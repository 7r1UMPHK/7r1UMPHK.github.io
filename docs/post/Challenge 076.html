<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="github-light" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://7r1UMPHK.github.io/css/primer.css' rel='stylesheet' />
    <script src='https://7r1UMPHK.github.io/plugins/theme.js'></script><script data-goatcounter='https://7r1umphk.goatcounter.com/count' async src='https://7r1umphk.github.io/plugins/count.js'></script>
    <link rel="icon" href="https://7r1UMPHK.github.io/image/20250320200557660.ico">
<meta name="description" content="![image-20250727171057275](http://7r1UMPHK.github.io/image/20250727171101631.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cd tmp      
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 076.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 415777 bytes (407 KiB)

Extracting archive: 076.zip
--
Path = 076.zip
Type = zip
Physical Size = 415777

Everything is Ok

Files: 2
Size:       1056496
Compressed: 415777
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al               
总计 1459
drwxr-xr-x 1 kali kali    4096  7月27日 05:11 .
drwxr-xr-x 1 kali kali   16384  7月26日 10:07 ..
-rwxr-xr-x 1 kali kali  415777  7月27日 05:11 076.zip
-rwxr-xr-x 1 kali kali   16392 2024年 7月 1日 hmv010
-rwxr-xr-x 1 kali kali 1040104 2024年 7月 1日 hmv010-static
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ./hmv010-static
Enter the flag : hello
Sorry, 𝓣𝓻𝔂 𝓱𝓪𝓻𝓭𝓮𝓻 !
```

反编译

```bash
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char v4[40]; // [rsp+0h] [rbp-30h] BYREF
  unsigned __int64 v5; // [rsp+28h] [rbp-8h]

  v5 = __readfsqword(0x28u);
  generate_random_numbers(argc, argv, envp);
  printf('Enter the flag : ');
  __isoc99_scanf('%32s', v4);
  if ( (unsigned int)xor_and_check(v4) )
    puts('馃憦 Bravo馃憦');
  else
    puts('Sorry, 饾摚饾摶饾攤 饾摫饾摢饾摶饾摥饾摦饾摶 !');
  return 0;
}

void generate_random_numbers()
{
  int i; // [rsp+Ch] [rbp-4h]

  srand(0);
  for ( i = 0; i <= 31; ++i )
    numbers[i] = rand() % 256;
}

__int64 __fastcall xor_and_check(__int64 a1)
{
  int i; // [rsp+14h] [rbp-4h]

  for ( i = 0; i <= 31; ++i )
  {
    if ( (FLAG[i] ^ numbers[i]) != *(unsigned __int8 *)(i + a1) )
      return 0LL;
  }
  return 1LL;
}
```

gdb

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ gdb ./hmv010-static 
GNU gdb (Debian 16.3-1) 16.3
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type 'show copying' and 'show warranty' for details.
This GDB was configured as 'x86_64-linux-gnu'.
Type 'show configuration' for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type 'help'.
Type 'apropos word' to search for commands related to 'word'...
Reading symbols from ./hmv010-static...
(No debugging symbols found in ./hmv010-static)
(gdb) break xor_and_check
Breakpoint 1 at 0x401bdb
(gdb) run
Starting program: /mnt/hgfs/gx/x/tmp/hmv010-static 
Enter the flag : aaaaaa

Breakpoint 1, 0x0000000000401bdb in xor_and_check ()
(gdb) info variables FLAG
All variables matching regular expression 'FLAG':

Non-debugging symbols:
0x00000000004b7020  FLAG
(gdb) info variables numbers
All variables matching regular expression 'numbers':

Non-debugging symbols:
0x00000000004e83c0  numbers
(gdb) x/32bx 0x4b7020
0x4b7020 <FLAG>:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00
0x4b7028 <FLAG+8>:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00
0x4b7030 <FLAG+16>:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00
0x4b7038 <FLAG+24>:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00
(gdb) x/32dw 0x4e83c0
0x4e83c0 <numbers>:     103     198     105     115
0x4e83d0 <numbers+16>:  81      255     74      236
0x4e83e0 <numbers+32>:  41      205     186     171
0x4e83f0 <numbers+48>:  242     251     227     70
0x4e8400 <numbers+64>:  124     194     84      248
0x4e8410 <numbers+80>:  27      232     231     141
0x4e8420 <numbers+96>:  118     90      46      99
0x4e8430 <numbers+112>: 51      159     201     154
(gdb) x/32dw 0x4b7020
0x4b7020 <FLAG>:        47      139     63      8
0x4b7030 <FLAG+16>:     1       140     47      153
0x4b7040 <FLAG+32>:     77      162     229     249
0x4b7050 <FLAG+48>:     147     149     167     118
0x4b7060 <FLAG+64>:     17      157     26      141
0x4b7070 <FLAG+80>:     118     138     130     255
0x4b7080 <FLAG+96>:     5       5       103     13
0x4b7090 <FLAG+112>:    108     192     138     231
```

写flag计算

```bash
#a.py
import random

def calc_flag():
    random.seed(0)
    
    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]
    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]
    
    flag = ''.join(chr(flag_ints[i] ^ numbers[i]) for i in range(32))
    print(flag)

calc_flag()
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 a.py             
HMV{Pseudo_RanD0m_Numbers_In__C}
```

。">
<meta property="og:title" content="Challenge 076">
<meta property="og:description" content="![image-20250727171057275](http://7r1UMPHK.github.io/image/20250727171101631.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cd tmp      
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 076.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 415777 bytes (407 KiB)

Extracting archive: 076.zip
--
Path = 076.zip
Type = zip
Physical Size = 415777

Everything is Ok

Files: 2
Size:       1056496
Compressed: 415777
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al               
总计 1459
drwxr-xr-x 1 kali kali    4096  7月27日 05:11 .
drwxr-xr-x 1 kali kali   16384  7月26日 10:07 ..
-rwxr-xr-x 1 kali kali  415777  7月27日 05:11 076.zip
-rwxr-xr-x 1 kali kali   16392 2024年 7月 1日 hmv010
-rwxr-xr-x 1 kali kali 1040104 2024年 7月 1日 hmv010-static
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ./hmv010-static
Enter the flag : hello
Sorry, 𝓣𝓻𝔂 𝓱𝓪𝓻𝓭𝓮𝓻 !
```

反编译

```bash
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char v4[40]; // [rsp+0h] [rbp-30h] BYREF
  unsigned __int64 v5; // [rsp+28h] [rbp-8h]

  v5 = __readfsqword(0x28u);
  generate_random_numbers(argc, argv, envp);
  printf('Enter the flag : ');
  __isoc99_scanf('%32s', v4);
  if ( (unsigned int)xor_and_check(v4) )
    puts('馃憦 Bravo馃憦');
  else
    puts('Sorry, 饾摚饾摶饾攤 饾摫饾摢饾摶饾摥饾摦饾摶 !');
  return 0;
}

void generate_random_numbers()
{
  int i; // [rsp+Ch] [rbp-4h]

  srand(0);
  for ( i = 0; i <= 31; ++i )
    numbers[i] = rand() % 256;
}

__int64 __fastcall xor_and_check(__int64 a1)
{
  int i; // [rsp+14h] [rbp-4h]

  for ( i = 0; i <= 31; ++i )
  {
    if ( (FLAG[i] ^ numbers[i]) != *(unsigned __int8 *)(i + a1) )
      return 0LL;
  }
  return 1LL;
}
```

gdb

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ gdb ./hmv010-static 
GNU gdb (Debian 16.3-1) 16.3
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type 'show copying' and 'show warranty' for details.
This GDB was configured as 'x86_64-linux-gnu'.
Type 'show configuration' for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type 'help'.
Type 'apropos word' to search for commands related to 'word'...
Reading symbols from ./hmv010-static...
(No debugging symbols found in ./hmv010-static)
(gdb) break xor_and_check
Breakpoint 1 at 0x401bdb
(gdb) run
Starting program: /mnt/hgfs/gx/x/tmp/hmv010-static 
Enter the flag : aaaaaa

Breakpoint 1, 0x0000000000401bdb in xor_and_check ()
(gdb) info variables FLAG
All variables matching regular expression 'FLAG':

Non-debugging symbols:
0x00000000004b7020  FLAG
(gdb) info variables numbers
All variables matching regular expression 'numbers':

Non-debugging symbols:
0x00000000004e83c0  numbers
(gdb) x/32bx 0x4b7020
0x4b7020 <FLAG>:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00
0x4b7028 <FLAG+8>:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00
0x4b7030 <FLAG+16>:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00
0x4b7038 <FLAG+24>:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00
(gdb) x/32dw 0x4e83c0
0x4e83c0 <numbers>:     103     198     105     115
0x4e83d0 <numbers+16>:  81      255     74      236
0x4e83e0 <numbers+32>:  41      205     186     171
0x4e83f0 <numbers+48>:  242     251     227     70
0x4e8400 <numbers+64>:  124     194     84      248
0x4e8410 <numbers+80>:  27      232     231     141
0x4e8420 <numbers+96>:  118     90      46      99
0x4e8430 <numbers+112>: 51      159     201     154
(gdb) x/32dw 0x4b7020
0x4b7020 <FLAG>:        47      139     63      8
0x4b7030 <FLAG+16>:     1       140     47      153
0x4b7040 <FLAG+32>:     77      162     229     249
0x4b7050 <FLAG+48>:     147     149     167     118
0x4b7060 <FLAG+64>:     17      157     26      141
0x4b7070 <FLAG+80>:     118     138     130     255
0x4b7080 <FLAG+96>:     5       5       103     13
0x4b7090 <FLAG+112>:    108     192     138     231
```

写flag计算

```bash
#a.py
import random

def calc_flag():
    random.seed(0)
    
    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]
    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]
    
    flag = ''.join(chr(flag_ints[i] ^ numbers[i]) for i in range(32))
    print(flag)

calc_flag()
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 a.py             
HMV{Pseudo_RanD0m_Numbers_In__C}
```

。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7r1UMPHK.github.io/post/Challenge%20076.html">
<meta property="og:image" content="https://7r1umphk.github.io/image/20250716100121947.webp">
<title>Challenge 076</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Challenge 076</h1>
<div class="title-right">
    <a href="https://7r1UMPHK.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/163" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题"style="display:none;">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/2ba842c29d74c322e5e76a1761dbc311299cb0ac1237c49863fd1de7d08a613d/687474703a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732373137313130313633312e77656270"><img src="https://camo.githubusercontent.com/2ba842c29d74c322e5e76a1761dbc311299cb0ac1237c49863fd1de7d08a613d/687474703a2f2f377231554d50484b2e6769746875622e696f2f696d6167652f32303235303732373137313130313633312e77656270" alt="image-20250727171057275" data-canonical-src="http://7r1UMPHK.github.io/image/20250727171101631.webp" style="max-width: 100%;"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ <span class="pl-c1">cd</span> tmp      
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 076.zip 

7-Zip 24.09 (x64) <span class="pl-c1">:</span> Copyright (c) 1999-2024 Igor Pavlov <span class="pl-c1">:</span> 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive <span class="pl-k">for</span> archives:
1 file, 415777 bytes (407 KiB)

Extracting archive: 076.zip
--
Path = 076.zip
Type = zip
Physical Size = 415777

Everything is Ok

Files: 2
Size:       1056496
Compressed: 415777
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al               
总计 1459
drwxr-xr-x 1 kali kali    4096  7月27日 05:11 <span class="pl-c1">.</span>
drwxr-xr-x 1 kali kali   16384  7月26日 10:07 ..
-rwxr-xr-x 1 kali kali  415777  7月27日 05:11 076.zip
-rwxr-xr-x 1 kali kali   16392 2024年 7月 1日 hmv010
-rwxr-xr-x 1 kali kali 1040104 2024年 7月 1日 hmv010-static</pre></div>
<p>运行</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ./hmv010-static
Enter the flag <span class="pl-c1">:</span> hello
Sorry, 𝓣𝓻𝔂 𝓱𝓪𝓻𝓭𝓮𝓻 <span class="pl-k">!</span></pre></div>
<p>反编译</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">int __fastcall main(int argc, const char <span class="pl-k">**</span>argv, const char <span class="pl-k">**</span>envp)
{
  char v4[40]<span class="pl-k">;</span> // [rsp+0h] [rbp-30h] BYREF
  unsigned __int64 v5<span class="pl-k">;</span> // [rsp+28h] [rbp-8h]

  v5 = __readfsqword(0x28u)<span class="pl-k">;</span>
  generate_random_numbers(argc, argv, envp)<span class="pl-k">;</span>
  printf(<span class="pl-s"><span class="pl-pds">"</span>Enter the flag : <span class="pl-pds">"</span></span>)<span class="pl-k">;</span>
  __isoc99_scanf(<span class="pl-s"><span class="pl-pds">"</span>%32s<span class="pl-pds">"</span></span>, v4)<span class="pl-k">;</span>
  <span class="pl-k">if</span> ( (unsigned int)xor_and_check(v4) )
    puts(<span class="pl-s"><span class="pl-pds">"</span>馃憦 Bravo馃憦<span class="pl-pds">"</span></span>)<span class="pl-k">;</span>
  <span class="pl-k">else</span>
    puts(<span class="pl-s"><span class="pl-pds">"</span>Sorry, 饾摚饾摶饾攤 饾摫饾摢饾摶饾摥饾摦饾摶 !<span class="pl-pds">"</span></span>)<span class="pl-k">;</span>
  <span class="pl-k">return</span> 0<span class="pl-k">;</span>
}

void <span class="pl-en">generate_random_numbers</span>()
{
  int i<span class="pl-k">;</span> // [rsp+Ch] [rbp-4h]

  srand(0)<span class="pl-k">;</span>
  <span class="pl-k">for</span> ( i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span>= 31<span class="pl-k">;</span> ++i )
    numbers[i] = <span class="pl-en">rand</span>() % 256;
}

__int64 __fastcall xor_and_check(__int64 a1)
{
  int i<span class="pl-k">;</span> // [rsp+14h] [rbp-4h]

  <span class="pl-k">for</span> ( i = 0<span class="pl-k">;</span> i <span class="pl-k">&lt;</span>= 31<span class="pl-k">;</span> ++i )
  {
    <span class="pl-k">if</span> ( (FLAG[i] ^ numbers[i]) <span class="pl-k">!</span>= <span class="pl-k">*</span>(unsigned __int8 <span class="pl-k">*</span>)(i + a1) )
      <span class="pl-k">return</span> 0LL<span class="pl-k">;</span>
  }
  <span class="pl-k">return</span> 1LL<span class="pl-k">;</span>
}</pre></div>
<p>gdb</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ gdb ./hmv010-static 
GNU gdb (Debian 16.3-1) 16.3
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <span class="pl-k">&lt;</span>http://gnu.org/licenses/gpl.html<span class="pl-k">&gt;</span>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type <span class="pl-s"><span class="pl-pds">"</span>show copying<span class="pl-pds">"</span></span> and <span class="pl-s"><span class="pl-pds">"</span>show warranty<span class="pl-pds">"</span></span> <span class="pl-k">for</span> details.
This GDB was configured as <span class="pl-s"><span class="pl-pds">"</span>x86_64-linux-gnu<span class="pl-pds">"</span></span>.
Type <span class="pl-s"><span class="pl-pds">"</span>show configuration<span class="pl-pds">"</span></span> <span class="pl-k">for</span> configuration details.
For bug reporting instructions, please see:
<span class="pl-k">&lt;</span>https://www.gnu.org/software/gdb/bugs/<span class="pl-k">&gt;</span>.
Find the GDB manual and other documentation resources online at:
    <span class="pl-k">&lt;</span>http://www.gnu.org/software/gdb/documentation/<span class="pl-k">&gt;</span>.

For help, <span class="pl-c1">type</span> <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span>.
Type <span class="pl-s"><span class="pl-pds">"</span>apropos word<span class="pl-pds">"</span></span> to search <span class="pl-k">for</span> commands related to <span class="pl-s"><span class="pl-pds">"</span>word<span class="pl-pds">"</span></span>...
Reading symbols from ./hmv010-static...
(No debugging symbols found <span class="pl-k">in</span> ./hmv010-static)
(gdb) <span class="pl-c1">break</span> xor_and_check
Breakpoint 1 at 0x401bdb
(gdb) run
Starting program: /mnt/hgfs/gx/x/tmp/hmv010-static 
Enter the flag <span class="pl-c1">:</span> aaaaaa

Breakpoint 1, 0x0000000000401bdb <span class="pl-k">in</span> <span class="pl-en">xor_and_check</span> ()
(gdb) info variables FLAG
All variables matching regular expression <span class="pl-s"><span class="pl-pds">"</span>FLAG<span class="pl-pds">"</span></span>:

Non-debugging symbols:
0x00000000004b7020  FLAG
(gdb) info variables numbers
All variables matching regular expression <span class="pl-s"><span class="pl-pds">"</span>numbers<span class="pl-pds">"</span></span>:

Non-debugging symbols:
0x00000000004e83c0  numbers
(gdb) x/32bx 0x4b7020
0x4b7020 <span class="pl-k">&lt;</span>FLAG<span class="pl-k">&gt;</span>:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00
0x4b7028 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">8&gt;</span>:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00
0x4b7030 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">16&gt;</span>:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00
0x4b7038 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">24&gt;</span>:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00
(gdb) x/32dw 0x4e83c0
0x4e83c0 <span class="pl-k">&lt;</span>numbers<span class="pl-k">&gt;</span>:     103     198     105     115
0x4e83d0 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">16&gt;</span>:  81      255     74      236
0x4e83e0 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">32&gt;</span>:  41      205     186     171
0x4e83f0 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">48&gt;</span>:  242     251     227     70
0x4e8400 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">64&gt;</span>:  124     194     84      248
0x4e8410 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">80&gt;</span>:  27      232     231     141
0x4e8420 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">96&gt;</span>:  118     90      46      99
0x4e8430 <span class="pl-k">&lt;</span>numbers+<span class="pl-k">112&gt;</span>: 51      159     201     154
(gdb) x/32dw 0x4b7020
0x4b7020 <span class="pl-k">&lt;</span>FLAG<span class="pl-k">&gt;</span>:        47      139     63      8
0x4b7030 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">16&gt;</span>:     1       140     47      153
0x4b7040 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">32&gt;</span>:     77      162     229     249
0x4b7050 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">48&gt;</span>:     147     149     167     118
0x4b7060 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">64&gt;</span>:     17      157     26      141
0x4b7070 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">80&gt;</span>:     118     138     130     255
0x4b7080 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">96&gt;</span>:     5       5       103     13
0x4b7090 <span class="pl-k">&lt;</span>FLAG+<span class="pl-k">112&gt;</span>:    108     192     138     231</pre></div>
<p>写flag计算</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span>a.py</span>
import random

def <span class="pl-en">calc_flag</span>():
    random.seed(0)
    
    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]
    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]
    
    flag = <span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>.join(chr(flag_ints[i] ^ numbers[i]) <span class="pl-k">for</span> <span class="pl-smi">i</span> <span class="pl-k">in</span> range(32))
    print(flag)

<span class="pl-en">calc_flag</span>()</pre></div>
<p>运行</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 a.py             
HMV{Pseudo_RanD0m_Numbers_In__C}</pre></div></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://7r1UMPHK.github.io">TriumphK Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","7r1UMPHK/7r1UMPHK.github.io");
    script.setAttribute("issue-term","title");
    
    script.setAttribute("theme","github-light");
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>

</html>
